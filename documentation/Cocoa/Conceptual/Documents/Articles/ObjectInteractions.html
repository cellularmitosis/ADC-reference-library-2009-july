<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Document-Based Applications Overview: Message Flow in the Document Architecture</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Message Flow in the Document Architecture"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40003196" title="Message Flow in the Document Architecture"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../DesignGuidelines-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000556" target="_top">Design Guidelines</a> &gt; <a href="../index.html" target="_top">Document-Based Applications Overview</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../Tasks/SubclassController.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../Concepts/WindowClosingBehav.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/TP40003196-SW2" title="Message Flow in the Document Architecture"></a><hr /><H1>Message Flow in the Document Architecture</H1><p><a name="//apple_ref/doc/uid/TP40003196-DontLinkElementID_44"></a>The objects that form the document architecture interact to perform the activities of document-based applications, and those interactions proceed primarily through messages sent among the objects via public APIs. This provides many opportunities for you to customize the behavior of your application by overriding methods in your <code>NSDocument</code> subclass or other subclasses.</p><p>This article describes default message flow among major objects of the document architecture, as defined in Mac OS X v10.4, including objects sending messages to themselves; it leaves out various objects and messages peripheral to the main mechanisms.</p><p>This article doesn't cover code paths the document architecture takes to support Java, as well as older, Objective-C document-based applications that override methods deprecated in Mac OS X v10.4. (If those methods are overridden, the document architecture ensures that they are called, so their customizations still work properly. Of course, such applications don't benefit from the improvements introduced in Mac OS X v10.4, such as robust error handling.) Finally, these messages are sent by the default implementations of the methods in question, and the behavior of subclasses may differ.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="ObjectInteractions.html#//apple_ref/doc/uid/TP40003196-DontLinkElementID_4">Creating a New Document</a>
				
			<br/>
			
        
			
			
				<a href="ObjectInteractions.html#//apple_ref/doc/uid/TP40003196-DontLinkElementID_5">Opening a Document</a>
				
			<br/>
			
        
			
			
				<a href="ObjectInteractions.html#//apple_ref/doc/uid/TP40003196-DontLinkElementID_7">Saving a Document</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40003196-DontLinkElementID_4" title="Creating a New Document"></a><h2>Creating a New Document</h2><p>The <a name="//apple_ref/doc/uid/TP40003196-DontLinkElementID_45"></a>document architecture creates a new document when the user chooses New from the File menu of a document-based application. This action begins a sequence of messages among the <code>NSDocumentController</code> object,  the newly created <code>NSDocument</code> object, and the <code>NSWindowController</code> object, as shown in <span class="content_text">Figure 2</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP40003196-SW1" title="Figure 2Creating a new document"></a><p><strong>Figure 2&nbsp;&nbsp;</strong>Creating a new document</p><img src = "Art/newdocument.gif" alt = "Creating a new document" width="771" height="354"></div><br/><p>The sequence numbers in <span class="content_text">Figure 2</span> refer to the following steps in the document-creation process:</p><ol class="ol"><li class="li"><p>The user chooses New from the File menu, causing the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocumentController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocumentController/newDocument:" target="_top">newDocument:</a></code> message to be sent to the document controller (or an Apple event, for example, sends an equivalent message).</p></li><li class="li"><p>The <code><a href="../../../Reference/ApplicationKit/Classes/NSDocumentController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocumentController/openUntitledDocumentAndDisplay:error:" target="_top">openUntitledDocumentAndDisplay:error:</a></code> method determines the default document type (stored in the application's <code>Info.plist</code> file) and sends it with the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocumentController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocumentController/makeUntitledDocumentOfType:error:" target="_top">makeUntitledDocumentOfType:error:</a></code>message.</p></li><li class="li"><p>The <code><a href="../../../Reference/ApplicationKit/Classes/NSDocumentController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocumentController/makeUntitledDocumentOfType:error:" target="_top">makeUntitledDocumentOfType:error:</a></code> method determines the <code>NSDocument</code> subclass corresponding to the document type, instantiates the document object, and sends it an initialization message.</p></li><li class="li"><p>The document controller adds the new document to its document list and, if the first parameter passed with <code><a href="../../../Reference/ApplicationKit/Classes/NSDocumentController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocumentController/openUntitledDocumentAndDisplay:error:" target="_top">openUntitledDocumentAndDisplay:error:</a></code> is <code>YES</code>, sends the document a message to create a window controller for its window, which is stored in its nib file. The <code>NSDocument</code> subclass can override <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/makeWindowControllers" target="_top">makeWindowControllers</a></code> if it has more than one window.</p></li><li class="li"><p>The document adds the newly created window controller to its list of window controllers by sending itself an <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/addWindowController:" target="_top">addWindowController:</a></code> message.</p></li><li class="li"><p>The document controller sends the document a message to show its windows. In response, the document sends the window controller a <code>showWindow:</code> message, which makes the window main and key.</p></li></ol><p>If the first parameter passed with <code><a href="../../../Reference/ApplicationKit/Classes/NSDocumentController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocumentController/openUntitledDocumentAndDisplay:error:" target="_top">openUntitledDocumentAndDisplay:error:</a></code> is <code>NO</code>, the document controller needs to explicitly send the document <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/makeWindowControllers" target="_top">makeWindowControllers</a></code> and <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/showWindows" target="_top">showWindows</a></code> messages to display the document window.</p><a name="//apple_ref/doc/uid/TP40003196-DontLinkElementID_5" title="Opening a Document"></a><h2>Opening a Document</h2><p>The <a name="//apple_ref/doc/uid/TP40003196-DontLinkElementID_46"></a>document architecture opens a document, reading its contents from a file, when the user chooses Open from the File menu. This action begins a sequence of messages among the <code>NSDocumentController</code>, <code>NSOpenPanel</code>, <code>NSDocument</code>, and <code>NSWindowController</code> objects, as shown in <span class="content_text"><a href="ObjectInteractions.html#//apple_ref/doc/uid/TP40003196-SW3">Figure 3</a></span>.</p><p>There are many similarities between the mechanisms for opening a document and creating a new document. In both cases the document controller needs to create and initialize an <code>NSDocument</code> object, using the proper <code>NSDocument</code> subclass corresponding to the document type, the document controller needs to add the document to its document list, and the document needs to create a window controller and tell it to show its window.</p><a name="//apple_ref/doc/uid/TP40003196-DontLinkElementID_6" title="Document Opening Message Flow"></a><h3>Document Opening Message Flow</h3><p>Opening a document differs from creating a new document in several ways. If document opening was invoked by the user choosing Open from the File menu, the document controller must run an Open panel to allow the user to select a file to provide the contents of the document. An Apple event can invoke a different message sequence. In any case, the document must read its content data from a file and keep track of the file's meta-information, such as its URL, type, and modification date.</p><br/><div><a name="//apple_ref/doc/uid/TP40003196-SW3" title="Figure 3Opening a document"></a><p><strong>Figure 3&nbsp;&nbsp;</strong>Opening a document</p><img src = "Art/opendocument.gif" alt = "Opening a document" width="658" height="397"></div><br/><p>The sequence numbers in <span class="content_text">Figure 3</span> refer to the following steps in the document-opening process:</p><ol class="ol"><li class="li"><p>The user chooses Open from the File menu, causing the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocumentController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocumentController/openDocument:" target="_top">openDocument:</a></code> message to be sent to the document controller.</p></li><li class="li"><p>The URL locating the document file must be retrieved from the user, so the <code>NSDocumentController</code> object sends itself the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocumentController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocumentController/URLsFromRunningOpenPanel" target="_top">URLsFromRunningOpenPanel</a></code> message. After this method creates the Open panel and sets it up appropriately, the document controller sends itself the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocumentController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocumentController/runModalOpenPanel:forTypes:" target="_top">runModalOpenPanel:forTypes:</a></code> message to present the Open panel to the user. The <code>NSDocumentController</code> object sends the <code><a href="../../../Reference/ApplicationKit/Classes/NSOpenPanel_Class/Reference/Reference.html#//apple_ref/occ/instm/NSOpenPanel/runModalForTypes:" target="_top">runModalForTypes:</a></code> message to the <code>NSOpenPanel</code> object.</p></li><li class="li"><p>With the resulting URL, the <code>NSDocumentController</code> object sends itself the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocumentController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocumentController/openDocumentWithContentsOfURL:display:error:" target="_top">openDocumentWithContentsOfURL:display:error:</a></code> message.</p></li><li class="li"><p>The <code>NSDocumentController</code> object sends itself the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocumentController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocumentController/makeDocumentWithContentsOfURL:ofType:error:" target="_top">makeDocumentWithContentsOfURL:ofType:error:</a></code> message and sends the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/initWithContentsOfURL:ofType:error:" target="_top">initWithContentsOfURL:ofType:error:</a></code> message to the newly created <code>NSDocument</code> object. This method initializes the document and reads in its contents from the file located at the specified URL. <span class="content_text"><a href="ObjectInteractions.html#//apple_ref/doc/uid/TP40003196-SW4">“Document Initialization Message Flow”</a></span> describes document initialization in this context.</p></li><li class="li"><p>When <code><a href="../../../Reference/ApplicationKit/Classes/NSDocumentController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocumentController/makeDocumentWithContentsOfURL:ofType:error:" target="_top">makeDocumentWithContentsOfURL:ofType:error:</a></code> returns an initialized <code>NSDocument</code> object, the <code>NSDocumentController</code> object adds the document to its document list by sending the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocumentController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocumentController/addDocument:" target="_top">addDocument:</a></code> message to itself.</p></li><li class="li"><p>To display the document's user interface, the document controller sends the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/makeWindowControllers" target="_top">makeWindowControllers</a></code> message to the <code>NSDocument</code> object, which creates an <code>NSWindowController</code> instance and adds it to its list using the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/addWindowController:" target="_top">addWindowController:</a></code> message.</p></li><li class="li"><p>Finally, the document controller sends the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/showWindows" target="_top">showWindows</a></code> message to the <code>NSDocument</code> object, which, in turn, sends the <code><a href="../../../Reference/ApplicationKit/Classes/NSWindowController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSWindowController/showWindow:" target="_top">showWindow:</a></code> message to the <code>NSWindowController</code> object, making the window main and key.</p></li><li class="li"><p>If the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocumentController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocumentController/URLsFromRunningOpenPanel" target="_top">URLsFromRunningOpenPanel</a></code> method returned an array with more than one URL, steps 3 through 7 repeat for each URL returned.</p></li></ol><a name="//apple_ref/doc/uid/TP40003196-SW4" title="Document Initialization Message Flow"></a><h3>Document Initialization Message Flow</h3><p><a name="//apple_ref/doc/uid/TP40003196-DontLinkElementID_47"></a>Initialization of the <code>NSDocument</code> subclass object is typical. Steps in the document-initialization process for document creation are shown in <span class="content_text">Figure 4</span>. Document initialization in the context of document opening is noteworthy because it invokes the document's location-based or data-based reading and writing methods, and you must override one of them. Steps in the document-initialization process for document opening are shown in <span class="content_text">Figure 5</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP40003196-SW7" title="Figure 4Document initialization for document creation"></a><p><strong>Figure 4&nbsp;&nbsp;</strong>Document initialization for document creation</p><img src = "Art/initnewdocument.gif" alt = "Document initialization for document creation" width="323" height="131"></div><br/><p>The sequence numbers in <span class="content_text">Figure 4</span> refer to the following steps in the document-initialization process:</p><ol class="ol"><li class="li"><p>The <code>NSDocumentController</code> object begins document initialization by sending the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/initWithType:error:" target="_top">initWithType:error:</a></code> message to the newly created <code>NSDocument</code> object.</p></li><li class="li"><p>The <code>NSDocument</code> object sends the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/init" target="_top">init</a></code> message to itself, invoking its designated initializer, then sets its filetype by sending itself the message <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/setFileType:" target="_top">setFileType:</a></code>.</p></li></ol><br/><div><a name="//apple_ref/doc/uid/TP40003196-SW5" title="Figure 5Document initialization for document opening"></a><p><strong>Figure 5&nbsp;&nbsp;</strong>Document initialization for document opening</p><img src = "Art/initdocument.gif" alt = "Document initialization for document opening" width="555" height="314"></div><br/><p>The sequence numbers in <span class="content_text">Figure 5</span> refer to the following steps in the document-opening process:</p><ol class="ol"><li class="li"><p>The <code>NSDocumentController</code> object begins document initialization by sending the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/initWithContentsOfURL:ofType:error:" target="_top">initWithContentsOfURL:ofType:error:</a></code> message to the newly created <code>NSDocument</code> object.</p></li><li class="li"><p>The <code>NSDocument</code> object sends the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/init" target="_top">init</a></code> message to itself, invoking its designated initializer, then sets its metadata about the file it is about to open by sending itself the messages <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/setFileURL:" target="_top">setFileURL:</a></code>, <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/setFileType:" target="_top">setFileType:</a></code>, and <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/setFileModificationDate:" target="_top">setFileModificationDate:</a></code>.</p></li><li class="li"><p>The <code>NSDocument</code> object reads the contents of the file by sending the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/readFromURL:ofType:error:" target="_top">readFromURL:ofType:error:</a></code> message to itself. That method gets a file wrapper from disk and reads it by sending the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/readFromFileWrapper:ofType:error:" target="_top">readFromFileWrapper:ofType:error:</a></code> message to itself. Finally, the <code>NSDocument</code> object puts the file contents into an <code>NSData</code> object and sends the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/readFromData:ofType:error:" target="_top">readFromData:ofType:error:</a></code> message to itself.</p><p>Your <code>NSDocument</code> subclass <em>must</em> override one of the three document-reading methods (<code>readFromURL:ofType:error:</code>, <code>readFromData:ofType:error:</code>, or <code>readFromFileWrapper:ofType:error:</code>) or every method that may invoke <code>readFromURL:ofType:error:</code>.</p></li></ol><a name="//apple_ref/doc/uid/TP40003196-DontLinkElementID_7" title="Saving a Document"></a><h2>Saving a Document</h2><p>The <a name="//apple_ref/doc/uid/TP40003196-DontLinkElementID_48"></a>document architecture saves a document—writes its contents to a file—when the user chooses one of the Save commands or Export from the File menu. Saving is handled primarily by the document object itself. Steps in the document-saving process are shown in <span class="content_text">Figure 6</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP40003196-SW6" title="Figure 6Saving a document"></a><p><strong>Figure 6&nbsp;&nbsp;</strong>Saving a document</p><img src = "Art/savedocument.gif" alt = "Saving a document" width="768" height="653"></div><br/><p>The sequence numbers in <span class="content_text">Figure 6</span> refer to the following steps in the document-saving process:</p><ol class="ol"><li class="li"><p>The user chooses Save from the File menu, causing the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/saveDocument:" target="_top">saveDocument:</a></code> message to be sent to the <code>NSDocument</code> object.</p></li><li class="li"><p>The <code>NSDocument</code> object sends the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/saveDocumentWithDelegate:didSaveSelector:contextInfo:" target="_top">saveDocumentWithDelegate:didSaveSelector:contextInfo:</a></code> message to itself.</p><p>If the document has never been saved, or if the user has moved or renamed the document file, then the <code>NSDocument</code> object runs a modal Save panel to get the file location under which to save the document, as it does immediately if the user chooses Save As or Save To from the File menu.</p></li><li class="li"><p>To run the Save panel, the <code>NSDocument</code> object sends the  <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/runModalSavePanelForSaveOperation:delegate:didSaveSelector:contextInfo:" target="_top">runModalSavePanelForSaveOperation:delegate:didSaveSelector:contextInfo:</a></code> message to itself. The document sends <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/prepareSavePanel:" target="_top">prepareSavePanel:</a></code> to itself to give subclasses an opportunity to customize the Save panel, then sends <code><a href="../../../Reference/ApplicationKit/Classes/NSSavePanel_Class/Reference/Reference.html#//apple_ref/occ/instm/NSSavePanel/runModalForDirectory:file:" target="_top">runModalForDirectory:file:</a></code> to the Save panel object.</p></li><li class="li"><p>The <code>NSDocument</code> object sends the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/saveToURL:ofType:forSaveOperation:delegate:didSaveSelector:contextInfo:" target="_top">saveToURL:ofType:forSaveOperation:delegate:didSaveSelector:contextInfo:</a></code> and, in turn, <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/saveToURL:ofType:forSaveOperation:error:" target="_top">saveToURL:ofType:forSaveOperation:error:</a></code> to itself. </p></li><li class="li"><p>The <code>NSDocument</code> object sends the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/writeSafelyToURL:ofType:forSaveOperation:error:" target="_top">writeSafelyToURL:ofType:forSaveOperation:error:</a></code> message to itself. The default implementation either creates a temporary directory in which the document writing should be done, or renames the old on-disk revision of the document, depending on what sort of save operation is being done, whether or not there's already a copy of the document on disk, and the capabilities of the file system to which writing is being done. Then it sends the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/writeToURL:ofType:forSaveOperation:originalContentsURL:error:" target="_top">writeToURL:ofType:forSaveOperation:originalContentsURL:error:</a></code> message to the document.</p></li><li class="li"><p>To write the document contents to the file, the <code>NSDocument</code> object sends itself the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/writeToURL:ofType:error:" target="_top">writeToURL:ofType:error:</a></code> message, which by default sends the document the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/fileWrapperOfType:error:" target="_top">fileWrapperOfType:error:</a></code> message. That method, in turn, sends the document the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/dataOfType:error:" target="_top">dataOfType:error:</a></code> message to create an <code>NSData</code> object containing the contents of the document. (For backward compatibility, if the deprecated <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/occ/instm/NSDocument/dataRepresentationOfType:" target="_top">dataRepresentationOfType:</a></code> is overridden, the document sends itself that message instead.)</p><p>The <code>NSDocument</code> subclass <em>must</em> override one of its document-writing methods (<code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/dataOfType:error:" target="_top">dataOfType:error:</a></code>, <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/writeToURL:ofType:error:" target="_top">writeToURL:ofType:error:</a></code>, <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/fileWrapperOfType:error:" target="_top">fileWrapperOfType:error:</a></code>, or <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/writeToURL:ofType:forSaveOperation:originalContentsURL:error:" target="_top">writeToURL:ofType:forSaveOperation:originalContentsURL:error:</a></code>).</p></li><li class="li"><p>The <code>NSDocument</code> object sends the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/fileAttributesToWriteToURL:ofType:forSaveOperation:originalContentsURL:error:" target="_top">fileAttributesToWriteToURL:ofType:forSaveOperation:originalContentsURL:error:</a></code> message to itself to get the file attributes, if any, which it writes to the file. The method then moves the just-written file to its final location, or deletes the old on-disk revision of the document, and deletes any temporary directories. In addition, the <code>NSDocument</code> object sends the <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/keepBackupFile" target="_top">keepBackupFile</a></code> message to itself. Subclasses can override this method, which returns <code>NO</code> by default, if they want to retain the backup files created before the document writes its data to the file.</p></li><li class="li"><p>The <code>NSDocument</code> object updates its location, file type, and modification date by sending itself the messages <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/setFileURL:" target="_top">setFileURL:</a></code>, <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/setFileType:" target="_top">setFileType:</a></code>, and <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/setFileModificationDate:" target="_top">setFileModificationDate:</a></code> if appropriate.<a name="//apple_ref/doc/uid/TP40003196-DontLinkElementID_49"></a></p></li></ol>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../Tasks/SubclassController.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../Concepts/WindowClosingBehav.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2001, 2009 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2009-01-12<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Conceptual/Documents/Articles/ObjectInteractions.html%3Fid%3D10000006i-2.7&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Conceptual/Documents/Articles/ObjectInteractions.html%3Fid%3D10000006i-2.7&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Conceptual/Documents/Articles/ObjectInteractions.html%3Fid%3D10000006i-2.7&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
