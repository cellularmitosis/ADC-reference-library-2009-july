<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Resource Format(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING589></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-588.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-590.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-570.html"><B>Appendix C - Keyboard Resources</B></A> / <A HREF="Text-588.html"><B>Key-Caps Resource (Type 'KCAP')</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING589-0></A>
<H2>Resource Format</H2>
 <A HREF=#MARKER-9-101>Figure C-10</A> shows the format for the key-caps resource.<P>
<B>Figure C-10  <A NAME=MARKER-9-101></A>Format of the key-caps resource</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/KR_L-06.jpg">
 The key-caps resource has these elements:<P>
<UL>
<LI>Boundary rectangle. The position of the content region of the Key Caps window.
<LI>Text rectangle. The position of the text box within the Key Caps window.
<LI>Main array. The remainder of the resource. It consists of an array of one shape entry for each key shape.<P>
</UL>
 Each shape entry in the main array has two components:<P>
<UL>
<LI>Shape array. A (zero-based) count of entries followed by one or more entries. Each entry is a point, representing the relative pixel offset from the origin of the key, that define a particular key shape. The shape array is a single point for rectangular keys. More complex keys, like the Return key, need two points in their shape array.
<LI>Key array. A set of key entries, describing all the keys with that shape.<P>
</UL>
 Each key entry in a shape entry specifies the following information:<P>
<UL>
<LI>Vertical delta and horizontal delta. Vertical and horizontal values to move the pen before drawing the current key. For each shape (that is, for each shape entry in the main array), the pen starts out at the upper-left corner of the content region of the Key Caps window, so the vertical and horizontal delta values for the first key in the key array for that shape are distances from the upper-left corner to the origin of the first key. For subsequent keys in the key array, the deltas are distances from the origin of the previous key to the origin of the current key. Each key is drawn with the shape defined by the shape array for that shape.
<LI>Virtual key code. The virtual key code for the current key. Because it uses virtual key codes, each key-caps resource is tied directly to a particular key-map resource and hardware keyboard but can work with any keyboard-layout resource.
<LI>Modifier mask and Boolean. A modifier mask and a Boolean flag for how to use it. When Key Caps draws the current key, it retrieves the byte that represents the real modifier key state, combines it with this mask performing an <CODE>OR</CODE> or <CODE>AND</CODE> operation as specified, calls the <CODE>KeyTranslate</CODE> function with the resulting modifier byte and the virtual key code from the key-caps resource, and draws the resulting character or characters in the current key's location. The modifier mask is only required for non-ADB keyboards, which use artificial modifier key states to overlap the key codes for arrow keys and keypad operator keys. For other keyboards, the mask is 0 and the flag is set to specify an <CODE>OR</CODE> operation.<P>
</UL>
 <A HREF=#MARKER-9-102>Listing C-4</A> is an abridged example of the data in a key-caps resource, shown in <BR>Rez format.<P>
<B>Listing C-4  <A NAME=MARKER-9-102></A>Sample key-caps resource data in Rez format</B><P>
<PRE>
resource 'KCAP' ($01) {
            {60, 45, 220, 455},              /* boundsRect */
            {12, 42, 36, 368},               /* textRect */
            {
               { {21, 21} }, {               /* Shape No. 1 */
                  0, or, $35, 50, 10;           /* escape */
                  0, or, $12, 0, 20;            /* 1 ! */
                  0, or, $13, 0, 20;            /* 2 @ */
                  ...
                  0, or, $7D, 0, 20;            /* Down arrow */
                  0, or, $7E, 0, 20;            /* Up arrow */
                  0, or, $41, 0, 80;            /* Keypad . */
                  0, or, $55, -20, 0;           /* Keypad 3 */
                  ...
            };
               { {21, 31} }, {               /* Shape No. 2 */
                  0, or, $30, 70, 10;           /* Tab */
                  0, or, $33, -20, 260          /* Backspace */
            };
                  ...
               {  {-21, 36}; {-41, 15} }, {  /* Shape No. 3 */
               0, or, $24, 111, 265             /* Return */
            };
            ...
         }
};
</PRE>
 The basic square key has a shape array of<CODE> { {21, 21} }</CODE>, which puts the origin in the upper-left corner of the key. The first key in the key array for this shape is the Escape key (key code $35) in the upper-left corner of the keyboard; this key is at vertical and horizontal delta offsets of (50, 50) from the upper-left corner of the window's content region. The next key with this shape is immediately to the right, with its origin at delta offsets of (0, 20) from the origin of the previous key.<P>
 The next shape is the slightly wider key with a shape array of <CODE>{ {21, 31} }</CODE>, used for the Tab and Backspace keys. The origin of the Tab key is at offsets (70, 10) from the upper-left corner of the window's content region (which puts the Tab key one row below the Escape key).<P>
 The shape array for the Return key is <CODE>{ {-21, 36}; {-41, 15} }</CODE>, which means that it is the union of two rectangles: the first rectangle is from the origin of the key to the first point, and the second rectangle is from the first point to the second point. (Both points are measured relative to the key origin, however.) This shape array puts the Return key's origin in the lower-left corner of the key. See <A HREF=#MARKER-9-103>Figure C-11</A>. The origin is at offsets (111, 265) from the upper-left corner of the window's content region.<P>
<B>Figure C-11  <A NAME=MARKER-9-103></A>Shape array and resulting region for the Return key</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/KR_L-07.jpg">
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-588.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-590.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
