<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>AppleScript Studio Programming Guide: Currency Converter Tutorial</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Currency Converter Tutorial"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20001253" title="Currency Converter Tutorial"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../ScriptingAutomation/index.html#//apple_ref/doc/uid/TP30000440-TP40005948" target="_top">Scripting &amp; Automation</a> &gt; <a href="../../../../ScriptingAutomation/AppleScript-date.html#//apple_ref/doc/uid/TP30000440-TP40005948-TP30000481" target="_top">AppleScript</a> &gt; <a href="../chapter01/studio_intro_book.html#//apple_ref/doc/uid/20001248-TPXREF101">AppleScript Studio Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../chapter05/studio_cookbook.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../chapter07/studio_ms_design_app.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/20001253-TPXREF101" title="Currency Converter Tutorial"></a><h1>Currency Converter Tutorial</h1><p>In this chapter, you’ll create a simple AppleScript Studio application that converts a dollar amount to an amount in another currency. The Currency Converter tutorial describes a number of tasks that are common to most AppleScript Studio applications, including:</p><ul class="ul"><li class="li"><p>creating a project with Xcode</p></li><li class="li"><p>building an interface with Interface Builder, including</p><ul class="nested"><li class="nested li"><p>inserting and initializing user interface objects</p></li><li class="nested li"><p>adjusting the interface to comply with the Aqua guidelines</p></li><li class="nested li"><p>connecting the interface to an event handler in a script</p></li><li class="nested li"><p>using common shortcuts</p></li></ul></li><li class="li"><p>writing an event handler</p></li><li class="li"><p>building and running the application</p></li></ul><p>You can also find a plain Cocoa version of the Currency Converter Tutorial in the Objective-C Language Documentation area of the <span class="content_text"><a href="../../../../Cocoa/index.html#//apple_ref/doc/uid/TP30000416" target="_top">Cocoa Documentation</a></span>. That tutorial provides some information you won’t need in this chapter, such as a discussion of object-oriented design, steps for creating custom object classes, and steps for hooking up user actions to class methods. In the AppleScript Studio version of Currency Converter, you’ll handle user actions in a scripting event handler, rather than with custom classes and methods. That makes your task quite a bit simpler. However, you may want to consult the Cocoa tutorial before designing more complex AppleScript Studio applications, such as the one described in <span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-TPXREF101">“Mail Search Tutorial: Design the Application.”</a></span></p><p>To build the Currency Converter application, you’ll perform these steps:</p><ol class="ol"><li class="li"><p><span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-BCIHBIDD">“Design the Application”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-TPXREF153">“Create a Project.”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-TPXREF154">“Build the Interface.”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-BCIIFFIJ">“Connect the Interface”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-BCIJHHAB">“Write Event Handlers”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-BCICGEEF">“Build and Run the Application”</a></span></p></li></ol><p>This chapter assumes you have completed the Hello World tutorial in <span class="content_text"><a href="../chapter02/studio_about_book.html#//apple_ref/doc/uid/20001249-TPXREF130">“Creating a Hello World Application”</a></span> and read <span class="content_text"><a href="../chapter03/studio_components.html#//apple_ref/doc/uid/20001250-TPXREF101">“AppleScript Studio Components”</a></span> as well.</p><p>After completing the Currency Converter tutorial, see <span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-BCIBJCHD">“Where To Go From Here”</a></span> for suggestions on how to learn more about AppleScript Studio.</p><a name="//apple_ref/doc/uid/20001253-BCIHBIDD" title="Design the Application"></a><h2>Design the Application</h2><p>The Currency Converter application is simple enough that it doesn’t require a complicated design process. The application should enable a user to type in a conversion rate and a dollar amount, then click a button to see the result—how much the dollars are worth in the new currency. The application requires only one window, which can be configured as shown in <span class="content_text">Figure 5-1</span>.</p><br/><div><a name="//apple_ref/doc/uid/20001253-BCIFGDAE" title="Figure 5-1The Currency Converter window"></a><p><strong>Figure 5-1&nbsp;&nbsp;</strong>The Currency Converter window</p><img src = "../art/cc_window_for_design.gif" alt = "The Currency Converter window" width="350" height="229"></div><br/><p>A user enters values in the first two fields, then clicks the button to get the answer in the third field. A horizontal separator divides the input and display fields from the Convert button.</p><a name="//apple_ref/doc/uid/20001253-TPXREF153" title="Create a Project"></a><h2>Create a Project</h2><p>Use Xcode to create a new AppleScript Studio project, as described in <span class="content_text"><a href="../chapter02/studio_about_book.html#//apple_ref/doc/uid/20001249-TPXREF130">“Creating a Hello World Application,”</a></span> typing “Currency Converter” for the project name.</p><p><span class="content_text">Figure 5-2</span> shows the new project after opening several groups in the Files list in the Groups &amp; Files pane. You can save the project by typing Command-S or by choosing the Save command from the File menu. Use your typical level of care in periodically saving and backing up your work.</p><br/><div><a name="//apple_ref/doc/uid/20001253-BCIEBBGH" title="Figure 5-2The project after opening several groups"></a><p><strong>Figure 5-2&nbsp;&nbsp;</strong>The project after opening several groups</p><img src = "../art/new_cc_proj_w_open_groups.gif" alt = "The project after opening several groups" width="700" height="481"></div><br/><p>At this point, you can build the project and create a working application, with a window that can be expanded, minimized, and closed. The application can display an About window and respond to a number of menu choices. These features are provided by the Cocoa application framework (described in <span class="content_text"><a href="../chapter03/studio_components.html#//apple_ref/doc/uid/20001250-TPXREF138">“Cocoa Framework Overview”</a></span>), without further work on your part. Of course you’ve got some work to do before the application can perform its custom operation of converting currencies.</p><p>To build and run the application, do one of the following:</p><ul class="ul"><li class="li"><p>type Command-R</p></li><li class="li"><p>choose Build and Run from the Build menu</p></li><li class="li"><p>click the Build and Run button shown in <span class="content_text">Figure 5-2</span></p></li></ul><p>When you are ready to continue with the tutorial, quit the application.</p><p>It usually makes sense to build an application periodically to make sure you haven’t introduced errors. However, the Currency Converter application is fairly simple, and it won’t have any additional functionality until you’ve written an event handler, so you might want to wait until later in this tutorial.</p><a name="//apple_ref/doc/uid/20001253-TPXREF154" title="Build the Interface"></a><h2>Build the Interface</h2><p>Before working on this section, you should be familiar with the information in <span class="content_text"><a href="../chapter03/studio_components.html#//apple_ref/doc/uid/20001250-TPXREF137">“Interface Builder Features for AppleScript Studio,”</a></span> which describes, among other things, the nib files Interface Builder uses to store interface definitions.</p><p>To build the interface for Currency Converter, you perform these steps:</p><ol class="ol"><li class="li"><p><span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-TPXREF147">“Launch Interface Builder”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-TPXREF163">“Adjust the Title, Size, and Other Attributes of the Currency Converter Window”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-BCIJAIGE">“Add Text Input Fields and Labels”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-BCIHIJAC">“Add a Result Field and Label”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-BCIDDJFA">“Add Number Formatters to the Input and Result Fields”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-BCICAAEA">“Add a Convert Button”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-BCIDIGJC">“Add a Horizontal Separator”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-BCICIJDJ">“Finalize the Layout”</a></span></p></li></ol><a name="//apple_ref/doc/uid/20001253-TPXREF147" title="Launch Interface Builder"></a><h3>Launch Interface Builder</h3><p>When you create a project with Xcode, the project automatically contains a default nib file named <code>MainMenu.nib</code>. The icon for this nib file is visible in <span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-BCIEBBGH">Figure 5-2</a></span>. To launch Interface Builder, double-click the icon. You should see the same four windows shown in <span class="content_text"><a href="../chapter03/studio_components.html#//apple_ref/doc/uid/20001250-BAJEEGIG">Figure 2-7</a></span>.</p><a name="//apple_ref/doc/uid/20001253-TPXREF163" title="Adjust the Title, Size, and Other Attributes of the Currency Converter Window"></a><h3>Adjust the Title, Size, and Other Attributes of the Currency Converter Window</h3><p>In this section you’ll make changes to the default window to set its title and adjust its size and other attributes. To modify the default window, perform these steps:</p><ol class="ol"><li class="li"><p>In Interface Builder’s MainMenu.nib window, double-click the text “Window” in the title of the Window instance. The result is shown in <span class="content_text">Figure 5-3</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCIGGGCE" title="Figure 5-3Selected text for Window instance in MainMenu.nib window"></a><p><strong>Figure 5-3&nbsp;&nbsp;</strong>Selected text for Window instance in MainMenu.nib window</p><img src = "../art/selected_instance_text.gif" alt = "Selected text for Window instance in MainMenu.nib window" width="389" height="267"></div></li><li class="li"><p>Type “Currency Converter” (without the quotes) as the new instance name. This step changes only the instance name, not the window title, but it’s a good habit to always name window instances so you can easily identify them.</p></li><li class="li"><p><span class="content_text">Figure 5-4</span> shows the default window for the Currency Converter instance. Note “Window” is still the window title.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCIDAHFD" title="Figure 5-4The default window in the Currency Converter project"></a><p><strong>Figure 5-4&nbsp;&nbsp;</strong>The default window in the Currency Converter project</p><img src = "../art/empty_search_wind.gif" alt = "The default window in the Currency Converter project" width="559" height="492"></div><p>Click once in this window, then choose Show Info from the Tools menu or type Command-Shift-I to open the Info window. The resulting Info window, with the Attribute pane visible, is shown in <span class="content_text">Figure 5-5</span>.</p><p>The Info window displays information about the currently selected object. The Info window displays the Attributes pane by default, or whichever pane was visible the last time the window was open. If the Attributes pane is not visible, use the pop-up menu at the top of the Info window or type Command-1 to display it.</p><p>You can tell the Info window is displaying information for a window object because its title is “NSWindow Info” (the window object is an instance of Cocoa’s NSWindow class). If the Info window has some other title when you open it, click either the window instance shown in <span class="content_text">Figure 5-3</span> or the window object shown in <span class="content_text">Figure 5-4</span> to display window information in the Info window.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCIGFHIG" title="Figure 5-5The Attributes pane of the Info window for a window object"></a><p><strong>Figure 5-5&nbsp;&nbsp;</strong>The Attributes pane of the Info window for a window object</p><img src = "../art/cc_info_before_retitle.gif" alt = "The Attributes pane of the Info window for a window object" width="306" height="454"></div></li><li class="li"><p>To retitle the window, simply type “Currency Converter” in the Window Title field, as shown in <span class="content_text">Figure 5-6</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCIIHHEJ" title="Figure 5-6The Info window after retitling the Currency Converter window"></a><p><strong>Figure 5-6&nbsp;&nbsp;</strong>The Info window after retitling the Currency Converter window</p><img src = "../art/cc_info_retitled_wind.gif" alt = "The Info window after retitling the Currency Converter window" width="306" height="454"></div></li><li class="li"><p>In the Controls section, deselect the Resize checkbox—you won’t allow a user to resize Currency Converter’s window. Later you’ll add a handler to quit the application when a user closes the window.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001253-DontLinkElementID_30" title="Note"></a><p><strong>Note:</strong>&nbsp;Even though you disable resizing of the window, the Currency Converter window in Interface Builder still has a resize control so you can resize it while working on your interface. When you build and run the application, the window will not have a resize control.</p></div><p>You don’t need to change the default settings for any other attributes. The final settings are shown in <span class="content_text">Figure 5-7</span>. For information on the other attributes, see <span class="content_text"><a href="../chapter04/studio_detail.html#//apple_ref/doc/uid/20001251-CJBGBHIF">“AppleScript Studio Terminology,”</a></span> as well as Interface Builder Help or the Cocoa documentation for the NSWindow class.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCIJJJIA" title="Figure 5-7The final Attributes settings for the Currency Converter window"></a><p><strong>Figure 5-7&nbsp;&nbsp;</strong>The final Attributes settings for the Currency Converter window</p><img src = "../art/cc_info_window_final.gif" alt = "The final Attributes settings for the Currency Converter window" width="306" height="452"></div></li><li class="li"><p>To resize the Currency Converter window, drag the resize control in the lower-right corner. The resized window should look similar to the one shown in <span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-BCIFGDAE">Figure 5-1</a></span>.</p><p>Instead of dragging, you can set the window to a specific pixel size. Use the pop-up menu or type Command-3 to display the Size pane in the Info window. The result is shown in <span class="content_text">Figure 5-8</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCICHIDB" title="Figure 5-8The Size pane of the Currency Converter window"></a><p><strong>Figure 5-8&nbsp;&nbsp;</strong>The Size pane of the Currency Converter window</p><img src = "../art/cc_info_size_pane.gif" alt = "The Size pane of the Currency Converter window" width="286" height="443"></div><p>To change the size, enter new width and height values in the text fields below the Width/Height pop-up menu. For the window shown in <span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-BCIFGDAE">Figure 5-1</a></span>, the width is about 320 pixels and the height about 180 pixels.</p><p>The Bottom/Left pop-up menu determines the window’s onscreen position when a user runs the application. You can either drag the window to the desired position or modify the values in the Size pane.</p><p>There are several items in the Size pane whose default values don’t need to be changed for Currency Converter. For example, the spring images control resizing, but you’ve already turned off resizing for the Currency Converter window.</p></li></ol><p>After all the changes you’ve made in this section, the Currency Converter window should look like <span class="content_text">Figure 5-9</span>.</p><br/><div><a name="//apple_ref/doc/uid/20001253-BCIEFBDA" title="Figure 5-9The modified Currency Converter window"></a><p><strong>Figure 5-9&nbsp;&nbsp;</strong>The modified Currency Converter window</p><img src = "../art/cc_wind_after_resizing.gif" alt = "The modified Currency Converter window" width="351" height="228"></div><br/><a name="//apple_ref/doc/uid/20001253-BCIJAIGE" title="Add Text Input Fields and Labels"></a><h3>Add Text Input Fields and Labels</h3><p>In this section you’ll perform steps that are common to nearly all AppleScript Studio application development, including:</p><ul class="spaceabove"><li class="li"><p>dragging user interface objects into your application window</p></li><li class="li"><p>positioning and resizing objects to support the Aqua user interface guidelines</p></li><li class="li"><p>using Interface Builder’s Info window to set attributes and prepare objects for scripting</p></li></ul><p>Currency Converter needs text fields for entering the exchange rate per dollar and the number of dollars to convert. Each of these input fields needs a label.</p><p>To add text input fields and labels to Currency Converter’s main window, perform these steps:</p><ol class="ol"><li class="li"><p>Click the Cocoa-Text button in the Palette window toolbar. The Cocoa-Text palette is shown in <span class="content_text">Figure 5-10</span>.</p><p>To display a help tag describing a button (and the palette it selects), position the cursor over an item in the Palette window’s toolbar for a few seconds.</p><p>Similarly, position the cursor over a user interface object in a palette to display the object’s Cocoa class (such as NSButton or NSTextField).</p><p>You can see that the palette provides several kinds of text elements. Each text element has a distinct appearance based on its function and role in an application—you can see a search field, a pop-up menu, a wrapping text field, and more.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001253-DontLinkElementID_31" title="Note"></a><p><strong>Note:</strong>&nbsp;You can modify the Palette window toolbar in Interface Builder by choosing Tools>Palettes>Customize Toolbar. If, for example, you do not see the AppleScript button (the rightmost button in <span class="content_text">Figure 5-10</span>) in the toolbar, you can add it by customizing the toolbar.</p></div><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-TPXREF209" title="Figure 5-10The Cocoa-Text palette of Interface Builder&acirc;&#128;&#153;s Palette window"></a><p><strong>Figure 5-10&nbsp;&nbsp;</strong>The Cocoa-Text palette of Interface Builder’s Palette window</p><img src = "../art/ib_text_palette.gif" alt = "The Cocoa-Text palette of Interface Builder’s Palette window" width="392" height="255"></div></li><li class="li"><p>Drag a text field object from the Palette window to the Currency Converter window. Position the text field in the upper-right corner, using Interface Builder’s feedback to help you align the text field according to the Aqua guidelines, as shown in <span class="content_text">Figure 5-11</span>. This is the exchange rate input field.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-TPXREF171" title="Figure 5-11Positioning a text input field for the exchange rate"></a><p><strong>Figure 5-11&nbsp;&nbsp;</strong>Positioning a text input field for the exchange rate</p><img src = "../art/cc_adding_first_field.gif" alt = "Positioning a text input field for the exchange rate" width="351" height="228"></div></li><li class="li"><p>Select the text field, then drag the middle selection handle on the left side to resize the field, as shown in <span class="content_text">Figure 5-12</span>. (If you use the upper or lower handle, it’s harder to maintain the same vertical height as you resize the field.) For now, don’t worry about making the field any specific width—you can adjust it later if necessary.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCIBHAHD" title="Figure 5-12Resizing the exchange rate input field"></a><p><strong>Figure 5-12&nbsp;&nbsp;</strong>Resizing the exchange rate input field</p><img src = "../art/cc_resizing_xchg_field.gif" alt = "Resizing the exchange rate input field" width="350" height="229"></div></li><li class="li"><p>With the exchange rate field selected, open the Info window to the Attribute pane. The result is shown in <span class="content_text">Figure 5-13</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCICHECC" title="Figure 5-13The Attributes pane of the Info window for the exchange rate field"></a><p><strong>Figure 5-13&nbsp;&nbsp;</strong>The Attributes pane of the Info window for the exchange rate field</p><img src = "../art/cc_info_for_xchg_field.gif" alt = "The Attributes pane of the Info window for the exchange rate field" width="285" height="477"></div></li><li class="li"><p>In the alignment section, click the middle button, to right-align text in the field.</p><p>There are several attributes whose default values don’t need to be changed for Currency Converter. For example, Editable and Enabled are already selected in the Options section. For information on other attributes, see Interface Builder Help or the Cocoa documentation for the NSTextField class.</p></li><li class="li"><p>To provide an AppleScript name for the exchange rate input field (so you can access it in scripts), display the AppleScript pane in the Info window, then type “rate” in the Name field. <span class="content_text">Figure 5-14</span> shows the result.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCIBIDFA" title="Figure 5-14The Info window, after supplying an AppleScript name for the exchange rate field"></a><p><strong>Figure 5-14&nbsp;&nbsp;</strong>The Info window, after supplying an AppleScript name for the exchange rate field</p><img src = "../art/cc_exch_rate_as_name.gif" alt = "The Info window, after supplying an AppleScript name for the exchange rate field" width="285" height="475"></div><p>If it makes sense, you can use the same AppleScript name for objects of different types in the same window (such as a button and a text field), or for objects of the same type (such as buttons) in different windows. However, if you name two text fields in the same window “rate,” you won’t be able to differentiate between them by name in an application script.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001253-DontLinkElementID_32" title="Note"></a><p><strong>Note:</strong>&nbsp;The first time you make a change in the AppleScript pane, Interface Builder adds a new instance named AppleScript Info to the nib window. This instance is shown in <span class="content_text">Figure 5-15</span>. For more information about this object, see <span class="content_text"><a href="../chapter08/studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-TPXREF165">“Add the Message Window to the Nib File.”</a></span></p></div><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCIHIEHC" title="Figure 5-15The MainMenu.nib window showing an AppleScript Info object (not selected)"></a><p><strong>Figure 5-15&nbsp;&nbsp;</strong>The MainMenu.nib window showing an AppleScript Info object (not selected)</p><img src = "../art/cc_nib_wind_with_info_obj.gif" alt = "The MainMenu.nib window showing an AppleScript Info object (not selected)" width="389" height="267"></div><div class="notebox"><a name="//apple_ref/doc/uid/20001253-DontLinkElementID_33" title="Note"></a><p><strong>Note:</strong>&nbsp;<span class="content_text">Figure 5-15</span> shows the Instances pane of the MainMenu.nib window in icon view. You can instead view it in outline view, by clicking the small outline view icon on the right-hand side of the view. An example of outline view is shown in <span class="content_text"><a href="../chapter09/studio_ms_connect_intf.html#//apple_ref/doc/uid/20001256-BCIBBDJI">Figure 8-12</a></span>.</p>Outline view is convenient for displaying view hierarchies and connections, and for selecting deeply nested objects. Later in this tutorial, you may want to use outline view to examine Currency Converter’s object hierarchy after inserting number formatters (see <span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-BCIDDJFA">“Add Number Formatters to the Input and Result Fields”</a></span>).</p></div></li><li class="li"><p>To add a label for the exchange rate input field, drag the label text field object with the text “System Font Text” (shown in <span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-TPXREF209">Figure 5-10</a></span>) from the Palette window to the Currency Converter window. Use the automatic feedback to position the label field to the left of the exchange rate input field, as shown in <span class="content_text">Figure 5-16</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCIFEJJB" title="Figure 5-16Positioning a label field for the exchange rate"></a><p><strong>Figure 5-16&nbsp;&nbsp;</strong>Positioning a label field for the exchange rate</p><img src = "../art/cc_placing_exch_label.gif" alt = "Positioning a label field for the exchange rate" width="262" height="177"></div></li><li class="li"><p>As in a previous step, select the label field and drag the middle selection handle on the left side to resize the field, as shown in <span class="content_text">Figure 5-17</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCIIEGFI" title="Figure 5-17Resizing the label field for the exchange rate"></a><p><strong>Figure 5-17&nbsp;&nbsp;</strong>Resizing the label field for the exchange rate</p><img src = "../art/cc_resizing_exch_label.gif" alt = "Resizing the label field for the exchange rate" width="263" height="177"></div></li><li class="li"><p>With the label field selected, open the Info window and display the Attributes pane. Now make these adjustments:</p><ol class="ol"><li class="ol ol"><p>Type “Exchange Rate per $1:” in the Title field. This is the label text. If any of the text is not visible, it may have scrolled out of view. If so, widen the label field until all the text is visible. You may need to resize the exchange rate input field as well.</p></li><li class="ol ol"><p>In the Alignment section, click the middle button, to right-align the label text.</p></li></ol><p><span class="content_text">Figure 5-18</span> shows the resulting Info window; <span class="content_text">Figure 5-19</span> shows the text label field. Note that a label field, like an input field, is based on the NSTextField class.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCIHDACI" title="Figure 5-18The Info window, after setting text and attributes for the exchange rate label"></a><p><strong>Figure 5-18&nbsp;&nbsp;</strong>The Info window, after setting text and attributes for the exchange rate label</p><img src = "../art/cc_info_for_exch_label.gif" alt = "The Info window, after setting text and attributes for the exchange rate label" width="285" height="477"></div><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCIFDIHF" title="Figure 5-19The exchange rate label field (selected)"></a><p><strong>Figure 5-19&nbsp;&nbsp;</strong>The exchange rate label field (selected)</p><img src = "../art/cc_final_exch_label.gif" alt = "The exchange rate label field (selected)" width="347" height="226"></div></li><li class="li"><p>Save all the changes you’ve made in Interface Builder—they’re saved to the <code>MainMenu.nib</code> file. You’ll also be given a chance to save your changes if you quit Interface Builder.</p></li><li class="li"><p>To add the text input and label fields for “Dollars to Convert,” you can repeat your previous steps:</p><ol class="ol"><li class="ol ol"><p>Drag a text field into the Currency Converter window, aligning it below the exchange rate text field.</p></li><li class="ol ol"><p>Resize the field.</p></li><li class="ol ol"><p>Set its attributes.</p></li><li class="ol ol"><p>Give it the AppleScript name “amount”.</p></li><li class="ol ol"><p>Add a label field, aligning it below the previous label field.</p></li><li class="ol ol"><p>Label the field “Dollars to Convert:” and right-align it.</p></li></ol><p>Or, you can use Interface Builder’s Duplicate command to duplicate the two already-created text fields, then supply them with new label text and new AppleScript names:</p><ol class="ol"><li class="ol ol"><p>Shift-click or drag to select the two fields you’ve already entered, then choose Duplicate from the File menu or type Command-D.</p></li><li class="ol ol"><p>Drag the duplicated fields, using the automatic guides to align them below the original fields.</p></li><li class="ol ol"><p>Select the new label field and in the Attributes pane of the Info window, type “Dollars to Convert:” in the Title field.</p></li><li class="ol ol"><p>To provide an AppleScript name for the text input field, select the field, open the Info window to the AppleScript pane, and type “amount” in the Name field.</p></li></ol><p><span class="content_text">Figure 5-20</span> shows the results of adding the two new text fields.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCIBBCGC" title="Figure 5-20The Currency Converter window with input fields and labels"></a><p><strong>Figure 5-20&nbsp;&nbsp;</strong>The Currency Converter window with input fields and labels</p><img src = "../art/cc_with_entry_fields.gif" alt = "The Currency Converter window with input fields and labels" width="350" height="228"></div></li></ol><a name="//apple_ref/doc/uid/20001253-BCIHIJAC" title="Add a Result Field and Label"></a><h3>Add a Result Field and Label</h3><p>In this section you’ll add a text field to display the computed total in the new currency. You’ll also add a label field for the conversion result. You’ll get additional tips on aligning fields in <span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-BCICIJDJ">“Finalize the Layout.”</a></span></p><ol class="ol"><li class="li"><p>To add a text field and label for “Amount in Other Currency,” perform these steps:</p><ol class="ol"><li class="ol ol"><p>Shift-click or drag to select the exchange rate label and text input fields, then choose Duplicate from the File menu or type Command-D.</p></li><li class="ol ol"><p>Drag the duplicated fields and align them below the original fields using the guides.</p></li><li class="ol ol"><p>Select the new label field and type “Amount in Other Currency:” in the Title field in the Attributes pane of the Info window.</p></li><li class="ol ol"><p>Select the text input field and type “total” in the Name field in the AppleScript pane of the Info window.</p><p><span class="content_text">Figure 5-21</span> shows the results of adding the additional text fields. The window now contains its final collection of text fields and labels.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCIGAHGE" title="Figure 5-21The Currency Converter window with all text fields and labels"></a><p><strong>Figure 5-21&nbsp;&nbsp;</strong>The Currency Converter window with all text fields and labels</p><img src = "../art/cc_all_fields.gif" alt = "The Currency Converter window with all text fields and labels" width="351" height="229"></div></li></ol></li><li class="li"><p>You don’t want a user to be able to enter text in the “Amount in Other Currency” input field, so you’ll need to disable editing. Select the field, display the Attributes pane in the Info window, and deselect the Editable checkbox in the Options section. <span class="content_text">Figure 5-22</span> shows the result.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCIGAHGG" title="Figure 5-22The Info window, after disabling editing for the amount in other currency field"></a><p><strong>Figure 5-22&nbsp;&nbsp;</strong>The Info window, after disabling editing for the amount in other currency field</p><img src = "../art/cc_info_for_amt_field.gif" alt = "The Info window, after disabling editing for the amount in other currency field" width="284" height="478"></div></li></ol><p>Save your work before moving on to the next section.</p><a name="//apple_ref/doc/uid/20001253-BCIDDJFA" title="Add Number Formatters to the Input and Result Fields"></a><h3>Add Number Formatters to the Input and Result Fields</h3><p>Currency Converter should allow users to input only meaningful values, and it should display a properly formatted result:</p><ul class="spaceabove"><li class="li"><p>the exchange rate input field should accept and display decimal numbers such as 1.55 or 10.24</p></li><li class="li"><p>the dollars to convert input field should display valid dollar amounts, such as $125.20</p></li><li class="li"><p>the amount in other currency field should display the computed total in the appropriate currency to the current locale, such as dollars ($600.10) or yen (¥1700.00)</p></li></ul><p>To format the text in a text field, Interface Builder provides number formatters (based on the Cocoa NSNumberFormatter class). In the Cocoa-Text palette in <span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-TPXREF209">Figure 5-10</a></span>, the number formatter is represented by a dollar sign superimposed on the number 1.99.</p><div class="importantbox"><a name="//apple_ref/doc/uid/20001253-DontLinkElementID_34" title="Important:"></a><p><strong>Important:</strong>&nbsp;When a number formatter is attached to a text field, the contents must be explicitly a number, as shown in <span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-BCIBCFFC">Listing 5-2</a></span>, and not as text.</p><p></p></div><p>To provide number formatters for Currency Converter’s text fields, perform these steps</p><ol class="ol"><li class="li"><p>Select the exchange rate input field in the Currency Converter window.</p></li><li class="li"><p>Open the Info window to the Attributes pane.</p></li><li class="li"><p>Display the Cocoa-Text palette in Interface Builder’s Palette window.</p></li><li class="li"><p>Drag a number formatter from the palette and drop it on the input field, as shown in <span class="content_text">Figure 5-23</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCICGJAA" title="Figure 5-23Adding a number formatter to the exchange rate input field"></a><p><strong>Figure 5-23&nbsp;&nbsp;</strong>Adding a number formatter to the exchange rate input field</p><img src = "../art/cc_add_exch_formatter.gif" alt = "Adding a number formatter to the exchange rate input field" width="349" height="230"></div><p><span class="content_text">Figure 5-24</span> shows Info window for the number formatter. The formatter pane should open automatically when you insert a number formatter into a text field. You can also select the pane from the pop-up menu.</p><p>The default formatter settings are correct for the exchange rate input field, so you don’t need to make any changes.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCIFDCHF" title="Figure 5-24The Formatter pane for the exchange rate input field"></a><p><strong>Figure 5-24&nbsp;&nbsp;</strong>The Formatter pane for the exchange rate input field</p><img src = "../art/cc_info_exch_formatter.gif" alt = "The Formatter pane for the exchange rate input field" width="284" height="477"></div><div class="notebox"><a name="//apple_ref/doc/uid/20001253-DontLinkElementID_35" title="Note"></a><p><strong>Note:</strong>&nbsp;See the Note with <span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-BCIHIEHC">Figure 5-15</a></span> for information on viewing Currency Converter’s MainMenu.nib window in outline view. In outline view, you can examine the application’s object hierarchy, and see each number formatter object and the text field it is associated with.</p></div></li><li class="li"><p>Repeat the previous steps to add a number formatter to the dollars to convert input field. The Info window should again look as in <span class="content_text">Figure 5-24</span>.</p></li><li class="li"><p>Select the second row in the formatter, so that the field includes a dollar sign.</p></li><li class="li"><p>Repeat the previous steps to add a number formatter to the amount in other currency field. The Info window should again look as in <span class="content_text">Figure 5-24</span>. Again, select the first format row that includes a dollar sign.</p></li><li class="li"><p>Because the amount in other currency is likely not to be in dollars, select the Localize checkbox in the Options section. <span class="content_text">Figure 5-25</span> shows the result.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCIGBBAB" title="Figure 5-25The Formatter pane for the amount in other currency field"></a><p><strong>Figure 5-25&nbsp;&nbsp;</strong>The Formatter pane for the amount in other currency field</p><img src = "../art/cc_info_tot_formatter.gif" alt = "The Formatter pane for the amount in other currency field" width="286" height="477"></div></li></ol><p>For more information on number formatters, see Interface Builder Help or the Cocoa documentation for the NSNumberFormatter class.</p><a name="//apple_ref/doc/uid/20001253-BCICAAEA" title="Add a Convert Button"></a><h3>Add a Convert Button</h3><p>To add a Convert button to Currency Converter, perform the following steps:</p><ol class="ol"><li class="li"><p>Drag a button object from the Cocoa-Controls palette in the Palette window to the bottom right corner of the Currency Converter window. Use the automatic feedback to align the right edge of the button with the right edge of the text field above it.</p></li><li class="li"><p>Double-click the button to select its text, then type “Convert”. <span class="content_text">Figure 5-26</span> shows the result.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCIGJCHH" title="Figure 5-26The Currency Converter window with a &acirc;&#128;&#156;Convert&acirc;&#128;&#157; button"></a><p><strong>Figure 5-26&nbsp;&nbsp;</strong>The Currency Converter window with a “Convert” button</p><img src = "../art/cc_convert_button.gif" alt = "The Currency Converter window with a “Convert” button" width="350" height="229"></div></li></ol><a name="//apple_ref/doc/uid/20001253-BCIDIGJC" title="Add a Horizontal Separator"></a><h3>Add a Horizontal Separator</h3><p>To add a horizontal separator to Currency Converter, perform the following steps:</p><ol class="ol"><li class="li"><p>Drag a box object from the Cocoa-Controls palette in the Palette window to the Currency Converter window. The box object looks like a horizontal line. (If you let the cursor rest over the line in the Palette window, Interface Builder displays “NSBox”.)</p><p>Position the box in the lower right of the window, between the convert button and the text field above it, with the right edge near the right edge of the window. Use the automatic feedback to align it.</p></li><li class="li"><p>Drag the left selection handle to resize the separator, using the automatic feedback to stretch it until it almost reaches the left side of the window. <span class="content_text">Figure 5-27</span> shows the result.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCIHCDEJ" title="Figure 5-27The Currency Converter window with a horizontal separator"></a><p><strong>Figure 5-27&nbsp;&nbsp;</strong>The Currency Converter window with a horizontal separator</p><img src = "../art/cc_final_window.gif" alt = "The Currency Converter window with a horizontal separator" width="350" height="229"></div></li></ol><a name="//apple_ref/doc/uid/20001253-BCICIJDJ" title="Finalize the Layout"></a><h3>Finalize the Layout</h3><p>In this tutorial, you have generally positioned user interface objects so that they are aligned with other objects and in accord with the Aqua interface guidelines. However, now that all the user interface objects are in place, you can check the alignment and perform other layout operations.</p><ol class="ol"><li class="li"><p>Click and shift-click to select all three of the label fields.</p></li><li class="li"><p>To resize the fields to their minimum sizes, choose Size to Fit from the Layout menu.</p></li><li class="li"><p>To right align the labels, choose Align Right Edges under Alignment in the Layout menu.</p></li><li class="li"><p>Similarly, select all three non-label text fields.</p></li><li class="li"><p>To make them the same size, choose Same Size from the Layout menu.</p></li><li class="li"><p>To align their left edges, choose Align Left Edges under Alignment in the Layout menu.</p></li><li class="li"><p>To make sure they’re still aligned according to the Aqua guidelines, use the automatic feedback as you drag them to the right edge of the window.</p></li></ol><p>See Interface Builder Help for information on other options in the Layout menu. And remember, you can use these layout options at any time that makes sense.</p><a name="//apple_ref/doc/uid/20001253-BCIIFFIJ" title="Connect the Interface"></a><h2>Connect the Interface</h2><p>The Currency Converter application needs a connection so that when a user clicks the Convert button (or presses the Return key), the application calls a handler in an application script. It also needs a connection so that when a user closes the window, the application quits (the application can’t do anything useful without a window).</p><p>To set up connections for Currency Converter, perform these steps in Interface Builder:</p><ol class="ol"><li class="li"><p>Select the Convert button, then display the Attributes pane in the Info window. <span class="content_text">Figure 5-28</span> shows the row in the middle of the Attributes pane that you use to select a key equivalent for the button.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-TPXREF211" title="Figure 5-28Fields from the Info window for setting keystroke equivalent"></a><p><strong>Figure 5-28&nbsp;&nbsp;</strong>Fields from the Info window for setting keystroke equivalent</p><img src = "../art/key_equiv_before_change.gif" alt = "Fields from the Info window for setting keystroke equivalent" width="297" height="22"></div><p>In the pop-up that says &lt;no key>, choose Return. This causes the Convert button’s action handler (the <code>clicked</code> handler you’ll connect next) to be called when a user presses the Return key. <span class="content_text">Figure 5-29</span> shows the result.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCICIHBH" title="Figure 5-29Fields from the Info window for setting keystroke equivalent"></a><p><strong>Figure 5-29&nbsp;&nbsp;</strong>Fields from the Info window for setting keystroke equivalent</p><img src = "../art/key_equiv_fields.gif" alt = "Fields from the Info window for setting keystroke equivalent" width="290" height="22"></div><p>When you choose the Return key as the keystroke equivalent for a button, you’ve designated that button as the default button in the window. Cocoa automatically colors the button aqua to show it is the default button.</p><p>You can use the checkboxes to the right of the pop-up to include the Option and Command keys as part of the keystroke equivalent, but that isn’t necessary for Currency Converter.</p></li><li class="li"><p>With the Convert button still selected, display the AppleScript pane in the Info window.</p></li><li class="li"><p>Type “convert” for the AppleScript name for the button.</p></li><li class="li"><p>Click the disclosure triangle next to the Action checkbox and select the “clicked” checkbox to indicate the application should have a <code>clicked</code> event handler, called when a user clicks the button.</p></li><li class="li"><p>Check the file <code>Currency Converter.applescript</code> in the Script list to connect the handler. <span class="content_text">Figure 5-30</span> shows the Info window after this step.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-CEGFGAGF" title="Figure 5-30The Info window after connecting a clicked handler to the Convert button"></a><p><strong>Figure 5-30&nbsp;&nbsp;</strong>The Info window after connecting a clicked handler to the Convert button</p><img src = "../art/cc_info_convert.gif" alt = "The Info window after connecting a clicked handler to the Convert button" width="288" height="559"></div></li><li class="li"><p>Save your results. That causes Interface Builder to insert an empty <code>clicked</code> handler in the selected script file. If you click the Edit Script button, Interface Builder also opens the file in an Xcode editor window. You’ll see the code for the <code>clicked</code> handler in the next section. But for now, just save your results and stay in Interface Builder so you can add another handler.</p></li><li class="li"><p>To quit the application when a user closes the Currency Converter window, you’ll need to connect a special handler to the application. <span class="content_text"><a href="studio_cur_converter.html#//apple_ref/doc/uid/20001253-BCIGGGCE">Figure 5-3</a></span> shows the MainMenu.nib window. The File’s Owner instance in that window represents NSApp, a global constant for the application object that serves as the master controller for the application. (The icons in the Instances pane are described in <span class="content_text"><a href="../chapter03/studio_components.html#//apple_ref/doc/uid/20001250-TPXREF161">“Interface Creation.”</a></span>)</p><p>Select the File’s Owner in the nib window and open the Info window to display the AppleScript pane.</p></li><li class="li"><p>Click the disclosure triangle next to the Application checkbox and select the “should quit after last window closed” checkbox. Clicking this checkbox indicates the application should have a corresponding event handler, called when a user closes the last window (the Currency Converter’s only window).</p><p>The dash in the Application checkbox indicates that at least one handler in the group is checked, but not all are.</p></li><li class="li"><p>Select the file <code>Currency Converter.applescript</code> in the Script list to connect the handler. <span class="content_text">Figure 5-31</span> shows the Info window after this step.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001253-BCIFBFCH" title="Figure 5-31The Info window after connecting a handler to the application object"></a><p><strong>Figure 5-31&nbsp;&nbsp;</strong>The Info window after connecting a handler to the application object</p><img src = "../art/cc_info_app.gif" alt = "The Info window after connecting a handler to the application object" width="289" height="557"></div></li></ol><a name="//apple_ref/doc/uid/20001253-BCIJHHAB" title="Write Event Handlers"></a><h2>Write Event Handlers</h2><p>When you connect a handler in Interface Builder and save your changes, Interface Builder inserts a skeleton handler into the specified script in your Xcode project. <span class="content_text">Listing 5-1</span> shows the skeleton <code>clicked</code> handler in the file <code>Currency Converter.applescript</code>. The application calls this handler when a user clicks the Convert button. The parameter <code>theObject</code> is a reference to the button object itself.</p><a name="//apple_ref/doc/uid/20001253-BCIJCGHH" title="Listing 5-1The empty clicked handler"></a><p class="codesample"><strong>Listing 5-1&nbsp;&nbsp;</strong>The empty clicked handler</p><div class="codesample"><table><tr><td scope="row"><pre>on clicked theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    (* Add your script here. *)<span></span></pre></td></tr><tr><td scope="row"><pre>end clicked<span></span></pre></td></tr></table></div><p>In the <code>clicked</code> handler, the Currency Converter application needs to get the exchange rate and the number of dollars to convert, multiply them to determine the total in the new currency, and display that value. It should behave gracefully if the value for either the exchange rate or the number of dollars is missing. (The number formatters you added to the input fields prevent a user from saving erroneous values, such as alphabetic characters.)</p><p><span class="content_text">Listing 5-2</span> shows the completed <code>clicked</code> handler.</p><div class="importantbox"><a name="//apple_ref/doc/uid/20001253-DontLinkElementID_36" title="Important:"></a><p><strong>Important:</strong>&nbsp;You do not have to use a <code>tell application "Currency Converter"</code> statement in an application script because scripts implicitly target the application itself. For that reason, the <code>clicked</code> handler in <span class="content_text">Listing 5-2</span> contains no <code>tell application</code> statement, though it does use a <code>tell window</code> statement to target the window on which it accesses various text fields.</p><p></p></div><a name="//apple_ref/doc/uid/20001253-BCIBCFFC" title="Listing 5-2The complete clicked handler"></a><p class="codesample"><strong>Listing 5-2&nbsp;&nbsp;</strong>The complete clicked handler</p><div class="codesample"><table><tr><td scope="row"><pre>on clicked theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    tell window of theObject<span></span></pre></td></tr><tr><td scope="row"><pre>        try<span></span></pre></td></tr><tr><td scope="row"><pre>            set theRate to contents of text field "rate" as number<span></span></pre></td></tr><tr><td scope="row"><pre>            set theAmount to contents of text field "amount" as number<span></span></pre></td></tr><tr><td scope="row"><pre>            set contents of text field "total" to theRate * theAmount<span></span></pre></td></tr><tr><td scope="row"><pre>        on error<span></span></pre></td></tr><tr><td scope="row"><pre>            set contents of text field "total" to 0<span></span></pre></td></tr><tr><td scope="row"><pre>        end try<span></span></pre></td></tr><tr><td scope="row"><pre>    end tell<span></span></pre></td></tr><tr><td scope="row"><pre>end clicked<span></span></pre></td></tr></table></div><p>The key points of this handler are:</p><ul class="ul"><li class="li"><p>the <code>theObject</code> parameter is a reference to the clicked button object</p></li><li class="li"><p>a button, like other controls, is a view, and a script can get the window of a view</p></li><li class="li"><p>a script can get a reference to any named AppleScript object within a window (it can also refer to items by number—for example, <code>the first text field</code>— or ID, but names are easy to specify, self-documenting, and won’t change dynamically)</p></li><li class="li"><p>the handler shows the syntax for getting and setting the content of text fields; when a number formatter is attached to a text field, the contents must be set explicitly as number, as shown in <span class="content_text">Listing 5-2</span>, and not as text</p></li><li class="li"><p>the actual work performed by the Currency Converter application is quite simple</p></li><li class="li"><p>the handler uses a <code>try</code>, <code>on error</code> block to set the contents of the result field to 0 if an error occurs in calculating the converted value; this protects the user from receiving a possibly confusing error message if they attempt to convert without supplying both an exchange rate and an amount to convert</p></li></ul><p>When you connect a handler in Interface Builder and click the Edit Script button, Interface Builder inserts a skeleton handler into the specified script and opens the script in Xcode. <span class="content_text">Listing 5-3</span> shows the completed <code>should quit after last window closed</code> handler in the file <code>Currency Converter.applescript</code>. This handler is called when a user closes the Currency Converter window. Its one line, supplied by you, returns the value <code>true</code>, indicating the application should, indeed, quit when the last window is closed.</p><a name="//apple_ref/doc/uid/20001253-BCIEHIDB" title="Listing 5-3The should quit after last widow closed handler"></a><p class="codesample"><strong>Listing 5-3&nbsp;&nbsp;</strong>The should quit after last widow closed handler</p><div class="codesample"><table><tr><td scope="row"><pre>on should quit after last window closed theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    return true<span></span></pre></td></tr><tr><td scope="row"><pre>end should quit after last window closed<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/20001253-BCICGEEF" title="Build and Run the Application"></a><h2>Build and Run the Application</h2><p>The Currency Converter application should now be ready to perform conversions, so it’s time to build it again. Use any of the mechanisms described previously to build and run the application:</p><ul class="ul"><li class="li"><p>type Command-R</p></li><li class="li"><p>choose Build and Run from the Build menu</p></li><li class="li"><p>click the Build and Run button (a combined monitor and hammer)</p></li></ul><p><span class="content_text">Figure 5-32</span> shows the application after computing a currency conversion. Because the test computer was set up for U.S. English, the converted amount is shown in dollars, but for another locale it might show yen or pounds.</p><br/><div><a name="//apple_ref/doc/uid/20001253-BCIEHJIF" title="Figure 5-32The Currency Converter application in action"></a><p><strong>Figure 5-32&nbsp;&nbsp;</strong>The Currency Converter application in action</p><img src = "../art/cc_final_window.gif" alt = "The Currency Converter application in action" width="350" height="229"></div><br/><p>For a detailed discussion of building and checking for syntax errors, see <span class="content_text"><a href="../chapter11/studio_ms_build_debug.html#//apple_ref/doc/uid/20001258-TPXREF101">“Mail Search Tutorial: Build and Test the Application.”</a></span></p><a name="//apple_ref/doc/uid/20001253-BCIBJCHD" title="Where To Go From Here"></a><h2>Where To Go From Here</h2><p>Once you have completed the Currency Converter tutorial, you have several options for learning more about AppleScript Studio:</p><ul class="ul"><li class="li"><p>If you haven’t already done so, build and experiment with some of the sample applications described in <span class="content_text"><a href="../chapter02/studio_about_book.html#//apple_ref/doc/uid/20001249-CJBJBFAA">“AppleScript Studio Sample Applications.”</a></span></p></li><li class="li"><p>If you’re ready for a more challenging tutorial, go right to the chapter <span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-TPXREF101">“Mail Search Tutorial: Design the Application.”</a></span></p></li><li class="li"><p>If you want to take it a little slower, try using the information in <span class="content_text"><a href="../chapter12/studio_ms_customize.html#//apple_ref/doc/uid/20001259-TPXREF101">“Chapter 12, Mail Search Tutorial: Customize the Application,”</a></span> to customize the Currency Converter application. Although the customizing chapter refers frequently to Mail Search, the customization steps can be applied to any application.</p></li></ul>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../chapter05/studio_cookbook.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../chapter07/studio_ms_design_app.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2001, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-04-04<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/chapter06/studio_cur_converter.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/chapter06/studio_cur_converter.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/chapter06/studio_cur_converter.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>