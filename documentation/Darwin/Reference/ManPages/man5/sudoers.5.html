<html><head><title>Mac OS X
 Manual Page For sudoers(5)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/5/sudoers" title="Mac OS X
 Manual Page for sudoers(5)"><!-- headerDoc=man; indexgroup=Section 5; uid="//apple_ref/doc/man/5/sudoers"; name=sudoers(5) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
SUDOERS(5)                                  MAINTENANCE COMMANDS                                  SUDOERS(5)



<b>NAME</b>
       sudoers - list of which users may execute what

<b>DESCRIPTION</b>
       The <u>sudoers</u> file is composed of two types of entries: aliases (basically variables) and user specifi-<font color="#ffffff" class="whiteout">cations&nbsp;specifications</font>
       cations (which specify who may run what).

       When multiple entries match for a user, they are applied in order.  Where there are conflicting val-<font color="#ffffff" class="whiteout">ues,&nbsp;values,</font>
       ues, the last match is used (which is not necessarily the most specific match).

       The <u>sudoers</u> grammar will be described below in Extended Backus-Naur Form (EBNF).  Don't despair if
       you don't know what EBNF is; it is fairly simple, and the definitions below are annotated.

       <b>Quick</b> <b>guide</b> <b>to</b> <b>EBNF</b>

       EBNF is a concise and exact way of describing the grammar of a language.  Each EBNF definition is
       made up of <u>production</u> <u>rules</u>.  E.g.,

        symbol ::= definition | alternate1 | alternate2 ...

       Each <u>production</u> <u>rule</u> references others and thus makes up a grammar for the language.  EBNF also con-<font color="#ffffff" class="whiteout">tains&nbsp;contains</font>
       tains the following operators, which many readers will recognize from regular expressions.  Do not,
       however, confuse them with "wildcard" characters, which have different meanings.

       ?       Means that the preceding symbol (or group of symbols) is optional.  That is, it may appear
               once or not at all.

       *       Means that the preceding symbol (or group of symbols) may appear zero or more times.

       +       Means that the preceding symbol (or group of symbols) may appear one or more times.

       Parentheses may be used to group symbols together.  For clarity, we will use single quotes ('') to
       designate what is a verbatim character string (as opposed to a symbol name).

       <b>Aliases</b>

       There are four kinds of aliases: User_Alias, Runas_Alias, Host_Alias and Cmnd_Alias.

        Alias ::= 'User_Alias'  User_Alias (':' User_Alias)* |
                  'Runas_Alias' Runas_Alias (':' Runas_Alias)* |
                  'Host_Alias'  Host_Alias (':' Host_Alias)* |
                  'Cmnd_Alias'  Cmnd_Alias (':' Cmnd_Alias)*

        User_Alias ::= NAME '=' User_List

        Runas_Alias ::= NAME '=' Runas_List

        Host_Alias ::= NAME '=' Host_List

        Cmnd_Alias ::= NAME '=' Cmnd_List

        NAME ::= [A-Z]([A-Z][0-9]_)*

       Each <u>alias</u> definition is of the form

        Alias_Type NAME = item1, item2, ...

       where <u>Alias</u><b>_</b><u>Type</u> is one of User_Alias, Runas_Alias, Host_Alias, or Cmnd_Alias.  A NAME is a string of
       uppercase letters, numbers, and underscore characters ('_').  A NAME <b>must</b> start with an uppercase
       letter.  It is possible to put several alias definitions of the same type on a single line, joined by
       a colon (':').  E.g.,

        Alias_Type NAME = item1, item2, item3 : NAME = item4, item5

       The definitions of what constitutes a valid <u>alias</u> member follow.

        User_List ::= User |
                      User ',' User_List

        User ::= '!'* username |
                 '!'* '%'group |
                 '!'* '+'netgroup |
                 '!'* User_Alias

       A User_List is made up of one or more usernames, system groups (prefixed with '%'), netgroups (pre-<font color="#ffffff" class="whiteout">fixed&nbsp;(prefixed</font>
       fixed with '+') and other aliases.  Each list item may be prefixed with one or more '!' operators.
       An odd number of '!' operators negate the value of the item; an even number just cancel each other
       out.

        Runas_List ::= Runas_User |
                       Runas_User ',' Runas_List

        Runas_User ::= '!'* username |
                       '!'* '#'uid |
                       '!'* '%'group |
                       '!'* +netgroup |
                       '!'* Runas_Alias

       A Runas_List is similar to a User_List except that it can also contain uids (prefixed with '#') and
       instead of User_Aliases it can contain Runas_Aliases.  Note that usernames and groups are matched as
       strings.  In other words, two users (groups) with the same uid (gid) are considered to be distinct.
       If you wish to match all usernames with the same uid (e.g. root and toor), you can use a uid instead
       (#0 in the example given).

        Host_List ::= Host |
                      Host ',' Host_List

        Host ::= '!'* hostname |
                 '!'* ip_addr |
                 '!'* network(/netmask)? |
                 '!'* '+'netgroup |
                 '!'* Host_Alias

       A Host_List is made up of one or more hostnames, IP addresses, network numbers, netgroups (prefixed
       with '+') and other aliases.  Again, the value of an item may be negated with the '!' operator.  If
       you do not specify a netmask with a network number, the netmask of the host's ethernet <!-- a -->interface(s)<!-- /a -->
       will be used when matching.  The netmask may be specified either in dotted quad notation (e.g.
       255.255.255.0) or CIDR notation (number of bits, e.g. 24).  A hostname may include shell-style wild-<font color="#ffffff" class="whiteout">cards&nbsp;wildcards</font>
       cards (see the Wildcards section below), but unless the hostname command on your machine returns the
       fully qualified hostname, you'll need to use the <u>fqdn</u> option for wildcards to be useful.

        Cmnd_List ::= Cmnd |
                      Cmnd ',' Cmnd_List

        commandname ::= filename |
                        filename args |
                        filename '""'

        Cmnd ::= '!'* commandname |
                 '!'* directory |
                 '!'* "sudoedit" |
                 '!'* Cmnd_Alias

       A Cmnd_List is a list of one or more commandnames, directories, and other aliases.  A commandname is
       a fully qualified filename which may include shell-style wildcards (see the Wildcards section below).
       A simple filename allows the user to run the command with any arguments he/she wishes.  However, you
       may also specify command line arguments (including wildcards).  Alternately, you can specify "" to
       indicate that the command may only be run <b>without</b> command line arguments.  A directory is a fully
       qualified pathname ending in a '/'.  When you specify a directory in a Cmnd_List, the user will be
       able to run any file within that directory (but not in any subdirectories therein).

       If a Cmnd has associated command line arguments, then the arguments in the Cmnd must match exactly
       those given by the user on the command line (or match the wildcards if there are any).  Note that the
       following characters must be escaped with a '\' if they are used in command arguments: ',', ':', '=',
       '\'.  The special command "sudoedit" is used to permit a user to run <b>sudo</b> with the <b>-e</b> flag (or as
       <b>sudoedit</b>).  It may take command line arguments just as a normal command does.

       <b>Defaults</b>

       Certain configuration options may be changed from their default values at runtime via one or more
       Default_Entry lines.  These may affect all users on any host, all users on a specific host, a spe-<font color="#ffffff" class="whiteout">cific&nbsp;specific</font>
       cific user, or commands being run as a specific user.

        Default_Type ::= 'Defaults' |
                         'Defaults' '@' Host |
                         'Defaults' ':' User |
                         'Defaults' '&gt;' RunasUser

        Default_Entry ::= Default_Type Parameter_List

        Parameter_List ::= Parameter |
                           Parameter ',' Parameter_List

        Parameter ::= Parameter '=' Value |
                      Parameter '+=' Value |
                      Parameter '-=' Value |
                      '!'* Parameter

       Parameters may be <b>flags</b>, <b>integer</b> values, <b>strings</b>, or <b>lists</b>.  Flags are implicitly boolean and can be
       turned off via the '!'  operator.  Some integer, string and list parameters may also be used in a
       boolean context to disable them.  Values may be enclosed in double quotes (") when they contain mul-<font color="#ffffff" class="whiteout">tiple&nbsp;multiple</font>
       tiple words.  Special characters may be escaped with a backslash (\).

       Lists have two additional assignment operators, += and -=.  These operators are used to add to and
       delete from a list respectively.  It is not an error to use the -= operator to remove an element that
       does not exist in a list.

       <b>Flags</b>:

       long_otp_prompt
                   When validating with a One Time Password scheme (<b>S/Key</b> or <b>OPIE</b>), a two-line prompt is
                   used to make it easier to cut and paste the challenge to a local window.  It's not as
                   pretty as the default but some people find it more convenient.  This flag is <u>off</u> by
                   default.

       ignore_dot  If set, <b>sudo</b> will ignore '.' or '' (current dir) in the PATH environment variable; the
                   PATH itself is not modified.  This flag is <u>off</u> by default.  Currently, while it is possi-<font color="#ffffff" class="whiteout">ble&nbsp;possible</font>
                   ble to set <u>ignore</u><b>_</b><u>dot</u> in <u>sudoers</u>, its value is not used.  This option should be consid-<font color="#ffffff" class="whiteout">ered&nbsp;considered</font>
                   ered read-only (it will be fixed in a future version of <b>sudo</b>).

       mail_always Send mail to the <u>mailto</u> user every time a users runs <b>sudo</b>.  This flag is <u>off</u> by default.

       mail_badpass
                   Send mail to the <u>mailto</u> user if the user running sudo does not enter the correct pass-<font color="#ffffff" class="whiteout">word.&nbsp;password.</font>
                   word.  This flag is <u>off</u> by default.

       mail_no_user
                   If set, mail will be sent to the <u>mailto</u> user if the invoking user is not in the <u>sudoers</u>
                   file.  This flag is <u>on</u> by default.

       mail_no_host
                   If set, mail will be sent to the <u>mailto</u> user if the invoking user exists in the <u>sudoers</u>
                   file, but is not allowed to run commands on the current host.  This flag is <u>off</u> by
                   default.

       mail_no_perms
                   If set, mail will be sent to the <u>mailto</u> user if the invoking user is allowed to use <b>sudo</b>
                   but the command they are trying is not listed in their <u>sudoers</u> file entry or is explic-<font color="#ffffff" class="whiteout">itly&nbsp;explicitly</font>
                   itly denied.  This flag is <u>off</u> by default.

       tty_tickets If set, users must authenticate on a per-tty basis.  Normally, <b>sudo</b> uses a directory in
                   the ticket dir with the same name as the user running it.  With this flag enabled, <b>sudo</b>
                   will use a file named for the tty the user is logged in on in that directory.  This flag
                   is <u>off</u> by default.

       authenticate
                   If set, users must authenticate themselves via a password (or other means of authentica-<font color="#ffffff" class="whiteout">tion)&nbsp;authentication)</font>
                   tion) before they may run commands.  This default may be overridden via the PASSWD and
                   NOPASSWD tags.  This flag is <u>on</u> by default.

       root_sudo   If set, root is allowed to run <b>sudo</b> too.  Disabling this prevents users from "chaining"
                   <b>sudo</b> commands to get a root shell by doing something like "sudo sudo /bin/sh".  Note,
                   however, that turning off <u>root</u><b>_</b><u>sudo</u> will also prevent root and from running <b>sudoedit</b>.
                   Disabling <u>root</u><b>_</b><u>sudo</u> provides no real additional security; it exists purely for historical
                   reasons.  This flag is <u>on</u> by default.

       log_host    If set, the hostname will be logged in the (non-syslog) <b>sudo</b> log file.  This flag is <u>off</u>
                   by default.

       log_year    If set, the four-digit year will be logged in the (non-syslog) <b>sudo</b> log file.  This flag
                   is <u>off</u> by default.

       shell_noargs
                   If set and <b>sudo</b> is invoked with no arguments it acts as if the <b>-s</b> flag had been given.
                   That is, it runs a shell as root (the shell is determined by the SHELL environment vari-<font color="#ffffff" class="whiteout">able&nbsp;variable</font>
                   able if it is set, falling back on the shell listed in the invoking user's /etc/passwd
                   entry if not).  This flag is <u>off</u> by default.

       set_home    If set and <b>sudo</b> is invoked with the <b>-s</b> flag the HOME environment variable will be set to
                   the home directory of the target user (which is root unless the <b>-u</b> option is used).  This
                   effectively makes the <b>-s</b> flag imply <b>-H</b>.  This flag is <u>off</u> by default.

       always_set_home
                   If set, <b>sudo</b> will set the HOME environment variable to the home directory of the target
                   user (which is root unless the <b>-u</b> option is used).  This effectively means that the <b>-H</b>
                   flag is always implied.  This flag is <u>off</u> by default.

       path_info   Normally, <b>sudo</b> will tell the user when a command could not be found in their PATH envi-<font color="#ffffff" class="whiteout">ronment&nbsp;environment</font>
                   ronment variable.  Some sites may wish to disable this as it could be used to gather
                   information on the location of executables that the normal user does not have access to.
                   The disadvantage is that if the executable is simply not in the user's PATH, <b>sudo</b> will
                   tell the user that they are not allowed to run it, which can be confusing.  This flag is
                   <u>off</u> by default.

       preserve_groups
                   By default <b>sudo</b> will initialize the group vector to the list of groups the target user is
                   in.  When <u>preserve</u><b>_</b><u>groups</u> is set, the user's existing group vector is left unaltered.
                   The real and effective group IDs, however, are still set to match the target user.  This
                   flag is <u>off</u> by default.

       fqdn        Set this flag if you want to put fully qualified hostnames in the <u>sudoers</u> file.  I.e.,
                   instead of myhost you would use myhost.mydomain.edu.  You may still use the short form if
                   you wish (and even mix the two).  Beware that turning on <u>fqdn</u> requires <b>sudo</b> to make DNS
                   lookups which may make <b>sudo</b> unusable if DNS stops working (for example if the machine is
                   not plugged into the network).  Also note that you must use the host's official name as
                   DNS knows it.  That is, you may not use a host alias (CNAME entry) due to performance
                   issues and the fact that there is no way to get all aliases from DNS.  If your machine's
                   hostname (as returned by the hostname command) is already fully qualified you shouldn't
                   need to set <u>fqdn</u>.  This flag is <u>off</u> by default.

       insults     If set, <b>sudo</b> will insult users when they enter an incorrect password.  This flag is <u>off</u>
                   by default.

       requiretty  If set, <b>sudo</b> will only run when the user is logged in to a real tty.  This will disallow
                   things like "rsh somehost sudo ls" since <a href="../man1/rsh.1.html#//apple_ref/doc/man/1/rsh"><u>rsh</u>(1)</a> does not allocate a tty.  Because it is
                   not possible to turn off echo when there is no tty present, some sites may wish to set
                   this flag to prevent a user from entering a visible password.  This flag is <u>off</u> by
                   default.

       env_editor  If set, <b>visudo</b> will use the value of the EDITOR or VISUAL environment variables before
                   falling back on the default editor list.  Note that this may create a security hole as it
                   allows the user to run any arbitrary command as root without logging.  A safer alterna-<font color="#ffffff" class="whiteout">tive&nbsp;alternative</font>
                   tive is to place a colon-separated list of editors in the editor variable.  <b>visudo</b> will
                   then only use the EDITOR or VISUAL if they match a value specified in editor.  This flag
                   is on by default.

       rootpw      If set, <b>sudo</b> will prompt for the root password instead of the password of the invoking
                   user.  This flag is <u>off</u> by default.

       runaspw     If set, <b>sudo</b> will prompt for the password of the user defined by the <u>runas</u><b>_</b><u>default</u> option
                   (defaults to root) instead of the password of the invoking user.  This flag is <u>off</u> by
                   default.

       targetpw    If set, <b>sudo</b> will prompt for the password of the user specified by the <b>-u</b> flag (defaults
                   to root) instead of the password of the invoking user.  Note that this precludes the use
                   of a uid not listed in the passwd database as an argument to the <b>-u</b> flag.  This flag is
                   <u>off</u> by default.

       set_logname Normally, <b>sudo</b> will set the LOGNAME and USER environment variables to the name of the
                   target user (usually root unless the <b>-u</b> flag is given).  However, since some programs
                   (including the RCS revision control system) use LOGNAME to determine the real identity of
                   the user, it may be desirable to change this behavior.  This can be done by negating the
                   set_logname option.

       stay_setuid Normally, when <b>sudo</b> executes a command the real and effective UIDs are set to the target
                   user (root by default).  This option changes that behavior such that the real UID is left
                   as the invoking user's UID.  In other words, this makes <b>sudo</b> act as a setuid wrapper.
                   This can be useful on systems that disable some potentially dangerous functionality when
                   a program is run setuid.  Note, however, that this means that sudo will run with the real
                   uid of the invoking user which may allow that user to kill <b>sudo</b> before it can log a fail-<font color="#ffffff" class="whiteout">ure,&nbsp;failure,</font>
                   ure, depending on how your OS defines the interaction between signals and setuid pro-<font color="#ffffff" class="whiteout">cesses.&nbsp;processes.</font>
                   cesses.

       env_reset   If set, <b>sudo</b> will reset the environment to only contain the following variables: HOME,
                   LOGNAME, PATH, SHELL, TERM, and USER (in addition to the SUDO_* variables).  Of these,
                   only TERM is copied unaltered from the old environment.  The other variables are set to
                   default values (possibly modified by the value of the <u>set</u><b>_</b><u>logname</u> option).  If <b>sudo</b> was
                   compiled with the SECURE_PATH option, its value will be used for the PATH environment
                   variable.  Other variables may be preserved with the <u>env</u><b>_</b><u>keep</u> option.

       use_loginclass
                   If set, <b>sudo</b> will apply the defaults specified for the target user's login class if one
                   exists.  Only available if <b>sudo</b> is configured with the --with-logincap option.  This flag
                   is <u>off</u> by default.

       noexec      If set, all commands run via sudo will behave as if the NOEXEC tag has been set, unless
                   overridden by a EXEC tag.  See the description of <u>NOEXEC</u> <u>and</u> <u>EXEC</u> below as well as the
                   "PREVENTING SHELL ESCAPES" section at the end of this manual.  This flag is <u>off</u> by
                   default.

       ignore_local_sudoers
                   If set via LDAP, parsing of @sysconfdir@/sudoers will be skipped.  This is intended for
                   an Enterprises that wish to prevent the usage of local sudoers files so that only LDAP is
                   used.  This thwarts the efforts of rogue operators who would attempt to add roles to
                   @sysconfdir@/sudoers.  When this option is present, @sysconfdir@/sudoers does not even
                   need to exist.  Since this options tells sudo how to behave when no specific LDAP entries
                   have been matched, this sudoOption is only meaningful for the cn=defaults section.  This
                   flag is <u>off</u> by default.

       <b>Integers</b>:

       passwd_tries
                   The number of tries a user gets to enter his/her password before <b>sudo</b> logs the failure
                   and exits.  The default is 3.

       <b>Integers</b> <b>that</b> <b>can</b> <b>be</b> <b>used</b> <b>in</b> <b>a</b> <b>boolean</b> <b>context</b>:

       loglinelen  Number of characters per line for the file log.  This value is used to decide when to
                   wrap lines for nicer log files.  This has no effect on the syslog log file, only the file
                   log.  The default is 80 (use 0 or negate the option to disable word wrap).

       timestamp_timeout
                   Number of minutes that can elapse before <b>sudo</b> will ask for a passwd again.  The default
                   is 5.  Set this to 0 to always prompt for a password.  If set to a value less than 0 the
                   user's timestamp will never expire.  This can be used to allow users to create or delete
                   their own timestamps via sudo -v and sudo -k respectively.

       passwd_timeout
                   Number of minutes before the <b>sudo</b> password prompt times out.  The default is 0, set this
                   to 0 for no password timeout.

       umask       Umask to use when running the command.  Negate this option or set it to 0777 to preserve
                   the user's umask.  The default is 0022.

       <b>Strings</b>:

       mailsub     Subject of the mail sent to the <u>mailto</u> user. The escape %h will expand to the hostname of
                   the machine.  Default is *** SECURITY information for %h ***.

       badpass_message
                   Message that is displayed if a user enters an incorrect password.  The default is Sorry,
                   try again. unless insults are enabled.

       timestampdir
                   The directory in which <b>sudo</b> stores its timestamp files.  The default is <u>/var/db/sudo</u>.

       timestampowner
                   The owner of the timestamp directory and the timestamps stored therein.  The default is
                   root.

       passprompt  The default prompt to use when asking for a password; can be overridden via the <b>-p</b> option
                   or the SUDO_PROMPT environment variable.  The following percent (`%') escapes are sup-<font color="#ffffff" class="whiteout">ported:&nbsp;supported:</font>
                   ported:

                   %u      expanded to the invoking user's login name

                   %U      expanded to the login name of the user the command will be run as (defaults to
                           root)

                   %h      expanded to the local hostname without the domain name

                   %H      expanded to the local hostname including the domain name (on if the machine's
                           hostname is fully qualified or the <u>fqdn</u> option is set)

                   %%      two consecutive % characters are collaped into a single % character

                   The default value is Password:.

       runas_default
                   The default user to run commands as if the <b>-u</b> flag is not specified on the command line.
                   This defaults to root.  Note that if <u>runas</u><b>_</b><u>default</u> is set it <b>must</b> occur before any
                   Runas_Alias specifications.

       syslog_goodpri
                   Syslog priority to use when user authenticates successfully.  Defaults to notice.

       syslog_badpri
                   Syslog priority to use when user authenticates unsuccessfully.  Defaults to alert.

       editor      A colon (':') separated list of editors allowed to be used with <b>visudo</b>.  <b>visudo</b> will
                   choose the editor that matches the user's USER environment variable if possible, or the
                   first editor in the list that exists and is executable.  The default is the path to vi on
                   your system.

       noexec_file Path to a shared library containing dummy versions of the <u>execv()</u>, <u>execve()</u> and <u>fexecve()</u>
                   library functions that just return an error.  This is used to implement the <u>noexec</u> func-<font color="#ffffff" class="whiteout">tionality&nbsp;functionality</font>
                   tionality on systems that support LD_PRELOAD or its equivalent.  Defaults to .

       <b>Strings</b> <b>that</b> <b>can</b> <b>be</b> <b>used</b> <b>in</b> <b>a</b> <b>boolean</b> <b>context</b>:

       lecture     This option controls when a short lecture will be printed along with the password prompt.
                   It has the following possible values:

                   never   Never lecture the user.

                   once    Only lecture the user the first time they run <b>sudo</b>.

                   always  Always lecture the user.

                   If no value is specified, a value of <u>once</u> is implied.  Negating the option results in a
                   value of <u>never</u> being used.  The default value is <u>once</u>.

       lecture_file
                   Path to a file containing an alternate sudo lecture that will be used in place of the
                   standard lecture if the named file exists.

       logfile     Path to the <b>sudo</b> log file (not the syslog log file).  Setting a path turns on logging to
                   a file; negating this option turns it off.

       syslog      Syslog facility if syslog is being used for logging (negate to disable syslog logging).
                   Defaults to local2.

       mailerpath  Path to mail program used to send warning mail.  Defaults to the path to sendmail found
                   at configure time.

       mailerflags Flags to use when invoking mailer. Defaults to <b>-t</b>.

       mailto      Address to send warning and error mail to.  The address should be enclosed in double
                   quotes (") to protect against sudo interpreting the @ sign.  Defaults to root.

       exempt_group
                   Users in this group are exempt from password and PATH requirements.  This is not set by
                   default.

       verifypw    This option controls when a password will be required when a user runs <b>sudo</b> with the <b>-v</b>
                   flag.  It has the following possible values:

                   all     All the user's <u>sudoers</u> entries for the current host must have the NOPASSWD flag
                           set to avoid entering a password.

                   any     At least one of the user's <u>sudoers</u> entries for the current host must have the
                           NOPASSWD flag set to avoid entering a password.

                   never   The user need never enter a password to use the <b>-v</b> flag.

                   always  The user must always enter a password to use the <b>-v</b> flag.

                   If no value is specified, a value of <u>all</u> is implied.  Negating the option results in a
                   value of <u>never</u> being used.  The default value is <u>all</u>.

       listpw      This option controls when a password will be required when a user runs <b>sudo</b> with the <b>-l</b>
                   flag.  It has the following possible values:

                   all     All the user's <u>sudoers</u> entries for the current host must have the NOPASSWD flag
                           set to avoid entering a password.

                   any     At least one of the user's <u>sudoers</u> entries for the current host must have the
                           NOPASSWD flag set to avoid entering a password.

                   never   The user need never enter a password to use the <b>-l</b> flag.

                   always  The user must always enter a password to use the <b>-l</b> flag.

                   If no value is specified, a value of <u>any</u> is implied.  Negating the option results in a
                   value of <u>never</u> being used.  The default value is <u>any</u>.

       <b>Lists</b> <b>that</b> <b>can</b> <b>be</b> <b>used</b> <b>in</b> <b>a</b> <b>boolean</b> <b>context</b>:

       env_check   Environment variables to be removed from the user's environment if the variable's value
                   contains % or / characters.  This can be used to guard against printf-style format vul-<font color="#ffffff" class="whiteout">nerabilities&nbsp;vulnerabilities</font>
                   nerabilities in poorly-written programs.  The argument may be a double-quoted, space-sep-<font color="#ffffff" class="whiteout">arated&nbsp;space-separated</font>
                   arated list or a single value without double-quotes.  The list can be replaced, added to,
                   deleted from, or disabled by using the =, +=, -=, and ! operators respectively.  The
                   default list of environment variables to check is printed when <b>sudo</b> is run by root with
                   the <u>-V</u> option.

       env_delete  Environment variables to be removed from the user's environment.  The argument may be a
                   double-quoted, space-separated list or a single value without double-quotes.  The list
                   can be replaced, added to, deleted from, or disabled by using the =, +=, -=, and ! opera-<font color="#ffffff" class="whiteout">tors&nbsp;operators</font>
                   tors respectively.  The default list of environment variables to remove is printed when
                   <b>sudo</b> is run by root with the <u>-V</u> option.  Note that many operating systems will remove
                   potentially dangerous variables from the environment of any setuid process (such as
                   <b>sudo</b>).

       env_keep    Environment variables to be preserved in the user's environment when the <u>env</u><b>_</b><u>reset</u> option
                   is in effect.  This allows fine-grained control over the environment <b>sudo</b>-spawned pro-<font color="#ffffff" class="whiteout">cesses&nbsp;processes</font>
                   cesses will receive.  The argument may be a double-quoted, space-separated list or a sin-<font color="#ffffff" class="whiteout">gle&nbsp;single</font>
                   gle value without double-quotes.  The list can be replaced, added to, deleted from, or
                   disabled by using the =, +=, -=, and ! operators respectively.  This list has no default
                   members.

       When logging via <a href="../man3/syslog.3.html#//apple_ref/doc/man/3/syslog"><u>syslog</u>(3)</a>, <b>sudo</b> accepts the following values for the syslog facility (the value of
       the <b>syslog</b> Parameter): <b>authpriv</b> (if your OS supports it), <b>auth</b>, <b>daemon</b>, <b>user</b>, <b>local0</b>, <b>local1</b>, <b>local2</b>,
       <b>local3</b>, <b>local4</b>, <b>local5</b>, <b>local6</b>, and <b>local7</b>.  The following syslog priorities are supported: <b>alert</b>,
       <b>crit</b>, <b>debug</b>, <b>emerg</b>, <b>err</b>, <b>info</b>, <b>notice</b>, and <b>warning</b>.

       <b>User</b> <b>Specification</b>

        User_Spec ::= User_List Host_List '=' Cmnd_Spec_List \
                      (':' Host_List '=' Cmnd_Spec_List)*

        Cmnd_Spec_List ::= Cmnd_Spec |
                           Cmnd_Spec ',' Cmnd_Spec_List

        Cmnd_Spec ::= Runas_Spec? Tag_Spec* Cmnd

        Runas_Spec ::= '(' Runas_List ')'

        Tag_Spec ::= ('NOPASSWD:' | 'PASSWD:' | 'NOEXEC:' | 'EXEC:')

       A <b>user</b> <b>specification</b> determines which commands a user may run (and as what user) on specified hosts.
       By default, commands are run as <b>root</b>, but this can be changed on a per-command basis.

       Let's break that down into its constituent parts:

       <b>Runas_Spec</b>

       A Runas_Spec is simply a Runas_List (as defined above) enclosed in a set of parentheses.  If you do
       not specify a Runas_Spec in the user specification, a default Runas_Spec of <b>root</b> will be used.  A
       Runas_Spec sets the default for commands that follow it.  What this means is that for the entry:

        dgb    boulder = (operator) /bin/ls, /bin/kill, /usr/bin/lprm

       The user <b>dgb</b> may run <u>/bin/ls</u>, <u>/bin/kill</u>, and <u>/usr/bin/lprm</u> -- but only as <b>operator</b>.  E.g.,

        $ sudo -u operator /bin/ls.

       It is also possible to override a Runas_Spec later on in an entry.  If we modify the entry like so:

        dgb    boulder = (operator) /bin/ls, (root) /bin/kill, /usr/bin/lprm

       Then user <b>dgb</b> is now allowed to run <u>/bin/ls</u> as <b>operator</b>, but  <u>/bin/kill</u> and <u>/usr/bin/lprm</u> as <b>root</b>.

       <b>Tag_Spec</b>

       A command may have zero or more tags associated with it.  There are four possible tag values,
       NOPASSWD, PASSWD, NOEXEC, EXEC.  Once a tag is set on a Cmnd, subsequent Cmnds in the Cmnd_Spec_List,
       inherit the tag unless it is overridden by the opposite tag (ie: PASSWD overrides NOPASSWD and EXEC
       overrides NOEXEC).

       <u>NOPASSWD</u> <u>and</u> <u>PASSWD</u>

       By default, <b>sudo</b> requires that a user authenticate him or herself before running a command.  This
       behavior can be modified via the NOPASSWD tag.  Like a Runas_Spec, the NOPASSWD tag sets a default
       for the commands that follow it in the Cmnd_Spec_List.  Conversely, the PASSWD tag can be used to
       reverse things.  For example:

        ray    rushmore = NOPASSWD: /bin/kill, /bin/ls, /usr/bin/lprm

       would allow the user <b>ray</b> to run <u>/bin/kill</u>, <u>/bin/ls</u>, and <u>/usr/bin/lprm</u> as root on the machine rushmore
       as <b>root</b> without authenticating himself.  If we only want <b>ray</b> to be able to run <u>/bin/kill</u> without a
       password the entry would be:

        ray    rushmore = NOPASSWD: /bin/kill, PASSWD: /bin/ls, /usr/bin/lprm

       Note, however, that the PASSWD tag has no effect on users who are in the group specified by the
       exempt_group option.

       By default, if the NOPASSWD tag is applied to any of the entries for a user on the current host, he
       or she will be able to run sudo -l without a password.  Additionally, a user may only run sudo -v
       without a password if the NOPASSWD tag is present for all a user's entries that pertain to the cur-<font color="#ffffff" class="whiteout">rent&nbsp;current</font>
       rent host.  This behavior may be overridden via the verifypw and listpw options.

       <u>NOEXEC</u> <u>and</u> <u>EXEC</u>

       If sudo has been compiled with <u>noexec</u> support and the underlying operating system support it, the
       NOEXEC tag can be used to prevent a dynamically-linked executable from running further commands
       itself.

       In the following example, user <b>aaron</b> may run <u>/usr/bin/more</u> and <u>/usr/bin/vi</u> but shell escapes will be
       disabled.

        aaron  shanty = NOEXEC: /usr/bin/more, /usr/bin/vi

       See the "PREVENTING SHELL ESCAPES" section below for more details on how <u>noexec</u> works and whether or
       not it will work on your system.

       <b>Wildcards</b>

       <b>sudo</b> allows shell-style <u>wildcards</u> (aka meta or glob characters) to be used in pathnames as well as
       command line arguments in the <u>sudoers</u> file.  Wildcard matching is done via the <b>POSIX</b> <a href="../man3/fnmatch.3.html#//apple_ref/doc/man/3/fnmatch"><u>fnmatch</u>(3)</a> rou-<font color="#ffffff" class="whiteout">tine.&nbsp;routine.</font>
       tine.  Note that these are <u>not</u> regular expressions.

       *       Matches any set of zero or more characters.

       ?       Matches any single character.

       [...]   Matches any character in the specified range.

       [!...]  Matches any character <b>not</b> in the specified range.

       \x      For any character "x", evaluates to "x".  This is used to escape special characters such as:
               "*", "?", "[", and "}".

       Note that a forward slash ('/') will <b>not</b> be matched by wildcards used in the pathname.  When matching
       the command line arguments, however, a slash <b>does</b> get matched by wildcards.  This is to make a path
       like:

           /usr/bin/*

       match <u>/usr/bin/who</u> but not <u>/usr/bin/X11/xterm</u>.

       WARNING: a pathname with wildcards will <b>not</b> match a user command that consists of a relative path.
       In other words, given the following <u>sudoers</u> entry:

           billy  workstation = /usr/bin/*

       user billy will be able to run any command in /usr/bin as root, such as <u>/usr/bin/w</u>.  The following
       two command will be allowed (the first assumes that <u>/usr/bin</u> is in the user's path):

           $ sudo w
           $ sudo /usr/bin/w

       However, this will not:

           $ cd /usr/bin
           $ sudo ./w

       For this reason you should only <b>grant</b> access to commands using wildcards and never <b>restrict</b> access
       using them.  This limitation will be removed in a future version of <b>sudo</b>.

       <b>Exceptions</b> <b>to</b> <b>wildcard</b> <b>rules</b>

       The following exceptions apply to the above rules:

       ""      If the empty string "" is the only command line argument in the <u>sudoers</u> entry it means that
               command is not allowed to be run with <b>any</b> arguments.

       <b>Other</b> <b>special</b> <b>characters</b> <b>and</b> <b>reserved</b> <b>words</b>

       The pound sign ('#') is used to indicate a comment (unless it occurs in the context of a user name
       and is followed by one or more digits, in which case it is treated as a uid).  Both the comment char-<font color="#ffffff" class="whiteout">acter&nbsp;character</font>
       acter and any text after it, up to the end of the line, are ignored.

       The reserved word <b>ALL</b> is a built-in <u>alias</u> that always causes a match to succeed.  It can be used
       wherever one might otherwise use a Cmnd_Alias, User_Alias, Runas_Alias, or Host_Alias.  You should
       not try to define your own <u>alias</u> called <b>ALL</b> as the built-in alias will be used in preference to your
       own.  Please note that using <b>ALL</b> can be dangerous since in a command context, it allows the user to
       run <b>any</b> command on the system.

       An exclamation point ('!') can be used as a logical <u>not</u> operator both in an <u>alias</u> and in front of a
       Cmnd.  This allows one to exclude certain values.  Note, however, that using a ! in conjunction with
       the built-in ALL alias to allow a user to run "all but a few" commands rarely works as intended (see
       SECURITY NOTES below).

       Long lines can be continued with a backslash ('\') as the last character on the line.

       Whitespace between elements in a list as well as special syntactic characters in a <u>User</u> <u>Specification</u>
       ('=', ':', '(', ')') is optional.

       The following characters must be escaped with a backslash ('\') when used as part of a word (e.g. a
       username or hostname): '@', '!', '=', ':', ',', '(', ')', '\'.

<b>FILES</b>
        /private/etc/sudoers           List of who can run what
        /etc/group             Local groups file
        /etc/netgroup          List of network groups

<b>EXAMPLES</b>
       Since the <u>sudoers</u> file is parsed in a single pass, order is important.  In general, you should struc-<font color="#ffffff" class="whiteout">ture&nbsp;structure</font>
       ture <u>sudoers</u> such that the Host_Alias, User_Alias, and Cmnd_Alias specifications come first, followed
       by any Default_Entry lines, and finally the Runas_Alias and user specifications.  The basic rule of
       thumb is you cannot reference an Alias that has not already been defined.

       Below are example <u>sudoers</u> entries.  Admittedly, some of these are a bit contrived.  First, we define
       our <u>aliases</u>:

        # User alias specification
        User_Alias     FULLTIMERS = millert, mikef, dowdy
        User_Alias     PARTTIMERS = bostley, jwfox, crawl
        User_Alias     WEBMASTERS = will, wendy, wim

        # Runas alias specification
        Runas_Alias    OP = root, operator
        Runas_Alias    DB = oracle, sybase

        # Host alias specification
        Host_Alias     SPARC = bigtime, eclipse, moet, anchor :\
                       SGI = grolsch, dandelion, black :\
                       ALPHA = widget, thalamus, foobar :\
                       HPPA = boa, nag, python
        Host_Alias     CUNETS = 128.138.0.0/255.255.0.0
        Host_Alias     CSNETS = 128.138.243.0, 128.138.204.0/24, 128.138.242.0
        Host_Alias     SERVERS = master, mail, www, ns
        Host_Alias     CDROM = orion, perseus, hercules

        # Cmnd alias specification
        Cmnd_Alias     DUMPS = /usr/bin/mt, /usr/sbin/dump, /usr/sbin/rdump,\
                               /usr/sbin/restore, /usr/sbin/rrestore
        Cmnd_Alias     KILL = /usr/bin/kill
        Cmnd_Alias     PRINTING = /usr/sbin/lpc, /usr/bin/lprm
        Cmnd_Alias     SHUTDOWN = /usr/sbin/shutdown
        Cmnd_Alias     HALT = /usr/sbin/halt
        Cmnd_Alias     REBOOT = /usr/sbin/reboot
        Cmnd_Alias     SHELLS = /usr/bin/sh, /usr/bin/csh, /usr/bin/ksh, \
                                /usr/local/bin/tcsh, /usr/bin/rsh, \
                                /usr/local/bin/zsh
        Cmnd_Alias     SU = /usr/bin/su

       Here we override some of the compiled in default values.  We want <b>sudo</b> to log via <a href="../man3/syslog.3.html#//apple_ref/doc/man/3/syslog"><u>syslog</u>(3)</a> using the
       <u>auth</u> facility in all cases.  We don't want to subject the full time staff to the <b>sudo</b> lecture, user
       <b>millert</b> need not give a password, and we don't want to reset the LOGNAME or USER environment vari-<font color="#ffffff" class="whiteout">ables&nbsp;variables</font>
       ables when running commands as root.  Additionally, on the machines in the <u>SERVERS</u> Host_Alias, we
       keep an additional local log file and make sure we log the year in each log line since the log
       entries will be kept around for several years.

        # Override built-in defaults
        Defaults               syslog=auth
        Defaults&gt;root          !set_logname
        Defaults:FULLTIMERS    !lecture
        Defaults:millert       !authenticate
        Defaults@SERVERS       log_year, logfile=/var/log/sudo.log

       The <u>User</u> <u>specification</u> is the part that actually determines who may run what.

        root           ALL = (ALL) ALL
        %wheel         ALL = (ALL) ALL

       We let <b>root</b> and any user in group <b>wheel</b> run any command on any host as any user.

        FULLTIMERS     ALL = NOPASSWD: ALL

       Full time sysadmins (<b>millert</b>, <b>mikef</b>, and <b>dowdy</b>) may run any command on any host without authenticat-<font color="#ffffff" class="whiteout">ing&nbsp;authenticating</font>
       ing themselves.

        PARTTIMERS     ALL = ALL

       Part time sysadmins (<b>bostley</b>, <b>jwfox</b>, and <b>crawl</b>) may run any command on any host but they must authen-<font color="#ffffff" class="whiteout">ticate&nbsp;authenticate</font>
       ticate themselves first (since the entry lacks the NOPASSWD tag).

        jack           CSNETS = ALL

       The user <b>jack</b> may run any command on the machines in the <u>CSNETS</u> alias (the networks 128.138.243.0,
       128.138.204.0, and 128.138.242.0).  Of those networks, only 128.138.204.0 has an explicit netmask (in
       CIDR notation) indicating it is a class C network.  For the other networks in <u>CSNETS</u>, the local
       machine's netmask will be used during matching.

        lisa           CUNETS = ALL

       The user <b>lisa</b> may run any command on any host in the <u>CUNETS</u> alias (the class B network 128.138.0.0).

        operator       ALL = DUMPS, KILL, SHUTDOWN, HALT, REBOOT, PRINTING,\
                       sudoedit /etc/printcap, /usr/oper/bin/

       The <b>operator</b> user may run commands limited to simple maintenance.  Here, those are commands related
       to backups, killing processes, the printing system, shutting down the system, and any commands in the
       directory <u>/usr/oper/bin/</u>.

        joe            ALL = /usr/bin/su operator

       The user <b>joe</b> may only <a href="../man1/su.1.html#//apple_ref/doc/man/1/su"><u>su</u>(1)</a> to operator.

        pete           HPPA = /usr/bin/passwd [A-z]*, !/usr/bin/passwd root

       The user <b>pete</b> is allowed to change anyone's password except for root on the <u>HPPA</u> machines.  Note that
       this assumes <a href="../man1/passwd.1ssl.html#//apple_ref/doc/man/1/passwd"><u>passwd</u>(1)</a> does not take multiple usernames on the command line.

        bob            SPARC = (OP) ALL : SGI = (OP) ALL

       The user <b>bob</b> may run anything on the <u>SPARC</u> and <u>SGI</u> machines as any user listed in the <u>OP</u> Runas_Alias
       (<b>root</b> and <b>operator</b>).

        jim            +biglab = ALL

       The user <b>jim</b> may run any command on machines in the <u>biglab</u> netgroup.  <b>Sudo</b> knows that "biglab" is a
       netgroup due to the '+' prefix.

        +secretaries   ALL = PRINTING, /usr/bin/adduser, /usr/bin/rmuser

       Users in the <b>secretaries</b> netgroup need to help manage the printers as well as add and remove users,
       so they are allowed to run those commands on all machines.

        fred           ALL = (DB) NOPASSWD: ALL

       The user <b>fred</b> can run commands as any user in the <u>DB</u> Runas_Alias (<b>oracle</b> or <b>sybase</b>) without giving a
       password.

        john           ALPHA = /usr/bin/su [!-]*, !/usr/bin/su *root*

       On the <u>ALPHA</u> machines, user <b>john</b> may su to anyone except root but he is not allowed to give <a href="../man1/su.1.html#//apple_ref/doc/man/1/su"><u>su</u>(1)</a> any
       flags.

        jen            ALL, !SERVERS = ALL

       The user <b>jen</b> may run any command on any machine except for those in the <u>SERVERS</u> Host_Alias (master,
       mail, www and ns).

        jill           SERVERS = /usr/bin/, !SU, !SHELLS

       For any machine in the <u>SERVERS</u> Host_Alias, <b>jill</b> may run any commands in the directory /usr/bin/
       except for those commands belonging to the <u>SU</u> and <u>SHELLS</u> Cmnd_Aliases.

        steve          CSNETS = (operator) /usr/local/op_commands/

       The user <b>steve</b> may run any command in the directory /usr/local/op_commands/ but only as user opera-<font color="#ffffff" class="whiteout">tor.&nbsp;operator.</font>
       tor.

        matt           valkyrie = KILL

       On his personal workstation, valkyrie, <b>matt</b> needs to be able to kill hung processes.

        WEBMASTERS     www = (www) ALL, (root) /usr/bin/su www

       On the host www, any user in the <u>WEBMASTERS</u> User_Alias (will, wendy, and wim), may run any command as
       user www (which owns the web pages) or simply <a href="../man1/su.1.html#//apple_ref/doc/man/1/su"><u>su</u>(1)</a> to www.

        ALL            CDROM = NOPASSWD: /sbin/umount /CDROM,\
                       /sbin/mount -o nosuid\,nodev /dev/cd0a /CDROM

       Any user may mount or unmount a CD-ROM on the machines in the CDROM Host_Alias (orion, perseus, her-<font color="#ffffff" class="whiteout">cules)&nbsp;hercules)</font>
       cules) without entering a password.  This is a bit tedious for users to type, so it is a prime candi-<font color="#ffffff" class="whiteout">date&nbsp;candidate</font>
       date for encapsulating in a shell script.

<b>SECURITY</b> <b>NOTES</b>
       It is generally not effective to "subtract" commands from ALL using the '!' operator.  A user can
       trivially circumvent this by copying the desired command to a different name and then executing that.
       For example:

           bill        ALL = ALL, !SU, !SHELLS

       Doesn't really prevent <b>bill</b> from running the commands listed in <u>SU</u> or <u>SHELLS</u> since he can simply copy
       those commands to a different name, or use a shell escape from an editor or other program.  There-<font color="#ffffff" class="whiteout">fore,&nbsp;Therefore,</font>
       fore, these kind of restrictions should be considered advisory at best (and reinforced by policy).

<b>PREVENTING</b> <b>SHELL</b> <b>ESCAPES</b>
       Once <b>sudo</b> executes a program, that program is free to do whatever it pleases, including run other
       programs.  This can be a security issue since it is not uncommon for a program to allow shell
       escapes, which lets a user bypass <b>sudo</b>'s restrictions.  Common programs that permit shell escapes
       include shells (obviously), editors, paginators, mail and terminal programs.

       Many systems that support shared libraries have the ability to override default library functions by
       pointing an environment variable (usually LD_PRELOAD) to an alternate shared library.  On such sys-<font color="#ffffff" class="whiteout">tems,&nbsp;systems,</font>
       tems, <b>sudo</b>'s <u>noexec</u> functionality can be used to prevent a program run by sudo from executing any
       other programs.  Note, however, that this applies only to native dynamically-linked executables.
       Statically-linked executables and foreign executables running under binary emulation are not
       affected.

       To tell whether or not <b>sudo</b> supports <u>noexec</u>, you can run the following as root:

           sudo -V | grep "dummy exec"

       If the resulting output contains a line that begins with:

           File containing dummy exec functions:

       then <b>sudo</b> may be able to replace the exec family of functions in the standard library with its own
       that simply return an error.  Unfortunately, there is no foolproof way to know whether or not <u>noexec</u>
       will work at compile-time.  <u>Noexec</u> should work on SunOS, Solaris, *BSD, Linux, IRIX, Tru64 UNIX,
       MacOS X, and HP-UX 11.x.  It is known <b>not</b> to work on AIX and UnixWare.  <u>Noexec</u> is expected to work on
       most operating systems that support the LD_PRELOAD environment variable.  Check your operating sys-<font color="#ffffff" class="whiteout">tem's&nbsp;system's</font>
       tem's manual pages for the dynamic linker (usually ld.so, ld.so.1, dyld, dld.sl, rld, or loader) to
       see if LD_PRELOAD is supported.

       To enable <u>noexec</u> for a command, use the NOEXEC tag as documented in the User Specification section
       above.  Here is that example again:

        aaron  shanty = NOEXEC: /usr/bin/more, /usr/bin/vi

       This allows user <b>aaron</b> to run <u>/usr/bin/more</u> and <u>/usr/bin/vi</u> with <u>noexec</u> enabled.  This will prevent
       those two commands from executing other commands (such as a shell).  If you are unsure whether or not
       your system is capable of supporting <u>noexec</u> you can always just try it out and see if it works.

       Note that disabling shell escapes is not a panacea.  Programs running as root are still capable of
       many potentially hazardous operations (such as changing or overwriting files) that could lead to
       unintended privilege escalation.  In the specific case of an editor, a safer approach is to give the
       user permission to run <b>sudoedit</b>.

<b>SEE</b> <b>ALSO</b>
       <a href="../man1/rsh.1.html#//apple_ref/doc/man/1/rsh"><u>rsh</u>(1)</a>, <a href="../man1/su.1.html#//apple_ref/doc/man/1/su"><u>su</u>(1)</a>, <a href="../man3/fnmatch.3.html#//apple_ref/doc/man/3/fnmatch"><u>fnmatch</u>(3)</a>, <a href="../man8/sudo.8.html#//apple_ref/doc/man/8/sudo">sudo(8)</a>, <a href="../man8/visudo.8.html#//apple_ref/doc/man/8/visudo">visudo(8)</a>

<b>CAVEATS</b>
       The <u>sudoers</u> file should <b>always</b> be edited by the <b>visudo</b> command which locks the file and does grammat-<font color="#ffffff" class="whiteout">ical&nbsp;grammatical</font>
       ical checking. It is imperative that <u>sudoers</u> be free of syntax errors since <b>sudo</b> will not run with a
       syntactically incorrect <u>sudoers</u> file.

       When using netgroups of machines (as opposed to users), if you store fully qualified hostnames in the
       netgroup (as is usually the case), you either need to have the machine's hostname be fully qualified
       as returned by the hostname command or use the <u>fqdn</u> option in <u>sudoers</u>.

<b>BUGS</b>
       If you feel you have found a bug in <b>sudo</b>, please submit a bug report at <a href="http://www.sudo.ws/sudo/bugs/">http://www.sudo.ws/sudo/bugs/</a>

<b>SUPPORT</b>
       Commercial support is available for <b>sudo</b>, see <a href="http://www.sudo.ws/sudo/support.html">http://www.sudo.ws/sudo/support.html</a> for details.

       Limited free support is available via the sudo-users mailing list, see <a href="http://www.sudo.ws/mailman/listinfo/sudo-users">http://www.sudo.ws/mail-</a>
       <a href="http://www.sudo.ws/mailman/listinfo/sudo-users">man/listinfo/sudo-users</a> to subscribe or search the archives.

<b>DISCLAIMER</b>
       <b>Sudo</b> is provided ``AS IS'' and any express or implied warranties, including, but not limited to, the
       implied warranties of merchantability and fitness for a particular purpose are disclaimed.  See the
       LICENSE file distributed with <b>sudo</b> or <a href="http://www.sudo.ws/sudo/license.html">http://www.sudo.ws/sudo/license.html</a> for complete details.



1.6.8p12                                        June 20, 2005                                     SUDOERS(5)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man5/sudoers.5.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man5/sudoers.5.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man5/sudoers.5.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
