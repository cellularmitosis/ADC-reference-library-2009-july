<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html><head>
<!-- BEGIN META TAG INFO -->
<link rel="home" href="http://developer.apple.com/">
<link rel="find" href="http://developer.apple.com/search/">
<link rel="stylesheet" type="text/css" href="../../documentation/css/adcstyle.css" title="fonts">
<script language="JavaScript" type="text/javascript" src="../../documentation/js/busnav.js"></script>
<script language="JavaScript" src="../../documentation/js/adc.js" type="text/javascript"></script>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<!-- END META TAG INFO -->
<!-- BEGIN TITLE -->
<title>Technical Q&amp;A QA1236: Debugging Graphics with QuartzDebug</title>
<!-- END TITLE -->
</head>
<!-- BEGIN BODY OPEN -->
<body bgcolor="#ffffff"><a name="//apple_ref/doc/uid/DTS10002281" title="Debugging Graphics with QuartzDebug"></a>
<!--END BODY OPEN -->
<!-- START CENTER OPEN -->
<center>
<!-- END CENTER OPEN -->
<a name="top"></a>
<!-- BEGIN LOGO AND SEARCH -->
<!--#include virtual="/includes/adcnavbar"-->
<!-- END LOGO AND SEARCH -->
<!-- START BREADCRUMB -->
<div id="breadcrumb"><table width="680" border="0" cellpadding="0" cellspacing="0"><tr>
<td scope="row"><img width="340" height="10" src="images/1dot.gif" alt=""></td>
<td><img width="340" height="10" src="images/1dot.gif" alt=""></td></tr><tr valign="middle"><td align="left" colspan="2">
<a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalqas/index.html">Technical Q&As</a> &gt; <a href="../../technicalqas/Carbon/index.html">Carbon</a> &gt; <a href="../../technicalqas/Carbon/idxGraphicsImaging-date.html">Graphics & Imaging</a> &gt; 
</td></tr><tr><td colspan="2" scope="row"><img width="680" height="35" src="images/1dot.gif" alt=""></td></tr></table></div>
<!-- END BREADCRUMB -->

<!-- START MAIN CONTENT -->
<!-- START TITLE GRAPHIC AND INTRO-->
<table width="680" border="0" cellpadding="0" cellspacing="0"><tr align="left" valign="top">
<td><h1>
<div id="pagehead">Technical Q&amp;A QA1236</div>
<div id="pageheadsub">Debugging Graphics with QuartzDebug</div>
</h1></td></tr></table>
<!-- END TITLE GRAPHIC AND INTRO -->
<!-- BEGIN WIDE COLUMN -->
<table width="680" border="0" cellpadding="0" cellspacing="0"><tr align="left" valign="top"><td align="left" width="680">
<!-- BEGIN CONTENTS -->
<h2>Q: Q: How do I use QuartzDebug to debug graphics issues?</h2><p>A: QuartzDebug is a debugging interface for the Quartz graphics system with several powerful tools to help you identify a number of graphics display and performance problems.</p><p>The Quartz Debug application is located in:  /Developer/Applications/Performance Tools/</p><ul><li><a href="#TNTAG2">Main Quartz Debug options window</a></li><li><a href="#TNTAG4">Tools Menu Options</a><ul><li><a href="#TNTAG10">Quartz Extreme</a></li><li><a href="#TNTAG7">The Frame Meter</a></li><li><a href="#TNTAG12">User Interface Resolution</a></li><li><a href="#TNTAG9">Beam Sync Tools</a></li><li><a href="#TNTAG6">The Window List</a></li></ul></li><li><a href="#TNT_HISTORY_TAG">Document Revision History</a></li></ul><A NAME="TNTAG2"></A><H2>Main Quartz Debug options window</H2><A NAME="TNTAG1"></A><p class="caption"><strong>Figure 1:</strong> Quartz Debug main window.</p><p><img  src="images/qa1236_chkbx.jpg" width="202" height="157" alt="Figure 1, Quartz Debug main window."></p><p>Upon launch, the QuartzDebug options window <A HREF="#TNTAG1">Figure 1</A> appears. It contains four debugging checkboxes (all initially deselected).</p><ul><li><p>The &quot;Autoflush drawing&quot; checkbox flushes the contents of a CoreGraphics graphics context after each drawing operation, rather than wait for the CGContextFlush(). This is useful for examining every single drawing operation.</p></li><li><p>When &quot;Flash screen updates&quot; is selected, regions of the screen that are about to be updated are painted yellow,  followed by a brief pause, followed by the actual screen update. This allows you to see screen updates as they occur. The pause allows you to see the region in yellow; without it, the screen would be updated immediately, possibly faster than you can perceive it. To turn off the pause, select the &quot;No delay after flash option.&quot;</p></li><li><p>When &quot;Flash identical updates (red)&quot; is selected, regions of the screen that are about to be updated, but are the same as the content already present in the window backing store, are painted red. The red is followed by a brief pause, followed by the actual screen update. This allows you to see which regions of the window are being drawing redundantly as the content is already present in the window backing store. To turn off the pause, select the &quot;No delay after flash option.&quot;</p></li><li><p>When &quot;No delay after flash option.&quot; is selected, &quot;Flash identical updates&quot;, and &quot;Flash screen updates&quot; will not pause after the flashes.</p></li></ul><p><a href="#top">Back to Top</a>&nbsp;<a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p><A NAME="TNTAG4"></A><H2>Tools Menu Options</H2><A NAME="TNTAG10"></A><H3>Quartz Extreme</H3><p>The &quot;Disable/Enable Quartz Extreme&quot; menu option allows you to disable or re-enable Quartz Extreme in the system. See the <A HREF="http://www.apple.com/macosx/features/quartzextreme/ ">Quartz Extreme</A>  page for more information. If grey, hardware does not support Quartz Extreme. If green, Quartz Extreme is enabled. If red, Quartz Extreme is disabled. This setting takes effect immediately. This setting is not sticky across reboots.</p><p><a href="#top">Back to Top</a>&nbsp;<a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p><A NAME="TNTAG7"></A><H3>The Frame Meter</H3><A NAME="TNTAG8"></A><p class="caption"><strong>Figure 2:</strong> The Frame Meter</p><p><img  src="images/qa1236_meter.jpg" width="266" height="227" alt="Figure 2, The Frame Meter"></p><p>The &quot;Show/Hide Frame Meter&quot; (shown in <A HREF="#TNTAG8">Figure 2</A>) menu option displays or hides the performance frame meter as shown in Figure 3. The frame meter displays the number of screen updates per second. It also includes a mini cpu frame meter that displays the cpu usage. It is a transparent window, that can moved around by click-dragging from any part of the window.</p><p><a href="#top">Back to Top</a>&nbsp;<a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p><A NAME="TNTAG12"></A><H3>User Interface Resolution</H3><p>&quot;Show User Interface Resolution&quot; Allows the user to set the user interface scale factor. Applications have to be restarted. Setting is sticky across reboots.</p><p><a href="#top">Back to Top</a>&nbsp;<a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p><A NAME="TNTAG9"></A><H3>Beam Sync Tools</H3><p>&quot;Show Beam Sync Tools&quot; Allows the user to see the affects of <A HREF="../../technotes/tn2005/tn2133.html">Coalesced Updates</A> on their application.</p><ul><li><p>Disable Beam Synchronization: Disables all beam syncing in the system, including the Coalesced Update feature. You may see visual tearing, and you may see increased performance because your drawing calls will no longer block waiting for the previous flush to complete. Use this mode for benchmark testing to see what the total throughput of your code is (disregarding the the display flushing).  There is currently no way to disable just the Coalesced Update feature only.</p></li><li><p>Automatic Beam Synchronization: This is the default for 10.4. In this mode, beam syncing is enabled for window geometry changes (also true in 10.3) and the Coalesced Update feature is also enabled. The latter is new to 10.4 and will result in the window server coalescing display updates across applications into a single update to the display waiting for a vertical blank of the display. This is tied to the display refresh rate and is also applicable to LCD monitors (which really update at 60Hz). This results in better system performance, but can have side-effects to applications that attempt to flush faster than the refresh of the display. Note that only mach-o applications linked on 10.4 will initiate coalesced updates. CFM and apps built pre-Tiger will not initiate a coalesced update, but if another application has initiated a coalesced update for a VBL, then the original app's update will also be coalesced.</p></li><li><p>Force Beam Synchronization: This will force coalescing of updates across all applications. Developers can use this to check the performance impact of the feature without waiting to link their application on Tiger. Right now, the first time the app tries to flush faster than the display refresh rate or ends up spending more that 50% of it's time waiting for the vbl will have a message logged to /var/log/windowserver.log. The message is of the format : &quot;Application &quot;SuchAndSuch&quot; is being throttled by update coalescing.&quot; This message will only be output once per application. Developers should monitor this log to check to see if their application is being impacted by coalesced updates or not.</p></li></ul><p><a href="#top">Back to Top</a>&nbsp;<a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p><A NAME="TNTAG6"></A><H3>The Window List</H3><p>To understand the impact of buffered windows on the memory footprint of your application, you can examine the window list. When you Choose Tools &gt; Show Window List, a window (similar to that shown in <A HREF="#TNTAG3">Figure 3</A>) that contains a list the systemwide windows appears. The list identifies the owner of each window and the memory the window occupies. The list automatically updates as windows are added and removed. Table <A HREF="#TNTAG5">Table 1</A> describes the data in each column of the window list. Windows colored in green are hardware accelerated using Quartz 2D Extreme. Windows colored in grey are compressed because they are inactive. The list is updated every second. This can be modified in the Preferences.</p><p>The &quot;Refresh Windows List Now&quot; refreshes the window list available from the Options Window.</p><A NAME="TNTAG3"></A><p class="caption"><strong>Figure 3:</strong> A Snapshot of the system-wide window list.</p><p><img  src="images/qa1236_window.jpg" width="649" height="199" alt="Figure 3, A Snapshot of the system-wide window list."></p><A NAME="TNTAG5"></A><p class="smalltext"><strong>Table 1:</strong> Description of the columns in the Window List</p><table cellspacing="0" class="graybox"><tr><th>QuartzDebug window list columns</th><th>Column Description</th></tr><tr><td scope="row">CID</td><td>The connection ID of the window. Used internally by the window server. Typically, the connection ID is the same for all windows owned by a process.</td></tr><tr><td scope="row">Application</td><td>The name of the application that owns the window.</td></tr><tr><td scope="row">WID</td><td>The ID of the window itself. Used internally by the  window server.</td></tr><tr><td scope="row">kBytes</td><td>The amount of memory occupied by the window buffer and other large data structures. Specified in kilobytes. The letter I is appended to the size if the buffer is invalid  (in need of an update). The letter C is appended if the window has been automatically been compressed by the window server.</td></tr><tr><td scope="row">Origin</td><td>Screen-relative origin of the window (in pixels).</td></tr><tr><td scope="row">Size</td><td>Size of the window (in pixels).</td></tr><tr><td scope="row">Type</td><td>Buffered windows are buffered in shared memory. All graphics operations are recorded in the backing buffer and drawn to screen by the window server as necessary. Only the portions of a Retained window that are obscured by other windows are saved in the buffer. This results in some memory savings, but disables translucency. Graphics operations in Non-Retained windows are not recorded at all.</td></tr><tr><td scope="row">Encoding</td><td>Depth of the window's buffer (the number of bits per pixel). The letters -A are appended if the window buffer has an alpha channel. Note that the window buffer includes  the window's title bar and frame (or, in Carbon terms, &quot;structure  region&quot;).</td></tr><tr><td scope="row">On Screen</td><td>Whether the window is visible and on screen or offscreen and hidden from view.</td></tr><tr><td scope="row">Shared</td><td>Whether the window is shared or not. Shared windows can be manipulated by multiple applications. Non-shared windows are only modifiable by the application specified in the Application column.</td></tr><tr><td scope="row">Fade</td><td>Opacity of the window. Opacity is separate from the window's alpha channel. Ranges from 0% to 100%, where 0% indicates a completely transparent window; 100% indicates a completely opaque window.</td></tr><tr><td scope="row">Level</td><td>The window level. Windows at higher levels can never be placed visually below windows at lower levels. Values from LONG_MIN + 1 to LONG_MAX - 16 are supported.</td></tr></table><p><a href="#top">Back to Top</a>&nbsp;<a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p><A NAME="TNT_HISTORY_TAG"></A><H2>Document Revision History</H2><table cellspacing="0" class="graybox" width="680"><tr><th width="100">Date</th><th width="580">Notes</th></tr><tr><td scope="row">2006-01-12</td><td>Updated for 10.4</td></tr><tr><td scope="row">2003-02-25</td><td>Explains how to use QuartzDebug to debug graphics issues.</td></tr></table><p><b>Posted:</b> 2006-01-12</p>
<!-- END CONTENTS -->
</td></tr></table>
<!-- END WIDE COLUMN -->
<!-- END MAIN CONTENT -->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/qa/qa2001/qa1236.html%3Fid%3DDTS10002281-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/qa/qa2001/qa1236.html%3Fid%3DDTS10002281-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/qa/qa2001/qa1236.html%3Fid%3DDTS10002281-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

<!-- START BOTTOM APPLE NAVIGATION -->
<!--#include virtual="/includes/footer"-->
<!-- END BOTTOM APPLE NAVIGATION -->
<!-- START CENTER CLOSE -->
</center>
<!-- END CENTER CLOSE -->
</body></html>