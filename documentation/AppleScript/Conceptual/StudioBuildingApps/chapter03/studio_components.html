<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>AppleScript Studio Programming Guide: AppleScript Studio Components</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="AppleScript Studio Components"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20001250" title="AppleScript Studio Components"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../ScriptingAutomation/index.html#//apple_ref/doc/uid/TP30000440-TP40005948" target="_top">Scripting &amp; Automation</a> &gt; <a href="../../../../ScriptingAutomation/AppleScript-date.html#//apple_ref/doc/uid/TP30000440-TP40005948-TP30000481" target="_top">AppleScript</a> &gt; <a href="../chapter01/studio_intro_book.html#//apple_ref/doc/uid/20001248-TPXREF101">AppleScript Studio Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../chapter02/studio_about_book.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../chapter04/studio_detail.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/20001250-TPXREF101" title="AppleScript Studio Components"></a><h1>AppleScript Studio Components</h1><p>AppleScript Studio is a combination of a development environment and an application framework that lets you quickly build AppleScript Studio applications—Mac OS X applications that combine AppleScript scripts and Cocoa user-interface objects. It also supplies enhanced scripting capabilities to Cocoa applications.</p><p>AppleScript Studio makes use of features from AppleScript, Xcode, Interface Builder, and the Cocoa application framework. See <span class="content_text"><a href="../chapter02/studio_about_book.html#//apple_ref/doc/uid/20001249-TPXREF101">“About AppleScript Studio”</a></span> for a brief introduction to AppleScript Studio.</p><p>This chapter describes, in the following sections, the key features you use to create AppleScript Studio applications:</p><ul class="ul"><li class="li"><p><span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-TPXREF135">“AppleScript Overview”</a></span> describes the scripting system you use in AppleScript Studio.</p></li><li class="li"><p><span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-TPXREF136">“Xcode Features for AppleScript Studio”</a></span> describes AppleScript Studio–specific features in this integrated development environment.</p></li><li class="li"><p><span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-TPXREF137">“Interface Builder Features for AppleScript Studio”</a></span> describes features for creating user interfaces for AppleScript Studio applications.</p></li><li class="li"><p><span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-TPXREF138">“Cocoa Framework Overview”</a></span> describes the sophisticated application framework you use to create AppleScript Studio applications.</p></li><li class="li"><p><span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-BCIEJFED">“AppleScriptKit Framework Overview”</a></span> describes the framework that allows AppleScript Studio applications to script Cocoa user interface objects.</p></li></ul><p>For additional overview information, see the chapter <span class="content_text"><a href="../../../Reference/StudioReference/sr2_fundamentals/sr_fundamentals.html#//apple_ref/doc/uid/20011216" target="_top">“Terminology Fundamentals”</a></span> in <em><a href="../../../Reference/StudioReference/index.html#//apple_ref/doc/uid/TP30000892" target="_top">AppleScript Studio Terminology Reference</a></em>.</p><a name="//apple_ref/doc/uid/20001250-TPXREF135" title="AppleScript Overview"></a><h2>AppleScript Overview</h2><p>AppleScript is a scripting system that provides direct control of scriptable Macintosh applications, including many parts of the Mac OS itself. Instead of using a mouse or keyboard to manipulate applications, you create scripts—sets of English-like instructions—to automate tasks, control applications on local or remote computers, and even control complex workflows. There are examples of AppleScript scripts throughout this document.</p><p>AppleScript is the scripting language of choice for many Macintosh users. To provide scripters with increased flexibility and power, developers make applications scriptable, or capable of responding to Apple events. Although Carbon and Cocoa applications use different internal mechanisms to support scripting, scripters can access features in any scriptable application, allowing them to combine features from many applications.</p><p>Sophisticated scripters use AppleScript to provide customized solutions that typically make use of multiple scriptable applications, as well as scriptable parts of the Mac OS, including:</p><ul class="ul"><li class="li"><p>The Finder, which supports a host of operations on files, folders, windows, and other components of the Macintosh desktop</p></li><li class="li"><p>Mail, which supports operations such as getting, reading, and deleting mail. AppleScript Studio includes the Mail Search sample application, described in detail starting in <span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-TPXREF101">“Chapter 7, Mail Search Tutorial: Design the Application,”</a></span> which uses scripts to search mailboxes in the Mac OS X Mail application.</p></li><li class="li"><p>QuickTime Player, which supports operations such as opening, playing, and stepping through movies. The Talking Head sample application shows how to play QuickTime movies in an AppleScript Studio application.</p></li></ul><p>AppleScript scripts can target applications on remote machines and can even make remote procedure calls to access services over the Internet (starting with Mac OS X version 10.1). AppleScript’s support for remote procedure calls, including XML-RPC and SOAP requests, provides access to a variety of web-based servers that can check spelling, translate text between languages, obtain stock quotes, and more. The SOAP Talk AppleScript Studio application, described in <span class="content_text"><a href="../chapter02/studio_about_book.html#//apple_ref/doc/uid/20001249-CJBJBFAA">“AppleScript Studio Sample Applications,”</a></span> shows one way to provide a user interface to access SOAP services. For documentation on AppleScript’s support for remote procedure calls, see <em><a href="../../soapXMLRPC/index.html#//apple_ref/doc/uid/TP30001126" target="_top">XML-RPC and SOAP Programming Guide</a></em>, available in <span class="content_text"><!--a target="_top" -->AppleScript Documentation<!--/a--></span>.</p><p>As an established scripting language, supported by a large number of scriptable applications and available on almost every Mac, AppleScript is the driving force behind AppleScript Studio.</p><a name="//apple_ref/doc/uid/20001250-TPXREF156" title="How AppleScript Is Implemented"></a><h3>How AppleScript Is Implemented</h3><p>You can use AppleScript Studio to create complex scripting solutions without detailed knowledge of how AppleScript is implemented in Mac OS X. Therefore, this section provides only a brief description of that implementation. For a more detailed description, see the additional documentation listed in <span class="content_text"><a href="../chapter01/studio_intro_book.html#//apple_ref/doc/uid/20001248-CIHDAGAF">“See Also.”</a></span></p><p>The following are some of the key frameworks and other components that support scripting in Mac OS X. Note, however, that you aren’t required to work directly with any of these frameworks in your AppleScript Studio project.</p><ul class="spaceabove"><li class="li"><p>The <strong>Open Scripting Architecture (OSA)</strong> provides an API for compiling and executing scripts, and for creating scripting components, such as AppleScript itself. It is implemented in <code>OpenScripting.framework</code>, a subframework of <code>Carbon.framework</code>.</p></li><li class="li"><p>The <strong>Apple Event Manager</strong> provides an API for sending and receiving Apple events and working with the information they contain. Scripting components use Apple events to send commands and data to targeted processes. The Apple Event Manager is implemented in <code>AE.framework</code>, a subframework of <code>ApplicationServices.framework</code>.</p></li><li class="li"><p>The <strong>AppleScript component</strong> in Mac OS X implements the AppleScript scripting language. A scripting component provides services for compiling and executing scripts (and relies on the OSA).</p></li><li class="li"><p>The <strong>Script Editor application</strong> provides the ability to edit, compile, and execute scripts, to examine the scripting terminology of scriptable applications (the terms you can use in scripts to communicate with applications), and to perform other scripting tasks. When you use it to execute a script, Script Editor calls on the AppleScript component to convert script statements into the appropriate Apple events to the targeted applications. In Mac OS X, Script Editor is located in <code>/Applications/AppleScript</code>. Third-party script editors provide many additional features.</p><p>Most scripters are familiar with Script Editor, and you can learn more about it in AppleScript Help in the Help Center. The version released with Mac OS X version 10.3 provides a number of new and enhanced features, such as a pop-up menu for inserting common script coding blocks, and histories of previous results and event logs.</p></li></ul><a name="//apple_ref/doc/uid/20001250-TPXREF157" title="Scripting in AppleScript Studio"></a><h3>Scripting in AppleScript Studio</h3><p>An AppleScript script can target any scriptable application in the Mac OS, including those in the Classic environment and on remote machines. It can also target scriptable parts of the Mac OS, and use any scripting features provided by AppleScript. With few exceptions, you can use any statements in an AppleScript Studio script that you would use in any other AppleScript script in Mac OS X.</p><p>AppleScript Studio also supports a key additional feature: the ability to access Cocoa’s rich set of user interface objects in scripts. These objects range from buttons and text fields to pop-up menus, browsers, and table views. For more information, see <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-BAJHAAGF">“Cocoa User Interface Objects”</a></span></p><p>To write scripts for an AppleScript Studio application, you need to know what terminology you can use with the user interface objects in the application. For information on how to find the available terminology, see <span class="content_text"><a href="../chapter04/studio_detail.html#//apple_ref/doc/uid/20001251-CJBGBHIF">“AppleScript Studio Terminology”</a></span> in this document, as well as <em><a href="../../../Reference/StudioReference/index.html#//apple_ref/doc/uid/TP30000892" target="_top">AppleScript Studio Terminology Reference</a></em>. In addition, Cocoa’s user interface objects are described in <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-BAJHAAGF">“Cocoa User Interface Objects.”</a></span></p><a name="//apple_ref/doc/uid/20001250-TPXREF167" title="Terms for Classes and Objects"></a><h3>Terms for Classes and Objects</h3><p>This document uses the following definitions to help distinguish between various kinds of Cocoa and AppleScript classes and objects you work with in AppleScript Studio:</p><ul class="spaceabove"><li class="li"><p>A <strong>Cocoa user interface class</strong> is an Objective-C class, generally defined in the AppKit framework, that supports a user interface item. For example, NSButton and NSBrowser are Cocoa user interface classes.</p></li><li class="li"><p>A <strong>Cocoa user interface object</strong> is an instance of a Cocoa user interface class. When creating the interface for an AppleScript Studio application with Interface Builder, for example, you drag user interface objects such as buttons and browsers into your application windows, where the objects are instances of NSButton and NSBrowser, respectively.</p><p>When you select a Cocoa user interface object in Interface Builder and examine it in the Info window, you see its class name in the window’s title bar (for example, NSButton).</p></li><li class="li"><p>An <strong>AppleScript object class</strong> is a category for AppleScript objects that share characteristics, such as properties and elements. For example, if you open the dictionary for an AppleScript Studio application, you see <code>button</code> in the list of classes in the Control View suite.</p></li><li class="li"><p>An <strong>AppleScript object</strong> is an instance of an AppleScript object class. An AppleScript object is typically a distinct object in an application or its documents that can be specified in a script. In an AppleScript Studio application, for example, you write statements similar to the following:</p><div class="codesample"><table><tr><td scope="row"><pre>set currentButton to button "Search" of window "Some Window"<span></span></pre></td></tr></table></div><p>where <code>currentButton</code> is a reference to an AppleScript object specified by <code>button "Search"</code>. The button referred to is also a Cocoa user interface object (an instance of NSButton) in the application. For user interface objects in AppleScript Studio applications, there is usually a corresponding Cocoa object for each AppleScript object.</p></li></ul><a name="//apple_ref/doc/uid/20001250-TPXREF136" title="Xcode Features for AppleScript Studio"></a><h2>Xcode Features for AppleScript Studio</h2><p><strong>Xcode</strong> is Apple’s integrated development environment for Mac OS X. It supports building Cocoa and Carbon applications (as well as bundles, frameworks, plug-ins, and tools) with C, C++, Objective-C, and Java. Xcode has extensive online help and release notes. There are also several tutorials available that describe how to build and debug standard applications.</p><p>When AppleScript Studio is installed, Xcode provides support for building AppleScript Studio applications. See <span class="content_text"><a href="../requirements/scriptStudio_requirements.html#//apple_ref/doc/uid/20001260-TPXREF101">“Appendix A, AppleScript Studio System Requirements and Version Information,”</a></span> for information on how to make sure AppleScript Studio is available.</p><p>You use the following Xcode features to create AppleScript Studio applications:</p><ul class="ul"><li class="li"><p><strong>Project templates</strong> Xcode provides project templates for three types of AppleScript Studio application: AppleScript Application, AppleScript Document-based Application, and AppleScript Droplet. These templates are described in <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-BAJEACHF">“AppleScript Studio Application Templates”</a></span> and <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-TPXREF164">“Default Project Contents.”</a></span></p><p>Starting in AppleScript Studio version 1.3, Xcode also provides a template you can use to add features to Xcode itself. This template is described in <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-CJBEAIDE">“AppleScript Studio Xcode Plug-in Template.”</a></span></p></li><li class="li"><p><strong>Interface support</strong> AppleScript Studio relies on Interface Builder to create a user interface for AppleScript Studio applications, as described in <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-TPXREF137">“Interface Builder Features for AppleScript Studio.”</a></span> As you work on an AppleScript Studio application, you can easily switch back and forth between Xcode and Interface Builder.</p></li><li class="li"><p><strong>Source code editor</strong> Xcode’s source code editor allows you to edit and compile AppleScript scripts. Scripts can be arbitrarily long and you can perform search and replace and other standard operations. For more information, see <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-BAJGDDIG">“Source Code Editor.”</a></span></p></li><li class="li"><p><strong>Terminology Browser</strong> Xcode provides an Open Dictionary command (in the File menu) to view the terminology for any scriptable application. For details, see <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-BAJBFHJJ">“Terminology Browser.”</a></span></p></li><li class="li"><p><strong>Debugging support</strong> Xcode provides AppleScript Studio with debugging support that allows you to perform a variety of debugging tasks. However, that support is not currently complete. For more information, see <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-CJBHJEDE">“Debugging Features.”</a></span></p></li><li class="li"><p><strong>Xcode Documentation Window</strong> Xcode’s Help menu provides the Documentation Window for quick access to reference, release notes, websites, and other documentation for working with AppleScript Studio.</p></li></ul><p>The following sections describe these features in more detail. You can also find step-by-step instructions for working with Xcode in the Mail Search tutorial, starting in <span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-TPXREF101">“Chapter 7, Mail Search Tutorial: Design the Application,”</a></span> and in <span class="content_text"><a href="../chapter02/studio_about_book.html#//apple_ref/doc/uid/20001249-TPXREF130">“Creating a Hello World Application.”</a></span></p><a name="//apple_ref/doc/uid/20001250-BAJEACHF" title="AppleScript Studio Application Templates"></a><h3>AppleScript Studio Application Templates</h3><p>To create a new AppleScript Studio application project in Xcode, you choose New Project from the File menu. The resulting template window is shown in <span class="content_text"><a href="../chapter02/studio_about_book.html#//apple_ref/doc/uid/20001249-CEGGBFJD">Figure 1-8</a></span>. Xcode provides three kinds of templates for AppleScript Studio projects: AppleScript Application, AppleScript Document-based Application, and AppleScript Droplet. You use the first for applications that don’t need documents, the second for applications that create and manage multiple documents, and the third for simple droplets (defined in <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-BAJCDBDI">“AppleScript Droplet Template”</a></span>).</p><p>When you create a new project, you specify a name, which becomes the default name for the application as well. You can also choose a location for the project. The default location is your home directory (~/), or the last location you specified when creating a previous project.</p><a name="//apple_ref/doc/uid/20001250-CJBEAIDE" title="AppleScript Studio Xcode Plug-in Template"></a><h3>AppleScript Studio Xcode Plug-in Template</h3><p>Starting in AppleScript Studio version 1.3, first distributed with Mac OS X version 10.3, Xcode provides a new template for creating an AppleScript plug-in for Xcode. That is, you can use AppleScript Studio to create a plug-in that adds features to Xcode itself.</p><p>To create an AppleScript plug-in project in Xcode, you follow these steps:</p><ol class="ol"><li class="li"><p>Choose File > New Project</p></li><li class="li"><p>In the New Project Assistant window, scroll down to the section for Standard Apple Plug-ins.</p></li><li class="li"><p>Select AppleScript Xcode Plugin</p></li></ol><p>Once you’ve built your plug-in, you place it in one of the following locations so that it will be loaded by Xcode the next time Xcode is launched:</p><ul class="spaceabove"><li class="li"><p>~<code>/Library/Application Support/Apple/Developer Tools/Plug-Ins</code></p><p>check for plug-ins in the user’s home directory</p></li><li class="li"><p><code>/Library/Application Support/Apple/Developer Tools/Plug-Ins</code></p><p>check in the system domain</p></li><li class="li"><p><code>/Network/Library/Application Support/Apple/Developer Tools/Plug-Ins</code></p><p> check in the network domain</p></li></ul><p>For an example of a plug-in script, see the Example section for the <code>plugin loaded</code> event in the PlugIn suite in <em><a href="../../../Reference/StudioReference/index.html#//apple_ref/doc/uid/TP30000892" target="_top">AppleScript Studio Terminology Reference</a></em>.</p><a name="//apple_ref/doc/uid/20001250-TPXREF164" title="Default Project Contents"></a><h3>Default Project Contents</h3><p>Xcode organizes a project’s files in a nested hierarchy of groups, displayed in the Files list in the project’s Groups &amp; Files list, as shown in <span class="content_text">Figure 2-1</span>. A group is represented by a folder icon, but items in a group do not necessarily reside in the same folder. If an item has a checked checkbox in the Target column (the column headed by a target symbol, next to the Groups &amp; Files column), it is part of the current target and is included when that target is built. You can add an item to a build or remove it by clicking to select or deselect its checkbox in the target column. For more information on targets and builds, see the Documentation Window in the Xcode Help menu.</p><p>The default contents of the Groups &amp; Files list is different for a new project based on the AppleScript Application and AppleScript Droplet templates than for one based on the AppleScript Document-based Application template, as described in the following sections.</p><a name="//apple_ref/doc/uid/20001250-BAJHDIHB" title="AppleScript Application Template"></a><h4>AppleScript Application Template</h4><p>A new project based on the AppleScript Application template contains all of the items shown in <span class="content_text">Figure 2-1</span>.</p><br/><div><a name="//apple_ref/doc/uid/20001250-BAJFCBJJ" title="Figure 2-1Default contents of an AppleScript Application project"></a><p><strong>Figure 2-1&nbsp;&nbsp;</strong>Default contents of an AppleScript Application project</p><img src = "../art/default_groups_files.gif" alt = "Default contents of an AppleScript Application project" width="263" height="469"></div><br/><p>The following is a description of these default items:</p><ul class="spaceabove"><li class="li"><p>The Scripts group contains the application’s script files, all of which must have the extension <code>.applescript</code> so that Xcode’s source code editor recognizes them as AppleScript script files.</p><p><code>Application.applescript</code> is the default script file, which is created as an empty file. When you write script statements to perform operations in your application, you do so in this file, or in additional script files you create.</p></li><li class="li"><p>The Resources group contains all of the application’s resources, and you should store any resource you add in this group. The default resources include the following:</p><ul class="nested"><li class="nested li"><p><code>AppleScriptKit.asdictionary</code> is a pointer to a file in the AppleScriptKit framework (described below). This file describes the scripting terminology you can use in AppleScript Studio scripts. It includes terms that are available to all Cocoa applications that support scripting (in the Standard and Text suites) and those that are specific to AppleScript Studio applications (the Application, Container View, Control View, Data View, Menu, Panel, and Text View suites). See <span class="content_text"><a href="../chapter04/studio_detail.html#//apple_ref/doc/uid/20001251-CJBGBHIF">“AppleScript Studio Terminology”</a></span> for more information on these suites.</p><p><code>AppleScriptKit.asdictionary</code> is provided so that you can conveniently examine the terminology before the application is built (and without opening the dictionary of some other built AppleScript Studio application). You can click the file’s icon to examine its contents; for details, see <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-BAJBFHJJ">“Terminology Browser.”</a></span></p><div class="notebox"><a name="//apple_ref/doc/uid/20001250-DontLinkElementID_8" title="Note"></a><p><strong>Note:</strong>&nbsp; Unlike the formatting for script files in an AppleScript Studio project, the formatting in <code>AppleScriptKit.asdictionary</code> is fixed when the file is created, and does not change to match settings you specify in the preferences for the Script Editor application. (In versions of Script Editor released prior to Mac OS X version 10.3, you set formatting by choosing the AppleScript Formatting menu item.) However the formatting for dictionaries from other applications that you open will reflect your settings. For information on script formatting, see <span class="content_text"><a href="../chapter04/studio_detail.html#//apple_ref/doc/uid/20001251-CJBCHHAD">“How Xcode Formats Scripts.”</a></span></p></div></li><li class="nested li"><p><code>MainMenu.nib</code> is the main nib file (or user interface resource file) for the application. Nib files are described in <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-TPXREF137">“Interface Builder Features for AppleScript Studio.”</a></span> You double-click the nib icon to open the file in Interface Builder, where you can add interface items, assign event handlers to them, and connect them to scripts.</p><p><code>English</code> contains the English version of any localized information for <code>MainMenu.nib</code>. By default, the application does not contain localized information for any other languages, so clicking or double-clicking <code>English</code> has the same affect as clicking or double-clicking <code>MainMenu.nib</code>.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001250-DontLinkElementID_9" title="Note"></a><p><strong>Note:</strong>&nbsp; Localization is too complex a topic to describe here. For a description of how to localize resources, see the “Bundles” chapter of <em><a href="../../../../MacOSX/Conceptual/OSX_Technology_Overview/index.html#//apple_ref/doc/uid/TP40001067" target="_top">Mac OS X Technology Overview</a></em>.</p></div></li><li class="nested li"><p><code>InfoPlist.strings</code> contains strings representing information that is displayed to the user, such as the application name, version, and copyright information. For a description of how this information is used, see <span class="content_text"><a href="../chapter12/studio_ms_customize.html#//apple_ref/doc/uid/20001259-TPXREF160">“Customize Version and Copyright Information.”</a></span></p><p><code>English</code> contains the English version of any localized string information. By default, the application contains only an English version, so clicking or double-clicking <code>English</code> has the same affect as clicking or double-clicking <code>InfoPlist.strings</code>.</p></li></ul></li><li class="li"><p>The Other Sources group contains the file <code>main.m</code>. This file contains the minimum Cocoa code required by the application. That code is shown in <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-CJBDAACD">Listing 2-1</a></span>. You don’t typically need to make any changes to this code file.</p></li><li class="li"><p>The Frameworks group contains two subgroups, Linked Frameworks and Other Frameworks. The Linked Frameworks group contains two frameworks:</p><ul class="nested"><li class="nested li"><p><code>Cocoa.framework</code> The Cocoa framework includes both the AppKit and Foundation frameworks, which together provide the code and resources for Cocoa applications, including the user interface classes you use in AppleScript Studio. All AppleScript Studio applications link against this framework.</p></li><li class="nested li"><p><code>AppleScriptKit.framework</code> This framework provides the scripting terminology and other extensions to Cocoa that allow AppleScript Studio applications to make use of Cocoa user interface classes. All AppleScript Studio applications link against this framework.</p><p>For more information, see <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-BCIEJFED">“AppleScriptKit Framework Overview.”</a></span></p></li></ul><p>The Other Frameworks group also contains two frameworks:</p><ul class="nested"><li class="nested li"><p><code>Foundation.framework</code> As you’ve seen, the Cocoa framework includes the Foundation framework. Foundation is included in the Other Frameworks group as a convenience—by opening the framework, you can quickly access header and documentation files associated with it.</p></li><li class="nested li"><p><code>AppKit.framework</code> As with the Foundation framework, the AppKit framework is included for convenience.</p></li></ul></li><li class="li"><p>The Products group contains the products produced by the targets in the project. The default project has just one target, which creates an application. In this example, <code>Simple Application.app</code> is the name of the application, where <code>.app</code> is the extension (which is not displayed in the Finder) for an application.</p><p>The applications you build are saved in the build directory, which is usually a folder named “build” in the project folder. When you are ready to distribute your AppleScript Studio application, you copy it from this location.</p></li></ul><a name="//apple_ref/doc/uid/20001250-BAJFAAFF" title="Document-based Application Template"></a><h4>Document-based Application Template</h4><p><span class="content_text">Figure 2-2</span> shows the Groups &amp; Files list for a new document-based project (the Mail Search project, from a later tutorial in this document), with most groups expanded. Many of the items are common to all AppleScript Studio project templates, and are described in <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-BAJHDIHB">“AppleScript Application Template.”</a></span> The following is a description of the default items that are unique to a document-based project:</p><ul class="spaceabove"><li class="li"><p><code>Document.applescript</code> is the default document script file, which is created as an empty file. If you have any document-related script statements, you should add them to this file.</p></li><li class="li"><p><code>Document.nib</code> is the nib file for creating document-associated windows. Nib files are described in <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-TPXREF137">“Interface Builder Features for AppleScript Studio.”</a></span> You double-click the nib icon to open the file in Interface Builder.</p></li><li class="li"><p><code>Credits.rtf</code> is a rich text format (<code>.rtf</code>) file that supplies text for the default About window in a Cocoa application. You edit this file to supply your own About window information, as described in <span class="content_text"><a href="../chapter12/studio_ms_customize.html#//apple_ref/doc/uid/20001259-TPXREF209">“Customize the About Window.”</a></span></p></li></ul><div class="notebox"><a name="//apple_ref/doc/uid/20001250-DontLinkElementID_10" title="Note"></a><p><strong>Note:</strong>&nbsp;In earlier versions of AppleScript Studio, the project contained a Classes group, which in turn contained two files, <code>Document.h</code> and <code>Document.m</code>. Those files contained the minimum code required to support documents in a document-based Cocoa application. Starting with AppleScript Studio version 1.2, they are no longer needed.</p></div><p>If you write Cocoa classes for your AppleScript Studio application, you can create a group for them.</p><br/><div><a name="//apple_ref/doc/uid/20001250-TPXREF171" title="Figure 2-2Default contents of an AppleScript Document-based Application project"></a><p><strong>Figure 2-2&nbsp;&nbsp;</strong>Default contents of an AppleScript Document-based Application project</p><img src = "../art/watson_exp_groups.gif" alt = "Default contents of an AppleScript Document-based Application project" width="181" height="352"></div><br/><p>AppleScript Studio version 1.2 provides new terms for working with documents. These terms are documented in <em><a href="../../../Reference/StudioReference/index.html#//apple_ref/doc/uid/TP30000892" target="_top">AppleScript Studio Terminology Reference</a></em>, and you can also examine them in the Document suite in the AppleScript Studio scripting dictionary <code>AppleScriptKit.asdictionary</code>. For details on how to view this dictionary, see <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-BAJBFHJJ">“Terminology Browser.”</a></span></p><a name="//apple_ref/doc/uid/20001250-BAJCDBDI" title="AppleScript Droplet Template"></a><h4>AppleScript Droplet Template</h4><p>AppleScript Studio provides the AppleScript Droplet template for creating its namesake—droplets. A <strong>droplet</strong> is a script application that launches when you drag a file or folder icon in the Finder and “drop” it on the droplet’s icon. A droplet contains an <code>on open</code> handler, which receives a list of descriptors for the folders or files dropped on it. Droplets are a popular kind of application because they can conveniently handle everyday tasks, such as changing file extensions, printing, or performing more complicated operations, on each item in a list of files or folders.</p><p>A project created with the AppleScript Droplet template contains the same items shown in <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-BAJFCBJJ">Figure 2-1</a></span> for the AppleScript Application template. The one difference is that the default script file, <code>Application.applescript</code>, is not empty in a droplet application. Instead, it contains the following handlers:</p><ul class="spaceabove"><li class="li"><p><code>on idle:</code> Script statements you add to this handler perform idle time processing.</p></li><li class="li"><p><code>on open:</code> Script statements you add to this handler perform the droplet’s main function.</p><p>By default, the <code>open</code> handler ends with a <code>quit</code> statement. If you want the handler to stay open, remove the <code>quit</code> statement.</p></li></ul><p>By adding script statements to these handlers, you can quickly create droplet applications.</p><a name="//apple_ref/doc/uid/20001250-TPXREF165" title="The Targets Group"></a><h3>The Targets Group</h3><p>Xcode keeps track of project targets in the Targets group. A new AppleScript Studio project contains just one target, with the same name as the application (without the <code>.app</code> extension). For example, the default target for the project described in <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-TPXREF164">“Default Project Contents”</a></span> is “Simple Application”. More complicated applications can have multiple targets.</p><p><span class="content_text">Figure 2-3</span> shows the Targets inspector for the Mail Search application, developed in a tutorial later in this document. The figure shows the Styles pane, containing a pop-up menu to choose between Development and Deployment styles. By default, a new application uses the development build style. In a development build, debugging symbols are included and compiled script files in the application’s bundle include the script text. In addition, ZeroLink is active. In a deployment build, symbols and script text are not included, and ZeroLink is turned off. As a result, a deployment build may have a much smaller disk footprint.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001250-DontLinkElementID_11" title="Note"></a><p><strong>Note:</strong>&nbsp;ZeroLink is a feature you can read about in Xcode Help. You can create fairly complex AppleScript Studio applications without having to modify default settings.</p></div><br/><div><a name="//apple_ref/doc/uid/20001250-BCIFFFED" title="Figure 2-3The Mail Search Target inspector"></a><p><strong>Figure 2-3&nbsp;&nbsp;</strong>The Mail Search Target inspector</p><img src = "../art/xc_target_pane.gif" alt = "The Mail Search Target inspector" width="532" height="460"></div><br/><a name="//apple_ref/doc/uid/20001250-BAJGDDIG" title="Source Code Editor"></a><h3>Source Code Editor</h3><p>Xcode provides a robust source code editor with many features, including:</p><ul class="spaceabove"><li class="li"><p>options for switching between recently edited files, jumping to named handlers, and performing split-pane editing</p></li><li class="li"><p>syntax checking for AppleScript, Java, C, and C++, as well as syntax coloring, which uses fonts, styles, and colors to distinguish, for example, between key words, comments, and so on</p></li><li class="li"><p>automatic indenting and adjustable tab width</p></li><li class="li"><p>matching of parentheses, braces, and brackets</p></li></ul><p>When AppleScript Studio is installed, Xcode recognizes files that end in <code>.applescript</code> as script files. For example, the name of the default script file created for a new AppleScript Studio project is <code>Application.applescript</code>. When you select a script file in the Groups &amp; Files list and click the Show Editor button, Xcode displays the file’s contents in the main project window, as shown in <span class="content_text">Figure 2-4</span>. (You can also double-click the file to open it in a separate editor window.) This window includes:</p><ul class="spaceabove"><li class="li"><p>a pair of arrows (the Go Back and Go Forward arrows) for switching between files displayed in the editor window</p></li><li class="li"><p>a script icon, indicating the file is a script file (if you position the cursor over the script icon, it displays the full path to the script file)</p></li><li class="li"><p>the name of the file (the name is in a pop-up menu; if you have displayed more than one file in the window, you can choose between them)</p></li><li class="li"><p>a pop-up menu for navigating to any handler in the script (the current, and in this case only, handler is the <code>on clicked</code> handler)</p></li><li class="li"><p>a “Go to Counterpart” button for switching between header and source files (not applicable for script files)</p></li><li class="li"><p>a button for splitting the window into more than one pane (clicking again rejoins split panes</p></li></ul><br/><div><a name="//apple_ref/doc/uid/20001250-BAJHGJIC" title="Figure 2-4Editing a Hello World script in Xcode"></a><p><strong>Figure 2-4&nbsp;&nbsp;</strong>Editing a Hello World script in Xcode</p><img src = "../art/hw_empty_clicked.gif" alt = "Editing a Hello World script in Xcode" width="543" height="348"></div><br/><p>You build an AppleScript Studio application with any of Xcode’s mechanisms for starting a build, which include menu commands (such as Build in the Build menu), keystroke shortcuts (such as Command-B), and clickable buttons (any of the buttons that include a hammer). Building creates the application or other product specified by the current target.</p><p>When you build an AppleScript Studio application, all modified script files that belong to the current target are compiled automatically. You can compile an individual script in an editor window by typing Command-K or pressing the Enter key.</p><p>Building the application also compiles the Cocoa code in the application’s <code>main.m</code> file (shown in <span class="content_text"><a href="../chapter02/studio_about_book.html#//apple_ref/doc/uid/20001249-CJBHJCHG">Figure 1-10</a></span>) and in any other source files in the current target, and links with the application’s frameworks. For more information on building applications, see any of the tutorials in this document, or refer to the Documentation Window in the Xcode Help menu. </p><p>In <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-BAJHGJIC">Figure 2-4</a></span>, AppleScript keywords are shown in blue (<code>on</code>, <code>end</code>) and application keywords in red (<code>clicked</code>, <code>display dialog</code>). For information on script formatting, see <span class="content_text"><a href="../chapter04/studio_detail.html#//apple_ref/doc/uid/20001251-CJBCHHAD">“How Xcode Formats Scripts.”</a></span></p><p>You can read more about the standard features available with Xcode’s source code editor in the Documentation Window, found in the Xcode Help menu.</p><a name="//apple_ref/doc/uid/20001250-CJBHJEDE" title="Debugging Features"></a><h3>Debugging Features</h3><div class="notebox"><a name="//apple_ref/doc/uid/20001250-DontLinkElementID_12" title="Note"></a><p><strong>Note:</strong>&nbsp;AppleScript Studio’s support for line-by-line debugging in Xcode is still in development. This document will be updated to describe this support as it becomes available. </p></div><p>The following sections contain some information that can help you debug your application:</p><ul class="spaceabove"><li class="li"><p><span class="content_text"><a href="../chapter04/studio_detail.html#//apple_ref/doc/uid/20001251-CJBFIAIB">“Programming Tips”</a></span> provides pointers for creating Studio applications. The section <span class="content_text"><a href="../chapter04/studio_detail.html#//apple_ref/doc/uid/20001251-BAJCIAJG">“Using the Log Command to Track Your Scripts”</a></span> can be useful in debugging your scripts.</p></li><li class="li"><p><span class="content_text"><a href="../chapter04/studio_detail.html#//apple_ref/doc/uid/20001251-CJBGAGHH">“Troubleshooting”</a></span> provides a list of common problems and tips for solving them.</p></li></ul><p>You may be also able to debug your application with a third-party debugger.</p><a name="//apple_ref/doc/uid/20001250-BAJBFHJJ" title="Terminology Browser"></a><h3>Terminology Browser</h3><p>Xcode provides the Open Dictionary command in the File menu to examine the scripting dictionary of any scriptable Carbon or Cocoa application. The dictionary defines the application’s scripting terminology—the English-like words and phrases you can use in a script to communicate with and control that application.</p><p>The Open Dictionary command brings up a dialog similar to the one in <span class="content_text">Figure 2-5</span>, where you can select from among the currently available scriptable applications.</p><br/><div><a name="//apple_ref/doc/uid/20001250-CJBDCAHF" title="Figure 2-5The Open Dictionary dialog in Xcode"></a><p><strong>Figure 2-5&nbsp;&nbsp;</strong>The Open Dictionary dialog in Xcode</p><img src = "../art/open_dict_dialog.gif" alt = "The Open Dictionary dialog in Xcode" width="468" height="243"></div><br/><p>Within an AppleScript Studio project, you can display the AppleScript Studio scripting dictionary by double-clicking the icon for <code>AppleScriptKit.asdictionary</code> in the Files list in Xcode’s Groups &amp; Files list. The result is a browser window similar to the one shown in <span class="content_text">Figure 2-6</span>. If you merely click the icon, or if you choose an AppleScript Studio application with the Open Dictionary command, the browser is displayed as a pane within the project window. In either case, you have access to the same information and navigation options.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001250-DontLinkElementID_13" title="Note"></a><p><strong>Note:</strong>&nbsp;The color of text you see when you display <code>AppleScriptKit.asdictionary</code> depends on the color settings at the time the file was created, and may vary from what is shown in <span class="content_text">Figure 2-6</span>.</p></div><p>You can also open dictionaries in the Script Editor application. Both applications provide the same information.</p><br/><div><a name="//apple_ref/doc/uid/20001250-BAJCEDBC" title="Figure 2-6The AppleScript Studio scripting dictionary in a browser window"></a><p><strong>Figure 2-6&nbsp;&nbsp;</strong>The AppleScript Studio scripting dictionary in a browser window</p><img src = "../art/as_dictionary_in_browser.gif" alt = "The AppleScript Studio scripting dictionary in a browser window" width="783" height="584"></div><br/><p><span class="content_text">Figure 2-6</span> shows the classes (which can include elements and properties) and events (which provide syntax descriptions) of the Container View Suite, with the terminology for the tab view item class currently visible.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001250-DontLinkElementID_14" title="Note"></a><p><strong>Note:</strong>&nbsp;The Event container in the scripting dictionary can contain both commands and events. A <strong>command</strong> is a word or phrase a script can send to an object to request an action. For example, a script can send a <code>stop</code> command to a progress indicator.</p>An <strong>event</strong> is an action an object can respond to. For example, a button click is an event that may result in execution of a <code>clicked</code> handler for the button that was clicked.</p>More simply, scripts can send commands to objects, while events, often the result of user actions, generate calls to event handlers in scripts.</p></div><p><span class="content_text">Figure 2-6</span> also shows a number of suites of related terminology. The Standard and Text suites are part of Cocoa and are available to all Cocoa applications that turn on scripting support. The remaining suites are provided by AppleScript Studio, which groups its scripting terminology in these suites. See <em><a href="../../../Reference/StudioReference/index.html#//apple_ref/doc/uid/TP30000892" target="_top">AppleScript Studio Terminology Reference</a></em> for detailed information about the available terminology, and also the section <span class="content_text"><a href="../chapter04/studio_detail.html#//apple_ref/doc/uid/20001251-CJBGBHIF">“AppleScript Studio Terminology”</a></span> in this document.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001250-DontLinkElementID_15" title="Note"></a><p><strong>Note:</strong>&nbsp;Outline items in the dictionary viewer shown in <span class="content_text">Figure 2-6</span> do not remember their expanded state, so if you shift to display another file in the window, when you shift back to the dictionary viewer all of the items will be collapsed. To avoid this, open the dictionary viewer in its own window. You can do so by double-clicking the file <code>AppleScriptKit.asdictionary</code> in the Files list in an AppleScript Studio project’s Groups &amp; Files list.</p></div><a name="//apple_ref/doc/uid/20001250-TPXREF137" title="Interface Builder Features for AppleScript Studio"></a><h2>Interface Builder Features for AppleScript Studio</h2><p><strong>Interface Builder</strong> is Apple’s graphical interface builder for Mac OS X. Interface Builder lets you lay out interface objects (including windows, controls, menus, and so on), resize them, set their attributes, and make connections to other objects. The resulting information is stored in user interface resources, called <strong>nibs</strong>, which in turn are stored in <strong>nib files</strong> that become part of your application. (A nib file is an Interface Builder file—the ”ib” in ”nib” stands for Interface Builder.) When the application is opened, it creates an interface containing the windows, buttons, and other user interface objects specified in its nib files.</p><p>The Interface Builder application is located in <code>/Developer/Applications</code>. Interface Builder has extensive online help and release notes. There are also tutorials available that describe how to build interfaces for Carbon and Cocoa applications.</p><p>Interface Builder’s support for AppleScript Studio includes the following features:</p><ul class="ul"><li class="li"><p>Graphical tools for creating sophisticated interfaces (not limited to AppleScript Studio applications). Some of these tools are reviewed in <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-TPXREF161">“Interface Creation.”</a></span> For additional documentation, see the tutorials throughout this document, as well as the tutorials and online help for Interface Builder.</p></li><li class="li"><p>Access to Cocoa’s rich set of user interface objects (also not limited to AppleScript Studio applications). For more information, see <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-BAJHAAGF">“Cocoa User Interface Objects.”</a></span></p></li><li class="li"><p>An AppleScript palette, which provides custom AppleScript Studio objects. For more information, see <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-TPXREF161">“Interface Creation.”</a></span></p></li><li class="li"><p>An AppleScript pane in the Info window. You can use this pane to connect user interface objects to scripts—when an event occurs, such as a user clicking a button, the application calls a specified event handler in a script. For more information, see <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-TPXREF162">“Interface Connections.”</a></span></p></li></ul><p>The following sections describe these features in more detail.</p><a name="//apple_ref/doc/uid/20001250-TPXREF161" title="Interface Creation"></a><h3>Interface Creation</h3><p>To create an interface with Interface Builder, you create and edit a nib file containing descriptions of the interface elements in your application. A nib file can describe all or part of a user interface. Many applications use multiple nib files—for more information, see <span class="content_text"><a href="../chapter04/studio_detail.html#//apple_ref/doc/uid/20001251-TPXREF181">“Deciding How Many Nib Files to Use.”</a></span></p><p>When you create an AppleScript Studio application with Xcode, it automatically contains a default nib file named <code>MainMenu.nib</code>. The icon for this nib file is shown in <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-BAJFCBJJ">Figure 2-1</a></span>. Double-clicking the icon for a nib file opens Interface Builder. When you open the default <code>MainMenu.nib</code> file for an AppleScript Studio application, Interface Builder opens four windows, such as those shown in <span class="content_text">Figure 2-7</span>.</p><br/><div><a name="//apple_ref/doc/uid/20001250-BAJEEGIG" title="Figure 2-7Interface Builder windows after opening the MainMenu.nib file"></a><p><strong>Figure 2-7&nbsp;&nbsp;</strong>Interface Builder windows after opening the <code>MainMenu.nib</code> file</p><img src = "../art/hw_ib_default_windows.gif" alt = "Interface Builder windows after opening the MainMenu.nib file" width="692" height="564"></div><br/><p>The <code>MainMenu.nib</code> window displays the Instances pane, showing four instances, two of which (MainMenu and Window) are shown in their own windows. The four instances are:</p><ul class="spaceabove"><li class="li"><p>File’s Owner: Every nib file has one owner, an object outside the nib file that relays messages between objects that are created from the nib. In this, the main nib file, File’s Owner always represents <code>NSApp</code>, a global constant that references the NSApplication object for the application. The application object serves as the master controller for the application. For more information on the application object, see <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-TPXREF177">“Cocoa Application Framework.”</a></span> For more on File’s Owner, see <span class="content_text"><a href="../chapter09/studio_ms_connect_intf.html#//apple_ref/doc/uid/20001256-TPXREF182">“Connect the Application Object.”</a></span> For more detail, see the Cocoa documentation described in <span class="content_text"><a href="../chapter01/studio_intro_book.html#//apple_ref/doc/uid/20001248-CIHDAGAF">“See Also.”</a></span></p></li><li class="li"><p>First Responder: This instance identifies the object that is the first target in the application for keystrokes. You won’t typically need to modify this instance in AppleScript Studio applications.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001250-DontLinkElementID_16" title="Note"></a><p><strong>Note:</strong>&nbsp;There is a window property <code>first responder</code> you use to set the current focus; for example <code>set first responder of window 1 to text field 1 of window 1</code> sets the focus to the specified text field so that it will receive keystrokes. As of AppleScript Studio version 1.2, you can only set the <code>first responder</code> property; getting it will not return a useful value.</p></div></li><li class="li"><p>MainMenu: This instance defines the menus for the application. It is displayed in its own window in <span class="content_text">Figure 2-7</span>. For information on working with menus, see <span class="content_text"><a href="../chapter12/studio_ms_customize.html#//apple_ref/doc/uid/20001259-BCIIAFBC">“Customize Menus.”</a></span></p></li><li class="li"><p>Window: This instance defines the document window for the application, and is also displayed in its own window in <span class="content_text">Figure 2-7</span>. For information on working with windows, see <span class="content_text"><a href="../chapter08/studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-TPXREF163">“Create the Message Window”</a></span> and <span class="content_text"><a href="../chapter08/studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-TPXREF168">“Create the Search Window.”</a></span></p></li></ul><p>For information on the other panes visible in the MainMenu.nib window, see Interface Builder Help.</p><p>The window containing a number of buttons and fields is the Palette window. You click the buttons in the Palette window’s toolbar to display other palettes, such as the AppleScript palette (whose button is on the left of the toolbar).</p><div class="notebox"><a name="//apple_ref/doc/uid/20001250-DontLinkElementID_17" title="Note"></a><p><strong>Note:</strong>&nbsp;Interface Builder allows you to customize the toolbar, so it may not appear exactly as shown in <span class="content_text">Figure 2-7</span>. To customize, click in the toolbar while holding down the Control key to see a menu of options.</p></div><p>To add Cocoa user interface objects to your application’s main window, you simply drag them from the Cocoa-Controls palette (or from another palette) and position them in the Window window.</p><p>To create a new Window, you drag a window out of the Cocoa-Windows palette and release it. The window will appear both as an instance in the nib window and as a window, into which you can drag user interface items.</p><p>One feature of the Palette window that is unique to AppleScript Studio is the AppleScript palette, shown in <span class="content_text">Figure 2-8</span>. This palette provides access to special-purpose objects the AppleScriptKit framework supplies for use in AppleScript Studio applications. For example, the icon in <span class="content_text">Figure 2-8</span> represents a <strong>data source object</strong> that supplies data to a table view or other view with rows and columns. (The data source icon shown is subject to change.) The section <span class="content_text"><a href="../chapter09/studio_ms_connect_intf.html#//apple_ref/doc/uid/20001256-TPXREF190">“Connect the Search Window”</a></span> in the Mail Search tutorial defines the data source and describes how to work with data source objects.</p><br/><div><a name="//apple_ref/doc/uid/20001250-BAJEBDHE" title="Figure 2-8The AppleScript palette in Interface Builder&acirc;&#128;&#153;s Palette window"></a><p><strong>Figure 2-8&nbsp;&nbsp;</strong>The AppleScript palette in Interface Builder’s Palette window</p><img src = "../art/ib_applescript_palette.gif" alt = "The AppleScript palette in Interface Builder’s Palette window" width="392" height="254"></div><br/><p>Interface Builder provides several mechanisms for modifying interface items:</p><ul class="spaceabove"><li class="li"><p>You can drag to move or resize items; as you drag, Interface Builder provides feedback to help align items according to the Aqua interface guidelines.</p></li><li class="li"><p>For many items, such as buttons, you can double-click the item to select its title, then type a new title.</p></li><li class="li"><p>You can use commands from the Format, Layout, and Tools menus to modify and position user interface items.</p></li><li class="li"><p>You can select a user interface item, then open the Info window (by typing Command-Shift-I or choosing Show Info from the Tools menu). The Info window has a number of panes, selected through a pop-up menu, which allow you to set attributes, adjust size, and perform other operations. The AppleScript pane is shown in <span class="content_text">Figure 2-9</span> and described in <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-TPXREF162">“Interface Connections.”</a></span></p></li></ul><a name="//apple_ref/doc/uid/20001250-TPXREF162" title="Interface Connections"></a><h3>Interface Connections</h3><p>Interface Builder provides the AppleScript pane in the Info window to connect objects in an application’s user interface to application scripts. You create connections so that when a user performs an action, such as typing text, clicking a button, or choosing a menu command, the application calls the appropriate handler to deal with that action.</p><p>To connect a handler, you select a user interface item in an Interface Builder window, then open the Info window by typing Command-Shift-I or choosing Show Info from the Tools menu. Use the pop-up menu at the top of the window to choose the AppleScript pane. <span class="content_text">Figure 2-9</span> shows the Info window for a button in the Hello World application, described in <span class="content_text"><a href="../chapter02/studio_about_book.html#//apple_ref/doc/uid/20001249-TPXREF130">“Creating a Hello World Application.”</a></span></p><br/><div><a name="//apple_ref/doc/uid/20001250-CEGFGAGF" title="Figure 2-9The Info window for a button"></a><p><strong>Figure 2-9&nbsp;&nbsp;</strong>The Info window for a button</p><img src = "../art/hw_button_info.gif" alt = "The Info window for a button" width="307" height="463"></div><br/><p>The AppleScript pane provides the ability to</p><ul class="spaceabove"><li class="li"><p>select any available event handlers for an object</p><p>The Info window shows all the event handlers available to objects of the current class (in this case, the button object is an instance of NSButton). That may include handlers inherited from superclasses.</p><p>Event handlers are grouped by function. You click the checkbox for any group to connect all handlers in that group, or click one or more checkboxes within a group to connect individual handlers.</p></li><li class="li"><p>assign selected event handlers to an existing script or to a new script you create</p><p>Any existing scripts in your application appear in the Script list. You click the New Script button to create a new script, which is added to the list of scripts. </p><p>To assign a handler to a script, check the handler, select the checkbox for the script, then click the Edit Script button. This automatically switches to an editor window in Xcode for the selected script. Xcode inserts an empty handler for the event, such as the following <code>clicked</code> handler:</p><div class="codesample"><table><tr><td scope="row"><pre>on clicked theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    (*Add your script here.*)<span></span></pre></td></tr><tr><td scope="row"><pre>end clicked<span></span></pre></td></tr></table></div><p>You can then add any desired script statements to the handler.</p></li><li class="li"><p>identify objects by an automatically assigned index, or by a name you supply</p><p>The button object in <span class="content_text">Figure 2-9</span> has index 1, meaning it is the first button in the window. You can also type a name in the Name field. Then, from within your scripts, you can refer to the object by either name or index. You can also manipulate objects in scripts by ID, but AppleScript Studio and Interface Builder do not supply a mechanism for obtaining the ID while creating the interface.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001250-DontLinkElementID_18" title="Note"></a><p><strong>Note:</strong>&nbsp; Identifying an object in a script by its unique ID is generally safer than using an index number, which can change during script execution.</p></div></li></ul><p>You can use the AppleScript pane in the Info window to examine the event handler definitions for all available handlers for a particular object. Just select all the checkboxes, choose a script, and click the Edit Script button. Xcode inserts an empty handler for every selected event.</p><p>As mentioned in <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-TPXREF161">“Interface Creation,”</a></span> the Info window provides panes for performing many operations, such as setting the enabled state and other attributes of an object. The tutorial chapters in this document describe how to perform operations with the Info window, and you can also read about those operations in Interface Builder Help. It is possible to use the Info window to hook up objects to Cocoa class methods. See the Cocoa documentation described in <span class="content_text"><a href="../chapter01/studio_intro_book.html#//apple_ref/doc/uid/20001248-CIHDAGAF">“See Also”</a></span> for more information.</p><a name="//apple_ref/doc/uid/20001250-TPXREF138" title="Cocoa Framework Overview"></a><h2>Cocoa Framework Overview</h2><p>While a previous section described AppleScript as the driving force behind AppleScript Studio, the Cocoa application framework provides the key technology for creating AppleScript Studio applications and supplying their user interfaces. This section provides a brief overview of features of the Cocoa framework.</p><p>The <strong>Cocoa framework</strong> is an object-oriented application framework. It pulls together two other frameworks, the AppKit and Foundation frameworks. Together, the classes and resources in these frameworks provide the basic building blocks for sophisticated Mac OS X applications.</p><p>The <strong>Foundation framework</strong> defines a layer of useful primitive object classes, including support for Unicode strings, allocation and deallocation of objects, arrays and collections, dates, ports, and more. The <strong>AppKit framework</strong> provides classes for a graphical, event-driven user interface, including windows, buttons, text fields, and more.</p><p>These frameworks are located in <code>/System/Library/Frameworks</code>, along with the other frameworks available with Mac OS X.</p><a name="//apple_ref/doc/uid/20001250-TPXREF168" title="Cocoa Scripting Support"></a><h3>Cocoa Scripting Support</h3><p>Cocoa applications can take advantage of automated scripting support supplied by the Foundation and AppKit frameworks. With the help of a scripting definition supplied by the application itself, this support converts incoming Apple events into script command objects that access application objects automatically to perform the specified operation. This mechanism makes it very easy to provide basic scripting support, such as responding to Apple events by manipulating scriptable objects and data in the application.</p><p>To turn on Cocoa’s built-in scripting support, an application must link with the AppKit and Foundation frameworks, and must also add a key to its <code>Info.plist</code> file:</p><div class="codesample"><table><tr><td scope="row"><pre>NSAppleScriptEnabled = YES<span></span></pre></td></tr></table></div><p>When you choose an AppleScript Studio project template in Xcode, this key is automatically added to your application’s <code>Info.plist</code> file.</p><p>AppleScript Studio uses an additional framework, the AppleScriptKit framework, to enhance the built-in scriptability available to Cocoa applications. That framework is described in <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-BCIEJFED">“AppleScriptKit Framework Overview.”</a></span> For information on how to use this framework with your Cocoa application, see <span class="content_text"><a href="../chapter05/studio_cookbook.html#//apple_ref/doc/uid/20001252-BCIIGFGD">“Adding AppleScript Studio Support to Your Cocoa Application.”</a></span></p><a name="//apple_ref/doc/uid/20001250-BAJHAAGF" title="Cocoa User Interface Objects"></a><h3>Cocoa User Interface Objects</h3><p>Cocoa provides a wide variety of user interface objects for use in your application. These objects range from the basic (buttons, checkboxes, text fields) to the sophisticated (windows, panes, tabs, browsers). You add these items to your application’s user interface with Interface Builder, as described in <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-TPXREF161">“Interface Creation.”</a></span> That section describes how to view the available objects in Interface Builder’s Palette window, shown in <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-BAJEEGIG">Figure 2-7</a></span>.</p><p>Another way to examine the user interface objects available in AppleScript Studio is to build the various applications distributed with AppleScript Studio. These applications are described in <span class="content_text"><a href="../chapter02/studio_about_book.html#//apple_ref/doc/uid/20001249-CJBJBFAA">“AppleScript Studio Sample Applications.”</a></span></p><p>The user interface objects you use in AppleScript Studio are instances of Cocoa classes defined in the AppKit framework. These classes are part of an application framework that provides many sophisticated features for creating object-oriented applications. For more information, see the Cocoa documentation described in <span class="content_text"><a href="../chapter01/studio_intro_book.html#//apple_ref/doc/uid/20001248-CIHDAGAF">“See Also.”</a></span></p><p>Scripters can access these user interface classes through the terminology provided by AppleScript Studio. <span class="content_text"><a href="../chapter04/studio_detail.html#//apple_ref/doc/uid/20001251-CJBGBHIF">“AppleScript Studio Terminology”</a></span> describes AppleScript Studio’s script suites, which specify the available objects and events you can use in AppleScript Studio scripts.</p><a name="//apple_ref/doc/uid/20001250-TPXREF177" title="Cocoa Application Framework"></a><h3>Cocoa Application Framework</h3><p>Because Cocoa is a full-featured application framework, just building the default application from a Cocoa project template results in an application that is ready to do real work, including displaying its interface and responding to user actions.</p><p>AppleScript Studio applications take advantage of the Cocoa framework, which works “behind the curtain” to display the interface, respond to user actions, and more. But there is very little visible Cocoa code required for an AppleScript Studio application (see <span class="content_text">Listing 2-1</span>). As a result, scripters gain the ability to create complex interfaces, work in a powerful development environment, and control applications using AppleScript script statements.</p><a name="//apple_ref/doc/uid/20001250-CJBDAACD" title="Listing 2-1Full Objective-C code for a simple AppleScript Studio application"></a><p class="codesample"><strong>Listing 2-1&nbsp;&nbsp;</strong>Full Objective-C code for a simple AppleScript Studio application</p><div class="codesample"><table><tr><td scope="row"><pre>extern int NSApplicationMain(int argc, const char *argv[]);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>int main(int argc, const char *argv[])<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    return NSApplicationMain(argc, argv);<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>In <span class="content_text">Listing 2-1</span>, the main function calls <code>NSApplicationMain</code> to create an application object, load the application’s main nib file (thus creating the interface), and call the application object’s <code>run</code> method. The application object’s main task is to receive events and distribute them to the objects in the application that should respond to them. For example, all keyboard and mouse events go directly to the window object associated with the event. In an AppleScript Studio application, these events can then be dispatched to script event handlers (described in the next section) associated with user interface objects.</p><p>Although you can create applications that perform virtually all of their operations by executing AppleScript scripts, you are free to include additional Cocoa code in applications. And if you want to know more about the Cocoa code working behind the scenes, see the Cocoa documentation described in <span class="content_text"><a href="../chapter01/studio_intro_book.html#//apple_ref/doc/uid/20001248-CIHDAGAF">“See Also.”</a></span></p><a name="//apple_ref/doc/uid/20001250-BCIEJFED" title="AppleScriptKit Framework Overview"></a><h2>AppleScriptKit Framework Overview</h2><p>Any Cocoa application can take advantage of automated scripting support supplied by the Foundation and AppKit frameworks. AppleScript Studio uses an additional framework, the <strong>AppleScriptKit framework</strong>, to supply advanced Cocoa scripting support that allows AppleScript Studio applications to work with Cocoa user interface objects in scripts. All AppleScript Studio applications automatically link with this framework.Cocoa applications can also link with it, as described in <span class="content_text"><a href="../chapter05/studio_cookbook.html#//apple_ref/doc/uid/20001252-BCIIGFGD">“Adding AppleScript Studio Support to Your Cocoa Application.”</a></span></p><p>When you install AppleScript Studio, the AppleScriptKit framework is installed in <code>/System/Library/Frameworks</code>. The framework is also installed automatically with Mac OS X version 10.1.2 and later, so even users who haven’t installed AppleScript Studio can use your Studio applications if they have installed the corresponding version of Mac OS X. See <span class="content_text"><a href="../requirements/scriptStudio_requirements.html#//apple_ref/doc/uid/20001260-TPXREF101">“AppleScript Studio System Requirements and Version Information”</a></span> for details on how to determine what version (if any) of AppleScript Studio is installed.</p><p>The primary importance of <code>AppleScriptKit.framework</code> to scripters is that it supplies the scripting terminology you use to access user interface objects in AppleScript Studio scripts. You can read about this terminology in <span class="content_text"><a href="../chapter04/studio_detail.html#//apple_ref/doc/uid/20001251-CJBGBHIF">“AppleScript Studio Terminology”</a></span> and find instructions on how to display it in <span class="content_text"><a href="studio_components.html#//apple_ref/doc/uid/20001250-BAJBFHJJ">“Terminology Browser.”</a></span> For very detailed terminology reference, see <em><a href="../../../Reference/StudioReference/index.html#//apple_ref/doc/uid/TP30000892" target="_top">AppleScript Studio Terminology Reference</a></em>.</p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../chapter02/studio_about_book.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../chapter04/studio_detail.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2001, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-04-04<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/chapter03/studio_components.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/chapter03/studio_components.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/chapter03/studio_components.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>