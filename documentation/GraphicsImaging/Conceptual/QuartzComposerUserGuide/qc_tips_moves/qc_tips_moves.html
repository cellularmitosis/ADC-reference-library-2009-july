<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Quartz Composer User Guide: Basic and Advanced Tasks, Tips, and Tricks</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Basic and Advanced Tasks, Tips, and Tricks"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40005381-CH203" title="Basic and Advanced Tasks, Tips, and Tricks"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000424" target="_top">Graphics &amp; Imaging</a> &gt; <a href="../../../Tools-date.html#//apple_ref/doc/uid/TP30000440-TP30000424-TP30000463" target="_top">Tools</a> &gt; <a href="../qc_intro/qc_intro.html#//apple_ref/doc/uid/TP40005381-CH201-TPXREF101">Quartz Composer User Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../qc_editor/qc_editor.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../qc_tutorial/qc_tutorial.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40005381-CH203-TPXREF101" title="Basic and Advanced Tasks, Tips, and Tricks"></a><h1>Basic and Advanced Tasks, Tips, and Tricks</h1><p>This chapter describes how to use the editor to add patches to the workspace and connect them, inspect the values of input and output ports, and publish ports. You’ll learn tips and shortcuts for getting the Quartz Composer development environment to support your working style. You’ll see how to use some of the advanced features including templates and patches that process code.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="qc_tips_moves.html#//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_25">Adding Patches</a>
				
			<br/>
			
        
			
			
				<a href="qc_tips_moves.html#//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_26">Making Connections Between Patches</a>
				
			<br/>
			
        
			
			
				<a href="qc_tips_moves.html#//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_27">Inspecting Port Values</a>
				
			<br/>
			
        
			
			
				<a href="qc_tips_moves.html#//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_28">Finding Out What a Patch Does</a>
				
			<br/>
			
        
			
			
				<a href="qc_tips_moves.html#//apple_ref/doc/uid/TP40005381-CH203-SW19">Setting Preferences</a>
				
			<br/>
			
        
			
			
				<a href="qc_tips_moves.html#//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_29">Keyboard Shortcuts</a>
				
			<br/>
			
        
			
			
				<a href="qc_tips_moves.html#//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_30">Commenting a Composition</a>
				
			<br/>
			
        
			
			
				<a href="qc_tips_moves.html#//apple_ref/doc/uid/TP40005381-CH203-SW6">Comparing Compositions</a>
				
			<br/>
			
        
			
			
				<a href="qc_tips_moves.html#//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_31">Checking Patch Compatibility and Security</a>
				
			<br/>
			
        
			
			
				<a href="qc_tips_moves.html#//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_32">Improving Rendering Performance</a>
				
			<br/>
			
        
			
			
				<a href="qc_tips_moves.html#//apple_ref/doc/uid/TP40005381-CH203-SW15">Adding a Clip to the Patch Creator</a>
				
			<br/>
			
        
			
			
				<a href="qc_tips_moves.html#//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_33">Using Templates</a>
				
			<br/>
			
        
			
			
				<a href="qc_tips_moves.html#//apple_ref/doc/uid/TP40005381-CH203-SW7">Using Programming Patches</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_25" title="Adding Patches"></a><h2>Adding Patches</h2><p>There are three ways to add a patch from the Patch Creator:</p><ul class="ul"><li class="li"><p>Press Return to add the patch whose name is selected.</p></li><li class="li"><p>Double-click a patch name.</p></li><li class="li"><p>Drag a patch name to the workspace.</p></li></ul><p>To duplicate a patch that’s already in the workspace, select the patch and press Command-D.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_63" title="Tip"></a><p><strong>Tip:</strong>&nbsp;Instead of adding an Image Importer patch, you can drag an image from the Finder directly to the workspace. Quartz Composer automatically creates an instance of the Image Importer patch and uses the name of the image as the title of the patch. Quartz Composer provides a similar convenience for movies. Instead of adding a Movie Loader patch, simply drag a QuickTime move from the Finder to the workspace.</p></div><a name="//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_26" title="Making Connections Between Patches"></a><h2>Making Connections Between Patches</h2><p>Connections between input and output ports of different patches establish a data flow in a composition. Simply click the output port, then click the input port you want to connect—you don’t need to hold down the mouse button while you move to the input port. Note that you can establish a connection only between ports that have compatible types—they must have the same type or a type conversion must be possible. </p><p>To break a connection between patches, either double-click the input port or drag the connector and release it. The connector disappears. <span class="content_text">Figure 3-1</span> shows some typical connections between patches.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_64" title="Tip"></a><p><strong>Tip:</strong>&nbsp;You can redirect  an existing connection by clicking the connection at the input port and then clicking another compatible input port. This action is similar to dragging, but you can release the mouse button while you move to the input port.</p></div><br/><div><a name="//apple_ref/doc/uid/TP40005381-CH203-SW8" title="Figure 3-1Patch connections"></a><p><strong>Figure 3-1&nbsp;&nbsp;</strong>Patch connections</p><img src = "../art/patch_connections.jpg" alt = "Patch connections" ></div><br/><p>The output from a patch can connect to the input of more than one patch. For example, the Result output port of the LFO patch (<span class="content_text">Figure 3-1</span>) provides input to the Math patch and to the Sprite patch.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_65" title="Tip"></a><p><strong>Tip:</strong>&nbsp;You can connect the output of a port to multiple input ports by holding down the Option key while clicking on each of the input ports.</p></div><a name="//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_27" title="Inspecting Port Values"></a><h2>Inspecting Port Values</h2><p>Hover the pointer over a port to view a short description of the port, its data type, and the current value. (See  <span class="content_text">Figure 3-2</span>.) If the input port is not an object port, you can edit the port value by double-clicking the circle associated with the port, entering the new value in the text editor, and then pressing the Return key to validate the value or the Escape key to cancel. Note that input ports have a default value, which is always null for object ports.</p><br/><div><a name="//apple_ref/doc/uid/TP40005381-CH203-SW9" title="Figure 3-2A help tag for an input port"></a><p><strong>Figure 3-2&nbsp;&nbsp;</strong>A help tag for an input port</p><img src = "../art/help_tag.jpg" alt = "A help tag for an input port" ></div><br/><p>You can also inspect and set the values for input ports  by opening the inspector and displaying the Input Parameters pane or by clicking the Patch Parameters button in the editor to toggle the input parameters pane.  </p><p>You can’t set the value for output ports, but you can view them. Image ports show a thumbnail representation of the image, as shown in <span class="content_text">Figure 3-3</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP40005381-CH203-SW10" title="Figure 3-3Image ports display a thumbnail image"></a><p><strong>Figure 3-3&nbsp;&nbsp;</strong>Image ports display a thumbnail image</p><img src = "../art/output_hover.jpg" alt = "Image ports display a thumbnail image" ></div><br/><a name="//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_28" title="Finding Out What a Patch Does"></a><h2>Finding Out What a Patch Does</h2><p>When you select a patch in the Patch Creator, its description appears in the Description pane. But if you are working with a patch in the workspace, you can hover the pointer over the patch title bar to see a help tag  that contains the name, category, and patch description, as shown in <span class="content_text">Figure 3-4</span>. </p><br/><div><a name="//apple_ref/doc/uid/TP40005381-CH203-SW11" title="Figure 3-4The patch description appears in a help tag"></a><p><strong>Figure 3-4&nbsp;&nbsp;</strong>The patch description appears in a help tag</p><img src = "../art/patch_documentation.jpg" alt = "The patch description appears in a help tag" ></div><br/><a name="//apple_ref/doc/uid/TP40005381-CH203-SW19" title="Setting Preferences"></a><h2>Setting Preferences</h2><p>Quartz Composer lets you set preferences for the editor, the workspace, and the viewer, and manage clips. By default,  when you launch Quartz Composer it displays templates that you can choose from. If you prefer, you can turn off that option in the General pane of Quartz Composer preferences and choose from among the options shown in <span class="content_text">Figure 3-5</span>. You can also set whether the editor and viewer are visible when you open a composition and enable autosaving.</p><br/><div><a name="//apple_ref/doc/uid/TP40005381-CH203-SW5" title="Figure 3-5The General pane of Quartz Composer preferences"></a><p><strong>Figure 3-5&nbsp;&nbsp;</strong>The General pane of Quartz Composer preferences</p><img src = "../art/editor_preferences.jpg" alt = "The General pane of Quartz Composer preferences" ></div><br/><p>Editor preferences include options that affect the appearance of the workspace (colors, shadows, grid) and the behavior of the Patch Creator.</p><p>You can set and define aspect ratios in the Viewer pane. You can also set up options for debugging, full-screen mode, and the rendering frame rate. </p><p>The Clips  pane lets you remove and edit clips, and view and edit clip information.</p><a name="//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_29" title="Keyboard Shortcuts"></a><h2>Keyboard Shortcuts</h2><p><span class="content_text">Table 3-1</span> summarizes the keyboard shortcuts for many of the actions available in the editor window.</p><a name="//apple_ref/doc/uid/TP40005381-CH203-SW1" title="Table 3-1Shortcuts for common actions in the editor window"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 3-1&nbsp;&nbsp;</strong>Shortcuts for common actions in the editor window</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Action</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Shortcut</p></th></tr><tr><td  scope="row"><p>Add a note</p></td><td ><p>Control-Click the workspace</p></td></tr><tr><td  scope="row"><p>Fast zoom in or out</p></td><td ><p>Press Command as you use the scroll wheel</p></td></tr><tr><td  scope="row"><p>View all temporarily</p></td><td ><p>Press and hold the = key. When you release the key, the view snaps back. This is a good way to get your bearings in a complex composition.</p></td></tr><tr><td  scope="row"><p>Show the Patch Creator</p></td><td ><p>Command-Return</p></td></tr><tr><td  scope="row"><p>Compare compositions</p></td><td ><p>Option-Command-O</p></td></tr><tr><td  scope="row"><p>Create macro</p></td><td ><p>Shift-Command-M</p></td></tr><tr><td  scope="row"><p>Show hierarchy browser</p></td><td ><p>Command-B</p></td></tr><tr><td  scope="row"><p>Show input parameters</p></td><td ><p>Command-T</p></td></tr><tr><td  scope="row"><p>Create sticky inspector</p></td><td ><p>Command-double-click</p></td></tr><tr><td  scope="row"><p>Show inspector</p></td><td ><p>Command-I</p></td></tr><tr><td  scope="row"><p>Edit information</p></td><td ><p>Option-Command-I</p></td></tr><tr><td  scope="row"><p>Edit protocol conformance</p></td><td ><p>Option-Command-P</p></td></tr><tr><td  scope="row"><p>Customize the toolbar</p></td><td ><p>Command-click the toolbar and chose Customize Toolbar</p></td></tr><tr><td  scope="row"><p>Show viewer</p></td><td ><p>Shift-Command-V</p></td></tr><tr><td  scope="row"><p>Show editor</p></td><td ><p>Shift-Command-E</p></td></tr></table></div><p><span class="content_text">Table 3-2</span> summarizes the keyboard shortcuts for the actions available in the viewer window.</p><a name="//apple_ref/doc/uid/TP40005381-CH203-SW2" title="Table 3-2Shortcuts for common actions in the viewer window"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 3-2&nbsp;&nbsp;</strong>Shortcuts for common actions in the viewer window</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Action</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Shortcut</p></th></tr><tr><td  scope="row"><p>Run the viewer</p></td><td ><p>Command-R</p></td></tr><tr><td  scope="row"><p>Stop rendering</p></td><td ><p>Command-.</p></td></tr><tr><td  scope="row"><p>Save snapshot</p></td><td ><p>Shift-Command-C</p></td></tr><tr><td  scope="row"><p>Enable full-screen mode</p></td><td ><p>Command-F</p></td></tr><tr><td  scope="row"><p>Performance rendering mode</p></td><td ><p>Shift-Command-R</p></td></tr><tr><td  scope="row"><p>Debug rendering mode</p></td><td ><p>Shift-Command-D</p></td></tr><tr><td  scope="row"><p>Profile rendering mode</p></td><td ><p>Shift-Command-L</p></td></tr><tr><td  scope="row"><p>Customize the toolbar</p></td><td ><p>Control-click the toolbar and chose Customize Toolbar</p></td></tr></table></div><a name="//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_30" title="Commenting a Composition"></a><h2>Commenting a Composition</h2><p>Commenting code is good practice, whether it’s in a program that uses a traditional coding language or in a composition. Quartz Composer provides three items that support  comments for all patches:</p><ul class="ul"><li class="li"><p>The  properties list. You can view and change items in this list by choosing Editor > Editor Information. </p></li><li class="li"><p>The patch title. You can change the default patch title to a more meaningful one for your composition by double-clicking the title.</p></li><li class="li"><p>Notes. You can add a note to the workspace by Control-clicking an empty area. A note that you can resize and type text into appears. <span class="content_text">Figure 3-6</span> show part of a complex composition that uses two notes. You type the text in the opaque area of the note, and the translucent area gives an indication of which patches the note pertains to. Control-click the note to view the contextual menu that lets you set the color. The example in <span class="content_text">Figure 3-6</span> shows short notes, but you can enter as much text as you like—several paragraphs or more. The opaque area expands with the amount of text.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP40005381-CH203-SW3" title="Figure 3-6Two notes used to comment a complex composition"></a><p><strong>Figure 3-6&nbsp;&nbsp;</strong>Two notes used to comment a complex composition</p><img src = "../art/notes_comments.jpg" alt = "Two notes used to comment a complex composition" ></div></li></ul><p>You can provide comments for programming patches directly in patch, along with the code that you provide. </p><a name="//apple_ref/doc/uid/TP40005381-CH203-SW6" title="Comparing Compositions"></a><h2>Comparing Compositions</h2><p>There are several reasons why you might want to compare two compositions. The most typical is to see how two versions of a composition differ. Choosing File > Compare Compositions opens a window that provides several comparison options. You can compare patch connections, parameters, and settings by clicking the appropriate controls at the top right of the window. (See <span class="content_text">Figure 3-7</span>). You can compare patch parameter views for each composition in the bottom portion of the window. </p><p>What’s unique about this window is that you  can also compare the compositions visually, and in a variety of interesting ways. In the lower part of the window, you can select an overlay method or whether to view the compositions side by -side. You can also choose to view the patch parameters.</p><br/><div><a name="//apple_ref/doc/uid/TP40005381-CH203-SW4" title="Figure 3-7Comparing compositions"></a><p><strong>Figure 3-7&nbsp;&nbsp;</strong>Comparing compositions</p><img src = "../art/comp_compare.jpg" alt = "Comparing compositions" ></div><br/><a name="//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_31" title="Checking Patch Compatibility and Security"></a><h2>Checking Patch Compatibility and Security</h2><p>Staring in Mac OS X v10.5, Quartz Composer can provide information on whether a patch is compatible with Mac OS X v10.4. You can also find out whether a patch could compromise security. Security information is important if you plan to embed a composition in a webpage or widget, or export it as a QuickTime movie. Webpages, widgets, and QuickTime movies won’t render compositions that contain unsafe patches. (For more information on embedding compositions in webpages and widgets, see <em><a href="../../QuartzComposer/index.html#//apple_ref/doc/uid/TP40001357" target="_top">Quartz Composer Programming Guide</a></em>.)</p><p>To check the compatibility of patches in a composition, choose Editor > Display 10.4 Compatibility Information. Patches that are not compatible with Mac OS X v10.4 display a small red icon with a white “x”. Patches that display a yellow icon with an exclamation point identify patches that might not be compatible because the patch was revised in some way, such as with additional input ports or changed settings. If you hover the pointer over the small icon, the tool tip for the patch provides more information about compatibility, such as what’s changed or that the patch is new.</p><p>To check whether any patches in a composition are unsafe, choose Editor > Indicate Unsafe Patches. Patches that are not safe display a small key icon.</p><p><span class="content_text">Figure 3-8</span> shows a variety of patches after choosing the compatibility and unsafe patches commands. The Image Importer shows a caution icon because the latest version has an additional setting that is not available in Mac OS X v10.4. The Area Histogram and Grep patches are new in Mac OS X v10.5. The Parallelogram Tile patch does not display any icons because it is compatible with Mac OS X v10.4 and it is a secure patch. The Bonjour and MIDI Clock Receiver patches are unsafe patches. Note that the MIDI Clock Receiver patch also has a caution icon because its settings changed since Mac OS X v10.4.</p><br/><div><a name="//apple_ref/doc/uid/TP40005381-CH203-SW18" title="Figure 3-8Compatibility and security information"></a><p><strong>Figure 3-8&nbsp;&nbsp;</strong>Compatibility and security information</p><img src = "../art/compatability.jpg" alt = "Compatibility and security information" ></div><br/><a name="//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_32" title="Improving Rendering Performance"></a><h2>Improving Rendering Performance</h2><p>To reduce execution time and improve rendering performance:</p><ul class="ul"><li class="li"><p>Limit image size to the dimensions you need.</p></li><li class="li"><p>Don’t use RGBA images for masks.</p></li><li class="li"><p>Make sure that the Render In Image patch is configured appropriately. The information in the Settings pane of the Patch inspector can help you choose the appropriate settings.</p></li><li class="li"><p>Set the Enable input of consumer patches to <code>false</code> whenever possible.</p></li><li class="li"><p>While in debug mode, minimize the number of patches that you use.</p></li><li class="li"><p>Don’t draw unnecessarily. For example, don’t draw 200 sprites when 50 would suffice.</p></li><li class="li"><p>Design your composition to adapt to hardware features.</p></li><li class="li"><p>If you intend for your composition to run on a variety of hardware, you might want to avoid Core Image effects. These effects perform best when Core Image uses the GPU. The CPU fallback, if needed, can cause your composition to render less optimally.</p></li></ul><a name="//apple_ref/doc/uid/TP40005381-CH203-SW15" title="Adding a Clip to the Patch Creator"></a><h2>Adding a Clip to the Patch Creator</h2><p>If you find yourself assembling and connecting the same set of patches repeatedly, you may want to create a clip. </p><p>Follow these steps to add a clip to the Patch Creator:</p><ol class="ol"><li class="li"><p>In the editor window of your composition, select the set of patches that you want to create a clip from.</p></li><li class="li"><p>Choose Editor > Create Clip.</p></li><li class="li"><p>Enter the clip name into the sheet that appears, along with copyright information and a description.</p></li><li class="li"><p>Click Done.</p></li></ol><p>Your new clip is now available in the Patch Creator. The name you entered in step 3 shows in the Patch Name list and the description shows in the Description box. </p><div class="notebox"><a name="//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_66" title="Note"></a><p><strong>Note:</strong>&nbsp;Quartz Composer stores clips in <code>/Developer/Library/Quartz Composer/Clips</code>.</p></div><a name="//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_33" title="Using Templates"></a><h2>Using Templates</h2><p>A template is a handy way to start from a preconfigured composition.</p><p>To make a composition available as a reusable template from within Quartz Composer, copy the composition file to this directory:</p><ul class="ul"><li class="li"><p><code>/Developer/Library/Quartz Composer/Templates</code></p></li></ul><p>To use the template later, choose File > New From Template.</p><p>Quartz Composer provides a number of templates that conform to protocols (see <span class="content_text"><a href="../qc_concepts/qc_concepts.html#//apple_ref/doc/uid/TP40005381-CH212-SW12">“Composition Repository”</a></span>). The templates you create are not required to conform to a protocol unless you want compositions created with your template to reside in the composition repository. </p><a name="//apple_ref/doc/uid/TP40005381-CH203-SW7" title="Using Programming Patches"></a><h2>Using Programming Patches</h2><p>Although you can use Quartz Composer to create powerful motion graphics without any code, the ability to write code within programming patches provides additional flexibility for  Core Image, JavaScript, and OpenGL programmers.</p><a name="//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_34" title="The Core Image Filter Patch"></a><h3>The Core Image Filter Patch</h3><p>The Core Image Filter programming patch is extremely useful for creating custom image processing filters. To use this patch effectively, you need to understand Core Image filters and be familiar with the Core Image kernel language, which is an extension to the OpenGL Shading Language. Two good sources of information on writing Core Image filters are <em><a href="../../CoreImaging/index.html#//apple_ref/doc/uid/TP30001185" target="_top">Core Image Programming Guide</a></em> and <em><a href="../../../Reference/CIKernelLangRef/index.html#//apple_ref/doc/uid/TP40004397" target="_top">Core Image Kernel Language Reference</a></em>. <em><a href="../../ImageUnitTutorial/index.html#//apple_ref/doc/uid/TP40004531" target="_top">Image Unit Tutorial</a></em> provides additional details on writing kernel routines and contains several kernel examples.</p><p><span class="content_text">Figure 3-9</span> shows the Settings window for the  Core Image Filter programming patch. You enter code for a kernel directly into this window. You can provide more than one kernel routine if you like, but it must be written using the Core Image Kernel Language. </p><br/><div><a name="//apple_ref/doc/uid/TP40005381-CH203-SW20" title="Figure 3-9The Settings window for the Core Image Filter patch"></a><p><strong>Figure 3-9&nbsp;&nbsp;</strong>The Settings window for the Core Image Filter patch</p><img src = "../art/cifilter_one_window.jpg" alt = "The Settings window for the Core Image Filter patch" ></div><br/><p>Quartz Composer automatically creates input ports for the patch based on the prototype of the kernel function that you supply in this window. Kernel input parameters whose type are <code>float</code>,<code>vec2</code>, <code>vec3</code>, and <code>vec4</code> become number input ports. A <code>__color</code> data type becomes a color input port. A <code>sampler</code> data type becomes an image port. If you change the name of a kernel function parameter, you’ll break the connections to the related input port. The patch has a single output image that represents the result produced by the kernel.</p><p>Selecting Show Advanced Input Sampler Options adds two input ports to the patch—one for specifying a wrapping mode (transparent or clamp) and another for specifying whether to use linear or nearest neighbor sampling. </p><p>When you select Edit Filter Function, a text field appears at the bottom of the Settings pane, as shown in <span class="content_text">Figure 3-10</span>. You can use this to define an ROI function (if one is needed) and a main function. You use JavaScript for the code in this window and wrapper functions provided by Quartz Composer. The main function must return an image (<code>__image</code>) and must follow this form: </p><div class="codesample"><table><tr><td scope="row"><pre>function __image main([arg_type_0] arg_0, [arg_type_1] arg_1, ...)<span></span></pre></td></tr></table></div><p>where arguments are of any of the following types:</p><p><code> __image</code>, <code>__vec2</code>, <code>__vec3</code>, <code>__vec4</code>, <code>__color</code>, <code>__number</code>, <code>__index</code></p><br/><div><a name="//apple_ref/doc/uid/TP40005381-CH203-SW13" title="Figure 3-10The filter editing window"></a><p><strong>Figure 3-10&nbsp;&nbsp;</strong>The filter editing window</p><img src = "../art/cif_settings.jpg" alt = "The filter editing window" ></div><br/><p>This patch supports Core Image filters of varying complexity, including:</p><ul class="spaceabove"><li class="li"><p>Single kernel, single pass filters for which the region of interest (ROI) and domain of definition (DOD) coincide. For this type of filter, you need only to provide a kernel function in the top window, such as the <code>multiplyEffect</code> kernel shown in <span class="content_text">Figure 3-10</span>.</p></li><li class="li"><p>Filters for which one or more kernels require you to define the region of interest. In this case, you use the bottom window to define an ROI function, and then supply a main routine in the bottom window to apply to the kernel function defined in the top window.</p></li><li class="li"><p>Multipass filters. You use a main function in the bottom window to apply multiple kernels or Core Image filters. You can apply any of the kernel functions that you define in the top window as well as any Core Image filter. Quartz Composer supplies wrappers for <code><a href="../../../Reference/QuartzCoreFramework/Classes/CIFilterShape_Class/Reference/Reference.html#//apple_ref/occ/cl/CIFilterShape" target="_top">CIFilterShape</a></code> and <code><a href="../../../../Cocoa/Reference/Foundation/Classes/NSAffineTransform_Class/Reference/Reference.html#//apple_ref/occ/cl/NSAffineTransform" target="_top">NSAffineTransform</a></code>. See <span class="content_text"><a href="qc_tips_moves.html#//apple_ref/doc/uid/TP40005381-CH203-SW14">Listing 3-1</a></span>.</p></li></ul><a name="//apple_ref/doc/uid/TP40005381-CH203-SW14" title="Listing 3-1A multipass filter that uses Core Image filters"></a><p class="codesample"><strong>Listing 3-1&nbsp;&nbsp;</strong>A multipass filter that uses Core Image filters</p><div class="codesample"><table><tr><td scope="row"><pre>// Assume myKernel is a routine defined in the top window.<span></span></pre></td></tr><tr><td scope="row"><pre>// This code is the main function defined in the bottom window.<span></span></pre></td></tr><tr><td scope="row"><pre>function __image main (__image image, __vec4 color){<span></span></pre></td></tr><tr><td scope="row"><pre>    var image1, image2;<span></span></pre></td></tr><tr><td scope="row"><pre>    var transform;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // Apply the kernel that's defined in the top window.<span></span></pre></td></tr><tr><td scope="row"><pre>    image1 = myKernel.apply(image.extent, null, image);<span></span></pre></td></tr><tr><td scope="row"><pre>    // Apply the Core Image Sepia filter.<span></span></pre></td></tr><tr><td scope="row"><pre>    image2 = Filter.sepiaTone(image1, 1.0);<span></span></pre></td></tr><tr><td scope="row"><pre>    // Set up and apply a transform<span></span></pre></td></tr><tr><td scope="row"><pre>    transform = new AffineTransform().scale(0.5);<span></span></pre></td></tr><tr><td scope="row"><pre>    return Filter.affineTransform(image2,transform);<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_35" title="The GLSL Patch"></a><h3>The GLSL Patch</h3><p>The GLSL patch (see <span class="content_text">Figure 3-11</span>) uses the vertex and fragment shaders you provide to render a result. You need to use the OpenGL Shading Language to write the shaders. </p><p>You can find several examples of compositions that use the GLSL patch in:</p><p><code>/Developer/Examples/Quartz Composer Compositions/GLSL</code></p><br/><div><a name="//apple_ref/doc/uid/TP40005381-CH203-SW12" title="Figure 3-11The GLSL programming patch"></a><p><strong>Figure 3-11&nbsp;&nbsp;</strong>The GLSL programming patch</p><img src = "../art/glsl_settings.jpg" alt = "The GLSL programming patch" ></div><br/><a name="//apple_ref/doc/uid/TP40005381-CH203-DontLinkElementID_36" title="The JavaScript Patch"></a><h3>The JavaScript Patch</h3><p>The JavaScript patch (see <span class="content_text">Figure 3-12</span>) implements the function that you provide in the Settings pane of the patch. Quartz Composer automatically creates input and output ports for the patch based on the prototype of the function. You must use these keywords to define input and output keys for your JavaScript function: <code>__number</code>, <code>__index</code>, <code>__string</code>, <code>__image</code>, <code>__structure</code>, and <code>__boolean</code>.</p><br/><div><a name="//apple_ref/doc/uid/TP40005381-CH203-SW17" title="Figure 3-12The JavaScript programming patch"></a><p><strong>Figure 3-12&nbsp;&nbsp;</strong>The JavaScript programming patch</p><img src = "../art/javascript_settings.jpg" alt = "The JavaScript programming patch" ></div><br/>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../qc_editor/qc_editor.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../qc_tutorial/qc_tutorial.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2004, 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-07-17<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/GraphicsImaging/Conceptual/QuartzComposerUserGuide/qc_tips_moves/qc_tips_moves.html%3Fid%3DTP40005381-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/GraphicsImaging/Conceptual/QuartzComposerUserGuide/qc_tips_moves/qc_tips_moves.html%3Fid%3DTP40005381-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/GraphicsImaging/Conceptual/QuartzComposerUserGuide/qc_tips_moves/qc_tips_moves.html%3Fid%3DTP40005381-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>