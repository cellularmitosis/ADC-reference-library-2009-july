<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Predicate Programming Guide: Comparison of NSPredicate and Spotlight Query Strings</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Comparison of NSPredicate and Spotlight Query Strings"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40002370" title="Comparison of NSPredicate and Spotlight Query Strings"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../DataManagement-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000445" target="_top">Data Management</a> &gt; <a href="../index.html" target="_top">Predicate Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="pUsing.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="pSyntax.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/TP40002370-SW1" title="Comparison of NSPredicate and Spotlight Query Strings"></a><hr /><H1>Comparison of NSPredicate and Spotlight Query Strings</H1><p>Both Spotlight and <code>NSPredicate</code> implement a query string syntax, and though they are similar, they differ in several respects. One query string can be converted into the other string form, as long as the common subset of functionality is used.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="pSpotlightComparison.html#//apple_ref/doc/uid/TP40002370-SW2">Spotlight and NSPredicate</a>
				
			<br/>
			
        
			
			
				<a href="pSpotlightComparison.html#//apple_ref/doc/uid/TP40002370-SW3">Creating a Predicate Format String From a Spotlight Search in Finder</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40002370-SW2" title="Spotlight and NSPredicate"></a><h2>Spotlight and NSPredicate</h2><p>There is no special relationship between Spotlight and <code>NSPredicate</code> other than that <code>NSMetadataQuery</code> is the Cocoa interface to Spotlight, and it uses <code>NSPredicate</code> in its API. The Spotlight query string syntax is similar to, but different from, the <code>NSPredicate</code> query string syntax. You can convert one query string into the other string form, as long as you use the common subset of functionality—Spotlight's query syntax is generally more limited than <code>NSPredicate</code>'s. For a complete description of the Spotlight query expression syntax, see <span class="content_text"><a href="../../../../Carbon/Conceptual/SpotlightQuery/Concepts/QueryFormat.html#//apple_ref/doc/uid/TP40001849" target="_top">Query Expression Syntax</a></span>, and for a complete description of the <code>NSPredicate</code> string syntax, see <span class="content_text"><a href="pSyntax.html#//apple_ref/doc/uid/TP40001795-SW1">“Predicate Format String Syntax.”</a></span></p><p>Spotlight requires comparison clauses to take the form <code>"KEY operator VALUE"</code> and does not accept <code>"VALUE operator KEY"</code>. Moreover, the kinds of attribute Spotlight accepts for <code>VALUE</code> are more limited than those accepted by <code>NSPredicate</code>. As a partial consequence of this limitation, you do not always have to quote literal strings in Spotlight queries. You can omit the quotes when <code>VALUE</code> is a string and no special operators need to be applied to it. You cannot do this with an <code>NSPredicate</code> query string, as the result would be ambiguous.</p><p>The syntax for denoting case- and diacritic-insensitivity for queries in Spotlight is different from the <code>NSPredicate</code> version. In Spotlight, you append markers to the end of the comparison string (for example, <code>"myAttribute == 'foo'cd"</code>). In <code>NSPredicate</code> strings, you use the <code>like</code> operator and prefix the markers within "[]"s (for example, <code>"myAttribute like[cd] 'foo'"</code>). In both cases, <code>'cd'</code> means case-insensitive and diacritic-insensitive. Spotlight puts the modifiers on the value, <code>NSPredicate</code> puts the modifiers on the operator.</p><p>You cannot use an <code>MDQuery</code> operator as the <code>VALUE</code> of an <code>NSPredicate</code> object <code>"KEY operator VALUE"</code> string. For example, you write an "is-substring-of" expression in Spotlight like this: <code>"myAttribute = '*foo*'"</code>; in <code>NSPredicate</code> strings you use the <code>contains</code> operator, like this: <code>"myAttribute contains 'foo'"</code>. Spotlight takes glob-like expressions, <code>NSPredicate</code> uses a different operator.</p><p>If you use "<code>*</code>" as left-hand-side key in a comparison expression, in Spotlight it means "any key in the item" and can only be used with <code>==</code>.  You could only use this expression in an <code>NSPredicate</code> object in conjunction with an <code>NSMetadataQuery</code> object.  </p><a name="//apple_ref/doc/uid/TP40002370-SW3" title="Creating a Predicate Format String From a Spotlight Search in Finder"></a><h2>Creating a Predicate Format String From a Spotlight Search in Finder</h2><p>You can create a predicate format string from a search in Finder. Perform a search, save it, then select the folder where you saved it and choose Show Info—the Info panel shows the query that is used by Spotlight. Note however, that there are slight differences between the <code>NSPredicate</code> format string and the one stored in Finder. The Finder string might look like the following example.</p><div class="codesample"><table><tr><td scope="row"><pre>((* = "FooBar*"wcd)) || (kMDItemTextContent = "FooBar*"cd)<span></span></pre></td></tr><tr><td scope="row"><pre>    &amp;&amp; (kMDItemContentType != com.apple.mail.emlx)<span></span></pre></td></tr><tr><td scope="row"><pre>    &amp;&amp; (kMDItemContentType != public.vcard))<span></span></pre></td></tr></table></div><p>Typically all you have to do to convert the Spotlight query into a predicate format string is make sure the predicate does not start with <code>*</code> (this is not supported by <code>NSMetadataQuery</code> when parsing a predicate). In addition, when you want to use a wildcard, you should use <code>LIKE</code>, as shown in the following example.</p><div class="codesample"><table><tr><td scope="row"><pre>((kMDItemTextContent LIKE[cd] "FooBar")<span></span></pre></td></tr><tr><td scope="row"><pre>    &amp;&amp; (kMDItemContentType != "com.apple.mail.emlx")<span></span></pre></td></tr><tr><td scope="row"><pre>    &amp;&amp; (kMDItemContentType != "public.vcard"))<span></span></pre></td></tr></table></div>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="pUsing.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="pSyntax.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2005, 2009 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2009-05-06<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Conceptual/Predicates/Articles/pSpotlightComparison.html%3Fid%3DTP40001789-1.11&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Conceptual/Predicates/Articles/pSpotlightComparison.html%3Fid%3DTP40001789-1.11&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Conceptual/Predicates/Articles/pSpotlightComparison.html%3Fid%3DTP40001789-1.11&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
