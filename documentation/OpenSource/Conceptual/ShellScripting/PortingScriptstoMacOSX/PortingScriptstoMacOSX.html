<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Shell Scripting Primer: Designing Scripts for Cross-Platform Deployment</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Designing Scripts for Cross-Platform Deployment"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40004268-TP40003517" title="Designing Scripts for Cross-Platform Deployment"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP40003594" target="_top">Open Source</a> &gt; <a href="../../../Scripting-date.html#//apple_ref/doc/uid/TP30000440-TP40003594-TP30000569" target="_top">Scripting &amp; Automation</a> &gt; <a href="../Introduction/Introduction.html#//apple_ref/doc/uid/TP40004268-TP40003516-SW1">Shell Scripting Primer</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../Howawk-ward/Howawk-ward.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../AdvancedTechniques/AdvancedTechniques.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW2" title="Designing Scripts for Cross-Platform Deployment"></a><h1>Designing Scripts for Cross-Platform Deployment</h1><p>For the most part, scripts that run on other UNIX-based or UNIX-like platforms (Linux, for example) also run correctly on Mac OS X and vice versa. There are differences, however.</p><p>In addition to finding subtle variations in the file system hierarchy and the behavior of common command-line tools, you will also find different tools and technologies for device I/O and for adding and removing users and groups.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="PortingScriptstoMacOSX.html#//apple_ref/doc/uid/TP40004268-TP40003517-SW3">Bourne Shell Version</a>
				
			<br/>
			
        
			
			
				<a href="PortingScriptstoMacOSX.html#//apple_ref/doc/uid/TP40004268-TP40003517-SW4">Managing Users and Groups</a>
				
			<br/>
			
        
			
			
				<a href="PortingScriptstoMacOSX.html#//apple_ref/doc/uid/TP40004268-TP40003517-SW5">Working with Device I/O</a>
				
			<br/>
			
        
			
			
				<a href="PortingScriptstoMacOSX.html#//apple_ref/doc/uid/TP40004268-TP40003517-SW6">Disk Management and Partitioning</a>
				
			<br/>
			
        
			
			
				<a href="PortingScriptstoMacOSX.html#//apple_ref/doc/uid/TP40004268-TP40003517-SW7">File System Hierarchy</a>
				
			<br/>
			
        
			
			
				<a href="PortingScriptstoMacOSX.html#//apple_ref/doc/uid/TP40004268-TP40003517-SW1">General Command-Line Tool Differences</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW3" title="Bourne Shell Version"></a><h2>Bourne Shell Version</h2><p>Mac OS X provides BASH as its Bourne shell implementation. When executed as <code>/bin/sh</code>, it should be fully compatible with other implementations. However, occasionally differences may arise. The same is true of other operating systems that use BASH or ZSH as their Bourne shell implementation.</p><p>For maximum compatibility, you should carefully avoid using any BASH-specific extensions in shell scripts. If you cannot avoid <a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_270"></a><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_271"></a>BASH extensions, you should explicitly make the script execute in BASH by changing the first line to the following:</p><div class="codesample"><table><tr><td scope="row"><pre>#!/bin/bash<span></span></pre></td></tr></table></div><p>You should use a similar first line for scripts written using ZSH extensions.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW26" title="Compatibility Note"></a><p><strong>Compatibility Note:</strong>&nbsp;For detailed <a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_272"></a><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_273"></a>lists of places where BASH and ZSH differ from pure Bourne shell variants, see <span class="content_text"><a href="http://www.gnu.org/software/bash/manual/bashref.html#Major-Differences-From-The-Bourne-Shell" target="_blank">http://www.gnu.org/software/bash/manual/bashref.html#Major-Differences-From-The-Bourne-Shell</a></span> and <span class="content_text"><a href="http://zsh.dotsrc.org/FAQ/zshfaq02.html" target="_blank">http://zsh.dotsrc.org/FAQ/zshfaq02.html</a></span>.</p>For more information about BASH and ZSH, see the manual pages for <code><a href="../../../../Darwin/Reference/ManPages/man1/bash.1.html#//apple_ref/doc/man/1/bash" target="_top">bash</a></code> and <code><a href="../../../../Darwin/Reference/ManPages/man1/zsh.1.html#//apple_ref/doc/man/1/zsh" target="_top">zsh</a></code>.</p></div><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW4" title="Managing Users and Groups"></a><h2>Managing Users and Groups</h2><p>In the default configuration of Mac OS X, <a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_274"></a>users and groups are not stored in a password file on disk. Thus, you cannot modify the password file directly.</p><p>Mac OS X supports a number of data stores for user and group information, including LDAP and flat files. Depending on the configuration, users could potentially be stored locally or remotely and accessed through any of these methods. Thus, to add users and groups through shell scripts in a general way, you <em>must</em> use the Directory Service command-line utility, <code><a href="../../../../Darwin/Reference/ManPages/man1/dscl.1.html#//apple_ref/doc/man/1/dscl" target="_top">dscl</a></code> (or the Directory Service API upon which that utility is based).</p><p>Because the <code>dscl</code> tool is specific to Mac OS X, if you are writing scripts for cross-platform deployment, you should test for its existence and fall back to traditional password file modification if it is not there. To learn how to do this, read <span class="content_text"><a href="../shell_scripts/shell_scripts.html#//apple_ref/doc/uid/TP40004268-CH237-SW6">“The if Statement.”</a></span></p><p>For sample code that shows how to add a new user from the command line, read the <span class="content_text"><a href="../../../../Porting/Conceptual/PortingUnix/additionalfeatures/additionalfeatures.html#//apple_ref/doc/uid/TP40002856" target="_top">Additional Features</a></span> chapter of <em><a href="../../../../Porting/Conceptual/PortingUnix/index.html#//apple_ref/doc/uid/TP30001003" target="_top">Porting UNIX/Linux Applications to Mac OS X</a></em>.</p><p>To learn more about Directory Service records at a high level, read <em><a href="../../../../Networking/Conceptual/Open_Directory/index.html#//apple_ref/doc/uid/TP40000917" target="_top">Open Directory Programming Guide</a></em>. To learn how to use the Directory Service command line utility to alter those records, read the manual page for <code><a href="../../../../Darwin/Reference/ManPages/man1/dscl.1.html#//apple_ref/doc/man/1/dscl" target="_top">dscl</a></code>.</p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW5" title="Working with Device I/O"></a><h2>Working with Device I/O</h2><p>Mac OS X uses the I/O Kit for <a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_275"></a><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_276"></a>device drivers. Unlike most UNIX-based and UNIX-like operating systems, most devices are not exposed through device files in <code>/dev</code>. (Disks and serial ports are notable exceptions.)</p><p>In general, device I/O must be written in a C-derived language using the functionality in the I/O Kit framework. However, if you are writing your own device driver, you can expose a device file in <code>/dev</code> if desired.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW27" title="Note"></a><p><strong>Note:</strong>&nbsp;Devices <em>cannot</em> be accessed through <code>/dev/mem</code> in Mac OS X.</p></div><p>See <em><a href="../../../../DeviceDrivers/Conceptual/IOKitFundamentals/index.html#//apple_ref/doc/uid/TP0000011" target="_top">I/O Kit Fundamentals</a></em> for general information, <em><a href="../../../../DeviceDrivers/Conceptual/AccessingHardware/index.html#//apple_ref/doc/uid/TP30000376" target="_top">Accessing Hardware From Applications</a></em> to learn how to write an application to access device drivers from user space, or <em><a href="../../../../Darwin/Conceptual/KernelProgramming/index.html#//apple_ref/doc/uid/TP30000905" target="_top">Kernel Programming Guide</a></em> to learn how to support device files and the <code><a href="../../../../Darwin/Reference/ManPages/man2/ioctl.2.html#//apple_ref/doc/man/2/ioctl" target="_top">ioctl</a></code> system call in the kernel.</p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW6" title="Disk Management and Partitioning"></a><h2>Disk Management and Partitioning</h2><p>Disk <a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_277"></a>management and partitioning tools vary widely from one UNIX-based or UNIX-like OS to the next. It is impractical for this document to cover the subject in depth.</p><p>For information on other UNIX-based and UNIX-like operating systems, a good place to start is the <em>UNIX System Administration Handbook</em> by Nemeth and others.</p><p>For information about Mac OS X command-line tools for disk management and partitioning, see section 8 of <em><a href="../../../../Darwin/Reference/ManPages/index.html#//apple_ref/doc/uid/TP40000894" target="_top">Mac OS X Man Pages</a></em>. In particular, you should look at the man pages for <code><a href="../../../../Darwin/Reference/ManPages/man1/hdiutil.1.html#//apple_ref/doc/man/1/hdiutil" target="_top">hdiutil</a></code>, <code><a href="../../../../Darwin/Reference/ManPages/man8/pdisk.8.html#//apple_ref/doc/man/8/pdisk" target="_top">pdisk</a></code>, and <code><a href="../../../../Darwin/Reference/ManPages/man8/diskutil.8.html#//apple_ref/doc/man/8/diskutil" target="_top">diskutil</a></code>.</p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW7" title="File System Hierarchy"></a><h2>File System Hierarchy</h2><p>A number of <a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_278"></a>files are in different places in Mac OS X than in other operating systems. For more information about the Mac OS X layout, read <em><a href="../../../../MacOSX/Conceptual/BPFileSystem/index.html#//apple_ref/doc/uid/10000185i" target="_top">File System Overview</a></em>. For more information about other operating systems, read the following:</p><ul class="ul"><li class="li"><p><code><a href="../../../../Darwin/Reference/ManPages/man7/hier.7.html#//apple_ref/doc/man/7/hier" target="_top">hier</a></code>—The Mac OS X manual page hier(7) describes the Mac OS X file-system hierarchy.</p></li><li class="li"><p><span class="content_text"><a href="http://www.FreeBSD.org/cgi/man.cgi?query=hier&amp;sektion=7" target="_blank">http://www.FreeBSD.org/cgi/man.cgi?query=hier&amp;sektion=7</a></span>—The FreeBSD manual page <code>hier(7)</code> describes the FreeBSD file-system hierarchy. It is similar to the hierarchy used by most BSD-based operating systems. (No, the spelling of section is not a typo.)</p></li><li class="li"><p><span class="content_text"><a href="http://www.pathname.com/fhs/" target="_blank">http://www.pathname.com/fhs/</a></span>—The Filesystem Hierarchy Standard describes the file system hierarchy used by Linux-based operating systems, and is derived from the hierarchy used by AT&amp;T UNIX-based operating systems.</p></li><li class="li"><p><span class="content_text"><a href="http://docs.hp.com/en/B2355-60130/hier.5.html" target="_blank">http://docs.hp.com/en/B2355-60130/hier.5.html</a></span>—This appendix from the HP-UX documentation describes the hierarchy of AT&amp;T UNIX-based operating systems.</p></li><li class="li"><p><span class="content_text"><a href="http://publib.boulder.ibm.com/infocenter/pseries/v5r3/index.jsp?topic=/com.ibm.aix.baseadmn/doc/baseadmndita/fs_tree_org.htm" target="_blank">http://publib.boulder.ibm.com/infocenter/pseries/v5r3/index.jsp?topic=/com.ibm.aix.baseadmn/‍doc/baseadmndita/fs_tree_org.htm</a></span>—This page in the IBM pSeries and AIX Information Center describes the hierarchy of AIX.</p></li></ul><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW1" title="General Command-Line Tool Differences"></a><h2>General Command-Line Tool Differences</h2><p>A number of <a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_279"></a><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_280"></a>command-line tools behave differently across various UNIX-based and UNIX-like operating systems. This chapter explains some of the key differences in those tools.</p><p>UNIX-based and UNIX-like operating systems generally fall into one of three camps:</p><ul class="ul"><li class="li"><p><strong>AT&amp;T UNIX:</strong> Also known as UNIX System V (in its latest incarnation), AT&amp;T UNIX was the original UNIX operating system. Its descendants include most operating systems that are commonly referred to as UNIX.</p></li><li class="li"><p><strong>BSD:</strong> Short for Berkeley Software Distribution, BSD is the name given to a family of operating systems descended from a derivative of UNIX that was originally distributed by the University of California, Berkeley, in the 1970s.</p><p>Over the years, the Berkeley distribution and the AT&amp;T distribution continued to diverge. The result is that there are a number of subtle syntax differences between shell scripts written for systems that follow AT&amp;T semantics versus those that follow BSD semantics.</p><p>In the 1990s, BSDi (a commercial company formed as a result of the UC Berkeley research) released the BSD operating system as open source. Most modern BSD operating systems are derived from this source base, known as 4.4BSD-Lite release 2.</p><p>Because of licensing restrictions on the original UNIX source code, the portions that were originally written by AT&amp;T had to be rewritten under a more permissive license in order to release it as open source. This contributed further to the differences in syntax between BSD-based and AT&amp;T UNIX-based operating systems.</p></li><li class="li"><p><strong>Linux and GNU:</strong> During the 1990s, a new operating system, Linux, was born. Combining a kernel written by Linus Torvalds and a number of utilities written by the Free Software Foundation (FSF) for their own operating system project (GNU Hurd), this operating system quickly grew into a very important third UNIX-like operating system.</p><p>Adding to the importance of Linux and the GNU tools was the advent of MacBSD, FreeBSD, NetBSD, OpenBSD, and other BSD variants. Although BSD-based operating systems had many common utilities, they had no replacements for a few of the missing AT&amp;T pieces. For this reason, many of these tools have also made their way into these BSD-based operating systems. In a similar way, BSD-derived tools frequently appear as part of Linux distributions.</p></li></ul><p>Over the years, a number of standards have emerged to mitigate the differences in syntax between these operating systems, including POSIX and the Single Unix Specification (SUS). As operating systems work towards compliance with these specifications, many of the differences in syntax are gradually fading into irrelevance. However, for true cross-platform compatibility, you should still be aware of these differences.</p><p>Mac OS X prior to version 10.5 provided tools that generally follow BSD semantics (or, in some cases, Linux or GNU semantics). Beginning in Mac OS X v10.5, many of these tools instead obey AT&amp;T semantics (most of the time; see note below for exceptions). Thus, some tools behave differently depending on the version of Mac OS X. These differences are described in the manual pages for the individual tools.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW28" title="Note"></a><p><strong>Note:</strong>&nbsp;While tools in Mac OS X v10.5 and later generally obey AT&amp;T semantics, this is not always true. In particular, when executed from installer scripts or startup items, they obey BSD semantics for backwards compatibility with existing scripts.</p>As a convenience to script developers, you can also obtain legacy behavior from most command-line tools by setting certain environment variables as described in the <code><a href="../../../../Darwin/Reference/ManPages/man5/compat.5.html#//apple_ref/doc/man/5/compat" target="_top">compat</a></code> manual page.</p>For more information on legacy-mode command support, see <em><a href="../../../../../releasenotes/Darwin/RN-Unix03Conformance/index.html#//apple_ref/doc/uid/TP40004772" target="_top">Unix 03 Conformance Release Notes</a></em>, the <code><a href="../../../../Darwin/Reference/ManPages/man5/compat.5.html#//apple_ref/doc/man/5/compat" target="_top">compat</a></code> manual page, and the manual pages for individual commands.</p></div><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW8" title="awk"></a><h3>awk</h3><p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_281"></a>In operating systems that follow AT&amp;T semantics, the <code><a href="../../../../Darwin/Reference/ManPages/man1/awk.1.html#//apple_ref/doc/man/1/awk" target="_top">awk</a></code> command supports certain forms of extended regular expressions (such as <code>{n,m}</code>, <code>[[==]]</code>, and <code>[[..]]</code>) without explicitly setting flags to enable extended regular expression support. Because this behavior is not portable, you should not depend on it.</p><p>Because of this difference, if you find a regular expression that a particular <code>awk</code> interpreter cannot handle, you should first try enabling extended regular expression support and then see if the problem goes away. This will usually break other parts of the expression, however. If so, you must rewrite the regular expression to fully use the extended regular expression syntax.</p><p>To learn about basic and extended regular expressions, read <span class="content_text"><a href="../RegularExpressionsUnfettered/RegularExpressionsUnfettered.html#//apple_ref/doc/uid/TP40004268-CH238-SW7">“Regular Expressions Unfettered.”</a></span> To learn more about the <code>awk</code> interpreter, read the manual page for <code><a href="../../../../Darwin/Reference/ManPages/man1/awk.1.html#//apple_ref/doc/man/1/awk" target="_top">awk</a></code>. To learn more about the AWK scripting language, read <span class="content_text"><a href="../Howawk-ward/Howawk-ward.html#//apple_ref/doc/uid/TP40004268-TP40003518-SW10">“How AWK-ward.”</a></span></p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW9" title="chown"></a><h3>chown</h3><p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_282"></a>If you pass the <code>-P</code> flag to <code><a href="../../../../Darwin/Reference/ManPages/man8/chown.8.html#//apple_ref/doc/man/8/chown" target="_top">chown</a></code>, it does not follow symbolic links. Thus, the file that a symbolic link points to is <em>never</em> modified if you specify the <code>-P</code> flag.</p><p>However, in operating systems that follow AT&amp;T semantics, when you issue the command <code>chown -RP directory_name</code>, the user ID of the symbolic link itself <em>is</em> modified. In operating systems that follow BSD semantics, the symbolic link itself is <em>not</em> modified.</p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW10" title="cp"></a><h3>cp</h3><p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_283"></a>If you pass both the <code>-i</code> and <code>-f</code> flags to <code><a href="../../../../Darwin/Reference/ManPages/man1/cp.1.html#//apple_ref/doc/man/1/cp" target="_top">cp</a></code>, the flag that takes precedence varies among operating systems. These flags specify opposite behavior, so you should never use them together.</p><p>Also, the <code>-f</code> option has different behavior depending on the operating system:</p><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Flags</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>BSD semantics</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>AT&amp;T semantics</p></th></tr><tr><td  scope="row"><p><code>-f</code> without <code>-p</code></p></td><td ><p>Destination file permissions unchanged.</p></td><td ><p>Destination file permissions set to default permissions.</p></td></tr><tr><td  scope="row"><p><code>-f</code> with <code>-p</code></p></td><td ><p>Destination file permissions set to permissions of source file.</p></td><td ><p>Destination file permissions set to permissions of source file.</p></td></tr></table></div><p>Finally, in operating systems that follow AT&amp;T semantics, when copying recursively, the copy operation stops as soon as any error occurs. In operating systems that follow BSD semantics, copy operation completes to the maximum extent possible. In either case, the command exits with a nonzero result code.</p><p>If you need to ensure that a copy operation does not stop on first failure, you can use <code><a href="../../../../Darwin/Reference/ManPages/man1/tar.1.html#//apple_ref/doc/man/1/tar" target="_top">tar</a></code> instead. For an example of how to use <code>tar</code> to copy files, see <span class="content_text"><a href="../SubroutinesandScoping/SubroutinesandScoping.html#//apple_ref/doc/uid/TP40004268-TP40003513-SW6">“Anonymous Subroutines.”</a></span></p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_4" title="crontab"></a><h3>crontab</h3><p>In AT&amp;T-based UNIX systems, the <code><a href="../../../../Darwin/Reference/ManPages/man1/crontab.1.html#//apple_ref/doc/man/1/crontab" target="_top">crontab(1)</a></code> command reads from standard input by default, but on BSD-based systems, it does not. For cross-platform compatibility, you should specify a hyphen (<code>-</code>) for the filename instead. This works on with versions of <code>crontab</code> that obey both AT&amp;T and BSD semantics.</p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW11" title="date"></a><h3>date</h3><p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_284"></a>The result codes returned by <code><a href="../../../../Darwin/Reference/ManPages/man1/date.1.html#//apple_ref/doc/man/1/date" target="_top">date</a></code> vary depending on the operating system. For cross-platform compatibility, you can only assume that a result code of zero (<code>0</code>) indicates success and any other value indicates some sort of failure.</p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_5" title="df"></a><h3>df</h3><p>The <code><a href="../../../../Darwin/Reference/ManPages/man1/df.1.html#//apple_ref/doc/man/1/df" target="_top">df(1)</a></code> command has two different meanings for the <code>-t</code> flag beginning in Mac OS X v10.5. They are as follows:</p><ul class="spaceabove"><li class="li"><p>If you include a value afterwards (for example, <code>-t hfs</code>), it behaves like the <code>-T</code> flag. This usage is deprecated.</p></li><li class="li"><p>Without an argument, it tells <code>df</code> to print the total allocated space. Because this option is the default, this use of the <code>-t</code> flag is unnecessary.</p></li></ul><p>The default block size varies on different operating systems. Linux and most BSD-based operating systems default to a 1k block size, while AT&amp;T UNIX-based operating systems default to a 512-byte block size.</p><p>For consistent behavior across multiple operating systems, you should always specify a block size explicitly. For example, the -k flag specifies that the block size should be reported in kilobytes.</p><p>Finally, the capacity percentage reported by <code>df</code> may be rounded differently in different operating systems.</p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_6" title="du"></a><h3>du</h3><p>Operating systems that follow AT&amp;T semantics allow you to pass a combination of the <code>-L</code>, <code>-H</code>, and <code>-P</code> options to <code><a href="../../../../Darwin/Reference/ManPages/man1/du.1.html#//apple_ref/doc/man/1/du" target="_top">du(1)</a></code>.  The last flag encountered determines the command's behavior.  In operating systems that follow BSD semantics, specifying more than one of these options results in an error. To fix this problem, delete all but the last of these options.</p><p>Also, many BSD-based operating systems cannot detect symbolic link loops. For cross-platform compatibility, you should generally not tell <code>du</code> to follow symbolic links unless you are certain that no cycles can occur.</p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW12" title="echo"></a><h3>echo</h3><p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_285"></a>Of particular interest is the difference in behavior of the <code><a href="../../../../Darwin/Reference/ManPages/man1/echo.1.html#//apple_ref/doc/man/1/echo" target="_top">echo</a></code> builtin and the corresponding standalone command. If you want to issue a prompt, in BSD-derived operating systems you can leave off the trailing newline by typing the following:</p><div class="codesample"><table><tr><td scope="row"><pre>echo -n "Prompt: "<span></span></pre></td></tr></table></div><p>In AT&amp;T UNIX-derived operating systems, the equivalent is:</p><div class="codesample"><table><tr><td scope="row"><pre>echo "Prompt: \c"<span></span></pre></td></tr></table></div><p>Unfortunately, this difference makes it very difficult to write scripts that depend on this behavior in a cross-platform way. For portability, you should avoid either of these constructions. As an alternative, you can either use the <code><a href="../../../../Darwin/Reference/ManPages/man1/printf.1.html#//apple_ref/doc/man/1/printf" target="_top">printf</a></code> command instead of <code>echo</code> or use the <code><a href="../../../../Darwin/Reference/ManPages/man1/tr.1.html#//apple_ref/doc/man/1/tr" target="_top">tr</a></code> command to remove the newline.</p><p>For example, the following lines both print "Prompt: “ followed by the word “newline” immediately afterward on the same line:</p><div class="codesample"><table><tr><td scope="row"><pre>echo "Prompt: " | tr -d '\n'; echo "newline"<span></span></pre></td></tr><tr><td scope="row"><pre>printf "Prompt: "; printf "newline\n";<span></span></pre></td></tr></table></div><p>The <code>echo</code> command also varies in the way it handles control-character escape sequences such as <code>\r</code>. Because these are handled differently in different operating systems, you should avoid using them with <code>echo</code>. As an alternative, use the <code><a href="../../../../Darwin/Reference/ManPages/man1/printf.1.html#//apple_ref/doc/man/1/printf" target="_top">printf</a></code> command to print these sequences, or store the desired control character in a shell variable using <code><a href="../../../../Darwin/Reference/ManPages/man1/tr.1.html#//apple_ref/doc/man/1/tr" target="_top">tr</a></code>.</p><p>For example, the following code sends an XON (Control-Q) byte to standard output:</p><div class="codesample"><table><tr><td scope="row"><pre>XON=$(echo 'x' | tr 'x' "\\021");<span></span></pre></td></tr><tr><td scope="row"><pre>echo "Here is an XON: $XON"<span></span></pre></td></tr></table></div><div class="notebox"><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW29" title="Note"></a><p><strong>Note:</strong>&nbsp;The behavior of <code>-n</code>, <code>\c</code>, and other escape sequences may also vary between shell builtin versions of <code>echo</code> and the <code>/bin/echo</code> executable, depending on the operating system and the shell you are using.</p></div><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW13" title="file"></a><h3>file</h3><p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_286"></a>The <code><a href="../../../../Darwin/Reference/ManPages/man1/file.1.html#//apple_ref/doc/man/1/file" target="_top">file</a></code> command has two switches that behave differently in different operating systems: <code>-i</code> and <code>-r</code> (or <code>--raw</code>). For consistent behavior, you should avoid these switches.</p><p>In AT&amp;T UNIX-based operating systems, the <code>-i</code> option tells the <code>file</code> command to not classify the contents of regular files using the external <code>mime.types</code> file.  This results in faster performance but provides less detailed analysis.</p><p>In BSD-derived operating systems, the <code>-i</code> flag tells the <code>file</code> command to output raw mime type strings rather than the more traditional human readable ones. For this behavior, you should use the <code>--mime</code> flag instead, though that option is also not supported universally.</p><p>The <code>-r</code> and <code>--raw</code> options are supported only in BSD-derived operating systems. These flags tell the file command not to translate unprintable characters to their octal representations. AT&amp;T-derived operating systems never do this.</p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW14" title="grep"></a><h3>grep</h3><p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_287"></a>In some operating systems, <code><a href="../../../../Darwin/Reference/ManPages/man1/grep.1.html#//apple_ref/doc/man/1/grep" target="_top">grep</a></code> fails silently if you try to match a caret in the middle of a line, while other versions of <code>grep</code> warn about the mistake. Such an expression is not a legal regular expression, of course, but if your script depends on getting an error in this case (or not getting an error), the script is not fully portable.</p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW35" title="head"></a><h3>head</h3><p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_288"></a>The <code><a href="../../../../Darwin/Reference/ManPages/man1/head.1.html#//apple_ref/doc/man/1/head" target="_top">head</a></code> command exists across most operating systems. However, different versions provide several flags that are nonstandard.</p><p>The only flag that can be used portably is the <code>-n</code> flag, which takes a line count.</p><p>Most operating systems (including Mac OS X) also support the <code>-c</code> flag, which specifies a byte count, but this support is not guaranteed to be portable. It is possible to emulate this functionality portably with the help of an AWK script, however, as follows:</p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_23" title="Listing 6-1Emulating head -c using AWK: 01_head_c.sh"></a><p class="codesample"><strong>Listing 6-1&nbsp;&nbsp;</strong>Emulating head -c using AWK: 01_head_c.sh</p><div class="codesample"><table><tr><td scope="row"><pre>#!/bin/sh<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre># Usage: ./head_c filename bytecount<span></span></pre></td></tr><tr><td scope="row"><pre>FILENAME=$1<span></span></pre></td></tr><tr><td scope="row"><pre>COUNT=$2<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>SCRIPT="$(mktemp '/tmp/head_c.XXXXXXXXXX')"<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>cat &lt;&lt; EOF > "$SCRIPT"<span></span></pre></td></tr><tr><td scope="row"><pre>BEGIN {<span></span></pre></td></tr><tr><td scope="row"><pre>        FS="";<span></span></pre></td></tr><tr><td scope="row"><pre>        my_string = ""<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>        my_string = my_string "\n" \$0;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre>END {<span></span></pre></td></tr><tr><td scope="row"><pre>        # Start from character 2 to skip the bogus leading newline.<span></span></pre></td></tr><tr><td scope="row"><pre>        print substr(my_string, 2, $COUNT);<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre>EOF<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>awk -f "$SCRIPT" "$FILENAME"<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>rm "$SCRIPT"<span></span></pre></td></tr></table></div><p>You may also run into a minor compatibility problem when porting scripts from Linux to Mac OS X. When you pass multiple filenames to the <code>head</code> command, it prints a heading line for each file name in the form</p><div class="codesample"><table><tr><td scope="row"><pre>==> filename &lt;==<span></span></pre></td></tr></table></div><p>The Linux version of <code>head</code> provides a <code>-q</code> flag that disables printing the header marker even if you specify multiple files. It also provides a <code>-v</code> flag that forces header printing even when only one file is specified.</p><p>As an alternative to the <code>-v</code> flag, you can output the filename marker in your script with a simple <code><a href="../../../../Darwin/Reference/ManPages/man1/echo.1.html#//apple_ref/doc/man/1/echo" target="_top">echo</a></code> statement like this one:</p><div class="codesample"><table><tr><td scope="row"><pre>echo "==> $FILENAME &lt;=="<span></span></pre></td></tr></table></div><p>As an alternative to the <code>-q</code> flag, provided that there is no possibility of your files’ contents actually matching the pattern, you can strip out the markers with <code><a href="../../../../Darwin/Reference/ManPages/man1/grep.1.html#//apple_ref/doc/man/1/grep" target="_top">grep</a></code> like this:</p><div class="codesample"><table><tr><td scope="row"><pre>head -n 1 file1 file2 ... | grep -v '^==>.*&lt;==$'<span></span></pre></td></tr></table></div><p>In addition to these flag differences, POSIX specifies that the input files for <code>head</code> must be valid text files, which means that all byte sequences must be valid for the current locale. Although not all versions of <code>head</code> enforce this restriction, versions that do may fail when used with binary files in some operating systems unless you change the local settings.</p><p>If your scripts must process binary files, be sure to specify the “C” locale before executing commands that work with these binary files. To change the locale, issue the following statement:</p><div class="codesample"><table><tr><td scope="row"><pre>export LANG="C"<a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_289"></a><span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW15" title="join"></a><h3>join</h3><p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_290"></a>The <code>-e</code> option tells the <code><a href="../../../../Darwin/Reference/ManPages/man1/join.1.html#//apple_ref/doc/man/1/join" target="_top">join</a></code> command to insert the specified string into empty fields. In operating systems that follow BSD semantics, substitution occurs <em>only</em> if there are no nonempty fields after the empty field. In operating systems that follow AT&amp;T UNIX semantics, substitution always occurs.</p><p>Not all <code>join</code> flags are supported on all operating systems. For portability, you should limit yourself to <code>-a</code>, <code>-e</code>, <code>-o</code>, <code>-t</code>, <code>-v</code>, <code>-1</code>, and <code>-2</code>.</p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_7" title="less"></a><h3>less</h3><p>See <span class="content_text"><a href="PortingScriptstoMacOSX.html#//apple_ref/doc/uid/TP40004268-TP40003517-SW36">“more or less.”</a></span></p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_8" title="ls"></a><h3>ls</h3><p>When <code>-H</code> is specified (and is not overridden by <code>-L</code> or <code>-P</code>) and a file argument is a symbolic link that resolves to a non-directory file, the output reflects the nature of the link, rather than that of the file. In operating systems that follow BSD semantics, the output describes the file.</p><p>The <code>-f</code> option turns on the <code>-a</code> option (show files whose names have a period (<code>.</code>) as the first character).  In operating systems that follow BSD semantics, it does not.</p><p>The <code>-o</code> option causes the listing to be in long format, but to omit the group id.  In operating systems that follow BSD semantics, the <code>-o</code> option modifies the <code>-l</code> option, causing file flags to be listed.</p><p>The <code>-g</code>, <code>-n</code>, and <code>-o</code> options turn on the <code>-l</code> option (causing the listing to be in long format).  In operating systems that follow BSD semantics, they do not.</p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW16" title="mkfifo"></a><h3>mkfifo</h3><p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_291"></a>In operating systems that follow BSD semantics, the <code><a href="../../../../Darwin/Reference/ManPages/man1/mkfifo.1.html#//apple_ref/doc/man/1/mkfifo" target="_top">mkfifo</a></code> command applies a mask of <code>0666</code> to the mode passed in for the <code>-m</code> option. In operating systems that follow AT&amp;T semantics, no mask is applied.</p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW36" title="more or less"></a><h3>more or less</h3><p>Different operating systems handle the <code>-n</code> and <code>-p</code> flags to the <code><a href="../../../../Darwin/Reference/ManPages/man1/more.1.html#//apple_ref/doc/man/1/more" target="_top">more(1)</a></code> command differently.</p><p>In operating systems that follow the BSD and AT&amp;T semantics, the <code>-n</code> option specifies the number of lines per screen, and the <code>-p</code> option allows you to specify commands (such as <code>:p</code>) to execute each time a new screenful of text is displayed.</p><p>In operating systems that follow Linux semantics (and for the <code><a href="../../../../Darwin/Reference/ManPages/man1/less.1.html#//apple_ref/doc/man/1/less" target="_top">less(1)</a></code> command on all operating systems), the <code>-n</code> flag tells the <code>more</code> command to to suppress line numbering, and the <code>-p</code> flag specifies a search pattern.</p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW17" title="mv"></a><h3>mv</h3><p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_292"></a>If you tell the <code><a href="../../../../Darwin/Reference/ManPages/man1/mv.1.html#//apple_ref/doc/man/1/mv" target="_top">mv</a></code> command to move a subdirectory into its current parent directory (by typing <code>mv foo/bar foo</code>, for example), the behavior varies in a subtle way. No action occurs in any operating system because you are effectively moving a directory on top of itself. However, operating systems that follow BSD semantics exit with a zero (success) result code, whereas operating systems that follow AT&amp;T semantics display an error message and exit with a nonzero (failure) result code.</p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW18" title="pr"></a><h3>pr</h3><p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_293"></a>In AT&amp;T UNIX semantics, the last space before the tab stop is replaced with a tab character. This replacement does not occur in most open source (BSD or Linux) implementations. For cross-platform consistency, you can globally replace the tab with a space by piping the output to <code><a href="../../../../Darwin/Reference/ManPages/man1/tr.1.html#//apple_ref/doc/man/1/tr" target="_top">tr</a></code> with appropriate arguments. For example:</p><div class="codesample"><table><tr><td scope="row"><pre>pr [arguments...] | tr '\t' ' '<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW19" title="ps"></a><h3>ps</h3><p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_294"></a>While not frequently used in shell scripts, the <code><a href="../../../../Darwin/Reference/ManPages/man1/ps.1.html#//apple_ref/doc/man/1/ps" target="_top">ps</a></code> command behaves very differently between operating systems that follow BSD and AT&amp;T semantics. The differences are summarized in the following table:</p><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Flag</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>AT&amp;T</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>BSD</p></th></tr><tr><td  scope="row"><p><code>-e</code></p></td><td ><p>Display information about other users’ processes, including those without controlling terminals; same as <code>-A</code>.</p></td><td ><p>Display the environment variable settings for each process; same as <code>-E</code>.</p></td></tr><tr><td  scope="row"><p><code>-g</code></p></td><td ><p>Display information about processes with the specified session leaders.</p></td><td ><p>Unused option.</p></td></tr><tr><td  scope="row"><p><code>-l</code></p></td><td ><p>"Long” display format; includes the <code>paddr</code> field.</p></td><td ><p>"Long” display format; does not include the <code>paddr</code> field.</p></td></tr><tr><td  scope="row"><p><code>-u</code></p></td><td ><p>Display processes belonging to a particular user. For example, <code>ps -u root</code> displays all processes belonging to the root user.</p></td><td ><p>Display the fields <code>user</code>, <code>pid</code>, <code>%cpu</code>, <code>%mem</code>, <code>vsz</code>, <code>rss</code>, <code>tt</code>, <code>state</code>, <code>start</code>, <code>time</code> and <code>command</code>. Also implies the <code>-r</code> option (sort by CPU usage).</p></td></tr></table></div><div class="notebox"><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW30" title="Note"></a><p><strong>Note:</strong>&nbsp;For the most part, the information available from <code>ps</code> is similar in all variants (with the exception of the <code>-u</code> flag). The headings themselves, however, differ somewhat among BSD, AT&amp;T, and Linux variants of the <code>ps</code> command. Similarly, column order is not guaranteed to be consistent across platforms. For this reason, programmatic use of ps is generally discouraged.</p></div><p>Most BSD and Linux variants have deprecated the use of BSD variants of flags when they are preceded by a dash. Passing these flags without a dash in these operating systems will generate the BSD behavior more consistently (at least on BSD and Linux-based operating systems). However, because this behavior is not portable, you should generally not depend on the specific quirks of a particular <code>ps</code> implementation.</p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW20" title="sed"></a><h3>sed</h3><p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_295"></a>Most GNU versions of <code><a href="../../../../Darwin/Reference/ManPages/man1/sed.1.html#//apple_ref/doc/man/1/sed" target="_top">sed</a></code> generate warnings for unused labels. Most other implementations do not.</p><p>Also, when the <code>y</code> function is specified (for example, <code>sed y/string1/string2/</code>), most GNU versions convert double backslashes to single backslashes. This behavior is not portable, so you should not depend on it.</p><p>Because of this incompatibility, if you need to construct an expression containing user-entered strings that could potentially include a backslash, you should avoid the problem entirely by using the <code>s</code> function (for example, <code>sed s/string1/string2/</code>) instead of the <code>y</code> function.</p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW21" title="sort"></a><h3>sort</h3><p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_296"></a>The form <code>sort +POS1 -POS2 ...</code> is a syntax specific to the GNU version of <code><a href="../../../../Darwin/Reference/ManPages/man1/sort.1.html#//apple_ref/doc/man/1/sort" target="_top">sort</a></code> and is considered obsolete. This syntax is not portable and is not supported in Mac OS X beginning in version 10.5.</p><p>For example:</p><div class="codesample"><table><tr><td scope="row"><pre>$ cat data<span></span></pre></td></tr><tr><td scope="row"><pre>b  a<span></span></pre></td></tr><tr><td scope="row"><pre>a  b<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>$ sort data<span></span></pre></td></tr><tr><td scope="row"><pre>a  b<span></span></pre></td></tr><tr><td scope="row"><pre>b  a<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>$ sort +1 -2 data<span></span></pre></td></tr><tr><td scope="row"><pre>sort: invalid option -- 2<span></span></pre></td></tr><tr><td scope="row"><pre>Try `sort --help' for more information.<span></span></pre></td></tr></table></div><p>Instead, you should use the <code>-k</code> flag to do the same thing. For example:</p><div class="codesample"><table><tr><td scope="row"><pre>$ sort -k 2,3 data<span></span></pre></td></tr><tr><td scope="row"><pre>b  a<span></span></pre></td></tr><tr><td scope="row"><pre>a  b<span></span></pre></td></tr></table></div><div class="notebox"><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW31" title="Note"></a><p><strong>Note:</strong>&nbsp;The field and character positions are numbered differently with this syntax. Numbering for the <code>-k</code> syntax starts at one (<code>1</code>), while the obsolete plus and minus syntax starts at zero (<code>0</code>).</p></div><div class="notebox"><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW32" title="Compatibility Note"></a><p><strong>Compatibility Note:</strong>&nbsp;<a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_297"></a>Mac OS X v10.5 and later does not support this legacy GNU sort syntax. However, as a temporary workaround while you rewrite the offending scripts, you can set the <code>_POSIX2_VERSION</code> environment variable as show in the following snippet:</p><div class="codesample"><table><tr><td scope="row"><pre>export _POSIX2_VERSION=200111<span></span></pre></td></tr><tr><td scope="row"><pre># or in CSH<span></span></pre></td></tr><tr><td scope="row"><pre>setenv _POSIX2_VERSION 200111<span></span></pre></td></tr></table></div>Do not rely on this workaround for production code; its continued support is not guaranteed.</p></div><p>For more information on compatibility issues with the <code>sort</code> command, see the manual page for <code><a href="../../../../Darwin/Reference/ManPages/man1/sort.1.html#//apple_ref/doc/man/1/sort" target="_top">sort</a></code>.</p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW22" title="stty"></a><h3>stty</h3><p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_298"></a>Prior to Mac OS X v10.5, the <code><a href="../../../../Darwin/Reference/ManPages/man1/stty.1.html#//apple_ref/doc/man/1/stty" target="_top">stty</a></code> command did not support the following control modes:</p><ul class="spaceabove"><li class="li"><p><code>bs0</code> and <code>bs1</code></p></li><li class="li"><p><code>cr0</code>, <code>cr1</code>, <code>cr2</code>, and <code>cr3</code></p></li><li class="li"><p><code>ff0</code> and <code>ff1</code></p></li><li class="li"><p><code>nl0</code> and <code>nl1</code></p></li><li class="li"><p><code>tab0</code>, <code>tab1</code>, <code>tab2</code>, and <code>tab3</code></p></li><li class="li"><p><code>vt0</code> and <code>vt1</code></p></li></ul><p>In addition, prior to Mac OS X v10.5, <code>stty</code> did not support the following options:</p><ul class="spaceabove"><li class="li"><p><code>ocrnl</code> and <code>-ocrnl</code></p></li><li class="li"><p><code>ofdel</code> and <code>-ofdel</code></p></li><li class="li"><p><code>ofill</code> and <code>-ofill</code></p></li><li class="li"><p><code>onlret</code> and <code>-onlret</code></p></li><li class="li"><p><code>onocr</code> and <code>-onocr</code></p></li></ul><p>In legacy mode, these modes and options are still not accepted. For more information, see the manual page for <code><a href="../../../../Darwin/Reference/ManPages/man1/stty.1.html#//apple_ref/doc/man/1/stty" target="_top">stty</a></code>.</p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_9" title="tail"></a><h3>tail</h3><p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_299"></a>The <code><a href="../../../../Darwin/Reference/ManPages/man1/tail.1.html#//apple_ref/doc/man/1/tail" target="_top">tail</a></code> command differs significantly between Linux and Mac OS X. The GNU variant of <code>tail</code> provides options that the Mac OS X version does not and vice versa. Both provide features that are not part of the POSIX specification, and thus may not be portable.</p><p>According to the POSIX specification, the following flags are portable: <code>-f</code> (continue to wait for the file to grow or for the FIFO to provide additional data), <code>-c</code> (byte count), and <code>-n</code> (line count).</p><p>Further, POSIX only explicitly requires the <code>tail</code> command to accept a single filename as an argument. Any use with multiple files is inherently not portable.</p><dl class="termdef">	<dt><code>-b</code> (Mac OS X)</dt><dd><p>Mac OS X provides a <code>-b</code> flag that allows you to specify a location in 512-byte block increments. For maximum portability, multiply the number by 512 yourself and use the <code>-c</code> flag instead.</p></dd><dt><code>-F</code> (Mac OS X and Linux)</dt><dd><p>Both Linux and Mac OS X provide a <code>-F</code> flag that is equivalent to <code>-f --retry</code>. This is easily avoided with the workarounds described as part of the entries for the individual <code>--follow</code> and <code>--retry</code> flags.</p></dd><dt><code>--follow</code> (Linux)</dt><dd><p>Linux also provides a <code>--follow</code> flag, which is equivalent to <code>-f</code> except when used with file descriptors.</p><p>When working with files, use <code>-f</code> instead.</p><p>The file descriptor syntax is not portable and is not supported except in Linux. Use a named pipe (FIFO) instead.</p></dd><dt><code>--max-unchanged-stat</code> (Linux)</dt><dd><p>Linux provides a <code>--max-unchanged-stat</code> that tries reopening a file if you are using the <code>-f</code> flag and the file hasn’t changed in a while. This allows it to handle the case here the file is renamed and a new file with the same name is created as often happens with log files. There is no easy portable replacement for this feature.</p></dd><dt><code>--pid</code> (Linux)</dt><dd><p>Linux provides a <code>--pid</code> flag that terminates the <code>tail</code> command after the specified process ID dies.</p><p>There is no easy portable replacement for this feature, though it could be replaced in a not-so-portable fashion by a script running as a background job that uses the <code><a href="../../../../Darwin/Reference/ManPages/man1/ps.1.html#//apple_ref/doc/man/1/ps" target="_top">ps</a></code> command to verify the existence of the process.</p><p>Assuming the process being watched was originally started by the shell script in the background, it could also be replaced by running the <code>tail</code> command in the background and using the <code>wait</code> shell builtin to wait for the process ID to exit, then killing the <code>tail</code> command. For more information, see <span class="content_text"><a href="../SubroutinesandScoping/SubroutinesandScoping.html#//apple_ref/doc/uid/TP40004268-TP40003513-SW7">“Background Jobs and Job Control.”</a></span></p></dd><dt><code>-q</code>  (Linux)</dt><dd><p>As with the <code><a href="../../../../Darwin/Reference/ManPages/man1/head.1.html#//apple_ref/doc/man/1/head" target="_top">head</a></code> command, Linux provides <code>-v</code> and <code>-q</code> flags. See <span class="content_text"><a href="PortingScriptstoMacOSX.html#//apple_ref/doc/uid/TP40004268-TP40003517-SW35">“head”</a></span> earlier in this section for explanation of these flags and suggested alternatives.</p></dd><dt><code>-r</code> (Mac OS X)</dt><dd><p>Mac OS X provides a <code>-r</code> flag that reverses the order of the lines printed. It also changes the behavior of the leading plus (<code>+</code>) and minus (<code>-</code>) symbols when passed as part of arguments to the <code>-b</code>, <code>-c</code>, and <code>-n</code> flags.</p><p>It is possible to write an AWK script to emulate this behavior by pushing each line in the input file into an array, then printing the lines in reverse order and either skipping a given number of entries in the array to skip lines or using <code>substr</code> call to skip a given number of bytes. The <span class="content_text"><a href="PortingScriptstoMacOSX.html#//apple_ref/doc/uid/TP40004268-TP40003517-SW35">“head”</a></span> section of this chapter provides an example of how to emulate <code>head -c</code> using an AWK script; this example provides a good starting point for writing a script that emulates this <code>tail</code> feature.</p></dd><dt><code>--retry</code> (Linux)</dt><dd><p>Linux provides a <code>--retry</code> flag to keep trying to open a file if it does not exists.</p><p>This is commonly used, with the <code>-f</code> flag, and in that usage, is equivalent to the <code>-F</code> flag, which Mac OS X supports.</p><p>By itself, however, Mac OS X has no equivalent flag, though you can trivially approximate it in a more portable fashion by writing a while loop in a shell script that repeatedly checks for the file until it finds it, then runs the <code>tail</code> command.</p></dd><dt><code>-s</code> and <code>--sleep-interval</code> (Linux)</dt><dd><p>Linux provides <code>-s</code> and <code>--sleep-interval</code> flags to lower CPU use by adding a delay between checks to see if a file you are watching with <code>-f</code> has grown.</p></dd><dt><code>-v</code>  (Linux)</dt><dd><p>As with the <code><a href="../../../../Darwin/Reference/ManPages/man1/head.1.html#//apple_ref/doc/man/1/head" target="_top">head</a></code> command, Linux provides <code>-v</code> and <code>-q</code> flags. See <span class="content_text"><a href="PortingScriptstoMacOSX.html#//apple_ref/doc/uid/TP40004268-TP40003517-SW35">“head”</a></span> earlier in this section for explanation of these flags and suggested alternatives.</p></dd></dl><p>In addition to these flag differences, POSIX specifies that the input files for <code>tail</code> must be valid text files, which means that all byte sequences must be valid for the current locale. Although not all versions of <code>tail</code> enforce this restriction, versions that do may fail when used with binary files in some operating systems unless you change the local settings.</p><p>If your scripts must process binary files, be sure to specify the “C” locale before executing commands that work with these binary files. To change the locale, issue the following statement:</p><div class="codesample"><table><tr><td scope="row"><pre>export LANG="C"<span></span></pre></td></tr></table></div><p>Finally, unlike the <code>head</code> command, POSIX does not require that the <code>tail</code> command be able to store and print a text block of arbitrary length. It requires only that the buffer size be at least 10 times the value of <code>LINE_MAX</code>. The value of <code>LINE_MAX</code> is implementation dependent, but must be at least 2048 bytes.</p><p>While this theoretical 20,480 byte limit in the output of the <code>tail</code> command is not commonly enforced in modern operating systems, the only <em>guaranteed</em> portable way to generate larger results from <code>tail</code> is to use another tool such as AWK.<a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_300"></a></p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW23" title="uudecode, uuencode"></a><h3>uudecode, uuencode</h3><p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_301"></a>In most Linux and BSD-derived operating systems, <code><a href="../../../../Darwin/Reference/ManPages/man1/uudecode.1.html#//apple_ref/doc/man/1/uudecode" target="_top">uudecode</a></code> applies a mask of <code>0666</code> to file modes, thus preventing the creation of executable files (or files with other special modes). In operating systems that follow AT&amp;T semantics, no mask is applied.</p><p>For consistency, if you require the results of <code>uudecode</code> to be executable or have nonstandard modes, your script should set the execute flag explicitly with <code><a href="../../../../Darwin/Reference/ManPages/man1/chmod.1.html#//apple_ref/doc/man/1/chmod" target="_top">chmod</a></code>.</p><p>In operating systems that follow AT&amp;T semantics, if <code>uudecode</code> overwrites an existing file, it cannot necessarily change its mode unless the file is owned by the current user or <code>uudecode</code> is running as the root user.</p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW24" title="which"></a><h3>which</h3><p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_302"></a>In Mac OS X, the <code><a href="../../../../Darwin/Reference/ManPages/man1/which.1.html#//apple_ref/doc/man/1/which" target="_top">which</a></code> command can take the -s flag for “silent” behavior. In this mode, it does not output any text and retursn an exit status of <code>0</code> if the command exists in any of the paths listed in the <code>PATH</code> environment variable or <code>1</code> if it does not (or <code>2</code> if you pass an invalid flag).</p><p>This flag does not exist in many operating systems that obey AT&amp;T semantics. The GNU version of <code>which</code> used in Linux also does not support this flag. As an alternative, you can redirect the output of <code>which</code> to <code>/dev/null</code> as described in <span class="content_text"><a href="../shell_scripts/shell_scripts.html#//apple_ref/doc/uid/TP40004268-CH237-SW23">“Pipes and Redirection.”</a></span></p><p>Also, some (not all) Linux distributions come with the GNU <code>which</code> command. This command differs significantly in its behavior from other UNIX-like operating systems. In order to support searching for multiple commands in a single <code>which</code> statement, its exit status contains the number of commands that were not found, or -1 if you pass it unknown flags. (It also supports a number of formatting flags that are not broadly available.)</p><p>For reliable cross-platform use, you should specify exactly one command argument at a time, pass no flags (except the ubiquitous <code>-a</code> flag, if desired), and assume that an exit status of either <code>-1</code> or <code>2</code> indicates a usage error.</p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW33" title="who"></a><h3>who</h3><p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_303"></a>In operating systems that follow AT&amp;T semantics, if you use the <code>-u</code> flag, the <code><a href="../../../../Darwin/Reference/ManPages/man1/who.1.html#//apple_ref/doc/man/1/who" target="_top">who</a></code> command displays the process ID of the corresponding <code><a href="../../../../Darwin/Reference/ManPages/man1/login.1.html#//apple_ref/doc/man/1/login" target="_top">login</a></code> process. In operating systems that follow BSD semantics, it does not display the process ID.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW34" title="Compatibility Note"></a><p><strong>Compatibility Note:</strong>&nbsp;<a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_304"></a>You can get the BSD semantics in Mac OS X v10.5 by enabling legacy mode as described in the <code><a href="../../../../Darwin/Reference/ManPages/man5/compat.5.html#//apple_ref/doc/man/5/compat" target="_top">compat</a></code> manual page.</p></div><a name="//apple_ref/doc/uid/TP40004268-TP40003517-SW25" title="xargs"></a><h3>xargs</h3><p><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_305"></a>If you pass the <code>-L</code> flag to the <code><a href="../../../../Darwin/Reference/ManPages/man1/xargs.1.html#//apple_ref/doc/man/1/xargs" target="_top">xargs</a></code> command, <code>xargs</code> calls the specified utility every time a certain number of lines are read. However, some details differ slightly:</p><ul class="spaceabove"><li class="li"><p><strong>Counting:</strong> In operating systems that follow BSD semantics, the number of lines is based on the number of newlines encountered. Every line (including blank lines) is counted. In operating systems that follow AT&amp;T UNIX semantics, blank lines are ignored for counting purposes.</p></li><li class="li"><p><strong>Concatenation:</strong> In operating systems that follow AT&amp;T UNIX semantics, any line ending with a space is combined with the lines that follow it, up to and including the first nonblank line. This concatenation does not occur in operating systems that follow BSD semantics.</p></li><li class="li"><p><strong>Combining Options:</strong> In operating systems that follow BSD semantics, the <code>-L</code> and <code>-n</code> options can be used together. In operating systems that follow AT&amp;T UNIX semantics, the <code>-L</code> and <code>-n</code> options are mutually exclusive, and the last one given on the command line will be used.</p></li></ul><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_306"></a><a name="//apple_ref/doc/uid/TP40004268-TP40003517-DontLinkElementID_307"></a>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../Howawk-ward/Howawk-ward.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../AdvancedTechniques/AdvancedTechniques.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2003, 2009 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2009-04-08<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/OpenSource/Conceptual/ShellScripting/PortingScriptstoMacOSX/PortingScriptstoMacOSX.html%3Fid%3DTP40004268-5.2&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/OpenSource/Conceptual/ShellScripting/PortingScriptstoMacOSX/PortingScriptstoMacOSX.html%3Fid%3DTP40004268-5.2&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/OpenSource/Conceptual/ShellScripting/PortingScriptstoMacOSX/PortingScriptstoMacOSX.html%3Fid%3DTP40004268-5.2&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>