<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>OSALoad(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING349></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-348.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-350.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-331.html"><B>Chapter 10 - Scripting Components</B></A> / <A HREF="IAC-344.html"><B>Scripting Components Reference</B></A><BR><DL><DD><A HREF="IAC-346.html"><B>Required Scripting Component Routines</B></A> / <A HREF="IAC-347.html"><B>Saving and Loading Script Data</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING349-0></A>
<H3>OSALoad</H3>
 You can use the <CODE>OSALoad</CODE> function to load script data. <A NAME=MARKER-2-8></A><P>
<PRE>
FUNCTION OSALoad(scriptingComponent: ComponentInstance; 
                 scriptData: AEDesc;
                 modeFlags: LongInt;
                 VAR resultingScriptID: OSAID): OSAError;
</PRE>
<DL>
<DT><CODE>scriptingComponent</CODE>
<DD> <BR>A component instance created by a prior call to the Component Manager function <CODE>OpenDefaultComponent</CODE> or <CODE>OpenComponent</CODE> (see <A HREF=IAC-332.html#MARKER-9-76>page 10-4</A>).
<DT><CODE>scriptData</CODE>
<DD> The descriptor record containing the script data to be loaded.
<DT><CODE>modeFlags</CODE>
<DD> Information used by individual scripting components. To avoid setting any mode flags, specify <CODE>kOSAModeNull</CODE>. To indicate that only the minimum script data required to run the script should be loaded, pass <CODE>kOSAModePreventGetSource</CODE> in this parameter.
<DT><CODE>resultingScriptID</CODE>
<DD> The returned script ID for the compiled script.
</DL>
<A NAME=HEADING349-7></A>
<H5>DESCRIPTION</H5>
 The <CODE>OSALoad</CODE> function loads script data and returns a script ID. The generic scripting component uses the descriptor record in the <CODE>scriptData</CODE> parameter to determine which scripting component should load the script. If the descriptor record is of type <CODE>typeOSAGenericStorage</CODE>, the generic scripting component uses the trailer at the end of the script data to identify the scripting component. If the descriptor record's type is the subtype value for another scripting component, the generic scripting component uses the descriptor type to identify the scripting component. <P>
 If you want the script ID returned by <CODE>OSALoad</CODE> to identify only the minimum script data required to run the script and you are sure that you won't need to display the source data to the user, specify the <CODE>kOSAModePreventGetSource</CODE> flag in the <CODE>modeFlags</CODE> parameter. <P>
 Scripting components other than the generic scripting component can load script data only if it has been saved in a descriptor record whose descriptor type matches the scripting component's subtype.<P>
 Script data may change after it has been loaded--for example, if your application allows the user to edit a script's source data. To test whether script data has been modified, pass its script ID to <CODE>OSAGetScriptInfo</CODE>. If it has changed, you can call <CODE>OSAStore</CODE> again to obtain a handle to the modified script data and save it. <P>
<A NAME=HEADING349-12></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>errOSACorruptData<TD>-1702<TD>Corrupt data<TR>
<TD>errOSASystemError<TD>-1750<TD>General scripting system error<TR>
<TD>errOSABadStorageType<TD>-1752<TD>Script data not for this scripting component <A NAME=MARKER-2-133></A> <A NAME=MARKER-2-134></A> <TR>
<TD>errOSADataFormatObsolete<TD>-1758<TD>Data format is obsolete<TR>
<TD>errOSADataFormatTooNew<TD>-1759<TD>Data format is too new<TR>
<TD>badComponentInstance<TD>$80008001<TD>Invalid component instance</TABLE>
</H5>
<A NAME=HEADING349-13></A>
<H5>SEE ALSO</H5>
 For more information about the way scripting components interpret script data, see <A HREF=IAC-335.html#MARKER-9-98>"Saving Script Data" on page 10-12</A>. <P>
 For examples of the use of <CODE>OSALoad</CODE>, see <A HREF=IAC-336.html#MARKER-9-123>Listing 10-4 on page 10-16</A> and <A HREF=IAC-413.html#MARKER-9-291>Listing 10-6 on page 10-19</A>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-348.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-350.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
