<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>SerStatus(IM: D)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING324></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->




<!-- Main Body -->

<CENTER>
<P>
<A HREF="Devices-323.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Devices-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Devices-328.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Devices-325.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Devices-2.html"><B>Devices</B></A> / <BR><DD><A HREF="Devices-312.html"><B>Chapter 7 - Serial Driver</B></A> / <A HREF="Devices-316.html"><B>Serial Driver Reference</B></A><BR><DL><DD><A HREF="Devices-317.html"><B>Serial Driver Routines</B></A> / <A HREF="Devices-309.html"><B></B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING324-0></A>
<H3><A NAME=MARKER-9-68></A>SerStatus<A NAME=MARKER-2-69></A></H3>
 You can use the <CODE>SerStatus</CODE> function to obtain status information from the Serial Driver.<P>
<PRE>
FUNCTION SerStatus (refNum: Integer; VAR serSta: SerStaRec):OSErr;
</PRE>
<DL>
<DT><CODE>refNum</CODE>
<DD> The driver reference number of the serial input or output driver.
<DT><CODE>serSta</CODE>
<DD> A pointer to a serial status record.
</DL>
<A NAME=HEADING324-5></A>
<H5>DESCRIPTION</H5>
 The <CODE>SerStatus</CODE> function returns status information for the specified input or output driver. This information includes error conditions, flow control status, and whether there are read or write operations pending. Because the serial status record is shared, the <CODE>SerStatus</CODE> function returns the same information whether you reference the input or output driver. The serial status record is defined by the <CODE>SerStaRec</CODE> data type:<P>
<PRE>
TYPE SerStaRec =
PACKED RECORD
   cumErrs:    Byte;       {cumulative errors}
   xOffSent:   Byte;       {XOFF sent as input flow control}
   rdPend:     Byte;       {read pending flag}
   wrPend:     Byte;       {write pending flag}
   ctsHold:    Byte;       {CTS flow control hold flag}
   xOffHold:   Byte;       {XOFF flow control hold flag}
END;
</PRE>
<DL>
<H5>Field Description</H5>
<DT><CODE>cumErrs<A NAME=MARKER-2-70></A></CODE>
<DD> A bit field that indicates what errors have occurred since the last time the <CODE>SerStatus</CODE> function was called. You can use the bit mask constants shown below to test for particular errors. Errors detected include software overrun, break asserted, parity error, hardware overrun, and framing error.
<DT><CODE>xOffSent<A NAME=MARKER-2-71></A></CODE>
<DD> A bit field that indicates if the driver has initiated input flow control by sending an XOFF character or negating the DTR signal. You can use the bit mask constants shown below to test for these conditions.
<DT><CODE>rdPend<A NAME=MARKER-2-72></A></CODE>
<DD> This field contains a non-zero value if the driver has a read operation pending.
<DT><CODE>wrPend<A NAME=MARKER-2-73></A></CODE>
<DD> This field contains a non-zero value if the driver has a write operation pending.
<DT><CODE>ctsHold<A NAME=MARKER-2-74></A></CODE>
<DD> This field contains a non-zero value if the driver has suspended output due to the CTS handshake signal.
<DT><CODE>xOffHold<A NAME=MARKER-2-92></A></CODE>
<DD> This field contains a non-zero value if the driver has suspended output due to receiving an XOFF character.
</DL>
 You can use the following constants as bit mask values for the <CODE>cumErrs</CODE> field, to detect which errors have occurred since the last time the <CODE>SerStatus</CODE> function was called. Because these are bit mask values, you can sum them to specify more than one error condition. The remaining bit values in the <CODE>cumErrs</CODE> field are reserved.<P>
<PRE>
CONST
   swOverrunErr   = 1;     {software overrun error}
   breakErr       = 8;     {break signal asserted}
   parityErr      = 16;    {parity error}
   hwOverrunErr   = 32;    {hardware overrun error}
   framingErr     = 64;    {framing error}
</PRE>
 You can use the following constants as bit mask values to test the <CODE>xOffSent</CODE> field for the specified conditions. The remaining bit values in the <CODE>xOffSent</CODE> field are reserved.<P>
<PRE>
CONST 
   dtrNegated     = 64;    {DTR signal was negated}
   xOffWasSent    = 128;   {XOFF character was sent}
</PRE>
<DL>
<DT><B>IMPORTANT</B>
<DD>Calling <CODE>SerStatus</CODE> resets <CODE>cumErrs</CODE> and other fields of the serial status record, so repeated calls to <CODE>SerStatus</CODE> may not return identical results.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
<A NAME=HEADING324-19></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The <CODE>SerStatus</CODE> function is equivalent to a Device Manager status request with a <CODE>csCode</CODE> value of 8; the serial status record is returned in the first 6 bytes of the <CODE>csParam</CODE> field (<CODE>csParam[0]</CODE> = SerStaRec).<P>
 You can execute the status request immediately, bypassing the I/O queue, by setting bit 9 of the trap word. You can set this bit by appending the word <CODE>IMMED</CODE> as the second argument to the trap macro. For example:<P>
<PRE>
_Status, IMMED
</PRE>
 This technique is recommended when you need to determine the current status of a port before issuing a subsequent I/O request.<P>
<A NAME=HEADING324-24></A>
<H5><A NAME=MARKER-2-76></A>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error</TABLE>
</H5>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Devices-323.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Devices-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Devices-328.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Devices-325.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Devices-3.html">&copy; Apple Computer, Inc.</A><br>3 JUL 1996</center></font><P>
<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->
</BODY>
</HTML>  
