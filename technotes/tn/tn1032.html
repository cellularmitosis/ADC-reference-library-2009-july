<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!-- Template 03-24-01 --><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note TN1032: Mixing QuickDraw &amp; Post-Script Printing from Your App: Some Gotchas</title>    <meta name="keywords" content="Mac OS 8 generating Postscript Quickdraw printing PostScriptHandle PicComment">    <meta name="Description" content="Technical Note TN1032: This Technical Note details techniquesfor building an application that generates PostScript directlyand lists caveats a developer should be aware of when doingthis. This Note is aimed at application developers who wantto mix the PostScript and QuickDraw imaging models."><meta name="categories" content="Printing and QuickDraw"><meta name="week-posted" content="Jan 29, 1996 - Feb 2, 1996"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002874" title="Mixing QuickDraw & Post-Script Printing from Your App: Some Gotchas"></a><A NAME="top"></A><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxPrinting-date.html">Printing</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/Printing/index.html" target="_blank">Reference Library > Printing</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TN1032</div>
<div id="pageheadsub">Mixing QuickDraw &amp; Post-Script Printing from Your App: Some Gotchas</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"> <!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr><td width=300 valign="top" align=left scope="row">    <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td></tr><tr bgcolor="#e6e6e6">    <td background="images/tnmenubody.gif" width=300 align=left><span id="menutitle">    CONTENTS     <BR>    <BR></span>    </td></tr><tr bgcolor="#e6e6e6">    <td background="images/tnmenubody.gif" width=300 align=left><!-- begin_toc --><P id = "menutext"><A HREF = "#RTFToC1">Using the PostScriptHandle PicComment, a Friend Indeed</a><br><br><A HREF = "#RTFToC2">Printing PostScript Files</a><br><br><A HREF = "#RTFToC3">Summary</a><br><br><A HREF = "#References">References</a><br><br><A HREF="#Downloads">Downloadables</A></P>   <!-- end_toc -->  </td></tr><tr>    <td width=300 align=left scope="row"><img src="images/tnmenubottom.gif" alt="" width=300 height=16>    </td></tr>    </table></td><td width=300 valign="top" align=left><!-- begin_intro_text -->  <p id = "introtext">If your application generates PostScript directly, or you're considering writing an app that does, there are some techniques that will help your development efforts. This Technote explains these techniques, as well as gotchas that are either inadequately documented, or scattered across multiple documentation sources.</p><P id = "introtext">This Note is aimed at application developers who want to mix the PostScript and QuickDraw imaging models.</p><!-- end_intro_text --><!-- begin_date --><h3>&nbsp;Updated: [Feb 1 1996]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR> <!-- begin_content --><a name="RTFToC1"></a><h2>Using the PostScriptHandle PicComment, a Friend Indeed</h2><P>Think of the PostScriptHandle PicComment as your friend. Use it, but be aware of its limitations. Because this PicComment lets you send huge chunks of PostScript directly to a printer, it's your obvious choice. However, there are a few gotchas that you need to consider.</p><h3>Gotcha #1</h3><p>The LaserWriter driver has control of your coordinate system.</p> <P>This means that the normal PostScript coordinate system you know and love has been transformed, i.e., coordinates now match the QuickDraw orientation. This actually makes things easier for you. When you include the QuickDraw representation of the PostScript you're sending, the coordinate system will be the same as the one you used for the PostScript. You don't have to think about converting the coordinates. If you do include a QuickDraw PICT so you can print to QuickDraw printers, you should bracket this QuickDraw representation with the <code>PostScriptBegin</code> and <code>PostScriptEnd PicComments</code>.</p><P>Also, if the user selects 2-up or a similar option in the print driver, all the coordinates get transformed behind your back by the driver. The consequence of your app "thinking" it knows the coordinate system is that your app may end up coloring outside the lines. That's another good reason to keep things simple so you don't outsmart yourself.</p><h3>Gotcha #2</h3><p>The QuickDraw side of the imaging engine in the print driver isn't aware of any changes you make to the PostScript imaging state.</p> <P>The LaserWriter driver attempts to save and restore the graphics state around Postscript that you're sending to the printer, but there are cases when you can confuse it. In one case, for example, your app generates PostScript which prints to multiple pages without telling the driver. Another example would be changing the PostScript pen size directly rather than via QuickDraw. In general, if you are changing the state, you need to restore it.</p><h3>Gotcha #3</h3><P>QuickDraw, and the Printing manager only know about pages when you signal page boundaries by calling <code>PrOpenPage</code> and <code>PrClosePage</code>.</p><P>What this means to you is that any PostScript you send using the <code>PostScriptHandle PicComment</code> should be a single image. More specifically, it should meet the criteria established for an EPS image, as described in Adobe's <cite>PostScript Language Reference Manual, 2nd Edition, Appendix H</cite>.</p><P>Following these guidelines will also help you avoid Gotcha #2.</p><h3>Gotcha #4</h3> <p>Use the right method for sending an application-specific PostScript dictionary (a.k.a. prep).</p> <P>The <code>'PREC'</code> 103 resource has been defined as the proper place for an application to store its application-specific PostScript which needs to be sent to the printer with each job.</p><P>  Applications which do not use this resource not only keep the  LaserWriter driver from optimizing the PostScript it generates, but also create compatibility problems for future versions of the  LaserWriter driver.</p><P><A HREF="#top">Back to top</A></P><a name="RTFToC2"></a><h2>Printing PostScript Files </h2><P>If you want to print complete PostScript files to a PostScript printer, you should be using the PAP.WrkStation.o library, which is provided on the MacOS SDK CD. Sample code for using that library is in the works, and will appear on a future Developer CD.</p><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>Note:</B><BR>Be sure that you're using the latest version of the library in order to avoid compatibility problems and to get the latest bug fixes from Apple. </P></TD></TR></TABLE></CENTER><BR><P><A HREF="#top">Back to top</A></P><a name="RTFToC3"></a><h2>Summary</h2><P>The PostScriptHandle PicComment is your friend, but even as your friend, you need to be aware of its limitations.</p><P><A HREF="#top">Back to top</A></P><a name="#Reference"></a><h2>References</h2><P><a href="http://developer.apple.com/documentation/mac/QuickDraw/QuickDraw-465.html">Inside Macintosh: Imaging with QuickDraw</A>, Appendix B</P><p>PostScript Language Reference Manual, 2nd Edition, Appendix H</P><BR><P><A HREF="#top">Back to top</A></P>          <A NAME=Downloads></A>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (56K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/tn1032.pdf">Download</A></P>               </TD>            </TR>         </TABLE>         <BR><BR><P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER>		<!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tn/tn1032.html%3Fid%3DDTS10002874-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tn/tn1032.html%3Fid%3DDTS10002874-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tn/tn1032.html%3Fid%3DDTS10002874-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>