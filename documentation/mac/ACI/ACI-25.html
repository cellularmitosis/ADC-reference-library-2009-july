<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Animating a Window With a Palette</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING25></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->




<!-- Main Body -->

<CENTER>
<P>
<A HREF="ACI-24.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="ACI-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="ACI-122.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="ACI-26.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="ACI-2.html"><B>Advanced Color Imaging on the Mac OS</B></A> / <BR><DD><A HREF="ACI-14.html"><B>Chapter 1 - Palette Manager</B></A> / <A HREF="ACI-21.html"><B>Using the Palette Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING25-0></A>
<H2><A NAME=MARKER-9-131></A>Animating a Window With a Palette</H2>
 The Palette Manager provides functions that allow you to create color animation effects. <A HREF=#MARKER-9-132>Listing 1-5</A> shows a simple means of creating animation in your application. <P>
<DL>
<DT><B>Note</B>
<DD>Color animation requires color tables. Therefore, you can create color animation effects on indexed screens only. Screens with 16-bit and 32-bit pixel depth do not have color tables and therefore cannot support Palette Manager animation.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
<B>Listing 1-5  <A NAME=MARKER-9-132></A>Animating with a palette</B><P>
<PRE>
#define  clutID   150
#define  numcolor 256

void DoAnimate()
{
   CTabHandle     myColorTable, StoreCTab;
   PaletteHandle  myPalette;
   WindowPtr      myWindow;
   RGBColor       changeColor;

   myColorTable = GetCTable (clutID);

   /* create a new window */
   myWindow = NewCWindow(nil, &amp;BaseRect, 
                        &quot;\pUsing Palette Manager&quot;, 
                        TRUE, documentProc, 
                        (WindowPtr) -1, TRUE, nil);

   /* create a 256-color palette */
   myPalette = NewPalette(numcolor, myColorTable, pmAnimate, 0);

   /* assign the palette to the window */
   SetPalette ((WindowPtr) myWindow, myPalette, TRUE);


   GetEntryColor (myPalette, 1, &amp;changecolor);
   AnimatePalette (myWindow, StoreCTab, 2, 1, numcolor - 2);
   AnimateEntry (myWindow, numcolor - 1, &amp;changecolor);
   PaletteToCTab (myPalette, StoreCTab);
}
</PRE>
 In <A HREF=#MARKER-9-132>Listing 1-5</A>, the <CODE>DoAnimate</CODE> function does some setup before performing the animation. It first declares variables for two color lookup tables, for the window and palette IDs, and for an RGB color. It retrieves a color table with the <CODE>GetCTable</CODE> function (described in the chapter "Color QuickDraw" of <I>Inside Macintosh: Imaging With QuickDraw</I>) and creates a new color window with the <CODE>NewCWindow</CODE> function (described in the chapter "Window Manager" of <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I>). It then creates a palette from the color table using <CODE>NewPalette</CODE> and assigns this palette to the newly created window using <CODE>SetPalette</CODE>. The palette contains 256 colors and the colors are all animated colors.<P>
 The first step in the animation is to use the <CODE>GetEntryColor</CODE> function to save the first color in the palette. Then <CODE>AnimatePalette</CODE> cycles through each color in the palette (except for black and white, which do not animate). The <CODE>AnimateEntry</CODE> function moves the saved color to the last entry in the palette. Finally, <CODE>PaletteToCTab</CODE> saves the new version of the palette to the color table for use during the next animation. <P>
 One thing you could do with this animation code is to put it in a loop. Because the first entry has been moved to the end, the animation, in effect, begins at the second entry during the second iteration, and so on for each time through the loop. The result is an animation that not only cycles through the palette but also displays a slight variation at each iteration by beginning with a different color. <P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="ACI-24.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="ACI-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="ACI-122.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="ACI-26.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="ACI-3.html">&copy; Apple Computer, Inc.</A><br>13 NOV 1996<P>
<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->
</BODY>
</HTML> 
