<html><head><title>Mac OS X
 Manual Page For MPI_Scan(3)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/3/MPI_Scan" title="Mac OS X
 Manual Page for MPI_Scan(3)"><!-- headerDoc=man; indexgroup=Section 3; uid="//apple_ref/doc/man/3/MPI_Scan"; name=MPI_Scan(3) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
MPI_Scan(3OpenMPI)                                                                        MPI_Scan(3OpenMPI)



<b>NAME</b>
       <b>MPI_Scan</b> - Computes an inclusive scan (partial reduction)


<b>SYNTAX</b>
<b>C</b> <b>Syntax</b>
       #include &lt;mpi.h&gt;
       int MPI_Scan(void *<u>sendbuf</u>, void *<u>recvbuf</u>, int <u>count</u>,
            MPI_Datatype <u>datatype</u>, MPI_Op <u>op</u>, MPI_Comm <u>comm</u>)


<b>Fortran</b> <b>Syntax</b>
       INCLUDE 'mpif.h'
       MPI_SCAN(<u>SENDBUF,</u> <u>RECVBUF,</u> <u>COUNT,</u> <u>DATATYPE,</u> <u>OP,</u> <u>COMM,</u> <u>IERROR</u>)
            &lt;type&gt;    <u>SENDBUF(*),</u> <u>RECVBUF(*)</u>
            INTEGER   <u>COUNT,</u> <u>DATATYPE,</u> <u>OP,</u> <u>COMM,</u> <u>IERROR</u>


<b>C++</b> <b>Syntax</b>
       #include &lt;mpi.h&gt;
       void MPI::Intracomm::Scan(const void* <u>sendbuf</u>, void* <u>recvbuf</u>,
            int <u>count</u>, const MPI::Datatype&amp; <u>datatype</u>,
            const MPI::Op&amp; <u>op</u>) const


<b>INPUT</b> <b>PARAMETERS</b>
       sendbuf   Send buffer (choice).

       count     Number of elements in input buffer (integer).

       datatype  Data type of elements of input buffer (handle).

       op        Operation (handle).

       comm      Communicator (handle).


<b>OUTPUT</b> <b>PARAMETERS</b>
       recvbuf   Receive buffer (choice).

       IERROR    Fortran only: Error status (integer).


<b>DESCRIPTION</b>
       MPI_Scan is used to perform an inclusive prefix reduction on data distributed across the calling pro-<font color="#ffffff" class="whiteout">cesses.&nbsp;processes.</font>
       cesses. The operation returns, in the <u>recvbuf</u> of the process with rank i, the  reduction  (calculated
       according to the function <u>op</u>) of the values in the <u>sendbuf</u>s of processes with ranks 0, ..., i (inclu-<font color="#ffffff" class="whiteout">sive).&nbsp;(inclusive).</font>
       sive). The type of operations supported, their semantics, and the constraints  on  send  and  receive
       buffers are as for MPI_Reduce.


<b>EXAMPLE</b>
       This  example  uses  a user-defined operation to produce a segmented scan. A segmented scan takes, as
       input, a set of values and a set of logicals, where the logicals delineate the  various  segments  of
       the scan. For example,

       values     v1      v2      v3      v4      v5      v6      v7      v8
       logicals   0       0       1       1       1       0       0       1
       result     v1    v1+v2     v3    v3+v4  v3+v4+v5   v6    v6+v7     v8

       The result for rank j is thus the sum <!-- a -->v(i)<!-- /a --> + ... + <!-- a -->v(j)<!-- /a -->, where i is the lowest rank such that for all
       ranks n, i &lt;= n &lt;= j, <!-- a -->logical(n)<!-- /a --> = <!-- a -->logical(j)<!-- /a -->. The operator that produces this effect is

             [ u ]     [ v ]     [ w ]
             [   ]  o  [   ]  =  [   ]
             [ i ]     [ j ]     [ j ]

       where

                   ( u + v if i  = j
             w  =  (
                   ( v     if i != j

       Note that this is a noncommutative operator. C code that implements it is given below.

            typedef struct {
                 double val;
                 int log;
            } SegScanPair;

            /*
             * the user-defined function
             */
            void segScan(SegScanPair *in, SegScanPair *inout, int *len,
                 MPI_Datatype *dptr)
            {
                 int i;
                 SegScanPair c;

                 for (i = 0; i &lt; *len; ++i) {
                      if (in-&gt;log == inout-&gt;log)
                           c.val = in-&gt;val + inout-&gt;val;
                      else
                           c.val = inout-&gt;val;

                      c.log = inout-&gt;log;
                      *inout = c;
                      in++;
                      inout++;
                 }
            }

       Note that the inout argument to the user-defined function corresponds to the  right-hand  operand  of
       the  operator.  When using this operator, we must be careful to specify that it is noncommutative, as
       in the following:

            int            i, base;
            SeqScanPair    a, answer;
            MPI_Op         myOp;
            MPI_Datatype   type[2] = {MPI_DOUBLE, MPI_INT};
            MPI_Aint       disp[2];
            int            blocklen[2] = {1, 1};
            MPI_Datatype   sspair;

            /*
             * explain to MPI how type SegScanPair is defined
             */
            MPI_Get_address(a, disp);
            MPI_Get_address(a.log, disp + 1);
            base = disp[0];
            for (i = 0; i &lt; 2; ++i)
                 disp[i] -= base;
            MPI_Type_struct(2, blocklen, disp, type, &amp;sspair);
            MPI_Type_commit(&amp;sspair);

            /*
             * create the segmented-scan user-op
             * noncommutative - set commute (arg 2) to 0
             */
            MPI_Op_create((MPI_User_function *)segScan, 0, &amp;myOp);
            ...
            MPI_Scan(a, answer, 1, sspair, myOp, comm);


<b>USE</b> <b>OF</b> <b>IN-PLACE</b> <b>OPTION</b>
       WHen the communicator is an intracommunicator, you can perform a scanning  operation  in  place  (the
       output  buffer is used as the input buffer).  Use the variable MPI_IN_PLACE as the value of the <u>send-</u>
       <u>buf</u> argument.  The input data is taken from the receive buffer and replaced by the output data.


<b>NOTES</b> <b>ON</b> <b>COLLECTIVE</b> <b>OPERATIONS</b>
       The reduction functions of type MPI_Op do not return an error value.  As a result, if  the  functions
       detect  an error, all they can do is either call MPI_Abort or silently skip the problem. Thus, if the
       error handler is changed from MPI_ERRORS_ARE_FATAL to something else (e.g., MPI_ERRORS_RETURN),  then
       no error may be indicated.

       The  reason  for this is the performance problems in ensuring that all collective routines return the
       same error value.


<b>ERRORS</b>
       Almost all MPI routines return an error value; C routines as the value of the  function  and  Fortran
       routines  in  the  last argument. C++ functions do not return errors. If the default error handler is
       set to MPI::ERRORS_THROW_EXCEPTIONS, then on error the C++ exception mechanism will be used to  throw
       an MPI:Exception object.

       Before  the  error value is returned, the current MPI error handler is called. By default, this error
       handler aborts the MPI job, except for I/O function errors. The error handler  may  be  changed  with
       MPI_Comm_set_errhandler;  the  predefined  error handler MPI_ERRORS_RETURN may be used to cause error
       values to be returned. Note that MPI does not guarantee that an MPI  program  can  continue  past  an
       error.

       See the MPI man page for a full list of MPI error codes.


<b>SEE</b> <b>ALSO</b>
       MPI_Exscan
       MPI_Op_create
       MPI_Reduce




Open MPI 1.2                                   September 2006                             MPI_Scan(3OpenMPI)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man3/MPI_Scan.3.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man3/MPI_Scan.3.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man3/MPI_Scan.3.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
