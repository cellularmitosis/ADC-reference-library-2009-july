<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Modifying a Dictionary(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING494></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-493.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-495.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-483.html"><B>Chapter 8 - Dictionary Manager</B></A> / <A HREF="Text-489.html"><B>Using the Dictionary Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING494-0></A>
<H2><A NAME=MARKER-2-213></A>Modifying a Dictionary</H2>
 This section tells you how to use the Dictionary Manager routines to add, replace, or delete dictionary records.<P>
 <A NAME=MARKER-2-215></A>You can use the <CODE>InsertRecordToDictionary</CODE> function to add or replace a record in a specified dictionary. Because there cannot be two separate records with the same key value in a dictionary, adding a new record may nullify an existing one. To avoid such a problem, you can specify the <B>insertion mode,</B> which notifies the Dictionary Manager how you want the new record treated. The insertion mode determines whether to put the record into the dictionary<P>
<UL>
<LI>only if it does <I>not</I> replace an existing record with the same key
<LI>only if it <I>does</I> replace an existing record with the same key
<LI>regardless of whether it adds a record or replaces another record<P>
</UL>
 You can effectively insert and replace individual entries in records, in that you can obtain a record from a dictionary (with <CODE>FindRecordInDictionary</CODE> or <CODE>FindRecordByIndexInDictionary</CODE>), modify parts of the record, and then put the record back into the dictionary with <CODE>InsertRecordToDictionary</CODE>.<P>
 In <A HREF=#MARKER-9-79>Listing 8-5</A>, the routine prompts the user for a key word and data for a new dictionary record. It then constructs the new record--in proper dictionary format--by calling the application routine <CODE>NewDictionaryEntry</CODE>. Finally, it calls <CODE>InsertRecordToDictionary</CODE>, providing a dictionary reference number to the desired dictionary file, a Pascal string representing the key, a handle to the new record, and a specification of how to insert the record into the dictionary.<P>
<B>Listing 8-5  <A NAME=MARKER-9-79></A>Inserting a record into a dictionary</B><P>
<PRE>
PROCEDURE AddNewRecord (dictionaryReference: LongInt);
VAR
   keyStr, descriptionStr: Str255;
   descriptionHandle:      Handle;
   err:                    OSErr;
BEGIN
   IF dictionaryReference &lt;&gt; 0 THEN BEGIN
      keyStr := Ask('Enter key:', '&lt;key word&gt;');
      IF keyStr &lt;&gt; '' THEN BEGIN
         descriptionStr := Ask(CONCAT(CONCAT
                              ('Enter description for &quot;', 
                              keyStr), '&quot;'), '&lt;record data&gt;');
         IF descriptionStr &lt;&gt; '' THEN BEGIN
            descriptionHandle := NewDictionaryEntry 
                                       (descriptionStr, 128, '');
            IF descriptionHandle &lt;&gt; NIL THEN BEGIN
               err := InsertRecordToDictionary 
                                       (dictionaryReference, 
                                       keyStr, descriptionHandle, 
                                       kInsertOrReplace);

               IF err &lt;&gt; noErr THEN
                  DebugErrStr(err, 'InsertRecordToDictionary');
               DisposeHandle(descriptionHandle);
            END;
         END;
      END;
   END;
END;  {AddNewRecord}
</PRE>
 <A NAME=MARKER-21-11></A>To remove a record from a dictionary, call the <CODE>DeleteRecordFromDictionary</CODE> function. When you call <CODE>DeleteRecordFromDictionary</CODE> you specifiy the key of the record to be deleted and the dictionary reference number of the dictionary file that contains the record.<P>
 Remember that deleting records from a dictionary, or replacing them with shorter records, does not make the dictionary file any smaller. It simply creates garbage data.<A NAME=MARKER-9-10></A>  <A NAME=MARKER-2-225></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-493.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-495.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
