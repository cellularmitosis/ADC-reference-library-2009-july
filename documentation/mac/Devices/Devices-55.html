<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>About the Slot Manager(IM: D)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING55></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->




<!-- Main Body -->

<CENTER>
<P>
<A HREF="Devices-54.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Devices-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Devices-328.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Devices-56.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Devices-2.html"><B>Devices</B></A> / <BR><DD><A HREF="Devices-53.html"><B>Chapter 2 - Slot Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING55-0></A>
<H1><A NAME=MARKER-9-106></A>About the Slot Manager</H1>
 <A NAME=MARKER-2-330></A>The Slot Manager provides three basic services:<P>
<UL>
<LI>On startup, it examines each slot and initializes any expansion cards it finds.
<LI>It maintains data structures that contain information about each slot and every available sResource.
<LI>It provides functions that allow you to get information about expansion cards and their sResources.<P>
</UL>
 <A NAME=MARKER-9-108></A><A NAME=MARKER-8-35></A>There are two variations of the System 7 Slot Manager: version 1 and version 2. Version 1 of the Slot Manager is RAM based and is installed by the user with the System 7 upgrade kit. Version 2 is included in the ROM of newer Macintosh computers. <P>
 <A NAME=MARKER-2-110></A>At startup, the version of the Slot Manager in ROM searches each slot for a declaration ROM and creates a<B> slot information record</B> for each slot. See <A HREF=Devices-60.html#MARKER-9-209>"Slot Information Record" on page 2-24</A> for the definition of the <CODE>SInfoRecord</CODE> data type.<P>
 <A NAME=MARKER-2-333></A>As the Slot Manager searches the slots, it identifies all of the sResources in each declaration ROM and creates a table--the <B>slot resource table</B> (<B>SRT</B>)--that lists all of the sResources currently available to the system. The slot resource table is a private data structure maintained by the Slot Manager. Applications and device drivers use Slot Manager routines to get information from the slot resource table.<P>
 <A NAME=MARKER-2-334></A><A NAME=MARKER-2-335></A>After building the slot resource table, the Slot Manager initializes the 6 bytes reserved for each slot in parameter RAM. If the slot has an expansion card with a <CODE>PRAMInitData</CODE> entry in its board sResource, the Slot Manager uses the values in that entry to initialize the parameter RAM; otherwise, it clears those bytes in parameter RAM.<A NAME=MARKER-2-336></A><P>
 Next, the Slot Manager disables interrupts and executes the code in the <CODE>PrimaryInit</CODE> entry of the board sResource for each card. Note that at this point in the startup, the keyboard and the mouse are not initialized and that a card's <CODE>PrimaryInit</CODE> code has only limited control over the functionality of the card itself.<A NAME=MARKER-2-337></A><P>
 If certain values (defined by the Start Manager) are set in a card's parameter RAM, a card with an <CODE>sRsrcBootRec</CODE> entry may take over the system startup process. The Start Manager passes control to the code in the <CODE>sRsrcBootRec</CODE> early in the startup sequence, before system patches are installed. Refer to the chapter "Start Manager" in <I><A HREF="../OSUtilities/OSUtilities-2.html">Inside Macintosh: Operating System Utilities</A></I> for more information about the startup process.<A NAME=MARKER-2-64></A><P>
 <I>Designing Cards and Drivers for the Macintosh Family</I>, third edition, describes the <CODE>PRAMInitData</CODE>, <CODE>PrimaryInit</CODE>, and <CODE>sRsrcBootRec</CODE> entry types.<P>
 If no card takes over, the normal system startup continues. After version 1 of the Slot Manager is loaded, it conducts a second search for declaration ROMs, this time in 32-bit mode. If the Slot Manager finds any additional NuBus cards, it adds their sResources to the slot resource table and executes the code in their <CODE>PrimaryInit</CODE> entries. (Version 2 of the Slot Manager, which resides in ROM, does not need to conduct a second search.)<P>
<DL>
<DT><B>Note</B>
<DD>Some versions of the Slot Manager prior to System 7 address NuBus cards in 24-bit mode and may not be able to identify all cards. After version 1 of the Slot Manager is loaded, it locates these cards.<EM></EM>   <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 After all system patches have been installed, version 1 or later of the Slot Manager executes the code in any <CODE>SecondaryInit</CODE> entries it finds in the declaration ROMs. It does not reexecute the code from <CODE>PrimaryInit</CODE> entries, reinitialize parameter RAM, or restore any sResources deleted by the <CODE>PrimaryInit</CODE> code. <A NAME=MARKER-2-49></A><P>
<DL>
<DT><B>Note</B>
<DD>Most versions of the Slot Manager prior to System 7 do not execute code from <CODE>SecondaryInit</CODE> entries.<EM></EM>   <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 After the Slot Manager executes <CODE>SecondaryInit</CODE> code, it searches for sResources that have an <CODE>sRsrcFlags</CODE> entry with the <CODE>fOpenAtStart</CODE> flag set. When the Slot Manager finds an sResource with this flag set, it loads the device driver from the <CODE>sRsrcDrvrDir</CODE> entry of the sResource, or calls the code in the sResource's <CODE>sRsrcLoadRec</CODE> entry, which loads the sResource's device driver.<A NAME=MARKER-4-118></A><A NAME=MARKER-9-345></A><P>
 Finally, the system executes initialization resources of type <CODE>'INIT'</CODE>.<P>
 See <I>Designing Cards and Drivers for the Macintosh Family</I>, third edition, for details about the <CODE>sRsrcFlags</CODE>, <CODE>sRsrcDrvrDir</CODE>, and <CODE>sRsrcLoadRec</CODE> entry types.<A NAME=MARKER-2-346></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Devices-54.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Devices-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Devices-328.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Devices-56.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Devices-3.html">&copy; Apple Computer, Inc.</A><br>3 JUL 1996</center></font><P>
<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->
</BODY>
</HTML>  
