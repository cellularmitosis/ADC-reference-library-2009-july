<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>WebKit Objective-C Programming Guide: Determining WebKit Availability</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Determining WebKit Availability"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20001846" title="Determining WebKit Availability"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../InternetWeb-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000526" target="_top">Internet &amp; Web</a> &gt; <a href="../index.html" target="_top">WebKit Objective-C Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="CarbonApps.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/20001846-BAJEAIEE" title="Determining WebKit Availability"></a><hr /><H1>Determining WebKit Availability</H1><p>On Mac OS X 10.2, the WebKit framework and the URL Loading system is only available on systems that have installed Safari 1.0. This article explains how a Mach-O application that use the WebKit framework or the URL Loading system, can run effectively on versions of Mac OS X that don't have Safari 1.0 installed.</p><p>If a user runs your application on a system that does not have the appropriate frameworks installed it will fail to launch, or crash at some point during execution. In order to prevent this you must take some precautions in your project. </p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="WebKitAvail.html#//apple_ref/doc/uid/20001846-171156">Testing for URL Loading System Availability</a>
				
			<br/>
			
        
			
			
				<a href="WebKitAvail.html#//apple_ref/doc/uid/20001846-171303">Testing for WebKit Availability</a>
				
			<br/>
			
        
			
			
				<a href="WebKitAvail.html#//apple_ref/doc/uid/20001846-171578">Isolating Your WebKit and URL Loading System Symbols</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/20001846-171156" title="Testing for URL Loading System Availability"></a><h2>Testing for URL Loading System Availability</h2><p>The URL Loading system is available as of version 462.6 of the Foundation framework. To determine if the classes are available you can test the <code><a href="../../../Reference/Foundation/Miscellaneous/Foundation_Constants/Reference/reference.html#//apple_ref/doc/c_ref/NSFoundationVersionNumber" target="_top">NSFoundationVersionNumber</a></code> of the installed Foundation framework.</p><p>The example code in <span class="content_text"><a href="WebKitAvail.html#//apple_ref/doc/uid/20001846-BCIEJFCB">Listing 1</a></span> will return <code>YES</code> if the URL Loading system is available.</p><a name="//apple_ref/doc/uid/20001846-BCIEJFCB" title="Listing 1Determining if the URL Loading system is available."></a><p class="codesample"><a name="//apple_ref/doc/uid/20001846-171186" title="Listing 1Determining if the URL Loading system is available."></a><strong>Listing 1&nbsp;&nbsp;</strong>Determining if the URL Loading system is available.</p><div class="codesample"><table><tr><td scope="row"><pre>+ (BOOL)isURLLoadingAvailable<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    return (NSFoundationVersionNumber >= 462.6);<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/20001846-171303" title="Testing for WebKit Availability"></a><h2>Testing for WebKit Availability</h2><p>An application can test for the availability of the WebKit by attempting to create a bundle for the framework using NSBundle. If the framework exists, the application can use the <code>load</code> method to dynamically load the framework.</p><p>The example code in <span class="content_text"><a href="WebKitAvail.html#//apple_ref/doc/uid/20001846-BAJEIBAH">Listing 2</a></span> will return <code>YES</code> if the framework is installed and loads successfully.</p><a name="//apple_ref/doc/uid/20001846-BAJEIBAH" title="Listing 2Determining if the WebKit framework is available"></a><p class="codesample"><a name="//apple_ref/doc/uid/20001846-171333" title="Listing 2Determining if the WebKit framework is available"></a><strong>Listing 2&nbsp;&nbsp;</strong>Determining if the WebKit framework is available</p><div class="codesample"><table><tr><td scope="row"><pre>+ (BOOL)isWebKitAvailable<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    static BOOL _webkitAvailable=NO;<span></span></pre></td></tr><tr><td scope="row"><pre>    static BOOL _initialized=NO;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    if (_initialized)<span></span></pre></td></tr><tr><td scope="row"><pre>        return _webkitAvailable;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    NSBundle* webKitBundle;<span></span></pre></td></tr><tr><td scope="row"><pre>    webKitBundle = [NSBundle bundleWithPath:@"/System/Library/Frameworks/WebKit.framework"];<span></span></pre></td></tr><tr><td scope="row"><pre>    if (webKitBundle) {<span></span></pre></td></tr><tr><td scope="row"><pre>        _webkitAvailable = [webKitBundle load];<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    _initialized=YES;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    return _webkitAvailable;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/20001846-171578" title="Isolating Your WebKit and URL Loading System Symbols"></a><h2>Isolating Your WebKit and URL Loading System Symbols</h2><p>Simply testing the version of the Foundation framework or if the WebKit framework is installed is not sufficient. If the application contains WebKit or URL Loading system symbols it can fail before it's able to execute the test code and inform the user of the problem.</p><p>The application must ensure that the main bundle does not include any symbols that may not be available at launch. </p><a name="//apple_ref/doc/uid/20001846-171587" title="Conditionally Loading Code"></a><h3>Conditionally Loading Code</h3><p>One solution is to separate your WebKit dependent code into a bundle and load it only after determining that the framework is available. </p><p>You start by creating a new Bundle target in your application's Xcode project. This target should contain all your code that directly references WebKit classes, globals and types and is should be set to link against the WebKit.framework.</p><p>Your main application target in Project Builder should specify that it is dependent on the bundle and copy it to the application directory at compile time. Your application then checks the availability of the WebKit framework and, if present, uses <code>NSBundle</code> or <code>CFBundle</code> to dynamically load the code.</p><a name="//apple_ref/doc/uid/20001846-171968" title="Weak Linking Symbols"></a><h3>Weak Linking Symbols</h3><p>Mac OS X 10.2 introduced support for weak linking in Mach-O applications. It works in a similar manner to the traditional Mac OS' Code Fragment Manager’s weak, or soft imports.</p><p>The technical note “Ensuring Backwards Binary Compatibility - Weak Linking and Availability Macros on Mac OS X” describes the current support for weak linking of Carbon symbols. Currently, the same level of support is not available for Objective-C classes.</p><p>Due to the dynamic nature of Objective-C it is possible to avoid using linked symbols for class names by creating an instance of a class using the <code><!--a-->NSClassFromString()<!--/a--></code> function.</p><div class="codesample"><table><tr><td scope="row"><pre>Class webDownloadClass=NSClassFromString(@"WebDownload");<span></span></pre></td></tr><tr><td scope="row"><pre>WebDownload *download=[[webDownloadClass alloc] initWithRequest:theRequest<span></span></pre></td></tr><tr><td scope="row"><pre>                                                delegate:self];<span></span></pre></td></tr></table></div><p>This is equivalent to the following code that explicitly uses the <code>WebDownload</code> class.</p><div class="codesample"><table><tr><td scope="row"><pre>WebDownload *download=[[WebDownload alloc] initWithRequest:theRequest<span></span></pre></td></tr><tr><td scope="row"><pre>                                                     delegate:self];<span></span></pre></td></tr></table></div><p>Depending on your usage, it may also be necessary to dynamically load WebKit constants using CFBundle after determining that the framework is available. The example code in <span class="content_text"><a href="WebKitAvail.html#//apple_ref/doc/uid/20001846-BCIDFCBB">Listing 3</a></span> demonstrates testing for the framework and loading a WebKit constant using CFBundle.</p><a name="//apple_ref/doc/uid/20001846-BCIDFCBB" title="Listing 3Loading WebKit constants dynamically using CFBundle"></a><p class="codesample"><a name="//apple_ref/doc/uid/20001846-172054" title="Listing 3Loading WebKit constants dynamically using CFBundle"></a><strong>Listing 3&nbsp;&nbsp;</strong>Loading WebKit constants dynamically using CFBundle</p><div class="codesample"><table><tr><td scope="row"><pre> CFURLRef url = CFURLCreateWithFileSystemPath(NULL,<span></span></pre></td></tr><tr><td scope="row"><pre>                          CFSTR("/System/Library/Frameworks/WebKit.framework"),<span></span></pre></td></tr><tr><td scope="row"><pre>                          kCFURLPOSIXPathStyle, TRUE);<span></span></pre></td></tr><tr><td scope="row"><pre>    CFBundleRef bundle = CFBundleCreate(NULL, url);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (bundle != NULL) {<span></span></pre></td></tr><tr><td scope="row"><pre>        NSString **WebHistoryItemsAddedNotificationPointer =<span></span></pre></td></tr><tr><td scope="row"><pre>              (NSString **)CFBundleGetDataPointerForName(bundle,<span></span></pre></td></tr><tr><td scope="row"><pre>                                 CFSTR("WebHistoryItemsAddedNotification"));<span></span></pre></td></tr><tr><td scope="row"><pre>        if (WebHistoryItemsAddedNotificationPointer != NULL) {<span></span></pre></td></tr><tr><td scope="row"><pre>            NSLog(@"looked up WebHistoryItemsAddedNotification");<span></span></pre></td></tr><tr><td scope="row"><pre>            NSLog(@"location is %x, value is %@", *WebHistoryItemsAddedNotificationPointer, *WebHistoryItemsAddedNotificationPointer);<span></span></pre></td></tr><tr><td scope="row"><pre>        } else {<span></span></pre></td></tr><tr><td scope="row"><pre>            NSLog(@"found WebKit, but couldn't get the pointer");<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>    } else {<span></span></pre></td></tr><tr><td scope="row"><pre>        NSLog(@"no WebKit installed");<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr></table></div><p>See Also: Technical Note TN2064 - <span class="content_text"><a href="http://developer.apple.com/technotes/tn2002/tn2064.html" target="_top">Ensuring backwards compatibility - Weak Linking and Availability Macros in Mac OS X 10.2</a></span></p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="CarbonApps.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2003, 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-10-15<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Conceptual/DisplayWebContent/Tasks/WebKitAvail.html%3Fid%3D10000164i-2.4&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Conceptual/DisplayWebContent/Tasks/WebKitAvail.html%3Fid%3D10000164i-2.4&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Conceptual/DisplayWebContent/Tasks/WebKitAvail.html%3Fid%3D10000164i-2.4&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
