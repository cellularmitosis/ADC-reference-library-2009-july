<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>SendAEFromTSMComponent(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING460></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-459.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-461.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-409.html"><B>Chapter 7 - Text Services Manager</B></A> / <A HREF="Text-425.html"><B>Text Services Manager Reference</B></A><BR><DL><DD><A HREF="Text-458.html"><B>Text Services Manager Routines for Components</B></A> / <A HREF="Text-459.html"><B>Sending Apple Events to a Client Application</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING460-0></A>
<H3><A NAME=MARKER-9-304></A>SendAEFromTSMComponent</H3>
 <A NAME=MARKER-2-36></A>The <CODE>SendAEFromTSMComponent</CODE> function sends Apple events from a text service component to a client application. <A NAME=MARKER-2-306></A><P>
<PRE>
FUNCTION SendAEFromTSMComponent (VAR theAppleEvent: AppleEvent; 
                              VAR reply: AppleEvent; 
                              sendMode: AESendMode; 
                              sendPriority: AESendPriority; 
                              timeOutInTicks: LongInt; 
                              idleProc: IdleProcPtr; 
                              filterProc: EventFilterProcPtr): 
                              OSErr;
</PRE>
<DL>
<DT><CODE>theAppleEvent</CODE>
<DD> The Apple event to be sent.
<DT><CODE>reply</CODE>
<DD> The reply Apple event returned by <CODE>SendAEFromTSMComponent</CODE>.
<DT><CODE>sendMode</CODE>
<DD> The value that lets you specify one of the following modes specified by corresponding constants: the reply mode for the Apple event, the interaction level, the application switch mode, the reconnection mode, and the return receipt mode. To obtain the value for this parameter, add the appropriate constants. Comprehensive details about these constants are provided in the description of the Apple Event Manager <CODE>AESend</CODE> function in <I><A HREF="../IAC/IAC-2.html">Inside Macintosh: Interapplication Communication</A></I>.
<DT><CODE>sendPriority</CODE>
<DD> The value that specifies whether to put the Apple event at the back of the event queue (set with the <CODE>kAENormalPriority</CODE> flag) or at the front of the queue (<CODE>kAEHighPriority</CODE> flag).
<DT><CODE>timeOutInTicks</CODE>
<DD> The length of time (in ticks) that the client application is willing to wait for the reply or return receipt from the server application before it times out. If the value of this parameter is <CODE>kNoTimeOut</CODE>, the Apple event never times out.
<DT><CODE>idleProc</CODE>
<DD> A pointer to a function for any tasks (such as displaying a globe, a wristwatch, or a spinning beach ball cursor) that the application performs while waiting for a reply or a return receipt.
<DT><CODE>filterProc</CODE>
<DD> A pointer to a routine that accepts certain incoming Apple events that are received while the handler waits for a reply or a return receipt and filters out the rest.
</DL>
<A NAME=HEADING460-10></A>
<H5>DESCRIPTION</H5>
 The <CODE>SendAEFromTSMComponent</CODE> function is essentially a wrapper routine for the Apple Event Manager function <CODE>AESend</CODE>. See the description of <CODE>AESend</CODE> for additional necessary information, including constants for the <CODE>sendMode</CODE> parameter and result codes.<P>
 <CODE>SendAEFromTSMComponent</CODE> identifies your text service component from the <CODE>keyAEServerInstance</CODE> parameter in the Apple event specified in the <CODE>theAppleEvent</CODE> parameter. If a reference constant (refcon) in a TSM document that corresponds to this parameter is found in the internal data structures of the Text Services Manager, <CODE>SendAEFromTSMComponent</CODE> adds the reference constant as the <CODE>keyAETSMDocumentRefcon</CODE> parameter to the given Apple event before sending it to the application. <P>
 If the client application is not TSM-aware, <CODE>SendAEFromTSMComponent</CODE> routes the Apple events to the floating input window to allow bottomline input.<P>
<DL>
<DT><B>IMPORTANT</B>
<DD>If your text service component changes the environment in any way--such as by modifying the A5 world or changing the current zone--while constructing an Apple event, it must restore the previous settings before sending the Apple event.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
<DT><B>Note</B>
<DD>Your text service component should always use the <CODE>kCurrentProcess</CODE> constant as the target address when it creates an Apple event to send to the Text Services Manager.<EM></EM><A NAME=MARKER-2-41></A>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
<A NAME=HEADING460-16></A>
<H5>SEE ALSO</H5>
 The <CODE>AESend</CODE> function is described with the Apple Event Manager in <I><A HREF="../IAC/IAC-2.html">Inside Macintosh: Interapplication Communication</A></I>.<P>
 The <CODE>kCurrentProcess</CODE> constant is described in <I><A HREF="../Processes/Processes-2.html">Inside Macintosh: Processes</A></I>.<P>
 For sample code showing how a text service component calls the <CODE>SendAEFromTSMComponent</CODE> function, see <A HREF=Text-424.html#MARKER-9-216>Listing 7-11 on page 7-45</A>.<A NAME=MARKER-2-308></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-459.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-461.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
