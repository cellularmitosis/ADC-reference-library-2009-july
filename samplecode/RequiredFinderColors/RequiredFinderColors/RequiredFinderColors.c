/*	File:		RequiredFinderColors.c	Contains:	Under system 7, the finder switches to the black&white					version of all the desktop icons when certain required					colors aren't available in the device's color table.					This snippet shows which colors are needed in the						system color table for the desktop icons to be							displayed in their color version.  Also with these						colors, the apple icon in the menu bar will remain in					color as well.	Written by: Edgar Lee		Copyright:	Copyright © 1992-1999 by Apple Computer, Inc., All Rights Reserved.				You may incorporate this Apple sample source code into your program(s) without				restriction. This Apple sample source code has been provided "AS IS" and the				responsibility for its operation is yours. You are not permitted to redistribute				this Apple sample source code as "Apple sample source code" after having made				changes. If you're going to re-distribute the source, we require that you make				it clear in the source that the code was descended from Apple sample source				code, but that you've made changes.	Change History (most recent first):				8/10/1999	Karl Groethe	Updated for Metrowerks Codewarror Pro 2.1				*/#include <TextUtils.h>#include <Dialogs.h>#include <Fonts.h>#include <Processes.h>#include <Palettes.h>#include <Menus.h>#include <Resources.h>/* Constant Declarations */#define	WWIDTH	500#define	WHEIGHT	100#define WLEFT	(((qd.screenBits.bounds.right - qd.screenBits.bounds.left) - WWIDTH) / 2)#define WTOP	(((qd.screenBits.bounds.bottom - qd.screenBits.bounds.top) - WHEIGHT) / 2)void initMac();void setUpMenus();void createWindow();void drawWindow();void doEventLoop();void main(void){	initMac();	setUpMenus();		createWindow();		doEventLoop();}void initMac(){	MaxApplZone();	InitGraf( &qd.thePort );	InitFonts();	InitWindows();	InitMenus();	TEInit();	InitDialogs( nil );	InitCursor();	FlushEvents( 0, everyEvent );}void createWindow(){	Rect			rect;	WindowPtr		window;	PaletteHandle	palette;		SetRect( &rect, WLEFT, WTOP, WLEFT + WWIDTH, WTOP + WHEIGHT );	window = NewCWindow( 0L, &rect, "\pRequired Finder Colors", true, documentProc,							(WindowPtr)-1L, true, 0L );							SetPort( window );		TextMode( srcXor );	TextFont( kFontIDGeneva );	TextSize( 9 );		palette = GetNewPalette( 128 );	SetPalette( window, palette, true );}void setUpMenus(){	Handle		menuHandle;		if ((menuHandle = GetNewMBar( 128 )) == nil)		ExitToShell();			SetMenuBar( menuHandle );	AppendResMenu( GetMenu( 128 ), 'DRVR' );			DrawMenuBar();	ReleaseResource( menuHandle );}void drawWindow(){	int			i;	int			numEntries;	int			lineWidth;	RGBColor	color;	Str255		string;		numEntries = 10;	lineWidth = WWIDTH / numEntries;		PenSize( lineWidth, 1 );		for (i = 0; i < numEntries; i++)	{		PmForeColor( i );		MoveTo( i * lineWidth, 0 );		LineTo( i * lineWidth, WHEIGHT );				Index2Color( i, &color );				MoveTo( i * lineWidth + 5, WHEIGHT * 3 / 8 );		DrawString( "\pRGB:" );				NumToString( color.red, string );		MoveTo( i * lineWidth + 5, WHEIGHT / 2 );		DrawString( string );				NumToString( color.green, string );		MoveTo( i * lineWidth + 5, WHEIGHT * 5 / 8 );		DrawString( string );				NumToString( color.blue, string );		MoveTo( i * lineWidth + 5, WHEIGHT * 6 / 8 );		DrawString( string );	}}void doEventLoop(){	EventRecord 	event;	WindowPtr   	window;	short      		clickArea;	Rect       		screenRect;	for (;;)	{		if (WaitNextEvent( everyEvent, &event, 0, nil ))		{			if (event.what == mouseDown)			{				clickArea = FindWindow( event.where, &window );								if (clickArea == inDrag)				{					screenRect = (**GetGrayRgn()).rgnBBox;					DragWindow( window, event.where, &screenRect );				}				else if (clickArea == inContent)				{					if (window != FrontWindow())						SelectWindow( window );				}				else if (clickArea == inGoAway)					if (TrackGoAway( window, event.where ))						return;			}			else if (event.what == updateEvt)			{				window = (WindowPtr)event.message;					SetPort( window );								BeginUpdate( window );				drawWindow();				EndUpdate( window );			}		}	}}