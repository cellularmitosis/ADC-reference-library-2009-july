<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Cursor Handling (MacApp PG)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING66></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MacAppProgGuide-65.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-67.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MacAppProgGuide-2.html"><B>Programmer's Guide to MacApp</B></A> / <A HREF="MacAppProgGuide-21.html"><B>Part 1 - MacApp Theory and Architecture</B></A><BR><DD><A HREF="MacAppProgGuide-63.html"><B>Chapter 8 - Displaying, Manipulating, and Printing Data</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING66-0></A>
<H1><A NAME=MARKER-9-134></A><A NAME=MARKER-2-135></A>Cursor Handling</H1>
 MacApp's cursor-handling capabilities are provided as part of the application, window, and view classes. Using only MacApp's default behavior, your application can<P>
<UL>
<LI>associate a cursor resource ID with a view and display the specified image when the cursor is over the view
<LI>display an arrow cursor if no other cursor image is specified
<LI>display a special cursor when the cursor image is over draggable data, switch the cursor when the user starts a drag, and switch back to the previous cursor when the drag is complete
<LI>display the watch cursor when the application is busy for an extended period<P>
</UL>
 MacApp handles each of these operations automatically--all your application has to do is supply a cursor resource ID at the appropriate time.<P>
<DL>
<DT><B>Note</B>
<DD>A <I>mouse</I> is a hardware device and a <I>cursor</I> is an image displayed on the screen, but Macintosh users tend to use the terms interchangeably. This chapter will use whichever term seems appropriate to a particular discussion.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 The following sections describe MacApp's basic cursor operations. For more information on general cursor operations, see <A HREF=MacAppProgGuide-112.html#MARKER-9-19>Chapter 21, "Working With the Cursor."</A> For information on working with the cursor for drag-and-drop operations, see <A HREF=MacAppProgGuide-72.html#MARKER-9-29>Chapter 9, "Drag and Drop,"</A> and <A HREF=MacAppProgGuide-136.html#MARKER-9-19>Chapter 28, "Working With Drag and Drop."</A><P>
<A NAME=HEADING66-9></A>
<H2><A NAME=MARKER-2-136></A>The Cursor Region</H2>
 Since your application can change the cursor image at any time, MacApp must constantly check which image to display while the mouse is moving. To optimize the checking MacApp must do, your views that handle the cursor compute the region for which the current cursor image is valid. While the cursor remains in this region, MacApp will not change the cursor image.<P>
<DL>
<DT><B>IMPORTANT</B>
<DD>Any method that changes the cursor image or the current cursor region is responsible for setting a new cursor region.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 Whenever the application object receives an event indicating that the mouse has moved outside the current cursor region, it invalidates the cursor region. This results in a call to the application object's <CODE><A NAME=MARKER-2-137></A>TrackCursor</CODE> method.<A NAME=MARKER-2-138></A><P>
<A NAME=HEADING66-13></A>
<H2><A NAME=MARKER-2-139></A>Tracking the Cursor</H2>
 When the application object tracks the cursor, it looks for an application window that can handle the cursor. If it doesn't find one, it computes the largest possible default cursor region and sets the cursor to the arrow cursor.<P>
 If the application object does find a window that can handle the cursor, it calls the window object's <CODE>HandleCursor</CODE> method (a method of the <CODE>TView</CODE> class), which does the following:<P>
<OL>
<LI>If the view allows its subviews to handle the cursor, <CODE>HandleCursor</CODE> gives each interested subview that contains the mouse a chance to handle the cursor.
<LI>If no subview handles the cursor, it gives each enabled behavior a chance to handle the cursor.
<LI>If no subview or behavior handles the cursor, it sets the cursor region to the window's extent and calls <CODE>DoSetCursor</CODE> to set the cursor for the window.<P>
</OL>
<A NAME=HEADING66-19></A>
<H2><A NAME=MARKER-2-140></A>Setting the Cursor Image for a View</H2>
 When a user moves the cursor over a view, MacApp calls the view's <CODE><A NAME=MARKER-2-141></A>DoSetCursor</CODE> method. If no drag operation is involved, MacApp automatically sets the cursor image according to the view's <CODE>fCursorID</CODE> field. If <CODE>fCursorID</CODE> is set to <CODE>kNoResource</CODE>, the arrow cursor is shown.<P>
 If drag-and-drop support is included in the application, the <CODE>DoSetCursor</CODE> method calls the view method <CODE>DoSetDragCursor</CODE> to determine whether a mouse click would initiate a drag. Setting the cursor for a drag operation is described in <A HREF=MacAppProgGuide-75.html#MARKER-9-42>"Setting the Drag Cursor," beginning on page 257</A>.<P>
<A NAME=HEADING66-22></A>
<H2><A NAME=MARKER-2-142></A>Busy Cursor Handling</H2>
 Your application should display a progress dialog box when it is busy with a long task. For shorter tasks, or when you don't know how long a task will take, you can display a busy cursor instead. The most common busy cursor is the <B><A NAME=MARKER-2-143></A>watch cursor</B>, a cursor that looks like a wristwatch. The watch cursor is called "animated" when the hands spin around the watch face.<P>
<A NAME=HEADING66-24></A>
<H3><A NAME=MARKER-2-144></A>Default Busy Cursor Behavior</H3>
 MacApp's <A NAME=MARKER-2-145></A>UBusyCursor unit implements a mechanism for automatically setting the cursor to an animated watch cursor whenever the application is busy. An application is considered busy if it hasn't called any of the Toolbox routines <CODE><A NAME=MARKER-2-146></A>WaitNextEvent</CODE>, <CODE><A NAME=MARKER-2-147></A>GetNextEvent</CODE>, or <CODE><A NAME=MARKER-2-148></A>EventAvail</CODE> for a given number of ticks, where 60 ticks equals 1 second.<P>
 The busy cursor mechanism is implemented by a global object <CODE>gBusyCursor</CODE>, of type <CODE><A NAME=MARKER-2-150></A>TBusyCursor</CODE>. This object is created in <CODE><A NAME=MARKER-2-151></A>InitUBusyCursor</CODE>, which is called from <CODE>DoInitUMacApp</CODE>. The cursor is changed to a watch cursor by a <B>vertical blanking </B>(or <B>VBL</B>) <B>task</B>, a task that is executed during the vertical blanking interrupt. For more information on VBL tasks, see the <I>Technical Introduction to the Macintosh Family, second edition</I>.<P>
 MacApp's busy cursor has the following default behavior:<P>
<UL>
<LI>The delay before changing to the busy cursor is 120 ticks, or 2 seconds.
<LI>The busy cursor is always animated, at least for the first 231 - 1 (2,147,483,647) seconds (or roughly 68 years).<P>
</UL>
<A NAME=HEADING66-30></A>
<H3><A NAME=MARKER-2-152></A>Modifying Busy Cursor Behavior</H3>
 You can modify the behavior of the busy cursor object in the following ways:<P>
<UL>
<LI>You can turn off automatic display of the busy cursor.
<LI>You can set the delay time before the busy cursor is displayed.
<LI>You can tell the busy cursor not to stay animated if your application stops responding. This ensures that the busy cursor won't spin forever if your application never returns from a task.<P>
</UL>
 For specific details on how to modify busy cursor behavior, see <A HREF=MacAppProgGuide-114.html#MARKER-9-68>"Recipe--Modifying Busy Cursor Behavior," beginning on page 497</A> in <A HREF=MacAppProgGuide-112.html#MARKER-9-19>Chapter 21, "Working With the Cursor."</A><A NAME=MARKER-2-153></A><A NAME=MARKER-2-154></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MacAppProgGuide-65.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-67.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MacAppProgGuide-3.html">&copy; Apple Computer, Inc.</A><br>25 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
