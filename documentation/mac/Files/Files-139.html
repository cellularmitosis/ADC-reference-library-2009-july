<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Low-Level File Access Routines (IM: F)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING139></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Files-138.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-140.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Files-2.html"><B>Files</B></A> / <BR><DD><A HREF="Files-72.html"><B>Chapter 2 - File Manager</B></A> / <A HREF="Files-113.html"><B>File Manager Reference</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING139-0></A>
<H2><A NAME=MARKER-9-1084></A>Low-Level File Access Routines</H2>
 This section describes the low-level file access routines. These low-level routines, whose names begin with the letters <CODE>PB</CODE>, provide two advantages over the corresponding high-level file access routines:<P>
<UL>
<LI>These routines can be executed asynchronously, returning control to your application before the operation is completed.
<LI>In certain cases, these routines provide more extensive information or perform advanced operations.<P>
</UL>
 All of these routines exchange parameters with your application through a parameter block of type <CODE>ParamBlock</CODE>. When you call a low-level routine, you pass the address of the parameter block to the routine.<P>
<DL>
<DT><B><A NAME=MARKER-9-1085></A>Assembly-Language Note</B>
<DD>When you call any of these low-level routines, register A0 must point to a parameter block containing the parameters for the routine. If you want the routine to be executed asynchronously, set bit 10 of the routine trap word. You can do this by supplying the word <CODE>ASYNC</CODE> as the second argument to the routine macro. Here's an example:  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
<PRE>
_Read, ASYNC
</PRE>
<DL>
<DD>You can set or test bit 10 of a trap word using the global constant <CODE>asyncTrpBit</CODE>.<A NAME=MARKER-2-1086></A>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
<DD>The hierarchical extensions of certain basic File Manager routines actually are not new calls. For instance, <CODE>_Open</CODE> and <CODE>_HOpen</CODE> both trap to the same routine. The trap word generated by the <CODE>_HOpen</CODE> macro is the same as the trap word that would be generated by invoking the <CODE>_Open</CODE> macro with bit 9 set. The setting of this bit tells the File Manager to expect a larger parameter block containing the additional fields (such as a directory ID) needed to handle a hierarchical directory volume. You can set or test bit 9 of a trap word by using the global constant <CODE>hfsBit</CODE>.<A NAME=MARKER-2-1088></A>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
<DD>All File Manager routines return a result code in register D0.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 These low-level file access routines can run either synchronously or asynchronously. There are three versions of each routine. The first takes two parameters: a pointer to the parameter block and a Boolean parameter that specifies whether the routine is to run asynchronously (<CODE>TRUE</CODE>) or synchronously (<CODE>FALSE</CODE>). For example, the first version of the low-level routine to read bytes from a file has this declaration:<P>
<PRE>
FUNCTION PBRead (paramBlock: ParmBlkPtr; async: Boolean): OSErr;
</PRE>
 The second version does not take a second parameter; instead, it adds the suffix <CODE>Async</CODE> to the name of the routine.<P>
<PRE>
FUNCTION PBReadAsync (paramBlock: ParmBlkPtr): OSErr;
</PRE>
 Similarly, the third version of the routine does not take a second parameter; instead, it adds the suffix <CODE>Sync</CODE> to the name of the routine.<P>
<PRE>
FUNCTION PBReadSync (paramBlock: ParmBlkPtr): OSErr;
</PRE>
 Only the first version of each routine is documented in this section. (See <A HREF=Files-301.html#MARKER-9-1488>"Summary of the File Manager,"</A> beginning on <A HREF=Files-301.html#MARKER-9-1488>page 2-240</A>, for a listing of all three versions of these routines.) Note, however, that the second and third versions of these routines do not use the glue code that the first version uses and are therefore more efficient.<P>
<DL>
<DT><B>Note</B>
<DD>Although you can execute low-level file access routines asynchronously, the underlying device driver may not support asynchronous operation. The SCSI Manager, for example, currently supports only synchronous data transfers. Data transfers to a floppy disk or to a network server, however, can be made asynchronously. <EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
<HR>
<B>Subtopics</B>
<B><!-- TOC --><DL>
<DL>
<DT><A HREF="Files-140.html#HEADING140-0">Reading, Writing, and Closing Files</A>
<DD>
<DT><A HREF="Files-144.html#HEADING144-0">Manipulating the File Mark</A>
<DD>
<DT><A HREF="Files-147.html#HEADING147-0">Manipulating the End-of-File</A>
<DD>
<DT><A HREF="Files-150.html#HEADING150-0">Allocating File Blocks</A>
<DD>
<DT><A HREF="Files-153.html#HEADING153-0">Updating Files</A>
<DD>
</DL>
</DL>
</B>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Files-138.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-140.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Files-3.html">&copy; Apple Computer, Inc.</A><br>2 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
