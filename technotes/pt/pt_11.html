<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note PT11: Apple's Multidisk Installer</title>                                       <meta name="categories" content="Platforms and Tools"><meta name="week-posted" content="Feb 24, 1986 - Mar 7, 1986"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002665" title="Apple's Multidisk Installer"></a><a name="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxTools-date.html">Tools</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/DeveloperTools/idxFilesSoftwareInstallation-date.html" target="_blank">Tools > Files & Software Installation</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note PT11</div>
<div id="pageheadsub">Apple's Multidisk Installer</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext"><A HREF="#Section1">Introduction</A><BR><BR><A HREF="#Section2">Common Question and Answers</A><BR><BR><A HREF="#References">References</A><BR><BR><A HREF="#Changes">Change History</A><BR><BR><A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><p id="introtext">This Technical Note documents Apple's Multidisk Installer, and it is inaddition to separate Installer documentation which provides the details ofwriting scripts.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Sep 01 1991]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><a name=Section1></A><h2>Introduction</h2><p>Apple's Multidisk Installer is intended to make it easy for Macintosh users toadd or update software.  It is a very useful tool for adding third-partysoftware, and Apple recommends that you use the Installer unless your softwareinstallation is simple. Apple also recommends that you use version 3.2 of theInstaller.</p><p>The Multidisk Installer has the following features, as of version 3.2:</p><ul type="disc">	<li>"Easy Install" mode where the Installer script writer can determine the appropriate installation based upon examination of the target environment and provide the user with "One-Button Installation"</li>	<li>An optional "Custom Install" mode where power users can customize their installation</li>	<li>"Live" installation to the currently booted and active system; thus it is no longer necessary to ship the Installer on a bootable disk with a System Folder</li>	<li>Ability to install from an AppleShare server ("Network Install")</li>	<li>Ability to install from multiple source disks</li>	<li>Installation of software to folders other than the System Folder as well as creation of new folders as necessary</li>	<li>Runs under System 4.2 and later versions</li>	<li>"User Function" support; this feature provides linkage to developer-defined code segments during Easy Install, so script writers can customize the process of determining what software to install and how to install it</li>	<li>"Action Atom" support; this feature provides linkage to developer-defined code segments that are called before or after the installation takes place; script writers can use this feature to extend the capabilities of the Installer</li>	<li>Audit Records; this feature provides the script writer with the ability to record details about an installation so that future installations can be more intelligent</li></ul><p>The <code>'indm'</code> (default map) resource of Installer 3.0.1 is no longersupported in Installer 3.1 and later versions. This was used by script writersto implement Easy Install. It is replaced by <code>'infr'</code>  (framework) and<code>'inrl'</code> (rule) resources.</p><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>Note:</B><BR>If the user opens the Installer document rather than theInstaller, the wrong Installer may be launched (depending upon the contents oftheir mounted volumes). This is only a problem between versions 3.1 and 3.0.x.If you are developing a 3.1 script, you may want to add an <code>'indm'</code>resource that puts up a warning dialog box. If you are developing a 3.0.xscript, you may want to add an <code>'infr'</code> and <code>'inrl'</code> resourcethat puts up a <code>reportSysError</code> dialog box. This problem is resolved inInstaller 3.2. With version 3.2, the file type and creator are both<code>'bjbc'</code> as opposed to the use of <code>'cfbj'</code> with versions 3.0.1and 3.1.</P></TD></TR></TABLE></CENTER><BR>   <p>Installer version 3.2 is available as a complete reference suite which includesthe following:</p><ul type="disc">	<li><i>Installer 3.2 Scripting Guide  </i>(dated December 1, 1991, on the cover)</li>	<li><i>Installer ScriptCheck 3.2b7 User's Manual</i></li>	<li>Installer 3.2 application</li>	<li>ScriptCheck 3.2.1 (MPW Tool)</li>	<li>InstallerTypes.r (MPW Rez interface file)</li>	<li>ActionAtomIntf.a, .h, .p (Action Atom interface files for Assembler, C, and Pascal)</li></ul><p>The reference suite for Multidisk Installer 3.2 is available on the latestDeveloper CD and on AppleLink in the Developer Services Bulletin Board. TheMultidisk Installer was also provided on the System 7 Golden Master CD-ROM:however, that package included the b7 release of the MPW ScriptCheck tool.</p><p>Multidisk Installer version 3.2 contains a few minor improvements that willmake it easier to write scripts that work on both System 6.0.x and 7.0.Installer 3.1 had minimal testing with System 7.0. If you are expecting toinstall software onto machines running System 7.0, you should considerupgrading. Script changes should be minimal.</p><a name="Section2"></a><P><A HREF="#top">Back to top</A></p><h2>Common Question and Answers</h2> <p>Q. How can I check for a minimum system version?</p><p>A. Use the <code>checkFileVersion</code> clause as part of the <code>'inrl'</code> RulesFramework resource. The format of the minimal-version parameter is shown in theInstallerTypes.r file as '<code>#define Version</code>'. The most commondifficulties are in remembering that BCD values are required and in dealingwith two-digit version numbers. Some samples follow.</p><p>Assuming that the target-filespec resource, <code>'infs'</code>, for the Systemfile is 1000, use the following clause to check for System version 6.0.5:</p><p><code>checkFileVersion{1000, 6, 5, release, 0};</code></p><p>    Assuming that the target-filespec resource, <code>'infs'</code>, for the Finderfile is 1001, use the following clause to check for Finder version 6.1.5:</p><p><code>        checkFileVersion{1001, 6, 0x15, release, 0};</code></p><p>    Assuming that the target-filespec resource, <code>'infs'</code>, for the AppleTalkresource file is 1002, use the following clause to check for AppleTalk version53:</p><p><code>checkFileVersion{1002, 0x53, 0, release, 0};</code></p>                <p>Q. My Installer script installs a desk accessory. Under System 6, each time Irun the script, a new copy of the DA appears as a DRVR resource in the Systemfile. Why?</p><p>A. Unfortunately, this is a symptom when the <code>'deleteWhenInstalling'</code>flag is used in conjunction with the <code>'updateExisting'</code> flag. The<i>Installer 3.1 &amp; 3.2 Scripting Guide</i>  indicates that resources markedwith the <code>'dontDeleteWhenInstalling'</code> flag can be replaced with a newresource. The guide also indicates that the Installer will overwrite apreexisting resource in the target file if the <code>'updateExisting'</code> flagis set. Given these two flag settings, and the use of the replace<code>'byName'</code> (noByID) flag, the Installer does not delete the DA. Insteada new DRVR resource is created with the same name but a new resource ID.</p><p>    The correct Installer action is accomplished by setting the'deleteWhenInstalling' flag in conjunction with the 'updateExisting' flag.Alternatively, use the 'dontDeleteWhenInstalling' flag with the 'keepExisting'flag.</p><p>Q    How can I include the current volume name in a reportVolError alert as manyof the installation scripts from Apple do?</p><p>A    The volume name can be included by inserting "^0" in the desired location ofthe Pascal string passed to the <code>reportVolError</code> error reportingclause.</p><p>Q.    I set the <code>searchForFile</code> flag in my '<code>infs</code>' resource,however, the Installer acts as if it's unable to find the file.  Why?</p><p>A.    The likely reason for this problem is that the desired file is within afolder by the same name.  When the <code>searchForFile</code> flag is set, theInstaller will also find a match on a folder.  The Installer will not replace afolder with a file, nor will it add a resource to a folder.  The Installercontinues as if the search failed.</p><p>Q    What is the <code>'incd'</code> resource about?</p><p>A    When the MPW ScriptCheck tool is used, it reads the script's file creationdate/time stamp and converts it into a long word with the <code>Date2Secs</code>procedure. ScriptCheck stores this long word in the <code>'incd'</code> resourcefor use with verifying files when a network installation is performed. See thefollowing questions for a discussion of this resource.</p><p>Q    What checks are made by the Installer when preflighting an installation?Occasionally the alert "Could not find a required file . . ." occurs and theinstallation is aborted.</p><p>A    The Installer compiles a list of the source file specifications from each ofthe resource <code>'inra'</code> and file <code>'infa'</code> atoms specified among thepackage <code>'inpk'</code> atoms included for installation. Each source filespecification includes a complete path name. As each source file is accessed, acheck is made of the file's creation date/time stamp with the date/time stamprecorded in the corresponding <code>'infs'</code> resource. If the date/time stampsdo not match, the alert results and the installation is aborted.  The creationdate/time stamp in the <code>'infs'</code> resource can be:</p><ul type="disc">	<li>entered manually into the script file so long as the value is not 1 or 0, </li>	<li>filled in by ScriptCheck automatically, if a value of 1 is entered in the date field, </li>	<li>forced to be updated, if the -d switch is used with ScriptCheck.</li></ul><P>Q. What are some of the considerations when configuring a network installationsetup?</p><p>A. Under Installer 3.1/3.2, network software installations are made possible bysetting up an installation folder on the server volume. This folder willcontain the Installer application, the Script file, and a folder(s) matchingthe names of the required disk(s). Within the disk folder(s) are thecorresponding contents of the disk(s).</p><p>A problem can occur when a workstation is used to create the serverinstallation folder and the system date and time differ significantly betweenthe two systems. Under such condition, files copied from the workstation to theserver may have their creation and modification date time/stamps altered. If amodification is made, the "delta" is constant for both the creation andmodification date/time stamp and for all files copied at that time.</p><p>As indicated in the previous question, the Installer preflights a file bycomparing its creation date/time stamp with the value stored in thecorresponding 'infs' resource in the script file. To compensate for the factthat a server may alter a file's creation date/time stamp, the Installerimplements the <code>'incd'</code> resource. After the user selects the Installbutton, the Installer reads the 'incd' resource and compares it with the scriptfile's creation date/time stamp. The difference is stored as the "delta." On anormal disk installation, the "delta" is always zero. As the Installer findseach required source file, the file's creation date/time stamp is converted toa long word and adjusted by the "delta." The modified date/time stamp is thencompared with that stored in the script file. If the values match, the file isconsidered found and the installation proceeds. On network installations, thedelta may be nonzero. If so, it indicates that the file's creation date/timestamps were modified when copied to the server.  Thus the 'incd' resource givesthe Installer a way to maintain file verification even though the date/timestamp may be altered.</p><p>A specific problem can occur when an installation is set up on some systemsrunning older versions of Novell Server software. Under specific conditions,files copied to some Novell servers have their creation time stamp altered to12:00 A.M. regardless of the original time stamp. This includes the creationtime stamp of the script file. This condition wreaks havoc with the Installer'spreflight mechanism. The "delta" determined between the <code>'incd'</code>resource and the Script file's creation date/time stamp may  not be consistentwith the creation date/time stamp stored in the infs resource and thecorresponding file's time stamp now at 12:00 A.M.</p><p>A work-around solution for this problem is to set the Creation time stamp forall files on the installation disk  to 12:00 A.M. , BEFORE running theScriptCheck tool. Use the MPW tool SetFile to perform this function. Here's asample MPW script for performing this function:</p><p><code>    SetFile   -d "1/1/92 12:00AM" 'files -r -s -f ~'</code></p>    <p>This script assumes that the current directory is set to the root of theInstallation disk. For multiple disks, run this script on each disk.  Use the'-f' switch with ScriptCheck to ensure that the date/time stamps are updated onscripts previously checked.</p><p>Installation of software is a non-trivial process. Apple recommends that youreserve time for development and testing to ensure that the installationprocess proceeds smoothly on all target machine configurations.</p><p>To ship the Installer with your product you must contact Apple's SoftwareLicensing Department  (AppleLink: SW.LICENSE) and license the Installer aloneor with the system software package that includes the version of the Installeryou intend to use. Software Licensing also supplies you with a copy of theInstaller that you may ship.</p><a name="References"></a><P><A HREF="#top">Back to top</A></p><h2>References</h2><P>   Installer 3.2 Reference Suite<i></i></p> <P><A NAME=Changes></A></P>                  <P><A HREF="#top">Back to top</A></p><h2>Change History</H2>                                    <TABLE BORDER=0 CELLPADDING=3 WIDTH=544>            <TR>               <td width=100 align=left>                  <P ALIGN=center>01-September-1991</P>               </TD>               <td align="left">                  <P>Revised information on the use of Installerversion 3.1 to version 3.2. Revised information on the use of ScriptCheckversion 3.2.1 with Installer version 3.2. Added Common Questions and Answersrelating to the use of the Installer.</P>               </TD>            </TR>            <TR>               <td width=100 align=left>                  <P ALIGN=center>01-March-1986</P>               </TD>               <td align="left">                  <P>Originally written.</P>               </TD>            </TR>                     </TABLE>         <a name=Downloads></A>                  <P><A HREF="#top">Back to top</A></p><h2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (36K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/pt_11.pdf">Download</A></P>               </TD>            </TR>                    </TABLE>         <BR></TD></TR></table></center><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/pt/pt_11.html%3Fid%3DDTS10002665-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/pt/pt_11.html%3Fid%3DDTS10002665-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/pt/pt_11.html%3Fid%3DDTS10002665-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>