<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/1998/REC-html40-19980424/loose.dtd">
<html>
<head>
<title>kpi_protocol.h</title>
<meta http-equiv="Content-Type" content="text/html; charset=ascii">
<meta name="generator" content="HeaderDoc">
<style><!--
#tocMenu {
		display: block;
		position:fixed;
		top:0px;
		left:0px;
		width:210px;
		height:100%;
		background:transparent;
}
#bodyText {
		margin-left: 210px;
}
--></style>
<meta id="toc-file" name="toc-file" content="toc.html">
<script language="JavaScript" src="../../../../Resources/JavaScript/page.js" type="text/javascript"></script><link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css">
<style type="text/css"><!--.keyword {background:#ffffff; color:#761550;}.template {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.function {background:#ffffff; color:#000000;}.string {background: #ffffff; color:#891315;}.preprocessor {background:#ffffff; color:#236e25}.comment {background:#ffffff; color:#236e25}.char {background: #ffffff; color:#0000ff;}.var {background:#ffffff; color:#000000;}.type {background:#ffffff; color:#761550;}.param {background:#ffffff; color:#000000;}.graybox {         border-top: 1px solid #919699;         border-left: 1px solid #919699;         margin-bottom: 10px;         }  .graybox th {         padding: 4px 8px 4px 8px;         background: #E2E2E2;         font-size: 12px;         font-weight: bold;         border-bottom: 1px solid #919699;         border-right: 1px solid #919699;         }  .graybox td {         padding: 8px;         font-size: 12px;         text-align: left;         vertical-align: top;         border-bottom: 1px solid #919699;         border-right: 1px solid #919699;         }  --></style>
</head>
<body bgcolor="#ffffff" onload="initialize_page();">
<noscript>
<div id="tocMenu">
<iframe id="toc_content" name="toc_content" src="toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
</div>
</noscript>
<div id="bodyText">
<!-- start of header -->

<!-- start of header -->
<!--#include virtual="/includes/framesetheader"-->
<!-- end of header -->

<table width="600"><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <a href="../../../../../reference/Darwin/index.html#//apple_ref/doc/uid/TP30001281-TP30000422" target="_top">Darwin</a> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/kernel_fw_leo" target="_top">Kernel Framework Reference</a></font>
<!-- end breadcrumb insert request -->
<p>&#160;</p>
</td></tr></table>
<!-- end of header --><a name="top"></a>
<a name="//apple_ref/doc/header/kpi_protocol.h" title="kpi_protocol.h"></a>
<hr>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h1><a name="kpi_protocol.h">kpi_protocol.h</a></h1>
</td></tr></table>
<div class="spec_sheet_info_box"><table cellspacing="0" class="specbox"><tr>
<td scope="row"><b>Includes:</b></td>
<td><div style="margin-bottom:1px"><div class="content_text">
<!-- a -->&lt;sys/kernel_types.h&gt;<!-- /a --><br><a href="../kpi_interface_h/index.html#//apple_ref/doc/header/kpi_interface.h" target="_top">&lt;net/kpi_interface.h&gt;</a>
</div></div></td>
</tr></table></div>
<h2>Overview</h2>
<!-- begin discussion --><p>This header defines an API to interact with protocols in the kernel.
The KPIs in this header file can be used to interact with protocols
that already exist in the stack. These KPIs can be used to support
existing protocols over media types that are not natively supported
in the kernel, such as ATM.<!-- end discussion -->
</p>
<hr>
<br><h2>Functions</h2>
<a name="HeaderDoc_functions"></a>
<dl>
<dt><tt><a href="index.html#//apple_ref/c/func/proto_inject" target="_top">proto_inject</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/c/func/proto_input" target="_top">proto_input</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/c/func/proto_register_plumber" target="_top">proto_register_plumber</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/c/func/proto_unregister_plumber" target="_top">proto_unregister_plumber</a></tt></dt>
<dd></dd>
</dl>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/proto_inject;   name=proto_inject --><a name="//apple_ref/c/func/proto_inject"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="proto_inject">proto_inject</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><!-- a --><span class="type">errno_t</span><!-- /a --> <a href="index.html#//apple_ref/c/func/proto_inject" target="_top" class="function"><span class="function">proto_inject</span></a>(
    <a href="../kpi_interface_h/index.html#//apple_ref/c/tdef/protocol_family_t" target="_top" class="type"><span class="type">protocol_family_t</span></a> <span class="param">protocol</span>,
    <!-- a --><span class="type">mbuf_t</span><!-- /a --> <span class="param">packet</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>protocol</code></dt>
<dd><p>The protocol of the packet.</p></dd>
<dt><code>packet</code></dt>
<dd><p>The first packet in a chain of packets to be injected.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->A errno error on failure. Unless proto_inject returns zero,
the caller is responsible for freeing the mbuf.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Injects a packet on the specified protocol from
anywhere. To avoid recursion, the protocol may need to queue the
packet to be handled later.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/proto_input;   name=proto_input --><a name="//apple_ref/c/func/proto_input"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="proto_input">proto_input</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><!-- a --><span class="type">errno_t</span><!-- /a --> <a href="index.html#//apple_ref/c/func/proto_input" target="_top" class="function"><span class="function">proto_input</span></a>(
    <a href="../kpi_interface_h/index.html#//apple_ref/c/tdef/protocol_family_t" target="_top" class="type"><span class="type">protocol_family_t</span></a> <span class="param">protocol</span>,
    <!-- a --><span class="type">mbuf_t</span><!-- /a --> <span class="param">packet</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>protocol</code></dt>
<dd><p>The protocol of the packet.</p></dd>
<dt><code>packet</code></dt>
<dd><p>The first packet in a chain of packets to be input.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->A errno error on failure. Unless proto_input returns zero,
the caller is responsible for freeing the mbuf.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Inputs a packet on the specified protocol from the input
path.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/proto_register_plumber;   name=proto_register_plumber --><a name="//apple_ref/c/func/proto_register_plumber"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="proto_register_plumber">proto_register_plumber</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><!-- a --><span class="type">errno_t</span><!-- /a --> <a href="index.html#//apple_ref/c/func/proto_register_plumber" target="_top" class="function"><span class="function">proto_register_plumber</span></a>(
    <a href="../kpi_interface_h/index.html#//apple_ref/c/tdef/protocol_family_t" target="_top" class="type"><span class="type">protocol_family_t</span></a> <span class="param">proto_fam</span>,
    <a href="../kpi_interface_h/index.html#//apple_ref/c/tdef/ifnet_family_t" target="_top" class="type"><span class="type">ifnet_family_t</span></a> <span class="param">if_fam</span>, 
    <a href="index.html#//apple_ref/c/tdef/proto_plumb_handler" target="_top" class="type"><span class="type">proto_plumb_handler</span></a> <span class="param">plumb</span>,
    <a href="index.html#//apple_ref/c/tdef/proto_unplumb_handler" target="_top" class="type"><span class="type">proto_unplumb_handler</span></a> <span class="param">unplumb</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>proto_fam</code></dt>
<dd><p>The protocol family these plumbing functions will
handle.</p></dd>
<dt><code>if_fam</code></dt>
<dd><p>The interface family these plumbing functions will
handle.</p></dd>
<dt><code>plumb</code></dt>
<dd><p>The function to call to attach the protocol to an
interface.</p></dd>
<dt><code>unplumb</code></dt>
<dd><p>The function to call to detach the protocol to an
interface, may be NULL in which case ifnet_detach_protocol will
be used to detach the protocol.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->A non-zero value of the attach failed.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Allows the caller to specify the functions called when a protocol
is attached to an interface belonging to the specified family and when
that protocol is detached.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/proto_unregister_plumber;   name=proto_unregister_plumber --><a name="//apple_ref/c/func/proto_unregister_plumber"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="proto_unregister_plumber">proto_unregister_plumber</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <a href="index.html#//apple_ref/c/func/proto_unregister_plumber" target="_top" class="function"><span class="function">proto_unregister_plumber</span></a>(
    <a href="../kpi_interface_h/index.html#//apple_ref/c/tdef/protocol_family_t" target="_top" class="type"><span class="type">protocol_family_t</span></a> <span class="param">proto_fam</span>,
    <a href="../kpi_interface_h/index.html#//apple_ref/c/tdef/ifnet_family_t" target="_top" class="type"><span class="type">ifnet_family_t</span></a> <span class="param">if_fam</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>proto_fam</code></dt>
<dd><p>The protocol family these plumbing functions
handle.</p></dd>
<dt><code>if_fam</code></dt>
<dd><p>The interface family these plumbing functions handle.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Unregisters a previously registered plumbing function.
<!-- end discussion -->
</p>
<p></p>
<h2>Typedefs</h2>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/proto_plumb_handler;   name=proto_plumb_handler --><a name="//apple_ref/c/tdef/proto_plumb_handler"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="proto_plumb_handler">proto_plumb_handler</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <!-- a --><span class="type">errno_t</span><!-- /a --> ( <span class="type">*</span><!-- a --><span class="function">proto_plumb_handler</span><!-- /a -->)(
    <!-- a --><span class="type">ifnet_t</span><!-- /a --> <span class="param">ifp</span>,
    <a href="../kpi_interface_h/index.html#//apple_ref/c/tdef/protocol_family_t" target="_top" class="type"><span class="type">protocol_family_t</span></a> <span class="param">protocol</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>ifp</code></dt>
<dd><p>The interface the protocol should be attached to.</p></dd>
<dt><code>protocol_family</code></dt>
<dd><p>The protocol that should be attached to the
interface.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->A non-zero value of the attach failed.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>proto_plumb_handler is called to attach a protocol to an
interface. A typical protocol plumb function would fill out an
ifnet_attach_proto_param and call ifnet_attach_protocol.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/proto_unplumb_handler;   name=proto_unplumb_handler --><a name="//apple_ref/c/tdef/proto_unplumb_handler"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="proto_unplumb_handler">proto_unplumb_handler</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> ( <span class="type">*</span><!-- a --><span class="function">proto_unplumb_handler</span><!-- /a -->)(
    <!-- a --><span class="type">ifnet_t</span><!-- /a --> <span class="param">ifp</span>,
    <a href="../kpi_interface_h/index.html#//apple_ref/c/tdef/protocol_family_t" target="_top" class="type"><span class="type">protocol_family_t</span></a> <span class="param">protocol</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Fields</font></h5>
<dl>
<dt><code>ifp</code></dt>
<dd><p>The interface the protocol should be detached from.</p></dd>
<dt><code>protocol_family</code></dt>
<dd><p>The protocol that should be detached from the
interface.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>proto_unplumb_handler is called to detach a protocol
from an interface. A typical unplumb function would call
ifnet_detach_protocol and perform any necessary cleanup.
<!-- end discussion -->
</p>
<p></p>
<p><!-- start of footer -->

<!-- start of footer --> 
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/KernelIOKitFramework/kpi_protocol_h/index.html%3Fid%3DTP30000816-3.4&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/KernelIOKitFramework/kpi_protocol_h/index.html%3Fid%3DTP30000816-3.4&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/KernelIOKitFramework/kpi_protocol_h/index.html%3Fid%3DTP30000816-3.4&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</p>
<p>&#160;</p>
<!--#include virtual="/footer"-->
<!-- end of footer -->


<!-- end of footer -->
Last Updated: 2008-12-19
</div>
<!-- headerDoc=Header;  uid=//apple_ref/doc/header/kpi_protocol.h;   name=kpi_protocol.h --><a name="//apple_ref/doc/header/kpi_protocol.h"></a>
</body>
</html>
