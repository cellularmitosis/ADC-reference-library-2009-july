<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"        "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd"><HTML><!-- Template 03-24-01 --><!--Includes revisions to code listings--><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note TN1010: QuickTime Teletext Component APIs</title>    <meta name="keywords" content="Mac OS 8 TeleText API Apple Video Player TTGetLocalIndexPage TTIsBroadcasting">    <meta name="Description" content="Technical Note TN1010: This Technical Note describes theTeletext component APIs. The Teletext component is includedin the Video Startup extension which is part of the AppleVideo Player software. Therefore this Technical Note detailshow to access a TeleText page and how to use a TeleText Componentand also provides a list of TeleText API constants"><meta name="categories" content="QuickTime"><meta name="week-posted" content="Sep 25, 1995 - Oct 6, 1995"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002852" title="QuickTime Teletext Component APIs"></a><A NAME="top"></A><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxQuickTime-date.html">QuickTime</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/QuickTime/index.html" target="_blank">Reference Library > QuickTime</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TN1010</div>
<div id="pageheadsub">QuickTime Teletext Component APIs</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left">         <!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                        <span id="menutitle">                            CONTENTS                             <BR>                            <BR>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc --><p id="menutext"><A HREF = "#RTFToC1">About Teletext Component APIs</a><br><br><A HREF = "#RTFToC2">Using Teletext Component APIs</a><br><br><A HREF = "#RTFToC3">TeleText Component APIs</a><br><br> <A HREF="#References">References</A><br><br><A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                 <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">This Technical Note describes the Teletext component APIs.</p><P id = "introtext">The Teletext component is included in the Video Startup extension whichis part of the Apple Video Player software. The component provides astandard API for accessing the Teletext hardware available on theinternational and UK tuner cards.</p><P id = "introtext">See <a href="http://developer.apple.com/documentation/mac/QuickTime/QuickTime-2.html"><cite>Inside Macintosh: QuickTime</cite></A> and <a href="http://developer.apple.com/documentation/mac/QTComponents/QTComponents-2.html"><cite>Inside Macintosh: QuickTime Components</cite></A> for further documentation.</p><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P id="introtext"><B>Note:</B><BR>This document assumes you have used Teletext before and understand the basic functionality from a user point of view.</p></TD></TR></TABLE></CENTER><!-- end_intro_text --><!-- begin_date --><h3 align=center>&nbsp;[Oct 1 1995]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>                   <!-- begin_content --><br><a name="RTFToC1"></a><h2>About Teletext Component APIs</h2><P>The Apple international and UK tuner cards include Teletext decoding hardware. The hardware also includes an Teletext page cache (currently 512K, but this will change in the future). The Teletext decoder hardware automatically decodes each Teletext page as it is received by the TV tuner and places it in the page cache. The page cache can store up to 512 of the most recently received pages. Because most Teletext systems broadcast fewer than 512 pages, the page cache  contains almost every available Teletext page. This provides immediate access to any page on the system.</p><h3>Teletext Page Data</h3><P>The Teletext page data consists of 25 lines of data, each containing 40 characters. Each character may be a visible text character, a graphics character, or a special control character.  Control characters are used to set text color, text size, text or graphics mode, etc. Interpretation of the control codes is not terribly complex, but is beyond the scope of this document.</p><P>The first eight characters of the first line do not contain any visible data. This area is used by some televisions to display the current page number. The last eight characters of the first line contain the current time.</p><P>The last line is used to display Fastext information. If no Fastext information is available for the current page, the last line will contain spaces.</p><P>Visible text characters are not encoded using standard Macintosh character encoding. The data may be displayed as-is using the special Teletext font, but when displaying it using any other font or when saving it to disk or the clipboard, the data must be converted to standard Macintosh ASCII encoding.</p><P>Each page also contains a small amount of other information: Fastext page numbers if available, a local index page number if available, and the character set the page should be displayed with (i.e., English, German, etc.).</p><P><A HREF="#top">Back to top</A></P><a name="RTFToC2"></a><h2>Using Teletext Component APIs</h2><h3>Accessing a Teletext Page</h3><P>The general algorithm for accessing the Teletext pages is as follows:</p><ul><li>Issue a request for the required page.</li><li>Periodically check to see if the page is available. Pages in the page cache will be available almost immediately. Other pages won't be available until they have been received.</li><li>Once the page is available, read the page data into a buffer. The page can then be displayed, saved to disk, etc.</li></ul><P>If the page is being displayed to the user, the application must periodically check to see if the page has been updated. "Updated" simply means that the page has been retransmitted by the broadcast station since the last time the page data was read, the actual contents of the page may or may not have changed. If the page has been updated, the application should read the new page data, check to see if the data has actually changed, and redisplay the page if necessary.</p><P>If the page is being displayed to the user, the application should also update the time field (i.e., the last 8 characters of the first line) once every second.</p><h3>Using the Teletext component</h3><P>All access to the Teletext information is handled by the Teletext component. The following code demonstrates how to find and open the Teletext component:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    ComponentDescriptiontheDesc;    Componentid;    ComponentInstanceteletextInst;    theDesc.componentType = 'tltx';    theDesc.componentSubType = 0;    theDesc.componentManufacturer = 'appl';    theDesc.componentFlags = 0L;    theDesc.componentFlagsMask = 0L;    id = FindNextComponent(nil, &amp;theDesc);    if (id != nil)        teletextInst = OpenComponent(id);</pre>	</TD></TR></TABLE></CENTER><P><code>FindNextComponent</code> will return <code>nil</code> if the Teletext component does not exist or if the component has determined that the Teletext hardware does not exist. <code>OpenComponent</code> will return <code>nil</code> if the Teletext component has already been opened by another application.</p><P>When the application is finished using the component, it should close the component using the <code>CloseComponent</code> call.</p><P><A HREF="#top">Back to top</A></P><a name="RTFToC3"></a><h2>TeleText Component APIs</h2><H3>TTGetFastextPages</H3><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>pascal  ComponentResult TTGetFastextPages(ComponentInstance ci, short *pages);ci      component instancepages   pointer to an array of kTTFastextPages (4) page numbers</pre>	</TD></TR></TABLE></CENTER><P>Returns <code>ttPageNotAvailErr</code> if requested page is not yet in memory. Returns <code>ttNoPageLinksErr</code> if Fastext information is not available for this channel.</p><P>This function returns the page numbers associated with the four colored Fastext links. Page number 0 is for the red link, page number 1 is for the green link, page number 2 is for the yellow link, and page number 3 is for the cyan link. There may be fewer than four Fastext items available for a given page. A page number of zero indicates that the Fastext link is not available for the current page.</p><H3>TTGetLocalIndexPage</H3><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>pascal  ComponentResult TTGetLocalIndexPage(ComponentInstance ci, short *page);ci      component instancepage    pointer to a page number</pre>	</TD></TR></TABLE></CENTER><P>Returns <code>ttPageNotAvailErr</code> if requested page is not yet in memory. Returns <code>ttNoPageLinksErr</code> if there is no local index page indicated for this page.</p><P>This function returns the local index page for the current page. Some stations specify a local index page for each Teletext page transmitted. For example, all of the pages in the sports section might specify the sports index page as the local index page. In turn, the sports index page might specify the news index page as it's local index page. The local index page is generally associated with the "Index" or "i" button on a remote control. If no local index page is specified for a page, use page 100 as the index page.</p><H3>TTGetPageFlags</H3><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>pascal  ComponentResult TTGetPageFlags(ComponentInstance ci, long *flags);ci      component instanceflags   pointer to a 32-bit flag word</pre>	</TD></TR></TABLE></CENTER><P>Returns <code>ttPageNotAvailErr</code> if requested page is not yet in memory.</p><P>This function returns various flags associated with the current page.  Each of the flags is defined below:</p><P><CODE>kTTLanguageFlags</CODE> = A 3-bit language value that specifies with character set to use when displaying the current page. The defined values are shown below. Undefined values should be treated as English.</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>        kTTLangEnglish = 0        kTTLangFrench = 1        kTTLangSwedish = 2        kTTLangGerman = 4        kTTLangSpanish = 5        kTTLangItalian = 6</pre>	</TD></TR></TABLE></CENTER><P><CODE>kTTSubtitleFlag</CODE> = True if this page is a subtitle page. Subtitles are similar to US closed captioning. They are displayed in a box overlaying the video. Subtitles are generally transmitted on page 888.</P><P><CODE>kTTNewsFlashFlag</CODE> = True if this page is a newsflash page. Newsflashes are also displayed in a box overlaying the video, but may be transmitted on any page.</P><H3>TTGetPageNumber</H3><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>pascal   ComponentResult TTGetPageNumber(ComponentInstance ci, short *page, short *subpage);ci       component instancepage     pointer to a page numbersubpage  pointer to a subpage number</pre>	</TD></TR></TABLE></CENTER><P>This function returns the page and subpage numbers last requested using the <code>TTRequestPage</code> function.</p><H3>TTIsBroadcasting</H3><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>pascal   ComponentResult TTIsBroadcasting(ComponentInstance ci, Boolean *flag);ci       component instanceflag     pointer to a Boolean flag</pre>	</TD></TR></TABLE></CENTER><P>This function returns <code>true</code> if Teletext information is being broadcast on the current channel.</p><H3>TTIsPageAvailable</H3><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>pascal      ComponentResult TTIsPageAvailable(ComponentInstance ci, Boolean *available);ci          component instanceavailable   pointer to a Boolean flag</pre>	</TD></TR></TABLE></CENTER><P>This function returns <code>true</code> if the page requested using <code>TTRequestPage</code> has been received and placed in memory.</p><H3>TTIsPageUpdated</H3><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>pascal   ComponentResult TTIsPageUpdated(ComponentInstance ci, Boolean *updated);ci       component instanceupdated  pointer to Boolean flag</pre>	</TD></TR></TABLE></CENTER><P>Returns <code>ttPageNotAvailErr</code> if requested page is not yet in memory.</p><P>This function returns <code>true</code> if current page has been updated since the last call to <code>TTReadPage</code>.  "Updated" simply means that a new copy of the page has been received from the broadcast station, the contents of the page may or may not have changed.</p><H3>TTReadPage</H3><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>pascal  ComponentResult TTReadPage(ComponentInstance ci, Ptr buffer);ci      component instancebuffer  pointer to a 1000 byte page buffer</pre>	</TD></TR></TABLE></CENTER><P>Returns <code>ttPageNotAvailErr</code> if requested page is not yet in memory. Returns <code>ttParamErr</code> if the buffer pointer is <code>nil</code>.</p><P>This function reads an entire Teletext page into the specified buffer. The page must first be requested using the <code>TTRequestPage</code> function. The page is organized into 25 lines with 40 characters per line. See the Teletext specification for information on decoding the page data.</p><H3>TTReadLine</H3><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>pascal    ComponentResult TTReadLine(ComponentInstance ci, Ptr buffer,          short line, short startcol, short length);ci        component instancebuffer    pointer to an appropriatly sized bufferline      line number (0-24)startcol  starting column number (0-39)length    number of bytes to read (1-40)</pre>	</TD></TR></TABLE></CENTER><P>Returns <code>ttPageNotAvailErr</code> if requested page is not yet in memory. Returns <code>ttParamErr</code> if the buffer pointer is nil, or if any of the other parameters is out of range.</p><P>This function reads a portion of a Teletext line and places it into the specified buffer.</p><H3>TTRequestPage</H3><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>pascal   ComponentResult TTRequestPage(ComponentInstance ci, short page, short subpage);ci       component instancepage     page number (100-899)subpage  subpage number (0-99)</pre>	</TD></TR></TABLE></CENTER><P>Returns <code>ttPageNotAvailErr</code> if requested page is not yet in memory. Returns <code>ttParamErr</code> if the page or subpage numbers is out of range.</p><P>This function tells the Teletext hardware to load the requested page into internal memory. Requesting a page is an asynchronous operation. If the page number is in the external page cache, the page will be loaded into memory almost immediately. If it is not in the external page cache, the page won't be loaded into memory until the page is transmitted again. Use the <code>TTIsPageAvailable</code> function to determine if the page has been loaded into memory.</p><H3>TTReset</H3><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>pascal ComponentResult TTReset(ComponentInstance ci);ci     component instance</pre>	</TD></TR></TABLE></CENTER><P>This function resets the Teletext hardware, clearing the external page cache and setting the requested page number to 100. This function should be called whenever the user changes channels.</p><H3>Teletext Component Constants</H3><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>#define         ttUnimpErr                  -2201       /* feature unimplemented */#define         ttParamErr                  -2202       /* bad parameter (out of range, etc) */#define         ttPageNotAvailErr           -2203       /* requested page is not yet available */#define         ttTooManyInstErr            -2204       /* too many instances of tuner */#define         ttNoPageLinksErr            -2205       /* no fastext or index links available */#define         kTTFastextPages                 4       /* number of Fastext page links *#define         kTTLinesPerPage                 25      /* number of lines per page */#define         kTTLineLength                   40      /* number of characters per line */#define         kTTTimeLength                   8       /* number of characters in time field */#define         kTTLanguageFlags                ((1&lt;&lt;2)+(1&lt;&lt;1)+(1&lt;&lt;0))    /* language type*/#define         kTTSubtitleFlag                 (1&lt;&lt;3)                    /* subtitle flag*/#define         kTTNewsFlashFlag                (1&lt;&lt;4)                    /* news flash flag */#define             kTTLangEnglish              0       /* language values */#define             kTTLangFrench               1#define             kTTLangSwedish              2#define             kTTLangGerman               4#define             kTTLangSpanish              5#define             kTTLangItalian              6#define             kTTRequestPageSelect        6#define             kTTReadPageSelect           7#define             kTTReadLineSelect           8#define             kTTIsPageAvailableSelect    9#define             kTTIsPageUpdatedSelect      10#define             kTTGetPageFlagsSelect       11#define             kTTGetPageNumberSelect      12#define             kTTGetFastextPagesSelect    13#define             kTTResetSelect              14#define             kTTIsBroadcastingSelect     15#define             kTTGetLocalIndexPageSelect  16pascal ComponentResult TTGetFastextPages(ComponentInstance ac, short *pages)       ComponentCallNow(kTTGetFastextPagesSelect, sizeof(Ptr));pascal ComponentResult TTGetLocalIndexPage(ComponentInstance ac, short *page)       ComponentCallNow(kTTGetLocalIndexPageSelect, sizeof(Ptr));pascal ComponentResult TTGetPageFlags(ComponentInstance ac, long *flags)       ComponentCallNow(kTTGetPageFlagsSelect, sizeof(Ptr));pascal ComponentResult TTGetPageNumber(ComponentInstance ac, short *page, short *subpage)       ComponentCallNow(kTTGetPageNumberSelect, sizeof(Ptr) + sizeof(Ptr));pascal ComponentResult TTIsBroadcasting(ComponentInstance ac, Boolean *flag)       ComponentCallNow(kTTIsBroadcastingSelect, sizeof(Ptr));pascal ComponentResult TTIsPageAvailable(ComponentInstance ac, Boolean *available)       ComponentCallNow(kTTIsPageAvailableSelect, sizeof(Ptr));pascal ComponentResult TTIsPageUpdated(ComponentInstance ac, Boolean *updated)       ComponentCallNow(kTTIsPageUpdatedSelect, sizeof(Ptr));pascal ComponentResult TTReadPage(ComponentInstance ac, Ptr buffer)       ComponentCallNow(kTTReadPageSelect, sizeof(Ptr));pascal ComponentResult TTReadLine(ComponentInstance ac, Ptr buffer,                                  short line, short startcol,short length)       ComponentCallNow(kTTReadLineSelect, sizeof(Ptr) + sizeof(short)*3);pascal ComponentResult TTRequestPage(ComponentInstance ac, short page,short subpage)       ComponentCallNow(kTTRequestPageSelect, sizeof(short) +sizeof(short));pascal ComponentResult TTReset(ComponentInstance ac)       ComponentCallNow(kTTResetSelect, 0);</pre>	</TD></TR></TABLE></CENTER><P><A HREF="#top">Back to top</A></P><A NAME="References"></a><H2>References</h2><p><a href="http://developer.apple.com/documentation/mac/QuickTime/QuickTime-2.html"><cite>Inside Macintosh: QuickTime</cite></A> </p><p><a href="http://developer.apple.com/documentation/mac/QTComponents/QTComponents-2.html"><cite>Inside Macintosh: QuickTime Components</cite></A></p><p><cite>QuickTime 2.0 Developer Guide for Macintosh</cite></p><P><A HREF="#top">Back to top</A></P>                           <A NAME=Downloads></A>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (56K)</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/tn1010.pdf">Download</A></P>               </TD>            </TR>         </TABLE>         <BR><BR><P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tn/tn1010.html%3Fid%3DDTS10002852-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tn/tn1010.html%3Fid%3DDTS10002852-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tn/tn1010.html%3Fid%3DDTS10002852-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>