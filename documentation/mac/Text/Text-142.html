<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Text in QuickDraw Pictures(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING142></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-141.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-143.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-126.html"><B>Chapter 3 - QuickDraw Text</B></A> / <A HREF="Text-133.html"><B>Using QuickDraw Text</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING142-0></A>
<H2><A NAME=MARKER-9-17></A>Text in QuickDraw Pictures</H2>
 This section describes aspects of how text is stored in picture files, including related limitations and restrictions, such as the following:<P>
<UL>
<LI>The <A NAME=MARKER-2-38></A><CODE>grayishTextOr</CODE> transfer mode is not stored in pictures files, and therefore you cannot use it for printing.
<LI>Inside a picture definition, <A NAME=MARKER-2-674></A><CODE>DrawText</CODE> cannot have a <CODE>byteCount</CODE> greater than 255.<P>
</UL>
<A NAME=HEADING142-4></A>
<H3>Fonts</H3>
 Whenever you record text in a picture file, QuickDraw stores the name of the current <A NAME=MARKER-2-215></A>font and uses it when playing back the picture. This is true for pictures drawn in both the original and color graphics ports. The opcode that QuickDraw uses to save this information is <CODE>$002C</CODE>. Here is its data type:<P>
<PRE>
PictFontInfo   =  Record
                     length:  Integer; {length of data in bytes}
                     fontID:  Integer; {ID in the source system}
                     fontName:STR255;
                  End;
</PRE>
 QuickDraw saves this information only one time for each font used in a picture. <BR>The code in <A HREF=#MARKER-9-243>Listing 3-10</A> generates a picture file containing the font information that <A HREF=#MARKER-9-245>Listing 3-11</A> shows.<P>
<B>Listing 3-10  <A NAME=MARKER-9-243></A>Generating a picture file with font information</B><P>
<PRE>
GetFNum ('Venice', theFontID); {Set a font before opening PICT}
TextFont (theFontID);

pHand2   := OpenPicture (pictRect);
      MoveTo(20,20);
      DrawString(' Better be Venice');
      
      GetFNum('Geneva', theFontID);
      TextFont(theFontID);
      MoveTo(20,40);
      DrawString('Geneva');
      
      GetFNum('Geneva', theFontID);
      TextFont(theFontID);
      MoveTo(20,60);
      DrawString('Geneva');
   ClosePicture;
</PRE>
 When QuickDraw plays back a picture, it uses the font family ID (<CODE>fontID</CODE>) as a reference into the list of font names which are used to set the correct font on the target system.<A NAME=MARKER-2-942></A><P>
<B>Listing 3-11  <A NAME=MARKER-9-245></A>A picture file with font information</B><P>
<PRE>
OpCode 0x002C {9, 
   "0005 0656 656E 6963 65"} /* save current font */
TxFont 'venice'
DHDVText {20, 20, " Better be Venice"}
OpCode 0x002C {9,             /* save next font name */
   "0003 0647 656E 6576 61"}
TxFont 'geneva'
DVText {20, "Geneva"}
OpCode 0x002C {11,      /* ditto       */
   "0002 084E 6577 2059 6F72 6B"}
TxFont 'geneva'               /* second Geneva does not need 
                                 another $002C */
DVText {20, "Geneva"}
</PRE>
<A NAME=HEADING142-13></A>
<H3>Text With Multiple Style Runs</H3>
 If you used the <CODE><A NAME=MARKER-2-964></A>GetFormatOrder</CODE> procedure to determine the correct order in which to draw text consisting of multiple style runs, the style runs are stored in display order when you record the text in a picture file. To reconstruct the storage order of the text from the picture file, an application that reads the style runs into memory from the picture file must then use the <CODE>GetFormatOrder</CODE> procedure to reverse the display order to storage order. Finally, the application must write the text into memory again, following the order that <CODE>GetFormatOrder</CODE> returns.<P>
 For example, suppose you have a a text string consisting of three style runs with different text directions--A (right-to-left), B (left-to-right), and C (left-to-right)--in storage order. You number them: A=1, B=2, C=3.<P>
 You call <CODE>GetFormatOrder</CODE> for these style runs with a line direction of right to left, and it returns 2, 3, 1. When you draw the style runs in display order and record them in a picture file, they are written to the picture file in display order. Suppose that after you record the picture file, an application cuts and pastes the text. Now the style runs are written to memory in display order: B, C, A.<P>
 To get the proper storage order, you call <CODE>GetFormatOrder</CODE> again, with the same line direction that you used the first time you called <CODE>GetFormatOrder</CODE> to determine the display order, and it produces the original storage order: A, B, C.<A NAME=MARKER-2-6></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-141.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-143.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
