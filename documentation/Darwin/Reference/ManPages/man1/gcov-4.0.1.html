<html><head><title>Mac OS X Developer Tools
 Manual Page For gcov-4.0(1)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/1/gcov-4.0" title="Mac OS X Developer Tools
 Manual Page for gcov-4.0(1)"><!-- headerDoc=man; indexgroup=Section 1; uid="//apple_ref/doc/man/1/gcov-4.0"; name=gcov-4.0(1) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac&nbsp;OS&nbsp;X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>

<p style='text-align:justify;'>This manual page is associated with the Mac&nbsp;OS&nbsp;X
developer tools.  The software or headers described may not be present on your
Mac&nbsp;OS&nbsp;X installation until you install the developer tools
package.  This package is available on your Mac&nbsp;OS&nbsp;X installation DVD,
and the latest versions can be downloaded from
<a href="http://developer.apple.com/tools/download/">developer.apple.com</a>.</p>

<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
GCOV(1)                                              GNU                                             <!-- a -->GCOV(1)<!-- /a -->



<b>NAME</b>
       gcov - coverage testing tool

<b>SYNOPSIS</b>
       gcov [<b>-v</b>|<b>--version</b>] [<b>-h</b>|<b>--help</b>]
            [<b>-a</b>|<b>--all-blocks</b>]
            [<b>-b</b>|<b>--branch-probabilities</b>]
            [<b>-c</b>|<b>--branch-counts</b>]
            [<b>-n</b>|<b>--no-output</b>]
            [<b>-l</b>|<b>--long-file-names</b>]
            [<b>-p</b>|<b>--preserve-paths</b>]
            [<b>-f</b>|<b>--function-summaries</b>]
            [<b>-o</b>|<b>--object-directory</b> <u>directory|file</u>] <u>sourcefile</u> ...
            [<b>-u</b>|<b>--unconditional-branches</b>]

<b>DESCRIPTION</b>
       <b>gcov</b> is a test coverage program.  Use it in concert with GCC to analyze your programs to help create
       more efficient, faster running code and to discover untested parts of your program.  You can use <b>gcov</b>
       as a profiling tool to help discover where your optimization efforts will best affect your code.  You
       can also use <b>gcov</b> along with the other profiling tool, <b>gprof</b>, to assess which parts of your code use
       the greatest amount of computing time.

       Profiling tools help you analyze your code's performance.  Using a profiler such as <b>gcov</b> or <b>gprof</b>,
       you can find out some basic performance statistics, such as:

          how often each line of code executes

          what lines of code are actually executed

          how much computing time each section of code uses

       Once you know these things about how your code works when compiled, you can look at each module to
       see which modules should be optimized.  <b>gcov</b> helps you determine where to work on optimization.

       Software developers also use coverage testing in concert with testsuites, to make sure software is
       actually good enough for a release.  Testsuites can verify that a program works as expected; a
       coverage program tests to see how much of the program is exercised by the testsuite.  Developers can
       then determine what kinds of test cases need to be added to the testsuites to create both better
       testing and a better final product.

       You should compile your code without optimization if you plan to use <b>gcov</b> because the optimization,
       by combining some lines of code into one function, may not give you as much information as you need
       to look for `hot spots' where the code is using a great deal of computer time.  Likewise, because
       <b>gcov</b> accumulates statistics by line (at the lowest resolution), it works best with a programming
       style that places only one statement on each line.  If you use complicated macros that expand to
       loops or to other control structures, the statistics are less helpful---they only report on the line
       where the macro call appears.  If your complex macros behave like functions, you can replace them
       with inline functions to solve this problem.

       <b>gcov</b> creates a logfile called <u>sourcefile.gcov</u> which indicates how many times each line of a source
       file <u>sourcefile.c</u> has executed.  You can use these logfiles along with <b>gprof</b> to aid in fine-tuning
       the performance of your programs.  <b>gprof</b> gives timing information you can use along with the
       information you get from <b>gcov</b>.

       <b>gcov</b> works only on code compiled with GCC.  It is not compatible with any other profiling or test
       coverage mechanism.

<b>OPTIONS</b>
       <b>-h</b>
       <b>--help</b>
           Display help about using <b>gcov</b> (on the standard output), and exit without doing any further
           processing.

       <b>-v</b>
       <b>--version</b>
           Display the <b>gcov</b> version number (on the standard output), and exit without doing any further
           processing.

       <b>-a</b>
       <b>--all-blocks</b>
           Write individual execution counts for every basic block.  Normally gcov outputs execution counts
           only for the main blocks of a line.  With this option you can determine if blocks within a single
           line are not being executed.

       <b>-b</b>
       <b>--branch-probabilities</b>
           Write branch frequencies to the output file, and write branch summary info to the standard
           output.  This option allows you to see how often each branch in your program was taken.
           Unconditional branches will not be shown, unless the <b>-u</b> option is given.

       <b>-c</b>
       <b>--branch-counts</b>
           Write branch frequencies as the number of branches taken, rather than the percentage of branches
           taken.

       <b>-n</b>
       <b>--no-output</b>
           Do not create the <b>gcov</b> output file.

       <b>-l</b>
       <b>--long-file-names</b>
           Create long file names for included source files.  For example, if the header file <u>x.h</u> contains
           code, and was included in the file <u>a.c</u>, then running <b>gcov</b> on the file <u>a.c</u> will produce an output
           file called <u>a.c##x.h.gcov</u> instead of <u>x.h.gcov</u>.  This can be useful if <u>x.h</u> is included in multiple
           source files.  If you use the <b>-p</b> option, both the including and included file names will be
           complete path names.

       <b>-p</b>
       <b>--preserve-paths</b>
           Preserve complete path information in the names of generated <u>.gcov</u> files.  Without this option,
           just the filename component is used.  With this option, all directories are used, with <b>/</b>
           characters translated to <b>#</b> characters, <u>.</u> directory components removed and <u>..</u>  components renamed
           to <b>^</b>.  This is useful if sourcefiles are in several different directories.  It also affects the
           <b>-l</b> option.

       <b>-f</b>
       <b>--function-summaries</b>
           Output summaries for each function in addition to the file level summary.

       <b>-o</b> <u>directory|file</u>
       <b>--object-directory</b> <u>directory</u>
       <b>--object-file</b> <u>file</u>
           Specify either the directory containing the gcov data files, or the object path name.  The <u>.gcno</u>,
           and <u>.gcda</u> data files are searched for using this option.  If a directory is specified, the data
           files are in that directory and named after the source file name, without its extension.  If a
           file is specified here, the data files are named after that file, without its extension.  If this
           option is not supplied, it defaults to the current directory.

       <b>-u</b>
       <b>--unconditional-branches</b>
           When branch probabilities are given, include those of unconditional branches.  Unconditional
           branches are normally not interesting.

       <b>gcov</b> should be run with the current directory the same as that when you invoked the compiler.
       Otherwise it will not be able to locate the source files.  <b>gcov</b> produces files called
       <u>mangledname.gcov</u> in the current directory.  These contain the coverage information of the source file
       they correspond to.  One <u>.gcov</u> file is produced for each source file containing code, which was
       compiled to produce the data files.  The <u>mangledname</u> part of the output file name is usually simply
       the source file name, but can be something more complicated if the <b>-l</b> or <b>-p</b> options are given.  Refer
       to those options for details.

       The <u>.gcov</u> files contain the <b>:</b> separated fields along with program source code.  The format is

               &lt;execution_count&gt;:&lt;line_number&gt;:&lt;source line text&gt;

       Additional block information may succeed each line, when requested by command line option.  The
       <u>execution</u><b>_</b><u>count</u> is <b>-</b> for lines containing no code and <b>#####</b> for lines which were never executed.
       Some lines of information at the start have <u>line</u><b>_</b><u>number</u> of zero.

       The preamble lines are of the form

               -:0:&lt;tag&gt;:&lt;value&gt;

       The ordering and number of these preamble lines will be augmented as <b>gcov</b> development progresses ---<font color="#ffffff" class="whiteout">do&nbsp;--do</font>
       do not rely on them remaining unchanged.  Use <u>tag</u> to locate a particular preamble line.

       The additional block information is of the form

               &lt;tag&gt; &lt;information&gt;

       The <u>information</u> is human readable, but designed to be simple enough for machine parsing too.

       When printing percentages, 0% and 100% are only printed when the values are <u>exactly</u> 0% and 100%
       respectively.  Other values which would conventionally be rounded to 0% or 100% are instead printed
       as the nearest non-boundary value.

       When using <b>gcov</b>, you must first compile your program with two special GCC options: <b>-fprofile-arcs</b>
       <b>-ftest-coverage</b>.  This tells the compiler to generate additional information needed by gcov
       (basically a flow graph of the program) and also includes additional code in the object files for
       generating the extra profiling information needed by gcov.  These additional files are placed in the
       directory where the object file is located.

       Running the program will cause profile output to be generated.  For each source file compiled with
       <b>-fprofile-arcs</b>, an accompanying <u>.gcda</u> file will be placed in the object file directory.

       Running <b>gcov</b> with your program's source file names as arguments will now produce a listing of the
       code along with frequency of execution for each line.  For example, if your program is called <u>tmp.c</u>,
       this is what you see when you use the basic <b>gcov</b> facility:

               $ gcc -fprofile-arcs -ftest-coverage tmp.c
               $ a.out
               $ gcov tmp.c
               90.00% of 10 source lines executed in file tmp.c
               Creating tmp.c.gcov.

       The file <u>tmp.c.gcov</u> contains output from <b>gcov</b>.  Here is a sample:

                       -:    0:Source:tmp.c
                       -:    0:Graph:tmp.gcno
                       -:    0:Data:tmp.gcda
                       -:    0:Runs:1
                       -:    0:Programs:1
                       -:    1:#include &lt;stdio.h&gt;
                       -:    2:
                       -:    3:int main (void)
                       1:    4:{
                       1:    5:  int i, total;
                       -:    6:
                       1:    7:  total = 0;
                       -:    8:
                      11:    9:  for (i = 0; i &lt; 10; i++)
                      10:   10:    total += i;
                       -:   11:
                       1:   12:  if (total != 45)
                   #####:   13:    printf ("Failure\n");
                       -:   14:  else
                       1:   15:    printf ("Success\n");
                       1:   16:  return 0;
                       -:   17:}

       When you use the <b>-a</b> option, you will get individual block counts, and the output looks like this:

                       -:    0:Source:tmp.c
                       -:    0:Graph:tmp.gcno
                       -:    0:Data:tmp.gcda
                       -:    0:Runs:1
                       -:    0:Programs:1
                       -:    1:#include &lt;stdio.h&gt;
                       -:    2:
                       -:    3:int main (void)
                       1:    4:{
                       1:    4-block  0
                       1:    5:  int i, total;
                       -:    6:
                       1:    7:  total = 0;
                       -:    8:
                      11:    9:  for (i = 0; i &lt; 10; i++)
                      11:    9-block  0
                      10:   10:    total += i;
                      10:   10-block  0
                       -:   11:
                       1:   12:  if (total != 45)
                       1:   12-block  0
                   #####:   13:    printf ("Failure\n");
                   $$$$$:   13-block  0
                       -:   14:  else
                       1:   15:    printf ("Success\n");
                       1:   15-block  0
                       1:   16:  return 0;
                       1:   16-block  0
                       -:   17:}

       In this mode, each basic block is only shown on one line -- the last line of the block.  A multi-line
       block will only contribute to the execution count of that last line, and other lines will not be
       shown to contain code, unless previous blocks end on those lines.  The total execution count of a
       line is shown and subsequent lines show the execution counts for individual blocks that end on that
       line.  After each block, the branch and call counts of the block will be shown, if the <b>-b</b> option is
       given.

       Because of the way GCC instruments calls, a call count can be shown after a line with no individual
       blocks.  As you can see, line 13 contains a basic block that was not executed.

       When you use the <b>-b</b> option, your output looks like this:

               $ gcov -b tmp.c
               90.00% of 10 source lines executed in file tmp.c
               80.00% of 5 branches executed in file tmp.c
               80.00% of 5 branches taken at least once in file tmp.c
               50.00% of 2 calls executed in file tmp.c
               Creating tmp.c.gcov.

       Here is a sample of a resulting <u>tmp.c.gcov</u> file:

                       -:    0:Source:tmp.c
                       -:    0:Graph:tmp.gcno
                       -:    0:Data:tmp.gcda
                       -:    0:Runs:1
                       -:    0:Programs:1
                       -:    1:#include &lt;stdio.h&gt;
                       -:    2:
                       -:    3:int main (void)
               function main called 1 returned 1 blocks executed 75%
                       1:    4:{
                       1:    5:  int i, total;
                       -:    6:
                       1:    7:  total = 0;
                       -:    8:
                      11:    9:  for (i = 0; i &lt; 10; i++)
               branch  0 taken 91% (fallthrough)
               branch  1 taken 9%
                      10:   10:    total += i;
                       -:   11:
                       1:   12:  if (total != 45)
               branch  0 taken 0% (fallthrough)
               branch  1 taken 100%
                   #####:   13:    printf ("Failure\n");
               call    0 never executed
                       -:   14:  else
                       1:   15:    printf ("Success\n");
               call    0 called 1 returned 100%
                       1:   16:  return 0;
                       -:   17:}

       For each function, a line is printed showing how many times the function is called, how many times it
       returns and what percentage of the function's blocks were executed.

       For each basic block, a line is printed after the last line of the basic block describing the branch
       or call that ends the basic block.  There can be multiple branches and calls listed for a single
       source line if there are multiple basic blocks that end on that line.  In this case, the branches and
       calls are each given a number.  There is no simple way to map these branches and calls back to source
       constructs.  In general, though, the lowest numbered branch or call will correspond to the leftmost
       construct on the source line.

       For a branch, if it was executed at least once, then a percentage indicating the number of times the
       branch was taken divided by the number of times the branch was executed will be printed.  Otherwise,
       the message ``never executed'' is printed.

       For a call, if it was executed at least once, then a percentage indicating the number of times the
       call returned divided by the number of times the call was executed will be printed.  This will
       usually be 100%, but may be less for functions call "exit" or "longjmp", and thus may not return
       every time they are called.

       The execution counts are cumulative.  If the example program were executed again without removing the
       <u>.gcda</u> file, the count for the number of times each line in the source was executed would be added to
       the results of the previous <!-- a -->run(s)<!-- /a -->.  This is potentially useful in several ways.  For example, it
       could be used to accumulate data over a number of program runs as part of a test verification suite,
       or to provide more accurate long-term information over a large number of program runs.

       The data in the <u>.gcda</u> files is saved immediately before the program exits.  For each source file
       compiled with <b>-fprofile-arcs</b>, the profiling code first attempts to read in an existing <u>.gcda</u> file; if
       the file doesn't match the executable (differing number of basic block counts) it will ignore the
       contents of the file.  It then adds in the new execution counts and finally writes the data to the
       file.

       <b>Using</b> <b>gcov</b> <b>with</b> <b>GCC</b> <b>Optimization</b>

       If you plan to use <b>gcov</b> to help optimize your code, you must first compile your program with two
       special GCC options: <b>-fprofile-arcs</b> <b>-ftest-coverage</b>.  Aside from that, you can use any other GCC
       options; but if you want to prove that every single line in your program was executed, you should not
       compile with optimization at the same time.  On some machines the optimizer can eliminate some simple
       code lines by combining them with other lines.  For example, code like this:

               if (a != b)
                 c = 1;
               else
                 c = 0;

       can be compiled into one instruction on some machines.  In this case, there is no way for <b>gcov</b> to
       calculate separate execution counts for each line because there isn't separate code for each line.
       Hence the <b>gcov</b> output looks like this if you compiled the program with optimization:

                     100:   12:if (a != b)
                     100:   13:  c = 1;
                     100:   14:else
                     100:   15:  c = 0;

       The output shows that this block of code, combined by optimization, executed 100 times.  In one sense
       this result is correct, because there was only one instruction representing all four of these lines.
       However, the output does not indicate how many times the result was 0 and how many times the result
       was 1.

       Inlineable functions can create unexpected line counts.  Line counts are shown for the source code of
       the inlineable function, but what is shown depends on where the function is inlined, or if it is not
       inlined at all.

       If the function is not inlined, the compiler must emit an out of line copy of the function, in any
       object file that needs it.  If <u>fileA.o</u> and <u>fileB.o</u> both contain out of line bodies of a particular
       inlineable function, they will also both contain coverage counts for that function.  When <u>fileA.o</u> and
       <u>fileB.o</u> are linked together, the linker will, on many systems, select one of those out of line bodies
       for all calls to that function, and remove or ignore the other.  Unfortunately, it will not remove
       the coverage counters for the unused function body.  Hence when instrumented, all but one use of that
       function will show zero counts.

       If the function is inlined in several places, the block structure in each location might not be the
       same.  For instance, a condition might now be calculable at compile time in some instances.  Because
       the coverage of all the uses of the inline function will be shown for the same source lines, the line
       counts themselves might seem inconsistent.

<b>SEE</b> <b>ALSO</b>
       <a href="../man7/gpl.7.html#//apple_ref/doc/man/7/gpl"><u>gpl</u>(7)</a>, <a href="../man7/gfdl.7.html#//apple_ref/doc/man/7/gfdl"><u>gfdl</u>(7)</a>, <a href="../man7/fsf-funding.7.html#//apple_ref/doc/man/7/fsf-funding"><u>fsf-funding</u>(7)</a>, <a href="gcc.1.html#//apple_ref/doc/man/1/gcc"><u>gcc</u>(1)</a> and the Info entry for <u>gcc</u>.

<b>COPYRIGHT</b>
       Copyright (c) 1996, 1997, 1999, 2000, 2001, 2002, 2003, 2004, 2005 Free Software Foundation, Inc.

       Permission is granted to copy, distribute and/or modify this document under the terms of the GNU Free
       Documentation License, Version 1.2 or any later version published by the Free Software Foundation;
       with the Invariant Sections being ``GNU General Public License'' and ``Funding Free Software'', the
       Front-Cover texts being (a) (see below), and with the Back-Cover Texts being (b) (see below).  A copy
       of the license is included in the <a href="../man7/gfdl.7.html#//apple_ref/doc/man/7/gfdl"><u>gfdl</u>(7)</a> man page.

       (a) The FSF's Front-Cover Text is:

            A GNU Manual

       (b) The FSF's Back-Cover Text is:

            You have freedom to copy and modify this GNU Manual, like GNU
            software.  Copies published by the Free Software Foundation raise
            funds for GNU development.



gcc-4.0.1                                        2007-09-23                                          <!-- a -->GCOV(1)<!-- /a -->
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man1/gcov-4.0.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man1/gcov-4.0.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man1/gcov-4.0.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
