<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Overview (MacApp PG)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING49></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MacAppProgGuide-48.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-50.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MacAppProgGuide-2.html"><B>Programmer's Guide to MacApp</B></A> / <A HREF="MacAppProgGuide-21.html"><B>Part 1 - MacApp Theory and Architecture</B></A><BR><DD><A HREF="MacAppProgGuide-48.html"><B>Chapter 6 - Scripting</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING49-0></A>
<H1>Overview</H1>
 The Macintosh Operating System provides the capability of using high-level events to communicate between applications, to control applications, to allow users to automate tasks, and even to allow sophisticated users to modify an application's behavior. This capability is based on the Open Scripting Architecture and the use of Apple events.<P>
 To help explain the scripting support MacApp supplies, the following sections describe basic scripting terminology and examine the levels of scripting support an application may provide. For a more detailed description of scripting, refer to <I><A HREF="../IAC/IAC-2.html">Inside Macintosh: Interapplication Communication</A></I>.<P>
<A NAME=HEADING49-3></A>
<H2><A NAME=MARKER-9-20></A><A NAME=MARKER-2-42></A>Scripting Terminology</H2>
 Apple Computer has defined the <A NAME=MARKER-2-22></A><B>Open Scripting Architecture (<A NAME=MARKER-2-51></A>OSA)</B>--a standard mechanism that allows users to control multiple applications with scripts written in a variety of scripting languages. Each scripting language has a corresponding scripting component. The AppleScript component implements <B>AppleScript</B>, the standard user scripting language defined by Apple Computer. By default, MacApp uses the AppleScript scripting component.<P>
 An <A NAME=MARKER-2-24></A><B>Apple event</B> is a high-level event that conforms to the Apple Event Interprocess Messaging Protocol. The Apple Event Manager uses the Event Manager to send Apple events between applications on the same computer or between applications on remote computers. An application is called a <B>server</B> when it responds to Apple events sent by another application. The sending application is referred to as the <B>client.</B><P>
 The <A NAME=MARKER-2-71></A><B>Apple event object model</B> defines a standard interface that allows an application to be controlled from other applications and to be scriptable using standard, human-language terminology. A <B>script</B> is a collection of data that, when executed by the appropriate program, causes a corresponding action or series of actions.<P>
 An <A NAME=MARKER-2-26></A><B>Apple event object</B> is a distinct item (such as a word, paragraph, shape, window, or style format), in an application or its documents, that can be specified by an<B> <A NAME=MARKER-2-27></A>object specifier record</B> in an Apple event. The Apple Event Manager allows applications to construct and interpret object specifier records by means of a standard classification system for Apple event objects. The <B><A NAME=MARKER-2-28></A>Object Support Library (<A NAME=MARKER-2-29></A>OSL)</B> is a component of the Apple Event Manager; applications use the OSL to create and resolve object specifier records.<P>
 The <I>Apple Event Registry: Standard Suites</I> defines the standard <B>suites</B> of Apple events, which are groups of related events that are usually implemented together. The standard suites include the following:<P>
<UL>
<LI>The <A NAME=MARKER-2-30></A><B>Required suite</B> consists of the four Apple events that the operating system sends to applications. These events are Open Application, Open Documents, Print Documents, and Quit Application. To support System 7 and later system versions, your application must support these events. MacApp provides support for the Required suite.
<LI>The <A NAME=MARKER-2-61></A><B>Core suite</B> consists of the basic Apple events nearly all applications use to communicate, including Get Data, Set Data, Move, Delete, and Save. The Core suite also includes the four required Apple events. MacApp supports part of the Core suite and provides a framework for your application to support the rest.
<LI>A functional-area suite consists of a group of Apple events that support related operations. Functional-area suites include the Database suite, the Mail suite, the Telephony suite, and the Text suite. You can use the MacApp scripting framework to implement support for the suites that are appropriate to your application.<P>
</UL>
 An <A NAME=MARKER-2-32></A><A NAME=MARKER-2-72></A><B>Apple event terminology extension resource</B>, of type <CODE>'aete'</CODE>, provides information to a scripting component about the Apple events an application supports and about the human-language terminology associated with those events.<P>
 <B>Factoring</B> an application (see <A HREF=#MARKER-9-44>page 143</A>) is a two-part process that involves<P>
<UL>
<LI>separating code that controls the user interface from code that responds to user actions
<LI>breaking functions into discrete operations that can be implemented as separate tasks<P>
</UL>
 There are three well-defined levels of scripting support an application can provide:<P>
<UL>
<LI>A <A NAME=MARKER-2-34></A><B>scriptable application</B> is capable of responding to Apple events sent to it by a scripting component. All applications should be scriptable to the extent of supporting the four required Apple events listed above. A scriptable application may also respond to Apple events it sends to itself.
<LI>A <A NAME=MARKER-2-35></A><B>recordable application</B> responds to user actions by sending Apple events to itself. When the Apple events are sent, the Apple Event Manager may record them into a script.
<LI>An <A NAME=MARKER-2-36></A><B>attachable application</B> is capable of attaching scripts to the application's data or objects to modify the basic behavior of the application.<P>
An <A NAME=MARKER-2-75></A><B>embedded script</B> is built into the application at the development stage. An <A NAME=MARKER-2-38></A><B>attached script</B> is one that can be added or modified without rebuilding the application.<P>
</UL>
 Most applications should be scriptable and recordable. Consider making your application attachable if it will need to be very flexible or customizable.<P>
 Scripting and recording are closely related. A scriptable application can respond to Apple events sent to it from any source. A recordable application handles an Apple event that it sends to itself the same as if it were sent from an external source--by performing the operation requested by the user. This implies that recordable applications must be scriptable.<P>
<DL>
<DT><B>Note</B>
<DD>To help support scripting in your application, MacApp provides a mechanism for creating command objects that can both perform an operation and supply an Apple event that describes that operation. For more information, see <A HREF=MacAppProgGuide-44.html#MARKER-9-167>"Command Objects and Apple Events," beginning on page 120</A>.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 MacApp predispatches Apple events to attached scripts before dispatching them to the application's scriptable objects. For more information, see <A HREF=MacAppProgGuide-52.html#MARKER-9-77>"Dispatching Apple Events," beginning on page 150</A>.<A NAME=MARKER-2-47></A><P>
<A NAME=HEADING49-25></A>
<H2><A NAME=MARKER-2-40></A><A NAME=MARKER-9-41></A>Deciding What Level of Scripting to Support</H2>
 During the design of your application, you determine what level of scripting support the application will provide. Here are some of the basic questions you need to answer:<P>
<UL>
<LI>Which Apple events will your application support?
<LI>Will your application define its own suite of Apple events?
<LI>Will the application be recordable?
<LI>Will you use embedded scripts to perform application operations? Will you allow attached scripts to control application functions?<P>
</UL>
<A NAME=HEADING49-31></A>
<H3>Required and Core Event Suites</H3>
 <A NAME=MARKER-2-42></A>Every application should support the four Apple events in the Required suite, since these events may be sent to the application by the operating system. Many applications support additional events from the Core suite to specify operations such as getting and setting data, moving and deleting objects, and counting objects of a particular type. MacApp automates support for the Required suite and supplies substantial support for the Core suite as well.<P>
<A NAME=HEADING49-33></A>
<H3>Area Suites</H3>
 <A NAME=MARKER-2-44></A>Depending on its function, your application may also want to support Apple events from other suites, such as the Database, Mail, and Text suites. For more information on Apple event suites, see <A HREF=MacAppProgGuide-93.html#MARKER-9-42>"Identify the Custom Apple Event," beginning on page 361</A>.<P>
<A NAME=HEADING49-35></A>
<H3><A NAME=MARKER-9-44></A>Factoring</H3>
 <A NAME=MARKER-2-45></A>Factoring your application plays a key role in providing scripting support. If you thoroughly separate user interface code from code that responds to user actions, and if you perform operations as individual tasks, it will be much easier to use Apple events to initiate and record actions. It will also be easier to use scripts to manipulate your application in a powerful and comprehensive way. Factoring can be a useful design goal for cross-platform development, even if your application has minimal scripting support.<P>
 MacApp itself is factored through the use of command objects. When a user manipulates the user interface to perform a task, MacApp creates a command object to perform the specified operation. A command can send an Apple event that describes its command operation, making it easy to record the operation or to allow an attached script to respond to the Apple event.<P>
<A NAME=HEADING49-38></A>
<H3>Advantages and Disadvantages of Adding Scripting Support </H3>
 There are a number of reasons to factor your application and support scripting for various Apple events:<P>
<UL>
<LI>A factored application can be much easier to modify and debug.
<LI>You must support the required Apple events to be compatible with newer versions of the Macintosh Operating System.
<LI>An application that supports a wide variety of Apple events can interact more effectively with other applications.
<LI>Program testing can be automated and users can automate repetitive tasks.<P>
</UL>
 The use of embedded scripts (those built in at the program development stage) and attached scripts (those that can be added or modified after the application is built) can offer additional advantages:<P>
<UL>
<LI>It should often be possible to modify and test an embedded script more easily than to modify and test the equivalent function written in C++ code.
<LI>New or enhanced features can be delivered simply by distributing new scripts.
<LI>Power users can customize program behavior.<P>
</UL>
 But there are also costs associated with writing a fully factored program that supports a large number of Apple events and uses embedded or attached scripts:<P>
<UL>
<LI>Factoring can add to the time required to develop the application.
<LI>Functions implemented by scripts are likely to be slower than similar functions implemented in C++ code.
<LI>Scripting support adds some complexity to an application and can be difficult to debug, especially when you're at the beginning of the learning curve.
<LI>Allowing users to modify program behavior with scripts is definitely a two-edged sword. Consider the problem of providing technical support for a user who has modified or completely replaced scripts that provide the basic functions of your application.<A NAME=MARKER-2-46></A><P>
</UL>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MacAppProgGuide-48.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-50.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MacAppProgGuide-3.html">&copy; Apple Computer, Inc.</A><br>25 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
