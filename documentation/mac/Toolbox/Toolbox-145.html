<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>InsertMenuItem(IM:Tb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING145></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Toolbox-144.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-146.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Toolbox-2.html"><B>Macintosh Toolbox Essentials</B></A> / <BR><DD><A HREF="Toolbox-89.html"><B>Chapter 3 - Menu Manager</B></A> / <A HREF="Toolbox-107.html"><B>Menu Manager Reference</B></A><BR><DL><DD><A HREF="Toolbox-112.html"><B>Menu Manager Routines</B></A> / <A HREF="Toolbox-143.html"><B>Adding and Deleting Menu Items</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING145-0></A>
<H3><A NAME=MARKER-9-580></A>InsertMenuItem</H3>
 <A NAME=MARKER-11-581></A><A NAME=MARKER-2-582></A>Use the <CODE>InsertMenuItem</CODE> procedure to insert one or more items to a menu previously created using <CODE>NewMenu</CODE>, <CODE>GetMenu</CODE>, or <CODE>GetNewMBar</CODE>. <P>
 The <CODE>InsertMenuItem</CODE> procedure is also available as the <CODE>InsMenuItem</CODE> procedure.<P>
<PRE>
PROCEDURE InsertMenuItem (theMenu: MenuHandle; itemString: Str255; 
                           afterItem: Integer); 
</PRE>
<DL>
<DT><CODE>theMenu</CODE>
<DD> A handle to the menu record of the menu to which you wish to add the menu item or items.
<DT><CODE>itemString</CODE>
<DD>  A string that defines the characteristics of the new menu items. Note that in most cases you should store the text of a menu item in a resource, so that your menu items can be more easily localized. You can specify the contents of the <CODE>itemString</CODE> parameter using metacharacters; the <CODE>InsertMenuItem</CODE> procedure accepts the same metacharacters as the <CODE>AppendMenu</CODE> procedure. However, if you specify multiple items, the <CODE>InsertMenuItem</CODE> procedure inserts the items in the reverse of their order in the <CODE>itemString</CODE> parameter.
<DT><CODE>afterItem</CODE>
<DD> The item number of the menu item after which the new menu items are to be added. Specify 0 in the <CODE>afterItem</CODE> parameter to insert the new items before the first menu item; specify the item number of a current menu item to insert the new menu items after it; specify a number greater than or equal to the last item in the menu to append the new items to the end of the menu.
</DL>
<A NAME=HEADING145-7></A>
<H5>DESCRIPTION</H5>
 The <CODE>InsertMenuItem</CODE> procedure inserts any defined menu items to the specified menu. The menu items are inserted according to the location specified by the <CODE>afterItem</CODE> parameter. You specify the text of any menu items and their characteristics in the <CODE>itemString</CODE> parameter. You can embed metacharacters in the string you specify to define various characteristics of a menu item. The metacharacters aren't displayed in <BR>the menu.<P>
 Here are the metacharacters you can specify in the <CODE>itemString</CODE> parameter:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Metacharacter<TH>Description<TR>
<TD><CODE>;</CODE> or Return<TD>Separates menu items.<TR>
<TD>^<TD>When followed by an icon number, defines the icon for the item. If the keyboard equivalent field contains $1C, this number is interpreted as a script code.<TR>
<TD>!<TD>When followed by a character, defines the mark for the item. If the keyboard equivalent field contains $1B, this value is interpreted as <BR>the menu ID of a submenu of this menu item.</TABLE>
 
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Metacharacter<TH>Description<TR>
<TD>&lt;<TD>When followed by one or more of the characters B, I, U, O, and S, defines the character style of the item to Bold, Italic, Underline, Outline, or Shadow, respectively.<TR>
<TD>/<TD>When followed by a character, defines the keyboard equivalent for the item. When followed by $1B, specifies that this menu item has a submenu. To specify that the menu item has a script code, small icon, or reduced icon, use the <CODE>SetItemCmd</CODE> procedure to set the keyboard equivalent field to $1C, $1D, or $1E, respectively.<TR>
<TD>(<TD>Defines the menu item as disabled.</TABLE>
<P>
 You can specify any, all, or none of these metacharacters in the text string. The metacharacters that you specify aren't displayed in the menu item. To use any of these metacharacters in the text of a menu item, first use <CODE>InsertMenuItem</CODE>, specifying at least one character as the item's text, and then use the <CODE>SetMenuItemText</CODE> procedure to set the item's text to the desired string.<P>
<DL>
<DT><B>Note</B>
<DD>If you add menu items using the <CODE>InsertMenuItem</CODE> procedure, you should define the text and any marks or keyboard equivalents in resources for easier localization. <EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 You can specify the first character that defines the text of a menu item as a hyphen to create a divider line. The string in the <CODE>itemString</CODE> parameter can be blank (containing one or more spaces), but it should not be an empty string.<P>
 If you do not define a specific characteristic of a menu item, the <CODE>InsertMenuItem</CODE> procedure assigns the default characteristic to the menu item. If you do not define any characteristic other than the text for a menu item, the <CODE>InsertMenuItem</CODE> procedure inserts the menu item so that it appears in the menu as an enabled item, without an icon or a mark, in the plain character style, and without a keyboard equivalent. <P>
 You can use <CODE>InsertMenuItem</CODE> to insert items into a menu regardless of whether the menu is in the current menu list.<P>
<A NAME=HEADING145-15></A>
<H5>SEE ALSO</H5>
 See <A HREF=Toolbox-102.html#MARKER-9-343>"Adding Items to a Menu" beginning on page 3-64</A> for examples. <A NAME=MARKER-2-583></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Toolbox-144.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-146.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Toolbox-3.html">&copy; Apple Computer, Inc.</A><br>11 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
