<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Automator Programming Guide: Implementing an AppleScript Action</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Implementing an AppleScript Action"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001512" title="Implementing an AppleScript Action"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000418" target="_top">Apple Applications</a> &gt; <a href="../../../Automator-date.html#//apple_ref/doc/uid/TP30000440-TP30000418-TP40001673" target="_top">Automator</a> &gt; <a href="../index.html" target="_top">Automator Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="ShowWhenRun.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="ImplementObjCAction.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/TP40001512-CJBJEJBE" title="Implementing an AppleScript Action"></a><hr /><H1>Implementing an AppleScript Action</H1><p><a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_350"></a><a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_351"></a><a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_352"></a><a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_353"></a>The Xcode<a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_354"></a> template for an AppleScript Action project includes an uncompiled script file named <code>main.applescript<a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_355"></a></code>. An AppleScript-based action must, at the minimum, add to <code>main.applescript</code> the scripting code that accesses the services of one or more applications and completes the stated purpose of the action. An AppleScript-based action can also rely on other components for its implementation, such as: </p><ul class="ul"><li class="li"><p>Other AppleScript script files, particularly for handling user-interface events</p></li><li class="li"><p>Objective-C classes, particularly for accessing system resources</p></li><li class="li"><p>Command-line tools or shell scripts</p></li></ul><p>Regardless of the possible implementation components, an AppleScript-based action always has a <code>main.applescript</code> file and an invisible instance of AMAppleScriptAction<a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_356"></a>. This instance owns the action bundle’s nib file, has access to <code>main.applescript</code>, and provides a default implementation of the method used to run the action behind the scenes, <code>runWithInput:fromAction:error:</code><a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_357"></a>. (AMBundleAction<a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_358"></a>, the superclass of AMAppleScriptAction, declares this method.)</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="ImplementScriptAction.html#//apple_ref/doc/uid/TP40001512-97148-CJBIADBH">The Structure of the on run Command Handler</a>
				
			<br/>
			
        
			
			
				<a href="ImplementScriptAction.html#//apple_ref/doc/uid/TP40001512-97174">Other AppleScript Scripts</a>
				
			<br/>
			
        
			
			
				<a href="ImplementScriptAction.html#//apple_ref/doc/uid/TP40001512-96897-CJBEJFAF">Hybrid Actions</a>
				
			<br/>
			
        
			
			
				<a href="ImplementScriptAction.html#//apple_ref/doc/uid/TP40001512-98354-CJBHHIEB">Updating Non-bound Parameters</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001512-97148" title="The Structure of the on run Command Handler"></a><a name="//apple_ref/doc/uid/TP40001512-97148-CJBIADBH" title="The Structure of the on run Command Handler"></a><h2>The Structure of the on run Command Handler</h2><p>The template <code>main.applscript</code> contains only the following skeletal structure of the <code>on run</code><a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_359"></a> command handler: </p><div class="codesample"><table><tr><td scope="row"><pre>on run {input, parameters}<span></span></pre></td></tr><tr><td scope="row"><pre>    -- your code goes here<span></span></pre></td></tr><tr><td scope="row"><pre>    return input<span></span></pre></td></tr><tr><td scope="row"><pre>end run<span></span></pre></td></tr></table></div><p>This <code>on run</code> command handler has two positional<a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_360"></a> parameters<a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_361"></a>, <code>input</code>, and <code>parameters</code>, The <code>input</code><a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_362"></a> parameter contains (in most instances) the output of the previous action in the workflow; it is almost always in the form of a list. The <code>parameters</code> parameter contains the settings made in the action’s user interface; the values in <code>parameters</code> (a record object) are typically set via the Cocoa bindings mechanism but can also be manually updated. The template code finally returns <code>input</code> as its output; your action should always return something as output, even if it what is given it as input. </p><p>You can use any valid AppleScript command, object, reference, expression, and statement in <code>main.applescript</code><a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_363"></a>. However, the following steps are suggested for an action’s <code>run</code> handler (not all steps are applicable to every kind of action).</p><ul class="ul"><li class="li"><p>Set local variables to the values of the current parameters. To extract the values from the <code>parameters</code><a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_364"></a> parameter, use the keys specified for bindings. For example:</p><div class="codesample"><table><tr><td scope="row"><pre>set multiple_selection to |multipleSelection| of parameters<span></span></pre></td></tr><tr><td scope="row"><pre>set prompt_message to |promptMessage| of parameters<span></span></pre></td></tr><tr><td scope="row"><pre>set default_location to |defaultLocation| of parameters<span></span></pre></td></tr></table></div><p>You use these parameters to control the logic of the script.</p></li><li class="li"><p>Set a local variable for output to an empty list. For example:</p><div class="codesample"><table><tr><td scope="row"><pre>set output to {}<span></span></pre></td></tr></table></div></li><li class="li"><p>In a <code>repeat</code> loop, perform whatever transformations are necessary on the items in the input list and add each transformed item to the output list. For example:</p><div class="codesample"><table><tr><td scope="row"><pre>repeat with i in input<span></span></pre></td></tr><tr><td scope="row"><pre>    copy (POSIX path of i) to end of filesToCopy<span></span></pre></td></tr><tr><td scope="row"><pre>end repeat<span></span></pre></td></tr></table></div></li><li class="li"><p>As the last step, return the output list.</p></li></ul><p>Some actions specify in their <code>AMAccepts</code><a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_365"></a> property that their input is optional (that is, the <code>Optional</code> subproperty is set to <code>&lt;true/></code>). This setting allows users to select a “Ignore Result From Previous Action” pop-up item in the action’s view. If your action has made input optional<a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_366"></a><a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_367"></a> in its <code>AMAccepts</code> property, you need to determine if the user has made this choice by testing the <code>ignoresInput</code><a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_368"></a> field of <code>parameters</code>; if it is set to <code>true</code>. then you do not need to do anything with the input object.</p><p>You can include subroutines<a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_369"></a> in <code>main.applescript</code> . For example, you might want to write a subroutine for returning localized strings (described in <span class="content_text"><a href="DevelopAction.html#//apple_ref/doc/uid/TP40001511-99011">“Localized Strings”</a></span>). </p><p>You can execute command-line tools<a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_370"></a> or shell scripts<a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_371"></a><a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_372"></a> for your script. The following script fragment runs the <code>screencapture</code> tool:</p><div class="codesample"><table><tr><td scope="row"><pre>set screencapture to "/usr/sbin/screencapture "<span></span></pre></td></tr><tr><td scope="row"><pre>-- here set up arguments of screencapture<span></span></pre></td></tr><tr><td scope="row"><pre>do shell script screencapture<span></span></pre></td></tr></table></div><p>A caveat about using the <code>do shell script</code><a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_373"></a> command is that, because of the threading architecture, it makes the user interface unresponsive until the shell script completes or the user presses Command-. (period).</p><p>An action’s scripts<a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_374"></a> can also invoke Objective-C methods that you have implemented in a custom class; for example, the following statement calls a class method named <code>isDVDPlayerRunning</code>:</p><div class="codesample"><table><tr><td scope="row"><pre>set dvdRunning to call method "isDVDPlayerRunning" of class "TakeScreenshot"<span></span></pre></td></tr></table></div><div class="notebox"><a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_21" title="Note"></a><p><strong>Note:</strong>&nbsp;The <code>call method</code><a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_375"></a> command is documented in <em><a href="../../../../AppleScript/Reference/StudioReference/index.html#//apple_ref/doc/uid/TP30000892" target="_top">AppleScript Studio Terminology Reference</a></em>.</p></div><p><span class="content_text"><a href="ImplementScriptAction.html#//apple_ref/doc/uid/TP40001512-96897">“Hybrid Actions”</a></span> discusses actions that contain a mix of AppleScript and Objective-C code.</p><a name="//apple_ref/doc/uid/TP40001512-97174" title="Other AppleScript Scripts"></a><h2>Other AppleScript Scripts</h2><p>An AppleScript action can contain scripts other than <code>main.applescript</code>. These additional scripts typically contain two types of handlers<a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_376"></a>: </p><ul class="ul"><li class="li"><p>AppleScript Studio-specified event handlers for managing the user interface of the action. For example, in an event handler you can modify the presentation of the user interface based on the user’s choices. </p></li><li class="li"><p>Handlers for the Automator-defined commands <code>update parameters</code><a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_377"></a> and <code>parameters updated</code><a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_378"></a>, which are attached to an action’s view. These handlers are an alternative to Cocoa bindings<a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_379"></a>: you can use them to store user settings made in the action parameters and to refresh those settings from existing parameters. For more on these handlers, see <span class="content_text"><a href="ImplementScriptAction.html#//apple_ref/doc/uid/TP40001512-98354">“Updating Non-bound Parameters.”</a></span></p></li><li class="li"><p>Handlers for the Automator-defined commands <code>activated<a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_380"></a></code> and <code>opened<a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_381"></a></code>, which are attached to an action’s view. The <code>on activated</code> handler is called when the action’s workflow is activated, and the <code>on opened</code> is called when the user adds the action to the workflow. You should use the <code>on opened</code> handler when you need to populate your action with data that takes some time to get and consequently need to display a progress indicator.</p></li></ul><p>AppleScript Studio allows you to request handlers for the <code>update parameters</code>, <code>parameters updated</code>, <code>activated</code>, and <code>opened</code> commands in the Automator Action View group in the AppleScript pane of the Interface Builder inspector.</p><p>As an example of AppleScript Studio event handlers, consider a pop-up menu for various date formats. When the user chooses a item from this pop-up menu, the action changes an example showing the effect of this format change. <span class="content_text">Listing 1</span> shows an event handler that is invoked when the user chooses a pop-up item for saving a screen capture to a “Specific File”.</p><a name="//apple_ref/doc/uid/TP40001512-99202-CJBDFDAI" title="Listing 1An event handler for displaying a Save panel"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP40001512-99202" title="Listing 1An event handler for displaying a Save panel"></a><strong>Listing 1&nbsp;&nbsp;</strong>An event handler for displaying a Save panel</p><div class="codesample"><table><tr><td scope="row"><pre>on clicked theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    if name of theObject is "choose output" then<span></span></pre></td></tr><tr><td scope="row"><pre>        -- Setup the properties in the 'save panel'<span></span></pre></td></tr><tr><td scope="row"><pre>        tell save panel<span></span></pre></td></tr><tr><td scope="row"><pre>            set title to "Choose an output file to save the screenshot to"<span></span></pre></td></tr><tr><td scope="row"><pre>            set prompt to "Save"<span></span></pre></td></tr><tr><td scope="row"><pre>            set required file type to "pdf"<span></span></pre></td></tr><tr><td scope="row"><pre>            set treat packages as directories to false<span></span></pre></td></tr><tr><td scope="row"><pre>        end tell<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        if (display save panel in directory "" with file name "") is equal to 1 then<span></span></pre></td></tr><tr><td scope="row"><pre>            set contents of text field "output file" of super view of theObject to path<span></span></pre></td></tr><tr><td scope="row"><pre>                name of save panel<span></span></pre></td></tr><tr><td scope="row"><pre>            set contents of popup button "output choice" of super view of theObject to 1<span></span></pre></td></tr><tr><td scope="row"><pre>            set enabled of button "choose output" of super view of theObject to true<span></span></pre></td></tr><tr><td scope="row"><pre>            set enabled of text field "output file" of super view of theObject to true<span></span></pre></td></tr><tr><td scope="row"><pre>        end if<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end clicked<span></span></pre></td></tr></table></div>	<a name="//apple_ref/doc/uid/TP40001512-96897" title="Hybrid Actions"></a><a name="//apple_ref/doc/uid/TP40001512-96897-CJBEJFAF" title="Hybrid Actions"></a><h2>Hybrid Actions</h2><p>An action<a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_382"></a><a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_383"></a> implementation can contain a mix of AppleScript and Objective-C code. Usually such hybrid actions are AppleScript-based—in other words, they have a <code>main.applescript</code> file containing the <code>run</code> command handler. However, it is possible to have Objective-C actions that use the Cocoa scripting classes to load (or create) and execute scripts. See <span class="content_text"><a href="ImplementObjCAction.html#//apple_ref/doc/uid/TP40001513-BCICCECC">“Implementing an Objective-C Action”</a></span> for a discussion of the latter type of hybrid action.</p><p>Why would you want to create a hybrid action? One reason is to have greater control of the user interface. An Objective-C class that links with the Application Kit has access to the full range of programmatic resources for managing the appearance and behavior of user-interface objects. </p><p>But perhaps the most common reason for hybrid actions is to get access to system resources that a script could not get on its own. Scripts can call Objective-C instance methods with the <code>call method</code> command, but only if the target object is something that the script can address (for example, <code>call method "title" of window 1</code>). Sometimes, an AppleScript Studio script does not have access to a valid object for a <code>call method</code> command. To get around this limitation, you can create a simple custom class that implements one or more class methods. The first argument of these methods is the target (receiver) of an instance method that the class method wraps. <span class="content_text">Listing 2</span> illustrates this approach.</p><a name="//apple_ref/doc/uid/TP40001512-99478-CJBBFJFC" title="Listing 2Implementing a custom Objective-C method to be called by a script"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP40001512-99478" title="Listing 2Implementing a custom Objective-C method to be called by a script"></a><strong>Listing 2&nbsp;&nbsp;</strong>Implementing a custom Objective-C method to be called by a script</p><div class="codesample"><table><tr><td scope="row"><pre>#import "CreatePackageAction.h"<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>@implementation CreatePackageAction<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>+ (BOOL)writeDictionary:(NSDictionary *)dictionary withName:(NSString *)name<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    return [dictionary writeToFile:name atomically:YES];<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>@end<span></span></pre></td></tr></table></div><p>In a script you can then use a <code>call method "</code><em>m</em><code>" of class "</code><em>c</em><code>" with parameters</code><strong>{ </strong><em>y</em><code>,</code><em>z</em><code>}</code> statement to call this method (<span class="content_text">Listing 3</span>).</p><a name="//apple_ref/doc/uid/TP40001512-99548-CJBBECCE" title="Listing 3A script calling the Objective-C method"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP40001512-99548" title="Listing 3A script calling the Objective-C method"></a><strong>Listing 3&nbsp;&nbsp;</strong>A script calling the Objective-C method</p><div class="codesample"><table><tr><td scope="row"><pre>set descriptionRecord to<span></span></pre></td></tr><tr><td scope="row"><pre>        {|IFPkgDescriptionTitle|:packageTitle,|IFPkgDescriptionVersion|:packageVersion,<span></span></pre></td></tr><tr><td scope="row"><pre>        |IFPkgDescriptionDescription|:description,<span></span></pre></td></tr><tr><td scope="row"><pre>        |IFPkgDescriptionDeleteWarning|:deleteWarning}<span></span></pre></td></tr><tr><td scope="row"><pre>set rootName to call method "lastPathComponent" of rootFilePath<span></span></pre></td></tr><tr><td scope="row"><pre>set descriptionFilePath to temporaryItemsPath &amp; rootName &amp; "description.plist"<span></span></pre></td></tr><tr><td scope="row"><pre>call method "writeDictionary:withName:" of class "CreatePackageAction" with parameters<span></span></pre></td></tr><tr><td scope="row"><pre>     {descriptionRecord, descriptionFilePath}<span></span></pre></td></tr></table></div>	<a name="//apple_ref/doc/uid/TP40001512-98354" title="Updating Non-bound Parameters"></a><a name="//apple_ref/doc/uid/TP40001512-98354-CJBHHIEB" title="Updating Non-bound Parameters"></a><h2>Updating Non-bound Parameters</h2><p>A property of all actions, including AppleScript-based ones, is a record (equivalent in Objective-C to a dictionary) containing values reflecting the settings users have made in the action’s user interface. When Automator runs an AppleScript action by calling its <code>run</code> command handler, it passes in these values in the <code>parameters</code> parameter. Most actions use the Cocoa bindings mechanism to set the parameters property. However, you may choose to forgo bindings in favor of more direct approach.</p><p>The Automator application defines several commands for AppleScript Studio. Among these are <code>update parameters</code> and <code>parameters updated</code>, which can be attached to an action’s view. The <code>update parameters</code> command is sent when the an action’s parameters record need to be refreshed from the values on the user interface. The <code>parameters updated</code> command is sent when the parameters record changes any of its values.</p><p>To specify handlers for these commands in Interface Builder, follow the usual AppleScript Studio procedure:</p><ol class="ol"><li class="li"><p>Select the action’s view.</p></li><li class="li"><p>In the AppleScript pane of the Info window, expose the commands under Automator Action View (see <span class="content_text">Figure 1</span>). </p></li><li class="li"><p>Click the check boxes for <code>update parameters</code> and <code>parameters updated</code>.</p></li><li class="li"><p>Specify a script file for the command handlers.</p></li></ol><br/><div><a name="//apple_ref/doc/uid/TP40001512-98675-CJBBEFCG" title="Figure 1Selecting the parameters-related handlers for action views"></a><p><a name="//apple_ref/doc/uid/TP40001512-98675" title="Figure 1Selecting the parameters-related handlers for action views"></a><strong>Figure 1&nbsp;&nbsp;</strong>Selecting the parameters-related handlers for action views</p><img src = "Art/as_update_parameters.gif" alt = "Selecting the parameters-related handlers for action views" width="307" height="483"></div><br/><p>Automator calls the handler for <code>update parameters</code> just before it runs the action. In this handler, the action should get the settings from the user interface and update the parameters record with them. <span class="content_text">Listing 4</span> provides an example of an <code>update parameters</code> handler.</p><a name="//apple_ref/doc/uid/TP40001512-98840-CJBIDIIE" title="Listing 4An &acirc;&#128;&#156;update parameters&acirc;&#128;&#157; command handler"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP40001512-98840" title="Listing 4An &acirc;&#128;&#156;update parameters&acirc;&#128;&#157; command handler"></a><strong>Listing 4&nbsp;&nbsp;</strong>An “update parameters” command handler</p><div class="codesample"><table><tr><td scope="row"><pre>on update parameters theObject parameters theParameters<span></span></pre></td></tr><tr><td scope="row"><pre>    set |destinationPath| of theParameters to (the content of text field "folder path" of the destination_folder_box) as string<span></span></pre></td></tr><tr><td scope="row"><pre>    set |textInput| of theParameters to (the content of text field "text input" of the text_source_box) as string<span></span></pre></td></tr><tr><td scope="row"><pre>    set |fileName| of theParameters to (the content of text field "file name" of the file_name_box) as string<span></span></pre></td></tr><tr><td scope="row"><pre>    set |chosenVoice| of theParameters to the title of popup button "voice popup" of voice_box<span></span></pre></td></tr><tr><td scope="row"><pre>    set |textSource| of theParameters to ((the current row of matrix "source matrix" of the text_source_box) as integer) - 1<span></span></pre></td></tr><tr><td scope="row"><pre>    return theParameters<span></span></pre></td></tr><tr><td scope="row"><pre>end update parameters<span></span></pre></td></tr></table></div>	<p>Always return the updated parameters object as the final step in this handler (<code>theParameters</code> in the above example).<a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_384"></a><a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_385"></a><a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_386"></a><a name="//apple_ref/doc/uid/TP40001512-DontLinkElementID_387"></a></p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="ShowWhenRun.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="ImplementObjCAction.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2004, 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-12-11<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleApplications/Conceptual/AutomatorConcepts/Articles/ImplementScriptAction.html%3Fid%3DTP40001450-3.5&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleApplications/Conceptual/AutomatorConcepts/Articles/ImplementScriptAction.html%3Fid%3DTP40001450-3.5&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleApplications/Conceptual/AutomatorConcepts/Articles/ImplementScriptAction.html%3Fid%3DTP40001450-3.5&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
