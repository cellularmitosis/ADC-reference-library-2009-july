<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Writing Object Accessor Functions(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING242></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-241.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-243.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-231.html"><B>Chapter 6 - Resolving and Creating Object Specifier Records</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING242-0></A>
<H1><A NAME=MARKER-9-157></A>Writing Object Accessor Functions</H1>
 <A NAME=MARKER-2-158></A>If the direct parameter for an Apple event consists of an object specifier record, your handler for the event should call the <CODE>AEResolve</CODE> function to resolve the object specifier record: that is, to find the Apple event objects or properties it describe. The <CODE>AEResolve</CODE> function resolves object specifier records with the help of object accessor functions provided by your application. For an overview of the way <CODE>AEResolve</CODE> works with your application's object accessor functions to locate Apple event objects, see <A HREF=IAC-232.html#MARKER-9-76>"Resolving Object Specifier Records,"</A> which begins on <A HREF=IAC-232.html#MARKER-9-76>page 6-4</A>. <A NAME=MARKER-2-159></A><P>
 This section describes how to write object accessor functions. You need to read this section if your application supports the Core suite or any of the functional-area suites in the <I>Apple Event Registry: Standard Suites.</I><P>
 Your application should provide object accessor functions that can find Apple event objects and their properties for all object classes supported by your application, including their corresponding properties and element classes. Because the Apple Event Manager dispatches object accessor functions according to the class ID of the requested Apple event object and the descriptor type of the token that identifies its container, you have a great deal of flexibility in deciding what object accessor functions you need to write for your application. The installation and dispatching of object accessor functions are described in <A HREF=IAC-239.html#MARKER-9-132>"Installing Entries in the Object Accessor Dispatch Tables,"</A> which begins on <A HREF=IAC-239.html#MARKER-9-132>page 6-27</A>.<P>
 <A NAME=MARKER-21-310></A>For example, if your application is a word processor, one object accessor function will probably work equally well for Apple event objects of object classes <CODE>cParagraph</CODE>, <CODE>cItem</CODE>, and <CODE>cWord</CODE> located in containers identified by tokens of descriptor type <CODE>myTextToken</CODE>. If you use a single descriptor type for tokens that identify any containers in which objects of these three object classes can be found, you can dispatch requests for all such elements to the same object accessor function. However, the same word processor might use one descriptor type for tokens identifying containers of class <CODE>cCell</CODE> and another descriptor type for tokens identifying containers of class <CODE>cColumn</CODE>--in which case it would need an object accessor function for each descriptor type.<P>
 For each object class that your application supports, your application should also provide one object accessor function that can find all the properties of that object class, or one object accessor function that can find all the properties of several object classes.<P>
 Here's the declaration for a sample object accessor function:<P>
<PRE>
FUNCTION MyObjectAccessor (desiredClass: DescType; 
                           containerToken: AEDesc; 
                           containerClass: DescType;
                           keyForm: DescType; keyData: AEDesc;
                           VAR theToken: AEDesc; 
                           theRefCon: LongInt): OSErr;
</PRE>
 The <CODE>AEResolve</CODE> function passes the following information to your object accessor function: the object class ID of the requested Apple event objects, the object class of their container, a token that identifies the specific container in which to look for them, the key form and key data that specify how to locate them, and the reference constant associated with the object accessor function. Your object accessor function uses this information to locate the requested objects. <P>
 Most applications that resolve object specifier records need to support only the key forms <CODE>formPropertyID</CODE>, <CODE>formName</CODE>, <CODE>formUnique</CODE>ID, <CODE>formAbsolutePosition</CODE>, <CODE>formRelativePosition</CODE>, and <CODE>formRange</CODE> explicitly. You do not need to support these key forms for all object classes; for example, words usually do not have names, so most applications should return <CODE>errAEEventNotHandled</CODE> if they receive a request for a word by name. <P>
 If your application provides an object-counting function and an object-comparison function in addition to the appropriate object accessor functions, the Apple Event Manager can handle <CODE>formTest</CODE> automatically.<P>
 The Apple Event Manager uses the key form <CODE>formWhose</CODE> internally to optimize resolution of object specifier records that specify <CODE>formTest</CODE>. Only applications that translate tests into their own query languages need to support <CODE>formWhose</CODE> explicitly. <A HREF=IAC-246.html#MARKER-9-186>"Handling Whose Tests,"</A> which begins on <A HREF=IAC-246.html#MARKER-9-186>page 6-47</A>, describes <CODE>formWhose</CODE> in detail.<P>
 If your object accessor function successfully locates the requested Apple event objects, your application should return the <CODE>noErr</CODE> result code and a token that identifies them. The token can be of any descriptor type, as long as it is a descriptor record. For example, to identify a file, your application might use a descriptor record of descriptor type <CODE>typeAlias</CODE> or <CODE>typeFSS</CODE>. To identify an open document, your application might define its own descriptor type, such as <CODE>typeMyDocToken</CODE>, for a descriptor record whose data handle refers to a pointer to a document record. For more information about tokens, see <A HREF=IAC-245.html#MARKER-9-178>"Defining Tokens" on page 6-45</A>.<A NAME=MARKER-2-161></A> <P>
<DL>
<DT><B>IMPORTANT</B>
<DD>Object accessor functions must not have side effects that change the number or order of elements in a container while an object specifier record is being resolved. If the number of elements in a container is changed during the resolution of an object specifier record, the Apple Event Manager may not be able to locate all the elements.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
<HR>
<B>Subtopics</B>
<B><!-- TOC --><DL>
<DL>
<DT><A HREF="IAC-243.html#HEADING243-0">Writing Object Accessor Functions That Find Apple Event Objects</A>
<DD>
<DT><A HREF="IAC-244.html#HEADING244-0">Writing Object Accessor Functions That Find Properties</A>
<DD>
<DT><A HREF="IAC-245.html#HEADING245-0">Defining Tokens</A>
<DD>
<DT><A HREF="IAC-246.html#HEADING246-0">Handling Whose Tests</A>
<DD>
</DL>
</DL>
</B>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-241.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-243.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
