<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>

	<!-- BEGIN META TAG INFO -->
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<link rel="home" href="http://developer.apple.com/">
	<link rel="find" href="http://developer.apple.com/search/">
	<link rel="stylesheet" type="text/css" href="../../documentation/css/adcstyle.css" title="fonts">
	<script language="JavaScript" src="../../documentation/js/adc.js" type="text/javascript"></script>
	<!-- END META TAG INFO -->
	
	<!-- BEGIN TITLE -->
	<title>QTSetMovieAudioDevice - /EnumDevices.cpp</title>
	<!-- END TITLE -->
<script language="JavaScript">
function JumpToNewPage() {
	window.location=document.scpopupmenu.gotop.value;
	return true;
}
</script>

</head>

<!-- BEGIN BODY OPEN -->
<body>
<!--END BODY OPEN -->

<!-- START CENTER OPEN -->
<center>
<!-- END CENTER OPEN -->

	<!-- BEGIN LOGO AND SEARCH -->
	<!--#include virtual="/includes/adcnavbar"-->
	<!-- END LOGO AND SEARCH -->
		
		
	<!-- START BREADCRUMB -->
	<div id="breadcrumb">
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td scope="row"><img width="340" height="10" src="images/1dot.gif" alt=""></td>
			<td><img width="340" height="10" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr valign="middle">
			<td align="left" colspan="2">
			<a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../samplecode/index.html">Sample Code</a> &gt; <a href="../../samplecode/QuickTime/index.html">QuickTime</a> &gt; <a href="../../samplecode/QuickTime/idxQuickTimeforWindows-date.html">QuickTime for Windows</a> &gt; <A HREF="javascript:location.replace('index.html');">QTSetMovieAudioDevice</A> &gt; 
			</td>
		</tr>
		<tr>
			<td colspan="2" scope="row"><img width="680" height="35" src="images/1dot.gif" alt=""></td>
		</tr>
	</table>
	</div>
	<!-- END BREADCRUMB -->


	<!-- START MAIN CONTENT -->
	
	<!-- START TITLE GRAPHIC AND INTRO-->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td><h1><div id="pagehead">QTSetMovieAudioDevice</div></h1></td>
		</tr>
	</table>
	<!-- END TITLE GRAPHIC AND INTRO -->
	<!-- START WIDE COLUMN -->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td id="scdetails">
				<h2>/EnumDevices.cpp</h2>
				<form name="scpopupmenu" onSubmit="return false;" method=post>
				<p><strong>View Source Code:</strong> 
					<select name="gotop" onChange="JumpToNewPage();" style="width:340px"><option selected value="ingnore">Select File</option>
<option value="listing1.html">/EnumDevices.cpp</option>
<option value="listing2.html">/EnumDevices.h</option>
<option value="listing3.html">/QTCode.cpp</option>
<option value="listing4.html">/QTCode.h</option>
<option value="listing5.html">/ReadMe.txt</option>
<option value="listing6.html">/resource.h</option></select>
				</p>
				</form>
				<p><strong><a href="QTSetMovieAudioDevice.zip">Download Sample</a></strong> (&#147;QTSetMovieAudioDevice.zip&#148;, 39.8K)<BR>
<strong><a href="QTSetMovieAudioDevice.dmg">Download Sample</a></strong> (&#147;QTSetMovieAudioDevice.dmg&#148;, 96.2K)</p>
				<!--
				<p><strong><a href="#">Download Sample</a></strong> (&#147;filename.sit&#148;, 500K)</p>
				-->
			</td>
		</tr>
		<tr>
			<td scope="row"><img width="680" height="10" src="images/1dot.gif" alt=""><br>
			<img height="1" width="680" src="images/1dot_919699.gif" alt=""><br>
			<img width="680" height="20" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr>
			<td scope="row">
	<!--googleon: index -->
<pre class="sourcecodebox">/*
*  File:    EnumDevices.cpp
* 
*  Contains:  Main Program. Displays a window which shows an enumeration of all Windows
*             DirectSound output devices. Buttons then allow user to choose an output device, 
*             and play a movie through the selected output device.
*  
*  Version:  1.0
* 
*  Created:  2/15/06
*
*  Disclaimer:  IMPORTANT:  This Apple software is supplied to you by Apple Computer, Inc.
*        (&quot;Apple&quot;) in consideration of your agreement to the following terms, and your
*        use, installation, modification or redistribution of this Apple software
*        constitutes acceptance of these terms.  If you do not agree with these terms,
*        please do not use, install, modify or redistribute this Apple software.
*
*        In consideration of your agreement to abide by the following terms, and subject
*        to these terms, Apple grants you a personal, non-exclusive license, under Apple's
*        copyrights in this original Apple software (the &quot;Apple Software&quot;), to use,
*        reproduce, modify and redistribute the Apple Software, with or without
*        modifications, in source and/or binary forms; provided that if you redistribute
*        the Apple Software in its entirety and without modifications, you must retain
*        this notice and the following text and disclaimers in all such redistributions of
*        the Apple Software.  Neither the name, trademarks, service marks or logos of
*        Apple Computer, Inc. may be used to endorse or promote products derived from the
*        Apple Software without specific prior written permission from Apple.  Except as
*        expressly stated in this notice, no other rights or licenses, express or implied,
*        are granted by Apple herein, including but not limited to any patent rights that
*        may be infringed by your derivative works or by other works in which the Apple
*        Software may be incorporated.
*
*        The Apple Software is provided by Apple on an &quot;AS IS&quot; basis.  APPLE MAKES NO
*        WARRANTIES, EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION THE IMPLIED
*        WARRANTIES OF NON-INFRINGEMENT, MERCHANTABILITY AND FITNESS FOR A PARTICULAR
*        PURPOSE, REGARDING THE APPLE SOFTWARE OR ITS USE AND OPERATION ALONE OR IN
*        COMBINATION WITH YOUR PRODUCTS.
*
*        IN NO EVENT SHALL APPLE BE LIABLE FOR ANY SPECIAL, INDIRECT, INCIDENTAL OR
*        CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
*        GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
*        ARISING IN ANY WAY OUT OF THE USE, REPRODUCTION, MODIFICATION AND/OR DISTRIBUTION
*        OF THE APPLE SOFTWARE, HOWEVER CAUSED AND WHETHER UNDER THEORY OF CONTRACT, TORT
*        (INCLUDING NEGLIGENCE), STRICT LIABILITY OR OTHERWISE, EVEN IF APPLE HAS BEEN
*        ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*
*  Copyright:  Copyright &copy; 2006 Apple Computer, Inc, All Rights Reserved
*/

#include &quot;EnumDevices.h&quot;
#include &quot;QTCode.h&quot;

//-----------------------------------------------------------------------------
// Function-prototypes
//-----------------------------------------------------------------------------

INT_PTR CALLBACK MainDialogProc( HWND hDlg, UINT msg, WPARAM wParam, LPARAM lParam );
HRESULT OnInitDialog( HWND hDlg );

INT_PTR CALLBACK DSoundEnumCallback( GUID* pGUID, TCHAR* strDesc, TCHAR* strDrvName,
                                  VOID* pContext );
HRESULT InitDirectSound( HWND hDlg );
HRESULT FreeDirectSound();

void CopySelectedSoundDeviceName( HWND hDlg,  TCHAR *outCurrentSoundDeviceName);
void CopySelectedSoundDeviceGUID( HWND hDlg,  GUID* outCurrentSoundGUID);

BOOL GetFile (TCHAR *theFileName);

#define SAFE_DELETE(p)  { if(p) { delete (p);     (p)=NULL; } }
#define SAFE_RELEASE(p) { if(p) { (p)-&gt;Release(); (p)=NULL; } }

//-----------------------------------------------------------------------------
// Global data
//-----------------------------------------------------------------------------

LPDIRECTSOUND      g_pDS              = NULL;
Movie          g_Movie              = NULL;
QTAudioContextRef    g_QTAudioContextForDevice    = NULL;
boolean          g_QT704Installed        = false;
static TCHAR      g_MovieFileNamePath[MAX_PATH]  = TEXT(&quot;&quot;);
static TCHAR      g_MovieFileName[MAX_PATH]    = TEXT(&quot;&quot;);
ComponentInstance    g_MovieController        = NULL;

//-----------------------------------------------------------------------------
// Name: WinMain()
// Desc: Entry point for the application.  Since we use a simple dialog for 
//       user interaction we don't need to pump messages.
//-----------------------------------------------------------------------------

INT APIENTRY WinMain( HINSTANCE hInst, HINSTANCE hPrevInst, LPSTR pCmdLine, 
                      INT nCmdShow )
{
    // Initialize COM
    CoInitialize( NULL );

  // Initialize QuickTime
  InitializeQTML(0);
  require(EnterMovies() == noErr, FAILQTINIT);

  g_QT704Installed = QT_QT704OrBetterInstalled();
  g_Movie = NULL;

    // Display the main dialog box.
    DialogBox( hInst, MAKEINTRESOURCE(IDD_MAIN), NULL, MainDialogProc );

FAILQTINIT:

    // Release COM
    CoUninitialize();

    return TRUE;
}

//-----------------------------------------------------------------------------
// Name: MainDialogProc()
// Desc: Handles dialog messages
//-----------------------------------------------------------------------------

INT_PTR CALLBACK MainDialogProc( HWND hDlg, UINT msg, WPARAM wParam, LPARAM lParam )
{
    HRESULT hr; 
  static CFStringRef movieFilePathRef = NULL;
  static HANDLE movieFileHandle = NULL;

  // give the movie controller this message first
  if (g_MovieController) 
  {
    MSG        myMsg = {0};
    EventRecord    myMacEvent;
    LONG      myPoints = GetMessagePos();

    myMsg.hwnd = hDlg;
    myMsg.message = msg;
    myMsg.wParam = wParam;
    myMsg.lParam = lParam;
    myMsg.time = GetMessageTime();
    myMsg.pt.x = LOWORD(myPoints);
    myMsg.pt.y = HIWORD(myPoints);

    // translate a Windows event to a Mac event
    WinEventToMacEvent(&amp;myMsg, &amp;myMacEvent);

    // pass the Mac event to the movie controller, but only if the movie window isn't minimized
    if (!IsIconic(hDlg))
    {
      MCIsPlayerEvent(g_MovieController, (EventRecord *)&amp;myMacEvent);
    }
  }

    switch( msg ) 
    {
    case WM_NOTIFY:
      break;

    case WM_CREATE:
      break;

    case WM_NULL:

      // we receive this message only to idle the movie
      if (g_MovieController)
      {
        MCIdle(g_MovieController);
      }
      break;

        case WM_COMMAND:

            switch( LOWORD(wParam) )
            {
                case IDC_CREATE:

                    // Init DirectSound
                    if( SUCCEEDED( hr = InitDirectSound( hDlg ) ) )
                    {
                        MessageBox( hDlg, TEXT(&quot;DirectSound interface created successfully&quot;), 
                                          TEXT(&quot;EnumDevices&quot;), MB_OK );
                    }
                    else
                    {
                        DXTRACE_ERR_MSGBOX( TEXT(&quot;InitDirectSound&quot;), hr );
                        MessageBox( hDlg, TEXT(&quot;DirectSound interface creatation failed&quot;), 
                                          TEXT(&quot;EnumDevices&quot;), MB_OK | MB_ICONERROR );
                    }

                    break;

        case IDC_SETMOVIE:
          {
            // get a movie file from the user

            TCHAR newMovieFileNamePath[MAX_PATH] = TEXT(&quot;&quot;);
            BOOL gotAFile = GetFile((TCHAR *)&amp;newMovieFileNamePath);
            if (gotAFile)
            {
              // if we got a new file, suspend any currently playing movie

              if( g_MovieController )
              {
                MCDoAction(g_MovieController, mcActionSuspend, (void *)NULL);
        
                // dispose of the existing movie controller and movie resource
                DisposeMovieController(g_MovieController);
                DisposeMovie(g_Movie);
              }

              // copy movie path
              StringCchCopy( g_MovieFileNamePath, MAX_PATH, newMovieFileNamePath );
              WCHAR* strLastSlash = wcsrchr( g_MovieFileNamePath, '\\' );
              // copy movie file name
              StringCchCopy( g_MovieFileName, MAX_PATH, strLastSlash + 1 );

              // create a new movie using the movie file path
              movieFilePathRef = CFStringCreateWithCharacters(kCFAllocatorDefault, 
                                  g_MovieFileNamePath, 
                                  MAX_PATH);
              require(movieFilePathRef != NULL, bail);
              OSStatus status = QT_CreateMovieWithProperties(movieFilePathRef, NULL, &amp;g_Movie);

              // show the movie name in the dialog box
              SetDlgItemText( hDlg, IDC_MOVIENAME, g_MovieFileName );

              // create a new movie controller for the movie
              Rect movieRect;
              GetMovieBox(g_Movie, &amp;movieRect);
              g_MovieController = NewMovieController(g_Movie, &amp;movieRect, mcNotVisible);
              
            bail:
            ;
            }
          }
          break;

          // play button
        case IDC_BUTTON2:
          {
            if (g_Movie)
            {
              // First create a QuickTime Audio Context from either:
              //
              //  - GUID  (QT 7.0.4 or better only)
              //  - Device Name

              if (g_QT704Installed )
              {
                // Use GUID

                GUID currentSoundDeviceGUID;

                CopySelectedSoundDeviceGUID( hDlg,  &amp;currentSoundDeviceGUID);

                // Create audio context from GUID
                OSStatus status = QT_CreateAudioContextFromGUID(&amp;currentSoundDeviceGUID, &amp;g_QTAudioContextForDevice);
              }
              else
              {
                // Use Device Name

                TCHAR currDeviceName[MAX_PATH];
                CopySelectedSoundDeviceName( hDlg, (TCHAR *)&amp;currDeviceName);

                // Create audio context from Device Name
                OSStatus status = QT_CreateAudioContextFromDeviceName((TCHAR *)&amp;currDeviceName, &amp;g_QTAudioContextForDevice);
              }

              // Set the QuickTime Audio Context for the current movie
              OSStatus status = SetMovieAudioContext(g_Movie, g_QTAudioContextForDevice);

              // Make a time record for the beginning of the movie
              TimeRecord currentTime;
              GetMovieTime(g_Movie, &amp;currentTime);
              currentTime.value.hi = 0; currentTime.value.lo = 0;

              // Set movie back to the beginning and play!
              MCDoAction(g_MovieController, mcActionGoToTime, (void *)&amp;currentTime);
              MCDoAction(g_MovieController, mcActionPrerollAndPlay, (void *)GetMoviePreferredRate(g_Movie));
            }
          }
          break;

        case IDC_SOUND_DEVICE_COMBO:
          if (HIWORD(wParam) == CBN_SELCHANGE)
          {
            printf(&quot;CBN_SELCHANGE\n&quot;);
          }
          break;

                case IDCANCEL:
                    EndDialog( hDlg, IDCANCEL );
                    break;

                default:
                    return FALSE; // Didn't handle message
            }
            break;


        case WM_INITDIALOG:
            if( FAILED( hr = OnInitDialog( hDlg ) ) )
            {
                DXTRACE_ERR_MSGBOX( TEXT(&quot;OnInitDialog&quot;), hr );
                MessageBox( hDlg, L&quot;Error enumerating DirectSound devices. &quot;
                                  L&quot;Sample will now exit.&quot;, L&quot;DirectSound Sample&quot;, 
                                  MB_OK | MB_ICONERROR );
                EndDialog( hDlg, IDABORT );
            }

      // Associate a GrafPort with the native window
      CreatePortAssociation(hDlg, NULL, 0L);

            break;

        case WM_DESTROY:
      {
              // Cleanup everything

        // Release DirectSound object
        FreeDirectSound();

        // Remove GrafPort association for native window
        DestroyPortAssociation((CGrafPtr)GetNativeWindowPort(hDlg));
      }
            break; 

        default:
            return FALSE; // Didn't handle message
    }

    return TRUE; // Handled message
}

//-----------------------------------------------------------------------------
// Name: OnInitDialog()
// Desc: Initializes the dialogs (sets up UI controls, etc.)
//-----------------------------------------------------------------------------

HRESULT OnInitDialog( HWND hDlg )
{
    HRESULT hr;

    // Enumerate the sound devices and place them in the combo box
    HWND hSoundDeviceCombo = GetDlgItem( hDlg, IDC_SOUND_DEVICE_COMBO );
    if( FAILED( hr = DirectSoundEnumerate( (LPDSENUMCALLBACK)DSoundEnumCallback,
                                           (VOID*)hSoundDeviceCombo ) ) )
        return DXTRACE_ERR_MSGBOX( TEXT(&quot;DirectSoundEnumerate&quot;), hr );

    // Select the first device in the combo box
    SendMessage( hSoundDeviceCombo,   CB_SETCURSEL, 0, 0 );

    return S_OK;
}

//-----------------------------------------------------------------------------
// Name: DSoundEnumCallback()
// Desc: Enumeration callback called by DirectSoundEnumerate
//-----------------------------------------------------------------------------

INT_PTR CALLBACK DSoundEnumCallback( GUID* pGUID, TCHAR* strDesc, TCHAR* strDrvName,
                                  VOID* pContext )
{
    static DWORD dwAudioDriverIndex = 0;
  static WORD guidArrayIndex = 0;

  // Note:   The first device enumerated is always called the 
  // Primary Sound Driver, and the lpGUID parameter of the 
  // callback is NULL. This device represents the preferred 
  // playback device set by the user in Control Panel. It is 
  // enumerated separately to make it easy for the application 
  // to add &quot;Primary Sound Driver&quot; to a list when presenting 
  // the user with a choice of devices. The primary device is 
  // also enumerated with its proper name and GUID.

  // For purposes of this example we will ignore Primary Sound
  // Driver, and only add the primary device when it is enumerated
  // with its proper name and GUID.
  if (!pGUID)
    return TRUE;

  size_t strDescLen = _tcslen(strDesc) * sizeof(TCHAR);

  dwAudioDriverIndex += strDescLen;

  // Now add driver name string to our popup control

    HWND hSoundDeviceCombo = (HWND)pContext;

    // Add the string to the combo box
    LRESULT result = SendMessage( hSoundDeviceCombo, CB_ADDSTRING, 
                 0, (LPARAM) (LPCTSTR) strDesc );

    // Get the index of the string in the combo box
    INT nIndex = (INT)SendMessage( hSoundDeviceCombo, CB_FINDSTRING, 
                                   0, (LPARAM) (LPCTSTR) strDesc );

  // Save the GUID
  if (g_QT704Installed)
  {
    SendMessage( hSoundDeviceCombo, CB_SETITEMDATA, 
          nIndex, (LPARAM) pGUID );

    ++guidArrayIndex;
  }

    return TRUE;
}

//-----------------------------------------------------------------------------
// Name: InitDirectSound()
// Desc: Initilizes DirectSound
//-----------------------------------------------------------------------------
HRESULT InitDirectSound( HWND hDlg )
{
    HRESULT hr;

    // Free any previous DirectSound objects
    FreeDirectSound();

    // Get the HWNDs the combo boxes
    HWND hSoundDeviceCombo   = GetDlgItem( hDlg, IDC_SOUND_DEVICE_COMBO );

    // Get the index of the currently selected devices
    INT nSoundIndex   = (INT)SendMessage( hSoundDeviceCombo,   CB_GETCURSEL, 0, 0 ); 

    // Get the GUID attached to the combo box item
    GUID* pSoundGUID = (GUID*) SendMessage( hSoundDeviceCombo, CB_GETITEMDATA, 
                                            nSoundIndex, 0 );

    // Create IDirectSound using the select sound device
    if( FAILED( hr = DirectSoundCreate( pSoundGUID, &amp;g_pDS, NULL ) ) )
        return DXTRACE_ERR_MSGBOX( TEXT(&quot;DirectSoundCreate&quot;), hr );

    // Release the IDirectSound object immediately since we don't want
    // to limit this sample to only computers that support full duplex audio
    SAFE_RELEASE( g_pDS ); 

  return S_OK;
}


//-----------------------------------------------------------------------------
// Name: FreeDirectSound()
// Desc: Releases DirectSound 
//-----------------------------------------------------------------------------
HRESULT FreeDirectSound()
{
    // Release DirectSound interfaces
    SAFE_RELEASE( g_pDS ); 

    return S_OK;
}

//-----------------------------------------------------------------------------
// Name: CopySelectedSoundDeviceGUID()
// Desc: Makes a copy of the currently selected sound device GUID
//-----------------------------------------------------------------------------
void CopySelectedSoundDeviceGUID( HWND hDlg,  GUID *outCurrentSoundGUID)
{
    // Get the HWNDs the combo boxes
    HWND hSoundDeviceCombo   = GetDlgItem( hDlg, IDC_SOUND_DEVICE_COMBO );

    // Get the index of the currently selected devices
    INT nSoundIndex   = (INT)SendMessage( hSoundDeviceCombo, CB_GETCURSEL, 0, 0 ); 

  GUID *pGUID = NULL;

  // Get the GUID attached to the combo box item
    pGUID = (GUID*) SendMessage( hSoundDeviceCombo, CB_GETITEMDATA, 
                                            nSoundIndex, 0 );
  if (pGUID)
  {
    memcpy(outCurrentSoundGUID, pGUID, sizeof(GUID));
  }

}

//-----------------------------------------------------------------------------
// Name: CopySelectedSoundDeviceName()
// Desc: Makes a copy of the currently selected sound device name
//-----------------------------------------------------------------------------
void CopySelectedSoundDeviceName( HWND hDlg,  TCHAR *outCurrentSoundDeviceName)
{
    // Get the HWNDs the combo boxes
    HWND hSoundDeviceCombo   = GetDlgItem( hDlg, IDC_SOUND_DEVICE_COMBO );

    // Get the index of the currently selected devices
    INT nSoundIndex   = (INT)SendMessage( hSoundDeviceCombo, CB_GETCURSEL, 0, 0 ); 

  // Get the Device Name attached to the combo box item
    LRESULT strLength = SendMessage( hSoundDeviceCombo, CB_GETLBTEXT, 
                                     nSoundIndex, (LPARAM)outCurrentSoundDeviceName );
}

//-----------------------------------------------------------------------------
// Name: GetFile()
// Desc: Show the open file dialog and allow the user to select a file
//-----------------------------------------------------------------------------
BOOL GetFile (TCHAR *theFileName)
{
    static TCHAR strPath[MAX_PATH] = TEXT(&quot;&quot;);

    // Setup the OPENFILENAME structure
    OPENFILENAME ofn = { sizeof(OPENFILENAME), NULL, NULL,
                         TEXT(&quot;Movie Files\0*.mov\0All Files\0*.*\0\0&quot;), NULL,
                         0, 1, theFileName, MAX_PATH, NULL, 0, strPath,
                         TEXT(&quot;Open a movie file&quot;),
                         OFN_FILEMUSTEXIST|OFN_HIDEREADONLY, 0, 0,
                         TEXT(&quot;.mov&quot;), 0, NULL, NULL };

    // Get the default media path (something like C:\WINDOWS\MEDIA)
    if( '\0' == strPath[0] )
    {
        if( GetWindowsDirectory( strPath, MAX_PATH ) != 0 )
        {
            StringCchCat( strPath, MAX_PATH, TEXT(&quot;\\MEDIA&quot;) );
        }
    }

     // Display the OpenFileName dialog. Then, try to load the specified file
    return (GetOpenFileName( &amp;ofn ) );
}</pre>
	<!--googleoff: index -->
			</td>
		</tr>
	</table>
	<!-- END WIDE COLUMN -->

	<!-- END MAIN CONTENT -->
		<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/samplecode/QTSetMovieAudioDevice/listing1.html%3Fid%3DDTS10003897-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/samplecode/QTSetMovieAudioDevice/listing1.html%3Fid%3DDTS10003897-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/samplecode/QTSetMovieAudioDevice/listing1.html%3Fid%3DDTS10003897-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

	<!-- START BOTTOM APPLE NAVIGATION -->
	<!--#include virtual="/includes/footer"-->
	<!-- END BOTTOM APPLE NAVIGATION -->

<!-- START CENTER CLOSE -->
</center>
<!-- END CENTER CLOSE -->

</body>
</html>