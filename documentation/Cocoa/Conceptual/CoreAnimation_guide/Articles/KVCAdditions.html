<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Core Animation Programming Guide: Core Animation Extensions To Key-Value Coding</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Core Animation Extensions To Key-Value Coding"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40005299" title="Core Animation Extensions To Key-Value Coding"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../GraphicsImaging/index.html#//apple_ref/doc/uid/TP30000440-TP30000424" target="_top">Graphics &amp; Imaging</a> &gt; <a href="../../../../GraphicsImaging/Quartz-date.html#//apple_ref/doc/uid/TP30000440-TP30000424-TP30000559" target="_top">Quartz</a> &gt; <a href="../index.html" target="_top">Core Animation Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="Layout.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="LayerVisProps.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/TP40005299-SW1" title="Core Animation Extensions To Key-Value Coding"></a><hr /><H1>Core Animation Extensions To Key-Value Coding</H1><p>The <code>CAAnimation</code> and <code>CALayer</code> classes extend the <code>NSKeyValueCoding</code> protocol adding default values for keys, expanded wrapping conventions, and key path support for <code>CGPoint</code>, <code>CGRect</code>, <code>CGSize</code>, and <code>CATransform3D</code>.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="KVCAdditions.html#//apple_ref/doc/uid/TP40005299-SW3">Key-Value Coding Compliant Container Classes</a>
				
			<br/>
			
        
			
			
				<a href="KVCAdditions.html#//apple_ref/doc/uid/TP40005299-SW4">Default Value Support</a>
				
			<br/>
			
        
			
			
				<a href="KVCAdditions.html#//apple_ref/doc/uid/TP40005299-SW5">Wrapping Conventions</a>
				
			<br/>
			
        
			
			
				<a href="KVCAdditions.html#//apple_ref/doc/uid/TP40005299-SW6">Key Path Support for Structure Fields</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40005299-SW3" title="Key-Value Coding Compliant Container Classes"></a><h2>Key-Value Coding Compliant Container Classes</h2><p>Both <code>CALayer</code> and <code>CAAnimation</code> are key-value coding compliant container classes, allowing you to set values for arbitrary keys. That is, while the key “foo” is not a declared property of the <code>CALayer</code> class, however you can still set a value for the key “foo” as follows:</p><div class="codesample"><table><tr><td scope="row"><pre>[theLayer setValue:[NSNumber numberWithInteger:50] forKey:@"foo"];<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr></table></div><p>You retrieve the value for the key “foo” using the following code:</p><div class="codesample"><table><tr><td scope="row"><pre>fooValue=[theLayer valueForKey:@"foo"];<span></span></pre></td></tr></table></div><div class="notebox"><a name="//apple_ref/doc/uid/TP40005299-DontLinkElementID_4" title="Mac OS X Note"></a><p><strong>Mac OS X Note:</strong>&nbsp;On Mac OS X, the <code>CALayer</code> and <code>CAAnimation</code> classes support the <code>NSCoding</code> protocol and will automatically archive any additional keys that you set for an instance of those classes.</p></div><a name="//apple_ref/doc/uid/TP40005299-SW4" title="Default Value Support"></a><h2>Default Value Support</h2><p>Core Animation adds a new convention to key value coding that allows a class to provide a default value that is used when a class has no value set for that key. Both <code>CALayer</code> or <code>CAAnimation</code> support this convention using the class method <code>defaultValueForKey:</code>.</p><p>To provide a default value for a key you create a subclass of the class and override <code>defaultValueForKey:</code>. The subclass implementation examines the key parameter and then returns the appropriate default value. <span class="content_text">Listing 1</span> shows an example implementation of <code>defaultValueForKey:</code> that provides a new default value for the layer property <code>masksToBounds</code>. </p><a name="//apple_ref/doc/uid/TP40005299-SW2" title="Listing 1Example implementation of defaultValueForKey:"></a><p class="codesample"><strong>Listing 1&nbsp;&nbsp;</strong>Example implementation of defaultValueForKey:</p><div class="codesample"><table><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>+ (id)defaultValueForKey:(NSString *)key<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    if ([key isEqualToString:@"masksToBounds"])<span></span></pre></td></tr><tr><td scope="row"><pre>         return [NSNumber numberWithBool:YES];<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    return [super defaultValueForKey:key];<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40005299-SW5" title="Wrapping Conventions"></a><h2>Wrapping Conventions</h2><p>When using the key-value coding methods to access properties whose values are not objects the standard key-value coding wrapping conventions support, the following wrapping conventions are used:</p><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>C Type</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Class</p></th></tr><tr><td  scope="row"><p>CGPoint</p></td><td ><p>NSValue</p></td></tr><tr><td  scope="row"><p>CGSize</p></td><td ><p>NSValue</p></td></tr><tr><td  scope="row"><p>CGRect</p></td><td ><p>NSValue</p></td></tr><tr><td  scope="row"><p>CGAffineTransform</p></td><td ><p>NSAffineTransform</p></td></tr><tr><td  scope="row"><p>CATransform3D</p></td><td ><p>NSValue</p></td></tr></table></div><a name="//apple_ref/doc/uid/TP40005299-SW6" title="Key Path Support for Structure Fields"></a><h2>Key Path Support for Structure Fields</h2><p><code>CAAnimation</code> provides support for accessing the fields of selected structures using key paths. This is useful for specifying these structure fields as the key paths for animations, as well as setting and getting values using <code><a href="../../../Reference/Foundation/Protocols/NSKeyValueCoding_Protocol/Reference/Reference.html#//apple_ref/occ/instm/NSObject/setValue:forKeyPath:" target="_top">setValue:forKeyPath:</a></code> and <code><a href="../../../Reference/Foundation/Protocols/NSKeyValueCoding_Protocol/Reference/Reference.html#//apple_ref/occ/instm/NSObject/valueForKeyPath:" target="_top">valueForKeyPath:</a></code>.</p><p><code>CATransform3D</code> exposes the following fields:</p><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Structure Field</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th></tr><tr><td  scope="row"><p><code>rotation.x</code></p></td><td ><p>The rotation, in radians, in the x axis.</p></td></tr><tr><td  scope="row"><p><code>rotation.y</code></p></td><td ><p>The rotation, in radians, in the y axis.</p></td></tr><tr><td  scope="row"><p><code>rotation.z</code></p></td><td ><p>The rotation, in radians, in the z axis.</p></td></tr><tr><td  scope="row"><p><code>rotation</code></p></td><td ><p>The rotation, in radians, in the z axis. This is identical to setting the <code>rotation.z</code> field.</p></td></tr><tr><td  scope="row"><p><code>scale.x</code></p></td><td ><p>Scale factor for the x axis.</p></td></tr><tr><td  scope="row"><p><code>scale.y</code></p></td><td ><p>Scale factor for the y axis.</p></td></tr><tr><td  scope="row"><p><code>scale.z</code></p></td><td ><p>Scale factor for the z axis.</p></td></tr><tr><td  scope="row"><p><code>scale</code></p></td><td ><p>Average of all three scale factors.</p></td></tr><tr><td  scope="row"><p><code>translation.x</code></p></td><td ><p>Translate in the x axis.</p></td></tr><tr><td  scope="row"><p><code>translation.y</code></p></td><td ><p>Translate in the y axis.</p></td></tr><tr><td  scope="row"><p><code>translation.z</code></p></td><td ><p>Translate in the z axis.</p></td></tr><tr><td  scope="row"><p><code>translation</code></p></td><td ><p>Translate in the x and y axis. Value is an NSSize or CGSize.</p></td></tr></table></div><p><code>CGPoint</code> exposes the following fields:</p><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Structure Field</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th></tr><tr><td  scope="row"><p><code>x</code></p></td><td ><p>The x component of the point.</p></td></tr><tr><td  scope="row"><p><code>y</code></p></td><td ><p>The y component of the point.</p></td></tr></table></div><p><code>CGSize</code> exposes the following fields:</p><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Structure Field</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th></tr><tr><td  scope="row"><p><code>width</code></p></td><td ><p>The width component of the size.</p></td></tr><tr><td  scope="row"><p><code>height</code></p></td><td ><p>The height component of the size.</p></td></tr></table></div><p><code>CGRect</code> exposes the following fields:</p><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Structure Field</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th></tr><tr><td  scope="row"><p><code>origin</code></p></td><td ><p>The origin of the rectangle as a <code>CGPoint</code>. </p></td></tr><tr><td  scope="row"><p><code>origin.x</code></p></td><td ><p>The x component of the rectangle origin.</p></td></tr><tr><td  scope="row"><p><code>origin.y</code></p></td><td ><p>The y component of the rectangle origin.</p></td></tr><tr><td  scope="row"><p><code>size</code></p></td><td ><p>The size of the rectangle as a <code>CGSize</code>.</p></td></tr><tr><td  scope="row"><p><code>size.width</code></p></td><td ><p>The width component of the rectangle size.</p></td></tr><tr><td  scope="row"><p><code>size.height</code></p></td><td ><p>The height component of the rectangle size.</p></td></tr></table></div><p>You can not specify a structure field key path using Objective-C 2.0 properties.  This will not work:</p><div class="codesample"><table><tr><td scope="row"><pre>    myLayer.transform.rotation.x=0;<span></span></pre></td></tr></table></div><p>Instead you must use <code><a href="../../../Reference/Foundation/Protocols/NSKeyValueCoding_Protocol/Reference/Reference.html#//apple_ref/occ/instm/NSObject/setValue:forKeyPath:" target="_top">setValue:forKeyPath:</a></code> or <code><a href="../../../Reference/Foundation/Protocols/NSKeyValueCoding_Protocol/Reference/Reference.html#//apple_ref/occ/instm/NSObject/valueForKeyPath:" target="_top">valueForKeyPath:</a></code> as shown below:</p><div class="codesample"><table><tr><td scope="row"><pre>    [myLayer setValue:[NSNumber numberWithInt:0] forKeyPath:@"transform.rotation.x"];<span></span></pre></td></tr></table></div>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="Layout.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="LayerVisProps.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-11-13<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Conceptual/CoreAnimation_guide/Articles/KVCAdditions.html%3Fid%3DTP40004514-5.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Conceptual/CoreAnimation_guide/Articles/KVCAdditions.html%3Fid%3DTP40004514-5.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Conceptual/CoreAnimation_guide/Articles/KVCAdditions.html%3Fid%3DTP40004514-5.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
