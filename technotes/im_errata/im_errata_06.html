<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note IMERRATA06: Inside Macintosh: Processes Errata</title><meta name="keywords" content="Macintosh OS 8 Processes errors omissions installing VBL tasks"><meta name="Description" content="Technical Note IMERRATA06: This Technical Note discussesknown errors and omissions in Inside Macintosh: Processes.Corrections include: Clarification of Installing PersistentVBL Tasks; Clarification of GetVBLQHdr; Clarification ofInterrupt Priorities During VBL Tasks.">                                       <meta name="categories" content="Processes and Inside Macintosh Errata"><meta name="week-posted" content="Sep 26, 1994 - Oct 7, 1994"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF" TEXT="#000000"><a name="//apple_ref/doc/uid/DTS10002526" title="Inside Macintosh: Processes Errata"></a><a name="top"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxCarbon-date.html">Carbon</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/Carbon/idxProcessManagement-date.html" target="_blank">Carbon > Process Management</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note IMERRATA06</div>
<div id="pageheadsub">Inside Macintosh: Processes Errata</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext"><A HREF="#Section1">Topics</a><BR><BR> <A HREF="#Section2">Chapter 1 - Introduction to Processes and Tasks</a><BR><BR> <A HREF="#Section3">Chapter 4 - Vertical Retrace Manager</a><BR><BR> <A HREF="#Section4">Chapter 6 - Deferred Task Manager</a><BR><BR> <A HREF="#Section5">Chapter 8 - Shutdown Manager</a><BR><BR><A HREF="#Glossary">Glossary </a><BR><BR><a href="#References">References</a><BR><BR>                  <A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">This Technical Note discusses known errors and omissions in <i>Inside Macintosh: Processes</i>.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Oct 01 1994]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><a name="Section1"></a><h2>Topics</h2><ul><li>Correction to Figure 1-1    October 1994</li><li>Clarification of Installing Persistent VBL Tasks    October 1994</li><li>Clarification of <code>GetVBLQHdr</code>    October 1994</li><li>Clarification of Interrupt Priorities During VBL Tasks    October 1994</li><li>Correction to Listing 8-1    October 1994</li><li>Correction to Glossary Entry    October 1994</li></ul> <P><A HREF="#top">Back to top</A></P><h2>Chapter 1 - Introduction to Processes and Tasks</h2><h3>Correction to Figure 1-1</h3><p>Page 1-4, The Cooperative Multitasking Environment</p><p>Figure 1-1 shows the wrong application icon in the menu bar. The SurfWritericon should be in the menu bar labeling the application menu, not the Finder icon.</p> <P><A HREF="#top">Back to top</A></P><h2>Chapter 4 - Vertical Retrace Manager</h2><h3>Clarification of Installing Persistent VBL Tasks</h3><p>Page 4-20, Installing a Persistent VBL Task</p><p>The description of installing a persistent VBL task is partly incorrect.The documentation states that "if you want to install a persistent system-basedVBL task, you need to load its VBL task record into the system partition." Thisis incorrect, and it is not what is demonstrated in Listing 4-15. Listing 4-15shows how to put the VBL task <i>code</i> (or enough of it to fool the VerticalRetrace Manager) into the system partition.</p><p>However, Listing 4-15 needs a call to <code>FlushInstructionCache</code> addedimmediately before the call to <code>VInstall</code>. In addition, it is preferableto code the error-handling part of Listing 4-15 like this:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>SysHeapPtr := NewPtrSys(kJMPSize);IF SysHeapPtr = NIL THEN    BEGIN        InstallPersistentVBL := MemError;        Exit(InstallPersistentVBL );    END;</pre>	</TD></TR></TABLE></CENTER><h3>Clarification of GetVBLQHdr</h3><p>Page 4-28</p><p><code>GetVBLQHdr</code> returns a pointer to the head of the VBL queue. One of the bits of the <code>qFlags</code> field of the VBL queue header indicates whether a VBL task is currently executing. The correct bit is bit 6 of the <i>first</i> byteof the <code>qFlags</code> field, or bit 14 of the entire two-byte field. Versionsof A/UX prior to 3.1 incorrectly used bit 6 of the entire two-byte field.</p> <P><A HREF="#top">Back to top</A></P> <a name="Section4"></a><h2>Chapter 6 - Deferred Task Manager</h2><h3>Clarification of Interrupt Priorities During VBL Tasks</h3><p>Pages 6-3, 6-5, About the Deferred Task Manager</p><p>The documentation states "If the current application is then interrupted by avertical retrace interrupt, the interrupt priority is set to 1 during the servicing ofthe interrupt and restored to 0 upon completion." This is not strictly correct. The Vertical Retrace Manager actually restores the interrupt mask to 0 before running VBL tasks. As a result, VBL tasks can be interrupted by future level-1 interrupts, although a VBL task cannot interrupt another VBL task.</p><p>On page 6-5, the documentation states "Suppose that your application installsand activates a Time Manager task, which is triggered by level-2 interrupts."Actually, Time Manager interrupts are level-1 interrupts.</p><p>Also on page 6-5, there is occasional mention of the status register beingrestored to 0. In fact, only three bits of the status register (the processorpriority level) are restored to 0. All other bits are unchanged.</p><a name="Section5"></a> <P><A HREF="#top">Back to top</A></P><h2>Chapter 8 - Shutdown Manager</h2><h3>Correction to Listing 8-1</h3><p>Page 8-8, Sending a Shutdown or Restart Event</p><p>Listing 8-1 on page 8-8 contains several errors. The constant<code>kFinderSig</code> should be defined to be '<code>MACS'</code>. In addition, thatconstant cannot be passed directly to the <code>AECreateDesc</code> function.Instead, you must declare a variable of type <code>OSType</code> and assign<code>kFinderSig</code> to it, as follows:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>CONST    kFinderSig = 'MACS';VAR    ...    signature: OSTypeBEGIN    signature := kFinderSig;    myErr := AECreateDesc(typeApplSignature, @signature, ...);    ...</pre>	</TD></TR></TABLE></CENTER><a name="Glossary"> </a><P><A HREF="#top">Back to top</A></P><h2>Glossary</h2><h3>Correction to Glossary Entry</h3><p>Page GL-2</p><p>The entry <b>interrupt handle</b> should be <b>interrupt handler.</b></p> <P><A HREF="#top">Back to top</A></P><h2>References</h2><p><i>Inside Macintosh: Processes</i></p>         <P><A HREF="#top">Back to top</A></P>                  <P><A NAME=Downloads></A></P>                  <h2>Downloadables</h2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (40K)</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/im_errata_06.pdf">Download</A></P>               </TD>            </TR>                     </TABLE>         <BR>                  <P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/im_errata/im_errata_06.html%3Fid%3DDTS10002526-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/im_errata/im_errata_06.html%3Fid%3DDTS10002526-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/im_errata/im_errata_06.html%3Fid%3DDTS10002526-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>