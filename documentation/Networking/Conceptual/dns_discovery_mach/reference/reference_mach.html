<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>DNSServiceDiscovery Mach-Based API (Not Recommended): Functions and Callbacks</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Functions and Callbacks"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	<meta name="ROBOTS" content="NOINDEX"/>
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30001129-CH206-241147" title="Functions and Callbacks"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000429" target="_top">Networking</a> &gt; <a href="../../../Bonjour-date.html#//apple_ref/doc/uid/TP30000440-TP30000429-TP30000566" target="_top">Bonjour</a> &gt; <a href="../introduction/intro_mach.html#//apple_ref/doc/uid/TP30001129-CH203-DontLinkElementID_8">DNSServiceDiscovery Mach-Based API (Not Recommended)</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../tasks/tasks_mach.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="reference_mach2.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        <script type="text/javascript" language="JavaScript">placeWatermark()</script>
<div id="legacyOuterWrapper"><div align="center" id="watermark">
<div class="legacybox">
<h1>Legacy Document<span class="closebutton"><a href="javascript:closeWatermark()"><img src="../../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>
        <a name="//apple_ref/doc/uid/TP30001129-CH206-BBCEJDCJ" title="Functions and Callbacks"></a><h1><a name="//apple_ref/doc/uid/TP30001129-CH206-TPXREF111" title="Functions and Callbacks"></a>Functions and Callbacks</h1><p>This section describes the functions that make up the
DNSServiceDiscovery API and provides prototypes of the callbacks
you need to implement. The callbacks are required to handle the
asynchronous replies that many of these functions generate. The
functions and callbacks are organized into the following sections:</p>
<ul class="ul"><li class="li"><p><span class="content_text"><a href="reference_mach.html#//apple_ref/doc/uid/TP30001129-CH206-172385">“Registration”</a></span></p></li>
<li class="li"><p><span class="content_text"><a href="reference_mach.html#//apple_ref/doc/uid/TP30001129-CH206-167965">“Mach Port Accessor”</a></span></p></li>
<li class="li"><p><span class="content_text"><a href="reference_mach.html#//apple_ref/doc/uid/TP30001129-CH206-228172">“Service Browser”</a></span></p></li>
<li class="li"><p><span class="content_text"><a href="reference_mach.html#//apple_ref/doc/uid/TP30001129-CH206-170555">“Service Address Resolver”</a></span></p></li>
<li class="li"><p><span class="content_text"><a href="reference_mach.html#//apple_ref/doc/uid/TP30001129-CH206-229047">“Domain Enumeration”</a></span></p></li>
<li class="li"><p><span class="content_text"><a href="reference_mach.html#//apple_ref/doc/uid/TP30001129-CH206-228819">“Reference Record Deallocation”</a></span></p></li>
<li class="li"><p><span class="content_text"><a href="reference_mach.html#//apple_ref/doc/uid/TP30001129-CH206-242137">“Dynamic Update”</a></span></p></li></ul>


<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="reference_mach.html#//apple_ref/doc/uid/TP30001129-CH206-DontLinkElementID_1">Functions by Task</a>
				
			<br/>
			
        
			
			
				<a href="reference_mach.html#//apple_ref/doc/uid/TP30001129-CH206-DontLinkElementID_2">Functions</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP30001129-CH206-DontLinkElementID_1" title="Functions by Task"></a><h2>Functions by Task</h2>
<a name="//apple_ref/doc/uid/TP30001129-CH206-172385" title="Registration"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-BBCEEAJA" title="Registration"></a>
    
    <h3 class="tasks"><a name="//apple_ref/doc/uid/TP30001129-CH206-TPXREF103" title="Registration"></a>Registration</h3>
    <p>These functions allow services to register
with the mDNS responder. Once a service is registered, it can be
found&#8212;either by name or by browsing for services of this type&#8212;using multicast
DNS requests.</p>
<ul class="ul"><li class="li"><p><code><a href="reference_mach.html#//apple_ref/c/func/DNSServiceRegistrationCreate">DNSServiceRegistrationCreate</a></code></p></li>
<li class="li"><p><code><a href="reference_mach.html#//apple_ref/c/func/MyDNSServiceRegistrationReply_handler">MyDNSServiceRegistrationReply_handler</a></code></p></li></ul>    
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference_mach.html#//apple_ref/c/func/DNSServiceRegistrationCreate">DNSServiceRegistrationCreate</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Allocates and initializes a <code>dns_service_discovery_ref</code> record,
sets up a Mach reply port for the service, and registers the service
in the specified domain.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference_mach.html#//apple_ref/c/func/MyDNSServiceRegistrationReply_handler">MyDNSServiceRegistrationReply_handler</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Your application implements this callback function to
handle replies from <code>DNSServiceRegistrationCreate</code>.
The reply is a <code>DNSServiceRegistrationReply</code>.'/>
            </span></li>
    </ul>


<a name="//apple_ref/doc/uid/TP30001129-CH206-167965" title="Mach Port Accessor"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-BBCGDEJH" title="Mach Port Accessor"></a>
    
    <h3 class="tasks"><a name="//apple_ref/doc/uid/TP30001129-CH206-TPXREF105" title="Mach Port Accessor"></a>Mach Port Accessor</h3>
    <p>These functions help the applications programmer
establish a connection with a Mach reply port.</p>
<ul class="ul"><li class="li"><p><code><a href="reference_mach.html#//apple_ref/c/func/DNSServiceDiscoveryMachPort">DNSServiceDiscoveryMachPort</a></code></p></li>
<li class="li"><p><code><a href="reference_mach.html#//apple_ref/c/func/DNSServiceDiscovery_handleReply">DNSServiceDiscovery_handleReply</a></code></p></li></ul>    
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference_mach.html#//apple_ref/c/func/DNSServiceDiscoveryMachPort">DNSServiceDiscoveryMachPort</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Returns a Mach reply port.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference_mach.html#//apple_ref/c/func/DNSServiceDiscovery_handleReply">DNSServiceDiscovery_handleReply</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Handles messages from your Mach port.'/>
            </span></li>
    </ul>


<a name="//apple_ref/doc/uid/TP30001129-CH206-228172" title="Service Browser"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-BBCDHIGC" title="Service Browser"></a>
    
    <h3 class="tasks"><a name="//apple_ref/doc/uid/TP30001129-CH206-TPXREF107" title="Service Browser"></a>Service Browser</h3>
    <p>These functions allow applications to discover
network services by browsing:</p>
<ul class="ul"><li class="li"><p><code><a href="reference_mach.html#//apple_ref/c/func/DNSServiceBrowserCreate">DNSServiceBrowserCreate</a></code></p></li>
<li class="li"><p><code><a href="reference_mach.html#//apple_ref/c/func/MyDNSServiceBrowserReply_handler">MyDNSServiceBrowserReply_handler</a></code></p></li></ul>    
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference_mach.html#//apple_ref/c/func/DNSServiceBrowserCreate">DNSServiceBrowserCreate</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Returns a list of all network services of a specified
type in a specified domain.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference_mach.html#//apple_ref/c/func/MyDNSServiceBrowserReply_handler">MyDNSServiceBrowserReply_handler</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Your application implements this callback function to
handle replies from <code>DNSServiceBrowserCreate</code>.
The reply is a <code>DNSServiceBrowserReply</code>.'/>
            </span></li>
    </ul>


<a name="//apple_ref/doc/uid/TP30001129-CH206-170555" title="Service Address Resolver"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-BBCIIIBJ" title="Service Address Resolver"></a>
    
    <h3 class="tasks"><a name="//apple_ref/doc/uid/TP30001129-CH206-TPXREF108" title="Service Address Resolver"></a>Service Address Resolver</h3>
    <p>These functions resolve the current IP address
and port of a given service instance.</p>
<ul class="ul"><li class="li"><p><code><a href="reference_mach.html#//apple_ref/c/func/DNSServiceResolverResolve">DNSServiceResolverResolve</a></code></p></li>
<li class="li"><p><code><a href="reference_mach.html#//apple_ref/c/func/MyDNSServiceResolverReply_handler">MyDNSServiceResolverReply_handler</a></code></p></li></ul>    
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference_mach.html#//apple_ref/c/func/DNSServiceResolverResolve">DNSServiceResolverResolve</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Finds the current IP address and port for a service instance,
as returned to your <code>DNSServiceBrowserReply_handler</code> callback
function after a call to <code>DNSServiceBrowserCreate</code>.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference_mach.html#//apple_ref/c/func/MyDNSServiceResolverReply_handler">MyDNSServiceResolverReply_handler</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Your application implements this callback function to
handle replies from <code>DNSServiceResolverResolve</code>.'/>
            </span></li>
    </ul>


<a name="//apple_ref/doc/uid/TP30001129-CH206-229047" title="Domain Enumeration"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-BBCEFCJF" title="Domain Enumeration"></a>
    
    <h3 class="tasks"><a name="//apple_ref/doc/uid/TP30001129-CH206-TPXREF106" title="Domain Enumeration"></a>Domain Enumeration</h3>
    <p>These functions list the recommended and default
domains for registration or browsing:</p>
<ul class="ul"><li class="li"><p><code><a href="reference_mach.html#//apple_ref/c/func/DNSServiceDomainEnumerationCreate">DNSServiceDomainEnumerationCreate</a></code></p></li>
<li class="li"><p><code><a href="reference_mach.html#//apple_ref/c/func/MyDNSServiceDomainEnumerationReply_handler">MyDNSServiceDomainEnumerationReply_handler</a></code></p></li></ul>    
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference_mach.html#//apple_ref/c/func/DNSServiceDomainEnumerationCreate">DNSServiceDomainEnumerationCreate</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Lists the recommended domains in which to register a service
or browse for services.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference_mach.html#//apple_ref/c/func/MyDNSServiceDomainEnumerationReply_handler">MyDNSServiceDomainEnumerationReply_handler</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Your application implements this callback function to
handle replies from <code>DNSServiceDomainEnumerationCreate</code>.
The reply is a <code>DNSServiceDomainEnumerationReply</code>.'/>
            </span></li>
    </ul>


<a name="//apple_ref/doc/uid/TP30001129-CH206-228819" title="Reference Record Deallocation"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-BBCDEJHC" title="Reference Record Deallocation"></a>
    
    <h3 class="tasks"><a name="//apple_ref/doc/uid/TP30001129-CH206-TPXREF104" title="Reference Record Deallocation"></a>Reference Record Deallocation</h3>
    <p>This function described in this section deallocates
a <code>dns_service_discovery_ref</code> record
and disconnects any associated Mach port.</p>
<ul class="ul"><li class="li"><p><code><a href="reference_mach.html#//apple_ref/c/func/DNSServiceDiscoveryDeallocate">DNSServiceDiscoveryDeallocate</a></code></p></li></ul>    
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference_mach.html#//apple_ref/c/func/DNSServiceDiscoveryDeallocate">DNSServiceDiscoveryDeallocate</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Deallocates a <code>dns_service_discovery_ref</code> record
and closes the connection to the server.'/>
            </span></li>
    </ul>


<a name="//apple_ref/doc/uid/TP30001129-CH206-242137" title="Dynamic Update"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-BBCIFDJB" title="Dynamic Update"></a>
    
    <h3 class="tasks"><a name="//apple_ref/doc/uid/TP30001129-CH206-BBCEGIBH" title="Dynamic Update"></a>Dynamic Update</h3>
    <p>These functions provide the ability to add
to, update, or delete registration information stored in the mDNS
responder dynamically, after you have registered and while your service
is running. An example would be updating the text record associated
with a printer to indicate a change in printing capabilities. Bonjour
automatically handles most update tasks, such as sleep/wake and
location changes, so these functions are rarely needed.</p>
<ul class="ul"><li class="li"><p><code><a href="reference_mach.html#//apple_ref/c/func/DNSServiceRegistrationAddRecord">DNSServiceRegistrationAddRecord</a></code></p></li>
<li class="li"><p><code><a href="reference_mach.html#//apple_ref/c/func/DNSServiceRegistrationRemoveRecord">DNSServiceRegistrationRemoveRecord</a></code></p></li>
<li class="li"><p><code><a href="reference_mach.html#//apple_ref/c/func/DNSServiceRegistrationUpdateRecord">DNSServiceRegistrationUpdateRecord</a></code></p></li></ul>    
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference_mach.html#//apple_ref/c/func/DNSServiceRegistrationAddRecord">DNSServiceRegistrationAddRecord</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Request that the mDNS Responder append an additional record
to the DNS resource information associated with your service.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference_mach.html#//apple_ref/c/func/DNSServiceRegistrationRemoveRecord">DNSServiceRegistrationRemoveRecord</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Request that the mDNS responder remove a record from your
service&#8217;s registration information.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference_mach.html#//apple_ref/c/func/DNSServiceRegistrationUpdateRecord">DNSServiceRegistrationUpdateRecord</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Request the mDNS responder to update a DNS record for
your service. Most services will never need to do this.'/>
            </span></li>
    </ul>

<a name="//apple_ref/doc/uid/TP30001129-CH206-DontLinkElementID_2" title="Functions"></a><h2>Functions</h2>




















<a name="//apple_ref/c/func/DNSServiceBrowserCreate" title="DNSServiceBrowserCreate"></a><a name="//apple_ref/doc/c_ref/DNSServiceBrowserCreate" title="DNSServiceBrowserCreate"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-DNSServiceBrowserCreate" title="DNSServiceBrowserCreate"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-DontLinkElementID_19"></a><h3 class="tight">DNSServiceBrowserCreate</h3>
<p class="spaceabove">Returns a list of all network services of a specified
type in a specified domain.</p>

<p class="spaceabove"><pre>
<a href="reference_mach2.html#//apple_ref/doc/c_ref/dns_service_discovery_ref">dns_service_discovery_ref</a> DNSServiceBrowserCreate(
const char *regtype,
const char *domain,
<!--a-->DNSServiceBrowserReply<!--/a--> callBack,
void *context);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>regtype</em></dt>
<dd><p>The type of service, as specified by the IANA; <code>_printer._tcp</code> is
an example.</p></dd>
<dt><em>domain</em></dt>
<dd><p>The domain to search for the specified type
of service; <code>local</code>. is
an example. Pass an empty string &#8220;&#8220; to search the default domain.</p></dd>
<dt><em>callBack</em></dt>
<dd><p>The <code>DNSServiceBrowserReply_handler</code> function
to be called when a service has been found or removed. See <span class="content_text"><a href="reference_mach.html#//apple_ref/c/func/MyDNSServiceBrowserReply_handler">“MyDNSServiceBrowserReply_handler.”</a></span></p></dd>
<dt><em>context </em></dt>
<dd><p>A user-specified context that will be passed
to the callback function.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>This function allocates
and returns a <code>dns_service_discovery_ref</code> record. The
caller is responsible for deallocating the record.</p>
<h5 class="tight">Discussion</h5>
<p>Use this function to browse for a list of available services
of a given type in a given domain. The requested service data is
sent asynchronously to your callback function as a <code><!--a  -->DNSServiceBrowserReply<!--/a--></code>.
Your callback may receive a number of calls asynchronously. Do not
update your user interface (list of available services) while the DNSServiceBrowserReply
has the &#8220;More&#8221; flag set, but do not disable the user interface
or change the cursor while waiting for data. Your callback should
remain active as long as your service browser is running. To use
a service found by this function, obtain the actual address information
for that service by calling <code>DNSServiceResolverResolve</code>.
To search for multiple service types, or to search multiple domains,
make multiple calls to <code><a href="reference_mach.html#//apple_ref/doc/c_ref/DNSServiceBrowserCreate">DNSServiceBrowserCreate</a></code>.</p>
<p>Sample code: <code>SamplemDNSClient.c</code></p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in OS X version 10.2.</p><a name="//apple_ref/c/func/DNSServiceDiscoveryDeallocate" title="DNSServiceDiscoveryDeallocate"></a><a name="//apple_ref/doc/c_ref/DNSServiceDiscoveryDeallocate" title="DNSServiceDiscoveryDeallocate"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-DNSServiceDiscoveryDeallocate" title="DNSServiceDiscoveryDeallocate"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-DontLinkElementID_20"></a><h3 class="tight">DNSServiceDiscoveryDeallocate</h3>
<p class="spaceabove">Deallocates a <code>dns_service_discovery_ref</code> record
and closes the connection to the server.</p>

<p class="spaceabove"><pre>
void DNSServiceDiscoveryDeallocate(
<a href="reference_mach2.html#//apple_ref/doc/c_ref/dns_service_discovery_ref">dns_service_discovery_ref</a> dnsServiceDiscovery);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>dnsServiceDiscovery_ref</em></dt>
<dd><p>A <code>dns_service_discovery_ref</code> record
as returned from calling <code>DNSServiceRegistrationCreate</code>, <code>DNSServiceBrowserCreate</code>,
or <code>DNSServiceDomainEnumerationCreate</code>.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>None.</p>
<h5 class="tight">Discussion</h5>
<p>You are responsible for deallocating <code>dns_service_discovery_ref</code> records
returned by creation or enumeration calls. For registration or browsing,
you typically make a single creation call, and the returned record
remains active until your application terminates. In these cases,
it is not necessary to deallocate the record. The enumeration function
can also be called once, and the callback left active, or it can
be called as needed. In the latter case, you should deallocate the
record before calling the enumeration function again to prevent a
memory leak.</p>
<p>A Mach reply port is set up for your application when you
call <code>DNSServiceRegistrationCreate</code>.
Deallocating the returned <code>dns_service_discovery_ref</code> disconnects
your application from the Mach port and unregisters your service.
You can use this technique if you need to unregister and re-register
your service without shutting down your application.</p>
<p>Sample code: <code>SamplemDNSClient.c</code></p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in OS X version 10.2.</p><a name="//apple_ref/c/func/DNSServiceDiscoveryMachPort" title="DNSServiceDiscoveryMachPort"></a><a name="//apple_ref/doc/c_ref/DNSServiceDiscoveryMachPort" title="DNSServiceDiscoveryMachPort"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-DNSServiceDiscoveryMachPort" title="DNSServiceDiscoveryMachPort"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-DontLinkElementID_21"></a><h3 class="tight">DNSServiceDiscoveryMachPort</h3>
<p class="spaceabove">Returns a Mach reply port.</p>

<p class="spaceabove"><pre>
mach_port_t DNSServiceDiscoveryMachPort(
<a href="reference_mach2.html#//apple_ref/doc/c_ref/dns_service_discovery_ref">dns_service_discovery_ref</a> dnsServiceDiscovery);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>registration</em></dt>
<dd><p>A <code>dns_service_discovery_ref</code> a
s returned from <code>DNSServiceRegistrationCreate</code>.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>This function returns
a Mach reply port. A <code>NULL</code> value
indicates that no address was specified or some other error occurred
which prevented the resolution from being started.</p>
<h5 class="tight">Discussion</h5>
<p>This function returns a Mach reply port which will be sent
messages as appropriate. These messages should be handled by the <code>DNSServiceDiscovery_handleReply</code> function,
which needs to be integrated into your run loop. See <code><a href="reference_mach.html#//apple_ref/c/func/DNSServiceDiscovery_handleReply">DNSServiceDiscovery_handleReply</a></code>.</p>
<p>Sample code: <code>SamplemDNSClient.c</code></p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in OS X version 10.2.</p><a name="//apple_ref/c/func/DNSServiceDiscovery_handleReply" title="DNSServiceDiscovery_handleReply"></a><a name="//apple_ref/doc/c_ref/DNSServiceDiscovery_handleReply" title="DNSServiceDiscovery_handleReply"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-DNSServiceDiscovery_handleReply" title="DNSServiceDiscovery_handleReply"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-DontLinkElementID_22"></a><h3 class="tight">DNSServiceDiscovery_handleReply</h3>
<p class="spaceabove">Handles messages from your Mach port.</p>

<p class="spaceabove"><pre>
void DNSServiceDiscovery_handleReply(void *replyMsg);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>*replyMsg</em></dt>
<dd><p>The Mach message.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>Install this function as a callback to handle messages from
your Mach port if you are providing a network service and using
the mDNS responder. </p>
<p>Sample code: <code>SamplemDNSClient.c</code></p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in OS X version 10.2.</p><a name="//apple_ref/c/func/DNSServiceDomainEnumerationCreate" title="DNSServiceDomainEnumerationCreate"></a><a name="//apple_ref/doc/c_ref/DNSServiceDomainEnumerationCreate" title="DNSServiceDomainEnumerationCreate"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-DNSServiceDomainEnumerationCreate" title="DNSServiceDomainEnumerationCreate"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-DontLinkElementID_23"></a><h3 class="tight">DNSServiceDomainEnumerationCreate</h3>
<p class="spaceabove">Lists the recommended domains in which to register a service
or browse for services.</p>

<p class="spaceabove"><pre>
<a href="reference_mach2.html#//apple_ref/doc/c_ref/dns_service_discovery_ref">dns_service_discovery_ref</a> DNSServiceDomainEnumerationCreate(
int registrationDomains,
<!--a-->DNSServiceDomainEnumerationReply<!--/a--> callBack,
void *context);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>registrationDomains</em></dt>
<dd><p>A Boolean indicating whether you are looking
for recommended registration domains (equivalent to the AppleTalk
zone list in the AppleTalk Control Panel) or recommended browsing
domains (equivalent to the AppleTalk zone list in the Chooser).</p></dd>
<dt><em>callBack</em></dt>
<dd><p>The <code>DNSServiceDomainEnumerationReply_handler</code> function
to be called when domains are found or removed See <code><a href="reference_mach.html#//apple_ref/c/func/MyDNSServiceDomainEnumerationReply_handler">&#8220;MyDNSServiceDomainEnumerationReply_handler&#8221;</a></code>.</p></dd>
<dt><em>context</em></dt>
<dd><p>A user-specified context that will be passed
to the callback function.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>This function allocates
and returns a <code>dns_service_discovery_ref </code>record. The
caller is responsible for deallocating the record. This record does
not contain the requested domain data&#8212;that information is sent
to your callback function asynchronously.</p>
<h5 class="tight">Discussion</h5>
<p>You can use this function obtain a list of recommended domains
in which to register your service or a list of recommended domains
in which to browse for services. This is not necessary if you want
to simply register in or search the default domain. You can pass
an empty string &#8220;&#8220; as the domain parameter for the registration
and browser functions, and they will use the default domain without
requiring you to look it up. Use this function if you need to do
something more complex.</p>
<p>Sample code: <code>SamplemDNSClient.c</code></p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in OS X version 10.2.</p><a name="//apple_ref/c/func/DNSServiceRegistrationAddRecord" title="DNSServiceRegistrationAddRecord"></a><a name="//apple_ref/doc/c_ref/DNSServiceRegistrationAddRecord" title="DNSServiceRegistrationAddRecord"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-DNSServiceRegistrationAddRecord" title="DNSServiceRegistrationAddRecord"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-DontLinkElementID_24"></a><h3 class="tight">DNSServiceRegistrationAddRecord</h3>
<p class="spaceabove">Request that the mDNS Responder append an additional record
to the DNS resource information associated with your service.</p>
<p class="spaceabove"><pre>
<a href="reference_mach2.html#//apple_ref/doc/c_ref/DNSRecordReference">DNSRecordReference</a> DNSServiceRegistrationAddRecord(
<a href="reference_mach2.html#//apple_ref/doc/c_ref/dns_service_discovery_ref">dns_service_discovery_ref</a> dnsServiceDiscovery,
uint16_t rrtype,
uint16_t rdlen,
const char *rdata,
uint32_t ttl);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>dnsServiceDiscovery</em></dt>
<dd><p>The <code>dns_service_discovery_ref</code> for
your service, as returned from a <code>DNSServiceRegistrationCreate</code> call.</p></dd>
<dt><em>rrtype</em></dt>
<dd><p>A standard DNS Resource Record Type, as defined
at <code>http://www.iana.org/assignments/dns-parameters</code>.</p></dd>
<dt><em>rdlen</em></dt>
<dd><p>Length of the data block to follow (<em>rdata</em>).</p></dd>
<dt><em>rdata</em></dt>
<dd><p>Opaque binary Resource Record data&#8212;up to
64 kB of whatever you need to store.</p></dd>
<dt><em>ttl</em></dt>
<dd><p>Time-to-live for the added record. The TTL
can be set to any signed 32-bit value.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>A <code>DNSRecordReference</code>,
an opaque reference that can be passed to <code><a href="reference_mach.html#//apple_ref/doc/c_ref/DNSServiceRegistrationUpdateRecord">DNSServiceRegistrationUpdateRecord</a></code> or <code><a href="reference_mach.html#//apple_ref/doc/c_ref/DNSServiceRegistrationRemoveRecord">DNSServiceRegistrationRemoveRecord</a></code> to
update or remove this record. If an error occurs, this value will
be zero or negative.</p>
<h5 class="tight">Discussion</h5>
<p>This function appends a resource record to your existing DNS
service registry. This should not be necessary for existing services.</p>
<p>Sample code: <code>SamplemDNSClient.c</code></p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in OS X version 10.2.</p><a name="//apple_ref/c/func/DNSServiceRegistrationCreate" title="DNSServiceRegistrationCreate"></a><a name="//apple_ref/doc/c_ref/DNSServiceRegistrationCreate" title="DNSServiceRegistrationCreate"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-DNSServiceRegistrationCreate" title="DNSServiceRegistrationCreate"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-DontLinkElementID_25"></a><h3 class="tight">DNSServiceRegistrationCreate</h3>
<p class="spaceabove">Allocates and initializes a <code>dns_service_discovery_ref</code> record,
sets up a Mach reply port for the service, and registers the service
in the specified domain.</p>
<p class="spaceabove"><pre>
<a href="reference_mach2.html#//apple_ref/doc/c_ref/dns_service_discovery_ref">dns_service_discovery_ref</a> DNSServiceRegistrationCreate(
const char *name,
const char *regtype,
const char *domain,
uint16_t port,
const char *txtRecord,
<!--a-->DNSServiceRegistrationReply<!--/a--> callBack,
void *context);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>name</em></dt>
<dd><p>The name of this service instance (e.g. &quot;Steve's
Printer&quot;).</p></dd>
<dt><em>regtype</em></dt>
<dd><p>The service type, such as &quot;<code>_printer._tcp.</code>&quot;
For the service type specifications, see RFC 2782 (DNS SRV).</p></dd>
<dt><em>domain</em></dt>
<dd><p>The domain in which to register the service,
such as <code>"local."</code> Set
this parameter to &#8220;&#8220; (empty string) to use the default domain(s).</p></dd>
<dt><em>port</em></dt>
<dd><p>The local IP port on which this service is
being offered (in network byte order).</p></dd>
<dt><em>txtRecord</em></dt>
<dd><p>Optional protocol-specific additional information.
This parameter is provided to support legacy protocols that have
no capability negotiation and require text configuration, such as
LPR printing. If you are creating a new protocol, please not use
text records.</p></dd>
<dt><em>callBack</em></dt>
<dd><p>The <code>DNSServiceRegistrationReply_handler</code> callback
function to be called with any flags or errors. See <code><a href="reference_mach.html#//apple_ref/c/func/MyDNSServiceRegistrationReply_handler">&#8220;MyDNSServiceRegistrationReply_handler&#8221;</a></code>.</p></dd>
<dt><em>context</em></dt>
<dd><p>A user specified context which will be passed
to the callback function.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>Allocates, initializes,
and returns a <code>dns_service_discovery_ref</code> record,
an opaque data structure. Use this record to obtain your Mach port
address from <code>DNSServiceDiscoveryManPort</code>.
This record is also used to identify your service to other functions
in this API. You are responsible for deallocating the returned record
when you are finished with it.</p>
<h5 class="tight">Discussion</h5>
<p>Use this function to create register a service. Calling this
function also sets up a Mach reply port for your service. To obtain
the Mach port address, pass the returned <code>dns_service_discovery_ref</code> record
to <code><a href="reference_mach.html#//apple_ref/doc/c_ref/DNSServiceDiscoveryMachPort">DNSServiceDiscoveryMachPort</a></code>. Deallocating
the returned record also closes your connection to the Mach reply
port. Your service needs a network socket and an IP address, and
should be ready to respond to service requests, when you call this
function.</p>
<p>Sample code: <code>SamplemDNSClient.c</code></p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in OS X version 10.2.</p><a name="//apple_ref/c/func/DNSServiceRegistrationRemoveRecord" title="DNSServiceRegistrationRemoveRecord"></a><a name="//apple_ref/doc/c_ref/DNSServiceRegistrationRemoveRecord" title="DNSServiceRegistrationRemoveRecord"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-DNSServiceRegistrationRemoveRecord" title="DNSServiceRegistrationRemoveRecord"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-DontLinkElementID_26"></a><h3 class="tight">DNSServiceRegistrationRemoveRecord</h3>
<p class="spaceabove">Request that the mDNS responder remove a record from your
service&#8217;s registration information.</p>

<p class="spaceabove"><pre>
<!--a-->DNSServiceRegistrationReplyErrorType<!--/a--> DNSServiceRegistrationRemoveRecord(
<a href="reference_mach2.html#//apple_ref/doc/c_ref/dns_service_discovery_ref">dns_service_discovery_ref</a> ref,
<a href="reference_mach2.html#//apple_ref/doc/c_ref/DNSRecordReference">DNSRecordReference</a> reference);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>ref</em></dt>
<dd><p>A <code>dns_service_discovery_ref</code> as
returned from a <code>DNSServiceRegistrationCreate</code> call</p></dd>
<dt><em>reference</em></dt>
<dd><p>A <code>dnsRecordReference</code> as
returned from calling <code>DNSServiceRegistrationAddRecord</code>.
To remove your primary record, as returned from DNSServiceRegistrationCreate,
pass a zero in this parameter.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>A <code>DNSServiceRegistrationReplyErrorType.</code> If
an error occurs, this value will be nonzero.</p>
<h5 class="tight">Discussion</h5>
<p>Call this function to remove a record from your service&#8217;s
DNS registration information. You do not need to do this in the
ordinary course of events. If you remove your primary record, you
effectively unregister your service, but this is a side effect,
not a design feature&#8212;it does not deallocate your registration
record or disconnect your Mach port, for example.</p>
<p>Sample code: <code>SamplemDNSClient.c</code></p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in OS X version 10.2.</p><a name="//apple_ref/c/func/DNSServiceRegistrationUpdateRecord" title="DNSServiceRegistrationUpdateRecord"></a><a name="//apple_ref/doc/c_ref/DNSServiceRegistrationUpdateRecord" title="DNSServiceRegistrationUpdateRecord"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-DNSServiceRegistrationUpdateRecord" title="DNSServiceRegistrationUpdateRecord"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-DontLinkElementID_27"></a><h3 class="tight">DNSServiceRegistrationUpdateRecord</h3>
<p class="spaceabove">Request the mDNS responder to update a DNS record for
your service. Most services will never need to do this.</p>

<p class="spaceabove"><pre>
<!--a-->DNSServiceRegistrationReplyErrorType<!--/a--> DNSServiceRegistrationUpdateRecord(
<a href="reference_mach2.html#//apple_ref/doc/c_ref/dns_service_discovery_ref">dns_service_discovery_ref</a> ref,
<a href="reference_mach2.html#//apple_ref/doc/c_ref/DNSRecordReference">DNSRecordReference</a> reference,
uint16_t rdlen,
const char *rdata,
uint32_t ttl);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>ref</em></dt>
<dd><p>A <code>dns_service_discovery_ref</code> as
returned by <code>DNSServiceRegistrationCreate</code>.</p></dd>
<dt><em>reference</em></dt>
<dd><p>A <code>dnsRecordReference</code> as
returned by <code>DNSServiceRegistrationAddRecord</code>.
To update information in your primary record, as returned from,
set this parameter to zero. You might do this, for example, if you
need to update the text field for a legacy protocol while a service
is running.</p></dd>
<dt><em>rdlen</em></dt>
<dd><p>Length of the data block to follow (<em>rdata</em>).</p></dd>
<dt><em>rdata</em></dt>
<dd><p>Opaque binary resource record data, containing
up to 64 kB of whatever data you choose.</p></dd>
<dt><em>ttl</em></dt>
<dd><p>Time to live for the updated record. The TTL
can be set to any signed 32-bit value.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>A value of type <code>DNSServiceRegistrationReplyErrorType</code>.
If an error occurs, this value will be non-zero.</p>
<h5 class="tight">Discussion</h5>
<p>You might use this function to update a text record associated
with your service, if you are supporting a legacy protocol and the
information stored in the text record changes. Otherwise, you are
unlikely to have use for this function.</p>
<p>Sample code: <code>SamplemDNSClient.c</code></p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in OS X version 10.2.</p><a name="//apple_ref/c/func/DNSServiceResolverResolve" title="DNSServiceResolverResolve"></a><a name="//apple_ref/doc/c_ref/DNSServiceResolverResolve" title="DNSServiceResolverResolve"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-DNSServiceResolverResolve" title="DNSServiceResolverResolve"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-DontLinkElementID_28"></a><h3 class="tight">DNSServiceResolverResolve</h3>
<p class="spaceabove">Finds the current IP address and port for a service instance,
as returned to your <code>DNSServiceBrowserReply_handler</code> callback
function after a call to <code>DNSServiceBrowserCreate</code>.</p>
<p class="spaceabove"><pre>
<a href="reference_mach2.html#//apple_ref/doc/c_ref/dns_service_discovery_ref">dns_service_discovery_ref</a> DNSServiceResolverResolve(
const char *name,
const char *regtype,
const char *domain,
<!--a-->DNSServiceResolverReply<!--/a--> callBack,
void *context);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>name</em></dt>
<dd><p>The name of the service instance, as returned
from <code>DNSServiceBrowserCreate</code>.</p></dd>
<dt><em>regtype</em></dt>
<dd><p>The type of service, as returned from <code>DNSServiceBrowserCreate</code>.</p></dd>
<dt><em>domain</em></dt>
<dd><p>The domain in which to find the service, as
returned from <code>DNSServiceBrowserCreate</code>.</p></dd>
<dt><em>callBack</em></dt>
<dd><p>The <code>DNSServiceResolverReply_handler</code> function
to be called when the specified address has been resolved. See <span class="content_text"><a href="reference_mach.html#//apple_ref/c/func/MyDNSServiceResolverReply_handler">“MyDNSServiceResolverReply_handler.”</a></span></p></dd>
<dt><em>context</em></dt>
<dd><p>A user specified context which will be passed
to the callback function.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>This function returns
a <code>dns_service_discovery_ref</code> record,
an opaque data type. The requested service address data is sent
to your callback function asynchronously as a <code><!--a-->DNSServiceResolverReply<!--/a--></code>.</p>
<h5 class="tight">Discussion</h5>
<p>Use this function to resolve the current IP address of a service
after you have obtained its name, service type, and domain from <code>DNSServiceBrowserCreate</code>.
The IP address can change dynamically, and services can be removed
or unplugged at any time, so call this function immediately before
using any network service, and call it each time you use the service.</p>
<p>Sample code: <code>SamplemDNSClient.c</code></p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in OS X version 10.2.</p><a name="//apple_ref/c/func/MyDNSServiceBrowserReply_handler" title="MyDNSServiceBrowserReply_handler"></a><a name="//apple_ref/doc/c_ref/MyDNSServiceBrowserReply_handler" title="MyDNSServiceBrowserReply_handler"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-BBCFABIB" title="MyDNSServiceBrowserReply_handler"></a>
<a name="//apple_ref/doc/uid/TP30001129-CH206-DontLinkElementID_29"></a><h3 class="tight">MyDNSServiceBrowserReply_handler</h3>
<p class="spaceabove">Your application implements this callback function to
handle replies from <code>DNSServiceBrowserCreate</code>.
The reply is a <code>DNSServiceBrowserReply</code>.</p>

<p class="spaceabove"><pre>
<!--a-->static<!--/a--> void MyDNSServiceBrowserReply_handler(
<a href="reference_mach2.html#//apple_ref/doc/c_ref/DNSServiceBrowserReplyResultType">DNSServiceBrowserReplyResultType</a> resultType,
const char *replyName,
const char *replyType,
const char *replyDomain
<a href="reference_mach2.html#//apple_ref/doc/c_ref/DNSServiceDiscoveryReplyFlags">DNSServiceDiscoveryReplyFlags</a> flags,
void *context)
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>resultType</em></dt>
<dd><p>The <code>DNSServiceBrowserReplyResultType</code>.
Possible values are <code>DNSServiceBrowserReplyAddInstance </code>and<code> DNSServiceBrowserReplyRemoveInstance</code>.</p></dd>
<dt><em>replyName</em></dt>
<dd><p>The name of the service instance; <code>Sales
Printer</code> is an example.</p></dd>
<dt><em>replyType</em></dt>
<dd><p>The type of service; <code>_printer._tcp</code> is
an example.</p></dd>
<dt><em>replyDomain</em></dt>
<dd><p>The domain of the service; <code>local</code>.
is an example.</p></dd>
<dt><em>flags</em></dt>
<dd><p>Any error codes or flags. See <code>DNSServiceDiscoveryFlags</code> in <span class="content_text"><a href="reference_mach2.html#//apple_ref/doc/uid/TP30001129-CH1g-207632">“Constants and Data Types.”</a></span>
If there are multiple known services, the <code>kDNSServiceDiscoveryMoreRepliesImmediately</code> flag
will be set until you have received replies for all of them. Do
not update the user interface (list of services) while this flag
is set, but do not disable the user interface or change the cursor
while waiting for this flag to clear.</p></dd>
<dt><em>context</em></dt>
<dd><p>A user-specified context that will be passed
to the callback function.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>Not applicable.</p>
<h5 class="tight">Discussion</h5>
<p>This is a prototype for your callback function, to be passed
in to <code><a href="reference_mach.html#//apple_ref/doc/c_ref/DNSServiceBrowserCreate">DNSServiceBrowserCreate</a></code>. Your
callback function will be called once for every service instance
of the specified type found in the domain. It will be called again
if new instances are added to the domain or known instances are
removed. The sum of these replies is the current list of service instances.
Note that you receive individual records; your application is responsible
for building and maintaining a list.</p>
<p>This callback should remain active as long as your service
browser is running. That way the list of available services will
always be up to date.</p>
<p>Your callback is sent a <code>DNSServiceBrowserReply</code> record,
a structure containing the reply type (add or delete a service instance
from your list), instance name, service type, and domain, any flags
or errors, and a context that will be returned to the callback function.
A simple code sample follows.</p>
<div class="codesample"><table><tr><td scope="row"><pre>static void browse_reply(DNSServiceBrowserReplyResultType resultType,<span></span></pre></td></tr><tr><td scope="row"><pre>    const char *replyName,<span></span></pre></td></tr><tr><td scope="row"><pre>    const char *replyType,<span></span></pre></td></tr><tr><td scope="row"><pre>    const char *replyDomain<span></span></pre></td></tr><tr><td scope="row"><pre>    DNSServiceDiscoveryReplyFlags flags,<span></span></pre></td></tr><tr><td scope="row"><pre>    void *context)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>char *op =<span></span></pre></td></tr><tr><td scope="row"><pre>(resultType == DNSServiceBrowserReplyAddInstance) ? Found&quot; : &quot;Removed&quot;;<span></span></pre></td></tr><tr><td scope="row"><pre>printf(&quot;Service \&quot;%s\&quot;, type \&quot;%s\&quot;, domain \&quot;%s\&quot; %s&quot;, replyName, replyType,  replyDomain, op);<span></span></pre></td></tr><tr><td scope="row"><pre>if (flags) printf(&quot; Flags: %X&quot;, flags);<span></span></pre></td></tr><tr><td scope="row"><pre>printf(&quot;\n&quot;);<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div>
<p>Sample code: <code>SamplemDNSClient.c</code></p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in OS X version 10.2.</p><a name="//apple_ref/c/func/MyDNSServiceDomainEnumerationReply_handler" title="MyDNSServiceDomainEnumerationReply_handler"></a><a name="//apple_ref/doc/c_ref/MyDNSServiceDomainEnumerationReply_handler" title="MyDNSServiceDomainEnumerationReply_handler"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-BBCDJEEE" title="MyDNSServiceDomainEnumerationReply_handler"></a>
<a name="//apple_ref/doc/uid/TP30001129-CH206-DontLinkElementID_30"></a><h3 class="tight">MyDNSServiceDomainEnumerationReply_handler</h3>
<p class="spaceabove">Your application implements this callback function to
handle replies from <code>DNSServiceDomainEnumerationCreate</code>.
The reply is a <code>DNSServiceDomainEnumerationReply</code>.</p>
<p class="spaceabove"><pre>
<!--a-->static<!--/a--> void regdom_reply(
<!--a-->DNSServiceDomainEnumerationReplyResultType<!--/a--> resultType,
const char *replyDomain,
<a href="reference_mach2.html#//apple_ref/doc/c_ref/DNSServiceDiscoveryReplyFlags">DNSServiceDiscoveryReplyFlags</a> flags,
void *context)
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>resultType</em></dt>
<dd><p>The <code>DNSServiceDomainEnumerationReplyResultType</code>.
Possible values are <code>DNSServiceDomainEnumerationReplyAddDomain</code>, <code>DNSServiceDomainEnumerationReplyAddDomainDefault</code>,
or<code> DNSServiceDomainEnumerationReplyRemoveDomain</code>.</p></dd>
<dt><em>replyDomain</em></dt>
<dd><p>A domain in which to register or browse; <code>local</code>.
is an example.</p></dd>
<dt><em>flags</em></dt>
<dd><p>Any error codes or flags. See <code>DNSServiceDiscoveryFlags</code> in <span class="content_text"><a href="reference_mach2.html#//apple_ref/doc/uid/TP30001129-CH1g-207632">“Constants and Data Types.”</a></span>
If there are multiple recommended domains, the <code>kDNSServiceDiscoveryMoreRepliesImmediately</code> flag
will be set until you have received replies for all of them.</p></dd>
<dt><em>context</em></dt>
<dd><p>A user-specified context that will be passed
to the callback function.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>Not applicable.</p>
<h5 class="tight">Discussion</h5>
<p>This is a prototype for your callback function, to be passed
in to <code><a href="reference_mach.html#//apple_ref/doc/c_ref/DNSServiceDomainEnumerationCreate">DNSServiceDomainEnumerationCreate</a></code>.
Your callback function will be called once for every recommended
domain. It will be called again if domains are added or removed,
or if the default changes. The sum of these replies is the current
list of recommended domains.</p>
<p>Your callback is sent a <code>DNSServiceDomainEnumerationReply</code> record,
a struct containing the reply type (add or delete a domain from
your list), a domain name, any flags or errors, and a context that
will be returned to the callback function. A code sample follows.</p>
<div class="codesample"><table><tr><td scope="row"><pre>#define DomainMsg(X) (<span></span></pre></td></tr><tr><td scope="row"><pre>(X) == DNSServiceDomainEnumerationReplyAddDomain<span></span></pre></td></tr><tr><td scope="row"><pre>? &quot;Added&quot;               :        \<span></span></pre></td></tr><tr><td scope="row"><pre>(X) == DNSServiceDomainEnumerationReplyAddDomainDefault<span></span></pre></td></tr><tr><td scope="row"><pre>? &quot;(Default)&quot;               :        \<span></span></pre></td></tr><tr><td scope="row"><pre>(X) == DNSServiceDomainEnumerationReplyRemoveDomain<span></span></pre></td></tr><tr><td scope="row"><pre>? &quot;Removed&quot;             : &quot;Unknown&quot;)<span></span></pre></td></tr><tr><td scope="row"><pre>static void regdom_reply(<span></span></pre></td></tr><tr><td scope="row"><pre>    DNSServiceDomainEnumerationReplyResultType resultType,<span></span></pre></td></tr><tr><td scope="row"><pre>    const char *replyDomain,<span></span></pre></td></tr><tr><td scope="row"><pre>    DNSServiceDiscoveryReplyFlags flags,<span></span></pre></td></tr><tr><td scope="row"><pre>    void *context)<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>    printf(&quot;Recommended Registration or Browse Domain %s %s&quot;, replyDomain,  DomainMsg(resultType));<span></span></pre></td></tr><tr><td scope="row"><pre>    if (flags) printf(&quot; Flags: %X&quot;, flags);<span></span></pre></td></tr><tr><td scope="row"><pre>    printf(&quot;\n&quot;);<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr></table></div>
<p>Sample code: <code>SamplemDNSClient.c</code></p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in OS X version 10.2.</p><a name="//apple_ref/c/func/MyDNSServiceRegistrationReply_handler" title="MyDNSServiceRegistrationReply_handler"></a><a name="//apple_ref/doc/c_ref/MyDNSServiceRegistrationReply_handler" title="MyDNSServiceRegistrationReply_handler"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-BBCIAECE" title="MyDNSServiceRegistrationReply_handler"></a>
<a name="//apple_ref/doc/uid/TP30001129-CH206-DontLinkElementID_31"></a><h3 class="tight">MyDNSServiceRegistrationReply_handler</h3>
<p class="spaceabove">Your application implements this callback function to
handle replies from <code>DNSServiceRegistrationCreate</code>.
The reply is a <code>DNSServiceRegistrationReply</code>.</p>
<p class="spaceabove"><pre>
<!--a-->static<!--/a--> void reg_reply(
<!--a-->DNSServiceRegistrationReplyErrorType<!--/a--> errorCode,
void *context)
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>errorCode</em></dt>
<dd><p>Any error codes or flags. See <code>DNSServiceDiscoveryFlags</code> in <span class="content_text"><a href="reference_mach2.html#//apple_ref/doc/uid/TP30001129-CH1g-207632">“Constants and Data Types.”</a></span></p></dd>
<dt><em>context</em></dt>
<dd><p>A user-specified context that will be passed
to the callback function.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>Not applicable.</p>
<h5 class="tight">Discussion</h5>
<p>This is a prototype for your callback function, to be passed
in to <code><a href="reference_mach.html#//apple_ref/doc/c_ref/DNSServiceRegistrationCreate">DNSServiceRegistrationCreate</a></code>. </p>
<p>Your callback is sent a <code>DNSServiceRegistrationReply</code>,
consisting of either no flags, a message conflict flag, or an error
code. If your requested DNS name is already in use, choose another
name and re-register. For example, your default service name may
be in use by another copy of your service on the same network, such
as an identical printer. If your service has no user interface for
naming, it is good practice to append a number to your default name
and retry, incrementing the number as necessary to obtain a unique name.
A code sample for a service with a user interface follows.</p>
<div class="codesample"><table><tr><td scope="row"><pre>static void reg_reply(<span></span></pre></td></tr><tr><td scope="row"><pre>    DNSServiceRegistrationReplyErrorType errorCode,<span></span></pre></td></tr><tr><td scope="row"><pre>    void *context)<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>    printf(&quot;Got a reply from the server: &quot;);<span></span></pre></td></tr><tr><td scope="row"><pre>    switch (errorCode)<span></span></pre></td></tr><tr><td scope="row"><pre>        {<span></span></pre></td></tr><tr><td scope="row"><pre>        case kDNSServiceDiscoveryNoError:<span></span></pre></td></tr><tr><td scope="row"><pre>            printf(&quot;Name now registered and active\n&quot;); break;<span></span></pre></td></tr><tr><td scope="row"><pre>        case kDNSServiceDiscoveryNameConflict:<span></span></pre></td></tr><tr><td scope="row"><pre>            printf(&quot;Name in use, please choose another\n&quot;); exit(-1);<span></span></pre></td></tr><tr><td scope="row"><pre>        default:<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>            printf(&quot;Error %d\n&quot;, errorCode); return;<span></span></pre></td></tr></table></div>
<p>Sample code: <code>SamplemDNSClient.c</code></p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in OS X version 10.2.</p><a name="//apple_ref/c/func/MyDNSServiceResolverReply_handler" title="MyDNSServiceResolverReply_handler"></a><a name="//apple_ref/doc/c_ref/MyDNSServiceResolverReply_handler" title="MyDNSServiceResolverReply_handler"></a><a name="//apple_ref/doc/uid/TP30001129-CH206-BBCJEEJD" title="MyDNSServiceResolverReply_handler"></a>
<a name="//apple_ref/doc/uid/TP30001129-CH206-DontLinkElementID_32"></a><h3 class="tight">MyDNSServiceResolverReply_handler</h3>
<p class="spaceabove">Your application implements this callback function to
handle replies from <code>DNSServiceResolverResolve</code>.</p>

<p class="spaceabove"><pre>
<!--a-->static<!--/a--> void MyDNSServiceResolverReply_handler(struct
<!--a-->sockaddr<!--/a--> *interface,
struct <!--a-->sockaddr<!--/a--> *address,
   const char *txtRecord,
   <a href="reference_mach2.html#//apple_ref/doc/c_ref/DNSServiceDiscoveryReplyFlags">DNSServiceDiscoveryReplyFlags</a> flags,
   void *context)
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>interface</em></dt>
<dd><p>A <code>sockaddr</code> containing
the IP address of the host&#8217;s network interface. If the host is
connected to more than one local network, such as an ethernet LAN and
a wireless LAN, this identifies which network contains the service.</p></dd>
<dt><em>address</em></dt>
<dd><p>A <em>sockaddr</em> containing
the link-local IP address and port number of the service. </p></dd>
<dt><em>txtrecord</em></dt>
<dd><p>A character string containing any additional
information, such as a print queue name. If there is no additional
information, this is an empty string.</p></dd>
<dt><em>flags</em></dt>
<dd><p>Any error codes or flags. See <code>DNSServiceDiscoveryFlags</code> in <span class="content_text"><a href="reference_mach2.html#//apple_ref/doc/uid/TP30001129-CH1g-207632">“Constants and Data Types.”</a></span></p></dd>
<dt><em>context</em></dt>
<dd><p>A user-specified context that will be passed
to the callback function.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>Not applicable.</p>
<h5 class="tight">Discussion</h5>
<p>This is a prototype for your callback function, to be passed
in to <code><a href="reference_mach.html#//apple_ref/doc/c_ref/DNSServiceResolverResolve">DNSServiceResolverResolve</a></code>. Your
function will be called when the service address has been resolved.
Your callback will receive a <code>DNSServiceResolverReply</code> record.
This struct contains the host interface IP address, the service
IP address and port, an optional text record with any additional
demultiplexing information, any flags or errors, and a context that
will be returned to the callback function. </p>
<p>A code sample follows.</p>
<div class="codesample"><table><tr><td scope="row"><pre>static void resolve_reply(struct sockaddr *interface,<span></span></pre></td></tr><tr><td scope="row"><pre>    struct sockaddr *address,<span></span></pre></td></tr><tr><td scope="row"><pre>    const char *txtRecord,<span></span></pre></td></tr><tr><td scope="row"><pre>    DNSServiceDiscoveryReplyFlags flags,<span></span></pre></td></tr><tr><td scope="row"><pre>    void *context)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>if (address-&gt;sa_family (!= AF_INET)<span></span></pre></td></tr><tr><td scope="row"><pre>    printf(&quot;Unknown address family %d\n&quot;, address-&gt;sa_family);<span></span></pre></td></tr><tr><td scope="row"><pre>else<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>    struct sockaddr_in *ip = (struct sockaddr_in *)address;<span></span></pre></td></tr><tr><td scope="row"><pre>    union { uint32_t l; u_char b[4]; } addr = { ip-&gt;sin_addr.s_addr };<span></span></pre></td></tr><tr><td scope="row"><pre>    union { uint16_t s; u_char b[2]; } port = { ip-&gt;sin_port };<span></span></pre></td></tr><tr><td scope="row"><pre>    uint16_t PortAsNumber = ((uint16_t)port.b[0]) &lt;&lt; 8 | port.b[1];<span></span></pre></td></tr><tr><td scope="row"><pre>    const char *src = txtRecord;<span></span></pre></td></tr><tr><td scope="row"><pre>    printf(&quot;Service can be reached at %d.%d.%d.%d:%u&quot;, addr.b[0],<span></span></pre></td></tr><tr><td scope="row"><pre>                     addr.b[1], addr.b[2], addr.b[3], PortAsNumber);<span></span></pre></td></tr><tr><td scope="row"><pre>    while (*src)<span></span></pre></td></tr><tr><td scope="row"><pre>        {<span></span></pre></td></tr><tr><td scope="row"><pre>        char txtInfo[256];<span></span></pre></td></tr><tr><td scope="row"><pre>        char *dst = txtInfo;<span></span></pre></td></tr><tr><td scope="row"><pre>        const char *const lim = &amp;txtInfo[sizeof(txtInfo)];<span></span></pre></td></tr><tr><td scope="row"><pre>        while (*src &amp;&amp; *src != 1 &amp;&amp; dst &lt; lim-1) *dst++ = *src++;<span></span></pre></td></tr><tr><td scope="row"><pre>        *dst++ = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>        printf(&quot; TXT \&quot;%s\&quot;&quot;, txtInfo);<span></span></pre></td></tr><tr><td scope="row"><pre>        if (*src == 1) src++;<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>    if (flags) printf(&quot; Flags: %X&quot;, flags);<span></span></pre></td></tr><tr><td scope="row"><pre>    printf(&quot;\n&quot;);<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div>
<p>Sample code: <code>SamplemDNSClient.c</code></p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in OS X version 10.2.</p>







        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../tasks/tasks_mach.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="reference_mach2.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2001, 2005 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2005-04-29<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Networking/Conceptual/dns_discovery_mach/reference/reference_mach.html%3Fid%3DTP30001129-3.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Networking/Conceptual/dns_discovery_mach/reference/reference_mach.html%3Fid%3DTP30001129-3.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Networking/Conceptual/dns_discovery_mach/reference/reference_mach.html%3Fid%3DTP30001129-3.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>