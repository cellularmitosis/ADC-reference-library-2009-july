<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Text Manipulation(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING34></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-33.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-35.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-13.html"><B>Chapter 1 - Introduction to Text on the Macintosh</B></A> / <A HREF="Text-29.html"><B>How Script Systems Work</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING34-0></A>
<H2>Text Manipulation</H2>
 <A NAME=MARKER-2-18></A>The Macintosh Operating System and Macintosh script management system implement certain script features transparently. For example, your application may not need to know that its dialog boxes can accept Japanese text. However, if your application actually manipulates the text of any language--as any word processor certainly does--it needs access to text-handling information that varies from script system to script system.<P>
 For example, to perform word selection and line-breaking, your application may need routines to determine word boundaries in any language. To sort text, it may need routines that sort acording to language-specific rules, and possibly also routines that perform case conversion or strip diacritical marks according to language-specific rules. Do not assume that all languages or regions have the same rules or conventions; use Text Utilities and Script Manager routines to handle different conventions.<P>
 Note that the user can affect which of the available script-system resources are used to control text manipulation such as sorting, number formatting, and date and time formatting. See <A HREF=Text-39.html#MARKER-9-491>"User Control of Script Settings" beginning on page 1-107</A>.<P>
 This section discusses routines that perform a variety of script-aware text manipulations including sorting strings; formatting dates, times, and numbers; analyzing characters; searching and modifying text; and finding word boundaries and line breaks. Most of these topics are described more fully in the chapters "Text Utilities" and "Script Manager" in this book.<P>
<DL>
<DT><B>Note</B>
<DD>The script management system does not address all possible localizable text issues. There is other information, not covered in a script's international resources, that may vary from locale to locale--such as formats for addresses, postal zone codes, and telephone numbers. You should place all such information in resources for ease of localization.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
<A NAME=HEADING34-6></A>
<H3>Sorting Strings</H3>
 <A NAME=MARKER-2-432></A>Comparing strings can be an intricate operation that involves subtle issues. Even for English, determining the sorting order cannot be done by a simple table look-up or comparison of character-code values. Furthermore, sorting rules vary not just among script systems but among the individual languages or regions within a script system.<A NAME=MARKER-2-575></A><P>
 Every script system--and every language-specific variation of a script system--has information specifying how its text is to be sorted. That information is in the script's string-manipulation (<CODE>'itl2'</CODE>) resource. The Text Utilities provides routines for comparing two strings for sorting purposes. Some routines work with Pascal strings, others with generalized <A NAME=MARKER-2-575></A><B>text strings</B> (defined by pointer and length). Some are script-aware, some are not. The script-aware routines take into account the sorting rules of the current script system or any script system that you explicitly specify, and can address these sorting factors:<P>
<UL>
<LI>primary and secondary sorting order
<LI>expansion and contraction of characters
<LI>ignorable characters
<LI>case-conversion and stripping of diacritical marks<P>
</UL>
 Other special cases, such as expansion of abbreviations that requires dictionary lookup, may be beyond the capability of the script management system.<P>
 In sorting lists of strings that may be from more than one script system, keep these points in mind:<P>
<UL>
<LI>If you are sorting strings from different script systems into a single list, the ordering relationship among the scripts as well as the sorting rules within each script are important. The script-sorting (<CODE>'itlm'</CODE>) resource that is part of system software contains tables that define the sorting relationship among all defined script systems. Text Utilities functions use that information to help you create a sorted list of strings in more than one script system.
<LI>If you are sorting strings from different languages within a single script system, you may or may not want to sort the strings into groups by language. If you do, you can determine the ordering relationship between the languages from the the script-sorting resource. Text Utilities functions use that information to help you create a sorted list of strings in more than one language.
<LI>If you need to sort strings in exactly the same way that the Macintosh file system does, there are Text Utilities routines that perform that type of sorting. The sorting order is fixed, and it is independent of any script system or language. It should be used only for operations internal to your application, not for user display of sorted filenames or other text strings.
<LI>Uppercase characters and diacritical marks affect sorting and searching, and conventions for their handling vary among script systems and languages. Text Utilities routines allow you to sort according to the rules of each script or language, and to take into account or disregard case and diacritical marks.<A NAME=MARKER-2-234></A><P>
</UL>
<A NAME=HEADING34-19></A>
<H3>Formatting Dates, Times, Numbers, and Symbols</H3>
 Dates, times, numbers, and symbols are common types of specialized strings whose formats vary widely around the world. Each script system defines how its times, dates, numbers, and other symbols are to be defined and formatted in its numeric-format (<CODE>'itl0'</CODE>), long-date-format (<CODE>'itl1'</CODE>), and tokens (<CODE>'itl4'</CODE>) resources.<P>
<A NAME=HEADING34-21></A>
<H4>Dates and Times<A NAME=MARKER-2-332></A></H4>
 <A NAME=MARKER-2-96></A><A HREF=#MARKER-9-439>Figure 1-58</A> shows two different Finder displays of the same filenames and modification dates. The upper display uses Arabic date formats, Arabic month names (with theGregorian calendar), Arabic numerals, and a right-to-left primary line direction. The lower display is exactly the same, except with U.S. date formats, English month names, western numerals, and a left-to-right primary line direction. (The changes were made with control panel selections; see <A HREF=Text-39.html#MARKER-9-491>"User Control of Script Settings" beginning on page 1-107</A>.)<P>
<B>Figure 1-58  <A NAME=MARKER-9-439></A>Filenames and dates in Arabic and U.S. formats (Arabic system script)</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/IT_S-04.jpg">
 The Text Utilities include a number of routines for converting and formatting date and time strings on the Macintosh. These routines allow you to specify each element of the date and time formats, including the number of digits used for each numeric element (for example, 3/01/90 or 3/1/90), the names of the months and the days of the week, and other characteristics such as the order of the elements and the use of a.m. and p.m. instead of a 24-hour clock.<P>
 Be careful about abbreviating the names of the weekdays (for instance, in English <I>S, M, T, W, Th, F,</I> and <I>S</I>). In Hebrew, for example, the names all begin with the same character, so the English convention would not be useful. Use instead the Text Utilities routines that give you the abbreviated versions provided by each script system.<P>
 <A NAME=MARKER-2-215></A>Multiple calendars may be available on some Macintosh systems. The time-formatting and date-formatting routines in the Text Utilities are generalized enough that they can handle other calendar systems. The Gregorian calendar is the standard Macintosh calendar that is used in most of the world, but other calendars are also supported. See the description of the long-date-format resource in the appendix "International Resources" in this book for a list of defined calendar types.<A NAME=MARKER-2-386></A><P>
<A NAME=HEADING34-28></A>
<H4>Numbers and Symbols</H4>
 <A NAME=MARKER-2-387></A>Western numerals (<I>1, 2, 3,</I> and so forth) are not universal, and the decimal separator is not always the period. The formats of numbers vary widely. The Japanese writing system, for instance, uses the standard ASCII Western digits, 2-byte encodings of the same Western digits, and 2-byte Japanese number characters in two forms.<A NAME=MARKER-9-331></A><P>
 To accommodate differences in number and currency formats around the world, the Text Utilities provide routines that separate the presentation of numeric values from their internal representation. They allow a script system or your application to define separately how positive numbers, negative numbers, and zero values are presented. They allow you to specify what separators, digits, text annotations, marks (such as + ), and literals (such as brackets or parentheses) can appear in numbers, and what kinds of padding can be used. In addition, they allow you to define how to represent positive and negative exponents for scientific notation. Each script system's numeric-format (<CODE>'itl0'</CODE>) and tokens (<CODE>'itl4'</CODE>) resources contain information used for formatting numbers.<P>
 Currency formats include the specification of the currency symbol (for example, $, , or DM) and whether it precedes or follows the value. Each script system's numeric-format resource specifies formats for currency.<P>
 Use the regional forms of symbols such as the bullet (center dot, ). Tokens that allow you to define these symbols in a language-independent fashion are found in each script system's international resources; use the Script Manager to gain access to those tokens.<P>
<DL>
<DT><B>Note</B>
<DD><A NAME=MARKER-2-45></A>Units of measure should be appropriate for the region you are targeting. For example, <I>lines per inch</I> is meaningless in the metric world. Units of measurement can be specified as metric or imperial (inches and miles). Each script system's numeric-format resource indicates the preferred measurement unit. You can use the Operating System Utilities function <CODE>IsMetric</CODE> to determine the appropriate unit of measure for the current script system. See <I><A HREF="../OSUtilities/OSUtilities-2.html">Inside Macintosh: OSUtilities</A></I>.<A NAME=MARKER-2-233></A>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
<A NAME=HEADING34-34></A>
<H3>Analyzing Characters</H3>
 <A NAME=MARKER-2-273></A>Analyzing characters is another common type of text-manipulation task. The Script Manager provides functions that let you analyze the size and type of individual characters. For example, with script systems that use 2-byte characters, you may need to determine what part of a character a single byte represents. In either 1-byte or 2-byte systems, you may need to know what type of character a particular character code represents. Character-type information is contained in a script system's string-manipulation (<CODE>'itl2'</CODE>) or encoding/rendering (<CODE>'itl5'</CODE>) resource.<A NAME=MARKER-9-103></A><P>
 For example, when searching for a single 1-byte character in text that may contain 2-byte characters, it is important not to mistake part of a 2-byte character for the character you are seeking. You can also determine whether a particular character is a letter, number, or punctuation mark, or whether or not it is uppercase. This information can be useful, for example, to filter input into specialized text fields. Also, for example, because several uppercase letters in the Cyrillic and Roman script systems are identical in appearance, you can detect an unwanted mixture of Cyrillic and Roman characters.<P>
 The Text Utilities provide a function that locates sequences of Roman characters (or characters of any other subscript) within non-Roman text. Use this routine when you want to separate out Roman characters into their own style runs, so that they can be formatted independently of the surrounding non-Roman text.<A NAME=MARKER-9-217></A><P>
<A NAME=HEADING34-38></A>
<H3>Searching, Modifying, and Converting Text</H3>
 <A NAME=MARKER-9-376></A>The Text Utilities provide several script-aware routines that you can use to modify the contents of strings or convert text from one form to another. You can use these routines on strings of any script system; the script-specific information they need is in the script's string-manipulation (<CODE>'itl2'</CODE>), tokens (<CODE>'itl4'</CODE>), encoding/rendering (<CODE>'itl5'</CODE>), or transliteration (<CODE>'trsl'</CODE>) resource.<P>
 For modifying strings, there are routines to<P>
<UL>
<LI>convert case and strip diacritical marks from characters (such as for sorting)
<LI>truncate a string to make it fit into a specified area on the screen
<LI>search for a character sequence in a string and replace it with a different sequence (accounting for both 1-byte and 2-byte characters)<P>
</UL>
 When searching, note that the text of some script systems can have accents or other diacritical marks that are considered optional. In Hebrew, for example, you may want to give the user the option to have search procedures ignore vowel and cantillation marks, because they are infrequently used in everyday writing. Note, however, that your application would have to provide this capability on its own; the Text Utilities stripping routines do not strip vowel or cantillation marks.<P>
 Different script systems have their own rules for dictionaries and hyphenation references. In searching text, your routines must be able to ignore text from script systems other than those to which the dictionaries and hyphenation references apply. As usual, it is your application's responsibility to track the script system of the text you manipulate; the script management system does not.<P>
 If you need to truncate a string, use the regional form of the ellipsis to indicate the truncation; different symbols may be expected in different languages. The Script Manager and the Text Utilities have routines that help you truncate strings and insert the proper symbol for an ellipsis.<A NAME=MARKER-2-112></A><P>
 <A NAME=MARKER-2-57></A><I>Macintosh Human Interface Guidelines</I> has guidelines for implementing intelligent cut-and-paste in your application. If the user cuts an entire word and pastes it in another location or document, you should make sure that the pasted word has proper word delimiters at its new location, and that extra word delimiters are not left at the location it was cut from. Applying intelligent cut-and-paste across all script systems requires complete understanding of word delimiters for each one. The Macintosh script management system does not provide support for this. However, the guidelines presented in <I>Macintosh Human Interface Guidelines</I> can work for any script system that uses spaces as word delimiters, and each script system sets a flag that you can access to determine whether it uses spaces. See the descriptions of script-variable selectors in the chapter "Script Manager" in this book.<P>
 <A NAME=MARKER-2-452></A>Compilers, assemblers, and scripting-language interpreters usually parse sequences of characters to <B>tokens,</B> abstract entities that stand for variables, symbols, and quoted literals. Each script system provides tokenizing information in its tokens resource, for use by the Script Manager. Using the Script Manager you can create tokens recognizable by a parser in any script system.<P>
 <A NAME=MARKER-9-51></A>The Script Manager also provides support for <B>transliteration,</B> the automatic conversion of text from one phonetic form or subscript to another within a single script system. In the Roman script system, this simply means case conversion. In Japanese, Chinese, and Korean script systems, it means the phonetic conversion of characters from one subscript to another. Script-specific information for transliteration is in a script's string-manipulation or transliteration resource. With the Script Manager you can convert, for example, from Hiragana to Romaji and Romaji to Katakana in Japanese; from Bopomofo to Roman in Chinese; and from Roman to Jamo, Jamo to Hangul, Hangul to Jamo, and Jamo to Roman in Korean.<A NAME=MARKER-2-405></A>  <A NAME=MARKER-2-455></A><P>
<A NAME=HEADING34-50></A>
<H3>Finding Word Boundaries and Line Breaks<A NAME=MARKER-2-456></A></H3>
 <A NAME=MARKER-2-963></A>Finding word boundaries for word-selection and for line-breaking is a common, though often difficult, text-manipulation task. Word-selection methods differ among script systems. For example, the Thai script does not use spaces between words; the Thai system must detect word boundaries by parsing. The Text Utilities provide a procedure that you can use to determine word boundaries, in order to support double-clicking, highlighting of search targets, and so on. You can also use the same procedure to find word boundaries for line breaking; see <A HREF=Text-32.html#MARKER-9-351>"Text Layout" on page 1-71</A>. The procedure works for all script systems and uses information in the script's string-manipulation (<CODE>'itl2'</CODE>) resource. <A NAME=MARKER-2-92></A>   <A NAME=MARKER-2-317></A>   <A NAME=MARKER-2-339></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-33.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-35.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
