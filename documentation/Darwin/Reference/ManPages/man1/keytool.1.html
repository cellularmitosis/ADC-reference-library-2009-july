<html><head><title>Mac OS X Developer Tools
 Manual Page For keytool(1)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/1/keytool" title="Mac OS X Developer Tools
 Manual Page for keytool(1)"><!-- headerDoc=man; indexgroup=Section 1; uid="//apple_ref/doc/man/1/keytool"; name=keytool(1) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac&nbsp;OS&nbsp;X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>

<p style='text-align:justify;'>This manual page is associated with the Mac&nbsp;OS&nbsp;X
developer tools.  The software or headers described may not be present on your
Mac&nbsp;OS&nbsp;X installation until you install the developer tools
package.  This package is available on your Mac&nbsp;OS&nbsp;X installation DVD,
and the latest versions can be downloaded from
<a href="http://developer.apple.com/tools/download/">developer.apple.com</a>.</p>

<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
keytool(1)                                                                                        keytool(1)



<b>NAME</b>
       keytool - key and certificate management tool

<b>SYNOPSIS</b>
       <b>keytool</b> [ <u>commands</u> ]

<b>DESCRIPTION</b>
       <b>keytool</b>  is  a  key and certificate management utility. It enables users to administer their own pub-<font color="#ffffff" class="whiteout">lic/private&nbsp;public/private</font>
       lic/private key pairs and associated certificates for use  in  self-authentication  (where  the  user
       authenticates himself/herself to other users/services) or data integrity and authentication services,
       using digital signatures. It also allows users to cache the public keys (in the form of certificates)
       of their communicating peers.

       A certificate is a digitally signed statement from one entity (person, company, and so forth), saying
       that the public key (and some other information) of some other entity has a particular  value.   (See
       Certificates.)  When  data  is  digitally  signed,  the  signature  can be verified to check the data
       integrity and authenticity.  Integrity means that the data has not been modified  or  tampered  with,
       and authenticity means the data indeed comes from whoever claims to have created and signed it.

       <b>keytool</b>  stores  the  keys  and  certificates  in a so-called keystore.  The <b>keytool</b> default keystore
       implementation implements the keystore as a file. It protects private keys with a password.

       The <a href="jarsigner.1.html#//apple_ref/doc/man/1/jarsigner"><b>jarsigner</b>(1)</a> tool uses information from a keystore to generate or verify digital  signatures  for
       Java ARchive (JAR) files. (A JAR file packages class files, images, sounds, and/or other digital data
       in a single file).  <a href="jarsigner.1.html#//apple_ref/doc/man/1/jarsigner"><b>jarsigner</b>(1)</a> verifies the digital signature of a JAR file, using the  certificate
       that  comes  with  it  (it  is included in the signature block file of the JAR file), and then checks
       whether or not the public key of that certificate is "trusted", that is, is contained in  the  speci-<font color="#ffffff" class="whiteout">fied&nbsp;specified</font>
       fied keystore.

       Please  note:  the <b>keytool</b> and <a href="jarsigner.1.html#//apple_ref/doc/man/1/jarsigner"><b>jarsigner</b>(1)</a> tools completely replace the javakey tool provided in JDK
       1.1. These new tools provide more features than javakey, including the ability to  protect  the  key-<font color="#ffffff" class="whiteout">store&nbsp;keystore</font>
       store and private keys with passwords, and the ability to verify signatures in addition to generating
       them. The new keystore architecture replaces the identity database that javakey created and  managed.
       It  is possible to import the information from an identity database into a keystore, via the <b>-identi</b>-<font color="#ffffff" class="whiteout">tydb&nbsp;-identitydb</font>
       <b>tydb</b> subcommand.

   <b>Keystore</b> <b>Entries</b>
       There are two different types of entries in a keystore:

       1.   key entries--each holds very sensitive cryptographic key information, which is stored in a  pro-<font color="#ffffff" class="whiteout">tected&nbsp;protected</font>
            tected  format to prevent unauthorized access.  Typically, a key stored in this type of entry is
            a secret key, or a private key accompanied by the certificate "chain" for the corresponding pub-<font color="#ffffff" class="whiteout">lic&nbsp;public</font>
            lic  key. The <b>keytool</b> and <a href="jarsigner.1.html#//apple_ref/doc/man/1/jarsigner"><b>jarsigner</b>(1)</a> tools only handle the latter type of entry, that is, pri-<font color="#ffffff" class="whiteout">vate&nbsp;private</font>
            vate keys and their associated certificate chains.

       2.   trusted certificate entries--each contains a single public key certificate belonging to  another
            party.  It  is  called a "trusted certificate" because the keystore owner trusts that the public
            key in the certificate indeed belongs to the identity identified by the "subject" (owner) of the
            certificate. The issuer of the certificate vouches for this, by signing the certificate.

   <b>Keystore</b> <b>Aliases</b>
       All  keystore  entries (key and trusted certificate entries) are accessed via unique aliases. Aliases
       are case-insensitive; the aliases Hugo and hugo would refer to the same keystore entry.

       An alias is specified when you add an entity to the keystore using the <b>-genkey</b> subcommand to generate
       a  key  pair  (public  and private key) or the <b>-import</b> subcommand to add a certificate or certificate
       chain to the list of trusted certificates. Subsequent <b>keytool</b> commands must use this  same  alias  to
       refer to the entity.

       For  example,  suppose  you use the alias duke to generate a new public/private key pair and wrap the
       public key into a self-signed certificate (see Certificate Chains) via the following command:

       <b>keytool</b> <b>-genkey</b> <b>-alias</b> <b>duke</b> <b>-keypass</b> <b>dukekeypasswd</b>

       This specifies an inital password of <b>dukekeypasswd</b> required by subsequent commands to access the pri-<font color="#ffffff" class="whiteout">vate&nbsp;private</font>
       vate key assocated with the alias <b>duke</b>.  If you later want to change <b>duke</b>'s private key password, you
       use a command like the following:

       <b>keytool</b> <b>-keypasswd</b> <b>-alias</b> <b>duke</b> <b>-keypass\</b>
                  <b>dukekeypasswd</b> <b>-new</b> <b>newpass</b>

       This changes the password from "dukekeypasswd" to "newpass".

       Please note: A password should not actually be specified on a command line or in a script  unless  it
       is  for  testing  purposes,  or  you are on a secure system. If you don't specify a required password
       option on a command line, you will be prompted for it.  When typing in a  password  at  the  password
       prompt,  the  password is currently echoed (displayed exactly as typed), so be careful not to type it
       in front of anyone.

   <b>Keystore</b> <b>Location</b>
       Each <b>keytool</b> command has a <b>-keystore</b> option for specifying the name and location  of  the  persistent
       keystore file for the keystore managed by <b>keytool</b>.  The keystore is by default stored in a file named
       <b>.keystore</b> in the user's home directory, as determined by the "user.home" system property.

       Note that the input stream from the -keystore option is passed to the KeyStore.load method.  If  NONE
       is  specified  as  the  URL, then a null stream is passed to the KeyStore.load method. NONE should be
       specified if the KeyStore is not file-based, for example, if it resides on a hardware token device.

   <b>Keystore</b> <b>Creation</b>
       A keystore is created whenever you use a <b>-genkey</b>, <b>-import</b>, or <b>-identitydb</b> subcommand to add data to a
       keystore that doesn't yet exist.

       More  specifically,  if you specify, in the <b>-keystore</b> option, a keystore that doesn't yet exist, that
       keystore will be created.

       If you don't specify a <b>-keystore</b> option, the default keystore is a file named <b>.keystore</b> in your  home
       directory.  If that file does not yet exist, it will be created.

   <b>Keystore</b> <b>Implementation</b>
       The  <b>KeyStore</b>  class provided in the java.security package supplies well-defined interfaces to access
       and modify the information in a keystore.  It is possible for there to be multiple different concrete
       implementations, where each implementation is that for a particular type of keystore.

       Currently,  there  are  two  command-line  tools (<b>keytool</b> and <a href="jarsigner.1.html#//apple_ref/doc/man/1/jarsigner"><b>jarsigner</b>(1)</a>) and also a GUI-based tool
       named <b>policytool</b>.  Since <b>KeyStore</b> is publicly available, JDK  users  can  write  additional  security
       applications that use it.

       There is a built-in default implementation, provided by Sun Microsystems.  It implements the keystore
       as a file, utilizing a proprietary keystore type (format) named "JKS".  It protects each private  key
       with its individual password, and also protects the integrity of the entire keystore with a (possibly
       different) password.

       Keystore implementations are provider-based.  More specifically, the application interfaces  supplied
       by  <b>KeyStore</b>  are  implemented in terms of a "Service Provider Interface" (SPI).  That is, there is a
       corresponding abstract <b>KeystoreSpi</b> class, also in the java.security package, which defines  the  Ser-<font color="#ffffff" class="whiteout">vice&nbsp;Service</font>
       vice  Provider  Interface  methods that "providers" must implement.  (The term "provider" refers to a
       package or a set of packages that supply a concrete implementation of a subset of services  that  can
       be  accessed  by  the  Java  Security API.)  Thus, to provide a keystore implementation, clients must
       implement a "provider" and supply a <b>KeystoreSpi</b> subclass  implementation,  as  described  in  How  to
       Implement a Provider for the Java Cryptography Architecture.

       Applications  can  choose different types of keystore implementations from different providers, using
       the "getInstance" factory method supplied in the <b>KeyStore</b> class. A keystore type defines the  storage
       and  data  format of the keystore information, and the algorithms used to protect private keys in the
       keystore and the integrity of the keystore itself. Keystore implementations of  different  types  are
       not compatible.

       <b>keytool</b>  works  on  any  file-based keystore implementation.  (It treats the keytore location that is
       passed to it at the command line as a filename and converts it to a FileInputStream,  from  which  it
       loads the keystore information.) The <a href="jarsigner.1.html#//apple_ref/doc/man/1/jarsigner"><b>jarsigner</b>(1)</a> and policytool tools, on the other hand, can read a
       keystore from any location that can be specified using a URL.

       For <b>keytool</b> and <a href="jarsigner.1.html#//apple_ref/doc/man/1/jarsigner"><b>jarsigner</b>(1)</a>, you can specify a keystore type at the command line, via the <b>-storetype</b>
       option.   For  <b>Policy</b>  <b>Tool</b>, you can specify a keystore type via the "Change Keystore" command in the
       Edit menu.

       If you don't explicitly specify a keystore type, the tools choose  a  keystore  implementation  based
       simply  on  the  value  of the keystore.type property specified in the security properties file.  The
       security properties file is called <b>java.security</b>, and it  resides  in  the  JDK  security  properties
       directory, <b>java.home/lib/security</b>, where java.home is the JDK installation directory.

       Each  tool gets the keystore.type value and then examines all the currently-installed providers until
       it finds one that implements keystores of that type. It then uses the  keystore  implementation  from
       that provider.

       The  <b>KeyStore</b>  class  defines a static method named getDefaultType that lets applications and applets
       retrieve the value of the <b>keystore.type</b> property. The following line of code creates an  instance  of
       the default keystore type (as specified in the <b>keystore.type</b> property):

       <b>KeyStore</b> <b>keyStore</b> <b>=</b> <b>KeyStore.getInstance(KeyStore.getDefaultType());</b>

       The  default  keystore type is "jks" (the proprietary type of the keystore implementation provided by
       Sun). This is specified by the following line in the security properties file:

       <b>keystore.type=jks</b>

       To have the tools utilize a keystore implementation other than the default, you can change that  line
       to specify a different keystore type.

       For  example,  if  you have a provider package that supplies a keystore implementation for a keystore
       type called "pkcs12", change the line to

       <b>keystore.type=pkcs12</b>

       Note: case doesn't matter in keystore type designations.  For example, "JKS" would be considered  the
       same as "jks".

   <b>Supported</b> <b>Algorithms</b> <b>and</b> <b>Key</b> <b>Sizes</b>
       <b>keytool</b>  allows  users  to specify any key pair generation and signature algorithm supplied by any of
       the registered cryptographic service providers. That is, the <b>-keyalg</b> and <b>-sigalg</b> options for  various
       subcommands must be supported by a provider implementation. The default key pair generation algorithm
       is "DSA". The signature algorithm is derived from the algorithm of the underlying private key: If the
       underlying private key is of type "DSA", the default signature algorithm is "SHA1withDSA", and if the
       underlying private key is of type "RSA", the default signature algorithm is "MD5withRSA".

       When generating a DSA key pair, the key size must be in the range from 512 to 1024 bits, and must  be
       a multiple of 64. The default key size for any algorithm is 1024 bits.

   <b>Certificates</b>
       A  certificate  (also  known  as  a  public-key certificate) is a digitally signed statement from one
       entity (the issuer), saying that the public key (and some other information) of another  entity  (the
       subject) has some

       Let us expand on some of the key terms used in this sentence:

       <b>Public</b> <b>Keys</b>         These  are  numbers  associated  with a particular entity, and are intended to be
                           known to everyone who needs to have trusted interactions with that entity. Public
                           keys are used to verify signatures.

       <b>Digitally</b> <b>Signed</b>    If  some  data  is  digitally signed it has been stored with the "identity" of an
                           entity, and a signature that proves that entity knows about the data. The data is
                           rendered unforgeable by signing with the entity's private key.

       <b>Identity</b>            A  known  way of addressing an entity. In some systems the identity is the public
                           key, in others it can be anything from a Unix UID to an Email address to an X.509
                           Distinguished Name.

       <b>Signature</b>           A  signature  is  computed over some data using the private key of an entity (the
                           signer, which in the case of a certificate is also known as the issuer).

       <b>Private</b> <b>Keys</b>        These are numbers, each of which is supposed to be known only to  the  particular
                           entity  whose  private key it is (that is, it's supposed to be kept secret). Pri-<font color="#ffffff" class="whiteout">vate&nbsp;Private</font>
                           vate and public keys exist in pairs in all public key cryptography systems  (also
                           referred  to as "public key crypto systems"). In a typical public key crypto sys-<font color="#ffffff" class="whiteout">tem,&nbsp;system,</font>
                           tem, such as DSA, a private key corresponds to exactly one  public  key.  Private
                           keys are used to compute signatures.

       <b>Entity</b>              An  entity is a person, organization, program, computer, business, bank, or some-<font color="#ffffff" class="whiteout">thing&nbsp;something</font>
                           thing else you are trusting to some degree.

       Basically, public key cryptography requires access to users' public keys. In a large-scale  networked
       environment  it  is  impossible  to guarantee that prior relationships between communicating entities
       have been established or that a trusted repository exists with all  used  public  keys.  Certificates
       were  invented  as  a solution to this public key distribution problem. Now a Certification Authority
       (CA) can act as a trusted third party. CAs are entities (for example, businesses) that are trusted to
       sign (issue) certificates for other entities. It is assumed that CAs will only create valid and reli-<font color="#ffffff" class="whiteout">able&nbsp;reliable</font>
       able certificates, as they are bound by legal agreements. There are many public Certification Author-<font color="#ffffff" class="whiteout">ities,&nbsp;Authorities,</font>
       ities,  such as VeriSign, Thawte, Entrust, and so on. You can also run your own Certification Author-<font color="#ffffff" class="whiteout">ity&nbsp;Authority</font>
       ity using products such as the Netscape/Microsoft Certificate Servers or the Entrust CA  product  for
       your organization.

       Using  <b>keytool</b>,  it  is  possible to display, import, and export certificates. It is also possible to
       generate self-signed certificates.

       <b>keytool</b> currently handles X.509 certificates.

   <b>X.509</b> <b>Certificates</b>
       The X.509 standard defines what information can go into a certificate, and describes how to write  it
       down (the data format). All X.509 certificates have the following data, in addition to the signature:

       Version        This identifies which version of the X.509 standard applies to this certificate, which
                      affects what information can be specified in it. Thus far, three versions are defined.
                      <b>keytool</b> can import and export v1, v2, and v3 certificates. It  generates  v1  certifi-<font color="#ffffff" class="whiteout">cates.&nbsp;certificates.</font>
                      cates.

       Serial Number  The  entity that created the certificate is responsible for assigning it a serial num-<font color="#ffffff" class="whiteout">ber&nbsp;number</font>
                      ber to distinguish it from other certificates it issues. This information is  used  in
                      numerous  ways,  for example when a certificate is revoked its serial number is placed
                      in a Certificate Revocation List (CRL).

       Signature Algorithm Identifier
                      This identifies the algorithm used by the CA to sign the certificate.

       Issuer Name    The X.500 Distinguished Name of the entity that signed the certificate. This  is  nor-<font color="#ffffff" class="whiteout">mally&nbsp;normally</font>
                      mally  a  CA. Using this certificate implies trusting the entity that signed this cer-<font color="#ffffff" class="whiteout">tificate.&nbsp;certificate.</font>
                      tificate. (Note that in some cases, such as root or  top-level  CA  certificates,  the
                      issuer signs its own certificate.)

       Validity Period
                      Each  certificate is valid only for a limited amount of time. This period is described
                      by a start date and time and an end date and time, and can be as short as a  few  sec-<font color="#ffffff" class="whiteout">onds&nbsp;seconds</font>
                      onds or almost as long as a century. The validity period chosen depends on a number of
                      factors, such as the strength of the private key used to sign the certificate  or  the
                      amount one is willing to pay for a certificate. This is the expected period that enti-<font color="#ffffff" class="whiteout">ties&nbsp;entities</font>
                      ties can rely on the public value, if the associated private key has not been  compro-<font color="#ffffff" class="whiteout">mised.&nbsp;compromised.</font>
                      mised.

       Subject Name   The name of the entity whose public key the certificate identifies. This name uses the
                      X.500 standard, so it is intended to be unique across the Internet. This is the  X.500
                      Distinguished Name (DN) of the entity, for example,

       <b>CN=Java</b> <b>Duke,</b> <b>OU=Java</b> <b>Software</b> <b>Division,</b> <b>O=Sun</b> <b>Microsystems</b> <b>Inc,</b> <b>C=US</b>

       (These refer to the subject's Common Name, Organizational Unit, Organization, and Country.)

       Subject Public Key Information
                      This  is  the public key of the entity being named, together with an algorithm identi-<font color="#ffffff" class="whiteout">fier&nbsp;identifier</font>
                      fier which specifies which public key crypto system this key belongs to and any  asso-<font color="#ffffff" class="whiteout">ciated&nbsp;associated</font>
                      ciated key parameters.

       <u>X.509</u> <u>Version</u> <u>1</u> has been available since 1988, is widely deployed, and is the most generic.

       <u>X.509</u>  <u>Version</u> <u>2</u> introduced the concept of subject and issuer unique identifiers to handle the possi-<font color="#ffffff" class="whiteout">bility&nbsp;possibility</font>
       bility of reuse of subject and/or issuer names over time. Most certificate profile documents strongly
       recommend  that names not be reused, and that certificates should not make use of unique identifiers.
       Version 2 certificates are not widely used.

       <u>X.509</u> <u>Version</u> <u>3</u> is the most recent (1996) and supports the notion of extensions, whereby  anyone  can
       define  an  extension  and  include  it  in the certificate. Some common extensions in use today are:
       KeyUsage (limits the use of the keys to particular purposes such as "signing-only") and  Alternative-<font color="#ffffff" class="whiteout">Names&nbsp;AlternativeNames</font>
       Names  (allows  other  identities to also be associated with this public key, for example, DNS names,
       Email addresses, IP addresses). Extensions can be marked critical  to  indicate  that  the  extension
       should  be checked and enforced/used. For example, if a certificate has the KeyUsage extension marked
       critical and set to "keyCertSign" then if this certificate is presented during SSL communication,  it
       should  be  rejected,  as  the certificate extension indicates that the associated private key should
       only be used for signing certificates and not for SSL use.

       All the data in a certificate is encoded using two related standards called ASN.1/DER.  <u>Abstract</u> <u>Syn</u>-<font color="#ffffff" class="whiteout">tax&nbsp;Syntax</font>
       <u>tax</u>  <u>Notation</u> <u>1</u> describes data. The Definite Encoding Rules describe a single way to store and trans-<font color="#ffffff" class="whiteout">fer&nbsp;transfer</font>
       fer that data.

   <b>X.500</b> <b>Distinguished</b> <b>Names</b>
       X.500 Distinguished Names are used to identify entities, such as those which are named by the subject
       and issuer (signer) fields of X.509 certificates.  <b>keytool</b> supports the following subparts:

        commonName--common name of a person, for example, "Susan Jones"

        organizationUnit--small organization (for example, department or division) name, such as, "Purchas-<font color="#ffffff" class="whiteout">ing"&nbsp;"Purchasing"</font>
         ing"

        organizationName--large organization
         name, for example, "ABCSystems, Inc."

        localityName--locality (city) name, for example, "Palo Alto"

        stateName--state or province name, for example, "California"

        country--two-letter country code, for example, "CH"

       When supplying a distinguished name string as the value of a <b>-dname</b> option, as  for  the  <b>-genkey</b>  or
       <b>-selfcert</b> subcommands, the string must be in the following format:

       <b>CN=cName,</b> <b>OU=orgUnit,</b> <b>O=org,</b> <b>L=city,</b> <b>S=state,</b> <b>C=countryCode</b>

       where  all  the italicized items represent actual values and the above keywords are abbreviations for
       the following:

       <b>CN=commonName</b>
       <b>OU=organizationUnit</b>
       <b>O=organizationName</b>
       <b>L=localityName</b>
       <b>S=stateName</b>
       <b>C=country</b>

       A sample distinguished name string is

       <b>CN=Mark</b> <b>Smith,</b> <b>OU=Java,</b> <b>O=Sun,</b> <b>L=Cupertino,</b> <b>S=California,</b> <b>C=US</b>

       and a sample command using such a string is

       <b>keytool</b> <b>-genkey</b> <b>-dname</b> <b>"CN=Mark</b> <b>Smith,</b> <b>OU=Java,</b>
       <b>O=Sun,</b> <b>L=Cupertino,</b> <b>S=California,</b> <b>C=US"</b> <b>-alias</b> <b>mark</b>

       Case does not matter for the keyword abbreviations. For example, <b>CN</b>, <b>cn</b>, and <b>Cn</b>
        are all treated the same.

       Order matters; each subcomponent must appear in the designated order. However, it is not necessary to
       have all the subcomponents. You may use a subset, for example:

       <b>CN=Steve</b> <b>Meier,</b> <b>OU=SunSoft,</b> <b>O=Sun,</b> <b>C=US</b>

       If a distinguished name string value contains a comma, it must be escaped by a "\" character when you
       specify the string on a command line, as in

       <b>cn=peter</b> <b>schuster,</b> <b>o=Sun</b> <b>Microsystems\,</b> <b>Inc.,</b> <b>o=sun,</b> <b>c=us</b>

       It is never necessary to specify a distinguished name string on a command line.  If it is needed  for
       a  command, but not supplied on the command line, the user is prompted for each of the subcomponents.
       In this case, a comma does not need to be escaped by a "\"

   <b>The</b> <b>Internet</b> <b>RFC</b> <b>1421</b> <b>Certificate</b> <b>Encoding</b> <b>Standard</b>
       Certificates are often stored using the printable encoding format defined by the  Internet  RFC  1421
       standard,  instead  of  their binary encoding. This certificate format, also known as "Base 64 encod-<font color="#ffffff" class="whiteout">ing",&nbsp;encoding",</font>
       ing", facilitates exporting certificates to other applications by email or through some other  mecha-<font color="#ffffff" class="whiteout">nism.&nbsp;mechanism.</font>
       nism.

       Certificates  read  by  the <b>-import</b> and <b>-printcert</b> subcommands can be in either this format or binary
       encoded.

       The <b>-export</b> subcommand by default outputs a certificate in binary encoding, but will instead output a
       certificate in the printable encoding format, if the <b>-rfc</b> option is specified.

       The  <b>-list</b>  subcommand  by  default  prints the MD5 fingerprint of a certificate. If the <b>-v</b> option is
       specified, the certificate is printed in human-readable format, while if the <b>-rfc</b>  option  is  speci-<font color="#ffffff" class="whiteout">fied,&nbsp;specified,</font>
       fied, the certificate is output in the printable encoding format.

       In its printable encoding format, the encoded certificate is bounded at the beginning by

       <b>-----BEGIN</b> <b>CERTIFICATE----</b>-<font color="#ffffff" class="whiteout">and&nbsp;CERTIFICATE----and</font>

       and at the end by

       <b>-----END</b> <b>CERTIFICATE----</b>-<font color="#ffffff" class="whiteout">Certificate&nbsp;CERTIFICATE----Certificate</font>

   <b>Certificate</b> <b>Chains</b>
       <b>keytool</b>  can  create and manage keystore "key" entries that each contain a private key and an associ-<font color="#ffffff" class="whiteout">ated&nbsp;associated</font>
       ated certificate "chain". The first certificate in the chain contains the public key corresponding to
       the private key.

       When  keys are first generated (see the <b>-genkey</b> subcommand), the chain starts off containing a single
       element, a self-signed certificate. A self-signed certificate is one for which the issuer (signer) is
       the  same  as  the  subject  (the entity whose public key is being authenticated by the certificate).
       Whenever the <b>-genkey</b> subcommand is called to generate a new public/private key pair,  it  also  wraps
       the public key into a self-signed certificate.

       Later, after a Certificate Signing Request (CSR) has been generated (see the <b>-certreq</b> subcommand) and
       sent to a Certification Authority (CA), the response from the CA is imported (see <b>-import</b>),  and  the
       self-signed  certificate  is  replaced  by a chain of certificates. At the bottom of the chain is the
       certificate (reply) issued by the CA authenticating the subject's public key. The next certificate in
       the chain is one that authenticates the CA's public key.

       In  many  cases, this is a self-signed certificate (that is, a certificate from the CA authenticating
       its own public key) and the last certificate in the chain. In other cases, the CA may return a  chain
       of  certificates. In this case, the bottom certificate in the chain is the same (a certificate signed
       by the CA, authenticating the public key of the key entry), but the second certificate in  the  chain
       is  a  certificate signed by a different CA, authenticating the public key of the CA you sent the CSR
       to. Then, the next certificate in the chain will be a certificate authenticating the second CA's key,
       and  so  on,  until a self-signed "root" certificate is reached. Each certificate in the chain (after
       the first) thus authenticates the public key of the signer of the previous certificate in the  chain.

       Many  CAs  only  return  the issued certificate, with no supporting chain, especially when there is a
       flat hierarchy (no intermediates CAs). In this case, the certificate chain must be  established  from
       trusted certificate information already stored in the keystore.

       A  different  reply  format (defined by the PKCS#7 standard) also includes the supporting certificate
       chain, in addition to the issued certificate. Both reply formats can be handled by <b>keytool</b>.

       The top-level (root) CA certificate is self-signed. However, the trust into  the  root's  public  key
       does not come from the root certificate itself (anybody could generate a self-signed certificate with
       the distinguished name of say, the VeriSign root CA!), but from other sources like a  newspaper.  The
       root  CA public key is widely known. The only reason it is stored in a certificate is because this is
       the format understood by most tools, so the certificate in this case is only used as a  "vehicle"  to
       transport  the  root  CA's  public  key. Before you add the root CA certificate to your keystore, you
       should view it (using the -printcert option) and compare the displayed  fingerprint  with  the  well-<font color="#ffffff" class="whiteout">known&nbsp;wellknown</font>
       known fingerprint (obtained from a newspaper, the root CA's webpage, and so forth).

   <b>Importing</b> <b>Certificates</b>
       To import a certificate from a file, use the <b>-import</b> subcommand, as in

       <b>keytool</b> <b>-import</b> <b>-alias</b> <b>joe</b> <b>-file</b> <b>jcertfile.cer</b>

       This  sample  command  imports the <!-- a -->certificate(s)<!-- /a --> in the file <u>jcertfile.cer</u> and stores it in the key-<font color="#ffffff" class="whiteout">store&nbsp;keystore</font>
       store entry identified by the alias <b>joe</b>.

       You import a certificate for two reasons:

       1.   to add it to the list of trusted certificates, or

       2.   to import a certificate reply received from a CA as the result of submitting a Certificate Sign-<font color="#ffffff" class="whiteout">ing&nbsp;Signing</font>
            ing Request (see the <b>-certreq</b> subcommand) to that CA.

       Which type of import is intended is indicated by the value of the <b>-alias</b> option.


        If the alias points to a key entry,
         then  keytool assumes you are importing a certificate reply.  keytool checks whether the public key
         in the certificate reply matches the public key stored with the alias, and exits if they  are  dif-<font color="#ffffff" class="whiteout">ferent.&nbsp;different.</font>
         ferent.


        If the alias does not point to a key entry,
         then keytool assumes you are adding a trusted certificate entry. In this case, the alias should not
         already exist in the keystore. If the alias does already exist,  then  keytool  outputs  an  error,
         since  there  is already a trusted certificate for that alias, and does not import the certificate.
         If the alias does not exist in the keystore, keytool creates a trusted certificate entry  with  the
         specified alias and associates it with the imported certificate.

       <b>WARNING</b> <b>Regarding</b> <b>Importing</b> <b>Trusted</b> <b>Certificates</b>

       IMPORTANT:  Be  sure  to check a certificate very carefully before importing it as a trusted certifi-<font color="#ffffff" class="whiteout">cate!&nbsp;certificate!</font>
       cate!

       View it first (using the <b>-printcert</b> subcommand, or  the  <b>-import</b>  subcommand  without  the  <b>-noprompt</b>
       option),  and  make  sure  that the displayed certificate <!-- a -->fingerprint(s)<!-- /a --> match the expected ones. For
       example, suppose someone sends or emails  you  a  certificate,  and  you  put  it  in  a  file  named
       <b>/tmp/cert</b>.<b>Before</b>you  consider  adding  the  certificate to your list of trusted certificates, you can
       execute a <b>-printcert</b> subcommand to view its fingerprints, as in

       <b>keytool</b> <b>-printcert</b> <b>-file</b> <b>/tmp/cert</b>
       <b>Owner:</b> <b>CN=ll,</b> <b>OU=ll,</b> <b>O=ll,</b> <b>L=ll,</b> <b>S=ll,</b> <b>C=ll</b>
       <b>Issuer:</b> <b>CN=ll,</b> <b>OU=ll,</b> <b>O=ll,</b> <b>L=ll,</b> <b>S=ll,</b> <b>C=ll</b>
       <b>Serial</b> <b>Number:</b> <b>59092b34</b>
       <b>Valid</b> <b>from:</b> <b>Thu</b> <b>Sep</b> <b>25</b> <b>18:01:13</b> <b>PDT</b> <b>1997</b> <b>until:</b> <b>Wed</b> <b>Dec</b> <b>24</b> <b>17:01:13</b> <b>PST</b> <b>1997</b>
       <b>Certificate</b> <b>Fingerprints:</b>
       <b>MD5:</b>  <b>11:81:AD:92:C8:E5:0E:A2:01:2E:D4:7A:D7:5F:07:6F</b>
       <b>SHA1:</b> <b>20:B6:17:FA:EF:E5:55:8A:D0:71:1F:E8:D6:9D:C0:37:13:0E:5E:FE</b>

       Then call or otherwise contact the person who sent the certificate, and  compare  the  <!-- a -->fingerprint(s)<!-- /a -->
       that  you see with the ones that they show.  Only if the fingerprints are equal is it guaranteed that
       the certificate has not been replaced in transit with somebody else's (for  example,  an  attacker's)
       certificate.  If such an attack took place, and you did not check the certificate before you imported
       it, you would end up trusting anything the attacker has signed (for example, a JAR  file  with  mali-<font color="#ffffff" class="whiteout">cious&nbsp;malicious</font>
       cious class files inside).

       Note:  it  is not required that you execute a <b>-printcert</b> subcommand prior to importing a certificate,
       since before adding a certificate to the list of trusted certificates in the  keystore,  the  <b>-import</b>
       subcommand  prints  out  the  certificate information and prompts you to verify it. You then have the
       option of aborting the import operation. Note, however, this is only  the  case  if  you  invoke  the
       <b>-import</b> subcommand without the <b>-noprompt</b> option. If the <b>-noprompt</b> option is given, there is no inter-<font color="#ffffff" class="whiteout">action&nbsp;interaction</font>
       action with the user.

   <b>Exporting</b> <b>Certificates</b>
       To export a certificate to a file, use the <b>-export</b> subcommand, as in

       <b>keytool</b> <b>-export</b> <b>-alias</b> <b>jane</b> <b>-file</b> <b>janecertfile.cer</b>

       This sample command exports jane's certificate to the file <u>janecertfile.cer</u>.  That is, if <b>jane</b> is the
       alias  for a key entry, the command exports the certificate at the bottom of the certificate chain in
       that keystore entry. This is the certificate that authenticates jane's public key.

       If, instead, <b>jane</b> is the alias for a trusted certificate entry,  then  that  trusted  certificate  is
       exported.

   <b>Displaying</b> <b>Certificates</b>
       To print out the contents of a keystore entry, use the <b>-list</b> subcommand, as in

       <b>keytool</b> <b>-list</b> <b>-alias</b> <b>joe</b>

       If you don't specify an alias, as in

       <b>keytool</b> <b>-list</b>

       the contents of the entire keystore are printed.

       To display the contents of a certificate stored in a file, use the <b>-printcert</b> subcommand, as in

       <b>keytool</b> <b>-printcert</b> <b>-file</b> <b>certfile.cer</b>

       This displays information about the certificate stored in the file <u>certfile.cer</u>.

       Note: This works independently of a keystore, that is, you do not need a keystore in order to display
       a certificate that's stored in a file.

   <b>Generating</b> <b>a</b> <b>Self-signed</b> <b>Certificate</b>
       A self-signed certificate is one for which the issuer (signer) is the same as the subject (the entity
       whose  public  key  is  being  authenticated  by the certificate). Whenever the <b>-genkey</b> subcommand is
       called to generate a new public/private key pair, it also wraps the public  key  into  a  self-signed
       certificate.

       You may occasionally wish to generate a new self-signed certificate. For example, you may want to use
       the same key pair under a different identity (distinguished name). For example,  suppose  you  change
       departments. You can then:

       1.   copy (clone) the original key entry. See <b>-keyclone</b>.

       2.   generate  a new self-signed certificate for the cloned entry, using your new distinguished name.
            See below.

       3.   generate a Certificate Signing Requests for the cloned entry, and import the  reply  certificate
            or certificate chain.  See the <b>-certreq</b> and <b>-import</b> subcommand.

       4.   delete the original (now obsolete) entry.  See <b>-delete</b>.

       To generate a self-signed certificate, use the <b>-selfcert</b> subcommand, as in

       <b>keytool</b> <b>-selfcert</b> <b>-alias</b> <b>dukeNew</b> <b>-keypass</b> <b>b92kqmp</b>
       <b>-dname</b> <b>"cn=Duke</b> <b>Smith,</b> <b>ou=Purchasing,</b> <b>o=BlueSoft,</b> <b>c=US"</b>

       The generated certificate is stored as a single-element certificate chain in the keystore entry iden-<font color="#ffffff" class="whiteout">tified&nbsp;identified</font>
       tified by the specified alias (in this case <b>dukeNew</b>)  where  it  replaces  the  existing  certificate
       chain.

<b>COMMAND</b> <b>AND</b> <b>OPTION</b> <b>NOTES</b>
       The various subcommands and their options are listed and described below.  Note:

        All subcommand and option names are preceded by a minus sign (-).

        The options for each subcommand may be provided in any order.


        All items not italicized or in braces or square brackets are required to appear as is.

        Braces  surrounding  an option generally signify that a default value will be used if the option is
         not specified on the command line. Braces are also used around the <b>-v</b>, <b>-rfc</b>, and <b>-J</b> options,  which
         only have meaning if they appear on the command line (that is, they don't have any "default" values
         other than not existing).

        Brackets surrounding an option signify that the user is prompted for the <!-- a -->value(s)<!-- /a --> if the option  is
         not  specified on the command line. (For a <b>-keypass</b> option, if you do not specify the option on the
         command line, <b>keytool</b> will first attempt to use the keystore password to recover the  private  key,
         and if this fails, will then prompt you for the private key password.)

        Items  in  italics  (option values) represent the actual values that must be supplied. For example,
         here is the format of the <b>-printcert</b> subcommand:

       <b>keytool</b> <b>-printcert</b> <b>{-file</b> <b>cert_file}</b> <b>{-v}</b>

       When specifying a <b>-printcert</b> subcommand, replace <u>cert</u><b>_</b><u>file</u> with the actual file name, as in:

       <b>keytool</b> <b>-printcert</b> <b>-file</b> <b>VScert.cer</b>


        Option values must be quoted if they contain a blank (space).


        The <b>-help</b> subcommand is the default. Thus, the command line

       <b>keytool</b>

       is equivalent to

       <b>keytool</b> <b>-help</b>

   <b>Option</b> <b>Defaults</b>
       Below are the defaults for various option values.

       <b>-alias</b> <b>"mykey"</b>
       <b>-keyalg</b> <b>"DSA"</b>
       <b>-keysize</b> <b>1024</b>
       <b>-validity</b> <b>90</b>
       <b>-keystore</b> <b>the</b> <b>file</b> <b>named</b> <b>.keystore</b> <b>in</b> <b>the</b> <b>user's</b> <b>home</b> <b>directory</b>
       <b>-file</b> <b>stdin</b> <b>if</b> <b>reading,</b> <b>stdout</b> <b>if</b> <b>writing</b>

       The signature algorithm ( <b>-sigalg</b> option) is derived from the algorithm  of  the  underlying  private
       key:  If  the  underlying  private  key  is  of type "DSA", the <b>-sigalg</b> private key is of type "RSA",
       <b>-sigalg</b> defaults to "MD5withRSA".

   <b>Options</b> <b>that</b> <b>Appear</b> <b>for</b> <b>Most</b> <b>Subcommands</b>
       The <b>-v</b> option can appear for all subcommands except <b>-help</b>.  If it  appears,  it  signifies  "verbose"
       mode; detailed certificate information will be output.

       There is also a <b>-J</b><u>javaoption</u> option that may appear for any subcommand.  If it appears, the specified
       <u>-javaoption</u> string is passed through directly to the Java interpreter.  (<b>keytool</b> is actually a "wrap-<font color="#ffffff" class="whiteout">per"&nbsp;"wrapper"</font>
       per" around the interpreter.)  This option should not contain any spaces.  It is useful for adjusting
       the execution environment or memory usage.  For a list of possible interpreter options, type <b>java</b>  <b>-h</b>
       or <b>java</b> <b>-X</b> at the command line.

       These options may appear for all commands operating on a keystore:

       <b>-storetype</b> <u>storetype</u>
              This qualifier specifies the type of keystore to be instantiated. The default keystore type is
              the one that is specified as the value of the "keystore.type" property in the security proper-<font color="#ffffff" class="whiteout">ties&nbsp;properties</font>
              ties file, which is returned by the static <b>getDefaultType</b> method in <b>java.security.KeyStore</b>.

       <b>-keystore</b> <u>keystore</u>
              The  keystore  (database  file)  location.   Defaults to the file <b>.keystore</b> in the user's home
              directory, as determined by the <b>user.home</b> system property.

       <b>-storepass</b> <u>storepass</u>
              The password which is used to protect the integrity of the keystore.

       <u>storepass</u> must be at least 6 characters long.  It must be provided to all subcommands that access the
       keystore contents.  For such subcommands, if a <b>-storepass</b> option is not provided at the command line,
       the user is prompted for it.

       When retrieving information from the keystore, the password is optional; if no password is given, the
       integrity of the retrieved information cannot be checked and a warning is displayed.

       Be careful with passwords - see Warning Regarding Passwords.

       <b>-provider</b> <u>provider</u><b>_</b><u>class</u><b>_</b><u>name</u>
              Used  to  specify  the name of the cryptographic service provider's master class file when the
              service provider is not listed in the security properties file.

   <b>Warning</b> <b>Regarding</b> <b>Passwords</b>
       Most commands operating on a keystore require the store password. Some commands require a private key
       password.

       Passwords  can  be  specified  on  the  command line (in the <b>-storepass</b> and <b>-keypass</b> options, respec-<font color="#ffffff" class="whiteout">tively).&nbsp;respectively).</font>
       tively).  However, a password should not be specified on a command line or in a script unless  it  is
       for testing purposes, or you are on a secure system.

       If you don't specify a required password option on a command line, you will be prompted for it.  When
       typing in a password at the password prompt, the password is currently echoed (displayed  exactly  as
       typed), so be careful not to type it in front of anyone.

   <b>COMMANDS</b>
       See also <b>COMMAND</b> <b>AND</b> <b>OPTION</b> <b>NOTES</b>.

   <b>Adding</b> <b>Data</b> <b>to</b> <b>the</b> <b>Keystore</b>
       <b>-genkey</b> <b>{-alias</b> <u>alias</u><b>}</b> <b>{-keyalg</b> <u>keyalg</u><b>}</b> <b>{-keysize</b> <u>keysize}</u>
                   <b>{-sigalg</b> <u>sigalg</u><b>}</b> <b>[-dname</b> <u>dname</u><b>]</b> <b>[-keypass</b> <u>keypass</u><b>]</b>
                   <b>{-validity</b> <u>valDays</u><b>}</b> <b>{-storetype</b> <u>storetype</u><b>}</b>
                   <b>{-keystore</b> <u>keystore</u><b>}</b> <b>[-storepass</b> <u>storepass</u><b>]</b>
                   <b>[-provider</b> <u>provider</u><b>_</b><u>class</u><b>_</b><u>name</u><b>]</b> <b>{-v}</b>
                   <b>{-J</b><u>javaoption</u><b>}</b>

              Generates  a  key pair (a public key and associated private key). Wraps the public key into an
              X.509 v1 self-signed certificate, which is stored as a single-element certificate chain.  This
              certificate  chain and the private key are stored in a new keystore entry identified by <u>alias</u>.

              keyalg specifies the algorithm to be used to generate the key pair, and <u>keysize</u> specifies  the
              size  of each key to be generated.  <u>sigalg</u> specifies the algorithm that should be used to sign
              the self-signed certificate; this algorithm must be  compatible  with  keyalg.  See  Supported
              Algorithms and Key Sizes.

              <u>dname</u>  specifies  the X.500 Distinguished Name to be associated with <u>alias</u>, and is used as the
              issuer and subject fields in the self-signed certificate.  If no distinguished  name  is  pro-<font color="#ffffff" class="whiteout">vided&nbsp;provided</font>
              vided at the command line, the user will be prompted for one.

              <u>keypass</u>  is  a password used to protect the private key of the generated key pair. If no pass-<font color="#ffffff" class="whiteout">word&nbsp;password</font>
              word is provided, the user is prompted for it. If you press RETURN  at  the  prompt,  the  key
              password  is set to the same password as that used for the keystore.  <u>keypass</u> must be at least
              6 characters long. Be careful with passwords: See <b>Warning</b> <b>Regarding</b> <b>Passwords</b>.

              <u>valDays</u> tells the number of days for which the certificate should be considered valid.

       <b>-import</b> <b>{-alias</b> <u>alias</u><b>}</b> <b>{-file</b> <u>cert</u><b>_</b><u>file</u><b>}</b> <b>[-keypass</b> <u>keypass</u><b>]</b>
                   <b>{-noprompt}</b> <b>{-trustcacerts}</b> <b>{-storetype</b> <u>storetype</u><b>}</b>
                   <b>{-keystore</b> <u>keystore</u><b>}</b> <b>[-storepass</b> <u>storepass</u><b>]</b>
                   <b>[-provider</b> <u>provider</u><b>_</b><u>class</u><b>_</b><u>name</u><b>]</b>
                   <b>{-v}</b> <b>{-J</b><u>javaoption</u><b>}</b>

              Reads the certificate or certificate chain (where the latter is supplied in a PKCS#7 formatted
              reply) from the file <u>cert</u><b>_</b><u>file</u>, and stores it in the keystore entry identified by <u>alias</u> given,
              the certificate or PKCS#7 reply is read from stdin.

              <b>keytool</b> can import X.509 v1, v2, and v3 certificates, and PKCS#7 formatted certificate  chains
              consisting  of  certificates  of that type. The data to be imported must be provided either in
              binary encoding format, or in printable encoding format (also known  as  Base64  encoding)  as
              defined by the Internet RFC 1421 standard. In the latter case, the encoding must be bounded at
              the beginning by a string that starts with "-----BEGIN", and bounded at the end  by  a  string
              that starts with "-----END".

              You import a certification for two reasons:

              1. to add it to the list of trusted certificates, or

              2.  to import a certificate reply received from a CA as the result of submitting a Certificate
              Signing Request (see the -certreq command) to that CA.

<b>Importing</b> <b>a</b> <b>New</b> <b>Trusted</b> <b>Certificate</b>
       When importing a new trusted certificate, <u>alias</u> must not yet exist in the keystore. Before adding the
       certificate  to  the keystore, <b>keytool</b> tries to verify it by attempting to construct a chain of trust
       from that certificate to a self-signed certificate (belonging to a root CA), using  trusted  certifi-<font color="#ffffff" class="whiteout">cates&nbsp;certificates</font>
       cates that are already available in the keystore.

       If  the <b>-trustcacerts</b> option has been specified, additional certificates are considered for the chain
       of trust, namely the certificates in a file named <b>cacerts</b>.

       If keytool fails to establish a trust path from the certificate to be imported up  to  a  self-signed
       certificate  (either from the keystore or the "cacerts" file), the certificate information is printed
       out, and the user is prompted to verify it, e.g., by comparing the displayed certificate fingerprints
       with  the  fingerprints  obtained from some other (trusted) source of information, which might be the
       certificate owner himself/herself. Be very careful to  ensure  the  certificate  is  valid  prior  to
       importing it as a "trusted" certificate! -- see WARNING Regarding Importing Trusted Certificates. The
       user then has the option of aborting the import operation.  If the -noprompt option  is  given,  how-<font color="#ffffff" class="whiteout">ever,&nbsp;however,</font>
       ever, there will be no interaction with the user.

<b>Importing</b> <b>a</b> <b>Certificate</b> <b>Reply</b>
       When  importing  a  certificate  reply, the certificate reply is validated using trusted certificates
       from the keystore, and optionally using the certificates configured in the <b>cacerts</b> keystore file  (if
       the <b>-trustcacerts</b> option was specified).

       The methods of determining whether the certificate reply is trusted are described in the following:

       If  the reply is a single X.509 certificate, <b>keytool</b> attempts to establish a trust chain, starting at
       the certificate reply and ending at a self-signed certificate (belonging to a root CA). The  certifi-<font color="#ffffff" class="whiteout">cate&nbsp;certificate</font>
       cate  reply and the hierarchy of certificates used to authenticate the certificate reply form the new
       certificate chain of <u>alias</u>.

       If the reply is a PKCS#7 formatted certificate chain, the chain is first ordered (with the user  cer-<font color="#ffffff" class="whiteout">tificate&nbsp;certificate</font>
       tificate  first  and  the self-signed root CA certificate last), before <b>keytool</b> attempts to match the
       root CA certificate provided in the reply with any of the trusted certificates in the keystore or the
       <b>cacerts</b>  keystore  file  (if  the  <b>-trustcacerts</b> option was specified). If no match can be found, the
       information of the root CA certificate is printed out, and the user is prompted  to  verify  it,  for
       example, by comparing the displayed certificate fingerprints with the fingerprints obtained from some
       other (trusted) source of information, which might be the root CA  itself.  The  user  then  has  the
       option  of aborting the import operation. If the -noprompt option is given, however, there will be no
       interaction with the user.

       The new certificate chain of <u>alias</u> replaces the old certificate chain associated with this entry. The
       old  chain  can  only be replaced if a valid keypass, the password used to protect the private key of
       the entry, is supplied. If no password is provided, and the private key password  is  different  from
       the keystore password, the user is prompted for it.  Be careful with passwords: See <b>Warning</b> <b>Regarding</b>
       <b>Passwords</b>.

<b>The</b> <b>cacerts</b> <b>Certificates</b> <b>File</b>
       A certificates file named "cacerts" resides in the security properties directory, java.home/lib/secu-<font color="#ffffff" class="whiteout">rity,&nbsp;java.home/lib/security,</font>
       rity,  where  java.home  is  the runtime environment's directory (the jre directory in the SDK or the
       top-level directory of the Java 2 Runtime Environment).

       The "cacerts" file represents a system-wide keystore with CA certificates. System administrators  can
       configure  and  manage that file using keytool, specifying "jks" as the keystore type.  The "cacerts"
       keystore file ships with several root CA certificates with the following aliases and X.500 owner dis-<font color="#ffffff" class="whiteout">tinguished&nbsp;distinguished</font>
       tinguished names:

            Alias:  thawtepersonalfreemailca  Owner DN: EmailAddress=personal-freemail@thawte.com, CN=Thawte
            Personal Freemail CA, OU=Certification Services  Division,  O=Thawte  Consulting,  L=Cape  Town,
            ST=Western Cape, C=ZA

            Alias:  thawtepersonalbasicca  Owner  DN: EmailAddress=personal-basic@thawte.com, CN=Thawte Per-<font color="#ffffff" class="whiteout">sonal&nbsp;Personal</font>
            sonal Basic CA, OU=Certification Services Division, O=Thawte Consulting, L=Cape Town, ST=Western
            Cape, C=ZA

            Alias:  thawtepersonalpremiumca  Owner  DN:  EmailAddress=personal-premium@thawte.com, CN=Thawte
            Personal Premium CA, OU=Certification  Services  Division,  O=Thawte  Consulting,  L=Cape  Town,
            ST=Western Cape, C=ZA

            Alias:  thawteserverca  Owner  DN:  EmailAddress=server-certs@thawte.com,  CN=Thawte  Server CA,
            OU=Certification Services Division, O=Thawte Consulting cc, L=Cape Town, ST=Western Cape, C=ZA

            Alias: thawtepremiumserverca Owner DN: EmailAddress=premium-server@thawte.com, CN=Thawte Premium
            Server  CA,  OU=Certification Services Division, O=Thawte Consulting cc, L=Cape Town, ST=Western
            Cape, C=ZA

            Alias:  verisignclass1ca  Owner  DN:  OU=Class  1  Public   Primary   Certification   Authority,
            O="VeriSign, Inc.", C=US

            Alias:   verisignclass2ca   Owner   DN:  OU=Class  2  Public  Primary  Certification  Authority,
            O="VeriSign, Inc.", C=US

            Alias:  verisignclass3ca  Owner  DN:  OU=Class  3  Public   Primary   Certification   Authority,
            O="VeriSign, Inc.", C=US

            Alias:   verisignclass4ca   Owner   DN:  OU=Class  4  Public  Primary  Certification  Authority,
            O="VeriSign, Inc.", C=US

            Alias: verisignserverca Owner DN: OU=Secure Server Certification Authority,  O="RSA  Data  Secu-<font color="#ffffff" class="whiteout">rity,&nbsp;Security,</font>
            rity, Inc.", C=US

            Alias:   baltimorecodesigningca   Owner   DN:   CN=Baltimore   CyberTrust   Code  Signing  Root,
            OU=CyberTrust, O=Baltimore, C=IE

            Alias: gtecybertrustca Owner DN: CN=GTE CyberTrust Root, O=GTE Corporation, C=US

            Alias: gtecybertrust5ca Owner DN: CN=GTE CyberTrust Root 5, OU="GTE CyberTrust Solutions, Inc.",
            O=GTE Corporation, C=US

       The  initial  password  of  the  "cacerts" keystore file is "changeit".  System administrators should
       change that password and the default access permission of that file upon installing the SDK.

       IMPORTANT: Verify Your cacerts File Since you trust the CAs in the cacerts file as entities for sign-<font color="#ffffff" class="whiteout">ing&nbsp;signing</font>
       ing  and issuing certificates to other entities, you must manage the cacerts file carefully. The cac-<font color="#ffffff" class="whiteout">erts&nbsp;cacerts</font>
       erts file should contain only certificates of the CAs you trust. It is your responsibility to  verify
       the  trusted  root  CA certificates bundled in the cacerts file and make your own trust decisions. To
       remove an untrusted CA certificate from the cacerts file, use the delete option of the  keytool  com-<font color="#ffffff" class="whiteout">mand.&nbsp;command.</font>
       mand.  You  can  find  the You can find the  cacerts file in the JRE installation directory.  Contact
       your system administrator if you do not have permission to edit this file.

       <b>-selfcert</b> <b>{-alias</b> <u>alias</u><b>}</b> <b>{-sigalg</b> <u>sigalg</u><b>}</b> <b>{-dname</b> <u>dname</u><b>}</b>
                   <b>{-validity</b> <u>valDays</u><b>}</b> <b>[-keypass</b> <u>keypass</u><b>]</b>
                   <b>{-storetype</b> <u>storetype</u><b>}</b> <b>{-keystore</b> <u>keystore</u><b>}</b>
                   <b>[-storepass</b> <u>storepass</u><b>]</b>
                   <b>[-provider</b> <u>provider</u><b>_</b><u>class</u><b>_</b><u>name</u><b>]</b>
                   <b>{-v}</b> <b>{-J</b><u>javaoption</u><b>}</b>

              Generates an X.509 v1 self-signed certificate, using keystore information including  the  pri-<font color="#ffffff" class="whiteout">vate&nbsp;private</font>
              vate  key  and public key associated with <u>alias</u>.  If <u>dname</u> is supplied at the command line, it
              is used as the X.500 Distinguished Name for both the issuer and subject  of  the  certificate.
              Otherwise,  the  X.500 Distinguished Name associated with <u>alias</u> (at the bottom of its existing
              certificate chain) is used.

              The generated certificate is stored as a single-element  certificate  chain  in  the  keystore
              entry identified by <u>alias</u>, where it replaces the existing certificate chain.

              <u>sigalg</u>  specifies  the  algorithm  that  should be used to sign the certificate. See Supported
              Algorithms and Key Sizes.

              In order to access the private key, the appropriate password must be provided,  since  private
              keys  are protected in the keystore with a password. If <u>keypass</u> is not provided at the command
              line, and is different from the password used to protect the integrity of  the  keystore,  the
              user is prompted for it.  Be careful with passwords: See <b>Warning</b> <b>Regarding</b> <b>Passwords</b>.

              <u>valDays</u> tells the number of days for which the certificate should be considered valid.

       <b>-identitydb</b> <b>{-file</b> <u>idb</u><b>_</b><u>file</u><b>}</b> <b>{-storetype</b> <u>storetype</u><b>}</b>
                   <b>{-keystore</b> <u>keystore</u><b>}</b> <b>[-storepass</b> <u>storepass</u><b>]</b>
                   <b>[-provider</b> <u>provider</u><b>_</b><u>class</u><b>_</b><u>name</u><b>]</b>
                   <b>{-v}</b> <b>{-J</b><u>javaoption</u><b>}</b>

              Reads  the  JDK  1.1.x-style identity database from the file <u>idb</u><b>_</b><u>file</u>, and adds its entries to
              the keystore. If no file is given, the identity database is read from  stdin.  If  a  keystore
              does not exist, it is created.

              Only  identity database entries ("identities") that were marked as trusted will be imported in
              the keystore. All other identities will be ignored. For  each  trusted  identity,  a  keystore
              entry will be created. The identity's name is used as the <u>alias</u> for the keystore entry.

              The  private  keys  from  trusted  identities  will  all be encrypted under the same password,
              storepass.  This is the same password that is used to protect the keystore's integrity.  Users
              can  later  assign  individual passwords to those private keys by using the <b>-keypasswd</b> <b>keytool</b>
              command option.

              An identity in an identity database may hold more than one certificate,  each  certifying  the
              same  public key. But a keystore key entry for a private key has that private key and a single
              "certificate chain" (initially just a single certificate), where the first certificate in  the
              chain contains the public key corresponding to the private key. When importing the information
              from an identity, only the first certificate of the identity is stored in the  keystore.  This
              is because an identity's name in an identity database is used as the <u>alias</u> for its correspond-<font color="#ffffff" class="whiteout">ing&nbsp;corresponding</font>
              ing keystore entry, and <u>alias</u> names are unique within a keystore,

   <b>Exporting</b> <b>Data</b>
       <b>-certreq</b> <b>{-alias</b> <u>alias</u><b>}</b> <b>{-sigalg</b> <u>sigalg</u><b>}</b> <b>{-file</b> <u>certreq</u><b>_</b><u>file</u><b>}</b>
                   <b>[-keypass</b> <u>keypass</u><b>]</b>
                   <b>{-storetype</b> <u>storetype</u><b>}</b> <b>{-keystore</b> <u>keystore</u><b>}</b>
                   <b>[-storepass</b> <u>storepass</u><b>]</b>
                   <b>[-provider</b> <u>provider</u><b>_</b><u>class</u><b>_</b><u>name</u><b>]</b>
                   <b>{-v}</b> <b>{-J</b><u>javaoption</u><b>}</b>

              Generates a Certificate Signing Request (CSR), using the PKCS#10 format.

              A CSR is intended to be sent to a certificate authority (CA). The  CA  will  authenticate  the
              certificate  requestor  (usually off-line) and will return a certificate or certificate chain,
              used to replace the existing certificate chain (which initially consists of a self-signed cer-<font color="#ffffff" class="whiteout">tificate)&nbsp;certificate)</font>
              tificate) in the keystore.

              The  private  key  and  X.500  Distinguished Name associated with <u>alias</u> are used to create the
              PKCS#10 certificate request. In order to access the private key, the appropriate password must
              be  provided,  since private keys are protected in the keystore with a password. If <u>keypass</u> is
              not provided at the command line, and is different from  the  password  used  to  protect  the
              integrity of the keystore, the user is prompted for it.

              Be careful with passwords: See <b>Warning</b> <b>Regarding</b> <b>Passwords</b>.

              <u>sigalg</u>  specifies  the algorithm that should be used to sign the CSR. See Supported Algorithms
              and Key Sizes.

              The CSR is stored in the file <u>certreq</u><b>_</b><u>file</u>.  If no file is given, the CSR is output to stdout.

              Use the import command to import the response from the CA.

       <b>-export</b> <b>{-alias</b> <u>alias</u><b>}</b> <b>{-file</b> <u>cert</u><b>_</b><u>file</u><b>}</b> <b>{-storetype</b> <u>storetype</u><b>}</b>
                   <b>{-keystore</b> <u>keystore</u><b>}</b> <b>[-storepass</b> <u>storepass</u><b>]</b>
                   <b>[-provider</b> <u>provider</u><b>_</b><u>class</u><b>_</b><u>name</u><b>]</b>
                   <b>{-rfc}</b> <b>{-v}</b> <b>{-J</b><u>javaoption</u><b>}</b>

              Reads  (from  the  keystore)  the certificate associated with <u>alias</u>, and stores it in the file
              <u>cert</u><b>_</b><u>file</u>.

              If no file is given, the certificate is output to <b>stdout</b>.

              The certificate is by default output in binary encoding, but will instead  be  output  in  the
              printable encoding format, as defined by the Internet RFC 1421 standard, if the <b>-rfc</b> option is
              specified.

              If <u>alias</u> refers to a trusted certificate, that certificate is output. Otherwise, <u>alias</u>  refers
              to  a  key  entry with an associated certificate chain. In that case, the first certificate in
              the chain is returned. This certificate authenticates the public key of the  entity  addressed
              by <u>alias</u>.

   <b>Displaying</b> <b>Data</b>
       <b>-list</b> <b>{-alias</b> <u>alias</u><b>}</b> <b>{-storetype</b> <u>storetype</u><b>}</b> <b>{-keystore</b> <u>keystore</u><b>}</b>
                   <b>[-storepass</b> <u>storepass</u><b>]</b>
                   <b>[-provider</b> <u>provider</u><b>_</b><u>class</u><b>_</b><u>name</u><b>]</b>
                   <b>{-v</b> <b>|</b> <b>-rfc}</b> <b>{-J</b><u>javaoption</u><b>}</b>

              Prints  (to  stdout)  the  contents of the keystore entry identified by <u>alias</u>.  If no <u>alias</u> is
              specified, the contents of the entire keystore are printed.

              This command by default prints the MD5 fingerprint of a certificate.   If  the  <b>-v</b>  option  is
              specified,  the  certificate  is printed in human-readable format, with additional information
              such as the owner, issuer, and serial number.  If the <b>-rfc</b> option  is  specified,  certificate
              contents  are printed using the printable encoding format, as defined by the Internet RFC 1421
              standard

              You cannot specify both <b>-v</b> and <b>-rfc</b>.

       <b>-printcert</b> <b>{-file</b> <u>cert</u><b>_</b><u>file</u><b>}</b> <b>{-v}</b> <b>{-J</b><u>javaoption</u><b>}</b>

              Reads the certificate from the file <u>cert</u><b>_</b><u>file</u>, and prints its  contents  in  a  human-readable
              format. If no file is given, the certificate is read from stdin.

              The  certificate  may  be either binary encoded or in printable encoding format, as defined by
              the Internet RFC 1421 standard.

              Note: This option can be used independently of a keystore.

   <b>Managing</b> <b>the</b> <b>Keystore</b>
       <b>-keyclone</b> <b>{-alias</b> <u>alias</u><b>}</b> <b>[-dest</b> <u>dest</u><b>_</b><u>alias</u><b>]</b> <b>[-keypass</b> <u>keypass</u><b>]</b>
                   <b>{-new</b> <u>new</u><b>_</b><u>keypass</u><b>}</b> <b>{-storetype</b> <u>storetype</u><b>}</b>
                   <b>{-keystore</b> <u>keystore</u><b>}</b> <b>[-storepass</b> <u>storepass</u><b>]</b>
                   <b>[-provider</b> <u>provider</u><b>_</b><u>class</u><b>_</b><u>name</u><b>]</b>
                   <b>{-v}</b> <b>{-J</b><u>javaoption</u><b>}</b>

              Creates a new keystore entry, which has the same private key  and  certificate  chain  as  the
              original entry.

              The original entry is identified by <u>alias</u> (which defaults to "mykey" if not provided). The new
              (destination) entry is identified by <u>dest</u><b>_</b><u>alias</u>.  If no destination <u>alias</u> is supplied  at  the
              command line, the user is prompted for it.

              If  the private key password is different from the keystore password, then the entry will only
              be cloned if a valid <u>keypass</u> is supplied.  This is the password used to  protect  the  private
              key  associated  with <u>alias</u>.  If no key password is supplied at the command line, and the pri-<font color="#ffffff" class="whiteout">vate&nbsp;private</font>
              vate key password is different from the keystore password, the user is prompted for  it.   The
              private  key in the cloned entry may be protected with a different password, if desired. If no
              <b>-new</b> option is supplied at the command line, the user is prompted for the new entry's password
              (and may choose to let it be the same as for the cloned entry's private key).

              Be careful with passwords: See <b>Warning</b> <b>Regarding</b> <b>Passwords</b>.

              This command can be used to establish multiple certificate chains corresponding to a given key
              pair, or for backup purposes.

       <b>-storepasswd</b> <b>{-new</b> <u>new</u><b>_</b><u>storepass</u><b>}</b> <b>{-storetype</b> <u>storetype</u><b>}</b>
                   <b>{-keystore</b> <u>keystore</u><b>}</b> <b>[-storepass</b> <u>storepass</u><b>]</b>
                   <b>[-provider</b> <u>provider</u><b>_</b><u>class</u><b>_</b><u>name</u><b>]</b>
                   <b>{-v}</b> <b>{-J</b><u>javaoption</u><b>}</b>

              Changes the password used to protect the integrity of the keystore contents. The new  password
              is <u>new</u><b>_</b><u>storepass</u>, which must be at least 6 characters long.

              Be careful with passwords: <b>Warning</b> <b>Regarding</b> <b>Passwords</b>.

       <b>-keypasswd</b> <b>{-alias</b> <u>alias</u><b>}</b> <b>[-keypass</b> <u>old</u><b>_</b><u>keypass</u><b>]</b>
                   <b>[-new</b> <u>new</u><b>_</b><u>keypass</u><b>]</b> <b>{-storetype</b> <u>storetype</u><b>}</b>
                   <b>{-keystore</b> <u>keystore</u><b>}</b> <b>[-storepass</b> <u>storepass</u><b>]</b>
                   <b>[-provider</b> <u>provider</u><b>_</b><u>class</u><b>_</b><u>name</u><b>]</b>
                   <b>{-v}</b> <b>{-J</b><u>javaoption</u><b>}</b>

              Changes  the  password  under  which  the  private  key identified by <u>alias</u> is protected, from
              <u>old</u><b>_</b><u>keypass</u> to <u>new</u><b>_</b><u>keypass</u>.

              If the <b>-keypass</b> option is not provided at the command line, and the private  key  password  is
              different from the keystore password, the user is prompted for it.

              If the <b>-new</b> option is not provided at the command line, the user is prompted for it.

              Be careful with passwords: See  <b>Warning</b> <b>Regarding</b> <b>Passwords</b>.

       <b>-delete</b> <b>[-alias</b> <u>alias</u><b>]</b> <b>{-storetype</b> <u>storetype</u><b>}</b>
                   <b>{-keystore</b> <u>keystore</u><b>}</b> <b>[-storepass</b> <u>storepass</u><b>]</b>
                   <b>[-provider</b> <u>provider</u><b>_</b><u>class</u><b>_</b><u>name</u><b>]</b>
                   <b>{-v}</b> <b>{-J</b><u>javaoption</u><b>}</b>

              Deletes  from the keystore the entry identified by <u>alias</u>.  The user is prompted for the <u>alias</u>,
              if no <u>alias</u> is provided at the command line.

   <b>Getting</b> <b>Help</b>
       <b>-help</b>  Lists all the command and their options.

<b>EXAMPLES</b>
       Suppose you want to create a keystore for managing your public/private key pair and certificates from
       entities you trust.

   <b>Generating</b> <b>Your</b> <b>Key</b> <b>Pair</b>
       The  first  thing you need to do is create a keystore and generate the key pair. You could use a com-<font color="#ffffff" class="whiteout">mand&nbsp;command</font>
       mand such as the following:

       <b>keytool</b> <b>-genkey</b> <b>-dname</b> <b>"cn=Mark</b> <b>Jones,</b> <b>ou=Java,</b> <b>o=Sun,</b> <b>c=US"</b>
       <b>-alias</b> <b>business</b> <b>-keypass</b> <b>kpi135</b> <b>-keystore</b> <b>/working/mykeystore</b>
       <b>-storepass</b> <b>ab987c</b> <b>-validity</b> <b>180</b>

       (Please note: This must be typed as a single line.  Multiple lines are used in the examples just  for
       legibility purposes.)

       This  command  creates  the  keystore named <b>mykeystore</b> in the <b>working</b> directory (assuming it does not
       already exist), and assigns it the password <b>ab987c</b>.  It generates a public/private key pair  for  the
       entity  whose "distinguished name" has a common name of <b>Mark</b>Jones<b>,</b> organizational unit of <b>Java</b>, orga-<font color="#ffffff" class="whiteout">nization&nbsp;organization</font>
       nization of <b>Sun</b> and two-letter country code of <b>US</b>.  It uses the default "DSA"  key  generation  algo-<font color="#ffffff" class="whiteout">rithm&nbsp;algorithm</font>
       rithm to create the keys, both 1024 bits long.

       It  creates  a  self-signed  certificate  (using  the default "SHA1withDSA" signature algorithm) that
       includes the public key and the distinguished name information. This certificate will  be  valid  for
       <b>180</b>  days,  and is associated with the private key in a keystore entry referred to by the alias <b>busi</b>-<font color="#ffffff" class="whiteout">ness.&nbsp;business.</font>
       <b>ness</b>.  The private key is assigned the password <b>kpi135</b>.

       The command could be significantly shorter if option defaults were accepted. As a matter of fact,  no
       options are required; defaults are used for unspecified options that have default values, and you are
       prompted for any required values. Thus, you could simply have the following:

       <b>keytool</b> <b>-genkey</b>

       In this case, a keystore entry with alias <b>mykey</b> is created, with a newly-generated  key  pair  and  a
       certificate  that  is valid for 90 days. This entry is placed in the keystore named <b>.keystore</b> in your
       home directory. (The keystore is created if it doesn't already exist.) You will be prompted  for  the
       distinguished name information, the keystore password, and the private key password.

       The  rest of the examples assume you executed the <b>-genkey</b> command without options specified, and that
       you responded to the prompts with values equal to those given in the first <b>-genkey</b> command, above  (a
       private key password of <b>kpi135</b>, and so forth.)

   <b>Requesting</b> <b>a</b> <b>Signed</b> <b>Certificate</b>
   <b>from</b> <b>a</b> <b>Certification</b> <b>Authority</b>
       So far all we've got is a self-signed certificate. A certificate is more likely to be trusted by oth-<font color="#ffffff" class="whiteout">ers&nbsp;others</font>
       ers if it is signed by a Certification Authority (CA). To get such a signature, you first generate  a
       Certificate Signing Request (CSR), via the following:

       <b>keytool</b> <b>-certreq</b> <b>-file</b> <b>MarkJ.csr</b>

       This  creates a CSR (for the entity identified by the default alias <b>mykey</b> and puts the request in the
       file named <b>MarkJ.csr</b>.  Submit this file to a CA, such as VeriSign, Inc. The CA will authenticate you,
       the  requestor (usually off-line), and then will return a certificate, signed by them, authenticating
       your public key. (In some cases, they will actually return a chain of certificates, each one  authen-<font color="#ffffff" class="whiteout">ticating&nbsp;authenticating</font>
       ticating the public key of the signer of the previous certificate in the chain.)

   <b>Importing</b> <b>a</b> <b>Certificate</b> <b>for</b> <b>the</b> <b>CA</b>
       You  need to replace your self-signed certificate with a certificate chain, where each certificate in
       the chain authenticates the public key of the signer of the previous certificate in the chain, up  to
       a "root" CA.

       Before  you  import  the  certificate reply from a CA, you need one or more "trusted certificates" in
       your keystore or in the cacerts keystore file (which is described in <b>import</b>command<b>):</b>

        If the certificate reply is a certificate chain, you just need the top  certificate  of  the  chain
         (that is, the "root" CA certificate authenticating that CA's public key).

        If  the  certificate  reply is a single certificate, you need a certificate for the issuing CA (the
         one that signed it), and if that certificate is not self-signed, you need  a  certificate  for  its
         signer, and so on, up to a self-signed "root" CA certificate.

       The  <b>cacerts</b>  keystore file ships with five VeriSign root CA certificates, so you probably won't need
       to import a VeriSign certificate as a trusted certificate in your keystore.  But  if  you  request  a
       signed  certificate from a different CA, and a certificate authenticating that CA's public key hasn't
       been added to <b>cacerts</b>, you will need to import a certificate from the CA as a "trusted  certificate".

       A  certificate  from  a  CA is usually either self-signed, or signed by another CA (in which case you
       also need a certificate authenticating that CA's public key).  Suppose company ABC, Inc.,  is  a  CA,
       and you obtain a file named <b>ABCCA.cer</b> that is purportedly a self-signed certificate from ABC, authen-<font color="#ffffff" class="whiteout">ticating&nbsp;authenticating</font>
       ticating that CA's public key.

       Be very careful to ensure the certificate is valid prior to importing it as a "trusted"  certificate!
       View  it  first  (using  the  <b>-printcert</b>  subcommand, or the <b>-import</b> subcommand without the <b>-noprompt</b>
       option), and make sure that the displayed certificate <!-- a -->fingerprint(s)<!-- /a --> match the expected ones. You can
       call  the  person who sent the certificate, and compare the <!-- a -->fingerprint(s)<!-- /a --> that you see with the ones
       that they show (or that a secure public key repository shows). Only if the fingerprints are equal  is
       it  guaranteed  that the certificate has not been replaced in transit with somebody else's (for exam-<font color="#ffffff" class="whiteout">ple,&nbsp;example,</font>
       ple, an attacker's) certificate. If such an attack took place, and you did not check the  certificate
       before you imported it, you would end up trusting anything the attacker has signed.

       If you trust that the certificate is valid, then you can add it to your keystore via the following:

       <b>keytool</b> <b>-import</b> <b>-alias</b> <b>abc</b> <b>-file</b> <b>ABCCA.cer</b>

       This  creates  a  "trusted certificate" entry in the keystore, with the data from the file <b>ABCCA.cer</b>,
       and assigns the alias <b>abc</b> to the entry.

   <b>Importing</b> <b>the</b> <b>Certificate</b>
   <b>Reply</b> <b>from</b> <b>the</b> <b>CA</b>
       Once you've imported a certificate authenticating the public key of the CA you  submitted  your  cer-<font color="#ffffff" class="whiteout">tificate&nbsp;certificate</font>
       tificate  signing  request  to  (or  there's already such a certificate in the <b>cacerts</b> file), you can
       import the certificate reply and thereby replace your  self-signed  certificate  with  a  certificate
       chain.  This  chain  is  the one returned by the CA in response to your request (if the CA reply is a
       chain), or one constructed (if the CA reply is a single certificate) using the certificate reply  and
       trusted  certificates that are already available in the keystore where you import the reply or in the
       <b>cacerts</b> keystore file.

       For example, suppose you sent your certificate signing request to VeriSign. You can then  import  the
       reply via the following, which assumes the returned certificate is named <b>VSMarkJ.cer</b>:

       <b>keytool</b> <b>-import</b> <b>-trustcacerts</b> <b>-file</b> <b>VSMarkJ.cer</b>

   <b>Exporting</b> <b>a</b> <b>Certificate</b> <b>Authenticating</b> <b>Your</b>
   <b>Public</b> <b>Key</b>
       Suppose  you  have used the <a href="jarsigner.1.html#//apple_ref/doc/man/1/jarsigner"><b>jarsigner</b>(1)</a> tool to sign a Java ARchive (JAR) file. Clients that want to
       use the file will want to authenticate your signature.

       One way they can do this is by first importing your public key certificate into their keystore  as  a
       "trusted" entry. You can export the certificate and supply it to your clients. As an example, you can
       copy your certificate to a file named <b>MJ.cer</b> via the following, assuming  the  entry  is  aliased  by
       <b>mykey</b>:

       <b>keytool</b> <b>-export</b> <b>-alias</b> <b>mykey</b> <b>-file</b> <b>MJ.cer</b>

       Given  that certificate, and the signed JAR file, a client can use the <a href="jarsigner.1.html#//apple_ref/doc/man/1/jarsigner"><b>jarsigner</b>(1)</a> tool to authenti-<font color="#ffffff" class="whiteout">cate&nbsp;authenticate</font>
       cate your signature.

   <b>Changing</b> <b>Your</b> <b>Distinguished</b>
   <b>Name</b> <b>but</b> <b>Keeping</b> <b>your</b> <b>Key</b> <b>Pair</b>
       Suppose your distinguished name changes, for example because you have changed departments or moved to
       a  different  city. If desired, you may still use the public/private key pair you've previously used,
       and yet update your distinguished name. For example, suppose your name is Susan Miller, and you  cre-<font color="#ffffff" class="whiteout">ated&nbsp;created</font>
       ated your initial key entry with the alias <b>sMiller</b> and the distinguished name

       <b>"cn=Susan</b> <b>Miller,</b> <b>ou=Finance</b> <b>Department,</b> <b>o=BlueSoft,</b> <b>c=us"</b>

       Suppose  you  change  from the Finance Department to the Accounting Department. You can still use the
       previously-generated public/private key pair and yet update your distinguished name by doing the fol-<font color="#ffffff" class="whiteout">lowing.&nbsp;following.</font>
       lowing.  First, copy (clone) your key entry:

       <b>keytool</b> <b>-keyclone</b> <b>-alias</b> <b>sMiller</b> <b>-dest</b> <b>sMillerNew</b>

       (This prompts for the store password and for the initial and destination private key passwords, since
       they aren't provided at the command line.) Now you need to change the  certificate  chain  associated
       with  the  copy,  so  that the first certificate in the chain uses your different distinguished name.
       Start by generating a self-signed certificate with the appropriate name:

       <b>keytool</b> <b>-selfcert</b> <b>-alias</b> <b>sMillerNew</b>
       <b>-dname</b> <b>"cn=Susan</b> <b>Miller,</b> <b>ou=Accounting</b> <b>Department,</b> <b>o=BlueSoft,</b> <b>c=us"</b>

       Then generate a Certificate Signing Request based on the information in this new certificate:

       <b>keytool</b> <b>-certreq</b> <b>-alias</b> <b>sMillerNew</b>

       When you get the CA certificate reply, import it:

       <b>keytool</b> <b>-import</b> <b>-alias</b> <b>sMillerNew</b> <b>-file</b> <b>VSSMillerNew.cer</b>

       After importing the certificate reply, you may want to remove the initial key entry  that  used  your
       old distinguished name:

       <b>keytool</b> <b>-delete</b> <b>-alias</b> <b>sMiller</b>

<b>SEE</b> <b>ALSO</b>
       <a href="jar.1.html#//apple_ref/doc/man/1/jar"><b>jar</b>(1)</a>, <a href="jarsigner.1.html#//apple_ref/doc/man/1/jarsigner"><b>jarsigner</b>(1)</a>

       See (or search <b>java.sun.com</b>) for the following:

       <b>Security</b> <b>in</b> <b>the</b> <b>Java</b> <b>2</b> <b>Platform</b> <b>@</b>
                 <a href="http://java.sun.com/docs/books/tutorial/security1.2/index.html">http://java.sun.com/docs/books/tutorial/security1.2/index.html</a>



                                                22 June 2004                                      keytool(1)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man1/keytool.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man1/keytool.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man1/keytool.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
