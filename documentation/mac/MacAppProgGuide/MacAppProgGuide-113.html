<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Overview (MacApp PG)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING113></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MacAppProgGuide-112.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-114.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MacAppProgGuide-2.html"><B>Programmer's Guide to MacApp</B></A> / <A HREF="MacAppProgGuide-78.html"><B>Part 2 - Working With MacApp</B></A><BR><DD><A HREF="MacAppProgGuide-112.html"><B>Chapter 21 - Working With the Cursor</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING113-0></A>
<H1>Overview</H1>
 MacApp provides support to help your application<P>
<UL>
<LI>change the cursor image for a view or change the image whenever the cursor is over an object in your view
<LI>show an animated watch cursor during completion of a long task
<LI>show the grabber hand or arrow cursor when a mouse-down action is initiating a drag operation, or show a drag cursor specified by your application<P>
</UL>
 Whenever the user moves the mouse, MacApp determines whether the cursor image is over the content area of an application window. If it is, the window object and the views in the window's content area are given the opportunity to track the cursor and to change the cursor image.<P>
 <A HREF=#MARKER-9-20>Figure 21-1</A> shows some commonly used cursor images. The I-beam cursor is typically used as a text insertion point, the crosshairs cursor for drawing, the plus sign for selecting or dragging, the wristwatch to show that the application is busy, the grabber hand for dragging, and the arrow for clicking, selecting, or dragging.<P>
<B>Figure 21-1  <A NAME=MARKER-9-20></A>Commonly used cursor images</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/MacApp_PG-L-030.gif"><P>
<A NAME=HEADING113-9></A>
<H2><A NAME=MARKER-2-21></A>MacApp's Cursor-Handling Support</H2>
 Some important MacApp classes, methods, and fields for working with the cursor are show in <A HREF=#MARKER-9-23>Figure 21-2</A>.<P>
<B>Figure 21-2  <A NAME=MARKER-2-22></A>Classes, methods, and fields for working with the cursor<A NAME=MARKER-9-23></A></B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/MacApp_PG-L-068.gif"><P>
 Cursor handling starts with the application object, which uses the <CODE>fCursorRegion</CODE> field to specify a region for which the current cursor image is valid. When the application receives a mouse-moved event that occurred outside the current cursor region, it invalidates the cursor region. The application's <CODE>MainEventLoop</CODE> method sets in motion a series of actions that cause the cursor region to be checked regularly and recomputed when necessary. <P>
 An application, window, view, or behavior object can handle the cursor by setting the cursor image and computing a region for which that image is valid. If no other object handles the cursor, the application object sets the cursor to the arrow cursor.<P>
<A NAME=HEADING113-15></A>
<H3>Application Fields and Methods</H3>
 These fields and methods of <CODE>TApplication</CODE> are used in cursor handling:<P>
<DL>
<DT><CODE><A NAME=MARKER-2-24></A>fAlwaysTrackCursor</CODE>
<DD> When the <CODE>fAlwaysTrackCursor</CODE> field has the value <CODE>TRUE</CODE>, MacApp ignores the current cursor region and always tracks the cursor; otherwise, it only tracks the cursor when the cursor moves outside the current cursor region. The default value is <CODE>FALSE</CODE>.
<DT><CODE><A NAME=MARKER-2-25></A>fCursorRegion</CODE> 
<DD> <CODE>The fCursorRegion field specifies </CODE>the area in which the current cursor image is valid.
<DT><CODE><A NAME=MARKER-2-26></A>DoSetCursor</CODE> 
<DD> The <CODE>DoSetCursor</CODE> method calls <CODE>GetDefaultCursorRegion</CODE>, then calls the Toolbox routine <CODE>SetCursor</CODE> to set the cursor image to the arrow cursor.
<DT><CODE>GetDefaultCursorRegion</CODE>
<DD> The <CODE>GetDefaultCursorRegion</CODE> method computes the cursor region for the case when no window has handled the cursor. It starts with the desktop region, then subtracts the cursor region of any window that handles the cursor.
<DT><CODE>HandleCursor</CODE> 
<DD> The <CODE>HandleCursor</CODE> method looks for a window that contains the mouse and can handle the cursor. If it finds one, it calls the window object's <CODE>HandleCursor</CODE> method, then adjusts the cursor region.
<DT><CODE><A NAME=MARKER-2-29></A>TrackCursor</CODE> 
<DD> The <CODE>TrackCursor</CODE> method calls <CODE>HandleCursor</CODE> to give the application's windows and views a chance to handle the cursor. If none does, it calls <CODE>DoSetCursor</CODE>.
</DL>
<A NAME=HEADING113-23></A>
<H3>View Fields and Methods</H3>
 These fields and methods of <CODE>TView</CODE> are used in cursor handling:<P>
<DL>
<DT><CODE><A NAME=MARKER-2-30></A>fCursorID</CODE>
<DD> The <CODE>fCursorID</CODE> field stores a resource ID number for a cursor resource. The default value is <CODE>kNoResource</CODE> (indicating the arrow cursor should be displayed).
<DT><CODE><A NAME=MARKER-2-31></A>fHandlesCursor</CODE>
<DD> When the <CODE>fHandlesCursor</CODE> field has the value <CODE>TRUE</CODE>, the view can handle the cursor; otherwise, it can't. The default value is <CODE>TRUE</CODE>.
<DT><CODE><A NAME=MARKER-2-32></A>fHandlesFirstClicks</CODE>
<DD> When the <CODE>fHandlesFirstClicks</CODE> field has the value <CODE>TRUE</CODE>, the view responds to a first click in the view; otherwise, it doesn't. The default value is <CODE>TRUE</CODE>. (See also <CODE>fDoFirstClick</CODE> in <A HREF=#MARKER-9-42>"Window Fields and Methods" on page 488</A>. If, for example, you want a user to be able start drawing in a window that isn't the frontmost window by clicking in that window and dragging, you set <CODE>fDoFirstClick</CODE> to <CODE>TRUE</CODE> for the window and set <CODE>fHandlesFirstClicks</CODE> to <CODE>TRUE</CODE> for the view that handles the drawing.)
<DT><CODE><A NAME=MARKER-2-38></A>fLetsSubViewsHandleCursor</CODE>
<DD> When the <CODE>fLetsSubViewsHandleCursor</CODE> field has the value <CODE>TRUE</CODE>, the view lets its subviews handle the cursor; otherwise, it doesn't. The default value is <CODE>TRUE</CODE>.
<DT><CODE><A NAME=MARKER-2-21></A>DoMakeDragCursorRegion</CODE>
<DD> The <CODE>DoMakeDragCursorRegion</CODE> method creates and returns a region, in local coordinates, that can be used to test whether the mouse is in a location that would initiate a drag operation (and over which the cursor image should be set to a drag cursor).
<DT><CODE><A NAME=MARKER-2-35></A>DoSetCursor</CODE>
<DD> The <CODE>DoSetCursor</CODE> method first calls <CODE>DoSetDragCursor</CODE>. If <CODE>DoSetDragCursor</CODE> doesn't set the cursor, then <CODE>DoSetCursor</CODE> uses <CODE>fCursorID</CODE> to retrieve a cursor resource. (If <CODE>fCursorID</CODE> is set to <CODE>kNoResource</CODE>, it uses the arrow cursor.) <CODE>DoSetCursor</CODE> calls the Toolbox routine <CODE>SetCursor</CODE> to set the cursor image.
<DT><CODE>DoSetDragCursor </CODE>
<DD> The <CODE>DoSetDragCursor</CODE> method determines whether a mouse click would initiate a drag operation. If so, it sets the cursor to the open-hand cursor; if not, it does nothing. (See <A HREF=MacAppProgGuide-75.html#MARKER-9-42>"Setting the Drag Cursor" on page 257</A>.)
<DT><CODE><A NAME=MARKER-2-37></A>GetDefaultCursorRegion</CODE>
<DD> The <CODE>GetDefaultCursorRegion</CODE> method computes the largest possible cursor region. It starts with the view's extent, then subtracts the region of any subview that handles the cursor.
<DT><CODE><A NAME=MARKER-2-38></A>HandleCursor</CODE> 
<DD> If the <CODE>fLetsSubViewsHandleCursor</CODE> field has the value <CODE>TRUE</CODE>, <CODE>HandleCursor</CODE> looks for a subview that contains the mouse and handles the cursor. If no subview handles the cursor, it lets behaviors have a chance. If no subview or behavior handles the cursor, it calls <CODE>DoSetCursor</CODE>.
<DT><CODE>HandleDragCursor</CODE>
<DD> If a subview contains the mouse, allows dragging, and has subviews of its own, the <CODE>HandleDragCursor</CODE> method calls the subview's <CODE>HandleDragCursor</CODE> method. If no such subview handles the drag cursor, but the current view does have at least one subview, <CODE>HandleDragCursor</CODE> computes a cursor region that contains the extent of all subviews that allow dragging. Finally, <CODE>HandleDragCursor</CODE> calls <CODE>DoSetDragCursor</CODE>. If <CODE><A NAME=MARKER-2-40></A>DoSetDragCursor</CODE> doesn't return a cursor region, <CODE>HandleDragCursor</CODE> sets the cursor region to the one it computed and sets the cursor to the arrow cursor.
<DT><CODE><A NAME=MARKER-2-22></A>WillDrag</CODE>
<DD> The <CODE>WillDrag</CODE> method is passed the cursor region computed by <CODE>DoMakeDragCursorRegion</CODE>. It determines whether the view contains draggable data and whether the cursor is currently in a location that would initiate a drag.
</DL>
<A NAME=HEADING113-36></A>
<H3><A NAME=MARKER-9-42></A>Window Fields and Methods</H3>
 These fields and methods of <CODE>TWindow</CODE> are used in cursor handling:<P>
<DL>
<DT><CODE><A NAME=MARKER-2-23></A>fDoFirstClick</CODE>
<DD> When the <CODE>fDoFirstClick</CODE> field has the value <CODE>TRUE</CODE>, a mouse-down event in this window activates the window and is passed on to the content region; otherwise, a mouse-down event only activates the window. The default value is <CODE>FALSE</CODE>. (See also <A HREF=MacAppProgGuide-104.html#MARKER-9-21>"Floating Windows," beginning on page 448</A>.)
<DT><CODE><A NAME=MARKER-2-26></A>fIsActive</CODE>
<DD> When the <CODE>fIsActive</CODE> field has the value <CODE>TRUE</CODE>, this window is active; otherwise, it is not active.
<DT><CODE><A NAME=MARKER-2-27></A>HandlesCursor</CODE>
<DD> The <CODE>HandlesCursor</CODE> method returns <CODE>TRUE</CODE> if <CODE>fHandlesCursor</CODE> is <CODE>TRUE</CODE> and the window is active, or if <CODE>fDoFirstClick</CODE> is <CODE>TRUE</CODE>.
</DL>
<A NAME=HEADING113-41></A>
<H2>Setting the Cursor Image for a View</H2>
 You can associate a cursor image with each of your views by specifying a cursor ID in your view resource and setting the <CODE>fHandlesCursor</CODE> field to <CODE>TRUE</CODE>. When a user moves the cursor over a view, MacApp calls the view's <CODE>DoSetCursor</CODE> method. If no drag operation is involved, MacApp automatically sets the cursor image according to the view's <CODE>fCursorID</CODE> field. If <CODE>fCursorID</CODE> is set to <CODE>kNoResource</CODE>, the arrow cursor is shown.<P>
 To change the view's cursor image as the mouse moves <I>within</I> a view, you override the <CODE>DoSetCursor</CODE> method, as described in <A HREF=MacAppProgGuide-114.html#MARKER-9-55>"Recipe--Setting the Cursor Image Over a View" on page 491</A>.<P>
 For information on setting the cursor for a drag operation, see <A HREF=MacAppProgGuide-72.html#MARKER-9-29>Chapter 9, "Drag and Drop,"</A> and <A HREF=MacAppProgGuide-136.html#MARKER-9-19>Chapter 28, "Working With Drag and Drop."</A><P>
<A NAME=HEADING113-45></A>
<H2><A NAME=MARKER-9-46></A>Color Cursors</H2>
 MacApp's default cursor handling for view and window objects is not set up to handle color cursor resources<A HREF=MacAppProgGuide-114.html#MARKER-9-63></A>. Unless you modify MacApp's behavior, the ID specified in the <CODE>fCursorID</CODE> field must refer to a standard cursor of type <CODE>'CURS'</CODE>. To work with a color cursor (resource type <CODE>'crsr'</CODE>), you use the Toolbox routine <CODE>GetCCursor</CODE> to get the cursor, and the routine <CODE>SetCCursor</CODE> to set it. For more information, see <A HREF=MacAppProgGuide-114.html#MARKER-9-62>"Recipe--Displaying a Color Cursor" on page 495</A>.<A NAME=MARKER-2-47></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MacAppProgGuide-112.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-114.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MacAppProgGuide-3.html">&copy; Apple Computer, Inc.</A><br>25 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
