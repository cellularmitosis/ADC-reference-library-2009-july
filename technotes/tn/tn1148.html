<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!-- Template 01-05-01 --><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css">   <title>Technical Note TN1148: Dialog Manager Helper Functions</title>    <meta name="keywords" content="Mac OS 8 Dialog Manager helper functions GetStdFilterProc StdFilterProc  SetDialogTracksCursor ">    <meta name="Description" content="Technical Note TN1148: This Technical Note discusses DialogManager calls available since System 7.0 which can ease thework of managing dialogs. They allow you to call on the servicesof the System to track the mouse cursor (i.e., change toand from the I-beam cursor) and handle the standard keystrokesfor accept and cancel in your dialog. The calls discussedare   SetDialogDefaultItem, SetDialogCancelItem,  SetDialogTracksCursor,GetStdFilterProcand StdFilterProc."><meta name="categories" content="Human Interface Toolbox"><meta name="week-posted" content="Dec 28, 1998 - Jan 1, 1999"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002987" title="Dialog Manager Helper Functions"></a><A NAME="top"></A><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/Carbon/index.html">Carbon</a> &gt; <a href="../../technicalnotes/Carbon/idxHumanInterfaceToolbox-date.html">Human Interface Toolbox</a> &gt; </p><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TN1148</div>
<div id="pageheadsub">Dialog Manager Helper Functions</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left">         <!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">     <tr><td width=300 valign="top" align=left scope="row">    <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>        </tr>        <tr bgcolor="#e6e6e6">   <td background="images/tnmenubody.gif" width=300 align=left>       <span id="menutitle">CONTENTS   <br>  <br>       </span>   </td>        </tr>        <tr bgcolor="#e6e6e6">   <td background="images/tnmenubody.gif" width=300 align=left>       <!-- begin_toc --><p id="menutext"><A HREF = "#Section1">Introduction</A><BR><BR><A HREF = "#Section2">System 7 Dialog Manager Call Interfaces</A><BR><BR><A HREF = "#Section3">Using the calls</A><BR><BR><A HREF = "#Summary">Summary</A><BR><BR><A HREF="#References">References</A><BR><BR><A HREF="#Downloads">Downloadables</A></p>  <!-- end_toc --></td>        </tr>        <tr>   <td width=300 align=left scope="row">       <img src="images/tnmenubottom.gif" alt="" width=300 height=16>   </td>        </tr>    </table></td>        <td width=300 valign="top" align=left>            <!-- begin_intro_text --><P id = "introtext">This Technote         discusses Dialog Manager calls available since System 7.0         which can ease the work of managing dialogs. They allow you         to call on the services of the System to track the mouse         cursor (i.e., change to and from the I-beam cursor) and         handle the standard keystrokes for accept and cancel in your         dialog.</P><!-- end_intro_text --><!-- begin_date --><h3>&nbsp;Updated: [Jan 11 1999]</h3><!-- end_date --></TD>             </TR>          </TABLE> <!-- end_header_box --><BR><BR><hr width=500 align=center><BR><BR><!-- begin_content --><A NAME=Section1></A>                  <H2>Introduction</H2>                  <P>With the introduction of System 7.0 some new Dialog         Manager calls were added to make creating standard dialog         functionality simpler for the developer.</P>                  <P>The functionality that has been simplified is:</P>                  <UL>            <LI>Setting the default button (aliases the return and            enter keys and draws the default ring around it)</LI>                        <LI>Setting the cancel button (aliases to the esc and            command-. keys)</LI>                        <LI>Tracking the cursor for changes to and from the            cursor and I-beam</LI>         </UL><BR><A HREF = "#top">Back to top</A><BR><A NAME=Section2></A>                  <H2>System 7 Dialog Manager Call         Interfaces</H2>                  <P>The new calls are:</P><BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>/* These are copied from Universal Headers 3.1 */EXTERN_API( Boolean )StdFilterProc                   (DialogPtr              theDialog,                                 EventRecord *          event,                                 DialogItemIndex *      itemHit);EXTERN_API( OSErr )GetStdFilterProc                (ModalFilterUPP *       theProc);EXTERN_API( OSErr )SetDialogDefaultItem            (DialogPtr              theDialog,                                 DialogItemIndex        newItem);EXTERN_API( OSErr )SetDialogCancelItem             (DialogPtr              theDialog,                                 DialogItemIndex        newItem);EXTERN_API( OSErr )SetDialogTracksCursor           (DialogPtr              theDialog,                                 Boolean                tracks);</pre></TD></TR></TABLE></CENTER><BR><BR>                                     <P><CODE>SetDialogDefaultItem</CODE> sets the default         button, the one that responds to the Return and Enter key.         It also puts the default ring around the button.</P>                  <P><CODE>SetDialogCancelItem</CODE> sets the cancel button,         which can be the same as the default button. The cancel         button responds to the esc key and the command-period (or         sequence-that-produces-the-period).</P>                  <P><CODE>SetDialogTracksCursor</CODE> tells the Dialog         Manager if it should track the cursor to change it from the         arrow cursor to the I-beam cursor (or vice-versa) when it         goes into (or out of) a text edit field.</P>                  <P>The <CODE>GetStdFilterProc</CODE> and         <CODE>StdFilterProc</CODE> calls work together allowing you         to delegate most of the work of managing a dialog back to         the Dialog Manager. You call the <CODE>StdFilterProc</CODE>         function whenever you want the default behavior of the         Dialog Manager.</P>         <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>Note:</B><BR>You <U>must</U> call the standardfilter proc for these calls to work properly.Automatic cursor tracking, default buttonbordering, and keystroke aliasing for <B>OK</B> and <B>Cancel</B>will only be active if you call the standard filterprocedure. Also, these calls are System 7 specific.You cannot use them in previous systemversions.</P></TD></TR></TABLE></CENTER><BR><BR><BR><A HREF = "#top">Back to top</A><BR><A NAME=Section3></A>                  <H2>Using the calls</H2>                  <P>Using these calls requires a little preparation on your         part. After you create your dialog, you need to tell the         Dialog Manager which items you want as the default and         cancel items. The button selected as the cancel item will be         toggled by the Escape key or by a Command-. keypress. The         button specified as the default will be toggled by the         Return or Enter key, and <U>also</U> will have the standard         heavy black border drawn around it. The buttons will also be         hilited when the correct key is hit.</P>                  <P><code>SetDialogTracksCursor</code> tells the Dialog Manager         that it should set the cursor on behalf of your application         according to what part of the dialog the mouse is hovering         over. When you pass a '<CODE>true</CODE>' value to the         <code>SetDialogTracksCursor</code> call the Dialog Manager will         constantly check cursor position in your dialog, and change         the cursor to an I-Beam when the cursor is over an edit         line. Otherwise, Dialog Manager sets the cursor to the         standard arrow.</P>                  <P>Here is a snippet of code showing how to call the         functions described in this Technote:</P><BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>/* Before we go into a ModalDialog loop, do a little preparation */    ModalFilterUPP              filterProcUPP;    myDialogPtr = GetNewDialog (kMyDialogID, nil, (WindowPtr)-1);    /* Tell the Dialog Manager that the OK button is the default */    myErr = SetDialogDefaultItem (myDialogPtr, ok);    /* Tell the Dialog Manager the cancel button is the cancel item*/    myErr = SetDialogCancelItem (myDialogPtr, cancel);    /* We have an edit item in our dialog, so tell the Dialog Manager       to change the cursor to an I-Beam when it's over the edit line */    myErr = SetDialogTracksCursor (myDialogPtr, true);    filterProcUPP = NewModalFilterProc (ModalDialogFilter);    do {        ModalDialog (filterProcUPP, &amp;hitItem);        switch (hitItem) {            case ...:                break;            case ...:                break;            default:        }    } while (hitItem != ok &amp;&amp; hitItem != cancel);    DisposeRoutineDescriptor (filterProcUPP);</pre></TD></TR></TABLE></CENTER><BR><BR>         <P>Your modal dialog filter will look something like         this:</P>         <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>Boolean ModalDialogFilter (DialogPtr theDialog,     EventRecord *theEvent, short *itemHit) {          Boolean                     result          = false;          OSErr                       err             = noErr;          ModalFilterUPP              standardProc;    if ((theEvent-&gt;what == updateEvt) &amp;&amp;       (WindowPtr)theEvent-&gt;message != theDialog) {        err = DispatchWindowUpdate ((WindowPtr)theEvent-&gt;message);    } else if ((theEvent-&gt;what == activateEvt) &amp;&amp;       (WindowPtr)theEvent-&gt;message != theDialog) {        DoActivate (theEvent, true);    } else {        err = GetStdFilterProc (&amp;standardProc);        if (err == noErr) {            result = CallModalFilterProc (standardProc, theDialog, theEvent, itemHit);        }    }    return result;}</pre></TD></TR></TABLE></CENTER><BR><BR><BR><A HREF = "#top">Back to top</A><BR><A NAME=Summary></A>                  <H2>Summary</H2>                  <P>By using these Dialog Manager calls (even when you're not         using a filter) you give your dialog a more consistent user         interface and can save yourself a fair amount of work over         doing it all yourself.</P><BR><A HREF = "#top">Back to top</A><BR><a name="References"></a><H2>References</H2><p><a href="http://developer.apple.com/documentation/mac/Toolbox/Toolbox-28.html#HEADING28-0">InsideMacintosh:Macintosh Toolbox Essentials, Chapter 2 - EventManager</A></p>            <p><a href="http://developer.apple.com/documentation/mac/Toolbox/Toolbox-188.html#HEADING188-0">InsideMacintosh:Macintosh Toolbox Essentials, Chapter 4 -Window Manager</A></p>            <p><a href="http://developer.apple.com/documentation/mac/Toolbox/Toolbox-370.html#HEADING370-0">InsideMacintosh:Macintosh Toolbox Essentials, Chapter 6 -Dialog Manager</A></p>        <BR><P><A HREF="#top">Back to top</A></P><A NAME="Downloads"></A> <h2>Downloadables</h2>        <center><TABLE BORDER=0 CELLPADDING=3 WIDTH="600">         <TR>             <td width=50 align=left>               <P ALIGN=center><img src="images/acrobatsmall.gif" align=middle alt="Acrobat" width=22 height=23></P>            </TD>            <td align="left">               <p>Acrobat version of this Note (56K).</P>            </TD>            <td width=60 align=left>               <p><A HREF="pdf/tn1148.pdf">Download</A></P>            </TD>          </TR> </table></center><BR><BR><BR><P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tn/tn1148.html%3Fid%3DDTS10002987-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tn/tn1148.html%3Fid%3DDTS10002987-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tn/tn1148.html%3Fid%3DDTS10002987-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>