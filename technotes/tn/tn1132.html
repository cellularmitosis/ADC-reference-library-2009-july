<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!-- Template 01-05-01 --><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css">   <title>Technical Note TN1132: Version Territory</title>       <meta name="keywords" content="Mac OS 8 vers resource numversion structure format MinorAndBugRev comparing">    <meta name="Description" content="Technical Note TN1132: This Technical Note clarifies theformat of data in the NumVersion structure used in a versionresource, and provides guidelines for the use of versionresources based on the version numbering scheme used at Apple."><meta name="categories" content="Overview"><meta name="week-posted" content="Jun 1, 1998 - Jun 5, 1998">		<meta http-equiv="content-type" content="text/html;charset=ISO-8859-1">	<LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002971" title="Version Territory"></a><A NAME="top"></A><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/Carbon/index.html">Carbon</a> &gt; <a href="../../technicalnotes/Carbon/idxRuntimeArchitecture-date.html">Runtime Architecture</a> &gt; </p><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TN1132</div>
<div id="pageheadsub">Version Territory</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><center><table width="600" cellpadding="0" cellspacing="0" border="0"> <tr> <td align="left" scope="row"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">     <tr>         <td width=300 valign="top" align=left>             <table border="0" width="300" cellpadding="0" cellspacing="0">                 <tr>             <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                 </tr>                 <tr bgcolor="#e6e6e6">                     <td background="images/tnmenubody.gif" width=300 align=left>                         <span id="menutitle">                             CONTENTS                             <br>                             <br>                         </span>                     </td>                 </tr>                 <tr bgcolor="#e6e6e6">                     <td background="images/tnmenubody.gif" width=300 align=left>                         <!-- begin_toc -->                         <p id="menutext"><A HREF = "#VersionNumberContents">Version Number Contents</A><BR>         <BR>         <A HREF = "#VersionNumberScheme">Apple's         Version Number Scheme</A><BR>         <BR>         <A HREF = "#ComparingVersionNumbers">Comparing         Version Numbers</A><BR>         <BR>         <A HREF = "#versresourcestructure">'vers'         Resource Structure</A><BR><BR><A HREF = "#References">References</A><BR><BR><A HREF = "#Changes">Change History</A><BR><BR><A HREF="#Downloads">Downloadables</A></P>                    <!-- end_toc -->                  </td>                 </tr>                 <tr>                     <td width=300 align=left scope="row">                         <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                     </td>                 </tr>             </table>         </td>         <td width=300 valign="top" align=left>             <!-- begin_intro_text -->             <P id = "introtext">Finder 6.1         introduced version (<TT>'vers'</TT>) resources as a way to         allow the creator of a file to identify the version of a         file, as well as the version of a set of files which includes         this file. The format of this resource is described in<a href="http://developer.apple.com/documentation/mac/Toolbox/Toolbox-454.html">Inside         Macintosh: Macintosh Toolbox Essentials</A>.</P><!-- end_intro_text --><!-- begin_date --><H4 ALIGN=center>[Aug 25, 2003]</H4><!-- end_date --></TD>             </TR>          </TABLE> <!-- end_header_box --><BR><BR><hr width=500 align=center><BR><BR>						<!-- begin_content -->						<P>This Note, originally <i>Technote OV 12- Version Territory</i>,          clarifies the format of data in the         <CODE>NumVersion</CODE> structure used in a version         resource, and provides guidelines for the use of version         resources based on the version numbering scheme used at         Apple.</P>						<P>All Mac OS programmers who distribute program files of         any type should include version resources in their         files.</P>       <BR><P><A HREF="#top">Back to top</A></P>         <A NAME="VersionNumberContents"></A>                  <H2>Version Number Contents</H2>                  <P>While the version resource structure is described in         <a href="http://developer.apple.com/documentation/mac/Toolbox/Toolbox-454.html">Inside         Macintosh</A>, it does not clearly describe the format for         the data in all the fields of the <CODE>NumVersion</CODE>         structure, which is the data type for the         <CODE>numericVersion</CODE> field in a version resource. The         comments in <code>MacTypes.h</code> from Universal Interfaces 3 aren't         any more helpful, which has lead to different interpretation         of the content of the fields in the <CODE>NumVersion</CODE>         structure.</P>                  <P>A <CODE>NumVersion</CODE> structure is defined as         containing four <CODE>UInt8</CODE> values. This allows a         <CODE>NumVersion</CODE> value to be used as a structure to         access individual fields, or cast to an unsigned long for the         purpose of comparing version numbers. There is a problem you         should be aware of when <A HREF = "#ComparingVersionNumbers">comparing         version number</A> as unsigned long values.</P>                  <P>The values in the <CODE>majorRev</CODE> and         <CODE>minorAndBugRev</CODE> fields are stored in         binary-coded decimal (BCD) format where each digit has a         range of 0 - 9 (normal binary digits have a range of 0 -         15). The <CODE>majorRev</CODE> field contains two BCD digits         for the major revision level. The         <CODE>MinorAndBugRev</CODE> field contains two values, each         stored as a single BCD digit -- the minor revision level and         the bug revision level. This means that a version number can         range from 0.0.0 to 99.9.9.</P>                  <P>The value in the <CODE>nonRelRev</CODE> field is stored         as an unsigned binary integer value. This give the         <CODE>nonRelRev</CODE> field a range of 0 - 255. This is the         field that is most often interpreted incorrectly, that is, as a         BCD value rather than as a binary value.</P>                  <H3>Consequences of Using BCD for<CODE>nonRelRev</CODE> Values</H3>                  <P>As long as version resources are consistently created the         same way the only consequence to using BCD values is that         there are fewer <CODE>nonRelRev</CODE> values available: 100         using BCD and 256 using binary. Consistency is important,         since BCD and binary values won't compare as equal even         though they represent the same value. For example, a BCD         revision 10 is <CODE>0x10</CODE> and a binary revision 10 is <CODE>0x0A</CODE>.</P>                  <P>Since most comparisons of version numbers are done by         first casting the <CODE>numericVersion</CODE> field to an         unsigned long, the use of BCD values for the         <CODE>nonRelRev</CODE> field does not affect this comparison         if the versions resource being compared were created the         same way, whether as BCD or binary values.</P>                  <P>There have been some applications, notably ResEdit, which         have interpreted the <CODE>nonRelRev</CODE> as BCD.         Resorcerer was changed in version 2.0 to correctly interpret         the <CODE>nonRelRev</CODE> field as an unsigned binary         value.</P>      <BR><P><A HREF="#top">Back to top</A></P>    <A NAME="VersionNumberScheme"></A>                  <H2>Apple's Version NumberScheme</H2>                  <P>Apple uses a version numbering scheme for its software         products which you might want to adopt. Table 1 summarizes         the scheme, which involves three numbers, each separated by         periods.</P>                  <BLOCKQUOTE><BLOCKQUOTE><TABLE BORDER=0 CELLPADDING=2 WIDTH=314>                  <TR>                     <td width=207 align=left>                        <P><B>Event</B></P>                     </TD>                     <td width=57 align=left>                        <P><B>Version</B></P>                     </TD>                  </TR>                  <TR>                     <td width=207 align=left>                        <P>First released version</P>                     </TD>                     <td width=57 align=left>                        <P>1.0</P>                     </TD>                  </TR>                  <TR>                     <td width=207 align=left>                        <P>First revision</P>                     </TD>                     <td width=57 align=left>                        <P>1.1</P>                     </TD>                  </TR>                  <TR>                     <td width=207 align=left>                        <P>First bug fix to the first revision</P>                     </TD>                     <td width=57 align=left>                        <P>1.1.1</P>                     </TD>                  </TR>                  <TR>                     <td width=207 align=left>                        <P>First major revision or rewrite</P>                     </TD>                     <td width=57 align=left>                        <P>2.0</P>                     </TD>                  </TR>               </TABLE>                              <P><B>Table 1-Apple's Version Numbering Scheme</B></P></BLOCKQUOTE></BLOCKQUOTE>                  <P>Note that Apple increments the first number when it         releases a major revision, the second number when it         releases a minor revision, and the third number when it         releases a version to address bugs (the third number is         omitted if it is zero).</P>                  <P>During product development, Apple uses a version number         followed by a suffix which indicates the stage of         development. Table 2 presents a few examples.</P>                  <TABLE BORDER=0 CELLPADDING=2 WIDTH=486>            <TR>               <td width=181 align=left>                  <P><B>Event</B></P>               </TD>               <td width=209 align=left>                  <P><B>Version</B></P>               </TD>               <td align="left">                  <P><B>Stage</B></P>               </TD>            </TR>            <TR>               <td width=181 align=left>                  <P>First version</P>               </TD>               <td width=209 align=left>                  <P>1.0d1, 1.0d2, ...</P>               </TD>               <td align="left">                  <P>development</P>               </TD>            </TR>            <TR>               <td width=181 align=left>                  <P>Product feature defined (begin testing)</P>               </TD>               <td width=209 align=left>                  <P>1.0a1, 1.0a2, ...</P>               </TD>               <td align="left">                  <P>alpha</P>               </TD>            </TR>            <TR>               <td width=181 align=left>                  <P>Product is stable (begin final testing)</P>               </TD>               <td width=209 align=left>                  <P>1.0b1, 1.0b2, ...</P>               </TD>               <td align="left">                  <P>beta</P>               </TD>            </TR>            <TR>               <td width=181 align=left>                  <P>Final candidate (almost ready to ship)</P>               </TD>               <td width=209 align=left>                  <P>1.0fc1, 1.0fc2, ...</P>               </TD>               <td align="left">                  <P>final</P>               </TD>            </TR>            <TR>               <td width=181 align=left>                  <P>First revision shipped</P>               </TD>               <td width=209 align=left>                  <P>1.0</P>               </TD>               <td align="left">                  <P>final</P>               </TD>            </TR>            <TR>               <td width=181 align=left>                  <P>First revision</P>               </TD>               <td width=209 align=left>                  <P>1.1d1,...,1.1a1,...,1.1b1,...,1.1</P>               </TD>               <td align="left">                  <P></P>               </TD>            </TR>            <TR>               <td width=181 align=left>                  <P>First bug fix to first revision</P>               </TD>               <td width=209 align=left>                  <P>1.1.1d1,...,1.1.1a1,...,1.1.1b1,...,1.1.1</P>               </TD>               <td align="left">                  <P></P>               </TD>            </TR>            <TR>               <td width=181 align=left>                  <P>First major revision</P>               </TD>               <td width=209 align=left>                  <P>2.0d1,...,2.0a1,...,2.0b1,...,2.0</P>               </TD>               <td align="left">                  <P></P>               </TD>            </TR>         </TABLE>                           <BLOCKQUOTE><BLOCKQUOTE><B>Table 2-Development Version               Numbering</B></BLOCKQUOTE></BLOCKQUOTE>      <BR><P><A HREF="#top">Back to top</A></P><A NAME="ComparingVersionNumbers"></A>                  <H2>Comparing Version Numbers</H2>                  <P>A problem can arise when comparing version numbers by         casting them to unsigned longs. When compared this way,         Golden Master (GM) version numbers will compare as being         older than any of the final candidate versions.</P>                  <P>For the GM release of a file, the version resource will         have the <CODE>stage</CODE> field set to <CODE>final</CODE>         and the <CODE>nonRelRev</CODE> field set to zero. Most final         candidate releases will contain a version resource, which has         the <CODE>stage</CODE> field set to <CODE>final</CODE> and         the <CODE>nonRelRev</CODE> field set to some value greater         than zero. The problem here is that when the version numbers         are cast to unsigned longs, the nonzero value in the         <CODE>nonRelRev</CODE> field of final candidate version         resources causes it to compare as greater than--and thus newer         than--the GM version, which is in fact the newest version         available.</P>                  <P>In the past, this is most often a problem during         installations when installing the GM version of a package         over a perviously installed final candidate version of the         same package. The installer would complain that you are         trying to replace newer versions of the files in the package         when this is clearly not the case. The Apple installer (and         most other installers) avoid this problem by comparing the         individual fields of version resources.</P>                  <P>The following function will properly compare two         <CODE>NumVersion</CODE> values:</P>                  <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>pascal SInt16 CompareVersions( NumVersion *vers1, NumVersion *vers2 ){    UInt16 nonRelRev1, nonRelRev2;    if (vers1-&gt;majorRev        &gt; vers2-&gt;majorRev)        return  1;    if (vers1-&gt;majorRev        &lt; vers2-&gt;majorRev)        return -1;    if (vers1-&gt;minorAndBugRev  &gt; vers2-&gt;minorAndBugRev)  return  1;    if (vers1-&gt;minorAndBugRev  &lt; vers2-&gt;minorAndBugRev)  return -1;    if (vers1-&gt;stage           &gt; vers2-&gt;stage)           return  1;    if (vers1-&gt;stage           &lt; vers2-&gt;stage)           return -1;    nonRelRev1 = vers1-&gt;nonRelRev;    nonRelRev2 = vers2-&gt;nonRelRev;    if (vers1-&gt;stage == finalStage) {        if (vers1-&gt;nonRelRev == 0)             nonRelRev1 = 0xFFFF;        if (vers2-&gt;nonRelRev == 0)             nonRelRev2 = 0xFFFF;    }    if (nonRelRev1 &gt; nonRelRev2)                         return  1;    if (nonRelRev1 &lt; nonRelRev2)                         return -1;    return 0;}         </pre></TD></TR></TABLE></CENTER><BR><BR>       <BR><P><A HREF="#top">Back to top</A></P>                <A NAME="versresourcestructure"></A>                  <H2>'vers' Resource Structure</H2>                  <P>The structure of a 'vers' resource is defined in         <CODE>MacTypes.r</CODE> (from <a href="http://developer.apple.com/sdk/index.html">Universal         Interfaces 3.1</A>) as:</P>                  <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>type 'vers' {    hex byte;                       /* Major revision in BCD*/    hex byte;                       /* Minor revision in BCD*/    hex byte    development = 0x20, /* Release stage        */                alpha = 0x40,                beta = 0x60,                final = 0x80, /* or */ release = 0x80;    hex byte;                       /* Non-final release #  */    integer;                        /* Region code          */    pstring;                        /* Short version number */    pstring;                        /* Long version number  */};</pre></TD></TR></TABLE></CENTER><BR><BR>                  <P>The structure of the corresponding <CODE>VersRec</CODE>         type is defined in <code>MacTypes.h</code> (from <a href="http://developer.apple.com/sdk/index.html">Universal         Interfaces 3.1</A>) as:</P>                  <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>struct VersRec {                                 /* 'vers' resource format */    NumVersion  numericVersion;  /* encoded version number */    short       countryCode;     /* country code from intl utilities */    Str255      shortVersion;    /* version number string                                    - worst case */    Str255      reserved;        /* longMessage string packed                                    after shortVersion*/};typedef struct VersRec           VersRec;typedef VersRec *                VersRecPtr;typedef VersRecPtr *             VersRecHndl;</pre></TD></TR></TABLE></CENTER><BR><BR>                  <P>The structure of the <CODE>NumVersion</CODE> type is         defined in <code>MacTypes.h</code> (from <a href="http://developer.apple.com/sdk/index.html">Universal         Interfaces 3.1</A>) as:</P>                  <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>struct NumVersion {               /* Numeric version part of 'vers' resource */    UInt8      majorRev;       /* 1st part of version number in BCD*/    UInt8      minorAndBugRev; /* 2nd &amp; 3rd part of version number                                  share a byte*/    UInt8      stage;          /* stage code:                                  dev, alpha, beta, final*/    UInt8      nonRelRev;      /* revision level of non-released                                  version*/};typedef struct NumVersion      NumVersion;         </pre></TD></TR></TABLE></CENTER><BR><BR>                  <P>The structure of the <CODE>NumVersionVariant</CODE> type is defined in         <code>MacTypes.h</code> (from <a href="http://developer.apple.com/sdk/index.html">Universal         Interfaces 3.1</A>) as:</P>                  <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>union NumVersionVariant {                 /* NumVersionVariant is a wrapper so                    NumVersion can be accessed as a 32-bit value */    NumVersion       parts;    unsigned long    whole;};typedef union NumVersionVariant NumVersionVariant;         </pre></TD></TR></TABLE></CENTER><BR><BR><P>Mention of third-party sites and third-party products is forinformational purposes only, and constitutes neither an endorsementnor a recommendation. Apple assumes no responsibility with regard tothe selection, performance, or use of these vendors or products.</P>  <BR><P><A HREF="#top">Back to top</A></P><A NAME="References"></A><H2>References</H2><p><a href="http://developer.apple.com/documentation/mac/Toolbox/Toolbox-454.html">InsideMacintosh: Providing Version Resources</A></p>  <BR><P><A HREF="#top">Back to top</A></P><A NAME=Changes></A>                  <H2>Change History</H2>                    <TABLE BORDER=0 CELLPADDING=3 WIDTH=544>            <TR>               <td width=100 align=left>                  <P ALIGN=center>01-April-1988</P>               </TD>               <td align="left">                  <P>Originally written.</P>               </TD>            </TR>            <TR>               <td width=100 align=left>                  <P ALIGN=center>1-Oct-1990</P>               </TD>               <td align="left">                  <P>Revised as <i>Technote OV 12 --             Version Territory</i> to reflect the changes in MPW C 3.1</P>               </TD>            </TR>            <TR>               <td width=100 align=left>                  <P ALIGN=center>1-June-1998</P>               </TD>               <td align="left">                  <P>Updated to clarify the use of the <code>NumVersion</code> structure.</P>               </TD>            </TR>         </TABLE>    <BR><P><A HREF="#top">Back to top</A></P>        <A NAME="Downloads"></A>         <h2>Downloadables</h2>        <center><TABLE BORDER=0 CELLPADDING=3 WIDTH="600">         <TR>             <td width=50 align=left>               <P ALIGN=center><img src="images/acrobatsmall.gif" align=middle alt="Acrobat" width=22 height=23></P>            </TD>            <td align="left">               <p>Acrobat version of this Note (60K).</P>            </TD>            <td width=60 align=left>               <p><A HREF="pdf/tn1132.pdf">Download</A></P>            </TD>          </TR>           <TR>             <td width=50 align=left>               <P ALIGN=center><img src="images/acrobatsmall.gif" align=middle alt="Acrobat" width=22 height=23></P>            </TD>            <td align="left">               <p>Acrobat version of Inside Macintosh: Macintosh Toolbox         Essentials.</P>            </TD>            <td width=60 align=left>               <p><A HREF = "ftp://dev.apple.com/devworld/Technical_Documentation/Inside_Macintosh/Mac_Toolbox_Essentials/CompleteBookPkg/Mac_Toolbox_Essentials.sit.hqx">Download</A></P>            </TD>          </TR>            <TR>             <td width=50 align=left>               <P ALIGN=center><img src="images/bluebook.gif" width=22 height=23 align=bottom alt="Bluebook"></P>            </TD>            <td align="left">               <p>Universal Interfaces 3.1</P>            </TD>            <td width=60 align=left>               <p><a href="http://developer.apple.com/sdk/index.html">Download</A></P>            </TD>          </TR>                  </TABLE></center><BR><BR>         <BR><P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tn/tn1132.html%3Fid%3DDTS10002971-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tn/tn1132.html%3Fid%3DDTS10002971-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tn/tn1132.html%3Fid%3DDTS10002971-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>