<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Apple Filing Protocol Reference</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Apple Filing Protocol Reference"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40003548-DontLinkChapterID_1" title="Apple Filing Protocol Reference"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> &gt; <a href="../../../../../reference/Networking/index.html#//apple_ref/doc/uid/TP30001281-TP30000429" target="_top">Networking</a> &gt; <a href="../../../../../reference/Networking/idxMacOSXServer-date.html#//apple_ref/doc/uid/TP30001281-TP30000429-TP30000542" target="_top">Mac OS X Server</a> &gt; <a href="../index.html" target="_top">Apple Filing Protocol Reference</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <!-- Previous button --><span style="margin-left: 8px"><a href="../RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40003548-DontLinkChapterID_1-DontLinkElementID_9" title="Apple Filing Protocol Reference"></a><h1>Apple Filing Protocol Reference</h1><div class="spec_sheet_info_box"><table cellspacing="0" class="specbox"><tr><td scope="row"><strong><span class="noWrap">Companion guide</span></strong></td><td><div style="margin-bottom:1px"><span class="content_text"><a href="../../../Conceptual/AFP/index.html#//apple_ref/doc/uid/TP40000854" target="_top">Apple Filing Protocol Programming Guide</a></span><br/></div></td></tr></table></div><br/><a name="//apple_ref/doc/uid/TP40003548-CH1-DontLinkElementID_5" title="Overview"></a><h2>Overview</h2><p>This document describes the Apple Filing Protocol (AFP) commands, data types and constants that can be used to communicate with an AFP file server. AFP allows users of multiple computers to share files easily and efficiently over a network.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_1" title="Functions"></a><h2>Functions</h2><a name="//apple_ref/c/func/FPAccess" title="FPAccess"></a><a name="//apple_ref/doc/c_ref/FPAccess" title="FPAccess"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDHGEFA" title="FPAccess"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_11"></a><h3 class="tight">FPAccess</h3><p class="spaceabove">Requests access to a file or directory on a volume for which ACLs are enabled.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long DirectoryID
unsigned short Bitmap
16 bytes UUID
long ReqAccess
byte Pathtype
string Pathname
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPAccess</code> (75).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume identifier.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Directory identifier.</p></dd><dt><em>Bitmap</em></dt><dd><p>Reserved.</p></dd><dt><em>UUID</em></dt><dd><p>Universally Unique Identifier (UUID) of the process sending this command.</p></dd><dt><em>ReqAccess</em></dt><dd><p>Requested access. For definitions, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/ACL_Access_Rights">“ACL Access Rights.”</a></span></p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname to the file or directory for which access is being requested. <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if access is allowed. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-226832">Table 2</a></span> for other possible result codes.</p></dd></dl><h5 class="tight">Discussion</h5><p>The request is sent to the server, which determines whether to grant access. </p><p>Support for this command, as well as <code><a href="reference.html#//apple_ref/c/func/FPGetACL">FPGetACL</a></code> and <code><a href="reference.html#//apple_ref/c/func/FPSetACL">FPSetACL</a></code> is required in order to support access control lists (ACLs). Support for UTF-8 and UUIDs is also required in order to support ACLs.</p><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-226832">Table 2</a></span> lists the result codes for the <code>FPAccess</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-310117" title="Table 1Result codes for the FPAccess command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDHJBGJ" title="Table 1Result codes for the FPAccess command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 1&nbsp;&nbsp;</strong>Result codes for the <code>FPAccess</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to request access to the file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Input parameters do not point to an existing file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>A parameter is invalid.</p></td></tr></table></div><p><span class="content_text">Figure 1</span> shows the request block for the <code>FPAccess</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-307885" title="Figure 1Request block for the FPAccess command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCEHFE" title="Figure 1Request block for the FPAccess command"></a><p><strong>Figure 1&nbsp;&nbsp;</strong>Request block for the <code>FPAccess</code> command</p><img src = "../Art/afp_FPAccess.gif" alt = "Request block for the FPAccess command" width="132" height="466"></div><br/><h5 class="tight">Version Notes</h5><p>Introduced in AFP 3.2.</p><a name="//apple_ref/c/func/FPAddAPPL" title="FPAddAPPL"></a><a name="//apple_ref/doc/c_ref/FPAddAPPL" title="FPAddAPPL"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFHIHC" title="FPAddAPPL"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_12"></a><h3 class="tight">FPAddAPPL</h3><p class="spaceabove">Adds an APPL mapping to the Desktop database.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short DTRefNum
long DirectoryID
long FileCreator
long ApplTag
byte PathType
string Pathname
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPAddAPPL</code> (53).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>DTRefNum</em></dt><dd><p>Desktop database reference number.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Ancestor Directory ID.</p></dd><dt><em>FileCreator</em></dt><dd><p>File creator of the application corresponding to the APPL mapping being added.</p></dd><dt><em>ApplTag</em></dt><dd><p>User-defined tag stored with the APPL mapping.</p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname to the application corresponding to the APPL mapping being added. <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-226832">Table 2</a></span> for other possible result codes.</p></dd><dt><em>Reply block</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command adds the specified mapping to the volume’s Desktop database, including the application’s location, and file creator. If an APPL mapping for the same application (same filename, same directory, and same file creator) already exists, the mapping is replaced.</p><p>The user must have search or write privileges to all ancestors except the application’s parent directory, as well as write access to the parent directory.</p><p>There may be more than one application in the Desktop database’s list of APPL mappings for a given file creator. To distinguish among them, the <code>ApplTag</code> parameter is stored with each APPL mapping. The tag information may be used to decide among these multiple applications and is not interpreted by the Desktop database.</p><p>The user must have previously called <code><a href="reference.html#//apple_ref/c/func/FPOpenDT">FPOpenDT</a></code> for the corresponding volume. In addition, the application must be present in the specified directory before this command is sent.</p><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-226832">Table 2</a></span> lists the result codes for the <code>FPAddAPPL</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-226832" title="Table 2Result codes for the FPAddAPPL command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFFDCC" title="Table 2Result codes for the FPAddAPPL command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 2&nbsp;&nbsp;</strong>Result codes for the <code>FPAddAPPL</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to add an APPL mapping.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Input parameters do not point to an existing file.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectTypeErr</code></p></td><td ><p>Input parameters point to a directory.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference or Desktop database reference number is unknown; pathname is invalid.</p></td></tr></table></div><p><span class="content_text">Figure 2</span> shows the request block for the <code>FPAddAPPL</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-208935" title="Figure 2Request block for the FPAddAPPL command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEJDBB" title="Figure 2Request block for the FPAddAPPL command"></a><p><strong>Figure 2&nbsp;&nbsp;</strong>Request block for the <code>FPAddAPPL</code> command</p><img src = "../Art/afp_036.gif" alt = "Request block for the FPAddAPPL command" width="133" height="428"></div><br/><a name="//apple_ref/c/func/FPAddComment" title="FPAddComment"></a><a name="//apple_ref/doc/c_ref/FPAddComment" title="FPAddComment"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CJBJEJJF" title="FPAddComment"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_13"></a><h3 class="tight">FPAddComment</h3><p class="spaceabove">Adds a comment for a file or directory to a volume’s Desktop database.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short DTRefNum
long DirectoryID
byte PathType
string Pathname
string Comment
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPAddComment</code> (56).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>DTRefNum</em></dt><dd><p>Desktop database reference number.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Ancestor Directory ID.</p></dd><dt><em>PathType</em></dt><dd><p>Type of name in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname to the file or directory with which the comment is to be associated. <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Comment</em></dt><dd><p>Comment data to be associated with the specified file or directory.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-226979">Table 3</a></span> for other possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command stores the comment data in the Desktop database and associates the comment with the specified file or directory. If the comment is longer than 199 bytes, the comment is truncated to 199 bytes without returning an error.</p><p>To add a comment to a directory that is not empty, the user needs search access to all ancestors including the directory’s parent directory, as well as write access to the parent directory. To add a comment to an empty directory, the user needs search or write access to all ancestors except the directory’s parent directory, as well as write access to the parent directory.</p><p>To add a comment to a file that is not empty, the user needs search access to all ancestors except the file’s parent directory, as well as read and write access to the parent directory. To add a comment to an empty file, the user needs search or write access to all ancestors except the files’s parent directory, as well as write access to the parent directory.</p><p>The user must have previously called <code><a href="reference.html#//apple_ref/c/func/FPOpenDT">FPOpenDT</a></code> for the corresponding volume. In addition, the specified file or directory must be present in the specified directory before this command is sent.</p><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-226979">Table 3</a></span> lists the result codes for the <code>FPAddComment</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-226979" title="Table 3Result codes for the FPAddComment command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDDBGJD" title="Table 3Result codes for the FPAddComment command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 3&nbsp;&nbsp;</strong>Result codes for the <code>FPAddComment</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to add a comment.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound </code></p></td><td ><p>Input parameters do not point to an existing file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr></table></div><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-209091">Figure 3</a></span> shows the request block for the <code>FPAddComment </code>command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-209091" title="Figure 3Request block for the FPAddComment command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJIDDD" title="Figure 3Request block for the FPAddComment command"></a><p><strong>Figure 3&nbsp;&nbsp;</strong>Request block for the <code>FPAddComment</code> command</p><img src = "../Art/afp_037.gif" alt = "Request block for the FPAddComment command" width="277" height="407"></div><br/><a name="//apple_ref/c/func/FPAddIcon" title="FPAddIcon"></a><a name="//apple_ref/doc/c_ref/FPAddIcon" title="FPAddIcon"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBFGBJ" title="FPAddIcon"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_14"></a><h3 class="tight">FPAddIcon</h3><p class="spaceabove">Adds an icon bitmap to a volume’s Desktop database.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short DTRefNum
long FileCreator
long FileType
byte IconType
byte Pad
long IconTag
short BitmapSize
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPAddIcon</code> (192).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>DTRefNum</em></dt><dd><p>Desktop database reference number.</p></dd><dt><em>FileCreator</em></dt><dd><p>File creator associated with the icon that is to be added.</p></dd><dt><em>FileType</em></dt><dd><p>File type associated with the icon that is to be added.</p></dd><dt><em>IconType</em></dt><dd><p>Type of icon that is to be added.</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>IconTag</em></dt><dd><p>Tag information to be stored with the icon.</p></dd><dt><em>BitmapSize</em></dt><dd><p>Size of the bitmap for this icon.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred, <code>kFPParamErr</code> if the session reference number or the Desktop database reference number is unknown or if the pathname is invalid, <code>kFPIconTypeError</code> if the new icon’s size is different from the size of the existing icon, or <code>kFPMiscErr</code> if an error occurred that is not specific to AFP.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command adds the icon for the specified file creator and icon type to the Desktop database and associates the tag information with the icon. If an icon of the same file creator and icon type already exists in the database, the icon is replaced. However, if the new icon’s size is different from the old icon, the server returns a <code>kFPIconTypeError</code> result code.</p><p>The user must have previously called <code><a href="reference.html#//apple_ref/c/func/FPOpenDT">FPOpenDT</a></code> for the corresponding volume.</p><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-209173">Figure 4</a></span> shows the request block for the <code>FPAddIcon </code>command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-209173" title="Figure 4Request block for the FPAddIcon command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDHHFJJ" title="Figure 4Request block for the FPAddIcon command"></a><p><strong>Figure 4&nbsp;&nbsp;</strong>Request block for the <code>FPAddIcon</code> command</p><img src = "../Art/afp_038.gif" alt = "Request block for the FPAddIcon command" width="123" height="440"></div><br/><a name="//apple_ref/c/func/FPByteRangeLock" title="FPByteRangeLock"></a><a name="//apple_ref/doc/c_ref/FPByteRangeLock" title="FPByteRangeLock"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDHIGEG" title="FPByteRangeLock"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_15"></a><h3 class="tight">FPByteRangeLock</h3><p class="spaceabove">Locks or unlocks a specified range of bytes within an open fork.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Flags
short OForkRefNum
long Offset
long Length
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPByteRangeLock</code> (1).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>DTRefNum</em></dt><dd><p>Bit 0 is the <code>LockUnlock</code> bit, where 0 indicates lock and 1 indicates unlock. Bit 7 is the <code>StartEndFlag</code> bit, where 0 indicates that <code>Offset</code> is relative to the beginning of the fork and 1 indicates that <code>Offset</code> is relative to the end of the fork. The <code>StartEndFlag</code> bit is only used when locking a range.</p></dd><dt><em>OForkRefNum</em></dt><dd><p>Open fork reference number.</p></dd><dt><em>Offset</em></dt><dd><p>Offset to the first byte of the range to be locked or unlocked (can be negative if the StartEndFlag bit is set to 1).</p></dd><dt><em>Length</em></dt><dd><p>Number of bytes to be locked or unlocked (a signed, positive long integer; cannot be negative except for the special value $FFFFFFFF).</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-227102">Table 4</a></span> for possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code> and the reply is for an attempt to lock a range, the server returns a reply block. The reply block consists of a long, called <code>RangeStart</code>, containing the number of the first byte of the range that was locked.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command locks and unlocks the specified range of bytes within an open fork for use by a user application. When locking a range, the server returns the number of the first locked byte.</p><p>Bytes are numbered from 0 to $7FFFFFFF. The latter value is the maximum size of the fork. The end of fork is one more than the number of the last byte in the fork.</p><p>If no user holds a lock on any part of the requested range, the server locks the range specified by this command. A user can hold multiple locks within the same open fork, up to a server-specific limit. Locks cannot overlap. A locked range can start or extend past the end of fork; this does not move the end of fork or prevent another user from writing to the fork past the locked range. Setting <code>Offset</code> to zero, the <code>StartEndFlag</code> bit to zero (start), and <code>Length</code> to $FFFFFFFF locks the entire fork to the maximum size of the fork. Setting <code>Offset</code> to a value other than zero, the <code>StartEndFlag</code> bit to zero, and <code>Length</code> to $FFFFFFFF locks a range beginning at <code>Offset</code> and extending to the maximum size of the fork.</p><p>Setting the <code>StartEndFlag</code> bit to 1 (end) allows a lock to be offset relative to the end of the fork. This enables a user to set a lock when the user does not know the exact end of the fork, as can happen when multiple writers are concurrently modifying the fork. The server returns the number of the first locked byte.</p><p>Lock conflicts are determined by the value of <code>OForkRefNum</code>. That is, if a fork is opened twice, the two open fork reference numbers are considered two different “users” regardless of whether they were opened for the same or different sessions.</p><p>All locks held by a user are unlocked when the user closes the fork. Unlocking a range makes it available to other users for reading and writing. The server returns a result code of <code>kFPRangeNotLocked</code> if a user tries to unlock a range that was locked by another user or that was not locked at all.</p><p>To unlock a range, the <code>StartEndFlag</code> bit must be set to zero (start), <code>Length</code> must match the size of the range that was locked, and <code>Offset</code> must match the number of the first byte in the locked range. If the range was locked with the <code>StartEndFlag</code> bit set to zero (start), use the same value of <code>Offset</code> to unlock the range that was used to lock the range. If the range was locked with the <code>StartEndFlag</code> bit set to 1 (end), set <code>Offset</code> to the value of <code>RangeStart</code> that was returned by the server. You cannot unlock part of range.</p><p>Mac OS X supports memory-mapped files, but byte range locks should not be used in conjunction with them.</p><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-227102">Table 4</a></span> lists the result codes for the <code>FPByteRangeLock</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-227102" title="Table 4Result codes for the FPByteRangeLock command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDHEGHI" title="Table 4Result codes for the FPByteRangeLock command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 4&nbsp;&nbsp;</strong>Result codes for the <code>FPByteRangeLock</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPLockErr</code></p></td><td ><p>Some or all of the requested range is locked by another user.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPNoMoreLocks</code></p></td><td ><p>Server’s maximum lock count has been reached.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number or open fork reference number is unknown; a combination of the StartEndFlag bit and Offset specifies a range that starts before byte zero.</p></td></tr><tr><td  scope="row"><p><code>kFPRangeNotLocked </code></p></td><td ><p>User tried to unlock a range that is locked by another user or that is not locked at all.</p></td></tr><tr><td  scope="row"><p><code>kFPRangeOverlap</code></p></td><td ><p>User tried to lock some or all of a range that the user has already locked.</p></td></tr></table></div><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-209503">Figure 5</a></span> shows the request and reply blocks for the <code>FPByteRangeLock </code>command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-209503" title="Figure 5Request and reply blocks for the FPByteRangeLock command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBHCCD" title="Figure 5Request and reply blocks for the FPByteRangeLock command"></a><p><strong>Figure 5&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPByteRangeLock</code> command</p><img src = "../Art/afp_039.gif" alt = "Request and reply blocks for the FPByteRangeLock command" width="403" height="279"></div><br/><a name="//apple_ref/c/func/FPByteRangeLockExt" title="FPByteRangeLockExt"></a><a name="//apple_ref/doc/c_ref/FPByteRangeLockExt" title="FPByteRangeLockExt"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFACIA" title="FPByteRangeLockExt"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_16"></a><h3 class="tight">FPByteRangeLockExt</h3><p class="spaceabove">Locks or unlocks a specified range of bytes within an open fork.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Flags
short OForkRefNum
long long Offset
long long Length
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPByteRangeLockExt</code> (59).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>Flags</em></dt><dd><p>Bit 0 is the <code>LockUnlock</code> bit, where 0 indicates lock and 1 indicates unlock. Bit 7 is the <code>StartEndFlag</code> bit, where 0 indicates that <code>Offset</code> is relative to the beginning of the fork and 1 indicates that <code>Offset</code> is relative to the end of the fork. The <code>StartEndFlag</code> bit is only used when locking a range.</p></dd><dt><em>OForkRefNum</em></dt><dd><p>Open fork reference number.</p></dd><dt><em>Offset</em></dt><dd><p>Offset to the first byte of the range to be locked or unlocked (can be negative if the StartEndFlag bit is set to 1).</p></dd><dt><em>Length</em></dt><dd><p>Number of bytes to be locked or unlocked (a signed, positive long integer; cannot be negative except for the special value $FFFFFFFFFFFFFFFF).</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-227474">Table 5</a></span> for possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code> and the reply is for an attempt to lock a range, the server returns a reply block. The reply block consists of a long, called <code>RangeStart</code>, containing the number of the first byte of the range that was locked.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command locks and unlocks the specified range of bytes within an open fork for use by a user application. When locking a range, the server returns the number of the locked byte.</p><p>The <code>FPByteRangeLockExt</code> command differs from the <code>FPByteRangeLock</code> command in that the <code>FPByteRangeLockExt</code> command is prepared to handle large values that may be required for locking ranges for volumes larger than 4 GB in size.</p><p>Bytes are numbered starting from 0. The end of fork is one more than the number of the last byte in the fork.</p><p>If no user holds a lock on any part of the requested range, the server locks the range specified by this command. A user can hold multiple locks within the same open fork, up to a server-specific limit. Locks cannot overlap. A locked range can start or extend past the end of the fork; this does not move the end of the fork or prevent another user from writing to the fork past the locked range. Setting <code>Offset</code> to zero, the <code>StartEndFlag</code> bit to zero (start), and <code>Length</code> to $FFFFFFFFFFFFFFFF locks the entire for to the maximum size of the fork. Specifying an offset other than zero, the <code>StartEndFlag</code> bit to zero (start), and <code>Length</code> to $FFFFFFFFFFFFFFFF locks a range beginning at <code>Offset</code> and extending to the maximum size of the fork.</p><p>Setting the <code>StartEndFlag</code> bit to 1 (end) allows a lock to be offset relative to the end of the fork. This enables a user to set a lock when the user does not know the exact end of the fork, as can happen when multiple writers are concurrently modifying the fork. The server returns the number of the first locked byte.</p><p>Lock conflicts are determined by the value of <code>OForkRefNum</code>. That is, if a fork is opened twice, the two open fork reference numbers are considered two different “users” regardless of whether they were opened for the same or different sessions.</p><p>All locks held by a user are unlocked when the user closes the fork. Unlocking a range makes it available to other users for reading and writing. The server returns a result code of <code>kFPRangeNotLocked</code> if a user tries to unlock a range that was locked by another user or that was not locked at all.</p><p>To unlock a range, the <code>StartEndFlag</code> bit must be set to zero (start), <code>Length</code> must match the size of the range that was locked, and <code>Offset</code> must match the number of the first byte in the locked range. If the range was locked with <code>StartEndFlag</code> set to zero (start), use the same value of <code>Offset</code> to unlock the range that was used to lock the range. If the range was locked with the <code>StartEndFlag</code> bit set to 1 (end), set <code>Offset</code> to the value of <code>RangeStart</code> that was returned by the server. You cannot unlock part of range.</p><p>Mac OS X supports memory-mapped files, but byte range locks should not be used in conjunction with them.</p><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-227474">Table 5</a></span> lists the result codes for the <code>FPByteRangeLockExt</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-227474" title="Table 5Result codes for the FPByteRangeLockExt command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJCGBH" title="Table 5Result codes for the FPByteRangeLockExt command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 5&nbsp;&nbsp;</strong>Result codes for the <code>FPByteRangeLockExt</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPLockErr</code></p></td><td ><p>Some or all of the requested range is locked by another user.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPNoMoreLocks</code></p></td><td ><p>Server’s maximum lock count has been reached.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Open fork reference number is unknown; a combination of the StartEndFlag bit and Offset parameters specifies a range that starts before byte zero.</p></td></tr><tr><td  scope="row"><p><code>kFPRangeOverlap</code></p></td><td ><p>User tried to lock some or all of a range that the user has already locked.</p></td></tr><tr><td  scope="row"><p><code>kFPRangeNotLocked </code></p></td><td ><p>User tried to unlock a range that is locked by another user or that is not locked at all.</p></td></tr></table></div><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-227376">Figure 6</a></span> shows the request and reply blocks for the <code>FPByteRangeLockExt </code>command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-227376" title="Figure 6Request and reply blocks for the FPByteRangeLockExt command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDHFHFA" title="Figure 6Request and reply blocks for the FPByteRangeLockExt command"></a><p><strong>Figure 6&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPByteRangeLockExt</code> command</p><img src = "../Art/afp_024.gif" alt = "Request and reply blocks for the FPByteRangeLockExt command" width="402" height="447"></div><br/><a name="//apple_ref/c/func/FPCatSearch" title="FPCatSearch"></a><a name="//apple_ref/doc/c_ref/FPCatSearch" title="FPCatSearch"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBIIFJ" title="FPCatSearch"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_17"></a><h3 class="tight">FPCatSearch</h3><p class="spaceabove">Searches a volume for files and directories that match specified criteria.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long ReqMatches
long Reserved
16 bytes CatalogPosition
short FileRsltBitmap
short DirectoryRsltBitmap
long ReqBitmap
Specification1
Specification2
unsigned char Length
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPCatSearch</code> (43).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>The ID of the volume to search.</p></dd><dt><em>Reserved</em></dt><dd><p>Reserved; must be zero.</p></dd><dt><em>ReqMatches</em></dt><dd><p>The maximum number of matches to return.</p></dd><dt><em>CatalogPosition</em></dt><dd><p>Current position in the catalog.</p></dd><dt><em>FileRsltBitmap</em></dt><dd><p>File bitmap describing the file parameters to get or null to get directory parameters only. Set the bit that corresponds to each desired parameter. This bitmap is the same as the <code>FileBitmap</code> parameter of the <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> command with some restrictions described in the Discussion section. For bit definitions for this bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/File_Bitmap">File Bitmap</a></span>.</p></dd><dt><em>DirectoryRsltBitmap</em></dt><dd><p>Directory bitmap describing the directory parameters to get or null to get file parameters only. Set the bit that corresponds to each desired parameter. This bitmap is the same as the <code>DirectoryBitmap</code> parameter of the <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> command with some restrictions described in the Discussion section. For bit definitions for this bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Directory_Bitmap">Directory Bitmap</a></span>.</p></dd><dt><em>ReqBitmap</em></dt><dd><p>Directory and file parameters that are to be searched. For directory parameters only, see <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-210177">Figure 7</a></span>. For file parameters only, see <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-210216">Figure 8</a></span>. For directory and file parameters, see <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-210255">Figure 9</a></span>.</p></dd><dt><em>Specification1</em></dt><dd><p>Search criteria lower bounds and values.</p></dd><dt><em>Specification2</em></dt><dd><p>Optional search criteria upper bounds and masks.</p></dd><dt><em>Length</em></dt><dd><p>Length of this request block.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-227622">Table 6</a></span> for possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-227772">Table 7</a></span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command searches a volume for files and directories that match the specified criteria and returns an array of records that describe the matches that were found. The criteria can include most parameters in the File bitmap, the Directory bitmap, or both bitmaps, that are defined for the <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> command. Parameters for the matching files and directories are returned. These parameters can also be any of those specified by the <code>FPGEtFileDirParms</code> command.</p><p>The first word of the <code>CatalogPosition</code> parameter specifies whether the parameter denotes an actual catalog position or a hint. If the first word is zero, the search starts at the beginning of the volume. If the first word is non-zero, <code>CatalogPosition</code> is a actual catalog position and the search starts with this entry.</p><p>The <code>Specification1</code> and <code>Specification2</code> parameters are used together to specify the search parameters. These parameters are packed in the same order as the bits in <code>ReqBitmap</code>. All variable-length parameters (such as those containing names) are put at the end of each specification record. An offset is stored in the specification parameters to indicate where the actual variable-length parameter is located. This offset is measured from the start of the specification parameters (not including the length and filler bytes). Results are packed in the same way.</p><p>The fields in <code>Specification1</code> and <code>Specification2</code> have different uses:</p><ul class="ul"><li class="li"><p>In the name field, <code>Specification1</code> holds the target string; <code>Specification2</code> must always have a null name field.</p></li><li class="li"><p>In all date and length fields, <code>Specification1</code> holds the lowest value in the target range and <code>Specification2</code> holds the highest value in the target range.</p></li><li class="li"><p>In file attributes and Finder Info fields, <code>Specification1</code> holds the target value and <code>Specification2</code> holds the bitwise mask that specifies which bits in that field in <code>Specification1</code> are relevant to the current search.</p></li></ul><p>This command returns a result code of <code>kFPEOFErr</code> only when it has reached the end of the volume directory tree. For example, if the client requests ten matches, the server may return only four matches, without returning an error. The client should then send a request for six (ten minus four) more matches, using the same <code>CatalogPosition</code> value that was received in the previous reply. This process continues until the originally requested matches are received or a <code>kFPEOFErr</code> is returned. If this command returns a result code of <code>kFPCatalogChanged</code>, the client cannot continue the search. The client must restart the search by setting the first word of <code>CatalogPosition</code> to zero.</p><p>This command returns parameters for files, directories or both, depending on the value of the <code>FileRsltBitmap</code> and <code>DirectoryRsltBitmap</code> parameters. If <code>FileRsltBitmap</code> is null, this command assumes that you are not searching for files. Likewise, if <code>DirectoryRsltBitmap</code> is null, this command assumes that you are not searching for directories. If both parameters are non-zero, this command searches for files and directories. Note that if you are searching for both files and directories, certain restrictions apply with regard to the parameters that are searched. The rest of this section describes these restrictions.</p><p>The <code>ReqBitmap</code> parameter specifies the directory and file parameters to be searched. The low-order word of <code>ReqBitmap</code> is the same as low-order word of the File bitmap and the Directory bitmap used by the <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> command, with the exception of the Short Name parameter, which cannot be searched. The high bit of the high-order word of <code>ReqBitmap</code> indicates whether the search should match on full names or partial names (0 = full name, 1 = partial name). There is no equivalent to the fsSBNegate bit used by the Macintosh File Manager’s <code>PBCatSearch</code> function.</p><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-210177">Figure 7</a></span> shows parameters this command can search when it is searching directories only.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-210177" title="Figure 7Parameters FPCatSearch searches when searching directories only"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDGHGJG" title="Figure 7Parameters FPCatSearch searches when searching directories only"></a><p><strong>Figure 7&nbsp;&nbsp;</strong>Parameters <code>FPCatSearch</code> searches when searching directories only</p><img src = "../Art/afp_015.gif" alt = "Parameters FPCatSearch searches when searching directories only" width="326" height="164"></div><br/><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-210216">Figure 8</a></span> shows parameters this command can search when it is searching files only.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-210216" title="Figure 8Parameters FPCatSearch searches when searching files only"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIJBJD" title="Figure 8Parameters FPCatSearch searches when searching files only"></a><p><strong>Figure 8&nbsp;&nbsp;</strong>Parameters <code>FPCatSearch</code> searches when searching files only</p><img src = "../Art/afp_016.gif" alt = "Parameters FPCatSearch searches when searching files only" width="327" height="221"></div><br/><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-210255">Figure 9</a></span> shows parameters this command can search when it is searching both directories and files.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-210255" title="Figure 9Parameters FPCatSearch searches when searching directories and files"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBGEJD" title="Figure 9Parameters FPCatSearch searches when searching directories and files"></a><p><strong>Figure 9&nbsp;&nbsp;</strong>Parameters <code>FPCatSearch</code> searches when searching directories and files</p><img src = "../Art/afp_017.gif" alt = "Parameters FPCatSearch searches when searching directories and files" width="325" height="136"></div><br/><p>Before sending this command, the user must call <code><a href="reference.html#//apple_ref/c/func/FPOpenVol">FPOpenVol</a></code> for the volume that is to be searched.</p><p>To return all files and directories that match the specified criteria, the user must have Read Only or Read &amp; Write privileges for all directories. This command skips directories for which the user does not have Read Only or Read &amp; Write privileges.</p><p><span class="content_text">Table 6</span> lists the result codes for the <code>FPCatSearch</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-227622" title="Table 6Result codes for the FPCatSearch command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFBIFI" title="Table 6Result codes for the FPCatSearch command"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 6&nbsp;&nbsp;</strong>Result codes for the <code>FPCatSearch</code> command</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPCallNotSupported</code></p></td><td ><p>Server does not support this command.</p></td></tr><tr><td  scope="row"><p><code>kFPCatalogChanged</code></p></td><td ><p>Catalog has changed and CatalogPosition may be invalid. No matches were returned.</p></td></tr><tr><td  scope="row"><p><code>kFPEOFErr</code></p></td><td ><p>No more matches.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number, Volume ID, or pathname type is unknown; pathname is null or bad.</p></td></tr></table></div><p><span class="content_text">Table 7</span> describes the reply block for the <code>FPCatSearch </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-227772" title="Table 7Reply block for the FPCatSearch command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDDHBBF" title="Table 7Reply block for the FPCatSearch command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 7&nbsp;&nbsp;</strong>Reply block for the <code>FPCatSearch</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>CatalogPosition</code> (16 bytes)</p></td><td ><p>Current position in the catalog.</p></td></tr><tr><td  scope="row"><p><code>FileRsltBitmap</code> (short)</p></td><td ><p>Copy of the input bitmap.</p></td></tr><tr><td  scope="row"><p><code>DirectoryRsltBitmap</code> (short)</p></td><td ><p>Copy of the input bitmap.</p></td></tr><tr><td  scope="row"><p><code>ActualCount</code> (byte)</p></td><td ><p>Number of ResultsRecord structures that follow.</p></td></tr><tr><td  scope="row"><p>Zero or more <code>ResultsRecord</code> structures</p></td><td ><p>Array of <code>ResultsRecord</code> structures describing the matches that were found and having the following structure:<code>  StructLength</code> (byte) — Unsigned length of this structure including this byte and the byte for the <code>FileDir</code> bit.  <code>FileDir</code> (bit 7 of a one-byte value) — Whether the record is for a file (0) or directory (1).  <code>Results</code> — The matching Long Name, Parent Directory ID, or both with a trailing null byte if necessary to make the entire structure end on an even boundary.</p></td></tr></table></div><p><span class="content_text">Figure 10</span> shows the request and reply blocks for the <code>FPCatSearch</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-210536" title="Figure 10Request and reply blocks for the FPCatSearch command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBDBII" title="Figure 10Request and reply blocks for the FPCatSearch command"></a><p><strong>Figure 10&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPCatSearch</code> command</p><img src = "../Art/afp_018.gif" alt = "Request and reply blocks for the FPCatSearch command" width="419" height="539"></div><br/><a name="//apple_ref/c/func/FPCatSearchExt" title="FPCatSearchExt"></a><a name="//apple_ref/doc/c_ref/FPCatSearchExt" title="FPCatSearchExt"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDDFHJA" title="FPCatSearchExt"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_18"></a><h3 class="tight">FPCatSearchExt</h3><p class="spaceabove">Searches a volume for files and directories that match specified criteria.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long ReqMatches
long Reserved
16 bytes CatalogPosition
short FileRsltBitmap
short DirectoryRsltBitmap
long ReqBitmap
Specification1
Specification2
unsigned char Length
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPCatSearchExt</code> (67).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>ReqMatches</em></dt><dd><p>Maximum number of matches to return.</p></dd><dt><em>Reserved</em></dt><dd><p>Reserved; must be zero.</p></dd><dt><em>CatalogPosition</em></dt><dd><p>Current position in the catalog.</p></dd><dt><em>FileRsltBitmap</em></dt><dd><p>Bitmap describing the file parameters to get or null to get directory parameters only. Set the bit that corresponds to each desired parameter. This bitmap is the same as the <code>FileBitmap</code> parameter of the <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> command with some restrictions described later in this section. For bit definitions for this bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/File_Bitmap">File Bitmap</a></span>.</p></dd><dt><em>DirectoryRsltBitmap</em></dt><dd><p>Bitmap describing the directory parameters to get or null to get file parameters only. Set the bit that corresponds to each desired parameter. This bitmap is the same as the <code>DirectoryBitmap</code> parameter of the <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> command with some restrictions described later in this section. For bit definitions for this bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Directory_Bitmap">Directory Bitmap</a></span>.</p></dd><dt><em>ReqBitmap</em></dt><dd><p>Directory and file parameters that are to be searched. For directory parameters, see <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-210938">Figure 11</a></span>. For file parameters, see <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-210977">Figure 12</a></span>. For directory and file parameters, see <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-211016">Figure 13</a></span>.</p></dd><dt><em>Specification1</em></dt><dd><p>Search criteria lower bounds and values.</p></dd><dt><em>Specification2</em></dt><dd><p>Optional search criteria upper bounds and masks.</p></dd><dt><em>Length</em></dt><dd><p>Length of this request block.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-227998">Table 8</a></span> for possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-228145">Table 9</a></span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command searches a volume for files and directories that match the specified criteria and returns an array of records that describe the matches that were found.</p><p>This command differs from the <code><a href="reference.html#//apple_ref/c/func/FPCatSearch">FPCatSearch</a></code><code></code> command in that <code>FPCatSearchExt</code> is prepared to handle longer search results that can occur when searching volumes that are more than 4 GB in size.</p><p>The criteria can include most parameters in the File bitmap, the Directory bitmap, or both bitmaps, that are defined for the <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> command. Parameters for the matching files and directories are returned. These parameters can also be any of those specified by the <code>FPGetFileDirParms</code> command.</p><p>The first word of the <code>CatalogPosition</code> parameter specifies whether the parameter denotes an actual catalog position or a hint. If the first word is zero, the search starts at the beginning of the volume. If the first word is non-zero, <code>CatalogPosition</code> is an actual catalog position and the search starts with this entry.</p><p>The <code>Specification1</code> and <code>Specification2</code> parameters are used together to specify the search parameters. These parameters are packed in the same order as the bits in the <code>ReqBitmap</code>. All variable-length parameters (such as those containing names) are put at the end of each specification record. An offset is stored in the specification parameters to indicate where the actual variable-length parameter is located. This offset is measured from the start of the specification parameters (not including the length and filler bytes). Results are packed in the same way.</p><p>The fields in <code>Specification1</code> and <code>Specification2</code> have different uses:</p><ul class="ul"><li class="li"><p>In the name field, <code>Specification1</code> holds the target string; <code>Specification2</code> must always have a null name field.</p></li><li class="li"><p>In all date and length fields, <code>Specification1</code> holds the lowest value in the target range and <code>Specification2</code> holds the highest value in the target range.</p></li><li class="li"><p>In Attributes and Finder Info fields, <code>Specification1</code> holds the target value and <code>Specification2</code> holds the bitwise mask that specifies which bits in that field in <code>Specification1</code> are relevant to the current search.</p></li></ul><p>This command returns a result code of <code>kFPEOFErr</code> only when it has reached the end of the volume directory tree. For example, if the client requests ten matches, the server may return only four matches, without returning an error. The client should then send a request for six (ten minus four) more matches, using the same <code>CatalogPosition</code> value that was received in the previous reply. This process continues until the originally requested matches are received or a result code of <code>kFPEOFErr</code> is returned. If this command returns a result code of <code>kFPCatalogChanged</code>, the client cannot continue the search. The client must restart the search by setting the first word of <code>CatalogPosition</code> to zero.</p><p>This command returns parameters for files, directories or both, depending on the value of the <code>FileRsltBitmap</code> and <code>DirectoryRsltBitmap</code> parameters. If <code>FileRsltBitmap</code> is null, this command assumes that you are not searching for files. Likewise, if DirectoryRsltBitmap is null, this command assumes that you are not searching for directories. If both parameters are non-zero, this command searches for files and directories. Note that if you are searching for both files and directories, certain restrictions apply with regard to the parameters that are searched. The rest of this section describes these restrictions.</p><p>The <code>ReqBitmap</code> parameter specifies the directory and file parameters to be searched. The low-order word of <code>ReqBitmap</code> is the same as low-order word of the File bitmap and the Directory bitmap in <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code>, with the exception of the Short Name parameter, which cannot be searched. The high bit of the high-order word of <code>ReqBitmap</code> indicates whether the search should match on full names or partial names (0 = full name, 1 = partial name). There is no equivalent to the fsSBNegate bit used by the Macintosh File Manager’s <code>PBCatSearch</code> function.</p><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-210938">Figure 11</a></span> shows parameters this command can search when it is searching directories only.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-210938" title="Figure 11Parameters FPCatSearchExt searches when searching directories only"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBGCEI" title="Figure 11Parameters FPCatSearchExt searches when searching directories only"></a><p><strong>Figure 11&nbsp;&nbsp;</strong>Parameters <code>FPCatSearchExt</code> searches when searching directories only</p><img src = "../Art/afp_015.gif" alt = "Parameters FPCatSearchExt searches when searching directories only" width="326" height="164"></div><br/><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-210216">Figure 8</a></span> shows parameters this command can search when it is searching files only.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-210977" title="Figure 12Parameters FPCatSearchExt searches when searching files only"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEGDAJ" title="Figure 12Parameters FPCatSearchExt searches when searching files only"></a><p><strong>Figure 12&nbsp;&nbsp;</strong>Parameters <code>FPCatSearchExt</code> searches when searching files only</p><img src = "../Art/afp_016.gif" alt = "Parameters FPCatSearchExt searches when searching files only" width="327" height="221"></div><br/><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-210255">Figure 9</a></span> shows parameters this command can search when it is searching both directories and files.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-211016" title="Figure 13Parameters FPCatSearchExt searches when searching directories and files"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFEDEC" title="Figure 13Parameters FPCatSearchExt searches when searching directories and files"></a><p><strong>Figure 13&nbsp;&nbsp;</strong>Parameters <code>FPCatSearchExt</code> searches when searching directories and files</p><img src = "../Art/afp_017.gif" alt = "Parameters FPCatSearchExt searches when searching directories and files" width="325" height="136"></div><br/><p>Before sending this command, the user must call <code><a href="reference.html#//apple_ref/c/func/FPOpenVol">FPOpenVol</a></code> for the volume that is to be searched.</p><p>To return all files and directories that match the specified criteria, the user must have Read Only or Read &amp; Write privileges for all directories. This command skips directories for which the user does not have Read Only or Read &amp; Write privileges.</p><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-227998">Table 8</a></span> lists the result codes for the <code>FPCatSearchExt</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-227998" title="Table 8Result codes for the FPCatSearchExt command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIJGGI" title="Table 8Result codes for the FPCatSearchExt command"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 8&nbsp;&nbsp;</strong>Result codes for the <code>FPCatSearchExt</code> command</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPCallNotSupported</code></p></td><td ><p>Server does not support this command.</p></td></tr><tr><td  scope="row"><p><code>kFPCatalogChanged</code></p></td><td ><p>Catalog has changed and CatalogPosition may be invalid. No matches were returned.</p></td></tr><tr><td  scope="row"><p><code>kFPEOFErr</code></p></td><td ><p>No more matches.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number, Volume ID, or pathname type is unknown; pathname is null or bad.</p></td></tr></table></div><p><span class="content_text">Table 9</span> describes the reply block for the <code>FPCatSearchExt </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-228145" title="Table 9Reply block for the FPCatSearchExt command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIGBCG" title="Table 9Reply block for the FPCatSearchExt command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 9&nbsp;&nbsp;</strong>Reply block for the <code>FPCatSearchExt</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>CatalogPosition</code> (16 bytes)</p></td><td ><p>Current position in the catalog.</p></td></tr><tr><td  scope="row"><p><code>FileRsltBitmap</code> (short)</p></td><td ><p>Copy of the input bitmap.</p></td></tr><tr><td  scope="row"><p><code>DirectoryRsltBitmap</code> (short)</p></td><td ><p>Copy of the input bitmap.</p></td></tr><tr><td  scope="row"><p><code>ActualCount</code> (short)</p></td><td ><p>Number of <code>ResultsRecord</code> structures that follow.</p></td></tr><tr><td  scope="row"><p>Zero or more <code>ResultsRecord</code> structures</p></td><td ><p>Array of <code>ResultsRecord </code>structures describing the matches that were found and having the following structure:<code>  StructLength</code> (byte) — Unsigned length of this structure including this byte and the byte for the <code>FileDir</code> bit.  <code>FileDir</code> (bit 7 of a one-byte value) — Whether the record is for a file (0) or directory (1).  <code>Results</code> — The matching Long Name, Parent Directory ID, or both with a trailing null byte if necessary to make the entire structure end on an even boundary.</p></td></tr></table></div><p><span class="content_text">Figure 14</span> shows the request and reply blocks for the <code>FPCatSearchExt </code>command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-211303" title="Figure 14Request and reply blocks for the FPCatSearchExt command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEBAHI" title="Figure 14Request and reply blocks for the FPCatSearchExt command"></a><p><strong>Figure 14&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPCatSearchExt</code> command</p><img src = "../Art/afp_030.gif" alt = "Request and reply blocks for the FPCatSearchExt command" width="419" height="510"></div><br/><a name="//apple_ref/c/func/FPChangePassword" title="FPChangePassword"></a><a name="//apple_ref/doc/c_ref/FPChangePassword" title="FPChangePassword"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDDDDFE" title="FPChangePassword"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_19"></a><h3 class="tight">FPChangePassword</h3><p class="spaceabove">Allows users to change their passwords.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
string UAM
string UserName
UserAuthInfo
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPChangePassword</code> (36).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>UAM</em></dt><dd><p>String specifying the UAM to uses.</p></dd><dt><em>UserName</em></dt><dd><p>Name of the user whose password is to be changed. Starting with AFP 3.0, <code>UserName</code> is two bytes with each byte set to zero. The first byte indicates a zero length string, and the second byte is a pad byte.</p></dd><dt><em>UserAuthInfo</em></dt><dd><p>UAM-specific information.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-228377">Table 10</a></span> for other possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>If the UAM is <code>Cleartxt Passwrd</code>, the AFP client sends the server the user’s name plus the user’s old and new eight-byte passwords in cleartext. The server looks up the password for that user. If it matches the old password sent in the packet, the new password is saved for that user. For more information on the Cleartext Password UAM, see the section “Cleartext Password” in the “Introduction” section.</p><p>If the UAM is <code>Randnum Exchange</code>, DES is used to encrypt and decrypt passwords. The AFP client sends the server the user name, the user’s old eight-byte password encrypted with the user’s new eight-byte password, and the user’s new eight-byte password encrypted with the user’s old eight-byte password. The server looks up the password for that user, uses that password as a key to decrypt the new password, and uses the result to decrypt the old password. If the final result matches what the server knows to be the old password, the new password is saved for that user. For more information on the Random Number Exchange UAM, see the section “Random Number Exchange” in the “Introduction” section.</p><p>When using the Random Number Exchange UAM, be sure to append null bytes to any password that is less than eight bytes so that the resulting password has a length of eight bytes.</p><p>If the user logged in using the Two-Way Random Number Exchange UAM, the client uses the Randnum UAM for changing the user’s password.</p><p>If the UAM is <code>DHCAST128</code>, the AFP client must call <code>FPChangePassword</code> twice. The first time, the AFP client calls <code>FPChangePassword</code> to send the user name and a random number that has been encrypted. The server replies with an ID, a random number, and a nonce/server signature value encrypted by a session key. The AFP client calls <code>FPChangePassword</code> again, this time sending the user name and the ID returned by the server. The client also sends the nonce incremented by one, the new password, and the old password, all encrypted by the session key. For information on using the DHX UAM to change passwords, see the section “DHX and Changing a Password” in the “Introduction” section.</p><p>Servers are not required to support this command. Call <code><a href="reference.html#//apple_ref/c/func/FPGetSrvrInfo">FPGetSrvrInfo</a></code> to determine whether a server supports this command.</p><p>The user may not have been granted the ability to change his or her password. Granting the ability to change a password is an administrative function and is beyond the scope of this protocol specification.</p><p><span class="content_text">Table 10</span> lists the result codes for the <code>FPChangePassword </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-228377" title="Table 10Result codes for the FPChangePassword command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDICFCA" title="Table 10Result codes for the FPChangePassword command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 10&nbsp;&nbsp;</strong>Result codes for the <code>FPChangePassword</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPNoErr</code></p></td><td ><p>No error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPCallNotSupported</code></p></td><td ><p>Server does not support this command.</p></td></tr><tr><td  scope="row"><p><code>kFPUserNotAuth</code></p></td><td ><p>UAM failed (the specified old password doesn’t match) or no user is logged in yet for the specified session.</p></td></tr><tr><td  scope="row"><p><code>kFPBadUAM</code></p></td><td ><p>Specified UAM is not a UAM that <code>FPChangePassword</code> supports.</p></td></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to use this command.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>User name is null, exceeds the UAM’s user name length limit, or does not exist.</p></td></tr><tr><td  scope="row"><p><code>kFPPwdSameErr</code></p></td><td ><p>User attempted to change his or her password to the same password that he or she previously had. This error occurs only if the password expiration feature is enabled on the server.</p></td></tr><tr><td  scope="row"><p><code>kFPPwdTooShortErr</code></p></td><td ><p>User password is shorter than the server’s minimum password length, or user attempted to change password to a password that is shorter than the server’s minimum password length.</p></td></tr><tr><td  scope="row"><p><code>kFPPwdPolicyErr</code></p></td><td ><p>New password does not conform to the server’s password policy.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr></table></div><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-211682">Figure 15</a></span> shows the request block for the <code>FPChangePassword </code>command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-211682" title="Figure 15Request block for the FPChangePassword command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEIBCI" title="Figure 15Request block for the FPChangePassword command"></a><p><strong>Figure 15&nbsp;&nbsp;</strong>Request block for the <code>FPChangePassword</code> command</p><img src = "../Art/afp_040.gif" alt = "Request block for the FPChangePassword command" width="264" height="185"></div><br/><a name="//apple_ref/c/func/FPCloseDir" title="FPCloseDir"></a><a name="//apple_ref/doc/c_ref/FPCloseDir" title="FPCloseDir"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDHJBFE" title="FPCloseDir"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_20"></a><h3 class="tight">FPCloseDir</h3><p class="spaceabove">Closes a directory and invalidates its Directory ID.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long DirectoryID
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPCloseDir</code> (3).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Directory ID.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred, <code>kFPParamErr</code> if the session reference number, Volume ID, or Directory ID is unknown, or <code>kFPMiscErr</code> if an error occurred that is not specific to AFP.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command invalidates the Directory ID specified by DirectoryID.</p><p>This command should be used only for variable Directory ID volumes. The user must have previously called <code><a href="reference.html#//apple_ref/c/func/FPOpenVol">FPOpenVol</a></code> for this volume and <code><a href="reference.html#//apple_ref/c/func/FPOpenDir">FPOpenDir</a></code> for this directory.</p><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-211776">Figure 16</a></span> shows the request block for the <code>FPCloseDir</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-211776" title="Figure 16Request block for the FPCloseDir command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJBEAA" title="Figure 16Request block for the FPCloseDir command"></a><p><strong>Figure 16&nbsp;&nbsp;</strong>Request block for the <code>FPCloseDir</code> command</p><img src = "../Art/afp_041.gif" alt = "Request block for the FPCloseDir command" width="123" height="194"></div><br/><a name="//apple_ref/c/func/FPCloseDT" title="FPCloseDT"></a><a name="//apple_ref/doc/c_ref/FPCloseDT" title="FPCloseDT"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBAGFH" title="FPCloseDT"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_21"></a><h3 class="tight">FPCloseDT</h3><p class="spaceabove">Closes a volume’s Desktop database.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short DTRefNum
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPCloseDT</code> (49).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>DTRefNum</em></dt><dd><p>Desktop database reference number.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred, <code>kFPParamErr</code> if the session reference number or the Desktop database reference number is unknown, or <code>kFPMiscErr</code> if an error occurred that is not specific to AFP.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command invalidates the Desktop database reference number specified by <code>DTRefNum</code>.</p><p>The user must first have sent a successful <code><a href="reference.html#//apple_ref/c/func/FPOpenDT">FPOpenDT</a></code> command.</p><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-211865">Figure 17</a></span> shows the request block for the <code>FPCloseDT</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-211865" title="Figure 17Request block for the FPCloseDT command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJDJCE" title="Figure 17Request block for the FPCloseDT command"></a><p><strong>Figure 17&nbsp;&nbsp;</strong>Request block for the <code>FPCloseDT</code> command</p><img src = "../Art/afp_042.gif" alt = "Request block for the FPCloseDT command" width="123" height="107"></div><br/><a name="//apple_ref/c/func/FPCloseFork" title="FPCloseFork"></a><a name="//apple_ref/doc/c_ref/FPCloseFork" title="FPCloseFork"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFHBDJ" title="FPCloseFork"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_22"></a><h3 class="tight">FPCloseFork</h3><p class="spaceabove">Closes a fork.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short OForkRefNum
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPCloseFork</code> (4).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>OForkRefNum</em></dt><dd><p>Open fork reference number.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred, <code>kFPParamErr</code> if the session reference number or the open fork reference number is unknown, or <code>kFPMiscErr</code> if an error occurred that is not specific to AFP.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command causes the server to flush and close the specified fork, invalidating the open fork reference number. If the fork was written to, the file’s modification date is set to the server’s clock.</p><p>The user must first have sent a successful <code><a href="reference.html#//apple_ref/c/func/FPOpenFork">FPOpenFork</a></code> command.</p><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-211958">Figure 18</a></span> shows the request block for the <code>FPCloseFork</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-211958" title="Figure 18Request block for the FPCloseFork command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDDJECB" title="Figure 18Request block for the FPCloseFork command"></a><p><strong>Figure 18&nbsp;&nbsp;</strong>Request block for the <code>FPCloseFork</code> command</p><img src = "../Art/afp_043.gif" alt = "Request block for the FPCloseFork command" width="123" height="107"></div><br/><a name="//apple_ref/c/func/FPCloseVol" title="FPCloseVol"></a><a name="//apple_ref/doc/c_ref/FPCloseVol" title="FPCloseVol"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCDCIE" title="FPCloseVol"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_23"></a><h3 class="tight">FPCloseVol</h3><p class="spaceabove">Closes a volume.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPCloseVol</code> (2).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred, <code>kFPParamErr</code> if the session reference number or the Volume ID is unknown, or <code>kFPMiscErr</code> if an error occurred that is not specific to AFP.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command invalidates the specified Volume ID but does not necessarily close all open files on a volume before closing the volume, so you should close all open files before calling FPCloseVol.</p><p>The user must first have sent a successful <code><a href="reference.html#//apple_ref/c/func/FPOpenVol">FPOpenVol</a></code> command for this volume.</p><p>After sending this command, the user can send no other commands for this volume without opening the volume again.</p><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-212057">Figure 19</a></span> shows the request block for the <code>FPCloseVol</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-212057" title="Figure 19Request block for the FPCloseVol command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJHDDB" title="Figure 19Request block for the FPCloseVol command"></a><p><strong>Figure 19&nbsp;&nbsp;</strong>Request block for the <code>FPCloseVol</code> command</p><img src = "../Art/afp_044.gif" alt = "Request block for the FPCloseVol command" width="140" height="107"></div><br/><a name="//apple_ref/c/func/FPCopyFile" title="FPCopyFile"></a><a name="//apple_ref/doc/c_ref/FPCopyFile" title="FPCopyFile"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJJCJD" title="FPCopyFile"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_24"></a><h3 class="tight">FPCopyFile</h3><p class="spaceabove">Copies a file from one location to another on the same file server.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short SourceVolumeID
long SourceDirectoryID
short DestVolumeID
long DestDirectoryID
byte SourcePathType
string SourcePathname
byte DestPathType
string DestPathname
byte NewType
string NewName
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPCopyFile</code> (5).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>SourceVolumeID</em></dt><dd><p>Source Volume ID.</p></dd><dt><em>SourceDirectoryID</em></dt><dd><p>Source ancestor Directory ID.</p></dd><dt><em>DestVolumeID</em></dt><dd><p>Destination Volume ID.</p></dd><dt><em>DestDirectoryID</em></dt><dd><p>Destination ancestor Directory ID.</p></dd><dt><em>SourcePathType</em></dt><dd><p>Type of names in <code>SourcePathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>SourcePathname</em></dt><dd><p>Pathname of the file to be copied (cannot be null). <code>Source</code><code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>DestPathType</em></dt><dd><p>Type of names in <code>DestPathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>DestPathname</em></dt><dd><p>Pathname to the destination parent directory (may be null). <code>DestPathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>NewType</em></dt><dd><p>Type of name in <code>NewName</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>NewName</em></dt><dd><p>Name to be given to the copy (may be null).</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-228637">Table 11</a></span> for other possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command copies a file to a new location on the server. The source and destination can be on the same or on different volumes.</p><p>The server tries to open the source file for Read, DenyWrite access. If this fails, the server returns <code>kFPDenyConflict</code> as the result code. If the server successfully opens the file, it copies the file to the directory specified by the destination parameters.</p><p>The copy is given the name specified by the <code>NewName</code> parameter. If <code>NewName</code> is null, the server gives the copy the same name as the original. The file’s other name (Long, Short) is generated as described in the section “Catalog Node Names” in Chapter 1. A unique file number is assigned to the file. The server also sets the file’s Parent ID to the Directory ID of the destination parent directory. All other file parameters remain the same as the source file’s parameters. The modification date of the destination parent directory is set to the server’s lock.</p><p>The user must have search access to all ancestors of the source file, except the source parent directory, and read access to the source parent directory. Further, the user must have search or write access to all ancestors of the destination file, except the destination parent directory, and write access to the destination parent directory.</p><p>This command is optional and may not be supported by all servers.</p><p><span class="content_text">Table 11</span> lists the result codes for the <code>FPCopyFile</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-228637" title="Table 11Result codes for the FPCopyFile command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFCDCD" title="Table 11Result codes for the FPCopyFile command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 11&nbsp;&nbsp;</strong>Result codes for the <code>FPCopyFile</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to read the file or write to the destination.</p></td></tr><tr><td  scope="row"><p><code>kFPCallNotSupported </code></p></td><td ><p>Server does not support this command.</p></td></tr><tr><td  scope="row"><p><code>kFPDenyConflict</code></p></td><td ><p>File cannot be opened for Read, DenyWrite.</p></td></tr><tr><td  scope="row"><p><code>kFPDiskFull</code></p></td><td ><p>No more space exists on the destination volume.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectExists</code></p></td><td ><p>File or directory of the name specified by <code>NewName</code> already exists in the destination parent directory.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>The source file does not exist; ancestor directory is unknown.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectTypeErr</code></p></td><td ><p>Source parameters point to a directory.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Open fork reference number is unknown; a combination of the <code>StartEndFlag</code> bit and <code>Offset</code> parameters specifies a range that starts before byte zero.</p></td></tr></table></div><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-212368">Figure 20</a></span> shows the request block for the <code>FPCopyFile</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-212368" title="Figure 20Request block for the FPCopyFile command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDGCGAC" title="Figure 20Request block for the FPCopyFile command"></a><p><strong>Figure 20&nbsp;&nbsp;</strong>Request block for the <code>FPCopyFile</code> command</p><img src = "../Art/afp_045.gif" alt = "Request block for the FPCopyFile command" width="133" height="511"></div><br/><a name="//apple_ref/c/func/FPCreateDir" title="FPCreateDir"></a><a name="//apple_ref/doc/c_ref/FPCreateDir" title="FPCreateDir"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIAFAB" title="FPCreateDir"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_25"></a><h3 class="tight">FPCreateDir</h3><p class="spaceabove">Creates a new directory.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long DirectoryID
byte PathType
string Pathname
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPCreateDir</code> (6).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Ancestor Directory ID.</p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname, including the name of the new directory (cannot be null). <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8– encoded path.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-229268">Table 12</a></span> for other possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a long, called <code>NewDirectoryID</code>, containing the Directory ID of the new directory in the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command creates an empty directory having the name specified by the <code>Pathname</code> parameter. The file server assigns the directory a unique Directory ID and returns it in the reply block. The new directory’s Owner ID is set to the User ID of the user sending the command, and its Group ID is set to the ID of the user’s Primary Group ID, if a primary group has been specified for the user.</p><p>The new directory’s privileges are initially set to read, write, and search for the owner, with no privileges for a group or Everyone. Finder information is set to zero and all directory attributes are initially cleared. The directory’s creation and modification dates, as well as the modification date of the parent directory, are set to the server’s clock. The directory’s backup date is set to $80000000, signifying that the directory has never been backed up. The directory’s other names are generated as described in the section “Catalog Node Names” in Chapter 1.</p><p>The user must have search or write access to all ancestors, except this directory’s parent directory, as well as write access to the parent directory.</p><p><span class="content_text">Table 12</span> lists the result codes for the <code>FPCreateDir</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-229268" title="Table 12Result codes for the FPCreateDir command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIICIA" title="Table 12Result codes for the FPCreateDir command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 12&nbsp;&nbsp;</strong>Result codes for the <code>FPCreateDir</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to use this command.</p></td></tr><tr><td  scope="row"><p><code>kFPDiskFull</code></p></td><td ><p>No more space exists on the volume.</p></td></tr><tr><td  scope="row"><p><code>kFPFlatVol</code></p></td><td ><p>Volume is flat and does not support directories.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Ancestor directory is unknown.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectExists</code></p></td><td ><p>File or directory of the specified name already exists.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number, Volume ID, or pathname is null or invalid.</p></td></tr><tr><td  scope="row"><p><code>kFPVolLocked </code></p></td><td ><p>Destination volume is read-only.</p></td></tr></table></div><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-229387">Figure 21</a></span> shows the request and reply blocks for the <code>FPCreateDir</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-229387" title="Figure 21Request and reply blocks for the FPCreateDir command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBGDIC" title="Figure 21Request and reply blocks for the FPCreateDir command"></a><p><strong>Figure 21&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPCreateDir</code> command</p><img src = "../Art/afp_046.gif" alt = "Request and reply blocks for the FPCreateDir command" width="285" height="252"></div><br/><a name="//apple_ref/c/func/FPCreateFile" title="FPCreateFile"></a><a name="//apple_ref/doc/c_ref/FPCreateFile" title="FPCreateFile"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCAFFE" title="FPCreateFile"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_26"></a><h3 class="tight">FPCreateFile</h3><p class="spaceabove">Creates a new file.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Flag
short VolumeID
long DirectoryID
byte PathType
string Pathname
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPCreateFile</code> (7).</p></dd><dt><em>Flag</em></dt><dd><p>Bit 7 of the <code>Flag</code> parameter is the CreateFlag bit, where 0 indicates a soft create and 1 indicates a hard create.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Ancestor Directory ID.</p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname, including the name of the new file (cannot be null). <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-229507">Table 13</a></span> for other possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command creates an empty file having the name specified by <code>Pathname</code>. For a soft create, if a file by that name already exists, the server returns a result code of <code>kFPObjectExists</code>. Otherwise, it creates a new file and assigns it the name specified by <code>Pathname</code>. A unique file number is assigned to the file. Finder information is set to zero, and all file attributes are initially cleared. The file’s creation and modification dates, and the modification date of the file’s parent of the file’s parent directory, are set to the server’s clock. The file’s backup date is set to $80000000, signifying that this file has never been backed up. The file’s other names are generated as described in the section “Catalog Node Names” in Chapter 1. The lengths of both of the file’s forks are set to zero.</p><p>For a soft create, the user must have search or write access to all ancestors, except this file’s parent directory, as well as write access to the parent directory. For a hard create, the user must have search access to all ancestors, except the parent directory, as well as read and write access to the parent directory.</p><p>For a hard create, if the file already exists and is not open, the file is deleted and then recreated. All file parameters (including the creation date) are reinitialized as described above.</p><p><span class="content_text">Table 13</span> lists the result codes for the <code>FPCreateFile </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-229507" title="Table 13Result codes for the FPCreateFile command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBBIEF" title="Table 13Result codes for the FPCreateFile command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 13&nbsp;&nbsp;</strong>Result codes for the <code>FPCreateFile</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to use this command.</p></td></tr><tr><td  scope="row"><p><code>kFPDiskFull</code></p></td><td ><p>No more space exists on the volume.</p></td></tr><tr><td  scope="row"><p><code>kFPFileBusy</code></p></td><td ><p>If attempting a hard create, the file already exists and is open.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectExists</code></p></td><td ><p>If attempting a soft create, a file of the specified name already exists.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Ancestor directory is unknown.</p></td></tr><tr><td  scope="row"><p><code>kFPVolLocked </code></p></td><td ><p>Destination volume is read-only.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number, Volume ID, or pathname is null or invalid.</p></td></tr></table></div><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-212890">Figure 22</a></span> shows the request block for the <code>FPCreateFile</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-212890" title="Figure 22Request block for the FPCreateFile command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEJHCI" title="Figure 22Request block for the FPCreateFile command"></a><p><strong>Figure 22&nbsp;&nbsp;</strong>Request block for the <code>FPCreateFile</code> command</p><img src = "../Art/afp_047.gif" alt = "Request block for the FPCreateFile command" width="205" height="252"></div><br/><a name="//apple_ref/c/func/FPCreateID" title="FPCreateID"></a><a name="//apple_ref/doc/c_ref/FPCreateID" title="FPCreateID"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCAFBJ" title="FPCreateID"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_27"></a><h3 class="tight">FPCreateID</h3><p class="spaceabove">Creates a unique File ID for a file.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long DirectoryID
byte PathType
string Pathname
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPCreateID</code> (39).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Directory ID of the directory in which the file is to be created.</p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Name of the file that is the target of the File ID (that is, the filename of the file for which a File ID is being created). <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-229748">Table 14</a></span> for other possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>File IDs provide a way to keep track of a file even if its name or location changes. The scope of a File ID is limited to the files on a volume. File IDs cannot be used across volumes.</p><p>The AFP server should take steps to ensure that every File ID is unique and that no File ID is reused once it has been deleted.</p><p>The user must have the Read Only or the Read &amp; Write privilege to use this command.</p><p><span class="content_text">Table 14</span> lists the result codes for the <code>FPCreateID</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-229748" title="Table 14Result codes for the FPCreateID command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCJJBC" title="Table 14Result codes for the FPCreateID command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 14&nbsp;&nbsp;</strong>Result codes for the <code>FPCreateID</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Target file does not exist.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectTypeErr</code></p></td><td ><p>Object defined was a directory, not a file.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number, Volume ID, or pathname type is unknown; pathname is null or bad.</p></td></tr><tr><td  scope="row"><p><code>kFPVolLocked </code></p></td><td ><p>Destination volume is read-only.</p></td></tr></table></div><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-213126">Figure 23</a></span> shows the request block for the <code>FPCreateID</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-213126" title="Figure 23Request block for the FPCreateID command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCCIBB" title="Figure 23Request block for the FPCreateID command"></a><p><strong>Figure 23&nbsp;&nbsp;</strong>Request block for the <code>FPCreateID</code> command</p><img src = "../Art/afp_009.gif" alt = "Request block for the FPCreateID command" width="284" height="251"></div><br/><a name="//apple_ref/c/func/FPDelete" title="FPDelete"></a><a name="//apple_ref/doc/c_ref/FPDelete" title="FPDelete"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCCAIG" title="FPDelete"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_28"></a><h3 class="tight">FPDelete</h3><p class="spaceabove">Deletes a file or directory.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long DirectoryID
byte PathType
string Pathname
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPDelete</code> (8).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Ancestor Directory ID.</p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname of the file or directory to be deleted (may be null if a directory is to be deleted). <code>Pathname</code>is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-231867">Table 15</a></span> for other possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>When deleting a directory, the server checks to see if it contains any offspring. If a directory contains offspring, the server returns a result code of <code>kFPDirNotEmpty</code>. If a file that is to be deleted is open by any user, the server returns a result code of <code>kFPFileBusy</code>. The modification date of the parent directory of the deleted file or directory is set to the servers clock.</p><p>The user must have search access to all ancestors except the file or directory’s parent directory, as well as write access to the parent directory. If a directory is being deleted, the user must also have search access to the parent directory; for a file, the user must also have read access to the parent directory.</p><p>The AFP server identifies the Network Trash Folder by name, and that name is not localized in international versions of the Mac OS because it is invisible.</p><p><span class="content_text">Table 15</span> lists the result codes for the <code>FPDelete </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-231867" title="Table 15Result codes for the FPDelete command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJICGI" title="Table 15Result codes for the FPDelete command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 15&nbsp;&nbsp;</strong>Result codes for the <code>FPDelete</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to use this command.</p></td></tr><tr><td  scope="row"><p><code>kFPDirNotEmpty</code></p></td><td ><p>Directory is not empty.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectLocked</code></p></td><td ><p>File or directory is marked DeleteInhibit.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Input parameters do not point to an existing file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectTypeErr</code></p></td><td ><p>Object defined was a directory, not a file.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number, Volume ID, or pathname type is unknown; pathname is invalid.</p></td></tr><tr><td  scope="row"><p><code>kFPVolLocked </code></p></td><td ><p>Volume is read-only.</p></td></tr></table></div><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-213377">Figure 24</a></span> shows the request block for the <code>FPDelete</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-213377" title="Figure 24Request block for the FPDelete command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFEDEE" title="Figure 24Request block for the FPDelete command"></a><p><strong>Figure 24&nbsp;&nbsp;</strong>Request block for the <code>FPDelete</code> command</p><img src = "../Art/afp_048.gif" alt = "Request block for the FPDelete command" width="133" height="252"></div><br/><a name="//apple_ref/c/func/FPDeleteID" title="FPDeleteID"></a><a name="//apple_ref/doc/c_ref/FPDeleteID" title="FPDeleteID"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEGFCA" title="FPDeleteID"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_29"></a><h3 class="tight">FPDeleteID</h3><p class="spaceabove">Invalidates all instances of the specified File ID.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long FileID
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPDeleteID</code> (40).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>FileID</em></dt><dd><p>File ID that is to be deleted.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text">Table 16</span> for other possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command deletes the specified File ID, which was created by an earlier call to <code><a href="reference.html#//apple_ref/c/func/FPCreateID">FPCreateID</a></code>.</p><p>The user must have the Read Only or the Read &amp; Write access privilege to use this command.</p><p><span class="content_text">Table 16</span> lists the result codes for the<code> FPDeleteID </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-230000" title="Table 16Result codes for the FPDeleteID command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDHCFEH" title="Table 16Result codes for the FPDeleteID command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 16&nbsp;&nbsp;</strong>Result codes for the <code>FPDeleteID</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to use this command.</p></td></tr><tr><td  scope="row"><p><code>kFPCallNotSupported</code></p></td><td ><p>Server does not support this command.</p></td></tr><tr><td  scope="row"><p><code>kFPIDNotFound</code></p></td><td ><p>File ID was not found. (No file thread exists.)</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Target file does not exist. The File ID is deleted anyway.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectTypeErr</code></p></td><td ><p>Object defined was a directory, not a file.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number, Volume ID, or pathname type is unknown; pathname is null or bad.</p></td></tr><tr><td  scope="row"><p><code>kFPVolLocked </code></p></td><td ><p>Volume is read-only.</p></td></tr></table></div><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-213623">Figure 25</a></span> shows the request block for the <code>FPDeleteID</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-213623" title="Figure 25Request block for the FPDeleteID command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJBCFC" title="Figure 25Request block for the FPDeleteID command"></a><p><strong>Figure 25&nbsp;&nbsp;</strong>Request block for the <code>FPDeleteID</code> command</p><img src = "../Art/afp_010.gif" alt = "Request block for the FPDeleteID command" width="123" height="194"></div><br/><a name="//apple_ref/c/func/FPDisconnectOldSession" title="FPDisconnectOldSession"></a><a name="//apple_ref/doc/c_ref/FPDisconnectOldSession" title="FPDisconnectOldSession"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDDHEHH" title="FPDisconnectOldSession"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_30"></a><h3 class="tight">FPDisconnectOldSession</h3><p class="spaceabove">Disconnects an old session and transfers its resources to a new session.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short Type
long TokenLength
string Token
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPDisconnectOldSession</code> (65).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>Type</em></dt><dd><p>Volume ID.</p></dd><dt><em>TokenLength</em></dt><dd><p>Length of <code>Token</code>.</p></dd><dt><em>Token</em></dt><dd><p>Token previous obtained by calling <code><a href="reference.html#//apple_ref/c/func/FPGetSessionToken">FPGetSessionToken</a></code>.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred, <code>kFPCallNotSupported</code> if the server does not support this command, or <code>kFPMiscErr</code> if an error occurred that is not specific to AFP.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command disconnects the session identified by the Token parameter, which was obtained by previously calling <code><a href="reference.html#//apple_ref/c/func/FPGetSessionToken">FPGetSessionToken</a></code> and transfers the resources of the old session to the new session.</p><p>The AFP client calls this command when the session it previously established was inadvertently disconnected, it successfully establishes a new session, and it is able to restore the state of the previous session. If the AFP client cannot successfully reestablish the state of the previous session, it should call this command, log out, and report the failure to the local operating system.</p><p>If the AFP client successfully reestablishes the state of the previous session, it should call this command again to get a new session token.</p><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-213720">Figure 26</a></span> shows the request block for the <code>FPDisconnectOldSession</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-213720" title="Figure 26Request block for the FPDisconnectOldSession command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDHBEII" title="Figure 26Request block for the FPDisconnectOldSession command"></a><p><strong>Figure 26&nbsp;&nbsp;</strong>Request block for the <code>FPDisconnectOldSession</code> command</p><img src = "../Art/afp_033.gif" alt = "Request block for the FPDisconnectOldSession command" width="138" height="224"></div><br/><a name="//apple_ref/c/func/FPEnumerate" title="FPEnumerate"></a><a name="//apple_ref/doc/c_ref/FPEnumerate" title="FPEnumerate"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDDCJGA" title="FPEnumerate"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_31"></a><h3 class="tight">FPEnumerate</h3><p class="spaceabove">Lists the contents of a directory.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long DirectoryID
short FileBitmap
short DirectoryBitmap
short ReqCount
short StartIndex
short MaxReplySize
byte PathType
string Pathname
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPEnumerate</code> (9).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Identifier for the directory to list.</p></dd><dt><em>FileBitmap</em></dt><dd><p>Bitmap describing the parameters to return if the enumerated offspring is a file. Set the bit that corresponds to each desired parameter. This bitmap is the same as the <code>FileBitmap</code> parameter of the <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> command and can be null. For bit definitions for this bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/File_Bitmap">File Bitmap</a></span>.</p></dd><dt><em>DirectoryBitmap</em></dt><dd><p>Bitmap describing the parameters to return if the enumerated offspring is a directory. Set the bit that corresponds to each desired parameter. This bitmap is the same as the <code>DirectoryBitmap</code> parameter of the <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> command and can be null. For bit definitions for this bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Directory_Bitmap">Directory Bitmap</a></span>.</p></dd><dt><em>ReqCount</em></dt><dd><p>Maximum number of <code>ResultsRecord </code>structures for which information is to be returned.</p></dd><dt><em>StartIndex</em></dt><dd><p>Directory offspring index.</p></dd><dt><em>MaxReplySize</em></dt><dd><p>Maximum size of the reply block.</p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname to the desired directory. <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-230275">Table 17</a></span> for other possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-283080">Table 18</a></span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command enumerates a directory as specified by the input parameters. This command differs from the <code><a href="reference.html#//apple_ref/c/func/FPEnumerateExt">FPEnumerateExt</a></code> and <code><a href="reference.html#//apple_ref/c/func/FPEnumerateExt2">FPEnumerateExt2</a></code> commands in that it is not able to handle values that may be returned when volumes are larger than 4 GB in size.</p><p>If <code>FileBitmap</code> is null, only directory offspring are enumerated, and <code>StartIndex</code> can range from one to the total number of directory offspring. Similarly, if <code>DirectoryBitmap</code> is null, only file offspring are enumerated, and <code>StartIndex</code> can range from one to the total number of file offspring. If both bitmaps have bits set, <code>StartIndex</code> can range from one to the total number of offspring. In this case, offspring structures for both files and directories are returned. These structures are not returned in any particular order.</p><p>This command is completed when the number of structures specified by <code>ReqCount</code> has been inserted into the reply block, when the reply block is full, or when no more offspring exist to be enumerated. No partial offspring structures are returned.</p><p>The server retrieves the specified parameters for each enumerated offspring and packs them, in bitmap order, in structures in the reply block. The server inserts one copy of the input bitmaps before all of the structures.</p><p>The server needs to keep variable-length parameters, such as Long Name and Short Name, at the end of each structure. In order to do this, the server represents variable-length parameters in the bitmap order as fixed-length offsets (integers). Each offset is measured from the start of the parameters in each structure (not from the start of the bitmap or the start of the header bytes) to the start of the variable-length parameter. Each structure is padded (suffixed) with a null byte if necessary to make its length even.</p><p>If this command returns a result code of <code>kFPNoErr</code>, all structures in the reply block are valid. If any error result code is returned, no valid offspring structures are in the reply block.</p><p>If the OffSpring Count bit in the Directory bitmap is set, the server adjusts the Offspring Count of each directory to reflect the access rights the user has to that directory. For example, if a particular directory contains three file and two directory offspring, the server returns the Offspring Count as 2 if the user has only search access to the directory, 3 if the user has only read access to the directory, or 5 if the user has both search and read access to the directory.</p><p>The user must have search access to all ancestors except this directory. In addition, the user needs search access to this directory in order to enumerate directory offspring and read access in order to enumerate file offspring.</p><p>Enumerating a large directory may require the sending of several <code>FPEnumerate</code> commands. During that time, other users may add to or delete from the directory, so enumeration can miss offspring or return duplicate offspring. To enumerate a directory accurately, enumerate until a <code>kFPObjectNotFound</code> result code is returned and then filter out duplicate entries.</p><p>A given offspring is not guaranteed to occupy the same index number in the parent directory from one enumeration to the next.</p><p><span class="content_text">Table 17</span> lists the result codes for the <code>FPEnumerate</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-230275" title="Table 17Result codes for the FPEnumerate command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDGJIFB" title="Table 17Result codes for the FPEnumerate command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 17&nbsp;&nbsp;</strong>Result codes for the <code>FPEnumerate</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to use this command.</p></td></tr><tr><td  scope="row"><p><code>kFPBitmapErr</code></p></td><td ><p>Attempt was made to retrieve a parameter that cannot be retrieved by this command, an attempt was made to retrieve the Directory ID for a directory on a variable Directory ID volume, or both bitmaps are empty.</p></td></tr><tr><td  scope="row"><p><code>kFPDirNotFound</code></p></td><td ><p>Input parameters do not point to an existing directory.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>No more offspring exist to be enumerated.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectTypeErr</code></p></td><td ><p>Input parameters point to a file.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number, Volume ID, or pathname type is unknown, pathname is bad, or <code>MaxReplySize</code> is too small to hold a single offspring structure.</p></td></tr></table></div><p><span class="content_text">Table 18</span> describes the reply block for the <code>FPEnumerate</code><code></code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-283080" title="Table 18Reply block for the FPEnumerate command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIACFA" title="Table 18Reply block for the FPEnumerate command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 18&nbsp;&nbsp;</strong>Reply block for the <code>FPEnumerate</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>FileBitmap</code> (short)</p></td><td ><p>Copy of the input parameter.</p></td></tr><tr><td  scope="row"><p><code>DirectoryBitmap</code> (short)</p></td><td ><p>Copy of the input parameter.</p></td></tr><tr><td  scope="row"><p><code>ActualCount</code> (short)</p></td><td ><p>Actual number of <code>ResultsRecord </code>structures returned.</p></td></tr><tr><td  scope="row"><p>Zero or more <code>ResultsRecord </code>structures</p></td><td ><p>Array of <code>ResultsRecord</code> structures consisting of the following fields:<code>  StructLength</code> (byte) — Unsigned length of this structure, including this byte and the byte for the <code>FileDir</code> bit.<code>  FileDir</code> (bit) — Flag indicating whether the <code>OffspringParameters</code> field describes a file (0) or a directory (1).  <code>OffspringParameters</code> — Packed in bitmap order, with a trailing null byte if necessary to make the length of the entire structure an even number.</p></td></tr></table></div><p><span class="content_text">Figure 27</span> shows the request and reply blocks for the <code>FPEnumerate</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-214221" title="Figure 27Request and reply blocks for the FPEnumerate command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDGAAGI" title="Figure 27Request and reply blocks for the FPEnumerate command"></a><p><strong>Figure 27&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPEnumerate</code> command</p><img src = "../Art/afp_029.gif" alt = "Request and reply blocks for the FPEnumerate command" width="434" height="474"></div><br/><a name="//apple_ref/c/func/FPEnumerateExt" title="FPEnumerateExt"></a><a name="//apple_ref/doc/c_ref/FPEnumerateExt" title="FPEnumerateExt"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDDBBJI" title="FPEnumerateExt"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_32"></a><h3 class="tight">FPEnumerateExt</h3><p class="spaceabove">Lists the contents of a directory.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long DirectoryID
short FileBitmap
short DirectoryBitmap
short ReqCount
short StartIndex
short MaxReplySize
byte PathType
string Pathname
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPEnumerateExt</code> (66).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Identifier for the directory to list.</p></dd><dt><em>FileBitmap</em></dt><dd><p>Bitmap describing the parameters to return if the enumerated offspring is a file. Set the bit that corresponds to each desired parameter. This bitmap is the same as the <code>FileBitmap</code> parameter of the <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> command and can be null. For bit definitions for this bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/File_Bitmap">File Bitmap</a></span>.</p></dd><dt><em>DirectoryBitmap</em></dt><dd><p>Bitmap describing the parameters to return if the enumerated offspring is a directory. Set the bit that corresponds to each desired parameter. This bitmap is the same as the <code>DirectoryBitmap</code> parameter of the <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> command and can be null. For bit definitions for this bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Directory_Bitmap">Directory Bitmap</a></span>.</p></dd><dt><em>ReqCount</em></dt><dd><p>Maximum number of <code>ResultsRecord</code> structures for which information is to be returned.</p></dd><dt><em>StartIndex</em></dt><dd><p>Directory offspring index.</p></dd><dt><em>MaxReplySize</em></dt><dd><p>Maximum size of the reply block.</p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname to the desired directory. <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-230723">Table 19</a></span> for other possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-230943">Table 20</a></span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command enumerates a directory as specified by the input parameters. This command differs from the <code><a href="reference.html#//apple_ref/c/func/FPEnumerate">FPEnumerate</a></code> command in that this command is prepared to handle values that may be returned when volumes are larger than 4 GB in size. This command also differs from the <code><a href="reference.html#//apple_ref/c/func/FPEnumerateExt2">FPEnumerateExt2</a></code> command in that StartIndex and MaxReplySize are shorts (instead of longs), which may limit the number of entries in a single directory that can be listed. The reply block for this command is the same as the reply block for <code>FPEnumerateExt2</code>.</p><p>If <code>FileBitmap</code> is null, only directory offspring are enumerated, and <code>StartIndex</code> can range from one to the total number of directory offspring. Similarly, if the <code>DirectoryBitmap</code> is null, only file offspring are enumerated, and <code>StartIndex</code> can range from one to the total number of file offspring. If both bitmaps have bits set, <code>StartIndex</code> can range from one to the total number of offspring. In this case, offspring structures for both files and directories are returned. These structures are not returned in any particular order.</p><p>This command is completed when the number of structures specified by <code>ReqCount</code> has been inserted into the reply block, when the reply block is full, or when no more offspring exist to be enumerated. No partial offspring structures are returned.</p><p>The server retrieves the specified parameters for each enumerated offspring and packs them, in bitmap order, in structures in the reply block. The server inserts one copy of the input bitmaps before all of the structures.</p><p>The server needs to keep variable-length parameters, such as Long Name and Short Name, at the end of each structure. In order to do this, the server represents variable-length parameters in the bitmap order as fixed-length offsets (integers). Each offset is measured from the start of the parameters in each structure (not from the start of the bitmap or the start of the header bytes) to the start of the variable-length parameter. Each structure will be padded (suffixed) with a null byte if necessary to make its length even.</p><p>If <code>kFPNoErr</code> is returned, all structures in the reply block are valid. If any error result code is returned, no valid offspring structures exist in the reply block.</p><p>If the OffSpring Count bit in the Directory bitmap is set, the server adjusts the Offspring Count of each directory to reflect what access rights the user has to that directory. For example, if a particular directory contains three file and two directory offspring, the server will return its Offspring Count as 2 if the user has only search access to the directory, 3 if the user has only read access to the directory, or 5 if the user has both search and read access to the directory.</p><p>The user must have search access to all ancestors except this directory. In addition, the user needs search access to this directory in order to enumerate directory offspring and read access in order to enumerate file offspring.</p><p>Enumerating a large directory may require the sending of several <code>FPEnumerateExt</code> commands. During that time, other users may add to or delete from the directory, so enumeration can miss offspring or return duplicate offspring. To enumerate a directory accurately, enumerate until a <code>kFPObjectNotFound</code> result code is returned and then filter out duplicate entries.</p><p>A given offspring is not guaranteed to occupy the same index number in the parent directory from one enumeration to the next.</p><p><span class="content_text">Table 19</span> lists the result codes for the <code>FPEnumerateExt</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-230723" title="Table 19Result codes for the FPEnumerateExt command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDDHCHA" title="Table 19Result codes for the FPEnumerateExt command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 19&nbsp;&nbsp;</strong>Result codes for the <code>FPEnumerateExt</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to use this command.</p></td></tr><tr><td  scope="row"><p><code>kFPBitmapErr</code></p></td><td ><p>Attempt was made to retrieve a parameter that cannot be retrieved by this command, an attempt was made to retrieve the Directory ID for a directory on a variable Directory ID volume, or both bitmaps are empty.</p></td></tr><tr><td  scope="row"><p><code>kFPDirNotFound</code></p></td><td ><p>Input parameters do not point to an existing directory.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>No more offspring exist to be enumerated.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectTypeErr</code></p></td><td ><p>Input parameters point to a file.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number, Volume ID, or pathname type is unknown, pathname is bad, or <code>MaxReplySize</code> is too small to hold a single offspring structure.</p></td></tr></table></div><p><span class="content_text">Table 20</span> describes the reply block for the <code>FPEnumerateExt </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-230943" title="Table 20Reply block for the FPEnumerateExt command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBIBHF" title="Table 20Reply block for the FPEnumerateExt command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 20&nbsp;&nbsp;</strong>Reply block for the <code>FPEnumerateExt</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>DirectoryBitmap</code> (short)</p></td><td ><p>Copy of the input parameter.</p></td></tr><tr><td  scope="row"><p><code>ActualCount</code> (short)</p></td><td ><p>Actual number of <code>ResultsRecord </code>structures returned.</p></td></tr><tr><td  scope="row"><p>Zero or more <code>ResultsRecord </code>structures</p></td><td ><p>An array of <code>ResultsRecord</code> structure consisting of the following fields:<code>  StructLength</code> (byte) — Unsigned length of this structure, including this byte and the byte for the <code>FileDir</code> bit.<code>  FileDir</code> (bit) — Flag indicating whether the <code>OffspringParameters</code> field describes a file (0) or a directory (1).<code>  Pad (byte) — Always zero.  OffspringParameters</code> — Packed in bitmap order, with a trailing null byte if necessary to make the length of the entire structure an even number.</p></td></tr></table></div><p><span class="content_text">Figure 28</span> shows the request and reply blocks for the <code>FPEnumerateExt</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-214734" title="Figure 28Request and reply blocks for the FPEnumerateExt command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCBFAC" title="Figure 28Request and reply blocks for the FPEnumerateExt command"></a><p><strong>Figure 28&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPEnumerateExt</code> command</p><img src = "../Art/afp_049.gif" alt = "Request and reply blocks for the FPEnumerateExt command" width="434" height="465"></div><br/><a name="//apple_ref/c/func/FPEnumerateExt2" title="FPEnumerateExt2"></a><a name="//apple_ref/doc/c_ref/FPEnumerateExt2" title="FPEnumerateExt2"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJJHID" title="FPEnumerateExt2"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_33"></a><h3 class="tight">FPEnumerateExt2</h3><p class="spaceabove">Lists the contents of a directory.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long DirectoryID
short FileBitmap
short DirectoryBitmap
short ReqCount
long StartIndex
long MaxReplySize
byte PathType
string Pathname
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPEnumerateExt2</code> (68).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Identifier for the directory to list.</p></dd><dt><em>FileBitmap</em></dt><dd><p>Bitmap describing the parameters to return if the enumerated offspring is a file. Set the bit that corresponds to each desired parameter. This bitmap is the same as the <code>FileBitmap</code> parameter of the <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> command and can be null. For bit definitions for this bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/File_Bitmap">File Bitmap</a></span>.</p></dd><dt><em>DirectoryBitmap</em></dt><dd><p>Bitmap describing the parameters to return if the enumerated offspring is a directory. Set the bit that corresponds to each desired parameter. This bitmap is the same as the <code>DirectoryBitmap</code> parameter of the <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> command and can be null. For bit definitions for this bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Directory_Bitmap">Directory Bitmap</a></span>.</p></dd><dt><em>ReqCount</em></dt><dd><p>Maximum number of <code>ResultsRecord</code> structures for which information is to be returned.</p></dd><dt><em>StartIndex</em></dt><dd><p>Directory offspring index.</p></dd><dt><em>StartIndex</em></dt><dd><p>Maximum size of the reply block.</p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname to the desired directory. <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-231174">Table 21</a></span> for other possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-231500">Table 22</a></span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command enumerates a directory as specified by the input parameters. This command differs from the <code><a href="reference.html#//apple_ref/c/func/FPEnumerateExt">FPEnumerateExt</a></code> command in that <code>StartIndex</code> and <code>MaxReplySize</code> are longs instead of shorts, thereby allowing this command to list more entries in a single directory. The reply block for this command is the same as the reply block for the <code>FPEnumerateExt</code> command.</p><p>If <code>FileBitmap</code> is null, only directory offspring are enumerated, and <code>StartIndex</code> can range from one to the total number of directory offspring. Similarly, if the <code>DirectoryBitmap</code> is null, only file offspring are enumerated, and <code>StartIndex</code> can range from one to the total number of file offspring. If both bitmaps have bits set, <code>StartIndex</code> can range from one to the total number of offspring. In this case, offspring structures for both files and directories are returned. These structures are not returned in any particular order.</p><p>This command is completed when the number of structures specified by <code>ReqCount</code> has been inserted into the reply block, when the reply block is full, or when no more offspring exist to be enumerated. No partial offspring structures are returned.</p><p>The server retrieves the specified parameters for each enumerated offspring and packs them, in bitmap order, in structures in the reply block. The server inserts one copy of the input bitmaps before all of the structures.</p><p>The server needs to keep variable-length parameters, such as Long Name and Short Name, at the end of each structure. In order to do this, the server represents variable-length parameters in the bitmap order as fixed-length offsets (integers). Each offset is measured from the start of the parameters in each structure (not from the start of the bitmap or the start of the header bytes) to the start of the variable-length parameter. Each structure will be padded (suffixed) with a null byte if necessary to make its length even.</p><p>If <code>kFPNoErr</code> is returned, all structures in the reply block are valid. If any error result code is returned, no valid offspring structures exist in the reply block.</p><p>If the OffSpring Count bit in the Directory bitmap is set, the server adjusts the Offspring Count of each directory to reflect what access rights the user has to that directory. For example, if a particular directory contains three file and two directory offspring, the server will return its Offspring Count as 2 if the user has only search access to the directory, 3 if the user has only read access to the directory, or 5 if the user has both search and read access to the directory.</p><p>The user must have search access to all ancestors except this directory. In addition, the user needs search access to this directory in order to enumerate directory offspring and read access in order to enumerate file offspring.</p><p>Enumerating a large directory may require the sending of several <code>FPEnumerateExt2</code> commands. During that time, other users may add to or delete from the directory, so enumeration can miss offspring or return duplicate offspring. To enumerate a directory accurately, enumerate until a <code>kFPObjectNotFound</code> result code is returned and then filter out duplicate entries.</p><p>A given offspring is not guaranteed to occupy the same index number in the parent directory from one enumeration to the next.</p><p><span class="content_text">Table 21</span> lists the result codes for the <code>FPEnumerateExt2</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-231174" title="Table 21Result codes for the FPEnumerateExt2 command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCEFEG" title="Table 21Result codes for the FPEnumerateExt2 command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 21&nbsp;&nbsp;</strong>Result codes for the <code>FPEnumerateExt2</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to use this command.</p></td></tr><tr><td  scope="row"><p><code>kFPBitmapErr</code></p></td><td ><p>Attempt was made to retrieve a parameter that cannot be retrieved by this command, an attempt was made to retrieve the Directory ID for a directory on a variable Directory ID volume, or both bitmaps are empty.</p></td></tr><tr><td  scope="row"><p><code>kFPDirNotFound</code></p></td><td ><p>Input parameters do not point to an existing directory.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>No more offspring exist to be enumerated.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectTypeErr</code></p></td><td ><p>Input parameters point to a file.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number, Volume ID, or pathname type is unknown, pathname is bad, or <code>MaxReplySize</code> is too small to hold a single offspring structure.</p></td></tr></table></div><p><span class="content_text">Table 22</span> describes the reply block for the <code>FPEnumerateExt2 </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-231500" title="Table 22Reply block for the FPEnumerateExt2 command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFAFJE" title="Table 22Reply block for the FPEnumerateExt2 command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 22&nbsp;&nbsp;</strong>Reply block for the <code>FPEnumerateExt2</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>FileBitmap</code> (short)</p></td><td ><p>Copy of the input parameter.</p></td></tr><tr><td  scope="row"><p><code>DirectoryBitmap</code> (short)</p></td><td ><p>Copy of the input parameter.</p></td></tr><tr><td  scope="row"><p><code>ActualCount</code> (short)</p></td><td ><p>Actual number of <code>ResultsRecord </code>structures returned.</p></td></tr><tr><td  scope="row"><p>Zero or more <code>ResultsRecord </code>structures</p></td><td ><p>An array of <code>ResultsRecord</code> structures, each consisting of the following fields:<code>  StructLength</code> (byte) — Unsigned length of this structure, including this byte and the byte for the <code>FileDir</code> bit.<code>  FileDir</code> (bit) — Flag indicating whether the <code>OffspringParameters</code> field describes a file (0) or a directory (1).  Pad (byte) — Always zero.  <code>OffspringParameters</code> — Packed in bitmap order, with a trailing null byte if necessary to make the length of the entire structure an even number.</p></td></tr></table></div><p><span class="content_text">Figure 29</span> shows the request and reply blocks for the <code>FPEnumerateExt2</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-215252" title="Figure 29Request and reply blocks for the FPEnumerateExt2 command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJIGEB" title="Figure 29Request and reply blocks for the FPEnumerateExt2 command"></a><p><strong>Figure 29&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPEnumerateExt2</code> command</p><img src = "../Art/afp_085.gif" alt = "Request and reply blocks for the FPEnumerateExt2 command" width="434" height="556"></div><br/><a name="//apple_ref/c/func/FPExchangeFiles" title="FPExchangeFiles"></a><a name="//apple_ref/doc/c_ref/FPExchangeFiles" title="FPExchangeFiles"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDHDAJI" title="FPExchangeFiles"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_34"></a><h3 class="tight">FPExchangeFiles</h3><p class="spaceabove">Preserves existing File IDs when performing a Save or a Save As operation.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long SourceDirectoryID
long DestDirectoryID
byte SourcePathType
string SourcePathname
byte DestPathType
string DestPathname
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPExchangeFiles</code> (42).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>SourceDirectoryID</em></dt><dd><p>Identifier of the directory containing the source file.</p></dd><dt><em>DestDirectoryID</em></dt><dd><p>Identifier of the directory containing the destination file.</p></dd><dt><em>SourcePathType</em></dt><dd><p>Type of names in <code>SourcePathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>SourcePathname</em></dt><dd><p>Pathname of the source file. <code>SourcePathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>DestPathType</em></dt><dd><p>Type of names in <code>DestPathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>DestPathname</em></dt><dd><p>Pathname of the source file. <code>DestPathname </code>is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-232050">Table 23</a></span> for other possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>To use this command, both files must exist on the same volume. File IDs do not, however, have to exist on the files to be exchanged. The files being exchanged can be open or closed.</p><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-215338">Figure 30</a></span> shows the results of an exchange operation between two files named Blue and Red.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-215338" title="Figure 30Example of exchanging files"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEGADJ" title="Figure 30Example of exchanging files"></a><p><strong>Figure 30&nbsp;&nbsp;</strong>Example of exchanging files</p><img src = "../Art/afp_012.gif" alt = "Example of exchanging files" width="417" height="426"></div><br/><p>Notice that only the filename, Parent Directory ID, File ID, and creation dates are exchanged. Byte-range locks and deny modes still apply to the same file reference number and data.</p><p>The user must have the Read &amp; Write privilege for both files in order to use this command.</p><p><span class="content_text">Table 23</span> lists the result codes for the <code>FPExchangeFiles</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-232050" title="Table 23Result codes for the FPExchangeFiles command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIHCBE" title="Table 23Result codes for the FPExchangeFiles command"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 23&nbsp;&nbsp;</strong>Result codes for the <code>FPExchangeFiles</code> command</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to use this command.</p></td></tr><tr><td  scope="row"><p><code>kFPBadIDErr</code></p></td><td ><p>File ID is not valid.</p></td></tr><tr><td  scope="row"><p><code>kFPCallNotSupported</code></p></td><td ><p>Server does not support this command.</p></td></tr><tr><td  scope="row"><p><code>kFPIDNotFound</code></p></td><td ><p>File ID was not found. (No file thread exists.)</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectTypeErr</code></p></td><td ><p>Object defined was a directory, not a file.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number, Volume ID, or pathname type is unknown; pathname is null or bad.</p></td></tr></table></div><p><span class="content_text">Figure 31</span> shows the request block for the <code>FPExchangeFiles</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-215537" title="Figure 31Request block for the FPExchangeFiles command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCBAAI" title="Figure 31Request block for the FPExchangeFiles command"></a><p><strong>Figure 31&nbsp;&nbsp;</strong>Request block for the <code>FPExchangeFiles</code> command</p><img src = "../Art/afp_013.gif" alt = "Request block for the FPExchangeFiles command" width="150" height="388"></div><br/><a name="//apple_ref/c/func/FPFlush" title="FPFlush"></a><a name="//apple_ref/doc/c_ref/FPFlush" title="FPFlush"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIAGHE" title="FPFlush"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_35"></a><h3 class="tight">FPFlush</h3><p class="spaceabove">Writes any volume data that has been modified.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPFlush</code> (10).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>Result</em></dt><dd><p>kFPNoErr if no error occurred, <code>kFPParamErr</code> if the session reference number or Volume ID is invalid, or <code>kFPMiscErr</code> if an error occurred that is not specific to AFP.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command writes to disk as much changed information as possible including</p><ul class="ul"><li class="li"><p>all forks opened by the user</p></li><li class="li"><p>volume catalog information changed by the user</p></li><li class="li"><p>any updated volume data structures</p></li></ul><p>AFP does not specify that the server must perform all of these functions. Therefore, users should not rely on the server to perform any particular function.</p><p>The volume’s modification date may change as a result of this command, but uses should not rely on it; updating of the date is implementation-dependent. If no volume information was changed since the last <code>FPFlush</code> command, the date may or may not change.</p><p>Notice that only the filename, Parent Directory ID, File ID, and creation dates are exchanged. Byte-range locks and deny modes still apply to the same file reference number and data.</p><p>The user must have the Read &amp; Write privilege for both files in order to use this command.</p><p><span class="content_text">Figure 32</span> shows the request block for the <code>FPFlush</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-215698" title="Figure 32Request block for the FPFlush command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEGEJC" title="Figure 32Request block for the FPFlush command"></a><p><strong>Figure 32&nbsp;&nbsp;</strong>Request block for the <code>FPFlush</code> command</p><img src = "../Art/afp_050.gif" alt = "Request block for the FPFlush command" width="123" height="110"></div><br/><a name="//apple_ref/c/func/FPFlushFork" title="FPFlushFork"></a><a name="//apple_ref/doc/c_ref/FPFlushFork" title="FPFlushFork"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJJJFH" title="FPFlushFork"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_36"></a><h3 class="tight">FPFlushFork</h3><p class="spaceabove">Writes any data buffered from previous write commands.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short OForkRefNum
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPFlushFork</code> (11).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>OForkRefNum</em></dt><dd><p>Open fork reference number.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred, <code>kFPParamErr</code> if the session reference number or Volume ID is invalid, or <code>kFPMiscErr</code> if an error occurred that is not specific to AFP.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command writes to disk any data buffered by the server by previous write commands. If the fork has been modified, the server set’s the file’s modification date to the server’s clock.</p><p>In order to optimize disk access, the server may buffer write commands made to a particular file fork. Within the constraints of performance, the server flushes each fork as soon as possible. By sending this command, the AFP client can force the server to write any buffered data.</p><p><span class="content_text">Figure 33</span> shows the request block for the <code>FPFlushFork</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-215781" title="Figure 33Request block for the FPFlushFork command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEIAIB" title="Figure 33Request block for the FPFlushFork command"></a><p><strong>Figure 33&nbsp;&nbsp;</strong>Request block for the <code>FPFlushFork</code> command</p><img src = "../Art/afp_051.gif" alt = "Request block for the FPFlushFork command" width="123" height="110"></div><br/><a name="//apple_ref/c/func/FPGetACL" title="FPGetACL"></a><a name="//apple_ref/doc/c_ref/FPGetACL" title="FPGetACL"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEHGHC" title="FPGetACL"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_37"></a><h3 class="tight">FPGetACL</h3><p class="spaceabove">Gets the access control list for a file or directory.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long DirectoryID
unsigned short Bitmap
long MaxReplySize
byte Pathtype
string Pathname
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPGetACL</code> (73).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume identifier.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Directory identifier.</p></dd><dt><em>Bitmap</em></dt><dd><p>Bits that specify the values that are to be obtained. Specify <code>kFileSec_UUID </code>to get the UUID of the specified file or directory. Specify <code>kFileSec_GRPUUID</code> to get the Group UUID of the specified file or directory, or specify <code>kFileSec_ACL</code> to get the ACL of the specified file or directory. For declarations of these constants, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Access_Control_List_Bitmap">Access Control List Bitmap</a></span>.</p></dd><dt><em>MaxReplySize</em></dt><dd><p>Reserved. Set this parameter to zero.</p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname of the file or directory for which the access control list (ACL) is to be obtained. <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text">Table 24</span> for other possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-232261">Table 26</a></span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>Depending on the bits set in the <code>Bitmap</code> parameter, this command gets the UUID, Group UUID, or ACL for the specified file or directory. If the <code>kFileSec_UUID</code> bit is set, the file or directory’s UUID appears first in the reply packet. If the <code>kFileSec_GRPUUID</code> bit is set, the file or directory’s Group UUID appears next in the reply packet. If the <code>kFileSec_ACL</code> bit is set, the file or directory’s ACL appears next in the packet.</p><p>Support for this command, as well as <code><a href="reference.html#//apple_ref/c/func/FPAccess">FPAccess</a></code> and <code><a href="reference.html#//apple_ref/c/func/FPSetACL">FPSetACL</a></code> is required in order to support access control lists (ACLs). Support for UTF-8 and UUIDs is also required in order to support ACLs.</p><p><span class="content_text">Table 24</span> lists the result codes for the <code>FPGetACL</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-308108" title="Table 24Result codes for the FPGetACL command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIBDBF" title="Table 24Result codes for the FPGetACL command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 24&nbsp;&nbsp;</strong>Result codes for the <code>FPGetACL</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access rights required to get the ACL for the specified file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Input parameters do not point to an existing file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>A parameter is invalid.</p></td></tr></table></div><p><span class="content_text">Table 25</span> describes the reply block for the <code>FPGetACL</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-295008" title="Table 25Reply block for the FPGetACL command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFGJIB" title="Table 25Reply block for the FPGetACL command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 25&nbsp;&nbsp;</strong>Reply block for the <code>FPGetACL</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>Bitmap</code> (short)</p></td><td ><p>Copy of the bitmap sent to the server.</p></td></tr><tr><td  scope="row"><p><code>UUID</code> (16 bytes)</p></td><td ><p>File or directory’s UUID, if the <code>kFileSec_UUID</code> bit was set.</p></td></tr><tr><td  scope="row"><p><code>GRPUUID </code>(16 bytes)</p></td><td ><p>File or directory’s Group UUID, if the <code>kFileSec_GRPUUID</code> bit was set.</p></td></tr><tr><td  scope="row"><p><code>ACL</code></p></td><td ><p>File or directory’s ACL in a <code>kauth_acl</code> structure, if the <code>kFileSec_ACL</code> bit was set. For details, see <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/kauth_acl">Access Control List Structure</a></span>.</p></td></tr></table></div><p><span class="content_text">Figure 34</span> shows the request and reply blocks for the <code>FPGetACL</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-322016" title="Figure 34Request and reply blocks for the FPGetACL command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDDDJAJ" title="Figure 34Request and reply blocks for the FPGetACL command"></a><p><strong>Figure 34&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPGetACL</code> command</p><img src = "../Art/afp_FPGetACL.gif" alt = "Request and reply blocks for the FPGetACL command" width="395" height="467"></div><br/><h5 class="tight">Version Notes</h5><p>Introduced in AFP 3.2.</p><a name="//apple_ref/c/func/FPGetAPPL" title="FPGetAPPL"></a><a name="//apple_ref/doc/c_ref/FPGetAPPL" title="FPGetAPPL"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDDIFDG" title="FPGetAPPL"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_38"></a><h3 class="tight">FPGetAPPL</h3><p class="spaceabove">Retrieves an APPL mapping from a volume’s Desktop database.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short DTRefNum
long FileCreator
short APPLIndex
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPGetAPPL</code> (55).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>DTRefNum</em></dt><dd><p>Desktop database reference number.</p></dd><dt><em>FileCreator</em></dt><dd><p>File creator of the application corresponding to the APPL mapping to be retrieved.</p></dd><dt><em>APPLIndex</em></dt><dd><p>Index of the APPL mapping to be retrieved.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred, <code>kFPParamErr</code> if the session reference number or Desktop database reference is unknown, <code>kFPItemNotFound</code> if no entries in the Desktop database match the input parameters, <code>kFPBitmapErr</code> if an attempt was made to retrieve a parameter that cannot be obtained with this command, or <code>kFPMiscErr</code> if an error occurred that is not specific to AFP.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-232261">Table 26</a></span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>For each file creator, the Desktop database contains a list of APPL mappings. Each APPL mapping contains the Parent Directory ID and CNode name of an application associated with the file creator, as well as an APPL Tag that can be used to distinguish among the APPL mappings (the APPL Tag is uninterpreted by the Desktop database).</p><p>Information about the application file associated with each APPL mapping can be obtained by sending successive <code>FPGetAPPL</code> commands with <code>Index </code>varying from one to the total number of APPL mappings stored in the Desktop database for that file creator. If <code>Index </code>is more than the number of APPL mappings in the Desktop database for <code>FileCreator</code>, a <code>kFPItemNotFound</code> result code is returned. An <code>Index</code> of zero returns the first APPL mapping, if one exists in the Desktop database.</p><p>The server retrieves the specified parameters for the application file and packs the, in bitmap order, in the reply block.</p><p>The user must have search access to all ancestors except the parent directory and read access to the parent directory of the application for which information will be returned.</p><p>The user must have previously called <code><a href="reference.html#//apple_ref/c/func/FPOpenDT">FPOpenDT</a></code> for the corresponding volume.</p><p><span class="content_text">Table 26</span> describes the reply block for the <code>FPGetAPPL</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-232261" title="Table 26Reply block for the FPGetAPPL command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJHCFH" title="Table 26Reply block for the FPGetAPPL command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 26&nbsp;&nbsp;</strong>Reply block for the <code>FPGetAPPL</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>Bitmap</code> (short)</p></td><td ><p>Bitmap describing the parameters of the application file to return. Set the bit that corresponds to each desired parameter. This bitmap is the same as the <code>FileBitmap</code> parameter of the <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> command. For bit definitions for the File bitmap, see Table 1-7 in <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/File_Bitmap">File Bitmap</a></span>.</p></td></tr><tr><td  scope="row"><p><code>APPLTag</code> (long)</p></td><td ><p>Tag information associated with the APPL mapping.</p></td></tr><tr><td  scope="row"><p><code>FileParameters</code></p></td><td ><p>Requested file parameters.</p></td></tr></table></div><p><span class="content_text">Figure 35</span> shows the request and reply blocks for the <code>FPGetAPPL</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-216033" title="Figure 35Request and reply blocks for the FPGetAPPL command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBCCBC" title="Figure 35Request and reply blocks for the FPGetAPPL command"></a><p><strong>Figure 35&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPGetAPPL</code> command</p><img src = "../Art/afp_052.gif" alt = "Request and reply blocks for the FPGetAPPL command" width="301" height="260"></div><br/><a name="//apple_ref/c/func/FPGetAuthMethods" title="FPGetAuthMethods"></a><a name="//apple_ref/doc/c_ref/FPGetAuthMethods" title="FPGetAuthMethods"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFICHE" title="FPGetAuthMethods"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_39"></a><h3 class="tight">FPGetAuthMethods</h3><p class="spaceabove">Gets the UAMs that an Open Directory domain supports.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
byte Flags
byte PathType
string Pathname
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPGetAuthMethods</code> (62).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>Flags</em></dt><dd><p>Flags providing additional information. (No flags are currently defined.)</p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname of the Open Directory domain for which UAMs are to be obtained. <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred, <code>kFPObjectNotFound</code> if the specified Open Directory domain could not be found, or <code>kFPMiscErr</code> if an error occurred that is not specific to AFP.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-216125">Table 27</a></span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command gets the UAMs for the specified Open Directory domain.</p><p><span class="content_text">Table 27</span> describes the reply block for the <code>FPGetAuthMethods</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-216125" title="Table 27Reply block for the FPGetAuthMethods command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDGBGDC" title="Table 27Reply block for the FPGetAuthMethods command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 27&nbsp;&nbsp;</strong>Reply block for the <code>FPGetAuthMethods</code> command </caption><tr><td  scope="row"><p><code>Flags</code> (byte)</p></td><td ><p>Copy of the Flags input parameter.</p></td></tr><tr><td  scope="row"><p><code>Count</code> (byte)</p></td><td ><p>Number of UAMs that follow.</p></td></tr><tr><td  scope="row"><p><code>UAMStrings</code> (packed Pascal strings)</p></td><td ><p>Packed Pascal strings containing the names of the available UAMs</p></td></tr></table></div><p><span class="content_text">Figure 36</span> shows the request and reply blocks for the <code>FPGetAuthMethods</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-216198" title="Figure 36Request and reply blocks for the FPGetAuthMethods command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDHJBCF" title="Figure 36Request and reply blocks for the FPGetAuthMethods command"></a><p><strong>Figure 36&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPGetAuthMethods</code> command</p><img src = "../Art/afp_028.gif" alt = "Request and reply blocks for the FPGetAuthMethods command" width="330" height="134"></div><br/><a name="//apple_ref/c/func/FPGetComment" title="FPGetComment"></a><a name="//apple_ref/doc/c_ref/FPGetComment" title="FPGetComment"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEDEGF" title="FPGetComment"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_40"></a><h3 class="tight">FPGetComment</h3><p class="spaceabove">Gets the comment associated with a file or directory from the volume’s Desktop database.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short DTRefNum
long DirectoryID
byte PathType
string Pathname
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPGetComment</code> (58).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>DTRefNum</em></dt><dd><p>Desktop database reference number.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Directory ID.</p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname to desired file or directory. <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text">Table 28</span> for other possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. The reply block consists of a string, called <code>Comment</code>, containing the comment text.</p></dd></dl><h5 class="tight">Discussion</h5><p>The comment for the specified file or directory, if it is found in the volume’s Desktop database, is returned in the reply block.</p><p>If the comment is associated with a directory, the user must have search access to all ancestors, including the parent directory. If the comment is associated with a file, the user must have search access to all ancestors except the parent directory and read access to the parent directory.</p><p>The user must have previously called <code><a href="reference.html#//apple_ref/c/func/FPOpenDT">FPOpenDT</a></code> for the corresponding volume. In addition, the file or directory must exist before this command is sent.</p><p><span class="content_text">Table 28</span> lists the result codes for the <code>FPGetComment</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-232450" title="Table 28Result codes for the FPGetComment command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFCGHC" title="Table 28Result codes for the FPGetComment command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 28&nbsp;&nbsp;</strong>Result codes for the <code>FPGetComment</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to use this command.</p></td></tr><tr><td  scope="row"><p><code>kFPItemNotFound</code></p></td><td ><p>No comment was found in the Desktop database.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number or Desktop database reference number is unknown.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Input parameters do point to an existing file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr></table></div><p><span class="content_text">Figure 37</span> shows the request and reply blocks for the <code>FPGetComment</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-216398" title="Figure 37Request and reply blocks for the FPGetComment command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEFDFB" title="Figure 37Request and reply blocks for the FPGetComment command"></a><p><strong>Figure 37&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPGetComment</code> command</p><img src = "../Art/afp_053.gif" alt = "Request and reply blocks for the FPGetComment command" width="308" height="242"></div><br/><a name="//apple_ref/c/func/FPGetExtAttr" title="FPGetExtAttr"></a><a name="//apple_ref/doc/c_ref/FPGetExtAttr" title="FPGetExtAttr"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCHBGI" title="FPGetExtAttr"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_41"></a><h3 class="tight">FPGetExtAttr</h3><p class="spaceabove">Gets the value of an extended attribute.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long DirectoryID unsigned short Bitmap
long long Offset
long long ReqCount
long MaxReplySize
byte PathType
string Pathname
byte Pad
unsigned short NameLength
string Name
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPGetExtAttr</code> (69).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume identifier.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Directory identifier.</p></dd><dt><em>Bitmap</em></dt><dd><p>Bitmap specifying the desired behavior when getting the value of an extended attribute. For this command, only <code>kAttrDontFollow</code> is valid. For details, see <code><a href="reference.html#//apple_ref/doc/constant_group/Extended_Attributes_Bitmap">Extended Attributes Bitmap</a></code> for details.</p></dd><dt><em>Offset</em></dt><dd><p>Always zero; reserved for future use.</p></dd><dt><em>ReqCount</em></dt><dd><p>Always –1; reserved for future use.</p></dd><dt><em>MaxReplySize</em></dt><dd><p>Size in bytes of the reply that your application can handle; set to zero to get the size of the reply without actually getting the attributes.</p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname to desired file or directory. <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Pad</em></dt><dd><p>Optional pad byte if needed to pad to an even boundary.</p></dd><dt><em>NameLength</em></dt><dd><p>Length in bytes of the extended attribute name that follows.</p></dd><dt><em>Name</em></dt><dd><p>UTF-8–encoded name of the extended attribute whose value is to be obtained.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text">Table 28</span> for other possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. The reply block consists of a bitmap and the value of the extended attribute that was requested. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-297501">Table 30</a></span> for the format of the reply block. </p></dd></dl><h5 class="tight">Discussion</h5><p>If the result code is <code>kFPNoErr</code>, this command returns in the reply block the value of the extended attribute that was requested.</p><p>Support for this command, as well as <code><a href="reference.html#//apple_ref/c/func/FPListExtAttrs">FPListExtAttrs</a></code>, <code><a href="reference.html#//apple_ref/c/func/FPRemoveExtAttr">FPRemoveExtAttr</a></code> and <code><a href="reference.html#//apple_ref/c/func/FPSetExtAttr">FPSetExtAttr</a></code> is required in order to support extended attributes. UTF-8 support is also required in order to support extended attributes.</p><p><span class="content_text">Table 29</span> lists the possible result codes for the <code>FPGetExtAttr</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-297601" title="Table 29Result codes for the FPGetExtAttr command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEEHIF" title="Table 29Result codes for the FPGetExtAttr command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 29&nbsp;&nbsp;</strong>Result codes for the <code>FPGetExtAttr</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to get the file of an extended attribute for the specified file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPBitmapErr</code></p></td><td ><p>Bitmap is null or specifies a value that is invalid for this command.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Input parameters do not point to an existing file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>A parameter is invalid.</p></td></tr></table></div><p><span class="content_text">Table 30</span> describes the reply block for the <code>FPGetExtAttr </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-297501" title="Table 30Reply block for the FPGetExtAttr command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDHHDBJ" title="Table 30Reply block for the FPGetExtAttr command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 30&nbsp;&nbsp;</strong>Reply block for the <code>FPGetExtAttr</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>Bitmap</code> (short)</p></td><td ><p>Copy of the input parameter.</p></td></tr><tr><td  scope="row"><p><code>DataLength</code> (long)</p></td><td ><p>Length in bytes of the extended attribute data that follows.</p></td></tr><tr><td  scope="row"><p><code>ExtendedAttribute Data</code> (string)</p></td><td ><p>Extended attribute data</p></td></tr></table></div><p><span class="content_text">Figure 37</span> shows the request and reply blocks for the <code>FPGetExtAttr</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-292220" title="Figure 38Request and reply blocks for the FPGetExtAttr command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEIIHF" title="Figure 38Request and reply blocks for the FPGetExtAttr command"></a><p><strong>Figure 38&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPGetExtAttr</code> command</p><img src = "../Art/afp_FPGetExtAttr.gif" alt = "Request and reply blocks for the FPGetExtAttr command" width="405" height="573"></div><br/><h5 class="tight">Version Notes</h5><p>Introduced in AFP 3.2.</p><a name="//apple_ref/c/func/FPGetFileDirParms" title="FPGetFileDirParms"></a><a name="//apple_ref/doc/c_ref/FPGetFileDirParms" title="FPGetFileDirParms"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBEHBG" title="FPGetFileDirParms"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_42"></a><h3 class="tight">FPGetFileDirParms</h3><p class="spaceabove">Gets the parameters for a file or a directory.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long DirectoryID
short FileBitmap
short DirectoryBitmap
byte PathType
string Pathname
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPGetFileDirParms</code> (34).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Directory ID.</p></dd><dt><em>FileBitmap</em></dt><dd><p>Bitmap describing the parameters to return for a file. Set the bit that corresponds to each desired parameter. For the bit definitions of this bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/File_Bitmap">File Bitmap</a></span>.</p></dd><dt><em>DirectoryBitmap</em></dt><dd><p>Bitmap describing the parameters to return for a directory. Set the bit that corresponds to each desired parameter. For the bit definitions of this bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Directory_Bitmap">Directory Bitmap</a></span>.</p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname to desired file or directory. <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-232675">Table 31</a></span> for other possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-232906">Table 32</a></span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>The server packs the requested parameters in the reply block in the order specified by the appropriate bitmap. The <code>FileDir</code> bit indicates whether the parameters are for a file or a directory. A copy of the input bitmaps is inserted before the parameters.</p><p>Variable-length parameters, such as Long Name and Short Name, are kept at the end of the block. To do this, the server represents variable-length parameters in the bitmap order as fixed-length offsets (integers). Each offset is measured from the start of the parameters (not from the start of the bitmap) to the start of the variable-length parameter. The actual variable-length parameters are then packed after all fixed-length parameters.</p><p>If the CNode exists and both bitmaps are null, no error is returned; <code>FileBitmap</code>, <code>DirectoryBitmap</code>, and the byte containing the <code>FileDir</code> bit are returned with no other parameters.</p><p>If a directory’s access rights are requested, the server returns the Access Rights parameter (a four-byte quantity) containing the read, write, and search access privileges corresponding to owner, group, and everyone as well as the User Access Rights Summary byte, which indicates the privileges the current user of the AFP client has to this directory. For bit definitions of the Access Rights parameter, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Access_Rights_Bitmap">Access Rights Bitmap</a></span>.</p><p>If the Offspring Count bit of the <code>DirectoryBitmap</code> parameter is set, the server will adjust the Offspring Count to reflect the access rights the user has to that directory. For example, if a particular directory contains three file and two directory offspring, the server will return its Offspring Count as two if the user has only search access to the directory, three if the user has only read access to the directory, or five if the user has both search and read access to the directory.</p><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-216542">Figure 39</a></span> shows the File and Directory bitmaps, the File and Directory Attributes parameters, and the Access Rights for directories.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-216542" title="Figure 39Bitmaps, Attributes, and Access Rights returned by FPGetFileDirParms"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFGFBB" title="Figure 39Bitmaps, Attributes, and Access Rights returned by FPGetFileDirParms"></a><p><strong>Figure 39&nbsp;&nbsp;</strong>Bitmaps, Attributes, and Access Rights returned by <code>FPGetFileDirParms</code></p><img src = "../Art/afp_078.gif" alt = "Bitmaps, Attributes, and Access Rights returned by FPGetFileDirParms" width="524" height="556"></div><br/><p>The user must have search access to all ancestors except this CNode’s parent directory. For directories, the user also needs search access to the parent directory. For files, the user needs read access to the parent directory.</p><p>Most of the attributes requested by this command are stored in corresponding flags within the CNode’s Finder Info record.</p><p><span class="content_text">Table 31</span> lists the result codes for the <code>FPGetFileDirParms</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-232675" title="Table 31Result codes for the FPGetFileDirParms command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIBEGJ" title="Table 31Result codes for the FPGetFileDirParms command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 31&nbsp;&nbsp;</strong>Result codes for the <code>FPGetFileDirParms</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to use this command.</p></td></tr><tr><td  scope="row"><p><code>kFPBitmapErr</code></p></td><td ><p>Attempt was made to retrieve a parameter that cannot be obtained with this command.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Input parameters do not point to an existing file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number, Volume ID, or pathname type is unknown; pathname is invalid.</p></td></tr></table></div><p><span class="content_text">Table 32</span> describes the reply block for the <code>FPGetFileDirParms </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-232906" title="Table 32Reply block for the FPGetFileDirParms command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCHJJD" title="Table 32Reply block for the FPGetFileDirParms command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 32&nbsp;&nbsp;</strong>Reply block for the <code>FPGetFileDirParms</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>FileBitmap</code> (short)</p></td><td ><p>Copy of the input parameter.</p></td></tr><tr><td  scope="row"><p><code>DirectoryBitmap</code> (short)</p></td><td ><p>Copy of the input parameter.</p></td></tr><tr><td  scope="row"><p><code>FileDir</code> (bit)</p></td><td ><p>Bit indicating whether the CNode is a file or a directory:0 = file 1 = directory</p></td></tr><tr><td  scope="row"><p><code>ReqParameters</code></p></td><td ><p>Requested parameters.</p></td></tr></table></div><p><span class="content_text">Figure 40</span> shows the request and reply blocks for the <code>FPGetFileDirParms</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-216823" title="Figure 40Request and reply blocks for the FPGetFileDirParms command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIIDCI" title="Figure 40Request and reply blocks for the FPGetFileDirParms command"></a><p><strong>Figure 40&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPGetFileDirParms</code> command</p><img src = "../Art/afp_054.gif" alt = "Request and reply blocks for the FPGetFileDirParms command" width="353" height="326"></div><br/><a name="//apple_ref/c/func/FPGetForkParms" title="FPGetForkParms"></a><a name="//apple_ref/doc/c_ref/FPGetForkParms" title="FPGetForkParms"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFHFAC" title="FPGetForkParms"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_43"></a><h3 class="tight">FPGetForkParms</h3><p class="spaceabove">Gets the parameters for a fork.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short OForkRefNum
short Bitmap
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPGetForkParms</code> (14).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>OForkRefNum</em></dt><dd><p>Open fork reference number.</p></dd><dt><em>Bitmap</em></dt><dd><p>Bitmap describing the parameters to be returned. Set the bits that correspond to each desired parameter. This bitmap is the same as the <code>FileBitmap</code> parameter of the <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> command. For bit definitions for this bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/File_Bitmap">File Bitmap</a></span>.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred, <code>kFPParamErr</code> if the session reference number or open fork reference number is invalid, <code>kFPBitmapErr</code> if an attempt was made to retrieve a parameter that cannot be obtained with this command; bitmap is null, or <code>kFPMiscErr</code> if an error occurred that is not specific to AFP.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-233099">Table 33</a></span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>The server packs the parameters in bitmap order in the reply block.</p><p>Variable-length parameters, such as Long Name and Short Name, are kept at the end of the block. To do this, the server represents variable-length parameters in the bitmap order as fixed-length offsets (integers). Each offset is measured from the start of the parameters (not from the start of the bitmap) to the start of the variable-length parameter. The actual variable-length fields are then packed after all fixed-length parameters.</p><p>This command retrieves the length the fork indicated by <code>OForkRefNum</code>; a <code>kFPBitmapErr</code> result code is returned if an attempt is made to retrieve the length of the file’s other fork.</p><p>The user must have previously called <code><a href="reference.html#//apple_ref/c/func/FPOpenFork">FPOpenFork</a></code> for this volume.</p><p><span class="content_text">Table 33</span> describes the reply block for the <code>FPGetForkParms </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-233099" title="Table 33Reply block for the FPGetForkParms command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIFHDH" title="Table 33Reply block for the FPGetForkParms command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 33&nbsp;&nbsp;</strong>Reply block for the <code>FPGetForkParms</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>Bitmap</code> (short)</p></td><td ><p>Copy of the input parameter.</p></td></tr><tr><td  scope="row"><p><code>FileParameters</code></p></td><td ><p>Requested fork parameters.</p></td></tr></table></div><p><span class="content_text">Figure 41</span> shows the request and reply blocks for the <code>FPGetForkParms</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-217016" title="Figure 41Request and reply blocks for the FPGetForkParms command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCFGAE" title="Figure 41Request and reply blocks for the FPGetForkParms command"></a><p><strong>Figure 41&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPGetForkParms</code> command</p><img src = "../Art/afp_076.gif" alt = "Request and reply blocks for the FPGetForkParms command" width="296" height="146"></div><br/><a name="//apple_ref/c/func/FPGetIcon" title="FPGetIcon"></a><a name="//apple_ref/doc/c_ref/FPGetIcon" title="FPGetIcon"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFIABJ" title="FPGetIcon"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_44"></a><h3 class="tight">FPGetIcon</h3><p class="spaceabove">Gets an icon from the Desktop database.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short DTRefNum
long FileCreator
long FileType
byte IconType
byte Pad
short Length
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPGetIcon</code> (51).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>DTRefNum</em></dt><dd><p>Desktop database reference number.</p></dd><dt><em>FileCreator</em></dt><dd><p>File creator of the file with which the icon is associated.</p></dd><dt><em>FileType</em></dt><dd><p>File type of the file with which the icon is associated.</p></dd><dt><em>IconType</em></dt><dd><p>Preferred icon type.</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>Length</em></dt><dd><p>Number of bytes the caller expects the icon bitmap to require in the reply block.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred, <code>kFPParamErr</code> if the session reference number or Desktop database reference number is unknown, <code>kFPItemNotFound</code> if no icon corresponding to the input parameters was found in the Desktop database, or <code>kFPMiscErr</code> if an error occurred that is not specific to AFP.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. The reply block consists of a short containing the requested icon bitmap.</p></dd></dl><h5 class="tight">Discussion</h5><p>The server retrieves an icon bitmap from the Desktop database as specified by the <code>FileCreator</code>, <code>FileType</code>, and <code>IconType</code> parameters. </p><p>An input <code>Length</code> value of zero is acceptable to test for the presence or absence of a particular icon. If <code>Length</code> is less than the actual size of the icon bitmap, only <code>Length</code> bytes are returned.</p><p>The user must have previously called <code><a href="reference.html#//apple_ref/c/func/FPOpenDT">FPOpenDT</a></code> for the corresponding volume.</p><p><span class="content_text">Figure 42</span> shows the request and reply blocks for the <code>FPGetIcon</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-217145" title="Figure 42Request and reply blocks for the FPGetIcon command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIEHEA" title="Figure 42Request and reply blocks for the FPGetIcon command"></a><p><strong>Figure 42&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPGetIcon</code> command</p><img src = "../Art/afp_056.gif" alt = "Request and reply blocks for the FPGetIcon command" width="347" height="349"></div><br/><a name="//apple_ref/c/func/FPGetIconInfo" title="FPGetIconInfo"></a><a name="//apple_ref/doc/c_ref/FPGetIconInfo" title="FPGetIconInfo"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIIAFC" title="FPGetIconInfo"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_45"></a><h3 class="tight">FPGetIconInfo</h3><p class="spaceabove">Gets icon information from the Desktop database.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short DTRefNum
long FileCreator
short IconIndex
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPGetIconInfo</code> (51).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>DTRefNum</em></dt><dd><p>Desktop database reference number.</p></dd><dt><em>FileCreator</em></dt><dd><p>File creator of the file with which the icon is associated.</p></dd><dt><em>IconIndex</em></dt><dd><p>Index of the requested icon.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred, <code>kFPParamErr</code> if the session reference number or Desktop database reference number is unknown, <code>kFPItemNotFound</code> if no icon corresponding to the input parameters was found in the Desktop database, or <code>kFPMiscErr</code> if an error occurred that is not specific to AFP.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-233289">Table 34</a></span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>The server retrieves a information about an icon in the volume’s Desktop database as specified by the icon’s file creator and icon index.</p><p>For each file creator, the Desktop database contains a list of icons. Information about each icon can be obtained by sending successive <code>FPGetIconInfo</code> commands with <code>IconIndex</code> varying from one to the total number of icons stored in the Desktop database for that file creator. If <code>IconIndex</code> is more than the number of icons in the Desktop database for the specified file creator, a result code of <code>kFPItemNotFound</code> is returned.</p><p>The user must have previously called <code><a href="reference.html#//apple_ref/c/func/FPOpenDT">FPOpenDT</a></code><span class="content_text"><a href="reference.html#//apple_ref/c/func/FPOpenDT">FPOpenDT</a></span> for the corresponding volume.</p><p><span class="content_text">Table 34</span> describes the reply block for the <code>FPGetIconInfo </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-233289" title="Table 34Reply block for the FPGetIconInfo command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIFAGE" title="Table 34Reply block for the FPGetIconInfo command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 34&nbsp;&nbsp;</strong>Reply block for the <code>FPGetIconInfo</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>IconTag</code> (long)</p></td><td ><p>Tag information associated with the requested icon.</p></td></tr><tr><td  scope="row"><p><code>FileType</code> (long)</p></td><td ><p>File type of the requested icon.</p></td></tr><tr><td  scope="row"><p><code>IconType</code> (byte)</p></td><td ><p>Type of the requested icon.</p></td></tr><tr><td  scope="row"><p><code>Pad</code> (byte)</p></td><td ><p>Pad byte.</p></td></tr><tr><td  scope="row"><p><code>Size</code> (short)</p></td><td ><p>Size of the icon bitmap.</p></td></tr></table></div><p><span class="content_text">Figure 43</span> shows the request and reply blocks for the <code>FPGetIconInfo</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-217378" title="Figure 43Request and reply blocks for the FPGetIconInfo command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDHFBAD" title="Figure 43Request and reply blocks for the FPGetIconInfo command"></a><p><strong>Figure 43&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPGetIconInfo</code> command</p><img src = "../Art/afp_055.gif" alt = "Request and reply blocks for the FPGetIconInfo command" width="343" height="271"></div><br/><a name="//apple_ref/c/func/FPGetSessionToken" title="FPGetSessionToken"></a><a name="//apple_ref/doc/c_ref/FPGetSessionToken" title="FPGetSessionToken"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEEBJA" title="FPGetSessionToken"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_46"></a><h3 class="tight">FPGetSessionToken</h3><p class="spaceabove">Gets a session token.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short Type
long IDLength
long timeStamp (optional)
ID
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPGetSessionToken</code> (64).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>Type</em></dt><dd><p>The value of this parameter is <code>kLoginWithoutID</code> (0) if the client supports an earlier version of AFP that does not send an <code>IDLength </code>and an <code>ID</code> parameter. It is <code>kLoginWithTimeAndID </code>(3) if the client is sending an <code>IDLength</code>, an <code>ID</code>, and a <code>Timestamp </code>parameter and the client wants its old session to be discarded. It is <code>kReconnWithTimeAndID </code>(4) if the client has just finished a successful reconnect, is sending an <code>IDLength</code>, an <code>ID</code>, and a <code>Timestamp </code>parameter, and wants the session to be updated with the <code>ID</code> parameter. It is <code>kGetKerberosSessionKey</code> (8) if the client is logging in using Kerberos v5. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/FPGetSessionToken_Types">FPGetSessionToken Types</a></span> for the enumeration that defines the constants for this parameter.</p></dd><dt><em>IDLength</em></dt><dd><p>Length of the <code>ID </code>parameter.</p></dd><dt><em>timeStamp</em></dt><dd><p>Optional time stamp specified only if the value of <code>ID</code> is <code>kLoginWithTimeAndID</code> or <code>kReconnWithTimeAndID</code>.</p></dd><dt><em>ID</em></dt><dd><p>A client-defined value that uniquely identifies this session.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred, <code>kFPParamErr</code> if the session reference number is unknown, <code>kFPCallNotSupported</code> if the server does not support this command, or <code>kFPMiscErr</code> if an error occurred that is not specific to AFP.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-233608">Table 35</a></span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command helps an AFP client manage a disconnect that occurs and there are open files or locked resources on the remote server. The remote server will save the current state of the session (including open files) and wait until its reconnect timeout expires before closing the files and discarding the saved session. In the case of an AFP client that fails to wake up properly from sleep with a mounted AFP server, the session will be saved on the remote server until the sleep timeout expires.</p><p>Under these circumstances, prior to AFP 3.1, when an AFP client logged back into the server from the same system, attempts to access the files that were open at the time of the crash would fail with a “file already open” or “resources already locked” result. The AFP client would have to wait for the reconnect or sleep timeout to expire, or a server administrator would have to manually disconnect the old session.</p><p>With AFP 3.1, the AFP client can set the <code>Type </code>parameter to <code>kLoginWithID</code>, set the <code>ID </code>parameter to a unique client-defined value, and send this command. The server will associate the value of <code>ID </code>with the session. Later, if the local system crashes and the AFP client logs in again, the AFP client can set the <code>Type </code>parameter to <code>kLoginWithID</code>, set the <code>ID </code>parameter to the ID that it previously sent to the remote server, and send this command again. The remote server will look for a session that matches the value of ID. If a match is found, it will close any files associated with the session that are open, free any locked resources, and disconnect the matching session. Note that in the current version, the unique ID is associated with a particular computer, so after the system crashes, the AFP client must log in from the same computer using the same information that was used to log in originally.</p><p>With AFP 3.1, the AFP client can also set the <code>Type</code> parameter to <code>kLoginWithTimeAndID</code>. In this case, the client must include a four-byte time stamp after the<code> IDLength</code> field, and the server saves the time stamp as well as the value of <code>ID</code> for each session. When the server receives a <code>FPGetSessionToken</code> command having a <code>TYPE</code> parameter whose value is <code>kLoginWithTimeAndID</code>, the server searches all of its session queues. If the server finds a session that matches the value of <code>ID</code>, it also checks the time stamp. If the time stamp matches, the client has <em>not </em>restarted so the session is not discarded. The session is only discarded if the saved time stamp does not match.</p><p>This command returns a session token that, with AFP 3.0 and later, is used to reconnect. If the local system is disconnected and the AFP client logs in again using the same log in information as before, the AFP client can call <code></code><code><a href="reference.html#//apple_ref/c/func/FPDisconnectOldSession">FPDisconnectOldSession</a></code>, passing the session token obtained by calling <code>FPGetSessionToken</code>, to tell the server to transfer the old session to the new session.</p><p>Note that sending the <code>FPGetSrvrMsg </code>command does not initiate a reconnect.</p><p>For security purposes, the server always fails reconnections for users who log in as Guest.</p><p><span class="content_text">Table 35</span> describes the reply block for the <code>FPGetSessionToken </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-233608" title="Table 35Reply block for the FPGetSessionToken command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJHAAH" title="Table 35Reply block for the FPGetSessionToken command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 35&nbsp;&nbsp;</strong>Reply block for the <code>FPGetSessionToken</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>TokenLength</code> (long)</p></td><td ><p>Length of the token that follows.</p></td></tr><tr><td  scope="row"><p><code>Token</code> (variable length)</p></td><td ><p>Token that can be passed to <code>FPDisconnectOldSession</code> if the session is inadvertently disconnected and then re-established. If the client supports the Reconnect UAM, the token needs to be refreshed periodically, and is also sent to the server by the <code><a href="reference.html#//apple_ref/c/func/FPLoginExt">FPLoginExt</a></code> command to reconnect if the session is disconnected.</p></td></tr></table></div><p><span class="content_text">Figure 44</span> shows the request and reply blocks for the <code>FPGetSessionToken</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-217591" title="Figure 44Request and reply blocks for the FPGetSessionToken command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBDAFG" title="Figure 44Request and reply blocks for the FPGetSessionToken command"></a><p><strong>Figure 44&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPGetSessionToken</code> command</p><img src = "../Art/afp_032.gif" alt = "Request and reply blocks for the FPGetSessionToken command" width="331" height="328"></div><br/><a name="//apple_ref/c/func/FPGetSrvrInfo" title="FPGetSrvrInfo"></a><a name="//apple_ref/doc/c_ref/FPGetSrvrInfo" title="FPGetSrvrInfo"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIEGED" title="FPGetSrvrInfo"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_47"></a><h3 class="tight">FPGetSrvrInfo</h3><p class="spaceabove">Gets information about a server.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPGetSrvrInfo</code> (15).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred, <code>kFPNoServer</code> if the server is not responding, or <code>kFPMiscErr</code> if an error occurred that is not specific to AFP.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-283229">Table 37</a></span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>The reply block begins with the offset to the <code>MachineType</code> parameter, followed by the offset to the <code>AFPVersions</code> parameter, the offset to the <code>UAMs</code> parameter, and the offset to the <code>VolumeIconAndMask</code> parameter. The offsets are followed by the <code>Flags</code> parameter, the <code>ServerName</code> parameter padded to an even boundary, the offset to the <code>ServerSignature</code> parameter, and the offset to the <code>NetworkAddresses</code> parameter.</p><p>The server packs the information in the reply block in any order, so no assumption should be made about the order of the information. Instead AFP clients should access the information only through the offsets. The exception is the <code>ServerName</code> parameter, which is always after the <code>Flags</code> parameter.</p><p>Providing offsets to the <code>VolumeIconAndMask</code>, <code>ServerSignature</code>, <code>NetworkAddresses</code>, and <code>DirectoryNames</code> parameters is required, but providing the parameters themselves is optional. If not provided, the value of each parameter is zero.</p><p>The <code>Flags </code>parameter indicates the server’s support for certain features. If bit 9 in the <code>Flags</code> parameter is set, the reply block contains a <code>UTF-8ServerNames</code> offset to the server’s name in UTF-8 format. <span class="content_text">Figure 45</span> shows how bits are used in the <code>Flags </code>parameter.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-322039" title="Figure 45Bit usage in the ServerFlags parameter"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJGAHJ" title="Figure 45Bit usage in the ServerFlags parameter"></a><p><strong>Figure 45&nbsp;&nbsp;</strong>Bit usage in the ServerFlags parameter</p><img src = "../Art/afp_086.gif" alt = "Bit usage in the ServerFlags parameter" width="320" height="224"></div><br/><p>The <code>AFPVersionsCount</code> and <code>UAMCount</code> parameters are each one byte containing the number of AFP and UAM version strings that follow, with the strings packed back-to-back without padding. For the AFP versions supported by this version of AFP, see <code><a href="reference.html#//apple_ref/doc/constant_group/AFP_Version_Strings">AFP Version Strings</a></code>. For the UAMs supported by this version of AFP, see <code><a href="reference.html#//apple_ref/doc/constant_group/AFP_UAM_Strings">AFP UAM Strings</a></code>.</p><p>The optional <code>ServerSignature</code> parameter contains a unique identifier for the server. An AFP client should use the server signature to ensure that it does not log on to the same server multiple times. Preventing multiple log ins is important when the server is configured for multihoming.</p><p>The <code>NetworkAddresses</code> parameter contains the addresses that the client can use to connect to the server. Each address is stored as an AFP Network Address. The format of an AFP Network Address is shown in <span class="content_text">Figure 46</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-217863" title="Figure 46AFP Network Address format"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJHFAB" title="Figure 46AFP Network Address format"></a><p><strong>Figure 46&nbsp;&nbsp;</strong>AFP Network Address format</p><img src = "../Art/afp_022.gif" alt = "AFP Network Address format" width="343" height="28"></div><br/><p>Each AFP Network Address consists of a length byte containing the total length in bytes of the Network Address, followed by a tag byte identifying the type of address the Address field contains, followed by up to 254 bytes of data. <span class="content_text">Table 36</span> lists the possible values of the <code>Length</code> and <code>Tag</code> fields and describes the type of address stored in the <code>Address</code> field.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-233833" title="Table 36AFP Network Address fields "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEBHAD" title="Table 36AFP Network Address fields "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 36&nbsp;&nbsp;</strong>AFP Network Address fields </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Length</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Tag</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Address</p></th></tr><tr><td  scope="row"><p></p></td><td ><p>0x00</p></td><td ><p>Reserved</p></td></tr><tr><td  scope="row"><p>0x6</p></td><td ><p>0x01</p></td><td ><p>Four-byte IP address</p></td></tr><tr><td  scope="row"><p>0x8</p></td><td ><p>0x02</p></td><td ><p>Four-byte IP address followed by a two-byte port number</p></td></tr><tr><td  scope="row"><p>0x6</p></td><td ><p>0x03</p></td><td ><p>DDP address (two bytes for the network number, one byte for the node number, and one byte for the socket number)</p></td></tr><tr><td  scope="row"><p>Variable</p></td><td ><p>0x04</p></td><td ><p>DNS name</p></td></tr><tr><td  scope="row"><p>0x8</p></td><td ><p>0x05</p></td><td ><p>IP address (four bytes) with port number (2 bytes). If this tag is present and the client is so configured, the client attempts to build a Secure Shell (SSH) tunnel between itself and the server and try to connect through the it.</p></td></tr><tr><td  scope="row"><p>0x12</p></td><td ><p>0x6</p></td><td ><p>IPv6 address (16 bytes)</p></td></tr><tr><td  scope="row"><p>0x14</p></td><td ><p>0x07</p></td><td ><p>IPv6 address (16 bytes) following by a two-byte port number</p></td></tr></table></div><p>The network address format provides the available network addresses to the AFP client. AFP clients should ignore any tags that it does not recognize.</p><p><code>FPGetSrvrInfo</code> can be called without first establishing a session with the server.</p><p><span class="content_text">Table 37</span> describes the reply block for the <code>FPGetSrvrInfo command.</code></p><a name="//apple_ref/doc/uid/TP40003548-CH3-283229" title="Table 37Reply block for the FPGetSrvrInfo command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDGBHCA" title="Table 37Reply block for the FPGetSrvrInfo command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 37&nbsp;&nbsp;</strong>Reply block for the <code>FPGetSrvrInfo</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>MachineType</code> offset </p></td><td ><p>Offset to the location in the reply block containing the server’s machine type.</p></td></tr><tr><td  scope="row"><p><code>AFPVersionCount</code> offset</p></td><td ><p>Offset to the location in the reply block containing the number of AFP versions the server supports.</p></td></tr><tr><td  scope="row"><p><code>UAMCount</code> offset</p></td><td ><p>Offset to the location in the reply block containing the number of UAMs the server supports.</p></td></tr><tr><td  scope="row"><p><code>VolumeIconAndMask</code> offset</p></td><td ><p>Offset to the location in the reply block containing volume icon and mask data.</p></td></tr><tr><td  scope="row"><p><code>Flags</code> (short)</p></td><td ><p>Flags describing the server’s capabilities. For bit definitions, see the section <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Server_Flags_Bitmap">Server Flags Bitmap</a></span>.</p></td></tr><tr><td  scope="row"><p><code>ServerName</code> (string)</p></td><td ><p>String containing the server’s name.</p></td></tr><tr><td  scope="row"><p><code>ServerSignature</code> offset</p></td><td ><p>Offset to the location in the reply block containing the server’s signature.</p></td></tr><tr><td  scope="row"><p><code>NetworkAddressesCount </code>offset</p></td><td ><p>Offset to the location in the reply block containing the number of AFP Network Addresses.</p></td></tr><tr><td  scope="row"><p><code>DirectoryNamesCount</code> offset</p></td><td ><p>Offset to the location in the reply block containing the number of Directory Names.</p></td></tr><tr><td  scope="row"><p><code>UTF-8ServerName</code></p></td><td ><p>Offset to the location in the reply block containing the server’s name in UTF-8 characters.</p></td></tr><tr><td  scope="row"><p><code>MachineType</code> (string)</p></td><td ><p>A string containing a description of the server’s hardware, operating system, or both.</p></td></tr><tr><td  scope="row"><p><code>AFPVersionsCount</code></p></td><td ><p>Number of AFP version strings that follow.</p></td></tr><tr><td  scope="row"><p><code>AFPVersions</code> (packed string)</p></td><td ><p>Each AFP version that the server supports in packed format. For each supported version, there is one byte stating the number of bytes in the version string that follows.</p></td></tr><tr><td  scope="row"><p><code>UAMsCount</code></p></td><td ><p>Number of UAM strings that follow.</p></td></tr><tr><td  scope="row"><p><code>UAMs</code> (packed string)</p></td><td ><p>Each UAM that the server supports in packed format. For each supported UAM, there is one byte stating the number of bytes in the UAM name string that follows.</p></td></tr><tr><td  scope="row"><p><code>ServerSignature</code>  (16 bytes)</p></td><td ><p>Sixteen-byte number that uniquely identifies the server, or zero if not supported. For AFP servers, supporting server signatures is optional, but AFP servers must provide a <code>ServerSignature</code> offset. An AFP server indicates that it supports server signatures by setting the <code>kSupportsSrvrSig</code> bit in the Flags parameter.</p></td></tr><tr><td  scope="row"><p><code>NetworkAddresses</code> (AFP Network Address)</p></td><td ><p>Server’s network addresses, or zero if not supported. (The AFP Network Address format is described later in this section.) For AFP servers, providing a <code>NetworkAddresses</code> parameter is optional, but AFP servers must provide a <code>NetworkAddresses</code> offset. An AFP server indicates that it supports Network Addresses by setting the <code>kSupportsTCP</code> bit in the <code>Flags</code> parameter.</p></td></tr><tr><td  scope="row"><p><code>DirectoryNames</code> (string)</p></td><td ><p>String containing the names of directories that Open Directory has made available for sharing, or zero if not supported. For AFP servers, supporting Open Directory is optional, but AFP servers must provide a <code>DirectoryNames</code> offset. An AFP server indicates that it supports Open Directory by setting the <code>kSupportsDirServices</code> bit in the Flags parameter. If the server supports the Kerberos UAM, it places its principal name in this string.</p></td></tr><tr><td  scope="row"><p><code>UTF-8ServerName</code> (AFPName)</p></td><td ><p>AFPName containing the UTF-8–encoded name of the server.</p></td></tr><tr><td  scope="row"><p><code>VolumeIconAndMask</code> (256 bytes)</p></td><td ><p>128 bytes of icon data and 128 bytes of mask data.</p></td></tr></table></div><p><span class="content_text">Figure 47</span> shows the request and reply blocks for the <code>FPGetSrvrInfo</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-218400" title="Figure 47Request and reply blocks for the FPGetSrvrInfo command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJBDCE" title="Figure 47Request and reply blocks for the FPGetSrvrInfo command"></a><p><strong>Figure 47&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPGetSrvrInfo</code> command</p><img src = "../Art/afp_023.gif" alt = "Request and reply blocks for the FPGetSrvrInfo command" width="500" height="526"></div><br/><a name="//apple_ref/c/func/FPGetSrvrMsg" title="FPGetSrvrMsg"></a><a name="//apple_ref/doc/c_ref/FPGetSrvrMsg" title="FPGetSrvrMsg"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBIFCA" title="FPGetSrvrMsg"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_48"></a><h3 class="tight">FPGetSrvrMsg</h3><p class="spaceabove">Gets a message from a server.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short MessageType
short MessageBitmap
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPGetSrvrMsg</code> (38).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>MessageType</em></dt><dd><p>Type of message, were 0 indicates log in and 1 indicates server. (Set <code>MessageType</code> to 1 when the Server Message bit in the attention code is set.)</p></dd><dt><em>MessageBitmap</em></dt><dd><p>Bitmap providing additional information. The client sets bit 0 of this bitmap to indicate it is requesting a message. Starting with AFP 3.0, the client can set bit 1 of this bitmap to indicate that it supports UTF-8 messages.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred, <code>kFPCallNotSupported</code> if the server does not support this command, <code>kFPBitmapErr</code> if unrecognized bits are set in <code>MessageBitmap</code>, or <code>kFPMiscErr</code> if an error occurred that is not specific to AFP.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-240744">Table 38</a></span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>An AFP client uses the <code>FPGetSrvrMsg</code> command to get messages from the server. Usually, the server sends an attention code to the client when server messages are available, and the client responds by calling <code>FPGetSrvrMsg</code>. However, the client can call <code>FPGetSrvrMsg</code> at any time. If no message is available when the client calls <code>FPGetSrvrMsg</code>, the server returns a zero-length string.</p><p>There are two message types: log in and server. The log in message type allows the server to send a message to a client at log in time. The client can query the server for a log in message at log in time, or whenever it is convenient to do so. If there is no login message, <code>FPGetSrvrMsg</code> returns a zero-length string.</p><p>The server message type allows the server to send messages to the client once the client has logged on. The server notifies the client that a server message is available by sending a DSI Attention packet in which the Server Message bit in the <code>AFPUserBytes</code> field is set.</p><p>There are two server message types:</p><ul class="ul"><li class="li"><p>Shutdown. The server can send a shutdown message to explain why the server is shutting down, how long it will be down, and so on. In addition to setting the Server Message bit in the <code>AFPUserBytes</code> field of the DSI Attention packet, the server sets the Shutdown bit to indicate that a shutdown message is available.</p></li><li class="li"><p>User. The server can send a message to a specific user. The client is made aware that a user message is available when the server sends an DSI Attention packet in which the Server Message bit in the <code>AFPUserBytes</code> field is set and the Shutdown bit is not set.</p></li></ul><p>The usual size of any of these messages is 200 bytes including the length byte (a Str199). AFP 3.<em>x</em> clients can request that the server send longer attention messages by setting the attention quantum size in the <code>Option</code> field of the <code>DSOpenSession</code> command (described in the document <em>Apple Filing Protocol Client</em>).</p><p>The user must be logged on to the server to receive server message notifications. Otherwise, no special access privileges are necessary to use this command.</p><p>Note that in the case of a disconnected session, sending this command does not initiate a reconnect.</p><p><span class="content_text">Table 38</span> describes the reply block for the <code>FPGetSrvrMsg </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-240744" title="Table 38Reply block for the FPGetSrvrMsg command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFBGHH" title="Table 38Reply block for the FPGetSrvrMsg command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 38&nbsp;&nbsp;</strong>Reply block for the <code>FPGetSrvrMsg</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>MessageType</code> (short)</p></td><td ><p>Copy of the input parameter.</p></td></tr><tr><td  scope="row"><p><code>MessageBitmap</code> (short)</p></td><td ><p>Bitmap describing the message. Bit 0 is set if <code>ServerMessage</code> contains a message. Starting with AFP 3.0, bit 1 is set to indicate that the message is UTF-8 encoded.</p></td></tr><tr><td  scope="row"><p><code>ServerMessage</code> (string)</p></td><td ><p>Message from the server.</p></td></tr></table></div><p><span class="content_text">Figure 48</span> shows the request and reply blocks for the <code>FPGetSrvrMsg</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-218700" title="Figure 48Request and reply blocks for the FPGetSrvrMsg command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDDIIBG" title="Figure 48Request and reply blocks for the FPGetSrvrMsg command"></a><p><strong>Figure 48&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPGetSrvrMsg</code> command</p><img src = "../Art/afp_008.gif" alt = "Request and reply blocks for the FPGetSrvrMsg command" width="440" height="285"></div><br/><a name="//apple_ref/c/func/FPGetSrvrParms" title="FPGetSrvrParms"></a><a name="//apple_ref/doc/c_ref/FPGetSrvrParms" title="FPGetSrvrParms"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFDIAJ" title="FPGetSrvrParms"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_49"></a><h3 class="tight">FPGetSrvrParms</h3><p class="spaceabove">Gets server parameters.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPGetSrvrParms</code> (16).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred, <code>kFPParamErr</code> if the session reference number is unknown, or <code>kFPMiscErr</code> if an error occurred that is not specific to AFP.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <span class="content_text">Table 39</span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>The <code>VolName</code> string, the <code>HasPassword</code> bit, and the <code>HasConfigInfo</code> bit are packed without padding in the reply block.</p><p>For AFP 2.x, this command returns volume names in ANSI format with a maximum length of 27 bytes.</p><p>For AFP 3.x, this command returns volume names in UTF-8 format with a one byte length byte specifying any length up to 255. Note that the Finder limits setting volume names to no more than 27 characters.</p><p><span class="content_text">Table 39</span> describes the reply block for the <code>FPGetSrvrParms </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-234629" title="Table 39Reply block for the FPGetSrvrParms command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCEBEH" title="Table 39Reply block for the FPGetSrvrParms command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 39&nbsp;&nbsp;</strong>Reply block for the <code>FPGetSrvrParms</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>ServerTime</code> (long)</p></td><td ><p>Current date and time on the server’s clock.</p></td></tr><tr><td  scope="row"><p><code>MessageBitmap</code> (short)</p></td><td ><p>Number of <code>VolStructure</code> structures that follow.</p></td></tr><tr><td  scope="row"><p><code>VolStructure</code></p></td><td ><p>An array of <code>Volstructure </code>structures consisting of the following fields:<code>  Flags</code> (byte) where bit 0 (<code>HasConfigInfo</code>) is set if the volume has configuration information and bit 7 (<code>HasPassword</code>) is set if a password is set for the volume  <code>VolName</code> (string) name of the volume</p></td></tr></table></div><p><span class="content_text">Figure 49</span> shows the request and reply blocks for the <code>FPGetSrvrParms</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-218906" title="Figure 49Request and reply blocks for the FPGetSrvrParms command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEIIHJ" title="Figure 49Request and reply blocks for the FPGetSrvrParms command"></a><p><strong>Figure 49&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPGetSrvrParms</code> command</p><img src = "../Art/afp_057.gif" alt = "Request and reply blocks for the FPGetSrvrParms command" width="414" height="200"></div><br/><a name="//apple_ref/c/func/FPGetUserInfo" title="FPGetUserInfo"></a><a name="//apple_ref/doc/c_ref/FPGetUserInfo" title="FPGetUserInfo"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEIEGJ" title="FPGetUserInfo"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_50"></a><h3 class="tight">FPGetUserInfo</h3><p class="spaceabove">Gets information about a user.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
long UserID
short Bitmap
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPGetUserInfo</code> (37).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>UserID</em></dt><dd><p>ID of user for whom information is to be retrieved. (Not valid if the ThisUser bit is set.)</p></dd><dt><em>Bitmap</em></dt><dd><p>Bitmap describing which ID to retrieve, where bit zero is set to get the user’s User ID and bit 1 is set to get the user’s Primary Group ID.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text">Table 40</span> for the other possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-235156">Table 41</a></span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>The server retrieves the specified information for the specified user and packs them, in bitmap order, in the reply block.</p><p>This command can be used only to retrieve the User ID and the Primary Group ID of the user who is the client of this session, thus requiring that the <code>ThisUser</code> bit be set. The <code>UserID</code> parameter is intended for future use.</p><p><span class="content_text">Table 40</span> lists the result codes for the <code>FPGetUserInfo</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-234963" title="Table 40Result codes for the FPGetUserInfo command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDGFHHB" title="Table 40Result codes for the FPGetUserInfo command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 40&nbsp;&nbsp;</strong>Result codes for the <code>FPGetUserInfo</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to get information about the specified user.</p></td></tr><tr><td  scope="row"><p><code>kFPBitmapErr</code></p></td><td ><p>Attempt was made to retrieve a parameter that cannot be obtained with this command.</p></td></tr><tr><td  scope="row"><p><code>kFPCallNotSupported</code></p></td><td ><p>Server does not support this command.</p></td></tr><tr><td  scope="row"><p><code>kFPItemNotFound</code></p></td><td ><p>Specified User ID is unknown.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>ThisUser bit is not set.</p></td></tr></table></div><p><span class="content_text">Table 41</span> describes the reply block for the <code>FPGetUserInfo </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-235156" title="Table 41Reply block for the FPGetUserInfo command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDHJFBH" title="Table 41Reply block for the FPGetUserInfo command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 41&nbsp;&nbsp;</strong>Reply block for the <code>FPGetUserInfo</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>Bitmap</code> (short)</p></td><td ><p>Copy of the input parameter.</p></td></tr><tr><td  scope="row"><p><code>UserInfo</code></p></td><td ><p>Requested information, packed in bitmap order.</p></td></tr></table></div><p><span class="content_text">Figure 50</span> shows the request and reply blocks for the <code>FPGetUserInfo</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-219574" title="Figure 50Request and reply blocks for the FPGetUserInfo command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDDHBBE" title="Figure 50Request and reply blocks for the FPGetUserInfo command"></a><p><strong>Figure 50&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPGetUserInfo</code> command</p><img src = "../Art/afp_058.gif" alt = "Request and reply blocks for the FPGetUserInfo command" width="347" height="239"></div><br/><a name="//apple_ref/c/func/FPGetVolParms" title="FPGetVolParms"></a><a name="//apple_ref/doc/c_ref/FPGetVolParms" title="FPGetVolParms"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCFGFF" title="FPGetVolParms"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_51"></a><h3 class="tight">FPGetVolParms</h3><p class="spaceabove">Gets volume parameters.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
short Bitmap
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPGetVolParms</code> (17).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID for the volume whose parameters are to be retrieved.</p></dd><dt><em>Bitmap</em></dt><dd><p>Bitmap describing the parameters that are to be returned. Set the bit of the desired parameter. This bitmap is the same as the bitmap used by the <code><a href="reference.html#//apple_ref/c/func/FPOpenVol">FPOpenVol</a></code> command. For bit definitions for this bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Volume_Bitmap">Volume Bitmap</a></span>.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred, <code>kFPParamErr</code> if the session reference number or Volume ID is unknown, <code>kFPBitmapErr</code> if the specified bitmap has unrecognized bits set, or <code>kFPMiscErr</code> if an error occurred that is not specific to AFP.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-235332">Table 42</a></span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command retrieves parameters that describe a volume as specified by the volume’s Volume ID.</p><p>The server responds to this command by returning a reply block containing a bitmap for the volume parameters and the parameters themselves. All variable-length parameters, such as Volume Name, are at the end of the block. The server represents variable-length parameters in bitmap order as fixed-length offsets (shorts). These offsets are measured from the start of the parameters (not from the start of the bitmap) to the start of the variable-length parameters. The variable-length parameters are then packed after all fixed-length parameters.</p><p><span class="content_text">Table 42</span> describes the reply block for the <code>FPGetVolParms </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-235332" title="Table 42Reply block for the FPGetVolParms command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDDJCGI" title="Table 42Reply block for the FPGetVolParms command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 42&nbsp;&nbsp;</strong>Reply block for the <code>FPGetVolParms</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>Bitmap</code> (short)</p></td><td ><p>Copy of the input parameter.</p></td></tr><tr><td  scope="row"><p><code>VolumeParameters</code></p></td><td ><p>Volume parameters packed in bitmap order.</p></td></tr></table></div><p><span class="content_text">Figure 51</span> shows the request and reply blocks for the <code>FPGetVolParms</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-219742" title="Figure 51Request and reply blocks for the FPGetVolParms command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBFEFD" title="Figure 51Request and reply blocks for the FPGetVolParms command"></a><p><strong>Figure 51&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPGetVolParms</code> command</p><img src = "../Art/afp_059.gif" alt = "Request and reply blocks for the FPGetVolParms command" width="336" height="152"></div><br/><p>For the layout of the bitmap and the volume parameters, see the sections <code><a href="reference.html#//apple_ref/doc/constant_group/Volume_Attributes_Bitmap">Volume Attributes Bitmap</a></code> and <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Volume_Bitmap">Volume Bitmap</a></span>.</p><a name="//apple_ref/c/func/FPListExtAttrs" title="FPListExtAttrs"></a><a name="//apple_ref/doc/c_ref/FPListExtAttrs" title="FPListExtAttrs"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDHGFHC" title="FPListExtAttrs"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_52"></a><h3 class="tight">FPListExtAttrs</h3><p class="spaceabove">Gets the names of extended attributes for a file or directory.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long DirectoryID unsigned short Bitmap
short ReqCount
long StartIndex
long MaxReplySize
byte PathType
string Pathname
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPListExtAttrs</code> (72).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume identifier.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Directory identifier.</p></dd><dt><em>Bitmap</em></dt><dd><p>Bitmap describing the desired behavior when getting the names of extended attributes. For this command <code>kAttrDontFollow</code> is the only valid bit. For details, see <code><a href="reference.html#//apple_ref/doc/constant_group/Extended_Attributes_Bitmap">Extended Attributes Bitmap</a></code>.</p></dd><dt><em>ReqCount</em></dt><dd><p>Reserved for future use. For AFP 3.2, clients can set this parameter to any numeric value. Servers should ignore this parameter and return all extended attribute names.</p></dd><dt><em>StartIndex</em></dt><dd><p>Reserved for future use. For AFP 3.2, set <code>StartIndex</code> to zero. Servers should ignore this parameter.</p></dd><dt><em>MaxReplySize</em></dt><dd><p>Size in bytes of the reply that your application can handle, including the size of the <code>Bitmap</code> and <code>DataLength</code> parameters. Set this parameter to zero to get the size of the reply block that would be returned without actually getting the names of the extended attributes.</p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname to desired file or directory. <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text">Table 43</span> for other possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <code>"Reply block for the FPListExtAttrs command "</code> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>If the result code is <code>kFPNoErr</code>, this command returns in the reply block the names of extended attributes for the specified file or directory.</p><p>Support for this command, as well as <code><a href="reference.html#//apple_ref/c/func/FPGetExtAttr">FPGetExtAttr</a></code>, <code><a href="reference.html#//apple_ref/c/func/FPRemoveExtAttr">FPRemoveExtAttr</a></code> and <code><a href="reference.html#//apple_ref/c/func/FPSetExtAttr">FPSetExtAttr</a></code> is required in order to support extended attributes. UTF-8 support is also required in order to support extended attributes.</p><p><span class="content_text">Table 43</span> lists the possible result codes for the <code>FPListExtAttrs</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-309392" title="Table 43Result codes for the FPListExtAttrs command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCEEGG" title="Table 43Result codes for the FPListExtAttrs command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 43&nbsp;&nbsp;</strong>Result codes for the <code>FPListExtAttrs</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to list the extended attribute names for the specified file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPBitmapErr</code></p></td><td ><p>Bitmap is null or specifies a value that is invalid for this command.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Input parameters do not point to an existing file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>A parameter is invalid.</p></td></tr></table></div><p><span class="content_text">Table 44</span> describes the reply block for the <code>FPListExtAttrs </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-309980" title="Table 44Reply block for the FPListExtAttrs command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIFIBB" title="Table 44Reply block for the FPListExtAttrs command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 44&nbsp;&nbsp;</strong>Reply block for the <code>FPListExtAttrs</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>Bitmap</code> (short)</p></td><td ><p>Reserved.</p></td></tr><tr><td  scope="row"><p><code>DataLength</code> (unsigned long)</p></td><td ><p>Length of the data that follows. If <code>MaxReplySize</code> was set to zero, <code>DataLength</code> describes the length of data that would otherwise have been returned.</p></td></tr><tr><td  scope="row"><p><code>AttributeNames</code> (string)</p></td><td ><p>Series of null-terminated, UTF-8 encoded extended attribute names if <code>MaxReplySize</code> was not set to zero.</p></td></tr></table></div><p><span class="content_text">Figure 37</span> shows the request and reply blocks for the <code>FPListExtAttrs</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-309519" title="Figure 52Request and reply blocks for the FPListExtAttrs command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDGADJB" title="Figure 52Request and reply blocks for the FPListExtAttrs command"></a><p><strong>Figure 52&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPListExtAttrs</code> command</p><img src = "../Art/afp_FPListExtendedAttr.gif" alt = "Request and reply blocks for the FPListExtAttrs command" width="293" height="472"></div><br/><h5 class="tight">Version Notes</h5><p>Introduced in AFP 3.2.</p><a name="//apple_ref/c/func/FPLogin" title="FPLogin"></a><a name="//apple_ref/doc/c_ref/FPLogin" title="FPLogin"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDHHEDA" title="FPLogin"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_53"></a><h3 class="tight">FPLogin</h3><p class="spaceabove">Establishes a session with a server.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
string AFPVersion
string UAM
UserAuthInfo
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPLogin</code> (18).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>AFPVersion</em></dt><dd><p>String indicating which AFP version to use. For possible values, see <code><a href="reference.html#//apple_ref/doc/constant_group/AFP_Version_Strings">AFP Version Strings</a></code>.</p></dd><dt><em>UAM</em></dt><dd><p>String indicating which UAM to use. For possible values, see <code><a href="reference.html#//apple_ref/doc/constant_group/AFP_UAM_Strings">AFP UAM Strings</a></code>.</p></dd><dt><em>UserAuthInfo</em></dt><dd><p>UAM-dependent information required to authenticate the user (can be null). The data type of <code>UserAuthInfo</code> depends on the UAM specified by <code>UAM</code>.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-235797">Table 45</a></span> for the possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-236026">Table 46</a></span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command establishes an AFP session with an AFP server. Before calling <code>FPLogin</code>, the AFP client should call <code><a href="reference.html#//apple_ref/c/func/FPGetAuthMethods">FPGetAuthMethods</a></code> to obtain the AFP versions and UAMs that the server supports. From the list of AFP versions and UAMs returned by <code>FPGetAuthMethods</code>, the AFP client chooses the highest AFP version and the most secure UAM that the client supports and provides them as the <code>AFPVersion</code> and <code>UAM</code> parameters to the <code>FPLogin</code> command.</p><p>If the server returns any result code other than <code>kFPAuthContinue</code> or <code>kFPNoErr</code>, a session has not been established.</p><p>For more detailed information about UAMs, see “File Server Security” in the “Introduction” section.</p><p>The AFP server keeps a count of log in attempts that is reset to zero after every successful login. For every failed login attempt without a preceding successful login, the count is incremented. When the maximum number of failed login attempts is reached, the user’s account is disabled. Any attempts to log in after the account is disabled yield a result code of <code>kFPParamErr</code>, indicating that the user is unknown or that his or her account is disabled. The administrator must enable the user’s account again. AFP does not notify the administrator that a user’s account has been disabled; the user must notify the administrator by some other means.</p><p><span class="content_text">Table 45</span> lists the result codes for the <code>FPLogin</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-235797" title="Table 45Result codes for the FPLogin command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCIAHG" title="Table 45Result codes for the FPLogin command"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 45&nbsp;&nbsp;</strong>Result codes for the <code>FPLogin</code> command</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAuthContinue</code></p></td><td ><p>Authentication is not yet complete.</p></td></tr><tr><td  scope="row"><p><code>kFPBadUAM</code></p></td><td ><p>Specified UAM is unknown.</p></td></tr><tr><td  scope="row"><p><code>kFPBadVersNum</code></p></td><td ><p>Server does not support the specified AFP version.</p></td></tr><tr><td  scope="row"><p><code>kFPCallNotSupported</code></p></td><td ><p>Server does not support this command.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>User is already authenticated.</p></td></tr><tr><td  scope="row"><p><code>kFPNoServer</code></p></td><td ><p>Server is not responding.</p></td></tr><tr><td  scope="row"><p><code>kFPPwdExpiredErr</code></p></td><td ><p>User’s password has expired. User is required to change his or her password. The user is logged on but can only change his or her password or log out.</p></td></tr><tr><td  scope="row"><p><code>kFPPwdNeedsChangeErr</code></p></td><td ><p>User’s password needs to be changed. User is required to change his or her password. The user is logged on but can only change his or her password or log out.</p></td></tr><tr><td  scope="row"><p><code>kFPServerGoingDown</code></p></td><td ><p>Server is shutting down.</p></td></tr><tr><td  scope="row"><p><code>kFPUserNotAuth</code></p></td><td ><p>Authentication failed.</p></td></tr></table></div><p><span class="content_text">Table 46</span> describes the reply block for the <code>FPLogin</code><code></code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-236026" title="Table 46Reply block for the FPLogin command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEBDAE" title="Table 46Reply block for the FPLogin command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 46&nbsp;&nbsp;</strong>Reply block for the <code>FPLogin</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>SRefNum</code> (short)</p></td><td ><p>Session reference number used to refer to this session when sending all subsequent commands for this session. The session reference number is valid if <code>kFPNoErr</code> or <code>kFPAuthContinue</code> is returned as the result code.</p></td></tr><tr><td  scope="row"><p><code>ID</code> (short)</p></td><td ><p>ID returned by certain UAMs to be passed to the <code>FPLoginCont</code> command. (Valid only when <code>kFPAuthContinue</code> is returned as the result code.)</p></td></tr><tr><td  scope="row"><p><code>UserAuthInfo</code></p></td><td ><p>Value returned by certain UAMs. (Valid only when <code>kFPAuthContinue</code> is returned as the result code.)</p></td></tr></table></div><p><span class="content_text">Figure 53</span> shows the request and reply blocks for the <code>FPLogin</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-220159" title="Figure 53Request and reply blocks for the FPLogin command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDECCEB" title="Figure 53Request and reply blocks for the FPLogin command"></a><p><strong>Figure 53&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPLogin</code> command</p><img src = "../Art/afp_060.gif" alt = "Request and reply blocks for the FPLogin command" width="342" height="194"></div><br/><a name="//apple_ref/c/func/FPLoginCont" title="FPLoginCont"></a><a name="//apple_ref/doc/c_ref/FPLoginCont" title="FPLoginCont"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFAEBJ" title="FPLoginCont"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_54"></a><h3 class="tight">FPLoginCont</h3><p class="spaceabove">Continues the login and user authentication process started by a login command.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short ID
UserAuthInfo
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPLoginCont</code> (19).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>ID</em></dt><dd><p>Number returned by a previous call to <code>FPLogin</code>, <code>FPLoginExt</code>, or <code>FPLoginCont</code>.</p></dd><dt><em>UserAuthInfo</em></dt><dd><p>UAM-dependent information required to authenticate the user (can be null). The data type of <code>UserAuthInfo</code> depends on the UAM that was specified when <code><a href="reference.html#//apple_ref/c/func/FPLogin">FPLogin</a></code> or <code><a href="reference.html#//apple_ref/c/func/FPLoginExt">FPLoginExt</a></code> was called.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-236453">Table 47</a></span> for the possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-236247">Table 48</a></span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command sends the <code>ID</code> and <code>UserAuthInfo</code> parameters to the server, which uses them to execute the next step in the UAM. If an additional exchange of packets is required, the server returns a result code of <code>kFPAuthContinue</code>. Otherwise, it returns no <code>kFPNoErr</code> (meaning the user has been authenticated) or <code>kFPUserNotAuth</code> (meaning the authentication has failed). If the server returns no error, <code>SRefNum</code> is valid for use when sending subsequent AFP commands for this session. If the server returns <code>kFPUserNotAuth</code>, it also closes the session and invalidates <code>SRefNum</code>.</p><p>If this command returns a result code of <code>kFPPwExpiredErr</code> or <code>kFPPwdNeedsChangeErr</code>, the AFP client should display an explanatory dialog box and allow the user to change his or her password.</p><p><span class="content_text">Table 47</span> lists the result codes for the <code>FPLoginCont</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-236453" title="Table 47Result codes for the FPLoginCont command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJFCII" title="Table 47Result codes for the FPLoginCont command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 47&nbsp;&nbsp;</strong>Result codes for the <code>FPLoginCont </code>command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAuthContinue</code></p></td><td ><p>Authentication is not yet complete.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPNoServer</code></p></td><td ><p>Server is not responding.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Authentication failed for an undisclosed reason.</p></td></tr><tr><td  scope="row"><p><code>kFPPwdExpiredErr</code></p></td><td ><p>User’s password has expired. User is required to change his or her password. The user is logged in but can only change his or her password or log out.</p></td></tr><tr><td  scope="row"><p><code>kFPPwdNeedsChangeErr</code></p></td><td ><p>User’s password needs to be changed. User is required to change his or her password. The user is logged on but can only change his or her password or log out.</p></td></tr><tr><td  scope="row"><p><code>kFPUserNotAuth</code></p></td><td ><p>User was not authenticated because the password is incorrect.</p></td></tr></table></div><p><span class="content_text">Table 48</span> describes the reply block for the <code>FPLoginCont </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-236247" title="Table 48Reply block for the FPLoginCont command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFIECB" title="Table 48Reply block for the FPLoginCont command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 48&nbsp;&nbsp;</strong>Reply block for the <code>FPLoginCont</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>ID</code> (short)</p></td><td ><p>ID returned by certain UAMs to be passed to the <code>FPLoginCont</code> command. (Valid only if <code>kFPAuthContinue</code> is returned as the result code.)</p></td></tr><tr><td  scope="row"><p><code>UserAuthInfo</code></p></td><td ><p>Value returned by certain UAMs. (Valid only if <code>kFPAuthContinue</code> is returned as the result code.)</p></td></tr></table></div><p><span class="content_text">Figure 54</span> shows the request and reply blocks for the <code>FPLoginCont</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-220513" title="Figure 54Request and reply blocks for the FPLoginCont command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBFDGD" title="Figure 54Request and reply blocks for the FPLoginCont command"></a><p><strong>Figure 54&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPLoginCont</code> command</p><img src = "../Art/afp_077.gif" alt = "Request and reply blocks for the FPLoginCont command" width="302" height="165"></div><br/><a name="//apple_ref/c/func/FPLoginExt" title="FPLoginExt"></a><a name="//apple_ref/doc/c_ref/FPLoginExt" title="FPLoginExt"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBJBDI" title="FPLoginExt"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_55"></a><h3 class="tight">FPLoginExt</h3><p class="spaceabove">Establishes a session with a server using an Open Directory domain.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short Flags
string AFPVersion
string UAM
byte UserNameType
AFPName UserName
byte PathType
string Pathname
byte Pad
UserAuthInfo
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPLoginExt</code> (63).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>Flags</em></dt><dd><p>Flags providing additional information. (No flags are currently defined.)</p></dd><dt><em>AFPVersion</em></dt><dd><p>String indicating which AFP version to use. For possible values, see <code><a href="reference.html#//apple_ref/doc/constant_group/AFP_Version_Strings">AFP Version Strings</a></code>.</p></dd><dt><em>UAM</em></dt><dd><p>String indicating which UAM to use. For possible values, see <code><a href="reference.html#//apple_ref/doc/constant_group/AFP_UAM_Strings">AFP UAM Strings</a></code>.</p></dd><dt><em>UserNameType</em></dt><dd><p>Type of name in <code>UserName</code>; always 3.</p></dd><dt><em>UserName</em></dt><dd><p>UTF-8–encoded name of the user.</p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>PathName</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname for the Open Directory domain in which the user specified by <code>UserName</code> can be found. <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte that may be required for <code>Pathname</code> to end on an even boundary.</p></dd><dt><em>UserAuthInfo</em></dt><dd><p>UAM-dependent information required to authenticate the user (can be null). The data type of <code>UserAuthInfo</code> is dependent on the UAM specified by <code>UAM</code>.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-283547">Table 49</a></span> for other possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code> or <code>kFPAuthContinue</code>, the server returns a reply block. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-236988">Table 50</a></span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command establishes an AFP session using the specified Open Directory domain in which information about the user can be found. Before sending this command, the AFP client should call <code><a href="reference.html#//apple_ref/c/func/FPGetAuthMethods">FPGetAuthMethods</a></code> to obtain the UAMs that the Open Directory domain supports. From the list of UAMs returned by <code>FPGetAuthMethods</code>, the AFP client chooses the most secure UAM that it supports and provides it in the <code>UAM</code> parameter of the <code>FPLoginExt</code> command.</p><p>If the server returns any result code other than <code>kFPAuthContinue</code> or <code>KFPNoErr</code>, a session has not been established.</p><p>For more detailed information about UAMs, see “File Server Security” in the “Introduction” section.</p><p>The AFP server keeps a count of log in attempts that is reset to zero after every successful login. For every failed log in attempt without a preceding successful log in, the count is incremented. When the maximum number of failed log in attempts is reached, the user’s account is disabled. Any attempts to log in after the account is disabled result in an <code>kFPParamErr</code> indicating that the user is unknown or that his or her account is disabled. The administrator must enable the user’s account again. AFP does not notify the administrator that a user’s account has been disabled; the user must notify the administrator by some other means.</p><p><span class="content_text">Table 49</span> lists the result codes for the <code>FPLoginExt</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-283547" title="Table 49Result codes for the FPLoginExt command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBJBIG" title="Table 49Result codes for the FPLoginExt command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 49&nbsp;&nbsp;</strong>Result codes for the <code>FPLoginExt</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAuthContinue</code></p></td><td ><p>Authentication is not yet complete.</p></td></tr><tr><td  scope="row"><p><code>kFPBadUAM</code></p></td><td ><p>Specified UAM is unknown.</p></td></tr><tr><td  scope="row"><p><code>kFPBadVersNum</code></p></td><td ><p>Server does not support the specified AFP version.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>User is already authenticated.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Specified user is unknown or the account has been disabled due to too many login attempts.</p></td></tr><tr><td  scope="row"><p><code>kFPPwdExpiredErr</code></p></td><td ><p>User’s password has expired. User is required to change his or her password. The user is logged on but can only change his or her password or log out.</p></td></tr><tr><td  scope="row"><p><code>kFPPwdNeedsChangeErr</code></p></td><td ><p>User’s password needs to be changed. User is required to change his or her password. The user is logged in but can only change his or her password or log out.</p></td></tr><tr><td  scope="row"><p><code>kFPNoServer</code></p></td><td ><p>Server is not responding.</p></td></tr><tr><td  scope="row"><p><code>kFPServerGoingDown</code></p></td><td ><p>Server is shutting down.</p></td></tr><tr><td  scope="row"><p><code>kFPUserNotAuth</code></p></td><td ><p>Authentication failed.</p></td></tr></table></div><p><span class="content_text">Table 50</span> describes the reply block for the<code> FPLoginExt</code><code></code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-236988" title="Table 50Reply block for the FPLoginExt command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDHBIEH" title="Table 50Reply block for the FPLoginExt command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 50&nbsp;&nbsp;</strong>Reply block for the <code>FPLoginExt</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>SRefNum</code> (short)</p></td><td ><p>Session reference number used to refer to this session when sending all subsequent commands for this session. The session reference number is valid if <code>kFPNoErr</code> or <code>kFPAuthContinue</code> is returned as the result code.</p></td></tr><tr><td  scope="row"><p><code>ID</code> (short)</p></td><td ><p>ID returned by certain UAMs to be passed to the FPLoginCont command. (Valid only when <code>kFPAuthContinue</code> is returned as the result code.)</p></td></tr><tr><td  scope="row"><p><code>UserAuthInfo</code></p></td><td ><p>Value returned by certain UAMs when <code>kFPAuthContinue</code> is returned as the result code.</p></td></tr></table></div><p><span class="content_text">Figure 55</span> shows the request and reply blocks for the <code>FPLoginExt</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-220919" title="Figure 55Request and reply blocks for the FPLoginExt command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFBDFA" title="Figure 55Request and reply blocks for the FPLoginExt command"></a><p><strong>Figure 55&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPLoginExt</code> command</p><img src = "../Art/afp_027.gif" alt = "Request and reply blocks for the FPLoginExt command" width="329" height="425"></div><br/><a name="//apple_ref/c/func/FPLogout" title="FPLogout"></a><a name="//apple_ref/doc/c_ref/FPLogout" title="FPLogout"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJCDHE" title="FPLogout"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_56"></a><h3 class="tight">FPLogout</h3><p class="spaceabove">Terminates a session with a server.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPLogout</code> (20).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred, <code>kFPParamErr</code> if the session reference number is unknown, or <code>kFPMiscErr</code> if an error occurred that is not specific to AFP.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command terminates sessions established by <code><a href="reference.html#//apple_ref/c/func/FPLogin">FPLogin</a></code><code></code>and <code><a href="reference.html#//apple_ref/c/func/FPLoginExt">FPLoginExt</a></code><code></code>. The server flushes and closes any forks opened by the session, frees all session-related resources, and invalidates the session reference number.</p><p><span class="content_text">Figure 56</span> shows the request block for the <code>FPLogout</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-221017" title="Figure 56Request block for the FPLogout command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFJCGA" title="Figure 56Request block for the FPLogout command"></a><p><strong>Figure 56&nbsp;&nbsp;</strong>Request block for the <code>FPLogout</code> command</p><img src = "../Art/afp_061.gif" alt = "Request block for the FPLogout command" width="123" height="91"></div><br/><a name="//apple_ref/c/func/FPMapID" title="FPMapID"></a><a name="//apple_ref/doc/c_ref/FPMapID" title="FPMapID"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEDIGG" title="FPMapID"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_57"></a><h3 class="tight">FPMapID</h3><p class="spaceabove">Maps a User ID to a user name or a Group ID to a group name.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Subfunction
long ID
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPMapID</code> (21).</p></dd><dt><em>Subfunction</em></dt><dd><p>Subfunction code, where 1 maps a User ID to a Macintosh Roman user name, 2 maps a Group ID to a Macintosh Roman group name, 3 maps a User ID to a UTF-8–encoded user name, and 4 maps a Group ID to a UTF-8–encoded group name.</p></dd><dt><em>ID</em></dt><dd><p>Group ID or User ID that is to be mapped.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred, <code>kFPParamErr</code> if the session reference number or subfunction code is unknown, <code>kFPItemNotFound</code> if the ID was not found, or <code>kFPMiscErr</code> if an error occurred that is not specific to AFP.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. The reply block consists of a string, called <code>Name</code>, containing the name that corresponds to <code>ID</code>. The name can be a string of up to 255 Macintosh Roman characters or an AFPName of up to 255 characters.</p></dd></dl><h5 class="tight">Discussion</h5><p>The server retrieves the user or group name in that corresponds to the specified User ID or Group ID.</p><p>The <code>Subfunction</code> parameter tells the server which database (user or group) to search first. User and group IDs come from the same pool of numbers, so if the ID has been assigned, <code>FPMapID</code> always returns a user or group name.</p><p><span class="content_text">Figure 57</span> shows the request and reply blocks for the <code>FPMapID</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-221113" title="Figure 57Request and reply blocks for the FPMapID command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDGGDCI" title="Figure 57Request and reply blocks for the FPMapID command"></a><p><strong>Figure 57&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPMapID</code> command</p><img src = "../Art/afp_034.gif" alt = "Request and reply blocks for the FPMapID command" width="324" height="151"></div><br/><a name="//apple_ref/c/func/FPMapName" title="FPMapName"></a><a name="//apple_ref/doc/c_ref/FPMapName" title="FPMapName"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCIFHJ" title="FPMapName"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_58"></a><h3 class="tight">FPMapName</h3><p class="spaceabove">Maps a user name to a User ID or a group name to a Group ID.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Subfunction
string Name
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPMapName</code> (22).</p></dd><dt><em>Subfunction</em></dt><dd><p>Subfunction code, where 1 maps a UTF-8–encoded user name to a User ID, 2 maps a UTF-8–encoded group name to a Group ID, 3 maps a Macintosh Roman user name to User ID, and 4 maps a Macintosh Roman group name to a Group ID.</p></dd><dt><em>Name</em></dt><dd><p>Name that is to be mapped to an ID. The name can be a string of up to 255 Macintosh Roman characters or an AFPName of up to 255 characters.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred, <code>kFPParamErr</code> if the session reference number or subfunction code is unknown, <code>kFPItemNotFound</code> if the ID was not found, or <code>kFPMiscErr</code> if an error occurred that is not specific to AFP.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. The reply block consists of a long, called <code>ID</code>, containing the ID corresponding to the input name.</p></dd></dl><h5 class="tight">Discussion</h5><p>The server retrieves the ID number that corresponds to the specified user or group name or returns a <code>kFPItemNotFound</code> result code if it does not find the name in its list of valid names.</p><p>The <code>Subfunction</code> parameter tells the server which database (user or group) to search first. If you have a user and a group that are both named “Fred” and you call <code>FPMapName</code>, the subfunction code will determine in which database (user or group) the match is found.</p><p><span class="content_text">Figure 58</span> shows the request and reply blocks for the <code>FPMapName</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-221211" title="Figure 58Request and reply blocks for the FPMapName command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEIHDH" title="Figure 58Request and reply blocks for the FPMapName command"></a><p><strong>Figure 58&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPMapName</code> command</p><img src = "../Art/afp_035.gif" alt = "Request and reply blocks for the FPMapName command" width="327" height="110"></div><br/><a name="//apple_ref/c/func/FPMoveAndRename" title="FPMoveAndRename"></a><a name="//apple_ref/doc/c_ref/FPMoveAndRename" title="FPMoveAndRename"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBJHCA" title="FPMoveAndRename"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_59"></a><h3 class="tight">FPMoveAndRename</h3><p class="spaceabove">Moves a CNode to another location on a volume or renames a CNode.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long SourceDirectoryID
long DestDirectoryID
byte SourcePathType
string SourcePathname
byte DestPathType
string DestPathname
byte NewType
string NewName
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPMoveAndRename</code> (23).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>SourceDirectoryID</em></dt><dd><p>Source ancestor Directory ID.</p></dd><dt><em>DestDirectoryID</em></dt><dd><p>Destination ancestor Directory ID.</p></dd><dt><em>SourcePathType</em></dt><dd><p>Type of names in <code>SourcePathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>SourcePathname</em></dt><dd><p>Pathname of the file or directory to be moved (may be null if a directory is being moved). <code>SourcePathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>DestPathType</em></dt><dd><p>Type of names in <code>DestPathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>DestPathname</em></dt><dd><p>Pathname of the file or directory to be moved (may be null if a directory is being moved). <code>DestPathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>NewType</em></dt><dd><p>Type of name in <code>NewName</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>NewName</em></dt><dd><p>New name of file or directory (may be null). <code>NewName</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-237219">Table 51</a></span> for other possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. The reply block consists of a long, called ID, containing the ID corresponding to the input name.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command copies and optionally renames the CNode and removes the CNode from the original parent directory. If the <code>NewName</code> parameter is null, the moved CNode retains it original name. Otherwise, the server moves the CNode, creating the Long or Short Names as described in the section “Catalog Node Names” in Chapter 1. The CNode’s modification date and the modification date of the source and destination parent directories are set to the server’s clock. The CNode’s Parent ID is set to the destination Parent ID. All other parameters remain unchanged, and if the CNode is a directory, the parameters of all descendent directories and files remain unchanged.</p><p>The <code>FPMoveAndRename</code> command indicates the destination of the move by specifying the ancestor Directory ID and the pathname to the CNode’s destination parent directory.</p><p>If the CNode being moved is a directory, all its descendents are moved as well.</p><p>To move a directory, the user must have search access to all ancestors, down to and including the source and destination parent directories, as well as write access to those directories. To move a file, the user must have search access to all ancestors, except the source and destination parents, as well as read and write access to the source parent directory and write access to the destination parent directory.</p><p>A CNode cannot be moved from one volume to another with this command, even if both volumes are managed by the same server.</p><p><span class="content_text">Table 51</span> lists the result codes for the <code>FPMoveAndRename</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-237219" title="Table 51Result codes for the FPMoveAndRename command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCGIGE" title="Table 51Result codes for the FPMoveAndRename command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 51&nbsp;&nbsp;</strong>Result codes for the <code>FPMoveAndRename</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to move or rename the specified file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPCantMove</code></p></td><td ><p>Attempt was made to move a directory into one of its descendent directories.</p></td></tr><tr><td  scope="row"><p><code>kFPInsideSharedErr</code></p></td><td ><p>Directory being moved contains a share point and is being moved into a directory that is shared or is the descendent of a directory that is shared.</p></td></tr><tr><td  scope="row"><p><code>kFPInsideTrashErr</code></p></td><td ><p>Shared directory is being moved into the Trash; a directory is being moved to the trash and it contains a shared folder.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectExists</code></p></td><td ><p>File or directory having the name specified by <code>NewName</code> already exists.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectLocked</code></p></td><td ><p>Directory being moved, renamed, or moved and renamed is marked RenameInhibit; file being moved and renamed is marked RenameInhibit.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Input parameters do not point to an existing file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number, Volume ID, or pathname type is unknown; a pathname or <code>NewName</code> is invalid.</p></td></tr><tr><td  scope="row"><p><code>kFPVolLocked</code></p></td><td ><p>Volume is ReadOnly.</p></td></tr></table></div><p><span class="content_text">Figure 59</span> shows the request block for the <code>FPMoveAndRename</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-221527" title="Figure 59Request block for the FPMoveAndRename command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJAIBC" title="Figure 59Request block for the FPMoveAndRename command"></a><p><strong>Figure 59&nbsp;&nbsp;</strong>Request block for the <code>FPMoveAndRename</code> command</p><img src = "../Art/afp_062.gif" alt = "Request block for the FPMoveAndRename command" width="133" height="504"></div><br/><a name="//apple_ref/c/func/FPOpenDir" title="FPOpenDir"></a><a name="//apple_ref/doc/c_ref/FPOpenDir" title="FPOpenDir"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJIAFB" title="FPOpenDir"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_60"></a><h3 class="tight">FPOpenDir</h3><p class="spaceabove">Opens a directory on a variable Directory ID volume and returns its Directory ID.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long DirectoryID
byte PathType
string Pathname
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPOpenDir</code> (25).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Ancestor Directory ID.</p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname of the file or directory to be moved (may be null if a directory is being moved). <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-237490">Table 52</a></span> for other possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. The reply block consists of a long, called DirectoryID, containing the Directory ID of the opened directory.</p></dd></dl><h5 class="tight">Discussion</h5><p>If <code>VolumeID</code> specifies a variable Directory ID volume, the server generates a Directory ID for the specified directory. If VolumeID specifies a fixed Directory ID type, the server returns the fixed Directory ID belonging to the directory specified by <code>Pathname</code>.</p><p>Although this command can obtain a Directory ID for a directory on a fixed Directory ID volume, the recommended way to obtain a Directory ID for a directory on a fixed Directory ID volume is to call <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code>.</p><p>The user must have search access to all ancestors down to and including the specified directory’s parent directory.</p><p><span class="content_text">Table 52</span> lists the result codes for the <code>FPOpenDir</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-237490" title="Table 52Result codes for the FPOpenDir command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDECJGB" title="Table 52Result codes for the FPOpenDir command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 52&nbsp;&nbsp;</strong>Result codes for the <code>FPOpenDir</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code </p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to open the directory.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Input parameters do not point to an existing directory.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectTypeErr</code></p></td><td ><p>Input parameters point to a file.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number, Volume ID, or pathname type is unknown; a pathname is invalid.</p></td></tr></table></div><p><span class="content_text">Figure 60</span> shows the request and reply blocks for the <code>FPOpenDir</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-221761" title="Figure 60Request and reply blocks for the FPOpenDir command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBEJDC" title="Figure 60Request and reply blocks for the FPOpenDir command"></a><p><strong>Figure 60&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPOpenDir</code> command</p><img src = "../Art/afp_063.gif" alt = "Request and reply blocks for the FPOpenDir command" width="309" height="272"></div><br/><a name="//apple_ref/c/func/FPOpenDT" title="FPOpenDT"></a><a name="//apple_ref/doc/c_ref/FPOpenDT" title="FPOpenDT"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEICJB" title="FPOpenDT"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_61"></a><h3 class="tight">FPOpenDT</h3><p class="spaceabove">Opens the Desktop database on a particular volume.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPOpenDT</code> (48).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred, <code>kFPParamErr</code> if the session reference number or <code>VolumeID </code>is unknown, or <code>kFPMiscErr</code> if an error occurred that is not specific to AFP.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. The reply block consists of a short, called <code>DTRefNum</code>, containing a Desktop database reference number.</p></dd></dl><h5 class="tight">Discussion</h5><p>The server opens the Desktop database on the selected volume and returns a Desktop database reference number that is unique among such reference numbers. The Desktop database reference number is to be used in all subsequent Desktop database commands relating to this volume.</p><p>The user must have previously called <code><a href="reference.html#//apple_ref/c/func/FPOpenVol">FPOpenVol</a></code> for this volume.</p><p><span class="content_text">Figure 61</span> shows the request and reply blocks for the <code>FPOpenDT</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-221852" title="Figure 61Request and reply blocks for the FPOpenDT command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEDGJF" title="Figure 61Request and reply blocks for the FPOpenDT command"></a><p><strong>Figure 61&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPOpenDT</code> command</p><img src = "../Art/afp_064.gif" alt = "Request and reply blocks for the FPOpenDT command" width="303" height="121"></div><br/><a name="//apple_ref/c/func/FPOpenFork" title="FPOpenFork"></a><a name="//apple_ref/doc/c_ref/FPOpenFork" title="FPOpenFork"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJJDED" title="FPOpenFork"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_62"></a><h3 class="tight">FPOpenFork</h3><p class="spaceabove">Opens a fork of an existing file for reading or writing.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Flag
short VolumeID
long DirectoryID
short Bitmap
short AccessMode
byte PathType
string Pathname
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPOpenFork</code> (26).</p></dd><dt><em>Flag</em></dt><dd><p>Bit 7 of the <code>Flag </code>parameter is the <code>ResourceDataFlag</code> bit, and it indicates which fork to open, where 0 specifies the data fork and 1 specifies the resource fork.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Ancestor Directory ID.</p></dd><dt><em>Bitmap</em></dt><dd><p>Bitmap describing the fork parameters to be returned. Set the bit that corresponds to each desired parameter. This bitmap is the same as the FileBitmap parameter of the <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> command and can be null. For bit definitions for the File bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/File_Bitmap">File Bitmap</a></span>.</p></dd><dt><em>AccessMode</em></dt><dd><p>Desired access and deny modes, specified by any combination of the following bits:   0 = Read — allows the fork to be read 1 = Write — allows the fork to be written 4 = DenyRead — prevents others from reading the fork while it is open 5 = DenyWrite — prevents others from writing the fork while it is open  For more information on access and deny modes, see “File Sharing Modes” in the “Introduction” section.</p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname to the desired file (cannot be null). <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-237679">Table 53</a></span> for the possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-237899">Table 54</a></span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>The server opens the specified fork if the user has the access rights for the requested access mode and if the access mode does not conflict with already-open access paths to the fork.</p><p>If the fork is opened, the server returns in the reply block a copy of the input bitmap, an open fork reference number for use with all subsequent commands involving the opened fork, and followed by file parameters packed in bitmap order.</p><p>File parameters are returned only if the command completes without error or if the command returns with a <code>kFPDenyConflict</code> result code. In the latter case, the server returns a fork reference of zero.</p><p>A <code>kFPBitmapErr</code> result code is returned if an attempt is made to retrieve the length of the file’s other fork.</p><p>The server needs to keep variable-length parameters, such as Long Name or Short Name, at the end of the reply block. In order to do this, the server represents variable-length parameters in bitmap order as fixed-length offsets (integer) to the start of the variable-length parameters. The actual variable-length fields are then packed after all fixed-length parameters.</p><p>If the fork is opened and the user has requested the file’s attributes in the file bitmap, the appropriate DAlreadyOpen or RAlreadyOpen bit is set.</p><p>To open a fork for read or no access (when neither read or write access is requested), the user must have search access to all ancestors, except the parent directory, as well as read access to the parent directory. For information about access modes, see “File Sharing Modes” in the “Introduction” section.</p><p>To open a fork for write access, the volume must not be designated for read-only access. If both forks are currently empty, the user must have search or write access to all ancestors, except the parent directory, as well as write access to the parent directory. If either fork is not empty and one of the forks is being opened for writing, the user must have search access to all ancestors, except the parent directory, as well as read and write access to the parent directory.</p><p>The user must have previously called <code><a href="reference.html#//apple_ref/c/func/FPOpenVol">FPOpenVol</a></code> for this volume. Each fork must be opened separately; a unique fork reference is returned for each fork.</p><p><span class="content_text">Table 53</span> lists the result codes for the <code>FPOpenFork</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-237679" title="Table 53Result codes for the FPOpenFork command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIEDEG" title="Table 53Result codes for the FPOpenFork command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 53&nbsp;&nbsp;</strong>Result codes for the <code>FPOpenFork</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to open the specified fork.</p></td></tr><tr><td  scope="row"><p><code>kFPBitmapErr</code></p></td><td ><p>Attempt was made to retrieve a parameter that cannot be obtained with this command (the fork is not opened).</p></td></tr><tr><td  scope="row"><p><code>kFPDenyConflict</code></p></td><td ><p>File or fork cannot be opened because of a deny modes conflict.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Input parameters do not point to an existing file.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectLocked</code></p></td><td ><p>Attempt was made to open a file for writing that is marked WriteInhibit.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectTypeErr</code></p></td><td ><p>Input parameters point to a directory.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number, Volume ID, or pathname type is unknown; a pathname is invalid.</p></td></tr><tr><td  scope="row"><p><code>KFPTooManyFilesOpen</code></p></td><td ><p>Server cannot open another fork.</p></td></tr><tr><td  scope="row"><p><code>kFPVolLocked</code></p></td><td ><p>Attempt was made to open for writing a file on a volume that is marked ReadOnly.</p></td></tr></table></div><p><span class="content_text">Table 54</span> describes the reply block for the<code> FPOpenFork</code><code></code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-237899" title="Table 54Reply block for the FPOpenFork command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIHFFI" title="Table 54Reply block for the FPOpenFork command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 54&nbsp;&nbsp;</strong>Reply block for the <code>FPOpenFork</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>Bitmap</code> (short)</p></td><td ><p>Copy of the input parameter.</p></td></tr><tr><td  scope="row"><p><code>OForkRefNum</code> (short)</p></td><td ><p>Open fork reference number for use when referring to this fork in when sending subsequent commands.</p></td></tr><tr><td  scope="row"><p><code>FileParameters</code></p></td><td ><p>Requested parameters.</p></td></tr></table></div><p><span class="content_text">Figure 62</span> shows the request and reply blocks for the <code>FPOpenFork</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-222271" title="Figure 62Request and reply blocks for the FPOpenFork command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDGJIAG" title="Figure 62Request and reply blocks for the FPOpenFork command"></a><p><strong>Figure 62&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPOpenFork</code> command</p><img src = "../Art/afp_065.gif" alt = "Request and reply blocks for the FPOpenFork command" width="427" height="355"></div><br/><a name="//apple_ref/c/func/FPOpenVol" title="FPOpenVol"></a><a name="//apple_ref/doc/c_ref/FPOpenVol" title="FPOpenVol"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCGIHE" title="FPOpenVol"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_63"></a><h3 class="tight">FPOpenVol</h3><p class="spaceabove">Opens a volume.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short Bitmap
string VolumeName
8 bytes Password
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPOpenVol</code> (24).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>Bitmap</em></dt><dd><p>Bitmap describing the parameters that are to be returned. Set the bit that corresponds to each desired parameter. The bitmap is the same as the Volume bitmap used by the <code><a href="reference.html#//apple_ref/c/func/FPGetVolParms">FPGetVolParms</a></code> command and cannot be null. For bit definitions, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Volume_Bitmap">Volume Bitmap</a></span>.</p></dd><dt><em>VolumeName</em></dt><dd><p>Name of the volume as returned by <code><a href="reference.html#//apple_ref/c/func/FPGetSrvrParms">FPGetSrvrParms</a></code>.</p></dd><dt><em>Password</em></dt><dd><p>Optional volume password.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-238019">Table 55</a></span> for the possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-238179">Table 56</a></span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command must be made before any other command can be made to obtain access to CNodes on the specified volume.</p><p>If a password is required to gain access to the volume, it is sent as the <code>Password</code> parameter in cleartext. Append null bytes to the password as necessary to obtain a length of eight bytes. Password comparison is case-sensitive. If the supplied password does not match the password kept with the volume, or if a password is not supplied when a password is required, the server returns a result code of kFPAccessDenied.</p><p>If the passwords match, or if the volume is not password-protected, the server packs the requested parameters in the reply block The user can now send commands related to CNodes on the volume.</p><p>The <code>Bitmap</code> parameter must request that the Volume ID be returned. There is no other way to retrieve the Volume ID, which is required by most subsequent commands related to this volume.</p><p><span class="content_text">Table 55</span> lists the result codes for the <code>FPOpenVol</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-238019" title="Table 55Result codes for the FPOpenVol command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCFICH" title="Table 55Result codes for the FPOpenVol command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 55&nbsp;&nbsp;</strong>Result codes for the <code>FPOpenVol</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>Password is not supplied or does not match.</p></td></tr><tr><td  scope="row"><p><code>kFPBitmapErr</code></p></td><td ><p>Attempt was made to retrieve a parameter that cannot be obtained with this command. (The bitmap is null.)</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Input parameters do not point to an existing volume.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number or volume name is unknown.</p></td></tr></table></div><p><span class="content_text">Table 56</span> describes the reply block for the <code>FPOpenVol </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-238179" title="Table 56Reply block for the FPOpenVol command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBDFBD" title="Table 56Reply block for the FPOpenVol command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 56&nbsp;&nbsp;</strong>Reply block for the <code>FPOpenVol</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>Bitmap</code> (short)</p></td><td ><p>Copy of the input parameter.</p></td></tr><tr><td  scope="row"><p><code>VolumeParameters</code></p></td><td ><p>Requested parameters, including the Volume ID, for the opened volume.</p></td></tr></table></div><p><span class="content_text">Figure 63</span> shows the request and reply blocks for the <code>FPOpenVol</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-222563" title="Figure 63Request and reply blocks for the FPOpenVol command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCEHFC" title="Figure 63Request and reply blocks for the FPOpenVol command"></a><p><strong>Figure 63&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPOpenVol</code> command</p><img src = "../Art/afp_066.gif" alt = "Request and reply blocks for the FPOpenVol command" width="335" height="370"></div><br/><a name="//apple_ref/c/func/FPRead" title="FPRead"></a><a name="//apple_ref/doc/c_ref/FPRead" title="FPRead"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFIJDG" title="FPRead"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_64"></a><h3 class="tight">FPRead</h3><p class="spaceabove">Reads a block of data.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short OForkRefNum
long Offset
long ReqCount
byte NewLineMask
byte NewLineChar
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPRead</code> (27).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>OForkRefNum</em></dt><dd><p>Open fork reference number.</p></dd><dt><em>Offset</em></dt><dd><p>Number of the first byte to read.</p></dd><dt><em>ReqCount</em></dt><dd><p>Number of bytes to read.</p></dd><dt><em>NewLineMask</em></dt><dd><p>Mask for determining where the read should terminate.</p></dd><dt><em>NewLineChar</em></dt><dd><p>Character for determining where the read should terminate.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-238302">Table 57</a></span> for the possible result codes.</p></dd><dt><em>ActualCount</em></dt><dd><p>Number of bytes actually read from the fork. This long value is returned by the underlying transport mechanism and is not a value in the reply block.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block containing the data that was read.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command retrieves the specified range of bytes from an open fork. Call <code><a href="reference.html#//apple_ref/c/func/FPOpenFork">FPOpenFork</a></code> to open the fork. The server begins reading at the byte number specified by the <code>Offset</code> parameter. Reading stops when one of the following occur:</p><ul class="ul"><li class="li"><p>The server encounters the character specified by the combination of the <code>NewLineMask</code> and <code>NewLineChar</code> parameters</p></li><li class="li"><p>The server reaches the end of the fork</p></li><li class="li"><p>The server encounters the start of a range locked by another user</p></li><li class="li"><p>The server reads the number of bytes specified by the <code>ReqCount</code> parameter</p></li></ul><p>If the server reaches the end of fork or the start of a locked range, it returns all data read to that point and a result code of <code>kFPEOFErr</code> or <code>kFPLockErr</code>, respectively.</p><p>The <code>NewLineMask</code> parameter is a byte mask that is to be logically ANDed with a copy of each byte read. If the result matches the <code>NewLineChar</code> parameter, the read terminates. Using a <code>NewLineMask</code> value of zero essentially disables the Newline check feature.</p><p>If a user reads a byte that was never written to the fork, the result is undefined.</p><p>Lock the range to be read before sending this command. The underlying transport mechanism may force the request to be broken into multiple smaller requests. If the range is not locked when this command begins execution, it is possible for another user to lock some or all of the range before this command completes, causing the read to succeed partially.</p><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-238302">Table 57</a></span> lists the result codes for the <code>FPRead</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-238302" title="Table 57Result codes for the FPRead command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEJHCG" title="Table 57Result codes for the FPRead command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 57&nbsp;&nbsp;</strong>Result codes for the <code>FPRead</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>Fork was not opened for read access.</p></td></tr><tr><td  scope="row"><p><code>kFPEOFErr</code></p></td><td ><p>End of fork was reached.</p></td></tr><tr><td  scope="row"><p><code>kFPLockErr</code></p></td><td ><p>Some or all of the requested range is locked by another user.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number or open fork reference number is unknown; ReqCount or Offset is negative; <code>NewLineMask</code> is invalid.</p></td></tr></table></div><p><span class="content_text">Figure 64</span> shows the request and reply blocks for the <code>FPRead</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-222874" title="Figure 64Request and reply blocks for the FPRead command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFHDDG" title="Figure 64Request and reply blocks for the FPRead command"></a><p><strong>Figure 64&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPRead</code> command</p><img src = "../Art/afp_067.gif" alt = "Request and reply blocks for the FPRead command" width="325" height="320"></div><br/><a name="//apple_ref/c/func/FPReadExt" title="FPReadExt"></a><a name="//apple_ref/doc/c_ref/FPReadExt" title="FPReadExt"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDGJHEG" title="FPReadExt"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_65"></a><h3 class="tight">FPReadExt</h3><p class="spaceabove">Reads a block of data.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short OForkRefNum
long long Offset
long long ReqCount
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPReadExt</code> (60).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>OForkRefNum</em></dt><dd><p>Open fork reference number.</p></dd><dt><em>Offset</em></dt><dd><p>Number of the first byte to read.</p></dd><dt><em>ReqCount</em></dt><dd><p>Number of bytes to read.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-238447">Table 58</a></span> for the possible result codes.</p></dd><dt><em>ActualCount</em></dt><dd><p>Number of bytes actually read from the fork. This long long value is returned by the underlying transport mechanism and is not a value in the reply block.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block containing the data that was read.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command retrieves the specified range of bytes from an open fork. Call <code><a href="reference.html#//apple_ref/c/func/FPOpenFork">FPOpenFork</a></code> to open the fork.</p><p>This command differs from the <code><a href="reference.html#//apple_ref/c/func/FPRead">FPRead</a></code> command in that this command is prepared to handle large values that may be returned for files the reside in volumes larger than 4 GB in size. Also, this command does not support the <code>NewlineMask</code> and <code>NewlineChar</code> parameters that <code>FPRead</code> supports.</p><p>The server begins reading at the byte number specified by the <code>Offset</code> parameter. Reading stops when one of the following occur:</p><ul class="ul"><li class="li"><p>The server reaches the end of the fork</p></li><li class="li"><p>The server encounters the start of a range locked by another user</p></li><li class="li"><p>The server reads the number of bytes specified by the <code>ReqCount</code> parameter</p></li></ul><p>If the server reaches the end of fork or the start of a locked range, it returns all data read to that point and a result code of <code>kFPEOFErr</code> or <code>kFPLockErr</code>, respectively.</p><p>If a user reads a byte that was never written to the fork, the result is undefined.</p><p>Lock the range to be read before sending this command. The underlying transport mechanism may force the request to be broken into multiple smaller requests. If the range is not locked when this command begins execution, it is possible for another user to lock some or all of the range before this command completes, causing the read to succeed partially.</p><p><span class="content_text">Table 58</span> lists the result codes for the <code>FPReadExt</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-238447" title="Table 58Result codes for the FPReadExt command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBAAAG" title="Table 58Result codes for the FPReadExt command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 58&nbsp;&nbsp;</strong>Result codes for the <code>FPReadExt</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>Fork was not opened for read access.</p></td></tr><tr><td  scope="row"><p><code>kFPEOFErr</code></p></td><td ><p>End of fork was reached.</p></td></tr><tr><td  scope="row"><p><code>kFPLockErr</code></p></td><td ><p>Some or all of the requested range is locked by another user.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number or open fork reference number is unknown; <code>ReqCount</code> or <code>Offset</code> is negative.</p></td></tr></table></div><p><span class="content_text">Figure 65</span> shows the request and reply blocks for the <code>FPReadExt</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-223190" title="Figure 65Request and reply blocks for the FPReadExt command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFDEHB" title="Figure 65Request and reply blocks for the FPReadExt command"></a><p><strong>Figure 65&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPReadExt</code> command</p><img src = "../Art/afp_025.gif" alt = "Request and reply blocks for the FPReadExt command" width="325" height="448"></div><br/><a name="//apple_ref/c/func/FPRemoveAPPL" title="FPRemoveAPPL"></a><a name="//apple_ref/doc/c_ref/FPRemoveAPPL" title="FPRemoveAPPL"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJAIAA" title="FPRemoveAPPL"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_66"></a><h3 class="tight">FPRemoveAPPL</h3><p class="spaceabove">Removes an APPL mapping from a volume’s Desktop database.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short DTRefNum
long DirectoryID
long FileCreator
byte PathType
string Pathname
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPRemoveAPPL</code> (54).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>DTRefNum</em></dt><dd><p>Desktop database reference number.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Ancestor Directory ID.</p></dd><dt><em>FileCreator</em></dt><dd><p>File creator of the application corresponding to the APPL mapping that is to be removed.</p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname to the desired file (cannot be null). <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-238651">Table 59</a></span> for the possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>The server locates in the Desktop database the APPL mapping corresponding to the specified application and file creator. If an APPL mapping is found, it is removed.</p><p>The user must have search access to all ancestors, except the parent directory, as well as read and write access to the parent directory.</p><p>The user must have previously called <code><a href="reference.html#//apple_ref/c/func/FPOpenDT">FPOpenDT</a></code> for the corresponding volume. In addition, the file must exist in the specified directory before this command is sent.</p><p><span class="content_text">Table 59</span> lists the result codes for the <code>FPRemoveAPPL</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-238651" title="Table 59Result codes for the FPRemoveAPPL command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFAHIB" title="Table 59Result codes for the FPRemoveAPPL command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 59&nbsp;&nbsp;</strong>Result codes for the <code>FPRemoveAPPL</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to use this command.</p></td></tr><tr><td  scope="row"><p><code>kFPItemNotFound</code></p></td><td ><p>No APPL mapping corresponding to the input parameters was found in the Desktop database.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Input parameters do not point to an existing file.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number or Desktop database reference number is unknown.</p></td></tr></table></div><p><span class="content_text">Figure 66</span> shows the request and reply blocks for the <code>FPRemoveAPPL</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-223397" title="Figure 66Request and reply blocks for the FPRemoveAPPL command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJCADD" title="Figure 66Request and reply blocks for the FPRemoveAPPL command"></a><p><strong>Figure 66&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPRemoveAPPL</code> command</p><img src = "../Art/afp_068.gif" alt = "Request and reply blocks for the FPRemoveAPPL command" width="133" height="345"></div><br/><a name="//apple_ref/c/func/FPRemoveComment" title="FPRemoveComment"></a><a name="//apple_ref/doc/c_ref/FPRemoveComment" title="FPRemoveComment"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDECJCJ" title="FPRemoveComment"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_67"></a><h3 class="tight">FPRemoveComment</h3><p class="spaceabove">Removes a comment from a volume’s Desktop database.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short DTRefNum
long DirectoryID
byte PathType
string Pathname
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPRemoveComment</code> (57).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>DTRefNum</em></dt><dd><p>Desktop database reference number.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Ancestor Directory ID.</p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname to the CNode whose comment is being removed (cannot be null). <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-238957">Table 60</a></span> for the possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>If the comment is associated with directory that is not empty, the user must have search access to all ancestors, including the parent directory, plus write access to the parent directory. If the comment is associated with an empty directory, the user must have search or write access to all ancestors, including the parent directory, plus write access to the parent directory.</p><p>If the comment is associated with a file that is not empty, the user must have search access to all ancestors, except the parent directory, plus read and write access to the parent directory. If the comment is associated with an empty file, the user must have search or write access to all ancestors, except the parent directory, plus write access to the parent directory.</p><p>The user must have previously called <code><a href="reference.html#//apple_ref/c/func/FPOpenDT">FPOpenDT</a></code> for the corresponding volume.</p><p><span class="content_text">Table 60</span> lists the result codes for the<code></code><code>FPRemoveComment</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-238957" title="Table 60Result codes for the FPRemoveComment command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIGJEC" title="Table 60Result codes for the FPRemoveComment command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 60&nbsp;&nbsp;</strong>Result codes for the <code>FPRemoveComment</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to use this command.</p></td></tr><tr><td  scope="row"><p><code>kFPItemNotFound</code></p></td><td ><p>Comment was not found in the Desktop database.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Input parameters do not point to an existing file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number, Desktop database reference number, or pathname type is unknown; pathname is invalid.</p></td></tr></table></div><p><span class="content_text">Figure 67</span> shows the request and reply blocks for the <code>FPRemoveComment</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-239043" title="Figure 67Request and reply blocks for the FPRemoveComment command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEHICA" title="Figure 67Request and reply blocks for the FPRemoveComment command"></a><p><strong>Figure 67&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPRemoveComment</code> command</p><img src = "../Art/afp_069.gif" alt = "Request and reply blocks for the FPRemoveComment command" width="133" height="256"></div><br/><a name="//apple_ref/c/func/FPRemoveExtAttr" title="FPRemoveExtAttr"></a><a name="//apple_ref/doc/c_ref/FPRemoveExtAttr" title="FPRemoveExtAttr"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIDEFI" title="FPRemoveExtAttr"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_68"></a><h3 class="tight">FPRemoveExtAttr</h3><p class="spaceabove">Removes an extended attribute.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long DirectoryID unsigned short Bitmap
byte PathType
string Pathname
byte Pad
unsigned short NameLength
string Name
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPRemoveExtAttr</code> (71).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume identifier.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Directory identifier.</p></dd><dt><em>Bitmap</em></dt><dd><p>Bitmap specifying the desired behavior when removing an extended attribute. For this command, <code>kAttrDontFollow</code> is the only valid bit. For details, see <code><a href="reference.html#//apple_ref/doc/constant_group/Extended_Attributes_Bitmap">Extended Attributes Bitmap</a></code>.</p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname to desired file or directory. <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Pad</em></dt><dd><p>Optional pad byte if needed to pad to an even boundary.</p></dd><dt><em>NameLength</em></dt><dd><p>Length in bytes of the extended attribute name that follows.</p></dd><dt><em>Name</em></dt><dd><p>UTF-8–encoded name of the extended attribute that is to be removed.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text">Table 61</span> for other possible result codes.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command removes the specified extended attribute.</p><p>Support for this command, as well as <code><a href="reference.html#//apple_ref/c/func/FPGetExtAttr">FPGetExtAttr</a></code>, <code><a href="reference.html#//apple_ref/c/func/FPListExtAttrs">FPListExtAttrs</a></code>, and <code><a href="reference.html#//apple_ref/c/func/FPSetExtAttr">FPSetExtAttr</a></code> is required in order to support extended attributes. UTF-8 support is also required in order to support extended attributes.</p><p><span class="content_text">Table 61</span> lists the possible result codes for the <code>FPRemoveExtAttr</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-329740" title="Table 61Result codes for the FPRemoveExtAttr command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDGDIBD" title="Table 61Result codes for the FPRemoveExtAttr command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 61&nbsp;&nbsp;</strong>Result codes for the <code>FPRemoveExtAttr</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to remove an extended attribute for the specified file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPBitmapErr</code></p></td><td ><p>Bitmap is null or specifies a value that is invalid for this command.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Input parameters do not point to an existing file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>A parameter is invalid.</p></td></tr></table></div><p><span class="content_text">Figure 68</span> shows the request block for the <code>FPRemoveExtAttr</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-293725" title="Figure 68Request block for the FPRemoveExtAttr command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIEHJE" title="Figure 68Request block for the FPRemoveExtAttr command"></a><p><strong>Figure 68&nbsp;&nbsp;</strong>Request block for the <code>FPRemoveExtAttr</code> command</p><img src = "../Art/afp_FPRemoveExtAttr.gif" alt = "Request block for the FPRemoveExtAttr command" width="243" height="377"></div><br/><h5 class="tight">Version Notes</h5><p>Introduced in AFP 3.2.</p><a name="//apple_ref/c/func/FPRename" title="FPRename"></a><a name="//apple_ref/doc/c_ref/FPRename" title="FPRename"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDDGACC" title="FPRename"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_69"></a><h3 class="tight">FPRename</h3><p class="spaceabove">Renames a file or directory.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long DirectoryID
byte PathType
string Pathname
byte NewType
string NewName
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPRename</code> (28).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Ancestor Directory ID.</p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname to the CNode whose name is being changed (cannot be null). <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>NewType</em></dt><dd><p>Type of names in <code>NewName</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>NewName</em></dt><dd><p>Pathname to the CNode, including its new name (cannot be null). <code>NewName</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-239169">Table 62</a></span> for the possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>The server assigns the new name to the file or directory. The other name (Long or Short) is generated as described in the section “Catalog Node Names” in Chapter 1. The modification date of the parent directory is set to the server’s clock.</p><p>To rename a directory, the user must have search access to all ancestors. including the CNode’s parent directory, as well as write access to the parent directory. To rename a file, the user must have search access to all ancestors, except the CNode’s parent directory, as well as read and write access to the parent directory.</p><p><span class="content_text">Table 62</span> lists the result codes for the <code>FPRename </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-239169" title="Table 62Result codes for the FPRename command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBHHAE" title="Table 62Result codes for the FPRename command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 62&nbsp;&nbsp;</strong>Result codes for the <code>FPRename</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to use this command.</p></td></tr><tr><td  scope="row"><p><code>kFPCantRename</code></p></td><td ><p>Attempt was made to rename a volume or root directory.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectExists</code></p></td><td ><p>File or directory having the name specified by <code>NewName</code> already exists.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectLocked</code></p></td><td ><p>File or directory is marked RenameInhibit.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Input parameters do not point to an existing file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number, Volume ID, or pathname type is unknown; pathname or <code>NewName</code> is invalid.</p></td></tr><tr><td  scope="row"><p><code></code><code>kFPVolLocked</code></p></td><td ><p>Volume is ReadOnly</p></td></tr></table></div><p><span class="content_text">Figure 69</span> shows the request block for the <code>FPRename</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-223896" title="Figure 69Request block for the FPRename command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFJDDE" title="Figure 69Request block for the FPRename command"></a><p><strong>Figure 69&nbsp;&nbsp;</strong>Request block for the <code>FPRename</code> command</p><img src = "../Art/afp_070.gif" alt = "Request block for the FPRename command" width="133" height="327"></div><br/><a name="//apple_ref/c/func/FPResolveID" title="FPResolveID"></a><a name="//apple_ref/doc/c_ref/FPResolveID" title="FPResolveID"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBBBIA" title="FPResolveID"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_70"></a><h3 class="tight">FPResolveID</h3><p class="spaceabove">Gets parameters for a file by File ID.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long FileID
short Bitmap
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPResolveID</code> (41).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>FileID</em></dt><dd><p>File ID to be resolved.</p></dd><dt><em>Bitmap</em></dt><dd><p>Bitmap describing the parameters to return. Set the bit that corresponds to each desired parameter. This bitmap is the same as the <code>FileBitmap</code> parameter of the <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> command. For bit definitions for the this bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/File_Bitmap">File Bitmap</a></span>.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-239400">Table 63</a></span> for the possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-239565">Table 64</a></span> for the format of the reply block.</p></dd></dl><h5 class="tight">Discussion</h5><p>The parameters returned by this command can be any parameter specified in the <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> command.</p><p>The user must have the Read Only or the Read &amp; Write privilege to use this command.</p><p><span class="content_text">Table 63</span> lists the result codes for the <code>FPResolveID</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-239400" title="Table 63Result codes for the FPResolveID command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDHDJHI" title="Table 63Result codes for the FPResolveID command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 63&nbsp;&nbsp;</strong>Result codes for the <code>FPResolveID</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to use this command.</p></td></tr><tr><td  scope="row"><p><code>kFPBadIDErr</code></p></td><td ><p>File ID is not valid.</p></td></tr><tr><td  scope="row"><p><code>kFPCallNotSupported</code></p></td><td ><p>Server does not support this command.</p></td></tr><tr><td  scope="row"><p><code>kFPIDNotFound</code></p></td><td ><p>File ID was not found. (No file thread exists.)</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectTypeErr</code></p></td><td ><p>Object defined was a directory, not a file.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number, Volume ID, or File ID is unknown.</p></td></tr></table></div><p><span class="content_text">Table 64</span> describes the reply block for the <code>FPResolveID </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-239565" title="Table 64Reply block for the FPResolveID command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCHEAF" title="Table 64Reply block for the FPResolveID command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 64&nbsp;&nbsp;</strong>Reply block for the <code>FPResolveID</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name and size</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>Bitmap</code> (short)</p></td><td ><p>Copy of the input bitmap.</p></td></tr><tr><td  scope="row"><p><code>FileParameters</code></p></td><td ><p>Requested file parameters.</p></td></tr></table></div><p><span class="content_text">Figure 69</span> shows the request and reply blocks for the <code>FPResolveID</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-224203" title="Figure 70Request and reply blocks for the FPResolveID command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEJHCB" title="Figure 70Request and reply blocks for the FPResolveID command"></a><p><strong>Figure 70&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPResolveID</code> command</p><img src = "../Art/afp_011.gif" alt = "Request and reply blocks for the FPResolveID command" width="347" height="237"></div><br/><a name="//apple_ref/c/func/FPSetACL" title="FPSetACL"></a><a name="//apple_ref/doc/c_ref/FPSetACL" title="FPSetACL"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIEDCA" title="FPSetACL"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_71"></a><h3 class="tight">FPSetACL</h3><p class="spaceabove">Sets the UUID, Group UUID, and ACL for a file or directory and removes an ACL from a file or directory.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long DirectoryID
unsigned short Bitmap
byte Pathtype
string Pathname
byte Pad
AdditionalInformation
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPSetACL</code> (74).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume identifier.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Directory identifier.</p></dd><dt><em>Bitmap</em></dt><dd><p>Bits that specify the values that are to be set. Specify <code>kFileSec_UUID </code>to set the UUID of the specified file or directory. Specify <code>kFileSec_GRPUUID</code> to set the Group UUID of the specified file or directory. Specify <code>kFileSec_ACL</code> to set the ACL of the specified file or directory or <code>kFileSec_REMOVEACL</code> to remove the file or directory’s ACL. If sending this command is part of the creation of a new item, set the <code>kFileSec_Inherit</code> bit. When the server receives an <code>FPSetACL</code> command having a <code>Bitmap </code>parameter in which the <code>kFileSec_Inherit</code> bit is set, it scans the current item looking for access control entries (ACEs) in which the <code>KAUTH_ACE_INHERITED</code> bit is set in its <code>ace_flags</code> field. The server copies any currently inherited ACEs to the end of the incoming list of ACEs and sets the ACL on the item. For declarations of these constants, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Access_Control_List_Bitmap">Access Control List Bitmap</a></span>. </p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname of the Open Directory domain for which UAMs are to be obtained. <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte if needed to pad to an even boundary.</p></dd><dt><em>AdditionalInformation</em></dt><dd><p>If <code>kFileSec_UUID</code> is set in the <code>Bitmap</code> parameter, the first item in this parameter is the UUID that is to be set. If <code>kFileSec_GRPUUID</code> is set, the next item in this parameter is the Group UUID that is to be set. If <code>kFileSec_ACL</code> is set, the next item in this parameter is a <code>kauth_acl</code><code></code> structure. For information on this structure, see the section <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/kauth_acl">Access Control List Structure</a></span>. If <code>kFileSec_REMOVEACL</code> is set in the <code>Bitmap</code> parameter, this parameter does not contain a <code>kauth_acl</code> structure.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text">Table 65</span> for other possible result codes.</p></dd></dl><h5 class="tight">Discussion</h5><p>Depending on the bits that are set in the <code>Bitmap</code> parameter, this command sets the UUID, Group UUID, and ACL for the specified file or directory or removes the ACL of the specified file or directory.</p><p>Support for this command, as well as <code><a href="reference.html#//apple_ref/c/func/FPAccess">FPAccess</a></code> and <code><a href="reference.html#//apple_ref/c/func/FPGetACL">FPGetACL</a></code> is required in order to support access control lists (ACLs). Support for UTF-8 and UUIDs is also required in order to support ACLs.</p><p><span class="content_text">Table 65</span> lists the result codes for the <code>FPSetACL</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-329852" title="Table 65Result codes for the FPSetACL command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCFEBH" title="Table 65Result codes for the FPSetACL command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 65&nbsp;&nbsp;</strong>Result codes for the <code>FPSetACL</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access rights required to set the ACL for the specified file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Input parameters do not point to an existing file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>A parameter is invalid.</p></td></tr></table></div><p><span class="content_text">Figure 35</span> shows the request block for the <code>FPSetACL</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-308314" title="Figure 71Request block for the FPSetACL command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIJADE" title="Figure 71Request block for the FPSetACL command"></a><p><strong>Figure 71&nbsp;&nbsp;</strong>Request block for the <code>FPSetACL</code> command</p><img src = "../Art/afp_FPSetACL.gif" alt = "Request block for the FPSetACL command" width="523" height="406"></div><br/><h5 class="tight">Version Notes</h5><p>Introduced in AFP 3.2.</p><a name="//apple_ref/c/func/FPSetDirParms" title="FPSetDirParms"></a><a name="//apple_ref/doc/c_ref/FPSetDirParms" title="FPSetDirParms"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDHDDCB" title="FPSetDirParms"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_72"></a><h3 class="tight">FPSetDirParms</h3><p class="spaceabove">Sets parameters for a directory.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long DirectoryID
short Bitmap
byte PathType
string Pathname
DirectoryParameters
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPSetDirParms</code> (29).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Ancestor Directory ID.</p></dd><dt><em>Bitmap</em></dt><dd><p>Bitmap describing the parameters to set. Set the bit that corresponds to each desired parameter. This bitmap is the same as the <code>DirectoryBitmap</code> parameter of the <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> command. For bit definitions for this bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Directory_Bitmap">Directory Bitmap</a></span>.</p></dd><dt><em>PathType</em></dt><dd><p>Type of name in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname to the desired directory. <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>DirectoryParameters</em></dt><dd><p>Parameters to be set, packed in bitmap order.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-240901">Table 66</a></span> for the possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command sets or clears certain parameters and attributes that are common to both files and directories. The parameters are the Invisible and System attributes, Creation Date, Modification Date, Backup Date, Finder Info, and UNIX privileges.</p><p>The parameters must be packed, in bitmap order, in the request block. Variable-length parameters, such as Long Name and Short Name, must be kept at the end of the block. To do this, variable-length parameters are represented in bitmap order as fixed-length offsets (integers). These offsets are measured from the start of the parameters to the start of the variable-length parameters. The actual variable-length parameters are then packed after all fixed-length parameters.</p><p>Changing a directory’s access rights immediately affects other open sessions. If the user does not have the access rights to set one of the parameters, a <code>kFPAccessDenied</code> result code is returned and no parameters are set.</p><p>To set a directory’s access privileges, Owner ID, Group ID, or to change the DeleteInhibit, RenameInhibit, WriteInhibit, or Invisible attributes, the user must have search or write access to all ancestors, including this directory’s parent directory, and the user must be the owner of the directory. To set any parameter other than the ones mentioned above for an empty directory, the user must have search or write access to all ancestors, except the parent directory, as well as write access to the parent directory. To set any parameter other than the ones mentioned above for a directory that is not empty, the user must have search access to all ancestors, including the parent directory, as well as write access to the parent directory.</p><p>This command cannot be used to set a directory’s name; instead, use <code><a href="reference.html#//apple_ref/c/func/FPRename">FPRename</a></code>. This command cannot be used to set a directory’s Parent Directory ID; instead, use <code><a href="reference.html#//apple_ref/c/func/FPMoveAndRename">FPMoveAndRename</a></code>. This command cannot be used to set a directory’s Directory ID or Offspring Count.</p><p><span class="content_text">Table 66</span> lists the result codes for the <code>FPSetDirParms</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-240901" title="Table 66Result codes for the FPSetDirParms command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIIDEB" title="Table 66Result codes for the FPSetDirParms command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 66&nbsp;&nbsp;</strong>Result codes for the <code>FPSetDirParms</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to use this command.</p></td></tr><tr><td  scope="row"><p><code>kFPBitmapErr</code></p></td><td ><p>Attempt was made to set a parameter that cannot be set by this command; bitmap is null.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Input parameters do not point to an existing directory.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectTypeErr</code></p></td><td ><p>Input parameters point to a file.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number, Volume ID, or pathname type is unknown; pathname, Owner ID, or Group ID is invalid.</p></td></tr><tr><td  scope="row"><p><code>kFPVolLocked</code></p></td><td ><p>Volume is ReadOnly.</p></td></tr></table></div><p><span class="content_text">Figure 72</span> shows the request block for the <code>FPSetDirParms</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-224479" title="Figure 72Request block for the FPSetDirParms command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDCBJDI" title="Figure 72Request block for the FPSetDirParms command"></a><p><strong>Figure 72&nbsp;&nbsp;</strong>Request block for the <code>FPSetDirParms</code> command</p><img src = "../Art/afp_071.gif" alt = "Request block for the FPSetDirParms command" width="277" height="355"></div><br/><a name="//apple_ref/c/func/FPSetExtAttr" title="FPSetExtAttr"></a><a name="//apple_ref/doc/c_ref/FPSetExtAttr" title="FPSetExtAttr"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDHIIGH" title="FPSetExtAttr"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_73"></a><h3 class="tight">FPSetExtAttr</h3><p class="spaceabove">Sets the value of an extended attribute.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long DirectoryID unsigned short Bitmap
long long Offset
byte PathType
string Pathname
byte Pad
unsigned short NameLength
string Name
unsigned long AttributeDataLength
string AttributeData
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPSetExtAttr</code> (70).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume identifier.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Directory identifier.</p></dd><dt><em>Bitmap</em></dt><dd><p>Bitmap specifying the desired behavior when setting the value of an extended attribute. For details, see <code><a href="reference.html#//apple_ref/doc/constant_group/Extended_Attributes_Bitmap">Extended Attributes Bitmap</a></code> for details.</p></dd><dt><em>Offset</em></dt><dd><p>Always zero; reserved for future use.</p></dd><dt><em>PathType</em></dt><dd><p>Type of names in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname to desired file or directory. <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>Pad</em></dt><dd><p>Optional pad byte if needed to pad to an even boundary.</p></dd><dt><em>NameLength</em></dt><dd><p>Length in bytes of the extended attribute name that follows.</p></dd><dt><em>Name</em></dt><dd><p>UTF-8–encoded name of the extended attribute that is to be set.</p></dd><dt><em>AttributeDataLength</em></dt><dd><p>Length in bytes of the extended attribute data that follows.</p></dd><dt><em>AttributeData</em></dt><dd><p>Value to which the extended attribute is to be set.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text">Table 67</span> for other possible result codes.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command sets the value of the specified extended attribute. If the extended attribute does not already exist, it is created.</p><p>Support for this command, as well as <code><a href="reference.html#//apple_ref/c/func/FPGetExtAttr">FPGetExtAttr</a></code>, <code><a href="reference.html#//apple_ref/c/func/FPListExtAttrs">FPListExtAttrs</a></code> and <code><a href="reference.html#//apple_ref/c/func/FPRemoveExtAttr">FPRemoveExtAttr</a></code> is required in order to support extended attributes. UTF-8 support is also required in order to support extended attributes.</p><p><span class="content_text">Table 67</span> lists the possible result codes for the <code>FPSetExtAttr</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-329966" title="Table 67Result codes for the FPSetExtAttr command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDDEFBD" title="Table 67Result codes for the FPSetExtAttr command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 67&nbsp;&nbsp;</strong>Result codes for the <code>FPSetExtAttr</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to set an extended attribute for the file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPBitmapErr</code></p></td><td ><p>Bitmap is null or specifies a value that is invalid for this command.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Input parameters do not point to an existing file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>A parameter is invalid.</p></td></tr></table></div><p><span class="content_text">Figure 73</span> shows the request block for the <code>FPSetExtAttr</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-293186" title="Figure 73Request block for the FPSetExtAttr command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDGGGDA" title="Figure 73Request block for the FPSetExtAttr command"></a><p><strong>Figure 73&nbsp;&nbsp;</strong>Request block for the <code>FPSetExtAttr</code> command</p><img src = "../Art/afp_FPSetExtendedAttr.gif" alt = "Request block for the FPSetExtAttr command" width="241" height="574"></div><br/><h5 class="tight">Version Notes</h5><p>Introduced in AFP 3.2.</p><a name="//apple_ref/c/func/FPSetFileDirParms" title="FPSetFileDirParms"></a><a name="//apple_ref/doc/c_ref/FPSetFileDirParms" title="FPSetFileDirParms"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDGCCED" title="FPSetFileDirParms"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_74"></a><h3 class="tight">FPSetFileDirParms</h3><p class="spaceabove">Sets parameters for a file or a directory.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long DirectoryID
short Bitmap
byte PathType
string Pathname
FileDirParameters
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPSetFileDirParms</code> (35).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Ancestor Directory ID.</p></dd><dt><em>Bitmap</em></dt><dd><p>Bitmap describing the parameters to set. Set the bit that corresponds to each desired parameter. This bitmap can be the same as the <code>DirectoryBitmap</code> or the <code>FileBitmap</code> parameter of the <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> command, but this command can only set the parameters that are common to both bitmaps. For bit definitions for the Directory and bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Directory_Bitmap">Directory Bitmap</a></span>; for bit definitions for the File bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/File_Bitmap">File Bitmap</a></span>.</p></dd><dt><em>PathType</em></dt><dd><p>Type of name in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname to the desired file or directory. <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>FileDirParameters</em></dt><dd><p>Parameters to be set, packed in bitmap order.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-239676">Table 68</a></span> for the possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command sets or clears certain parameters and attributes that are common to both files and directories. The parameters are the Invisible and System attributes, Creation Date, Modification Date, Backup Date, Finder Info, and UNIX privileges.</p><p>The parameters must be packed, in bitmap order, in the request block. Variable-length parameters, such as Long Name and Short Name, must be kept at the end of the block. To do this, variable-length parameters are represented in bitmap order as fixed-length offsets (integers). These offsets are measured from the start of the parameters to the start of the variable-length parameters. The actual variable-length parameters are then packed after all fixed-length parameters.</p><p>If necessary, a null byte must be added between <code>Pathname</code> and <code>DirectoryParameters</code> in the request block to make <code>DirectoryParameters</code> begin on an even boundary.</p><p>If the Attributes parameter is included, the Set/Clear bit indicates that the specified attributes are to be set (1) or cleared (0). Therefore, it is not possible to set some attributes and clear other attributes in the same command.</p><p>If this command changes the CNode's attributes or sets the CNode's dates (except modification date), Finder Info, or UNIX privileges, the modification date of the CNode is set to the server's clock. If this command changes the CNode’s Invisible attribute, the modification date of the CNode’s parent directory is set to the server’s clock.</p><p>To set the parameters for a directory that is not empty, the user needs search access to all ancestors, including the parent directory, as well as write access to the parent directory. To set parameters for an empty directory, the user needs search or write access to all ancestors, except the parent directory, as well as write access to the parent directory.</p><p>To set parameters for a file that is not empty, the user needs search access to all ancestors, except the parent directory, as well as write access to the parent directory. To set parameters for an empty file, the user needs search or write access to all ancestors, except the parent directory, as well as write access to the parent directory.</p><p>For files, call <code><a href="reference.html#//apple_ref/c/func/FPSetFileParms">FPSetFileParms</a></code> to set parameters and attributes that <code>FPSetFileDirParms</code> cannot set. For directories, call <code><a href="reference.html#//apple_ref/c/func/FPSetDirParms">FPSetDirParms</a></code> to set parameters and attributes that <code>FPSetFileDirParms</code> cannot set.</p><p><span class="content_text">Table 68</span> lists the result codes for the <code>FPSetFileDirParms</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-239676" title="Table 68Result codes for the FPSetFileDirParms command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEJCCB" title="Table 68Result codes for the FPSetFileDirParms command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 68&nbsp;&nbsp;</strong>Result codes for the <code>FPSetFileDirParms</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to use this command.</p></td></tr><tr><td  scope="row"><p><code>kFPBitmapErr</code></p></td><td ><p>Attempt was made to set a parameter that cannot be set by this command; bitmap is null.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Input parameters do not point to an existing file or directory.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number, Volume ID, or pathname type is unknown; pathname is invalid.</p></td></tr><tr><td  scope="row"><p><code>kFPVolLocked</code></p></td><td ><p>Volume is ReadOnly.</p></td></tr></table></div><p><span class="content_text">Figure 74</span> shows the request block for the <code>FPSetFileDirParms</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-224794" title="Figure 74Request block for the FPSetFileDirParms command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDDJADJ" title="Figure 74Request block for the FPSetFileDirParms command"></a><p><strong>Figure 74&nbsp;&nbsp;</strong>Request block for the <code>FPSetFileDirParms</code> command</p><img src = "../Art/afp_072.gif" alt = "Request block for the FPSetFileDirParms command" width="274" height="355"></div><br/><a name="//apple_ref/c/func/FPSetFileParms" title="FPSetFileParms"></a><a name="//apple_ref/doc/c_ref/FPSetFileParms" title="FPSetFileParms"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDDFFCG" title="FPSetFileParms"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_75"></a><h3 class="tight">FPSetFileParms</h3><p class="spaceabove">Sets parameters for a file.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
long DirectoryID
short Bitmap
byte PathType
string Pathname
FileParameters
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPSetFileParms</code> (30).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>DirectoryID</em></dt><dd><p>Ancestor Directory ID.</p></dd><dt><em>Bitmap</em></dt><dd><p>Bitmap describing the parameters to set. Set the bit that corresponds to each desired parameter. This bitmap can be the same as the FileBitmap parameter of the <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> command. For bit definitions for the Directory bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Directory_Bitmap">Directory Bitmap</a></span>; for bit definitions for the File bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/File_Bitmap">File Bitmap</a></span>.</p></dd><dt><em>PathType</em></dt><dd><p>Type of name in <code>Pathname</code>. See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Path_Type_Constants">Path Type Constants</a></span> for possible values.</p></dd><dt><em>Pathname</em></dt><dd><p>Pathname to the desired file or directory. <code>Pathname</code> is a string if it contains Short or Long Names or an AFPName if it contains a UTF-8–encoded path.</p></dd><dt><em>FileParameters</em></dt><dd><p>Parameters to be set, packed in bitmap order.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-239840">Table 69</a></span> for the possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>The parameters must be packed, in bitmap order, in the request block. Variable-length parameters must be kept at the end of the block. To do this, variable-length parameters are represented in bitmap order as fixed-length offsets (integers). These offsets are measured from the start of the parameters to the start of the variable-length parameters. The actual variable-length parameters are then packed after all fixed-length parameters.</p><p>If necessary, a null byte must be added between <code>Pathname</code> and <code>FileParameters</code> in the request block to make <code>FileParameters</code> begin on an even boundary.</p><p>The following parameters may be set or cleared: Attributes (all attributes except DAlreadyOpen, RAlreadyOpen, and CopyProtect), Creation Date, Modification Date, Backup Date, Finder Info, and UNIX privileges.</p><p>If the Attributes parameter is included, the Set/Clear bit indicates that the specified attributes are to be set (1) or cleared (0). Therefore, it is not possible to set some attributes and clear other attributes in the same call.</p><p>If this command changes the file’s Invisible attribute, the modification date of the file’s parent directory is set to the server’s clock. If this command changes the file’s Attributes or sets any dates (except modification date), or Finder Info, the file’s modification date is set to the server’s clock.</p><p>If the file is empty (both forks are zero length), the user must have search or write access to all ancestors, except this file’s parent directory, as well as write access to the parent directory. If either fork is not empty, the user must have search access to all ancestors except the parent directory, as well as read and write access to the parent directory.</p><p>This command cannot be used to set a file’s name; instead, use <code><a href="reference.html#//apple_ref/c/func/FPRename">FPRename</a></code>. This command cannot be used to set the file’s Parent Directory ID; instead, use <code><a href="reference.html#//apple_ref/c/func/FPMoveAndRename">FPMoveAndRename</a></code>. This command cannot be used to set a file’s fork lengths; instead, call <code><a href="reference.html#//apple_ref/c/func/FPSetForkParms">FPSetForkParms</a></code>. This command cannot be used to set a file’s Node ID.</p><p><span class="content_text">Table 69</span> lists the result codes for the <code>FPSetFileParms</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-239840" title="Table 69Result codes for the FPSetFileParms command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJHIFC" title="Table 69Result codes for the FPSetFileParms command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 69&nbsp;&nbsp;</strong>Result codes for the <code>FPSetFileParms</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to use this command.</p></td></tr><tr><td  scope="row"><p><code>kFPBitmapErr</code></p></td><td ><p>Attempt was made to set a parameter that cannot be set by this command; bitmap is null.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectNotFound</code></p></td><td ><p>Input parameters do not point to an existing file.</p></td></tr><tr><td  scope="row"><p><code>kFPObjectTypeErr</code></p></td><td ><p>Input parameters point to a directory.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number, Volume ID, or pathname type is unknown; pathname is invalid or null.</p></td></tr></table></div><p><span class="content_text">Figure 75</span> shows the request block for the <code>FPSetFileParms</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-225090" title="Figure 75Request block for the FPSetFileParms command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIJFGB" title="Figure 75Request block for the FPSetFileParms command"></a><p><strong>Figure 75&nbsp;&nbsp;</strong>Request block for the <code>FPSetFileParms</code> command</p><img src = "../Art/afp_073.gif" alt = "Request block for the FPSetFileParms command" width="274" height="355"></div><br/><a name="//apple_ref/c/func/FPSetForkParms" title="FPSetForkParms"></a><a name="//apple_ref/doc/c_ref/FPSetForkParms" title="FPSetForkParms"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDGABCD" title="FPSetForkParms"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_76"></a><h3 class="tight">FPSetForkParms</h3><p class="spaceabove">Sets the length of a fork.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short OForkRefNum
short Bitmap
long ForkLen
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPSetForkParms</code> (31).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>OForkRefNum</em></dt><dd><p>Open fork reference number.</p></dd><dt><em>Bitmap</em></dt><dd><p>Bitmap describing the parameters to set. Set the bit that corresponds to each desired parameter. This bitmap is the same as the <code>FileBitmap</code> of the <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> command, but only the Data Fork Length, Resource Fork Length, Extended Data Fork Length, and Extended Resource Fork Length parameters can be set. For bit definitions for this bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/File_Bitmap">File Bitmap</a></span>.</p></dd><dt><em>ForkLen</em></dt><dd><p>New end-of-fork value.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-240011">Table 70</a></span> for the possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>The <code>Bitmap</code> and <code>ForkLen</code> parameters are passed to the server, which changes the length of the fork specified by <code>OForkRefNum</code>. The server returns a <code>kFPBitmapErr</code> result code if the command tries to set the length of the file’s other fork or if it tries to set any other file parameter.</p><p>The server returns a <code>kFPLockErr</code> result code if an attempt is made to truncate the fork in a way that would eliminate a range or part of a range that is locked by another user.</p><p>The fork must be open for writing by the user.</p><p>This command cannot set a file’s name; instead, use <code><a href="reference.html#//apple_ref/c/func/FPRename">FPRename</a></code>. This command cannot set a file’s Parent Directory ID; instead, use <code><a href="reference.html#//apple_ref/c/func/FPMoveAndRename">FPMoveAndRename</a></code>. This command cannot set a file’s file number.</p><p><span class="content_text">Table 70</span> lists the result codes for the<code> FPSetForkParms </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-240011" title="Table 70Result codes for the FPSetForkParms command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJHAEG" title="Table 70Result codes for the FPSetForkParms command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 70&nbsp;&nbsp;</strong>Result codes for the <code>FPSetForkParms</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to use this command.</p></td></tr><tr><td  scope="row"><p><code>kFPBitmapErr</code></p></td><td ><p>Attempt was made to set a parameter that cannot be set by this command; bitmap is null.</p></td></tr><tr><td  scope="row"><p><code>kFPDiskFull</code></p></td><td ><p>No more space exists on the volume.</p></td></tr><tr><td  scope="row"><p><code>kFPLockErr</code></p></td><td ><p>Range lock conflict exists.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number or fork reference number is invalid.</p></td></tr><tr><td  scope="row"><p><code>kFPVolLocked</code></p></td><td ><p>Volume is ReadOnly.</p></td></tr></table></div><p><span class="content_text">Figure 76</span> shows the request block for the <code>FPSetForkParms</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-225361" title="Figure 76Request block for the FPSetForkParms command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBGDEE" title="Figure 76Request block for the FPSetForkParms command"></a><p><strong>Figure 76&nbsp;&nbsp;</strong>Request block for the <code>FPSetForkParms</code> command</p><img src = "../Art/afp_074.gif" alt = "Request block for the FPSetForkParms command" width="123" height="231"></div><br/><a name="//apple_ref/c/func/FPSetVolParms" title="FPSetVolParms"></a><a name="//apple_ref/doc/c_ref/FPSetVolParms" title="FPSetVolParms"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBJCFC" title="FPSetVolParms"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_77"></a><h3 class="tight">FPSetVolParms</h3><p class="spaceabove">Sets a volume’s backup date.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
short VolumeID
short Bitmap
Date BackupDate
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPSetVolParms</code> (32).</p></dd><dt><em>Pad</em></dt><dd><p>Pad byte.</p></dd><dt><em>VolumeID</em></dt><dd><p>Volume ID.</p></dd><dt><em>Bitmap</em></dt><dd><p>Bitmap describing the parameters to be set. This parameter is the same as the <code>Bitmap</code> parameter for the <code><a href="reference.html#//apple_ref/c/func/FPGetVolParms">FPGetVolParms</a></code> command, but only the Backup Date bit can be set. For bit definitions for this bitmap, see <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Volume_Bitmap">Volume Bitmap</a></span>.</p></dd><dt><em>BackupDate</em></dt><dd><p>New backup date.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text">Table 71</span> for the possible result codes.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>This command sets a volume’s backup date.</p><p><span class="content_text">Table 71</span> lists the result codes for the<code> FPSetVolParms </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-314762" title="Table 71Result codes for the FPSetVolParms command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDIFAHF" title="Table 71Result codes for the FPSetVolParms command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 71&nbsp;&nbsp;</strong>Result codes for the <code>FPSetVolParms</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>User does not have the access privileges required to use this command.</p></td></tr><tr><td  scope="row"><p><code>kFPBitmapErr</code></p></td><td ><p>Attempt was made to set a parameter that cannot be set by this command; bitmap is null.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number is unknown.</p></td></tr><tr><td  scope="row"><p><code>kFPVolLocked</code></p></td><td ><p>Volume is ReadOnly.</p></td></tr></table></div><p><span class="content_text">Figure 77</span> shows the request block for the <code>FPSetVolParms</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-225548" title="Figure 77Request block for the FPSetVolParms command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBCAAH" title="Figure 77Request block for the FPSetVolParms command"></a><p><strong>Figure 77&nbsp;&nbsp;</strong>Request block for the <code>FPSetVolParms</code> command</p><img src = "../Art/afp_075.gif" alt = "Request block for the FPSetVolParms command" width="123" height="231"></div><br/><a name="//apple_ref/c/func/FPWrite" title="FPWrite"></a><a name="//apple_ref/doc/c_ref/FPWrite" title="FPWrite"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDJHIDE" title="FPWrite"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_78"></a><h3 class="tight">FPWrite</h3><p class="spaceabove">Writes a block of data to an open fork.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Flag
short OForkRefNum
long Offset
long ReqCount
ForkData
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPWrite</code> (33).</p></dd><dt><em>Flag</em></dt><dd><p>Bit 7 is the <code>StartEndFlag</code> bit, and it indicates whether <code>Offset</code> is relative to the beginning or end of the fork. A value of zero indicates that the start is relative to the beginning of the fork; a value of 1 indicates that the start is relative to the end of the fork.</p></dd><dt><em>OForkRefNum</em></dt><dd><p>Open fork reference number.</p></dd><dt><em>Offset</em></dt><dd><p>Byte offset from the beginning or the end of the fork indicating where the write is to begin; a negative value indicates a byte within the fork relative to the end of the fork.</p></dd><dt><em>ReqCount</em></dt><dd><p>Number of bytes to be written.</p></dd><dt><em>ForkData</em></dt><dd><p>Data to be written, which is not a part of the request block. Instead, the data is transmitted to the server in an intermediate exchange of DSI packets.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-240401">Table 72</a></span> for the possible result codes.</p></dd><dt><em>ActualCount</em></dt><dd><p>Number of bytes actually written to the fork. This long value is returned by the underlying transport mechanism and is not a value in the reply block.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block consisting of a long, called <code>LastWritten</code>, containing the number of the byte just past the last byte written.</p></dd></dl><h5 class="tight">Discussion</h5><p>The server writes data to the open fork, starting at the number of bytes from the beginning or end of the fork as specified by <code>Offset</code>. The <code>StartEndFlag</code> bit indicates whether the block of data is to be written at an offset relative to the beginning or the end of the fork. When the offset is relative to the end of the fork, data can be written without knowing the exact end of the fork, which is useful when multiple writers modify a fork concurrently. The server returns the number of the byte just past the last byte written.</p><p>This command differs from the <code><a href="reference.html#//apple_ref/c/func/FPWriteExt">FPWriteExt</a></code> command in that the <code>FPWriteExt</code> command is prepared to handle the large values that may be required for writing to files that reside in volumes larger than 4 GB in size.</p><p>If the block of data to be written extends beyond the end of the fork, the fork is extended. If part of the range is locked by another user, the server returns a <code>kFPLockErr</code> result code and does not write any data to the fork.</p><p>The file’s Modification Date is not changed until the fork is closed.</p><p>The fork must be open for writing by the user sending this command.</p><p>Lock the range before sending this command. The underlying transport mechanism may force the request to be broken into multiple smaller requests. If the range is not locked when this command begins execution, it is possible for another user to lock some or all of the range before this command completes, causing the write to succeed partially.</p><p><span class="content_text">Table 72</span> lists the result codes for the <code>FPWrite</code> command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-240401" title="Table 72Result codes for the FPWrite command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFJFAH" title="Table 72Result codes for the FPWrite command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 72&nbsp;&nbsp;</strong>Result codes for the <code>FPWrite</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>Fork is not open for writing by this user.</p></td></tr><tr><td  scope="row"><p><code>kFPDiskFull</code></p></td><td ><p>No space exists on the volume.</p></td></tr><tr><td  scope="row"><p><code>kFPLockErr</code></p></td><td ><p>Some or all of the requested range is locked by another user.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number or open fork reference number is unknown.</p></td></tr></table></div><p><span class="content_text">Figure 78</span> shows the request and reply blocks for the <code>FPWrite</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-225809" title="Figure 78Request and reply blocks for the FPWrite command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDBCDEI" title="Figure 78Request and reply blocks for the FPWrite command"></a><p><strong>Figure 78&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPWrite</code> command</p><img src = "../Art/afp_079.gif" alt = "Request and reply blocks for the FPWrite command" width="394" height="278"></div><br/><a name="//apple_ref/c/func/FPWriteExt" title="FPWriteExt"></a><a name="//apple_ref/doc/c_ref/FPWriteExt" title="FPWriteExt"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDFJIAD" title="FPWriteExt"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_79"></a><h3 class="tight">FPWriteExt</h3><p class="spaceabove">Writes a block of data to an open fork.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Flag
short OForkRefNum
long long Offset
long long ReqCount
ForkData
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPWriteExt</code> (61).</p></dd><dt><em>Flag</em></dt><dd><p>Bit 7 of the <code>Flag </code>parameter is the <code>StartEndFlag</code> bit, and it indicates whether <code>Offset</code> is relative to the beginning or end of the fork. A value of zero indicates that the start is relative to the beginning of the fork; a value of 1 indicates that the start is relative to the end of the fork.</p></dd><dt><em>OForkRefNum</em></dt><dd><p>Open fork reference number.</p></dd><dt><em>Offset</em></dt><dd><p>Byte offset from the beginning or the end of the fork indicating where the write is to begin; a negative value indicates a byte within the fork relative to the end of the fork.</p></dd><dt><em>ReqCount</em></dt><dd><p>Number of bytes to be written.</p></dd><dt><em>ForkData</em></dt><dd><p>Data to be written, which is not a part of the request block. Instead, the data is transmitted to the server in an intermediate exchange of DSI packets.</p></dd><dt><em>Result</em></dt><dd><p><code>kFPNoErr</code> if no error occurred. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH3-240570">Table 73</a></span>for the possible result codes.</p></dd><dt><em>ActualCount</em></dt><dd><p>Number of bytes actually written to the fork. This long long value is returned by the underlying transport mechanism and is not a value in the reply block.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>If the result code is <code>kFPNoErr</code>, the server returns a reply block consisting of a long, called <code>LastWritten</code>, containing the number of the byte just past the last byte written.</p></dd></dl><h5 class="tight">Discussion</h5><p>The server writes data to the open fork, starting at the number of bytes from the beginning or end of the fork as specified by <code>Offset</code>.</p><p>This command differs from the <code><a href="reference.html#//apple_ref/c/func/FPWrite">FPWrite</a></code> command in that this command is prepared to handle the large values that may be required for writing to files that reside in volumes larger than 4 GB in size.</p><p>The <code>StartEndFlag</code> bit indicates whether the block of data is to be written at an offset relative to the beginning or the end of the fork. When the offset is relative to the end of the fork, data can be written without knowing the exact end of the fork, which is useful when multiple writers modify a fork concurrently. The server returns the number of the byte just past the last byte written.</p><p>If the block of data to be written extends beyond the end of the fork, the fork is extended. If part of the range is locked by another user, the server returns a <code>kFPLockErr</code> result code and does not write any data to the fork.</p><p>The file’s Modification Date is not changed until the fork is closed.</p><p>The fork must be open for writing by the user sending this command.</p><p>Lock the range before sending this command. The underlying transport mechanism may force the request to be broken into multiple smaller requests. If the range is not locked when this command begins execution, it is possible for another user to lock some or all of the range before this command completes, causing the write to success partially.</p><p><span class="content_text">Table 73</span> lists the result codes for the <code>FPWriteExt </code>command.</p><a name="//apple_ref/doc/uid/TP40003548-CH3-240570" title="Table 73Result codes for the FPWriteExt command "></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEFIIF" title="Table 73Result codes for the FPWriteExt command "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 73&nbsp;&nbsp;</strong>Result codes for the <code>FPWriteExt</code> command </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result code</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th></tr><tr><td  scope="row"><p><code>kFPAccessDenied</code></p></td><td ><p>Fork is not open for writing by this user.</p></td></tr><tr><td  scope="row"><p><code>kFPDiskFull</code></p></td><td ><p>No space exists on the volume.</p></td></tr><tr><td  scope="row"><p><code>kFPLockErr</code></p></td><td ><p>Some or all of the requested range is locked by another user.</p></td></tr><tr><td  scope="row"><p><code>kFPMiscErr</code><code></code></p></td><td ><p>Non-AFP error occurred.</p></td></tr><tr><td  scope="row"><p><code>kFPParamErr</code></p></td><td ><p>Session reference number or open fork reference number is unknown.</p></td></tr></table></div><p><span class="content_text">Figure 79</span> shows the request and reply blocks for the <code>FPWriteExt</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-226076" title="Figure 79Request and reply blocks for the FPWriteExt command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-CHDEAGHH" title="Figure 79Request and reply blocks for the FPWriteExt command"></a><p><strong>Figure 79&nbsp;&nbsp;</strong>Request and reply blocks for the <code>FPWriteExt</code> command</p><img src = "../Art/afp_026.gif" alt = "Request and reply blocks for the FPWriteExt command" width="391" height="449"></div><br/><a name="//apple_ref/c/func/FPZzzzz" title="FPZzzzz"></a><a name="//apple_ref/doc/c_ref/FPZzzzz" title="FPZzzzz"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-FPZzzzz" title="FPZzzzz"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-DontLinkElementID_80"></a><h3 class="tight">FPZzzzz</h3><p class="spaceabove">Notifies the server that the client is going to sleep.</p><p class="spaceabove"><pre>
   
byte CommandCode
byte Pad
unsigned long Flags
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>CommandCode</em></dt><dd><p><code>kFPZzzzz</code> (122).</p></dd><dt><em>Flag</em></dt><dd><p>Reserved.</p></dd><dt><em>ReplyBlock</em></dt><dd><p>None.</p></dd></dl><h5 class="tight">Discussion</h5><p>If an AFP sharepoint is mounted when the client goes to sleep (for example, an idle sleep or a demand sleep such as when the lid of a PowerBook is closed), the client sends the <code>FPZzzzz</code> command. This command notifies the AFP server that the client is going to sleep and that the server should not send any more packets to the client. When the client is awakens, it will send AFP packets to the server, which notifies the server that the client is now awake.</p><p>The AFP server should have a setting for the maximum time that a client can sleep — typically 24 hours. If a client has been asleep longer than the maximum sleep time, the server assumes that the client has been disconnected and may free client-related resources on the server.</p><p>The <code>FPZzzzz</code> command is supported by AFP 2.3 and later over AFP/TCP only.</p><p><span class="content_text">Figure 80</span> shows the request block for the <code>FPZzzzz</code> command.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH3-282398" title="Figure 80Request block for the FPZzzzz command"></a><a name="//apple_ref/doc/uid/TP40003548-CH3-BACBDGIJ" title="Figure 80Request block for the FPZzzzz command"></a><p><strong>Figure 80&nbsp;&nbsp;</strong>Request block for the <code>FPZzzzz</code> command</p><img src = "../Art/afp_095.gif" alt = "Request block for the FPZzzzz command" width="123" height="160"></div><br/><a name="//apple_ref/doc/uid/TP40003548-CH4-DontLinkElementID_6" title="Data Types"></a><h2>Data Types</h2><a name="//apple_ref/c/tdef/kauth_acl" title="Access Control List Structure" role="Enum"></a><a name="//apple_ref/doc/c_ref/kauth_acl" title="Access Control List Structure" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-CHDEEBJE" title="Access Control List Structure" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-DontLinkElementID_81"></a><h3 class="tight">Access Control List Structure</h3><p class="spaceabove">Structure that describes a file or directory’s access control list (ACL).</p><p class="spaceabove"><pre>
struct <a href="reference.html#//apple_ref/doc/c_ref/kauth_acl">kauth_acl</a> {
      u_int32_t acl_entrycount;
      u_int32_t = acl_flags;
      struct <!--a-->kauth_ace<!--/a--> acl_ace[];
   };
</pre></p><h5 class="tight">Constants</h5><dl class="termdef"><a name="//apple_ref/c/econst/acl_entrycount" title="acl_entrycount"></a><a name="//apple_ref/doc/c_ref/acl_entrycount" title="acl_entrycount"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-DontLinkElementID_82"></a><dt><code>acl_entrycount</code></dt><dd><p>Number of <code>acl_ace</code> structures.</p></dd><a name="//apple_ref/c/econst/acl_flags" title="acl_flags"></a><a name="//apple_ref/doc/c_ref/acl_flags" title="acl_flags"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-DontLinkElementID_83"></a><dt><code>acl_flags</code></dt><dd><p>See the Core Foundation ACL documentation for definitions.</p></dd><a name="//apple_ref/c/econst/acl_ace" title="acl_ace"></a><a name="//apple_ref/doc/c_ref/acl_ace" title="acl_ace"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-DontLinkElementID_84"></a><dt><code>acl_ace</code></dt><dd><p>An <code>acl_ace</code> structure. See the Core Foundation ACL documentation for a description of this structure.</p></dd></dl><h5 class="tight">Discussion</h5><p>The Access Control List structure is returned by the <code><a href="reference.html#//apple_ref/c/func/FPGetACL">FPGetACL</a></code> command and set by the <code><a href="reference.html#//apple_ref/c/func/FPSetACL">FPSetACL</a></code> command.</p><a name="//apple_ref/doc/constant_group/Access_Rights_Bitmap" title="Access Rights Bitmap" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-CHDDBIJJ" title="Access Rights Bitmap" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-DontLinkElementID_85"></a><h3 class="tight">Access Rights Bitmap</h3><p class="spaceabove">A 32-bit value whose bits indicate the ability of the directory’s Owner, Group, and Everyone to read, write, and search a directory.</p><p class="spaceabove"><pre>
   
</pre></p><h5 class="tight">Discussion</h5><p>Call <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> to get the Access Rights bitmap.</p><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH4-261031">Figure 81</a></span> shows the Access Rights bitmap.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH4-261031" title="Figure 81Access Rights bitmap"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-CHDICEFH" title="Figure 81Access Rights bitmap"></a><p><strong>Figure 81&nbsp;&nbsp;</strong>Access Rights bitmap</p><img src = "../Art/afp_093.gif" alt = "Access Rights bitmap" width="312" height="138"></div><br/><a name="//apple_ref/doc/constant_group/Directory_Bitmap" title="Directory Bitmap" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-CHDHGHEH" title="Directory Bitmap" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-DontLinkElementID_86"></a><h3 class="tight">Directory Bitmap</h3><p class="spaceabove">A 16-bit value whose bits are used to get and set directory parameters. </p><p class="spaceabove"><pre>
enum {
   <!--a-->kFPAttributeBit<!--/a--> = 0<!--a-->x1<!--/a-->,
   <!--a-->kFPParentDirIDBit<!--/a--> = 0<!--a-->x2<!--/a-->,
   <!--a-->kFPCreateDateBit<!--/a--> = 0<!--a-->x4<!--/a-->,
   <!--a-->kFPModDateBit<!--/a--> = 0<!--a-->x8<!--/a-->,
   <!--a-->kFPBackupDateBit<!--/a--> = 0<!--a-->x10<!--/a-->,
   <!--a-->kFPFinderInfoBit<!--/a--> = 0<!--a-->x20<!--/a-->,
   <!--a-->kFPLongNameBit<!--/a--> = 0<!--a-->x40<!--/a-->,
   <!--a-->kFPShortNameBit<!--/a--> = 0<!--a-->x80<!--/a-->,
   <!--a-->kFPNodeIDBit<!--/a--> = 0<!--a-->x100<!--/a-->,
   <!--a-->kFPOffspringCountBit<!--/a--> = 0<!--a-->x0200<!--/a-->,
   <!--a-->kFPOwnerIDBit<!--/a--> = 0<!--a-->x0400<!--/a-->,
   <!--a-->kFPGroupIDBit<!--/a--> = 0<!--a-->x0800<!--/a-->,
   <!--a-->kFPAccessRightsBit<!--/a--> = 0<!--a-->x1000<!--/a-->,
   <!--a-->kFPProDOSInfoBit<!--/a--> = 0<!--a-->x2000<!--/a--> // <!--a-->AFP<!--/a--> <a href="../../../../Security/Reference/AuthorizationPluginRef/Reference/reference.html#//apple_ref/doc/c_ref/version" target="_top">version</a> 2.2 <!--a-->and<!--/a--> <!--a-->earlier<!--/a-->
   <!--a-->kFPUTF8NameBit<!--/a--> = 0<!--a-->x2000<!--/a-->, // <!--a-->AFP<!--/a--> <a href="../../../../Security/Reference/AuthorizationPluginRef/Reference/reference.html#//apple_ref/doc/c_ref/version" target="_top">version</a> 3.0 <!--a-->and<!--/a--> <!--a-->later<!--/a-->
   <!--a-->kFPUnixPrivsBit<!--/a--> = 0<!--a-->x8000<!--/a--> // <!--a-->AFP<!--/a--> <a href="../../../../Security/Reference/AuthorizationPluginRef/Reference/reference.html#//apple_ref/doc/c_ref/version" target="_top">version</a> 3.0 <!--a-->and<!--/a--> <!--a-->later<!--/a-->
};
</pre></p><h5 class="tight">Discussion</h5><p>The Directory bitmap is used when calling <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> to indicate the directory parameters you want to get. It is also used when calling <code><a href="reference.html#//apple_ref/c/func/FPSetDirParms">FPSetDirParms</a></code><code></code> and <code><a href="reference.html#//apple_ref/c/func/FPSetFileDirParms">FPSetFileDirParms</a></code> to set directory parameters.</p><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH4-301888">Figure 82</a></span> describes the Directory bitmap.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH4-301888" title="Figure 82Directory bitmap"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-CHDDAADH" title="Figure 82Directory bitmap"></a><p><strong>Figure 82&nbsp;&nbsp;</strong>Directory bitmap</p><img src = "../Art/afp_089.gif" alt = "Directory bitmap" width="254" height="273"></div><br/><a name="//apple_ref/doc/constant_group/Directory_Attributes_Bitmap" title="Directory Attributes Bitmap" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-CHDBHECI" title="Directory Attributes Bitmap" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-DontLinkElementID_87"></a><h3 class="tight">Directory Attributes Bitmap</h3><p class="spaceabove">A 16-bit value whose bits provide additional information about a directory.</p><p class="spaceabove"><pre>
   
</pre></p><h5 class="tight">Discussion</h5><p>Use the bits in the Directory Attributes bitmap to inhibit renaming or deleting the directory. Other bits in the Directory Attributes bitmap indicate whether the directory needs to be backed up, whether the directory is mounted by a user, whether the directory is invisible or a system directory, and whether the directory is in a shared area or is a share point. When calling <code><a href="reference.html#//apple_ref/c/func/FPSetDirParms">FPSetDirParms</a></code> and <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> to set Directory Attributes, use the Set/Clear bit (bit 15) to indicate whether you are setting or clearing a directory attribute.</p><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH4-301958">Figure 83</a></span> describes the Attributes bitmap for a directory.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH4-301958" title="Figure 83Directory Attributes bitmap"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-CHDIDAGI" title="Figure 83Directory Attributes bitmap"></a><p><strong>Figure 83&nbsp;&nbsp;</strong>Directory Attributes bitmap</p><img src = "../Art/afp_090.gif" alt = "Directory Attributes bitmap" width="216" height="182"></div><br/><a name="//apple_ref/doc/constant_group/Extended_Attributes_Bitmap" title="Extended Attributes Bitmap" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-CHDJCDDJ" title="Extended Attributes Bitmap" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-DontLinkElementID_88"></a><h3 class="tight">Extended Attributes Bitmap</h3><p class="spaceabove">Constants that control the behavior when setting extended attributes.</p><p class="spaceabove"><pre>
enum {
   <a href="reference.html#//apple_ref/doc/c_ref/kXAttrNoFollow">kXAttrNoFollow</a> = 0<!--a-->x1<!--/a-->,
   <a href="reference.html#//apple_ref/doc/c_ref/kXAttrCreate">kXAttrCreate</a> = 0<!--a-->x2<!--/a-->,
   <a href="reference.html#//apple_ref/doc/c_ref/kXAttrReplace">kXAttrReplace</a> = 0<!--a-->x4<!--/a-->
};
</pre></p><h5 class="tight">Constants</h5><dl class="termdef"><a name="//apple_ref/c/econst/kXAttrNoFollow" title="kXAttrNoFollow"></a><a name="//apple_ref/doc/c_ref/kXAttrNoFollow" title="kXAttrNoFollow"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-DontLinkElementID_89"></a><dt><code>kXAttrNoFollow</code></dt><dd><p>If set, do not follow symbolic links.</p></dd><a name="//apple_ref/c/econst/kXAttrCreate" title="kXAttrCreate"></a><a name="//apple_ref/doc/c_ref/kXAttrCreate" title="kXAttrCreate"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-DontLinkElementID_90"></a><dt><code>kXAttrCreate</code></dt><dd><p>If set, <code><a href="reference.html#//apple_ref/c/func/FPSetExtAttr">FPSetExtAttr</a></code> fails if the extended attribute already exists.</p></dd><a name="//apple_ref/c/econst/kXAttrReplace" title="kXAttrReplace"></a><a name="//apple_ref/doc/c_ref/kXAttrReplace" title="kXAttrReplace"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-DontLinkElementID_91"></a><dt><code>kXAttrReplace</code></dt><dd><p>If set, <code><a href="reference.html#//apple_ref/c/func/FPSetExtAttr">FPSetExtAttr</a></code> fails if the extended attribute does not exist.</p></dd></dl><h5 class="tight">Discussion</h5><p>Use these constants in the Bitmap parameter of the <code><a href="reference.html#//apple_ref/c/func/FPGetExtAttr">FPGetExtAttr</a></code>, <code><a href="reference.html#//apple_ref/c/func/FPSetExtAttr">FPSetExtAttr</a></code>, and <code><a href="reference.html#//apple_ref/c/func/FPRemoveExtAttr">FPRemoveExtAttr</a></code> commands to get, set, and remove extended attributes.</p><a name="//apple_ref/doc/constant_group/File_Bitmap" title="File Bitmap" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-CHDJGJDD" title="File Bitmap" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-DontLinkElementID_92"></a><h3 class="tight">File Bitmap</h3><p class="spaceabove">A 16-bit value whose bits are used to get and set file parameters.</p><p class="spaceabove"><pre>
enum {
   <!--a-->kFPAttributeBit<!--/a--> = 0<!--a-->x1<!--/a-->,
   <!--a-->kFPParentDirIDBit<!--/a--> = 0<!--a-->x2<!--/a-->,
   <!--a-->kFPCreateDateBit<!--/a--> = 0<!--a-->x4<!--/a-->,
   <!--a-->kFPModDateBit<!--/a--> = 0<!--a-->x8<!--/a-->,
   <!--a-->kFPBackupDateBit<!--/a--> = 0<!--a-->x10<!--/a-->,
   <!--a-->kFPFinderInfoBit<!--/a--> = 0<!--a-->x20<!--/a-->,
   <!--a-->kFPLongNameBit<!--/a--> = 0<!--a-->x40<!--/a-->,
   <!--a-->kFPShortNameBit<!--/a--> = 0<!--a-->x80<!--/a-->,
   <!--a-->kFPNodeIDBit<!--/a--> = 0<!--a-->x100<!--/a-->,
   <!--a-->kFPDataForkLenBit<!--/a--> = 0<!--a-->x0200<!--/a-->,
   <!--a-->kFPRsrcForkLenBit<!--/a--> = 0<!--a-->x0400<!--/a-->,
   <!--a-->kFPExtDataForkLenBit<!--/a--> = 0<!--a-->x0800<!--/a-->, // <!--a-->AFP<!--/a--> <a href="../../../../Security/Reference/AuthorizationPluginRef/Reference/reference.html#//apple_ref/doc/c_ref/version" target="_top">version</a> 3.0 <!--a-->and<!--/a--> <!--a-->later<!--/a-->
   <!--a-->kFPLaunchLimitBit<!--/a--> = 0<!--a-->x1000<!--/a-->,
   <!--a-->kFPUTF8NameBit<!--/a--> = 0<!--a-->x2000<!--/a-->, // <!--a-->AFP<!--/a--> <a href="../../../../Security/Reference/AuthorizationPluginRef/Reference/reference.html#//apple_ref/doc/c_ref/version" target="_top">version</a> 3.0 <!--a-->and<!--/a--> <!--a-->later<!--/a-->
   <!--a-->kFPExtRsrcForkLenBit<!--/a--> = 0<!--a-->x4000<!--/a-->, // <!--a-->AFP<!--/a--> <a href="../../../../Security/Reference/AuthorizationPluginRef/Reference/reference.html#//apple_ref/doc/c_ref/version" target="_top">version</a> 3.0 <!--a-->and<!--/a--> <!--a-->later<!--/a-->
   <!--a-->kFPUnixPrivsBit<!--/a--> = 0<!--a-->x8000<!--/a--> // <!--a-->AFP<!--/a--> <a href="../../../../Security/Reference/AuthorizationPluginRef/Reference/reference.html#//apple_ref/doc/c_ref/version" target="_top">version</a> 3.0 <!--a-->and<!--/a--> <!--a-->later<!--/a-->
};
</pre></p><h5 class="tight">Discussion</h5><p>The File bitmap is used when calling <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> to indicate the file parameters you want to get. It is also used when calling <code><a href="reference.html#//apple_ref/c/func/FPSetFileParms">FPSetFileParms</a></code> and <code><a href="reference.html#//apple_ref/c/func/FPSetFileDirParms">FPSetFileDirParms</a></code> to set file parameters.</p><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH4-302268">Figure 84</a></span> describes the File bitmap.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH4-302268" title="Figure 84File bitmap"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-CHDGGJAC" title="Figure 84File bitmap"></a><p><strong>Figure 84&nbsp;&nbsp;</strong>File bitmap</p><img src = "../Art/afp_091.gif" alt = "File bitmap" width="311" height="258"></div><br/><a name="//apple_ref/doc/constant_group/File_Attributes_Bitmap" title="File Attributes Bitmap" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-CHDFJDCG" title="File Attributes Bitmap" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-DontLinkElementID_93"></a><h3 class="tight">File Attributes Bitmap</h3><p class="spaceabove">A 16-bit value whose bits provide additional information about a file.</p><p class="spaceabove"><pre>
enum {
   <!--a-->kFPInvisibleBit<!--/a--> = 0<!--a-->x01<!--/a-->,
   <!--a-->kFPMultiUserBit<!--/a--> = 0<!--a-->x02<!--/a-->,
   <!--a-->kFPSystemBit<!--/a--> = 0<!--a-->x04<!--/a-->,
   <!--a-->kFPDAlreadyOpenBit<!--/a--> = 0<!--a-->x08<!--/a-->,
   <!--a-->kFPRAlreadyOpenBit<!--/a--> = 0<!--a-->x10<!--/a-->,
   <!--a-->kFPWriteInhibitBit<!--/a--> = 0<!--a-->x20<!--/a-->,
   <!--a-->kFPBackUpNeededBit<!--/a--> = 0<!--a-->x40<!--/a-->,
   <!--a-->kFPRenameInhibitBit<!--/a--> = 0<!--a-->x80<!--/a-->,
   <!--a-->kFPDeleteInhibitBit<!--/a--> = 0<!--a-->x100<!--/a-->,
   <!--a-->kFPCopyProtectBit<!--/a--> = 0<!--a-->x400<!--/a-->,
   <!--a-->kFPSetClearBit<!--/a--> = 0<!--a-->x8000<!--/a-->
};
</pre></p><h5 class="tight">Discussion</h5><p>Use the bits in the File Attributes bitmap to inhibit writing, renaming or deleting the file. Other bits in the File Attributes bitmap indicate whether the file needs to be backed up, whether the file can be copied, whether the file is invisible or a system file, whether the file’s data or resource fork is open, and whether the file can be opened at the same time by multiple users. When calling <code><a href="reference.html#//apple_ref/c/func/FPSetFileParms">FPSetFileParms</a></code> and <code><a href="reference.html#//apple_ref/c/func/FPSetFileDirParms">FPSetFileDirParms</a></code> to set File Attributes, use the Set/Clear bit (bit 15) to indicate whether you are setting or clearing a file attribute.</p><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH4-261242">Figure 85</a></span> describes the Attributes bitmap for a file.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH4-261242" title="Figure 85File Attributes bitmap"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-CHDHDDII" title="Figure 85File Attributes bitmap"></a><p><strong>Figure 85&nbsp;&nbsp;</strong>File Attributes bitmap</p><img src = "../Art/afp_092.gif" alt = "File Attributes bitmap" width="215" height="198"></div><br/><a name="//apple_ref/c/tag/FPUnixPrivs" title="FPUnixPrivs"></a><a name="//apple_ref/doc/c_ref/FPUnixPrivs" title="FPUnixPrivs"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-CHDEECGG" title="FPUnixPrivs"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-DontLinkElementID_94"></a><h3 class="tight">FPUnixPrivs</h3><p class="spaceabove">A structure the describes UNIX privileges for files and directories that reside on a volume that supports UNIX privileges.</p><p class="spaceabove"><pre>
struct FPUnixPrivs {
   unsigned long uid;
   unsigned long gid;
   unsigned long permissions;
   unsigned long ua_permissions;
};
</pre></p><h5 class="tight">Fields</h5><dl class="termdef"><dt><code>uid</code></dt><dd><p>User ID of the file or directory’s owner.</p></dd><dt><code>gid</code></dt><dd><p>Group ID of the file or directory’s owner.</p></dd><dt><code>permissions</code></dt><dd><p>Setting of the file or directory’s permission bits.</p></dd><dt><code>ua_permissions</code></dt><dd><p>User’s access rights to the file or directory. Bit 31 is set if the user is the owner of the file or directory.</p></dd></dl><h5 class="tight">Discussion</h5><p>A <code>FPUnixPrivs </code>structure is returned when you call <code><a href="reference.html#//apple_ref/c/func/FPGetFileDirParms">FPGetFileDirParms</a></code> and specify that you want to get the UNIX privileges for a file or directory.</p><a name="//apple_ref/doc/constant_group/Server_Flags_Bitmap" title="Server Flags Bitmap" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-CHDIGHBJ" title="Server Flags Bitmap" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-DontLinkElementID_95"></a><h3 class="tight">Server Flags Bitmap</h3><p class="spaceabove">A 16-bit value that describes server capabilities.</p><p class="spaceabove"><pre>
enum {
   <!--a-->kSupportsCopyfile<!--/a--> = 0<!--a-->x01<!--/a-->,
   <!--a-->kSupportsChgPwd<!--/a--> = 0<!--a-->x02<!--/a-->,
   <!--a-->kDontAllowSavePwd<!--/a--> = 0<!--a-->x04<!--/a-->,
   <!--a-->kSupportsSrvrMsg<!--/a--> = 0<!--a-->x08<!--/a-->,
   <!--a-->kSrvrSig<!--/a--> = 0<!--a-->x10<!--/a-->,
   <!--a-->kSupportsTCP<!--/a--> = 0<!--a-->x20<!--/a-->,
   <!--a-->kSupportsSrvrNotify<!--/a--> = 0<!--a-->x40<!--/a-->,
   <!--a-->kSupportsReconnect<!--/a--> = 0<!--a-->x80<!--/a-->,
   <!--a-->kSupportsDirServices<!--/a--> = 0<!--a-->x100<!--/a-->,
   <!--a-->kSupportsUTF8SrvrName<!--/a--> = 0<!--a-->x200<!--/a-->,
   <!--a-->kSupportsUUIDs<!--/a--> = 0<!--a-->x400<!--/a-->,
   <!--a-->kSupportsSuperClient<!--/a--> = 0<!--a-->x8000<!--/a-->
};
</pre></p><h5 class="tight">Discussion</h5><p>The Server Flags bitmap is returned by the <code><a href="reference.html#//apple_ref/c/func/FPGetSrvrInfo">FPGetSrvrInfo</a></code> command.</p><a name="//apple_ref/doc/constant_group/Volume_Attributes_Bitmap" title="Volume Attributes Bitmap" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-CHDHICFD" title="Volume Attributes Bitmap" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-DontLinkElementID_96"></a><h3 class="tight">Volume Attributes Bitmap</h3><p class="spaceabove">A 16-bit value whose bits describe how a volume is mounted and whether it supports certain AFP features.</p><p class="spaceabove"><pre>
enum {
   <!--a-->kReadOnly<!--/a--> = 0<!--a-->x01<!--/a-->,
   <!--a-->kHasVolumePassword<!--/a--> = 0<!--a-->x02<!--/a-->,
   <!--a-->kSupportsFileIDs<!--/a--> = 0<!--a-->x04<!--/a-->,
   <!--a-->kSupportsCatSearch<!--/a--> = 0<!--a-->x08<!--/a-->,
   <!--a-->kSupportsBlankAccessPrivs<!--/a--> = 0<!--a-->x10<!--/a-->,
   <!--a-->kSupportsUnixPrivs<!--/a--> = 0<!--a-->x20<!--/a-->,
   <!--a-->kSupportsUTF8Names<!--/a--> = 0<!--a-->x40<!--/a-->,
   <!--a-->kNoNetworkUserIDs<!--/a--> = 0<!--a-->x80<!--/a-->,
   <!--a-->kDefaultPrivsFromParent<!--/a--> = 0<!--a-->x10<!--/a-->,
   <!--a-->kNoExchangeFiles<!--/a--> = 0<!--a-->x20<!--/a-->,
   <!--a-->kSupportsExtAttrs<!--/a--> = 0<!--a-->x40<!--/a-->,
   <!--a-->kSupportsACLs<!--/a--> = 0<!--a-->x80<!--/a-->
};
</pre></p><h5 class="tight">Discussion</h5><p><span class="content_text">Figure 86</span> describes the Attributes bitmap for a volume.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH4-322057" title="Figure 86Volume Attributes bitmap"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-CHDHHFCF" title="Figure 86Volume Attributes bitmap"></a><p><strong>Figure 86&nbsp;&nbsp;</strong>Volume Attributes bitmap</p><img src = "../Art/afp_088.gif" alt = "Volume Attributes bitmap" width="341" height="261"></div><br/><a name="//apple_ref/doc/constant_group/Volume_Bitmap" title="Volume Bitmap" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-CHDGJAID" title="Volume Bitmap" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-DontLinkElementID_97"></a><h3 class="tight">Volume Bitmap</h3><p class="spaceabove">A 16-bit value whose bits are used to get and set volume parameters.</p><p class="spaceabove"><pre>
enum {
   <!--a-->kFPBadVolPre222Bitmap<!--/a--> = 0<!--a-->xFe00<!--/a-->,
   <!--a-->kFPBadVolBitmap<!--/a--> = 0<!--a-->xF000<!--/a-->,
   <!--a-->kFPVolAttributeBit<!--/a--> = 0<!--a-->x1<!--/a-->,
   <!--a-->kFPVolSignatureBit<!--/a--> = 0<!--a-->x2<!--/a-->,
   <!--a-->kFPVolCreateDateBit<!--/a--> = 0<!--a-->x4<!--/a-->,
   <!--a-->kFPVolModDateBit<!--/a--> = 0<!--a-->x8<!--/a-->,
   <!--a-->kFPVolBackupDateBit<!--/a--> = 0<!--a-->x10<!--/a-->,
   <!--a-->kFPVolIDBit<!--/a--> = 0<!--a-->x20<!--/a-->,
   <!--a-->kFPVolBytesFreeBit<!--/a--> = 0<!--a-->x40<!--/a-->,
   <!--a-->kFPVolBytesTotalBit<!--/a--> = 0<!--a-->x80<!--/a-->,
   <!--a-->kFPVolNameBit<!--/a--> = 0<!--a-->x100<!--/a-->,
   <!--a-->kFPVolExtBytesFreeBit<!--/a--> = 0<!--a-->x200<!--/a-->,
   <!--a-->kFPVolExtBytesTotalBit<!--/a--> = 0<!--a-->x400<!--/a-->,
   <!--a-->kFPVolBlockSizeBit<!--/a--> = 0<!--a-->x800<!--/a-->
};
</pre></p><h5 class="tight">Discussion</h5><p>The Volume bitmap is used when calling <code><a href="reference.html#//apple_ref/c/func/FPGetVolParms">FPGetVolParms</a></code> to indicate the volume parameters you want to get. It is also used when calling <code><a href="reference.html#//apple_ref/c/func/FPSetVolParms">FPSetVolParms</a></code><code></code> to set a volume’s backup date, which is the only Volume parameter that an AFP client can set. <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40003548-CH4-242236">Figure 87</a></span> describes the Volume bitmap.</p><br/><div><a name="//apple_ref/doc/uid/TP40003548-CH4-242236" title="Figure 87Volume bitmap"></a><a name="//apple_ref/doc/uid/TP40003548-CH4-CHDBIBEJ" title="Figure 87Volume bitmap"></a><p><strong>Figure 87&nbsp;&nbsp;</strong>Volume bitmap</p><img src = "../Art/afp_087.gif" alt = "Volume bitmap" width="260" height="269"></div><br/><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_7" title="Constants"></a><h2>Constants</h2><a name="//apple_ref/doc/constant_group/Access_Control_List_Bitmap" title="Access Control List Bitmap" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-CHDHFJJJ" title="Access Control List Bitmap" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_98"></a><h3 class="tight">Access Control List Bitmap</h3><p class="spaceabove">Bitmap for getting and setting access control lists (ACLs).</p><p class="spaceabove"><pre>
enum {
<a href="reference.html#//apple_ref/doc/c_ref/kFileSec_UUID">kFileSec_UUID</a> = 0<!--a-->x01<!--/a-->,
<a href="reference.html#//apple_ref/doc/c_ref/kFileSec_GRPUUID">kFileSec_GRPUUID</a> = 0<!--a-->x02<!--/a-->,
<a href="reference.html#//apple_ref/doc/c_ref/kFileSec_ACL">kFileSec_ACL</a> = 0<!--a-->x04<!--/a-->,
<a href="reference.html#//apple_ref/doc/c_ref/kFileSec_REMOVEACL">kFileSec_REMOVEACL</a> = 0<!--a-->x08<!--/a-->,
<a href="reference.html#//apple_ref/doc/c_ref/kFileSec_Inherit">kFileSec_Inherit</a> = 0<!--a-->x10<!--/a-->
};
</pre></p><h5 class="tight">Constants</h5><dl class="termdef"><a name="//apple_ref/c/econst/kFileSec_UUID" title="kFileSec_UUID"></a><a name="//apple_ref/doc/c_ref/kFileSec_UUID" title="kFileSec_UUID"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_99"></a><dt><code>kFileSec_UUID</code></dt><dd><p>Set this bit to get or set a UUID.</p></dd><a name="//apple_ref/c/econst/kFileSec_GRPUUID" title="kFileSec_GRPUUID"></a><a name="//apple_ref/doc/c_ref/kFileSec_GRPUUID" title="kFileSec_GRPUUID"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_100"></a><dt><code>kFileSec_GRPUUID</code></dt><dd><p>Set this bit to get or set a Group UUID.</p></dd><a name="//apple_ref/c/econst/kFileSec_ACL" title="kFileSec_ACL"></a><a name="//apple_ref/doc/c_ref/kFileSec_ACL" title="kFileSec_ACL"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_101"></a><dt><code>kFileSec_ACL</code></dt><dd><p>Set this bit to get or set an ACL.</p></dd><a name="//apple_ref/c/econst/kFileSec_REMOVEACL" title="kFileSec_REMOVEACL"></a><a name="//apple_ref/doc/c_ref/kFileSec_REMOVEACL" title="kFileSec_REMOVEACL"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_102"></a><dt><code>kFileSec_REMOVEACL</code></dt><dd><p>Set this bit toremove an ACL. This bit is not valid when used with the <code><a href="reference.html#//apple_ref/c/func/FPGetACL">FPGetACL</a></code>.</p></dd><a name="//apple_ref/c/econst/kFileSec_Inherit" title="kFileSec_Inherit"></a><a name="//apple_ref/doc/c_ref/kFileSec_Inherit" title="kFileSec_Inherit"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_103"></a><dt><code>kFileSec_Inherit</code></dt><dd><p>Set this bit any access control entries (ACEs) that have already been inherited. This constant is used only with the <code><a href="reference.html#//apple_ref/c/func/FPSetACL">FPSetACL</a></code> command.</p></dd></dl><h5 class="tight">Discussion</h5><p>Use the Access Control List bitmap with the <code><a href="reference.html#//apple_ref/c/func/FPGetACL">FPGetACL</a></code> and <code><a href="reference.html#//apple_ref/c/func/FPSetACL">FPSetACL</a></code> commands to control the behavior of those commands.</p><a name="//apple_ref/doc/constant_group/AFP_Version_Strings" title="AFP Version Strings" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-BFAEBCAH" title="AFP Version Strings" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_104"></a><h3 class="tight">AFP Version Strings</h3><p class="spaceabove">Strings that identify different AFP versions.</p><p class="spaceabove"><pre>
"<!--a-->AFPVersion<!--/a--> 2.1"
"AFP2.2"
"AFP2.3"
"AFPX02"
"AFP3.1"
"AFP3.2"
</pre></p><h5 class="tight">Constants</h5><dl class="termdef"><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_105"></a><dt><code>AFPVersion 2.1</code></dt><dd><p>AFP version 2.1.</p></dd><a name="//apple_ref/c/econst/AFP2.2" title="AFP2.2"></a><a name="//apple_ref/doc/c_ref/AFP2.2" title="AFP2.2"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_106"></a><dt><code>AFP2.2</code></dt><dd><p>AFP version 2.2.</p></dd><a name="//apple_ref/c/econst/AFP2.3" title="AFP2.3"></a><a name="//apple_ref/doc/c_ref/AFP2.3" title="AFP2.3"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_107"></a><dt><code>AFP2.3</code></dt><dd><p>AFP version 2.3.</p></dd><a name="//apple_ref/c/econst/AFPX02" title="AFPX02"></a><a name="//apple_ref/doc/c_ref/AFPX02" title="AFPX02"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_108"></a><dt><code>AFPX02</code></dt><dd><p>AFP version 3.0.</p></dd><a name="//apple_ref/c/econst/AFP3.1" title="AFP3.1"></a><a name="//apple_ref/doc/c_ref/AFP3.1" title="AFP3.1"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_109"></a><dt><code>AFP3.1</code></dt><dd><p>AFP version 3.1.</p></dd><a name="//apple_ref/c/econst/AFP3.2" title="AFP3.2"></a><a name="//apple_ref/doc/c_ref/AFP3.2" title="AFP3.2"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_110"></a><dt><code>AFP3.2</code></dt><dd><p>AFP version 3.2.</p></dd></dl><h5 class="tight">Discussion</h5><p>AFP Version strings are returned by the <code><a href="reference.html#//apple_ref/c/func/FPGetSrvrInfo">FPGetSrvrInfo</a></code> command. AFP clients sent an AFP Version string as a parameter to the <code><a href="reference.html#//apple_ref/c/func/FPLogin">FPLogin</a></code> and <code><a href="reference.html#//apple_ref/c/func/FPLoginExt">FPLoginExt</a></code> commands.</p><a name="//apple_ref/doc/constant_group/AFP_UAM_Strings" title="AFP UAM Strings" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-CHDBEBIE" title="AFP UAM Strings" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_111"></a><h3 class="tight">AFP UAM Strings</h3><p class="spaceabove">Strings that identify different UAM versions.</p><p class="spaceabove"><pre>
"<!--a-->No<!--/a--> <!--a-->User<!--/a--> Authent"
"<!--a-->Cleartxt<!--/a--> Passwrd"
"<!--a-->Randnum<!--/a--> Exchange"
"2-<!--a-->Way<!--/a--> Randnum"
"DHCAST128"
"DHX2"
"<!--a-->Client<!--/a--> <!--a-->Krb<!--/a--> v2"
"Recon1"
</pre></p><h5 class="tight">Constants</h5><dl class="termdef"><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_112"></a><dt><code>No User Authent</code></dt><dd><p>UAM that does not require user authentication.</p></dd><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_113"></a><dt><code>Cleartxt Passwrd</code></dt><dd><p>Cleartext Password UAM.</p></dd><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_114"></a><dt><code>Randnum Exchange</code></dt><dd><p>Random Number Exchange UAM.</p></dd><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_115"></a><dt><code>2-Way Randnum</code></dt><dd><p>Two-Way Random Number Exchange UAM.</p></dd><a name="//apple_ref/c/econst/DHCAST128" title="DHCAST128"></a><a name="//apple_ref/doc/c_ref/DHCAST128" title="DHCAST128"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_116"></a><dt><code>DHCAST128</code></dt><dd><p>Diffie-Hellman Exchange UAM to be used during the log process.</p></dd><a name="//apple_ref/c/econst/DHX2" title="DHX2"></a><a name="//apple_ref/doc/c_ref/DHX2" title="DHX2"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_117"></a><dt><code>DHX2</code></dt><dd><p>Causes the Diffie-Hellman Exchange 2 UAM.</p></dd><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_118"></a><dt><code>Client Krb v2</code></dt><dd><p>Kerberos UAM.</p></dd><a name="//apple_ref/c/econst/Recon1" title="Recon1"></a><a name="//apple_ref/doc/c_ref/Recon1" title="Recon1"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_119"></a><dt><code>Recon1</code></dt><dd><p>Reconnect UAM.</p></dd></dl><h5 class="tight">Discussion</h5><p>AFP UAM strings are returned by the <code><a href="reference.html#//apple_ref/c/func/FPGetSrvrInfo">FPGetSrvrInfo</a></code> command. AFP clients sent an AFP UAM string as a parameter to the <code><a href="reference.html#//apple_ref/c/func/FPLogin">FPLogin</a></code> and <code><a href="reference.html#//apple_ref/c/func/FPLoginExt">FPLoginExt</a></code> commands.</p><a name="//apple_ref/doc/constant_group/FPGetSessionToken_Types" title="FPGetSessionToken Types" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-BACEAABC" title="FPGetSessionToken Types" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_120"></a><h3 class="tight">FPGetSessionToken Types</h3><p class="spaceabove">Values for the <code>Type</code> parameter of the <code>FPGetSessionToken</code> command.</p><p class="spaceabove"><pre>
enum {
<a href="reference.html#//apple_ref/doc/c_ref/kLoginWithoutID">kLoginWithoutID</a> = 0,
<a href="reference.html#//apple_ref/doc/c_ref/kLoginWithID">kLoginWithID</a> = 1,
<a href="reference.html#//apple_ref/doc/c_ref/kReconnWithID">kReconnWithID</a> = 2,
<a href="reference.html#//apple_ref/doc/c_ref/kLoginWithTimeAndID">kLoginWithTimeAndID</a> = 3,
<a href="reference.html#//apple_ref/doc/c_ref/kReconnWithTimeAndID">kReconnWithTimeAndID</a> = 4,
<a href="reference.html#//apple_ref/doc/c_ref/kRecon1Login">kRecon1Login</a> = 5,
<a href="reference.html#//apple_ref/doc/c_ref/kRecon1ReconnectLogin">kRecon1ReconnectLogin</a> = 6,
<!--a-->kRecon1Refresh<!--/a--> = 7,
   <a href="reference.html#//apple_ref/doc/c_ref/kGetKerberosSessionKey">kGetKerberosSessionKey</a> = 8
};
</pre></p><h5 class="tight">Constants</h5><dl class="termdef"><a name="//apple_ref/c/econst/kLoginWithoutID" title="kLoginWithoutID"></a><a name="//apple_ref/doc/c_ref/kLoginWithoutID" title="kLoginWithoutID"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_121"></a><dt><code>kLoginWithoutID</code></dt><dd><p>The <code>FPGetSessionToken</code> parameter block does not contain an <code>ID</code> parameter; specified by AFP clients that support a version of AFP prior to AFP 3.1.</p></dd><a name="//apple_ref/c/econst/kLoginWithID" title="kLoginWithID"></a><a name="//apple_ref/doc/c_ref/kLoginWithID" title="kLoginWithID"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_122"></a><dt><code>kLoginWithID</code></dt><dd><p>Deprecated.</p></dd><a name="//apple_ref/c/econst/kReconnWithID" title="kReconnWithID"></a><a name="//apple_ref/doc/c_ref/kReconnWithID" title="kReconnWithID"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_123"></a><dt><code>kReconnWithID</code></dt><dd><p>Deprecated.</p></dd><a name="//apple_ref/c/econst/kLoginWithTimeAndID" title="kLoginWithTimeAndID"></a><a name="//apple_ref/doc/c_ref/kLoginWithTimeAndID" title="kLoginWithTimeAndID"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_124"></a><dt><code>kLoginWithTimeAndID</code></dt><dd><p>The <code>FPGetSessionToken</code> parameter block contains an <code>ID</code> and a time stamp parameter. The command is sent to indicate that the client wants its old session to be discarded.</p></dd><a name="//apple_ref/c/econst/kReconnWithTimeAndID" title="kReconnWithTimeAndID"></a><a name="//apple_ref/doc/c_ref/kReconnWithTimeAndID" title="kReconnWithTimeAndID"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_125"></a><dt><code>kReconnWithTimeAndID</code></dt><dd><p>The <code>FPGetSessionToken</code> parameter block contains an <code>ID</code> and a time stamp parameter. The command is sent to indicate that the client has successfully reconnected and wants the session to be updated with the new value of <code>ID</code>.</p></dd><a name="//apple_ref/c/econst/kRecon1Login" title="kRecon1Login"></a><a name="//apple_ref/doc/c_ref/kRecon1Login" title="kRecon1Login"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_126"></a><dt><code>kRecon1Login</code></dt><dd><p>Used after logging in to get a credential that can be used to reconnect using the Reconnect UAM. Specifying <code>kRecon1Login</code> tells the server to destroy any old sessions that may be associated with the <code>ID </code>parameter to the <code>FPGetSessionToken</code> command.</p></dd><a name="//apple_ref/c/econst/kRecon1ReconnectLogin" title="kRecon1ReconnectLogin"></a><a name="//apple_ref/doc/c_ref/kRecon1ReconnectLogin" title="kRecon1ReconnectLogin"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_127"></a><dt><code>kRecon1ReconnectLogin</code></dt><dd><p>Used to get a new reconnect token after reconnecting using the Reconnect UAM.</p></dd><a name="//apple_ref/c/econst/kRecon1RefreshToken" title="kRecon1RefreshToken"></a><a name="//apple_ref/doc/c_ref/kRecon1RefreshToken" title="kRecon1RefreshToken"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_128"></a><dt><code>kRecon1RefreshToken</code></dt><dd><p>Used to get a new credential when the current credential is about to expire.</p></dd><a name="//apple_ref/c/econst/kGetKerberosSessionKey" title="kGetKerberosSessionKey"></a><a name="//apple_ref/doc/c_ref/kGetKerberosSessionKey" title="kGetKerberosSessionKey"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_129"></a><dt><code>kGetKerberosSessionKey</code></dt><dd><p>Used to get a Kerberos v5 session key.</p></dd></dl><h5 class="tight">Discussion</h5><p>The value of the <code>Type</code> parameter determines the behavior of the server when it receives the<code><a href="reference.html#//apple_ref/c/func/FPGetSessionToken">FPGetSessionToken</a></code> command.</p><a name="//apple_ref/doc/constant_group/FPMapID_Constants" title="FPMapID Constants" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_2" title="FPMapID Constants" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_130"></a><h3 class="tight">FPMapID Constants</h3><p class="spaceabove">Values used in the <code>Subfunction</code> parameter of the <code>FPMapID</code> command.</p><p class="spaceabove"><pre>
enum {
<a href="reference.html#//apple_ref/doc/c_ref/kUserIDToName">kUserIDToName</a> = 1,
<a href="reference.html#//apple_ref/doc/c_ref/kGroupIDToName">kGroupIDToName</a> = 2,
<a href="reference.html#//apple_ref/doc/c_ref/kUserIDToUTF8Name">kUserIDToUTF8Name</a> = 3,
<a href="reference.html#//apple_ref/doc/c_ref/kGroupIDToUTF8Name">kGroupIDToUTF8Name</a> = 4,
<a href="reference.html#//apple_ref/doc/c_ref/kUserUUIDToUTF8Name">kUserUUIDToUTF8Name</a> = 5,
<a href="reference.html#//apple_ref/doc/c_ref/kGroupUUIDToUTF8Name">kGroupUUIDToUTF8Name</a> = 6
};
</pre></p><h5 class="tight">Constants</h5><dl class="termdef"><a name="//apple_ref/c/econst/kUserIDToName" title="kUserIDToName"></a><a name="//apple_ref/doc/c_ref/kUserIDToName" title="kUserIDToName"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_131"></a><dt><code>kUserIDToName</code></dt><dd><p>Causes <code>FPMapID</code> to map the specified User ID to its respective Macintosh Roman user name.</p></dd><a name="//apple_ref/c/econst/kGroupIDToName" title="kGroupIDToName"></a><a name="//apple_ref/doc/c_ref/kGroupIDToName" title="kGroupIDToName"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_132"></a><dt><code>kGroupIDToName</code></dt><dd><p>Causes <code>FPMapID</code> to map the specified Group ID to its respective Macintosh Roman group name.</p></dd><a name="//apple_ref/c/econst/kUserIDToUTF8Name" title="kUserIDToUTF8Name"></a><a name="//apple_ref/doc/c_ref/kUserIDToUTF8Name" title="kUserIDToUTF8Name"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_133"></a><dt><code>kUserIDToUTF8Name</code></dt><dd><p>Causes <code>FPMapID</code> to map the specified User ID to its respective user name in UTF-8 encoding.</p></dd><a name="//apple_ref/c/econst/kGroupIDToUTF8Name" title="kGroupIDToUTF8Name"></a><a name="//apple_ref/doc/c_ref/kGroupIDToUTF8Name" title="kGroupIDToUTF8Name"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_134"></a><dt><code>kGroupIDToUTF8Name</code></dt><dd><p>Causes <code>FPMapID</code> to map the specified Group ID to its respective group name in UTF-8 encoding.</p></dd><a name="//apple_ref/c/econst/kUserUUIDToUTF8Name" title="kUserUUIDToUTF8Name"></a><a name="//apple_ref/doc/c_ref/kUserUUIDToUTF8Name" title="kUserUUIDToUTF8Name"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_135"></a><dt><code>kUserUUIDToUTF8Name</code></dt><dd><p>Causes <code>FPMapID</code> to map the specified User UUID to its respective user name in UTF-8 encoding.</p></dd><a name="//apple_ref/c/econst/kGroupUUIDToUTF8Name" title="kGroupUUIDToUTF8Name"></a><a name="//apple_ref/doc/c_ref/kGroupUUIDToUTF8Name" title="kGroupUUIDToUTF8Name"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_136"></a><dt><code>kGroupUUIDToUTF8Name</code></dt><dd><p>Causes <code>FPMapID</code> to map the specified Group UUID to its respective group name in UTF-8 encoding.</p></dd></dl><h5 class="tight">Discussion</h5><p>These constants are used with the <code>FPMapID</code> command to indicate the way in which mapping is to occur.</p><a name="//apple_ref/doc/constant_group/FPMapName_Constants" title="FPMapName Constants" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_3" title="FPMapName Constants" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_137"></a><h3 class="tight">FPMapName Constants</h3><p class="spaceabove">Values used in the <code>Subfunction</code> parameter of the <code>FPMapID</code> command.</p><p class="spaceabove"><pre>
enum {
<a href="reference.html#//apple_ref/doc/c_ref/kNameToUserID">kNameToUserID</a> = 1,
<a href="reference.html#//apple_ref/doc/c_ref/kNameToGroupID">kNameToGroupID</a> = 2,
<a href="reference.html#//apple_ref/doc/c_ref/kUTF8NameToUserID">kUTF8NameToUserID</a> = 3,
<a href="reference.html#//apple_ref/doc/c_ref/kUTF8NameToGroupID">kUTF8NameToGroupID</a> = 4,
<a href="reference.html#//apple_ref/doc/c_ref/kUTF8NameToUserUUID">kUTF8NameToUserUUID</a> = 5,
<a href="reference.html#//apple_ref/doc/c_ref/kUTF8NameToGroupUUID">kUTF8NameToGroupUUID</a> = 6
};
</pre></p><h5 class="tight">Constants</h5><dl class="termdef"><a name="//apple_ref/c/econst/kNameToUserID" title="kNameToUserID"></a><a name="//apple_ref/doc/c_ref/kNameToUserID" title="kNameToUserID"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_138"></a><dt><code>kNameToUserID</code></dt><dd><p>Causes <code>FPMapName</code> to map the specified Macintosh Roman user name to its respective User ID.</p></dd><a name="//apple_ref/c/econst/kNameToGroupID" title="kNameToGroupID"></a><a name="//apple_ref/doc/c_ref/kNameToGroupID" title="kNameToGroupID"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_139"></a><dt><code>kNameToGroupID</code></dt><dd><p>Causes <code>FPMapName</code> to map the specified Macintosh Roman Group name to its respective Group ID.</p></dd><a name="//apple_ref/c/econst/kUTF8NameToUserID" title="kUTF8NameToUserID"></a><a name="//apple_ref/doc/c_ref/kUTF8NameToUserID" title="kUTF8NameToUserID"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_140"></a><dt><code>kUTF8NameToUserID</code></dt><dd><p>Causes <code>FPMapName</code> to map the specified UTF-8-encoded user name to its respective User ID.</p></dd><a name="//apple_ref/c/econst/kUTF8NameToGroupID" title="kUTF8NameToGroupID"></a><a name="//apple_ref/doc/c_ref/kUTF8NameToGroupID" title="kUTF8NameToGroupID"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_141"></a><dt><code>kUTF8NameToGroupID</code></dt><dd><p>Causes <code>FPMapName</code> to map the specified UTF-8-encoded group name to its respective Group ID.</p></dd><a name="//apple_ref/c/econst/kUTF8NameToUserUUID" title="kUTF8NameToUserUUID"></a><a name="//apple_ref/doc/c_ref/kUTF8NameToUserUUID" title="kUTF8NameToUserUUID"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_142"></a><dt><code>kUTF8NameToUserUUID</code></dt><dd><p>Causes <code>FPMapName</code> to map the specified UTF-8-encoded user name to its respective user UUID.</p></dd><a name="//apple_ref/c/econst/kUTF8NameToGroupUUID" title="kUTF8NameToGroupUUID"></a><a name="//apple_ref/doc/c_ref/kUTF8NameToGroupUUID" title="kUTF8NameToGroupUUID"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_143"></a><dt><code>kUTF8NameToGroupUUID</code></dt><dd><p>Causes <code>FPMapName</code> to map the specified UTF-8-encoded user name to its respective Group UUID.</p></dd></dl><h5 class="tight">Discussion</h5><p>These constants are used with the <code>FPMapName</code> command to indicate the way in which mapping is to occur.</p><a name="//apple_ref/doc/constant_group/Path_Type_Constants" title="Path Type Constants" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-CHDEEHIH" title="Path Type Constants" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_144"></a><h3 class="tight">Path Type Constants</h3><p class="spaceabove">Constants indicating the type of names in a <code>Pathname</code><code></code> parameter</p><p class="spaceabove"><pre>
enum {
<a href="reference.html#//apple_ref/doc/c_ref/kFPShortName">kFPShortName</a> = 1,
<a href="reference.html#//apple_ref/doc/c_ref/kFPLongName">kFPLongName</a> = 2,
<a href="reference.html#//apple_ref/doc/c_ref/kFPUTF8Name">kFPUTF8Name</a> = 3
};
</pre></p><h5 class="tight">Constants</h5><dl class="termdef"><a name="//apple_ref/c/econst/kFPShortName" title="kFPShortName"></a><a name="//apple_ref/doc/c_ref/kFPShortName" title="kFPShortName"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_145"></a><dt><code>kFPShortName</code></dt><dd><p>Indicates that a <code>Pathname</code> parameter contains Short Names.</p></dd><a name="//apple_ref/c/econst/kFPLongName" title="kFPLongName"></a><a name="//apple_ref/doc/c_ref/kFPLongName" title="kFPLongName"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_146"></a><dt><code>kFPLongName</code></dt><dd><p>Indicates that a <code>Pathname</code> parameter contains Long Names.</p></dd><a name="//apple_ref/c/econst/kFPUTF8Name" title="kFPUTF8Name"></a><a name="//apple_ref/doc/c_ref/kFPUTF8Name" title="kFPUTF8Name"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_147"></a><dt><code>kFPUTF8Name</code></dt><dd><p>Indicates that a <code>Pathname </code>parameter contains an AFPName, which consists of a four-byte text encoding hint followed a two-byte length, followed by a UTF-8– encoded pathname.</p></dd></dl><h5 class="tight">Discussion</h5><p>These constants are used in the <code>PathType</code> parameter for many AFP commands to specify the type of names that appear in an associated <code>Pathname</code> parameter.</p><a name="//apple_ref/doc/constant_group/File_Creation_Constants" title="File Creation Constants" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_4" title="File Creation Constants" role="Enum"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_148"></a><h3 class="tight">File Creation Constants</h3><p class="spaceabove">Constants used when creating files.</p><p class="spaceabove"><pre>
enum {
<a href="reference.html#//apple_ref/doc/c_ref/kFPSoftCreate">kFPSoftCreate</a> = 0,
<!--a-->kFPHardCreate<!--/a--> = 0<!--a-->x80<!--/a-->
};
</pre></p><h5 class="tight">Constants</h5><dl class="termdef"><a name="//apple_ref/c/econst/kFPSoftCreate" title="kFPSoftCreate"></a><a name="//apple_ref/doc/c_ref/kFPSoftCreate" title="kFPSoftCreate"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_149"></a><dt><code>kFPSoftCreate</code></dt><dd><p>Indicates soft creation.</p></dd><a name="//apple_ref/c/econst/kFPLongCreate" title="kFPLongCreate"></a><a name="//apple_ref/doc/c_ref/kFPLongCreate" title="kFPLongCreate"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_150"></a><dt><code>kFPLongCreate</code></dt><dd><p>Indicates indicates hard creation.</p></dd></dl><h5 class="tight">Discussion</h5><p>These constants are used in the <code>Flag</code> parameter for the <code><a href="reference.html#//apple_ref/c/func/FPCreateFile">FPCreateFile</a></code> command.</p><a name="//apple_ref/doc/constant_group/ACL_Access_Rights" title="ACL Access Rights" role="PoundDefineGroup"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-CHDFJHJF" title="ACL Access Rights" role="PoundDefineGroup"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_151"></a><h3 class="tight">ACL Access Rights</h3><p class="spaceabove">Access rights bit definitions.</p><p class="spaceabove"><pre>
   #define <!--a-->KAUTH_VNDOE_READ_DATA<!--/a--> <!--a-->(1&lt<!--/a-->;&lt;1)
   #define <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_LIST_DIRECTORY">KAUTH_VNODE_LIST_DIRECTORY</a> <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_READ_DATA">KAUTH_VNODE_READ_DATA</a>
   #define <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_WRITE_DATA">KAUTH_VNODE_WRITE_DATA</a> <!--a-->(1&lt<!--/a-->;&lt;2)
   #define <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_ADD_FILE">KAUTH_VNODE_ADD_FILE</a> <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_WRITE_DATA">KAUTH_VNODE_WRITE_DATA</a>
   #define <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_EXECUTE">KAUTH_VNODE_EXECUTE</a> <!--a-->(1&lt<!--/a-->;&lt;3)
   #define <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_SEARCH">KAUTH_VNODE_SEARCH</a> <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_EXECUTE">KAUTH_VNODE_EXECUTE</a>
   #define <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_DELETE">KAUTH_VNODE_DELETE</a> <!--a-->(1&lt<!--/a-->;&lt;4)
   #define <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_APPEND_DATA">KAUTH_VNODE_APPEND_DATA</a> <!--a-->(1&lt<!--/a-->;&lt;5)
   #define <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_ADD_SUBDIRECTORY">KAUTH_VNODE_ADD_SUBDIRECTORY</a> <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_APPEND_DATA">KAUTH_VNODE_APPEND_DATA</a>
   #define <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_DELETE_CHILD">KAUTH_VNODE_DELETE_CHILD</a> <!--a-->(1&lt<!--/a-->;&lt;6)
   #define <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_READ_ATTRIBUTES">KAUTH_VNODE_READ_ATTRIBUTES</a> <!--a-->(1&lt<!--/a-->;&lt;7)
   #define <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_WRITE_ATTRIBUTES">KAUTH_VNODE_WRITE_ATTRIBUTES</a> <!--a-->(1&lt<!--/a-->;&lt;8)
   #define <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_READ_EXTATTRIBUTES">KAUTH_VNODE_READ_EXTATTRIBUTES</a> <!--a-->(1&lt<!--/a-->;&lt;9)
   #define <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_WRITE_EXTATTRIBUTES">KAUTH_VNODE_WRITE_EXTATTRIBUTES</a> <!--a-->(1&lt<!--/a-->;&lt;10)
   #define <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_READ_SECURITY">KAUTH_VNODE_READ_SECURITY</a> <!--a-->(1&lt<!--/a-->;&lt;11)
   #define <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_WRITE_SECURITY">KAUTH_VNODE_WRITE_SECURITY</a> <!--a-->(1&lt<!--/a-->;&lt;12)
   #define <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_CHANGE_OWNER">KAUTH_VNODE_CHANGE_OWNER</a> <!--a-->(1&lt<!--/a-->;&lt;13)
   #define <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_SYNCHRONIZE">KAUTH_VNODE_SYNCHRONIZE</a> <!--a-->(1&lt<!--/a-->;&lt;20)
   #define <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_GENERIC_ALL">KAUTH_VNODE_GENERIC_ALL</a> <!--a-->(1&lt<!--/a-->;&lt;21)
   #define <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_GENERIC_EXECUTE">KAUTH_VNODE_GENERIC_EXECUTE</a> <!--a-->(1&lt<!--/a-->;&lt;22)
   #define <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_GENERIC_WRITE">KAUTH_VNODE_GENERIC_WRITE</a> <!--a-->(1&lt<!--/a-->;&lt;23)
   #define <a href="reference.html#//apple_ref/doc/c_ref/KAUTH_VNODE_GENERIC_READ">KAUTH_VNODE_GENERIC_READ</a> <!--a-->(1&lt<!--/a-->;&lt;24)
</pre></p><h5 class="tight">Constants</h5><dl class="termdef"><a name="//apple_ref/c/macro/KAUTH_VNODE_READ_DATA" title="KAUTH_VNODE_READ_DATA"></a><a name="//apple_ref/doc/c_ref/KAUTH_VNODE_READ_DATA" title="KAUTH_VNODE_READ_DATA"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_152"></a><dt><code>KAUTH_VNODE_READ_DATA</code></dt><dd><p>For a file, the right to read a file’s data; for a directory, the right to list the contents of a directory.</p></dd><a name="//apple_ref/c/macro/KAUTH_VNODE_LIST_DIRECTORY" title="KAUTH_VNODE_LIST_DIRECTORY"></a><a name="//apple_ref/doc/c_ref/KAUTH_VNODE_LIST_DIRECTORY" title="KAUTH_VNODE_LIST_DIRECTORY"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_153"></a><dt><code>KAUTH_VNODE_LIST_DIRECTORY</code></dt><dd><p>For a directory, the same as <code>KAUTH_VNODE_LIST_DIRECTORY</code>, which is the right to list the contents of a directory.</p></dd><a name="//apple_ref/c/macro/KAUTH_VNODE_WRITE_DATA" title="KAUTH_VNODE_WRITE_DATA"></a><a name="//apple_ref/doc/c_ref/KAUTH_VNODE_WRITE_DATA" title="KAUTH_VNODE_WRITE_DATA"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_154"></a><dt><code>KAUTH_VNODE_WRITE_DATA</code></dt><dd><p>For a file, the right to write to a file; for a directory, the right to create a file in a directory.</p></dd><a name="//apple_ref/c/macro/KAUTH_VNODE_ADD_FILE" title="KAUTH_VNODE_ADD_FILE"></a><a name="//apple_ref/doc/c_ref/KAUTH_VNODE_ADD_FILE" title="KAUTH_VNODE_ADD_FILE"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_155"></a><dt><code>KAUTH_VNODE_ADD_FILE</code></dt><dd><p>For a file, the same as <code>KAUTH_VNODE_WRITE_DATA</code>; the right to write to a file.</p></dd><a name="//apple_ref/c/macro/KAUTH_VNODE_EXECUTE" title="KAUTH_VNODE_EXECUTE"></a><a name="//apple_ref/doc/c_ref/KAUTH_VNODE_EXECUTE" title="KAUTH_VNODE_EXECUTE"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_156"></a><dt><code>KAUTH_VNODE_EXECUTE</code></dt><dd><p>Right to execute a program.</p></dd><a name="//apple_ref/c/macro/KAUTH_VNODE_SEARCH" title="KAUTH_VNODE_SEARCH"></a><a name="//apple_ref/doc/c_ref/KAUTH_VNODE_SEARCH" title="KAUTH_VNODE_SEARCH"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_157"></a><dt><code>KAUTH_VNODE_SEARCH</code></dt><dd><p>Same as <code>KAUTH_VNODE_EXECUTE</code>.</p></dd><a name="//apple_ref/c/macro/KAUTH_VNODE_DELETE" title="KAUTH_VNODE_DELETE"></a><a name="//apple_ref/doc/c_ref/KAUTH_VNODE_DELETE" title="KAUTH_VNODE_DELETE"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_158"></a><dt><code>KAUTH_VNODE_DELETE</code></dt><dd><p>Right to delete a file.</p></dd><a name="//apple_ref/c/macro/KAUTH_VNODE_APPEND_DATA" title="KAUTH_VNODE_APPEND_DATA"></a><a name="//apple_ref/doc/c_ref/KAUTH_VNODE_APPEND_DATA" title="KAUTH_VNODE_APPEND_DATA"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_159"></a><dt><code>KAUTH_VNODE_APPEND_DATA</code></dt><dd><p>For a file, the right to append data to a file; for a directory, the right to create a subdirectory in a directory.</p></dd><a name="//apple_ref/c/macro/KAUTH_VNODE_ADD_SUBDIRECTORY" title="KAUTH_VNODE_ADD_SUBDIRECTORY"></a><a name="//apple_ref/doc/c_ref/KAUTH_VNODE_ADD_SUBDIRECTORY" title="KAUTH_VNODE_ADD_SUBDIRECTORY"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_160"></a><dt><code>KAUTH_VNODE_ADD_SUBDIRECTORY</code></dt><dd><p>For a directory, the same as <code>kAUTH_VNODE_APPEND_DATA</code>, which is the right to create a subdirectory in a directory.</p></dd><a name="//apple_ref/c/macro/KAUTH_VNODE_DELETE_CHILD" title="KAUTH_VNODE_DELETE_CHILD"></a><a name="//apple_ref/doc/c_ref/KAUTH_VNODE_DELETE_CHILD" title="KAUTH_VNODE_DELETE_CHILD"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_161"></a><dt><code>KAUTH_VNODE_DELETE_CHILD</code></dt><dd><p>Right to delete a directory and all the files it contains.</p></dd><a name="//apple_ref/c/macro/KAUTH_VNODE_READ_ATTRIBUTES" title="KAUTH_VNODE_READ_ATTRIBUTES"></a><a name="//apple_ref/doc/c_ref/KAUTH_VNODE_READ_ATTRIBUTES" title="KAUTH_VNODE_READ_ATTRIBUTES"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_162"></a><dt><code>KAUTH_VNODE_READ_ATTRIBUTES</code></dt><dd><p>Right to read a file’s hidden attributes, such as hidden, read-only, system, and archive.</p></dd><a name="//apple_ref/c/macro/KAUTH_VNODE_WRITE_ATTRIBUTES" title="KAUTH_VNODE_WRITE_ATTRIBUTES"></a><a name="//apple_ref/doc/c_ref/KAUTH_VNODE_WRITE_ATTRIBUTES" title="KAUTH_VNODE_WRITE_ATTRIBUTES"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_163"></a><dt><code>KAUTH_VNODE_WRITE_ATTRIBUTES</code></dt><dd><p>Right to write a file’s attributes, such as hidden, read-only, system, and archive.</p></dd><a name="//apple_ref/c/macro/KAUTH_VNODE_READ_EXTATTRIBUTES" title="KAUTH_VNODE_READ_EXTATTRIBUTES"></a><a name="//apple_ref/doc/c_ref/KAUTH_VNODE_READ_EXTATTRIBUTES" title="KAUTH_VNODE_READ_EXTATTRIBUTES"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_164"></a><dt><code>KAUTH_VNODE_READ_EXTATTRIBUTES</code></dt><dd><p>Right to read a file or directory’s extended attributes.</p></dd><a name="//apple_ref/c/macro/KAUTH_VNODE_WRITE_EXTATTRIBUTES" title="KAUTH_VNODE_WRITE_EXTATTRIBUTES"></a><a name="//apple_ref/doc/c_ref/KAUTH_VNODE_WRITE_EXTATTRIBUTES" title="KAUTH_VNODE_WRITE_EXTATTRIBUTES"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_165"></a><dt><code>KAUTH_VNODE_WRITE_EXTATTRIBUTES</code></dt><dd><p>Right to write extended attributes.</p></dd><a name="//apple_ref/c/macro/KAUTH_VNODE_READ_SECURITY" title="KAUTH_VNODE_READ_SECURITY"></a><a name="//apple_ref/doc/c_ref/KAUTH_VNODE_READ_SECURITY" title="KAUTH_VNODE_READ_SECURITY"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_166"></a><dt><code>KAUTH_VNODE_READ_SECURITY</code></dt><dd><p>Right to get a file or directory’s access rights.</p></dd><a name="//apple_ref/c/macro/KAUTH_VNODE_WRITE_SECURITY" title="KAUTH_VNODE_WRITE_SECURITY"></a><a name="//apple_ref/doc/c_ref/KAUTH_VNODE_WRITE_SECURITY" title="KAUTH_VNODE_WRITE_SECURITY"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_167"></a><dt><code>KAUTH_VNODE_WRITE_SECURITY</code></dt><dd><p>Right to set a file or directory’s access rights.</p></dd><a name="//apple_ref/c/macro/KAUTH_VNODE_CHANGE_OWNER" title="KAUTH_VNODE_CHANGE_OWNER"></a><a name="//apple_ref/doc/c_ref/KAUTH_VNODE_CHANGE_OWNER" title="KAUTH_VNODE_CHANGE_OWNER"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_168"></a><dt><code>KAUTH_VNODE_CHANGE_OWNER</code></dt><dd><p>Right to change the owner of a file or directory.</p></dd><a name="//apple_ref/c/macro/KAUTH_VNODE_SYNCHRONIZE" title="KAUTH_VNODE_SYNCHRONIZE"></a><a name="//apple_ref/doc/c_ref/KAUTH_VNODE_SYNCHRONIZE" title="KAUTH_VNODE_SYNCHRONIZE"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_169"></a><dt><code>KAUTH_VNODE_SYNCHRONIZE</code></dt><dd><p>Right to block until the file or directory is put in the signaled state; provided for Windows interoperability.</p></dd><a name="//apple_ref/c/macro/KAUTH_VNODE_GENERIC_ALL" title="KAUTH_VNODE_GENERIC_ALL"></a><a name="//apple_ref/doc/c_ref/KAUTH_VNODE_GENERIC_ALL" title="KAUTH_VNODE_GENERIC_ALL"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_170"></a><dt><code>KAUTH_VNODE_GENERIC_ALL</code></dt><dd><p>Windows NT right that includes all rights specified by <code>KAUTH_VNODE_GENERIC_EXECUTE</code>, <code>KAUTH_VNODE_GENERIC_WRITE</code>, and <code>KAUTH_VNODE_GENERIC_READ</code>.</p></dd><a name="//apple_ref/c/macro/KAUTH_VNODE_GENERIC_EXECUTE" title="KAUTH_VNODE_GENERIC_EXECUTE"></a><a name="//apple_ref/doc/c_ref/KAUTH_VNODE_GENERIC_EXECUTE" title="KAUTH_VNODE_GENERIC_EXECUTE"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_171"></a><dt><code>KAUTH_VNODE_GENERIC_EXECUTE</code></dt><dd><p>Windows NT right that in Windows 2000 became the right to read attributes, read permissions, traverse folders, and execute files.</p></dd><a name="//apple_ref/c/macro/KAUTH_VNODE_GENERIC_WRITE" title="KAUTH_VNODE_GENERIC_WRITE"></a><a name="//apple_ref/doc/c_ref/KAUTH_VNODE_GENERIC_WRITE" title="KAUTH_VNODE_GENERIC_WRITE"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_172"></a><dt><code>KAUTH_VNODE_GENERIC_WRITE</code></dt><dd><p>Windows NT right that in Windows 2000 became right to read access rights, create a subdirectory in a directory, write data in a file, create files in a directory, append data to a file, write attributes, and write extended attributes.</p></dd><a name="//apple_ref/c/macro/KAUTH_VNODE_GENERIC_READ" title="KAUTH_VNODE_GENERIC_READ"></a><a name="//apple_ref/doc/c_ref/KAUTH_VNODE_GENERIC_READ" title="KAUTH_VNODE_GENERIC_READ"></a><a name="//apple_ref/doc/uid/TP40003548-CH5-DontLinkElementID_173"></a><dt><code>KAUTH_VNODE_GENERIC_READ</code></dt><dd><p>Windows NT right that in Windows 2000 became right to list directories, read file data, read attributes, read extended attributes, and read access rights.</p></dd></dl><h5 class="tight">Discussion</h5><p>These definitions are made in <code>kauth.h</code>. Use these definitions to specify access rights when calling <code><a href="reference.html#//apple_ref/c/func/FPAccess">FPAccess</a></code>, to parse the access rights returned by <code><a href="reference.html#//apple_ref/c/func/FPGetACL">FPGetACL</a></code>, and to set access rights when calling <code><a href="reference.html#//apple_ref/c/func/FPSetExtAttr">FPSetExtAttr</a></code>.</p><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_8" title="Result Codes"></a><h2>Result Codes</h2><p>The result codes specific to the Apple Filing Protocol are listed in the table below.</p><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><tr><th scope="col" align="left"><strong>Result Code</strong></th><th scope="col" align="left"><strong>Value</strong></th><th scope="col" align="left"><strong>Description</strong></th></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kASPSessClosed" title="kASPSessClosed"></a><a name="//apple_ref/doc/c_ref/kASPSessClosed" title="kASPSessClosed"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_174"></a><code>kASPSessClosed</code></td><td align="right" valign="top" class="content_text noWrap">-1072</td><td valign="top" class="content_text"><p>ASP session closed.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPAccessDenied" title="kFPAccessDenied"></a><a name="//apple_ref/doc/c_ref/kFPAccessDenied" title="kFPAccessDenied"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_175"></a><code>kFPAccessDenied</code></td><td align="right" valign="top" class="content_text noWrap">-5000</td><td valign="top" class="content_text"><p>User does not have the access privileges required to use the command.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPAuthContinue" title="kFPAuthContinue"></a><a name="//apple_ref/doc/c_ref/kFPAuthContinue" title="kFPAuthContinue"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_176"></a><code>kFPAuthContinue</code></td><td align="right" valign="top" class="content_text noWrap">-5001</td><td valign="top" class="content_text"><p>Authentication is not yet complete.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPBadUAM" title="kFPBadUAM"></a><a name="//apple_ref/doc/c_ref/kFPBadUAM" title="kFPBadUAM"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_177"></a><code>kFPBadUAM</code></td><td align="right" valign="top" class="content_text noWrap">-5002</td><td valign="top" class="content_text"><p>Specified UAM is unknown</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPBadVersNum" title="kFPBadVersNum"></a><a name="//apple_ref/doc/c_ref/kFPBadVersNum" title="kFPBadVersNum"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_178"></a><code>kFPBadVersNum</code></td><td align="right" valign="top" class="content_text noWrap">-5003</td><td valign="top" class="content_text"><p>Server does not support the specified AFP version.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPBitmapErr" title="kFPBitmapErr"></a><a name="//apple_ref/doc/c_ref/kFPBitmapErr" title="kFPBitmapErr"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_179"></a><code>kFPBitmapErr</code></td><td align="right" valign="top" class="content_text noWrap">-5004</td><td valign="top" class="content_text"><p>Attempt was made to get or set a parameter that cannot be obtained or set with this command, or a required bitmap is null</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPCantMove" title="kFPCantMove"></a><a name="//apple_ref/doc/c_ref/kFPCantMove" title="kFPCantMove"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_180"></a><code>kFPCantMove</code></td><td align="right" valign="top" class="content_text noWrap">-5005</td><td valign="top" class="content_text"><p>Attempt was made to move a directory into one of its descendent directories.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPDenyConflict" title="kFPDenyConflict"></a><a name="//apple_ref/doc/c_ref/kFPDenyConflict" title="kFPDenyConflict"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_181"></a><code>kFPDenyConflict</code></td><td align="right" valign="top" class="content_text noWrap">-5006</td><td valign="top" class="content_text"><p>Specified fork cannot be opened because of a deny modes conflict.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPDirNotEmpty" title="kFPDirNotEmpty"></a><a name="//apple_ref/doc/c_ref/kFPDirNotEmpty" title="kFPDirNotEmpty"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_182"></a><code>kFPDirNotEmpty</code></td><td align="right" valign="top" class="content_text noWrap">-5007</td><td valign="top" class="content_text"><p>Directory is not empty.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPDiskFull" title="kFPDiskFull"></a><a name="//apple_ref/doc/c_ref/kFPDiskFull" title="kFPDiskFull"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_183"></a><code>kFPDiskFull</code></td><td align="right" valign="top" class="content_text noWrap">-5008</td><td valign="top" class="content_text"><p>No more space exists on the volume</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPEOFErr" title="kFPEOFErr"></a><a name="//apple_ref/doc/c_ref/kFPEOFErr" title="kFPEOFErr"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_184"></a><code>kFPEOFErr</code></td><td align="right" valign="top" class="content_text noWrap">-5009</td><td valign="top" class="content_text"><p>No more matches or end of fork reached.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPFileBusy" title="kFPFileBusy"></a><a name="//apple_ref/doc/c_ref/kFPFileBusy" title="kFPFileBusy"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_185"></a><code>kFPFileBusy</code></td><td align="right" valign="top" class="content_text noWrap">-5010</td><td valign="top" class="content_text"><p>When attempting a hard create, the file already exists and is open.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPFlatVol" title="kFPFlatVol"></a><a name="//apple_ref/doc/c_ref/kFPFlatVol" title="kFPFlatVol"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_186"></a><code>kFPFlatVol</code></td><td align="right" valign="top" class="content_text noWrap">-5011</td><td valign="top" class="content_text"><p>Volume is flat and does not support directories.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPItemNotFound" title="kFPItemNotFound"></a><a name="//apple_ref/doc/c_ref/kFPItemNotFound" title="kFPItemNotFound"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_187"></a><code>kFPItemNotFound</code></td><td align="right" valign="top" class="content_text noWrap">-5012</td><td valign="top" class="content_text"><p>Specified APPL mapping, comment, or icon was not found in the Desktop database; specified ID is unknown.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPLockErr" title="kFPLockErr"></a><a name="//apple_ref/doc/c_ref/kFPLockErr" title="kFPLockErr"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_188"></a><code>kFPLockErr</code></td><td align="right" valign="top" class="content_text noWrap">-5013</td><td valign="top" class="content_text"><p>Some or all of the requested range is locked by another user; a lock range conflict exists.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPMiscErr" title="kFPMiscErr"></a><a name="//apple_ref/doc/c_ref/kFPMiscErr" title="kFPMiscErr"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_189"></a><code>kFPMiscErr</code></td><td align="right" valign="top" class="content_text noWrap">-5014</td><td valign="top" class="content_text"><p>Non-AFP error occurred.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPNoMoreLocks" title="kFPNoMoreLocks"></a><a name="//apple_ref/doc/c_ref/kFPNoMoreLocks" title="kFPNoMoreLocks"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_190"></a><code>kFPNoMoreLocks</code></td><td align="right" valign="top" class="content_text noWrap">-5015</td><td valign="top" class="content_text"><p>Server’s maximum lock count has been reached.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPNoServer" title="kFPNoServer"></a><a name="//apple_ref/doc/c_ref/kFPNoServer" title="kFPNoServer"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_191"></a><code>kFPNoServer</code></td><td align="right" valign="top" class="content_text noWrap">-5016</td><td valign="top" class="content_text"><p>Server is not responding.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPObjectExists" title="kFPObjectExists"></a><a name="//apple_ref/doc/c_ref/kFPObjectExists" title="kFPObjectExists"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_192"></a><code>kFPObjectExists</code></td><td align="right" valign="top" class="content_text noWrap">-5017</td><td valign="top" class="content_text"><p>File or directory already exists.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPObjectNotFound" title="kFPObjectNotFound"></a><a name="//apple_ref/doc/c_ref/kFPObjectNotFound" title="kFPObjectNotFound"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_193"></a><code>kFPObjectNotFound</code></td><td align="right" valign="top" class="content_text noWrap">-5018</td><td valign="top" class="content_text"><p>Input parameters do not point to an existing directory, file, or volume.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPParamErr" title="kFPParamErr"></a><a name="//apple_ref/doc/c_ref/kFPParamErr" title="kFPParamErr"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_194"></a><code>kFPParamErr</code></td><td align="right" valign="top" class="content_text noWrap">-5019</td><td valign="top" class="content_text"><p>Session reference number, Desktop database reference number, open fork reference number, Volume ID, Directory ID, File ID, Group ID, or subfunction is unknown; byte range starts before byte zero; pathname is invalid; pathname type is unknown; user name is null, exceeds the UAM’s user name length limit, or does not exist, <code>MaxReplySize</code> is too small to hold a single offspring structure, ThisUser bit is not set, authentication failed for an undisclosed reason, specified user is unknown or the account has been disabled due to too many login attempts; ReqCount or Offset is negative; <code>NewLineMask</code> is invalid.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPRangeNotLocked" title="kFPRangeNotLocked"></a><a name="//apple_ref/doc/c_ref/kFPRangeNotLocked" title="kFPRangeNotLocked"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_195"></a><code>kFPRangeNotLocked</code></td><td align="right" valign="top" class="content_text noWrap">-5020</td><td valign="top" class="content_text"><p>Attempt to unlock a range that is locked by another user or that is not locked at all.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPRangeOverlap" title="kFPRangeOverlap"></a><a name="//apple_ref/doc/c_ref/kFPRangeOverlap" title="kFPRangeOverlap"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_196"></a><code>kFPRangeOverlap</code></td><td align="right" valign="top" class="content_text noWrap">-5021</td><td valign="top" class="content_text"><p>User tried to lock some or all of a range that the user has already locked.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPSessClosed" title="kFPSessClosed"></a><a name="//apple_ref/doc/c_ref/kFPSessClosed" title="kFPSessClosed"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_197"></a><code>kFPSessClosed</code></td><td align="right" valign="top" class="content_text noWrap">-5022</td><td valign="top" class="content_text"><p>Session is closed.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPUserNotAuth" title="kFPUserNotAuth"></a><a name="//apple_ref/doc/c_ref/kFPUserNotAuth" title="kFPUserNotAuth"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_198"></a><code>kFPUserNotAuth</code></td><td align="right" valign="top" class="content_text noWrap">-5023</td><td valign="top" class="content_text"><p>UAM failed (the specified old password doesn’t match); no user is logged in yet for the specified session; authentication failed; password is incorrect.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPCallNotSupported" title="kFPCallNotSupported"></a><a name="//apple_ref/doc/c_ref/kFPCallNotSupported" title="kFPCallNotSupported"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_199"></a><code>kFPCallNotSupported</code></td><td align="right" valign="top" class="content_text noWrap">-5024</td><td valign="top" class="content_text"><p>Server does not support this command.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPObjectTypeErr" title="kFPObjectTypeErr"></a><a name="//apple_ref/doc/c_ref/kFPObjectTypeErr" title="kFPObjectTypeErr"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_200"></a><code>kFPObjectTypeErr</code></td><td align="right" valign="top" class="content_text noWrap">-5025</td><td valign="top" class="content_text"><p>Input parameters point to the wrong type of object.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPTooManyFilesOpen" title="kFPTooManyFilesOpen"></a><a name="//apple_ref/doc/c_ref/kFPTooManyFilesOpen" title="kFPTooManyFilesOpen"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_201"></a><code>kFPTooManyFilesOpen</code></td><td align="right" valign="top" class="content_text noWrap">-5026</td><td valign="top" class="content_text"><p>Server cannot open another fork.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPServerGoingDown" title="kFPServerGoingDown"></a><a name="//apple_ref/doc/c_ref/kFPServerGoingDown" title="kFPServerGoingDown"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_202"></a><code>kFPServerGoingDown</code></td><td align="right" valign="top" class="content_text noWrap">-5027</td><td valign="top" class="content_text"><p>Server is shutting down.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPCantRename" title="kFPCantRename"></a><a name="//apple_ref/doc/c_ref/kFPCantRename" title="kFPCantRename"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_203"></a><code>kFPCantRename</code></td><td align="right" valign="top" class="content_text noWrap">-5028</td><td valign="top" class="content_text"><p>Attempt was made to rename a volume or root directory.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPDirNotFound" title="kFPDirNotFound"></a><a name="//apple_ref/doc/c_ref/kFPDirNotFound" title="kFPDirNotFound"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_204"></a><code>kFPDirNotFound</code></td><td align="right" valign="top" class="content_text noWrap">-5029</td><td valign="top" class="content_text"><p>Input parameters do not point to an existing directory.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPIconTypeError" title="kFPIconTypeError"></a><a name="//apple_ref/doc/c_ref/kFPIconTypeError" title="kFPIconTypeError"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_205"></a><code>kFPIconTypeError</code></td><td align="right" valign="top" class="content_text noWrap">-5030</td><td valign="top" class="content_text"><p>New icon’s size is different from the size of the existing icon.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPVolLocked" title="kFPVolLocked"></a><a name="//apple_ref/doc/c_ref/kFPVolLocked" title="kFPVolLocked"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_206"></a><code>kFPVolLocked</code></td><td align="right" valign="top" class="content_text noWrap">-5031</td><td valign="top" class="content_text"><p>Volume is Read Only.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPObjectLocked" title="kFPObjectLocked"></a><a name="//apple_ref/doc/c_ref/kFPObjectLocked" title="kFPObjectLocked"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_207"></a><code>kFPObjectLocked</code></td><td align="right" valign="top" class="content_text noWrap">-5032</td><td valign="top" class="content_text"><p>File or directory is marked DeleteInhibit; directory being moved, renamed, or moved and renamed is marked RenameInhibit; file being moved and renamed is marked RenameInhibit; attempt was made to open a file for writing that is marked WriteInhibit; attempt was made to rename a file or directory that is marked RenameInhibit.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPContainsSharedErr" title="kFPContainsSharedErr"></a><a name="//apple_ref/doc/c_ref/kFPContainsSharedErr" title="kFPContainsSharedErr"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_208"></a><code>kFPContainsSharedErr</code></td><td align="right" valign="top" class="content_text noWrap">-5033</td><td valign="top" class="content_text"><p>Directory contains a share point.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPIDNotFound" title="kFPIDNotFound"></a><a name="//apple_ref/doc/c_ref/kFPIDNotFound" title="kFPIDNotFound"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_209"></a><code>kFPIDNotFound</code></td><td align="right" valign="top" class="content_text noWrap">-5034</td><td valign="top" class="content_text"><p>File ID was not found. (No file thread exists.)</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPIDExists" title="kFPIDExists"></a><a name="//apple_ref/doc/c_ref/kFPIDExists" title="kFPIDExists"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_210"></a><code>kFPIDExists</code></td><td align="right" valign="top" class="content_text noWrap">-5035</td><td valign="top" class="content_text"><p>File already has a File ID.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPDiffVolErr" title="kFPDiffVolErr"></a><a name="//apple_ref/doc/c_ref/kFPDiffVolErr" title="kFPDiffVolErr"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_211"></a><code>kFPDiffVolErr</code></td><td align="right" valign="top" class="content_text noWrap">-5036</td><td valign="top" class="content_text"><p>Wrong volume.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPCatalogChanged" title="kFPCatalogChanged"></a><a name="//apple_ref/doc/c_ref/kFPCatalogChanged" title="kFPCatalogChanged"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_212"></a><code>kFPCatalogChanged</code></td><td align="right" valign="top" class="content_text noWrap">-5037</td><td valign="top" class="content_text"><p>Catalog has changed.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPSameObjectErr" title="kFPSameObjectErr"></a><a name="//apple_ref/doc/c_ref/kFPSameObjectErr" title="kFPSameObjectErr"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_213"></a><code>kFPSameObjectErr</code></td><td align="right" valign="top" class="content_text noWrap">-5038</td><td valign="top" class="content_text"><p>Two objects that should be different are the same object.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPBadIDErr" title="kFPBadIDErr"></a><a name="//apple_ref/doc/c_ref/kFPBadIDErr" title="kFPBadIDErr"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_214"></a><code>kFPBadIDErr</code></td><td align="right" valign="top" class="content_text noWrap">-5039</td><td valign="top" class="content_text"><p>File ID is not valid.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPPwdSameErr" title="kFPPwdSameErr"></a><a name="//apple_ref/doc/c_ref/kFPPwdSameErr" title="kFPPwdSameErr"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_215"></a><code>kFPPwdSameErr</code></td><td align="right" valign="top" class="content_text noWrap">-5040</td><td valign="top" class="content_text"><p>User attempted to change his or her password to the same password that is currently set.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPPwdTooShortErr" title="kFPPwdTooShortErr"></a><a name="//apple_ref/doc/c_ref/kFPPwdTooShortErr" title="kFPPwdTooShortErr"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_216"></a><code>kFPPwdTooShortErr</code></td><td align="right" valign="top" class="content_text noWrap">-5041</td><td valign="top" class="content_text"><p>User password is shorter than the server’s minimum password length, or user attempted to change password to a password that is shorter than the server’s minimum password length.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPPwdExpiredErr" title="kFPPwdExpiredErr"></a><a name="//apple_ref/doc/c_ref/kFPPwdExpiredErr" title="kFPPwdExpiredErr"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_217"></a><code>kFPPwdExpiredErr</code></td><td align="right" valign="top" class="content_text noWrap">-5042</td><td valign="top" class="content_text"><p>User’s password has expired.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPInsideSharedErr" title="kFPInsideSharedErr"></a><a name="//apple_ref/doc/c_ref/kFPInsideSharedErr" title="kFPInsideSharedErr"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_218"></a><code>kFPInsideSharedErr</code></td><td align="right" valign="top" class="content_text noWrap">-5043</td><td valign="top" class="content_text"><p>Directory being moved contains a share point and is being moved into a directory that is shared or is the descendent of a directory that is shared.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPInsideTrashErr" title="kFPInsideTrashErr"></a><a name="//apple_ref/doc/c_ref/kFPInsideTrashErr" title="kFPInsideTrashErr"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_219"></a><code>kFPInsideTrashErr</code></td><td align="right" valign="top" class="content_text noWrap">-5044</td><td valign="top" class="content_text"><p>Shared directory is being moved into the Trash; a directory is being moved to the trash and it contains a shared folder.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPPwdNeedsChangeErr" title="kFPPwdNeedsChangeErr"></a><a name="//apple_ref/doc/c_ref/kFPPwdNeedsChangeErr" title="kFPPwdNeedsChangeErr"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_220"></a><code>kFPPwdNeedsChangeErr</code></td><td align="right" valign="top" class="content_text noWrap">-5045</td><td valign="top" class="content_text"><p>User’s password needs to be changed.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPPwdPolicyErr" title="kFPPwdPolicyErr"></a><a name="//apple_ref/doc/c_ref/kFPPwdPolicyErr" title="kFPPwdPolicyErr"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_221"></a><code>kFPPwdPolicyErr</code></td><td align="right" valign="top" class="content_text noWrap">-5046</td><td valign="top" class="content_text"><p>New password does not conform to the server’s password policy.</p></td></tr><tr><td valign="top" scope="row"><a name="//apple_ref/c/econst/kFPDiskQuotaExceeded" title="kFPDiskQuotaExceeded"></a><a name="//apple_ref/doc/c_ref/kFPDiskQuotaExceeded" title="kFPDiskQuotaExceeded"></a><a name="//apple_ref/doc/uid/TP40003548-CH6-DontLinkElementID_222"></a><code>kFPDiskQuotaExceeded</code></td><td align="right" valign="top" class="content_text noWrap">-5047</td><td valign="top" class="content_text"><p>Disk quota exceeded.</p></td></tr></table></div>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <!-- Previous button --><span style="margin-left: 8px"><a href="../RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-05-23<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Networking/Reference/AFP_Reference/Reference/reference.html%3Fid%3DTP40003548-2.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Networking/Reference/AFP_Reference/Reference/reference.html%3Fid%3DTP40003548-2.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Networking/Reference/AFP_Reference/Reference/reference.html%3Fid%3DTP40003548-2.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>