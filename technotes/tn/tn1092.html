<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!-- Template 03-24-01 --><!--Includes revisions to code listings--><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note TN1092: A Printing Loop That Cares - The Sequel</title>    <meta name="keywords" content="Mac OS 8 print manager loop C error codes">    <meta name="Description" content="Technical Note TN1092: This Technical Note discusses howand why your application should add                                         a generic printing loop in order to becompatible with today's                                         printer drivers. This Note then discusses properopening and closing of the                                         Macintosh Printing Manager with calls to PrOpenand PrClose. It                                         also shows how your application should handle errors at printtime                                          and lists thelatest error codes."><meta name="categories" content="Printing"><meta name="week-posted" content="Jan 27, 1997 - Feb 7, 1997"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002932" title="A Printing Loop That Cares - The Sequel"></a><A NAME="top"></A><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxMacOS9Earlier-date.html">Mac OS 9 & Earlier</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/index.html" target="_blank">Reference Library</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TN1092</div>
<div id="pageheadsub">A Printing Loop That Cares - The Sequel</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                   <td background="images/tnmenubody.gif" width=300 align=left>                        <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left><!-- begin_toc -->    <P id = "menutext"><A HREF = "#Section1">The Old Way of Handling Printing</a><BR><BR>    <A HREF = "#Section2">The New Way: a C Print Loop</a><BR><BR>    <A HREF = "#Section3">Checking For Error Conditions While Printing</a><BR><BR>    <A HREF = "#Section4">Error Messages</a><BR><BR>    <A HREF = "#Summary">Summary</a><BR><BR>   <A HREF="#References">References</A><BR><BR>    <A HREF = "#Changes">Change History</A> <BR><BR>     <A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row"><img src="images/tnmenubottom.gif" alt="" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>		<td width=300 valign="top" align=left>	<!-- begin_intro_text -->   <P id = "introtext">This Technote,     originally <CITE>Technote PR 10 - A Printing Loop That Cares</CITE>,discusses how and why your application should add a generic printingloop in order to be compatible with today's printer drivers.</p><P id = "introtext">This revised Technote reflects the current Macintosh Printing Managerand discusses proper opening and closing of the Macintosh PrintingManager with calls to <CODE>PrOpen</CODE> and <CODE>PrClose</CODE>. It also shows how yourapplication should handle errors at print time and lists the latesterror codes.</P> <!-- end_intro_text --><!-- begin_date --><h3>&nbsp;Updated: [Feb 11 1997]</h3><!-- end_date -->                </TD>             </TR>          </TABLE> <!-- end_header_box --><BR><BR><hr width=500 align=center><BR><BR><!-- begin_content -->    <a name="Section1"></a>    <H2>The Old Way of Handling Printing</h2>    <P>In the past (pre-System 7), Apple recommended that developers call<CODE>PrOpen</CODE> at the beginning of your application and <CODE>PrClose</CODE> at the endbefore returning to the Finder. This recommendation was appropriate whenyour application only had to deal with a single printer driver. However,as more printers became available on the market, it became importantthat your application took into account the presence of other launchedapplications and multiple printer drivers.</P><P>For instance, the user could open the Chooser at any time and change thecurrent printer driver without the current application's knowledge. Ifan application followed the old philosophy and a user changed thecurrent printer driver while running the application, the next time theuser attempted to print, the wrong driver would be open, the PrintingManager would not be able to find the necessary resources, and the userwould get an error. </P><P>The original Technote described a method of printing that allowedapplications to circumvent all of these problems; this revised Noteshows you an even better method.</P>  <P><A HREF="#top">Back to top</A></P>    <a name="Section2"></A>    <H2>The New Way: a C Print Loop</h2>            <P>The following code snippet, <CODE>PrintStuff</CODE>, represents a simple print loopthat your application should use to print. It works as follows: </P><OL TYPE="1" START="1">    <LI>It calls all of the necessary Print Manager calls to print a document.</li>    <LI>It checks <CODE>PrError</CODE> after each Print Manager call. </li>    <LI>If an error is found, all of the Print Manager open calls (i.e.,<CODE>PrOpen</CODE>, <CODE>PrOpenDoc</CODE>...) have a corresponding close call before posting an error. </li></OL><P>You should use the error-checking method in Step #3 to make sure thePrint Manager closes properly and that all temporary memory is released.</P><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>Note:</B><BR>Apple Developer Technical Support currently recommends that applications openand close the printer driver each time your application uses thePrinting Manager. We also highly recommend appropriate error checking,as demonstrated in this snippet of code.</P></TD></TR></TABLE></CENTER><BR><H3>The PrintStuff Print Loop</h3><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>void PrintStuff (){  GrafPtr      oldPort;  short        copies,               firstPage,               lastPage,               numberOfCopies,               printmgrsResFile,               realNumberOfPagesinDoc,               pageNumber,               PrintError;  THPrint      thePrRecHdl;  TPPrPort     thePrPort;  TPrStatus    theStatus;  GetPort(&amp;oldPort);thePrRecHdl = (THPrint)  NewHandle (sizeof (TPrint)); /**     Check to make sure that the memory manager did not produce an error     when it allocated the print record handle and make sure it did not pass     back a nil handle. **/  if (thePrRecHdl != NULL &amp;&amp; MemError() == noErr)    {      PrOpen();      if (PrError() == noErr)        {         /** Save the current resource file (i.e., the printer driver's) so          the driver will not lose its resources upon return from the pIdleProc.          **/          printmgrsResFile = CurResFile();          PrintDefault(thePrRecHdl);          if (PrError() == noErr)            {              if (PrStlDialog(thePrRecHdl))                {                 /**                    DetermineNumberOfPagesinDoc determines the number of pages                    contained in the document by comparing the size of the                    document with rPage from the TPrInfo record (Inside                    Macintosh: Imaging With QuickDraw p.9-46).                    It returns the number of pages required to print the                    document for the currently selected printer.                  **/                  realNumberOfPagesinDoc = DetermineNumberOfPagesinDoc                                             ((**thePrRecHdl).prInfo.rPage);                  if (PrJobDialog(thePrRecHdl))                    {                     /**                            Get the number of copies of the document that the                            user wants printed from iCopies of the TPrJob record                            (Inside Macintosh: Imaging With QuickDraw p.9-47).                      **/                      numberOfCopies = (**thePrRecHdl).prJob.iCopies;                       /**                           Get the first and last pages of the document that                           were requested to be printed by the user from FstPage                           and iLastPage from the TPrJob record (Inside                           Macintosh: Imaging With QuickDraw p.9-47).                        **/                      firstPage = (**thePrRecHdl).prJob.iFstPage;                      lastPage = (**thePrRecHdl).prJob.iLstPage;                       /**                           Print &quot;all&quot; pages in the print loop                        **/                      (**thePrRecHdl).prJob.iFstPage = 1;                      (**thePrRecHdl).prJob.iLstPage = 9999;                       /**                           Determine the &quot;real&quot; number of pages contained in the                           document. Without this test, you would print 9999 pages.                        **/                      if (realNumberOfPagesinDoc &lt; lastPage)                        lastPage = realNumberOfPagesinDoc;                      PrintingStatusDialog = GetNewDialog(rPrintingDialogID,                         nil, (WindowPtr) -1);                       /**                           Print the number of copies of the document                           requested by the user from the Print Job Dialog.                        **/                      for (copies = 1; copies &lt;= numberOfCopies; copies++)                        {                         /**                        Install a pointer to your pIdle proc in my print record.                          **/                          (**thePrRecHdl).prJob.pIdleProc = checkMyPrintDialogButton();                         /**                             Restore the resource file to the printer driver's.                          **/                          UseResFile(printmgrsResFile);                          thePrPort = PrOpenDoc(thePrRecHdl, nil, nil);                          if (PrError() == noErr)                            {                             /**                                 Print the range of pages of the document                                 requested by the user from the Print Job Dialog.                              **/                              pageNumber = firstPage;                              while (pageNumber &lt;= lastPage &amp;&amp; PrError() == noErr)                                {                     /**                       If we've crossed a 128-page boundary,                       close the current print file, send it                       to the printer if necessary, and open a                       new document.                     **/                     if ((pageNumber - firstPage) % iPFMaxPgs == 0)                       {                         if (pageNumber != firstPage)                           {                             PrCloseDoc(thePrPort);                             if (((**thePrRecHdl).prJob.bJDocLoop ==                                             bSpoolLoop) &amp;&amp; (PrError() == noErr))                                             PrPicFile(thePrRecHdl, nil, nil, nil,                                                       &amp;theStatus);                             thePrPort = PrOpenDoc(thePrRecHdl, nil,                                                                nil);                                         }                                     }                     PrOpenPage(thePrPort, nil);                                  if (PrError() == noErr)                                    {                                     /**                                        rPage (Inside Macintosh: Imaging With                                        QuickDraw p.9-46) is the printable area                                        for the currently selected printer. By                                        passing the current port to the draw                                        routine, enables your app to use the                                        same routine to draw to the screen and                                        the printer's GrafPort.                                      **/                                      DrawStuff ((**thePrRecHdl).prInfo.rPage,                                           (GrafPtr) thePrPort, pageNumber);                                    }                                  PrClosePage(thePrPort);                                  pageNumber++;                                }  /**  End pageNumber loop  **/                            }                          PrCloseDoc(thePrPort);                        } /**  End copies loop  **/                    }                   /**                       The printing job is being canceled by the request of the                       user from the Print Style Dialog or the Print Job Dialog.                       PrError will be set to PrAbort to tell the Print Manager                       to abort the current printing job.                    **/                  else                    PrSetError (iPrAbort);   /**  cancel from the job dialog  **/                }              else                PrSetError (iPrAbort);   /**  cancel from the style dialog  **/            }        }      if (((**thePrRecHdl).prJob.bJDocLoop == bSpoolLoop) &amp;&amp; (PrError() == noErr))        PrPicFile(thePrRecHdl, nil, nil, nil, &amp;theStatus);       /**            Grab the printing error -- once you close the Printing Manager,            PrError doesn't return a valid result anymore.       **/      PrintError = PrError();      PrClose();       /**           You do not want to report any printing errors until you have fallen           through the printing loop. This will make sure that ALL of the Print           Manager's open calls have their corresponding close calls, thereby           enabling the Print Manager to close properly and that all temporary           memory allocations are released.        **/      if (PrintError != noErr)        PostPrintingErrors (PrintError);    }  if (thePrRecHdl != NULL)    DisposeHandle((Handle) thePrRecHdl);  if (PrintingStatusDialog != NULL)    DisposeDialog(PrintingStatusDialog);  SetPort(oldPort);}  /** PrintStuff **/</pre>	</TD></TR></TABLE></CENTER>  <P><A HREF="#top">Back to top</A></P>    <a name="Section3"></a>    <H2>Checking For Error Conditions While Printing</h2>        <P>Your application should always check for error conditions whileprinting. You can do this by calling <CODE>PrError</CODE>. <CODE>PrError</CODE> returns errorsfrom the Printing Manager (and some AppleTalk and OS errors) that mayoccur during printing.</P><P>As the previous example code demonstrates, your application should call<CODE>PrError</CODE> after each call to a Printing Manager function or procedure. Byconsistently checking <CODE>PrError</CODE> after each call, your application will beable to catch any errors created at print time and be able to reportthem to your user via a dialog box. </P>    <H3>Some General Error-Handling Guidelines</h3>        <P>The following section provides you with some general error-handlingguidelines: </P><UL TYPE=DISC>    <LI>Don't call <CODE>PrError</CODE> within your <CODE>pIdle</CODE>     procedure; errors that occurwhile it is executing are usually temporary and serve only as internalflags for communication within the printer driver -- they are notintended for the application. If you discover that you need to abortprinting while in your idle procedure, set a flag to signal yourself,and check your flag after each Printing Manager function. If the flag isset, you can exit in the same manner as if an error occurred.<BR><BR></li>    <LI>On detecting an error after the completion of a printing routine, stopdrawing at that point, and proceed to the next procedure to close anypreviously made open calls. For example, if you detect an error aftercalling <CODE>PrOpenDoc</CODE>, skip to the next <CODE>PrCloseDoc</CODE>. Or, if you get an errorafter calling <CODE>PrOpenPage</CODE>, skip to the next <CODE>PrClosePage</CODE> and <CODE>PrCloseDoc</CODE>. Remember that if you have called <CODE>PrOpen</CODE>, then you must call thecorresponding <CODE>PrClose</CODE> to ensure that printing closes properly and thatall temporary memory allocations are released and returned to the heap.<BR><BR> </li>    <LI>Don't display any alert or dialog boxes to report an error until theend of the printing loop. Once at the end, check for the error again; ifthere is no error,  assume that printing completed normally. If theerror is still present, alert the user.<P>This procedure -- not displaying any alerts or dialog boxes -- isimportant for two reasons. </P><OL TYPE="1" START="1">    <LI>If you display a dialog box in the middle of the printing loop, itcould cause errors that can terminate an otherwise normal job. Forexample, if the printer is an AppleTalk printer, the connection can beterminated abnormally, since the driver would be unable to respond toAppleTalk requests received from the printer while the dialog box waswaiting for input from the user. If the printer does not hear from theMacintosh within a certain period of time (currently 300-600 seconds), it times out, assuming that the Macintosh is no longer there, which results in aprematurely broken connection, causing another error to which theapplication must respond. </li>    <LI>The driver may have already displayed its own dialog box in responseto an error. In this instance, the driver posts an error to let theapplication "know" that something went wrong and it should abortprinting. For example, in older LaserWriter drivers, when the driver detected that the Laser Prep version which was being downloaded to the LaserWriter wasdifferent than the version the user was trying to print with, it displayedthe appropriate dialog box informing the user of the situation andgave him or her the option of reinitializing the printer. If the userchose to cancel printing, the driver posted an error to let theapplication "know" that it needed to abort, but since the driver hadalready taken care of the error by displaying a dialog box, the error wasreset to zero before the printing loop was complete. Your applicationshould check for the error again at the end of the printing loop, and ifit still indicates an error, your application can then display theappropriate dialog box. <BR><BR></li></OL> </li><LI>If you're using <CODE>PrGeneral</CODE>, be prepared to receive the followingerrors:  <CODE>NoSuchRsl</CODE>, <CODE>OpNotImpl</CODE>, and <CODE>resNotFound</CODE>. In all three cases, your application should be prepared to continue printing without usingthe features of that particular opcode.<P>In the case of the <CODE>resNotFound</CODE> error, however, it means the currentprinter driver does not support <CODE>PrGeneral</CODE>. This lack of support shouldnot be a problem for  your application, but your application needs to beprepared to deal with this error. If you receive a <CODE>resNotFound</CODE> errorfrom <CODE>PrError</CODE>, clear the error with a call to <CODE>PrSetError(0)</CODE>; otherwise,<CODE>PrError</CODE> might still contain this error the next time you check it, whichwould prevent your application from printing.</P> </li></UL><H3>Cancelling or Pausing the Printing Process</h3><P>If you install a procedure for handling requests to cancel printing,with an option to pause the printing process, beware of timeout problemswhen printing to network printers. Communication between the Macintoshand a networked printer must be maintained to prevent a job or a waittimeout. If there is no communication for a period of time (roughly 300-600seconds), the printer times out and the print job terminates due to await  timeout. Or, if the print job requires more than ten minutes toprint, the print job terminates due to a job timeout. Since there is nogood method to determine to what type of printer an application isprinting, it is probably a good idea to document in your ReadMe thepossibility of a network printer timing out for a user who chooses toselect "pause" for five minutes or more.</P>  <P><A HREF="#top">Back to top</A></P>    <a name="Section4"></a>    <H2>Error Messages</h2>        <P>The Printing Manager reports the error messages covered in this section.If an error that does not belong to the Printing Manager occurs, thePrinting Manager puts it into low memory, where it can be retrieved witha call to <CODE>PrError</CODE>, and terminates the printing loop, if necessary. Asalready documented, if you encounter an error in the middle of aprinting loop, don't jump out; fall through the loop and let thePrinting Manager terminate properly.</P><P>The most common error encountered is <B>-4101</B>, which is generated if theselected LaserWriter is not available on the network. Since this erroris so common, it's a good idea to display a dialog box requesting theuser to select a printer from the Chooser when this error isencountered.</P><H3>Common Printing Manager and System Errors</h3><P>The following table shows you common printing manager and system error codes. </P>    <TABLE BORDER = 1>    <TR>        <td align="left"><B>Error Code</B></TD>        <td align="left"><B>Constant</B></TD>        <td align="left"><B>Description</B></TD>    </TR>            <TR>        <td align="left">0</TD>        <td align="left"><CODE>noErr</CODE></TD>        <td align="left">No error</TD>    </TR>         <TR>        <td align="left">28</TD>        <td align="left">[don't know]</TD>        <td align="left">Stack/heap collision. Too much stack usage inside QuickDraw [not        uncommon if you're calling DrawPicture on QT compressed pictures]</TD>    </TR>        <TR>        <td align="left">128</TD>        <td align="left"><CODE>iPrAbort</CODE></TD>        <td align="left">Abort the printing process (result of Command-period)</TD>    </TR>                        <TR>        <td align="left">-1</TD>        <td align="left"><CODE>iPrSavePFil</CODE></TD>        <td align="left">Problem saving print file</TD>    </TR>        <TR>        <td align="left">-17</TD>        <td align="left"><CODE>controlErr</CODE></TD>        <td align="left">Unimplemented Control call</TD>    </TR>        <TR>        <td align="left">-27</TD>        <td align="left"><CODE>iIOAbort</CODE></TD>        <td align="left">I/O problems</TD>    </TR>        <TR>        <td align="left">-108</TD>        <td align="left"><CODE>iMemFullErr</CODE></TD>        <td align="left">Not enough heap space</TD>    </TR></TABLE></td></tr></table><BR><TABLE BORDER=0 WIDTH="498"><TR> <td align="left"><H3><CODE>PrGeneral</CODE> Errors</h3><P><CODE>PrGeneral</CODE> is declared like this in C: </P><CODE>pascal void PrGeneral (Ptr pData);</CODE><P>The <CODE>pData</CODE> parameter is a pointer to a record called <CODE>TGnlData</CODE>. The firsteight bytes comprise a header shared by all the <CODE>PrGeneral</CODE> calls: </P><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre> struct TGnlData     {            short iOpCode;            short iError;            long lReserved;</pre>	</TD></TR></TABLE></CENTER>        <P>After each call to <CODE>PrGeneral</CODE>, your application should check the value inthe <CODE>iError</CODE> field. The possible result codes that can be returned are: </P><TABLE BORDER="1"><TR>    <td align="left"><B>Error Code</B></TD>    <td align="left"><B>Constant</B></TD>    <td align="left"><B>Description</B></TD></TR>    <TR>    <td align="left">0</TD>    <td align="left"><CODE>noErr</CODE></TD>    <td align="left">No Error</TD></TR><TR>    <td align="left">1</TD>    <td align="left"><CODE>NoSuchRsl</CODE></TD>    <td align="left">Unsupported Resolution</TD></TR><TR>    <td align="left">2</TD>    <td align="left"><CODE>OpNotImpl</CODE></TD>    <td align="left">Unsupported Opcode</TD></TR><TR>    <td align="left">-192</TD>    <td align="left"><CODE>resNotfound</CODE></TD>    <td align="left">The current printer driver does not support <CODE>PrGeneral</CODE>.</TD></TR></TABLE><P>For further information on <CODE>PrGeneral</CODE>, you should read Pete 'Luke' Alexander's article,"Meet <CODE>PrGeneral</CODE>," in <I><a href="http://developer.apple.com/dev/techsupport/develop/issue03toc.shtml">develop 3</A></I>.</P><H3>LaserWriter Driver Family Errors</h3><TABLE BORDER="1"><TR>     <td align="left"><B>Error Code</B></TD>     <td align="left"><B>Description</B></TD></TR>    <TR>    <td align="left">-4101</TD>    <td align="left">Printer not found or closed.</TD></TR><TR>    <td align="left">-4100</TD>    <td align="left">Connection just closed.</TD></TR><TR>    <td align="left">-4099</TD>    <td align="left">Write request too big.</TD></TR><TR>    <td align="left">-4098</TD>    <td align="left">Request already active.</TD></TR><TR>    <td align="left">-4097</TD>    <td align="left">Bad connection refnum.</TD></TR><TR>    <td align="left">-4096</TD>    <td align="left">No free Connect Control Blocks (CCBs) available.</TD></TR></TABLE><H3>LaserWriter 8 Internal Errors</h3><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>Note:</B><BR>The following error codes are internal LaserWriter 8 errors. Theyare useful for debugging, but your application should NOT try tointerpret or use these error codes during runtime.</P></TD></TR></TABLE></CENTER><BR><TABLE BORDER="1"><TR><td align="left">-8998</TD><td align="left"><CODE>errNotAKey</CODE></TD><td align="left">Couldn't find a key for the desired font number.</TD></TR><TR><td align="left">-8997</TD><td align="left"><CODE>errFaceListBad</CODE></TD><td align="left">(NO LONGER USED)</TD></TR><TR><td align="left">-8996</TD><td align="left"><CODE>errSizeListBad</CODE></TD><td align="left">The size list was not consistent with the face list.</TD></TR><TR><td align="left">-8995</TD><td align="left"><CODE>errFontNotFound</CODE></TD><td align="left">A font query reply didn't match any of the PostScript fonts.</TD></TR><TR><td align="left">-8994</TD><td align="left"><CODE>errUnknownPSLevel</CODE></TD><td align="left">We asked for the printer's PostScript level and got an answer we didn't expect.</TD></TR><TR><td align="left">-8993</TD><td align="left"><CODE>errInLineTimeout</CODE></TD><td align="left">We got tired of waiting for a response from the printer.</TD></TR><TR><td align="left">-8991</TD><td align="left"><CODE>errNoProcSetRes</CODE></TD><td align="left">While generating PostScript prolog, we couldn't find the resource containing the needed procedure sets.</TD></TR><TR><td align="left">-8990</TD><td align="left"><CODE>errBadSpoolFileVersion</CODE></TD><td align="left">While foreground printing (pre-LW8.4) we read the spool file, and the header information was not good.</TD></TR><TR><td align="left">-8989</TD><td align="left"><CODE>errCouldNotMakeNumberedFilename</CODE></TD><td align="left">Couldn't make a unique spool file name by adding numbers to the base name. We ran out of numbers.</TD></TR><TR><td align="left">-8987</TD><td align="left"><CODE>errPSFileName</CODE></TD><td align="left">While saving PS to disk, the filename was bad.</TD></TR><TR><td align="left">-8986</TD><td align="left"><CODE>errBitmapFontMissing</CODE></TD><td align="left">We tried to build a 1-bit bitmap, but failed.</TD></TR><TR><td align="left">-8985</TD><td align="left"><CODE>errDidNotDownloadFont</CODE></TD><td align="left">The PS outline couldn't be found, and there's no 'sfnt'.</TD></TR><TR><td align="left">-8984</TD><td align="left"><CODE>errBadConverterIndex</CODE></TD><td align="left">Couldn't find the entry matching the selection in the "Save to Disk" popup.</TD></TR><TR><td align="left">-8983</TD><td align="left"><CODE>errSpoolFolderIsAFile</CODE></TD><td align="left">(NO LONGER USED)</TD></TR><TR><td align="left">-8982</TD><td align="left"><CODE>errPSFileNameNull</CODE></TD><td align="left">(NO LONGER USED)</TD></TR><TR><td align="left">-8981</TD><td align="left"><CODE>errNullColorInfo</CODE></TD><td align="left"><CODE>GetColor</CODE> was called with a NULL handle.</TD></TR><TR><td align="left">-8980</TD><td align="left"><CODE>errNoPagesSpooled</CODE></TD><td align="left">The app made a <CODE>PrOpenDoc</CODE> call and <CODE>PrCloseDoc</CODE>, but didn't print any pages.</TD></TR><TR><td align="left">-8979</TD><td align="left"><CODE>errBadConverterID</CODE></TD><td align="left">The PDEF we wanted to run as a converter wasn't there.</TD></TR><TR><td align="left">-8978</TD><td align="left"><CODE>errNoPattern</CODE></TD><td align="left">We couldn't find or make a pixpat.</TD></TR><TR><td align="left">-8977</TD><td align="left"><CODE>errPSStateUnderFlow</CODE></TD><td align="left">We tried to pop the topmost graphics state. Oops!</TD></TR><TR><td align="left">-8976</TD><td align="left"><CODE>errChannelNotBinary</CODE></TD><td align="left">Application wants binary data (via <CODE>PrGeneral</CODE>), but the actual channel to the printer isn't binary.</TD></TR><TR><td align="left">-8975</TD><td align="left"><CODE>errPrinterNotLevel2</CODE></TD><td align="left">Application wants to use Level 2 PS, but the printer's not hip to Level 2.</TD></TR><TR><td align="left">-8974</TD><td align="left"><CODE>errBadFontKeyType</CODE></TD><td align="left">The type of a font was not PS, TT or bitmap.</TD></TR><TR><td align="left">-8973</TD><td align="left"><CODE>errFunctionNotAvailable</CODE></TD><td align="left">(NO LONGER USED)</TD></TR><TR><td align="left">-8972</TD><td align="left"><CODE>errNULLFormatString</CODE></TD><td align="left">The format string passed to an internal printf-like function was null.</TD></TR><TR><td align="left">-8971</TD><td align="left"><CODE>errNotAFolderAlias</CODE></TD><td align="left">The alias that should point to the "Print Monitor Documents" folder isn't pointing to a folder.</TD></TR><TR><td align="left">-8970</TD><td align="left"><CODE>errMissingPAPA</CODE></TD><td align="left">The PAPA resource we looked for isn't there.</TD></TR><TR><td align="left">-8969</TD><td align="left"><CODE>errMissingPrinterInfo</CODE></TD><td align="left">The current printer does not have an entry in the printer database - usually because it hasn't been set up.</TD></TR><TR><td align="left">-8968</TD><td align="left"><CODE>errUnsupportedDestColorMode</CODE></TD><td align="left">The output colorspace isn't supported.</TD></TR><TR><td align="left">-8967</TD><td align="left"><CODE>errUnknownColorUsage</CODE></TD><td align="left">(NO LONGER USED)</TD></TR><TR><td align="left">-8966</TD><td align="left"><CODE>errUnsupportedCodec</CODE></TD><td align="left">Compressed pixmap wants a codec we can't deal with.</TD></TR><TR><td align="left">-8965</TD><td align="left"><CODE>errInvalidPPD</CODE></TD><td align="left">Tried to open the PPD and couldn't.</TD></TR>    <TR><td align="left">-8964</TD><td align="left"><CODE>errBadColorSync2Comment</CODE></TD><td align="left">The ColorSync2 PicComment wants a 4-byte selector and we encountered a datasize &lt; 4 bytes.</TD></TR><TR><td align="left">-8963</TD><td align="left"><CODE>errBadFlattenRefCon</CODE></TD><td align="left">ColorSync gave us a NULL refcon in the flatten proc.</TD></TR><TR><td align="left">-8962</TD><td align="left"><CODE>errGlyphsDontFit</CODE></TD><td align="left">A single glyph either didn't end on a 4-byte boundary (a bug in the font) or was greater than 64k.</TD></TR><TR><td align="left">-8961</TD><td align="left"><CODE>errGenericComponentErr</CODE></TD><td align="left">Generic error</TD></TR><TR><td align="left">-8960</TD><td align="left"><CODE>errUnsupportedStream</CODE></TD><td align="left">The PSStream type passed in to a given library call is not supported.</TD></TR><TR><td align="left">-8959</TD><td align="left"><CODE>errProfileNotInList</CODE></TD><td align="left">The internal temporary profile list went bad.</TD></TR><TR><td align="left">-8958</TD><td align="left"><CODE>errUninitializedPort</CODE></TD><td align="left">Uninitialized port</TD></TR><TR><td align="left">-8957</TD><td align="left"><CODE>errHintWrongSize</CODE></TD><td align="left">One of the converter's hints was an unexpected size.</TD></TR><TR><td align="left">-8956</TD><td align="left"><CODE>errSystemProfileNotFound</CODE></TD><td align="left">We tried to use ColorSync, but couldn't find the default System Profile.</TD></TR><TR><td align="left">-8955</TD><td align="left"><CODE>errCFM_EnablerNotPresent</CODE></TD>      <td align="left">We're trying to use CFM-68K, but the enabler's not there.</TD></TR><TR><td align="left">-8954</TD><td align="left"><CODE>errCouldNotIDArchitecture</CODE></TD></TR>          <TR><td align="left">-8953</TD><td align="left"><CODE>errPSStreamNullOutProc</CODE></TD><td align="left">Got a bad function pointer for the output routine.</TD></TR><TR><td align="left">-8952</TD><td align="left"><CODE>errTriedToWriteNullBuffer</CODE></TD>       <td align="left">This should never happen.</TD></TR><TR><td align="left">-8951</TD><td align="left"><CODE>errWhoTookThatOutBuffer</CODE></TD><td align="left">We had a buffer that's gone now. This seems bad.</TD></TR><TR><td align="left">-8950</TD><td align="left"><CODE>errMoreDataToFlush</CODE></TD><td align="left">There's still data to be dealt with.</TD></TR><TR><td align="left">-8160</TD><td align="left"><CODE>zoomRangeErr</CODE></TD></TR><TR><td align="left">-8152</TD><td align="left"><CODE>noPrepErr</CODE></TD></TR><TR><td align="left">-8151</TD><td align="left"><CODE>prepMismatchErr</CODE></TD></TR><TR><td align="left">-8150</TD><td align="left"><CODE>noChosenPrinterErr</CODE></TD></TR><TR><td align="left">-8133</TD><td align="left"><CODE>generalPSErr</CODE></TD><td align="left">PostScript error during transmission of data to printer. Most often caused by a bug in the PostScript code being downloaded.</TD></TR><TR><td align="left">-8132</TD><td align="left"><CODE>manualFeedTOErr</CODE></TD><td align="left">Timeout occurred.</TD></TR><TR><td align="left">-8131</TD><td align="left">Printer not responding.</TD></TR></TABLE>  <P><A HREF="#top">Back to top</A></P>  <a name="Summary"></a><H2>Summary</h2><P>That's all there is to it. Now your application can print properly withthe Macintosh Printing Manager by adhering to the rules specified inthis Note and by handling error messages appropriately.</P>  <P><A HREF="#top">Back to top</A></P>  <a name="References"></a><H2>References</H2>    <p><I><a href="http://developer.apple.com/documentation/mac/QuickDraw/QuickDraw-406.html">    Inside Macintosh: Imaging With QuickDraw</A></I>, Chapter 9</p>    <p>StdFileSaver sample code, available on the Developer CD Series: Tool Chest Edition. </p>    <p><A HREF = "../pr/pr_02.html">Technote PR02: Device-Independent Printing</A>     by Ginger Jernigan. </p>    <p><I><a href="http://developer.apple.com/dev/techsupport/develop/issue03toc.shtml">develop 3</A></I>:     "Meet <CODE>PrGeneral</CODE>, the Trap That Makes the Most of the Printing Manager"     by Pete "Luke" Alexander. </p>    <p><I><a href="http://developer.apple.com/dev/techsupport/develop/issue27toc.shtml">develop 27</A></I>:     "Print Hints: The All-New LaserWriter Driver Version 8.4"     by Dave Polaschek.</p>  <P><A HREF="#top">Back to top</A></P><a name="Changes"></a><h2>Change History</h2><TABLE BORDER=0 CELLPADDING=3 WIDTH=544>            <TR>               <td width=100 align=left>                  <P ALIGN=center>01-October-1990</P>               </TD>               <td align="left">                  <P> Originally written in October 1990, as <I>Technote PR10 -- A Printing LoopThat Cares...</I></P>               </TD>            </TR>    <TR>		<td width=100 align=left>                  <P ALIGN=center>01-January-1994</P>               </TD>               <td align="left">                  <P> Revised as <I>Technote PR10 -- APrinting Loop That Cares...</I> with new text and code.</P>               </TD>            </TR> <TR>		<td width=100 align=left>                  <P ALIGN=center>11-February-1997</P>               </TD>               <td align="left">                  <P>Technote updated to reflect the currentMacintosh Printing Manager and to use C code. The Pascal code wasremoved. Updated error codes were also added to the Error Messages section.</P>               </TD>            </TR>  </table><BR>  <P><A HREF="#top">Back to top</A></P>                           <P><A NAME=Downloads></A></P>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" alt="acrobat" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (72K)</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/tn1092.pdf">Download</A></P>               </TD>            </TR>                </TABLE>         <BR>                  <P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tn/tn1092.html%3Fid%3DDTS10002932-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tn/tn1092.html%3Fid%3DDTS10002932-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tn/tn1092.html%3Fid%3DDTS10002932-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --><hr width=500 align=center></BODY></HTML> 