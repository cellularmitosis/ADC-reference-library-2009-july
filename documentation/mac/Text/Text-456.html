<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Converting Text Offsets to Global Coordinates(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING456></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-455.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-457.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-409.html"><B>Chapter 7 - Text Services Manager</B></A> / <A HREF="Text-425.html"><B>Text Services Manager Reference</B></A><BR><DL><DD><A HREF="Text-453.html"><B>Apple Event Handlers Supplied by Client Applications</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING456-0></A>
<H3>Converting Text Offsets to Global Coordinates</H3>
 The Offset To Position Apple event requests that a client application convert byte offsets in text to global coordinates. The text service component uses this Apple event to determine where in the active input area to draw an element (such as the caret or a palette of conversion choices) that relates to a particular character.
<TABLE BORDER="0" CELLPADDING=3><TH colspan=2><A NAME=MARKER-2-49></A>Offset To Position--Converting Text Offsets to Global Coordinates (Continued)<TR>
<TD>Event class<TD>kTextServiceClass<TR>
<TD><A NAME=MARKER-2-50></A>Event ID<TD>kOffset2Pos<TR>
<TD>Requested action<TD rowspan=2>Convert a specified byte offset into global coordinates. The offset value passed to the client application is relative to the start of the active input area. If there is no active input area, the offset is relative to the start of the current text body.<TR>
<TD>&nbsp;<TR>
<TD colspan=2>Required parameters<TR>
<TD>Keyword:<TD>keyAETSMDocumentRefcon<TR>
<TD>Descriptor type:<TD>typeLongInteger<TR>
<TD>Data:<TD>A TSM document specifier (reference constant) supplied by the application in a prior call to the <CODE>NewTSMDocument</CODE> function (see <A HREF=Text-431.html#MARKER-9-231>page 7-50</A>). This value is associated with the TSM document affected by this event.<TR>
<TD colspan=2>Required parameters<TR>
<TD>Keyword:<TD>keyAEServerInstance<TR>
<TD>Descriptor type:<TD>typeComponentInstance<TR>
<TD>Data:<TD>A component instance value returned by a prior call to the Component Manager <CODE>OpenComponent</CODE> function. This value identifies the text service component.<TR>
<TD>Keyword:<TD>keyAEOffset<TR>
<TD>Descriptor type:<TD>typeLongInteger<TR>
<TD>Data:<TD>The text offset to be converted into a global point. Offset is in terms of bytes from the start of the active input area. <TR>
<TD colspan=2>Return parameters<TR>
<TD>Keyword:<TD>keyAEPoint<TR>
<TD>Descriptor type:<TD>typePoint<TR>
<TD>Data:<TD>A point that contains the global coordinates obtained by converting the byte offset passed in the <CODE>keyAEOffset</CODE> parameter.<TR>
<TD>Keyword:<TD>keyErrorNumber<TR>
<TD>Descriptor type:<TD>typeShortInteger<TR>
<TD>Data:<TD><CODE>errOffsetInvalid</CODE> indicates that there is no text at the offset. <CODE>errOffsetIsOutsideOfView</CODE> indicates that the text offset is out of view. <P>The application must pass Memory Manager, TextEdit, or other errors that it receives through to the component; otherwise, it should pass 0 (<CODE>noErr</CODE>).<TR>
<TD colspan=2>Optional return parameters<TR>
<TD>Keyword:<TD>keyAETextFont<TR>
<TD>Descriptor type:<TD>typeLongInteger<TR>
<TD>Data:<TD>The font of the text in the active input area. The application can send this information to the input method to help the input method position the active input area.<TR>
<TD>Keyword:<TD>keyAETextPointSize<TR>
<TD>Descriptor type:<TD>typeFixed<TR>
<TD>Data:<TD>The size of the text in the active input area. The application can send this information to the input method to help the input method position the active input area.<TR>
<TD>Keyword:<TD>keyAETextLineHeight<TR>
<TD>Descriptor type:<TD>typeShortInteger<TR>
<TD>Data:<TD>The line height of the text in the active input area. The application can send this information to the input method to help the input method position the active input area.<TR>
<TD>&nbsp;<TD>&nbsp;<TR>
<TD colspan=2>Optional return parameters<TR>
<TD>Keyword:<TD>keyAETextLineAscent<TR>
<TD>Descriptor type:<TD>typeShortInteger<TR>
<TD>Data:<TD>The ascent height of the text in the active input area. The application can send this information to the input method to help the input method position the active input area.<TR>
<TD>Keyword:<TD>keyAEAngle<TR>
<TD>Descriptor type:<TD>typeFixed<TR>
<TD>Data:<TD>The orientation of the text in the active input area. The value 90 specifies a horizontal line direction and 180 specifies a vertical line direction. The application can send this information to the input method to help the input method position the active input area.</TABLE>
<P>
 For sample code that handles the Offset To Position Apple event, see <A HREF=Text-419.html#MARKER-9-169>Listing 7-9 on page 7-33</A>.<A NAME=MARKER-2-400></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-455.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-457.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
