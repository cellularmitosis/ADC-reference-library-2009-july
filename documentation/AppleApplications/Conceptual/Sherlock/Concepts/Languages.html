<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Sherlock Channels (Legacy): Sherlock Scripting Language Support</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Sherlock Scripting Language Support"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	<meta name="ROBOTS" content="NOINDEX"/>
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20001084" title="Sherlock Scripting Language Support"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../LegacyTechnologies/index.html#//apple_ref/doc/uid/TP30000440-TP30000470" target="_top">Legacy Documents</a> &gt; <a href="../../../../LegacyTechnologies/InternetWeb-date.html#//apple_ref/doc/uid/TP30000440-TP30000470-TP30000526" target="_top">Internet &amp; Web</a> &gt; <a href="../index.html" target="_top">Sherlock Channels (Legacy)</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="DevelopingChannels.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="ScriptExtensions.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        <script type="text/javascript" language="JavaScript">placeWatermark()</script>
<div id="legacyOuterWrapper"><div align="center" id="watermark">
<div class="legacybox">
<h1>Legacy Document<span class="closebutton"><a href="javascript:closeWatermark()"><img src="../../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
Sherlock is unsupported in Mac OS X v10.5 and later.</p></div></div></div>
        <a name="//apple_ref/doc/uid/20001084-SW1" title="Sherlock Scripting Language Support"></a><hr /><H1><a name="//apple_ref/doc/uid/20001084-BBCCGFCG" title="Sherlock Scripting Language Support"></a>Sherlock Scripting Language Support</H1><p>Sherlock provides you with two different languages—JavaScript and XQuery—for writing your channel’s script code. These languages provide you with both the power and flexibility to process data and manipulate your channel’s contents dynamically. This article provides a brief introduction to each language and provides information about Apple’s implementation.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="Languages.html#//apple_ref/doc/uid/20001084-96925">Introduction to JavaScript</a>
				
			<br/>
			
        
			
			
				<a href="Languages.html#//apple_ref/doc/uid/20001084-97786">Introduction to XQuery</a>
				
			<br/>
			
        
			
			
				<a href="Languages.html#//apple_ref/doc/uid/20001084-97317">Deciding Which Language To Use</a>
				
			<br/>
			
        
			
			
				<a href="Languages.html#//apple_ref/doc/uid/20001084-107179">Supported XQuery Functions</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/20001084-96925" title="Introduction to JavaScript"></a><h2>Introduction to JavaScript</h2><p>The JavaScript language was originally developed by Netscape as a way to implement dynamic HTML pages in a client’s web browser. JavaScript is an interpreted language whose syntax resembles those of C in some aspects, but which also includes a mechanism for declaring and using objects. JavaScript is also known by the name ECMAScript and is typically used for writing short subroutines to manipulate browser data or respond to user interactions within web pages. </p><p>Sherlock supports JavaScript as one of the primary languages for writing triggers. Sherlock’s uses a standard implementation of the JavaScript engine to interpret and execute script code in the Sherlock application environment. The JavaScript syntax is documented in numerous third-party books and is not covered in this article. However, developers familiar with the C and Java languages will find some familiar programming constructs. </p><p>Apple provides several predefined objects for JavaScript code to use. These objects are specific to the Sherlock channel environment and are described in more detail in <span class="content_text"><a href="ScriptExtensions.html#//apple_ref/doc/uid/20001085-160650">“JavaScript Extensions.”</a></span></p><a name="//apple_ref/doc/uid/20001084-97786" title="Introduction to XQuery"></a><h2>Introduction to XQuery</h2><p>XQuery is a part of the XML Query specification currently being defined by the World Wide Web Consortium. The goal of XML Query is to provide a convenient way to extract data from real and virtual documents on the web. The medium for achieving this goal is XML and the script language used to manipulate the data is called XQuery. </p><p>A complete discussion of the XQuery language is beyond the scope of this article. For the latest information about XML Query, visit the World Wide Web Consortium website (<code>http://www.w3c.org/XML/Query</code>). This site includes information about the XQuery language and other current developments. </p><p>Apple provides several additions to the XQuery language that allow you to manage Sherlock resources. Apple’s additions are documented in <span class="content_text"><a href="ScriptExtensions.html#//apple_ref/doc/uid/20001085-160986">“XQuery Extensions.”</a></span> </p><p>For new and experienced XQuery programmers, the following sections include some tips and techniques for using XQuery in your Sherlock channels. </p><a name="//apple_ref/doc/uid/20001084-97806" title="Accessing the Data Store"></a><h3>Accessing the Data Store</h3><p>Because XQuery triggers do not have access to the data store, you must use the <code>inputs</code> and <code>output</code> attributes of the trigger to get and set data store values. These parameters are described further in the section <span class="content_text"><a href="ScriptExtensions.html#//apple_ref/doc/uid/20001085-134716">“Trigger Tag Syntax.”</a></span> </p><p>An alternative to using the <code>output</code> attribute to return values is to return a dictionary of key/value pairs instead. When you return a dictionary of values from an XQuery trigger, the data store interprets the keys of the dictionary as paths. The data store then assigns the value for each key back to the corresponding path.</p><a name="//apple_ref/doc/uid/20001084-97648" title="Commenting Out Text"></a><h3>Commenting Out Text</h3><p>Comments in XQuery begin with an open curly brace followed by two hyphens. To close the comment, use two hyphens followed by a close curly brace, as shown in the following example:</p><div class="codesample"><table><tr><td scope="row"><pre>{-- Comments go here. --}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/20001084-98124" title="Support for Additional Data Types"></a><h3>Support for Additional Data Types</h3><p>Apple defines additional data types to supplement those provided by the XQuery language. Among the data types are the <code>data</code>, <code>dictionary</code>, and <code>url</code> types, which correspond to the Core Foundation types CFDataRef, CFDictionaryRef, and CFURLRef respectively. </p><p>The <code>dictionary</code> type is especially useful when writing XQuery-based triggers. To create a dictionary, you use the <code>dictionary</code> function provided by Apple and defined in <span class="content_text"><a href="ScriptExtensions.html#//apple_ref/doc/uid/20001085-160986">“XQuery Extensions.”</a></span> When you return a dictionary from an XQuery trigger, Sherlock interprets the dictionary keys as data store paths and proceeds to update the corresponding values with the dictionary data. </p><a name="//apple_ref/doc/uid/20001084-98040" title="Accessing the Web"></a><h3>Accessing the Web</h3><p>Apple provides several additions to the XQuery language that make it easy to access web-based resources. The additions are built on top of Apple’s Web Foundation Framework and provide access to the web using the HTTP protocol.</p><p>To request a URL, you can use any of the following functions:</p><ul class="spaceabove"><li class="li"><p><code>http-get</code></p></li><li class="li"><p><code>http-head</code></p></li><li class="li"><p><code>http-post</code></p></li><li class="li"><p><code>http-request</code></p></li></ul><p>These functions take the requested URL and any parameters and use them to generate an HTTP request. They return a dictionary of keys identifying the returned data and status information. </p><a name="//apple_ref/doc/uid/20001084-97317" title="Deciding Which Language To Use"></a><h2>Deciding Which Language To Use</h2><p>When it comes time to write your trigger code, you need to choose which language to use. Most tasks can be performed using either JavaScript or XQuery; however, some tasks are better performed in one language than the other. Knowing which language to use for a given trigger can simplify the channel development process.</p><p>Common uses for the JavaScript language include executing conditional code, putting values in the data store, and opening URLs based on user actions.</p><p>Advantages of using the JavaScript language to develop triggers and services include:</p><ul class="ul"><li class="li"><p>JavaScript triggers run synchronously, allowing for more dynamic processing of inputs.</p></li><li class="li"><p>Data store variables can be retrieved and set directly using the DataStore object.</p></li><li class="li"><p>JavaScript is an established language with numerous resources available for learning the language.</p></li><li class="li"><p>JavaScript can use XQuery functions through the XMLQuery object.</p></li></ul><p>Disadvantages include:</p><ul class="ul"><li class="li"><p>Performance of JavaScript triggers is typically slower due to their synchronous execution.</p></li><li class="li"><p>JavaScript does not have a strong set of tools for processing text and XML expressions.</p></li><li class="li"><p>There is no direct way to initiate HTTP requests from JavaScript. They must be performed using the XQuery functions.</p></li></ul><p>Common uses for the XQuery language include retrieving data from a URL and parsing XML/HTML to create a list of results.</p><p>Advantages of using the XQuery language to develop triggers and services include:</p><ul class="ul"><li class="li"><p>The XQuery syntax is well suited for transforming data and processing XML expressions.</p></li><li class="li"><p>XQuery triggers run asynchronously by default, providing better performance and the ability to process several expressions simultaneously.</p></li><li class="li"><p>Apple-provided extensions make it easy to access web pages and Sherlock web services.</p></li></ul><p>Disadvantages include:</p><ul class="ul"><li class="li"><p>The XQuery specification is still in flux and subject to change. </p></li><li class="li"><p>There are fewer resources available for learning the XQuery syntax.</p></li><li class="li"><p>XQuery triggers cannot access the data store directly. Triggers must use the <code>inputs</code> and <code>output</code> attributes to move data back and forth</p></li></ul><a name="//apple_ref/doc/uid/20001084-107179" title="Supported XQuery Functions"></a><h2>Supported XQuery Functions</h2><p>Sherlock supports a subset of the XQuery functions defined at <span class="content_text"><a href="http://www.w3.org/TR/2002/WD-xquery-operators-20020816/" target="_blank">http://www.w3.org/TR/2002/WD-xquery-operators-20020816/</a></span> . The supported functions are listed here in functional groups.</p><dl class="termdef">	<dl class="content_text"><b>Date, Time, and Duration</b><dd><p><code>current-dateTime</code>, <code>dateTime</code>, <code>date</code>, <code>time</code>, <code>duration</code></p></dd></dl><dl class="content_text"><b>Numbers</b><dd><p><code>number</code>, <code>ceiling</code>, <code>floor</code>, <code>round</code>, <code>sum</code></p></dd></dl><dl class="content_text"><b>Strings</b><dd><p><code>string</code>, <code>string-length</code>, <code>normalize-space</code>, <code>concat</code>, <code>contains</code>, <code>starts-with</code>, <code>ends-with</code>, <code>substring</code>, <code>substring-after</code>, <code>substring-before</code>, <code>translate</code>, <code>compare</code>, <code>lower-case</code>, <code>upper-case</code>, <code>replace</code>, <code>string-pad</code>, <code>match</code>, <code>matches</code>, <code>string-join</code>, <code>codepoints-to-string</code>, <code>string-to-codepoints</code></p></dd></dl><dl class="content_text"><b>Other</b><dd><p><code>document</code>, <code>count</code>, <code>local-name</code>, <code>boolean</code>, <code>false</code>, <code>true</code>, <code>not</code>, <code>empty</code>, <code>exists</code>, <code>distinct-values</code>, <code>distinct-nodes</code>, <code>insert</code>, <code>remove</code>, <code>sublist</code>, <code>min</code>, <code>max</code>, <code>to</code>, <code>item-at</code>, <code>index-of</code>, <code>deep-equal</code></p></dd></dl></dl><a name="//apple_ref/doc/uid/20001084-119929" title="Deprecated XQuery Constructs in Mac OS X 10.3"></a><h3>Deprecated XQuery Constructs in Mac OS X 10.3</h3><p>In Mac OS X 10.3, <span class="content_text">Table 1</span> list identifies the XQuery constructs that are being deprecated. You should update your channel code to eliminate calls these functions.</p><a name="//apple_ref/doc/uid/20001084-119941-BBCDEAED" title="Table 1Deprecated XQuery constructs"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/20001084-119941" title="Table 1Deprecated XQuery constructs"></a><strong>Table 1&nbsp;&nbsp;</strong>Deprecated XQuery constructs</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Construct</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Notes</p></th></tr><tr><td  scope="row"><p><code>sortby</code> function</p></td><td ><p>This function is being replaced by the “order by” expressions instead.</p></td></tr><tr><td  scope="row"><p><code>==</code> and <code>!==</code> operators</p></td><td ><p>Use the <code>is</code> and <code>isnot</code> operators instead.</p></td></tr><tr><td  scope="row"><p>XML constructs with non-quoted attributes</p></td><td ><p>An example of this construct is <code>&lt;a href={$link} /></code>. You must now include quotes around the attribute value, so that the above construct would now be <code>&lt;a href="{$link}" /></code>.</p></td></tr><tr><td  scope="row"><p>Using uninitialized variables</p></td><td ><p>If you use a variable that has not been defined or initialized with a value, you will get an error.</p></td></tr><tr><td  scope="row"><p>Comments</p></td><td ><p>Using a close curly brace character <code>}</code> inside a comment now generates an error.</p></td></tr></table></div>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="DevelopingChannels.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="ScriptExtensions.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2002, 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-04-09<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleApplications/Conceptual/Sherlock/Concepts/Languages.html%3Fid%3D10000121i-2.2&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleApplications/Conceptual/Sherlock/Concepts/Languages.html%3Fid%3D10000121i-2.2&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleApplications/Conceptual/Sherlock/Concepts/Languages.html%3Fid%3D10000121i-2.2&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
