<HTML>		<HEAD>		<TITLE>			ODBCAdaptor		</TITLE>		</HEAD>	<body bgcolor="#ffffff"><!--start of banner --><!-- #include virtual="/techpubs/navbar" --><!-- end of banner --><!--start of path --><font face="Geneva,Helvetica,Arial" size="1"><b>PATH<spacer type="horizontal" size="5">&nbsp;</b> <a href="../../../../../../../index.html" target="_top">Documentation</a> <b>&gt;</b> <a href="../../../../../../webobjects.html" target="_top">WebObjects 4.5</a> <b>&gt;</b>ODBCEOAdaptor Reference</font><br><br><!--end of path --><a href="../ODBCEOAdaptorTOC.html"><img src="../../../../../../images/up.gif" border="0" alt="Table of Contents"></a> <a name = "ODBCAdaptor"><BR><h1><FONT COLOR=\"#000066\"><a name="//apple_ref/java/cl/ODBCAdaptor">ODBCAdaptor</a></FONT></h1><br></a><blockquote><b>Inheritsfrom: </b> EOAdaptor : NSObject</blockquote><blockquote><b>Package: </b>com.apple.yellow.odbceoadaptor</blockquote><HR SIZE=4><br><h2>Class Description</h2><hr><p>An ODBCAdaptor represents a single connection to an ODBC databaseserver, and is responsible for keeping login and model information,performing ODBC-specific formatting of SQL expressions, and reportingerrors.</p><p>ODBC (Open Data Base Connectivity) defines a standard interfacethat Windows applications can use to access any data source. Unlikethe other Enterprise Objects Frameworks adaptors that support a singletype of database, the ODBC adaptor supports any data source thathas an ODBC driver. Consequently, in addition to having standardadaptor features, the ODBC adaptor also manages information relatingto the driver and to the data types defined by the data source thedriver supports.</p><p>The ODBCAdaptor class doesn't support nested transactions.</p><br><br><br><h2>Constants</h2><hr><p>ODBCAdaptor defines the following string constants for useas connection dictionary keys.</p><br><table border = \"1\"><tr><td scope="row"><b>Constant</b></td><td><b>Corresponding value in the connection dictionary</b></td></tr><tr><td scope="row"><a name = "BICBFDBB"><tt>dataSourceKey</tt></a></td><td>The name of the data source to connect to.</td></tr><tr><td scope="row"><a name = "BICGHCFJ"><tt>userNameKey</tt></a></td><td>The name of the user to log in as.</td></tr><tr><td scope="row"><a name = "BICFHFGF"><tt>passwordKey</tt></a></td><td>The user's password.</td></tr><tr><td scope="row"><a name = "BICHAFIA"><tt>connectionStringKey</tt></a></td><td>The complete string used to connect to the database.If this key is present in the dictionary,  <a frame= "conv" href="#BICBFDBB">dataSourceKey</a>,  <a frame= "conv" href="#BICGHCFJ">userNameKey</a>, and  <a frame= "conv" href="#BICFHFGF">passwordKey</a> are ignored.</td></tr><tr><td scope="row"><a name = "BICCFEEJ"><tt>typeInfoKey</tt></a></td><td>Information about the types supported by the driver. </td></tr><tr><td scope="row"><a name = "BICJHJFH"><tt>driverInfoKey</tt></a></td><td>Information about driver, including the driver name,version, and so on. </td></tr></table><br><p>For more information on the connection dictionary, see  <a frame= "conv" href="../Introduction.html#BCEFADAC">"The Connection Dictionary" </a> inthe ODBCEOAdaptor Framework introduction.</p><p>Additionally, ODBCAdaptor defines a string constant for useas a key in an exception's userInfo dictionary.</p><br><table border = \"1\"><tr><td scope="row"><b>Constant</b></td><td><b>Corresponding value in an exception's userInfo dictionary</b></td></tr><tr><td scope="row"><a name = "BCECAAAH"><tt>SQLStatesKey</tt></a></td><td>An array of strings. Each string is a five charactercode corresponding to an ODBC SQL state.</td></tr></table><br><br><br><h2>Method Types</h2><hr><blockquote><dl><dt>Mapping external typesto internal types</dt><dd> <a frame= "conv" href="#//apple_ref/java/clm/ODBCAdaptor/assignExternalTypeForAttribute">assignExternalTypeForAttribute</a></dd><dd> <a frame= "conv" href="#//apple_ref/java/clm/ODBCAdaptor/externalTypeForOdbcType">externalTypeForOdbcType</a></dd><dd> <a frame= "conv" href="#//apple_ref/java/clm/ODBCAdaptor/getOdbcInfoWithConnectionDictionary">getOdbcInfoWithConnectionDictionary</a></dd><dd> <a frame= "conv" href="#//apple_ref/java/clm/ODBCAdaptor/odbcTypeForExternalType">odbcTypeForExternalType</a></dd><dd> <a frame= "conv" href="#//apple_ref/java/clm/ODBCAdaptor/odbcTypeForStringRepresentation">odbcTypeForStringRepresentation</a></dd><dd> <a frame= "conv" href="#//apple_ref/java/clm/ODBCAdaptor/resetOdbcInfoWithConnectionDictionary">resetOdbcInfoWithConnectionDictionary</a></dd><dd> <a frame= "conv" href="#//apple_ref/java/clm/ODBCAdaptor/stringRepresentationForOdbcType">stringRepresentationForOdbcType</a></dd></dl><dl><dt>Access information inthe connection dictionary</dt><dd> <a frame= "conv" href="#//apple_ref/java/instm/ODBCAdaptor/odbcConnectionString">odbcConnectionString</a></dd><dd> <a frame= "conv" href="#//apple_ref/java/clm/ODBCAdaptor/driverInfoForModel">driverInfoForModel</a></dd><dd> <a frame= "conv" href="#//apple_ref/java/clm/ODBCAdaptor/typeInfoForModel">typeInfoForModel</a></dd><dd> <a frame= "conv" href="#//apple_ref/java/instm/ODBCAdaptor/driverInfo">driverInfo</a></dd><dd> <a frame= "conv" href="#//apple_ref/java/instm/ODBCAdaptor/typeInfo">typeInfo</a></dd></dl></blockquote><br><br><h2>Static Methods</h2><hr><a name = "assignExternalTypeForAttribute_"><BR><h3><a name="//apple_ref/java/clm/ODBCAdaptor/assignExternalTypeForAttribute">assignExternalTypeForAttribute</a></h3></a><p><code>public static void <b>assignExternalInfoForAttribute</b>(EOAttribute <em>attribute</em>)</code></p>Sets the external information for <em>attribute</em> basedon the internal type, precision, and width.<hr WIDTH=25% ALIGN=LEFT><a name = "driverInfoForModel_"><BR><h3><a name="//apple_ref/java/clm/ODBCAdaptor/driverInfoForModel">driverInfoForModel</a></h3></a><p><code>public static NSDictionary <b>driverInfoForModel</b>(com.apple.yellow.eoaccess.EOModel <em>model</em>)</code></p>Returns an NSDictionary containing the driverinformation cached in the connection dictionary of <em>model</em>.If the information is not yet cached in <em>model</em>,connects to the database to get it.<p><b>See Also: </b>  <a frame= "conv" href="#//apple_ref/java/clm/ODBCAdaptor/typeInfoForModel">typeInfoForModel</a>,  <a frame= "conv" href="#//apple_ref/java/instm/ODBCAdaptor/driverInfo">driverInfo</a>,  <a frame= "conv" href="#//apple_ref/java/instm/ODBCAdaptor/typeInfo">typeInfo</a></p><hr WIDTH=25% ALIGN=LEFT><a name = "externalTypeForOdbcType_model_"><BR><h3><a name="//apple_ref/java/clm/ODBCAdaptor/externalTypeForOdbcType">externalTypeForOdbcType</a></h3></a><p><code>public static String <b>externalTypeForOdbcType</b>(int <em>type</em>,com.apple.yellow.eoaccess.EOModel <em>model</em>)</code></p>Returns the external type that represents thebest match for an ODBC <em>type</em> in <em>model</em>.<hr WIDTH=25% ALIGN=LEFT><a name = "getOdbcInfoWithConnectionDictionary_"><BR><h3><a name="//apple_ref/java/clm/ODBCAdaptor/getOdbcInfoWithConnectionDictionary">getOdbcInfoWithConnectionDictionary</a></h3></a><p><code>public static NSDictionary <b>getOdbcInfoWithConnectionDictionary</b>(NSDictionary <em>connectionDictionary</em>)</code></p>Sets up the typeInfo and driverInfo dictionariesin <em>connectionDictionary</em>, and returnsan updated connection dictionary. Creates an <code>ODBCAdaptor</code>, <code>ODBCContext</code>,and <code>ODBCChannel</code>, andconnects to the database to get the information for the typeInfoand driverInfo dictionaries.<hr WIDTH=25% ALIGN=LEFT><a name = "odbcTypeForExternalType_model_"><BR><h3><a name="//apple_ref/java/clm/ODBCAdaptor/odbcTypeForExternalType">odbcTypeForExternalType</a></h3></a><p><code>public static String <b>odbcTypeForExternalType</b>(String <em>externalType</em>,com.apple.yellow.eoaccess.EOModel <em>model</em>)</code></p>Returns the ODBC type for <em>externalType</em>,as defined in the typeInfo dictionary in <em>model</em>'sconnection dictionary.<hr WIDTH=25% ALIGN=LEFT><a name = "odbcTypeForStringRepresentation_"><BR><h3><a name="//apple_ref/java/clm/ODBCAdaptor/odbcTypeForStringRepresentation">odbcTypeForStringRepresentation</a></h3></a><p><code>public static int <b>odbcTypeForStringRepresentation</b>(String <em>type</em>)</code></p>Returns the ODBC type (such as SQL_CHAR) for <em>type</em> (suchas @"CHAR"). The method  <a frame= "conv" href="#//apple_ref/java/clm/ODBCAdaptor/stringRepresentationForOdbcType">stringRepresentationForOdbcType</a> performsthe opposite function: returning a string for a specified ODBC type.These methods are used in conjunction to encode ODBC types in thetypeInfo dictionary.<hr WIDTH=25% ALIGN=LEFT><a name = "resetOdbcInfoWithConnectionDictionary_"><BR><h3><a name="//apple_ref/java/clm/ODBCAdaptor/resetOdbcInfoWithConnectionDictionary">resetOdbcInfoWithConnectionDictionary</a></h3></a><p><code>public static NSDictionary <b>resetOdbcInfoWithConnectionDictionary</b>(NSDictionary <em>connectionDictionary</em>)</code></p>Removes the typeInfo and driverInfo dictionariesfrom a copy of <em>connectionDictionary</em> andreturns the modified connection dictionary.<hr WIDTH=25% ALIGN=LEFT><a name = "stringRepresentationForOdbcType_"><BR><h3><a name="//apple_ref/java/clm/ODBCAdaptor/stringRepresentationForOdbcType">stringRepresentationForOdbcType</a></h3></a><p><code>public static String <b>stringRepresentationForOdbcType</b>(int <em>type</em>)</code></p>Returns the string representation of <em>type</em>-forexample, for the type SQL_CHAR this method would return the string@"CHAR". The method  <a frame= "conv" href="#//apple_ref/java/clm/ODBCAdaptor/odbcTypeForStringRepresentation">odbcTypeForStringRepresentation</a> performsthe opposite function: returning the ODBC type for a specified string.These methods are used in conjunction to encode ODBC types in thetypeInfo dictionary. <hr WIDTH=25% ALIGN=LEFT><a name = "typeInfoForModel_"><BR><h3><a name="//apple_ref/java/clm/ODBCAdaptor/typeInfoForModel">typeInfoForModel</a></h3></a><p><code>public static NSDictionary <b>typeInfoForModel</b>(com.apple.yellow.eoaccess.EOModel <em>model</em>)</code></p>Returns an NSDictionary containing the typeinformation cached in the connection dictionary of <em>model</em>. Ifthe information is not yet cached in <em>model</em>,connects to the database to get it.<p><b>See Also: </b>  <a frame= "conv" href="#//apple_ref/java/clm/ODBCAdaptor/driverInfoForModel">driverInfoForModel</a>,  <a frame= "conv" href="#//apple_ref/java/instm/ODBCAdaptor/driverInfo">driverInfo</a>,  <a frame= "conv" href="#//apple_ref/java/instm/ODBCAdaptor/typeInfo">typeInfo</a></p><hr WIDTH=25% ALIGN=LEFT><BR><BR><h2>Instance Methods</h2><hr><a name = "driverInfo"><BR><h3><a name="//apple_ref/java/instm/ODBCAdaptor/driverInfo">driverInfo</a></h3></a><p><code>public NSDictionary <b>driverInfo</b>()</code></p>Returns an NSDictionary containing the driverinformation cached in the receiver's model's connection dictionary.If the information is not yet cached in the model, connects to thedatabase to get it.<p><b>See Also: </b>  <a frame= "conv" href="#//apple_ref/java/instm/ODBCAdaptor/typeInfo">typeInfo</a></p><hr WIDTH=25% ALIGN=LEFT><a name = "odbcConnectionString"><BR><h3><a name="//apple_ref/java/instm/ODBCAdaptor/odbcConnectionString">odbcConnectionString</a></h3></a><p><code>public String <b>odbcConnectionString</b>()</code></p>Returns the user name, password, and data sourceas a string that's used to connect to the database.<hr WIDTH=25% ALIGN=LEFT><a name = "typeInfo"><BR><h3><a name="//apple_ref/java/instm/ODBCAdaptor/typeInfo">typeInfo</a></h3></a><p><code>public NSDictionary <b>typeInfo</b>()</code></p>Returns an NSDictionary containing the typeinformation cached in the receiver's model's connection dictionary.If the information is not yet cached in the model, connects to thedatabase to get it.<p><b>See Also: </b>  <a frame= "conv" href="#//apple_ref/java/instm/ODBCAdaptor/driverInfo">driverInfo</a>,  <a frame= "conv" href="#//apple_ref/java/clm/ODBCAdaptor/driverInfoForModel">driverInfoForModel</a>,  <a frame= "conv" href="#//apple_ref/java/clm/ODBCAdaptor/typeInfoForModel">typeInfoForModel</a></p><hr WIDTH=25% ALIGN=LEFT><BR><br><a href="../ODBCEOAdaptorTOC.html"><img src="../../../../../../images/up.gif" border="0" alt="Table of Contents"></a> </BODY></HTML>