<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Manipulating the Default Volume and Directory (IM: F)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING92></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Files-91.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-93.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Files-2.html"><B>Files</B></A> / <BR><DD><A HREF="Files-72.html"><B>Chapter 2 - File Manager</B></A> / <A HREF="Files-89.html"><B>Using the File Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING92-0></A>
<H2><A NAME=MARKER-9-335></A>Manipulating the Default Volume and Directory</H2>
 When your application is running, the File Manager maintains a default volume and a default directory for it. The <B>default directory</B> is used in File Manager routines whenever you don't explicitly specify some directory. The <B>default volume</B> is the volume containing the default directory.<A NAME=MARKER-2-336></A><A NAME=MARKER-2-337></A><A NAME=MARKER-2-338></A><A NAME=MARKER-2-339></A><P>
 If you pass 0 as the volume specification with routines that operate on a volume (such as mounting or ejecting routines), the File Manager assumes that you want to perform the operation on the default volume. Initially, the volume used to start up the application is set as the default volume, but your application can designate any mounted volume as the default volume.<P>
 With routines that access files or directories, if you don't specify a directory <I>and</I> you pass a volume specification of 0, the File Manager assumes that the file or directory is located in the default directory. Initially, the default directory is set to the root directory of the default volume, but your application can designate any directory as the default directory.<P>
<DL>
<DT><B>Note</B>
<DD>Don't confuse the default directory and volume maintained by the <BR>File Manager with the current directory and volume maintained by <BR>the Standard File Package. Although the default volume and current volume are initially the same, they can differ whenever your application resets one of them. See the chapter "Standard File Package" in this book for more information about the current directory and volume.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 The provision of a default volume was originally intended as a convenient way for <BR>you to limit all File Manager calls to a particular volume. The default directory was introduced along with HFS as an analog to the default volume. In general, however, it <BR>is safest to specify both a volume and a directory explicitly in all File Manager calls. In particular, the introduction of file system specification records has rendered default volumes and directories largely obsolete. As a result, you should avoid relying on them.<P>
 In some cases, however, you might want to set the default volume or directory explicitly. You can determine the default volume and directory by calling the <CODE>GetVol</CODE> or <CODE>HGetVol</CODE> function. You can explicitly set the default directory and volume by calling the <CODE>SetVol</CODE> or <CODE>HSetVol</CODE> function. For reasons explained later, however, the use of <CODE>HSetVol</CODE> and its low-level equivalent <CODE>PBHSetVol</CODE> is discouraged.<P>
 To set the default volume only, you can call <CODE>SetVol</CODE>, passing it the volume reference number of the volume you want to establish as the default volume, as in this example:<P>
<PRE>
myErr := SetVol(NIL, myVRefNum);
</PRE>
 You can instead specify the volume by name, but because volume names might not be unique, it is best to use the volume reference number.<P>
 To set both the default directory and the default volume, you could call <CODE>HSetVol</CODE>, passing it the appropriate volume reference number and directory ID, as in this example:<P>
<PRE>
myErr := HSetVol(NIL, myVRefNum, myDirID);
</PRE>
 However, using <CODE>HSetVol</CODE> can lead to problems in certain circumstances. When you call <CODE>HSetVol</CODE> (or its low-level version <CODE>PBHSetVol</CODE>) and pass a working directory reference number in the <CODE>vRefNum</CODE> parameter, the File Manager stores the encoded volume reference number and directory ID separately. If you later call <CODE>GetVol</CODE> (or its low-level version <CODE>PBGetVol</CODE>), the File Manager returns that volume reference number, not the working directory reference number you passed to <CODE>HSetVol</CODE>. The net result is that any code using the results of the <CODE>GetVol</CODE> call will access the root directory of the default volume, not the actual default directory.<A NAME=MARKER-2-194></A><P>
 It is important to realize that calling <CODE>HSetVol</CODE> is perfectly safe if all the code executing in your application's partition always calls <CODE>HGetVol</CODE> instead of <CODE>GetVol</CODE>. This is because <CODE>HGetVol</CODE> returns a working directory reference number whenever the previous call to <CODE>HSetVol</CODE> passed one in. Calling <CODE>HSetVol</CODE> can create problems only if your application is running under a system software version prior to version 7.0. In that case, a desk accessory might be opened in your application's partition, thereby inheriting your application's default volume and directory. If that desk accessory calls <CODE>GetVol</CODE> instead of <CODE>HGetVol</CODE>, it might receive a volume reference number when it expects a working directory reference number, as described in the previous paragraph. To avoid this problem, you can simply use <CODE>SetVol</CODE> (or <CODE>PBSetVol</CODE>) instead of <CODE>HSetVol</CODE>, as in this example:<P>
<PRE>
myErr := SetVol(NIL, myVRefNum);
</PRE>
 In this case, the <CODE>myVRefNum</CODE> parameter should contain a working directory <BR>reference number.<A NAME=MARKER-2-345></A><A NAME=MARKER-2-346></A><A NAME=MARKER-2-347></A><A NAME=MARKER-2-348></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Files-91.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-93.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Files-3.html">&copy; Apple Computer, Inc.</A><br>2 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
