<html><head><title>Mac OS X
 Manual Page For traceroute(8)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/8/traceroute" title="Mac OS X
 Manual Page for traceroute(8)"><!-- headerDoc=man; indexgroup=Section 8; uid="//apple_ref/doc/man/8/traceroute"; name=traceroute(8) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
TRACEROUTE(8)             BSD System Manager's Manual            TRACEROUTE(8)

<b>NAME</b>
     <b>traceroute</b> -- print the route packets take to network host

<b>SYNOPSIS</b>
     <b>traceroute</b> [<b>-dFISdNnrvx</b>] [<b>-f</b> <u>first</u><b>_</b><u>ttl</u>] [<b>-g</b> <u>gateway</u>] [<b>-i</b> <u>iface</u>] [<b>-M</b> <u>first</u><b>_</b><u>ttl</u>] [<b>-m</b> <u>max</u><b>_</b><u>ttl</u>] [<b>-P</b> <u>proto</u>]
                [<b>-p</b> <u>port</u>] [<b>-q</b> <u>nqueries</u>] [<b>-s</b> <u>src</u><b>_</b><u>addr</u>] [<b>-t</b> <u>tos</u>] [<b>-w</b> <u>waittime</u>] [<b>-z</b> <u>pausemsecs</u>] <u>host</u>
                [<u>packetsize</u>]

<b>DESCRIPTION</b>
     The Internet is a large and complex aggregation of network hardware, connected together by gateways.
     Tracking the route one's packets follow (or finding the miscreant gateway that's discarding your pack-<font color="#ffffff" class="whiteout">ets)&nbsp;packets)</font>
     ets) can be difficult.  <b>Traceroute</b> utilizes the IP protocol `time to live' field and attempts to elicit
     an ICMP TIME_EXCEEDED response from each gateway along the path to some host.

     The only mandatory parameter is the destination host name or IP number.  The default probe datagram
     length is 40 bytes, but this may be increased by specifying a packet size (in bytes) after the destina-<font color="#ffffff" class="whiteout">tion&nbsp;destination</font>
     tion host name.

     Other options are:

     <b>-f</b> <u>first</u><b>_</b><u>ttl</u>
             Set the initial time-to-live used in the first outgoing probe packet.

     <b>-F</b>      Set the "don't fragment" bit.

     <b>-d</b>      Enable socket level debugging.

     <b>-g</b> <u>gateway</u>
             Specify a loose source route gateway (8 maximum).

     <b>-i</b> <u>iface</u>
             Specify a network interface to obtain the source IP address for outgoing probe packets. This is
             normally only useful on a multi-homed host. (See the <b>-s</b> flag for another way to do this.)

     <b>-I</b>      Use ICMP ECHO instead of UDP datagrams.  (A synonym for "-P icmp").

     <b>-M</b> <u>first</u><b>_</b><u>ttl</u>
             Set the initial time-to-live value used in outgoing probe packets.  The default is 1, i.e.,
             start with the first hop.

     <b>-m</b> <u>max</u><b>_</b><u>ttl</u>
             Set the max time-to-live (max number of hops) used in outgoing probe packets.  The default is
             <u>net.inet.ip.ttl</u> hops (the same default used for TCP connections).

     <b>-N</b>      Disables the increment of the destination port (see -p). Useful for using tcpdump through fire-<font color="#ffffff" class="whiteout">walls.&nbsp;firewalls.</font>
             walls.

     <b>-n</b>      Print hop addresses numerically rather than symbolically and numerically (saves a nameserver
             address-to-name lookup for each gateway found on the path).

     <b>-P</b> <u>proto</u>
             Send packets of specified IP protocol. The currently supported protocols are: UDP , TCP , GRE
             and ICMP Other protocols may also be specified (either by name or by number), though <b>traceroute</b>
             does not implement any special knowledge of their packet formats. This option is useful for
             determining which router along a path may be blocking packets based on IP protocol number. But
             see BUGS below.

     <b>-p</b> <u>port</u>
             Protocol specific. For UDP and TCP, sets the base <u>port</u> number used in probes (default is
             33434).  <b>Traceroute</b> hopes that nothing is listening on UDP ports <u>base</u> to <u>base+nhops-1</u> at the
             destination host (so an ICMP PORT_UNREACHABLE message will be returned to terminate the route
             tracing).  If something is listening on a port in the default range, this option can be used to
             pick an unused port range.

     <b>-q</b> <u>nqueries</u>
             Set the number of probes per ``ttl'' to <u>nqueries</u> (default is three probes).

     <b>-r</b>      Bypass the normal routing tables and send directly to a host on an attached network.  If the
             host is not on a directly-attached network, an error is returned.  This option can be used to
             ping a local host through an interface that has no route through it (e.g., after the interface
             was dropped by <a href="routed.8.html#//apple_ref/doc/man/8/routed">routed(8)</a>).

     <b>-s</b> <u>src</u><b>_</b><u>addr</u>
             Use the following IP address (which must be given as an IP number, not a hostname) as the
             source address in outgoing probe packets.  On hosts with more than one IP address, this option
             can be used to force the source address to be something other than the IP address of the inter-<font color="#ffffff" class="whiteout">face&nbsp;interface</font>
             face the probe packet is sent on.  If the IP address is not one of this machine's interface
             addresses, an error is returned and nothing is sent.  (See the <b>-i</b> flag for another way to do
             this.)

     <b>-S</b>      Print a summary of how many probes were not answered for each hop.

     <b>-t</b> <u>tos</u>  Set the <u>type-of-service</u> in probe packets to the following value (default zero).  The value must
             be a decimal integer in the range 0 to 255.  This option can be used to see if different types-<font color="#ffffff" class="whiteout">of-service&nbsp;typesof-service</font>
             of-service result in different paths.  (If you are not running a 4.4BSD or later system, this
             may be academic since the normal network services like telnet and ftp don't let you control the
             TOS).  Not all values of TOS are legal or meaningful - see the IP spec for definitions.  Useful
             values are probably `-t 16' (low delay) and `-t 8' (high throughput).

     <b>-v</b>      Verbose output.  Received ICMP packets other than TIME_EXCEEDED and UNREACHABLEs are listed.

     <b>-w</b>      Set the time (in seconds) to wait for a response to a probe (default 5 sec.).

     <b>-x</b>      Toggle IP checksums. Normally, this prevents traceroute from calculating IP checksums. In some
             cases, the operating system can overwrite parts of the outgoing packet but not recalculate the
             checksum (so in some cases the default is to not calculate checksums and using <b>-x</b> causes them
             to be calculated). Note that checksums are usually required for the last hop when using ICMP
             ECHO probes ( <b>-I</b> ). So they are always calculated when using ICMP.

     <b>-z</b> <u>pausemsecs</u>
             Set the time (in milliseconds) to pause between probes (default 0).  Some systems such as
             Solaris and routers such as Ciscos rate limit ICMP messages. A good value to use with this this
             is 500 (e.g. 1/2 second).

     This program attempts to trace the route an IP packet would follow to some internet host by launching
     UDP probe packets with a small ttl (time to live) then listening for an ICMP "time exceeded" reply from
     a gateway.  We start our probes with a ttl of one and increase by one until we get an ICMP "port
     unreachable" (which means we got to "host") or hit a max (which defaults to <u>net.inet.ip.ttl</u> hops &amp; can
     be changed with the <b>-m</b> flag).  Three probes (changed with <b>-q</b> flag) are sent at each ttl setting and a
     line is printed showing the ttl, address of the gateway and round trip time of each probe.  If the
     probe answers come from different gateways, the address of each responding system will be printed.  If
     there is no response within a 5 sec. timeout interval (changed with the <b>-w</b> flag), a "*" is printed for
     that probe.

     We don't want the destination host to process the UDP probe packets so the destination port is set to
     an unlikely value (if some clod on the destination is using that value, it can be changed with the <b>-p</b>
     flag).

     A sample use and output might be:

     [yak 71]% traceroute nis.nsf.net.
     traceroute to nis.nsf.net (35.1.1.48), 64 hops max, 38 byte packet
     1  helios.ee.lbl.gov (128.3.112.1)  19 ms  19 ms  0 ms
     2  lilac-dmc.Berkeley.EDU (128.32.216.1)  39 ms  39 ms  19 ms
     3  lilac-dmc.Berkeley.EDU (128.32.216.1)  39 ms  39 ms  19 ms
     4  ccngw-ner-cc.Berkeley.EDU (128.32.136.23)  39 ms  40 ms  39 ms
     5  ccn-nerif22.Berkeley.EDU (128.32.168.22)  39 ms  39 ms  39 ms
     6  128.32.197.4 (128.32.197.4)  40 ms  59 ms  59 ms
     7  131.119.2.5 (131.119.2.5)  59 ms  59 ms  59 ms
     8  129.140.70.13 (129.140.70.13)  99 ms  99 ms  80 ms
     9  129.140.71.6 (129.140.71.6)  139 ms  239 ms  319 ms
     10  129.140.81.7 (129.140.81.7)  220 ms  199 ms  199 ms
     11  nic.merit.edu (35.1.1.48)  239 ms  239 ms  239 ms

     Note that lines 2 &amp; 3 are the same.  This is due to a buggy kernel on the 2nd hop system - lbl-<font color="#ffffff" class="whiteout">csam.arpa&nbsp;lblcsam.arpa</font>
     csam.arpa - that forwards packets with a zero ttl (a bug in the distributed version of 4.3 BSD).  Note
     that you have to guess what path the packets are taking cross-country since the NSFNet (129.140)
     doesn't supply address-to-name translations for its NSSes.

     A more interesting example is:

     [yak 72]% traceroute allspice.lcs.mit.edu.
     traceroute to allspice.lcs.mit.edu (18.26.0.115), 64 hops max
     1  helios.ee.lbl.gov (128.3.112.1)  0 ms  0 ms  0 ms
     2  lilac-dmc.Berkeley.EDU (128.32.216.1)  19 ms  19 ms  19 ms
     3  lilac-dmc.Berkeley.EDU (128.32.216.1)  39 ms  19 ms  19 ms
     4  ccngw-ner-cc.Berkeley.EDU (128.32.136.23)  19 ms  39 ms  39 ms
     5  ccn-nerif22.Berkeley.EDU (128.32.168.22)  20 ms  39 ms  39 ms
     6  128.32.197.4 (128.32.197.4)  59 ms  119 ms  39 ms
     7  131.119.2.5 (131.119.2.5)  59 ms  59 ms  39 ms
     8  129.140.70.13 (129.140.70.13)  80 ms  79 ms  99 ms
     9  129.140.71.6 (129.140.71.6)  139 ms  139 ms  159 ms
     10  129.140.81.7 (129.140.81.7)  199 ms  180 ms  300 ms
     11  129.140.72.17 (129.140.72.17)  300 ms  239 ms  239 ms
     12  * * *
     13  128.121.54.72 (128.121.54.72)  259 ms  499 ms  279 ms
     14  * * *
     15  * * *
     16  * * *
     17  * * *
     18  ALLSPICE.LCS.MIT.EDU (18.26.0.115)  339 ms  279 ms  279 ms

     Note that the gateways 12, 14, 15, 16 &amp; 17 hops away either don't send ICMP "time exceeded" messages or
     send them with a ttl too small to reach us.  14 - 17 are running the MIT C Gateway code that doesn't
     send "time exceeded"s.  God only knows what's going on with 12.

     The silent gateway 12 in the above may be the result of a bug in the 4.[23] BSD network code (and its
     derivatives):  4.x (x &lt;= 3) sends an unreachable message using whatever ttl remains in the original
     datagram.  Since, for gateways, the remaining ttl is zero, the ICMP "time exceeded" is guaranteed to
     not make it back to us.  The behavior of this bug is slightly more interesting when it appears on the
     destination system:

     1  helios.ee.lbl.gov (128.3.112.1)  0 ms  0 ms  0 ms
     2  lilac-dmc.Berkeley.EDU (128.32.216.1)  39 ms  19 ms  39 ms
     3  lilac-dmc.Berkeley.EDU (128.32.216.1)  19 ms  39 ms  19 ms
     4  ccngw-ner-cc.Berkeley.EDU (128.32.136.23)  39 ms  40 ms  19 ms
     5  ccn-nerif35.Berkeley.EDU (128.32.168.35)  39 ms  39 ms  39 ms
     6  csgw.Berkeley.EDU (128.32.133.254)  39 ms  59 ms  39 ms
     7  * * *
     8  * * *
     9  * * *
     10  * * *
     11  * * *
     12  * * *
     13  rip.Berkeley.EDU (128.32.131.22)  59 ms !  39 ms !  39 ms !

     Notice that there are 12 "gateways" (13 is the final destination) and exactly the last half of them are
     "missing".  What's really happening is that rip (a Sun-3 running Sun OS3.5) is using the ttl from our
     arriving datagram as the ttl in its ICMP reply.  So, the reply will time out on the return path (with
     no notice sent to anyone since ICMP's aren't sent for ICMP's) until we probe with a ttl that's at least
     twice the path length.  I.e., rip is really only 7 hops away.  A reply that returns with a ttl of 1 is
     a clue this problem exists.  <b>Traceroute</b> prints a "!" after the time if the ttl is &lt;= 1.  Since vendors
     ship a lot of obsolete (DEC's Ultrix, Sun 3.x) or non-standard (HPUX) software, expect to see this
     problem frequently and/or take care picking the target host of your probes.

     Other possible annotations after the time are <b>!H</b>, <b>!N</b>, or <b>!P</b> (host, network or protocol unreachable), <b>!S</b>
     (source route failed), <b>!F</b> (fragmentation needed - the RFC1191 Path MTU Discovery value is displayed),
     <b>!X</b> (communication administratively prohibited), <b>!V</b> (host precedence violation), <b>!C</b> (precedence cutoff
     in effect), or <b>!&lt;num&gt;</b> (ICMP unreachable code &lt;num&gt;).  These are defined by RFC1812 (which supersedes
     RFC1716).  If almost all the probes result in some kind of unreachable, <b>traceroute</b> will give up and
     exit.

     This program is intended for use in network testing, measurement and management.  It should be used
     primarily for manual fault isolation.  Because of the load it could impose on the network, it is unwise
     to use <b>traceroute</b> during normal operations or from automated scripts.

<b>AUTHOR</b>
     Implemented by Van Jacobson from a suggestion by Steve Deering.  Debugged by a cast of thousands with
     particularly cogent suggestions or fixes from C. Philip Wood, Tim Seaver and Ken Adelman.

<b>SEE</b> <b>ALSO</b>
     <a href="../man1/netstat.1.html#//apple_ref/doc/man/1/netstat">netstat(1)</a>, <a href="ping.8.html#//apple_ref/doc/man/8/ping">ping(8)</a>

<b>BUGS</b>
     When using protocols other than UDP, functionality is reduced.  In particular, the last packet will
     often appear to be lost, because even though it reaches the destination host, there's no way to know
     that because no ICMP message is sent back.  In the TCP case, <b>traceroute</b> should listen for a RST from
     the destination host (or an intermediate router that's filtering packets), but this is not implemented
     yet.

4.3 Berkeley Distribution     September 21, 2000     4.3 Berkeley Distribution
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man8/traceroute.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man8/traceroute.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man8/traceroute.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
