<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Accessing a Dictionary(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING492></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-491.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-493.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-483.html"><B>Chapter 8 - Dictionary Manager</B></A> / <A HREF="Text-489.html"><B>Using the Dictionary Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING492-0></A>
<H2><A NAME=MARKER-2-202></A>Accessing a Dictionary</H2>
 Before you can use a dictionary you must first open it. Once it is open, you can get information about it and you can use it. When you are finished with the dictionary, you must close it.<P>
<A NAME=HEADING492-2></A>
<H3>Opening and Closing the Dictionary</H3>
 <A NAME=MARKER-2-82></A>To open and use a dictionary, you must create an access path to the dictionary file using the <CODE>OpenDictionary</CODE> function. You provide a pointer to the file system specification record that defines the file, and you specify the read and write permission for the <BR>access path.<P>
 The <CODE>OpenDictionary</CODE> function returns a long integer, called a <I><A NAME=MARKER-2-32></A>dictionary reference number,</I> that specifies the open dictionary. You use that same dictionary reference number whenever you use the dictionary, and finally when you close the dictionary with the <CODE>CloseDictionary</CODE> function.<A NAME=MARKER-2-33></A><P>
 <A HREF=#MARKER-9-63>Listing 8-2</A> gives an example of how to create and close this access path. It consists of portions of the <CODE>CASE</CODE> statement from a sample application's menu-dispatching routine.<P>
<B>Listing 8-2  <A NAME=MARKER-9-63></A>Opening and closing a dictionary file</B><P>
<PRE>
      {if user selects "Open dictionary" menu item:}
      iOpenDictionary: 
         IF gDictionaryReference = 0 THEN BEGIN
            {only open my own dictionary file types}
            fileTypes[0] := kMyDictionaryFileType;


            StandardGetFile(NIL, 1, fileTypes, fileReply);
            IF fileReply.sfGood THEN BEGIN
               gDictionaryFile := fileReply.sfFile;
               {open file with read-write permission}
               err := OpenDictionary(@gDictionaryFile, 
                                    fsRdWrPerm, 
                                    gDictionaryReference);
            END;
         END;
      {if user selects "Close dictionary" menu item:}
      iCloseDictionary: 
         IF gDictionaryReference &lt;&gt; 0 THEN BEGIN
            err := CloseDictionary(gDictionaryReference);
            gDictionaryReference := 0;
         END;
</PRE>
<A NAME=HEADING492-9></A>
<H3>Obtaining Information About the Dictionary</H3>
 <A NAME=MARKER-2-203></A>You can use the <CODE>GetDictionaryInformation</CODE> function to obtain the following information about a dictionary file:<P>
<UL>
<LI>its file system specification record
<LI>the number of records it contains
<LI>the current size in bytes of its unused (garbage) data<A NAME=MARKER-2-99></A>
<LI>the script code of the script system it belongs to
<LI>its maximum key length<A NAME=MARKER-2-100></A>
<LI>its search criteria<A NAME=MARKER-2-130></A><P>
</UL>
 To identify the desired dictionary file, you use the dictionary reference number obtained when you open a dictionary file with the <CODE>OpenDictionary</CODE> function.<P>
 <A NAME=MARKER-9-12></A>The <CODE>GetDictionaryInformation</CODE> function returns its information in a dictionary information record. The dictionary information record is defined by the <CODE>DictionaryInformation</CODE> data type as follows:<P>
<PRE>
TYPE DictionaryInformation = 
   RECORD
      dictionaryFSSpec:    FSSpec;        {file system spec}
      numberOfRecords:     LongInt;       {total no. of records}
      currentGarbageSize:  LongInt;       {size of unusable data}
      script:              ScriptCode;    {script system}
      maximumKeyLength:    Integer;       {maximum length of keys}
      keyAttributes:       UnsignedByte;  {key search criteria}
   END;
</PRE>
 See <A HREF=Text-504.html#MARKER-9-104>page 8-25</A> for a complete description of these fields. <A HREF=#MARKER-9-69>Listing 8-3</A> shows a call to <CODE>GetDictionaryInformation</CODE> to obtain the number of records in a dictionary.<P>
<B>Listing 8-3  <A NAME=MARKER-9-69></A>Obtaining information about a dictionary</B><P>
<PRE>
FUNCTION GetNumberOfRecordsInDictionary(dictionaryReference: 
                                          LONGINT): INTEGER;
VAR
   err:              OSErr;
   dictionaryInfo:   DictionaryInformation;
   numRecords:       Integer;
BEGIN
   numRecords := -1;          {return result in case of error}
   IF dictionaryReference &lt;&gt; 0 THEN BEGIN
      {get the dictionary information record}
      err := GetDictionaryInformation(gDictionaryReference, 
                                       dictionaryInfo);
      IF err &lt;&gt; noErr THEN
         numRecords := dictionaryInfo.numberOfRecords
      ELSE
         DebugErrStr(err, 'GetDictionaryInformation');   {error}
   END;
   GetNumberOfRecordsInDictionary := numRecords;
END;  {GetNumberOfRecordsInDictionary}  
</PRE>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-491.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-493.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
