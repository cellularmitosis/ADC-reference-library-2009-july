<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"        "http://www.w3.org/TR/1998/REC-html40-19980424/loose.dtd"><HTML><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note HW28: PowerBook Miscellanea (Cold Serial in the Morning)</title><meta name="categories" content="Hardware"><meta name="week-posted" content="Sep 28, 1992 - Oct 2, 1992"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF" TEXT="#000000"><a name="//apple_ref/doc/uid/DTS10002497" title="PowerBook Miscellanea (Cold Serial in the Morning)"></a><a name="top"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxHardwareDrivers-date.html">Hardware & Drivers</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/HardwareDrivers/idxSerial-date.html" target="_blank">Hardware & Drivers > Serial</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note HW28</div>
<div id="pageheadsub">PowerBook Miscellanea (Cold Serial in the Morning)</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->                     <P id = "menutext">         <A HREF="#Section1">It Feels Like I'm Floating</A><BR><BR> <A HREF="#Section2">AT or Not AT?</A><BR><BR>  <A HREF="#Section3">You Light Up My Life (The Charging Process) </A><BR><BR>   <A HREF="#Section4">When I Snap My Fingers, You Will Forget...</A><BR><BR><A HREF="#Section5">NiCad Myths and Nightmares</A><BR><BR>  <A HREF="#References">References</A><BR><BR><A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">This Technical Note describes some nonintuitive ramifications of working with abattery-powered computer.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Oct 01 1992]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR><!-- begin_content --><a name="Section1"></a><h2>It Feels Like I'm Floating</h2><p>You may have problems connecting RS-232 from PowerBook to PowerBook or fromPowerBook to other battery-powered device if your connection is not properlygrounded. This will result in unacceptable noise in your signal or a completefailure in the two devices to interpret the transmitted voltage levelscorrectly. Serial communications using RS-232 voltage levels depend onreference to ground. Because the PowerBooks are freestanding battery-powereddevices, they are properly grounded with respect to RS-232 only when the cableconverting their RS-422 to RS-232 also connects to a proper signal ground andshield ground.  (RS-422 uses balanced-pair signals and does not have thisproblem.) This is a common cause of your program getting stuck in the <code>vSyncWait</code>routine as the serial driver is waiting for character transmission to completewhile the SCC waits for an appropriate DTR or CTS that can't be seen due to alack of proper ground reference.</p><p>To remedy this problem, you will need to make sure the cable you are usingconnects the signal and shield grounds to <i>both</i> devices and that at somepoint these grounds are connected to an actual grounding source (groundingstrap, ground plug, or similar "metal pipe into the planet"). Plugging in thewall power adapter will have no effect on this problem--it provides nogrounding to the PowerBook.</p><a name="Section2"></a><P><A HREF="#top">Back to top</A></P><h2>AT or Not AT?</h2><p>PowerBook modem has been designed with a minor deviation from the Hayes modemcommand set standard. The Hayes command set deviation is documented on page 88of the FaxModem user's guide. Many programs begin their modem initialization byissuing a modem break command. For these programs, you will need to change the"+++" string in your communication programs to "+++AT&lt;Return&gt;" (6characters). Additional information about the entire supported AT command setis now available in the <i>PowerBook Modem Guide</i> on the Developer CD.</p><a name="Section3"></a><P><A HREF="#top">Back to top</A></P><h2>You Light Up My Life (The Charging Process) </h2><p>The Power Adapter port on the PowerBook has been engineered with a mechanicalswitch that detects the presence of the adapter. Software detects the insertionof the plug into the PowerBook Power Adapter port, and, during the attempt tocharge the battery, the lightning bolt icon that appears in the Battery deskaccessory toggles on to indicate that the charging apparatus is attempting tobulk charge the battery. In the status byte returned by <code>BatteryStatus</code>, bit 0indicates the presence of the physical plug in the power connector. Bit 1indicates if the charging circuit is set to bulk rate or trickle.</p><p>There is no way to determine if the attached charging apparatus is providingcurrent, as the circuit can read only the voltage level of the entire system.Additionally, it might be possible to write a utility that, over time (seconds)and while also watching the power state of the various subsystems, coulddetermine if the unit was gaining a charge. Although a difficult programmingproblem, this might make a great third-party product.</p><p>There are two phases to recharging the battery. The first is bulk recharge andthe second is trickle charge. The bulk recharge will bring the battery to an 80percent charge. It takes 2 hours to get to this 80 percent level when the unitis not being used. The full current level available from the power adapter isused in this phase of the recharge cycle. When the 80 percent level has beenreached, the computer will start a trickle recharge. This is a reduced currentthat allows the battery to reach 100 percent charge without the danger ofovercharging.</p><a name="Section4"></a><P><A HREF="#top">Back to top</A></P><h2>When I Snap My Fingers, You Will Forget...</h2><p>When the PowerBook enters sleep mode, all subsystems except the memory and thePower Manager are turned off. This means the SCC, being disconnected frompower, will no longer be able to drive the DTR lines state despite the settingof csCode 16 to the serial driver to hold DTR.</p><p>In addition, when the power is dropped to the internal modem its currentsettings will be lost also. To work around this if you expect the modem toremember settings across sleeps, you should install a Sleep Queue task to readout the settings just before sleep and then restore settings on systemwake-up.</p><a name="Section5"></a><P><A HREF="#top">Back to top</A></P><h2>Snap, Crackle, Pop</h2><p>To further power conservation and enhance battery life, the system softwaredetects whether or not the sound chip is being used. If it hasn't been used fora while, power is disconnected from the sound circuitry in order to conservepower. During this process, a click may be heard from the speaker as thespeaker coil deenergizes. You can defeat this sound by plugging a minijack intothe Sound Output port, thus disconnecting the internal speaker. The electricaldischarge and subsequent sound are unfortunately the other side of anengineering trade-off made to help maximize battery life.</p><a name="Section6"></a><P><A HREF="#top">Back to top</A></P><h2>NiCad Myths and Nightmares</h2><p>There really <i>is</i> a "charge memory" problem with Nickel-Cadmium batteries!The trouble is that to get that effect you need to get your battery into ageosynchronous orbit, in microgravity, and subject it to extremes of heat andcold while charging for precise times over a period of months. Also, the resultof a true "charge memory" effect is a reduction in voltage by a few tenths of avolt, not a change in the amp-hour duration of battery charge. In satelliteswhere this is a concern, a reconditioning cycle is run every year or so! Thisis not a reasonable concern even if your work routine is the same day to day.The problem is that, for fear of causing a memory problem in NiCad batteries,many people attempt to fully discharge then fully recharge their batteries.This tends to accelerate electrolyte loss and to create the possibility ofreverse polarizing individual internal cells--resulting in the reduced batterycapacity that these same people claim as evidence of the "memory" effect. Youshould therefore <i>never</i> attempt to run your battery down for the purposeof "reconditioning" it.</p><p>Another possible problem is charging or discharging the battery too fast. Inthe first case you can generate excessive heat and cause the loss ofelectrolyte and in the second (by shorting the terminals) you can cause theloss of electrolyte and generate excessive heat. The charger circuit in thePowerBooks as well as the stand-alone battery chargers from Apple are designedto bulk charge the battery as fast as possible without overheating, then totrickle charge up to their full charge.</p><p>In general use, you should plug into your wall adapter whenever it isavailable, whether using the lead-acid battery in the PowerBook 100 or theNiCads in the 140 and 170, and not worry about possible memory effects. If youare looking for a third-party battery charger, stay away from bulk chargers andthose that "provide" discharge/recharge cycles.</p><p>Despite what the manual says, you should never intentionally discharge yourbattery other than in the course of normal use.</p><a name="References"></a><h2>References</h2><P><i>Inside Macintosh</i>, Volume VI, Power Manager</p><P>Macintosh PowerBook Family Developer Notes</p><P>"Getting the Most Out of Nickel-Cadmium Batteries" by Ken Stuart, <i>QSTMagazine,</i> February 1992</p><P><i>PowerBook Modem Guide</i> available on the Developer CD</p><P><A HREF="#top">Back to top</A></P><P><A NAME=Downloads></A></P>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (60K)</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/hw_28.pdf">Download</A></P>               </TD>            </TR></table><BR><P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/hw/hw_28.html%3Fid%3DDTS10002497-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/hw/hw_28.html%3Fid%3DDTS10002497-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/hw/hw_28.html%3Fid%3DDTS10002497-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>