<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!-- Template 01-05-01 --><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css">   <title>Technical Note TN1162: Introduction to MRJ Scripting with AppleScript for Java</title>   <meta name="keywords" content="Java,MRJ,AppleScript,scripting"><meta name="Description" content="Technical Note TN1162: This document covers the technical
information your JDK 1.1.x application on Mac OS Classic will need to take full advantage of AppleScript."><meta name="categories" content="AppleScript and Java"><meta name="week-posted" content="Jan 31, 2000 - Feb 4, 2000"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10003001" title="Introduction to MRJ Scripting with AppleScript for Java"></a><A NAME="top"></A><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxJava-date.html">Java</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/Java/idxPorting-date.html" target="_blank">Java > Porting</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TN1162</div>
<div id="pageheadsub">Introduction to MRJ Scripting with AppleScript for Java</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left">   <!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">     <tr><td width=300 valign="top" align=left scope="row">    <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>            <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>  </tr>  <tr bgcolor="#e6e6e6">   <td background="images/tnmenubody.gif" width=300 align=left> <span id="menutitle">CONTENTS   <br>  <br> </span>   </td>  </tr>  <tr bgcolor="#e6e6e6">   <td background="images/tnmenubody.gif" width=300 align=left> <!-- begin_toc --><P id = "menutext"><A HREF = "#Section1">How MRJ Scripting Works</A><BR>        <BR>        <A HREF = "#Section2">Scripting the Applet Runner or Java Application</A><BR>        <BR>        <A HREF = "#Section3">Applet Runner ApplicationProperties</A><BR>        <BR>        <A HREF = "#Section4">Java Objects as AppleScript Objects</A><BR>        <BR>        <A HREF = "#Section5">Java Methods as AppleScript Commands</A><BR>        <BR>        <A HREF = "#Section6">Scripting Java Applets</A><BR>        <BR>        <A HREF = "#Section7">Creating a Scriptable Java Application</A><BR>        <BR>        <A HREF = "#Section8">Generating an 'aete' resource for a Java Application</A>      <A HREF = "#Changes">Changes in MRJ 2.2</a><BR>        <BR>        <A HREF = "#Summary">Summary</A><BR><BR>        <A HREF = "#References">References</A><BR><BR>        <A HREF = "#Downloads">Downloadables</A></p>        	 <!-- end_toc --></td>  </tr>  <tr>   <td width=300 align=left scope="row"> <img src="images/tnmenubottom.gif" alt="" width=300 height=16>   </td>  </tr>    </table></td>  <td width=300 valign="top" align=left>            <!-- begin_intro_text --><P id = "introtext">Withthe release of MRJ 2.1, AppleScript support in Java applets and applications is now a reality. This Technote covers the technical information you will need to take full advantage of AppleScript in your Java application.</p><P id = "introtext">Apple Applet Runner and the MRJShellLib (inside of MRJLib) support the Macintosh Open Scripting Architecture. As a result, the AppleApplet Runner, the applets it runs, and applications created with JBindery  can be scripted by AppleScript or any other OSA scripting language. The only additional work required (for scripting of java-based applications) is the inclusion of the scripting resources <CODE>'aete</code>' and <code>'scsz</code>'. No other specific scripting support is required from the Java applet or application. This enables MRJ users to download Java applets or applications from the Internet and use them as scriptable components on the Macintosh.</P><P id = "introtext">This document provides a brief overview of MRJ Scripting. It assumes that you are familiar with <A HREF = "http://www.apple.com/applescript">AppleScript</A> and the OSA Architecture. As more information about MRJ Scripting becomes available, it will be posted on the <a href="http://developer.apple.com/java">MRJ Developer Page</A>.</P><!-- end_intro_text --><!-- begin_date --><h3>&nbsp;Updated: [Feb 2 2000]</h3><!-- end_date --></TD> </TR>    </TABLE> <!-- end_header_box --><BR><BR><hr width=500 align=center><BR><BR>      <!-- begin_content -->             <A NAME="Section1"></A><H2>How MRJ Scripting Works</H2><P>MRJ Scripting works by exporting public Javaclass, property, and method names as OSA scripting terminology so that they are visible to scripters. When a script runs, MRJ scripting translates the Apple Event data types and events into Java data types and method calls. A scripter can thus set and get data in property fields of Java objects, and invoke Java methods on thoseobjects.</p><P>The OSA scripting terminology is generated dynamically by the Applet Runner or Java application. When you compile a script that targetsthe Apple Applet Runner, the Script Editor (or any other OSA developmentenvironment) fetches its dynamic terminology. That terminology includes AWT Component objects for each open applet. For example, the sample applet "Lightweight Gauge" has a formal applet name of <CODE>ExampleApplet</CODE>;if you open the Applet Runner dictionary while Lightweight Gauge is running, you will see that it includes suites that look likethis:</p><BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>ExampleApplet:init: public voidExampleApplet.init()init reference   Class Example Applet:   Properties:           &lt;Inheritance&gt; Applet [r/o]                        Gauge:                          Class Gauge:    Properties:&lt;Inheritance&gt; Component [r/o]         total Amount integer [r/o]  -- public int Gauge.getTotalAmount( )         preferred Size point  [r/o] -- public java.awt.DimensionGauge.getPreferredSize()         minimum Size point  [r/o] -- public java.awt.DimensionGauge.getMinimumSize()         current Amount  integer -- public int Gauge.getCurrentAmount()&amp;                                                      -- public voidGauge.setCurrentAmount(int)</pre></TD></TR></TABLE></CENTER><BR><BR>                <P>Because the <CODE>ExampleApplet</CODE> is running, the Applet Runner now exposes a <code>Gauge</code> class that inherits itsproperties from the Component class, a read-only property <code>totalAmount</code>, and a writable property <code>currentAmount</code>.</p>            <P>Methods and properties of Java objects are exposed to the scripter in this manner. Occasionally some Java object, method, or propertynames will conflict with AppleScript reserved word namespace, or be illegal in AppleScript (for example, an item that contains periods like user.name). When this happens, the Java names will be published enclosed in AppleScript's literal quotation marks, the vertical bars ( | ). For example, a Java Applet parameter named "columns" can be written as <CODE>|columns|</code> and will not conflict with the AppleScriptterminology "columns". Notice that identifiers inside vertical bars are case sensitive, whereas normal AppleScript terminology is not.</P><P>In an applet that uses AWT, the entire AWT component hierarchy is exported for scripting, so every function of the applet that can be driven by the user interface can also be driven by scripting. To script an applet, you do not have to know about its internal methods; you can script its buttons, menus, and display objects directly. This is different from normal Macintosh application scripting, where you normally script the semantic objects of the application. Theprincipal advantage to the MRJ's scripting method is that all aspects of the applet's operation are scriptable, without any special assistance from the applet. The principal disadvantage is that internal orsemantic information stored in the applet can only be accessed by pulling the "puppet strings" of the user interface by scriptingthe AWT components. Thus, developers should include semantic objects as properties of the top-level Component in their Java applets or applications. Then you can script Java applets or applications in the preferred way of Macintosh scripting.</P><BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>IMPORTANT:</B><BR>Obfuscated java classes areunscriptable for all practical purposes.</p></TD></TR></TABLE></CENTER><BR><BR><P><A HREF = "#top">Back to top</A></P><A NAME="Section2"></A><H2>Scripting the Applet Runner or Java Application</H2><P>The Applet Runner is a scriptable application that supports the Required and Standard suites of events, as well as a small number ofcustom events. Java applications should also have a dictionary that supports these events. The supported events are:</P><UL>    <LI><b>print</b> - prints an AWT component.</li>    <LI><b>exists</b> - tests if a Java objectexists</li>    <LI><b>check... belongs to</b> - checks to see if a Java object belongs to a certain class</li>    <LI><b>apply to</b> - calls a method by name. This can be useful if the terminology is not present and as a result, you cannot call it the normal way.</li>    <LI><b>save object</b> - serialize the Javaobject into a .jar file</li>    <LI><b>load object</b> - load an object from a.jar file</li>    <LI><b>start tool</b> - the tool can be any jar file with visible bean inside. Since it is a tool with Java classes you can script it the usual manner. The developer can build up useful AppleScript tools to dothings such as display an <CODE>AEList</CODE> as a tree.</li>    <LI><b>type .. keystrokes</b> - a low-level event to deliver keystrokes to Java windows</li>    <LI><b>click</b> - a low-level event to simulate mouse clicks on AWT components. This can also be used to do some UI scriptingsuch as clicking on a menu item by name</li>            </UL>            <P>See the Applet Runner dictionary for the fullparameters and results of these events.</p>       <BR><P><A HREF = "#top">Back to top</A></P>            <A NAME="Section3"></A><H2>Applet Runner Application Properties</H2><P>Like most scriptable applications, the Applet Runner application or Java applications support global properties that control itsoperation. All system properties of the Java engine are exposed as application properties of the Applet Runner or Java application. Remember that because most system properties are illegal as AppleScript identifiers, they are enclosed in vertical bars and arecase sensitive:</P>                  <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>tellapplication &quot;Apple Applet Runner&quot;    get its |user.name|end tellThere are two new system properties that control specificaspects of MRJ Scripting:tellapplication &quot;Apple Applet Runner&quot;    set its |macos.scripting.debug| to true    set its |macos.menu.contextual.disable| to trueend tell</pre></TD></TR></TABLE></CENTER><BR><BR>            <P>If a method returns a Java object, it is normally returned as the opaque class of the Java object. With <CODE>|macos.scripting.debug|</CODE> setto <B>true</B>, a Java object will be translated into a text string using the Java method <CODE>toString()</CODE>. While this may not be useful from a scripting perspective, it can be very useful for debugging purposes.</P><P>MRJ Scripting provides automatic contextual menu support for Java <CODE>TextComponent</CODE> objects. You can disable this capability by setting <CODE>|macos.menu.contextual.disable|</CODE> to <B>true</B> or turning it off from the help menu.</p>              <BR><P><A HREF = "#top">Back to top</A></P><A NAME="Section4"></A><H2>Java Objects as AppleScript Objects</H2><P>When an applet is opened in the Applet Runner, it is available as an implicit top-level element of the application (much like desktop files are implicit top-level objects in the Finder). To experiment with this, open the "Lightweight Gauge" applet in the Applet Runner and execute the following script:</P><BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>tellapplication &quot;Apple Applet Runner&quot;     restart ExampleApplet 1end tell</pre></TD></TR></TABLE></CENTER><BR><BR><P>The Java objects that make up this applet are contained by the <CODE>ExampleApplet</CODE> object.</p><BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>IMPORTANT:</B><BR>In this version of the Applet Runner, the containment relationships of Java AWT components are exposed through the components property of the Container object. This object returns a list of Java components enclosed by that container. There is no formal "element" relationship between a container and its contents, but the Applet Runner accepts element-style references and translates them to the correct Java object references. This means that thenormal AppleScript commands that act on elements (<code>count</code>, <code>each</code>, <code>whose</code>, etc.) do not operate on items contained by a container object even though you can perform some of those operations on the components property of that container.</p></TD></TR></TABLE></CENTER><BR><BR><P>(Note that in the applet runner, the window is a container of the Applet and is not the Applet object itself. The Applet Runner's Window class is useful only for manipulating the windows the Applet Runner displays. You can also address the applet directly.)</p><P>Discovering the correct name of a component through trial and error can be difficult. MRJ Scripting assists you in determining objectspecifiers (when the <CODE>|macos.scripting.debug|</CODE> property is set to true). If you turn on Balloon Help, you may point to any object, and the balloon will give you a useful object specifier for that object. The object specifier is also output to the Java console.</p><P>Following AppleScript conventions, the contents of containers are referred to using 1-based indices, even though the standard for Java is zero-based indices. So the first component in a container is component 1, not component 0.</p><P>Most properties of the Java object are available asproperties of the AppleScript object, and the AppleScript <code>get</code> and <code>set</code>commands can be used to examine and change the values. For example, using the Lightweight Gauge applet as an example, the value for the second bar can be accessed with:</p>                        <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre></pre></TD></TR></TABLE></CENTER><BR><BR><P>It can be set accordingly with the AppleScript<CODE>set</code> command if the property is not marked as [r/o] (read only) in the dictionary.</p><BR><P><A HREF = "#top">Back to top</A></P><A NAME="Section5"></A><H2><B>Java Methods as AppleScript Commands</B></H2><P>Most method calls on a Java object are available as AppleScript commands. In the dictionary displayed by the Script Editor, eachJava class is listed in its own suite with an AppleScript class representing the Java class and a list of commands in that suite that correspond to the methods.</p><BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>IMPORTANT:</B><BR>Note that AppleScript is laxabout associating commands with objects. A script that sends a command to an object that does not support that method <b>will</b> compile, although it will get a runtime error.</p></TD></TR></TABLE></CENTER><BR><BR><P>The target or direct object of a command must be the Java object that supports the corresponding method. You can use the syntax of anyof the following AppleScript examples to send a command to a target object:</P><BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>restart ExampleApplet 1restart of Example Applet 1tell Example Applet 1 to restarttell Example Applet 1    restart</pre></TD></TR></TABLE></CENTER><BR><BR><P>Because AppleScript supports named parameters but not orderedparameters, and Java supports ordered parameters but typically not namedparameter information via Java reflection, the parameters are usually passed in the parameter-named parameters. This is an ordered list containing the values that would appear between the parenthesis in the Java method invocation. Remember, the parameters must be supplied in the order they are expected by the Java method; for your convenience, this is listed in the comment line of the command's dictionary entry. For example, an invocation of the <CODE>replaceRange</CODE> command would look like: </p>            <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre></pre></TD></TR></TABLE></CENTER><BR><BR>                      <P>(Because parameter lists are passed directly to Java methods without interpretation, index parameters are zero-based, not 1-based).</p><p>Java classes that implement the BeanInfo interface provides additional information for scripting. MRJ scripting can then look for JavaParameter Descripter objects to provide named parameters in the dictionary, and you can use these named parameters directly in AppleScript. As more JavaBeans are created, this will become more common, but currently very little Java code provides thisinformation.</p><P>Most methods take scalar parameters (discrete types such as <CODE>ints</CODE>, <CODE>longs</CODE>, <CODE>Booleans</CODE>, etc.) and return scalar results. However, the Java objects <CODE>String</CODE>, <CODE>Rectangle</CODE>, <CODE>Point</CODE>, <CODE>Dimension</CODE>, and <CODE>Color</CODE> are considered to be scalar for this purpose; they are automatically translated between Java and AppleScript formats.</p>              <BR><P><A HREF = "#top">Back to top</A></P>            <A NAME="Section6"></A><H2>Scripting Java Applets</H2><P>For applets, the applet tag is provided to AppleScript as a property of the Applet object, even though it is not really a field of theJava Applet class. Furthermore, you can get and set the Applet tag to change runtime parameters. Setting the Applet tag will result in a relaunch of the Applet with the new Applet tag. Here is an exampleof changing the <CODE>BarChart</CODE> applet to the vertical orientation:</p><BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>set applet tag of Applet 1 to {c1:&quot;10&quot;, c1_color:&quot;blue&quot;, c1_label:&quot;Q1&quot;,c1_style:&quot;striped&quot;, c2:&quot;20&quot;, &not; c2_color:&quot;green&quot;,c2_label:&quot;Q2&quot;, c2_style:&quot;solid&quot;, c3:&quot;5&quot;, c3_color:&quot;magenta&quot;,c3_label:&quot;Q3&quot;, &not; c3_style:&quot;striped&quot;, c4:&quot;30&quot;,c4_color:&quot;yellow&quot;, c4_label:&quot;Q4&quot;, c4_style:&quot;solid&quot;,|columns|:&quot;4&quot;, &not; orientation:&quot;vertical&quot;,</pre></TD></TR></TABLE></CENTER><BR><BR>   <BR><P><A HREF = "#top">Back to top</A></P><A NAME="Section7"></A><H2>Creating a Scriptable Java Application</H2><P>To script a Java application, the Java application file needs to have <CODE>'aete'</CODE> and <CODE>'scsz'</CODE> resources in its resource fork. A sample <CODE>'aete'</CODE> resource, "MRJ Scripting aete," is provided in the MRJ 2.1 SDK in the folder "MRJ Scripting." A similar<CODE>'aete'</CODE> resource is already included with the AppletRunner. The <CODE>'aete'</CODE> resource includes a built-in suite and a first cut at the AWT terminologies. Terminology for other classes is generated dynamically using Java's reflection feature. </p><P>Automatically generated terminologies may not be very user friendly. Their comments are simply the Java object's name, and they exposemost properties and methods to the scripter. You may want to use theautomatically generated terminology as a starting point, then change the comments and delete the properties and methods that are notuseful to the scripter.</p><P>Since the <CODE>'aete'</CODE> can be fairly large, it is a good idea to increase the memory partition of Script Editor, HyperCard, or whatever OSA development environment you are using. You may also need to increase the memory partition of the Java application or Applet Runner.</P>          <BR><P><A HREF = "#top">Back to top</A></P><A NAME="Section8"></A><H2>Generating an 'aete' for a Java application</H2><P>Scriptable applications must provide a <B>terminology resource</B> (stored in resource <CODE>'aete'</CODE> 0 in the resource fork) in order to be scriptable with AppleScript and other OSA scripting languages. This terminology resource associates the four-character event and class codes used in the application's source code with the English terminologyused by the scripter. Normally, a developer compiles the terminology resource from a .r file with the Rez tool or edits it using aresource editor with an <CODE>'aete'</CODE> template (such as Resorcerer or ResEdit). For MRJ scripting, the four-character codes used for scripting are generated automatically and may not be modified by the developer, but you may want to change the terminology toimprove readability.</p><P>The automatically generated terminology is a combination of a static basic terminology and dynamic terminology created by your scriptableJava application. The file "MRJ Scripting aete" includes the basic terminologies and the AWT component terminologies. MRJ scripting automatically generates additional terminologies for all components in open windows of Java applications; in this way MRJ generates all basic terminology needed to make an MRJ application scriptable. Toinclude the basic resources in a Java application, use JBindery or ResEdit.</P><P>Once the basic <CODE>'aete'</CODE> resource is in your Java application, you must run it and touch every part of the application you want to be scriptable in order for it to generate the dynamic terminology. Open all the windows with components that you are interested in, so that AppleScript classes for those components will be included in the terminology.</P><P>If it is not practical to open all the windows manually, or if there are scriptable classes that are not AWT components, you can use scripting itself to ensure terminologies will be generated for those classes. In the basic dictionary there is a suite called the "Developer Suite," which contains commands and classes that designed to assist the developer, not the end user. In this suite, the <code>add terminologies for class</code> event lets you specify that a particular Java class should be included in the dynamic terminology.</P><P>Once you have touched (manually or by scripting) all the classes you wish to expose, the next step is to retrieve the dynamicterminologies. You do this with the same <CODE>'gdte'</CODE> event that the Script Editor uses to fetch the dynamic terminology from an application. Normally this event is hidden from the scripter so there is no terminology for it; in the Developer Suite we give it the eventname <code>get terminologies</code> so you can write a script that sends it to your application.</P>        <P>In our terminology we also enhance the <code>get terminologies</code> event with an optional boolean parameter <code>object parameters</code>.Normally, the terminology generated excludes all events that have Java objects as parameters; if you want to include such events, you may add "with object parameters" when you call the <code>get terminologies </code>event.</P><P>The result of the <code>get terminologies </code>event is a large data object containing both the static and dynamic terminologies. If youwant to edit this dynamic terminology to make it more usable, you need to save it to a file. There are a number of shareware scripting additions that will do the job. In the following example we use the <code>add resource</code> command from the GTQ Scripting Library(see <A HREF = "http://www.scriptweb.com/osaxen/gtq_scripting_library.html">http://www.scriptweb.com/osaxen/gtq_scripting_library.html</A>):</P>                              <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>tellapplication &quot;test.app&quot;    add terminology for class &quot;com.acme.test.SpecialButton&quot;    add terminology for class &quot;com.acme.test.SpecialClass&quot;    set aeteRes to get terminologies --set aeteRes to get                   terminologies with object parameters-- NOTE: There is currently an issue with using &quot;get terminologies-- with object parameters&quot;-- Use &quot;get terminologies with &lt;&lt;class objt&gt;&gt;&quot;-- instead    add resource aeteRes to file &quot;HD:TestRes&quot; oftype &quot;aete&quot; id 0 &not;    with replacing allowedend tell</pre></TD></TR></TABLE></CENTER><BR><BR>    <CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>IMPORTANT:</B><BR>In the above AppleScript,&lt;&lt; and &gt;&gt; must be replaced with their single-character equivalents - the Option-\ and Option-Shift-\ characters in order for the script to function correctly.</P></TD></TR></TABLE></CENTER><BR><BR>   <P>When installing the "Add Resource" scripting addition, increase the partition size of the Script Editor to about 1500K, and enter andrun this script. Then you can find the resource in the resulting"HD:TestRes" file and edit it with your favorite <CODE>'aete'</CODE> editor: either derez it and edit the .r file, or use Resorcerer or ResEdit with the <CODE>'aete'</CODE> template.</p><P>When cleaning up the terminology for the scripter, you should delete all the events and properties that are not relevant. You may want to delete non-relevant classes well; however, if dynamic terminology is on, thenthe terminologies of classes you have removed will show up again dynamically. Currently, to get around the problem, you can delete all events and properties of those classes but leave the classes around. Since the dynamic terminology generation does not try to override the classes already in the <CODE>'aete'</CODE>, these classes would remain empty.</P><P>You should never change the four-character codes in the aete. However, you are encouraged to change the names of events, parameters, classes,and properties if they are generated from programming names and not the display names. You should also add comments to inform the scripter what the individual classes are and how they are used.</P><P>After you have edited the <CODE>'aete'</CODE> resource into its final form, you should probably delete the Developer Suite since it is not intended for the scripter.</P><P>Dynamic terminology is controlled by the <CODE>'scsz'</CODE> resource. You may edit the <CODE>'scsz'</CODE> resource to disable dynamic terminology and thus freeze the terminology to be what you declare in the modified <CODE>'aete'</CODE>. (If you do this, you don't need to worry about automatic generation of unwanted terminology.) But this too has drawbacks. If your Java application is extensible (for example, through the <code>start tool</code> event), new classes can be introduced at run time; the only way to make these classes scriptable is to enable dynamic terminology in the <CODE>'scsz'</CODE> resource.</P><P>You are strongly encouraged to edit and trim down your <CODE>'aete'</CODE> resource, otherwise the scripter will likely be overwhelmed by the number of entries in the dictionary. You should also give the user some suggestions on where they should direct their scripting efforts. Then the scripter will have a better chance of fully utilizing your application. It is recommended that you ship sample scripts with your application to help the scripter with terminology idiosyncrasies and to demonstrate how to make use of scripting support effectively.</P>            <BR><P><A HREF = "#top">Back to top</A></P><a name="Changes"></a>       <h2>Changes in MRJ 2.2</h2>      <p>MRJ 2.2 has made some significant changes to the scripting model used by the MRJ. These changes lie in two main areas: changes to the terminology, and improved support for alternative containment hierarchies. These changes are documented in <i>About MRJ Scripting</i> which is part of the MRJ SDK 2.2.</p>      <p><b>Terminology Changes</b></p>      <p>There are some changes in the terminology to avoid conflicts with built-in         AppleScript key words:</p>      <ul>        <li>&quot;file&quot; has been changed to &quot;Java file&quot;</li>        <li>&quot;get&quot; has been changed to &quot;get dictionary item&quot;</li>      </ul>      <p>Java array support has been improved. In previous MRJ versions, it was         possible to get scripting errors when referring to the index of an array         item. In MRJ 2.2, these type of references are now possible:</p>                        <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>set testobject of frame 1 to {1,2,3}set item 2 of testobject of frame 1 to 4</pre></TD></TR></TABLE></CENTER><BR><BR>                        <p>This operation is now possible and will return the value {1, 4, 3} where         previously, it would have caused an error.</p>      <p>Additionally, it is now possible to manipulate Java Vector objects just         like an AppleScript Array. For example, you can now do the following:</p>                        <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>get item 2 of testvector of frame 1set item 2 of testvector of frame 1 to &quot;gamma&quot;</pre></TD></TR></TABLE></CENTER><BR><BR>                        <p>This operation will return the result &quot;gamma&quot;. In previous         versions of the MRJ, the only way to manipulate Vector objects was via         the class methods.</p>      <p>The &quot;make&quot; event of the core suite is now supported. It is         analogous to calling the constructor of a class directly. For example:</p>                        <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre></pre></TD></TR></TABLE></CENTER><BR><BR>                          <p>Corresponds to calling &quot;new Frame( )&quot; from Java. You can even         do more complex operations such as:</p>                        <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>make new class &quot;java.awt.Frame&quot; with properties {title: &quot;hello&quot;,  |visible|:true}</pre></TD></TR></TABLE></CENTER><BR><BR>                        <p>This is equivalent to the following:</p>                        <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>Frame f = new Frame();f.setTitle(&quot;hello&quot;);f.setVisible(true);</pre></TD></TR></TABLE></CENTER><BR><BR>                        <p>Finally, MRJ 2.2 adds support for object references. For example, if         you want to store an object reference for later use, you can store it         in the &quot;object collection&quot; property of the Java application.         For example:</p>                        <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>make new class &quot;xyz&quot;</pre></TD></TR></TABLE></CENTER><BR><BR>                        <p>This saves a reference to the new xyz object under the variable name         &quot;alpha&quot;, If you need to retrieve that reference later, you may         refer to it as:</p>                        <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre></pre></TD></TR></TABLE></CENTER><BR><BR>                        <p>Note that if AppleScript is holding a reference to a particular object,         the garbage collector cannot free that memory even if the object is no         longer in use. You must explicitly remove the reference from the object         collection as follows:</p>                      <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre></pre></TD></TR></TABLE></CENTER><BR><BR>                        <p><b>Support for Alternative Containment Hierarchies</b></p>      <p>In the MRJ, typically objects must be referenced from AppleScript in         terms of the visual containment hierarchy. Thus, if a button is in a panel         in a window, you must access the button as follows:</p>                      <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre></pre></TD></TR></TABLE></CENTER><BR><BR>                      <p>This can be a nuisance if you have a deep containment hierarchy such         as in the case of swing. In MRJ 2.2, a developer may specify an alternate         hierarchy by implementing the com.apple.scripting.AlternateHierarchy interface.         This bypasses the traditional visual containment hierarchy.</p>      <p>For example:</p>                        <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>public class test extends Frame implements AlternateHierarchy{    public Button getButton( int i )    {        ... // get the ith button in the frame    }    ...</pre></TD></TR></TABLE></CENTER><BR><BR>                        <p>This allows the developer to write the following script:</p>                        <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre></pre></TD></TR></TABLE></CENTER><BR><BR>                        <p>regardless of how many layers deep button 2 is. However, it is the responsibility of the developer to keep track of items in the custom hierarchy and writing the retrieval method.</p>          <BR><P><A HREF = "#top">Back to top</a> </p><A NAME="Summary"></A><H2>Summary</H2><P>Incorporating AppleScript into your Java application allows increasedautomation support. Adding basic scriptability is very simple. You need only to add a pre-generated <CODE>'aete'</CODE> and a <CODE>'scsz'</CODE> resource; however, more advanced scripting may require careful editing of these resource types for finer controlof which objects and methods are exposed in the dictionary.</p>        <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>Note:</B><BR>Mention of third-party sites and third-party products is for informational purposes only and constitutes neither an endorsement nor a recommendation. Apple assumes no responsibility with regard to the selection, performance, or use of these vendors or products.</p></TD></TR></TABLE></CENTER><BR><BR><BR><p><a href="#top">Back to top</a></p><a name="References"></a><H2>References</H2><p><a href="../../documentation/Carbon/interapplicationcomm/AppleScript/AppleScriptLangGuide/index.html">AppleScript Language Guide: English Dialect</A></p>                <p><a href="http://developer.apple.com/java/text/download.html#sdk">MRJ SDK 2.2</A> (About MRJ Scripting)</p><p><A HREF = "http://www.apple.com/applescript/">AppleScript Home Page</A></p><P><A HREF = "#top">Back to top</A></P><A NAME="Downloads"></A> <h2>Downloadables</h2><center><TABLE BORDER=0 CELLPADDING=3 WIDTH="600"> <TR> <td width=50 align=left>   <P ALIGN=center><img src="images/acrobatsmall.gif" align=middle alt="Acrobat" width=22 height=23></P></TD><td align="left">   <p>Acrobat version of this Note (80K).</P></TD><td width=60 align=left>   <p><A HREF="pdf/tn1162.pdf">Download</A></P></TD>  </TR> </table></center><BR><p><a href="#top">Back to top</a></p></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tn/tn1162.html%3Fid%3DDTS10003001-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tn/tn1162.html%3Fid%3DDTS10003001-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tn/tn1162.html%3Fid%3DDTS10003001-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>