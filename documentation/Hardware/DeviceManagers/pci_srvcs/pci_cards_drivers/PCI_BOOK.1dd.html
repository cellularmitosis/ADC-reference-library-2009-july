<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE> Gamma Table Implementation</TITLE></HEAD><BODY BGCOLOR="#ffffff"><DIV><a name="top"></a><!-- start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!-- start of path --><font face="Geneva,Helvetica,Arial" size="1"><b><br>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Documentation</a> &gt; <!-- a href="" target="_top" -->Hardware<!-- /a -->  <b>&gt; </b><a href="../../devicemgrs.html" target="_top">Device Managers and Drivers</a> <b>&gt; </b><a href="../pci_srvcs.html" target="_top">PCI Card Services</a> <b>&gt; </b>Designing PCI Cards and Drivers for Power Macintosh Computers</font><br><br><!-- end of path --><A HREF="PCI_BOOK.1d6.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.1dc.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.1de.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><HR></DIV><H1 CLASS="H2.Heading2"><A NAME="pgfId=3357"> </A>Gamma Table Implementation</H1><P CLASS="T1.Text1"><A NAME="pgfId=3358"> </A>The Power Macintosh gamma table structure is defined in the header file <TT CLASS="cv">QuickDraw.h</TT>. Its definition is diagrammed in <A HREF="PCI_BOOK.1dd.html#40997" CLASS="XRef">Figure&nbsp;13-2</A>.</P><P CLASS="Fg.Figure"><B><A NAME="pgfId=3366"> </A>Figure&nbsp;13-2	<A NAME="40997"> </A>Gamma table structure</B></P><DIV><IMG SRC="PCI_BOOK-31.gif"></DIV><P CLASS="T1.Text1"><A NAME="pgfId=3370"> </A>The gamma table is a variable length data structure. As shown in <A HREF="PCI_BOOK.1dd.html#40997" CLASS="XRef">Figure&nbsp;13-2</A>, the structure <TT CLASS="cv">GammaTbl</TT> sits at the front of a pool of memory that holds the data required to apply gamma correction.</P><P CLASS="T1.Text1"><A NAME="pgfId=3371"> </A>The last member of the fixed-length portion of the structure <TT CLASS="cv">gFormulaData</TT> is also the entry point to the variable-length portion of the structure. This variable-length portion is divided into two sets, formula data and correction data.</P><h4>Field descriptions</h4><DL COMPACT><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=15491"> </A><TT CLASS="cv">gVersion</TT></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=3372"> </A>The version of the <TT CLASS="cv">GammaTbl</TT> data structure. <TT CLASS="cv">gVersion == 0</TT> is the only version of the <TT CLASS="cv">GammaTbl</TT> data structure currently defined.</DD><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=15500"> </A><TT CLASS="cv">gType</TT></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=3373"> </A>Since gamma tables are created empirically, they can either attempt to correct the response curve of a specific CLUT, a specific display, or a specific combination of CLUT and display. <TT CLASS="cv">gType == 0</TT> indicates that the curve is derived from a display, not a CLUT. In this case, two different hardware modules can share the same gamma table.</DD><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=15509"> </A><TT CLASS="cv">gFormulaSize</TT> </DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=3374"> </A>See <TT CLASS="cv">gFormulaData</TT>, below.</DD><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=15518"> </A><TT CLASS="cv">gChanCnt</TT></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=3375"> </A>The number of tables of correction data. If there is more than one channel of correction data, the channels are ordered red, green, blue. If there is only one channel of correction data, the same correction is applied to the red, green, and blue channels of the hardware. The only valid values for <TT CLASS="cv">gChanCnt</TT> are 1 and 3.</DD><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=15527"> </A><TT CLASS="cv">gDataCnt</TT></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=3376"> </A>The number of entries of correction information per channel. </DD><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=15536"> </A><TT CLASS="cv">gDataWidth</TT></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=3377"> </A>How many significant bits of information are available in each entry, packed to the next larger byte size.</DD><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=15545"> </A><TT CLASS="cv">gFormulaData</TT></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=3378"> </A>The entry point to the variable-length portion of the gamma table, consisting of the formula data, if any, followed by the correction data. If a gamma table is hardware-invariant (<TT CLASS="cv">gType ==</TT> <TT CLASS="cv">0</TT>), then the formula data is never inspected. If a gamma table varies with the hardware (in which case <TT CLASS="cv">gType</TT> is the ID of the frame buffer), and <TT CLASS="cv">gFormulaSize</TT> <TT CLASS="cv">!=</TT> <TT CLASS="cv">0</TT>, then <TT CLASS="cv">gFormulaData[0]</TT> is inspected to see if it is the ID of the monitor currently connected. If the monitor IDs match, the gamma table is considered valid; otherwise it is considered to be the wrong table.</DD></DL COMPACT><H2 CLASS="H3.Heading3TOC"><A HREF="PCI_BOOK.1de.html#pgfId=3379" CLASS="Hypertext">Correction Data</A></H2><H2 CLASS="H3.Heading3TOC"><A HREF="PCI_BOOK.1df.html#pgfId=3392" CLASS="Hypertext">Gamma Table Errors</A></H2><H2 CLASS="RoH.RoutineHeadingTOC"><A HREF="PCI_BOOK.1e0.html#pgfId=3397" CLASS="Hypertext">GrayPage (csCode = 5)</A></H2><H2 CLASS="RoH.RoutineHeadingTOC"><A HREF="PCI_BOOK.1e1.html#pgfId=3410" CLASS="Hypertext">SetGray (csCode = 6)</A></H2><H2 CLASS="RoH.RoutineHeadingTOC"><A HREF="PCI_BOOK.1e2.html#pgfId=3416" CLASS="Hypertext">SetInterrupt (csCode = 7)</A></H2><H2 CLASS="RoH.RoutineHeadingTOC"><A HREF="PCI_BOOK.1e3.html#pgfId=3423" CLASS="Hypertext">DirectSetEntries (csCode = 8)</A></H2><H2 CLASS="RoH.RoutineHeadingTOC"><A HREF="PCI_BOOK.1e4.html#pgfId=3428" CLASS="Hypertext">SetDefaultMode (csCode = 9)</A></H2><H2 CLASS="RoH.RoutineHeadingTOC"><A HREF="PCI_BOOK.1e5.html#pgfId=3433" CLASS="Hypertext">SwitchMode (csCode = 10)</A></H2><H2 CLASS="RoH.RoutineHeadingTOC"><A HREF="PCI_BOOK.1e6.html#pgfId=3444" CLASS="Hypertext">SetSync (csCode = 11)</A></H2><H2 CLASS="RoH.RoutineHeadingTOC"><A HREF="PCI_BOOK.1e7.html#pgfId=3539" CLASS="Hypertext">SavePreferredConfiguration (csCode = 16)</A></H2><H2 CLASS="RoH.RoutineHeadingTOC"><A HREF="PCI_BOOK.1e8.html#pgfId=3555" CLASS="Hypertext">SetHardwareCursor (csCode = 22)</A></H2><H2 CLASS="RoH.RoutineHeadingTOC"><A HREF="PCI_BOOK.1e9.html#pgfId=3567" CLASS="Hypertext">DrawHardwareCursor (csCode = 23)</A></H2><H2 CLASS="RoH.RoutineHeadingTOC"><A HREF="PCI_BOOK.1ea.html#pgfId=3573" CLASS="Hypertext">SetPowerState (csCode = 25)</A></H2><HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 26 March 99)<P><A HREF="PCI_BOOK.1d6.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.1dc.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.1de.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></HTML>