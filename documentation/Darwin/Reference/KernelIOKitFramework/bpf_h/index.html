<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/1998/REC-html40-19980424/loose.dtd">
<html>
<head>
<title>bpf.h</title>
<meta http-equiv="Content-Type" content="text/html; charset=ascii">
<meta name="generator" content="HeaderDoc">
<style><!--
#tocMenu {
		display: block;
		position:fixed;
		top:0px;
		left:0px;
		width:210px;
		height:100%;
		background:transparent;
}
#bodyText {
		margin-left: 210px;
}
--></style>
<meta id="toc-file" name="toc-file" content="toc.html">
<script language="JavaScript" src="../../../../Resources/JavaScript/page.js" type="text/javascript"></script><link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css">
<style type="text/css"><!--.keyword {background:#ffffff; color:#761550;}.template {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.function {background:#ffffff; color:#000000;}.string {background: #ffffff; color:#891315;}.preprocessor {background:#ffffff; color:#236e25}.comment {background:#ffffff; color:#236e25}.char {background: #ffffff; color:#0000ff;}.var {background:#ffffff; color:#000000;}.type {background:#ffffff; color:#761550;}.param {background:#ffffff; color:#000000;}.graybox {         border-top: 1px solid #919699;         border-left: 1px solid #919699;         margin-bottom: 10px;         }  .graybox th {         padding: 4px 8px 4px 8px;         background: #E2E2E2;         font-size: 12px;         font-weight: bold;         border-bottom: 1px solid #919699;         border-right: 1px solid #919699;         }  .graybox td {         padding: 8px;         font-size: 12px;         text-align: left;         vertical-align: top;         border-bottom: 1px solid #919699;         border-right: 1px solid #919699;         }  --></style>
</head>
<body bgcolor="#ffffff" onload="initialize_page();">
<noscript>
<div id="tocMenu">
<iframe id="toc_content" name="toc_content" src="toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
</div>
</noscript>
<div id="bodyText">
<!-- start of header -->

<!-- start of header -->
<!--#include virtual="/includes/framesetheader"-->
<!-- end of header -->

<table width="600"><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <a href="../../../../../reference/Darwin/index.html#//apple_ref/doc/uid/TP30001281-TP30000422" target="_top">Darwin</a> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/kernel_fw_leo" target="_top">Kernel Framework Reference</a></font>
<!-- end breadcrumb insert request -->
<p>&#160;</p>
</td></tr></table>
<!-- end of header --><a name="top"></a>
<a name="//apple_ref/doc/header/bpf.h" title="bpf.h"></a>
<hr>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h1><a name="bpf.h">bpf.h</a></h1>
</td></tr></table>
<div class="spec_sheet_info_box"><table cellspacing="0" class="specbox"><tr>
<td scope="row"><b>Includes:</b></td>
<td><div style="margin-bottom:1px"><div class="content_text">
<!-- a -->&lt;sys/appleapiopts.h&gt;<!-- /a --><br><a href="../../usr_APIs/types/index.html#//apple_ref/doc/header/types.h" target="_top">&lt;sys/types.h&gt;</a><br><!-- a -->&lt;sys/time.h&gt;<!-- /a --><br><!-- a -->&lt;sys/cdefs.h&gt;<!-- /a --><br><!-- a -->&lt;sys/kernel_types.h&gt;<!-- /a --><br><!-- a -->&lt;sys/_structs.h&gt;<!-- /a -->
</div></div></td>
</tr></table></div>
<h2>Overview</h2>
<hr>
<br><h2>Functions</h2>
<a name="HeaderDoc_functions"></a>
<dl>
<dt><tt><a href="index.html#//apple_ref/c/func/bpf_attach" target="_top">bpf_attach</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/c/func/bpf_tap_in" target="_top">bpf_tap_in</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/c/func/bpf_tap_out" target="_top">bpf_tap_out</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/c/func/bpfattach" target="_top">bpfattach</a></tt></dt>
<dd></dd>
</dl>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/bpf_attach;   name=bpf_attach --><a name="//apple_ref/c/func/bpf_attach"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="bpf_attach">bpf_attach</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><!-- a --><span class="type">errno_t</span><!-- /a --> <a href="index.html#//apple_ref/c/func/bpf_attach" target="_top" class="function"><span class="function">bpf_attach</span></a>(
    <!-- a --><span class="type">ifnet_t</span><!-- /a --> <span class="param">interface</span>,
    <!-- a --><span class="type">u_int32_t</span><!-- /a --> <span class="param">data_link_type</span>, 
    <!-- a --><span class="type">u_int32_t</span><!-- /a --> <span class="param">header_length</span>,
    <a href="index.html#//apple_ref/c/tdef/bpf_send_func" target="_top" class="type"><span class="type">bpf_send_func</span></a> <span class="param">send</span>, 
    <a href="index.html#//apple_ref/c/tdef/bpf_tap_func" target="_top" class="type"><span class="type">bpf_tap_func</span></a> <span class="param">tap</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>interface</code></dt>
<dd><p>The interface to register with BPF.</p></dd>
<dt><code>data_link_type</code></dt>
<dd><p>The data link type of the interface. See the
DLT_* defines in bpf.h.</p></dd>
<dt><code>header_length</code></dt>
<dd><p>The length, in bytes, of the data link header.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Registers an interface with BPF. This allows bpf devices
to attach to your interface to capture and transmit packets.
Your interface will be unregistered automatically when your
interface is detached. You may register multiple times with
different data link types. An 802.11 interface would use this to
allow clients to pick whether they want just an ethernet style
frame or the 802.11 wireless headers as well. The first dlt you
register will be considered the default. Any bpf device attaches
that do not specify a data link type will use the default.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/bpf_tap_in;   name=bpf_tap_in --><a name="//apple_ref/c/func/bpf_tap_in"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="bpf_tap_in">bpf_tap_in</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <a href="index.html#//apple_ref/c/func/bpf_tap_in" target="_top" class="function"><span class="function">bpf_tap_in</span></a>(
    <!-- a --><span class="type">ifnet_t</span><!-- /a --> <span class="param">interface</span>,
    <!-- a --><span class="type">u_int32_t</span><!-- /a --> <span class="param">dlt</span>,
    <!-- a --><span class="type">mbuf_t</span><!-- /a --> <span class="param">packet</span>, 
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">header</span>,
    <!-- a --><span class="type">size_t</span><!-- /a --> <span class="param">header_len</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>interface</code></dt>
<dd><p>The interface the packet was received on.</p></dd>
<dt><code>dlt</code></dt>
<dd><p>The data link type of the packet.</p></dd>
<dt><code>packet</code></dt>
<dd><p>The packet received.</p></dd>
<dt><code>header</code></dt>
<dd><p>An optional pointer to a header that will be prepended.</p></dd>
<dt><code>headerlen</code></dt>
<dd><p>If the header was specified, the length of the header.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Call this function when your interface receives a
packet. This function will check if any bpf devices need a
a copy of the packet.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/bpf_tap_out;   name=bpf_tap_out --><a name="//apple_ref/c/func/bpf_tap_out"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="bpf_tap_out">bpf_tap_out</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <a href="index.html#//apple_ref/c/func/bpf_tap_out" target="_top" class="function"><span class="function">bpf_tap_out</span></a>(
    <!-- a --><span class="type">ifnet_t</span><!-- /a --> <span class="param">interface</span>,
    <!-- a --><span class="type">u_int32_t</span><!-- /a --> <span class="param">dlt</span>,
    <!-- a --><span class="type">mbuf_t</span><!-- /a --> <span class="param">packet</span>, 
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">header</span>,
    <!-- a --><span class="type">size_t</span><!-- /a --> <span class="param">header_len</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>interface</code></dt>
<dd><p>The interface the packet was or will be transmitted on.</p></dd>
<dt><code>dlt</code></dt>
<dd><p>The data link type of the packet.</p></dd>
<dt><code>packet</code></dt>
<dd><p>The packet received.</p></dd>
<dt><code>header</code></dt>
<dd><p>An optional pointer to a header that will be prepended.</p></dd>
<dt><code>headerlen</code></dt>
<dd><p>If the header was specified, the length of the header.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Call this function when your interface trasmits a
packet. This function will check if any bpf devices need a
a copy of the packet.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/bpfattach;   name=bpfattach --><a name="//apple_ref/c/func/bpfattach"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="bpfattach">bpfattach</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <a href="index.html#//apple_ref/c/func/bpfattach" target="_top" class="function"><span class="function">bpfattach</span></a>(
    <!-- a --><span class="type">ifnet_t</span><!-- /a --> <span class="param">interface</span>,
    <!-- a --><span class="type">u_int</span><!-- /a --> <span class="param">data_link_type</span>,
    <!-- a --><span class="type">u_int</span><!-- /a --> <span class="param">header_length</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>interface</code></dt>
<dd><p>The interface to register with BPF.</p></dd>
<dt><code>data_link_type</code></dt>
<dd><p>The data link type of the interface. See the
DLT_* defines in bpf.h.</p></dd>
<dt><code>header_length</code></dt>
<dd><p>The length, in bytes, of the data link header.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Registers an interface with BPF. This allows bpf devices
to attach to your interface to capture packets. Your interface
will be unregistered automatically when your interface is
detached.
<!-- end discussion -->
</p>
<p></p>
<h2>Typedefs</h2>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/bpf_send_func;   name=bpf_send_func --><a name="//apple_ref/c/tdef/bpf_send_func"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="bpf_send_func">bpf_send_func</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <!-- a --><span class="type">errno_t</span><!-- /a --> ( <span class="type">*</span><!-- a --><span class="function">bpf_send_func</span><!-- /a -->)(
    <!-- a --><span class="type">ifnet_t</span><!-- /a --> <span class="param">interface</span>,
    <!-- a --><span class="type">u_int32_t</span><!-- /a --> <span class="param">data_link_type</span>, 
    <!-- a --><span class="type">mbuf_t</span><!-- /a --> <span class="param">packet</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Fields</font></h5>
<dl>
<dt><code>interface</code></dt>
<dd><p>The interface the packet is being sent on.</p></dd>
<dt><code>dlt</code></dt>
<dd><p>The data link type the bpf device is attached to.</p></dd>
<dt><code>packet</code></dt>
<dd><p>The packet to be sent.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>bpf_send_func is called when a bpf file descriptor is
used to send a raw packet on the interface. The mbuf and data
link type are specified. The callback is responsible for
releasing the mbuf whether or not it returns an error.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/bpf_tap_func;   name=bpf_tap_func --><a name="//apple_ref/c/tdef/bpf_tap_func"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="bpf_tap_func">bpf_tap_func</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <!-- a --><span class="type">errno_t</span><!-- /a --> ( <span class="type">*</span><!-- a --><span class="function">bpf_tap_func</span><!-- /a -->)(
    <!-- a --><span class="type">ifnet_t</span><!-- /a --> <span class="param">interface</span>,
    <!-- a --><span class="type">u_int32_t</span><!-- /a --> <span class="param">data_link_type</span>, 
    <a href="../kpi_interface_h/index.html#//apple_ref/c/tdef/bpf_tap_mode" target="_top" class="type"><span class="type">bpf_tap_mode</span></a> <span class="param">direction</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Fields</font></h5>
<dl>
<dt><code>interface</code></dt>
<dd><p>The interface being tapped.</p></dd>
<dt><code>dlt</code></dt>
<dd><p>The data link type being tapped.</p></dd>
<dt><code>direction</code></dt>
<dd><p>The direction of the tap.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>bpf_tap_func is called when the tap state of the
interface changes. This happens when a bpf device attaches to an
interface or detaches from an interface. The tap mode will join
together (bit or) the modes of all bpf devices using that
interface for that dlt. If you return an error from this
function, the bpf device attach attempt that triggered the tap
will fail. If this function was called bacuse the tap state was
decreasing (tap in or out is stopping), the error will be
ignored.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/bpf_tap_mode_DONTLINK_1;   name=bpf_tap_mode --><a name="//apple_ref/c/tdef/bpf_tap_mode_DONTLINK_1"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="bpf_tap_mode">bpf_tap_mode</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Mode for tapping. BPF_MODE_DISABLED/BPF_MODE_INPUT_OUTPUT etc.
<!-- end abstract --></p>
<p></p>
<pre><span class="keyword">typedef</span> <!-- a --><span class="type">u_int32_t</span><!-- /a --> <!-- a --><span class="var">bpf_tap_mode</span><!-- /a -->;  </pre>
<p></p>
<h2>Enumerations</h2>
<hr>
<!-- headerDoc=tag;  uid=//apple_ref/c/tag/BPF_DONTLINK_1;   name=BPF --><a name="//apple_ref/c/tag/BPF_DONTLINK_1"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="BPF">BPF</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Constants defining interface families.
<!-- end abstract --></p>
<p></p>
<pre><span class="keyword">enum</span> { 
    <a href="../../KPI_Reference/kpi_interface/CompositePage.html#//apple_ref/c/econst/BPF_MODE_DISABLED" target="_top" class="var"><span class="var">BPF_MODE_DISABLED</span></a> = <span class="number">0</span>, 
    <a href="../../KPI_Reference/kpi_interface/CompositePage.html#//apple_ref/c/econst/BPF_MODE_INPUT" target="_top" class="var"><span class="var">BPF_MODE_INPUT</span></a> = <span class="number">1</span>, 
    <a href="../../KPI_Reference/kpi_interface/CompositePage.html#//apple_ref/c/econst/BPF_MODE_OUTPUT" target="_top" class="var"><span class="var">BPF_MODE_OUTPUT</span></a> = <span class="number">2</span>, 
    <a href="../../KPI_Reference/kpi_interface/CompositePage.html#//apple_ref/c/econst/BPF_MODE_INPUT_OUTPUT" target="_top" class="var"><span class="var">BPF_MODE_INPUT_OUTPUT</span></a> = <span class="number">3</span> 
};  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Constants</font></h5>
<blockquote>
<dl>
<dt><a name="//apple_ref/c/econst/BPF/BPF_MODE_DISABLED_DONTLINK_1"><code>BPF_MODE_DISABLED</code></a></dt>
<dd><p>Disable bpf.</p></dd>
<dt><a name="//apple_ref/c/econst/BPF/BPF_MODE_INPUT_DONTLINK_1"><code>BPF_MODE_INPUT</code></a></dt>
<dd><p>Enable input only.</p></dd>
<dt><a name="//apple_ref/c/econst/BPF/BPF_MODE_OUTPUT_DONTLINK_1"><code>BPF_MODE_OUTPUT</code></a></dt>
<dd><p>Enable output only.</p></dd>
<dt><a name="//apple_ref/c/econst/BPF/BPF_MODE_INPUT_OUTPUT_DONTLINK_1"><code>BPF_MODE_INPUT_OUTPUT</code></a></dt>
<dd><p>Enable input and output.</p></dd>
</dl>
</blockquote>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion -->tap mode<!-- end discussion -->
<p></p>
<p><!-- start of footer -->

<!-- start of footer --> 
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/KernelIOKitFramework/bpf_h/index.html%3Fid%3DTP30000816-3.4&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/KernelIOKitFramework/bpf_h/index.html%3Fid%3DTP30000816-3.4&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/KernelIOKitFramework/bpf_h/index.html%3Fid%3DTP30000816-3.4&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</p>
<p>&#160;</p>
<!--#include virtual="/footer"-->
<!-- end of footer -->


<!-- end of footer -->
Last Updated: 2008-12-19
</div>
<!-- headerDoc=Header;  uid=//apple_ref/doc/header/bpf.h;   name=bpf.h --><a name="//apple_ref/doc/header/bpf.h"></a>
</body>
</html>
