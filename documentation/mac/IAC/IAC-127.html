<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Setting the Client Application's User Interaction Preferences(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING127></A>


<!-- Top of Header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- Bottom of Header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-126.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-128.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-115.html"><B>Chapter 4 - Responding to Apple Events</B></A> / <A HREF="IAC-126.html"><B>Interacting With the User</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING127-0></A>
<H2>Setting the Client Application's User Interaction Preferences</H2>
 <A NAME=MARKER-2-195></A><A NAME=MARKER-2-205></A><A NAME=MARKER-21-208></A><A NAME=MARKER-2-418></A>The client application sets its user interaction preferences by setting flags in the <CODE>sendMode</CODE> parameter to the <CODE>AESend</CODE> function. The Apple Event Manager automatically adds the specified flags to the <CODE>keyInteractLevelAttr</CODE> attribute of the Apple event. These flags are represented by the following constants:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Flag<TH>Description<TR>
<TD>kAENeverInteract<TD>The server application should never interact with the user in response to the Apple event. If this flag is set, <CODE>AEInteractWithUser</CODE> returns the <CODE>errAENoUserInteraction</CODE> result code. This flag is the default when an Apple event is sent to a remote application.<A NAME=MARKER-2-194></A><TR>
<TD>kAECanInteract<TD>The server application can interact with the user in response to the Apple event--by convention, if the user needs to supply information to the server. If this flag is set and the server allows interaction, <CODE>AEInteractWithUser</CODE> either brings the server application to the foreground or posts a notification request. This flag is the default when an Apple event is sent to a local application. <A NAME=MARKER-2-199></A><TR>
<TD>kAEAlwaysInteract<TD>The server application can interact with the user in response to the Apple event--by convention, whenever the server application normally asks a user to confirm a decision or interact in any other way, even if no additional information is needed from the user. If this flag is set and the server allows interaction, <CODE>AEInteractWithUser</CODE> either brings the server application to the foreground or posts a notification request. <A NAME=MARKER-2-200></A></TABLE>
<P>
 For example, suppose a client application sends a Set Data event to a database application to change a customer's address. The database application is configured to request user confirmation of changes to a customer's record. In this case the client sets the <CODE>kAECanInteract</CODE> flag before sending the event. Thus, the database application attempts to interact with the user if interaction is allowed. If interaction is not allowed, the database makes the correction anyway without consulting the user. However, if the client application sends a Delete event to delete a customer's record entirely and sets the <CODE>kAEAlwaysInteract</CODE> flag, the database application deletes the specified record only if it can interact with the user first and receives confirmation of the decision to delete a record. If interaction with the user is not allowed, the database application returns an error. By setting the <CODE>kAEAlwaysInteract</CODE> flag, the client application ensures that the entire record won't be lost if the user sends the Delete event by mistake.<P>
 If the client application doesn't specify any of the three user interaction flags, the Apple Event Manager sets either the <CODE>kAENeverInteract</CODE> or the <CODE>kAECanInteract</CODE> flag in the <CODE>keyInteractLevelAttr</CODE> attribute of the Apple event, depending on the location of the server application. If the server application is on a remote computer, the Apple Event Manager sets the <CODE>kAENeverInteract</CODE> flag as the default. If the server application is on the local computer, the Apple Event Manager sets the <CODE>kAECanInteract</CODE> flag as the default.<P>
 In addition to the three user interaction flags, the client application can set another flag in the <CODE>sendMode</CODE> parameter to <CODE>AESend</CODE> to request that the Apple Event Manager immediately bring the server application directly to the foreground instead of posting a notification request:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Flag<TH>Description<TR>
<TD>kAECanSwitchLayer<TD>If both the client and server allow interaction, and if the client application is the active application on the local computer and is waiting for a reply (that is, it has set the <CODE>kAEWaitReply</CODE> flag), <CODE>AEInteractWithUser</CODE> brings the server directly to the foreground. Otherwise, <CODE>AEInteractWithUser</CODE> uses the Notification Manager to request that the user bring the server application to the foreground. <A NAME=MARKER-2-40></A> <A NAME=MARKER-21-233></A></TABLE>
<P>
 Note that although the <CODE>kAECanSwitchLayer</CODE> flag must be set for the Apple Event Manager to bring the server application directly to the foreground, setting it does not guarantee that the Apple Event Manager will bypass the notification request if user interaction is permitted. Another flag, the <CODE>kAEWaitReply</CODE> flag, must also be set in the <CODE>sendMode</CODE> parameter, and the client application must provide an idle function.<P>
 The <CODE>kAEWaitReply</CODE> flag is one of three flags in the <CODE>sendMode</CODE> parameter that a client application can set to specify whether and how the client should wait for a reply. (For a description of these flags, see <A HREF=IAC-105.html#MARKER-9-230>"Sending an Apple Event and Handling the Reply" on page 3-25</A>.) If the client application is not waiting for a reply, the user may have continued with other work. An application switch at this point might be unexpected and would thus violate the principle of user control as described in <I>Macintosh Human Interface Guidelines.</I><P>
 If the client application sets the <CODE>kAEWaitReply</CODE> flag, it should also provide an idle function when it calls <CODE>AESend</CODE> so that it can handle events such as update events that it receives while waiting for the reply. Idle functions are described in <A HREF=IAC-202.html#MARKER-9-123>"Writing an Idle Function,"</A> which begins on <A HREF=IAC-202.html#MARKER-9-123>page 5-22</A>.<P>
 When a server application calls <CODE>AEInteractWithUser</CODE>, the function first checks whether the <CODE>kAENeverInteract</CODE> flag in the <CODE>keyInteractLevelAttr</CODE> attribute of the Apple event is set. (The Apple Event Manager sets this attribute according to the flags specified in the <CODE>sendMode</CODE> parameter of <CODE>AESend</CODE>.) If the <CODE>kAENeverInteract</CODE> flag is set, <CODE>AEInteractWithUser</CODE> immediately returns the <CODE>errAENoUserInteraction</CODE> result code. If the client specified <CODE>kAECanInteract</CODE> or <CODE>kAEAlwaysInteract</CODE>, <CODE>AEInteractWithUser</CODE> checks the server's preferences for user interaction.<A NAME=MARKER-2-306></A><A NAME=MARKER-2-210></A><A NAME=MARKER-21-211></A><A NAME=MARKER-2-214></A><A NAME=MARKER-21-218></A><A NAME=MARKER-2-241></A><A NAME=MARKER-2-425></A> <A NAME=MARKER-2-47></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-126.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-128.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
