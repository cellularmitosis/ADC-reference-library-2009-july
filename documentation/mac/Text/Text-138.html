<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Measuring and Drawing Single Segments of Text(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING138></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-137.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-139.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-126.html"><B>Chapter 3 - QuickDraw Text</B></A> / <A HREF="Text-133.html"><B>Using QuickDraw Text</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING138-0></A>
<H2><A NAME=MARKER-2-78></A><A NAME=MARKER-2-15></A>Measuring and Drawing Single Segments of Text</H2>
 This section describes how to draw a single <A NAME=MARKER-2-217></A>glyph or a series of glyphs that share the same font and character attributes. Because you usually measure text before you draw it to determine if it fits on the display area, this section describes the measuring and drawing routines in pairs. These pairs are <A NAME=MARKER-2-87></A><CODE>CharWidth</CODE> and <A NAME=MARKER-2-336></A><CODE>DrawChar</CODE> to measure and draw the glyph of a single character, <CODE>StringWidth</CODE> and <CODE>DrawString</CODE> to measure and draw Pascal strings, and <CODE>TextWidth</CODE> and <CODE>DrawText</CODE> to measure and draw text segments.<P>
 You are responsible for tracking and specifying the memory location and the character attributes of the text to be drawn. This is true whether you are working with a single glyph, a Pascal string, or a text string. For a single glyph, you pass the character code to the procedure; for a Pascal string, you pass the string.<P>
<DL>
<DT><B>Note</B>
<DD>Before you call a QuickDraw measuring or drawing routine, you need to set the graphics port text-related fields to those of the character.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
<A NAME=HEADING138-4></A>
<H3><A NAME=MARKER-9-123></A>Individual Glyphs</H3>
 You measure text a character at a time by calling the <CODE>CharWidth</CODE> function, and you draw text a character at a time by calling the <CODE>DrawChar</CODE> procedure. These routines only work with 1-byte simple script systems.<P>
 Although this section describes how to use these routines, you should understand their limitations, and avoid using <A NAME=MARKER-2-50></A><CODE>CharWidth</CODE> and <A NAME=MARKER-2-198></A><CODE>DrawChar</CODE> for applications drawing sequences of more than one character. Nevertheless, you may want to use <CODE>DrawChar</CODE> for special purposes, such as including a glyph in a book's index, to show a single glyph as it exists apart from contextual transformations.<P>
 The <CODE>CharWidth</CODE> function takes into account all of the text characteristics defined in the current graphics port, so make sure these values reflect the attributes that you intend to draw with. You can draw a sequence of individual glyphs by placing the pen at the beginning of the leftmost glyph, and making a succession of calls to <CODE>DrawChar</CODE>.<P>
 Always use <CODE>CharWidth</CODE> to measure the width of a sequence of glyphs that you intend to draw using <CODE>DrawChar</CODE>, instead of using <CODE>StringWidth</CODE>; <CODE>StringWidth</CODE> and <CODE>DrawString</CODE> accumulate fractional portions, while <CODE>CharWidth</CODE> and <CODE>DrawChar</CODE> do not. Making successive calls to <CODE>CharWidth</CODE> to measure a segment of text and calling <CODE>StringWidth</CODE> to measure the same segment of text produce different results.<A NAME=MARKER-2-433></A><A NAME=MARKER-2-475></A><P>
 In general, you should measure and draw text in segments, rather than as individual glyphs. In Roman fonts, if you measure fractional-width glyphs singly using <CODE>CharWidth</CODE>, you can get incorrect results, because <CODE>CharWidth</CODE> doesn't accumulate fractional-width positions. Also, it takes longer to measure the widths of several glyphs one at a time than it does to measure them together using <CODE>TextWidth</CODE>.<P>
 For contextual 1-byte fonts, <CODE>CharWidth</CODE> and <CODE>DrawChar</CODE> do not correctly measure or draw ligatures, reversals, or other contextual forms. You cannot use <CODE>CharWidth</CODE> and <CODE>DrawChar</CODE> for 2-byte fonts, because they take a 1-byte character code as a parameter.<A NAME=MARKER-2-603></A><P>
<A NAME=HEADING138-11></A>
<H3><A NAME=MARKER-2-53></A><A NAME=MARKER-9-130></A>Pascal Strings</H3>
 You can call the <A NAME=MARKER-2-114></A><CODE>StringWidth</CODE> function to measure the screen pixel width of a Pascal string to determine how many glyphs will fit on the screen, and you can call the <A NAME=MARKER-2-402></A><CODE>DrawString</CODE> procedure to <A NAME=MARKER-9-51></A>draw a Pascal string with the text characteristics of the current graphics port. The <CODE>DrawString</CODE> procedure accumulates the fractional portion as it draws each glyph and positions the next glyph correctly.<P>
 You cannot use the <CODE>DrawString</CODE> and <CODE>StringWidth</CODE> routines to draw or measure a Pascal string that is justified or explicitly scaled. If you want to do this, you must separate the string from its length byte, and call <CODE>MeasureJustified</CODE> or <CODE>StdTxMeas</CODE> to measure it, and then <CODE>DrawJustified</CODE> to draw it, passing the text and the text length separately. Note that a Pascal string is limited to 255 characters. The following code fragment shows how to adjust for the length byte.<P>
<PRE>
myTextPtr := Ptr(Ord(@myString) + 1);
myTextLength := Ord(myString[0]);
</PRE>
<A NAME=HEADING138-15></A>
<H3><A NAME=MARKER-9-134></A>Text Segments </H3>
 You can call the <CODE>TextWidth</CODE> function to measure a segment of text to see if it fits on a single line; if it does, then you can the <CODE>DrawText</CODE> procedure to draw it.<P>
 You pass <CODE>DrawText</CODE> a pointer to the text buffer, the byte offset into the text buffer of the first character to be drawn, and the length of the text segment you want to draw. QuickDraw draws the text at the current pen position with the text characteristics of the current graphics port.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-137.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-139.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
