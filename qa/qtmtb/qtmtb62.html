<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!--Template 8-10-00--><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css">   <title>Technical Q&amp;A QTMTB62: Batch Exporting movie sound tracks with ConvertMovieToFile()</title><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><meta name="keywords" content=""><meta name="Description" content="Technical Q&amp;A QTMTB62: "><meta name="categories" content="QuickTime Movie Toolbox"><meta name="week-posted" content="Sep 4, 2000 - Sep 8, 2000"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002032" title="Batch Exporting movie sound tracks with ConvertMovieToFile()"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalqas/index.html">Technical Q&As</a> &gt; <a href="../../technicalqas/QuickTime/index.html">QuickTime</a> &gt; <a href="../../technicalqas/QuickTime/idxMovieBasics-date.html">Movie Basics</a> &gt; </p><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Q&amp;A QTMTB62</div>
<div id="pageheadsub">Batch Exporting movie sound tracks with ConvertMovieToFile()</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER> <!-- --> <!-- Document Body --></P> <CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600>   <TR>      <td align="left">                       <hr width=500 align=center><P id=p2>Q: I'm trying to batch export Movie sound tracks as AIFF files encoded with QDesign. <CODE>ConvertMovieToFile()</CODE> does this nicely, but I would like to configure the encoder only once for multiple files and not every time my application is run.</p><P id=p4>A: <CODE>ConvertMovieToFile()</CODE> can take a <CODE>ComponentInstance</CODE> as its last parameter. If you want a particular movie export component to perform the conversion (such as the AIFF "spit" component) you may pass an instance of that component here. This allows you to communicate directly with the component beforehand establishing any conversion parameters the user might want.</p><P id=p4>Here's how:</p><P id=p4>Open an instance of the export component, then use <CODE>MovieExportDoUserDialog()</CODE> to request the component to display its user dialog box. This provides an opportunity for the user to configure the component and will get the component to fill out the parameters fully and correctly. Because some encoders have complicated combinations of sample rates and output bit rates, it is a lot of work to do this by hand.</p><P id=p4>Once configured, call <CODE>MovieExportGetSettingsAsAtomContainer()</CODE> and save the resulting <CODE>AtomContainer</CODE>, perhaps in a configuration or preference file. You now have configuration information which can be used over and over again. See Listing 1.</p><P id=p4>When performing a batch mode operation simply open an instance of the Exporter component, call <CODE>MovieExportSetSettingsFromAtomContainer()</CODE> with the AtomContainer previously saved. The Export component will be configured as it was before avoiding any user interaction. You can then call <CODE>ConvertMovieToFile()</CODE> using the fully configured Export component as the last parameter. See Listing 2.</p><P id=p4>Once you're finished with the component be sure to close it by calling <CODE>CloseComponent()</CODE>.</p></td></tr></table><BR><CENTER><TABLE BORDER=0 CELLPADDING=0 WIDTH=480>            <TR>               <td align="left">                  <P>&nbsp;<B>Listing 1</B>. </P> <TABLE BORDER=0 CELLPADDING=5 WIDTH=470>                     <TR>                        <td bgcolor="#EEEEE0" align=left><pre>ComponentResult GetExportSettings(Movie inMovie, Track inTrack,     QTAtomContainer *outSettings){    Component c = 0;    ComponentInstance theExporter = 0;    ComponentDescription cd = { MovieExportType,                                kQTFileTypeAIFF,                                StandardCompressionSubTypeSound,                                hasMovieExportUserInterface,                                hasMovieExportUserInterface };    ComponentResult err = invalidComponentID;    Boolean ignore;    c = FindNextComponent(0, &amp;cd);    if (c == 0) goto bail;    err = OpenAComponent(c, &amp;theExporter);    if (err || theExporter == 0) goto bail;    err = MovieExportDoUserDialog(theExporter, inMovie,         inTrack, 0,      GetTrackDuration(inTrack), &amp;ignore);    if (err) goto bail;    err = MovieExportGetSettingsAsAtomContainer(theExporter,         outSettings);bail:    if (theExporter)        CloseComponent(theExporter);    return err;}</pre></td></tr></table><BR></td>	</tr></table></center><CENTER><TABLE BORDER=0 CELLPADDING=0 WIDTH=480>            <TR>               <td align="left">                  <P>&nbsp;<B>Listing 2</B>. </P> <TABLE BORDER=0 CELLPADDING=5 WIDTH=470>                     <TR>                        <td bgcolor="#EEEEE0" align=left><pre>OSErr DoExport(Movie inMovie, Track inTrack, FSSpec inFile[],     UInt16 inCount, QTAtomContainer *inSettings){    Component c = 0;    ComponentInstance theExporter = 0;    ComponentDescription cd = { MovieExportType,                                kQTFileTypeAIFF,                                StandardCompressionSubTypeSound,                                hasMovieExportUserInterface,                                hasMovieExportUserInterface };    OSErr err = invalidComponentID;    c = FindNextComponent(0, &amp;cd);    if (c == 0) goto bail;    err = OpenAComponent(c, &amp;theExporter);    if (err || theExporter == 0) goto bail;    err = MovieExportSetSettingsFromAtomContainer(theExporter,         *inSettings);    if (err) goto bail;    while (inCount &amp;&amp; !err) {        err = ConvertMovieToFile(inMovie,                               inTrack,                               &amp;inFile[--inCount],                               kQTFileTypeAIFF,                               sigMoviePlayer,                               smSystemScript,                               NULL,                               0,                               theExporter);    }bail:    if (theExporter)        CloseComponent(theExporter);    return err;}</pre></td></tr></table><!-- begin_date --><H4 ALIGN=center>[Sep 05 2000]</H4><!-- end_date -->		</td>	</tr></table></center></CENTER><P ALIGN=center></CENTER><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/qa/qtmtb/qtmtb62.html%3Fid%3DDTS10002032-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/qa/qtmtb/qtmtb62.html%3Fid%3DDTS10002032-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/qa/qtmtb/qtmtb62.html%3Fid%3DDTS10002032-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></P></BODY></HTML>