<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>

	<!-- BEGIN META TAG INFO -->
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<link rel="home" href="http://developer.apple.com/">
	<link rel="find" href="http://developer.apple.com/search/">
	<link rel="stylesheet" type="text/css" href="../../documentation/css/adcstyle.css" title="fonts">
	<script language="JavaScript" src="../../documentation/js/adc.js" type="text/javascript"></script>
	<!-- END META TAG INFO -->
	
	<!-- BEGIN TITLE -->
	<title>7Edit - /Source/SVEditUtils.c</title>
	<!-- END TITLE -->
<script language="JavaScript">
function JumpToNewPage() {
	window.location=document.scpopupmenu.gotop.value;
	return true;
}
</script>

</head>

<!-- BEGIN BODY OPEN -->
<body>
<!--END BODY OPEN -->

<!-- START CENTER OPEN -->
<center>
<!-- END CENTER OPEN -->

	<!-- BEGIN LOGO AND SEARCH -->
	<!--#include virtual="/includes/adcnavbar"-->
	<!-- END LOGO AND SEARCH -->
		
		
	<!-- START BREADCRUMB -->
	<div id="breadcrumb">
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td scope="row"><img width="340" height="10" src="images/1dot.gif" alt=""></td>
			<td><img width="340" height="10" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr valign="middle">
			<td align="left" colspan="2">
			<a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../samplecode/index.html">Sample Code</a> &gt; <a href="../../samplecode/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../samplecode/LegacyTechnologies/idxMacOS9Earlier-date.html">Mac OS 9 & Earlier</a> &gt; <A HREF="javascript:location.replace('index.html');">7Edit</A> &gt; 
			</td>
		</tr>
		<tr>
			<td colspan="2" scope="row"><img width="680" height="35" src="images/1dot.gif" alt=""></td>
		</tr>
	</table>
	</div>
	<!-- END BREADCRUMB -->

	<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/Carbon/idxInterapplicationCommunication-date.html" target="_blank">Carbon > Interapplication Communication</a></li>
	</ul>
</div>




</div></div></div>

	<!-- START MAIN CONTENT -->
	
	<!-- START TITLE GRAPHIC AND INTRO-->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td><h1><div id="pagehead">7Edit</div></h1></td>
		</tr>
	</table>
	<!-- END TITLE GRAPHIC AND INTRO -->
	<!-- START WIDE COLUMN -->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td id="scdetails">
				<h2>/Source/SVEditUtils.c</h2>
				<form name="scpopupmenu" onSubmit="return false;" method=post>
				<p><strong>View Source Code:</strong> 
					<select name="gotop" onChange="JumpToNewPage();" style="width:340px"><option selected value="ingnore">Select File</option>
<option value="listing1.html">/Source/DebugUtils.c</option>
<option value="listing2.html">/Source/DebugUtils.h</option>
<option value="listing3.html">/Source/Offscreen.c</option>
<option value="listing4.html">/Source/Offscreen.h</option>
<option value="listing5.html">/Source/SVAEAccessors.c</option>
<option value="listing6.html">/Source/SVAEAccessors.h</option>
<option value="listing7.html">/Source/SVAEClone.c</option>
<option value="listing8.html">/Source/SVAEClone.h</option>
<option value="listing9.html">/Source/SVAEClose.c</option>
<option value="listing10.html">/Source/SVAEClose.h</option>
<option value="listing11.html">/Source/SVAECoercions.c</option>
<option value="listing12.html">/Source/SVAECoercions.h</option>
<option value="listing13.html">/Source/SVAECompare.c</option>
<option value="listing14.html">/Source/SVAECompare.h</option>
<option value="listing15.html">/Source/SVAECopy.c</option>
<option value="listing16.html">/Source/SVAECopy.h</option>
<option value="listing17.html">/Source/SVAECountElements.c</option>
<option value="listing18.html">/Source/SVAECountElements.h</option>
<option value="listing19.html">/Source/SVAECreate.c</option>
<option value="listing20.html">/Source/SVAECreate.h</option>
<option value="listing21.html">/Source/SVAECut.c</option>
<option value="listing22.html">/Source/SVAECut.h</option>
<option value="listing23.html">/Source/SVAEDelete.c</option>
<option value="listing24.html">/Source/SVAEDelete.h</option>
<option value="listing25.html">/Source/SVAEGetData.c</option>
<option value="listing26.html">/Source/SVAEGetData.h</option>
<option value="listing27.html">/Source/SVAEGetDataSize.c</option>
<option value="listing28.html">/Source/SVAEGetDataSize.h</option>
<option value="listing29.html">/Source/SVAEMove.c</option>
<option value="listing30.html">/Source/SVAEMove.h</option>
<option value="listing31.html">/Source/SVAEObjectsExist.c</option>
<option value="listing32.html">/Source/SVAEObjectsExist.h</option>
<option value="listing33.html">/Source/SVAEPaste.c</option>
<option value="listing34.html">/Source/SVAEPaste.h</option>
<option value="listing35.html">/Source/SVAERecording.c</option>
<option value="listing36.html">/Source/SVAERecording.h</option>
<option value="listing37.html">/Source/SVAERevert.c</option>
<option value="listing38.html">/Source/SVAERevert.h</option>
<option value="listing39.html">/Source/SVAESave.c</option>
<option value="listing40.html">/Source/SVAESave.h</option>
<option value="listing41.html">/Source/SVAESelect.c</option>
<option value="listing42.html">/Source/SVAESelect.h</option>
<option value="listing43.html">/Source/SVAESetData.c</option>
<option value="listing44.html">/Source/SVAESetData.h</option>
<option value="listing45.html">/Source/SVAETextUtils.c</option>
<option value="listing46.html">/Source/SVAETextUtils.h</option>
<option value="listing47.html">/Source/SVAEWindowUtils.c</option>
<option value="listing48.html">/Source/SVAEWindowUtils.h</option>
<option value="listing49.html">/Source/SVAppleEvents.c</option>
<option value="listing50.html">/Source/SVAppleEvents.h</option>
<option value="listing51.html">/Source/SVDrag.c</option>
<option value="listing52.html">/Source/SVDrag.h</option>
<option value="listing53.html">/Source/SVEditAEUtils.c</option>
<option value="listing54.html">/Source/SVEditAEUtils.h</option>
<option value="listing55.html">/Source/SVEditFile.c</option>
<option value="listing56.html">/Source/SVEditFile.h</option>
<option value="listing57.html">/Source/SVEditGlobals.c</option>
<option value="listing58.html">/Source/SVEditGlobals.h</option>
<option value="listing59.html">/Source/SVEditMain.c</option>
<option value="listing60.html">/Source/SVEditMain.h</option>
<option value="listing61.html">/Source/SVEditPrinting.c</option>
<option value="listing62.html">/Source/SVEditPrinting.h</option>
<option value="listing63.html">/Source/SVEditUtils.c</option>
<option value="listing64.html">/Source/SVEditUtils.h</option>
<option value="listing65.html">/Source/SVEditWindow.c</option>
<option value="listing66.html">/Source/SVEditWindow.h</option>
<option value="listing67.html">/Source/SVToken.h</option></select>
				</p>
				</form>
				<p><strong><a href="7Edit.zip">Download Sample</a></strong> (&#147;7Edit.zip&#148;, 205.9K)<BR>
<strong><a href="7Edit.dmg">Download Sample</a></strong> (&#147;7Edit.dmg&#148;, 251.7K)</p>
				<!--
				<p><strong><a href="#">Download Sample</a></strong> (&#147;filename.sit&#148;, 500K)</p>
				-->
			</td>
		</tr>
		<tr>
			<td scope="row"><img width="680" height="10" src="images/1dot.gif" alt=""><br>
			<img height="1" width="680" src="images/1dot_919699.gif" alt=""><br>
			<img width="680" height="20" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr>
			<td scope="row">
	<!--googleon: index -->
<pre class="sourcecodebox">/*  File:    SVEditUtils.c  Contains:    Written by: Original version by Jon Lansdell and Nigel Humphreys.              3.1 updates by Greg Sutton.    Copyright:  Copyright &copy;1995-1999 by Apple Computer, Inc., All Rights Reserved.        You may incorporate this Apple sample source code into your program(s) without        restriction. This Apple sample source code has been provided &quot;AS IS&quot; and the        responsibility for its operation is yours. You are not permitted to redistribute        this Apple sample source code as &quot;Apple sample source code&quot; after having made        changes. If you're going to re-distribute the source, we require that you make        it clear in the source that the code was descended from Apple sample source        code, but that you've made changes.  Change History (most recent first):        7/19/1999  Karl Groethe  Updated for Metrowerks Codewarror Pro 2.1        10/12/95  CW            Simplified FeatureIsImplemented routine.                                 Added init of gHasDragManager flag in CheckEnvironment.        */#include &lt;DriverServices.h&gt;#include &lt;Events.h&gt;#include &lt;Traps.h&gt;#include &lt;Dialogs.h&gt;#include &lt;Fonts.h&gt;#include &lt;Packages.h&gt;#include &lt;ToolUtils.h&gt;#include &lt;AppleEvents.h&gt;#include &lt;CodeFragments.h&gt;#include &quot;SVEditUtils.h&quot;#include &lt;TextUtils.h&gt;/**-----------------------------------------------------------------------    Name:       LesserOf    Purpose:    Returns the Lesser of two longints.  -----------------------------------------------------------------------**/#pragma segment Utils    pascal long LesserOf(long A, long B) {   if (A&lt;B)     return(A);   else     return(B); }   /*LesserOf*/      /**-----------------------------------------------------------------------    Name:       GreaterOf    Purpose:    Returns the Greater of two longints.  -----------------------------------------------------------------------**/  #pragma segment Utils    pascal long GreaterOf(long A, long B) {   if (A&gt;B)     return(A);   else     return(B); }  /*GreaterOf*/      /**-----------------------------------------------------------------------    Name:       ShowError    Purpose:    Reports an error to the user as both string and number.  -----------------------------------------------------------------------**/#pragma segment Utils    pascal void ShowError(Str255  theError,                      long    theErrorCode){   short     alertResult;   Str255    theString;   OSErr     myErr;      myErr = AEInteractWithUser(kAEDefaultTimeout, nil,nil);      if (myErr == noErr)     {       SetCursor(&amp;qd.arrow);       NumToString(theErrorCode, theString);       ParamText(theError, theString, (unsigned char *)&quot;&quot;, (unsigned char *)&quot;&quot;);       alertResult = Alert(300, nil);     }} /* ShowError *//**-----------------------------------------------------------------------    Name:       Ours    Purpose:    Checks the frontmost window belongs to the app.  -----------------------------------------------------------------------**/#pragma segment Utils        pascal Boolean Ours(WindowPtr aWindow) {    if (aWindow)      if (((WindowPeek)aWindow)-&gt;windowKind == zoomDocProc)        return(true);    return(false);} /* Ours *//**-----------------------------------------------------------------------    Name:       SetShortMenus    Purpose:    Cuts the menus down to a minimum - Apple File Edit.                Greys out the unavailable options - used when no docs open  -----------------------------------------------------------------------**/#pragma segment Utils    pascal void SetShortMenus(){   DeleteMenu(mfontID);  DeleteMenu(sizeID);  DeleteMenu(styleID);  DisableItem(myMenus[fileM], fmClose);  DisableItem(myMenus[fileM], fmSave);  DisableItem(myMenus[fileM], fmSaveAs);  DisableItem(myMenus[fileM], fmRevert);  DisableItem(myMenus[fileM], fmPageSetUp);  DisableItem(myMenus[fileM], fmNoGXPrint);  /* now the unnecessary items on the edit menu */          DisableItem(myMenus[editM], undoCommand);  DisableItem(myMenus[editM], cutCommand);  DisableItem(myMenus[editM], copyCommand);  DisableItem(myMenus[editM], clearCommand);  DisableItem(myMenus[editM], pasteCommand);  DisableItem(myMenus[editM], selectAllCommand);  DrawMenuBar();}  /* SetShortMenus *//**-----------------------------------------------------------------------    Name:       SetLongMenus    Purpose:    Reinstates the full menu bar - called when first document                opened.  -----------------------------------------------------------------------**/#pragma segment Utils    pascal void SetLongMenus()  {    InsertMenu(myMenus[fontM], 0);    InsertMenu(myMenus[sizeM], 0);    InsertMenu(myMenus[styleM], 0);    EnableItem(myMenus[fileM], fmClose);    EnableItem(myMenus[fileM], fmSave);    EnableItem(myMenus[fileM], fmSaveAs);    EnableItem(myMenus[fileM], fmRevert);    EnableItem(myMenus[fileM], fmPageSetUp);    EnableItem(myMenus[fileM], fmNoGXPrint );    /* now the necessary items on the edit menu -      many other items fixed on each pass thru the main event      loop or before the window pulled down    */        EnableItem(myMenus[editM], selectAllCommand);    DrawMenuBar();  }  /* SetLongMenus *//**-----------------------------------------------------------------------    Name:       SetStyleMenu    Purpose:    Sets the style menu checking to reflect the style of the                first character of the current selection in the given                document.  -----------------------------------------------------------------------**/#pragma segment Utils        pascal void SetStyleMenu(DPtr theDoc)  {    TextStyle    theTStyle;    short       contMode;    short       i;        contMode = doFace;        TEContinuousStyle(&amp;contMode,&amp;theTStyle,theDoc-&gt;theText);        if ((contMode &amp; doFace) != 0)      {        CheckItem(myMenus[styleM], cPlain,     (theTStyle.tsFace == 0));        CheckItem(myMenus[styleM], cBold,      (bold      &amp; theTStyle.tsFace));        CheckItem(myMenus[styleM], cItalic,    (italic    &amp; theTStyle.tsFace));        CheckItem(myMenus[styleM], cUnderline, (underline &amp; theTStyle.tsFace));        CheckItem(myMenus[styleM], cOutline,   (outline   &amp; theTStyle.tsFace));        CheckItem(myMenus[styleM], cShadow,    (shadow    &amp; theTStyle.tsFace));        CheckItem(myMenus[styleM], cCondense,  (condense  &amp; theTStyle.tsFace));        CheckItem(myMenus[styleM], cExtend,    (extend    &amp; theTStyle.tsFace));      }    else      for (i=cPlain; i&lt;= cExtend; i++)        CheckItem(myMenus[styleM], i,     false);  }/**-----------------------------------------------------------------------    Name:       SetSizeMenu    Purpose:    Outline all the items if the current font is an                outline font. Check the size of the current selection  -----------------------------------------------------------------------**/#pragma segment Utils    pascal void SetSizeMenu(DPtr theDoc)  {    short       i;    short        aSize;    short        max;    long         theSize;    Str255      name;    Boolean     sizeinMenu;    Boolean     oldState;    Point       numer;    TextStyle    theStyle;    TEHandle    myText;    short       contMode;          numer.h = 1;    numer.v = 1;    myText = theDoc-&gt;theText;        contMode = doSize+doFont;        TEContinuousStyle(&amp;contMode,&amp;theStyle,theDoc-&gt;theText);        sizeinMenu = false;    max = CountMItems(myMenus[sizeM]);    for (i = 1; i &lt;= max - 5; i++)      {        GetMenuItemText(myMenus[sizeM], i, name);        StringToNum(name, &amp;theSize);        aSize = (short)theSize;        if (RealFont(theStyle.tsFont, aSize) &amp;&amp; (contMode &amp; doFont) != 0) // there is only one font and this size exists          SetItemStyle(myMenus[sizeM], i, outline);        else          SetItemStyle(myMenus[sizeM], i, 0);        if ((aSize == theStyle.tsSize) &amp;&amp; (contMode &amp; doSize) != 0)          {            sizeinMenu = true;            CheckItem(myMenus[sizeM], i, true);          }        else          CheckItem(myMenus[sizeM], i, false);      }              /*        if it's not a size in the menu,and there is only one size in the        selection range check the other item      */            if (!sizeinMenu &amp;&amp; (contMode &amp; doSize) != 0)        CheckItem(myMenus[sizeM], max, true);      else        CheckItem(myMenus[sizeM], max, false);      /*if this is an outline font, set the rest of the items to outline style*/      /*RealFont will ensure that the sizes are outlined*/      oldState = GetOutlinePreferred();      SetOutlinePreferred(true);      for (i = max-4; i &lt;= max; i++)        {          if (IsOutline(numer, numer) &amp;&amp; (contMode &amp; doFont)!= 0)            SetItemStyle(myMenus[sizeM], i, outline);          else            SetItemStyle(myMenus[sizeM], i, 0);        }              SetOutlinePreferred(oldState);  }/**-----------------------------------------------------------------------    Name:       SetFontMenu    Purpose:    Set the font menu according to the state of                current selection of the supplied document.  -----------------------------------------------------------------------**/#pragma segment Utils    pascal void SetFontMenu(DPtr theDoc)  {    MenuHandle    theMHandle;    short         theNumber;    short         i;    short          max;    Str255        name;    TextStyle     theStyle;    short         contMode;    theMHandle = GetMenuHandle(mfontID);    if (gFontMItem)      CheckItem(theMHandle, gFontMItem, false);          max = CountMItems(theMHandle);    contMode = doFont;    TEContinuousStyle(&amp;contMode,&amp;theStyle,theDoc-&gt;theText);    gFontMItem = 0;        if (contMode &amp; doFont)      for (i=1; i&lt;=max; i++)        {          GetMenuItemText(theMHandle, i, name);          GetFNum(name, &amp;theNumber);          if (theNumber == theStyle.tsFont)            gFontMItem = i;        }    if (gFontMItem)      CheckItem(theMHandle, gFontMItem, true);          SetSizeMenu(theDoc);    SetStyleMenu(theDoc);  }/**-----------------------------------------------------------------------    Name:       GetTempFileName    Purpose:    Fills newstring with a temporary file name.  -----------------------------------------------------------------------**/#pragma segment Utilspascal void GetTempFileName(DPtr aDoc,                            Str255 newString)  {     Str255        s;     Str255        fileName;    if (aDoc-&gt;everSaved == false)      PStrCopy(fileName, (unsigned char *)&quot;\pTEXTra&quot;);    else      PStrCopy(fileName, aDoc-&gt;theFileName);    /*generate a unique(ish) temporary filename*/        if (fileName[0] &gt; 21)      fileName[0] = 21;              NumToString(TickCount(), s);        PStrCat(fileName, s);        PStrCopy(newString,fileName);  }/**-----------------------------------------------------------------------    Name:       SetText    Purpose:    Sets the text of the supplied itemNo in aDialog to                 theString and select it.  -----------------------------------------------------------------------**/#pragma segment Utilspascal void SetText(DialogPtr aDialog,                    short     itemNo,                    Str255    theString)  {    Handle      itemHandle;    Rect        box;    short       kind;    TEHandle    theTEHandle;    GetDialogItem(aDialog, itemNo, &amp;kind, &amp;itemHandle, &amp;box);    SetDialogItemText(itemHandle, theString);            theTEHandle = ((DialogPeek)aDialog)-&gt;textH;    /*set all the text to be selected*/    if (theTEHandle)      TESetSelect(0, 255, theTEHandle);  }      /**-----------------------------------------------------------------------    Name:       RetrieveText    Purpose:    Returns the text of anItem in aDialog in aString.  -----------------------------------------------------------------------**/#pragma segment Utilspascal void RetrieveText(DialogPtr aDialog,                         short     anItem,                         Str255    aString)  {     short      kind;     Rect       box;     Handle     itemHandle;     GetDialogItem(aDialog, anItem, &amp;kind, &amp;itemHandle, &amp;box);     GetDialogItemText(itemHandle, aString);  }/**-----------------------------------------------------------------------    Name:       DrawDefaultOutline    Purpose:    Draws an outline around theItem.                Called as a useritem Proc by the dialog manager.                To use place a useritem over the default item in the                dialog and install the address of this proc as the item                handle.  -----------------------------------------------------------------------**/#pragma segment Utilspascal void DrawDefaultOutline(DialogPtr theDialog, short theItem)  {    short       kind;    Handle      itemHandle;    Rect        box;            GetDialogItem(theDialog, theItem, &amp;kind, &amp;itemHandle, &amp;box);    PenSize(3, 3);    InsetRect(&amp;box, - 4, - 4);    FrameRoundRect(&amp;box, 16, 16);    PenNormal();      }  /* DrawDefaultOutline */      /**-----------------------------------------------------------------------    Name:       AdornDefaultButton    Purpose:    Installs DrawDefaultOutline as the useritem proc                for the given item.  -----------------------------------------------------------------------**/#pragma segment Utils    pascal void AdornDefaultButton(DialogPtr theDialog,short theItem)  {    short       kind;    Handle      itemHandle;    Rect        box;    GetDialogItem(theDialog, theItem, &amp;kind, &amp;itemHandle, &amp;box);    SetDialogItem(theDialog, theItem, kind, (Handle)gDefaultButtonUPP, &amp;box);  }    /*-------  Determining of Gestalt is available ---------------*/    /*The following routines come from the Inside Mac VI recommendations*/    /*about how to find if a trap is available*/     /*      The glue for Gestalt will be in MPW 3.2, so if it is available we will also       need to check the system version    */pascal void GetRectOfDialogItem(DialogPtr theDialog, short theItem, Rect *theRect)  {    short       kind;    Handle      itemHandle;        GetDialogItem(theDialog, theItem, &amp;kind, &amp;itemHandle, theRect);  }#pragma segment Utilspascal short NumToolboxTraps(void)  {    if (NGetTrapAddress(_InitGraf, ToolTrap) == NGetTrapAddress(0xAA6E, ToolTrap))      return(0x200);    else      return(0x400);  }#pragma segment Utils#define TrapMask  0x0800pascal TrapType GetTrapType(short theTrap)  {    if ((theTrap &amp; TrapMask) &gt; 0)      return(ToolTrap);    else      return(OSTrap);  }#pragma segment Utilspascal Boolean TrapAvailable(short theTrap)  {    TrapType  tType;    tType = GetTrapType(theTrap);    if (tType == ToolTrap)      {        theTrap = theTrap &amp; 0x07FF;        if (theTrap &gt;= NumToolboxTraps())          theTrap = _Unimplemented;      }    return(NGetTrapAddress(theTrap, tType) != NGetTrapAddress(_Unimplemented,ToolTrap));  }#pragma segment Utils#define _Gestalt 0xA1ADpascal Boolean GestaltAvailable()  {    return(TrapAvailable(_Gestalt));  }/**------  FeatureIsImplemented    ------------**//*This is called to use Gestalt to determine if a feature is implemented. This applies to only those referenced by OSType*/#pragma segment Utilspascal Boolean FeatureIsImplemented ( OSType theFeature, short theTestBit ){  OSErr     err;  long      result;  err = Gestalt ( theFeature, &amp;result );  return (err == noErr &amp;&amp; (result &amp; (1L &lt;&lt; theTestBit)));  }#pragma segment Utilspascal Boolean CheckEnvironment()  {    /*     first determine of Gestalt is available- if it isn't exit     as we only run under 7.0.  It could it present in 6.04 - so we need     to do some further checks for important features    */    gGestaltAvailable = GestaltAvailable();        if (!gGestaltAvailable)      return(false);    /*first check if the Edition Manager is present*/            gEditionManagerImplemented = FeatureIsImplemented(gestaltEditionMgrAttr,                                                      gestaltEditionMgrPresent);    /*and for good measure- the Alias manager*/            gAliasManagerImplemented  = FeatureIsImplemented(gestaltAliasMgrAttr,                                                     gestaltAliasMgrPresent);          /*check for the AppleEvents manager - we certainly can't work without it*/        gAppleEventsImplemented   = FeatureIsImplemented(gestaltAppleEventsAttr,                                                     gestaltAppleEventsPresent);        /*check if recording is implemented*/        gRecordingImplemented   = FeatureIsImplemented(gestaltAppleEventsAttr,1);          /*check for the Outline fonts*/        gOutlineFontsImplemented  = FeatureIsImplemented(gestaltFontMgrAttr,                                                     gestaltOutlineFonts);        // We would also like the Drag Manager  gHasDragManager = FeatureIsImplemented ( gestaltDragMgrAttr, gestaltDragMgrPresent );    // It isn't enough to use Gestalt because we may not have sucessfully linked  // to the DragLib shared library. So, we also need to test one of the symbols  // against kUnresolvedSymbol to make sure we have a valid connection to it.  #if GENERATINGCFM  if ( gHasDragManager )    gHasDragManager = (InstallTrackingHandler != (void*) kUnresolvedCFragSymbolAddress);#endif    return (gEditionManagerImplemented &amp;&amp;            gAliasManagerImplemented   &amp;&amp;            gAppleEventsImplemented    &amp;&amp;            gOutlineFontsImplemented);                  }  /* CheckEnvironment */        /*    DoPageSetup returns true if the page setup of the document is altered  */    pascal Boolean DoPageSetup(DPtr theDoc)    {        Boolean result = false;        if (theDoc)            {              PrOpen();              result =  PrStlDialog(theDoc-&gt;thePrintSetup);              PrClose();            }                  return(result);    }  /* DoPageSetup *//*  Name:    CtrlKeyPressed  Purpose: Returns true if control key pressed during event*/pascal Boolean CtrlKeyPressed(const EventRecord *theEvent)  {    return((theEvent-&gt;modifiers &amp; controlKey) != 0);  }  /*  Name:    OptionKeyPressed  Purpose: Returns true if option key pressed during event*/pascal Boolean OptionKeyPressed(const EventRecord *theEvent)  {    return((theEvent-&gt;modifiers &amp; optionKey) != 0);  }</pre>
	<!--googleoff: index -->
			</td>
		</tr>
	</table>
	<!-- END WIDE COLUMN -->

	<!-- END MAIN CONTENT -->
		<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/samplecode/7Edit/listing63.html%3Fid%3DDTS10000200-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/samplecode/7Edit/listing63.html%3Fid%3DDTS10000200-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/samplecode/7Edit/listing63.html%3Fid%3DDTS10000200-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

	<!-- START BOTTOM APPLE NAVIGATION -->
	<!--#include virtual="/includes/footer"-->
	<!-- END BOTTOM APPLE NAVIGATION -->

<!-- START CENTER CLOSE -->
</center>
<!-- END CENTER CLOSE -->

</body>
</html>