<HTML>	<HEAD>		<META HTTP-EQUIV="content-type" CONTENT="text/html;charset=iso-8859-1">		<META NAME="generator" CONTENT="GoLive CyberStudio">		<script language="JavaScript" src="frametest.js"></script><TITLE>ATA_RegAccess</TITLE>	</HEAD>	<BODY BGCOLOR="#ffffff"><a name="top"></a><!-- start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!-- start of path --><table border="0" cellpadding="0" cellspacing="2" width="432">		<tr>	<td scope="row"><font face="Geneva,Helvetica,Arial" size="1">	<b>PATH<img src="../../../images/space.gif" width="6" height="12"></b>	<a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Documentation</a> &gt; <!-- a href="" target="_top" -->Hardware<!-- /a --> 	<b>&gt;</b> <a href="../../devicemgrs.html">Device Managers and Drivers</a>	<b>&gt;</b> <a href="../ata.html" target="_top">ATA Devices</a>	<b>&gt;</b> ATA Device Software Guide		</font></td>	</tr>	</table><br><!-- end of path --><P><A HREF="ATA.2a.html"><img src="images/up.gif" border="0"></A> <A HREF="ATA.30.html"><img src="images/previous.gif" border="0"></A> <A HREF="ATA.32.html"><img src="images/next.gif" border="0"></A> <!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></a></div><!-- end top navigation --><hr>		<A NAME="pgfId=945"></A><A NAME="35347"></A><H3>ATA_RegAccess</H3>		<P CLASS="T0.Text0"><A NAME="pgfId=946"></A>The <TT CLASS="cv">ATA_RegAccess</TT> function enables access to a particular device register of a		selected device. This function is used for diagnostic and error		recovery processes. <A NAME="marker=947"></A><A NAME="marker=948"></A></P>		<P CLASS="T1.Text1"><A NAME="pgfId=2791"></A>This call finctions properly with ATA Manager versions 3 and ATA		Manager 4.1.1, and does not function properly with ATA Manager		versions 4.0.0 or 4.1.0. ATA Manager 4.1.1 is part of the Mac		OS 8 software release. To get the version number of the current		ATA Manager, use the <TT CLASS="cv"><A HREF="ATA.2c.html#15537" CLASS="XRef">ATA_MgrInquiry</TT> function</A>. </P>		<P CLASS="T1.Text1"><A NAME="pgfId=949"></A>The manager function code for the <TT CLASS="cv">ATA_RegAccess</TT> function is $12. </P>		<P CLASS="T1.Text1"><A NAME="pgfId=950"></A>The parameter block associated with this function is defined below:</P>		<P><A NAME="pgfId=14345"></A><TABLE BORDER="0" CELLPADDING="0" CELLSPACING="2" FRAME WIDTH="481">			<TR VALIGN="TOP">				<TD COLSPAN="2"><CODE CLASS="Cv.Code">typedef</CODE></TD>				<TD WIDTH="37"></TD>				<TD WIDTH="100"><CODE CLASS="Cv.Code">struct</CODE></TD>				<TD WIDTH="200"><CODE CLASS="Cv.Code">/* Register access structure */</CODE></TD>			</TR>			<TR>				<TD WIDTH="20"><CODE CLASS="Cv.Code">{</CODE></TD>				<TD WIDTH="75"></TD>				<TD WIDTH="37"></TD>				<TD WIDTH="100"></TD>				<TD WIDTH="200"></TD>			</TR>			<TR>				<TD WIDTH="20"></TD>				<TD WIDTH="75"><CODE CLASS="Cv.Code">struct</CODE></TD>				<TD WIDTH="37"></TD>				<TD WIDTH="100"><CODE CLASS="Cv.Code">ataPBHdr</CODE></TD>				<TD WIDTH="200"><CODE CLASS="Cv.Code">/* ataPBHdr parameter block */</CODE></TD>			</TR>			<TR VALIGN="TOP">				<TD WIDTH="20"></TD>				<TD WIDTH="75"><CODE CLASS="Cv.Code">UInt16</CODE></TD>				<TD WIDTH="37"></TD>				<TD WIDTH="100"><CODE CLASS="Cv.Code">RegSelect</CODE></TD>				<TD WIDTH="200"><CODE CLASS="Cv.Code">/* --&gt; Device register */<BR>				/* selector */</CODE></TD>			</TR>			<TR>				<TD WIDTH="20"></TD>				<TD WIDTH="75"><CODE CLASS="Cv.Code">union{</CODE></TD>				<TD WIDTH="37"></TD>				<TD WIDTH="100"></TD>				<TD WIDTH="200"></TD>			</TR>			<TR VALIGN="TOP">				<TD WIDTH="20"></TD>				<TD WIDTH="75">				<DIV ALIGN="right"><CODE CLASS="Cv.Code">UInt8 </CODE>				</DIV></TD>				<TD WIDTH="37"></TD>				<TD WIDTH="100"><CODE CLASS="Cv.Code">byteRegValue;</CODE></TD>				<TD WIDTH="200"><CODE CLASS="Cv.Code">/* &lt;--&gt; Byte register value to */ <BR>				/* read or to be written */</CODE></TD>			</TR>			<TR VALIGN="TOP">				<TD WIDTH="20"></TD>				<TD WIDTH="75">				<DIV ALIGN="right"><CODE CLASS="Cv.Code">UInt16</CODE>				</DIV></TD>				<TD WIDTH="37"></TD>				<TD WIDTH="100"><CODE CLASS="Cv.Code">wordRegValue;</CODE></TD>				<TD WIDTH="200"><CODE CLASS="Cv.Code">/* &lt;--&gt; Word register value to */<BR>				/* read or to be written */<BR>				</CODE></TD>			</TR>			<TR>				<TD WIDTH="20"></TD>				<TD COLSPAN="2"><CODE CLASS="Cv.Code">} registerValue;</CODE></TD>				<TD WIDTH="100"></TD>				<TD WIDTH="200"></TD>			</TR>			<TR VALIGN="TOP">				<TD WIDTH="20"></TD>				<TD WIDTH="75"><CODE CLASS="Cv.Code">UInt16</CODE></TD>				<TD WIDTH="37"></TD>				<TD WIDTH="100"><CODE CLASS="Cv.Code">RegMask;</CODE></TD>				<TD WIDTH="200"><CODE CLASS="Cv.Code">/* --&gt; Mask for registers(s) */<BR>				/* to update */</CODE></TD>			</TR>			<TR>				<TD WIDTH="20"></TD>				<TD WIDTH="75"><CODE CLASS="Cv.Code">devicePB</CODE></TD>				<TD WIDTH="37"></TD>				<TD WIDTH="100"><CODE CLASS="Cv.Code">xi;</CODE></TD>				<TD WIDTH="200"><CODE CLASS="Cv.Code">/* &lt;--&gt; Register images */</CODE></TD>			</TR>			<TR VALIGN="TOP">				<TD WIDTH="20"></TD>				<TD WIDTH="75"><CODE CLASS="Cv.Code">UInt8</CODE></TD>				<TD WIDTH="37"></TD>				<TD WIDTH="100"><CODE CLASS="Cv.Code">altStatDevCntrReg;</CODE></TD>				<TD WIDTH="200"><CODE CLASS="Cv.Code">/* &lt;--&gt; Alternate status(R) or */<BR>				/* Device Control(W) register */<BR>				/* image */<BR>				</CODE></TD>			</TR>			<TR>				<TD WIDTH="20"></TD>				<TD WIDTH="75"><CODE CLASS="Cv.Code">UInt8</CODE></TD>				<TD WIDTH="37"></TD>				<TD WIDTH="100"><CODE CLASS="Cv.Code">Reserved[3];</CODE></TD>				<TD WIDTH="200"><CODE CLASS="Cv.Code">/* Reserved */</CODE></TD>			</TR>			<TR>				<TD WIDTH="20"></TD>				<TD WIDTH="75"><CODE CLASS="Cv.Code">UInt16</CODE></TD>				<TD WIDTH="37"></TD>				<TD WIDTH="100"><CODE CLASS="Cv.Code">Reserved[16];</CODE></TD>				<TD WIDTH="200"><CODE CLASS="Cv.Code">/* Reserved */</CODE></TD>			</TR>			<TR>				<TD COLSPAN="4"><CODE CLASS="Cv.Code">} ataRegAccess;</CODE> </TD>				<TD WIDTH="200"></TD>			</TR>		</TABLE>		</P>		<P><CODE CLASS="Cv.Code"><BR></CODE></P>		<DL COMPACT>						<h4>Field descriptions</h4>			<DT CLASS="DT.DefinitionTerm">			<DIV><A NAME="pgfId=14347"></A><TT CLASS="cv">ataPBHdr</TT> 				<DD CLASS="DD.DefinitionDef"><A NAME="pgfId=976"></A>See the definition of the <TT CLASS="cv"><A HREF="ATA.26.html" CLASS="XRef">ataPBHdr</TT> parameter block</A>. 				<DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=14356"></A><TT CLASS="cv">RegSelect</TT> 				<DD CLASS="DD.DefinitionDef"><A NAME="pgfId=977"></A>This field specifies which one of the device registers to access.				The selectors for the registers supported by the <TT CLASS="cv">ATA_RegAccess</TT> function are listed in <A HREF="#26268" CLASS="XRef">Table&nbsp;3-3</A> . If <TT CLASS="cv">RegSelect</TT> is &quot;FFFF&quot;, then <TT CLASS="cv">regMask</TT> describes which register(s) are to be accessed as part of a multiregister				access. 				<DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=14365"></A><TT CLASS="cv">RegValue</TT> 				<DD CLASS="DD.DefinitionDef"><A NAME="pgfId=981"></A>This field is either the source or destination of values for individual				register accesses. For byte accesses, the upper half of the word				is used. Word accesses (such as the data register) use the entire				word. This field is the source or destination for the data register				component of multiregister accesses. 				<DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=14374"></A><TT CLASS="cv">regMask</TT> 				<DD CLASS="DD.DefinitionDef"><A NAME="pgfId=982"></A>This field is valid only if the <TT CLASS="cv">RegSelect</TT> field contains 0xFFFF. It indicates what combination of the taskfile				registers should be accessed. A bit set to one indicates either				a read or a write to the register. A bit set to zero performs				no operation to the register. The mask bits corresponding to				the selected registers are listed in <A HREF="#38355" CLASS="XRef">Table&nbsp;3-4</A>. Bit 0 is the least significant bit of the field. 				<DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=14386"></A><tt>xi</tt> 				<DD CLASS="DD.DefinitionDef"><A NAME="pgfId=986"></A>This field contains register images for Error/Features, Sector				Count, Sector Number, Cylinder Low, Cylinder High, SDH, and Status/Command.				Only those register images specified in the <TT CLASS="cv">regMask</TT> field are valid. Refer to the description of the devicePB structure				for the <TT CLASS="cv"><A HREF="ATA.2b.html#22098" CLASS="XRef">RegBlock</TT></A> field. 				<DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=14395"></A><TT CLASS="cv">altStatDevCntrReg</TT>				<DD CLASS="DD.DefinitionDef"><A NAME="pgfId=987"></A>For multiregister writes, this field is the source for device				control writes and the destination for alternate status reads.				This field is valid if the Alternate Status/Device Control Register				bit in the regMask field is set to 1.			</DL>			<P CLASS="Tb.Table"><A NAME="pgfId=994"></A><B>Table&nbsp;3-3</B><A NAME="26268"></A>&nbsp;&nbsp;ATA register selectors for regSelect field</P>			<P CLASS="TbH.TblHd"><TABLE BORDER="1" CELLPADDING="3">				<TR>					<TH><A NAME="pgfId=1000"></A>Selector name</TH>					<TH><A NAME="pgfId=1002"></A>Selector</TH>					<TH><A NAME="pgfId=1004"></A>Register description </TH>				</TR>				<TR>					<TD VALIGN="TOP"><CODE CLASS="TbCv.TblCode"><A NAME="pgfId=1006"></A><TT CLASS="cv">DataReg</TT> </CODE></TD>					<TD VALIGN="TOP"><A NAME="pgfId=1008"></A>0</TD>					<TD VALIGN="TOP"><A NAME="pgfId=1010"></A>Data register (16-bit access only) </TD>				</TR>				<TR>					<TD VALIGN="TOP"><CODE CLASS="TbCv.TblCode"><A NAME="pgfId=1012"></A><TT CLASS="cv">ErrorReg</TT> </CODE></TD>					<TD VALIGN="TOP"><A NAME="pgfId=1014"></A>1</TD>					<TD VALIGN="TOP"><A NAME="pgfId=1016"></A>Error register (R) or features register (W) </TD>				</TR>				<TR>					<TD VALIGN="TOP"><CODE CLASS="TbCv.TblCode"><A NAME="pgfId=1018"></A><TT CLASS="cv">SecCntReg</TT> </CODE></TD>					<TD VALIGN="TOP"><A NAME="pgfId=1020"></A>2</TD>					<TD VALIGN="TOP"><A NAME="pgfId=1022"></A>Sector count register </TD>				</TR>				<TR>					<TD VALIGN="TOP"><CODE CLASS="TbCv.TblCode"><A NAME="pgfId=1024"></A><TT CLASS="cv">SecNumReg</TT> </CODE></TD>					<TD VALIGN="TOP"><A NAME="pgfId=1026"></A>3</TD>					<TD VALIGN="TOP"><A NAME="pgfId=1028"></A>Sector number register </TD>				</TR>				<TR>					<TD VALIGN="TOP"><CODE CLASS="TbCv.TblCode"><A NAME="pgfId=1030"></A><TT CLASS="cv">CylLoReg</TT> </CODE></TD>					<TD VALIGN="TOP"><A NAME="pgfId=1032"></A>4</TD>					<TD VALIGN="TOP"><A NAME="pgfId=1034"></A>Cylinder low register </TD>				</TR>				<TR>					<TD VALIGN="TOP"><CODE CLASS="TbCv.TblCode"><A NAME="pgfId=1036"></A><TT CLASS="cv">CylHiReg</TT> </CODE></TD>					<TD VALIGN="TOP"><A NAME="pgfId=1038"></A>5</TD>					<TD VALIGN="TOP"><A NAME="pgfId=1040"></A>Cylinder high register </TD>				</TR>				<TR>					<TD VALIGN="TOP"><CODE CLASS="TbCv.TblCode"><A NAME="pgfId=1042"></A><TT CLASS="cv">SDHReg</TT> </CODE></TD>					<TD VALIGN="TOP"><A NAME="pgfId=1044"></A>6</TD>					<TD VALIGN="TOP"><A NAME="pgfId=1046"></A>SDH register </TD>				</TR>				<TR>					<TD VALIGN="TOP"><CODE CLASS="TbCv.TblCode"><A NAME="pgfId=1048"></A><TT CLASS="cv">StatusReg<BR>					CmdReg</TT> </CODE></TD>					<TD VALIGN="TOP"><A NAME="pgfId=1050"></A>7</TD>					<TD VALIGN="TOP"><A NAME="pgfId=1052"></A>Status register (R) or command register (W) </TD>				</TR>				<TR>					<TD VALIGN="TOP"><CODE CLASS="TbCv.TblCode"><A NAME="pgfId=1054"></A><TT CLASS="cv">AltStatus<BR>					DevCntr</TT> </CODE></TD>					<TD VALIGN="TOP"><A NAME="pgfId=1056"></A>14 </TD>					<TD VALIGN="TOP"><A NAME="pgfId=1058"></A>Alternate status (R) or device control (W) </TD>				</TR>				<TR>					<TD VALIGN="TOP"><CODE CLASS="TbCv.TblCode"><A NAME="pgfId=2444"></A>&nbsp;</CODE></TD>					<TD VALIGN="TOP"><A NAME="pgfId=2446"></A>0xFFFF </TD>					<TD VALIGN="TOP"><A NAME="pgfId=2448"></A>Multi-register access (ataPBVers 2.0 or greater) </TD>				</TR>			</TABLE>			</P>				<P CLASS="T1.TEXT1"><A NAME="pgfId=14405"></A><BR>				The register mask selectors are defined in Table&nbsp;3-4.</P>				<A NAME="pgfId=1116"></A>					<BR><P CLASS="T1.TEXT1">					<A NAME="pgfId=1065"></A><B>Table&nbsp;3-4</B><A NAME="38355"></A>&nbsp;&nbsp;Register mask selectors</P>					<TABLE BORDER="1" CELLPADDING="3">					<TR>						<TH ALIGN=LEFT><A NAME="pgfId=1069"></A>Mask bit</TH>						<TH ALIGN=LEFT><A NAME="pgfId=1071"></A>Register description</TH>					</TR>					<TR>						<TD VALIGN="TOP"><A NAME="pgfId=1073"></A>0</TD>						<TD VALIGN="TOP"><A NAME="pgfId=1075"></A>Data register </TD>					</TR>					<TR>						<TD VALIGN="TOP"><A NAME="pgfId=1077"></A>1</TD>						<TD VALIGN="TOP"><A NAME="pgfId=1079"></A>Error register </TD>					</TR>					<TR>						<TD VALIGN="TOP"><A NAME="pgfId=1081"></A>2</TD>						<TD VALIGN="TOP"><A NAME="pgfId=1083"></A>Sector count register </TD>					</TR>					<TR>						<TD VALIGN="TOP"><A NAME="pgfId=1085"></A>3</TD>						<TD VALIGN="TOP"><A NAME="pgfId=1087"></A>Sector number register </TD>					</TR>					<TR>						<TD VALIGN="TOP"><A NAME="pgfId=1089"></A>4</TD>						<TD VALIGN="TOP"><A NAME="pgfId=1091"></A>Cylinder low register </TD>					</TR>					<TR>						<TD VALIGN="TOP"><A NAME="pgfId=1093"></A>5</TD>						<TD VALIGN="TOP"><A NAME="pgfId=1095"></A>Cylinder high register </TD>					</TR>					<TR>						<TD VALIGN="TOP"><A NAME="pgfId=1097"></A>6</TD>						<TD VALIGN="TOP"><A NAME="pgfId=1099"></A>ataTFSDH register </TD>					</TR>					<TR>						<TD VALIGN="TOP"><A NAME="pgfId=1101"></A>7</TD>						<TD VALIGN="TOP"><A NAME="pgfId=1103"></A>Status/command register </TD>					</TR>					<TR>						<TD VALIGN="TOP"><A NAME="pgfId=1105"></A>8-13 </TD>						<TD VALIGN="TOP"><A NAME="pgfId=1107"></A>Reserved (set to 0) </TD>					</TR>					<TR>						<TD VALIGN="TOP"><A NAME="pgfId=1109"></A>14 </TD>						<TD VALIGN="TOP"><A NAME="pgfId=1111"></A>Alternate status/device control register </TD>					</TR>					<TR>						<TD VALIGN="TOP"><A NAME="pgfId=1113"></A>15 </TD>						<TD VALIGN="TOP"><A NAME="pgfId=1115"></A>Reserved (set to 0) </TD>					</TR>				</TABLE>									<H5 CLASS="RSb.RoutineSbhd">			<DIV><A NAME="pgfId=1117"></A>RESULT CODES</H5>				<P CLASS="T0.Text0"><A NAME="pgfId=1121"></A>See <A HREF="ATA.3a.html#37212" CLASS="XRef">Table&nbsp;A-1</A> for possible result codes returned by the ATA Manager.</P>				<P>			</DIV>			<HR>			&copy; 1999 Apple Computer, Inc. </P>			<P><A HREF="ATA.2a.html"><img src="images/up.gif" border="0"></A> <A HREF="ATA.30.html"><img src="images/previous.gif" border="0"></A> <A HREF="ATA.32.html"><img src="images/next.gif" border="0"></A>  <!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!-- document.write(frameLink);//--></script></a><!-- end Show/Hide frames --></P><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer -->		</BODY>	</HTML>