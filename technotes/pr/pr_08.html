<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note PR08: PrGeneral Bug</title>                                      <meta name="categories" content="Printing"><meta name="week-posted" content="Oct 26, 1987 - Nov 6, 1987"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002629" title="PrGeneral Bug"></a><a name="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxPrinting-date.html">Printing</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/Printing/index.html" target="_blank">Reference Library > Printing</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note PR08</div>
<div id="pageheadsub">PrGeneral Bug</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext"><A HREF="#Section1">Introduction</A><BR><BR><A HREF="#References">References</A><BR><BR> <A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><p id="introtext">This technical note documents a bug in the implementation of the <code>PrGeneral</code>procedure in the LaserWriter driver version 4.0. The bug has to do with theformat of the information returned by the <code>GetRslData</code> opcode. This technicalnote will also describe a workaround for the problem.</p> <!-- end_intro_text --><!-- begin_date --><h3 align=center>[Nov 01 1987]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><a name=Section1></A><h2>Introduction</h2><P>One of the opcodes supported by the <code>PrGeneral</code> procedure (TechnicalNote #128) is named <code>GetRslData</code>. The <code>GetRslData</code> operationinitializes a resolution record that is of the following form:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    TRslRg = RECORD {used in TGetRslBlk}        iMin:    Integer;    {0 if printer only supports discrete resolutions}        iMax:    Integer;    {0 if printer only supports discrete                                     resolutions}    END;    TRslRec = RECORD    {used in TGetRslBlk}        iXRsl:    Integer;    {a discrete, physical X resolution}        iYRsl:    Integer;    {a discrete, physical Y resolution}    END;    TGetRslBlk = RECORD {data block for GetRslData call}        iOpCode:    Integer;    {input; = getRslDataOp}        iError:     Integer;    {output}        lReserved:    LongInt;    {reserved for future use}        iRgType:    Integer;    {output; this declaration is for RgType1}        XRslRg:     TRslRg;     {output; range of X resolutions}        YRslRg:     TRslRg;     {output; range of Y resolutions}        iRslRecCnt: Integer;    {output; how many RslRecs follow}        rgRslRec:    ARRAY[1..27]                OF TRslRec; {output; number used depends on printer type}</pre>	</TD></TR></TABLE></CENTER><p>The LaserWriter 4.0 implementation has a bug that affects the <code>YRslRg</code>and <code>XRslRg</code> fields of the <code>TGetRslBlk</code> record. The correctvalues for the fields are:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>        TGetRslBlk.XRslRg.iMin := 25;        TGetRslBlk.XRslRg.iMax := 1500;        TGetRslBlk.YRslRg.iMin := 25;</pre>	</TD></TR></TABLE></CENTER><p>Unfortunately, the information returned by the LaserWriter 4.0 version of<code>PrGeneral</code> is:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>        TGetRslBlk.XRslRg.iMin := 25;        TGetRslBlk.XRslRg.iMax := 25;&nbsp;        TGetRslBlk.YRslRg.iMin := 1500;</pre>	</TD></TR></TABLE></CENTER><p>The recommended workaround for this problem is to use the <code>PrDrvrVers</code>function (<i>Inside Macintosh</i> II-163) to find out which version of theprint driver you are using. If you are using 4.0, modify the resolution databefore using it. The following code fragment illustrates this workaround:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    PROCEDURE CheckRslRecord(VAR theRslRecord: TGetRslBlk);    CONST        BogusDriver = 40;    BEGIN        IF PrDrvrVers = BogusDriver THEN BEGIN            theRslRecord.XRslRg.iMax := theRslRecord.YRslRg.iMax;            theRslRecord.YRslRg.iMin := theRslRecord.XRslRg.iMin;        END;</pre>	</TD></TR></TABLE></CENTER><p>When the bug is fixed in a future version of the driver, the<code>CheckRslRecord</code> procedure will no longer have any effect on theresolution record. This will make sure your application gets the correctresolution data no matter which version of the driver is being used.</p><P><A HREF="#top">Back to top</A></P><a name="References"></a><h2>References</h2><p>The Print Manager</p><p>Technical Note M.IM.PrGeneral-- <A HREF = "pr_07.html">PrGeneral</a></p>         <P><A HREF="#top">Back to top</A></P>         <a name=Downloads></A>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (44K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/pr_08.pdf">Download</A></P>               </TD>            </TR>                    </TABLE>         <BR></TD></TR></table></center><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/pr/pr_08.html%3Fid%3DDTS10002629-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/pr/pr_08.html%3Fid%3DDTS10002629-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/pr/pr_08.html%3Fid%3DDTS10002629-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>