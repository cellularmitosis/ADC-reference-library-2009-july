<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>WritePartialResource (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING92></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-91.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-93.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-9.html"><B>Chapter 1 - Resource Manager</B></A> / <A HREF="MoreToolbox-24.html"><B>Resource Manager Reference</B></A><BR><DL><DD><A HREF="MoreToolbox-30.html"><B>Resource Manager Routines</B></A> / <A HREF="MoreToolbox-90.html"><B>Reading and Writing Partial Resources</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING92-0></A>
<H3>WritePartialResource</H3>
 <A NAME=MARKER-11-442></A><A NAME=MARKER-2-443></A>You can use the <CODE>WritePartialResource</CODE> procedure to write part of a resource to disk when working with a small subsection of a large resource.<P>
<PRE>
PROCEDURE WritePartialResource (theResource: Handle; 
                                offset: LongInt; buffer: UNIV Ptr;
                                count: LongInt);
</PRE>
<DL>
<DT><CODE>theResource</CODE>
<DD> A handle to a resource.
<DT><CODE>offset</CODE>
<DD> The beginning of the resource subsection to write, measured in bytes <BR>from the beginning of the resource.
<DT><CODE>buffer</CODE>
<DD> A pointer to the buffer containing the data to write.
<DT><CODE>count</CODE>
<DD> The length of the resource subsection to write.
</DL>
<A NAME=HEADING92-7></A>
<H5>DESCRIPTION</H5>
 The <CODE>WritePartialResource</CODE> procedure writes the data specified by the <CODE>buffer</CODE> parameter to the resource subsection identified by the <CODE>theResource</CODE>, <CODE>offset</CODE>, and <CODE>count</CODE> parameters. Your application is responsible for the buffer's memory management.<P>
 If the disk or the file is locked, the <CODE>ResError</CODE> function returns an appropriate File Manager result code. If you try to write past the end of a resource, the Resource Manager attempts to enlarge the resource. The <CODE>ResError</CODE> function returns the result code <CODE>writingPastEnd</CODE> if the attempt succeeds. If the Resource Manager cannot enlarge the resource, <CODE>ResError</CODE> returns an appropriate File Manager result code. If you pass an invalid value in the <CODE>offset</CODE> parameter, <CODE>ResError</CODE> returns the result code <CODE>inputOutOfBounds</CODE>.<A NAME=MARKER-3-444></A><P>
 The <CODE>WritePartialResource</CODE> procedure tries to write the data from the buffer to disk. If the attempt is successful and the resource data (referenced through the resource's handle) is in memory, <CODE>ResError</CODE> returns the result code <CODE>resourceInMemory</CODE>. In this situation, be aware that the data of the resource subsection on disk matches the data from the buffer, not the resource data referenced through the resource's handle. If the attempt to write the data from the buffer to the disk fails, <CODE>ResError</CODE> returns an appropriate error.<P>
 When using partial resource routines, you should call the <CODE>SetResLoad</CODE> procedure, specifying <CODE>FALSE</CODE> for the <CODE>load</CODE> parameter, before you call <CODE>GetResource</CODE>. Doing so prevents the Resource Manager from reading the entire resource into memory. Be sure to restore the normal state by calling <CODE>SetResLoad</CODE> again, with the <CODE>load</CODE> parameter set to <CODE>TRUE</CODE>, immediately after you call <CODE>GetResource</CODE>.<P>
 If you read a partial resource into memory and then change its size, you must use <CODE>SetResourceSize</CODE> to change the entire resource's size on disk as necessary before you write the partial resource.<P>
<A NAME=HEADING92-13></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 The <CODE>WritePartialResource</CODE> procedure may move or purge memory blocks in the application heap. Your application should not call this procedure at interrupt time.<P>
<A NAME=HEADING92-15></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The trap macro and routine selector for <CODE>WritePartialResource</CODE> are
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Trap macro<TH>Selector<TR>
<TD>_ResourceDispatch<TD>$7002</TABLE>
<P>
<A NAME=HEADING92-17></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>dskFulErr<TD>-34<TD>Disk full<TR>
<TD>resourceInMemory<TD>-188<TD>Resource already in memory<TR>
<TD>writingPastEnd<TD>-189<TD>Writing past end of file<TR>
<TD>inputOutOfBounds<TD>-190<TD>Offset or count out of bounds</TABLE>
</H5>
<A NAME=HEADING92-18></A>
<H5>SEE ALSO</H5>
 To check for errors, call the <CODE>ResError</CODE> function as described on <A HREF=MoreToolbox-35.html#MARKER-9-220>page 1-47</A>.<P>
 For descriptions of the <CODE>GetResource</CODE> and <CODE>SetResLoad</CODE> routines, see <A HREF=MoreToolbox-50.html#MARKER-9-287>page 1-68</A> and <A HREF=MoreToolbox-55.html#MARKER-9-305>page 1-74</A>, respectively. The <CODE>SetResourceSize</CODE> procedure is described next. <A NAME=MARKER-2-445></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-91.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-93.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
