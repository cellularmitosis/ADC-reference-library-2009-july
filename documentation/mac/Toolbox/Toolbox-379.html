<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Creating Alert Sounds and Alert Boxes(IM:Tb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING379></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Toolbox-378.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-380.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Toolbox-2.html"><B>Macintosh Toolbox Essentials</B></A> / <BR><DD><A HREF="Toolbox-370.html"><B>Chapter 6 - Dialog Manager</B></A> / <A HREF="Toolbox-378.html"><B>Using the Dialog Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING379-0></A>
<H2><A NAME=MARKER-9-89></A>Creating Alert Sounds and Alert Boxes</H2>
 <A NAME=MARKER-2-90></A><A NAME=MARKER-2-91></A>To create an alert, use one of these functions: <CODE>NoteAlert</CODE>, <CODE>CautionAlert</CODE>, <CODE>StopAlert</CODE>, and <CODE>Alert</CODE>. Icons associated with the first three functions appear in the upper-left corner of the alert boxes, as previously shown in <A HREF=Toolbox-372.html#MARKER-9-51>Figure 6-3</A>, <A HREF=Toolbox-372.html#MARKER-9-53>Figure 6-4</A>, and <A HREF=Toolbox-372.html#MARKER-9-55>Figure 6-5</A>. The <CODE>Alert</CODE> function allows you to display your own icon or to have no icon at all in the upper-left corner of the alert box.<P>
 These functions take descriptive information about the alert from an alert resource that you provide. An alert resource has the resource type <CODE>'ALRT'</CODE>. When you call one of these functions, you pass it the resource ID of the alert resource and a pointer to an event filter function. These functions create and display an alert box. When the user clicks a button in an alert box, these functions return the button's item number and close the alert box, at which time you respond appropriately to the user's click, as described in <A HREF=Toolbox-385.html#MARKER-9-323>"Responding to Events in Alert Boxes" beginning on page 6-81</A>.<P>
 Here's an example of how to create the caution alert shown in <A HREF=#MARKER-9-92>Figure 6-10</A>.<P>
<PRE>
VAR
   myAlertItem:      Integer;
myAlertItem := CautionAlert(kSaveAlertID, @MyEventFilter);
</PRE>
<B>Figure 6-10  <A NAME=MARKER-9-92></A>An alert box to save changes to a document</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/DM-S-11.jpg"><P>
 You should specify a pointer to an event filter function when you call the <CODE>Alert</CODE>, <CODE>StopAlert</CODE>, <CODE>CautionAlert</CODE>, and <CODE>NoteAlert</CODE> functions. You should provide an event filter function as a secondary event-handling loop for events that <CODE>ModalDialog</CODE> doesn't handle. In this example, a pointer to <CODE>MyEventFilter</CODE> is specified for the event filter function. You can use the standard event filter function by passing <CODE>NIL</CODE> in this parameter. The standard event filter function allows users to press the Return or Enter key in lieu of clicking the default button. As described in <A HREF=Toolbox-385.html#MARKER-9-340>"Writing an Event Filter Function for Alert and Modal Dialog Boxes" beginning on page 6-86</A>, your application should provide a simple event filter function that also allows background applications to receive update events. You can use the same event filter function in most or all of your alert boxes and modal dialog boxes. <P>
 <A NAME=MARKER-2-93></A>Continuing with the previous example, an application-defined constant (<CODE>kSaveAlertID</CODE>) specifies the resource ID of an alert resource in a parameter to <BR>the <CODE>CautionAlert</CODE> function. <A HREF=#MARKER-9-94>Listing 6-1</A> shows how this alert resource appears <BR>in Rez input format. (Rez is the resource compiler provided with Apple's Macintosh Programmer's Workshop [MPW], available from APDA.)<P>
<B>Listing 6-1  <A NAME=MARKER-9-94></A>Rez input for an alert resource</B><P>
<PRE>
resource 'ALRT' (kSaveAlertID, purgeable) {  /*alert resource*/
   {94, 80, 183, 438},        /*rectangle for alert box*/
   kSaveAlertDITL,            /*use the 'DITL' with res ID 200*/
   {                          /*alert stages, starting with #4; at each */
                              /* stage, make OK the default, display the */
                              /* alert box, &amp; play the system alert sound*/
   OK, visible, sound1,       /*4th consecutive error*/
   OK, visible, sound1,       /*3rd consecutive error*/
   OK, visible, sound1,       /*2nd consecutive error*/
   OK, visible, sound1,       /*1st error*/
   },
   alertPositionParentWindow  /*place over document window*/
};
</PRE>
 An alert resource contains the following information:<P>
<UL>
<LI>a rectangle, given in global coordinates, that determines the alert box's dimensions and, optionally, its position; these coordinates specify the upper-left and lower-right corners of the alert box
<LI>the resource ID of the item list for the alert box<A NAME=MARKER-2-95></A>
<LI>the actions to be taken at each of four alert stages <A NAME=MARKER-2-227></A>
<LI>as an option, a constant (either <CODE>alertPositionParentWindow</CODE>, <CODE>alertPositionMainScreen</CODE>, or <CODE>alertPositionParentWindowScreen</CODE>) <BR>that tells the Dialog Manager where to position the alert box (available only to applications running in System 7)<P>
</UL>
 In <A HREF=#MARKER-9-94>Listing 6-1</A>, the coordinates (94,80,183,438) specify the dimensions of the alert box, and the <CODE>alertPositionParentWindow</CODE> constant causes the Dialog Manager to place the alert box just below the title bar of the user's document window. If you don't supply a positioning constant, the Dialog Manager places the alert box at the global coordinates you specify for the alert box's rectangle. The positioning constants for alert boxes are explained in <A HREF=Toolbox-384.html#MARKER-9-239>"Positioning Alert and Dialog Boxes" beginning on page 6-62</A>.<P>
 In <A HREF=#MARKER-9-94>Listing 6-1</A>, the application-defined constant <CODE>kSaveAlertDITL</CODE> represents the resource ID for the item list resource. <A HREF=Toolbox-381.html#MARKER-9-123>"Providing Items for Alert and Dialog Boxes" beginning on page 6-24</A> describes how to create an item list resource. <P>
 Your application can base its response on the number of consecutive times an alert condition recurs. In <A HREF=#MARKER-9-94>Listing 6-1</A>, the alert resource specifies that each consecutive time <BR>the user repeats the action that invokes this caution alert, the Dialog Manager should perform the following: outline the OK button and treat it as the default button, display the alert box (that is, make it "visible"), and play a single system alert sound.<P>
 Your application can define different responses for each of four stages of an alert. This is most appropriate for stop alerts--those that signify that an action cannot be completed--especially when that action has a high probability of being accidental (for example, when the user chooses the Cut command when no text is selected). Under such a circumstance, your application might simply play the system alert sound the first two times the user makes the mistake, and for subsequent mistakes it might also present an alert box. Every consecutive occurrence of the mistake after the fourth alert stage is treated as a fourth-stage alert.<P>
 For example, a user might try to paste a graphic outside the page margins of a simple page-layout program; the first time the user tries this, the application--using the Dialog Manager--may simply play the system alert sound for the user. If the user repeats the mistake, the application may play the system alert sound again. But when the user repeats the error for the third consecutive time, the application may display an alert box like the one shown in <A HREF=#MARKER-9-97>Figure 6-11</A>. If the user makes the same mistake immediately after dismissing this alert box, the alert box reappears, and it continues doing so until the user corrects or abandons the improper action.<P>
<B>Figure 6-11  <A NAME=MARKER-9-97></A>An alert box displayed only during the third and fourth alert stages</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/DM-S-12.jpg"><P>
 <A HREF=#MARKER-9-98>Listing 6-2</A> shows the alert resource used to specify the stop alert displayed in <BR><A HREF=#MARKER-9-97>Figure 6-11</A>. Notice that the fourth alert stage is listed first, and the first alert stage is listed last. At the third alert stage, the application displays an alert box but does not <BR>play the system alert sound. If the user repeats the mistake a fourth consecutive time, <BR>the application plays the system alert sound and displays the alert box as well.<P>
<B>Listing 6-2  <A NAME=MARKER-9-98></A>Specifying different alert responses according to alert stage</B><P>
<PRE>
resource 'ALRT' (kStopAlertID, purgeable) {  /*alert resource*/
   {40, 40, 127, 353},     /*rectangle for alert box*/
   kStopAlertDITL,         /*use the 'DITL' with res ID 300*/
   {                       /*alert stages, starting with #4*/
   OK, visible, sound1,    /*4th err: show alert box, play alert sound*/
   OK, visible, silent,    /*3rd err: show alert box, don't play sound*/
   OK, invisible, sound1,  /*2nd err: play sound, don't show alert box*/
   OK, invisible, sound1,  /*1st err: play sound, don't show alert box*/
   },
   alertPositionParentWindow  /*place over document window*/
};
</PRE>
 The actions for each alert stage are specified by the following three pieces of information:<P>
<UL>
<LI>Which button is the default button--the OK button (that is, the first item in the item list resource) or the Cancel button (that is, the second item in the item list resource). The Dialog Manager automatically draws a bold outline around the default button, and when the user presses the Return or Enter key, the Dialog Manager treats--or your event filter function should treat--that keyboard event as a click in the default button. The OK and Cancel buttons are described in detail in <A HREF=Toolbox-381.html#MARKER-9-123>"Providing Items for Alert and Dialog Boxes" beginning on page 6-24</A>. At each alert stage, you can change the default button, although it's difficult to imagine a scenario where changing the default button would be helpful to the user. In the previous example, the OK button is the default.<A NAME=MARKER-2-446></A>
<LI>Whether the alert box is to be displayed. If you specify the <CODE>visible</CODE> constant for <BR>an alert stage, the alert box is displayed; if you specify the <CODE>invisible</CODE> constant, it is not. In <A HREF=#MARKER-9-98>Listing 6-2</A>, the alert box is not displayed the first two consecutive times the user repeats the mistake, but it is displayed for all subsequent consecutive times.<A NAME=MARKER-2-473></A><A NAME=MARKER-2-447></A>
<LI>Which of four possible sounds (if any) should be emitted at this stage of the alert. In the previous example, the first, second, and fourth alert stages play a single system alert sound, but the third stage plays no sound.<A NAME=MARKER-2-444></A><P>
</UL>
 <A NAME=MARKER-2-457></A><A NAME=MARKER-2-643></A>By default, the Dialog Manager uses the system alert sound. The <CODE>sound1</CODE> constant, used in <A HREF=#MARKER-9-98>Listing 6-2</A>, tells the Dialog Manager to play the system alert sound once; you can also specify the <CODE>sound2</CODE> and <CODE>sound3</CODE> constants, which cause the Dialog Manager to play the system alert sound two and three times, respectively, each time at the same pitch and with the same duration. The volume of the sound depends on the current speaker volume setting, which the user can adjust in the Sound control panel. If the user has set the speaker volume to 0, the menu bar blinks once in place of each sound that the user would otherwise hear.<A NAME=MARKER-2-459></A><P>
 If you want the Dialog Manager to play sounds other than the system alert sound, write your own sound procedure and then call <CODE>ErrorSound</CODE> and pass it a pointer to your sound procedure. The <CODE>ErrorSound</CODE> procedure (described on <A HREF=Toolbox-392.html#MARKER-9-394>page 6-104</A>) makes your sound procedure the current sound procedure. For example, you might create a sound procedure named <CODE>MyAlertSound</CODE>, as shown in <A HREF=#MARKER-9-106>Listing 6-3</A>.<P>
<B>Listing 6-3  <A NAME=MARKER-9-106></A>Creating your own sound procedure for alerts</B><P>
<PRE>
PROCEDURE MyAlertSound (soundNo: Integer);
BEGIN
   CASE soundNo OF
      0: PlayMyWhisperAlert;  {sound for silent constant in alert resources}
      1: PlayMyBellAlert;     {sound for sound1 constant in alert resources}
      2: PlayMyDrumAlert;     {sound for sound2 constant in alert resources}
      3: PlayMyTrumpetAlert;  {sound for sound3 constant in alert resources}
   OTHERWISE   ;
   END;                       {of CASE}
END;
</PRE>
 For each of the four alert stages that can be reported in the <CODE>soundNo</CODE> parameter, your procedure can emit any sound that you define.<A NAME=MARKER-2-107></A> <A NAME=MARKER-2-108></A><A NAME=MARKER-2-458></A><P>
 As previously explained, the dimensions of the rectangle you specify in the alert resource determine the dimensions of the alert box. You can also let the rectangle coordinates serve as global coordinates that position the alert box, or you can let the Dialog Manager automatically locate it for you according to three standard positions. <A HREF=#MARKER-9-98>Listing 6-2 on page 6-20</A>, for example, uses the <CODE>alertPositionParentWindow</CODE> constant to position the alert box over the document window where the user is working. For details about these standard positions, see <A HREF=Toolbox-384.html#MARKER-9-239>"Positioning Alert and Dialog Boxes" beginning on page 6-62</A>.<A NAME=MARKER-2-580></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Toolbox-378.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-380.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Toolbox-3.html">&copy; Apple Computer, Inc.</A><br>11 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
