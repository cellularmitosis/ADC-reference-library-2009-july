<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>AddResource (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING64></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-63.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-65.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-9.html"><B>Chapter 1 - Resource Manager</B></A> / <A HREF="MoreToolbox-24.html"><B>Resource Manager Reference</B></A><BR><DL><DD><A HREF="MoreToolbox-30.html"><B>Resource Manager Routines</B></A> / <A HREF="MoreToolbox-62.html"><B>Modifying Resources</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING64-0></A>
<H3><A NAME=MARKER-9-342></A>AddResource</H3>
 <A NAME=MARKER-11-343></A><A NAME=MARKER-2-344></A>You can use the <CODE>AddResource</CODE> procedure to add a resource to the current resource file.<P>
<PRE>
PROCEDURE AddResource (theData: Handle; theType: ResType; 
                       theID: Integer; name: Str255);
</PRE>
<DL>
<DT><CODE>theData</CODE>
<DD> A handle to data in memory to be added as a resource to the current resource file (not a handle to an existing resource).
<DT><CODE>theType</CODE>
<DD> The resource type of the resource to be added.
<DT><CODE>theID</CODE>
<DD> The resource ID of the resource to be added.
<DT><CODE>name</CODE>
<DD> The name of the resource to be added.
</DL>
<A NAME=HEADING64-7></A>
<H5>DESCRIPTION</H5>
 Given a handle to any type of data in memory (but not a handle to an existing resource), <CODE>AddResource</CODE> adds the given handle, resource type, resource ID, and resource name to the current resource file's resource map in memory. The <CODE>AddResource</CODE> procedure sets the <CODE>resChanged</CODE> attribute to 1; it does not set any of the resource's other attributes--that is, all other attributes are set to 0.<P>
<DL>
<DT><B>WARNING</B>
<DD>The <CODE>AddResource</CODE> procedure doesn't verify whether the resource ID you pass in the parameter <CODE>theID</CODE> is already assigned to another resource of the same type. You should call the <CODE>UniqueID</CODE> or <CODE>Unique1ID</CODE> function to get a unique resource ID before adding a resource with <CODE>AddResource</CODE>.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 If the <CODE>resChanged</CODE> attribute of a resource has been set and your application calls <CODE>UpdateResFile</CODE> or quits, the Resource Manager writes both the resource map and the resource data for that resource to the resource fork of the corresponding file on disk. If the <CODE>resChanged</CODE> attribute for a resource has been set and your application calls <CODE>WriteResource</CODE>, the Resource Manager writes only the resource data for that resource to disk.<P>
 If you add a resource to the current resource file, the Resource Manager writes the <BR>entire resource map to disk when it updates the file. If you want any of your changes to the resource map or resource data to be temporary, you must restore the original information before the Resource Manager updates the file on disk.<P>
 If the value of the parameter <CODE>theData</CODE> is an empty handle (that is, a handle whose master pointer is set to <CODE>NIL</CODE>), the Resource Manager writes zero-length resource data to disk when it updates the resource. If the value of <CODE>theData</CODE> is either <CODE>NIL</CODE> or a handle to an existing resource, <CODE>AddResource</CODE> does nothing, and the <CODE>ResError</CODE> function returns the result code <CODE>addResFailed</CODE>. If the resource map becomes too large to fit in memory, <CODE>AddResource</CODE> does nothing, and <CODE>ResError</CODE> returns an appropriate result code. The same is true if the resource data in memory can't be written to the resource fork (for example, because the disk is full). <P>
 When your application calls <CODE>AddResource</CODE>, the Resource Manager attempts to reserve disk space for the new resource. If the new resource data can't be written to the resource fork (for example, if there's not enough room on disk), the <CODE>resChanged</CODE> attribute is not set to 1. If this is the case and you call <CODE>UpdateResFile</CODE> or <CODE>WriteResource</CODE>, the Resource Manager won't know that resource data has been added. Thus, the routine won't write the new resource data to the resource fork and won't return an error. For this reason, always make sure that the <CODE>ResError</CODE> function returns the result code <CODE>noErr</CODE> after a call to <CODE>AddResource</CODE>. <P>
 To copy an existing resource, get a handle to the resource you want to copy, call the <CODE>DetachResource</CODE> procedure, then call <CODE>AddResource</CODE>. To add the same resource data to several different resource forks, call the Memory Manager function <CODE>HandToHand</CODE> to duplicate the handle for each resource.<P>
<A NAME=HEADING64-15></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>addResFailed<TD>-194<TD><CODE>AddResource</CODE> procedure failed</TABLE>
</H5>
<A NAME=HEADING64-16></A>
<H5>SEE ALSO</H5>
 To check for errors, call the <CODE>ResError</CODE> function as described on <A HREF=MoreToolbox-35.html#MARKER-9-220>page 1-47</A>.<P>
 For examples of the use of the <CODE>AddResource</CODE> procedure, see <A HREF=MoreToolbox-19.html#MARKER-9-143>Listing 1-4 on page 1-18</A> and <A HREF=MoreToolbox-22.html#MARKER-9-180>Listing 1-11 on page 1-32</A>.<P>
 For descriptions of the <CODE>UpdateResFile</CODE> and <CODE>WriteResource</CODE> procedures, see <A HREF=MoreToolbox-66.html#MARKER-9-349>page 1-87</A> and <A HREF=MoreToolbox-67.html#MARKER-9-353>page 1-88</A>, respectively. For descriptions of the <CODE>UniqueID</CODE> and <CODE>Unique1ID</CODE> functions, see <A HREF=MoreToolbox-71.html#MARKER-9-369>page 1-91</A>. For a description of the <CODE>DetachResource</CODE> procedure, see <A HREF=MoreToolbox-86.html#MARKER-9-422>page 1-102</A>.<P>
 For information about using the Memory Manager procedure <CODE>HandToHand</CODE>, see <I><A HREF="../Memory/Memory-2.html">Inside Macintosh: Memory</A></I>. <A NAME=MARKER-2-345></A> <A NAME=MARKER-2-346></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-63.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-65.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
