<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Q&amp;A QTMTB52: Playing memory-resident WAVE data using QuickTime 4</title><meta name="keywords" content="Mac OS 8 QuickTime 4 playing memory-resident WAVE data "><meta name="Description" content="Technical Q&amp;A QTMTB52: Q&amp;A explains how to play memory-residentWAVE data in QuickTime 4."><meta name="categories" content="QuickTime Movie Toolbox"><meta name="week-posted" content="Jul 19, 1999 - Jul 23, 1999"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF" TEXT="#000000"><a name="//apple_ref/doc/uid/DTS10002022" title="Playing memory-resident WAVE data using QuickTime 4"></a> <!-- white background --><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalqas/index.html">Technical Q&As</a> &gt; <a href="../../technicalqas/QuickTime/index.html">QuickTime</a> &gt; <a href="../../technicalqas/QuickTime/idxMusicAudio-date.html">Audio</a> &gt; </p><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Q&amp;A QTMTB52</div>
<div id="pageheadsub">Playing memory-resident WAVE data using QuickTime 4</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER>			<!-- -->						<!-- Document Body --><table cellspacing="0" cellpadding="0" border="0" WIDTH="600"><tr><td align="left" scope="row"><hr width=500 align=center><p id=p2>Q: How do I play memory-resident WAVE data using QuickTime 4?</p><p id=p4>A: QuickTime 4 has a built-in WAV file importer. You can open and play a WAV file quite easily by opening the file as if it were a QuickTime movie file and playing the "movie" (WAV file). For example, here's some QuickTime code which you can use to play any WAV file (simply select your WAV file at the file prompt and QuickTime will play it as a sound-only movie):</p><TABLE BORDER=0 CELLPADDING=1 BGCOLOR="#EEEEE0"> <TR> <td align="left">                     <pre>OSErr PlayWAVfile (){    SFTypeList        myTypeList;    StandardFileReply myReply;    OSErr             err = noErr;    short             movieRefNum, resID = 0;    Movie             movie;        StandardGetFilePreview(NULL, -1, myTypeList, &amp;myReply);        if (!myReply.sfGood)        {            err = userCanceledErr;            return err;        }        else        {            err = OpenMovieFile(&amp;myReply.sfFile, &amp;movieRefNum, fsRdPerm);            if (!err)            {                err = NewMovieFromFile(&amp;movie,                                       movieRefNum,                                       &amp;resID,                                       NULL,                                       newMovieActive,                                       NULL);            }            if (err)            {                if (movie)                {                    DisposeMovie(movie);                }            }            else            {                SetMovieVolume(movie, kFullVolume);                GoToBeginningOfMovie(movie);                StartMovie(movie);                while (!IsMovieDone(movie))                {                    MoviesTask(movie, 0);                    err = GetMoviesError();                }            }        }        return err;}</pre>   </TD> </TR> </TABLE><BR>  <P id=p4>It's a bit more work to play a WAV sound using QuickTime if your WAV data is in memory instead of in a file. In this case, one option is to create a new movie and add the WAV dataas a separate sound track (since the QuickTime WAV importer only works with files). <a href="http://developer.apple.com/documentation/quicktime/qtdevdocs/RM/frameset.htm" target="_blank">Inside Macintosh: QuickTime chapter 2</A> contains sample code which shows how to create a movie from scratch and add a sound track to the movie. Simply add the WAV data to the sound track of your movie as you would normally then play the movie.</p><P id=p4>You can also use the QuickTime WAV movie import component along with the <CODE>MovieImportDataRef</CODE> function to add memory-resident WAV file data to a movie. The <CODE>MovieImportDataRef</CODE> function lets you specify the data reference to use for the import operation (in this case, a handle data reference for the WAV file data). Note that this does not mean you actually pass the handle to your data in the <CODE>dataRef</CODE> parameter; instead, the <CODE>dataRef</CODE> is a handle that starts with the handle to your data (see code below):</P><TABLE BORDER=0 CELLPADDING=1 bgcolor="#EEEEE0"> <TR> <td align="left">                     <pre>void ImportWAVDataFromMemory(Ptr waveDataPtr, long waveDataSize){    Handle                  myHandle, dataRef = nil;    Movie                   movie;    MovieImportComponent    miComponent;    Track                   targetTrack = nil;    TimeValue               addedDuration = 0;    long                    outFlags = 0;    OSErr                   err;    ComponentResult         result;        myHandle = NewHandleClear((Size)waveDataSize);        BlockMove(waveDataPtr,                    *myHandle,                    waveDataSize);        err = PtrToHand(&amp;myHandle,                        &amp;dataRef,                        sizeof(Handle));        miComponent = OpenDefaultComponent(MovieImportType,                                            kQTFileTypeWave);        movie = NewMovie(0);        result = MovieImportDataRef(miComponent,                                    dataRef,                                    HandleDataHandlerSubType,                                    movie,                                    nil,                                    &amp;targetTrack,                                    nil,                                    &amp;addedDuration,                                    movieImportCreateTrack,                                    &amp;outFlags);        SetMovieVolume(movie, kFullVolume);        GoToBeginningOfMovie(movie);        StartMovie(movie);        while (!IsMovieDone(movie))        {            MoviesTask(movie, 0);            err = GetMoviesError();        }}</pre>   </TD> </TR> </TABLE> <BR><!-- begin_date --><H4 ALIGN=center>[Jul 21 1999]</H4><!-- end_date --></td></tr></table></CENTER><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/qa/qtmtb/qtmtb52.html%3Fid%3DDTS10002022-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/qa/qtmtb/qtmtb52.html%3Fid%3DDTS10002022-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/qa/qtmtb/qtmtb52.html%3Fid%3DDTS10002022-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>