<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Overview (MacApp PG)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING92></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MacAppProgGuide-91.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-93.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MacAppProgGuide-2.html"><B>Programmer's Guide to MacApp</B></A> / <A HREF="MacAppProgGuide-78.html"><B>Part 2 - Working With MacApp</B></A><BR><DD><A HREF="MacAppProgGuide-91.html"><B>Chapter 14 - Working With Scripting</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING92-0></A>
<H1>Overview</H1>
 MacApp supports the Apple event object model, which is described in <A HREF=MacAppProgGuide-49.html#MARKER-9-20>"Scripting Terminology," beginning on page 140</A>. MacApp uses a global Apple event dispatcher object to serve as an intermediary between the Apple Event Manager (and its Object Support Library component) and the application objects that can work with Apple events.<P>
 <A HREF=#MARKER-9-21>Figure 14-1</A> shows MacApp's mixin and C++ utility classes for scripting, and <A HREF=#MARKER-9-22>Figure 14-2</A> shows classes, methods, and fields used to support scripting.<P>
 The objects in a MacApp application are organized in a hierarchy that extends from the application object, to its document objects, to the documents' window objects, and to the windows' view objects. This hierarchy is shown in <A HREF=MacAppProgGuide-17.html#MARKER-9-38>Figure 1-1 on page 7</A>. An object in the hierarchy that needs to respond to Apple events mixes in the multiple inheritance class <CODE>MScriptableObject</CODE>. That enables the object to describe itself in terms the Object Support Library (OSL) can understand, to contain Apple event objects (such as shapes, paragraphs, words, and so on), to get and set object properties for the objects it contains, and to have an attached script (which can respond to Apple events sent to the object).<P>
<B>Figure 14-1  <A NAME=MARKER-2-20></A><A NAME=MARKER-9-21></A>Mixin and C++ utility classes for scripting support</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/MacApp_PG-L-085.gif"><P>
 MacApp's global Apple event dispatcher works with the Apple Event Manager, the OSL, and the scriptable objects in the application's object hierarchy to determine which object is the target for an Apple event, and to <P>
<B>Figure 14-2  <A NAME=MARKER-9-22></A>Classes, methods, and fields used to support scripting<A NAME=MARKER-2-23></A></B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/MacApp_PG-L-083.gif"><P>
 hand the event off to that object. If a specified object has an attached script, the script gets first shot at handling the Apple event. If an event doesn't specify a target, it is sent to the default target. MacApp specifies the application object as the default Apple event target.<P>
<A NAME=HEADING92-10></A>
<H2><A NAME=MARKER-2-24></A><A NAME=MARKER-9-25></A>Creating an Object Specifier</H2>
 For an object to receive Apple events, it must be able to create a specifier for itself.<CODE> </CODE>An object that mixes in <CODE>MScriptableObject can call MakeObjectSpecifier</CODE> to create an object specifier. <CODE>MakeObjectSpecifier</CODE> supports the specifier forms of <CODE>formName</CODE>, <CODE>formAbsolutePosition</CODE>, and <CODE>formUniqueID</CODE>. You override <CODE>MakeObjectSpecifier</CODE> only if you need to make object specifiers for other forms.<P>
 Your application makes object specifiers for Apple events when implementing recordable commands (see <A HREF=MacAppProgGuide-93.html#MARKER-9-32>"Recipe--Defining a Recordable Command Class," beginning on page 353</A>). For example, the <CODE>MakeAppleEvent</CODE> method from the <CODE>TZoomInCommand</CODE> has this call:<P>
<PRE>
fIconDocument-&gt;MakeObjectSpecifier(
         directObjectDesc, fIconDocument-&gt;GetSpecifierForm());
</PRE>
 The <CODE>TDocument::</CODE>GetSpecifierForm method returns <CODE>formName</CODE>, so the MakeObjectSpecifier method attempts to create an object specifier for the form name. If MakeObjectSpecifier cannot make a specifier for the preferred form, it will try to use one of the other forms, either <CODE>formName</CODE>, <CODE>formAbsolutePosition</CODE>, or <CODE>formUniqueID</CODE>.<P>
<DL>
<DT><B>Note</B>
<DD>The <CODE>TApplication</CODE> class overrides MakeObjectSpecifier to return a <CODE>NULL</CODE> specifier that identifies the application as the <B><A NAME=MARKER-2-26></A>ultimate container</B>--the first object queried by the OSL when resolving an object specifier.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MacAppProgGuide-91.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-93.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MacAppProgGuide-3.html">&copy; Apple Computer, Inc.</A><br>25 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
