<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>TEUseStyleScrap(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING114></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-113.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-115.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-40.html"><B>Chapter 2 - TextEdit</B></A> / <A HREF="Text-56.html"><B>TextEdit Reference</B></A><BR><DL><DD><A HREF="Text-67.html"><B>Routines</B></A> / <A HREF="Text-108.html"><B>Checking, Setting, and Replacing Styles</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING114-0></A>
<H3>TEUseStyleScrap</H3>
 The <A NAME=MARKER-9-296></A><CODE>TEUseStyleScrap</CODE> procedure assigns new character attributes to the specified range of text in the designated edit record.<P>
<PRE>
PROCEDURE TEUseStyleScrap (rangeStart: LongInt; rangeEnd: LongInt;
                        newStyles: STScrpHandle; redraw: Boolean; 
                        hTE: TEHandle);
</PRE>
<DL>
<DT><CODE>rangeStart</CODE>
<DD> The offset of the first character in the text of the edit record to which the character attributes are to be applied.
<DT><CODE>rangeEnd</CODE>
<DD> The offset of the last character in the text of the edit record to which the character attributes are to be applied.
<DT><CODE>newStyles</CODE>
<DD> A handle to a style scrap record. The style scrap record contains the attributes to be applied to the specified range of text. If the value of <CODE>newStyles</CODE> is <CODE>NIL</CODE>, no action is performed.
<DT><CODE>redraw</CODE>
<DD> A flag that specifies whether TextEdit should immediately redraw the selection range using the new character attributes.
<DT><CODE>hTE</CODE>
<DD> A handle to the edit record containing the range of text to which the character attributes are to be applied. If the handle points to a monostyled edit record (created using <CODE>TENew</CODE>), no action is performed.
</DL>
<A NAME=HEADING114-8></A>
<H5>DESCRIPTION</H5>
 The <CODE>TEUseStyleScrap</CODE> procedure writes the character attribute information into the style record's style table and updates the style run table. If the <CODE>redraw</CODE> parameter is set to <CODE>TRUE</CODE>, the attributes are applied immediately to the specified range of text, and line breaks, line heights, and line ascents are recalculated. If <CODE>redraw</CODE> is set to <CODE>FALSE</CODE>, the new character attributes are not reflected in the view rectangle until the next update event occurs.<P>
 Regardless of whether the text is redrawn, the current selection range is not changed; if characters are highlighted before <CODE>TEUseStyleScrap</CODE> is called, they remain highlighted after it is called. However, if characters within the current selection range also fall within the specified range of text, they are rendered in the new character attributes when the text is redrawn.<P>
 Each element in the style scrap record contains a field that is the offset of the beginning of the element's character attributes. This field (<CODE>scrpStartChar</CODE>) defines the boundaries for the scrap's style runs.<P>
 The <CODE>TEUseStyleScrap</CODE> procedure applies the first element's attributes to the characters from <CODE>rangeStart</CODE> up to the <CODE>scrpStartChar</CODE> field of the next element. The <CODE>TEUseStyleScrap</CODE> procedure terminates without error if it prematurely reaches the end of the range or if there are not enough scrap style elements to cover the whole range. In the latter case, <CODE>TEUseStyleScrap</CODE> applies the last set of character attributes in the style scrap record to the remainder of the range.<P>
 Depending on the requirements of your application, you can create a style scrap record directly and pass its handle to <CODE>TEUseStyleScrap</CODE> as the value of <CODE>newStyles</CODE> or you can use a style scrap record created by <CODE>TEGetStyleScrapHandle</CODE>.<A NAME=MARKER-2-309></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-113.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-115.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
