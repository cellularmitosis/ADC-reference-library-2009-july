<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Kernel Extension Programming Topics: Packaging Your KEXT for Distribution and Installation</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Packaging Your KEXT for Distribution and Installation"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20002368" title="Packaging Your KEXT for Distribution and Installation"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000422" target="_top">Darwin</a> &gt; <a href="../../../Kernel-date.html#//apple_ref/doc/uid/TP30000440-TP30000422-TP30000532" target="_top">Kernel</a> &gt; <a href="../index.html" target="_top">Kernel Extension Programming Topics</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../KEXTConceptDebugger/hello_debugger.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../KEXTConceptLoading/loading_kexts.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/20002368-CHDCBCJA" title="Packaging Your KEXT for Distribution and Installation"></a><hr /><H1>Packaging Your KEXT for Distribution and Installation</H1>

<p>This tutorial describes how to package a kernel extension (KEXT) for distribution and installation on Mac OS X. The KEXT can be any type: a device driver, file system stack, or Network Kernel Extension (NKE). The tutorial assumes that you are working in a Mac OS X development environment.</p><div class="importantbox"><a name="//apple_ref/doc/uid/20002368-DontLinkElementID_36" title="Important:"></a><p><strong>Important:</strong>&nbsp;The information in this document reflects versions of PackageMaker available in Mac OS X v10.3 and above.</p><p></p></div>

<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="packaging_kext.html#//apple_ref/doc/uid/20002368-101074">Why Should You Create a Package?</a>
				
			<br/>
			
        
			
			
				<a href="packaging_kext.html#//apple_ref/doc/uid/20002368-97383-CHDCACGI">Anatomy of a Package</a>
				
			<br/>
			
        
			
			
				<a href="packaging_kext.html#//apple_ref/doc/uid/20002368-97575">Preparation</a>
				
			<br/>
			
        
			
			
				<a href="packaging_kext.html#//apple_ref/doc/uid/20002368-97742">Roadmap</a>
				
			<br/>
			
        
			
			
				<a href="packaging_kext.html#//apple_ref/doc/uid/20002368-97862-CHDDJEAE">Locate Your KEXT</a>
				
			<br/>
			
        
			
			
				<a href="packaging_kext.html#//apple_ref/doc/uid/20002368-98104-CHDDHCHD">Create a Distribution Directory</a>
				
			<br/>
			
        
			
			
				<a href="packaging_kext.html#//apple_ref/doc/uid/20002368-98736-CHDEGEDE">Gather Any Package Resources</a>
				
			<br/>
			
        
			
			
				<a href="packaging_kext.html#//apple_ref/doc/uid/20002368-98950">Create a Read Me File</a>
				
			<br/>
			
        
			
			
				<a href="packaging_kext.html#//apple_ref/doc/uid/20002368-99097">Create a Software License File</a>
				
			<br/>
			
        
			
			
				<a href="packaging_kext.html#//apple_ref/doc/uid/20002368-99229">Create a Welcome File</a>
				
			<br/>
			
        
			
			
				<a href="packaging_kext.html#//apple_ref/doc/uid/20002368-99356-CHDIAABA">Create a Package with PackageMaker</a>
				
			<br/>
			
        
			
			
				<a href="packaging_kext.html#//apple_ref/doc/uid/20002368-100070-CHDCEAGB">Examine the Package and Files</a>
				
			<br/>
			
        
			
			
				<a href="packaging_kext.html#//apple_ref/doc/uid/20002368-100371-CHDEIADI">Test Installing the Package</a>
				
			<br/>
			
        
			
			
				<a href="packaging_kext.html#//apple_ref/doc/uid/20002368-100614">Where to Go Next</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/20002368-101074" title="Why Should You Create a Package?"></a><h2>Why Should You Create a Package?</h2>
<p>As built, a kernel extension is not well-suited for distribution and installation. For example, some of the files in the bundle could be lost during distribution over the Web. The hierarchical tree format of a bundle leaves its contents open to accidental damage by mishandling. For example, if a KEXT were transferred to a DOS (“8.3”) file system, filenames within the bundle directory could be truncated.</p>
<p>In addition, a KEXT does not normally contain the sort of useful information users expect when they install software, such as licensing restrictions, descriptive information, or default installation location. Before you distribute a KEXT for installation under Mac OS X, you should prepare it by creating a <em>package</em>.</p>
<a name="//apple_ref/doc/uid/20002368-97383" title="Anatomy of a Package"></a><a name="//apple_ref/doc/uid/20002368-97383-CHDCACGI" title="Anatomy of a Package"></a><h2>Anatomy of a Package</h2>
<p>The Mac OS X package format was created to be used with the Installer application. Installer takes care of providing users with many useful features such as descriptive information and default installation location.</p>
<p>Like KEXTs, packages are also implemented as bundles, folders that the Finder treats as single files. Although a package appears as a single entity from a Desktop Finder window, you can Control-click the package icon and choose Show Package Contents to view the files in the package. You can also use the Terminal application to enter a package directory and view the component files. The files that make up a package are named with suffixes that indicate the type of information stored in the file.</p>
<p>A package provides everything the Mac OS X Installer needs to install your software. A basic package contains:</p>
<ul class="ul"><li class="li"><p>A Bill of Materials file—this is a file in binary (non-text) format that describes the contents of the archive file. PackageMaker names this file <code>Archive.bom</code>.</p></li>
<li class="li"><p>An <code>Info.plist</code> file—this is a plist-formatted file that contains the information you entered in the PackageMaker application when you created the package project.</p></li>
<li class="li"><p>An archive file—this is an archive of the complete set of files that will be installed. PackageMaker names this file <code>Archive.pax</code>[<code>.gz</code>]. If you choose to compress the files, the file name will include the <code>.gz</code> suffix. For this tutorial, the contents of your KEXT will comprise the <code>Archive.pax</code>[<code>.gz</code>] file.</p></li>
<li class="li"><p>A package-description file—this is a plist-formatted file that contains localizable information such as the package title. PackageMaker names this file <code>Description.plist</code>.</p></li>
<li class="li"><p>Resources (optional)—packages may contain additional (optional) supplementary resources, such as Read Me files, licensing information, pre- or postinstall scripts, and installation or volume check tools. These are package resources, used (or run) at installation time; they are not part of the KEXT's installation but are saved to disk as part of the package's receipt (located in <code>/Library/Receipts</code>). Resources can include any number of localized language projects (<code>.lproj</code> folders) that can contain localized versions of the Read Me, welcome, and license files, as well as a localized background image.</p></li></ul>
<p>Because packages are implemented as bundles, their contents are also subject to possible modification during handling. To prepare a package for distribution, you should archive and (possibly) compress it into a form that can be distributed safely without changing the contents.</p>
<a name="//apple_ref/doc/uid/20002368-97575" title="Preparation"></a><h2>Preparation</h2>
<p>Before you begin this tutorial, make sure you have met the following requirements.</p>
<ol class="ol"><li class="li"><p>Be sure you understand how to create a KEXT and what makes up a KEXT.</p><p>You should have completed and understood the material presented in a previous tutorial, <span class="content_text"><a href="../KEXTConceptKEXT/hello_kext.html#//apple_ref/doc/uid/20002365-BABJHCJA">“Hello Kernel: Creating a Kernel Extension With Xcode,”</a></span> before beginning this one. That tutorial demonstrates how to create a simple kernel extension project and explains the contents of a KEXT.</p></li>
<li class="li"><p>If your KEXT is a device driver, be sure you understand the differences between a device driver and other KEXTs.</p><p>You should have completed and understood the material presented in <span class="content_text"><a href="../KEXTConceptIOKit/hello_iokit.html#//apple_ref/doc/uid/20002366-CIHECHHE">“Hello I/O Kit: Creating a Device Driver With Xcode.”</a></span> That tutorial demonstrates how to create a simple device driver (I/O Kit KEXT) project and explains the differences between device drivers and other kernel extensions.</p></li>
<li class="li"><p>Build a KEXT.</p><p>Before you begin this tutorial, you will need to build a KEXT that you can package and install. It doesn’t matter whether you plan to package a device driver or another type of KEXT. </p></li>
<li class="li"><p>This tutorial assumes you are logging in to Mac OS X as the user <code>admin</code> and that this user has administrative privileges on your computer. This tutorial also assumes that your KEXT project was named <code>Hello</code>. In the examples below, the project files can be found at the location<code> /Users/admin/Projects/Hello/build</code>. The name of the KEXT is <code>Hello.kext</code>. If you are using another account, project name, or project location, substitute the correct information in the examples below.</p></li></ol>
<a name="//apple_ref/doc/uid/20002368-97742" title="Roadmap"></a><h2>Roadmap</h2>
<p>Here’s how you’ll package your KEXT:</p>
<ol class="ol"><li class="li"><p><span class="content_text"><a href="packaging_kext.html#//apple_ref/doc/uid/20002368-97862">“Locate Your KEXT”</a></span></p></li>
<li class="li"><p><span class="content_text"><a href="packaging_kext.html#//apple_ref/doc/uid/20002368-98104">“Create a Distribution Directory”</a></span></p></li>
<li class="li"><p><span class="content_text"><a href="packaging_kext.html#//apple_ref/doc/uid/20002368-98736">“Gather Any Package Resources”</a></span></p></li>
<li class="li"><p><span class="content_text"><a href="packaging_kext.html#//apple_ref/doc/uid/20002368-99356">“Create a Package with PackageMaker”</a></span></p></li>
<li class="li"><p><span class="content_text"><a href="packaging_kext.html#//apple_ref/doc/uid/20002368-100070">“Examine the Package and Files”</a></span></p></li>
<li class="li"><p><span class="content_text"><a href="packaging_kext.html#//apple_ref/doc/uid/20002368-100371">“Test Installing the Package”</a></span></p></li></ol>
<p>You’ll use the Terminal application to type the commands to locate your KEXT and create a distribution tree. You’ll use the PackageMaker application to build your package. Then you will test the package with the Mac OS X Installer application.</p>
<a name="//apple_ref/doc/uid/20002368-97862" title="Locate Your KEXT"></a><a name="//apple_ref/doc/uid/20002368-97862-CHDDJEAE" title="Locate Your KEXT"></a><h2>Locate Your KEXT</h2>
<p>If you have not yet done so, you will need to create, build, and test a KEXT, either a device driver or another type of KEXT. If you do not already have a KEXT to package, follow the instructions in one of the previous tutorials, <span class="content_text"><a href="../KEXTConceptKEXT/hello_kext.html#//apple_ref/doc/uid/20002365-BABJHCJA">“Hello Kernel: Creating a Kernel Extension With Xcode”</a></span> or <span class="content_text"><a href="../KEXTConceptIOKit/hello_iokit.html#//apple_ref/doc/uid/20002366-CIHECHHE">“Hello I/O Kit: Creating a Device Driver With Xcode.”</a></span> It is not necessary (for this tutorial) that your KEXT actually do anything, only that it exists.</p>
<p>Locate your KEXT. Use the Terminal application to move to the directory that contains your KEXT.</p>
<ol class="ol"><li class="li"><p>Start the Terminal application. From a Desktop Finder window, locate and launch the Terminal application, found at <code>/Applications/Utilities/Terminal</code>. </p></li>
<li class="li"><p>Choose New from the Shell menu to start a new shell window.</p></li>
<li class="li"><p>In the Terminal window, move to the directory that contains your KEXT. Use the <strong>cd</strong> command to move to the appropriate directory. For example: </p><div class="codesample"><table><tr><td scope="row"><pre>% cd /Users/admin/Projects/Hello/build<span></span></pre></td></tr></table></div><p>This directory contains your KEXT. You can use the <strong>ls</strong> command to view the contents of this directory. For example:</p>
<div class="codesample"><table><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>% ls<span></span></pre></td></tr><tr><td scope="row"><pre>Hello.build<span></span></pre></td></tr><tr><td scope="row"><pre>Hello.kext<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr></table></div><p>Your KEXT should have a name that ends with the suffix <strong>.kext</strong>. </p><div class="warningbox"><img src="../../../../Resources/Images/icon_warning.gif" alt="!" width="20" height="20" border="0" class="warningicon" /><a name="//apple_ref/doc/uid/20002368-DontLinkElementID_37" title="Warning:"></a><p><strong>Warning:</strong>&nbsp;
For purposes of packaging, distribution, and installation, the filename of the KEXT (apart from the suffix) does not matter. However, the name of the KEXT binary and its class (if a driver), as stored in the KEXT's property list, should be unique. These should use the recommended “reverse-DNS” naming convention, such as <code>com.MySoftwareCompany.iokit.HelloIOKit</code>.</p><p></p><div class="clear"></div></div><p>From a Desktop Finder window, a KEXT appears as a single file (look for it from the Desktop if you like). From the Terminal application, however, a KEXT appears as a directory.</p></li></ol>
<a name="//apple_ref/doc/uid/20002368-98104" title="Create a Distribution Directory"></a><a name="//apple_ref/doc/uid/20002368-98104-CHDDHCHD" title="Create a Distribution Directory"></a><h2>Create a Distribution Directory</h2>
<p>When your KEXT is installed, it will be installed into the Extensions folder, at <code>/System/Library/Extensions</code> under Mac OS X.</p>
<p>Because kernel extensions contain code and data that are loaded into the kernel, the most protected environment in the operating system, their file ownership and permissions must be set to prevent unauthorized tampering. All KEXT bundles (all files and folders in the KEXT, including the KEXT binary) must be owned by the user <code>root</code> and the group <code>wheel</code>. In addition, the folders and files of the KEXT bundle must have their permissions set so that they are not writable by any user other than the super user.</p>
<p>For development purposes, however, you can make a <code>root</code>-owned copy of your KEXT binary by using the <strong>sudo</strong> command to copy the KEXT binary (<code>Hello.kext</code>) to the <code>/tmp</code> directory and creating the distribution directory there. Using the <strong>sudo</strong> command to copy the KEXT binary to <code>/tmp</code> gives the KEXT the super user's ownership and permissions and leaves the original KEXT alone so you can revise and save it as you choose.</p>
<div class="notebox"><a name="//apple_ref/doc/uid/20002368-DontLinkElementID_38" title="Note"></a><p><strong>Note:</strong>&nbsp;You should not change the ownership and permissions of any of your KEXT files in your own directory, because you will no longer be able to save them after working on them. Thus, every time you make changes to your KEXT and rebuild it, you need to repeat the following steps to copy the new version to the <code>/tmp</code> directory and repackage it.</p></div>
<p>To create the package, you will first make a distribution folder, then copy your KEXT into it. When the package is installed (unpacked), Installer will place the KEXT at the correct point in the user's file system.</p>
<ol class="ol"><li class="li"><p>At the prompt, you'll use the <strong>cp -R</strong> command with the <strong>sudo</strong> command to copy your KEXT to <code>/tmp</code>. The <strong>cp</strong> command copies files from one place to another and the <em>-R</em> option tells <strong>cp</strong> to copy a directory and its entire subtree (like <code>Hello.kext</code>). When prompted for a password, enter your <code>admin</code> password. (Note that nothing is displayed as you type the password.)</p><p>For example:</p><div class="codesample"><table><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>% sudo cp -R Hello.kext /tmp<span></span></pre></td></tr><tr><td scope="row"><pre>Password:<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr></table></div><p>Check the ownership and permissions of your driver by moving to the <code>/tmp</code> directory and using the <strong>ls -l</strong> command:</p>
<div class="codesample"><table><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>% cd /tmp<span></span></pre></td></tr><tr><td scope="row"><pre>% ls -l<span></span></pre></td></tr><tr><td scope="row"><pre>drwxr-xr-x 3 root wheel 102 Oct 20 10:30 Hello.kext<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr></table></div><p>The <em>-l</em> makes the <strong>ls</strong> command display extra information about the files in a directory.</p></li>
<li class="li"><p>Now use the <strong>mkdir</strong> command with the <strong>sudo</strong> command to create the distribution directory. For example: </p>
<div class="codesample"><table><tr><td scope="row"><pre>% sudo mkdir dstroot<span></span></pre></td></tr></table></div><p>This creates a directory folder, <code>dstroot</code> (distribution root), in the <code>/tmp</code> directory.</p></li>
<li class="li"><p>Copy your KEXT into the new <code>dstroot</code> folder using the <strong>cp</strong> command with the <code>-R</code> option. For example: </p><div class="codesample"><table><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>% sudo cp -R Hello.kext dstroot<span></span></pre></td></tr></table></div></li>
<li class="li"><p>List the contents of the new directory hierarchy. Use the <strong>find</strong> command. For example: </p><div class="codesample"><table><tr><td scope="row"><pre>% find dstroot<span></span></pre></td></tr></table></div><p>You should see output like this (although the name of your KEXT may differ):</p>
<div class="codesample"><table><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>dstroot<span></span></pre></td></tr><tr><td scope="row"><pre>dstroot/Hello.kext<span></span></pre></td></tr><tr><td scope="row"><pre>dstroot/Hello.kext/Contents<span></span></pre></td></tr><tr><td scope="row"><pre>dstroot/Hello.kext/Contents/Info.plist<span></span></pre></td></tr><tr><td scope="row"><pre>dstroot/Hello.kext/Contents/MacOS<span></span></pre></td></tr><tr><td scope="row"><pre>dstroot/Hello.kext/Contents/MacOS/Hello<span></span></pre></td></tr><tr><td scope="row"><pre>dstroot/Hello.kext/Contents/Resources<span></span></pre></td></tr><tr><td scope="row"><pre>dstroot/Hello.kext/Contents/Resources/English.lproj<span></span></pre></td></tr><tr><td scope="row"><pre>dstroot/Hello.kext/Contents/Resources/English.lproj/InfoPlist.strings<span></span></pre></td></tr><tr><td scope="row"><pre>dstroot/Hello.kext/Contents/Resources/...<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr></table></div></li></ol>
<a name="//apple_ref/doc/uid/20002368-98736" title="Gather Any Package Resources"></a><a name="//apple_ref/doc/uid/20002368-98736-CHDEGEDE" title="Gather Any Package Resources"></a><h2>Gather Any Package Resources</h2>
<p>As described in <span class="content_text"><a href="packaging_kext.html#//apple_ref/doc/uid/20002368-97383">“Anatomy of a Package,”</a></span> packages may contain additional (optional) supplementary resources used by the package itself. These are used (or run) at installation time but will not be installed on disk along with the software.</p>
<p>There are certain special filenames that Installer will recognize and display automatically if they are present in a package. These are: a Read Me file, a software license file, and a welcome file. These files can be in any of several forms: text (.txt), HTML (.html) or Rich Text Format (.rtf). In this tutorial, you will create three files: <code>ReadMe.rtf</code>, <code>License.rtf</code>, and <code>Welcome.rtf</code>.</p>
<p>The supplementary resources will not be installed along with your KEXT, so they should not be placed in the distribution directory you created in <span class="content_text"><a href="packaging_kext.html#//apple_ref/doc/uid/20002368-98104">“Create a Distribution Directory.”</a></span> Instead, use the <strong>cd</strong> command to go back to the <code>Projects</code> directory containing the original copy of your KEXT:</p>
<div class="codesample"><table><tr><td scope="row"><pre>% cd /Users/admin/Projects<span></span></pre></td></tr></table></div>
<p>and create a resources directory there:</p>
<div class="codesample"><table><tr><td scope="row"><pre>% mkdir MyResources<span></span></pre></td></tr></table></div>
<p>You can create your supplementary Installer resources elsewhere and copy them to the resources directory, or you can create them in the directory. In this tutorial, you will create three files, <code>ReadMe.rtf</code>, <code>License.rtf</code>, and <code>Welcome.rtf</code> in the resources directory. Move to your resources directory using the <strong>cd</strong> command. For example:</p>
<div class="codesample"><table><tr><td scope="row"><pre>% cd MyResources<span></span></pre></td></tr></table></div>
<a name="//apple_ref/doc/uid/20002368-98950" title="Create a Read Me File"></a><h2>Create a Read Me File</h2>
<p>If a Read Me file is present in a package, the Mac OS X Installer will display the contents of the file. A user dismisses the Read Me by clicking Continue. The presence of a <code>ReadMe.rtf</code> file is all that is needed to get this feature. Installer will automatically add a “Read Me” line to the bullet list presented in the left column of the application. For an example of a Read Me file displayed during installation, see <span class="content_text"><a href="packaging_kext.html#//apple_ref/doc/uid/20002368-103634-CHDCFJBC">Figure 6</a></span>.</p>
<ol class="ol"><li class="li"><p>Start the TextEdit application. From a Desktop Finder window, locate and launch the TextEdit application, located at <code>/Applications/TextEdit</code>. </p></li>
<li class="li"><p>Enter the text of your Read Me file. Generally, a Read Me file should describe the contents of your package, version information, and any additional information a user might need to see. For example, a Read Me file could provide contact information, special hardware instructions, any known incompatibilities with other extensions, and so forth.</p></li>
<li class="li"><p>Save your Read Me file. Use the name <code>ReadMe.rtf</code>. As the location (Where), choose the <code>MyResources</code> directory you created in <span class="content_text"><a href="packaging_kext.html#//apple_ref/doc/uid/20002368-98736">“Gather Any Package Resources.”</a></span></p></li>
<li class="li"><p>Close the Read Me file.</p></li></ol>
<a name="//apple_ref/doc/uid/20002368-99097" title="Create a Software License File"></a><h2>Create a Software License File</h2>
<p>If a license file is present in a package, Installer will display the contents of the file. A user dismisses the license pane by clicking Continue. Installer then displays a dialog that requires the user to Agree to the license terms in order to proceed with installation.</p>
<p>The presence of a <code>License.rtf</code> file is all that is needed to get this feature. Installer will automatically add a "License" line to the bullet list presented in the Left column of the application.</p>
<ol class="ol"><li class="li"><p>Use the TextEdit application. Choose New from the File menu to start a new document. </p></li>
<li class="li"><p>Enter the text of your license file. Generally, a license file should describe the terms of use for your package, any legal disclaimers, or any pre-release software warnings.</p></li>
<li class="li"><p>Save your license file. Use the name <code>License.rtf</code>. As the location (Where), choose the <code>MyResources</code> directory you created in <span class="content_text"><a href="packaging_kext.html#//apple_ref/doc/uid/20002368-98736">“Gather Any Package Resources.”</a></span></p></li>
<li class="li"><p>Close the license file.</p></li></ol>
<a name="//apple_ref/doc/uid/20002368-99229" title="Create a Welcome File"></a><h2>Create a Welcome File</h2>
<p>If a welcome file is present in a package, Installer will display the contents of the file. After the user authenticates (if required), the welcome message is the first thing displayed when a package is opened. The presence of a <code>Welcome.rtf</code> file is all that is needed to get this feature.</p>
<ol class="ol"><li class="li"><p>Use the TextEdit application. Choose New from the File menu to start a new document.</p></li>
<li class="li"><p>Enter the text of your welcome file. Generally, a welcome file is a brief introduction to the software being installed, and may contain the name of the software, its creator, and a very brief description of the software. More extensive description belongs in the Read Me file.</p><p>The text of the welcome file may not be larger than the Installer window it is displayed in because the welcome pane will not allow the user to scroll to see more text.</p></li>
<li class="li"><p>Save your welcome file. Use the name <code>Welcome.rtf</code>. As the location (Where), choose the <code>MyResources</code> directory you created in <span class="content_text"><a href="packaging_kext.html#//apple_ref/doc/uid/20002368-98736">“Gather Any Package Resources.”</a></span></p></li>
<li class="li"><p>Close the welcome file.</p></li></ol>
<a name="//apple_ref/doc/uid/20002368-99356" title="Create a Package with PackageMaker"></a><a name="//apple_ref/doc/uid/20002368-99356-CHDIAABA" title="Create a Package with PackageMaker"></a><h2>Create a Package with PackageMaker</h2>
<p>Now you can use PackageMaker to create a package project and build from it an installable package, which includes all of the files in your distribution and resources directories.</p>
<ol class="ol"><li class="li"><p>Start the PackageMaker application. From a Desktop Finder window, locate and launch the PackageMaker application, located at <code>/Developer/Applications/Utilities</code>. </p></li><li class="li"><p>With PackageMaker, you can create simple packages, metapackages, and distributions (for more information on these types of installations, see <em><a href="../../../../DeveloperTools/Conceptual/SoftwareDistribution/index.html#//apple_ref/doc/uid/10000145i" target="_top">Software Delivery Guide</a></em>). For this tutorial, select Simple Package Project in the Assistant window and click OK, as shown in <span class="content_text">Figure 1</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20002368-SW1" title="Figure 1Choose Simple Package Project in the PackageMaker Assistant window"></a><p><strong>Figure 1&nbsp;&nbsp;</strong>Choose Simple Package Project in the PackageMaker Assistant window</p><img src = "../art/pmassistant.jpg" alt = "" ></div></li>
<li class="li"><p>After you click OK to choose the package project type, the Assistant window disappears and is replaced by the PackageMaker window. Click the Show Installer Interface Editor button (if you don't see this button, be sure the Installer Interface tab is selected in the PackageMaker window). This displays a separate window in which you can customize the background image Installer displays and add to the package your welcome, Read Me, and license files (for this tutorial, you won't customize the background image).</p><ul class="ul"><li class="li"><p>First, add to the package the welcome file you created in <span class="content_text"><a href="packaging_kext.html#//apple_ref/doc/uid/20002368-99229">“Create a Welcome File.”</a></span> Click the Introduction radio button on the left side of the Installer Interface Editor window. You can either drag your welcome file into the center pane or you can select Custom Welcome in the Introduction Inspector drawer on the right side of the window. If you select Custom Welcome in the Introduction Inspector, you'll see a dialog drop down in which you navigate to your welcome file and then double-click it or select it and click Open, as shown in <span class="content_text">Figure 2</span>. </p><div class="item_figure"><a name="//apple_ref/doc/uid/20002368-SW2" title="Figure 2Use the Installer Interface Editor to add the welcome file to the package"></a><p><strong>Figure 2&nbsp;&nbsp;</strong>Use the Installer Interface Editor to add the welcome file to the package</p><img src = "../art/pminstallwelcome.jpg" alt = "" ></div></li><li class="li"><p>Next, perform similar steps to add the Read Me file you created in <span class="content_text"><a href="packaging_kext.html#//apple_ref/doc/uid/20002368-98950">“Create a Read Me File”</a></span>: Click the Read Me radio button on the left side of the Installer Interface Editor window. You can either drag your Read Me file into the center pane or you can select Custom Read Me in the Read Me Inspector drawer on the right side of the window. If you select Custom Read Me, a dialog drops down in which you navigate to your Read Me file and then double-click it or select it and click Open.</p></li><li class="li"><p>Finally, perform similar steps to add the license file you created in <span class="content_text"><a href="packaging_kext.html#//apple_ref/doc/uid/20002368-99097">“Create a Software License File”</a></span>: Click the License radio button on the left side of the Installer Interface Editor window. You can either drag your license file into the center pane or you can select Custom License in the License Inspector drawer on the right side of the window. If you select Custom License, a dialog drops down in which you navigate to your license file and then double-click it or select it and click Open.</p></li></ul></li><li class="li"><p>Before you close the Installer Interface Editor window, save the changes you've made to the package project. In the menu bar, choose File and click Save. PackageMaker will ask you to name this project and choose a location in which to save it. For this tutorial, choose the name <code>Hello.pmproj</code>.</p><p>As you provide additional information in the following steps, it's a good idea to save frequently. Also, if you want to make changes to any of this information, you can edit this project later and build a new package from it.</p><p>Close the Installer Interface Editor window.</p><div class="notebox"><a name="//apple_ref/doc/uid/20002368-DontLinkElementID_39" title="Note"></a><p><strong>Note:</strong>&nbsp;You do not need to make any changes to the Installer Interface pane in the main PackageMaker window, because the package you build in this tutorial is not contained in an old-style metapackage. For more information about metapackages, see <em><a href="../../../../DeveloperTools/Conceptual/SoftwareDistribution/index.html#//apple_ref/doc/uid/10000145i" target="_top">Software Delivery Guide</a></em>.</p></div></li>
<li class="li"><p>In the PackageMaker window, click Contents.</p><ul class="ul"><li class="li"><p>For Root, type or choose the path to the copy of your KEXT in the <code>/tmp</code> directory. For example, <code>/tmp/dstroot</code>.</p></li><li class="li"><p>For this tutorial, you can leave the checkboxes under Advanced Options in their default state. Specifically, you can leave the Compress Archive and the Remove .DS_Store Files from Archive checkboxes checked and the Preserve Resource Forks checkbox unchecked. <span class="content_text">Figure 3</span> shows the Contents pane of the PackageMaker window after you've completed this step. If you're interested in learning more about these options and how they can affect the packaging and installation of your software, see <em><a href="../../../../DeveloperTools/Conceptual/SoftwareDistribution/index.html#//apple_ref/doc/uid/10000145i" target="_top">Software Delivery Guide</a></em>.</p></li></ul><div class="item_figure"><a name="//apple_ref/doc/uid/20002368-SW4" title="Figure 3Provide the location of your software"></a><p><strong>Figure 3&nbsp;&nbsp;</strong>Provide the location of your software</p><img src = "../art/pmcontents.jpg" alt = "" ></div></li>
<li class="li"><p>Click Configuration.</p><ul class="ul"><li class="li"><p>For Default Location, type or choose the path to the location in which you want your KEXT installed. For example, <code>/System/Library/Extensions</code>.</p></li>
<li class="li"><p>Select Root authentication for the authentication requirement. This allows one of Installer's tools to be run as <code>root</code>. If the user installing your KEXT is logged in as the <code>root</code> user, Installer will not request any authorization. If the user is logged in as the <code>admin</code> user, Installer will display a dialog that requests the user to supply his or her <code>admin</code> password. Only users with <code>root</code> or <code>admin</code> privileges should install KEXTs.</p></li>
<li class="li"><p>Select the appropriate restart action. For this tutorial, select None.</p></li>
<li class="li"><p>Set the appropriate flags. For this tutorial, check only the Follow Symbolic Links checkbox. This ensures that the user's symbolic links will be preserved.</p><div class="importantbox"><a name="//apple_ref/doc/uid/20002368-DontLinkElementID_40" title="Important:"></a><p><strong>Important:</strong>&nbsp;Be sure to leave the Overwrite Directory Permissions checkbox unchecked. This prevents the possibility of causing Installer to incorrectly change the permissions of the <code>/System/Library/Extensions</code> folder.</p><p></p></div></li></ul><p><span class="content_text">Figure 4</span> shows the Configuration pane of the PackageMaker window after you've completed this step.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20002368-SW5" title="Figure 4Describe the installation location and actions"></a><p><strong>Figure 4&nbsp;&nbsp;</strong>Describe the installation location and actions</p><img src = "../art/pmconfiguration.jpg" alt = "" ></div></li>
<li class="li"><p>Click Package Version.</p><ul class="ul">
<li class="li"><p>For Identifier, type your reverse-DNS name; for example, <code>com.MyTutorial.Hello</code>.</p></li>
<li class="li"><p>The Get Info String field contains a string the Finder displays in the Get Info window for the package. Choose a name that describes your KEXT, such as <code>Hello v1.0</code>.</p></li>
<li class="li"><p>The Version field contains the version string the Finder displays in column view. You can use the same version number you used in the Get Info string or a different one, depending on how you structure your development environment. For this tutorial, use the same version number (<code>1.0</code>).</p></li></ul></li></ol>
<p>When you are finished providing the package information, click File in the menu bar and select Save. If you haven't saved earlier, PackageMaker will ask you what name to save the package project under and where to store it.</p><p>Now PackageMaker can build an installable package from the information in the project you've created. In the menu bar, choose Project and click Build.</p><p>PackageMaker will ask you what name to save the package under and where to store it:</p>
<ol class="ol"><li class="li"><p>In the Save As field, type in a name for your package. The best name to choose is one that incorporates the name of your KEXT. For example, if your KEXT is named <code>Hello.kext</code>, name your package <code>Hello.pkg</code> (note that PackageMaker automatically supplies the <code>.pkg</code> extension in the Save As field).</p></li>
<li class="li"><p>Choose a location. The default location is your home folder, but you may want to create a new folder called Packages to use for all packages you create.</p></li>
<li class="li"><p>When you have chosen a name and location, click Save.</p></li></ol>
<a name="//apple_ref/doc/uid/20002368-100070" title="Examine the Package and Files"></a><a name="//apple_ref/doc/uid/20002368-100070-CHDCEAGB" title="Examine the Package and Files"></a><h2>Examine the Package and Files</h2>
<p>You can now quit PackageMaker and examine your new package.</p>
<ol class="ol"><li class="li"><p>From a Desktop Finder window, navigate to the location where you told PackageMaker to save your package. For example, if you named the package Hello.pkg and told PackageMaker to store it in the Packages folder in your home folder, move to the Packages folder as shown in <span class="content_text">Figure 5</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20002368-103335-CHDJBGGJ" title="Figure 5Locate your package on the Desktop"></a>
<p><a name="//apple_ref/doc/uid/20002368-103335" title="Figure 5Locate your package on the Desktop"></a><strong>Figure 5&nbsp;&nbsp;</strong>Locate your package on the Desktop</p>
<img src = "../art/desktoppkg.jpg" alt = "" ></div><p>The file <code>Hello.pmproj</code> is the project that contains the information you provided in <span class="content_text"><a href="packaging_kext.html#//apple_ref/doc/uid/20002368-99356">“Create a Package with PackageMaker.”</a></span></p></li>
<li class="li"><p>From a shell window in the Terminal application, move to the directory that contains your package. For example: </p>
<div class="codesample"><table><tr><td scope="row"><pre>% cd /Users/admin/Packages<span></span></pre></td></tr></table></div><p>From a Desktop Finder window, a package appears as a single file. From the Terminal application, however, a package appears as a directory.</p><p>List the contents of your package directory using the <strong>find</strong> command. Some of the files you'll see are listed below:</p><div class="codesample"><table><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>% find Hello.pkg<span></span></pre></td></tr><tr><td scope="row"><pre>Hello.pkg<span></span></pre></td></tr><tr><td scope="row"><pre>Hello.pkg/Contents<span></span></pre></td></tr><tr><td scope="row"><pre>Hello.pkg/Contents/Archive.bom<span></span></pre></td></tr><tr><td scope="row"><pre>Hello.pkg/Contents/Archive.pax.gz<span></span></pre></td></tr><tr><td scope="row"><pre>Hello.pkg/Contents/Info.plist<span></span></pre></td></tr><tr><td scope="row"><pre>Hello.pkg/Contents/PkgInfo<span></span></pre></td></tr><tr><td scope="row"><pre>Hello.pkg/Contents/Resources<span></span></pre></td></tr><tr><td scope="row"><pre>Hello.pkg/Contents/Resources/BundleVersions.plist<span></span></pre></td></tr><tr><td scope="row"><pre>Hello.pkg/Contents/Resources/English.lproj/License.rtf<span></span></pre></td></tr><tr><td scope="row"><pre>Hello.pkg/Contents/Resources/English.lproj/ReadMe.rtf<span></span></pre></td></tr><tr><td scope="row"><pre>Hello.pkg/Contents/Resources/English.lproj/Welcome.rtf<span></span></pre></td></tr></table></div><p>Refer to <span class="content_text"><a href="packaging_kext.html#//apple_ref/doc/uid/20002368-97383">“Anatomy of a Package”</a></span> and <span class="content_text"><a href="packaging_kext.html#//apple_ref/doc/uid/20002368-98736">“Gather Any Package Resources”</a></span> for descriptions of the <code>Hello</code> and <code>.rtf</code> files and their contents.</p></li></ol>
<a name="//apple_ref/doc/uid/20002368-100371" title="Test Installing the Package"></a><a name="//apple_ref/doc/uid/20002368-100371-CHDEIADI" title="Test Installing the Package"></a><h2>Test Installing the Package</h2>
<p>Now you can test your package. Mac OS X will run the Installer application if you double-click a package.</p>
<ol class="ol"><li class="li"><p>From a Desktop Finder window, navigate to the location where you told PackageMaker to save your package (repeat step #1 in <span class="content_text"><a href="packaging_kext.html#//apple_ref/doc/uid/20002368-100070">“Examine the Package and Files”</a></span>).</p></li>
<li class="li"><p>Select and double-click the package, for example, <code>Hello.pkg</code>.</p></li>
<li class="li"><p>The Mac OS X Installer launches.</p></li>
<li class="li"><p>The Introduction window will be displayed, along with the welcome file, if you created one. Click Continue. </p></li>
<li class="li"><p>If you created a Read Me file, you should see it displayed with the heading “Important Information” as shown in <span class="content_text">Figure 6</span>. Click Continue. </p><div class="item_figure"><a name="//apple_ref/doc/uid/20002368-103634-CHDCFJBC" title="Figure 6Installer displays Read Me file"></a><p><a name="//apple_ref/doc/uid/20002368-103634" title="Figure 6Installer displays Read Me file"></a><strong>Figure 6&nbsp;&nbsp;</strong>Installer displays Read Me file</p><img src = "../art/readme.jpg" alt = "" ></div></li>
<li class="li"><p>If you created a license file, you should see it displayed with the heading “Software License Agreement”. Click Continue. Installer will display a dialog requiring you to agree (or disagree) to the terms of the license. Click Agree.</p></li>
<li class="li"><p>If appropriate, select a destination volume and click Continue.</p></li>
<li class="li"><p>If you required a higher level of authorization than you are currently logged in at, Installer will display an authorization dialog and ask you to type your password, as in <span class="content_text">Figure 7</span>. </p><div class="item_figure"><a name="//apple_ref/doc/uid/20002368-103577-CHDFGJJJ" title="Figure 7Installer displays an authentication dialog"></a>
<p><a name="//apple_ref/doc/uid/20002368-103577" title="Figure 7Installer displays an authentication dialog"></a><strong>Figure 7&nbsp;&nbsp;</strong>Installer displays an authentication dialog</p>
<img src = "../art/pminstallauthenticate.jpg" alt = "" ></div></li>
<li class="li"><p>Click Install (or Upgrade if you've installed this package before) and allow Installer to proceed. Click Close when Installer has finished.</p></li></ol>
<p>Now you can check that the package was installed. Navigate to <code>/System/Library/Extensions</code>. You should see your KEXT (<code>Hello.kext</code>). Remember that the KEXT is a bundle; you can view the contents of the KEXT from a Terminal shell. If you do, you can see that the Read Me, software license, and welcome files were not installed.</p>
<a name="//apple_ref/doc/uid/20002368-100614" title="Where to Go Next"></a><h2>Where to Go Next</h2>
<p>Congratulations! You’ve now packaged and installed a KEXT.</p>
<p>This tutorial is part of a series. An additional tutorial describes how to debug a kernel extension (<span class="content_text"><a href="../KEXTConceptDebugger/hello_debugger.html#//apple_ref/doc/uid/20002367-CHDIHFDI">“Hello Debugger: Debugging a Device Driver With GDB”</a></span>). This tutorial, as well as the earlier (prerequisite) tutorials, can be found in <em><a href="../index.html" target="_top">Kernel Extension Programming Topics</a></em>.</p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../KEXTConceptDebugger/hello_debugger.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../KEXTConceptLoading/loading_kexts.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2003, 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-10-31<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Conceptual/KEXTConcept/KEXTConceptPackaging/packaging_kext.html%3Fid%3DTP40001063-3.7&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Conceptual/KEXTConcept/KEXTConceptPackaging/packaging_kext.html%3Fid%3DTP40001063-3.7&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Conceptual/KEXTConcept/KEXTConceptPackaging/packaging_kext.html%3Fid%3DTP40001063-3.7&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
