<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>OTRcvUReply</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING173></A>
<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->

<!-- Main Body -->

<CENTER>
<P>
<A HREF="NetworkingWOT-172.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="NetworkingWOT-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="NetworkingWOT-491.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A>  <A HREF="NetworkingWOT-174.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html"><B>Inside Macintosh:</B></A> <A HREF="NetworkingWOT-2.html"><B>Networking With Open Transport </B></A> / <A HREF="NetworkingWOT-81.html"><B>Part 2 - Open Transport Reference</B></A><BR><DD><A HREF="NetworkingWOT-127.html"><B>Chapter 22 - Endpoints Reference</B></A> / <A HREF="NetworkingWOT-146.html"><B>Functions</B></A><BR><DL><DD><A HREF="NetworkingWOT-169.html"><B>Functions for Connectionless Transaction-Based Endpoints</B></A> / </DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING173-0></A>
<H3><A NAME=MARKER-9-190></A>OTRcvUReply</H3>
 Reads a reply to a request sent by a client using a connectionless transaction-based protocol.<P>
<A NAME=HEADING173-2></A>
<H5>C INTERFACE</H5>
<PRE>
<A NAME=MARKER-11-191></A>OSStatus OTRcvUReply(EndpointRef ref, TUnitReply* reply, 
                                         OTFlags* replyFlags);
</PRE>
<A NAME=HEADING173-4></A>
<H5>C++ INTERFACE</H5>
<PRE>
<A NAME=MARKER-12-192></A>OSStatus TEndpoint::RcvUReply(TUnitReply* reply, 
                     OTFlags* replyFlags);
</PRE>
<A NAME=HEADING173-6></A>
<H5>PARAMETERS</H5>
<DL>
<DT><CODE>ref</CODE>
<DD> The endpoint reference of the endpoint accepting the reply.<P>
<DT><CODE>reply</CODE>
<DD> A pointer to a <A HREF=NetworkingWOT-141.html#MARKER-9-100><CODE>TUnitReply</CODE></A> structure that specifies the location to store the reply information.<P>
<DT>
<DD> The <CODE>reply-&gt;addr</CODE> field specifies the location and size of a buffer containing the address of the endpoint sending the reply. You must allocate a buffer into which the address is placed when the function returns, and you must set the <CODE>reply-&gt;addr.buf</CODE> field to point to this buffer. You must also set the <CODE>reply-&gt;addr.maxlen</CODE> field to the maximum size of the buffer. <P>
<DT>
<DD> The <CODE>reply-&gt;opt </CODE>field specifies the location and size of a buffer containing the association-related options that the responder has sent using the <CODE>OTSndUReply</CODE> function. You must allocate a buffer to hold option information and set the <CODE>reply-&gt;opt</CODE> field to point to it. When the <CODE>OTRcvUReply</CODE> function returns, it fills this buffer with option information. You must set the <CODE>reply-&gt;opt.maxlen</CODE> field to the maximum size necessary to hold option information.<P>
<DT>
<DD> The <CODE>reply-&gt;udata </CODE>field specifies the location and size of a buffer into which the function places the reply data on return. You must allocate a buffer to hold the data, set the <CODE>reply-&gt;udata.buf</CODE> field to point to it, and set the <CODE>reply-&gt;udata.maxlen</CODE> field to the maximum size of this buffer. The size must not exceed the value specified for the <CODE>tsdu</CODE> field of the <CODE>TEndpointInfo</CODE> structure for this endpoint.<P>
<DT>
<DD> If you have sent out multiple requests, you can use the <CODE>reply-&gt;sequence</CODE> field to match incoming replies to outgoing requests.<P>
<DT><CODE>replyFlags</CODE>
<DD> A pointer to a bitmapped long that is filled in by the endpoint provider to indicate whether there is more reply data to be read, in which case you must call the <CODE>OTRcvUReply</CODE> function again. A value of <CODE>T_MORE</CODE> indicates that the buffer pointed to by <CODE>udata.buf </CODE>is too small to contain the reply. A value of <CODE>T_PARTIALDATA</CODE> indicates that the data unit being read does not contain the complete reply. It is possible that both flags are set.<P>
<DT><I>function result</I>
<DD> An error code. See Discussion.
</DL>
<A NAME=HEADING173-15></A>
<H5>DISCUSSION</H5>
 You use the <CODE>OTRcvUReply</CODE> function to read the reply to a request that you have issued using the <CODE>OTSndURequest</CODE> function. The <CODE>reply</CODE> parameter points to buffers in which the function stores the reply, the address of the responder, any options connected with this transaction, and the transaction ID for this transaction. <P>
 If the endpoint is in asynchronous mode, the provider generates a <CODE>T_REPLY</CODE> event to let you know that reply data has arrived. If it should happen that the reply data is sent using multiple calls to the sending function, Open Transport does not generate additional <CODE>T_REPLY</CODE> events. To guard against this possibility, your notifier function should call the <CODE>OTRcvUReply</CODE> function until it returns the <CODE>kOTNoDataErr</CODE> result.<P>
 If a transaction has timed out awaiting reply data, the <CODE>OTRcvUReply</CODE> function returns a <CODE>kETIMEDOUTErr</CODE> result; the <CODE>sequence</CODE> field of the <CODE>reply</CODE> parameter specifies which request has timed out. <P>
 If you have issued multiple requests, it is not possible to know ahead of time how incoming replies match your requests. If the <CODE>OTRcvUReply</CODE> function returns withthe <CODE>T_PARTIALDATA</CODE> flag set, you must be prepared to receive a reply to any outstanding request. One way to manage this situation is to call the <CODE>OTRcvUReply</CODE> function with the <CODE>reply-&gt;udata.maxlen</CODE> field set to 0. The rest of the information returned by the function on this first call lets you know the sequence number of the reply as well as the <CODE>flagPtr</CODE> setting. Once you determine the matching request and the appropriate reply buffer, you can call the <CODE>OTRcvUReply</CODE> function a second time to read the actual reply data. On the second and subsequent reads, Open Transport sets the <CODE>reply-&gt;opt.len</CODE> field to 0. It is guaranteed that once a reply has been partially read, subsequent calls to <CODE>OTRcvUReply </CODE>will read from that same reply until all the data has been read.<P>
 If the <CODE>T_MORE</CODE> bit is set in the <CODE>flags</CODE> parameter, this means your buffer is not large enough to hold the entire reply. You must call the <CODE>OTRcvURequest</CODE> function again to retrieve more request data. Open Transport ignores the <CODE>addr</CODE> and <CODE>opt</CODE> fields of the <CODE>reply</CODE> parameter for subsequent calls to the function. The <CODE>T_MORE</CODE> flag is not set for the last reply packet to let you know that this is the last packet. <P>
 If the <CODE>T_PARTIALDATA </CODE>bit is set in the <CODE>flags</CODE> parameter, this means that the data you read with the <CODE>OTRcvUReply</CODE> function does not constitute the entire reply; more data is coming but it has not yet arrived. You must call the function again to read more of, or the rest of, the reply.<P>
 If the <CODE>T_MORE</CODE> and the <CODE>T_PARTIALDATA</CODE> bits are both set, this means that the data you read constitutes only part of the reply and that your buffer is too small to contain even this chunk. In this case, you must call the function again until the <CODE>T_MORE</CODE> flag is clear. The <CODE>T_PARTIALDATA</CODE> bit is set only on the first call to the function.<P>
 The following table shows how the endpoint's mode of execution and blocking status affects the behavior of the <CODE>OTRcvUReply</CODE> function.<P>

<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>&nbsp;<TH>Blocking<TH>Nonblocking<TR>
<TD>Synchronous<TD>The function returns when the provider lifts flow-control restrictions and the reply has arrived.<TD>The function returns immediately.<TR>
<TD>&nbsp;<TD>The <CODE>kOTFlowErr</CODE> result is never returned.<TD>The <CODE>kOTFlowErr</CODE> result might be returned.<TR>
<TD>Asynchronous&nbsp;&nbsp;<TD>The function returns immediately.<P>The provider calls your notifier, passing <CODE>T_REPLY</CODE> for the <CODE>code</CODE> parameter.<TD>The function returns immediately.<P>The provider calls your notifier, passing <CODE>T_REPLY</CODE> for the <CODE>code</CODE> parameter.<TR>
<TD>&nbsp;<TD>The <CODE>kOTFlowErr</CODE> result might be returned.<TD>The <CODE>kOTFlowErr</CODE> result might be returned.</TABLE>
<P>
<A NAME=HEADING173-24></A>
<H5>SEE ALSO</H5>
 The <A HREF=NetworkingWOT-170.html#MARKER-9-181><CODE>OTSndURequest</CODE></A> function.<P>
 <A HREF=NetworkingWOT-414.html#MARKER-9-27>"AppleTalk Reference"</A>.<P>
 <A HREF=NetworkingWOT-27.html#MARKER-9-12>Table 4-4</A>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="NetworkingWOT-172.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="NetworkingWOT-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="NetworkingWOT-491.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A>  <A HREF="NetworkingWOT-174.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="NetworkingWOT-4.html">&copy; Apple Computer, Inc.</A><br>15 JAN 1998<P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML> 
