<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Recording Typing(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING325></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-324.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-326.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-316.html"><B>Chapter 9 - Recording Apple Events</B></A> / <A HREF="IAC-321.html"><B>What to Record</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING325-0></A>
<H2>Recording Typing</H2>
 In general, to record typing your application should send itself a Set Data event that sets the contents of the selection. The data should be unstyled text. When your application handles the Set Data event, it should apply the styles that prevail at the insertion point. If your application supports styled text, you need to decide how to apply styles to new text and how to record style changes to selected text. Follow these general guidelines for recording typing: <A NAME=MARKER-2-173></A><P>
<UL>
<LI>When the user sets an insertion point and types new text, use the styles defined for the text just before the insertion location.
<LI>When a user selects text and changes its style, apply the changes to the selection.
<LI>If a user types or pastes new text into a selection, place the insertion point after the new text.<P>
</UL>
 The rest of this section provides examples of how to apply these guidelines.<P>
 Suppose the user sets an insertion point and then types something. Your application should use the style, font, size, and other characteristics of the text just before the insertion point for the new text, and it should record only the new characters inserted. For example, to place the insertion point after word 30 and insert the text "This is the new text," your application can send a Select event followed by a Set Data event:<P>
<UL>
<LI>A Select event with this direct parameter places the insertion point after word 30:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyDirectObject<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cInsertionLoc<TR>
<TD>  keyAEContainer<TD>  typeObjectSpecifier<TD>  (see indented record)<TR>
<TD>    keyAEDesiredClass<TD>    typeType<TD>    cWord<TR>
<TD>    keyAEContainer<TD>    typeNull<TD>    No data<TR>
<TD>    keyAEKeyForm<TD>    typeEnumerated<TD>    formAbsolutePosition<TR>
<TD>    keyAEKeyData<TD>    typeLongInteger<TD>    30<TR>
<TD>  keyAEKeyForm<TD>  typeEnumerated<TD>  formRelativePosition<TR>
<TD>  keyAEKeyData<TD>  typeEnumerated<TD>  kAENext</TABLE>

<LI>A Set Data event (event class <CODE>kAECoreSuite</CODE>, event ID <CODE>kAESetData</CODE>) with these parameters (keyDirectObject and keyAEData) sets the selection to the new text:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyDirectObject<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cProperty<TR>
<TD>  keyAEContainer<TD>  typeObjectSpecifier<TD>  (see indented record)<TR>
<TD>    keyAEDesiredClass<TD>    typeType<TD>    cProperty<TR>
<TD>    keyAEContainer<TD>    typeNull<TD>    No data<TR>
<TD>    keyAEKeyForm<TD>    typeEnumerated<TD>    formPropertyID<TR>
<TD>    keyAEKeyData<TD>    typeLongInteger<TD>    pSelection<TR>
<TD>  keyAEKeyForm<TD>  typeEnumerated<TD>  formPropertyID<TR>
<TD>  keyAEKeyData<TD>  typeType<TD>  pContents<TR>
<TD>keyAEData<TD>typeChar<TD>"This is the new text"</TABLE>
<P>
</UL>
 Notice that the Select event in this example causes your application to set its <CODE>pSelection</CODE> property (the current selection) to the location specified by the object specifier record in the direct parameter--that is, after word 30. The Set Data event then sets the contents of the selection to a text string. The <CODE>pContents</CODE> property specified by the object specifier record in the direct parameter of the Set Data event represents the contents of the selection, and the text string in the <CODE>keyAEData</CODE> parameter is the text to which the selection's contents is to be set. <P>
 At this stage, the insertion point is after word 35--the last word added by typing. If the user now selects one of the new words, say word 34, and changes the style to boldface and the font to Helvetica<Superscript>\xC6<EM></EM>, send a Select event and two Set Data events to record the action:<P>
<UL>
<LI>A Select event with this direct parameter selects word 34:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyDirectObject<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cWord<TR>
<TD>  keyAEContainer<TD>  typeNull<TD>  No data<TR>
<TD>  keyAEKeyForm<TD>  typeEnumerated<TD>  formAbsolutePosition<TR>
<TD>  keyAEKeyData<TD>  typeLongInteger<TD>  34</TABLE>

<LI>A Set Data event with these parameters sets the style of the selection to boldface
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyDirectObject<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cProperty<TR>
<TD>  keyAEContainer<TD>  typeObjectSpecifier<TD>  (see indented record)<TR>
<TD>    keyAEDesiredClass<TD>    typeType<TD>    cProperty<TR>
<TD>    keyAEContainer<TD>    typeNull<TD>    No data<TR>
<TD>    keyAEKeyForm<TD>    typeEnumerated<TD>    formPropertyID<TR>
<TD>    keyAEKeyData<TD>    typeLongInteger<TD>    pSelection<TR>
<TD>  keyAEKeyForm<TD>  typeType<TD>  formPropertyID<TR>
<TD>  keyAEKeyData<TD>  typeType<TD>  pTextStyles<TR>
<TD>keyAEData<TD>typeEnumerated<TD>kAEBold</TABLE>
:
<LI>A Set Data event with these parameters sets the font of the selection to Helvetica: 
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyDirectObject<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cProperty<TR>
<TD>  keyAEContainer<TD>  typeObjectSpecifier<TD>  (see indented record)<TR>
<TD>    keyAEDesiredClass<TD>    typeType<TD>    cProperty<TR>
<TD>    keyAEContainer<TD>    typeNull<TD>  No data<TR>
<TD>    keyAEKeyForm<TD>    typeEnumerated<TD>    formPropertyID<TR>
<TD>    keyAEKeyData<TD>    typeLongInteger<TD>    pSelection<TR>
<TD>  keyAEKeyForm<TD>  typeEnumerated<TD>  formPropertyID<TR>
<TD>  keyAEKeyData<TD>  typeType<TD>  pFont<TR>
<TD>keyAEData<TD>typeChar<TD>"Helvetica"</TABLE>
<P>
</UL>
 After these three events are sent, word 34 remains selected. Thus, subsequent user actions upon the same selection do not require your application to send an additional event to set the selection. Your application should maintain the selection as long as the selected text is not replaced. If the user types or pastes new text into the selection, your application should place the insertion point after the new text. <P>
 Such a strategy might result in a series of events like these:<P>
<UL>
<LI>A Set Data event with these parameters sets the contents of a selection to "More new text":
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyDirectObject<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cProperty<TR>
<TD>  keyAEContainer<TD>  typeObjectSpecifier<TD>  (see indented record)<TR>
<TD>    keyAEDesiredClass<TD>    typeType<TD>    cProperty<TR>
<TD>    keyAEContainer<TD>    typeNull<TD>  No data<TR>
<TD>    keyAEKeyForm<TD>    typeEnumerated<TD>    formPropertyID<TR>
<TD>    keyAEKeyData<TD>    typeLongInteger<TD>    pSelection<TR>
<TD>  keyAEKeyForm<TD>  typeEnumerated<TD>  formPropertyID<TR>
<TD>  keyAEKeyData<TD>  typeType<TD>  pContents<TR>
<TD>keyAEData<TD>typeChar<TD>"More new text"</TABLE>

<LI>Two Paste events paste the contents of the Clipboard twice after the new text. <A NAME=MARKER-2-144></A><P>
</UL>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-324.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-326.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
