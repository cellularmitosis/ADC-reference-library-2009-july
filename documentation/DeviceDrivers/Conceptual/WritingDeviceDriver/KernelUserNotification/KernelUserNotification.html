<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>I/O Kit Device Driver Design Guidelines: Kernel-User Notification</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Kernel-User Notification"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30000699" title="Kernel-User Notification"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../HardwareDrivers/index.html#//apple_ref/doc/uid/TP30000440-TP40003576" target="_top">Hardware &amp; Drivers</a> &gt; <a href="../Introduction/Intro.html#//apple_ref/doc/uid/TP40002799-TPXREF101">I/O Kit Device Driver Design Guidelines</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../MakingHWAccessible/MakingHWAccessible.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../InternationalizingDrivers/InternationalizingDrivers.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP30000699-BAJIIAGJ" title="Kernel-User Notification"></a><h1>Kernel-User Notification</h1><div class="importantbox"><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_78" title="Important:"></a><p><strong>Important:</strong>&nbsp;The Kernel-User Notification Center APIs are not available to KEXTs that declare dependencies on the sustainable kernel programming interfaces (KPIs) introduced in Mac OS X v10.4. However, if your driver currently uses the KUNC APIs and you have not revised it to depend on KPIs, your driver will still work. See <span class="content_text"><a href="../../../../Darwin/Conceptual/KEXTConcept/KEXTConceptDependencies/kext_dependencies.html#//apple_ref/doc/uid/20002370" target="_top">Kernel Extension Dependencies</a></span> for more information on KPIs and which KEXTs should declare dependencies on them. </p><p></p></div><p><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_517"></a><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_518"></a>Once<a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_519"></a> in a while a driver—or for that matter any type of kernel extension—may need to communicate some information to the user. In some circumstances, it might even have to prompt the user to choose among two or more alternatives. For example, a USB driver might gently remind the user that, next time, she should dismount a volume before physically disconnecting it. Or a mass storage driver might ask a user if he’s really sure he wants to reinitialize the device, giving him an option to cancel the operation.</p><p>For these situations you can use the Kernel-User Notification Center (KUNC<a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_520"></a>). The APIs of the KUNC facility enable you to do the following:</p><ul class="ul"><li class="li"><p>Put up a non-blocking notification dialog.</p><p>These notifications are strictly informative and permit the calling code to return immediately. Clicking the sole button (entitled “OK”) merely closes the dialog.</p></li><li class="li"><p>Present a blocking notification dialog.</p><p>In this instance, the dialog has two or more buttons, each offering the user a different choice. Your driver blocks until the user clicks a button, and then responds in a manner appropriate to the button clicked.</p></li><li class="li"><p>Launch a user-space program or open a preferences pane (System Preferences application).</p><p>You can use this API to allow the user to install items or configure your driver.</p></li><li class="li"><p>Load a more sophisticated user interface from a bundle<a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_521"></a>.</p><p>The bundle<a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_522"></a> is typically the driver’s kernel extension and the item loaded is an XML property list. This alternative allows elements such as pop-up lists, radio buttons, and text fields, as well as button titles and a customizable message. Because the information displayed is stored in a bundle, it can be localized.</p></li></ul><p>The KUNC APIs should be used sparingly. You should send notifications<a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_523"></a> to user space only when it is essential that the user knows about or reacts to a particular situation related to hardware. For example, a mass media driver should <em>not</em> put up a notification dialog when it encounters a bad block. However, if the user mounts an encrypted disk, the driver should provide some user interface enabling the user to unlock the disk.</p><p>Of course, any communication carried out through the KUNC facility can only be initiated by a kernel extension. If you have a user program that needs to communicate with a driver, you must use a suitable alternative, such as an Apple-provided device interface, a custom user client, POSIX I/O calls, or I/O Registry properties.</p><p>The KUNC APIs are defined in <code>Kernel.framework/Headers/UserNotification/</code>.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="KernelUserNotification.html#//apple_ref/doc/uid/TP30000699-BAJCBGAF">Presenting Notification Dialogs</a>
				
			<br/>
			
        
			
			
				<a href="KernelUserNotification.html#//apple_ref/doc/uid/TP30000699-TPXREF101">Launching User-Space Executables</a>
				
			<br/>
			
        
			
			
				<a href="KernelUserNotification.html#//apple_ref/doc/uid/TP30000699-TPXREF102">Presenting Bundled Dialogs</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP30000699-BAJCBGAF" title="Presenting Notification Dialogs"></a><h2>Presenting Notification Dialogs</h2><p><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_524"></a><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_525"></a>For the simpler forms of notification, the <a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_526"></a><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_527"></a>KUNC APIs provide a function that displays a notice dialog (<code><!--a-->KUNCNotificationDisplayNotice<!--/a--></code>) and a function that displays an alert dialog (<code><!--a-->KUNCNotificationDisplayAlert<!--/a--></code>). The distinction between a notice and an alert is straightforward:</p><ul class="ul"><li class="li"><p>A <a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_528"></a>notice (<span class="content_text"><a href="KernelUserNotification.html#//apple_ref/doc/uid/TP30000699-BAJEDFJC">Figure 5-1</a></span>) is used merely to inform the user about some situation related to hardware; because it does not require a response from the user, the calling code is not blocked. A notice has only one button or, if a time-out is used, no button. Clicking the button simply dismisses the dialog. </p></li><li class="li"><p>An <a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_529"></a>alert (<span class="content_text"><a href="KernelUserNotification.html#//apple_ref/doc/uid/TP30000699-BAJCBIBA">Figure 5-2</a></span>) not only tells the user about some event related to hardware, but requests the user to make a choice among two or three alternatives related to that event. The code calling the KUNC alert function blocks until the user clicks one of the buttons to indicate a choice; it then must interpret which button was clicked and act appropriately. You can specify a time-out period, and if the period expires without the user making a choice, KUNC closes the dialog and returns the default action (associated with the blinking button).</p></li></ul><br/><div><a name="//apple_ref/doc/uid/TP30000699-BAJEDFJC" title="Figure 5-1A KUNC notice"></a><p><strong>Figure 5-1&nbsp;&nbsp;</strong>A KUNC notice</p><img src = "../Art/kuncnotice.gif" alt = "A KUNC notice" width="346" height="134"></div><br/><br/><div><a name="//apple_ref/doc/uid/TP30000699-BAJCBIBA" title="Figure 5-2A KUNC alert"></a><p><strong>Figure 5-2&nbsp;&nbsp;</strong>A KUNC alert</p><img src = "../Art/kuncalert.gif" alt = "A KUNC alert" width="394" height="151"></div><br/><p><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_530"></a>The <code><!--a-->KUNCUserNotificationDisplayNotice<!--/a--></code> and <code><!--a-->KUNCUserNotificationDisplayAlert<!--/a--></code><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_531"></a> functions have similar signatures, the latter’s parameter list being a superset of the former’s. <span class="content_text"><a href="KernelUserNotification.html#//apple_ref/doc/uid/TP30000699-BAJJIACC">Listing 5-1</a></span> shows the prototype for <code><!--a-->KUNCUserNotificationDisplayNotice<!--/a--></code>.</p><a name="//apple_ref/doc/uid/TP30000699-BAJJIACC" title="Listing 5-1Definition of KUNCUserNotificationDisplayNotice"></a><p class="codesample"><strong>Listing 5-1&nbsp;&nbsp;</strong>Definition of KUNCUserNotificationDisplayNotice</p><div class="codesample"><table><tr><td scope="row"><pre>kern_return_t<span></span></pre></td></tr><tr><td scope="row"><pre>KUNCUserNotificationDisplayNotice(<span></span></pre></td></tr><tr><td scope="row"><pre>    int     timeout,<span></span></pre></td></tr><tr><td scope="row"><pre>    unsigned    flags,<span></span></pre></td></tr><tr><td scope="row"><pre>    char        *iconPath,<span></span></pre></td></tr><tr><td scope="row"><pre>    char        *soundPath,<span></span></pre></td></tr><tr><td scope="row"><pre>    char        *localizationPath,<span></span></pre></td></tr><tr><td scope="row"><pre>    char        *alertHeader,<span></span></pre></td></tr><tr><td scope="row"><pre>    char        *alertMessage,<span></span></pre></td></tr><tr><td scope="row"><pre>    char        *defaultButtonTitle);<span></span></pre></td></tr></table></div><p><span class="content_text"><a href="KernelUserNotification.html#//apple_ref/doc/uid/TP30000699-BAJEDGDD">Table 5-1</a></span> describes<a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_532"></a> the parameters of this function.</p><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_533"></a><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_534"></a><a name="//apple_ref/doc/uid/TP30000699-BAJEDGDD" title="Table 5-1Parameters of the KUNCUserNotificationDisplayNotice function"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 5-1&nbsp;&nbsp;</strong>Parameters of the KUNCUserNotificationDisplayNotice function</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Parameter</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th></tr><tr><td  scope="row"><p><em>timeout</em></p></td><td ><p>Seconds to elapse before KUNC dismisses the dialog (and the user doesn’t click the default button). If zero is specified, the dialog is not automatically dismissed.</p></td></tr><tr><td  scope="row"><p><em>flags</em></p></td><td ><p>Flags that represent the alert level (stop, note, caution, or plain), and that indicate whether no default button should appear. These flags can be OR’d together. Check the constants defined in Core Foundation’s CFUserNotification for the constants to use.</p></td></tr><tr><td  scope="row"><p><em>iconPath</em></p></td><td ><p>File-system location of a file containing an ICNS or TIFF icon to display with the message text. Specify an absolute path or <code>NULL</code> if there is no icon file. </p></td></tr><tr><td  scope="row"><p><em>soundPath</em></p></td><td ><p>File-system location of a file containing a sound to play when the dialog is displayed. Sounds in AIFF, WAV, and NeXT ".snd" formats are supported. Specify an absolute path or <code>NULL</code> if there is no icon file. (Currently unimplemented.able</p></td></tr><tr><td  scope="row"><p><em>localizationPath</em></p></td><td ><p>File-system location of a bundle<a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_535"></a> containing a <code>Localizable.strings</code> file as a localized resource. If this is the case, the text and titles specified for the dialog are keys to the localized strings in this file. Specify an absolute path or <code>NULL</code> if there is no <code>Localizable.strings</code> file. </p></td></tr><tr><td  scope="row"><p><em>alertHeader</em></p></td><td ><p>The heading for the dialog.</p></td></tr><tr><td  scope="row"><p><em>alertMessage</em></p></td><td ><p>The message of the dialog.</p></td></tr><tr><td  scope="row"><p><em>defaultButtonTitle</em></p></td><td ><p>The title of the default button (the only button in this dialog). The conventional title “OK” is suitable for most situations.</p></td></tr></table></div><p><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_536"></a>The <code><!--a-->KUNCUserNotificationDisplayAlert<!--/a--></code> function appends three more parameters (<span class="content_text"><a href="KernelUserNotification.html#//apple_ref/doc/uid/TP30000699-BAJCGFBJ">Table 5-2</a></span>).</p><a name="//apple_ref/doc/uid/TP30000699-BAJCGFBJ" title="Table 5-2Additional parameters of KUNCUserNotificationDisplayAlert"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 5-2&nbsp;&nbsp;</strong>Additional parameters of KUNCUserNotificationDisplayAlert</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Parameter</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th></tr><tr><td  scope="row"><p><em>alternateButtonTitle</em></p></td><td ><p>The title of the alternative button (for example, “Cancel”).</p></td></tr><tr><td  scope="row"><p><em>otherButtonTitle</em></p></td><td ><p>The title of a third button.</p></td></tr><tr><td  scope="row"><p><em>responseFlags</em></p></td><td ><p>A constant representing the button clicked: <code><!--a  -->kKUNCDefaultResponse<!--/a--></code>, <code><!--a  -->kKUNCAlternateResponse<!--/a--></code>, <code><!--a  -->kKUNCOtherResponse<!--/a--></code>, <code><!--a  -->kKUNCCancelResponse<!--/a--></code>. </p></td></tr></table></div><p><span class="content_text"><a href="KernelUserNotification.html#//apple_ref/doc/uid/TP30000699-BAJHFJJE">Listing 5-2</a></span> illustrates how you might call <code><!--a-->KUNCUserNotificationDisplayAlert<!--/a--></code> and (trivially) interpret the response. If the <code>kern_return_t</code> return value is not <code>KERN_SUCCESS</code>, then the call failed for some reason; you can print a string describing the reason with the <code><!--a-->mach_error_string<!--/a--></code> function.</p><a name="//apple_ref/doc/uid/TP30000699-BAJHFJJE" title="Listing 5-2Calling KUNCUserNotificationDisplayAlert"></a><p class="codesample"><strong>Listing 5-2&nbsp;&nbsp;</strong>Calling KUNCUserNotificationDisplayAlert</p><div class="codesample"><table><tr><td scope="row"><pre>kern_return_t ret;<span></span></pre></td></tr><tr><td scope="row"><pre>unsigned int rf;<span></span></pre></td></tr><tr><td scope="row"><pre>ret = KUNCUserNotificationDisplayAlert(<span></span></pre></td></tr><tr><td scope="row"><pre>    10,<span></span></pre></td></tr><tr><td scope="row"><pre>    0,<span></span></pre></td></tr><tr><td scope="row"><pre>    NULL,<span></span></pre></td></tr><tr><td scope="row"><pre>    NULL,<span></span></pre></td></tr><tr><td scope="row"><pre>    NULL,<span></span></pre></td></tr><tr><td scope="row"><pre>    "Something's Gone Terribly Wrong!",<span></span></pre></td></tr><tr><td scope="row"><pre>    "Do you want to do anything about it?",<span></span></pre></td></tr><tr><td scope="row"><pre>    "Yes",  // Default<span></span></pre></td></tr><tr><td scope="row"><pre>    "No", // Alternative<span></span></pre></td></tr><tr><td scope="row"><pre>    "Think About It", // Other<span></span></pre></td></tr><tr><td scope="row"><pre>    &amp;rf);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    if (ret == KERN_SUCCESS) {<span></span></pre></td></tr><tr><td scope="row"><pre>        if (rf == kKUNCDefaultResponse)<span></span></pre></td></tr><tr><td scope="row"><pre>            IOLog("Default button clicked");<span></span></pre></td></tr><tr><td scope="row"><pre>        else if (rf == kKUNCAlternateResponse)<span></span></pre></td></tr><tr><td scope="row"><pre>            IOLog("Alternate button clicked");<span></span></pre></td></tr><tr><td scope="row"><pre>        else if (rf == kKUNCOtherResponse)<span></span></pre></td></tr><tr><td scope="row"><pre>            IOLog("Other button clicked");<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP30000699-TPXREF101" title="Launching User-Space Executables"></a><h2>Launching User-Space Executables</h2><p><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_537"></a><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_538"></a><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_539"></a><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_540"></a><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_541"></a><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_542"></a>Your kernel code can use the Kernel-User Notification Center to launch applications. You can thereby engage the user’s involvement in complex installation, configuration, and other tasks related to a driver or other kernel extension. You can use KUNC not only to launch applications, but to present preference panes and run daemons or other (non-GUI) tools. </p><p>The KUNC function that you call to launch an application is <code><!--a-->KUNCExecute<!--/a--></code><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_543"></a>. This function takes three parameters:</p><ul class="ul"><li class="li"><p><strong>Path to executable</strong> (<em>executionPath</em>). The file-system path to the application or other executable. The form of the path is indicated by the third parameter (<em>pathExecutionType</em>).</p><div class="importantbox"><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_79" title="Important:"></a><p><strong>Important:</strong>&nbsp;In upcoming versions of Darwin and Mac OS X, you will be able to specify an application’s bundle identifier (<code>CFBundleIdentifier</code>) for this parameter. This will be the preferred method for identifying applications to launch.</p><p></p></div></li><li class="li"><p><strong>User authorization</strong> (<em>openAsUser</em>). The user-authorization level given the launched application. It can be either as the logged-in user (<code><!--a  -->kOpenAppAsConsoleUser<!--/a--></code>) or as root (<code><!--a  -->kOpenAppAsRoot<!--/a--></code>). Root-user access permits tasks such as copying to <code>/System/Library</code> without the need to authenticate; you should use root-user access judiciously. </p></li><li class="li"><p><strong>Type of executable path</strong> (<em>pathExecutionType</em>). The form of the executable path specified in the first parameter (<em>executionPath</em>). The parameter must be one of the following constants: </p><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Constant</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th></tr><tr><td  scope="row"><p><code><!--a  -->kOpenApplicationPath<!--/a--></code></p></td><td ><p>The absolute path to the executable. For an application, this is the binary in the application bundle’s <code>MacOS</code> directory (for example, <code>/Applications/Foo.app/Contents/MacOS/Foo</code>).</p></td></tr><tr><td  scope="row"><p><code><!--a  -->kOpenPreferencePanel<!--/a--></code></p></td><td ><p>The name of a preference pane in <code>/System/Library/PreferencePanes</code> (for example, <code>ColorSync.prefPane</code>).</p></td></tr><tr><td  scope="row"><p><code><!--a  -->kOpenApplication<!--/a--></code></p></td><td ><p>The name of an application (minus the .<code>app</code>) in any of the system locations for applications: <code>/Applications</code>, <code>/Network/Applications</code>, or <code>~/Applications</code>.</p></td></tr></table></div><div class="importantbox"><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_80" title="Important:"></a><p><strong>Important:</strong>&nbsp;Future versions of the Kernel-User Notification Center will include a constant to indicate that an application’s bundle identifier is being used in <em>executionPath</em>.</p><p></p></div></li></ul><p>The code shown in <span class="content_text"><a href="KernelUserNotification.html#//apple_ref/doc/uid/TP30000699-BAJFDIDA">Listing 5-3</a></span> launches the Text Edit application and opens the Internet preferences pane.</p><a name="//apple_ref/doc/uid/TP30000699-BAJFDIDA" title="Listing 5-3Launching applications from a KEXT"></a><p class="codesample"><strong>Listing 5-3&nbsp;&nbsp;</strong>Launching applications from a KEXT</p><div class="codesample"><table><tr><td scope="row"><pre>kern_return_t ret;<span></span></pre></td></tr><tr><td scope="row"><pre>ret = KUNCExecute("/Applications/TextEdit.app/Contents/MacOS/TextEdit", kOpenAppAsRoot, kOpenApplicationPath);<span></span></pre></td></tr><tr><td scope="row"><pre>ret = KUNCExecute("Internet.prefPane", kOpenAppAsConsoleUser, kOpenPreferencePanel);<span></span></pre></td></tr></table></div><p>It’s usually a good idea to put up a notice (function <code><!--a-->KUNCUserNotificationDisplayNotice<!--/a--></code>) at the same time you launch an application or open a preference pane to inform users what they need to do with the application or preference pane.<a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_544"></a></p><a name="//apple_ref/doc/uid/TP30000699-TPXREF102" title="Presenting Bundled Dialogs"></a><h2>Presenting Bundled Dialogs</h2><p><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_545"></a><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_546"></a>The dialogs created through the <code><!--a-->KUNCUserNotificationDisplayNotice<!--/a--></code> and <code><!--a-->KUNCUserNotificationDisplayAlert<!--/a--></code> functions have a limited collection of user-interface elements to present to users. Apart from the header, icon, and message, they permit up to three buttons, and that’s it. The only information they can elicit is the choice made through the click of a button.</p><p>The <code><!--a-->KUNCUserNotificationDisplayFromBundle<!--/a--></code><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_547"></a> function, however, enables you to present a much richer set of user-interface controls and to gather more information from the user. The elements that you can have on a bundled dialog include the following:</p><ul class="ul"><li class="li"><p>Header, message text, sound, and icon</p></li><li class="li"><p>Up to three buttons (default, alternative, other)</p></li><li class="li"><p>Text fields, including password fields</p></li><li class="li"><p>Pop-up lists</p></li><li class="li"><p>Check boxes</p></li><li class="li"><p>Radio buttons</p></li></ul><p>Your kernel extension can obtain the selections that users make and any text that they type and process this information accordingly.</p><p><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_548"></a>The controls and behavior of these kernel-user notification dialogs<a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_549"></a> are captured as XML descriptions stored in a file within a bundle (typically the KEXT bundle itself). By virtue of being bundled, the XML descriptions are localizable. You can also update them without the need for a recompile. The XML file can be named anything. It consists of an arbitrary number of dictionary elements, one each for a dialog that the kernel extension might present. Each dialog description itself is a dictionary whose keys can be any of those described in <span class="content_text"><a href="KernelUserNotification.html#//apple_ref/doc/uid/TP30000699-BAJEFJDF">Table 5-3</a></span><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_550"></a>.</p><a name="//apple_ref/doc/uid/TP30000699-BAJEFJDF" title="Table 5-3KUNC XML notification dialog properties"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 5-3&nbsp;&nbsp;</strong>KUNC XML notification dialog properties</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Key</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Type</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th></tr><tr><td  scope="row"><p>Header</p></td><td ><p>string</p></td><td ><p>The title of the dialog.</p></td></tr><tr><td  scope="row"><p>Message</p></td><td ><p>string</p></td><td ><p>Text of the message in the dialog. The text can include “%@” placeholders that, when the bundle is loaded, are replaced by “@”-delimited substrings in the <em>tokenString</em> parameter of the function <code><!--a-->KUNCUserNotificationDisplayFromBundle<!--/a--></code>. See <span class="content_text"><a href="KernelUserNotification.html#//apple_ref/doc/uid/TP30000699-BAJEAAHI">Table 5-4</a></span> for this and other parameters.</p></td></tr><tr><td  scope="row"><p>OK Button Title</p></td><td ><p>string</p></td><td ><p>The title of the default button of the dialog (usually entitled “OK”). This button is the one closest to the right edge of the dialog.</p></td></tr><tr><td  scope="row"><p>Alternate Button Title</p></td><td ><p>string</p></td><td ><p>The title of the alternate button of the dialog (often entitled “Cancel”). This button is the one closest to the left edge of the dialog.</p></td></tr><tr><td  scope="row"><p>Other Button Title</p></td><td ><p>string</p></td><td ><p>The title of the third allowable button, which is placed between the other two buttons.</p></td></tr><tr><td  scope="row"><p>Icon URL</p></td><td ><p>string</p></td><td ><p>An absolute POSIX path identifying a file containing a TIFF or ICNS image to display next to the message text. </p></td></tr><tr><td  scope="row"><p>Sound URL</p></td><td ><p>string</p></td><td ><p>An absolute POSIX path identifying a file containing a sound to play when the dialog is displayed. Sounds in AIFF, WAV, and NeXT ".snd" formats are supported. (Currently unimplemented.)</p></td></tr><tr><td  scope="row"><p>Localization URL</p></td><td ><p>string</p></td><td ><p>An absolute POSIX path identifying a bundle containing a <code>Localizable.strings</code> file from which to retrieve localized text. If this property is specified, all text-related values in the XML description are assumed to be keys to items in <code>Localizable.strings</code>.</p></td></tr><tr><td  scope="row"><p>Timeout</p></td><td ><p>string </p></td><td ><p>A number indicating the number of seconds before the dialog is automatically dismissed. If zero is specified, the dialog will not time out.</p></td></tr><tr><td  scope="row"><p>Alert Level</p></td><td ><p>string</p></td><td ><p>Takes “Stop”, “Notice”, or “Alert” to identify the severity of the alert. Each alert level has an icon associated with it. If you don’t specify an alert level, “Notice” becomes the default. </p></td></tr><tr><td  scope="row"><p>Blocking Message</p></td><td ><p>string</p></td><td ><p>Either “0” or “1”. If “1”, the dialog has no buttons regardless of any specified.</p></td></tr><tr><td  scope="row"><p>Text Field Strings</p></td><td ><p>array of strings</p></td><td ><p>A list of labels to display just above the text fields they identify. See <span class="content_text"><a href="KernelUserNotification.html#//apple_ref/doc/uid/TP30000699-BAJCDDHH">Figure 5-3</a></span> to see the size and placement of these fields.</p></td></tr><tr><td  scope="row"><p>Password Fields</p></td><td ><p>array of strings</p></td><td ><p>One or more numbers identifying which of the text fields (which must also be specified) is a password field. In other words, each number is an index into the array of text fields. A password field displays “•” for each character typed in it.</p></td></tr><tr><td  scope="row"><p>Popup Button Strings </p></td><td ><p>array of strings</p></td><td ><p>A list of the titles for each element in a popup button.</p></td></tr><tr><td  scope="row"><p>Selected Popup</p></td><td ><p>string</p></td><td ><p>A number (index) identifying the element to display in the popup button. If this is not specified, the first element is displayed.</p></td></tr><tr><td  scope="row"><p>Radio Button Strings</p></td><td ><p>array of strings</p></td><td ><p>A list of the titles for each radio button to display. The radio buttons are aligned vertically. Only a single button can be selected.</p></td></tr><tr><td  scope="row"><p>Selected Radio</p></td><td ><p>string</p></td><td ><p>A number (index) identifying the radio button to show as selected.</p></td></tr><tr><td  scope="row"><p>Check Box Strings</p></td><td ><p>array of strings</p></td><td ><p>A list of the titles for each check box to display. The check boxes are aligned vertically. Multiple checkboxes can be selected.</p></td></tr><tr><td  scope="row"><p>Checked Boxes</p></td><td ><p>array of strings</p></td><td ><p>A number (index) identifying the check box (or check boxes) that are selected.</p></td></tr></table></div><p>As indicated in the description of the <code>Localization URL</code> property above, you can access localized text in two ways. You can have localized versions of the XML description file itself. Or you can have a single XML description file and a <code>Localizable.strings</code> file for each localization. In the latter case, the <code>Localization URL</code> property points to the bundle<a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_551"></a> containing the <code>Localizable.strings</code> files and the values of textual properties in the XML description file are keys into <code>Localizable.strings</code>.<a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_552"></a><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_553"></a></p><p><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_554"></a>A welcome aspect of the bundled-notifications feature of KUNC is that it is asynchronous. When you call the <code><!--a-->KUNCUserNotificationDisplayFromBundle<!--/a--></code> function to request a dialog, the call returns immediately. Your code can go on to do other things. KUNC handles delivery of the request to user space, where the dialog is constructed and displayed. Throughout its journey, the request is identified by a notification ID that you supplied to <code><!--a-->KUNCUserNotificationDisplayFromBundle<!--/a--></code>. When a user clicks one of the dialog buttons, a callback function implemented in your KEXT is invoked. There you can identify the request through its notification ID and handle the user’s response. </p><p><span class="content_text"><a href="KernelUserNotification.html#//apple_ref/doc/uid/TP30000699-BAJJADBA">Listing 5-4</a></span> shows the signature of the <code><!--a-->KUNCUserNotificationDisplayFromBundle<!--/a--></code> function.</p><a name="//apple_ref/doc/uid/TP30000699-BAJJADBA" title="Listing 5-4Declaration of KUNCUserNotificationDisplayFromBundle"></a><p class="codesample"><strong>Listing 5-4&nbsp;&nbsp;</strong>Declaration of <code>KUNCUserNotificationDisplayFromBundle</code></p><div class="codesample"><table><tr><td scope="row"><pre>kern_return_t<span></span></pre></td></tr><tr><td scope="row"><pre>KUNCUserNotificationDisplayFromBundle(<span></span></pre></td></tr><tr><td scope="row"><pre>    KUNCUserNotificationID      notificationID,<span></span></pre></td></tr><tr><td scope="row"><pre>    char                        *bundleIdentifier,<span></span></pre></td></tr><tr><td scope="row"><pre>    char                        *fileName,<span></span></pre></td></tr><tr><td scope="row"><pre>    char                        *fileExtension,<span></span></pre></td></tr><tr><td scope="row"><pre>    char                        *messageKey,<span></span></pre></td></tr><tr><td scope="row"><pre>    char                        *tokenString,<span></span></pre></td></tr><tr><td scope="row"><pre>    KUNCUserNotificationCallBackcallback,<span></span></pre></td></tr><tr><td scope="row"><pre>    int                         contextKey);<span></span></pre></td></tr></table></div><p><span class="content_text"><a href="KernelUserNotification.html#//apple_ref/doc/uid/TP30000699-BAJEAAHI">Table 5-4</a></span> describes the parameters of this function.</p><a name="//apple_ref/doc/uid/TP30000699-BAJEAAHI" title="Table 5-4Parameters of KUNCUserNotificationDisplayFromBundle"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 5-4&nbsp;&nbsp;</strong>Parameters of <code>KUNCUserNotificationDisplayFromBundle</code></caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Parameter</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th></tr><tr><td  scope="row"><p><em>notificationID</em></p></td><td ><p>A value of type <code>KUNCUserNotificationID</code> that identifies the dialog request. You obtain this value through the <code><!--a-->KUNCGetNotificationID<!--/a--></code> function.</p></td></tr><tr><td  scope="row"><p><em>bundleIdentifier</em></p></td><td ><p>The location (specified as an absolute path) of the bundle containing the file with the XML descriptions of notification dialogs. An example of such a path might be “/System/Library/Extensions/MyDriver.kext”.</p><p>Upcoming versions of KUNC will permit the specification of the bundle’s <code>CFBundleIdentifier</code> instead; this will be the preferred way to identify bundles.</p></td></tr><tr><td  scope="row"><p><em>fileName</em></p></td><td ><p>The name of the file from which to retrieve the XML descriptions of dialogs. This name should omit the file’s extension.</p></td></tr><tr><td  scope="row"><p><em>fileExtension</em></p></td><td ><p>The extension of the XML file, minus the period; this can be anything, such as “dict” or “xml”.</p></td></tr><tr><td  scope="row"><p><em>messageKey</em></p></td><td ><p>Name of the XML key identifying the dialog description you want to have KUNC retrieve from the file.</p></td></tr><tr><td  scope="row"><p><em>tokenString</em></p></td><td ><p>A string that can contain one or more token substrings. Each substring, which is separated from adjacent substrings by the “@” character, is substituted in turn for each “%@” placeholder in the message text of the dialog (XML key “Message”). </p><p>Here is an example: if the message text is “Access denied after %@ attempts to access account %@.” and the token string is “4@jdoe”, the displayed string is “Access denied after 4 attempts to access account jdoe.”</p></td></tr><tr><td  scope="row"><p><em>callback</em></p></td><td ><p>The callback function that is invoked when the user clicks one of the buttons of the dialog. The function must conform to the <code>KUNCUserNotificationCallback</code> prototype.</p></td></tr><tr><td  scope="row"><p><em>contextKey</em></p></td><td ><p>Any context information you wish to provide to help your kernel extension identify the notification request (in addition to the notification ID).</p></td></tr></table></div><p>T<a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_555"></a>he final step in implementing bundled notifications for your kernel extension is to implement a callback function to handle user responses. This function must conform to the <code>KUNCUserNotificationCallback</code> prototype:</p><div class="codesample"><table><tr><td scope="row"><pre>typedef void (*KUNCUserNotificationCallBack)(<span></span></pre></td></tr><tr><td scope="row"><pre>    int     contextKey,<span></span></pre></td></tr><tr><td scope="row"><pre>    int     responseFlags,<span></span></pre></td></tr><tr><td scope="row"><pre>    void    *xmlData);<span></span></pre></td></tr></table></div><p>A couple of the parameters may seem familiar. The <em>contextKey</em> parameter is the same value you passed into the <code><!--a-->KUNCUserNotificationDisplayFromBundle<!--/a--></code> function to help identify the request. The <em>responseFlags</em> parameter holds one of the constants that identify the dialog button the user clicked; these constants are discussed in<span class="content_text"><a href="KernelUserNotification.html#//apple_ref/doc/uid/TP30000699-BAJCBGAF">“Presenting Notification Dialogs.”</a></span> What is new is the <em>xmlData</em> parameter. This is the XML string data associated with the user’s response; if the user has entered any information (such as user name and password) or has selected a popup item, radio button, or checkbox, your code should parse the XML and extract this information.</p><p>When you parse the XML, you should look for the corresponding element of the array you passed into KUNC. For example, if you have a user-name field and a password field, you have a <code>Text Field Strings</code> array with two elements. When you parse the <em>xmlData</em> parameter, the first element of <code>Text Field Strings</code> is the user name entered by the user; the second element is the password. Similarly, you parse the <code>Selected Popup</code> array to see which index into that array has been selected.</p><p>To illustrate how you might use the KUNC APIs for bundled notification dialogs, let’s step through a couple of examples. You create an XML file called <code>Messages.dict</code> and put it in your KEXT’s localized <code>.lproj</code><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_556"></a>directories. This file contains the key “Password Message”; <span class="content_text"><a href="KernelUserNotification.html#//apple_ref/doc/uid/TP30000699-BAJFEAAF">Listing 5-5</a></span> shows the associated XML description for this key.</p><a name="//apple_ref/doc/uid/TP30000699-BAJFEAAF" title="Listing 5-5XML description of a password dialog"></a><p class="codesample"><strong>Listing 5-5&nbsp;&nbsp;</strong>XML description of a password dialog</p><div class="codesample"><table><tr><td scope="row"><pre>    &lt;key>Password Message&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;dict><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>Alternate Button Title&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;string>Cancel&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>OK Button Title&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;string>OK&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>Header&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;string>Authentication Message&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>Message&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;string>Please enter a user name and password.&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>Timeout&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;string>0&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>Alert Level&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;string>Stop&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>Text Field Strings&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;array><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;string>User Name:&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;string>Password:&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;/array><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>Password Fields&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;array><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;string>1&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;/array><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>Blocking Message&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;string>1&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/dict><span></span></pre></td></tr></table></div><p>In the code of your kernel extension, you call <code><!--a-->KUNCUserNotificationDisplayFromBundle<!--/a--></code>, specifying “Password Message” as the message key (<span class="content_text"><a href="KernelUserNotification.html#//apple_ref/doc/uid/TP30000699-BAJIHDHH">Listing 5-6</a></span>).</p><a name="//apple_ref/doc/uid/TP30000699-BAJIHDHH" title="Listing 5-6Displaying the bundled password dialog"></a><p class="codesample"><strong>Listing 5-6&nbsp;&nbsp;</strong>Displaying the bundled password dialog</p><div class="codesample"><table><tr><td scope="row"><pre>context = 2;<span></span></pre></td></tr><tr><td scope="row"><pre>ret = KUNCUserNotificationDisplayFromBundle(KUNCGetNotificationID(),<span></span></pre></td></tr><tr><td scope="row"><pre>    "/tmp/ExampleDriver/ExampleDriver.kext",<span></span></pre></td></tr><tr><td scope="row"><pre>    "Messages",<span></span></pre></td></tr><tr><td scope="row"><pre>    "dict",<span></span></pre></td></tr><tr><td scope="row"><pre>    "Password Message",<span></span></pre></td></tr><tr><td scope="row"><pre>    "",<span></span></pre></td></tr><tr><td scope="row"><pre>    MyKUNCBundleCallback,<span></span></pre></td></tr><tr><td scope="row"><pre>    context);<span></span></pre></td></tr></table></div><p>When this code is executed, the dialog shown in <span class="content_text"><a href="KernelUserNotification.html#//apple_ref/doc/uid/TP30000699-BAJIHDHH">Listing 5-6</a></span> appears on the user’s screen, as in <span class="content_text"><a href="KernelUserNotification.html#//apple_ref/doc/uid/TP30000699-BAJCDDHH">Figure 5-3</a></span>.<a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_557"></a></p><br/><div><a name="//apple_ref/doc/uid/TP30000699-BAJCDDHH" title="Figure 5-3The password dialog"></a><p><strong>Figure 5-3&nbsp;&nbsp;</strong>The password dialog</p><img src = "../Art/kuncbundledpassworddialog.gif" alt = "The password dialog" width="356" height="220"></div><br/><p>Of course, you can have even more complicated dialogs with a mix of user-interface elements. <span class="content_text"><a href="KernelUserNotification.html#//apple_ref/doc/uid/TP30000699-BAJJIGID">Listing 5-7</a></span> shows the XML description of a dialog that includes text and password fields and radio buttons.</p><a name="//apple_ref/doc/uid/TP30000699-BAJJIGID" title="Listing 5-7XML description of a dialog with various controls"></a><p class="codesample"><strong>Listing 5-7&nbsp;&nbsp;</strong>XML description of a dialog with various controls</p><div class="codesample"><table><tr><td scope="row"><pre>    &lt;key>Mixed Message&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;dict><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>OK Button Title&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;string>OK&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>Header&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;string>Authorization&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>Message&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;string>Please log in at required level.&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>Timeout&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;string>20&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>Alert Level&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;string>Stop&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>Text Field Strings&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;array><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;string>User Name:&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;string>Password:&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;/array><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>Password Fields&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;array><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;string>1&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;/array><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>Radio Button Strings&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;array><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;string>User&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;string>Local Admin&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;string>Network Admin&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;/array><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>Selected Radio&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;string>1&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/dict><span></span></pre></td></tr></table></div><p>When your loaded kernel extension calls the <code><!--a-->KUNCUserNotificationDisplayFromBundle<!--/a--></code> function, supply this time “Mixed Message” as the XML dictionary key, the dialog shown in <span class="content_text"><a href="KernelUserNotification.html#//apple_ref/doc/uid/TP30000699-BAJHGCAI">Figure 5-4</a></span> appears on the user’s screen.<a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_558"></a><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_559"></a><a name="//apple_ref/doc/uid/TP30000699-DontLinkElementID_560"></a></p><br/><div><a name="//apple_ref/doc/uid/TP30000699-BAJHGCAI" title="Figure 5-4Display of a mixed control dialog"></a><p><strong>Figure 5-4&nbsp;&nbsp;</strong>Display of a mixed control dialog</p><img src = "../Art/kuncbundledmixedcontrols.gif" alt = "Display of a mixed control dialog" width="355" height="277"></div><br/>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../MakingHWAccessible/MakingHWAccessible.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../InternationalizingDrivers/InternationalizingDrivers.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2002, 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-03-06<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/DeviceDrivers/Conceptual/WritingDeviceDriver/KernelUserNotification/KernelUserNotification.html%3Fid%3DTP30000694-2.13&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/DeviceDrivers/Conceptual/WritingDeviceDriver/KernelUserNotification/KernelUserNotification.html%3Fid%3DTP30000694-2.13&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/DeviceDrivers/Conceptual/WritingDeviceDriver/KernelUserNotification/KernelUserNotification.html%3Fid%3DTP30000694-2.13&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>