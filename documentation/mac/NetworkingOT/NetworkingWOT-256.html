<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>OTOptionManagement</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING256></A>
<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->

<!-- Main Body -->

<CENTER>
<P>
<A HREF="NetworkingWOT-255.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="NetworkingWOT-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="NetworkingWOT-491.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A>  <A HREF="NetworkingWOT-257.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html"><B>Inside Macintosh:</B></A> <A HREF="NetworkingWOT-2.html"><B>Networking With Open Transport </B></A> / <A HREF="NetworkingWOT-81.html"><B>Part 2 - Open Transport Reference</B></A><BR><DD><A HREF="NetworkingWOT-243.html"><B>Chapter 25 - Option Management Reference</B></A> / <A HREF="NetworkingWOT-254.html"><B>Functions</B></A><BR><DL><DD><A HREF="NetworkingWOT-255.html"><B>Determining and Changing Function Values</B></A> / </DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING256-0></A>
<H3><A NAME=MARKER-9-86></A>OTOptionManagement</H3>
 Determines an endpoint's current or default option values or changes <BR>these values.<P>
<A NAME=HEADING256-2></A>
<H5>C INTERFACE </H5>
<PRE>
<A NAME=MARKER-13-14></A>OSStatus OTOptionManagement(EndpointRef ref, TOptMgmt* req, 
                                         TOptMgmt* ret);
</PRE>
<A NAME=HEADING256-4></A>
<H5>C++ INTERFACE </H5>
<PRE>
<A NAME=MARKER-12-88></A>OSStatus TEndpoint::OptionManagement(TOptMgmt* req, TOptMgmt* ret);
</PRE>
<A NAME=HEADING256-6></A>
<H5>PARAMETERS </H5>
<DL>
<DT><CODE>ref</CODE>
<DD>   The endpoint reference of the endpoint for which you are checking or setting option values.
<DT><CODE>req</CODE>
<DD> A pointer to an  <A HREF=NetworkingWOT-253.html#MARKER-9-81>option management structure</A>, which describes the action to be taken by the function and the options affected. 
<DT><CODE>ret</CODE>
<DD> A pointer to an e <A HREF=NetworkingWOT-253.html#MARKER-9-81>option management structur</A>, which describes the options that were changed or returned by the function and how successful the negotiation process was. 
<DT><I>function result</I>
<DD> See Discussion.
</DL>
<A NAME=HEADING256-11></A>
<H5>DISCUSSION</H5>
 To use the <CODE>OTOptionManagement</CODE> function, you must have opened an endpoint using the<CODE> OTOpenEndpoint</CODE> or <CODE>OTAsyncOpenEndpoint</CODE> functions.<P>
 You use the <CODE>OTOptionManagement</CODE> function to negotiate, retrieve, or verify an endpoint's protocol options. If the endpoint is in synchronous mode, the endpoint will returns results of the option managment in the structure referenced by the <CODE>req</CODE> parameter. If the endpoint is in asynchronous mode, the function returns immediately with the <CODE>kOTNoError</CODE> result. When the operation completes, the endpoint calls your notifier with the <CODE>T_OPTNMGMTCOMPLETE</CODE> event code. The <CODE>cookie</CODE> parameter to the notifier will contain the value of the <CODE>ret</CODE> parameter. If you have not installed a notifier function, it is not possible to determine when the function completes. For more information on notifier functions and event codes see <A HREF=NetworkingWOT-117.html#MARKER-9-113>"Using Notifier Functions"</A> and <A HREF=NetworkingWOT-100.html#MARKER-9-22>"Event Codes"</A>.<P>
 The action taken by the <CODE>OTOptionManagement</CODE> function is determined by the setting of the <CODE>req-&gt;flags</CODE> field. The following bulleted items describe the different operations that you can perform and the flag settings that you use to specify these operations.<P>
<UL>
<P><LI>To negotiate values for the endpoint, you must call the <CODE>OTOptionManagement</CODE> function, specifying <CODE>T_NEGOTIATE</CODE> for the <CODE>req-&gt;flags</CODE> field. The endpoint provider evaluates the requested options, negotiates the values, and returns the resulting values in the option management structure pointed to by the <CODE>ret-&gt;opt.buf</CODE> field. The <CODE>status</CODE> field of each returned option is set to a constant that indicates the result of the negotiation. These constants are described by the status codes enumeration <A HREF=NetworkingWOT-247.html#MARKER-9-45></A>.<P>
For any protocol specified, you can negotiate for the default values of all options supported by the endpoint by specifying the value <CODE>T_ALLOPT</CODE> for the <CODE>name</CODE> field of the <CODE>TOption</CODE> structure<A HREF=NetworkingWOT-251.html#MARKER-9-72></A>. This might be useful if you want to change current settings or if negotiations for other values have failed. The success of the negotiations depends partly on the state of the endpoint--that is, simply because these are default values does not guarantee a completely successful negotiation. When the function returns, the resulting values are returned, option by option, in the buffer pointed to by the <CODE>ret-&gt;opt.buf</CODE> field.<A NAME=MARKER-13-89></A><P>
<P><LI>To retrieve an endpoint's default option values, call the <CODE>OTOptionManagement</CODE> function, specifying <CODE>T_DEFAULT</CODE> for the <CODE>req-&gt;flags</CODE> field. You must also specify the name of the option (but not its value) in the <CODE>TOption</CODE> structure that you create for each of the options you are interested in. (The option buffer should have an option header, but no value fields; the <CODE>TOption.len</CODE> field should be set to <CODE>kOTOptionHeaderSize</CODE>.) <A NAME=MARKER-13-90></A><P>
When the function returns, it passes the default values for the options back to you in the buffer pointed to by the <CODE>ret-&gt;opt.buf</CODE> field. For each option, the <CODE>status</CODE> field contains <CODE>T_NOTSUPPORT</CODE> if the protocol does not support the option, <CODE>T_READONLY</CODE> if the option is read-only, and <CODE>T_SUCCESS</CODE> in all other cases. <P>
When getting an endpoint's default option values, you can specify <CODE>T_ALLOPT</CODE> for the option name. This returns all supported options for the specified level with their default values. In this case, you must set the <CODE>opt.maxlen</CODE> field to the maximum size required to hold an endpoint's option information, which you can get from the <CODE>info.opt</CODE> field of the <CODE>TEndpointInfo</CODE><A HREF=NetworkingWOT-136.html#MARKER-9-81></A> structure.<P>
<P><LI>To retrieve an endpoint's current option values, call the <CODE>OTOptionManagement</CODE> function, specifying <CODE>T_CURRENT</CODE> for the <CODE>req-&gt;flags</CODE> field. For each option in the buffer referenced by the <CODE>req-&gt;opt.buf</CODE> field, specify the name of the option you are interested in. The function ignores any option values <BR>you specify. <P>
When the function returns, it passes the current values for the options back to you in the buffer referenced by the <CODE>ret-&gt;opt.buf</CODE> field. For each option, the <CODE>status</CODE> field contains <CODE>T_NOTSUPPORT</CODE> if the protocol does not support the option, <CODE>T_READONLY</CODE> if the option is read-only, and <CODE>T_SUCCESS</CODE> in all other cases. <P>
When retrieving an endpoint's current option values, you can specify <CODE>T_ALLOPT</CODE> for the option name. The function returns all supported options for the specified protocol, with their current values. In this case, you must set the <CODE>opt.maxlen</CODE> field to the maximum size required to hold an endpoint's option information, which you can get from the <CODE>info.opt</CODE> field of the <CODE>TEndpointInfo</CODE> structure.<A NAME=MARKER-13-91></A><P>
<P><LI>To check whether an endpoint provider supports certain options or option values, you must call the <CODE>OTOptionManagement</CODE> function, specifying <CODE>T_CHECK</CODE> for the <CODE>req-&gt;flags</CODE> field. Checking options or their values does not change the current settings of an endpoint's options.<A NAME=MARKER-13-92></A><P>
<UL>
<P><LI>To check whether an option is supported, set the <CODE>name</CODE> field of the <CODE>TOption</CODE> structure to the option name, but do not specify an option value. (The option buffer should have an option header, but no value fields; the <CODE>TOption.len</CODE> field should be set to <CODE>kOTOptionHeaderSize</CODE>.) When the function returns, the <CODE>status</CODE> field for the corresponding <CODE>TOption</CODE> structure in the buffer pointed to by the <CODE>ret-&gt;opt.buf</CODE> field is set to <CODE>T_SUCCESS</CODE> if the option is supported, <CODE>T_NOTSUPPORT</CODE> if it is not supported or needs additional client privileges, and <CODE>T_READONLY</CODE> if it is read-only. <P>
<P><LI>To check whether an option value is supported, set the <CODE>name</CODE> field of the <CODE>TOption</CODE> structure to the option name, and set the <CODE>value</CODE> field to the value you want to check. When the function returns, the <CODE>status</CODE> field for the corresponding <CODE>TOption</CODE> structure in the buffer pointed to by the <CODE>ret-&gt;opt.buf</CODE> field is set as it would be if you had specified the <CODE>T_NEGOTIATE</CODE> flag. <P>
</UL>
</UL>
 The overall result of the request for option negotiation is returned in the <CODE>ret-&gt;flags</CODE> field. The meaning of this result is described by the  <A HREF=NetworkingWOT-247.html#MARKER-9-45>status codes enumeration</A>.<P>
<A NAME=HEADING256-27></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 While an option management call is outstanding, any other functions that are called for the same endpoint return with a <CODE>kOTStateChangeErr</CODE> result.<P>
 If the endpoint is in asynchronous mode, the provider might issue the <CODE>T_OPTMGMTCOMPLETE</CODE> event before the function returns the first time.<P>
<A NAME=HEADING256-30></A>
<H5>SEE ALSO</H5>
 The format of option buffers in <A HREF=NetworkingWOT-39.html#MARKER-9-42>"Specifying Option Values"</A>.<P>
 The <A HREF=NetworkingWOT-261.html#MARKER-9-97><CODE>OTCreateOptions</CODE></A> function.<P>
 The <A HREF=NetworkingWOT-261.html#MARKER-9-97><CODE>OTCreateOptionString</CODE></A> function. <P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="NetworkingWOT-255.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="NetworkingWOT-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="NetworkingWOT-491.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A>  <A HREF="NetworkingWOT-257.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="NetworkingWOT-4.html">&copy; Apple Computer, Inc.</A><br>15 JAN 1998<P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML> 
