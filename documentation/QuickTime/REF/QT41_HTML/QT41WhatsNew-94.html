<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"><HTML><head><script language="JavaScript" src="../../frametest.js"></script><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1"><META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css"><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><!-- Link line removed --><TITLE> ExtendedSoundComponentData</TITLE><script language=javascript> window.parent.focus(); </script></HEAD><BODY BGCOLOR="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- path goes here --><!-- QTnavbar start --><P><I>Inside Macintosh: QuickTime Reference</I><P>| <A HREF="QT41WhatsNew-93.html">Previous</A> | <A HREF="QT41WhatsNew-1.html">Chapter Contents</A> | <A HREF="QT41WhatsNew.html">Chapter Top</A> | <A HREF="QT41WhatsNew-95.html">Next</A> |</P><!-- QTnavbar end --><H1 CLASS="H3-Heading3"><A NAME="pgfId-30158"></A>ExtendedSoundComponentData</H1><P CLASS="T1-Text1"><A NAME="pgfId-30159"></A>The <TT>ExtendedSoundComponentData</TT> structure is shown below.</P><TT><A NAME="pgfId-55740"></A>struct&nbsp;ExtendedSoundComponentData&nbsp;{<BR>SoundComponentData&nbsp;&nbsp;desc;&nbsp;&nbsp;/*description&nbsp;of&nbsp;sound&nbsp;buffer*/<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;long&nbsp;&nbsp;&nbsp;recordSize;&nbsp;/*size&nbsp;of&nbsp;this&nbsp;record&nbsp;in&nbsp;bytes*/<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;long&nbsp;&nbsp;&nbsp;extendedFlags;&nbsp;/*flags&nbsp;for&nbsp;extended&nbsp;record*/<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;long&nbsp;&nbsp;&nbsp;bufferSize;&nbsp;/*size&nbsp;of&nbsp;buffer&nbsp;in&nbsp;bytes*/<BR>};<BR>&nbsp;&nbsp;typedef&nbsp;struct&nbsp;ExtendedSoundComponentData&nbsp;ExtendedSoundComponentData;<BR>&nbsp;&nbsp;typedef&nbsp;ExtendedSoundComponentData&nbsp;*&nbsp;ExtendedSoundComponentDataPtr;</TT><P CLASS="T1-Text1"><A NAME="pgfId-30161"></A>Its first element is a classic <TT>SoundComponentData</TT> allowing a pointer to a <TT>SoundComponentData</TT> to also serve as a pointer to an <TT>ExtendedSoundComponentData</TT>. This means that in parts of the component API where a <TT>SoundComponentData</TT> was passed or retrieved, it is now possible to find an <TT>ExtendedSoundComponentData</TT>.</P><P CLASS="T1-Text1"><A NAME="pgfId-30162"></A>To determine if the <TT>SoundComponentData</TT> is an <TT>ExtendedSoundComponentData</TT>, you can check the following flag in the <TT>flags</TT> field of a <TT>SoundComponentData</TT>:</P><TT><A NAME="pgfId-55744"></A>kExtendedSoundData = (1 &lt;&lt; 14)</TT><P CLASS="T1-Text1"><A NAME="pgfId-30164"></A>If set, you know that the structure consists at least of the fields shown here -- namely, <TT>recordSize</TT>, <TT>extendedFlags</TT> and <TT>bufferSize</TT>. In the future, it is expected that the set of fields will be extended, so it is important to confirm that the fields you want to read are actually present. To that end, you should compare the <TT>recordSize</TT> field's value to the size of a record containing the fields you need. If the record size is smaller, then you know the fields are missing.</P><P CLASS="T1-Text1"><A NAME="pgfId-30165"></A>The <TT>bufferSize</TT> field holds the number of bytes in the buffer. This allows for cases where the number of bytes isn't derivable directly from the number of samples. In the cases where it is derivable, this information is at worst redundant. The <TT>extendedFlags</TT> holds fields relating to the interpretation of the new fields and to the interpretation of the old fields. The fields defined currently are:</P><TT><A NAME="pgfId-55748"></A>kExtendedSoundSampleCountNotValid&nbsp;=&nbsp;1L&nbsp;&lt;&lt;&nbsp;0<BR>kExtendedSoundBufferSizeValid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1L&nbsp;&lt;&lt;&nbsp;1</TT><P CLASS="T1-Text1"><A NAME="pgfId-30167"></A>The <TT>kExtendedSoundBufferSizeValid</TT> flag indicates if the <TT>bufferSize</TT> field is valid. If not set, then you shouldn't use the <TT>bufferSize</TT> field's value. In the case of the 4.1 sound media handler, the buffer size is now passed so this flag is set.</P><P CLASS="T1-Text1"><A NAME="pgfId-30168"></A>The <TT>kExtendedSoundSampleCountNotValid</TT> is slightly more unusual. This allows a buffer of audio of <TT>bufferSize</TT> bytes to not declare the number of audio samples that it will generate. Note that if this flag is set, the <TT>bufferSize</TT> field must be valid and the <TT>kExtendedSoundBufferSizeValid</TT> flag must be set.</P><P CLASS="T1-Text1"><A NAME="pgfId-30169"></A>While this ability to not specify the sample count is of little use in the sound media handler case where the sample references already describe the durations of all the samples, it may prove more useful in other cases.</P><P CLASS="T1-Text1"><A NAME="pgfId-30170"></A>One such case involves sound conversion where the decompressor is asked to generate audio samples until a source buffer is exhausted. Instead of requiring that we know the number of source audio samples before decompression, this allows the client to just feed audio until there is no more. Another case involves playback where durations aren't known. In both cases, it seems advantageous to not have to ask the decompressor to parse all the data just to determine the number of audio samples only to pass that number back to the decompressor so that it can parse and actually decode the data.</P><P CLASS="T1-Text1"><A NAME="pgfId-30171"></A>From the sound decompressor's point of view, this is the most important new structure and is available from the decompressor's call to its source's <TT>SoundComponentGetSourceData</TT> call. Keep in mind that the structure returned may not be an <TT>ExtendedSoundComponentData</TT>, so be careful to check.</P><hr>&#169; 2000 Apple Computer, Inc.<!-- QTnavbar start --><P><I>Inside Macintosh: QuickTime Reference</I><P>| <A HREF="QT41WhatsNew-93.html">Previous</A> | <A HREF="QT41WhatsNew-1.html">Chapter Contents</A> | <A HREF="QT41WhatsNew.html">Chapter Top</A> | <A HREF="QT41WhatsNew-95.html">Next</A> |</P><!-- QTnavbar end --></DIV><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY></HTML>