<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Overview (MacApp PG)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING146></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MacAppProgGuide-145.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-147.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MacAppProgGuide-2.html"><B>Programmer's Guide to MacApp</B></A> / <A HREF="MacAppProgGuide-78.html"><B>Part 2 - Working With MacApp</B></A><BR><DD><A HREF="MacAppProgGuide-145.html"><B>Chapter 31 - Working With the Edition Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING146-0></A>
<H1>Overview</H1>
 Applications use the Edition Manager to support publish and subscribe. Publish and subscribe allows users to share data between documents and applications and keep that data up to date in all locations when the original data changes.<P>
 MacApp's built-in support takes care of much of the overhead required to use the Edition Manager in your application. MacApp implements numerous classes, supplies menu and alert resources, and dispatches Edition Manager Apple events to the objects that can handle them. Your application can support publish and subscribe for the data types <CODE>'PICT'</CODE>, <CODE>'TEXT'</CODE>, and <CODE>'snd '</CODE> by overriding a relatively small number of methods, most of them in its document class.<P>
 The Calc sample application demonstrates support for publishing and subscribing cell data in a spreadsheet. <A HREF=#MARKER-9-21>Figure 31-1</A> shows the MacApp classes and methods used to provide Edition Manager support.<P>
<A NAME=HEADING146-4></A>
<H2>Basic Edition Manager Support</H2>
 If you add Edition Manager support to your application, users can specify data to publish or can subscribe to published data. To support this sharing of data, your application must <P>
<UL>
<LI>add Edition Manager menu commands to the Edit menu <A HREF=MacAppProgGuide-147.html#MARKER-9-29>(page 652)</A>
<LI>be able to designate an area in a document for publishing or subscribing <A HREF=#MARKER-9-22>(page 650)</A>
<LI>be able to show the required border around publishers and subscribers (<A HREF=#MARKER-9-24>page 650</A>, <A HREF=MacAppProgGuide-147.html#MARKER-9-31>659</A>)
<LI>be able to handle section Apple events from the Edition Manager <A HREF=#MARKER-9-26>(page 650)</A><P>
</UL>
 These topics are described in greater detail beginning on the specified pages.<P>
<B>Figure 31-1  <A NAME=MARKER-2-20></A><A NAME=MARKER-9-21></A>Edition Manager classes and methods</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/MacApp_PG-L-086.gif"><P>
<A NAME=HEADING146-13></A>
<H2><A NAME=MARKER-9-22></A>Designating an Area in a Document</H2>
 To publish or subscribe to data, a user must be able to select an area of the document, usually by selecting data in a view. In most applications, selection is a standard operation, but Edition Manager support may require special handling.<P>
 If your application publishes data in a format that can be represented by a line, region, or coordinate rectangle, you can use one of MacApp's designator classes, <CODE>TLinearDesignator</CODE>, <CODE>TRegionDesignator</CODE>, or <CODE>TVRectDesignator</CODE>. Otherwise, you can define a designator subclass to represent your data type. <P>
<A NAME=HEADING146-16></A>
<H2><A NAME=MARKER-2-23></A><A NAME=MARKER-9-24></A>Publisher and Subscriber Borders</H2>
 When a user chooses the Show Borders command, the application draws the appropriate border around all visible publishers and subscribers. A publisher border is 3 pixels wide and 50 percent gray. A subscriber border is 3 pixels wide and 75 percent gray. A rectangle of 1 white pixel separates the data from the border itself. Borders are drawn <I>outside</I> the contents of publishers and subscribers so that data is not obscured.<P>
 To draw the border for a publisher or subscriber, your application creates an object of type <CODE>TPublisherAdorner</CODE> or <CODE>TSubscriberAdorner</CODE>. For example, when a user creates a publisher for a document, your application creates an instance of <CODE>TPublisherAdorner</CODE>, initializes it with a region representing the area of the document that is published, and adds the adorner to the view that displays the publisher. The adorner draws the border for the published or subscribed-to data.<P>
<A NAME=HEADING146-19></A>
<H2><A NAME=MARKER-2-25></A><A NAME=MARKER-9-26></A>Section Apple Events</H2>
 The Edition Manager sends a section Apple event to tell your application when a subscriber should get a new edition or when a publisher should send a new edition. There are also section Apple events to scroll a selection and to cancel a publisher or subscriber. MacApp dispatches Edition Manager events to the <CODE>DoScriptCommand</CODE> method of your application object, which in turn calls the <CODE>DoAESectionEvent</CODE> method of its <CODE>TSectionMgr</CODE> behavior object. <CODE>DoAESectionEvent</CODE> creates and posts a command object to handle the section event.<P>
 To handle section Apple events, your application must include MacApp's Edition Manager, as described in <A HREF=MacAppProgGuide-147.html#MARKER-9-28>"Recipe--Adding Publish and Subscribe Support to Your Application," beginning on page 651</A>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MacAppProgGuide-145.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-147.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MacAppProgGuide-3.html">&copy; Apple Computer, Inc.</A><br>25 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
