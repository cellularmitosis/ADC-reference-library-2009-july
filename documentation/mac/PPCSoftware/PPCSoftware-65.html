<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>The Code Fragment Resource (IM: PS)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING65></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="PPCSoftware-64.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="PPCSoftware-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="PPCSoftware-86.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="PPCSoftware-66.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="PPCSoftware-2.html"><B>PowerPC System Software</B></A> / <BR><DD><A HREF="PPCSoftware-40.html"><B>Chapter 3 - Code Fragment Manager</B></A> / <A HREF="PPCSoftware-43.html"><B>Code Fragment Manager Reference</B></A><BR><DL><DD><A HREF="PPCSoftware-64.html"><B>Resources</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING65-0></A>
<H3><A NAME=MARKER-16-170></A><A NAME=MARKER-9-171></A>The Code Fragment Resource<A NAME=MARKER-2-53></A><A NAME=MARKER-2-55></A><A NAME=MARKER-2-30></A></H3>
 You use a code fragment resource to specify some characteristics of a code fragment. For an application, the code fragment resource indicates to the Process Manager that the application's data fork contains an executable code fragment. For an import library, the code fragment resource specifies the library's name and version information.<P>
<DL>
<DT><B>IMPORTANT</B>
<DD>A code fragment resource must have resource ID 0.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 <A HREF=#MARKER-9-175>Figure 3-1</A> shows the structure of a compiled code fragment resource.<P>
<B>Figure 3-1  <A NAME=MARKER-9-175></A>Structure of a compiled code fragment (<CODE>'cfrg'</CODE>) resource</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/PPCO-L-17.jpg">
 The compiled version of a code fragment resource contains the following elements:<P>
<UL>
<LI>Reserved. The first two long integers are reserved and should be set to 0.
<LI>Version information. This field specifies the current version of the <CODE>'cfrg'</CODE> resource. The current version is 0x00000001.
<LI>Reserved. The next four long integers are reserved and should be set to 0.
<LI>Number of fragment descriptions. This field specifies the number of code fragment information records that follow this field in the resource. (The value in this field should be the actual number of information records that follow, beginning with 1.)<P>
</UL>
 <A NAME=MARKER-2-116></A>Following the array count is an array of <B>code fragment information records.</B> A single file can include one or more containers. Similarly, it might occasionally be useful to assign more than one name to a single import library or application. Typically, however, both applications and import libraries include just a single code fragment information record in their <CODE>'cfrg'</CODE> resources. Each record has the format illustrated in <A HREF=#MARKER-9-177>Figure 3-2</A>.<P>
<B>Figure 3-2  <A NAME=MARKER-9-177></A>The format of a code fragment information record</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/PPCO-L-18.jpg">
 A code fragment information record contains the following elements:<P>
<UL>
<LI>The instruction set architecture. You can use the <A NAME=MARKER-2-261></A>Rez constant <CODE>kPowerPC</CODE> (<CODE>'pwpc'</CODE>) to specify the PowerPC instruction set architecture.<A NAME=MARKER-2-179></A><A NAME=MARKER-2-180></A><A NAME=MARKER-2-181></A><A NAME=MARKER-2-182></A>
<LI><A NAME=MARKER-2-183></A><A NAME=MARKER-2-184></A>The update level. For an import library, you can specify either the value <CODE>kFullLib</CODE> (0), to indicate that the library is a base library (not an update of some other library), or the value <CODE>kUpdateLib</CODE> (1), to indicate that the library updates only part of some other library. Applications should specify the value <CODE>kFullLib</CODE> in this field.
<LI>The current version number. For an import library, this field specifies the implementa-<BR>tion version. This field has the same format as the first 4 bytes of a resource of type <CODE>'vers'</CODE>. See the chapter "Finder Interface" in <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I> for details on the structure of a <CODE>'vers'</CODE> resource.<A NAME=MARKER-2-185></A><A NAME=MARKER-2-186></A>
<LI>The oldest definition version number. For an import library, this field specifies the oldest version of the definition library with which the implementation import library is compatible. This field has the same format as the first 4 bytes of a resource of <BR>type <CODE>'vers'</CODE>.<A NAME=MARKER-2-187></A><A NAME=MARKER-2-188></A>
<LI><A NAME=MARKER-2-193></A><A NAME=MARKER-11-190></A>The application stack size. For an application, this field specifies the minimum size, in bytes, of the application stack. You can use the Rez constant <CODE>kDefaultStackSize</CODE> (0) to indicate that the stack should be given the default size for the current software and hardware configuration. If you determine at run time that your application needs a larger or smaller stack, you can use the standard stack-adjusting techniques that call <CODE>GetApplLimit</CODE> and <CODE>SetApplLimit</CODE>.<A NAME=MARKER-2-191></A><A NAME=MARKER-2-192></A><A NAME=MARKER-2-193></A><A NAME=MARKER-2-194></A><A NAME=MARKER-2-195></A>
<LI>The application's library directory. For an application, this field specifies the resource ID of an alias resource (a resource of type <CODE>'alis'</CODE>) in the application's resource fork that describes the application's load directory. See <A HREF=PPCSoftware-41.html#MARKER-9-25>"Import Library Searching" on page 3-5</A> for more information about load directories. For information about alias resources, see the chapter "Alias Manager" in <I><A HREF="../Files/Files-2.html">Inside Macintosh: Files</A></I>.<A NAME=MARKER-2-196></A><A NAME=MARKER-2-197></A><A NAME=MARKER-2-198></A><A NAME=MARKER-2-199></A><A NAME=MARKER-2-200></A>
<LI>A usage field. This field specifies the type of fragment that this record describes. The value <CODE>kIsLib</CODE> (0) indicates that the fragment is an import library. The value <CODE>kIsApp</CODE> (1) indicates that the fragment is an application. The value <CODE>kIsDropIn</CODE> (2) indicates that the fragment is an extension. The Code Fragment Manager recognizes only the values <CODE>kIsLib</CODE> and <CODE>kIsApp</CODE>. The value <CODE>kIsDropIn</CODE> is provided to allow you to put private application extensions in a file and not have the Code Fragment Manager recognize them as shared libraries.
<LI>A location field. This field specifies the location of the fragment's container. The value <CODE>kInMem</CODE> (0) indicates that the container is in memory (usually in ROM). This value is intended for use by the Operating System; in general, you should not use it. The value <CODE>kOnDiskFlat</CODE> (1) indicates that the container is in the data fork of some file. The value <CODE>kOnDiskSegmented</CODE> (2) indicates that the container is in a resource in the resource fork of some file.<A NAME=MARKER-2-201></A><A NAME=MARKER-2-202></A>
<LI>The offset to the beginning of the fragment. The interpretation of this field depends <BR>on the value specified in the location field immediately preceding this field. If the location field has the value <CODE>kInMem</CODE>, this field is the address in memory of the begin-<BR>ning of the fragment. If the location field has the value <CODE>kOnDiskFlat</CODE>, this field is the number of bytes from the beginning of the data fork to the beginning of the fragment itself. You can use the Rez constant <CODE>kZeroOffset</CODE> (0) to specify an offset of 0 bytes. If the location field has the value <CODE>kOnDiskSegmented</CODE>, this field is the resource type (of type <CODE>OSType</CODE>) of the resource that contains the fragment.
<LI>The length of the fragment. The interpretation of this field depends on the value specified in the location field immediately preceding the offset field. If the location field has the value <CODE>kInMem</CODE>, this field is the address in memory of the end of the fragment. If the location field has the value <CODE>kOnDiskFlat</CODE>, this field is the length, in bytes, of the fragment. You can use the <A NAME=MARKER-2-203></A>Rez constant <CODE>kWholeFork</CODE> (0) to indicate that the fragment occupies the entire fork. If the location field has the value <CODE>kOnDiskSegmented</CODE>, this field is the sign-extended resource ID of the resource that contains the fragment.<A NAME=MARKER-2-204></A>
<LI>Reserved. The next two long integers are reserved and should be set to 0.
<LI>The total length of the code fragment information record. This field specifies <BR>the length, in bytes, of this code fragment information record, including the <BR>fragment name and any pad bytes added to the name field.
<LI>The fragment's name. This field is a Pascal string that indicates the name of the application or import library. This is the default name used by the debugger for this fragment. This field is padded with null bytes, if necessary, so that the information record extends to a 4-byte boundary.<A NAME=MARKER-2-205></A><A NAME=MARKER-2-206></A><A NAME=MARKER-2-37></A><A NAME=MARKER-2-44></A><A NAME=MARKER-2-53></A><A NAME=MARKER-2-38></A><P>
</UL>

</BLOCKQUOTE>
<HR>
<center>
<A HREF="PPCSoftware-64.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="PPCSoftware-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="PPCSoftware-86.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="PPCSoftware-66.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="PPCSoftware-3.html">&copy; Apple Computer, Inc.</A><br>3 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
