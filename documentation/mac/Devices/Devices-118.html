<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Summary of the Slot Manager(IM: D)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING118></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->




<!-- Main Body -->

<CENTER>
<P>
<A HREF="Devices-117.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Devices-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Devices-328.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Devices-119.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Devices-2.html"><B>Devices</B></A> / <BR><DD><A HREF="Devices-53.html"><B>Chapter 2 - Slot Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING118-0></A>
<H1>Summary of the Slot Manager</H1>
<A NAME=HEADING118-1></A>
<H2>Pascal Summary</H2>
<A NAME=HEADING118-2></A>
<H3>Constants</H3>
<PRE>
CONST
   {siStatusFlags field of SInfoRecord}
   fCardIsChanged       = 1;           {card has changed}
   {flags for SSearchSRT}
   fCkForSame           = 0;           {check for same sResource in table}
   fCkForNext           = 1;           {check for next sResource in table}

   {flag passed to card by SPrimaryInit during startup or restart}
   fWarmStart           = 2;           {warm start if set; else cold start}
   {constants for siState field of sInfoRecord}
   stateNil             = 0;           {state}
   stateSDMInit         = 1;           {slot declaration manager init}
   statePRAMInit        = 2;           {sPRAM record init}
   statePInit           = 3;           {primary init}
   stateSInit           = 4;           {secondary init}
   {bit flags for spParamData field of SpBlock}
   fAll                 = 0;           {if set, search all sResources}
   fOneSlot             = 1;           {if set, search in given slot only}
   fNext                = 2;           {if set, search for next sResource}
</PRE>
<A NAME=HEADING118-7></A>
<H3>Data Types</H3>
<PRE>
TYPE SpBlock =                         {Slot Manager parameter block}
   PACKED RECORD
      spResult:         LongInt;       {function result}
      spsPointer:       Ptr;           {structure pointer}
      spSize:           LongInt;       {size of structure}
      spOffsetData:     LongInt;       {offset or data}
      spIOFileName:     Ptr;           {reserved for Slot Manager}
      spsExecPBlk:      Ptr;           {pointer to SEBlock data structure}
      spParamData:      LongInt;       {flags}
      spMisc:           LongInt;       {reserved for Slot Manager}
      spReserved:       LongInt;       {reserved for Slot Manager}
      spIOReserved:     Integer;       {ioReserved field from SRT}
      spRefNum:         Integer;       {driver reference number}
      spCategory:       Integer;       {Category field of sRsrcType entry}
      spCType:          Integer;       {cType field of sRsrcType entry}
      spDrvrSW:         Integer;       {DrSW field of sRsrcType entry}
      spDrvrHW:         Integer;       {DrHW field of sRsrcType entry}
      spTBMask:         SignedByte;    {sRsrcType entry bit mask}
      spSlot:           SignedByte;    {slot number}
      spID:             SignedByte;    {sResource ID}
      spExtDev:         SignedByte;    {external device ID}
      spHwDev:          SignedByte;    {hardware device ID}
      spByteLanes:      SignedByte;    {valid byte lanes}
      spFlags:          SignedByte;    {flags used by Slot Manager}
      spKey:            SignedByte;    {reserved for Slot Manager}
   END;
   SpBlockPtr = ^SpBlock;
   SInfoRecord =                       {slot information record}
   PACKED RECORD
      siDirPtr:         Ptr;           {pointer to sResource directory}
      siInitStatusA:    Integer;       {initialization error}
      siInitStatusV:    Integer;       {status returned by vendor }
                                       { initialization routine}
      siState:          SignedByte;    {initialization state}
      siCPUByteLanes:   SignedByte;    {byte lanes used}
      siTopOfROM:       SignedByte;    {highest valid address in ROM}
      siStatusFlags:    SignedByte;    {status flags}
      siTOConstant:     Integer;       {timeout constant for bus error}
      siReserved:       PACKED ARRAY [0..1] OF SignedByte;  {reserved}
      siROMAddr:        Ptr;           {address of top of ROM}
      siSlot:           Char;          {slot number}
      siPadding:        PACKED ARRAY [0..2] OF SignedByte;  {reserved}
   END;
   SInfoRecPtr = ^SInfoRecord;
   FHeaderRec =                        {format header record}
   PACKED RECORD
      fhDirOffset:      LongInt;       {offset to sResource directory}
      fhLength:         LongInt;       {length in bytes of declaration ROM}
      fhCRC:            LongInt;       {cyclic redundancy check}
      fhROMRev:         SignedByte;    {declaration ROM revision}
      fhFormat:         SignedByte;    {declaration ROM format}
      fhTstPat:         LongInt;       {test pattern}
      fhReserved:       SignedByte;    {reserved; must be 0}
      fhByteLanes:      SignedByte;    {byte lanes used by declaration ROM}
   END;
   FHeaderRecPtr = ^FHeaderRec;
   SPRAMRecord =                       {slot parameter RAM record}
   PACKED RECORD
      boardID:          Integer;       {Apple-defined card ID}
      vendorUse1:       SignedByte;    {reserved for vendor use}
      vendorUse2:       SignedByte;    {reserved for vendor use}
      vendorUse3:       SignedByte;    {reserved for vendor use}
      vendorUse4:       SignedByte;    {reserved for vendor use}
      vendorUse5:       SignedByte;    {reserved for vendor use}
      vendorUse6:       SignedByte;    {reserved for vendor use}
   END;
   SPRAMRecPtr = ^SPRAMRecord;
   SEBlock =                           {slot execution parameter block}
   PACKED RECORD
      seSlot:           SignedByte;    {slot number}
      sesRsrcId:        SignedByte;    {sResource ID}
      seStatus:         Integer;       {status of sExecBlock code}
      seFlags:          SignedByte;    {flags}
      seFiller0:        SignedByte;    {filler for word alignment}
      seFiller1:        SignedByte;    {filler}
      seFiller2:        SignedByte;    {filler}
      seResult:         LongInt;       {result of SLoadDriver}
      seIOFileName:     LongInt;       {pointer to driver name}
      seDevice:         SignedByte;    {device to read from}
      sePartition:      SignedByte;    {partition}
      seOSType:         SignedByte;    {type of OS}
      seReserved:       SignedByte;    {reserved}
      seRefNum:         SignedByte;    {driver reference number}
      seNumDevices:     SignedByte;    {number of devices to load}
      seBootState:      SignedByte;    {state of StartBoot code}
   END;
   SlotIntQElement =                   {slot interrupt queue element}
   RECORD
      sqLink:           Ptr;           {pointer to next queue element}
      sqType:           Integer;       {queue type ID; must be sIQType}
      sqPrio:           Integer;       {priority value in low byte}
      sqAddr:           ProcPtr;       {interrupt handler}
      sqParm:           LongInt;       {optional A1 parameter}
   END;
   SQElemPtr = ^SlotIntQElement;
</PRE>
<A NAME=HEADING118-14></A>
<H3>Slot Manager Routines</H3>
<A NAME=HEADING118-15></A>
<H4>Determining the Version of the Slot Manager</H4>
<PRE>
FUNCTION SVersion		(spBlkPtr: SpBlockPtr): OSErr;
</PRE>
<A NAME=HEADING118-17></A>
<H4>Finding sResources</H4>
<PRE>
FUNCTION SRsrcInfo		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SGetSRsrc		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SGetTypeSRsrc		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SNextSRsrc		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SNextTypeSRsrc		(spBlkPtr: SpBlockPtr): OSErr;
</PRE>
<A NAME=HEADING118-23></A>
<H4>Getting Information From sResources</H4>
<PRE>
FUNCTION SReadDrvrName		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SReadByte		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SReadWord		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SReadLong		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SGetCString		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SGetBlock		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SFindStruct		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SReadStruct		(spBlkPtr: SpBlockPtr): OSErr;
</PRE>
<A NAME=HEADING118-32></A>
<H4>Enabling, Disabling, Deleting, and Restoring sResources</H4>
<PRE>
FUNCTION SetSRsrcState		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SDeleteSRTRec		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION InsertSRTRec		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SUpdateSRT		(spBlkPtr: SpBlockPtr): OSErr;
</PRE>
<A NAME=HEADING118-37></A>
<H4>Loading Drivers and Executing Code From sResources</H4>
<PRE>
FUNCTION SGetDriver		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SExec			(spBlkPtr: SpBlockPtr): OSErr;
</PRE>
<A NAME=HEADING118-40></A>
<H4>Getting Information About Expansion Cards and Declaration ROMs</H4>
<PRE>
FUNCTION SReadInfo		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SReadFHeader		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SCkCardStat		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SCardChanged		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SFindDevBase		(spBlkPtr: SpBlockPtr): OSErr;
</PRE>
<A NAME=HEADING118-46></A>
<H4>Accessing Expansion Card Parameter RAM</H4>
<PRE>
FUNCTION SReadPRAMRec		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SPutPRAMRec		(spBlkPtr: SpBlockPtr): OSErr;
</PRE>
<A NAME=HEADING118-49></A>
<H4>Managing the Slot Interrupt Queue</H4>
<PRE>
FUNCTION SIntInstall		(sIntQElemPtr: SQElemPtr;
				theSlot: Integer) : OsErr;
FUNCTION SIntRemove		(sIntQElemPtr: SQElemPtr; 
				theSlot: Integer) : OsErr;
</PRE>
<A NAME=HEADING118-52></A>
<H3>Low-Level Routines</H3>
<PRE>
FUNCTION InitSDeclMgr		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SCalcSPointer		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SCalcStep		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SFindBigDevBase	(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SFindSInfoRecPtr	(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SFindSRsrcPtr		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SGetSRsrcPtr		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SInitPRAMRecs		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SInitSRsrcTable	(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SOffsetData		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SPrimaryInit		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SPtrToSlot		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SReadPBSize		(spBlkPtr: SpBlockPtr): OSErr;
FUNCTION SSearchSRT		(spBlkPtr: SpBlockPtr): OSErr;
</PRE>
<A NAME=HEADING118-67></A>
<H2>C Summary</H2>
<A NAME=HEADING118-68></A>
<H3>Constants</H3>
<PRE>
enum {
   /* StatusFlags field of sInfoArray */
   fCardIsChanged = 1,              /* card has changed */
   /* flags for SearchSRT */
   fCkForSame     = 0,              /* check for same sResource in table */
   fCkForNext     = 1,              /* check for next sResource in table */

   /* flag passed to card by SPrimaryInit during startup or restart */
   fWarmStart     = 2,              /* warm start if set; else cold start */
   /* constants for siState field of sInfoRecord */
   stateNil       = 0,              /* state */
   stateSDMInit   = 1,              /* slot declaration manager init */
   statePRAMInit  = 2,              /* sPRAM record init */
   statePInit     = 3,              /* primary init */
   stateSInit     = 4,              /* secondary init */
   /* bit flags for spParamData field of SpBlock */
   fall           = 0,              /* if set, search all sResources */
   foneslot       = 1,              /* if set, search in given slot only */
   fnext          = 2               /* if set, search for next sResource */
};
</PRE>
<A NAME=HEADING118-73></A>
<H3>Data Types</H3>
<PRE>
typedef struct SpBlock {            /* Slot Manager parameter block */
   long     spResult;               /* function result */
   Ptr      spsPointer;             /* structure pointer */
   long     spSize;                 /* size of structure */
   long     spOffsetData;           /* offset or data */
   Ptr      spIOFileName;           /* reserved for Slot Manager */
   Ptr      spsExecPBlk;            /* pointer to SEBlock structure */
   long     spParamData;            /* flags */
   long     spMisc;                 /* reserved for Slot Manager */
   long     spReserved;             /* reserved for Slot Manager */
   short    spIOReserved;           /* ioReserved field from SRT */
   short    spRefNum;               /* driver reference number */
   short    spCategory;             /* Category field of sRsrcType entry */
   short    spCType;                /* cType field of sRsrcType entry */
   short    spDrvrSW;               /* DrSW field of sRsrcType entry */
   short    spDrvrHW;               /* DrHW field of sRsrcType entry */
   char     spTBMask;               /* sRsrcType entry bit mask */
   char     spSlot;                 /* slot number */
   char     spID;                   /* sResource ID */
   char     spExtDev;               /* external device ID */
   char     spHwDev;                /* hardware device ID */
   char     spByteLanes;            /* valid byte lanes */
   char     spFlags;                /* flags used by Slot Manager */
   char     spKey;                  /* reserved for Slot Manager */
} SpBlock;
typedef SpBlock *SpBlockPtr;
typedef struct SInfoRecord {        /* slot information record */
   Ptr      siDirPtr;               /* pointer to sResource directory */
   short    siInitStatusA;          /* initialization error */
   short    siInitStatusV;          /* status returned by vendor
                                       initialization routine */
   char     siState;                /* initialization state */
   char     siCPUByteLanes;         /* byte lanes used */
   char     siTopOfROM;             /* highest valid address in ROM */
   char     siStatusFlags;          /* status flags */
   short    siTOConst;              /* timeout constant for bus error */
   char     siReserved[2];          /* reserved */
   Ptr      siROMAddr;              /* address of top of ROM */
   char     siSlot;                 /* slot number */
   char     siPadding[3];           /* reserved */
} SInfoRecord;
typedef SInfoRecord *SInfoRecPtr;
typedef struct FHeaderRec {         /* format header record */
   long     fhDirOffset;            /* offset to sResource directory */
   long     fhLength;               /* length in bytes of declaration ROM */
   long     fhCRC;                  /* cyclic redundancy check */
   char     fhROMRev;               /* declaration ROM revision */
   char     fhFormat;               /* declaration ROM format */
   long     fhTstPat;               /* test pattern */
   char     fhReserved;             /* reserved; must be 0 */
   char     fhByteLanes;            /* byte lanes used by declaration ROM */
} FHeaderRec;
typedef FHeaderRec *FHeaderRecPtr;
typedef struct SPRAMRecord {        /* slot parameter RAM record */
   short    boardID;                /* Apple-defined card ID */
   char     vendorUse1;             /* reserved for vendor use */
   char     vendorUse2;             /* reserved for vendor use */
   char     vendorUse3;             /* reserved for vendor use */
   char     vendorUse4;             /* reserved for vendor use */
   char     vendorUse5;             /* reserved for vendor use */
   char     vendorUse6;             /* reserved for vendor use */
} SPRAMRecord;
typedef SPRAMRecord *SPRAMRecPtr;
typedef struct SEBlock {            /* slot execution parameter block */
   unsigned char     seSlot;        /* slot number */
   unsigned char     sesRsrcId;     /* sResource ID */
   short             seStatus;      /* status of sExecBlock code */
   unsigned char     seFlags;       /* flags */
   unsigned char     seFiller0;     /* filler for word alignment */
   unsigned char     seFiller1;     /* filler */
   unsigned char     seFiller2;     /* filler */
   long              seResult;      /* result of SLoadDriver */
   long              seIOFileName;  /* pointer to driver name */
   unsigned char     seDevice       /* device to read from */
   unsigned char     sePartition;   /* partition */
   unsigned char     seOSType;      /* type of OS */
   unsigned char     seReserved;    /* reserved */
   unsigned char     seRefNum;      /* driver reference number */
   unsigned char     seNumDevices;  /* number of devices to load */
   unsigned char     seBootState;   /* state of StartBoot code */
} SEBlock;
typedef struct SlotIntQElement {    /* slot interrupt queue element */
   Ptr      sqLink;                 /* pointer to next queue element */
   short    sqType;                 /* queue type ID; must be sIQType */
   short    sqPrio;                 /* priority value in low byte */
   ProcPtr  sqAddr;                 /* interrupt handler */
   long     sqParm;                 /* optional A1 parameter */
} SlotIntQElement;
typedef SlotIntQElement *SQElemPtr;
</PRE>
<A NAME=HEADING118-80></A>
<H3>Slot Manager Functions</H3>
<A NAME=HEADING118-81></A>
<H4>Determining the Version of the Slot Manager</H4>
<PRE>
pascal OSErr SVersion 		(SpBlockPtr spBlkPtr);
</PRE>
<A NAME=HEADING118-83></A>
<H4>Finding sResources</H4>
<PRE>
pascal OSErr SRsrcInfo 		(SpBlockPtr spBlkPtr);
pascal OSErr SGetSRsrc 		(SpBlockPtr spBlkPtr);
pascal OSErr SGetTypeSRsrc 	(SpBlockPtr spBlkPtr);
pascal OSErr SNextSRsrc 	(SpBlockPtr spBlkPtr);
pascal OSErr SNextTypeSRsrc 	(SpBlockPtr spBlkPtr);
</PRE>
<A NAME=HEADING118-89></A>
<H4>Getting Information From sResources</H4>
<PRE>
pascal OSErr SReadDrvrName 	(SpBlockPtr spBlkPtr);
pascal OSErr SReadByte 		(SpBlockPtr spBlkPtr);
pascal OSErr SReadWord 		(SpBlockPtr spBlkPtr);
pascal OSErr SReadLong 		(SpBlockPtr spBlkPtr);
pascal OSErr SGetCString 	(SpBlockPtr spBlkPtr);
pascal OSErr SGetBlock 		(SpBlockPtr spBlkPtr);
pascal OSErr SFindStruct 	(SpBlockPtr spBlkPtr);
pascal OSErr SReadStruct 	(SpBlockPtr spBlkPtr);
</PRE>
<A NAME=HEADING118-98></A>
<H4>Enabling, Disabling, Deleting, and Restoring sResources</H4>
<PRE>
pascal OSErr SetSRsrcState 	(SpBlockPtr spBlkPtr);
pascal OSErr SDeleteSRTRec 	(SpBlockPtr spBlkPtr);
pascal OSErr InsertSRTRec 	(SpBlockPtr spBlkPtr);
pascal OSErr SUpdateSRT 	(SpBlockPtr spBlkPtr);
</PRE>
<A NAME=HEADING118-103></A>
<H4>Loading Drivers and Executing Code From sResources</H4>
<PRE>
pascal OSErr SGetDriver 	(SpBlockPtr spBlkPtr);
pascal OSErr SExec 		(SpBlockPtr spBlkPtr);
</PRE>
<A NAME=HEADING118-106></A>
<H4>Getting Information About Expansion Cards and Declaration ROMs</H4>
<PRE>
pascal OSErr SReadInfo 		(SpBlockPtr spBlkPtr);
pascal OSErr SReadFHeader 	(SpBlockPtr spBlkPtr);
pascal OSErr SCkCardStat 	(SpBlockPtr spBlkPtr);
pascal OSErr SCardChanged 	(SpBlockPtr spBlkPtr);
pascal OSErr SFindDevBase 	(SpBlockPtr spBlkPtr);
</PRE>
<A NAME=HEADING118-112></A>
<H4>Accessing Expansion Card Parameter RAM</H4>
<PRE>
pascal OSErr SReadPRAMRec 	(SpBlockPtr spBlkPtr);
pascal OSErr SPutPRAMRec 	(SpBlockPtr spBlkPtr);
</PRE>
<A NAME=HEADING118-115></A>
<H4>Managing the Slot Interrupt Queue</H4>
<PRE>
pascal OSErr SIntInstall 	(SQElemPtr sIntQElemPtr, short theSlot);
pascal OSErr SIntRemove 	(SQElemPtr sIntQElemPtr, short theSlot);
</PRE>
<A NAME=HEADING118-118></A>
<H3>Low-Level Functions</H3>
<PRE>
pascal OSErr InitSDeclMgr 	(SpBlockPtr spBlkPtr);
pascal OSErr SCalcSPointer 	(SpBlockPtr spBlkPtr);
pascal OSErr SCalcStep 		(SpBlockPtr spBlkPtr);
pascal OSErr SFindBigDevBase 	(SpBlockPtr spBlkPtr);
pascal OSErr SFindSInfoRecPtr	(SpBlockPtr spBlkPtr);
pascal OSErr SFindSRsrcPtr 	(SpBlockPtr spBlkPtr);
pascal OSErr SGetSRsrcPtr 	(SpBlockPtr spBlkPtr);
pascal OSErr SInitPRAMRecs 	(SpBlockPtr spBlkPtr);
pascal OSErr SInitSRsrcTable 	(SpBlockPtr spBlkPtr);
pascal OSErr SOffsetData 	(SpBlockPtr spBlkPtr);
pascal OSErr SPrimaryInit 	(SpBlockPtr spBlkPtr);
pascal OSErr SPtrToSlot 	(SpBlockPtr spBlkPtr);
pascal OSErr SReadPBSize 	(SpBlockPtr spBlkPtr);
pascal OSErr SSearchSRT 	(SpBlockPtr spBlkPtr);
</PRE>
<A NAME=HEADING118-133></A>
<H2>Assembly-Language Summary</H2>
<A NAME=HEADING118-134></A>
<H3>Data Structures</H3>
<A NAME=HEADING118-135></A>
<H4>Slot Manager Parameter Block
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>0<TH><CODE>spResult</CODE><TH>long<TH>function result<TR>
<TD>4<TD><CODE>spsPointer</CODE><TD>long<TD>structure pointer<TR>
<TD>8<TD><CODE>spSize</CODE><TD>long<TD>size of structure<TR>
<TD>12<TD><CODE>SpOffsetData</CODE><TD>long<TD>offset or data<TR>
<TD>16<TD><CODE>spIOFileName</CODE><TD>long<TD>reserved for Slot Manager<TR>
<TD>20<TD><CODE>spsExecPBlk</CODE><TD>long<TD>pointer to SEBlock data structure<TR>
<TD>24<TD><CODE>spParamData</CODE><TD>long<TD>flags<TR>
<TD>28<TD><CODE>spMisc</CODE><TD>long<TD>reserved for Slot Manager<TR>
<TD>32<TD><CODE>spReserved</CODE><TD>long<TD>reserved for Slot Manager<TR>
<TD>36<TD><CODE>spIOReserved</CODE><TD>word<TD><CODE>ioReserved</CODE> field from SRT<TR>
<TD>38<TD><CODE>spRefNum</CODE><TD>word<TD>driver reference number<TR>
<TD>40<TD><CODE>spCategory</CODE><TD>word<TD><CODE>Category</CODE> field of <CODE>sRsrcType</CODE> entry<TR>
<TD>42<TD><CODE>spCType</CODE><TD>word<TD><CODE>cType</CODE> field of <CODE>sRsrcType</CODE> entry<TR>
<TD>44<TD><CODE>spDrvrSW</CODE><TD>word<TD><CODE>DrSW</CODE> field of <CODE>sRsrcType</CODE> entry<TR>
<TD>46<TD><CODE>spDrvrHW</CODE><TD>word<TD><CODE>DrHW</CODE> field of <CODE>sRsrcType</CODE> entry<TR>
<TD>48<TD><CODE>spTBMask</CODE><TD>byte<TD><CODE>sRsrcType</CODE> entry bit mask<TR>
<TD>49<TD><CODE>spSlot</CODE><TD>byte<TD>slot number<TR>
<TD>50<TD><CODE>spID</CODE><TD>byte<TD>sResource ID<TR>
<TD>51<TD><CODE>spExtDev</CODE><TD>byte<TD>external device ID<TR>
<TD>52<TD><CODE>spHwDev</CODE><TD>byte<TD>hardware device ID<TR>
<TD>53<TD><CODE>spByteLanes</CODE><TD>byte<TD>valid byte lanes<TR>
<TD>54<TD><CODE>spFlags</CODE><TD>byte<TD>flags used by Slot Manager<TR>
<TD>55<TD><CODE>spKey</CODE><TD>byte<TD>reserved for Slot Manager</TABLE>
</H4>
<A NAME=HEADING118-136></A>
<H4>Slot Information Record
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>0<TH><CODE>siDirPtr</CODE><TH>long<TH>pointer to sResource directory<TR>
<TD>4<TD><CODE>siInitStatusA</CODE><TD>word<TD>initialization error<TR>
<TD>6<TD><CODE>siInitStatusV</CODE><TD>word<TD>status returned by vendor initialization routine<TR>
<TD>8<TD><CODE>siState</CODE><TD>byte<TD>initialization state<TR>
<TD>9<TD><CODE>siCPUByteLanes</CODE><TD>byte<TD>byte lanes used<TR>
<TD>10<TD><CODE>siTopOfROM</CODE><TD>byte<TD>highest valid address in ROM<TR>
<TD>11<TD><CODE>siStatusFlags</CODE><TD>byte<TD>status flags<TR>
<TD>12<TD><CODE>siTOConst</CODE><TD>word<TD>timeout constant for bus error<TR>
<TD>14<TD><CODE>siReserved</CODE><TD>word<TD>reserved<TR>
<TD>16<TD><CODE>siROMAddr</CODE><TD>long<TD>address of top of ROM<TR>
<TD>20<TD><CODE>siSlot</CODE><TD>byte<TD>slot number<TR>
<TD>21<TD><CODE>siPadding</CODE><TD>3 bytes<TD>reserved</TABLE>
</H4>
<A NAME=HEADING118-137></A>
<H4>Format Header Record
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>0<TH><CODE>fhDirOffset</CODE><TH>long<TH>offset to sResource directory<TR>
<TD>4<TD><CODE>fhLength</CODE><TD>long<TD>length in bytes of declaration ROM<TR>
<TD>8<TD><CODE>fhCRC</CODE><TD>long<TD>cyclic redundancy check<TR>
<TD>12<TD><CODE>fhROMRev</CODE><TD>byte<TD>declaration ROM revision<TR>
<TD>13<TD><CODE>fhFormat</CODE><TD>byte<TD>declaration ROM format<TR>
<TD>14<TD><CODE>fhTstPat</CODE><TD>long<TD>test pattern<TR>
<TD>18<TD><CODE>fhReserved</CODE><TD>byte<TD>reserved; must be 0<TR>
<TD>19<TD><CODE>fhByteLanes</CODE><TD>byte<TD>byte lanes used by declaration ROM</TABLE>
</H4>
<A NAME=HEADING118-138></A>
<H4>Slot Parameter RAM Record
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>0<TH><CODE>boardID</CODE><TH>word<TH>Apple-defined card ID<TR>
<TD>2<TD><CODE>vendorUse1</CODE><TD>byte<TD>reserved for vendor use<TR>
<TD>3<TD><CODE>vendorUse2</CODE><TD>byte<TD>reserved for vendor use<TR>
<TD>4<TD><CODE>vendorUse3</CODE><TD>byte<TD>reserved for vendor use<TR>
<TD><B>X</B><TD><CODE>vendorUse4</CODE><TD>byte<TD>reserved for vendor use<TR>
<TD>6<TD><CODE>vendorUse5</CODE><TD>byte<TD>reserved for vendor use<TR>
<TD>7<TD><CODE>vendorUse6</CODE><TD>byte<TD>reserved for vendor use</TABLE>
</H4>
<A NAME=HEADING118-139></A>
<H4>Slot Execution Parameter Block
<TABLE BORDER="0" CELLPADDING=3><TD>0<TD><CODE>seSlot</CODE><TD>byte<TD>slot number<TR>
<TD>1<TD><CODE>sesRsrcId</CODE><TD>byte<TD>sResource ID<TR>
<TD>2<TD><CODE>seStatus</CODE><TD>word<TD>status of <CODE>sExecBlock</CODE> code<TR>
<TD>4<TD><CODE>seFlags</CODE><TD>byte<TD>flags<TR>
<TD><B>X</B><TD><CODE>seFiller0</CODE><TD>byte<TD>filler for word alignment<TR>
<TD>6<TD><CODE>seFiller1</CODE><TD>byte<TD>filler<TR>
<TD>7<TD><CODE>seFiller2</CODE><TD>byte<TD>filler<TR>
<TD>8<TD><CODE>seResult</CODE><TD>long<TD>result of <CODE>SLoadDriver</CODE><TR>
<TD>12<TD><CODE>seIOFileName</CODE><TD>long<TD>pointer to driver name<TR>
<TD>16<TD><CODE>seDevice</CODE><TD>byte<TD>device to read from<TR>
<TD>17<TD><CODE>sePartition</CODE><TD>byte<TD>partition<TR>
<TD>18<TD><CODE>seOSType</CODE><TD>byte<TD>type of operating system<TR>
<TD>19<TD><CODE>seReserved</CODE><TD>byte<TD>reserved<TR>
<TD>20<TD><CODE>seRefNum</CODE><TD>byte<TD>driver reference number<TR>
<TD>21<TD><CODE>seNumDevices</CODE><TD>byte<TD>number of devices to load<TR>
<TD>22<TD><CODE>seBootState</CODE><TD>byte<TD>state of <CODE>StartBoot</CODE> code</TABLE>
</H4>
<A NAME=HEADING118-140></A>
<H4>Slot Interrupt Queue Element
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>0<TH><CODE>sqLink</CODE><TH>long<TH>pointer to next queue element<TR>
<TD>4<TD><CODE>sqType</CODE><TD>word<TD>queue type ID; must be <CODE>sIQType</CODE><TR>
<TD>6<TD><CODE>sqPrio</CODE><TD>word<TD>priority value in low <CODE>byte</CODE><TR>
<TD>8<TD><CODE>sqAddr</CODE><TD>long<TD>pointer to interrupt handler<TR>
<TD>12<TD><CODE>sqParm</CODE><TD>long<TD>optional A1 parameter</TABLE>
</H4>
<A NAME=HEADING118-141></A>
<H3><A NAME=MARKER-9-469></A>Trap Macros</H3>
<A NAME=HEADING118-142></A>
<H4>Trap Macros Requiring Routine Selectors</H4>
<PRE>
_SlotManager
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Selector<TH>Routine<TR>
<TD>$0000<TD><CODE>SReadByte</CODE><TR>
<TD>$0001<TD><CODE>SReadWord</CODE><TR>
<TD>$0002<TD><CODE>SReadLong</CODE><TR>
<TD>$0003<TD><CODE>SGetCString</CODE><TR>
<TD>$0005<TD><CODE>SGetBlock</CODE><TR>
<TD>$0006<TD><CODE>SFindStruct</CODE><TR>
<TD>$0007<TD><CODE>SReadStruct</CODE><TR>
<TD>$0008<TD>SVersion<TR>
<TD>$0009<TD>SetSRsrcState<TR>
<TD>$000A<TD>InsertSRTRec<TR>
<TD>$000B<TD>SGetSRsrc<TR>
<TD>$000C<TD>SGetTypeSRsrc<TR>
<TD>$0010<TD><CODE>SReadInfo</CODE><TR>
<TD>$0011<TD><CODE>SReadPRAMRec</CODE><TR>
<TD>$0012<TD><CODE>SPutPRAMRec</CODE><TR>
<TD>$0013<TD><CODE>SReadFHeader</CODE><TR>
<TD>$0014<TD><CODE>SNextSRsrc</CODE><TR>
<TD>$0015<TD><CODE>SNextTypeSRsrc</CODE><TR>
<TD>$0016<TD><CODE>SRsrcInfo</CODE><TR>
<TD>$0018<TD><CODE>SCkCardStat</CODE><TR>
<TD>$0019<TD><CODE>SReadDrvrName</CODE><TR>
<TD>$001B<TD><CODE>SFindDevBase</CODE><TR>
<TD>$001C<TD><CODE>SFindBigDevBase</CODE><TR>
<TD>$001D<TD>SGetSRsrcPtr<TR>
<TD>$0020<TD><CODE>InitSDeclMgr</CODE><TR>
<TD>$0021<TD><CODE>SPrimaryInit</CODE><TR>
<TD>$0022<TD><CODE>SCardChanged</CODE><TR>
<TD>$0023<TD><CODE>SExec</CODE><TR>
<TD>$0024<TD><CODE>SOffsetData</CODE><TR>
<TD>$0025<TD><CODE>SInitPRAMRecs</CODE><TR>
<TD>$0026<TD><CODE>SReadPBSize</CODE><TR>
<TD>$0028<TD><CODE>SCalcStep</CODE><TR>
<TD>$0029<TD><CODE>SInitSRsrcTable</CODE><TR>
<TD>$002A<TD><CODE>SSearchSRT</CODE><TR>
<TD>$002B<TD><CODE>SUpdateSRT</CODE><TR>
<TD>$002C<TD><CODE>SCalcSPointer</CODE><TR>
<TD>$002D<TD><CODE>SGetDriver</CODE><TR>
<TD>$002E<TD><CODE>SPtrToSlot</CODE><TR>
<TD>$002F<TD><CODE>SFindSInfoRecPtr</CODE><TR>
<TD>$0030<TD><CODE>SFindSRsrcPtr</CODE><TR>
<TD>$0031<TD><CODE>SDeleteSRTRec</CODE></TABLE>


</PRE>
<A NAME=HEADING118-145></A>
<H2>Result Codes
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>memFullErr<TD>-108<TD>Not enough room in heap<TR>
<TD><CODE>smEmptySlot</CODE><TD>-300<TD>No card in this slot<TR>
<TD><CODE>smCRCFail</CODE><TD>-301<TD>CRC check failed<TR>
<TD><CODE>smFormatErr</CODE><TD>-302<TD>The format of the declaration ROM is wrong<TR>
<TD><CODE>smUnExBusErr</CODE><TD>-308<TD>A bus error occurred<TR>
<TD><CODE>smBLFieldBad</CODE><TD>-309<TD>A valid <CODE>fhByteLanes</CODE> field was not found<TR>
<TD><CODE>smDisposePErr</CODE><TD>-312<TD>An error occurred during execution of <CODE>DisposePtr</CODE><TR>
<TD><CODE>smNoBoardsRsrc</CODE><TD>-313<TD>There is no board sResource<TR>
<TD><CODE>smNoBoardId</CODE><TD>-315<TD>There is no board ID<TR>
<TD><CODE>smInitStatVErr</CODE><TD>-316<TD>The <CODE>InitStatusV</CODE> field was negative after <CODE>PrimaryInit</CODE><TR>
<TD><CODE>smBadRefId</CODE><TD>-330<TD>Reference ID was not found in the given list<TR>
<TD><CODE>smBadsList</CODE><TD>-331<TD>The IDs are not in ascending order<TR>
<TD><CODE>smReservedErr</CODE><TD>-332<TD>A reserved field was not zero<TR>
<TD><CODE>smCodeRevErr</CODE><TD>-333<TD>The revision of the code to be executed by <CODE>sExec</CODE> was wrong<TR>
<TD><CODE>smCPUErr</CODE><TD>-334<TD>The CPU field of the code to be executed by <CODE>sExec</CODE> was wrong<TR>
<TD><CODE>smsPointerNil</CODE><TD>-335<TD>The <CODE>spsPointer</CODE> value is <CODE>NIL</CODE>: no list is specified<TR>
<TD><CODE>smNilsBlockErr</CODE><TD>-336<TD>The physical block size of an sBlock was zero<TR>
<TD><CODE>smSlotOOBErr</CODE><TD>-337<TD>The given slot was out of bounds or does not exist<TR>
<TD><CODE>smSelOOBErr</CODE><TD>-338<TD>Selector out of bounds or function not implemented<TR>
<TD><CODE>smCkStatusErr</CODE><TD>-341<TD>Status of slot is bad<TR>
<TD><CODE>smGetDrvrNamErr</CODE><TD>-342<TD>An error occurred during execution of <CODE>_sGetDrvrName</CODE><TR>
<TD><CODE>smNoMoresRsrcs</CODE><TD>-344<TD>Requested sResource not found<TR>
<TD><CODE>smBadsPtrErr</CODE><TD>-346<TD>Bad <CODE>spsPointer</CODE> value<TR>
<TD><CODE>smByteLanesErr</CODE><TD>-347<TD>Bad <CODE>spByteLanes</CODE> value<TR>
<TD><CODE>smRecNotFnd</CODE><TD>-351<TD>Record not found in the slot resource table</TABLE>
<A NAME=MARKER-2-470></A></H2>
</BLOCKQUOTE><P>

</BLOCKQUOTE>
<HR>
<center>
<A HREF="Devices-117.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Devices-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Devices-328.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Devices-119.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Devices-3.html">&copy; Apple Computer, Inc.</A><br>3 JUL 1996</center></font><P>
<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->
</BODY>
</HTML>  
