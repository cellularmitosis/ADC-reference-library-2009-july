<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Adding Rows and Columns to a List (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING211></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-210.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-212.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-202.html"><B>Chapter 4 - List Manager</B></A> / <A HREF="MoreToolbox-209.html"><B>Using the List Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING211-0></A>
<H2><A NAME=MARKER-9-153></A>Adding Rows and Columns to a List</H2>
 Your application can choose to preallocate the cells it needs when it creates a list. For example, an application might preallocate the columns it needs, and then add rows to the list one by one. Other applications might create a list and add both rows and columns to it later. Regardless of the technique your application uses to create its cells, it can set the data in a cell by using the <CODE>LSetCell</CODE> procedure.<P>
 You specify the data, the length of the data, the location of the cell whose data you wish to set, and a handle to the list containing the cell, as parameters to the <CODE>LSetCell</CODE> procedure. <A HREF=#MARKER-9-154>Listing 4-4</A> demonstrates an application-defined procedure that adds rows to a one-column list based on the contents of a string list resource. The <CODE>MyAddItemsFromStringList</CODE> procedure adds each row to the list using the <CODE>LAddRow</CODE> function, then sets the data of the cell in the first (and only) column of the newly added row using the <CODE>LSetCell</CODE> procedure.<P>
<B>Listing 4-4  <A NAME=MARKER-9-154></A>Adding items from a string list to a one-column, text-only list<A NAME=MARKER-2-195></A></B><P>
<PRE>
PROCEDURE MyAddItemsFromStringList (myList: ListHandle;
                                    stringListID: Integer);
VAR
   index:      Integer;             {index within string list}
   rowNum:     Integer;             {row number to add string to}
   myString:   Str255;              {string to add}
   aCell:      Cell;                {cell to store string in}
BEGIN
                                    {compute new row number}
   rowNum := myList^^.dataBounds.bottom;
   index := 1;                      {start with first string}
   REPEAT
      GetIndString(myString, stringListID, index);
      IF myString &lt;&gt; '' THEN
      BEGIN    {add new row for string}
         {specify #rows to add, row number of first new row}
         rowNum := LAddRow(1, rowNum, myList);
         {prepare to set cell data--specify }
         { the cell's column number, row number}
         SetPt(aCell, 0, rowNum);
         {set cell data to string}
         LSetCell(@myString[1], Length(myString), aCell,
                  myList);          
      END;
      rowNum := rowNum + 1;
      index := index + 1;
   UNTIL myString = '';
END;
</PRE>
 The <CODE>MyAddItemsFromStringList</CODE> procedure defined in <A HREF=#MARKER-9-154>Listing 4-4</A> adds strings from a string list resource to the end of a list. It keeps track of the index of the string in the string list with the <CODE>index</CODE> variable, and it tracks the number of the new row to add in the <CODE>rowNum</CODE> variable. <P>
 The <CODE>MyAddItemsFromStringList</CODE> procedure adds a new row by calling the <CODE>LAddRow</CODE> function. The first parameter to <CODE>LAddRow</CODE> specifies the number of rows to add, and the second parameter specifies the row number of the first new row. <CODE>LAddRow</CODE> returns the row number of the first row added, which differs from the second parameter only if that parameter specifies a row number that is out of range.<P>
 After creating a new row, <CODE>MyAddItemsFromStringList</CODE> sets the cell in the first column of the added row to the text contained within the string. Note that the procedure does not copy the length byte of the string.<A NAME=MARKER-2-156></A><P>
 To add columns to a list, your application can use the <CODE>LAddColumn</CODE> function, which works just like <CODE>LAddRow</CODE>.<P>
 To delete a row or column from a list, your application can call the <CODE>LDelRow</CODE> procedure or the <CODE>LDelColumn</CODE> procedure. The first parameter of each of these procedures is <BR>the number of rows (or columns) to delete, and the second parameter is the row or column number of the first to be deleted. For example, this code deletes the first row <BR>of a list:<P>
<PRE>
LDelRow(1, 0, myList);{#rows to delete, starting row number}
</PRE>
 <A NAME=MARKER-2-350></A>When making many changes to a list, your application should temporarily disable the automatic drawing mode (unless the list is in a window that is not yet visible). To do so, call the <CODE>LSetDrawingMode</CODE> procedure to turn off the automatic drawing mode, make the changes to the list, turn the automatic drawing mode back on, and redraw the list (by invalidating a rectangle containing the list and its scroll bars and later calling the <CODE>LUpdate</CODE> procedure when your application receives an update event). You might do these steps as follows:<A NAME=MARKER-2-84></A><P>
<PRE>
LSetDrawingMode (FALSE, myList);
{...(make changes to the list)...}
LSetDrawingMode (TRUE, myList);
InvalRect(myList^^.rView);
IF (myList^^.vScroll &lt;&gt; NIL) THEN
   InvalRect(myList^^.vScroll^^.contrlRect);
IF (myList^^.hScroll &lt;&gt; NIL) THEN
   InvalRect(myList^^.hScroll^^.contrlRect);
</PRE>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-210.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-212.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
