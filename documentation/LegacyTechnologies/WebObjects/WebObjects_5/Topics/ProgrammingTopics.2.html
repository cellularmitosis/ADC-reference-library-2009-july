<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML EXPERIMENTAL 970324//EN"><HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><TITLE> Working With Dates in WebObjects</TITLE></HEAD><BODY bgcolor="#ffffff">		<!-- start of header -->		<!--#include virtual="/includes/framesetheader" -->		<!-- end of header --><!-- start of path --><table cellspacing=0 border=0 width=600 valign="left"><tr><td scope="row"><font face="Geneva,Helvetica,Arial" size="1"><b>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="../../index.html" target="_top">Documentation</a> <b>></b> <a href="../webobjects.html" target="_top">WebObjects</a></font></td></tr></table><br><!-- end of path --><DIV><a name="top"></a><A HREF="TopicsTOC.html"><img src="up.gif" border="0" alt="Up"></A><nobr>&nbsp;</nobr><A HREF="TopicsTOC.html"><img src="previous.gif" border="0" alt="Previous"></A><nobr>&nbsp;</nobr><A HREF="ProgrammingTopics.3.html"><img src="next.gif" border="0" alt="Next"></A></DIV><H1 CLASS="TopictTitle"><A NAME="pgfId=606100"> </A>Working With Dates in WebObjects</H1><DIV><H2 CLASS="Synopsis"><A NAME="pgfId=606101"> </A>Synopsis</H2><P CLASS="Body"><A NAME="pgfId=606102"> </A>Describes how you write WebObjects applications that present and allow entry of dates. Shows you why you should disable &quot;natural language processing&quot; and why your dates should use four-digit years.</P></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606103"> </A>Discussion</H2><P CLASS="Body"><A NAME="pgfId=618265"> </A>The approach of the new millennium has given rise to a number of concerns about how dates are being handled in computer programs. The so-called &quot;Y2K&quot; problem relates to both how dates are stored internally, and how they're displayed and accepted as input.</P><P CLASS="Body"><A NAME="pgfId=618270"> </A>Writing software that is &quot;Y2K-compliant,&quot; or modifying an existing program so that it becomes Y2K-compliant, requires that you have a solid understanding of the software package that you are using to represent and manipulate dates. Unfortunately, that package is typically complex, mirroring the fact that dates themselves are complex objects and that any package that works with dates needs to be extremely flexible in order to be useful in the largest number of situations.</P><P CLASS="Body"><A NAME="pgfId=618275"> </A>In a WebObjects application, you work with date objects--which store the date values internally--and <EM CLASS="Emphasis">formatters</EM>--which translate between the internal representation and a textual one. While these objects can be used in a Y2K-compliant fashion, they can also be used in a way that is not Y2K compliant. This paper introduces the various objects you use when working with dates, and shows you how to avoid writing WebObjects applications that will fail in the new millennium.</P><DIV><H3 CLASS="Heading2"><A NAME="pgfId=618288"> </A>Date Objects</H3><P CLASS="Body"><A NAME="pgfId=618292"> </A>On the server, WebObjects applications use a standard date object provided by the Foundation layer to contain date values. The NSGregorianDate class (NSCalendarDate in Objective-C) represents concrete date objects and performs date computations based on the Gregorian calendar. These date objects store a date as the number of seconds relative to the absolute reference date (January 1 2001, GMT).</P><P CLASS="Body"><A NAME="pgfId=618297"> </A>On the client-side of a Java Client application, dates are represented using a version of NSCalendarDate that is a simple subclass of <TT CLASS="Code">java.util.Date</TT>. Because the underlying object differs (NSGregorianDate on the server, <TT CLASS="Code">java.util.Date</TT> on the client), the behavior of a given date object could conceivably change depending on whether it is running on the client or on the server (see the reference documentation for the NSGregorianDate class and the <TT CLASS="Code">java.util.Date</TT> documentation provided with the JDK (and with WebObjects) for specifics on how these objects behave).</P><P CLASS="Body"><A NAME="pgfId=618314"> </A>In a server-based WebObjects application, users frequently interact with date objects through WOTextFields (date values can also be displayed using WOStrings). To map between the textual representation of a date and the internal representation that a date object uses, Foundation relies on <EM CLASS="Emphasis">formatter</EM> objects.</P><DIV><H4 CLASS="Heading3"><A NAME="pgfId=618327"> </A>Server-Side Date Formatters</H4><P CLASS="Body"><A NAME="pgfId=618331"> </A>WOTextField relies on a date formatter when formatting dates for display and interpreting user-entered dates. This formatter (NSGregorianDateFormatter for Java applications, NSDateFormatter for Objective-C and WebScript applications) allows great flexibility in formatting dates: &quot;Thu 22 Dec 1994&quot; and &quot;12/12/94&quot; are two possibilities.</P><P CLASS="Body"><A NAME="pgfId=618336"> </A>The Gregorian date formatter has two attributes: a format string and a &quot;natural language processing&quot; flag. The format string is constructed from a set of date conversion specifiers and explicitly specifies the display format or the expected date entry format. You specify the format that a WOTextField or WOString should use either by binding the format string to the element's <TT CLASS="Code">dateFormat</TT> attribute or by binding a date formatter that was instantiated with the desired format string to the element's <TT CLASS="Code">formatter</TT> attribute.</P><TABLE BORDER="1" CELLPADDING="3"><B><CAPTION><P CLASS="TableTitle"><A NAME="pgfId=618356"> </A>Date Formatter Conversion Specifiers&nbsp;</P></CAPTION></B><TR><TH ROWSPAN="1" COLSPAN="1"><P CLASS="CellHeading"><A NAME="pgfId=618362"> </A>Specifier</P></TH><TH ROWSPAN="1" COLSPAN="1"><P CLASS="CellHeading"><A NAME="pgfId=618365"> </A>Description</P></TH></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618369"> </A>%%</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618372"> </A>a `%' character</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618376"> </A>%a</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618379"> </A>abbreviated weekday name</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618383"> </A>%A</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618386"> </A>full weekday name</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618390"> </A>%b</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618393"> </A>abbreviated month name</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618397"> </A>%B</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618400"> </A>full month name</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618404"> </A>%c</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618407"> </A>shorthand for &quot; %X %x&quot;, the locale format for date and time</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618411"> </A>%d</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618414"> </A>day of the month as a decimal number (01-31)</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618418"> </A>%e</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618421"> </A>same as %d without the leading 0 for days 1 through 9</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618425"> </A>%F</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618428"> </A>milliseconds as a decimal number</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618432"> </A>%H</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618435"> </A>hour based on a 24-hour clock as a decimal number (00-23)</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618439"> </A>%I</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618442"> </A>hour based on a 12-hour clock as a decimal number (01-12)</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618446"> </A>%j</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618449"> </A>day of the year as a decimal number (001-366)</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618453"> </A>%m</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618456"> </A>month as a decimal number (01-12)</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618460"> </A>%M</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618463"> </A>minute as a decimal number (00-59)</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618467"> </A>%p</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618470"> </A>AM/PM designation for the locale</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618474"> </A>%S</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618477"> </A>second as a decimal number (00-59)</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618481"> </A>%w</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618484"> </A>weekday as a decimal number (0-6), where Sunday is 0</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618488"> </A>%x</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618491"> </A>date using the date representation for the locale</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618495"> </A>%X</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618498"> </A>time using the time representation for the locale</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618502"> </A>%y</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618505"> </A>year without century (00-99)</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618509"> </A>%Y</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618512"> </A>year with century (such as 1990)</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618516"> </A>%Z</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618519"> </A>time zone abbreviation (such as PDT)</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618523"> </A>%z</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618526"> </A>time zone offset in hours and minutes from GMT (HHMM)</P></TD></TR></TABLE></DIV><DIV><H4 CLASS="Heading3"><A NAME="pgfId=618537"> </A>Natural Language Processing of Dates</H4><P CLASS="Body"><A NAME="pgfId=618541"> </A>The natural language processing flag adds an extra level of intelligence to the interpretation of strings: if the entered string doesn't match the date format string and natural language processing has been requested, the date formatter attempts to interpret the date anyway. This allows users to enter dates in a more colloquial fashion: &quot;today,&quot; &quot;the day after tomorrow,&quot; and &quot;a month from today&quot; are all valid input.</P><P CLASS="Body"><A NAME="pgfId=618546"> </A>Although natural language processing might appear to be a good thing, in actual practice it introduces a level of ambiguity that is difficult to ignore. Imprecision in the English language is partly to blame: the word &quot;Tuesday&quot; by itself isn't absolute: <EM CLASS="Emphasis">which</EM> Tuesday does it refer to? (The natural language processor assumes &quot;next Tuesday.&quot;) Phrases like &quot;last Tuesday&quot; and &quot;next Tuesday&quot; are interpreted as you would expect, and &quot;next week&quot; is translated as &quot;one week from today.&quot; But the natural language processor has its limits: &quot;a week ago last Tuesday&quot; gives the same result as &quot;last Tuesday&quot;--which may or may not be what you want.</P><P CLASS="Body"><A NAME="pgfId=618555"> </A>The natural language processing logic can also be a problem when working with numeric dates when the date doesn't match the format string or the format string isn't supplied (In Objective-C, NSCalendarDate's <TT CLASS="Code">dateWithNaturalLanguageString:</TT> method engages the natural language processing logic directly, bypassing any attempt at matching to a format string).</P></DIV><DIV><H4 CLASS="Heading3"><A NAME="pgfId=618573"> </A>Disabling Natural Language Processing</H4><P CLASS="Body"><A NAME="pgfId=618577"> </A>Although the use of natural language processing is discouraged, WebObjects assumes its use by default. Further, when you bind a date object to a WOTextField or WOString, although there is an attribute that allows you to specify the format string directly in the binding, there isn't a corresponding attribute that allows you to enable or disable natural language processing. In order to disable it, you must explicitly create and use a formatter object. You can create this object in a number of places: in your application's constructor (or <TT CLASS="Code">init</TT> method), in your component's <TT CLASS="Code">awake</TT> method, or in a particular method as needed. In Java, you can create a date formatter with natural language processing disabled like this:</P><PRE CLASS="Code"><A NAME="pgfId=618594"> </A>NSGregorianDateFormatter dateFormatter = <A NAME="pgfId=618600"> </A>	new NSGregorianDateFormatter(&quot;%m/%d/%Y&quot;, false);</PRE><P CLASS="Body"><A NAME="pgfId=618605"> </A>In Objective-C or WebScript, do this:</P><PRE CLASS="Code"><A NAME="pgfId=618613"> </A>_dateFormatter = [[NSDateFormatter alloc]<A NAME="pgfId=618619"> </A>	initWithDateFormat:@&quot;%m/%d/%Y&quot; allowNaturalLanguage:NO];</PRE><P CLASS="Body"><A NAME="pgfId=618623"> </A>Note that when applying a date formatter to a cell using Interface Builder in a Java Client application, you're presented with a checkbox that allows you to select or de-select natural language processing. On the client side, the underlying objects are part of the JDK and have no such natural language processing ability. Thus, this checkbox has no effect.</P></DIV><DIV><H4 CLASS="Heading3"><A NAME="pgfId=618634"> </A>Client-Side Date Formatters</H4><P CLASS="Body"><A NAME="pgfId=618638"> </A>Java Client applications use NSGregorianDateFormatter objects to translate between the internal representation of a date and a string representation. On the client, the NSGregorianDateFormatter class inherits from <TT CLASS="Code">java.text.SimpleDateFormat</TT> (on the server, it inherits from NSFormatter). Although the NSGregorianDateFormatter is essentially the same class on both the client and the server, the client-side version doesn't support natural language processing. </P><P CLASS="Body"><A NAME="pgfId=618651"> </A>Since NSGregorianDateFormatter exists on the client, you use the same date formatter conversion specifiers in your Java Client applications as you do for your server-based applications, with one exception: the <TT CLASS="Code">%c</TT> format specifier isn't supported on the client and thus shouldn't be used in Java Client applications (<TT CLASS="Code">%c</TT> is shorthand for &quot;%X %x&quot;, the locale format for date and time).</P></DIV></DIV><DIV><H3 CLASS="Heading2"><A NAME="pgfId=618670"> </A>Years as Two or Four Digits</H3><P CLASS="Body"><A NAME="pgfId=618674"> </A>The server-side date formatter has two format specifiers specifically for handling years: <TT CLASS="Code">%y</TT> deals with years represented using two digits, while <TT CLASS="Code">%Y</TT> deals with four-digit years. </P><P CLASS="Body"><A NAME="pgfId=618691"> </A>The use of <TT CLASS="Code">%y</TT> is not recommended due to possible misinterpretation of years before and after the year 2000. Specifying a date of &quot;1/1/99&quot; is conventionally understood to mean January 1, 1999, but it's less clear what is meant by a date of &quot;1/1/00&quot;; is this January 1, 1900, or January 1, 2000? The way in which a two-digit year is interpreted by the date formatter changed in WebObjects 4.0. Prior to 4.0, two digit years were all considered to be offsets from 1900: the year &quot;05,&quot; for example, meant 1905. Recognizing that a format specifier of <TT CLASS="Code">%y</TT> prevented the entry of years after 1999, however, the meaning of a two-digit year was changed in the version of Foundation that shipped with WebObjects 4.0: years from &quot;00&quot; to &quot;29&quot; are now interpreted relative to the year 2000, while &quot;30&quot; to &quot;99&quot; are relative to 1900, as before. Thus, &quot;1/1/29&quot; is assumed to be January 1, 2029, while &quot;1/1/30&quot; works out to January 1, 1930.</P><P CLASS="Body"><A NAME="pgfId=618704"> </A>To further complicate the issue, if your server-side formatter uses<TT CLASS="Code"> %y</TT> (for instance, &quot;%m/%d/%y&quot;) and the user enters a date with a four-digit year (&quot;1/1/2000&quot;, for example), the formatter takes you at your word and only looks at the first two digits of the year. It then applies the algorithm described in the above paragraph, making those two digits relative to 1900 or 2000, depending on the version of WebObjects. So, for example, if you are running WebObjects 4.0 and your formatter uses &quot;%m/%d/%y&quot;, an entry of &quot;1/1/2000&quot; is interpreted as <BR>&quot;1/1/2020&quot;--and is redisplayed as &quot;1/1/20&quot;. </P><P CLASS="Body"><A NAME="pgfId=618713"> </A>Given the problems with the <TT CLASS="Code">%y</TT> format specifier, most server-based WebObjects applications should use <TT CLASS="Code">%Y</TT>. This format specifier accepts both two-digit and four-digit years. However, the way in which it interprets two-digit years depends on whether or not natural language processing is active, and is not always intuitive. For instance, with natural language processing turned off, two-digit years are taken literally: the year &quot;29&quot; really is the year 29. If natural language processing is used (meaning that it is turned on and the entered date doesn't match the format string), however, two-digit years are interpreted as with <TT CLASS="Code">%y</TT>: in versions of WebObjects prior to 4.0, they are offsets from 1900; in WebObjects 4.0 and later, &quot;00&quot;-&quot;29&quot; are offsets from 2000, while &quot;30&quot;-&quot;99&quot; are offsets from 1900.</P><P CLASS="Body"><A NAME="pgfId=618726"> </A>Be aware that small variations in the user's input can cause natural language processing to be enabled or disabled (assuming that it isn't turned off). If your format string is &quot;%m/%d/%y&quot;, an entry of &quot;1/1/99&quot; doesn't activate natural language processing, while an entry of &quot;1-1-99&quot; does.</P><P CLASS="Body"><A NAME="pgfId=618731"> </A>The following two tables summarize this behavior (the first table applies to WebObjects 4.0 and later versions, while the second applies to WebObjects 3.51 and earlier versions):</P><TABLE BORDER="1" CELLPADDING="3"><B><CAPTION><P CLASS="TableTitle"><A NAME="pgfId=618739"> </A><A NAME="11355"> </A>Summary of Year Behavior in WebObjects 4.0 and later&nbsp;</P></CAPTION></B><TR><TH ROWSPAN="2" COLSPAN="1"><P CLASS="CellHeading"><A NAME="pgfId=618749"> </A>Year Entered</P></TH><TH ROWSPAN="1" COLSPAN="3"><P CLASS="CellHeading"><A NAME="pgfId=618752"> </A>Year Stored in Date Object</P></TH></TR><TR><TH ROWSPAN="1" COLSPAN="1"><P CLASS="CellHeading"><A NAME="pgfId=618765"> </A>%y</P></TH><TH ROWSPAN="1" COLSPAN="1"><P CLASS="CellHeading"><A NAME="pgfId=618768"> </A>%Y, <BR>NLP enabled</P></TH><TH ROWSPAN="1" COLSPAN="1"><P CLASS="CellHeading"><A NAME="pgfId=618771"> </A>%Y, <BR>NLP disabled</P></TH></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618783"> </A>00</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618786"> </A>2000</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618789"> </A>2000</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618796"> </A>nil</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618800"> </A>29</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618803"> </A>2029</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618806"> </A>2029</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618809"> </A>29</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618813"> </A>30</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618816"> </A>1930</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618819"> </A>1930</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618822"> </A>30</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618826"> </A>99</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618829"> </A>1999</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618832"> </A>1999</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618835"> </A>99</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618839"> </A>1900</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618846"> </A>2019</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618849"> </A>1900</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618852"> </A>1900</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618856"> </A>1929</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618859"> </A>2019</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618862"> </A>1929</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618865"> </A>1929</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618869"> </A>1999</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618872"> </A>2019</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618875"> </A>1999</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618878"> </A>1999</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618882"> </A>2000</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618885"> </A>2020</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618888"> </A>2000</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618891"> </A>2000</P></TD></TR></TABLE><P CLASS="CellHeading"><A NAME="pgfId=621063"> </A>TABLE NOTES</P><UL><LI CLASS="Bulleted"><A NAME="pgfId=621096"> </A>In WebObjects 4.0 and in earlier versions, there is a bug in NSDateFormatter that causes the current year to be used if natural language parsing is enabled, %y is specified, and a year of &quot;00&quot; is entered. This bug was fixed in WebObjects 4.0.1.</LI><LI CLASS="Bulleted"><A NAME="pgfId=621115"> </A>In WebObjects 4.0 and later, the %Y format specifier doesn't accept &quot;00&quot; as a valid year.</LI><LI CLASS="Bulleted"><A NAME="pgfId=621119"> </A>Regarding the last four entries in the %y column: although these years are stored in the date object as indicated in the table, only the first two digits are accepted as input by the %y date formatter. Then, because the %y formatter displays only the year within the century, they are displayed as &quot;19&quot; or &quot;20&quot; in these cases.</LI></UL><P CLASS="Body"><A NAME="pgfId=621064"> </A></P><TABLE BORDER="1" CELLPADDING="3"><B><CAPTION><P CLASS="TableTitle"><A NAME="pgfId=618901"> </A><A NAME="30334"> </A>Summary of Year Behavior in WebObjects 3.51 and earlier&nbsp;</P></CAPTION></B><TR><TH ROWSPAN="2" COLSPAN="1"><P CLASS="CellHeading"><A NAME="pgfId=618911"> </A>Year Entered</P></TH><TH ROWSPAN="1" COLSPAN="3"><P CLASS="CellHeading"><A NAME="pgfId=618914"> </A>Year Stored in Date Object</P></TH></TR><TR><TH ROWSPAN="1" COLSPAN="1"><P CLASS="CellHeading"><A NAME="pgfId=618927"> </A>%y</P></TH><TH ROWSPAN="1" COLSPAN="1"><P CLASS="CellHeading"><A NAME="pgfId=618930"> </A>%Y, <BR>NLP enabled</P></TH><TH ROWSPAN="1" COLSPAN="1"><P CLASS="CellHeading"><A NAME="pgfId=618933"> </A>%Y, <BR>NLP disabled</P></TH></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618945"> </A>00</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618948"> </A>1900</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618951"> </A>1900</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618954"> </A>0</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618958"> </A>29</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618961"> </A>1929</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618964"> </A>1929</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618967"> </A>29</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618971"> </A>30</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618974"> </A>1930</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618977"> </A>1930</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618980"> </A>30</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618984"> </A>99</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618987"> </A>1999</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618990"> </A>1999</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618993"> </A>99</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=618997"> </A>1900</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=619004"> </A>1919</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=619007"> </A>1900</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=619010"> </A>1900</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=619014"> </A>1929</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=619017"> </A>1919</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=619020"> </A>1929</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=619023"> </A>1929</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=619027"> </A>1999</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=619030"> </A>1919</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=619033"> </A>1999</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=619036"> </A>1999</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=619040"> </A>2000</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=619043"> </A>1920</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=619046"> </A>2000</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="CellBody"><A NAME="pgfId=619049"> </A>2000</P></TD></TR></TABLE><P CLASS="CellHeading"><A NAME="pgfId=621157"> </A>TABLE NOTES</P><UL><LI CLASS="Bulleted"><A NAME="pgfId=621158"> </A>In WebObjects 4.0 and in earlier versions, there is a bug in NSDateFormatter that causes the current year to be used if natural language parsing is enabled, %y is specified, and a year of &quot;00&quot; is entered. This bug was fixed in WebObjects 4.0.1.</LI><LI CLASS="Bulleted"><A NAME="pgfId=621160"> </A>Regarding the last four entries in the %y column: although these years are stored in the date object as indicated in the table, only the first two digits are accepted as input by the %y date formatter. Then, because the %y formatter displays only the year within the century, they are displayed as &quot;19&quot; or &quot;20&quot; in these cases.</LI></UL><P CLASS="Body"><A NAME="pgfId=619056"> </A>For most WebObjects applications, the right-most column in the two tables above represent the recommended approach, combined with code to validate the year.</P><DIV><H4 CLASS="Heading3"><A NAME="pgfId=619065"> </A>Validating Dates</H4><P CLASS="Body"><A NAME="pgfId=619073"> </A>Because of the possibly unexpected behavior when your formatter uses <TT CLASS="Code">%Y</TT> and your application's user enters a two-digit year, you may want to disable natural language processing and then implement a validation method on your enterprise objects that &quot;sanity-checks&quot; the year portion of any entered date.</P><P CLASS="Body"><A NAME="pgfId=619078"> </A>Objects that inherit from EOCustomObject or EOGenericRecord inherit a default implementation of EOValidation. The default implementation of EOValidation's <TT CLASS="Code">validateValueForKey</TT> method searches for a method of the form <TT CLASS="Code">validate</TT><EM CLASS="Emphasis">Key</EM> (where <EM CLASS="Emphasis">Key</EM> is the name of one of a class's properties) and invokes it if it exists. Thus, as long as your objects inherit from EOCustomObject or EOGenericRecord, you need only implement the appropriate <TT CLASS="Code">validate</TT><EM CLASS="Emphasis">Key</EM> method to validate a given enterprise object property. </P><P CLASS="Body"><A NAME="pgfId=619111"> </A>For more information on validating enterprise object attributes, see the online reference documentation for EOControl's EOValidation interface.</P></DIV><DIV><H4 CLASS="Heading3"><A NAME="pgfId=619121"> </A>Two-Digit Years on the Client</H4><P CLASS="Body"><A NAME="pgfId=619129"> </A>The SimpleDateFormat object that's part of the <TT CLASS="Code">java.text</TT> package uses different logic to interpret years entered with two digits. When the formatter specifies a two-digit (&quot;abbreviated&quot;) year, SimpleDateFormat interprets the entry by adjusting the date to be within 80 years before and 20 years after the time the SimpleDateFormat instance was created. Thus, for example, using a pattern of &quot;MM/dd/yy&quot; and a SimpleDateFormat instance created on Jan 1, 1997, the string &quot;01/11/12&quot; would be interpreted as Jan 11, 2012 while the string &quot;05/04/64&quot; would be interpreted as May 4, 1964.</P></DIV></DIV><DIV><H3 CLASS="Heading2"><A NAME="pgfId=619140"> </A>API Differences between Objective-C and Java</H3><P CLASS="Body"><A NAME="pgfId=619144"> </A>Unlike most of the classes in the Foundation framework, the Java and Objective-C versions of the date classes differ in some fairly important respects. As mentioned earlier, in Java you work with NSGregorianDate and NSGregorianDateFormatter objects, while in Objective-C you work with NSCalendarDate and NSDateFormatter objects. Although the NSGregorianDateFormatter and NSDateFormatter objects are closely related, the date objects themselves aren't.</P><P CLASS="Body"><A NAME="pgfId=619149"> </A>The NSGregorianDate and NSCalendarDate classes are both designed specifically for working with dates that are based upon the Gregorian calendar. NSCalendarDate, however, is the more flexible of the two. When constructing or initializing an NSCalendarDate from an NSString, for example, you don't need an NSDateFormatter; NSCalendarDate has methods that allow you to specify the format string directly (<TT CLASS="Code">+&nbsp;dateWithString:...</TT> and <TT CLASS="Code">-&nbsp;initWithString:...</TT>, respectively). NSGregorianDate, on the other hand, has no such methods. As well, the Objective-C version of NSDate has two class methods that return an NSDate object initialized solely from an NSString using natural language processing (<TT CLASS="Code">+&nbsp;dateWithNaturalLanguageString:...</TT>). These methods are not available to the Java programmer.</P><P CLASS="Body"><A NAME="pgfId=619166"> </A>Finally, the Objective-C date classes allow you to take advantage of a locale dictionary that contains a set of implicit calendar formats. This dictionary is not used by the Java date classes.</P></DIV><DIV><H3 CLASS="Heading2"><A NAME="pgfId=619176"> </A>For More Information</H3><P CLASS="Body"><A NAME="pgfId=619180"> </A>When working with date objects, be sure to read through the documentation carefully. Relevant documentation for server-based applications can be found under NSDate, NSGregorianDate, NSFormatter, and NSGregorianDateFormatter if you're programming in Java, and under NSDate, NSCalendarDate, NSFormatter, and NSDateFormatter if you're working in Objective-C or WebScript. (Be aware that this documentation has been written with the AppKit programmer in mind; you'll find numerous references to AppKit's NSCell class.) For programmers developing Java Client applications, the documentation for Sun's JDK 1.1.6 is installed along with WebObjects Developer and can be accessed through the WebObjects Info Center (under Reference-&gt;JavaSoft), or can be accessed over the Internet at <TT CLASS="Code">http://www.javasoft.com</TT>.</P></DIV></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606161"> </A>See Also</H2><UL><LI CLASS="Bulleted"><A NAME="pgfId=613729"> </A>(Java) NSDate, NSGregorianDate, NSFormatter, NSGregorianDateFormatter in <EM CLASS="Emphasis">Foundation Framework Reference</EM></LI><LI CLASS="Bulleted"><A NAME="pgfId=619453"> </A>(Objective-C) NSDate, NSCalendarDate, NSFormatter, NSDateFormatter in <EM CLASS="Emphasis">Foundation Framework Reference</EM></LI><LI CLASS="Bulleted"><A NAME="pgfId=613739"> </A>Sun's JDK 1.1.6 documentation (Reference-&gt;JavaSoft in the WOInfoCenter)</LI></UL></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606163"> </A>Questions</H2><UL><LI CLASS="Bulleted"><A NAME="pgfId=606164"> </A>How do I handle 2-digit years?</LI><LI CLASS="Bulleted"><A NAME="pgfId=606165"> </A>How can I make my WebObjects application year-2000 compliant?</LI><LI CLASS="Bulleted"><A NAME="pgfId=619405"> </A>How do I use the date formatters?</LI></UL></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606166"> </A>Keywords</H2><UL><LI CLASS="Bulleted"><A NAME="pgfId=606167"> </A>Dates</LI><LI CLASS="Bulleted"><A NAME="pgfId=618199"> </A>Y2K</LI><LI CLASS="Bulleted"><A NAME="pgfId=619390"> </A>Year 2000</LI><LI CLASS="Bulleted"><A NAME="pgfId=619401"> </A>Date Formatter</LI></UL></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606169"> </A>Revision History</H2><P CLASS="Body"><A NAME="pgfId=606170"> </A>27 April, 1999. Greg Wilson. First Draft.</P><P CLASS="Body"><A NAME="pgfId=612729"> </A></P></DIV><hr alt="">&#169 1999 Apple Computer, Inc.<P><A HREF="TopicsTOC.html"><img src="up.gif" border="0" alt="Up"></A><nobr>&nbsp;</nobr><A HREF="TopicsTOC.html"><img src="previous.gif" border="0" alt="Previous"></A><nobr>&nbsp;</nobr><A HREF="ProgrammingTopics.3.html"><img src="next.gif" border="0" alt="Next"></A><!-- start of footer --><!--#include file="footer" --><!-- end of footer --><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></HTML>