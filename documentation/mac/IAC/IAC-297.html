<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Compiling, Saving, Modifying, and Executing Scripts(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING297></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-296.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-298.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-288.html"><B>Chapter 7 - Introduction to Scripting</B></A> / <A HREF="IAC-296.html"><B>Manipulating and Executing Scripts</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING297-0></A>
<H2><A NAME=MARKER-9-73></A>Compiling, Saving, Modifying, and Executing Scripts</H2>
 This section introduces some of the scripting component functions your application can use to compile, save, modify, and execute scripts.<P>
 To create and execute a script using the Script Editor application, a user can type the script, then press the Run button to execute it. Your application can provide similar capabilities by using these functions to compile source data and execute the resulting compiled script:<P>
<UL>
<LI>The <CODE>OSACompile</CODE> function takes a descriptor record with a handle to source data (usually text) and a script ID. If you specify <CODE>kOSANullScript</CODE> instead of an existing script ID, <CODE>OSACompile</CODE> returns a script ID for the new compiled script, which you can then pass to the <CODE>OSAExecute</CODE> function.
<LI>The <CODE>OSAExecute</CODE> function takes a script ID for a compiled script and a script ID for a script context, executes the script, and returns a script ID for the resulting script value.<P>
</UL>
 The binding of any global variables in the compiled script is determined by the script context whose script ID you pass to <CODE>OSAExecute</CODE>. If you pass <CODE>kOSANullScript</CODE> instead of the script ID for a script context, the scripting component provides its own default context. If you want to provide your own script context rather than using the scripting component default context, you can use either <CODE>OSACompile</CODE> or <CODE>OSAMakeContext</CODE> to create a script context, which you can load and store just like a compiled script.<P>
 After creating a script and trying it out, a user may want to save it for future use. Your application should normally save its scripts as script data rather than source data, so that it can reload and execute the data without recompiling it. Before saving script data, you must first call the <CODE>OSAStore</CODE> function to get a handle to the data in the form of a descriptor record. You can then save the data to disk as a resource or write it to the data fork of a document. <P>
 To allow a user to reload and execute a previously compiled and saved script, your application can call these functions:<P>
<UL>
<LI>The <CODE>OSALoad</CODE> function takes a descriptor record that contains a handle to the saved script data and returns a script ID for the compiled script.
<LI>The <CODE>OSAExecute</CODE> function takes a script ID for a compiled script and a script ID for a script context, executes the script, and returns a script ID for the resulting script value.<P>
</UL>
 In most cases you will want to allow users to modify saved scripts and save them again. To allow a user to modify and save a compiled script, your application can call these functions:<P>
<UL>
<LI>The <CODE>OSAGetSource</CODE> function takes a script ID and returns a descriptor record with a handle to the equivalent source data.
<LI>The <CODE>OSACompile</CODE> function takes a descriptor record with a handle to source data and a script ID, and returns the same script ID updated so that it refers to the modified and recompiled script.
<LI>The <CODE>OSAStore</CODE> function takes a script ID and returns a copy of the corresponding script data in the form of a storage descriptor record.<P>
</UL>
 You can pass the script ID for the compiled script to be modified to the <CODE>OSAGetSource</CODE> function, which returns a descriptor record with a handle to the equivalent source data. Your application can then present the source data to the user for editing. When the user has finished editing the source data, you can pass the modified source data and the original script ID to the <CODE>OSACompile</CODE> function to update the script ID so that it refers to the modified and recompiled script. Finally, to obtain a handle to the modified script data so you can save it in a resource or write it to the data fork of a document, you can pass the script ID for the modified compiled script to the <CODE>OSAStore</CODE> function. <P>
 If your application has no further use for a compiled script or a resulting script value after successfully loading, saving, compiling, or executing a script, you can use the <CODE>OSADispose</CODE> function to release the memory assigned to them. The <CODE>OSADispose</CODE> function takes a script ID and releases the memory assigned to the corresponding script data. A script ID is no longer valid after the memory associated with it has been released. This means, for example, that a scripting component may assign a different script ID to the same compiled script each time you load it, and that a scripting component may reuse a script ID that is no longer associated with a specific script.<P>
 <A HREF=IAC-333.html#MARKER-9-86>"Using Scripting Component Routines,"</A> which begins on <A HREF=IAC-333.html#MARKER-9-86>page 10-7</A>, provides more information about the standard scripting component routines described in this section. <P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-296.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-298.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
