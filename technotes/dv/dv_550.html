<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!-- Template 01-August-01 --><!-- Includes revisions to graphics tags --><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note DV550: SCSI Manager Q&amp;As</title><meta name="keywords" content="Mac OS 8 SCSI Manager drivers reselection VM virtual memory"><meta name="Description" content="Technical Note DV550: This Technical Note contains a collectionof archived Q&amp;As relating to the SCSI Manager--questionssent the Developer Support Center (DSC) along with answersfrom the DSC engineers. Archived Q&amp;As include: what rulesand documentation about Virtual Memory, SCSI driving andSystem 7 exist; Can VM be disabled from a SCSI driver andhow to determine what volume the virtual swap file resides;target reselection and the SCSI Manager; and where to getSCSI Manager sample code.">                                      <meta name="categories" content="Devices"><meta name="week-posted" content="Oct 1, 1990 - Oct 5, 1990"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002424" title="SCSI Manager Q&As"></a><A NAME="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxMacOS9Earlier-date.html">Mac OS 9 & Earlier</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/HardwareDrivers/idxAccessibility-date.html" target="_blank">Hardware & Drivers > Accessibility</a></li>
		<li><a href="../../referencelibrary/HardwareDrivers/idxSCSI-date.html" target="_blank">Hardware & Drivers > SCSI</a></li>
		<li><a href="../../referencelibrary/HardwareDrivers/idxMassStorageDevices-date.html" target="_blank">Hardware & Drivers > Storage</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note DV550</div>
<div id="pageheadsub">SCSI Manager Q&amp;As</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc --><p id="menutext"><a href="#Section1">Documentation describing VM/SCSI driver requirements</a><BR><BR><a href="#Section2">SCSI drivers and virtual memory</a><BR><BR><a href="#Section3">Macintosh SCSI reselection</a><BR><BR><a href="#Section4">Where to get Macintosh SCSI Manager sample code</a><BR><BR><A HREF="#downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><p id = "introtext">This Technical Note contains a collection of archived Q&amp;As relating to a specifictopic--questions sent the Developer Support Center (DSC) along with answers from the DSC engineers. Current Q&amp;As can be found on the <a href="../../qa/index.html">Macintosh Technical Q&amp;As web site</a>.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Oct 01 1990]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><A NAME="Section1"></A><h2>Documentation describing VM/SCSI driver requirements</h2><p>Date Written:  9/10/91</p><p>Last reviewed:  8/1/92</p><p>Are there any new rules regarding SCSI driving with virtual memory? My System 6driver doesn't work with System 7.</p><p>___</p><p>It's important to remember that VM usually uses a SCSI device for its backingstore. As such, if VM needs to use your driver it can't tolerate a driver'spage swap in the middle of a page swap. This means if your driver's code is notin the system heap, it needs to be held when called, and your buffers also needto be held if your driver is entered by a Control or Status call. Buffers areautomatically held by the system if your driver is entered by a Read or Writecall. The following documents provide a good overview of what you need to do torevise a SCSI driver for VM compatibility.</p><ul type="circle">	<li><i>Inside Macintosh Volume</i> VI, which contains new information specific to virtual memory as it relates to drivers and especially SCSI</li>	<li>Macintosh Technical Note <u><A HREF = "../me/me_09.html">"Coping with VM and Memory Mappings"</a></u></li>	<li>"VM Paper" from the System 7 CD in the VM Goodies folder</li></ul><P><A HREF="#top">Back to top</A></P><a name="Section2"></a><h2>SCSI drivers and virtual memory</h2><p>Date Written:  8/30/91</p><p>Last reviewed:  8/1/92</p><p>How can we disable virtual memory (VM) from a SCSI driver, for dequeuing partitions? How can our driver determine which volume the virtual swap file resides upon?</p><p>___</p><p>The use of virtual memory requires that at boot time the PMMU be programmedwith the appropriate memory mapping tables and enabled. The virtual memory isthen laid out in the VM Storage file and available "real" RAM begins to be usedto implement those portions of the virtual memory that need to be resident. Itis not possible to turn this on and off while the machine is running.Specifically, it cannot be disabled / re-enabled from within your SCSI driver.With VM running, you can dismount and remount any disk or partition EXCEPT theunit that contains the VM Storage file. Whenever the system boots with VM on,the Finder makes sure there is only one file of that name mounted anywhere anddeletes any "extra" files it encounters.</p><p>Currently there is no interface for locating the VM Storage file. Since thefile name is guaranteed to be unique, it should be sufficient to search eachvolume for that file name.</p><P><A HREF="#top">Back to top</A></P><a name="Section3"></a><h2>Macintosh SCSI reselection</h2><p>Date Written:  5/24/91</p><p>Last reviewed:  8/1/92</p><p>How should we handle target reselection with the Macintosh SCSI Manager?</p><p>___</p><p>The Macintosh SCSI Manager does not yet support disconnection and reselection.After arbitration and selection, the target device should perform a SCSIMsgOutto identify the logical unit number and especially to see if disconnection andreselection is allowed (bit 6 of the Identify message). The Macintosh currentlyalways sets bit 6 of the Identify message to 0, meaning disconnection is not allowed.</p><p>A target device should always assume that disconnection is not allowed unless it is specifically told otherwise by the Identify message. In this way, the target will do the right thing even if it does not follow protocol and issue a Message Out before requesting the Command.</p><P><A HREF="#top">Back to top</A></P><a name="Section4"></a><h2>Where to get Macintosh SCSI Manager sample code</h2><p>Date Written:  11/30/90</p><p>Last reviewed:  8/1/92</p><p>Can you provide some sample code on using the Macintosh SCSI Manager to access a SCSI device?</p><p>___</p><p>SCSI sample code can be found on Apple's <a href="http://developer.apple.com/samplecode">sample code web site.</A></p><P><A HREF="#top">Back to top</A></P>         <a name="downloads"></a>         <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center>                                    <img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (48K)</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/dv_550.pdf">Download</A></P>               </TD>            </TR>         </TABLE>         <BR><P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/dv/dv_550.html%3Fid%3DDTS10002424-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/dv/dv_550.html%3Fid%3DDTS10002424-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/dv/dv_550.html%3Fid%3DDTS10002424-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --><hr width=500 align=center></BODY></HTML>