<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Recipes--Windows (MacApp PG)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING105></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MacAppProgGuide-104.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-106.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MacAppProgGuide-2.html"><B>Programmer's Guide to MacApp</B></A> / <A HREF="MacAppProgGuide-78.html"><B>Part 2 - Working With MacApp</B></A><BR><DD><A HREF="MacAppProgGuide-103.html"><B>Chapter 18 - Working With Windows</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING105-0></A>
<H1><A NAME=MARKER-2-33></A>Recipes--Windows</H1>
 The recipes and sample code in this section demonstrate how to create a window from a <CODE>'View'</CODE> resource and how to define and use floating windows in your application.<P>
<A NAME=HEADING105-2></A>
<H2><A NAME=MARKER-10-13></A><A NAME=MARKER-9-35></A>Recipe--Creating a Window From a View Resource</H2>
 To create a window from a view resource, you perform these steps:<P>
<OL>
<LI>Define a resource ID constant for the <CODE>'View'</CODE> resource.
<LI>Define the <CODE>'View'</CODE> resource for the window.
<LI>Call the <CODE>gViewServer-&gt;NewTemplateWindow</CODE> method to create a window from the <CODE>'View'</CODE> resource.<P>
</OL>
 The sample code shown in this recipe is from the DemoDialogs application.<P>
<A NAME=HEADING105-8></A>
<H3>Define a Resource ID Constant for the 'View' Resource</H3>
 The DemoDialogs application defines a resource ID for the "Views by Template" view in both its resource definition file and implementation file. In the resource file, <CODE>DemoDialogs.r</CODE>, the ID is defined as<P>
<PRE>
#define cTemplateViews1002
</PRE>
 In the implementation file, <CODE>UDemoDialogs.cp</CODE>, the ID is defined as a constant:<P>
<PRE>
const short cTemplateViews = 1002;
</PRE>
<A NAME=HEADING105-13></A>
<H3>Define the 'View' Resource for the Window</H3>
 You may choose to define a view resource with a view resource editor that creates a compiled resource, then use an <CODE>include</CODE> statement to include the compiled resource into your resource definition file. Or you can convert the compiled resource to text with a resource decompiler and add the text definition to your resource file. This is the approach used in the DemoDialogs application. (For more information on resource formats, see <A HREF=MacAppProgGuide-101.html#MARKER-9-60>"Converting Between Resource Formats," beginning on page 427</A>.)<P>
 The Dialogs menu in the DemoDialogs application contains the Views by Templates command, which creates a window that displays many types of MacApp views. DemoDialogs stores the view hierarchy for this window in a text <CODE><A NAME=MARKER-2-36></A>'View'</CODE> resource definition in the file <CODE>DemoDialogs.r</CODE>. A portion of that resource, including the window definition but not the definitions for all of the enclosed views, is shown on the following page.<P>
<PRE>
resource 'View' (cTemplateViews, purgeable)
{  MAThreeOh, 
   {
      ViewSignatureAndClassname
      {
         'wind', 1862, &quot;&quot;, noID, enabled, noIdle, {}, MAThreeOh, 
         {50, 20}, {260, 430}, sizeVariable, sizeVariable, shown,
         doesntWantToBeTarget, handlesCursor, letsSubViewsHandleCursor,
         noCursorID, handlesHelp, letsSubViewsHandleHelp, noHelpID, 1, 
         NoDrawingEnvironment {}, AdornerListSignatureAndClassname
         {
            noIdentifier, AdornerList, AdornerElementSize, AdornerElementSizeShift,
            DynamicArrayAllocationIncrement,
            {
               AdornFirst, AdornerLocalObject {EraseAdorner}, 
               DrawView, AdornerLocalObject {DrawAdorner}, 
               AdornLast, AdornerLocalObject {ResizeIconAdorner}
            }
         },
         emptyUserArea, 
         Window
         {
            zoomDocProc, 'DLOG', goAwayBox, resizable, doFirstClick, 
            freeOnClosing, disposeOnFree, closesDocument, openWithDocument,
            dontAdaptToScreen, stagger, forceOnScreen, 
            dontCenter, doesntFloat, doesntHideOnSuspend, generateActivates,
            filler, kWindowTitles, 2
         },
         3
      },
      .  // Other views not shown.
      .
      .
   }
}
</PRE>
<A NAME=HEADING105-17></A>
<H3><A NAME=MARKER-9-37></A>Create a Window From the 'View' Resource</H3>
 Once you have defined a view resource for your window and a resource ID constant to identify it, you can create the window using MacApp's global view server object. (The global view server is described in <A HREF=MacAppProgGuide-101.html#MARKER-9-50>"The TViewServer Class," beginning on page 218</A>.) In its <CODE>TTestApplication::MakeTemplateViews</CODE> method, the DemoDialogs application calls <CODE>gViewServer-&gt;NewTemplateWindow</CODE>, passing a command number as the resource ID:<P>
<PRE>
aWindow = gViewServer-&gt;NewTemplateWindow((short)aCommandNumber, NULL);
FailNIL(aWindow);
// Some code not shown.
aWindow-&gt;Open();
</PRE>
 For the "Views by Template" menu command, the variable aCommandNumber has the value cTemplateViews. <CODE>MakeTemplateViews</CODE> calls the window's Open method to display the window.<A NAME=MARKER-10-7></A><P>
<A NAME=HEADING105-21></A>
<H2><A NAME=MARKER-2-39></A>Recipe--Defining and Using a Floating Window</H2>
 The Dialogs menu of the DemoDialogs application has a menu command called Message Windoid. Each time a user chooses Message Windoid, the application opens a small floating window with a title bar, close box, static text view, and text edit view. The window is always drawn in front of other application windows (except other copies of itself) and is hidden when the application is switched to the background. <P>
 The floating window also demonstrates drag and drop--its static text can be dragged, any selected text in the text edit view can be dragged, and dragged text can be dropped in the text edit view.<P>
 To define and use a floating window in your application, you perform these steps:<P>
<OL>
<LI>Include MacApp's <CODE>FloatWindow.r</CODE> file into your resource definition file.
<LI>Call the <CODE>InitUFloatWindow</CODE> initialization method.
<LI>Base your floating windows on the <CODE>TFloatWindow</CODE> class or a subclass.
<LI>Define a resource ID for the <CODE>'View'</CODE> resource.
<LI>Use the <CODE>'fwnd'</CODE> resource type to define a floating window <CODE>'View'</CODE> resource.
<LI>Call <CODE>NewTemplateWindow</CODE> to create the floating window.<P>
</OL>
 The sample code shown in this recipe is from the DemoDialogs application.<P>
<A NAME=HEADING105-32></A>
<H3>Include MacApp's FloatWindow.r File Into Your Resource File</H3>
 MacApp supplies floating window information your application needs in the file <CODE>FloatWindow.r</CODE>. DemoDialogs includes that information into its resource definition file, <CODE>DemoDialogs.r</CODE>, with the following code:<P>
<PRE>
#ifndef __FloatWindow__
#include &quot;FloatWindow.r&quot;
#endif
</PRE>
<A NAME=HEADING105-35></A>
<H3>Call the InitUFloatWindow Initialization Method</H3>
 To initialize MacApp's floating window support, your application must call the <CODE>InitUFloatWindow routine. The DemoDialogs application calls InitUFloatWindow from its main routine:</CODE><P>
<PRE>
InitUFloatWindow();
</PRE>
<A NAME=HEADING105-38></A>
<H3>Base Your Floating Windows on the TFloatWindow Class</H3>
 The <CODE>TFloatWindow</CODE> class is described in <A HREF=MacAppProgGuide-104.html#MARKER-9-21>"Floating Windows," beginning on page 448</A>. To take advantage of MacApp's floating window support, your floating window objects should be based on this class or on a subclass you define.<P>
<A NAME=HEADING105-40></A>
<H3>Define a Resource ID for the 'View' Resource</H3>
 The DemoDialogs application defines a resource ID for the Message Windoid view in both its resource definition file and implementation file. In the resource file, <CODE>DemoDialogs.r</CODE>, the ID is defined as<P>
<PRE>
#define cMessageWindoid1014
</PRE>
 In the implementation file, <CODE>UDemoDialogs.cp</CODE>, the ID is defined as a constant:<P>
<PRE>
const short cMessageWindoid = 1014;
</PRE>
<A NAME=HEADING105-45></A>
<H3>Use the 'fwnd' Resource Type to Define a Floating Window Resource</H3>
 Working with view resources is described in detail in <A HREF=MacAppProgGuide-101.html#MARKER-9-58>"Working With View Resource Templates," beginning on page 425</A>. An example is also provided in <A HREF=#MARKER-9-35>"Recipe--Creating a Window From a View Resource," beginning on page 451</A>. <P>
 As with other window and view resources, you can use a view-editing application to create a floating window resource. You can include the output, a compiled resource definition, into your resource definition file, or you can use a resource decompiler such as DeRez to convert the compiled resource to its text equivalent. You can then paste the text version into your resource definition file.<P>
 The DemoDialogs application defines the view resource for its Message Windoid window in the file <CODE>DemoDialogs.r</CODE>. A portion of that definition is shown here:<P>
<PRE>
resource 'View' (cMessageWindoid, purgeable) {MAThreeOh, 
{
   ViewSignatureAndClassname
   {  'fwnd', 430, &quot;&quot;, 'WIND', enabled, noIdle, {}, MAThreeOh, 
      {72, 64}, {55, 364}, sizeVariable, sizeVariable, shown, doesntWantToBeTarget, 
      handlesCursor, letsSubViewsHandleCursor, noCursorID, 
      handlesHelp, letsSubViewsHandleHelp, noHelpID, 1, 
      NoDrawingEnvironment {}, 
      AdornerListSignatureAndClassname 
      {  noIdentifier, AdornerList, AdornerElementSize, AdornerElementSizeShift,
         DynamicArrayAllocationIncrement,
            {  AdornFirst, AdornerLocalObject {EraseAdorner},
               DrawView, AdornerLocalObject {DrawAdorner}
            }
      }, emptyUserArea, 
      FloatWindow 
      {  kSystem75_kWindoidWDEF, 'mark', goAwayBox, notResizable,
         doFirstClick, freeOnClosing, disposeOnFree, closesDocument,
         openWithDocument, dontAdaptToScreen, dontStagger, forceOnScreen, 
         centerHorizontally, floats, hidesOnSuspend, doesntGenerateActivates,
         filler, kWindowTitles, -1
      }, 2
   },
   ...  // Some information not shown.
}
</PRE>
<A NAME=HEADING105-50></A>
<H3>Call NewTemplateWindow to Create a Floating Window</H3>
 The DemoDialogs application uses the <CODE>MakeDialog</CODE> method to create various windows, including the Message Windoid window. <CODE>MakeDialog</CODE> includes the following lines to create and open the floating window:<P>
<PRE>
TWindow *aWindow;
aWindow = gViewServer-&gt;NewTemplateWindow((short)aCommandNumber, NULL);
FailNIL((aWindow);
aWindow-&gt;Open();
</PRE>
 The resource ID is passed to <CODE>MakeDialog</CODE> as a command number, so for the Message Windoid menu command, the variable aCommandNumber has the value cMessageWindoid<A NAME=MARKER-2-20></A><A NAME=MARKER-2-23></A>, and NewTemplateWindow creates a Message Windoid floating window.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MacAppProgGuide-104.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-106.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MacAppProgGuide-3.html">&copy; Apple Computer, Inc.</A><br>25 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
