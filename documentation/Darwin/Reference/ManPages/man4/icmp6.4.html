<html><head><title>Mac OS X
 Manual Page For icmp6(4)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/4/icmp6" title="Mac OS X
 Manual Page for icmp6(4)"><!-- headerDoc=man; indexgroup=Section 4; uid="//apple_ref/doc/man/4/icmp6"; name=icmp6(4) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
ICMP6(4)                 BSD Kernel Interfaces Manual                 ICMP6(4)

<b>NAME</b>
     <b>icmp6</b> -- Internet Control Message Protocol for IPv6

<b>SYNOPSIS</b>
     <b>#include</b> <b>&lt;sys/socket.h&gt;</b>
     <b>#include</b> <b>&lt;netinet/in.h&gt;</b>
     <b>#include</b> <b>&lt;netinet/icmp6.h&gt;</b>

     <u>int</u>
     <b>socket</b>(<u>AF</u><b>_</b><u>INET6</u>, <u>SOCK</u><b>_</b><u>RAW</u>, <u>IPPROTO</u><b>_</b><u>ICMPV6</u>);

<b>DESCRIPTION</b>
     ICMPv6 is the error and control message protocol used by IPv6 and the IPv6 protocol family (see <a href="ip6.4.html#//apple_ref/doc/man/4/ip6">ip6(4)</a>
     and <a href="inet6.4.html#//apple_ref/doc/man/4/inet6">inet6(4)</a>).  It may be accessed through a ``raw socket'' for network monitoring and diagnostic func-<font color="#ffffff" class="whiteout">tions.&nbsp;functions.</font>
     tions.

     The <u>proto</u> parameter to the <a href="../man2/socket.2.html#//apple_ref/doc/man/2/socket">socket(2)</a> call to create an ICMPv6 socket may be obtained from
     <a href="../man3/getprotobyname.3.html#//apple_ref/doc/man/3/getprotobyname">getprotobyname(3)</a>.  ICMPv6 sockets are connectionless, and are normally used with the <a href="../man2/sendto.2.html#//apple_ref/doc/man/2/sendto">sendto(2)</a> and
     <a href="../man2/recvfrom.2.html#//apple_ref/doc/man/2/recvfrom">recvfrom(2)</a> calls, though the <a href="../man2/connect.2.html#//apple_ref/doc/man/2/connect">connect(2)</a> call may also be used to fix the destination for future pack-<font color="#ffffff" class="whiteout">ets&nbsp;packets</font>
     ets (in which case <a href="../man2/read.2.html#//apple_ref/doc/man/2/read">read(2)</a> or <a href="../man2/recv.2.html#//apple_ref/doc/man/2/recv">recv(2)</a> and <a href="../man2/write.2.html#//apple_ref/doc/man/2/write">write(2)</a> or <a href="../man2/send.2.html#//apple_ref/doc/man/2/send">send(2)</a> system calls may be used).

     Outgoing packets automatically have an IPv6 header prepended to them (based on the destination
     address).  Incoming packets on the socket are received with the IPv6 header and any extension headers
     removed.

   <b>Types</b>
     ICMPv6 messages are classified according to the type and code fields present in the ICMPv6 header.  The
     abbreviations for the types and codes may be used in rules in <!-- a -->pf.conf(5)<!-- /a -->.  The following types are
     defined:

           <b>Num</b>  <b>Abbrev.</b>         <b>Description</b>
           1    unreach         Destination unreachable
           2    toobig          Packet too big
           3    timex           Time exceeded
           4    paramprob       Invalid IPv6 header
           128  echoreq         Echo service request
           129  echorep         Echo service reply
           130  groupqry        Group membership query
           130  listqry         Multicast listener query
           131  grouprep        Group membership report
           131  listenrep       Multicast listener report
           132  groupterm       Group membership termination
           132  listendone      Multicast listerner done
           133  routersol       Router solicitation
           134  routeradv       Router advertisement
           135  neighbrsol      Neighbor solicitation
           136  neighbradv      Neighbor advertisement
           137  redir           Shorter route exists
           138  routrrenum      Route renumbering
           139  fqdnreq         FQDN query
           139  niqry           Node information query
           139  wrureq          Who-are-you request
           140  fqdnrep         FQDN reply
           140  nirep           Node information reply
           140  wrurep          Who-are-you reply
           200  mtraceresp      mtrace response
           201  mtrace          mtrace messages

     The following codes are defined:

           <b>Num</b>  <b>Abbrev.</b>         <b>Type</b>        <b>Description</b>
           0    noroute-unr     unreach     No route to destination
           1    admin-unr       unreach     Administratively prohibited
           2    beyond-unr      unreach     Beyond scope of source address
           2    notnbr-unr      unreach     Not a neighbor (obselete)
           3    addr-unr        unreach     Address unreachable
           4    port-unr        unreach     Port unreachable
           0    transit         timex       Time exceeded in transit
           1    reassemb        timex       Time exceeded in reassembly
           0    badhead         paramprob   Erroneous header field
           1    nxthdr          paramprob   Unrecognized next header
           2                    redir       Unrecognized option
           0    redironlink     redir       Redirection to on-link node
           1    redirrouter     redir       Redirection to better router

   <b>Headers</b>
     All ICMPv6 messages are prefixed with an ICMPv6 header.  This header corresponds to the <u>icmp6</u><b>_</b><u>hdr</u>
     structure and has the following definition:

           struct icmp6_hdr {
                   u_int8_t        icmp6_type;     /* type field */
                   u_int8_t        icmp6_code;     /* code field */
                   u_int16_t       icmp6_cksum;    /* checksum field */
                   union {
                           u_int32_t icmp6_un_data32[1]; /* type-specific */
                           u_int16_t icmp6_un_data16[2]; /* type-specific */
                           u_int8_t  icmp6_un_data8[4];  /* type-specific */
                   } icmp6_dataun;
           } __packed;

           #define icmp6_data32    icmp6_dataun.icmp6_un_data32
           #define icmp6_data16    icmp6_dataun.icmp6_un_data16
           #define icmp6_data8     icmp6_dataun.icmp6_un_data8
           #define icmp6_pptr      icmp6_data32[0] /* parameter prob */
           #define icmp6_mtu       icmp6_data32[0] /* packet too big */
           #define icmp6_id        icmp6_data16[0] /* echo request/reply */
           #define icmp6_seq       icmp6_data16[1] /* echo request/reply */
           #define icmp6_maxdelay  icmp6_data16[0] /* mcast group membership*/

     <u>icmp6</u><b>_</b><u>type</u> describes the type of the message.  Suitable values are defined in &lt;<u>netinet/icmp6.h&gt;</u>.
     <u>icmp6</u><b>_</b><u>code</u> describes the sub-type of the message and depends on <u>icmp6</u><b>_</b><u>type</u>.  <u>icmp6</u><b>_</b><u>cksum</u> contains the
     checksum for the message and is filled in by the kernel on outgoing messages.  The other fields are
     used for type-specific purposes.

   <b>Filters</b>
     Because of the extra functionality of ICMPv6 in comparison to ICMPv4, a larger number of messages may
     be potentially received on an ICMPv6 socket.  Input filters may therefore be used to restrict input to
     a subset of the incoming ICMPv6 messages so only interesting messages are returned by the <a href="../man2/recv.2.html#//apple_ref/doc/man/2/recv">recv(2)</a> fam-<font color="#ffffff" class="whiteout">ily&nbsp;family</font>
     ily of calls to an application.

     The <u>icmp6</u><b>_</b><u>filter</u> structure may be used to refine the input message set according to the ICMPv6 type.
     By default, all messages types are allowed on newly created raw ICMPv6 sockets.  The following macros
     may be used to refine the input set:

     <b>void</b> <b>ICMP6_FILTER_SETPASSALL</b>(<u>struct</u> <u>icmp6</u><b>_</b><u>filter</u> <u>*filterp</u>)
             Allow all incoming messages.  <u>filterp</u> is modified to allow all message types.

     <b>void</b> <b>ICMP6_FILTER_SETBLOCKALL</b>(<u>struct</u> <u>icmp6</u><b>_</b><u>filter</u> <u>*filterp</u>)
             Ignore all incoming messages.  <u>filterp</u> is modified to ignore all message types.

     <b>void</b> <b>ICMP6_FILTER_SETPASS</b>(<u>int</u> <u>type</u>, <u>struct</u> <u>icmp6</u><b>_</b><u>filter</u> <u>*filterp</u>)
             Allow ICMPv6 messages with the given <u>type</u>.  <u>filterp</u> is modified to allow such messages.

     <b>void</b> <b>ICMP6_FILTER_SETBLOCK</b>(<u>int</u> <u>type</u>, <u>struct</u> <u>icmp6</u><b>_</b><u>filter</u> <u>*filterp</u>)
             Ignore ICMPv6 messages with the given <u>type</u>.  <u>filterp</u> is modified to ignore such messages.

     <b>int</b> <b>ICMP6_FILTER_WILLPASS</b>(<u>int</u> <u>type</u>, <u>const</u> <u>struct</u> <u>icmp6</u><b>_</b><u>filter</u> <u>*filterp</u>)
             Determine if the given filter will allow an ICMPv6 message of the given type.

     <b>int</b> <b>ICMP6_FILTER_WILLBLOCK</b>(<u>int</u> <u>type</u>, <u>const</u> <u>struct</u> <u>icmp6</u><b>_</b><u>filter</u> <u>*filterp</u>)
             Determine if the given filter will ignore an ICMPv6 message of the given type.

     The <a href="../man2/getsockopt.2.html#//apple_ref/doc/man/2/getsockopt">getsockopt(2)</a> and <a href="../man2/setsockopt.2.html#//apple_ref/doc/man/2/setsockopt">setsockopt(2)</a> calls may be used to obtain and install the filter on ICMPv6 sock-<font color="#ffffff" class="whiteout">ets&nbsp;sockets</font>
     ets at option level IPPROTO_ICMPV6 and name ICMPV6_FILTER with a pointer to the <u>icmp6</u><b>_</b><u>filter</u> structure
     as the option value.

   <b>Non-privileged</b> <b>ICMPv6</b>
     ICMPv6 sockets can be opened with the SOCK_DGRAM socket type without requiring root privileges. The
     synopsis is the following:

     <b>socket</b>(<u>AF</u><b>_</b><u>INET6</u>, <u>SOCK</u><b>_</b><u>DGRAM</u>, <u>IPPROTO</u><b>_</b><u>ICMP6</u>)

     This can only be used to send ICMPv6 echo requests to gauge the quality of the connectivity to a host,
     to receive destination unreachable message for path MTU discovery, or to receveive time exceeded mes-<font color="#ffffff" class="whiteout">sage&nbsp;message</font>
     sage for traceroute.

     A socket opened with superuser privileges can send any kind of ICMPv6 message and can also use the
     <a href="ip6.4.html#//apple_ref/doc/man/4/ip6">ip6(4)</a> options that require superuser privileges.

<b>SEE</b> <b>ALSO</b>
     <a href="../man2/getsockopt.2.html#//apple_ref/doc/man/2/getsockopt">getsockopt(2)</a>, <a href="../man2/recv.2.html#//apple_ref/doc/man/2/recv">recv(2)</a>, <a href="../man2/send.2.html#//apple_ref/doc/man/2/send">send(2)</a>, <a href="../man2/setsockopt.2.html#//apple_ref/doc/man/2/setsockopt">setsockopt(2)</a>, <a href="../man2/socket.2.html#//apple_ref/doc/man/2/socket">socket(2)</a>, <a href="../man3/getprotobyname.3.html#//apple_ref/doc/man/3/getprotobyname">getprotobyname(3)</a>, <a href="inet6.4.html#//apple_ref/doc/man/4/inet6">inet6(4)</a>, <a href="ip6.4.html#//apple_ref/doc/man/4/ip6">ip6(4)</a>,
     <a href="netintro.4.html#//apple_ref/doc/man/4/netintro">netintro(4)</a>

     W. Stevens and M. Thomas, <u>Advanced</u> <u>Sockets</u> <u>API</u> <u>for</u> <u>IPv6</u>, RFC 2292, February 1998.

     A. Conta and S. Deering, <u>Internet</u> <u>Control</u> <u>Message</u> <u>Protocol</u> <u>(ICMPv6)</u> <u>for</u> <u>the</u> <u>Internet</u> <u>Protocol</u> <u>Version</u> <u>6</u>
     <u>(IPv6)</u> <u>Specification</u>, RFC 2463, December 1998.

BSD                            December 20, 2004                           BSD
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man4/icmp6.4.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man4/icmp6.4.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man4/icmp6.4.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
