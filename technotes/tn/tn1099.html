<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!-- Template 03-24-01 --><!--Includes revisions to code listings--><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css">   <title>Technical Note TN1099: Power Management &amp; PC Card Manager 3.0</title>    <meta name="keywords" content="Powerbook Power Manager PC card Manager 3.0 relationship Dynamic Data">    <meta name="Description" content="Technical Note TN1099: This Technical Note describes therelationship between the Power Manager on PowerBook computersand the PC Card Manager 3.0. It details what the PC cardmanager 3.0 does and what Card developers need to do to ensurecorrect function."><meta name="categories" content="Devices"><meta name="week-posted" content="Jun 30, 1997 - Jul 4, 1997"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002939" title="Power Management & PC Card Manager 3.0"></a><A NAME="top"></A><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxMacOS9Earlier-date.html">Mac OS 9 & Earlier</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/HardwareDrivers/idxPCIandPCCard-date.html" target="_blank">Hardware & Drivers > PCI and PC Card</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TN1099</div>
<div id="pageheadsub">Power Management &amp; PC Card Manager 3.0</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                   <td background="images/tnmenubody.gif" width=300 align=left>                        <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->					<p id="menutext"><A HREF = "#Section1">PowerBook Power         Management (Sleep/Wake) and PC Card Manager         3.0</A><BR><BR>         <A HREF = "#Section2">What PC Card         Manager 3.0 Does...</A><BR><BR>         <A HREF = "#Section3">What Card         developers need to do</A><BR><BR> 		<A HREF = "#References">References</A><BR><BR>     	<A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="Technote menu gif" width=300 height=16>                    </td>                </tr>            </table>        </td>		<td width=300 valign="top" align=left>	<!-- begin_intro_text --><P id = "introtext">This Technote         describes the relationship between the Power Manager on         PowerBook computers and the PC Card Manager 3.0.</p><!-- end_intro_text --><!-- begin_date --><h3>&nbsp;Updated: [Feb 9 1998]</h3><!-- end_date -->                </TD>             </TR>          </TABLE> <!-- end_header_box --><BR><BR><hr width=500 align=center><BR><BR><!-- begin_content -->         <P><A NAME="Section1"></A></P>         <H2>PowerBook Power Management         (Sleep/Wake) and PC Card Manager 3.0</H2>         <P>PowerBooks support a Sleep state in order to extend         battery life. Since PC Cards can consume a lot of power         (relatively speaking), PC Card Manager 3.0 works along with         the Mac OS to turn off power when the computer goes to         sleep. This provides some opportunities and responsibilities         for the developers of PC Card drivers and card enablers.</p><P><A HREF="#top">Back to top</A></P>         <P><A NAME="Section2"></A></P>         <H2>What PC Card Manager 3.0 Does...</H2>         <H3>When your PowerBook goes to sleep</H3>         <UL>            <LI>PC Card Manager 3.0 will notify clients (with a            <CODE>kPCCardPMSuspendMessage</CODE>)</li>            <LI>PC Card Manager 3.0 saves the generic state of the            card (configuration registers, window mappings etc.)</li>            <LI>PC Card Manager 3.0 turns off power to the socket</li>         </UL>         <H3>When your PowerBook wakes up</H3>         <UL>            <LI>PC Card Manager 3.0 turns on power to the socket</li>            <LI>PC Card Manager 3.0 restores the generic state of the            card</li>            <LI>PC Card Manager 3.0 sends <CODE>kPCCardPMResumeMessage</CODE>            notification to clients</li>         </UL>         <H3>When your PowerBook is idle</H3>         <UL>            <LI>depending on the settings of your PowerBook control            panel, after some period of time, the Mac OS will issue a            sleep request in order to determine if it is safe to put            the machine to sleep</li>            <LI>PC Card Manager 3.0 will get this request and send a            <CODE>kPCCardPMSuspendRequest</CODE> notification to all clients</li>            <LI>if any client objects to going to sleep (for example,            if it would disrupt a network connection), it should            return a value not equal to noErr from it's call back            function.</li>            <LI>if nobody vetoes this sleep request (PC CARD client            or non-client), the machine goes to sleep and PC CARD            clients will see a <CODE>kPCCardPMSuspendMessage</CODE></li>            <LI>when a  sleep demand call is issued,  PC Cards can            not reject the call; this is merely notification to your            card that the system is going to go to sleep, not a            request for sleep. See the             <a href="../../documentation/mac/Devices/Devices-230.html">            Power Manager chapter            </A> of<CITE><I>Inside Macintosh: Devices</I></CITE> for more detail.</li>         </UL><P><A HREF="#top">Back to top</A></P>         <P><A NAME="Section3"></A></P>         <H2>What Card developers need to         do</H2>         <H3>Preserving Device Specific Dynamic Data</H3>         <UL>            <LI>if you are doing a driver for a PC CARD device that            has some data on a card that will go away if the power is            turned off, you are responsible for saving and restoring            it.</li>            <LI>you can save and restore this data in either the            device driver or a custom card enabler</li>            <LI>if you wish to save this data in a device driver:             <UL>               <LI>register the driver as a card services client</li>               <LI>when you get a <CODE>kPCCardPMSuspendMessage</CODE>, save the               device specific data</li>               <LI>when you get a <CODE>kPCCardPMResumeMessage</CODE>, restore the               device specific data</li>            </UL></li>            <LI>if you wish to save this data in a custom card            enabler: (this might be the best choice for a            multi-function card)            <UL>               <LI>override <CODE>setPCCardPowerLevel</CODE>               <UL>                  <LI>save the device specific data on the card</li>                  <LI>call <CODE>CEPowerManagement</CODE></li>               </UL></li>               <LI>When waking up               <UL>                  <LI>call <CODE>CEPowerManagement</CODE></li>                  <LI>restore the device specific data on the card</li>               </UL></li>            </UL></li>         </UL>         <H3>Implementing a Low Power Mode</H3>         <UL>            <LI>We have defined three power states for PC Card            Manager 3.0 ( <CODE>kPCCardPowerOn</CODE>, <CODE>kPCCardPowerOff</CODE> and            <CODE>kPCCardLowPower</CODE>)</li>            <LI>PC Card Manager 3.0 only supports On and Off (Low is            considered to be On)</li>            <LI>If your card supports a Low power mode, you will need            a custom card enabler to support transitions to and from            this Low power mode - you will need to override            <CODE>setPCCardPowerLevel</CODE> to do so.</li>            </ul><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>Note:</B><BR>in a future version of the PC Card Manager, we            intend to implement a function named <CODE>PCCardSetPowerLevel</CODE>            which could be called by a driver to turn power off            and/or low. This will make your driver very battery            friendly.</p></TD></TR></TABLE></CENTER><BR><P><A HREF="#top">Back to top</A></P>         <a name="References"></a><H2>References</H2>            <p><A HREF = "ftp: //dev.apple.com/devworld/Development_Kits/PC_Card_SDKs.sit.hqx">PC Card 3.0 Manager SDK            Documentation</A></p>            <p><a href="../../documentation/mac/Devices/Devices-230.html">            Inside Macintosh: Devices, chapter 6, the Power Manager</A></P><P><A HREF="#top">Back to top</A></P>                  <P><A NAME=Downloads></A></P>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (48K)</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/tn1099.pdf">Download</A></P>               </TD>            </TR>           </TABLE>                  <P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content -->		<!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tn/tn1099.html%3Fid%3DDTS10002939-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tn/tn1099.html%3Fid%3DDTS10002939-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tn/tn1099.html%3Fid%3DDTS10002939-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --><hr width=500 align=center></BODY></HTML>