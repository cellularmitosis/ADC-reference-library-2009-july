<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>

	<!-- BEGIN META TAG INFO -->
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<link rel="home" href="http://developer.apple.com/">
	<link rel="find" href="http://developer.apple.com/search/">
	<link rel="stylesheet" type="text/css" href="../../documentation/css/adcstyle.css" title="fonts">
	<script language="JavaScript" src="../../documentation/js/adc.js" type="text/javascript"></script>
	<!-- END META TAG INFO -->
	
	<!-- BEGIN TITLE -->
	<title>GetPPPStatus - /AEHelpers.c</title>
	<!-- END TITLE -->
<script language="JavaScript">
function JumpToNewPage() {
	window.location=document.scpopupmenu.gotop.value;
	return true;
}
</script>

</head>

<!-- BEGIN BODY OPEN -->
<body>
<!--END BODY OPEN -->

<!-- START CENTER OPEN -->
<center>
<!-- END CENTER OPEN -->

	<!-- BEGIN LOGO AND SEARCH -->
	<!--#include virtual="/includes/adcnavbar"-->
	<!-- END LOGO AND SEARCH -->
		
		
	<!-- START BREADCRUMB -->
	<div id="breadcrumb">
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td scope="row"><img width="340" height="10" src="images/1dot.gif" alt=""></td>
			<td><img width="340" height="10" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr valign="middle">
			<td align="left" colspan="2">
			<a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../samplecode/index.html">Sample Code</a> &gt; <a href="../../samplecode/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../samplecode/LegacyTechnologies/idxNetworking-date.html">Networking</a> &gt; <A HREF="javascript:location.replace('index.html');">GetPPPStatus</A> &gt; 
			</td>
		</tr>
		<tr>
			<td colspan="2" scope="row"><img width="680" height="35" src="images/1dot.gif" alt=""></td>
		</tr>
	</table>
	</div>
	<!-- END BREADCRUMB -->

	<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/Networking/index.html" target="_blank">Reference Library > Networking</a></li>
	</ul>
</div>




</div></div></div>

	<!-- START MAIN CONTENT -->
	
	<!-- START TITLE GRAPHIC AND INTRO-->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td><h1><div id="pagehead">GetPPPStatus</div></h1></td>
		</tr>
	</table>
	<!-- END TITLE GRAPHIC AND INTRO -->
	<!-- START WIDE COLUMN -->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td id="scdetails">
				<h2>/AEHelpers.c</h2>
				<form name="scpopupmenu" onSubmit="return false;" method=post>
				<p><strong>View Source Code:</strong> 
					<select name="gotop" onChange="JumpToNewPage();" style="width:340px"><option selected value="ingnore">Select File</option>
<option value="listing1.html">/AEHelpers.c</option>
<option value="listing2.html">/AEHelpers.h</option>
<option value="listing3.html">/FinderRegistry.h</option>
<option value="listing4.html">/GetPPPStatus.c</option>
<option value="listing5.html">/MoreFinderEvents.c</option>
<option value="listing6.html">/MoreFinderEvents.h</option>
<option value="listing7.html">/OpenTptPPP.h</option>
<option value="listing8.html">/RAScriptingAdditions.h</option>
<option value="listing9.html">/TrapUtils.c</option>
<option value="listing10.html">/TrapUtils.h</option></select>
				</p>
				</form>
				<p><strong><a href="GetPPPStatus.zip">Download Sample</a></strong> (&#147;GetPPPStatus.zip&#148;, 51.4K)<BR>
<strong><a href="GetPPPStatus.dmg">Download Sample</a></strong> (&#147;GetPPPStatus.dmg&#148;, 116.4K)</p>
				<!--
				<p><strong><a href="#">Download Sample</a></strong> (&#147;filename.sit&#148;, 500K)</p>
				-->
			</td>
		</tr>
		<tr>
			<td scope="row"><img width="680" height="10" src="images/1dot.gif" alt=""><br>
			<img height="1" width="680" src="images/1dot_919699.gif" alt=""><br>
			<img width="680" height="20" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr>
			<td scope="row">
	<!--googleon: index -->
<pre class="sourcecodebox">/*  File:    AEHelpers.c  Contains:  Functions to help you when you are building and sending Apple events.  Written by: Andy Bachorski    Copyright:  Copyright &copy; 1996-1999 by Apple Computer, Inc., All Rights Reserved.        You may incorporate this Apple sample source code into your program(s) without        restriction. This Apple sample source code has been provided &quot;AS IS&quot; and the        responsibility for its operation is yours. You are not permitted to redistribute        this Apple sample source code as &quot;Apple sample source code&quot; after having made        changes. If you're going to re-distribute the source, we require that you make        it clear in the source that the code was descended from Apple sample source        code, but that you've made changes.  Change History (most recent first):        7/22/1999  Karl Groethe  Updated for Metrowerks Codewarror Pro 2.1        *///  Constant used to #undef PASCAL when not compiling a library#define  COMPILING_MORE_FINDER_EVENTS  true//  System includes#include &lt;AERegistry.h&gt;#include &lt;AEObjects.h&gt;#include &lt;AEPackObject.h&gt;#include &lt;Aliases.h&gt;#include &lt;Gestalt.h&gt;#include &lt;Icons.h&gt;#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;//  MoreFinderEvents includes#include &quot;FinderRegistry.h&quot;#include &quot;MoreFinderEvents.h&quot;#include &quot;TrapUtils.h&quot;//  Export symbols in this header for shared libraries#pragma export on#include &quot;AEHelpers.h&quot;#pragma export off// *****************************************************************************//  Private Prototypes// *****************************************************************************pascal  OSErr  MyIconAction (ResType theIconType,               Handle *theIcon,               void *myDataPtr);               /*  Used by AEHMakeIconFamilyRecord, passed to ForEachIconDo as the IconAction  function. Puts each icon in an icon suite into the descriptor record passed  in the myDataPtr parameter.*/// ************************************************************************************************pascal  OSErr  FindProcessBySignature( const OSType targetType,                    const OSType targetCreator,                    ProcessSerialNumberPtr psnPtr ){  OSErr    anErr = noErr;  Boolean    foundTheProcess = false;    ProcessInfoRec  infoRec;    infoRec.processInfoLength = sizeof( ProcessInfoRec );  infoRec.processName = nil;  infoRec.processLocation = nil;  infoRec.processAppSpec = nil;    psnPtr-&gt;lowLongOfPSN = kNoProcess;  psnPtr-&gt;highLongOfPSN = kNoProcess;  while ( !foundTheProcess )  {    anErr = GetNextProcess( psnPtr );    if ( anErr == noErr )    {      anErr = GetProcessInformation( psnPtr, &amp;infoRec );      if ( ( anErr == noErr )         &amp;&amp; ( infoRec.processType == targetType )         &amp;&amp; ( infoRec.processSignature == targetCreator ) )      {        foundTheProcess = true;      }    }  }    return anErr;}//end FindProcessBySignature// ************************************************************************************************pascal  OSErr  AEHMakeAppleEventSignatureTarget( const OSType targetType,                          const OSType targetCreator,                          const AEEventClass eventClass,                          const AEEventID eventID,                            AppleEvent *theEvent ){  OSErr  anErr = noErr;    ProcessSerialNumber    psn = { kNoProcess, kNoProcess };    anErr = FindProcessBySignature( targetType, targetCreator, &amp;psn );  if ( anErr == noErr )  {    anErr = AEHMakeEventProcessTarget( &amp;psn, eventClass, eventID, theEvent );  }  return anErr;}//end AEHMakeAppleEventSignatureTarget// ************************************************************************************************pascal  OSErr  AEHMakeEventProcessTarget( const ProcessSerialNumberPtr psnPtr,                       const AEEventClass eventClass,                       const AEEventID eventID,                         AppleEvent *theEvent ){  OSErr  anErr = noErr;  AEDesc  targetAppDesc = { typeNull, nil };    anErr = AECreateDesc (typeProcessSerialNumber, psnPtr, sizeof( ProcessSerialNumber ), &amp;targetAppDesc);  if ( anErr == noErr )  {    anErr = AECreateAppleEvent( eventClass, eventID, &amp;targetAppDesc,                  kAutoGenerateReturnID, kAnyTransactionID, theEvent);  }    AEDisposeDesc( &amp;targetAppDesc );    return anErr;}//end AEHMakeEventProcessTarget// ************************************************************************************************pascal  OSErr  AEHMakeEventTargetID( const TargetID *targetIDPtr,                    const AEEventClass eventClass,                    const AEEventID eventID,                      AppleEvent *theEvent ){  OSErr  anErr = noErr;  AEDesc  targetAppDesc = { typeNull, nil };    anErr = AECreateDesc (typeTargetID, targetIDPtr, sizeof( TargetID ), &amp;targetAppDesc);  if ( anErr == noErr )  {    anErr = AECreateAppleEvent( eventClass, eventID, &amp;targetAppDesc,                  kAutoGenerateReturnID, kAnyTransactionID, theEvent);  }    AEDisposeDesc( &amp;targetAppDesc );    return anErr;}//end AEHMakeEventProcessTarget// ************************************************************************************************pascal  OSErr  AEHMakeAliasDescFromFSSpec( const FSSpecPtr fssPtr,                      AEDesc *aliasDesc ){  OSErr      anErr = noErr;  AliasHandle    aliasHandle;    NewAlias( nil, fssPtr, &amp;aliasHandle);  if ( aliasHandle == nil )  {    anErr = paramErr;  }  else  {    anErr = AEHMakeAliasDesc( aliasHandle, aliasDesc );    DisposeHandle( (Handle)aliasHandle );  }      return anErr;}//end MakeAliasObject// ************************************************************************************************pascal  OSErr  AEHMakeAliasDesc( const AliasHandle aliasHandle,                    AEDesc *aliasDesc ){  OSErr  anErr = noErr;    char  handleState = HGetState( (Handle)aliasHandle );  HLock( (Handle)aliasHandle );    anErr = AECreateDesc( typeAlias, *aliasHandle, GetHandleSize( (Handle)aliasHandle ), aliasDesc );    HSetState( (Handle)aliasHandle, handleState );    return anErr;}//end MakeAliasObject// ************************************************************************************************pascal  OSErr  AEHMakeAliasObjectFromFSSpec( const FSSpecPtr fssPtr,                          AEDesc *containerObj,                          AEDesc *aliasObject ){  OSErr      anErr = noErr;  AliasHandle    aliasHandle;    anErr = NewAlias( nil, fssPtr, &amp;aliasHandle);  if ( aliasHandle == nil )  {    anErr = paramErr;  }    if ( anErr == noErr )  {    anErr = AEHMakeAliasObject( aliasHandle, containerObj, aliasObject );  }    DisposeHandle( (Handle)aliasHandle );    return anErr;}//end MakeAliasObject// ************************************************************************************************pascal  OSErr  AEHMakeAliasObject( const AliasHandle aliasHandle,                      AEDesc *containerObj,                      AEDesc *aliasObject ){  OSErr  anErr = noErr;  AEDesc  aliasDesc;  char  handleState = HGetState( (Handle)aliasHandle );  HLock( (Handle)aliasHandle );    anErr = AECreateDesc( typeAlias, *aliasHandle, GetHandleSize( (Handle)aliasHandle ), &amp;aliasDesc );  HSetState( (Handle)aliasHandle, handleState );    if ( anErr == noErr )  {    anErr = CreateObjSpecifier( typeAlias, containerObj, formAbsolutePosition,                  &amp;aliasDesc, true, aliasObject );    AEDisposeDesc( &amp;aliasDesc );  }    return anErr;}//end MakeAliasObject// ************************************************************************************************pascal  OSErr  AEHMakePropertyObject( const DescType propType,                       AEDesc *containerObj,                       AEDesc *propertyObj ){  OSErr  anErr = noErr;  AEDesc  propDesc;    anErr = AECreateDesc( typeType, &amp;propType, sizeof( propType ), &amp;propDesc );    if ( anErr == noErr )  {    anErr = CreateObjSpecifier( cProperty, containerObj, formPropertyID,                  &amp;propDesc, true, propertyObj );    AEDisposeDesc( &amp;propDesc );  }    return anErr;}//end MakePropertyObject// ************************************************************************************************pascal  OSErr  AEHMakeProcessObject( const ProcessSerialNumber *psnPtr,                       AEDesc *containerObj,                       AEDesc *propertyObj ){  OSErr  anErr = noErr;  AEDesc  psnDesc;    anErr = AECreateDesc( typeProcessSerialNumber, psnPtr, sizeof( ProcessSerialNumber ), &amp;psnDesc );    if ( anErr == noErr )  {    anErr = CreateObjSpecifier( cProperty, containerObj, formPropertyID,                  &amp;psnDesc, true, propertyObj );    AEDisposeDesc( &amp;psnDesc );  }    return anErr;}//end MakePropertyObject// ************************************************************************************************pascal  OSErr  AEHMakeSelectionObject( const DescType selection,                        AEDesc *containerObj,                        AEDesc *selectionObject ){  OSErr  anErr = noErr;    AEDesc  selectionDesc = { typeNull, nil };    anErr = AECreateDesc( typeAbsoluteOrdinal, &amp;selection, sizeof( selection ), &amp;selectionDesc );  if ( anErr == noErr )  {    anErr = CreateObjSpecifier( cObject, containerObj, formAbsolutePosition,                  &amp;selectionDesc, true, selectionObject );  }        return anErr;}// ************************************************************************************************pascal  OSErr  AEHMakeIconSuite( const AEDescList *iconFamilyRecPtr,                    Handle *iconSuitePtr ){  static  DescType  iconTypes[] = {  typeIconAndMask, type8BitIcon, type4BitIcon,                    typeSmallIconAndMask, typeSmall8BitIcon, typeSmall4BitIcon };  const  long    iconTypesCnt = 6;    OSErr  anErr = noErr;    AEDescList  iconList = { typeNull, nil };    anErr = AECoerceDesc( iconFamilyRecPtr, typeAERecord, &amp;iconList );    if ( anErr == noErr )  {    anErr = NewIconSuite( iconSuitePtr );        if ( anErr == noErr )    {      long  index;      AEDesc  iconDataDesc = { typeNull, nil };            for ( index = 0; index &lt; iconTypesCnt; index++ )      {        anErr = AEGetKeyDesc( &amp;iconList, iconTypes[ index ],                    typeWildCard, &amp;iconDataDesc );        if ( anErr == noErr )        {          anErr = AddIconToSuite( iconDataDesc.dataHandle,                      *iconSuitePtr, iconTypes[ index ] );        }      }    }  }  AEDisposeDesc( &amp;iconList );  return anErr;}// ************************************************************************************************pascal  OSErr  MyIconAction( ResType theIconType,                Handle *theIcon,                void *myDataPtr){  OSErr  anErr = noErr;    if ( *theIcon != nil )  // only add the icon if it's really there  {    AEDescList *iconFamilyRecPtr = (AEDescList*)myDataPtr;        anErr = AEPutKeyPtr( iconFamilyRecPtr, theIconType, theIconType,               **theIcon, GetHandleSize( *theIcon ) );  }      return anErr;}//end MyIconAction// ************************************************************************************************pascal  OSErr  AEHMakeIconFamilyRecord( const Handle iconSuite,                     const IconSelectorValue iconSelector,                         AEDescList *iconFamilyRecPtr ){  OSErr  anErr = noErr;  AEDescList  iconList = { typeNull, nil };    static  IconActionUPP iconActionUPP;    if ( iconActionUPP == nil )  {    iconActionUPP = NewIconActionProc( &amp;MyIconAction );  }    // create a record for the icon family  anErr = AECreateList( nil, 0, true, &amp;iconList );    if ( anErr == noErr )  {    ForEachIconDo( iconSuite, iconSelector,             iconActionUPP, &amp;iconList );        anErr = AECoerceDesc( &amp;iconList, typeIconFamily, iconFamilyRecPtr );    AEDisposeDesc( &amp;iconList );  }  return anErr;}// ************************************************************************************************pascal  OSErr  AEHGetHandlerError( const AppleEvent *reply ){  OSErr    anErr = noErr;    DescType  actualType;  long    actualSize;  long    handlerErr;    if ( reply-&gt;descriptorType != typeNull )  // there's a reply, so there may be an error  {    OSErr  getErrErr = noErr;        getErrErr = AEGetParamPtr( reply, keyErrorNumber, typeLongInteger, &amp;actualType,                  &amp;handlerErr, sizeof( long ), &amp;actualSize );        if ( getErrErr != errAEDescNotFound )  // found an errorNumber parameter    {      anErr = handlerErr;        // so return it's value    }  }  return anErr;}//end AEHGetHandlerError// ************************************************************************************************pascal  Boolean  AEHSimpleIdleFunction( EventRecord *event,                    long *sleepTime,                    RgnHandle *mouseRgn ){#pragma unused( event )  *sleepTime = 30;  *mouseRgn = nil;    return ( false );}//end AEHSimpleIdleFunction// ********************************************************pascal Boolean HasAppleEvents( void ){  OSErr  anErr = noErr;    Boolean    hasAppleEvents = false;    if ( TrapAvailable( _Gestalt ) )  {    long  response;        if ( Gestalt( gestaltAppleEventsAttr, &amp;response ) == noErr )    {      hasAppleEvents = ( response &amp; (1L &lt;&lt; gestaltAppleEventsPresent) );    }  }  else  {    hasAppleEvents = false;  }    return hasAppleEvents ;}//end HasAppleEvents// ********************************************************pascal Boolean FinderCallsAEProcess( void ){  OSErr  anErr = noErr;    Boolean    finderCallsAEProcess = false;    if ( TrapAvailable( _Gestalt ) )  {    long  response;        if ( Gestalt( gestaltFinderAttr, &amp;response ) == noErr )    {      finderCallsAEProcess = ( response &amp; (1L &lt;&lt; gestaltFinderCallsAEProcess) );    }  }  else  {    finderCallsAEProcess = false;  }    return finderCallsAEProcess ;}//end FinderCallsAEProcess// ********************************************************pascal Boolean FinderIsOSLCompliant( void ){  OSErr  anErr = noErr;    Boolean    finderIsOSLCompliant = false;    if ( TrapAvailable( _Gestalt ) )  {    long  response;        if ( Gestalt( gestaltFinderAttr, &amp;response ) == noErr )    {      finderIsOSLCompliant = ( response &amp; (1L &lt;&lt; gestaltOSLCompliantFinder) );    }  }  else  {    finderIsOSLCompliant = false;  }    return finderIsOSLCompliant ;}//end FinderIsOSLCompliant// ********************************************************</pre>
	<!--googleoff: index -->
			</td>
		</tr>
	</table>
	<!-- END WIDE COLUMN -->

	<!-- END MAIN CONTENT -->
		<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/samplecode/GetPPPStatus/listing1.html%3Fid%3DDTS10000236-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/samplecode/GetPPPStatus/listing1.html%3Fid%3DDTS10000236-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/samplecode/GetPPPStatus/listing1.html%3Fid%3DDTS10000236-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

	<!-- START BOTTOM APPLE NAVIGATION -->
	<!--#include virtual="/includes/footer"-->
	<!-- END BOTTOM APPLE NAVIGATION -->

<!-- START CENTER CLOSE -->
</center>
<!-- END CENTER CLOSE -->

</body>
</html>