<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE> Registering a Drawing Engine</TITLE></HEAD><BODY BGCOLOR="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- path goes here --><H1 CLASS="H2.Heading2"><A NAME="pgfId=47643"> </A><A NAME="16727"> </A>Registering a Drawing Engine</H1><P CLASS="T1.Text1"><A NAME="pgfId=47644"> </A><A NAME="marker=51473"> </A>Once you written all the necessary public and private draw context methods, as well as methods to handle textures and bitmaps, you must write a <TT CLASS="cv">TQAEngineGetMethod</TT> method that reports the addresses of some of those methods to QuickDraw&nbsp;3D RAVE. <A HREF="qd3dravedriver.11.htm#30252" CLASS="XRef">Listing&nbsp;14</A> shows a sample <TT CLASS="cv">TQAEngineGetMethod</TT> method. Notice that this method returns the addresses only of the private draw context methods and the methods to handle textures and bitmaps. The pointers for the public draw context methods are assigned directly to the fields of a draw context structure by your <TT CLASS="cv">TQADrawPrivateNew</TT> method (as shown in <A HREF="qd3dravedriver.f.htm#37138" CLASS="XRef">Listing&nbsp;11</A>).</P><P CLASS="L.Listing"><A NAME="pgfId=51092"> </A>Listing&nbsp;14<A NAME="30252"> </A>A <TT CLASS="cv">TQAEngineGetMethod</TT> method</P><CODE CLASS="CvF.CodeFull"><A NAME="pgfId=64028"> </A>TQAError MyEngineGetMethod (TQAEngineMethodTag methodTag, TQAEngineMethod *method)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;switch (methodTag) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case kQADrawPrivateNew:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method-&gt;drawPrivateNew = MyDrawPrivateNew;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case kQADrawPrivateDelete:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method-&gt;drawPrivateDelete = MyDrawPrivateDelete;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case kQAEngineCheckDevice:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method-&gt;engineCheckDevice = MyEngineCheckDevice;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case kQAEngineGestalt:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method-&gt;engineGestalt = MyEngineGestalt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case kQABitmapNew:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method-&gt;bitmapNew = MyBitmapNew;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case kQABitmapDetach:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method-&gt;bitmapDetach = MyBitmapDetach;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case kQABitmapDelete:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method-&gt;bitmapDelete = MyBitmapDelete;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return(kQANotSupported);<BR>&nbsp;&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;&nbsp;return(kQANoErr);<BR>}<BR></CODE><P CLASS="T1.Text1"><A NAME="pgfId=51101"> </A><A NAME="marker=64030"> </A>Finally, you register your drawing engine by passing the address of your <TT CLASS="cv">TQAEngineGetMethod</TT> method to the <TT CLASS="cv">QARegisterEngine</TT> function:</P><CODE CLASS="Cv.Code"><A NAME="pgfId=64034"> </A>QARegisterEngine(&amp;MyEngineGetMethod);<BR></CODE><P CLASS="T1.Text1"><A NAME="pgfId=51180"> </A><A NAME="marker=60353"> </A><A NAME="marker=60354"> </A>You can call <TT CLASS="cv">QARegisterEngine</TT> in two ways. During product development, you can link your drawing engine code directly with a test application, in which case you should call <TT CLASS="cv">QARegisterEngine</TT> from your application's initialization code. Alternatively, once you've completed development, you should build your engine's code into a shared library of type <TT CLASS="cv">'tnsl'</TT>. In this case, you should call <TT CLASS="cv">QARegisterEngine</TT> from the initialization routine of the shared library. When the shared library containing QuickDraw&nbsp;3D RAVE is loaded, it searches for and loads any drawing engines contained in shared libraries in the current folder or in the Extensions folder.<A NAME="marker=51474"> </A></P><hr>&#169; 1997 Apple Computer, Inc.</DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY></HTML>