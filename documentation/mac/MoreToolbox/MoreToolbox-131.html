<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>PutScrap (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING131></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-130.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-132.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-109.html"><B>Chapter 2 - Scrap Manager</B></A> / <A HREF="MoreToolbox-122.html"><B>Scrap Manager Reference</B></A><BR><DL><DD><A HREF="MoreToolbox-126.html"><B>Routines</B></A> / <A HREF="MoreToolbox-129.html"><B>Writing Information to the Scrap</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING131-0></A>
<H3><A NAME=MARKER-11-172></A>PutScrap<A NAME=MARKER-2-173></A></H3>
 You can use the <CODE>PutScrap</CODE> function to write data in a specific format to the scrap.<P>
<PRE>
FUNCTION PutScrap (length: LongInt; theType: ResType; source: Ptr)
                  : LongInt;
</PRE>
<DL>
<DT><CODE>length</CODE>
<DD> The number of bytes of data to write to the scrap.
<DT><CODE>theType</CODE>
<DD> The scrap format type of the data to be written to the scrap. The scrap format type is a four-character sequence that refers to the particular <BR>data format, such as <CODE>'TEXT'</CODE>, <CODE>'PICT'</CODE>, <CODE>'styl'</CODE>, <CODE>'snd '</CODE>, or <CODE>'movv'</CODE>.
<DT><CODE>source</CODE>
<DD> A pointer to the data that the <CODE>PutScrap</CODE> function should write to the scrap. 
</DL>
<A NAME=HEADING131-6></A>
<H5>DESCRIPTION</H5>
 The <CODE>PutScrap</CODE> function writes the specified number of bytes of data from the memory location pointed to by the <CODE>source</CODE> parameter to the scrap. The Scrap Manager writes the data to the current location of the scrap (your application's heap or disk).<P>
 Whenever your application needs to write data to the scrap as a result of a cut or copy operation, your application uses the <CODE>PutScrap</CODE> function to write a representation of the data to the scrap. If your application uses a private scrap, it should copy data from its private scrap to the scrap using the <CODE>PutScrap</CODE> function whenever it receives a suspend event. Your application can use the <CODE>PutScrap</CODE> function multiple times to write different formats of the same data to the scrap. <P>
<DL>
<DT><B>IMPORTANT</B>
<DD>Whenever your application needs to write data in one or more formats to the scrap, you should call <CODE>ZeroScrap</CODE> before the first time you call <CODE>PutScrap</CODE>.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 If your application writes multiple formats to the scrap, you should write <BR>your application's preferred scrap format type first. For example, if the SurfWriter application's preferred scrap format type is a private scrap format type called <CODE>'SURF'</CODE> and SurfWriter also supports the scrap format types <CODE>'TEXT'</CODE> and <CODE>'PICT'</CODE>, then SurfWriter should write the data to the scrap using the <CODE>'SURF'</CODE> scrap format type first, and then write any other scrap format types that it supports in subsequent order of preference.<P>
<DL>
<DT><B>WARNING</B>
<DD>Do not write data to the scrap that has the same scrap format type as any data already in the scrap. If you do so, the new data is appended to the scrap. Note that when you request data from the scrap using the <CODE>GetScrap</CODE> function, <CODE>GetScrap</CODE> returns the first data that it finds with the requested scrap format type; thus you cannot retrieve any appended data of the same format type using <CODE>GetScrap</CODE>.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 If your application uses TextEdit to handle text in its documents, use TextEdit routines to implement cut and copy operations and to write the TextEdit scrap to the scrap. If your application uses the Dialog Manager to handle editable text in your application's dialog boxes and a dialog box is the frontmost window, use the Dialog Manager procedure <CODE>DialogCut</CODE> or <CODE>DialogCopy</CODE> to copy the data from the current editable text item to the scrap.<P>
 If the scrap does not already exist (in memory or on the disk), the <CODE>PutScrap</CODE> function returns a long integer with the value <CODE>noScrapErr</CODE>. The <CODE>PutScrap</CODE> function returns other nonzero values corresponding to result codes if an error occurs. <P>
<A NAME=HEADING131-14></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 The <CODE>PutScrap</CODE> function may move or purge memory blocks in the application heap. Your application should not call this function at interrupt time.<P>
<A NAME=HEADING131-16></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>noScrapErr<TD>-100<TD>Scrap does not exist (not initialized)</TABLE>
</H5>
<A NAME=HEADING131-17></A>
<H5>SEE ALSO</H5>
 See <A HREF=MoreToolbox-117.html#MARKER-9-70>Listing 2-1 on page 2-16</A>, <A HREF=MoreToolbox-117.html#MARKER-9-74>Listing 2-2 on page 2-18</A>, and <A HREF=MoreToolbox-119.html#MARKER-9-116>Listing 2-7 on page 2-27</A> for examples that write data to the scrap. If your application uses a private scrap, see <A HREF=MoreToolbox-121.html#MARKER-9-134>"Handling Editing Operations in Dialog Boxes" on page 2-31</A> for information on maintaining consistency of the scrap when copying and pasting data between document windows and dialog boxes. See <I><A HREF="../Text/Text-2.html">Inside Macintosh: Text</A></I> for information on TextEdit. See <I><A HREF="../QuickDraw/QuickDraw-2.html">Inside Macintosh: Imaging with QuickDraw</A></I> for information on the QuickDraw <CODE>'PICT'</CODE> format. <A NAME=MARKER-2-142></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-130.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-132.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
