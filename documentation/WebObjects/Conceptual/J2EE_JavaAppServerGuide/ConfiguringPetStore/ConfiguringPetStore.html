<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Java Application Server Guide: Configuring and Deploying Sun&acirc;&#128;&#153;s Pet Store</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Configuring and Deploying Sun&acirc;&#128;&#153;s Pet Store"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40002323-CH216" title="Configuring and Deploying Sun&acirc;&#128;&#153;s Pet Store"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../MacOSXServer/index.html#//apple_ref/doc/uid/TP30000440-TP30000426" target="_top">Mac OS X Server</a> &gt; <a href="../../../../MacOSXServer/Java-date.html#//apple_ref/doc/uid/TP30000440-TP30000426-TP30000528" target="_top">Java</a> &gt; <a href="../Introduction/Introduction.html#//apple_ref/doc/uid/TP40002323-CH204-TPXREF101">Java Application Server Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../ConfiguringApplications/ConfiguringApplications.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../AdministeringAppServers/AdministeringAppServers.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40002323-CH216-BCIGCDAB" title="Configuring and Deploying Sun&acirc;&#128;&#153;s Pet Store"></a><h1>Configuring and Deploying Sun’s Pet Store</h1><p><a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_86"></a>Pet Store is a sample J2EE application from Sun Microsystems. Pet Store showcases the power and flexibility of the J2EE platform. This chapter provides a tutorial on the configuration of Sun’s Pet Store for deployment in Mac OS X Server.</p><p>Sun’s Pet Store is comprised of several applications. This tutorial uses the Pet Store enterprise application and the Supplier enterprise application.</p><p>In this tutorial you obtain the Pet Store files from Sun, prepare your Mac OS X Server system for a Pet Store deployment, and configure the Pet Store and Supplier applications for deployment on JBoss.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_10" title="Note"></a><p><strong>Note:</strong>&nbsp;The companion files<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_87"></a> of this document include configured Pet Store archives that are ready for deployment using MySQL as the database engine. They’re at <code>Application_Server_companion/Configured_Pet_Store_archives</code>. You need to perform only the steps listed in <span class="content_text"><a href="ConfiguringPetStore.html#//apple_ref/doc/uid/TP40002323-CH216-TPXREF105">“Set Up the Environment”</a></span> and <span class="content_text"><a href="ConfiguringPetStore.html#//apple_ref/doc/uid/TP40002323-CH216-TPXREF136">“Deploy and Test the Application.”</a></span></p></div><p>See <span class="content_text"><a href="http://developer.java.sun.com/developer/releases/petstore" target="_blank">http://developer.java.sun.com/developer/releases/petstore</a></span> for more information on Sun’s Pet Store application.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="ConfiguringPetStore.html#//apple_ref/doc/uid/TP40002323-CH216-TPXREF105">Set Up the Environment</a>
				
			<br/>
			
        
			
			
				<a href="ConfiguringPetStore.html#//apple_ref/doc/uid/TP40002323-CH216-BCIGBICG">Configure the Pet Store Enterprise Application</a>
				
			<br/>
			
        
			
			
				<a href="ConfiguringPetStore.html#//apple_ref/doc/uid/TP40002323-CH216-BCIFBJEB">Configure the Supplier Enterprise Application</a>
				
			<br/>
			
        
			
			
				<a href="ConfiguringPetStore.html#//apple_ref/doc/uid/TP40002323-CH216-TPXREF136">Deploy and Test the Application</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF105" title="Set Up the Environment"></a><h2>Set Up the Environment</h2><p>Before you can configure an enterprise application for deployment in Mac OS X Server, make sure that you have all the files you need. Then create any necessary tables in your database, and ensure that the appropriate processes are running:</p><ol class="ol"><li class="li"><p>Get Pet Store from Sun.</p><p><a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_88"></a>Download the Pet Store enterprise application from <span class="content_text"><a href="http://developer.java.sun.com/developer/releases/petstore" target="_blank">http://developer.java.sun.com/developer/releases/petstore</a></span>, and place the <code>petstore1.3.2</code> directory in your home directory. (Pet Store 1.3.2 is also included as part of this document’s companion files.)</p></li><li class="li"><p>Configure MySQL<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_89"></a>:</p><ol class="ol"><li class="ol ol"><p>Launch MySQL Manager, located in <code>/Applications/Server</code>.</p></li><li class="ol ol"><p>Click the lock button, and authenticate as the system administrator.</p></li><li class="ol ol"><p>Click Install and then click Start.</p></li><li class="ol ol"><p>Quit MySQL Manager.</p></li></ol></li><li class="li"><p>Create the Pet Store Tables<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_90"></a>:</p><ol class="ol"><li class="ol ol"><p>In Terminal, run the <code>mysql</code> command-line tool<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_91"></a>.</p></li><li class="ol ol"><p>Enter <code>use test</code> and press Return.</p></li><li class="ol ol"><p>Copy the text in <code>Application_Server_companion/Pet_Store_resources/create_tables_sql.txt</code> (in this document’s companion files<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_92"></a>) to the Clipboard, and paste its contents into the <code>mysql</code> command-line tool.</p></li><li class="ol ol"><p>Enter <code>quit</code> and press Return.</p></li></ol></li><li class="li"><p>Deploy the <code>petstore-destinations-service.xml</code> file<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_93"></a>.</p><p>To prepare JBoss for running Pet Store, copy the <code>Application_Server_companion/Pet_Store_resources/petstore-destinations-service.xml</code> file included in this document’s companion files to <code>/Library/JBoss/3.2/deploy</code>.</p></li><li class="li"><p>Start the application server.</p><p>You must be running the application server to configure Pet Store. Make sure the application server is running on your computer. See <span class="content_text"><a href="../ConfiguringApplications/ConfiguringApplications.html#//apple_ref/doc/uid/TP40002323-CH215-BAJHIGBB">“Starting the Application Server”</a></span> for details.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-BCIGBICG" title="Configure the Pet Store Enterprise Application"></a><h2>Configure the Pet Store Enterprise Application</h2><p><a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_94"></a><a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_95"></a>This section guides you through the steps required to configure the <code>petstore.ear</code> file so that it can be deployed in Mac OS X Server. This process involves specifying the data source that enterprise beans use to obtain a connection to the database, mapping the enterprise beans’ CMP fields to table columns, defining relationships among enterprise beans, and so on.</p><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF106" title="Open the petstore.ear File in the Deployment Tool"></a><h3>Open the petstore.ear File in the Deployment Tool</h3><ol class="ol"><li class="li"><p>Launch the JBoss deployment tool. (See <span class="content_text"><a href="../ConfiguringApplications/ConfiguringApplications.html#//apple_ref/doc/uid/TP40002323-CH215-BAJGEJDI">“Starting the JBoss Deployment Tool”</a></span> for details.)</p></li><li class="li"><p>In the Load Application window, enter the full path to the <code>petstore.ear</code> file in the text field, and click Load Application.</p></li><li class="li"><p>Click “Click here to continue.”</p></li><li class="li"><p>In the PetStoreEAR (Application) window (also known as the main window or the navigation window), click Connect.</p></li><li class="li"><p>In the Connect to Server window, enter the host name and the port of the application server. (By default the host is <code>localhost</code> and the port is <code>1099</code>.)</p><div class="item_figure"><img src = "../art/deploy_petstore_initial.gif" alt = "image: ../art/deploy_petstore_initial.gif" width="522" height="508"></div></li><li class="li"><p>Click Connect to Server.</p></li><li class="li"><p>Close the Connect to Server window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF107" title="Configure Application-Wide Settings"></a><h3>Configure Application-Wide Settings</h3><p><a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_96"></a>In this section you configure the settings that affect all the modules in the <code>petstore.ear</code> archive.</p><ol class="ol"><li class="li"><p>Under PetStoreEAR (Application), click Application Settings.</p></li><li class="li"><p>In the PetStoreEAR window, click the JBoss tab.</p></li><li class="li"><p>Set J2EE Compliant Class Loading to no, and click Update.</p></li><li class="li"><p>Close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF108" title="Configure the AsyncSender Enterprise Bean"></a><h3>Configure the AsyncSender Enterprise Bean</h3><ol class="ol"><li class="li"><p>Under AsyncSenderEJB (EJB), click Enterprise Beans. Then click AsyncSenderEJB<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_97"></a>.</p></li><li class="li"><p>In the AsyncSenderEJB window, select <code>jms/QueueConnectionFactory</code> in the JBoss Resource Refs list, and click Edit.</p></li><li class="li"><p>From the Jndi Name pop-up menu, choose <code>java:/ConnectionFactory</code> , and click Update.</p><div class="item_figure"><img src = "../art/deploy_asyncsender2.gif" alt = "image: ../art/deploy_asyncsender2.gif" width="543" height="298"></div></li><li class="li"><p>In the JBoss Resource Env Refs list, select <code>jms/AsyncSenderQueue</code> , and click Edit.</p></li><li class="li"><p>From the Jndi Name pop-up menu, choose <code>/queue/supplier/PurchaseOrderQueue</code>, and click Update.</p></li><li class="li"><p>Click Update to finish configuring the AsyncSender enterprise bean, and close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF109" title="Configure the Catalog Enterprise Bean"></a><h3>Configure the Catalog Enterprise Bean</h3><ol class="ol"><li class="li"><p>Under CatalogJAR (EJB), click Enterprise Beans. Then click CatalogEJB<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_98"></a>.</p></li><li class="li"><p>In the JBoss Resource Refs list in the CatalogEJB window , select <code>jdbc/CatalogDB</code>, and click Edit.</p></li><li class="li"><p>From the Jndi Name pop-up menu, choose <code>java:MySqlDS</code> , and click Update.</p></li><li class="li"><p>In the JBoss Resources Refs list in the CatalogEJB window, select <code>url/CatalogDAOSQLURL</code> , and click Edit.</p></li><li class="li"><p>In the Resource URL text field, enter <code>http://localhost:8080/petstore/CatalogDAOSQL.xml</code>, and click Update.</p></li><li class="li"><p>Click Update to finish configuring the Catalog enterprise bean, and close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-BCIBEFAD" title="Configure the Customer Module"></a><h3>Configure the Customer Module</h3><p>The following sections guide you through the configuration of the Customer module.</p><a name="//apple_ref/doc/uid/TP40002323-CH216-BCIFAEDJ" title="Configure Module-Wide Settings"></a><h4>Configure Module-Wide Settings</h4><p>This section walks you through setting the data source and data-source mapping for the enterprise beans in the Customer module. It also details how to configure the relationships between some of the enterprise beans.</p><ol class="ol"><li class="li"><p>Under CustomerJAR (EJB)<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_99"></a>, click Module Settings.</p></li><li class="li"><p>In the CustomerJAR window, click the CMP - Default Settings tab.</p></li><li class="li"><p>From the Datasource pop-up menu, choose MySQL 4.0.14 (java:/MySqlDS).</p></li><li class="li"><p>From the Datasource Mapping pop-up menu, choose <code>mySQL</code>, and click Update.</p></li><li class="li"><p>From the Entity Command Name pop-up menu, choose <code>no-select-before-insert</code>.</p><div class="item_figure"><img src = "../art/deploy_customer1.gif" alt = "image: ../art/deploy_customer1.gif" width="621" height="642"></div><p>The advantage of configuring the database<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_100"></a><a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_101"></a> and the data-source mapping at the module level is that the settings apply to all the enterprise beans in the module. Therefore, you don’t have to configure those settings for each enterprise bean in the module, unless they differ from the ones set for the module.</p></li><li class="li"><p>Click the CMP - PK Generation tab.</p></li><li class="li"><p>In the Unknown Pk Class text field, enter <code>java.lang.Long</code>.</p></li><li class="li"><p>In the Field Name text field, enter <code>pk</code>.</p></li><li class="li"><p>In the Column Name text field, enter <code>pk</code>.</p></li><li class="li"><p>Set Auto Increment to yes.</p><div class="item_figure"><img src = "../art/deploy_customer2.gif" alt = "image: ../art/deploy_customer2.gif" width="618" height="362"></div></li><li class="li"><p>Click the CMP - Relationships tab.</p></li><li class="li"><p>Configure the relationships<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_102"></a><a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_103"></a>.</p><p><span class="content_text">Table 3-1</span> lists the relationship information for the customer module.</p><a name="//apple_ref/doc/uid/TP40002323-CH216-BCIJIEJJ" title="Table 3-1Relationship information for the Customer module"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 3-1&nbsp;&nbsp;</strong>Relationship information for the Customer module</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Relationship name</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Role name</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Column name</p></th></tr><tr><td  scope="row"><p>CustomerEJB-AccountEJB Relationship</p></td><td ><p>AccountEJB</p></td><td ><p><code>account_fk</code></p></td></tr><tr><td  scope="row"><p>ContactInfoEJB-AddressEJB Relationship</p></td><td ><p>AddressEJB</p></td><td ><p><code>address_fk</code></p></td></tr><tr><td  scope="row"><p>CustomerEJB-ProfileEJB Relationship</p></td><td ><p>ProfileEJB</p></td><td ><p><code>profile_fk</code></p></td></tr><tr><td  scope="row"><p>AccountEJB-ContactInfoEJB Relationship</p></td><td ><p>ContactInfoEJB</p></td><td ><p><code>contactInfo_fk</code></p></td></tr><tr><td  scope="row"><p>AccountEJB-CreditCardEJB Relationship</p></td><td ><p>CreditCardEJB</p></td><td ><p><code>creditCard_fk</code></p></td></tr></table></div><p>Perform the following steps to configure each relationship listed in <span class="content_text">Table 3-1</span>.</p><ol class="ol"><li class="ol ol"><p>In the Ejb Relations list, select the relationship to configure, and click Edit.</p></li><li class="ol ol"><p>In the Relationship Roles list, click the corresponding relationship role.</p></li><li class="ol ol"><p>Click New next to the Key Fields list.</p></li><li class="ol ol"><p>In the Field Name text field, enter <code>pk</code>.</p></li><li class="ol ol"><p>From the Column Name pop-up menu, choose the name of the appropriate column, and click Update.</p></li><li class="ol ol"><p>Click Update to finish configuring the relationship role.</p></li><li class="ol ol"><p>Click Update to finish configuring the relationship.</p></li></ol></li><li class="li"><p>Click Update to finish configuring the Customer module settings, and close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF110" title="Configure the Account Enterprise Bean"></a><h4>Configure the Account Enterprise Bean</h4><ol class="ol"><li class="li"><p>Under CustomerJAR (EJB), click Enterprise Beans. Then click AccountEJB<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_104"></a>.</p></li><li class="li"><p>From the Table Name pop-up menu in the AccountEJB window, choose <code>PS_Account</code>.</p></li><li class="li"><p>Map the CMP fields to the appropriate column names by selecting the field in the Cmp Fields list, clicking Edit, choosing the corresponding column name from the Column Name list, and clicking Update.</p></li><li class="li"><p>Click the CMP - Mapping tab. From the Entity Command Name pop-up menu, choose <code>mysql-get-generated-keys</code>.</p></li><li class="li"><p>Click Update to finish configuring the Account enterprise bean, and close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF111" title="Configure the Address Enterprise Bean"></a><h4>Configure the Address Enterprise Bean</h4><ol class="ol"><li class="li"><p>Under Enterprise Beans under CustomerJAR (EJB), click AddressEJB<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_105"></a>.</p></li><li class="li"><p>From the Table Name pop-up menu in the AddressEJB window, choose <code>PS_Address</code>.</p></li><li class="li"><p>Map the CMP fields to the appropriate column names by selecting the field in the Cmp Fields list, clicking Edit, choosing the corresponding column name from the Column Name list, and clicking Update.</p></li><li class="li"><p>Click the CMP - Mapping tab. From the Entity Command Name pop-up menu, choose <code>mysql-get-generated-keys</code>.</p></li><li class="li"><p>Click Update to finish configuring the Address enterprise bean, and close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF112" title="Configure the ContactInfo Enterprise Bean"></a><h4>Configure the ContactInfo Enterprise Bean</h4><ol class="ol"><li class="li"><p>Under Enterprise Beans under CustomerJAR (EJB), click ContactInfoEJB<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_106"></a>.</p></li><li class="li"><p>From the Table Name pop-up menu in the ContactInfoEJB window, choose <code>PS_ContactInfo</code>.</p></li><li class="li"><p>Map the CMP fields to the appropriate column names by selecting the field in the Cmp Fields list, clicking Edit, choosing the corresponding column name from the Column Name list, and clicking Update.</p></li><li class="li"><p>Click the CMP - Mapping tab. From the Entity Command Name pop-up menu, choose <code>mysql-get-generated-keys</code>.</p></li><li class="li"><p>Click Update to finish configuring the ContactInfo enterprise bean, and close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF113" title="Configure the CreditCard Enterprise Bean"></a><h4>Configure the CreditCard Enterprise Bean</h4><ol class="ol"><li class="li"><p>Under Enterprise Beans under CustomerJAR (EJB), click CreditCardEJB<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_107"></a>.</p></li><li class="li"><p>From the Table Name pop-up menu in the CreditCardEJB window, choose <code>PS_CreditCard</code>.</p></li><li class="li"><p>Map the CMP fields to the appropriate column names by selecting the field in the Cmp Fields list, clicking Edit, choosing the corresponding column name from the Column Name list, and clicking Update.</p></li><li class="li"><p>Click the CMP - Mapping tab. From the Entity Command Name pop-up menu, choose <code>mysql-get-generated-keys</code>.</p></li><li class="li"><p>Click Update to finish configuring the CreditCard enterprise bean, and close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF114" title="Configure the Customer Enterprise Bean"></a><h4>Configure the Customer Enterprise Bean</h4><ol class="ol"><li class="li"><p>Under Enterprise Beans under CustomerJAR (EJB), click CustomerEJB<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_108"></a>.</p></li><li class="li"><p>From the Table Name pop-up menu in the CustomerEJB window, choose <code>PS_Customer</code>.</p></li><li class="li"><p>Map the CMP fields to the appropriate column names by selecting the field in the Cmp Fields list, clicking Edit, choosing the corresponding column name from the Column Name list, and clicking Update.</p></li><li class="li"><p>Click Update to finish configuring the Customer enterprise bean, and close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF115" title="Configure the Profile Enterprise Bean"></a><h4>Configure the Profile Enterprise Bean</h4><ol class="ol"><li class="li"><p>Under Enterprise Beans under CustomerJAR (EJB), click ProfileEJB<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_109"></a>.</p></li><li class="li"><p>From the Table Name pop-up menu in the ProfileEJB window, choose <code>PS_Profile</code>.</p></li><li class="li"><p>Map the CMP fields to the appropriate column names by selecting the field in the Cmp Fields list, clicking Edit, choosing the corresponding column name from the Column Name list, and clicking Update.</p></li><li class="li"><p>Click the CMP - Mapping tab. From the Entity Command Name pop-up menu, choose <code>mysql-get-generated-keys</code>.</p></li><li class="li"><p>Click Update to finish configuring the Profile enterprise bean, and close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF116" title="Configure the PetStore Web Application"></a><h3>Configure the PetStore Web Application</h3><ol class="ol"><li class="li"><p>Under PetStoreWAR<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_110"></a> (WebApp), click Module Settings.</p></li><li class="li"><p>In the JBoss Resource Refs list in the PetStoreWAR window, select <code>jdbc/CatalogDB</code>, and click Edit.</p></li><li class="li"><p>From the Jndi Name pop-up menu, choose <code>java:/MySqlDS</code>, and click Update.</p></li><li class="li"><p>In the JBoss Resource Refs list, select <code>url/CatalogDAOSQLURL</code>, and click Edit.</p></li><li class="li"><p>In the Resource URL text field, enter <code>http://localhost:8080/petstore/CatalogDAOSQL.xml</code>, and click Update.</p></li><li class="li"><p>Click Update to finish configuring the PetStore web application, and close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF117" title="Configure the SignOn Module"></a><h3>Configure the SignOn Module</h3><ol class="ol"><li class="li"><p>Under SignOnJAR<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_111"></a> (EJB), click Module Settings.</p></li><li class="li"><p>In the SignOnJAR window, click the CMP - Default Settings tab.</p></li><li class="li"><p>From the Entity Command Name pop-up menu, choose <code>no-select-before-insert</code>, and click Update.</p></li><li class="li"><p>Close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF118" title="Configure the User Enterprise Bean"></a><h3>Configure the User Enterprise Bean</h3><ol class="ol"><li class="li"><p>Under Enterprise Beans under SignOnJAR (EJB), click UserEJB<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_112"></a>.</p></li><li class="li"><p>From the Datasource pop-up menu in the UserEJB window, choose MySQL 4.0.14 (java:/MySqlDS).</p></li><li class="li"><p>From the Datasource Mapping pop-up menu, choose <code>mySql</code>.</p></li><li class="li"><p>From the Table Name pop-up menu, choose <code>PS_User</code>.</p></li><li class="li"><p>Map the CMP fields to the appropriate column names by selecting the field in the Cmp Fields list, clicking Edit, choosing the corresponding column name from the Column Name list, and clicking Update.</p></li><li class="li"><p>Click Update to finish configuring the User enterprise bean, and close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF119" title="Configure the Counter Enterprise Bean"></a><h3>Configure the Counter Enterprise Bean</h3><ol class="ol"><li class="li"><p>Under UniqueIdGeneratorJAR (EJB), click Enterprise Beans. Then click CounterEJB<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_113"></a>.</p></li><li class="li"><p>From the Datasource pop-up menu in the CounterEJB window, choose MySQL 4.0.14 (java:/MySqlDS).</p></li><li class="li"><p>From the Datasource Mapping pop-up menu, choose <code>mySql</code>.</p></li><li class="li"><p>From the Table Name pop-up menu, choose <code>PS_Counter</code>.</p></li><li class="li"><p>Map the CMP fields to the appropriate column names by selecting the field in the Cmp Fields list, clicking Edit, choosing the corresponding column name from the Column Name list, and clicking Update.</p></li><li class="li"><p>Click Update to finish configuring the Counter enterprise bean, and close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF120" title="Save the Application"></a><h3>Save the Application</h3><p>To save the configured PetStore application, click Save in the navigation window and choose a location for it:</p><ol class="ol"><li class="li"><p>Using the Finder or Terminal, create a directory under <code>/Library</code> named Configured_Apps.</p></li><li class="li"><p>In the main window, click Save.</p></li><li class="li"><p>In the text field in the Save Application window, enter <code>/Library/Configured_Apps/petstore.ear</code>, and click Save Application.</p></li><li class="li"><p>Close the window.<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_114"></a><a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_115"></a></p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-BCIFBJEB" title="Configure the Supplier Enterprise Application"></a><h2>Configure the Supplier Enterprise Application</h2><p><a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_116"></a><a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_117"></a>The following sections guide you through configuring the Supplier enterprise application.</p><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF121" title="Open the supplier.ear file in the Deployment Tool"></a><h3>Open the supplier.ear file in the Deployment Tool</h3><ol class="ol"><li class="li"><p>In the PetStoreEAR window, click Load.</p></li><li class="li"><p>In the text field in the Load Application window, enter the path to the <code>supplier.ear</code> file, and click Load Application or press Return.</p></li><li class="li"><p>In the navigation window, click Connect.</p></li><li class="li"><p>If the Connect to Server window indicates that you’re not connected to the application server, click Connect to Server.</p></li><li class="li"><p>Close the Connect to Server window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF122" title="Configure Application-Wide Settings"></a><h3>Configure Application-Wide Settings</h3><ol class="ol"><li class="li"><p><a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_118"></a>Under SupplierEAR<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_119"></a> (Application), click Application Settings.</p></li><li class="li"><p>In the SupplierEAR window, click the JBoss tab.</p></li><li class="li"><p>Set J2EE Compliant Class Loading to no, and click Update.</p></li><li class="li"><p>Close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF123" title="Configure the Supplier Module"></a><h3>Configure the Supplier Module</h3><p>The following sections explain how to configure the SupplierJAR module.</p><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF124" title="Configure the Module Settings"></a><h4>Configure the Module Settings</h4><ol class="ol"><li class="li"><p>Under SupplierJAR<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_120"></a> (EJB), click Module Settings.</p></li><li class="li"><p>In the SupplierJAR window, click the CMP - Default Settings tab.</p></li><li class="li"><p>From the Datasource pop-up menu, choose MySQL 4.0.14 (java:/MySqlDS).</p></li><li class="li"><p>From the Datasource Mapping pop-up menu, choose <code>mySql</code>, and click Update.</p></li><li class="li"><p>Close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF125" title="Configure the Inventory Enterprise Bean"></a><h4>Configure the Inventory Enterprise Bean</h4><ol class="ol"><li class="li"><p>Under SupplierJAR (EJB), click Enterprise Beans. Then click InventoryEJB<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_121"></a>.</p></li><li class="li"><p>From the Table Name pop-up menu, choose <code>SUPP_Inventory</code>.</p></li><li class="li"><p>Map the CMP fields to the appropriate column names by selecting the field in the Cmp Fields list, clicking Edit, choosing the corresponding column name from the Column Name list, and clicking Update.</p></li><li class="li"><p>Click Update to finish configuring the Inventory enterprise bean, and close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF126" title="Configure the OrderFulfillmentFacade Enterprise Bean"></a><h4>Configure the OrderFulfillmentFacade Enterprise Bean</h4><ol class="ol"><li class="li"><p>Under Enterprise Beans under SupplierJAR (EJB), click OrderFulfillmentFacade<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_122"></a>.</p></li><li class="li"><p>In the JBoss Resource Refs list in the OrderFulfillmentFacadeEJB window, select <code>url/EntityCatalogURL</code>, and click Edit.</p></li><li class="li"><p>In the Res URL text field, enter <code>http://localhost:8080/opc/EntityCatalog.jsp</code>, and click Update.</p></li><li class="li"><p>Click Update to finish configuring the OrderFulfillmentFacade enterprise bean, and close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF127" title="Configure the SupplierOrder Message-Driven Bean"></a><h4>Configure the SupplierOrder Message-Driven Bean</h4><ol class="ol"><li class="li"><p>Under Enterprise Beans under SupplierJAR (EJB), click SupplierOrderMDB<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_123"></a>.</p></li><li class="li"><p>In the JBoss Resource Refs list, select <code>jms/QueueConnectionFactory</code>, and click Edit.</p></li><li class="li"><p>From the Jndi Name pop-up menu, choose <code>/ConnectionFactory</code>, and click Update.</p></li><li class="li"><p>In the JBoss Resource Refs list, select <code>jms/TopicConnectionFactory</code>, and click Edit.</p></li><li class="li"><p>From the Jndi Name pop-up menu, choose <code>/ConnectionFactory</code>, and click Update.</p></li><li class="li"><p>In the JBoss Resource Env Refs list, select <code>jms/opc/InvoiceTopic</code>, and click Edit.</p></li><li class="li"><p>From the Jndi Name pop-up menu, choose <code>/topic/opc/InvoiceTopic</code>, and click Update.</p></li><li class="li"><p>Click Update to finish configuring the SupplierOrder message-driven bean, and close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF128" title="Configure the SupplierPurchaseOrder Module"></a><h3>Configure the SupplierPurchaseOrder Module</h3><p>These sections explain how to configure the SupplierPurchaseOrderJAR module.</p><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF129" title="Configure the Module Settings"></a><h4>Configure the Module Settings</h4><ol class="ol"><li class="li"><p>Under SupplierPurchaseOrderJAR<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_124"></a> (EJB), click Module Settings.</p></li><li class="li"><p>In the SupplierPurchaseOrderJAR window, click the CMP - Default Settings tab.</p></li><li class="li"><p>From the Datasource pop-up menu, choose MySQL 4.0.14 (java:/MySqlDS).</p></li><li class="li"><p>From the Datasource mapping pop-up menu, choose <code>mySql</code>.</p></li><li class="li"><p>From the Entity Command Name pop-up menu, choose <code>no-select-before-insert</code>.</p></li><li class="li"><p>Click the CMP - PK Generation tab.</p></li><li class="li"><p>In the Unknown Pk Class text field, enter <code>java.lang.Long</code>.</p></li><li class="li"><p>In the Field Name text field, Enter <code>pk</code>.</p></li><li class="li"><p>In the Column Name text field, enter <code>pk</code>.</p></li><li class="li"><p>Set Auto Increment to yes, and click Update.</p></li><li class="li"><p>Close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF130" title="Configure the Address Enterprise Bean"></a><h4>Configure the Address Enterprise Bean</h4><ol class="ol"><li class="li"><p>Under SupplierPurchaseOrderJAR (EJB), click Enterprise Beans. Then click AddressEJB<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_125"></a>.</p></li><li class="li"><p>From the Table Name pop-up menu in the AddressEJB window, choose <code>PS_Address</code>.</p></li><li class="li"><p>Map the CMP fields to the appropriate column names by selecting the field in the Cmp Fields list, clicking Edit, choosing the corresponding column name from the Column Name list, and clicking Update.</p></li><li class="li"><p>Click the CMP - Mapping tab. From the Entity Command Name pop-up menu, choose <code>mysql-get-generated-keys</code>.</p></li><li class="li"><p>Click Update to finish configuring the Address enterprise bean, and close the AddressEJB window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF131" title="Configure the ContactInfo Enterprise Bean"></a><h4>Configure the ContactInfo Enterprise Bean</h4><ol class="ol"><li class="li"><p>Under Enterprise Beans under SupplierPurchaseOrderJAR (EJB), click ContactInfoEJB<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_126"></a>.</p></li><li class="li"><p>From the Table Name pop-up menu in the ContactInfoEJB window, choose <code>PS_ContactInfo</code>.</p></li><li class="li"><p>Map the CMP fields to the appropriate column names by selecting the field in the Cmp Fields list, clicking Edit, choosing the corresponding column name from the Column Name list, and clicking Update.</p></li><li class="li"><p>Click the CMP - Mapping tab. From the Entity Command Name pop-up menu, choose <code>mysql-get-generated-keys</code>.</p></li><li class="li"><p>Click Update to finish configuring the ContactInfo enterprise bean, and close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF132" title="Configure the LineItem Enterprise Bean"></a><h4>Configure the LineItem Enterprise Bean</h4><ol class="ol"><li class="li"><p>Under Enterprise Beans under SupplierPurchaseOrderJAR (EJB), click LineItemEJB<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_127"></a>.</p></li><li class="li"><p>From the Table Name pop-up menu in the LineItemEJB window, choose <code>SUPP_LineItem</code>.</p></li><li class="li"><p>Map the CMP fields to the appropriate column names by selecting the field in the Cmp Fields list, clicking Edit, choosing the corresponding column name from the Column Name list, and clicking Update.</p></li><li class="li"><p>Click the CMP - Mapping tab. From the Entity Command Name pop-up menu, choose <code>mysql-get-generated-keys</code>.</p></li><li class="li"><p>Click Update to finish configuring the LineItem enterprise bean, and close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF133" title="Configure the SupplierOrder Enterprise Bean"></a><h4>Configure the SupplierOrder Enterprise Bean</h4><ol class="ol"><li class="li"><p>Under Enterprise Beans under SupplierPurchaseOrderJAR (EJB), click SupplierOrderEJB<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_128"></a>.</p></li><li class="li"><p>From the Table Name pop-up menu in the SupplierOrderEJB window, choose <code>SUPP_SupplierOrder</code>.</p></li><li class="li"><p>Map the CMP fields to the appropriate column names by selecting the field in the Cmp Fields list, clicking Edit, choosing the corresponding column name from the Column Name list, and clicking Update.</p></li><li class="li"><p>Click the CMP - Mapping tab. From the Entity Command Name pop-up menu, choose <code>mysql-get-generated-keys</code>.</p></li><li class="li"><p>Click Update to finish configuring the SupplierOrder enterprise bean, and close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF134" title="Configure the Supplier Web Application Module"></a><h3>Configure the Supplier Web Application Module</h3><ol class="ol"><li class="li"><p>Under SupplierWAR<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_129"></a> (WebApp), click Module Settings.</p></li><li class="li"><p>In the JBoss Resource Env Refs list, select <code>jms/opc/InvoiceTopic</code>, and click Edit.</p></li><li class="li"><p>From the Jndi Name pop-up menu, choose <code>/topic/opc/InvoiceTopic</code>, and click Update.</p></li><li class="li"><p>In the JBoss Resource Refs list, select <code>jms/TopicConnectionFactory</code>, and click Edit.</p></li><li class="li"><p>From the Jndi Name pop-up menu, choose <code>/ConnectionFactory</code>, and click Update.</p></li><li class="li"><p>Click Update to finish configuring the Supplier web-application module, and close the window.</p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF135" title="Save the Application"></a><h3>Save the Application</h3><ol class="ol"><li class="li"><p>In the navigation window, click Save.</p></li><li class="li"><p>In the text field in the Save Application window, enter <code>/Library/Configured_Apps/supplier.ear</code>, and click Save Application.</p></li><li class="li"><p>Close the window.<a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_130"></a><a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_131"></a></p></li></ol><a name="//apple_ref/doc/uid/TP40002323-CH216-TPXREF136" title="Deploy and Test the Application"></a><h2>Deploy and Test the Application</h2><p><a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_132"></a><a name="//apple_ref/doc/uid/TP40002323-CH216-DontLinkElementID_133"></a>To deploy Pet Store in Mac OS X Server, copy the configured files to <code>/Library/JBoss/3.2/deploy</code>. (You can also use the management tool to deploy the application. See <span class="content_text"><a href="../AdministeringAppServers/AdministeringAppServers.html#//apple_ref/doc/uid/TP40002323-CH217-CJBDFIAG">“Deploying Applications”</a></span> for details.) After about a minute, open <code>http://localhost:8080/petstore</code> in your web browser. You could also have saved the EAR files directly to the JBoss <code>deploy</code> directory. However, it’s generally safer to configure application files of undeployed archives.</p><p>Follow these steps to test Pet Store:</p><ol class="ol"><li class="li"><p>Open <code>http://localhost:8080/petstore</code> in a web-browser window.</p></li><li class="li"><p>Click the link that takes you to the store.</p></li><li class="li"><p>In the Welcome to the BluePrints Petstore webpage, click Birds.</p></li><li class="li"><p>In the Items webpage, click Amazon Parrot.</p></li><li class="li"><p>In the Product webpage, click Add to Cart.</p></li><li class="li"><p>In the Cart webpage, click Check Out.</p></li><li class="li"><p>In the Sign On webpage, click Sign In.</p></li><li class="li"><p>In the Enter Order Information webpage, click Submit.</p></li></ol><p>If you get an error page during the test, make sure JBoss is running and recheck the configuration settings described in <span class="content_text"><a href="ConfiguringPetStore.html#//apple_ref/doc/uid/TP40002323-CH216-BCIGBICG">“Configure the Pet Store Enterprise Application”</a></span> and <span class="content_text"><a href="ConfiguringPetStore.html#//apple_ref/doc/uid/TP40002323-CH216-BCIFBJEB">“Configure the Supplier Enterprise Application.”</a></span></p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../ConfiguringApplications/ConfiguringApplications.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../AdministeringAppServers/AdministeringAppServers.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2003, 2005 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2005-08-11<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/WebObjects/Conceptual/J2EE_JavaAppServerGuide/ConfiguringPetStore/ConfiguringPetStore.html%3Fid%3DTP40002323-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/WebObjects/Conceptual/J2EE_JavaAppServerGuide/ConfiguringPetStore/ConfiguringPetStore.html%3Fid%3DTP40002323-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/WebObjects/Conceptual/J2EE_JavaAppServerGuide/ConfiguringPetStore/ConfiguringPetStore.html%3Fid%3DTP40002323-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>