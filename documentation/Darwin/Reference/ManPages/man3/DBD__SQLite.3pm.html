<html><head><title>Mac OS X
 Manual Page For DBD::SQLite(3pm)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/3pm/DBD::SQLite" title="Mac OS X
 Manual Page for DBD::SQLite(3pm)"><a name="//apple_ref/doc/man/3/DBD::SQLite" title="Mac OS X
 Manual Page for DBD::SQLite(3pm)"><!-- headerDoc=man; indexgroup=Section 3pm; uid="//apple_ref/doc/man/3pm/DBD::SQLite"; name=DBD::SQLite(3pm) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
DBD::SQLite(3)                       User Contributed Perl Documentation                      DBD::SQLite(3)



<b>NAME</b>
       DBD::SQLite - Self Contained RDBMS in a DBI Driver

<b>SYNOPSIS</b>
         use DBI;
         my $dbh = DBI-&gt;connect("dbi:SQLite:dbname=dbfile","","");

<b>DESCRIPTION</b>
       SQLite is a public domain RDBMS database engine that you can find at <a href="http://www.hwaci.com/sw/sqlite/">http://www.hwaci.com/sw/sqlite/</a>

       Rather than ask you to install SQLite first, because SQLite is public domain, DBD::SQLite includes
       the entire thing in the distribution. So in order to get a fast transaction capable RDBMS working for
       your perl project you simply have to install this module, and <b>nothing</b> else.

       SQLite supports the following features:

       Implements a large subset of SQL92
           See <a href="http://www.hwaci.com/sw/sqlite/lang.html">http://www.hwaci.com/sw/sqlite/lang.html</a> for details.

       A complete DB in a single disk file
           Everything for your database is stored in a single disk file, making it easier to move things
           around than with DBD::CSV.

       Atomic commit and rollback
           Yes, DBD::SQLite is small and light, but it supports full transactions!

       Extensible
           User-defined aggregate or regular functions can be registered with the SQL parser.

       There's lots more to it, so please refer to the docs on the SQLite web page, listed above, for SQL
       details. Also refer to DBI for details on how to use DBI itself.

<b>CONFORMANCE</b> <b>WITH</b> <b>DBI</b> <b>SPECIFICATION</b>
       The API works like every DBI module does. Please see DBI for more details about core features.

       Currently many statement attributes are not implemented or are limited by the typeless nature of the
       SQLite database.

<b>DRIVER</b> <b>PRIVATE</b> <b>ATTRIBUTES</b>
       <b>Database</b> <b>Handle</b> <b>Attributes</b>


       sqlite_version
           Returns the version of the SQLite library which DBD::SQLite is using, e.g., "2.8.0". Can only be
           read.

       unicode
           If set to a true value, DBD::SQLite will turn the UTF-8 flag on for all text strings coming out
           of the database. For more details on the UTF-8 flag see perlunicode. The default is for the UTF-8
           flag to be turned off.

           Also note that due to some bizareness in SQLite's type system (see
           <a href="http://www.sqlite.org/datatype3.html)">http://www.sqlite.org/datatype3.html)</a> if you want to retain blob-style behavior for <b>some</b> columns
           under "$dbh-&gt;{unicode} = 1" (say, to store images in the database), you have to state so
           explicitely using the 3-argument form of "bind_param" in DBI when doing updates:

               use DBI qw(:sql_types);
               $dbh-&gt;{unicode} = 1;
               my $sth = $dbh-&gt;prepare
                    ("INSERT INTO mytable (blobcolumn) VALUES (?)");
               $sth-&gt;bind_param(1, $binary_data, SQL_BLOB); # binary_data will
               # be stored as-is.

           Defining the column type as BLOB in the DDL is <b>not</b> sufficient.

<b>DRIVER</b> <b>PRIVATE</b> <b>METHODS</b>
       <b>$dbh-&gt;func('last_insert_rowid')</b>

       This method returns the last inserted rowid. If you specify an INTEGER PRIMARY KEY as the first
       column in your table, that is the column that is returned.  Otherwise, it is the hidden ROWID column.
       See the sqlite docs for details.

       Note: You can now use $dbh-&gt;<u>last</u><b>_</b><u>insert</u><b>_</b><u>id()</u> if you have a recent version of DBI.

       <b>$dbh-&gt;func(</b> <b>'busy_timeout'</b> <b>)</b>

       Retrieve the current busy timeout.

       <b>$dbh</b>-&gt;func( $ms, 'busy_timeout' )

       Set the current busy timeout. The timeout is in milliseconds.

       <b>$dbh</b>-&gt;func( $name, $argc, $func_ref, "create_function" )

       This method will register a new function which will be useable in SQL query. The method's parameters
       are:

       $name
           The name of the function. This is the name of the function as it will be used from SQL.

       $argc
           The number of arguments taken by the function. If this number is -1, the function can take any
           number of arguments.

       $func_ref
           This should be a reference to the function's implementation.

       For example, here is how to define a <u>now()</u> function which returns the current number of seconds since
       the epoch:

           $dbh-&gt;func( 'now', 0, sub { return time }, 'create_function' );

       After this, it could be use from SQL as:

           INSERT INTO mytable ( now() );

       <b>$dbh</b>-&gt;func( $name, $argc, $pkg, 'create_aggregate' )

       This method will register a new aggregate function which can then used from SQL. The method's
       parameters are:

       $name
           The name of the aggregate function, this is the name under which the function will be available
           from SQL.

       $argc
           This is an integer which tells the SQL parser how many arguments the function takes. If that
           number is -1, the function can take any number of arguments.

       $pkg
           This is the package which implements the aggregator interface.

       The aggregator interface consists of defining three methods:

       <u>new()</u>
           This method will be called once to create an object which should be used to aggregate the rows in
           a particular group. The <u>step()</u> and <u>finalize()</u> methods will be called upon the reference return by
           the method.

       step(@_)
           This method will be called once for each rows in the aggregate.

       <u>finalize()</u>
           This method will be called once all rows in the aggregate were processed and it should return the
           aggregate function's result. When there is no rows in the aggregate, <u>finalize()</u> will be called
           right after <u>new()</u>.

       Here is a simple aggregate function which returns the variance (example adapted from pysqlite):

           package variance;

           sub new { bless [], shift; }

           sub step {
               my ( $self, $value ) = @_;

               push @$self, $value;
           }

           sub finalize {
               my $self = $_[0];

               my $n = @$self;

               # Variance is NULL unless there is more than one row
               return undef unless $n || $n == 1;

               my $mu = 0;
               foreach my $v ( @$self ) {
                   $mu += $v;
               }
               $mu /= $n;

               my $sigma = 0;
               foreach my $v ( @$self ) {
                   $sigma += ($x - $mu)**2;
               }
               $sigma = $sigma / ($n - 1);

               return $sigma;
           }

           $dbh-&gt;func( "variance", 1, 'variance', "create_aggregate" );

       The aggregate function can then be used as:

           SELECT group_name, variance(score) FROM results
           GROUP BY group_name;

<b>BLOBS</b>
       As of version 1.11, blobs should "just work" in SQLite as text columns. However this will cause the
       data to be treated as a string, so SQL statements such as <!-- a -->length(x)<!-- /a --> will return the length of the
       column as a NUL terminated string, rather than the size of the blob in bytes. In order to store
       natively as a BLOB use the following code:

         use DBI qw(:sql_types);
         my $dbh = DBI-&gt;connect("dbi:sqlite:/path/to/db");

         my $blob = `cat foo.jpg`;
         my $sth = $dbh-&gt;prepare("INSERT INTO mytable VALUES (1, ?)");
         $sth-&gt;bind_param(1, $blob, SQL_BLOB);
         $sth-&gt;execute();

       And then retreival just works:

         $sth = $dbh-&gt;prepare("SELECT * FROM mytable WHERE id = 1");
         $sth-&gt;execute();
         my $row = $sth-&gt;fetch;
         my $blobo = $row-&gt;[1];

         # now $blobo == $blob

<b>NOTES</b>
       To access the database from the command line, try using dbish which comes with the DBI module. Just
       type:

         dbish dbi:SQLite:foo.db

       On the command line to access the file <u>foo.db</u>.

       Alternatively you can install SQLite from the link above without conflicting with DBD::SQLite and use
       the supplied "sqlite" command line tool.

<b>PERFORMANCE</b>
       SQLite is fast, very fast. I recently processed my 72MB log file with it, inserting the data
       (400,000+ rows) by using transactions and only committing every 1000 rows (otherwise the insertion is
       quite slow), and then performing queries on the data.

       Queries like count(*) and avg(bytes) took fractions of a second to return, but what surprised me most
       of all was:

         SELECT url, count(*) as count FROM access_log
           GROUP BY url
           ORDER BY count desc
           LIMIT 20

       To discover the top 20 hit URLs on the site (<a href="http://axkit.org)">http://axkit.org)</a> and it returned within 2 seconds. I'm
       seriously considering switching my log analysis code to use this little speed demon!

       Oh yeah, and that was with no indexes on the table, on a 400MHz PIII.

       For best performance be sure to tune your hdparm settings if you are using linux. Also you might want
       to set:

         PRAGMA default_synchronous = OFF

       Which will prevent sqlite from doing fsync's when writing (which slows down non-transactional writes
       significantly) at the expense of some peace of mind. Also try playing with the cache_size pragma.

<b>BUGS</b>
       Likely to be many, please use <a href="http://rt.cpan.org/">http://rt.cpan.org/</a> for reporting bugs.

<b>AUTHOR</b>
       Matt Sergeant, matt@sergeant.org

       Perl extension functions contributed by Francis J. Lacoste &lt;flacoste@logreport.org&gt; and Wolfgang
       Sourdeau &lt;wolfgang@logreport.org&gt;

<b>SEE</b> <b>ALSO</b>
       DBI.



perl v5.8.8                                      2006-09-07                                   DBD::SQLite(3)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man3/DBD__SQLite.3pm.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man3/DBD__SQLite.3pm.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man3/DBD__SQLite.3pm.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
