<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>QuickTime Video Effects and Transitions Guide: Constructing a Video Effects User Interface</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Constructing a Video Effects User Interface"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface" title="Constructing a Video Effects User Interface"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000433" target="_top">QuickTime</a> &gt; <a href="../../../../VideoEffectsTransitions-date.html#//apple_ref/doc/uid/TP30000440-TP30000433-TP30000588" target="_top">Video Effects &amp; Transitions</a> &gt; <a href="../A-Intro/1Introduction.html#//apple_ref/doc/uid/TP40000868-IntroductiontoQuickTimeVideoEffectsandTransitionsGuide-DontLinkElementID_130">QuickTime Video Effects and Transitions Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../B-Chapter/2HowToAddQuickTimeVi.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../D-Chapter/4Built-inQuickTimeVi.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-SW1" title="Constructing a Video Effects User Interface"></a>
<h1>Constructing a Video Effects User Interface</h1>

<p>This chapter discusses how to construct a user interface that enables users to select an effect, change its parameters, and preview the results.</p>
<p>If your application creates QuickTime movies with video effects, you need to provide the user with a way to choose an effect, adjust its parameters, and preview the results. Although you are free to write your own code for these user interface tasks, you are encouraged to use the APIs that QuickTime provides.</p>
<p>QuickTime provides a standard dialog box (called the <strong>standard</strong> <strong>parameters</strong> <strong>dialog</strong> <strong>box)</strong> that allows the user to select an effect, choose values for its parameters, and preview the effect. Using this dialog box means that your users see an interface that is standard across applications. In addition, if effects parameters change in the future, your application will not need to be rebuilt to use them.</p>
<p>In most applications, it is appropriate to show the standard parameters dialog box to let users choose and customize effects. QuickTime provides a set of high-level API functions that you can call to do this. <span class="content_text"><a href="3ConstructingaVideoE.html#//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DisplayingtheEffectsUserInterfaceUsingtheHighLevelAPI">Displaying the Effects User Interface Using the High-Level API</a></span> explains the use of these functions.</p>
<p>In some cases, you might need greater control over the effects user interface than these high-level functions provide. You might, for example, want to add the controls from the standard dialog box to one of your applicationâ€™s own dialog boxes. QuickTime provides a set of low-level APIs that let you do this. They give you greater control and flexibility than the high-level functions, but they are more complex to use. These low-level functions are discussed in <span class="content_text"><a href="3ConstructingaVideoE.html#//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-AddingVideoEffectsControlstoanExistingDialogBox">Adding Video Effects Controls to an Existing Dialog Box</a></span>.</p>



<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="3ConstructingaVideoE.html#//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DontLinkElementID_22">Displaying the Effects User Interface Using the High-Level API</a>
				
			<br/>
			
        
			
			
				<a href="3ConstructingaVideoE.html#//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DontLinkElementID_25">Processing Standard Parameter Dialog Box Events</a>
				
			<br/>
			
        
			
			
				<a href="3ConstructingaVideoE.html#//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DontLinkElementID_26">Adding Video Effects Controls to an Existing Dialog Box</a>
				
			<br/>
			
        
			
			
				<a href="3ConstructingaVideoE.html#//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DontLinkElementID_27">Creating Your Application's Dialog Box</a>
				
			<br/>
			
        
			
			
				<a href="3ConstructingaVideoE.html#//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DontLinkElementID_28">Incorporating Controls From the Standard Parameters Dialog Box</a>
				
			<br/>
			
        
			
			
				<a href="3ConstructingaVideoE.html#//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DontLinkElementID_29">Adding a Preview to Your Dialog Box</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DontLinkElementID_22" title="Displaying the Effects User Interface Using the High-Level API"></a>
<h2><a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DisplayingtheEffectsUserInterfaceUsingtheHighLevelAPI" title="Displaying the Effects User Interface Using the High-Level API"></a>Displaying the Effects User Interface Using the High-Level API</h2>
<p>This section describes the set of functions you call to invoke the standard parameters dialog box in your applications.</p>
<a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DontLinkElementID_23" title="Getting a List of Effects"></a>
<h3><a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-GettingaListofEffects" title="Getting a List of Effects"></a>Getting a List of Effects</h3>
<p>Before your application presents the standard parameters dialog box to users, you will probably want to build a list of the effects that are available. QuickTime provides the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTGetEffectsList" target="_top">QTGetEffectsList</a></code> function to do this for you. This returns a <code>QTAtomContainer</code> structure that contains a list of all the effects currently available.</p>
<div class="importantbox"><a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DontLinkElementID_136" title="Important:"></a><p><strong>Important:</strong>&nbsp;
The <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTGetEffectsList" target="_top">QTGetEffectsList</a></code> function can take several seconds to execute, so you should typically call it only once when your application is launched (or after a pair of suspend and resume events).  </p><p>
</p></div>
<p>You can remove effects from the returned list if you want to restrict the set of effects the user can choose from.</p>
<p>If you present the standard parameters dialog box without providing a list of effects, the dialog function gets the list of available effects automatically. This can save you a few lines of code, but your users must wait while QuickTime searches for available effects and generates the list every time you open the dialog box.</p>

<a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DontLinkElementID_24" title="Displaying the Standard Parameters Dialog Box"></a>
<h3><a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DisplayingtheStandardParametersDialogBox" title="Displaying the Standard Parameters Dialog Box"></a>Displaying the Standard Parameters Dialog Box</h3>
<p>Use the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTCreateStandardParameterDialog" target="_top">QTCreateStandardParameterDialog</a></code> function to display the standard parameters dialog box. This allows the user to choose an effect, adjust the settings for that effect, and see a preview of the effect with the selected settings. The use of this function is described below.</p>
<p>When you call the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTCreateStandardParameterDialog" target="_top">QTCreateStandardParameterDialog</a></code> function, QuickTime creates a standard parameters dialog box. The contents of the dialog box vary, depending on the list of effects you pass to the function and the set of parameters for the currently chosen effect.</p>
<p>Calling <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTCreateStandardParameterDialog" target="_top">QTCreateStandardParameterDialog</a></code> does not immediately display the dialog box; it only prepares it for display. The dialog box is shown the first time you call <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTIsStandardParameterDialogEvent" target="_top">QTIsStandardParameterDialogEvent</a></code> to process events for the dialog box. Event handling is described in <span class="content_text"><a href="3ConstructingaVideoE.html#//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-ProcessingStandardParameterDialogBoxEvents">Processing Standard Parameter Dialog Box Events</a></span>.</p>
<p>The standard parameters dialog box for Appleâ€™s film noise effect is shown in FigureÂ 2-1.</p>
<br/><div><img src = "../Art/parameter_dialog_box.jpg" alt = "The standard parameters dialog box for Apple's film noise effect" ></div><br/>
<p>Notice that the dialog box has three main sections. In the upper-left corner is a scrolling list of all the effect components. To the right of this are the parameters of the chosen effect. As you select different items in the list of effects, the parameters change appropriately. There is also an effect preview area below the list of effects. This shows a preview of the chosen effect and parameter settings.</p>
<p>The user interface for setting the value of a parameter may be a slider, as shown in the example above, a set of radio buttons, an editable text field, or any of several other interfaces specified in the parameter descriptionâ€™s <code>kParameterDataBehavior</code> field.</p>
<p>For parameters that are always tweens, the user is presented with a starting and ending value. For parameters that can be tweened optionally, the dialog box presents the user with a single value by default. In order to set such a parameter to a tweened value, the user must hold down the Option key when selecting an effect.</p>
<p>Note that your application does not need to know what effects are available, what their parameters are, or what kind of control to use when setting a parameter. All these details are handled by the standard dialog box function.</p>
<p>The function call to create and display this dialog box is</p>

<div class="codesample"><table><tr><td scope="row"><pre>QTCreateStandardParameterDialog(theEffectList,<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â theEffectParameters,<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 0,<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &amp;createdDialogID);<span></span></pre></td></tr></table></div>

<p>The variable <code>theEffectList</code> holds the list of effects returned by the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTGetEffectsList" target="_top">QTGetEffectsList</a></code> function. You can also pass <code>nil</code> for this value, in which case <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTCreateStandardParameterDialog" target="_top">QTCreateStandardParameterDialog</a></code> calls <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTGetEffectsList" target="_top">QTGetEffectsList</a></code> to generate the list of all the currently installed effects, then shows these effects. On input, <code>theEffectParameters</code> contains a <code>QTAtomContainer</code> structure that holds the initial values of the effectâ€™s parameters. In most cases, you should pass an empty <code>QTAtomContainer</code> structure as this argument, in which case the default values of each effect are shown.</p>
<p>The third argument specifies how to deal with parameters that can be tweened. Passing in 0 selects the default behavior, which allows the user to set a starting and ending value for parameters that must be tweens, but only allows the user to set a single value for parameters that are optionally tweens.</p>
<p>When the user selects the dialog boxâ€™s OK button, the chosen effectâ€™s parameter values are returned in <code>theEffectParameters</code>. The parameter values are returned in a <code>QTAtomContainer</code> structure that you can use as an effect description. You will need to add <code>kEffectSourceName</code> atoms for effects that use one or more sources.</p>
<p>The <code>createdDialog</code> argument returns an ID number that is passed to the other functions that deal with the standard parameters dialog box. This is explained in detail in the next section.</p>


<a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DontLinkElementID_25" title="Processing Standard Parameter Dialog Box Events"></a>
<h2><a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-ProcessingStandardParameterDialogBoxEvents" title="Processing Standard Parameter Dialog Box Events"></a>Processing Standard Parameter Dialog Box Events</h2>
<p>Once the dialog box has been created, you must process the events sent to it using an event loop. You repeatedly call <code>WaitNextEvent</code> and pass the events returned through the  <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTIsStandardParameterDialogEvent" target="_top">QTIsStandardParameterDialogEvent</a></code> function.</p>
<p>The <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTIsStandardParameterDialogEvent" target="_top">QTIsStandardParameterDialogEvent</a></code> function checks each event to see if it relates to the standard parameters dialog box. You should continue to handle events that are not related to the standard parameters dialog box as usual.</p>
<div class="warningbox"><img src="../../../../../Resources/Images/icon_warning.gif" alt="!" width="20" height="20" border="0" class="warningicon" /><a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DontLinkElementID_137" title="Warning:"></a><p><strong>Warning:</strong>&nbsp;
You should not use the <code>ModalDialog</code> function to process events for a standard parameters dialog box. The <code>ModalDialog</code> function is not guaranteed to work correctly in all circumstances with a standard parameters dialog box.  </p><p>
</p><div class="clear"></div></div>
<p>You pass the event record returned from <code>WaitNextEvent</code> to the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTIsStandardParameterDialogEvent" target="_top">QTIsStandardParameterDialogEvent</a></code> function, then check the return value to find out how the events was handled. Common return values are shown in the table below.</p>
<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Term</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Definition</p></th>
</tr>


<tr>
<td  scope="row"><p><code>noErr</code></p></td>
<td ><p>The event was related to the standard parameters dialog box and was completely processed. Your application should not process this event, instead it should poll <code>WaitNextEvent</code> again.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>featureUnsupported</code></p></td>
<td ><p>The event was not related to the standard parameters dialog box. Your application should process the event in the normal way.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>codecParameterDialogConfirm</code></p></td>
<td ><p>The user clicked the OK button in the standard parameters dialog box. Your application should call <code>QTDismissStandardParameterDialog</code> to close the dialog box. The values chosen by the user are put into the atom container you passed in the <code>parameters</code> parameter when you called <code>QTCreateStandardParameterDialog</code>. This atom container now holds an effect description that is ready to insert into an effects track (it may require one or two kEffectSourceName atoms to be complete).</p></td>
</tr>
<tr>
<td  scope="row"><p><code>userCanceledErr</code></p></td>
<td ><p>The user clicked the Cancel button in the standard parameters dialog box. Your application should call <code>QTDismissStandardParameterDialog</code> to close the dialog box.</p></td>
</tr>

</table></div>
<p>The <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTIsStandardParameterDialogEvent" target="_top">QTIsStandardParameterDialogEvent</a></code> function may also return error codes, such as memory errors.</p>
<p>Your application should only process the event returned from <code>WaitNextEvent</code> if <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTIsStandardParameterDialogEvent" target="_top">QTIsStandardParameterDialogEvent</a></code> returns an error or a <code>featureUnsupported</code> code.</p>
<p>The code in ListingÂ 2-1 is an example event loop showing how <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTIsStandardParameterDialogEvent" target="_top">QTIsStandardParameterDialogEvent</a></code> is used.</p>
<a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DontLinkElementID_138" title="Listing 2-1An example event loop showing use of QTIsStandardParameterDialogEvent"></a>
<p class="codesample"><strong>Listing 2-1&nbsp;&nbsp;</strong>An example event loop showing use of QTIsStandardParameterDialogEvent</p>
<div class="codesample"><table><tr><td scope="row"><pre>while (result == noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â EventRecordÂ Â Â Â Â theEvent;<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â WaitNextEvent(everyEvent, &amp;theEvent, 0, nil);<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â result = QTIsStandardParameterDialogEvent(&amp;theEvent,<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â createdDialogID);<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â switch (result)<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â {<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â case featureUnsupported:<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â {<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â result = noErr;<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â switch (theEvent.what)<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â {<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â case updateEvt:<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â BeginUpdate((WindowPtr) theEvent.message);<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â EndUpdate((WindowPtr) theEvent.message);<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â break;<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â }<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â break;<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â }<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â <span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â case codecParameterDialogConfirm:<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â case userCanceledErr:<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â QTDismissStandardParameterDialog(createdDialogID);<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â createdDialogID = nil;<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â break;<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â }<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â }<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div>


<a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DontLinkElementID_26" title="Adding Video Effects Controls to an Existing Dialog Box"></a>
<h2><a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-AddingVideoEffectsControlstoanExistingDialogBox" title="Adding Video Effects Controls to an Existing Dialog Box"></a>Adding Video Effects Controls to an Existing Dialog Box</h2>
<p>In most circumstances, it is best to use high-level functions to create a user interface for video effects. However, if you need finer control over the way the interface is presented, QuickTime provides a set of low-level API functions to assist you.</p>
<p>For example, you may want to incorporate the controls from the standard parameters dialog box into an existing dialog box that your application displays, rather than using a completely independent dialog box. This would be necessary if you wanted a single dialog box that allowed users to customize an effect and also specify its duration. To do this, you would create a dialog box with a control for the duration of the effect and then, at runtime, you would add the customization controls from the standard parameters dialog box by calling the <code><a href="../../../../Reference/QTRef_ImageCodec/Reference/reference.html#//apple_ref/c/func/ImageCodecCreateStandardParameterDialog" target="_top">ImageCodecCreateStandardParameterDialog</a></code> function.</p>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DontLinkElementID_139" title="Note"></a>
<p><strong>Note:</strong>&nbsp;
The low-level APIs follow the same naming convention as their high-level counterparts, except that the low-level versions begin with <code>ImageCodec</code>, whereas the high-level versions begin with <code>QT</code>.  </p>
</div>

<a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DontLinkElementID_27" title="Creating Your Application&#39;s Dialog Box"></a>
<h2><a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-CreatingYourApplicationsDialogBox" title="Creating Your Application&#39;s Dialog Box"></a>Creating Your Application's Dialog Box</h2>
<p>First create the dialog box that will incorporate the controls from the standard parameters dialog box. This dialog box must contain a user item that is large enough to hold the controls that will be added. For example, if you are using 12-point Chicago as your dialog box font, the user item should be 250 pixels wide and 300 pixels high. If you are using 9-point Geneva, the user item should be 150 pixels wide and 200 pixels high.</p>
<p>Figure 2-2 shows a dialog box in a running application after a custom effects control has been incorporated.</p>
<br/><div><img src = "../Art/custom_effect_control.jpg" alt = "A dialog box after incorporation of a custom effect control." ></div><br/>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DontLinkElementID_140" title="Note"></a>
<p><strong>Note:</strong>&nbsp;
You should make sure that the dialog box resource is marked as not initially visible. You then call a QuickTime function to add the effects controls from the standard parameter dialog box to the applicationâ€™s dialog box before showing it.  </p>
</div>

<a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DontLinkElementID_28" title="Incorporating Controls From the Standard Parameters Dialog Box"></a>
<h2><a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-IncorporatingControlsFromtheStandardParametersDialogBox" title="Incorporating Controls From the Standard Parameters Dialog Box"></a>Incorporating Controls From the Standard Parameters Dialog Box</h2>
<p>Once you have defined the resource for your dialog box, you are ready to add code to your application to create the dialog box and add the effects controls to it. First, call <code>GetNewDialog</code> in the usual way to create an instance of the dialog box. Then call <code><a href="../../../../Reference/QTRef_ImageCodec/Reference/reference.html#//apple_ref/c/func/ImageCodecCreateStandardParameterDialog" target="_top">ImageCodecCreateStandardParameterDialog</a></code> to incorporate the controls from the standard parameter dialog box into the dialog box. You then show the dialog box in the usual way.</p>
<p>The code in ListingÂ 2-2 shows these steps.</p>
<a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DontLinkElementID_141" title="Listing 2-2Creating a dialog box and adding effect controls"></a>
<p class="codesample"><strong>Listing 2-2&nbsp;&nbsp;</strong>Creating a dialog box and adding effect controls</p>
<div class="codesample"><table><tr><td scope="row"><pre>movableModalDialog = GetNewDialog(kExtraDialogID, nil, (WindowPtr) -1);<span></span></pre></td></tr><tr><td scope="row"><pre>if (movableModalDialog!=nil)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â // Add the user interface elements from the standard parameters<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â // dialog box to the modal dialog box just created<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â ImageCodecCreateStandardParameterDialog(gCompInstance,<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  parameterDescription,<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  gEffectSample,<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  pdOptionsModelDialogBox,<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  movableModalDialog,<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  kExtraUserItemID,<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  &amp;createdDialogID);<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â // Now show the dialog box and make it the default port<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â ShowWindow(movableModalDialog);<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â SelectWindow(movableModalDialog);<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â SetPort(movableModalDialog);<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div>

<p>The call to <code><a href="../../../../Reference/QTRef_ImageCodec/Reference/reference.html#//apple_ref/c/func/ImageCodecCreateStandardParameterDialog" target="_top">ImageCodecCreateStandardParameterDialog</a></code> shows how to pass the existing dialog box (<code>movableModalDialog</code> ) and the item number of the user item (<code>kExtraUserItemID</code> ) that will be replaced with the controls from the standard parameter dialog box.</p>
<p>Once the effect controls have been added, the dialog box is shown, selected, and made the default port.</p>
<p>The rest of the code needed to handle the dialog box is largely the same as dealing with a stand-alone parameters dialog box. You pass every non-null event returned from <code>WaitNextEvent</code> through <code><a href="../../../../Reference/QTRef_ImageCodec/Reference/reference.html#//apple_ref/c/func/ImageCodecIsStandardParameterDialogEvent" target="_top">ImageCodecIsStandardParameterDialogEvent</a></code>, and continue processing events yourself only if it returns <code>featureUnsupported</code>.</p>
<p>You track <code>MouseDown</code> events sent to the dialog box as usual. When the user clicks the OK button in the dialog box, you need to retrieve the values from the incorporated standard parameters dialog box. To do this, call the function <code><a href="../../../../Reference/QTRef_ImageCodec/Reference/reference.html#//apple_ref/c/func/ImageCodecStandardParameterDialogDoAction" target="_top">ImageCodecStandardParameterDialogDoAction</a></code> with the <code>pdActionConfirmDialog</code> action selector. This retrieves an effect description that describes the parameter values the user has chosen. You then call <code><a href="../../../../Reference/QTRef_ImageCodec/Reference/reference.html#//apple_ref/c/func/ImageCodecDismissStandardParameterDialog" target="_top">ImageCodecDismissStandardParameterDialog</a></code> to dispose of the incorporated elements. After this is done, you call <code>DisposeDialog</code> to correctly dispose of the applicationâ€™s dialog box.</p>

<a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-DontLinkElementID_29" title="Adding a Preview to Your Dialog Box"></a>
<h2><a name="//apple_ref/doc/uid/TP40000868-ConstructingaVideoEffectsUserInterface-AddingaPreviewtoYourDialogBox" title="Adding a Preview to Your Dialog Box"></a>Adding a Preview to Your Dialog Box</h2>
<p>You may have noticed that the incorporated control shown in Figure 2-2 does not include a preview, as the standard parameters dialog box does (FigureÂ 2-1).</p>
<p>In order for your dialog box to show a preview of the effect, include another user item in the applicationâ€™s dialog box to contain the preview movie clip. Then call the <code><a href="../../../../Reference/QTRef_ImageCodec/Reference/reference.html#//apple_ref/c/func/ImageCodecStandardParameterDialogDoAction" target="_top">ImageCodecStandardParameterDialogDoAction</a></code> function with the <code>pdActionSetPreviewUserItem</code> action selector, as shown in the following code snippet:</p>

<div class="codesample"><table><tr><td scope="row"><pre>myErr = ImageCodecStandardParameterDialogDoAction(gCompInstance,<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â gEffectsDialog,<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â pdActionSetPreviewUserItem,<span></span></pre></td></tr><tr><td scope="row"><pre>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â (void *) kPreviewUserItemID);<span></span></pre></td></tr></table></div>

<p>This makes the user item whose item number is <code>kPreviewUserItemID</code> (an application-defined constant in this example) the previewer for your dialog box.</p>
<p>You can use the <code><a href="../../../../Reference/QTRef_ImageCodec/Reference/reference.html#//apple_ref/c/func/ImageCodecStandardParameterDialogDoAction" target="_top">ImageCodecStandardParameterDialogDoAction</a></code> function to perform a number of similar customizations.</p>




        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../B-Chapter/2HowToAddQuickTimeVi.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../D-Chapter/4Built-inQuickTimeVi.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2005, 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-05-03<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/QuickTime/RM/EffectsTransitions/Effects/C-Chapter/3ConstructingaVideoE.html%3Fid%3DTP40000868-3.1&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/QuickTime/RM/EffectsTransitions/Effects/C-Chapter/3ConstructingaVideoE.html%3Fid%3DTP40000868-3.1&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/QuickTime/RM/EffectsTransitions/Effects/C-Chapter/3ConstructingaVideoE.html%3Fid%3DTP40000868-3.1&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>