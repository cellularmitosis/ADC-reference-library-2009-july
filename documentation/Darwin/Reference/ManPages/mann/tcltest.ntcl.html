<html><head><title>Mac OS X
 Manual Page For tcltest(ntcl)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/ntcl/tcltest" title="Mac OS X
 Manual Page for tcltest(ntcl)"><a name="//apple_ref/doc/man/n/tcltest" title="Mac OS X
 Manual Page for tcltest(ntcl)"><!-- headerDoc=man; indexgroup=Section ntcl; uid="//apple_ref/doc/man/ntcl/tcltest"; name=tcltest(ntcl) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
tcltest(n)                                  Tcl Bundled Packages                                  tcltest(n)



____________________________________________________________________________________________________________

<b>NAME</b>
       tcltest - Test harness support code and utilities

<b>SYNOPSIS</b>
       <b>package</b> <b>require</b> <b>tcltest</b> <b>?2.2.5?</b>

       <b>tcltest::test</b> <u>name</u> <u>description</u> <u>?option</u> <u>value</u> <u>...?</u>
       <b>tcltest::test</b> <u>name</u> <u>description</u> <u>?constraints?</u> <u>body</u> <u>result</u>

       <b>tcltest::loadTestedCommands</b>
       <b>tcltest::makeDirectory</b> <u>name</u> <u>?directory?</u>
       <b>tcltest::removeDirectory</b> <u>name</u> <u>?directory?</u>
       <b>tcltest::makeFile</b> <u>contents</u> <u>name</u> <u>?directory?</u>
       <b>tcltest::removeFile</b> <u>name</u> <u>?directory?</u>
       <b>tcltest::viewFile</b> <u>name</u> <u>?directory?</u>
       <b>tcltest::cleanupTests</b> <u>?runningMultipleTests?</u>
       <b>tcltest::runAllTests</b>

       <b>tcltest::configure</b>
       <b>tcltest::configure</b> <u>option</u>
       <b>tcltest::configure</b> <u>option</u> <u>value</u> <u>?option</u> <u>value</u> <u>...?</u>
       <b>tcltest::customMatch</b> <u>mode</u> <u>command</u>
       <b>tcltest::testConstraint</b> <u>constraint</u> <u>?value?</u>
       <b>tcltest::outputChannel</b> <u>?channelID?</u>
       <b>tcltest::errorChannel</b> <u>?channelID?</u>
       <b>tcltest::interpreter</b> <u>?interp?</u>

       <b>tcltest::debug</b> <u>?level?</u>
       <b>tcltest::errorFile</b> <u>?filename?</u>
       <b>tcltest::limitConstraints</b> <u>?boolean?</u>
       <b>tcltest::loadFile</b> <u>?filename?</u>
       <b>tcltest::loadScript</b> <u>?script?</u>
       <b>tcltest::match</b> <u>?patternList?</u>
       <b>tcltest::matchDirectories</b> <u>?patternList?</u>
       <b>tcltest::matchFiles</b> <u>?patternList?</u>
       <b>tcltest::outputFile</b> <u>?filename?</u>
       <b>tcltest::preserveCore</b> <u>?level?</u>
       <b>tcltest::singleProcess</b> <u>?boolean?</u>
       <b>tcltest::skip</b> <u>?patternList?</u>
       <b>tcltest::skipDirectories</b> <u>?patternList?</u>
       <b>tcltest::skipFiles</b> <u>?patternList?</u>
       <b>tcltest::temporaryDirectory</b> <u>?directory?</u>
       <b>tcltest::testsDirectory</b> <u>?directory?</u>
       <b>tcltest::verbose</b> <u>?level?</u>

       <b>tcltest::test</b> <u>name</u> <u>description</u> <u>optionList</u>
       <b>tcltest::bytestring</b> <u>string</u>
       <b>tcltest::normalizeMsg</b> <u>msg</u>
       <b>tcltest::normalizePath</b> <u>pathVar</u>
       <b>tcltest::workingDirectory</b> <u>?dir?</u>
____________________________________________________________________________________________________________

<b>DESCRIPTION</b>
       The  <b>tcltest</b>  package provides several utility commands useful in the construction of test suites for
       code instrumented to be run by evaluation of Tcl commands.  Notably the built-in commands of the  Tcl
       library itself are tested by a test suite using the tcltest package.

       All  the  commands  provided  by  the  <b>tcltest</b> package are defined in and exported from the <b>::tcltest</b>
       namespace, as indicated in the <b>SYNOPSIS</b> above.  In the  following  sections,  all  commands  will  be
       described by their simple names, in the interest of brevity.

       The  central command of <b>tcltest</b> is [<b>test</b>] that defines and runs a test.  Testing with [<b>test</b>] involves
       evaluation of a Tcl script and comparing the result to an expected result,  as  configured  and  con-<font color="#ffffff" class="whiteout">trolled&nbsp;controlled</font>
       trolled  by a number of options.  Several other commands provided by <b>tcltest</b> govern the configuration
       of [<b>test</b>] and the collection of many [<b>test</b>] commands into test suites.

       See <b>CREATING</b> <b>TEST</b> <b>SUITES</b> <b>WITH</b> <b>TCLTEST</b> below for an extended example of how to  use  the  commands  of
       <b>tcltest</b> to produce test suites for your Tcl-enabled code.

<b>COMMANDS</b>
       <b>test</b> <u>name</u> <u>description</u> <u>?option</u> <u>value</u> <u>...?</u>
              Defines and possibly runs a test with the name <u>name</u> and description <u>description</u>.  The name and
              description of a test are used in messages reported by [<b>test</b>] during the test,  as  configured
              by  the  options  of <b>tcltest</b>.  The remaining <u>option</u> <u>value</u> arguments to [<b>test</b>] define the test,
              including the scripts to run, the conditions under which to run them, the expected result, and
              the  means by which the expected and actual results should be compared.  See <b>TESTS</b> below for a
              complete description of the valid options and how they define  a  test.   The  [<b>test</b>]  command
              returns an empty string.

       <b>test</b> <u>name</u> <u>description</u> <u>?constraints?</u> <u>body</u> <u>result</u>
              This  form  of  [<b>test</b>] is provided to support test suites written for version 1 of the <b>tcltest</b>
              package, and also a simpler interface for a common usage.   It  is  the  same  as  [<b>test</b>  <u>name</u>
              <u>description</u>  <b>-constraints</b> <u>constraints</u> <b>-body</b> <u>body</u> <b>-result</b> <u>result</u>].  All other options to [<b>test</b>]
              take their default values.  When <u>constraints</u> is omitted, this form of [<b>test</b>]  can  be  distin-<font color="#ffffff" class="whiteout">guished&nbsp;distinguished</font>
              guished from the first because all <u>option</u>s begin with ``-''.

       <b>loadTestedCommands</b>
              Evaluates  in  the  caller's  context  the script specified by [<b>configure</b> <b>-load</b>] or [<b>configure</b>
              <b>-loadfile</b>].  Returns the result of that script evaluation, including any error raised  by  the
              script.   Use this command and the related configuration options to provide the commands to be
              tested to the interpreter running the test suite.

       <b>makeFile</b> <u>contents</u> <u>name</u> <u>?directory?</u>
              Creates a file named <u>name</u> relative to directory <u>directory</u> and  write  <u>contents</u>  to  that  file
              using the encoding [<b>encoding</b> <b>system</b>].  If <u>contents</u> does not end with a newline, a newline will
              be appended so that the file named <u>name</u> does end with a newline.  Because the system  encoding
              is used, this command is only suitable for making text files.  The file will be removed by the
              next evaluation of [<b>cleanupTests</b>], unless it is removed by [<b>removeFile</b>]  first.   The  default
              value  of  <u>directory</u>  is the directory [<b>configure</b> <b>-tmpdir</b>].  Returns the full path of the file
              created.  Use this command to create any text file required by a test with contents as needed.

       <b>removeFile</b> <u>name</u> <u>?directory?</u>
              Forces the file referenced by <u>name</u> to be removed.  This file name should be relative to <u>direc</u>-<font color="#ffffff" class="whiteout">tory.&nbsp;directory.</font>
              <u>tory</u>.   The default value of <u>directory</u> is the directory [<b>configure</b> <b>-tmpdir</b>].  Returns an empty
              string.  Use this command to delete files created by [<b>makeFile</b>].

       <b>makeDirectory</b> <u>name</u> <u>?directory?</u>
              Creates a directory named <u>name</u> relative to directory <u>directory</u>.  The directory will be removed
              by the next evaluation of [<b>cleanupTests</b>], unless it is  removed  by  [<b>removeDirectory</b>]  first.
              The default value of <u>directory</u> is the directory [<b>configure</b> <b>-tmpdir</b>].  Returns the full path of
              the directory created.  Use this command to create any directories that are required to  exist
              by a test.

       <b>removeDirectory</b> <u>name</u> <u>?directory?</u>
              Forces  the  directory  referenced by <u>name</u> to be removed. This directory should be relative to
              <u>directory</u>.  The default value of <u>directory</u> is the directory [<b>configure</b> <b>-tmpdir</b>].   Returns  an
              empty string.  Use this command to delete any directories created by [<b>makeDirectory</b>].

       <b>viewFile</b> <u>file</u> <u>?directory?</u>
              Returns  the  contents  of <u>file</u>, except for any final newline, just as [<b>read</b> <b>-nonewline</b>] would
              return.  This file name should be relative to <u>directory</u>.  The default value  of  <u>directory</u>  is
              the  directory [<b>configure</b> <b>-tmpdir</b>].  Use this command as a convenient way to turn the contents
              of a file generated by a test into the result of that test for matching  against  an  expected
              result.   The  contents  of  the file are read using the system encoding, so its usefulness is
              limited to text files.

       <b>cleanupTests</b>
              Intended to clean up and summarize after several tests have been run.  Typically  called  once
              per  test  file,  at the end of the file after all tests have been completed.  For best effec-<font color="#ffffff" class="whiteout">tiveness,&nbsp;effectiveness,</font>
              tiveness, be sure that the [<b>cleanupTests</b>] is evaluated even if an error occurs earlier in  the
              test file evaluation.

              Prints  statistics  about the tests run and removes files that were created by [<b>makeDirectory</b>]
              and [<b>makeFile</b>] since the last [<b>cleanupTests</b>].  Names of files and directories in the directory
              [<b>configure</b>  <b>-tmpdir</b>]  created  since the last [<b>cleanupTests</b>], but not created by [<b>makeFile</b>] or
              [<b>makeDirectory</b>] are printed to [<b>outputChannel</b>].  This command also restores the original shell
              environment, as described by the ::env array. Returns an empty string.

       <b>runAllTests</b>
              This is a master command meant to run an entire suite of tests, spanning multiple files and/or
              directories, as governed by the configurable options of <b>tcltest</b>.  See <b>RUNNING</b> <b>ALL</b> <b>TESTS</b>  below
              for a complete description of the many variations possible with [<b>runAllTests</b>].

<b>CONFIGURATION</b> <b>COMMANDS</b>
       <b>configure</b>
              Returns the list of configurable options supported by <b>tcltest</b>.  See <b>CONFIGURABLE</b> <b>OPTIONS</b> below
              for the full list of options, their valid values, and their effect on <b>tcltest</b> operations.

       <b>configure</b> <u>option</u>
              Returns the current value of the supported configurable option <u>option</u>.   Raises  an  error  if
              <u>option</u> is not a supported configurable option.

       <b>configure</b> <u>option</u> <u>value</u> <u>?option</u> <u>value</u> <u>...?</u>
              Sets  the value of each configurable option <u>option</u> to the corresponding value <u>value</u>, in order.
              Raises an error if an <u>option</u> is not a supported configurable option, or  if  <u>value</u>  is  not  a
              valid  value  for  the  corresponding <u>option</u>, or if a <u>value</u> is not provided.  When an error is
              raised, the operation of [<b>configure</b>] is halted, and subsequent <u>option</u> <u>value</u> arguments are  not
              processed.

              If  the  environment variable <b>::env(TCLTEST_OPTIONS)</b> exists when the <b>tcltest</b> package is loaded
              (by [<b>package</b> <b>require</b> <b>tcltest</b>]) then its value is taken as a list of arguments to pass to [<b>con</b>-<font color="#ffffff" class="whiteout">figure].&nbsp;[configure].</font>
              <b>figure</b>].   This  allows the default values of the configuration options to be set by the envi-<font color="#ffffff" class="whiteout">ronment.&nbsp;environment.</font>
              ronment.

       <b>customMatch</b> <u>mode</u> <u>script</u>
              Registers <u>mode</u> as a new legal value of the <b>-match</b> option to  [<b>test</b>].   When  the  <b>-match</b>  <u>mode</u>
              option  is  passed to [<b>test</b>], the script <u>script</u> will be evaluated to compare the actual result
              of evaluating the body of the test to the expected result.  To perform the match,  the  <u>script</u>
              is  completed  with  two additional words, the expected result, and the actual result, and the
              completed script is evaluated in the global namespace.  The completed script  is  expected  to
              return  a  boolean  value  indicating whether or not the results match.  The built-in matching
              modes of [<b>test</b>] are <b>exact</b>, <b>glob</b>, and <b>regexp</b>.

       <b>testConstraint</b> <u>constraint</u> <u>?boolean?</u>
              Sets or returns the boolean value associated with the named <u>constraint</u>.  See <b>TEST</b>  <b>CONSTRAINTS</b>
              below for more information.

       <b>interpreter</b> <u>?executableName?</u>
              Sets  or  returns  the name of the executable to be [<b>exec</b>]ed by [<b>runAllTests</b>] to run each test
              file when [<b>configure</b> <b>-singleproc</b>] is false.  The default value for [<b>interpreter</b>] is  the  name
              of the currently running program as returned by [<b>info</b> <b>nameofexecutable</b>].

       <b>outputChannel</b> <u>?channelID?</u>
              Sets  or  returns  the output channel ID.  This defaults to stdout.  Any test that prints test
              related output should send that output to [<b>outputChannel</b>]  rather  than  letting  that  output
              default to stdout.

       <b>errorChannel</b> <u>?channelID?</u>
              Sets  or  returns  the error channel ID.  This defaults to stderr.  Any test that prints error
              messages should send that output to [<b>errorChannel</b>] rather than printing directly to stderr.

<b>SHORTCUT</b> <b>COMMANDS</b>
       <b>debug</b> <u>?level?</u>
              Same as [<b>configure</b> <b>-debug</b> <u>?level?</u>].

       <b>errorFile</b> <u>?filename?</u>
              Same as [<b>configure</b> <b>-errfile</b> <u>?filename?</u>].

       <b>limitConstraints</b> <u>?boolean?</u>
              Same as [<b>configure</b> <b>-limitconstraints</b> <u>?boolean?</u>].

       <b>loadFile</b> <u>?filename?</u>
              Same as [<b>configure</b> <b>-loadfile</b> <u>?filename?</u>].

       <b>loadScript</b> <u>?script?</u>
              Same as [<b>configure</b> <b>-load</b> <u>?script?</u>].

       <b>match</b> <u>?patternList?</u>
              Same as [<b>configure</b> <b>-match</b> <u>?patternList?</u>].

       <b>matchDirectories</b> <u>?patternList?</u>
              Same as [<b>configure</b> <b>-relateddir</b> <u>?patternList?</u>].

       <b>matchFiles</b> <u>?patternList?</u>
              Same as [<b>configure</b> <b>-file</b> <u>?patternList?</u>].

       <b>outputFile</b> <u>?filename?</u>
              Same as [<b>configure</b> <b>-outfile</b> <u>?filename?</u>].

       <b>preserveCore</b> <u>?level?</u>
              Same as [<b>configure</b> <b>-preservecore</b> <u>?level?</u>].

       <b>singleProcess</b> <u>?boolean?</u>
              Same as [<b>configure</b> <b>-singleproc</b> <u>?boolean?</u>].

       <b>skip</b> <u>?patternList?</u>
              Same as [<b>configure</b> <b>-skip</b> <u>?patternList?</u>].

       <b>skipDirectories</b> <u>?patternList?</u>
              Same as [<b>configure</b> <b>-asidefromdir</b> <u>?patternList?</u>].

       <b>skipFiles</b> <u>?patternList?</u>
              Same as [<b>configure</b> <b>-notfile</b> <u>?patternList?</u>].

       <b>temporaryDirectory</b> <u>?directory?</u>
              Same as [<b>configure</b> <b>-tmpdir</b> <u>?directory?</u>].

       <b>testsDirectory</b> <u>?directory?</u>
              Same as [<b>configure</b> <b>-testdir</b> <u>?directory?</u>].

       <b>verbose</b> <u>?level?</u>
              Same as [<b>configure</b> <b>-verbose</b> <u>?level?</u>].

<b>OTHER</b> <b>COMMANDS</b>
       The remaining commands provided by <b>tcltest</b> have  better  alternatives  provided  by  <b>tcltest</b>  or  <b>Tcl</b>
       itself.  They are retained to support existing test suites, but should be avoided in new code.

       <b>test</b> <u>name</u> <u>description</u> <u>optionList</u>
              This  form  of  [<b>test</b>]  was  provided to enable passing many options spanning several lines to
              [<b>test</b>] as a single argument quoted by braces, rather than needing to backslash quote the  new-<font color="#ffffff" class="whiteout">lines&nbsp;newlines</font>
              lines  between  arguments to [<b>test</b>].  The <u>optionList</u> argument is expected to be a list with an
              even number of elements representing <u>option</u> and <u>value</u> arguments to pass to  [<b>test</b>].   However,
              these  values  are  not passed directly, as in the alternate forms of [<b>switch</b>].  Instead, this
              form makes an unfortunate attempt to overthrow Tcl's substitution rules by performing  substi-<font color="#ffffff" class="whiteout">tutions&nbsp;substitutions</font>
              tutions on some of the list elements as an attempt to implement a ``do what I mean'' interpre-<font color="#ffffff" class="whiteout">tation&nbsp;interpretation</font>
              tation of a brace-enclosed ``block''.  The result is nearly impossible  to  document  clearly,
              and  for  that  reason this form is not recommended.  See the examples in <b>CREATING</b> <b>TEST</b> <b>SUITES</b>
              <b>WITH</b> <b>TCLTEST</b> below to see that this form is really not  necessary  to  avoid  backslash-quoted
              newlines.  If you insist on using this form, examine the source code of <b>tcltest</b> if you want to
              know the substitution details, or just enclose the third through last argument  to  [<b>test</b>]  in
              braces and hope for the best.

       <b>workingDirectory</b> <u>?directoryName?</u>
              Sets  or  returns  the  current working directory when the test suite is running.  The default
              value for workingDirectory is the directory in which the test suite  was  launched.   The  Tcl
              commands [<b>cd</b>] and [<b>pwd</b>] are sufficient replacements.

       <b>normalizeMsg</b> <u>msg</u>
              Returns  the  result  of  removing  the ``extra'' newlines from <u>msg</u>, where ``extra'' is rather
              imprecise.  Tcl offers plenty of string processing commands to modify strings as you wish, and
              [<b>customMatch</b>] allows flexible matching of actual and expected results.

       <b>normalizePath</b> <u>pathVar</u>
              Resolves symlinks in a path, thus creating a path without internal redirection.  It is assumed
              that <u>pathVar</u> is absolute.  <u>pathVar</u> is modified in place.  The Tcl command [<b>file</b> <b>normalize</b>]  is
              a sufficient replacement.

       <b>bytestring</b> <u>string</u>
              Construct a string that consists of the requested sequence of bytes, as opposed to a string of
              properly formed UTF-8 characters using the value supplied in <u>string</u>.  This allows  the  tester
              to  create denormalized or improperly formed strings to pass to C procedures that are supposed
              to accept strings with embedded NULL types and confirm that a string result has a certain pat-<font color="#ffffff" class="whiteout">tern&nbsp;pattern</font>
              tern of bytes.  This is exactly equivalent to the Tcl command [<b>encoding</b> <b>convertfrom</b> <b>identity</b>].

<b>TESTS</b>
       The [<b>test</b>] command is the heart of the <b>tcltest</b> package.  Its essential function is to evaluate a  Tcl
       script and compare the result with an expected result.  The options of [<b>test</b>] define the test script,
       the environment in which to evaluate it, the expected result, and how the compare the  actual  result
       to the expected result.  Some configuration options of <b>tcltest</b> also influence how [<b>test</b>] operates.

       The valid options for [<b>test</b>] are summarized:
              test <u>name</u> <u>description</u>
                      ?-constraints <u>keywordList|expression</u>?
                      ?-setup <u>setupScript</u>?
                      ?-body <u>testScript</u>?
                      ?-cleanup <u>cleanupScript</u>?
                      ?-result <u>expectedAnswer</u>?
                      ?-output <u>expectedOutput</u>?
                      ?-errorOutput <u>expectedError</u>?
                      ?-returnCodes <u>codeList</u>?
                      ?-match <u>mode</u>?
       The <u>name</u> may be any string.  It is conventional to choose a <u>name</u> according to the pattern:
              <u>target</u>-<u>majorNum</u>.<u>minorNum</u>
       For  white-box  (regression)  tests, the target should be the name of the C function or Tcl procedure
       being tested.  For black-box tests, the target should be the name of the feature being tested.   Some
       conventions call for the names of black-box tests to have the suffix <b>_bb</b>.  Related tests should share
       a major number.  As a test suite evolves, it is best to have the same test name  continue  to  corre-<font color="#ffffff" class="whiteout">spond&nbsp;correspond</font>
       spond to the same test, so that it remains meaningful to say things like ``Test foo-1.3 passed in all
       releases up to 3.4, but began failing in release 3.5.''

       During evaluation of [<b>test</b>], the <u>name</u> will be compared to  the  lists  of  string  matching  patterns
       returned by [<b>configure</b> <b>-match</b>], and [<b>configure</b> <b>-skip</b>].  The test will be run only if <u>name</u> matches any
       of the patterns from [<b>configure</b> <b>-match</b>] and matches none of the patterns from [<b>configure</b> <b>-skip</b>].

       The <u>description</u> should be a short textual description of the test.  The <u>description</u>  is  included  in
       output produced by the test, typically test failure messages.  Good <u>description</u> values should briefly
       explain the purpose of the test to users of a test suite.  The name of a  Tcl  or  C  function  being
       tested should be included in the description for regression tests.  If the test case exists to repro-<font color="#ffffff" class="whiteout">duce&nbsp;reproduce</font>
       duce a bug, include the bug ID in the description.

       Valid attributes and associated values are:

       <b>-constraints</b> <u>keywordList|expression</u>
              The optional <b>-constraints</b> attribute can be list of one or more keywords or an expression.   If
              the  <b>-constraints</b>  value is a list of keywords, each of these keywords should be the name of a
              constraint defined by a call to [<b>testConstraint</b>].  If any of the listed constraints  is  false
              or  does  not  exist,  the  test is skipped.  If the <b>-constraints</b> value is an expression, that
              expression is evaluated. If the expression evaluates to true, then the test is run.  Note that
              the  expression  form  of  <b>-constraints</b>  may  interfere with the operation of [<b>configure</b> <b>-con</b>-<font color="#ffffff" class="whiteout">straints]&nbsp;-constraints]</font>
              <b>straints</b>] and [<b>configure</b> <b>-limitconstraints</b>], and is not recommended.  Appropriate  constraints
              should  be  added to any tests that should not always be run.  That is, conditional evaluation
              of a test should be accomplished by the <b>-constraints</b> option, not by conditional evaluation  of
              [<b>test</b>].   In  that way, the same number of tests are always reported by the test suite, though
              the number skipped may change based on the testing environment.  The default value is an empty
              list.  See <b>TEST</b> <b>CONSTRAINTS</b> below for a list of built-in constraints and information on how to
              add your own constraints.

       <b>-setup</b> <u>script</u>
              The optional <b>-setup</b> attribute indicates a <u>script</u> that will be run before the script  indicated
              by  the  <b>-body</b>  attribute.   If evaluation of <u>script</u> raises an error, the test will fail.  The
              default value is an empty script.

       <b>-body</b> <u>script</u>
              The <b>-body</b> attribute indicates the <u>script</u> to run to carry out  the  test.   It  must  return  a
              result that can be checked for correctness.  If evaluation of <u>script</u> raises an error, the test
              will fail.  The default value is an empty script.

       <b>-cleanup</b> <u>script</u>
              The optional <b>-cleanup</b> attribute indicates a <u>script</u> that will be run after the script indicated
              by  the  <b>-body</b>  attribute.   If evaluation of <u>script</u> raises an error, the test will fail.  The
              default value is an empty script.

       <b>-match</b> <u>mode</u>
              The <b>-match</b> attribute determines how expected answers supplied by <b>-result</b>, <b>-output</b>, and  <b>-erro</b>-<font color="#ffffff" class="whiteout">rOutput&nbsp;-errorOutput</font>
              <b>rOutput</b> are compared.  Valid values for <u>mode</u> are <b>regexp</b>, <b>glob</b>, <b>exact</b>, and any value registered
              by a prior call to [<b>customMatch</b>].  The default value is <b>exact</b>.

       <b>-result</b> <u>expectedValue</u>
              The <b>-result</b> attribute supplies the <u>expectedValue</u> against which the return  value  from  script
              will be compared. The default value is an empty string.

       <b>-output</b> <u>expectedValue</u>
              The  <b>-output</b>  attribute  supplies the <u>expectedValue</u> against which any output sent to <b>stdout</b> or
              [<b>outputChannel</b>] during evaluation of the <!-- a -->script(s)<!-- /a --> will be compared.  Note  that  only  output
              printed  using  [<b>::puts</b>]  is used for comparison.  If <b>-output</b> is not specified, output sent to
              <b>stdout</b> and [<b>outputChannel</b>] is not processed for comparison.

       <b>-errorOutput</b> <u>expectedValue</u>
              The <b>-errorOutput</b> attribute supplies the <u>expectedValue</u> against which any output sent to  <b>stderr</b>
              or  [<b>errorChannel</b>]  during evaluation of the <!-- a -->script(s)<!-- /a --> will be compared. Note that only output
              printed using [<b>::puts</b>] is used for comparison.  If <b>-errorOutput</b> is not specified, output  sent
              to <b>stderr</b> and [<b>errorChannel</b>] is not processed for comparison.

       <b>-returnCodes</b> <u>expectedCodeList</u>
              The optional <b>-returnCodes</b> attribute supplies <u>expectedCodeList</u>, a list of return codes that may
              be accepted from evaluation of the <b>-body</b> script.  If evaluation of the <b>-body</b> script returns  a
              code not in the <u>expectedCodeList</u>, the test fails.  All return codes known to [<b>return</b>], in both
              numeric and symbolic form, including extended return codes, are  acceptable  elements  in  the
              <u>expectedCodeList</u>.  Default value is <b>{ok</b> <b>return}</b>.

       To  pass, a test must successfully evaluate its <b>-setup</b>, <b>-body</b>, and <b>-cleanup</b> scripts.  The return code
       of the <b>-body</b> script and its result must match expected values, and if  specified,  output  and  error
       data  from  the test must match expected <b>-output</b> and <b>-errorOutput</b> values.  If any of these conditions
       are not met, then the test fails.  Note that all scripts are evaluated in the context of  the  caller
       of [<b>test</b>].

       As  long as [<b>test</b>] is called with valid syntax and legal values for all attributes, it will not raise
       an error.  Test failures are instead reported as output written to [<b>outputChannel</b>].  In default oper-<font color="#ffffff" class="whiteout">ation,&nbsp;operation,</font>
       ation,  a  successful test produces no output.  The output messages produced by [<b>test</b>] are controlled
       by the [<b>configure</b> <b>-verbose</b>] option as described in <b>CONFIGURABLE</b> <b>OPTIONS</b> below.  Any  output  produced
       by  the  test  scripts themselves should be produced using [<b>::puts</b>] to [<b>outputChannel</b>] or [<b>errorChan</b>-<font color="#ffffff" class="whiteout">nel],&nbsp;[errorChannel],</font>
       <b>nel</b>], so that users of the test suite may easily capture output with  the  [<b>configure</b>  <b>-outfile</b>]  and
       [<b>configure</b> <b>-errfile</b>] options, and so that the <b>-output</b> and <b>-errorOutput</b> attributes work properly.

<b>TEST</b> <b>CONSTRAINTS</b>
       Constraints  are  used  to  determine whether or not a test should be skipped.  Each constraint has a
       name, which may be any string, and a boolean value.  Each [<b>test</b>] has a <b>-constraints</b> value which is  a
       list  of  constraint names.  There are two modes of constraint control.  Most frequently, the default
       mode is used, indicated by a setting of [<b>configure</b> <b>-limitconstraints</b>] to false.  The  test  will  run
       only  if  all  constraints in the list are true-valued.  Thus, the <b>-constraints</b> option of [<b>test</b>] is a
       convenient, symbolic way to define any conditions required for the test to be possible or meaningful.
       For  example,  a [<b>test</b>] with <b>-constraints</b> <b>unix</b> will only be run if the constraint <b>unix</b> is true, which
       indicates the test suite is being run on a Unix platform.

       Each [<b>test</b>] should include whatever <b>-constraints</b> are required to  constrain  it  to  run  only  where
       appropriate.   Several  constraints are pre-defined in the <b>tcltest</b> package, listed below.  The regis-<font color="#ffffff" class="whiteout">tration&nbsp;registration</font>
       tration of user-defined constraints is performed by the [<b>testConstraint</b>] command.  User-defined  con-<font color="#ffffff" class="whiteout">straints&nbsp;constraints</font>
       straints  may  appear  within a test file, or within the script specified by the [<b>configure</b> <b>-load</b>] or
       [<b>configure</b> <b>-loadfile</b>] options.

       The following is a list of constraints pre-defined by the <b>tcltest</b> package itself:

       <u>singleTestInterp</u>
              test can only be run if all test files are sourced into a single interpreter

       <u>unix</u>   test can only be run on any Unix platform

       <u>win</u>    test can only be run on any Windows platform

       <u>nt</u>     test can only be run on any Windows NT platform

       <u>95</u>     test can only be run on any Windows 95 platform

       <u>98</u>     test can only be run on any Windows 98 platform

       <u>mac</u>    test can only be run on any Mac platform

       <u>unixOrWin</u>
              test can only be run on a Unix or Windows platform

       <u>macOrWin</u>
              test can only be run on a Mac or Windows platform

       <u>macOrUnix</u>
              test can only be run on a Mac or Unix platform

       <u>tempNotWin</u>
              test can not be run on Windows.  This flag is used to temporarily disable a test.

       <u>tempNotMac</u>
              test can not be run on a Mac.  This flag is used to temporarily disable a test.

       <u>unixCrash</u>
              test crashes if it's run on Unix.  This flag is used to temporarily disable a test.

       <u>winCrash</u>
              test crashes if it's run on Windows.  This flag is used to temporarily disable a test.

       <u>macCrash</u>
              test crashes if it's run on a Mac.  This flag is used to temporarily disable a test.

       <u>emptyTest</u>
              test is empty, and so not worth running, but it remains as a place-holder for  a  test  to  be
              written  in  the  future.  This constraint has value false to cause tests to be skipped unless
              the user specifies otherwise.

       <u>knownBug</u>
              test is known to fail and the bug is not yet fixed.  This constraint has value false to  cause
              tests to be skipped unless the user specifies otherwise.

       <u>nonPortable</u>
              test  can  only  be run in some known development environment.  Some tests are inherently non-<font color="#ffffff" class="whiteout">portable&nbsp;nonportable</font>
              portable because they depend on things like word length,  file  system  configuration,  window
              manager,  etc.   This  constraint has value false to cause tests to be skipped unless the user
              specifies otherwise.

       <u>userInteraction</u>
              test requires interaction from the user.  This constraint has value false to causes  tests  to
              be skipped unless the user specifies otherwise.

       <u>interactive</u>
              test  can only be run in if the interpreter is in interactive mode (when the global tcl_inter-<font color="#ffffff" class="whiteout">active&nbsp;tcl_interactive</font>
              active variable is set to 1).

       <u>nonBlockFiles</u>
              test can only be run if platform supports setting files into nonblocking mode

       <u>asyncPipeClose</u>
              test can only be run if platform supports async flush and async close on a pipe

       <u>unixExecs</u>
              test can only be run if this machine has Unix-style commands <b>cat</b>, <b>echo</b>,  <b>sh</b>,  <b>wc</b>,  <b>rm</b>,  <b>sleep</b>,
              <b>fgrep</b>, <b>ps</b>, <b>chmod</b>, and <b>mkdir</b> available

       <u>hasIsoLocale</u>
              test can only be run if can switch to an ISO locale

       <u>root</u>   test can only run if Unix user is root

       <u>notRoot</u>
              test can only run if Unix user is not root

       <u>eformat</u>
              test  can  only  run if app has a working version of sprintf with respect to the "e" format of
              floating-point numbers.

       <u>stdio</u>  test can only be run if [<b>interpreter</b>] can be [<b>open</b>]ed as a pipe.

       The alternative mode of constraint control is enabled by  setting  [<b>configure</b>  <b>-limitconstraints</b>]  to
       true.   With  that configuration setting, all existing constraints other than those in the constraint
       list returned by [<b>configure</b> <b>-constraints</b>] are set to false.   When  the  value  of  [<b>configure</b>  <b>-con</b>-<font color="#ffffff" class="whiteout">straints]&nbsp;-constraints]</font>
       <b>straints</b>]  is set, all those constraints are set to true.  The effect is that when both options [<b>con</b>-<font color="#ffffff" class="whiteout">figure&nbsp;[configure</font>
       <b>figure</b> <b>-constraints</b>] and [<b>configure</b> <b>-limitconstraints</b>] are in use, only those  tests  including  only
       constraints from the [<b>configure</b> <b>-constraints</b>] list are run; all others are skipped.  For example, one
       might set up a configuration with
              configure -constraints knownBug \
                        -limitconstraints true \
                        -verbose pass
       to run exactly those tests that exercise known bugs, and discover whether any of them pass,  indicat-<font color="#ffffff" class="whiteout">ing&nbsp;indicating</font>
       ing the bug had been fixed.

<b>RUNNING</b> <b>ALL</b> <b>TESTS</b>
       The  single  command  [<b>runAllTests</b>] is evaluated to run an entire test suite, spanning many files and
       directories.  The configuration options of <b>tcltest</b> control the precise operations.  The [<b>runAllTests</b>]
       command begins by printing a summary of its configuration to [<b>outputChannel</b>].

       Test  files  to  be evaluated are sought in the directory [<b>configure</b> <b>-testdir</b>].  The list of files in
       that directory that match any of the patterns in [<b>configure</b> <b>-file</b>] and match none of the patterns  in
       [<b>configure</b> <b>-notfile</b>] is generated and sorted.  Then each file will be evaluated in turn.  If [<b>config</b>-<font color="#ffffff" class="whiteout">ure&nbsp;[configure</font>
       <b>ure</b> <b>-singleproc</b>] is true, then each file will be [<b>source</b>]d in the caller's context.  If if is  false,
       then  a  copy of [<b>interpreter</b>] will be [<b>exec</b>]d to evaluate each file.  The multi-process operation is
       useful when testing can cause errors so severe that a process terminates.  Although such an error may
       terminate  a  child process evaluating one file, the master process can continue with the rest of the
       test suite.  In multi-process operation, the configuration of <b>tcltest</b> in the master process is passed
       to  the  child  processes as command line arguments, with the exception of [<b>configure</b> <b>-outfile</b>].  The
       [<b>runAllTests</b>] command in the master process collects all output from the child processes and collates
       their results into one master report.  Any reports of individual test failures, or messages requested
       by a [<b>configure</b> <b>-verbose</b>] setting are passed directly on to [<b>outputChannel</b>] by the master process.

       After evaluating all selected test files, a summary of the results  is  printed  to  [<b>outputChannel</b>].
       The  summary  includes  the  total number of [<b>test</b>]s evaluated, broken down into those skipped, those
       passed, and those failed.  The summary also notes the number of files evaluated, and the names of any
       files  with  failing tests or errors.  A list of the constraints that caused tests to be skipped, and
       the number of tests skipped for each is also printed.  Also, messages are printed if it appears  that
       evaluation of a test file has caused any temporary files to be left behind in [<b>configure</b> <b>-tmpdir</b>].

       Having  completed and summarized all selected test files, [<b>runAllTests</b>] then recursively acts on sub-<font color="#ffffff" class="whiteout">directories&nbsp;subdirectories</font>
       directories of [<b>configure</b> <b>-testdir</b>].  All subdirectories that match any of the patterns in [<b>configure</b>
       <b>-relateddir</b>]  and  do  not match any of the patterns in [<b>configure</b> <b>-asidefromdir</b>] are examined.  If a
       file named <b>all.tcl</b> is found in such a directory, it  will  be  [<b>source</b>]d  in  the  caller's  context.
       Whether  or  not  an examined directory contains an <b>all.tcl</b> file, its subdirectories are also scanned
       against the [<b>configure</b> <b>-relateddir</b>] and [<b>configure</b> <b>-asidefromdir</b>] patterns.  In this way, many direc-<font color="#ffffff" class="whiteout">tories&nbsp;directories</font>
       tories in a directory tree can have all their test files evaluated by a single [<b>runAllTests</b>] command.

<b>CONFIGURABLE</b> <b>OPTIONS</b>
       The [<b>configure</b>] command is used to set and query the configurable  options  of  <b>tcltest</b>.   The  valid
       options are:

       <b>-singleproc</b> <u>boolean</u>
              Controls  whether or not [<b>runAllTests</b>] spawns a child process for each test file.  No spawning
              when <u>boolean</u> is true.  Default value is false.

       <b>-debug</b> <u>level</u>
              Sets the debug level to <u>level</u>, an integer value  indicating  how  much  debugging  information
              should be printed to stdout.  Note that debug messages always go to stdout, independent of the
              value of [<b>configure</b> <b>-outfile</b>].  Default value is 0.  Levels are defined as:

              0      Do not display any debug information.

              1      Display information regarding whether a test is skipped because it doesn't match any of
                     the  tests  that  were specified using by [<b>configure</b> <b>-match</b>] (userSpecifiedNonMatch) or
                     matches any of the tests specified  by  [<b>configure</b>  <b>-skip</b>]  (userSpecifiedSkip).   Also
                     print  warnings  about  possible  lack of cleanup or balance in test files.  Also print
                     warnings about any re-use of test names.

              2      Display the flag array parsed by the command line processor, the contents of the  ::env
                     array,  and  all user-defined variables that exist in the current namespace as they are
                     used.

              3      Display information regarding what individual procs in the test harness are doing.

       <b>-verbose</b> <u>level</u>
              Sets the type of output verbosity desired to <u>level</u>, a list of zero or  more  of  the  elements
              <b>body</b>, <b>pass</b>, <b>skip</b>, <b>start</b>, and <b>error</b>.  Default value is <b>{body</b> <b>error}</b>.  Levels are defined as:

              body (b)
                     Display the body of failed tests

              pass (p)
                     Print output when a test passes

              skip (s)
                     Print output when a test is skipped

              start (t)
                     Print output whenever a test starts

              error (e)
                     Print  errorInfo  and  errorCode, if they exist, when a test return code does not match
                     its expected return code
       The single letter abbreviations noted above are also recognized so that [<b>configure</b>  <b>-verbose</b>  <b>pt</b>]  is
       the same as [<b>configure</b> <b>-verbose</b>  <b>{pass</b> <b>start}</b>].

       <b>-preservecore</b> <u>level</u>
              Sets  the  core  preservation  level to <u>level</u>.  This level determines how stringent checks for
              core files are.  Default value is 0.  Levels are defined as:

              0      No checking - do not check for core files at the end of each test command, but do check
                     for them in [<b>runAllTests</b>] after all test files have been evaluated.

              1      Also check for core files at the end of each [<b>test</b>] command.

              2      Check  for  core  files at all times described above, and save a copy of each core file
                     produced in [<b>configure</b> <b>-tmpdir</b>].

       <b>-limitconstraints</b> <u>boolean</u>
              Sets the mode by which [<b>test</b>] honors constraints as described in <b>TESTS</b> above.   Default  value
              is false.

       <b>-constraints</b> <u>list</u>
              Sets all the constraints in <u>list</u> to true.  Also used in combination with [<b>configure</b> <b>-limitcon</b>-<font color="#ffffff" class="whiteout">straints&nbsp;-limitconstraints</font>
              <b>straints</b> <b>true</b>] to control an alternative constraint mode as described in <b>TESTS</b> above.  Default
              value is an empty list.

       <b>-tmpdir</b> <u>directory</u>
              Sets  the  temporary directory to be used by [<b>makeFile</b>], [<b>makeDirectory</b>], [<b>viewFile</b>], [<b>remove</b>-<font color="#ffffff" class="whiteout">File],&nbsp;[removeFile],</font>
              <b>File</b>], and [<b>removeDirectory</b>] as the default directory where temporary  files  and  directories
              created by test files should be created.  Default value is [<b>workingDirectory</b>].

       <b>-testdir</b> <u>directory</u>
              Sets the directory searched by [<b>runAllTests</b>] for test files and subdirectories.  Default value
              is [<b>workingDirectory</b>].

       <b>-file</b> <u>patternList</u>
              Sets the list of patterns used by [<b>runAllTests</b>] to determine  what  test  files  to  evaluate.
              Default value is <b>*.test</b>.

       <b>-notfile</b> <u>patternList</u>
              Sets the list of patterns used by [<b>runAllTests</b>] to determine what test files to skip.  Default
              value is <b>l.*.test</b>, so that any SCCS lock files are skipped.

       <b>-relateddir</b> <u>patternList</u>
              Sets the list of patterns used by [<b>runAllTests</b>] to determine what subdirectories to search for
              an <b>all.tcl</b> file.  Default value is <b>*</b>.

       <b>-asidefromdir</b> <u>patternList</u>
              Sets  the list of patterns used by [<b>runAllTests</b>] to determine what subdirectories to skip when
              searching for an <b>all.tcl</b> file.  Default value is an empty list.

       <b>-match</b> <u>patternList</u>
              Set the list of patterns used by [<b>test</b>] to determine whether a test should  be  run.   Default
              value is <b>*</b>.

       <b>-skip</b> <u>patternList</u>
              Set  the  list  of  patterns  used  by  [<b>test</b>]  to determine whether a test should be skipped.
              Default value is an empty list.

       <b>-load</b> <u>script</u>
              Sets a script to be evaluated by [<b>loadTestedCommands</b>].  Default value is an empty script.

       <b>-loadfile</b> <u>filename</u>
              Sets the filename from which to read a script to be evaluated by  [<b>loadTestedCommands</b>].   This
              is an alternative to <b>-load</b>.  They cannot be used together.

       <b>-outfile</b> <u>filename</u>
              Sets  the  file to which all output produced by tcltest should be written.  A file named <u>file</u>-<font color="#ffffff" class="whiteout">name&nbsp;filename</font>
              <u>name</u> will be [<b>open</b>]ed for writing, and the resulting channel will be set as the value of [<b>out</b>-<font color="#ffffff" class="whiteout">putChannel].&nbsp;[outputChannel].</font>
              <b>putChannel</b>].

       <b>-errfile</b> <u>filename</u>
              Sets  the  file to which all error output produced by tcltest should be written.  A file named
              <u>filename</u> will be [<b>open</b>]ed for writing, and the resulting channel will be set as the  value  of
              [<b>errorChannel</b>].

<b>CREATING</b> <b>TEST</b> <b>SUITES</b> <b>WITH</b> <b>TCLTEST</b>
       The  fundamental  element  of  a  test suite is the individual [<b>test</b>] command.  We begin with several
       examples.

       [1]    Test of a script that returns normally.
              test example-1.0 {normal return} {
                  format %s value
              } value

       [2]    Test of a script that requires context setup and cleanup.   Note  the  bracing  and  indenting
              style that avoids any need for line continuation.
              test example-1.1 {test file existence} -setup {
                  set file [makeFile {} test]
              } -body {
                  file exists $file
              } -cleanup {
                  removeFile test
              } -result 1

       [3]    Test of a script that raises an error.
              test example-1.2 {error return} -body {
                  error message
              } -returnCodes error -result message

       [4]    Test with a constraint.
              test example-1.3 {user owns created files} -constraints {
                  unix
              } -setup {
                  set file [makeFile {} test]
              } -body {
                  file attributes $file -owner
              } -cleanup {
                  removeFile test
              } -result $::tcl_platform(user)

       At the next higher layer of organization, several [<b>test</b>] commands are gathered together into a single
       test file.  Test files should have names with the <b>.test</b> extension, because that is the  default  pat-<font color="#ffffff" class="whiteout">tern&nbsp;pattern</font>
       tern  used by [<b>runAllTests</b>] to find test files.  It is a good rule of thumb to have one test file for
       each source code file of your project.  It is good practice to edit the test file and the source code
       file together, keeping tests synchronized with code changes.

       Most  of  the  code  in  the test file should be the [<b>test</b>] commands.  Use constraints to skip tests,
       rather than conditional evaluation of [<b>test</b>].  That is, do this:

       [5]
              testConstraint X [expr $myRequirement]
              test goodConditionalTest {} X {
                  # body
              } result
       and do not do this:

       [6]
              if $myRequirement {
                  test badConditionalTest {} {
                #body
                  } result
              }

       Use the <b>-setup</b> and <b>-cleanup</b> options to establish and release all context  requirements  of  the  test
       body.   Do not make tests depend on prior tests in the file.  Those prior tests might be skipped.  If
       several consecutive tests require the same context, the appropriate setup and cleanup scripts may  be
       stored  in variable for passing to each tests <b>-setup</b> and <b>-cleanup</b> options.  This is a better solution
       than performing setup outside of [<b>test</b>] commands, because the setup will only be done  if  necessary,
       and any errors during setup will be reported, and not cause the test file to abort.

       A  test  file  should  be able to be combined with other test files and not interfere with them, even
       when [<b>configure</b> <b>-singleproc</b> <b>1</b>] causes all files to be evaluated in a common  interpreter.   A  simple
       way to achieve this is to have your tests define all their commands and variables in a namespace that
       is deleted when the test file evaluation is complete.  A good namespace to use is a  child  namespace
       <b>test</b> of the namespace of the module you are testing.

       A  test  file should also be able to be evaluated directly as a script, not depending on being called
       by a master [<b>runAllTests</b>].  This means that each test file should process command line  arguments  to
       give the tester all the configuration control that <b>tcltest</b> provides.

       After all [<b>test</b>]s in a test file, the command [<b>cleanupTests</b>] should be called.

       [7]    Here is a sketch of a sample test file illustrating those points:
              package require tcltest 2.2
              eval tcltest::configure $argv
              package require example
              namespace eval ::example::test {
                  namespace import ::tcltest::*
                  testConstraint X [expr {...}]
                  variable SETUP {#common setup code}
                  variable CLEANUP {#common cleanup code}
                  test example-1 {} -setup $SETUP -body {
                # First test
                  } -cleanup $CLEANUP -result {...}
                  test example-2 {} -constraints X -setup $SETUP -body {
                # Second test; constrained
                  } -cleanup $CLEANUP -result {...}
                  test example-3 {} {
                # Third test; no context required
                  } {...}
                  cleanupTests
              }
              namespace delete ::example::test

       The  next  level  of organization is a full test suite, made up of several test files.  One script is
       used to control the entire suite.  The basic function of this script is to call  [<b>runAllTests</b>]  after
       doing any necessary setup.  This script is usually named <b>all.tcl</b> because that's the default name used
       by [<b>runAllTests</b>] when combining multiple test suites into one testing run.

       [8]    Here is a sketch of a sample test suite master script:
              package require Tcl 8.4
              package require tcltest 2.2
              package require example
              tcltest::configure -testdir         [file dirname [file normalize [info script]]]
              eval tcltest::configure $argv
              tcltest::runAllTests

<b>COMPATIBILITY</b>
       A number of commands and variables in the <b>::tcltest</b> namespace provided by earlier releases of <b>tcltest</b>
       have  not been documented here.  They are no longer part of the supported public interface of <b>tcltest</b>
       and should not be used in new test suites.  However, to continue  to  support  existing  test  suites
       written  to the older interface specifications, many of those deprecated commands and variables still
       work as before.  For example, in many circumstances, [<b>configure</b>] will be automatically called shortly
       after  [<b>package</b>  <b>require</b>  <b>tcltest</b>  <b>2.1</b>] succeeds with arguments from the variable <b>::argv</b>.  This is to
       support test suites that depend on the old behavior that <b>tcltest</b> was  automatically  configured  from
       command line arguments.  New test files should not depend on this, but should explicitly include
              eval tcltest::configure $::argv
       to establish a configuration from command line arguments.

<b>KNOWN</b> <b>ISSUES</b>
       There  are  two known issues related to nested evaluations of [<b>test</b>].  The first issue relates to the
       stack level in which test scripts are executed.  Tests nested within other tests may be  executed  at
       the same stack level as the outermost test.  For example, in the following code:
              test level-1.1 {level 1} {
                  -body {
                      test level-2.1 {level 2} {
                      }
                  }
              }
       any  script  executed  in level-2.1 may be executed at the same stack level as the script defined for
       level-1.1.

       In addition, while two [<b>test</b>]s have been run, results will only be  reported  by  [<b>cleanupTests</b>]  for
       tests  at  the  same  level  as  test  level-1.1.   However,  test results for all tests run prior to
       level-1.1 will be available when test level-2.1 runs.  What this means is that if you try  to  access
       the  test  results  for  test level-2.1, it will may say that 'm' tests have run, 'n' tests have been
       skipped, 'o' tests have passed and 'p' tests have failed, where 'm', 'n', 'o', and 'p' refer to tests
       that were run at the same test level as test level-1.1.

       Implementation  of output and error comparison in the test command depends on usage of ::puts in your
       application code.  Output is intercepted by redefining the ::puts  command  while  the  defined  test
       script  is being run.  Errors thrown by C procedures or printed directly from C applications will not
       be caught by the test command.  Therefore, usage of the <b>-output</b> and <b>-errorOuput</b> options to [<b>test</b>]  is
       useful only for pure Tcl applications that use [<b>::puts</b>] to produce output.


<b>KEYWORDS</b>
       test, test harness, test suite



tcltest                                              2.2                                          tcltest(n)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/mann/tcltest.ntcl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/mann/tcltest.ntcl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/mann/tcltest.ntcl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
