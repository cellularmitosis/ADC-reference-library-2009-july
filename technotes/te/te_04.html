<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note TE04: Font Names</title>                                       <meta name="categories" content="Text"><meta name="week-posted" content="Mar 28, 1988 - Apr 1, 1988"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002812" title="Font Names"></a><a name="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxMacOS9Earlier-date.html">Mac OS 9 & Earlier</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/index.html" target="_blank">Reference Library</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TE04</div>
<div id="pageheadsub">Font Names</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext"><A HREF="#Section1">Introduction</A><BR><BR><A HREF="#Section2">Handy Hint for Lists of Font Names</A><BR><BR><A HREF="#Section3">Suggested Font Strategy for Applications and Documents</A><BR><BR><A HREF="#References">References</A><BR><BR><A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">This note recommends the use of font names rather than font numbers.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Aug 01 1988]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><a name=Section1></A><h2>Introduction</h2><P>The Font Manager chapter of <i>Inside Macintosh Volume IV</i> claims that fontfamily numbers 0 through 127 are reserved for use by Apple, and numbers 128through 255 are assigned by Apple for fonts created by software developers.This is no longer true. Developer Technical Support does <b>not</b> assign fontfamily numbers. You should only use font numbers to reference the system font(font 0) and application default font (font 1). All other fonts should beidentified by name. The Font/DA Mover will renumber a font when moving it intoa file containing a conflicting font family.</p><p>The Font Manager routines <code>GetFontName</code> and <code>GetFNum</code> map fontnames to numbers and vice versa. This makes it simple to store a font's name ina document and turn it back into a number when reading the document.Unfortunately, <code>GetFNum</code> returns a 0 when a font by that name doesn'texist; this is the same as the font ID for the system font. The followingroutine in MPW Pascal alleviates this problem:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    FUNCTION GetFontNumber(fontName: Str255; VAR fontNum: INTEGER) : BOOLEAN;    {GetFontNumber returns in fontNum the number for the font having     the given fontName. If there's no such font, it returns FALSE.}    VAR        systemFontName: Str255;    BEGIN    GetFNum(fontName, theNum);    IF fontNum = 0 THEN BEGIN        {either the font was not found, or it is the system font}        {if it was the system font, we got it, otherwise we didn't}        GetFontName(0, systemFontName);        GetFontNumber := EqualString(fontName, systemFontName, FALSE, FALSE);    END ELSE        {if theNum was not 0, we found the font}        GetFontNumber := TRUE;</pre>	</TD></TR></TABLE></CENTER><h3>In MPW C:</h3><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    Boolean GETFONTNUMBER(fontName, fontNum)    Str255* fontName;    short* fontNum;    /* GetFontNumber returns in fontNum the number for the font having       the given fontName. If there's no such font, it returns false. */    {        Str255* systemFontName;        GETFNUM(fontName, fontNum);        if (*fontNum == 0) {            /* either the font was not found, or it is the system font */            /* if it was the system font, we got it, otherwise we didn't */            GETFONTNAME(0, systemFontName);            return (EQUALSTRING(fontName, systemFontName, false, false));        } else            return true;</pre>	</TD></TR></TABLE></CENTER><p>This routine makes it easy to find out if a given font exists; if the fontisn't available, you can present a dialog to the user, allowing an appropriatesubstitute font to be chosen.</p><a name="Section2"></a><P><A HREF="#top">Back to top</A></p><h2>Handy Hint for Lists of Font Names</h2><p>Most applications that offer the user a choice of fonts do so by creating aFonts menu. Some applications, however, present a list of fonts in some otherway: for example, word processors that use a dialog box to let the user pick afont family, point size, and style often display the font family choices in aList Manager list. You can get the Menu Manager to do most of the work by using<code>AddResMenu</code> to enumerate and alphabetize the names, as follows:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>PROCEDURE BuildMyFontList;CONST    AnUnusedMenuID = 150; {a menu ID not used by any of your menus}VAR    tempMenu: MenuHandle;    thisItem: INTEGER;    aFontName: Str255;BEGIN    {Get a menu; use the Menu Manager to fill it with font names}    tempMenu := NewMenu(AnUnusedMenuID,'x');    AddResMenu(tempMenu,'FONT');    {Extract the names we got, one at a time}    FOR thisItem := 1 TO CountMItems(tempMenu) DO        BEGIN            {Extract the next name from the menu}            GetItem(tempMenu,thisItem,aFontName);            {** Do something with this font name (add   **}             {** it to a List Manager list, or whatever) **}        END;    {We're done with the menu; dispose of it}    DisposeMenu(tempMenu);</pre>	</TD></TR></TABLE></CENTER><p>This approach will help to insulate your application from changes to the FontManager. Historically, <code>AddResMenu</code> was modified to notice <code>FOND</code>resources at the same time the Font Manager began to support them, soapplications that used this technique to build their font lists didn't need tobe modified to work with <code>FOND</code>s.</p><a name="Section3"></a><P><A HREF="#top">Back to top</A></p><h2>Suggested Font Strategy for Applications and Documents</h2><p>If your application offers the user a choice of a single font for use in theentire document, it's a simple matter to store the name of that font somewherein the document (perhaps in an 'STR ' resource). However, if your applicationlets the user use many fonts within each document (as is the case with mostword processors) a more complex strategy is necessary:  the Font Name MappingTable. Each entry might look like this:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    FontMapEntry : RECORD        name: Str255;        {The name of the font}        localID: INTEGER;    {a unique number for this entry}        realID: INTEGER;    {last time we checked, this font's font number}        useCount: INTEGER;    {How many times this font is used in this                    document}</pre>	</TD></TR></TABLE></CENTER><p>In a new document, start out with no entries in the table. When the userchanges a selection of text to a new font (that is, one whose name is not inthe table), add an entry to the table. Set <code>useCount</code> to 1 (as this fontis now referenced once within the document), and pick a <code>localID</code> thatis unique within the table. In the text, or wherever you would normally keepthe font number, store a copy of this <code>localID</code> instead of the fontnumber. Use <code>GetFontNumber</code> (the example above) to get the "real" fontnumber, and store it in the table as well, in <code>realID</code>.</p><p>Whenever you need to draw text, search through the table for the proper<code>localID</code>. When you find it, use the <code>realID</code> that is stored inthat entry in a call to <code>TextFont</code>, then draw your text as usual.</p><p>Keep the <code>useCount</code> updated, so that you know when to get rid of a tableentry. If the user deletes a range of text, or changes it to another font,examine the text to see if you should decrement any of the <code>useCount</code>sin your table. When a <code>useCount</code> for an entry becomes zero, you'll knowthat the font for that entry isn't used anywhere within the document, and youcan remove the entry from the table.</p><p>When you save the document, save the table with it. When you open an existingdocument, load the table. For each entry, call <code>GetFontNumber</code> usingeach <code>name</code>, and update the <code>realID</code> field with the current fontnumber for that name. If a font isn't present, you should warn the user: Youcould let the user choose an alternative font, or use the default applicationfont by storing (and using) the constant <code>applFont</code> as that font's<code>realID</code>; this way, the user could still edit the document, but theoriginal font name would remain, so that when the user adds the proper font tothe System file, or moves the document to a Macintosh whose System filecontains it, the document would be displayed as originally intended.</p><p>The overhead of handling your documents' fonts in this manner is rather small;as more font families become available, and Font/DA Mover's renumberings occurmore often, your customers will appreciate this extra effort.</p><P><A HREF="#top">Back to top</A></p><a name = "References"></a><h2>References</h2><P>The Font Manager</p>         <a name="Downloads"></a>       <P><A HREF="#top">Back to top</A></p><h2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (44K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/te_04.pdf">Download</A></P>               </TD>            </TR>                    </TABLE>         <BR></TD></TR></table></center><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/te/te_04.html%3Fid%3DDTS10002812-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/te/te_04.html%3Fid%3DDTS10002812-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/te/te_04.html%3Fid%3DDTS10002812-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>