<!-- legacy work start -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<!-- legacy work end -->


<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)

LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>SPBRecordToFile (IM: S)  (deprecated)</Title>

<!-- legacy work start -->
        <META NAME="Generator" CONTENT="manual">
        <META http-equiv="content-type" CONTENT="text/html;charset=utf-8">
        <META NAME = "Copyright" CONTENT="Copyright 2007 Apple Inc. All Rights Reserved.">
        <META NAME="IndexTitle" CONTENT="Inside Macintosh: Sound (Not Recommended)">
        <meta name="xcode-display" content="render">

        <LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css"> <!-- before submitting, globally replace ".." with "developer.apple.com" -->
        <script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
<!-- legacy work end -->

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<A NAME=HEADING161></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Sound-160.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Sound-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Sound-336.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Sound-162.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Sound-2.html"><B>Sound</B></A> / <BR><DD><A HREF="Sound-137.html"><B>Chapter 3 - Sound Input Manager</B></A> / <A HREF="Sound-146.html"><B>Sound Input Manager Reference</B></A><BR><DL><DD><A HREF="Sound-152.html"><B>Sound Input Manager Routines</B></A> / <A HREF="Sound-159.html"><B>Recording Sounds Directly From Sound Input Devices</B></A></DL></DL></FONT><P>
<HR>

<!-- legacy work start -->
<script type="text/javascript"> placeWatermark()</script>
<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
<i>Inside Macintosh: Sound</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="../../../referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div>
<!-- legacy work end -->


<BLOCKQUOTE>
<A NAME=HEADING161-0></A>
<H3><A NAME=MARKER-11-291></A>SPBRecordToFile<A NAME=MARKER-2-126></A></H3>
 You can use the <CODE>SPBRecordToFile</CODE> function to record audio data into a file, either synchronously or asynchronously.<P>
<PRE>
FUNCTION SPBRecordToFile (fRefNum: Integer; inParamPtr: SPBPtr; 
                           asynchFlag: Boolean): OSErr;
</PRE>
<DL>
<DT><CODE>fRefNum</CODE>
<DD> The file reference number of an open file in which to place the recorded sound data.
<DT><CODE>inParamPtr</CODE>
<DD> A pointer to a sound input parameter block.
<DT><CODE>asynchFlag</CODE>
<DD> A Boolean value that specifies whether the recording occurs asynchronously (<CODE>TRUE</CODE>) or synchronously (<CODE>FALSE</CODE>).
</DL>
<B><CODE>
<TABLE BORDER="0" CELLPADDING=3><TD>--><TD>inRefNum<TD>LongInt<TD>A reference number of a sound input device.<TR>
<TD><--><TD>count<TD>LongInt<TD>The number of bytes of recording.<TR>
<TD><--><TD>milliseconds<TD>LongInt<TD>The number of milliseconds of recording.<TR>
<TD>--><TD>completionRoutine<TD>ProcPtr<TD>A pointer to a completion routine.<TR>
<TD>--><TD>interruptRoutine<TD>ProcPtr<TD>Unused.<TR>
<TD>--><TD>userLong<TD>LongInt<TD>Free for application's use.<TR>
<TD><--<TD>error<TD>OSErr<TD>The error value returned after recording.<TR>
<TD>--><TD>unused1<TD>LongInt<TD>Reserved.</TABLE>
</CODE></B><P>
<DL>
<H5>Field Description</H5>
<DT><CODE>inRefNum</CODE>
<DD> The device reference number of the sound input device, as obtained from the <CODE>SPBOpenDevice</CODE> function.
<DT><CODE>count</CODE>
<DD> On input, the number of bytes to record. If this field indicates a longer recording time than the <CODE>milliseconds</CODE> field, then the <CODE>milliseconds</CODE> field is ignored. On output, the number of bytes actually recorded.
<DT><CODE>milliseconds</CODE>
<DD> On input, the number of milliseconds to record. If this field indicates a longer recording time than the <CODE>count</CODE> field, then the <CODE>count</CODE> field is ignored. On output, the number of milliseconds actually recorded.
<DT><CODE>completionRoutine</CODE>
<DD> A pointer to a completion routine. This routine is called when the recording terminates (after you call the <CODE>SPBStopRecording</CODE> function, when the prescribed limit is reached, or after an error occurs). The completion routine is called only for asynchronous recording.
<DT><CODE>interruptRoutine</CODE>
<DD> Unused. You should set this field to <CODE>NIL</CODE> before calling <CODE>SPBRecordToFile</CODE>.
<DT><CODE>userLong</CODE>
<DD> A long integer that your application can use to pass data to your application's completion or interrupt routines.
<DT><CODE>error</CODE>
<DD> On exit, the error that occurred during recording. This field contains the number 1 while recording unless an error occurs, in which case it contains a value less than 0 that indicates an operating system error. Your application can poll this field to check on the status of an asynchronous recording. If recording terminates without an error, this field contains 0.
<DT><CODE>unused1</CODE>
<DD> Reserved. You should set this field to 0 before calling the <CODE>SPBRecordToFile</CODE> function.
</DL>
<A NAME=HEADING161-15></A>
<H5>DESCRIPTION</H5>
 The <CODE>SPBRecordToFile</CODE> function starts recording from the specified device into a file. The sound data recorded is simply stored in the file, so it is up to your application to insert whatever headers are needed to play the sound with the Sound Manager. Your application must open the file specified by the <CODE>fRefNum</CODE> parameter with write access before calling <CODE>SPBRecordToFile</CODE>, and it must eventually close that file.<P>
 The fields in the parameter block specified by the <CODE>inParamPtr</CODE> parameter are identical to the fields in the parameter block passed to the <CODE>SPBRecord</CODE> function, except that the <CODE>bufferLength</CODE> and <CODE>bufferPtr</CODE> fields are not used. The <CODE>interruptRoutine</CODE> field is ignored by <CODE>SPBRecordToFile</CODE> because <CODE>SPBRecordToFile</CODE> copies data returned by the sound input device driver to disk during the sound input interrupt routine, but you should initialize this field to <CODE>NIL</CODE>.<P>
 The <CODE>SPBRecordToFile</CODE> function writes samples to disk in the same format that they are read in from the sound input device. If compression is enabled, then the samples written to the file are compressed. Multiple channels of sound are interleaved on a sample basis (or, for compressed sound data, on a packet basis). When you are recording 8-bit audio data to an <CODE>AIFF</CODE> file, you must set the <CODE>siTwosComplementOnOff</CODE> flag to so that the data is stored on disk in the two's-complement format. If you don't store the data in this format, it sounds distorted when you play it back.<P>
 If any errors occur during the file writing process, recording is suspended. All File Manager errors are returned through the function's return value if the routine is called synchronously. If the routine is called asynchronously and the completion routine is not <CODE>NIL</CODE>, the completion routine is called and is passed a single parameter on the stack that points to the sound input parameter block; any errors are returned in the <CODE>error</CODE> field of the sound input parameter block.<P>
 The <CODE>SPBRecordToFile</CODE> function returns the value that the <CODE>error</CODE> field of the parameter block contains when recording finishes.<P>
<A NAME=HEADING161-21></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 Because the <CODE>SPBRecordToFile</CODE> function moves or purges memory, you should not call it at interrupt time.<P>
<A NAME=HEADING161-23></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The trap macro and routine selector for the <CODE>SPBRecordToFile</CODE> function are
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Trap macro<TH>Selector<TR>
<TD>_SoundDispatch<TD>$04240014</TABLE>
<P>
<A NAME=HEADING161-25></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>permErr<TD>-54<TD>Attempt to open locked file for writing<TR>
<TD>siNoSoundInHardware<TD>-220<TD>No sound input hardware available<TR>
<TD>siBadSoundInDevice<TD>-221<TD>Invalid sound input device<TR>
<TD>siHardDriveTooSlow<TD>-224<TD>Hard drive too slow to record<A NAME=MARKER-2-423></A><A NAME=MARKER-2-207></A><A NAME=MARKER-2-119></A></TABLE>
</H5>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Sound-160.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Sound-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Sound-336.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Sound-162.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Sound-3.html">&copy; Apple Computer, Inc.</A><br>2 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
