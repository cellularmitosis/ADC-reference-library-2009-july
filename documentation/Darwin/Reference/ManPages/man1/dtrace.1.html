<html><head><title>Mac OS X
 Manual Page For dtrace(1)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/1/dtrace" title="Mac OS X
 Manual Page for dtrace(1)"><!-- headerDoc=man; indexgroup=Section 1; uid="//apple_ref/doc/man/1/dtrace"; name=dtrace(1) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
DTRACE(1)                                                                                          DTRACE(1)



<b>NAME</b>
       dtrace - generic front-end to the DTrace facility

<b>SYNOPSIS</b>
       <b>dtrace</b> [<b>-aACeFhHlqSvVwZ</b>] [<b>-arch</b> <u>arch</u><b>_</b><u>name</u>]
              [<b>-b</b> <u>bufsz</u>] [<b>-c</b> <u>fullPathToCommand</u>] [<b>-D</b> <u>name</u>[=<u>def</u>]]
              [<b>-I</b> <u>path</u>] [<b>-L</b> <u>path</u>] [<b>-o</b> <u>output</u>] [<b>-p</b> <u>pid</u>]
              [<b>-s</b> <u>script</u>] [<b>-U</b> <u>name</u>] [<b>-x</b> <u>arg</u>[=<u>val</u>]]
              [<b>-P</b> <u>provider</u> [[<u>predicate</u>] <u>action</u>]]
              [<b>-m</b> [<u>provider</u>:] <u>module</u> [[<u>predicate</u>] <u>action</u>]]
              [<b>-f</b> [[<u>provider</u>:] <u>module</u>:] <u>function</u> [[<u>predicate</u>] <u>action</u>]]
              [<b>-n</b> [[[<u>provider</u>:] <u>module</u>:] <u>function</u>:] <u>name</u> [[<u>predicate</u>] <u>action</u>]]
              [<b>-i</b> <u>probe-id</u> [[<u>predicate</u>] <u>action</u>]]

<b>OVERVIEW</b>
       The  <u>dtrace</u>  command  is a generic front-end to the DTrace facility.  The command implements a simple
       interface to invoke the D language compiler, the ability to retrieve buffered  trace  data  from  the
       DTrace kernel facility, and a set of basic routines to format and print traced data.

       Users  new  to DTrace are encouraged to read: <u>How</u> <u>To</u> <u>Use</u> <u>DTrace</u>. Sun Microsystems, 2005. Available on
       the web at <a href="http://www.sun.com/software/solaris/howtoguides/dtracehowto.jsp">http://www.sun.com/software/solaris/howtoguides/dtracehowto.jsp</a>

<b>DESCRIPTION</b>
       The <u>dtrace</u> command provides a generic interface to all of the  essential  services  provided  by  the
       DTrace facility, including:

        Options to list the set of probes and providers currently published by DTrace

        Options  to enable probes directly using any of the probe description specifiers (provider, module,
         function, name)

        Options to run the D compiler and compile one or more D program files or programs written  directly
         on the command-line

        Options to generate anonymous tracing programs

        Options to generate program stability reports

        Options to modify DTrace tracing and buffering behavior and enable additional D compiler features

<b>OPTIONS</b>
       <u>dtrace</u> has the following options:

       <b>-arch</b> <u>arch</u><b>_</b><u>name</u>
              Set dtrace's target data model. See <a href="arch.1.html#//apple_ref/doc/man/1/arch"><u>arch</u>(1)</a> for a list of currently supported architectures.

       <b>-a</b>     Claim anonymous tracing state and display the traced data.  You can combine the <b>-a</b> option with
              the <b>-e</b> option to force <u>dtrace</u> to exit immediately after consuming the anonymous tracing  state
              rather than continuing to wait for new data.

       <b>-A</b>     Generate  a  <a href="../man5/plist.5.html#//apple_ref/doc/man/5/plist">plist(5)</a>  of  directives  for  anonymous tracing.  If the <b>-A</b> option is specified,
              <u>dtrace</u> compiles any D programs specified using the <b>-s</b> option or on the command-line  and  con-
              structs  a  <a href="../man5/plist.5.html#//apple_ref/doc/man/5/plist">plist(5)</a> of dtrace directives to enable the specified probes for anonymous trcaing
              and then  exits.   By  default,  <u>dtrace</u>  attempts  to  store  the  plist  to  the  file  /Sys-
              tem/Library/Extensions/dtrace_dof.kext/Contents/Info.plist.   This  behavior  can  be modified
              using the <b>-o</b> option to specify an alternate output file.

       <b>-b</b>     Set principal trace buffer size.  The trace buffer size can include any of the  size  suffixes
              <b>k</b>,  <b>m</b>, <b>g</b>, or <b>t</b>.  If the buffer space cannot be allocated, <u>dtrace</u> attempts to reduce the buffer
              size or exit depending on the setting of the bufresize property.

       <b>-c</b>     Run the specified command <u>cmd</u> and exit upon its completion. If more  than  one  <b>-c</b>  option  is
              present  on  the  command line, <b>dtrace</b> exits when all commands have exited, reporting the exit
              status for each child process as it terminates. The process-ID of the first  command  is  made
              available  to  any D programs specified on the command line or using the <b>-s</b> option through the
              <b>$target</b> macro variable.

       <b>-C</b>     Run the C preprocessor <u>cpp</u> over D programs before compiling them.  Options can  be  passed  to
              the C preprocessor using the <b>-D</b>, <b>-U</b>, <b>-I</b>, and <b>-H</b> options.  The degree of C standard conformance
              can be selected using the <b>-X</b> option.  Refer to the description of the <b>-X</b> option for a descrip-
              tion of the set of tokens defined by the D compiler when invoking the C preprocessor.

       <b>-D</b>     Define  the specified <u>name</u> when invoking <u>cpp</u> (enabled using the <b>-C</b> option).  If an equals sign
              (=) and additional <u>value</u> are specified, the name is assigned the  corresponding  value.   This
              options passes the <b>-D</b> option to each <u>cpp</u> invocation.

       <b>-e</b>     Exit  after compiling any requests and consuming anonymous tracing state (<b>-a</b> option) but prior
              to enabling any probes.  This option can be combined with the <b>-a</b>  option  to  print  anonymous
              tracing  data  and exit, or it can be compiled with D compiler options to verify that programs
              compile without actually executing them and enabling the corresponding instrumentation.

       <b>-f</b>     Specify function name to trace or list (<b>-l</b> option).  The corresponding  argument  can  include
              any  of  the  probe  description forms <u>provider</u>:<u>module</u>:<u>function</u>, <u>module</u>:<u>function</u>, or <u>function</u>.
              Unspecified probe description fields are left blank and match any  probes  regardless  of  the
              values  in  those  fields.  If no qualifiers other than <u>function</u> are specified in the descrip-
              tion, all probes with the  corresponding  <u>function</u>  are  matched.   The  <b>-f</b>  argument  can  be
              suffiexed  with  an  optional D probe clause.  More than one <b>-f</b> option may be specified on the
              command-line at a time.

       <b>-F</b>     Coalesce trace output by identifying function entry and return.  Function entry probe  reports
              are  indented  and  their output is prefixed with -&gt;.  Function return probe reports are unin-
              dented and their output is prefixed with &lt;-.

       <b>-h</b>     Generate a header file containing macro definitions for USDT  probes.  If  the  <b>-o</b>  option  is
              present,  the header file is saved using the pathname specified as the argument for this flag.
              If the <b>-o</b> option is not present and the DTrace program is contained in a file  whose  name  is
              filename.d, the header file is saved using the name filename.h.

       <b>-H</b>     Print  the  pathnames of included files when invoking <u>cpp</u> (enabled using the <b>-C</b> option).  This
              option passes the <b>-H</b> option to each <u>cpp</u> invocation, causing it to display the  list  of  path-
              names, one per line, to stderr.

       <b>-i</b>     Specify  probe identifier to trace or list (<b>-l</b> option).  Probe IDs are specified using decimal
              integers as shown by <u>dtrace</u> <b>-l</b>.  The <b>-i</b> argument can be suffixed  with  an  optional  D  probe
              clause.  More than one <b>-i</b> option may be specified on the command-line at a time.

       <b>-I</b>     Add  the  specified  directory  <u>path</u>  to  the search path for #include files when invoking <u>cpp</u>
              (enabled using the <b>-C</b> option).  This option passes the <b>-I</b> option to each <u>cpp</u> invocation.   The
              specified directory is inserted into the search path ahead of the default directory list.

       <b>-l</b>     List  all  probes matching probe specifications appearing in <b>-f</b>, <b>-i</b>, <b>-m</b>, <b>-n</b>, or <b>-P</b> options. No
              tracing is initiated for any probes.

       <b>-L</b>     Add the specified directory <u>path</u> to the search path for DTrace  libraries.   DTrace  libraries
              are  used  to contain common definitions that may be used when writing D programs.  The speci-
              fied <u>path</u> is added after the default library search path.

       <b>-m</b>     Specify module name to trace or list (<b>-l</b> option).  The corresponding argument can include  any
              of  the  probe  description  forms  <u>provider</u>:<u>module</u>  or <u>module</u>.  Unspecified probe description
              fields are left blank and match any probes regardless of the values in those  fields.   If  no
              qualifiers other than <u>module</u> are specified in the description, all probes with a corresponding
              <u>module</u> are matched.  The <b>-m</b> argument can be suffixed with an optional D  probe  clause.   More
              than one <b>-m</b> option may be specified on the command-line at a time.

       <b>-n</b>     Specify  probe  name to trace or list (<b>-l</b> option).  The corresponding argument can include any
              of the probe  description  forms  <u>provider</u>:<u>module</u>:<u>function</u>:<u>name</u>,  <u>module</u>:<u>function</u>:<u>name</u>,  <u>func</u>-
              <u>tion</u>:<u>name</u>,  or <u>name</u>.  Unspecified probe description fields are left blank and match any probes
              regardless of the values in those fields.  If no qualifiers other than <u>name</u> are  specified  in
              the  description,  all  probes  with a corresponding name are matched.  The <b>-n</b> argument can be
              suffixed with an optional D probe clause.  More than one <b>-n</b> option may  be  specified  on  the
              command-line at a time.

       <b>-o</b>     Specify  the  <u>output</u> file for the <b>-A</b> and <b>-l</b> options, or for the traced data.  If the <b>-A</b> option
              is present, and <b>-o</b> is not present, the default output file is /kernel/drv/dtrace.conf.

       <b>-p</b>     Grab the specified process-ID <u>pid</u>, cache its symbol tables, and exit upon its  completion.  If
              more  than  one  <b>-p</b> option is present on the command line, <b>dtrace</b> exits when all commands have
              exited, reporting the exit status for each process as it terminates. The first  process-ID  is
              made available to any D programs spe cified on the command line or using the <b>-s</b> option through
              the <b>$target</b> macro variable.

       <b>-P</b>     Specify provider name to trace or list (<b>-l</b> option).  The remaining  probe  description  fields
              module,  function,  and  name  are left blank and match any probes regardless of the values in
              those fields.  The <b>-P</b> argument can be suffixed with an optional D probe clause.  More than one
              <b>-P</b> option may be specified on the command-line at a time.

       <b>-q</b>     Set  quiet  mode.   <u>dtrace</u>  will suppress messages such as the number of probes matched by the
              specified options and D programs will not print column headers, the CPU ID, the probe  ID,  or
              insert  newlines into the output.  Only data traced and formatted by D program statements such
              as <b>trace()</b> and <b>printf()</b> will be displayed to stdout.

       <b>-s</b>     Compile the specified D program source file.  If the <b>-e</b> option is present, the program is com-
              piled  but  no instrumentation is enabled.  If the <b>-l</b> option is specified, the program is com-
              piled and the set of probes matched by it is listed, but no instrumentation will  be  enabled.
              If neither <b>-e</b> or <b>-l</b> are present, the instrumentation specified by the D program is enabled and
              tracing begins.

       <b>-S</b>     Show D compiler intermediate code.  The D compiler will produce a report of  the  intermediate
              code generated for each D program to stderr.

       <b>-U</b>     Undefine  the  specified  <u>name</u>  when  invoking <u>cpp</u> (enabled using the <b>-C</b> option).  This option
              passes the <b>-U</b> option to each <u>cpp</u> invocation.

       <b>-v</b>     Set verbose mode.  If the <b>-v</b> option is specified, <u>dtrace</u> produces a program  stability  report
              showing the minimum interface stability and dependency level for the specified D programs.

       <b>-V</b>     Report  the  highest  D programming interface version supported by <u>dtrace</u>.  The version infor-
              maion is printed to stdout and the dtrace command exits.

       <b>-w</b>     Allow destructive actions. D programs containing destructive  actions  will  fail  to  compile
              unless this flag is specified.

       <b>-x</b>     Enable or modify a DTrace runtime option or D compiler option.  Boolean options are enabled by
              specifying their name.  Options with values are set by separating the option  name  and  value
              with an equals sign (=).

       <b>-Z</b>     Permit  probe  descriptions that match zero probes.  If the <b>-Z</b> option is not specified, <u>dtrace</u>
              will report an error and exit if any probe descriptions  specified  in  D  program  files  (<b>-s</b>
              option)  or  on  the command-line (<b>-P</b>, <b>-m</b>, <b>-f</b>, <b>-n</b>, or <b>-i</b> options) contain descriptions that do
              not match any known probes.

<b>OPERANDS</b>
       Zero or more additional arguments may be specified on the <u>dtrace</u> command line  to  define  a  set  of
       macro  variables ($1, $2, and so on) to be used in any D programs specified using the <b>-s</b> option or on
       the command-line.

<b>C++</b> <b>MANGLED</b> <b>NAMES</b>
       By default, <u>dtrace</u> uses the demangled names of C++ symbols. You can tell <u>dtrace</u> to  use  the  mangled
       symbol names by passing <u>-xmangled</u> to the command.

<b>OBJECTIVE</b> <b>C</b> <b>PROVIDER</b>
       The  Objective  C  provider is similar to the pid provider, and allows instrumentation of Objective C
       classes and methods. Objective C probe specifiers use the following format:

       <b>objc</b><u>pid</u>:[<u>class-name</u>[(<u>category-name</u>)]]:[[+|-]<u>method-name</u>]:[<u>name</u>]

       <b>pid</b>    The id number of the process.

       <b>class-name</b>
              The name of the Objective C class.

       <b>category-name</b>
              The name of the category within the Objective C class.

       <b>method-name</b>
              The name of the Objective C method.

       <b>name</b>   The name of the probe, <b>entry</b>, <b>return</b>, or an integer instruction offset within the method.

<b>OBJECTIVE</b> <b>C</b> <b>PROVIDER</b> <b>EXAMPLES</b>
       <b>objc123:NSString:-*:entry</b>
              Every instance method of class NSString in process 123.

       <b>objc123:NSString(*)::entry</b>
              Every method on every category of class NSString in process 123.

       <b>objc123:NSString(foo):+*:entry</b>
              Every class method in NSString's foo category in process 123.

       <b>objc123::-*:entry</b>
              Every instance method in every class and category in process 123.

       <b>objc123:NSString(foo):-dealloc:entry</b>
              The dealloc method in the foo category of class NSString in process 123.

       <b>objc123::method?with?many?colons:entry</b>
              The method method:with:many:colons in every class in process 123. (A <b>?</b> wildcard must  be  used
              to  match  colon  characters  inside  of  Objective C method names, as they would otherwise be
              parsed as the provider field separators.)

<b>BUILDING</b> <b>CODE</b> <b>CONTAINING</b> <b>USDT</b> <b>PROBES</b>
       The process of adding USDT probes to code is  slightly  different  than  documented  in  the  <u>Solaris</u>
       <u>Dynamic</u> <u>Tracing</u> <u>Guide</u>. The steps for adding probes are as follows:

       1. Name the provider and specify its probes, using the following form:

               provider Example {
                    probe increment(int);
               };

          This  defines  the  <b>Example</b>  provider with one probe, <b>increment</b>, that takes a single int argument.
          Providers can define multiple probes and probes can take multiple arguments.

       2. Process the provider description into a header file.

          The provider description must be converted into a form usable by ObjC/C/C++ code. The dtrace  com-
          mand should be invoked with the <b>-h</b> flag to do this.

               <b>dtrace</b> <b>-h</b> <b>-s</b> <b>exampleProvider.d</b>

          This will generate a header file named <b>exampleProvider.h</b>

       3. Add probe invocations to the application

          For  each probe defined in the provider, the provider.h file will contain two macros.The naming is
          as follows:

               <b>PROVIDER_PROBENAME()</b>
               <b>PROVIDER_PROBENAME_ENABLED()</b>

          In the Example provider, the increment probe becomes:

               <b>EXAMPLE_INCREMENT()</b>
               <b>EXAMPLE_INCREMENT_ENABLED()</b>

          Place a macro invocation in the code at each site to be traced. If the arguments passed to a probe
          are expensive to calculate, you may guard the probe placement like this:

               if (EXAMPLE_INCREMENT_ENABLED()) {
                    argument = /* Expensive argument calculation code here */;
                    EXAMPLE_INCREMENT(argument);
               };

          The if test will only succeed when the increment probe is active.

       4. Compile and link your program normally. No additional compiler or linker flags are required.


<b>EXIT</b> <b>STATUS</b>
       The following exit values are returned by the <u>dtrace</u> utility:

       <b>0</b>      The specified requests were completed successfully.  For D program requests, the 0 exit status
              indicates that programs were successfully  compiled,  probes  were  successfully  enabled,  or
              anonymous  state  was  successfully retrieved.  <u>dtrace</u> returns 0 even if the specified tracing
              requests encountered errors or drops.

       <b>1</b>      A fatal error occurred.  For D program requests, the 1 exit status indicates that program com-
              pilation failed or that the specified request could not be satisfied.

       <b>2</b>      Invalid command-line options or arguments were specified.

<b>SEE</b> <b>ALSO</b>
       <u>How</u>  <u>To</u>  <u>Use</u>  <u>DTrace</u>.  Sun  Microsystems,  2005.  Available  on  the  web at <a href="http://www.sun.com/software/solaris/howtoguides/dtracehowto.jsp">http://www.sun.com/soft-</a>
       <a href="http://www.sun.com/software/solaris/howtoguides/dtracehowto.jsp">ware/solaris/howtoguides/dtracehowto.jsp</a>
       <u>Solaris</u>  <u>Dynamic</u>   <u>Tracing</u>   <u>Guide</u>.    Sun   Microsystems,   2005.    Available   on   the   web   at
       <a href="http://docs.sun.com/app/docs/doc/817-6223">http://docs.sun.com/app/docs/doc/817-6223</a>




Version 1.0                                       July 2006                                        DTRACE(1)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man1/dtrace.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man1/dtrace.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man1/dtrace.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
