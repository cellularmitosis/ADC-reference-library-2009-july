<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML EXPERIMENTAL 970324//EN"><HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><TITLE> Dealing With Browser Backtracking</TITLE></HEAD><BODY bgcolor="#ffffff">		<!-- start of header -->		<!--#include virtual="/includes/framesetheader" -->		<!-- end of header --><!-- start of path --><table cellspacing=0 border=0 width=600 valign="left"><tr><td scope="row"><font face="Geneva,Helvetica,Arial" size="1"><b>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="../../index.html" target="_top">Documentation</a> <b>></b> <a href="../webobjects.html" target="_top">WebObjects</a></font></td></tr></table><br><!-- end of path --><DIV><a name="top"></a><A HREF="TopicsTOC.html"><img src="up.gif" border="0" alt="Up"></A><nobr>&nbsp;</nobr><A HREF="ProgrammingTopics.12.html"><img src="previous.gif" border="0" alt="Previous"></A><nobr>&nbsp;</nobr><A HREF="ProgrammingTopics.14.html"><img src="next.gif" border="0" alt="Next"></A></DIV><H1 CLASS="TopictTitle"><A NAME="pgfId=606100"> </A><A NAME="23604"> </A>Dealing With Browser Backtracking</H1><DIV><H2 CLASS="Synopsis"><A NAME="pgfId=606101"> </A>Synopsis</H2><P CLASS="Body"><A NAME="pgfId=606102"> </A>Describes solutions to the page synchronization issues that arise when users backtrack with the browser.</P></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606103"> </A>Discussion</H2><P CLASS="Body"><A NAME="pgfId=606104"> </A>A problem can arise in WebObjects when users are allowed to backtrack using the browser. The problem is that browsers normally cache the previous pages and repaint the cached pages when the user backtracks. The old page might contain items that are no longer part of the current result set. Thus, the user may get a response for an item he has not selected. </P><P CLASS="Body"><A NAME="pgfId=606105"> </A>For example, suppose that you have a page capable of showing either a list of movies or the details of one movie. In addition, based on a detail mode flag, a WOCondition decides to show the details. Furthermore, the user clicks a movie title within the list of titles, detail mode is toggled on, the selection is remembered, and the same page instance is returned. If the user presses the browser's back button, the browser simply repaints the page with the list of movie hyperlinks. This is where the problem arises. The current state of the page is set to detailed mode. When the user selects another movie title from the list, WebObjects must figure out which action should be invoked. It does this by running through the components on the page and determining which element was selected. Since the current state is detail mode, only the detail WOCondition block of elements are checked and a mismatch occurs.</P><P CLASS="Body"><A NAME="pgfId=606106"> </A>There are two ways to work around this problem.</P><DIV><H3 CLASS="Heading2"><A NAME="pgfId=606107"> </A>Option 1: Generate Preexpired Pages</H3><P CLASS="Body"><A NAME="pgfId=606108"> </A>When you set the WOApplication <TT CLASS="Code">setPageRefreshOnBacktrackEnabled</TT> method to YES, WOF generates preexpired pages. This informs the browser that it must refetch the page whenever the browser is going to move back to the page.</P><P CLASS="Body"><A NAME="pgfId=606109"> </A>The issues with this solution are as follows:</P><UL><LI CLASS="Bulleted"><A NAME="pgfId=606110"> </A>	The user will always see the latest page, no matter how far he backtracks. This behavior may compromise the friendliness of your user interface. You might want the user to see the old screens and be able to reselect from them.</LI><LI CLASS="Bulleted"><A NAME="pgfId=606111"> </A>	Some browsers handle preexpired pages by simply informing the user that the page must be refreshed.</LI><LI CLASS="Bulleted"><A NAME="pgfId=606112"> </A>	Some browsers don't always refresh the page even at the user's explicit request, effectively eliminating backtracking with preexpired pages.</LI></UL></DIV><DIV><H3 CLASS="Heading2"><A NAME="pgfId=606114"> </A>Option 2: Return a New Page Instance for Every Action</H3><P CLASS="Body"><A NAME="pgfId=606115"> </A>Create a new instance of the current page and push all of the current state into that page. Make state changes in this new page and then return the new page from the current page's action. This ensures that every page keeps its original state for future requests from a backtracking user.</P><P CLASS="Body"><A NAME="pgfId=606116"> </A>The issues with this solution are as follows:</P><UL><LI CLASS="Bulleted"><A NAME="pgfId=606117"> </A>	More memory is used to hold the pages. Ensure that you limit the WOApplication's page cache size. When a new page is accessed, the oldest page will be expired out of the page cache and users will get a &quot;You backtracked too far&quot; exception when trying to execute actions on the old page.</LI><LI CLASS="Bulleted"><A NAME="pgfId=606118"> </A>	Since a complete set of state is kept in each page, the memory usage can grow quickly.</LI><LI CLASS="Bulleted"><A NAME="pgfId=606119"> </A>	State might be invalid even though it is accessible from older pages.</LI></UL><P CLASS="Body"><A NAME="pgfId=606121"> </A>There are many different combinations of these two approaches that can be used throughout a WebObjects application. You must think through the issues of both and perform some basic testing within your environment to see what works best.</P></DIV></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606123"> </A>See Also</H2><UL><LI CLASS="Bulleted"><A NAME="pgfId=606124"> </A>WOApplication class specification in the <EM CLASS="Emphasis">WebObjects Framework Reference</EM></LI><LI CLASS="Bulleted"><A NAME="pgfId=606125"> </A>WOResponse class specification in the <EM CLASS="Emphasis">WebObjects Framework Reference</EM></LI></UL></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606126"> </A>Questions</H2><UL><LI CLASS="Bulleted"><A NAME="pgfId=606127"> </A>	How do I preexpire all pages within WebObjects?</LI><LI CLASS="Bulleted"><A NAME="pgfId=606128"> </A>	How do I handle browser backtrack issues?</LI></UL></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606129"> </A>Keywords</H2><UL><LI CLASS="Bulleted"><A NAME="pgfId=606130"> </A>Backtrack</LI><LI CLASS="Bulleted"><A NAME="pgfId=606131"> </A>Preexpire</LI></UL></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606133"> </A>Revision History</H2><P CLASS="Body"><A NAME="pgfId=606134"> </A>24 July, 1998. David Scheck. First Draft.<BR>19 November, 1998. Clif Liu. Second Draft.</P><PRE CLASS="Code"><A NAME="pgfId=602450"> </A></PRE></DIV><hr alt="">&#169 1999 Apple Computer, Inc.<P><A HREF="TopicsTOC.html"><img src="up.gif" border="0" alt="Up"></A><nobr>&nbsp;</nobr><A HREF="ProgrammingTopics.12.html"><img src="previous.gif" border="0" alt="Previous"></A><nobr>&nbsp;</nobr><A HREF="ProgrammingTopics.14.html"><img src="next.gif" border="0" alt="Next"></A><!-- start of footer --><!--#include file="footer" --><!-- end of footer --><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></HTML>