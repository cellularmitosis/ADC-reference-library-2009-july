<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Providing Help Tags in Carbon: Carbon Help Manager Tasks for Adding Help Tags</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Carbon Help Manager Tasks for Adding Help Tags"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20001325-3" title="Carbon Help Manager Tasks for Adding Help Tags"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000420" target="_top">Carbon</a> &gt; <a href="../../../UserExperience-date.html#//apple_ref/doc/uid/TP30000440-TP30000420-TP30000465" target="_top">User Experience</a> &gt; <a href="../carbon_help_introduction/carbon_help_introduction.html#//apple_ref/doc/uid/20001325-1-DontLinkElementID_14">Providing Help Tags in Carbon</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../carbon_help_concepts/carbon_help_concepts.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../revision_history/revision_history.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/20001325-3-DontLinkElementID_16" title="Carbon Help Manager Tasks for Adding Help Tags"></a><h1><a name="//apple_ref/doc/uid/20001325-3-BGBFBAII" title="Carbon Help Manager Tasks for Adding Help Tags"></a>Carbon Help Manager Tasks for Adding Help Tags</h1><p>This chapter contains instructions and sample code showing you how to use the Carbon Help Manager to add help tags to your application’s user interface. </p><p>The code samples assume you are developing your application on the Mac OS using Carbon. All code samples in this chapter are in C.</p><p>You have several options for creating and displaying help tags in your application. You can use any one of the following methods, or any combination of them:</p><ul class="ul"><li class="li"><p>Specify help tags in Interface Builder, Apple’s graphical interface editor. This is the simplest way to create help tags for your application’s user interface.</p></li><li class="li"><p>Call Carbon Help Manager functions to attach help content directly to objects in your application’s user interface. </p></li><li class="li"><p>Install help tag callbacks for objects in your application’s user interface. Use this approach to dynamically determine help content. </p></li><li class="li"><p>Directly display a help tag. If your application needs to display a help tag that is not associated with a control, window, or menu, you can create a help tag and tell the Carbon Help Manager to display it immediately.</p></li></ul>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="carbon_help_tasks.html#//apple_ref/doc/uid/20001325-3-TPXREF101">Using Interface Builder to Create Help Tags</a>
				
			<br/>
			
        
			
			
				<a href="carbon_help_tasks.html#//apple_ref/doc/uid/20001325-3-CHDEFFJD">Attaching a Help Tag Directly to a User Interface Element</a>
				
			<br/>
			
        
			
			
				<a href="carbon_help_tasks.html#//apple_ref/doc/uid/20001325-3-TPXREF102">Providing Help Tags With a Help Tag Callback</a>
				
			<br/>
			
        
			
			
				<a href="carbon_help_tasks.html#//apple_ref/doc/uid/20001325-3-TPXREF104">Displaying a Help Tag at an Application-Defined Location</a>
				
			<br/>
			
        
			
			
				<a href="carbon_help_tasks.html#//apple_ref/doc/uid/20001325-3-CEGHBAAA">Creating a Help Tag for a Menu Title in Versions of Mac OS X Prior to 10.2</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/20001325-3-TPXREF101" title="Using Interface Builder to Create Help Tags"></a><h2>Using Interface Builder to Create Help Tags</h2><p>If you are using Interface Builder to create your application’s user interface, you can use the Info window to easily add help tags to interface elements. Interface Builder stores this help tag content in the nib file, along with other information describing the objects in your application’s interface. When you unarchive an object with help content, the help tag is automatically attached to the user interface element using the appropriate Carbon Help Manager <code>HMSet...Content</code> call. These functions are described further in the section <span class="content_text"><a href="carbon_help_tasks.html#//apple_ref/doc/uid/20001325-3-CHDEFFJD">“Attaching a Help Tag Directly to a User Interface Element.”</a></span> For instructions on using Interface Builder to create your application’s user interface, choose Interface Builder Help from the Help menu in Interface Builder.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001325-3-DontLinkElementID_17" title="Note"></a><p><strong>Note:</strong>&nbsp; You can use Interface Builder to create help tags for controls, windows, and menu items. To create a help tag for a menu title, use the function <code>HMSetMenuItemHelpContent</code> to attach the help content directly to the menu title, or install a help tag callback.</p></div><p>You cannot specify expanded content for a help tag in Interface Builder. If you wish to create an expanded help tag for a user interface element, you must call the appropriate Carbon Help Manager function to attach the help content to the element, or you must install a help tag callback. </p><p>To create a help tag for a user interface element using Interface Builder, perform the following steps:</p><ol class="ol"><li class="li"><p>Select the user interface element in the Interface Builder window.</p></li><li class="li"><p>Open the Info window by choosing Show Info from the Tools menu, or by pressing Shift-Command-I.</p></li><li class="li"><p>Choose Help from the pop-up menu at the top of the Info window. <span class="content_text">Figure 3-1</span> shows the Info window after choosing Help.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001325-3-DontLinkElementID_18" title="Figure 2-1Help in the Info window"></a><p><a name="//apple_ref/doc/uid/20001325-3-CHDGGBEB" title="Figure 2-1Help in the Info window"></a><strong>Figure 2-1&nbsp;&nbsp;</strong>Help in the Info window</p><img src = "../art/help_in_inspector.gif" alt = "Help in the Info window" width="233" height="348"></div></li><li class="li"><p>Type the help tag message in the Text field.</p></li><li class="li"><p>Choose the location for the help tag from the Display Side pop-up menu. The locations listed in this pop-up menu are relative to the hot rectangle for the help tag. These locations correspond to the locations represented by the display location constants described in more detail in the section <span class="content_text"><a href="../carbon_help_concepts/carbon_help_concepts.html#//apple_ref/doc/uid/20001325-2-TPXREF104">“Display Location.”</a></span> <span class="content_text">Figure 3-2</span> shows the Info window with the Display Side pop-up menu open.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001325-3-DontLinkElementID_19" title="Figure 2-2Selecting the help tag location"></a><p><a name="//apple_ref/doc/uid/20001325-3-CHDGDAJE" title="Figure 2-2Selecting the help tag location"></a><strong>Figure 2-2&nbsp;&nbsp;</strong>Selecting the help tag location</p><img src = "../art/selecting_tag_location.gif" alt = "Selecting the help tag location" width="230" height="422"></div></li></ol><a name="//apple_ref/doc/uid/20001325-3-CHDEFFJD" title="Attaching a Help Tag Directly to a User Interface Element"></a><h2>Attaching a Help Tag Directly to a User Interface Element</h2><p>When you attach a help tag directly to a user interface element, the Carbon Help Manager displays and removes the help tag as necessary until you dispose of the interface element. To set the help tag content for a user interface element, you must</p><ul class="ul"><li class="li"><p>create a help tag structure describing the help tag content for the control, window, or menu item</p></li><li class="li"><p>attach the help tag to the control, window, or menu item using the appropriate Carbon Help Manager function</p></li></ul><p>The help tag is described by the <code>HMHelpContentRec</code> structure. Before attaching the tag to an item in your user interface, you must initialize an <code>HMHelpContentRec</code> structure with values for</p><ul class="ul"><li class="li"><p>the structure version</p></li><li class="li"><p>the tag’s hot rectangle</p></li><li class="li"><p>the location, relative to the hot rectangle, at which the tag is displayed</p></li><li class="li"><p>the help tag content</p></li></ul><p>You can use an empty rectangle for the hot rectangle and the Carbon Help Manager will substitute the current bounds of the interface element for the empty rectangle when the help tag is displayed.</p><p>Once you have created the help tag structure, you can attach it to the user interface element. To attach the help tag to a window or control, pass a pointer to your <code>HMHelpContentRec</code> structure and a reference to the window or the control to either the <code>HMSetControlHelpContent</code> or the <code>HMSetWindowHelpContent</code> function, respectively. To attach the tag to a menu item, pass a pointer to your help tag, a reference to the menu containing the item, and the index number of the menu item to the <code>HMSetMenuItemHelpContent</code> function. Passing a menu item index of zero to <code>HMSetMenuItemHelpContent</code> sets the help content for the menu title.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001325-3-DontLinkElementID_20" title="Note"></a><p><strong>Note:</strong>&nbsp; Attaching help content directly to a menu title with <code>HMSetMenuItemHelpContent</code> does not work in Mac OS X version 10.1 and earlier. See <span class="content_text"><a href="carbon_help_tasks.html#//apple_ref/doc/uid/20001325-3-CEGHBAAA">“Creating a Help Tag for a Menu Title in Versions of Mac OS X Prior to 10.2”</a></span> for a workaround.</p></div><p><span class="content_text">Listing 3-1</span> shows a function that creates a help tag structure and then attaches it to a window.</p><a name="//apple_ref/doc/uid/20001325-3-DontLinkElementID_21" title="Listing 2-1A function that creates a help tag and attaches it a window"></a><p class="codesample"><a name="//apple_ref/doc/uid/20001325-3-CIHJIBIH" title="Listing 2-1A function that creates a help tag and attaches it a window"></a><strong>Listing 2-1&nbsp;&nbsp;</strong>A function that creates a help tag and attaches it a window</p><div class="codesample"><table><tr><td scope="row"><pre>pascal OSStatus MyAttachHelpTag(WindowRef window)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    OSStatus status;<span></span></pre></td></tr><tr><td scope="row"><pre>    HMHelpContentRec helpTag;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    helpTag.version = kMacHelpVersion;<span>// 1</span></pre></td></tr><tr><td scope="row"><pre>    helpTag.tagSide = kHMDefaultSide;<span>// 2</span></pre></td></tr><tr><td scope="row"><pre>    SetRect (&amp;helpTag.absHotRect, 0, 0, 0, 0);<span>// 3</span></pre></td></tr><tr><td scope="row"><pre>    helpTag.content[kHMMinimumContentIndex].contentType = kHMCFStringLocalizedContent;<span>// 4</span></pre></td></tr><tr><td scope="row"><pre>    helpTag.content[kHMMinimumContentIndex].u.tagCFString = CFSTR("The help tag for the window.");<span>// 5</span></pre></td></tr><tr><td scope="row"><pre>    helpTag.content[kHMMaximumContentIndex].contentType = kHMNoContent;<span>// 6</span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    status =  HMSetWindowHelpContent(window, &amp;helpTag);<span>// 7</span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    return status;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Here’s what the function does:</p><ol class="ol"><li class="li"><p>Sets the <code>version</code> field of the help tag structure to the current structure version, represented by the <code>kMacHelpVersion</code> constant.</p></li><li class="li"><p>Sets the location at which the help tag is displayed. Use one of the display location constants in the <code>tagSide</code> field to represent the location of the help tag relative to the window’s absolute hot rectangle. The system default location, represented by the constant <code>kHMDefaultSide</code>, is centered horizontally below the hot rectangle.</p></li><li class="li"><p>Calls the QuickDraw function <code>SetRect</code> to set the hot rectangle for the help tag. The <code>MyAttachHelpTag</code> function sets the hot rectangle to an empty rectangle—that is, a rectangle with coordinates (0,0,0,0). The Carbon Help Manager substitutes the current location of the interface element—in this case, the window—for the empty rectangle when it displays the help tag.</p></li><li class="li"><p>Specifies the format for the help tag’s default, or minimum, content. All help tags should have minimum content, which is displayed by default when the user moves the pointer over the interface element. The function sets the <code>contentType</code> field for the default content to <code>kHMCFStringLocalizedContent</code>, indicating that the help tag message is a localized string contained in the <code>Localizable.strings</code> file.</p></li><li class="li"><p>Specifies the CFString key that the Carbon Help Manager should use when retrieving the localized help message. The Carbon Help Manager searches for this key in the <code>Localizable.strings</code> file for the appropriate language. If the key is found, the Carbon Help Manager displays the localized help text associated with the key in a help tag.</p></li><li class="li"><p>Specifies the format for the help tag’s expanded content. Expanded content—which is displayed when the user presses the Command key and moves the pointer over the window—is optional. In this case, the window has no expanded help tag content, so the function sets the <code>contentType</code> field of the expanded content to <code>kHMNoContent</code>.</p></li><li class="li"><p>Calls the Carbon Help Manager function <code>HMSetWindowHelpContent</code> to attach the help tag to the window.</p></li></ol><a name="//apple_ref/doc/uid/20001325-3-TPXREF102" title="Providing Help Tags With a Help Tag Callback"></a><h2>Providing Help Tags With a Help Tag Callback</h2><p>Help tag callbacks allow your application to provide dynamic help tag content, including content that can be determined only while your application is running and content that may change or vary while your application is running. When you install a help tag callback with a control, window, or menu, you do not supply help tag content for that user interface element until the help tag is about to be displayed to the user. For example, you might use callbacks if your help content is stored in an external database. Rather than reading in all help content at application startup and attaching it directly to elements of the interface, your callback can query the database for help tag content only as it is needed. </p><p>You may also use help tag callbacks to create context-sensitive help tags. When the Carbon Help Manager notifies you of a request for help tag content for an interface element, you can check the current state of that element and alter the help content accordingly.</p><p>The Carbon Help Manager defines help tag callback types for controls, windows, menu items, and menu titles. These are <code>HMControlContentProcPtr</code>, <code>HMWindowContentProcPtr</code>, <code>HMMenuItemContetProcPtr</code> and <code>HMMenuTitleContentProcPtr</code>, respectively. See the <em>Carbon Help Manager Reference</em> for a detailed description of these callback types.</p><p>The Carbon Help Manager invokes your help tag callback when the user hovers the pointer over the control, window, or menu to which the callback is attached. When it calls your help tag callback, the Carbon Help Manager passes the following information to your callback:</p><ul class="ul"><li class="li"><p>a reference to the user interface element for which to provide help tag content </p></li><li class="li"><p>a pointer, in the <code>ioHelpContent</code> parameter, to the help tag structure for the user interface element’s help tag</p></li><li class="li"><p>a constant, in the <code>inRequest</code> parameter, specifying the action that your callback should take</p></li></ul><p>Depending upon the value of the constant in the <code>inRequest</code> parameter, your help tag callback must either supply a help tag for the Carbon Help Manager to display, or release any memory used by the help tag content after the Carbon Help Manager has hidden the help tag.</p><a name="//apple_ref/doc/uid/20001325-3-CHDHCHHD" title="Installing a Help Tag Callback"></a><h3>Installing a Help Tag Callback</h3><p>To install your help tag callback, use the Carbon Help Manager functions <code>HMInstallControlContentCallback</code>, <code>HMInstallWindowContentCallback</code>, <code>HMInstallMenuItemContentCallback</code>, and <code>HMInstallMenuTitleContentCallback</code>. These functions install a help tag callback with a control, a window, a menu’s items, and a menu’s title, respectively. The installation functions take a universal procedure pointer (UPP) to your help tag callback and a reference to the user interface element—control, window, or menu—to which the callback should be attached. <span class="content_text">Listing 3-2</span> shows how to attach a help tag callback, described in the section <span class="content_text"><a href="carbon_help_tasks.html#//apple_ref/doc/uid/20001325-3-CEGCGGFF">“Supplying Help Tag Content With Callbacks,”</a></span> to a control. For a description of the <code>HMInstallControlContentCallback</code>, <code>HMInstallWindowContentCallback</code>, <code>HMInstallMenuItemContentCallback</code>, and <code>HMInstallMenuTitleContentCallback</code> functions, see the <em>Carbon Help Manager Reference</em>.</p><a name="//apple_ref/doc/uid/20001325-3-DontLinkElementID_22" title="Listing 2-2Installing a help tag callback with a control"></a><p class="codesample"><a name="//apple_ref/doc/uid/20001325-3-CHDGIGBJ" title="Listing 2-2Installing a help tag callback with a control"></a><strong>Listing 2-2&nbsp;&nbsp;</strong>Installing a help tag callback with a control</p><div class="codesample"><table><tr><td scope="row"><pre>pascal OSStatus MyInstallHelpTagCallback (WindowRef window)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    OSStatus status;<span></span></pre></td></tr><tr><td scope="row"><pre>    HMControlContentUPP controlHelpTagCallbackUPP;<span></span></pre></td></tr><tr><td scope="row"><pre>    ControlRef theControl;<span></span></pre></td></tr><tr><td scope="row"><pre>    ControlID theControlID = {kMyControlSig, kMyControlID};<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    status = GetControlByID(window, &amp;theControlID, &amp;theControl);<span>// 1</span></pre></td></tr><tr><td scope="row"><pre>    controlHelpTagCallbackUPP = NewHMControlContentUPP(MyControlHelpTagCallback);<span>// 2</span></pre></td></tr><tr><td scope="row"><pre>    status =  HMInstallControlContentCallback(theControl, controlHelpTagCallbackUPP);<span>// 3</span></pre></td></tr><tr><td scope="row"><pre>    return status;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Here’s what the code in <span class="content_text">Listing 3-2</span> does:</p><ol class="ol"><li class="li"><p>Calls the Control Manager function <code>GetControlByID</code> to retrieve a reference to the control to which to attach the help tag callback.</p></li><li class="li"><p>Calls the <code>NewHMControlContentUPP</code> function to create a universal procedure pointer to the help tag callback for the control.</p></li><li class="li"><p>Calls the <code>HMInstallControlContentCallback</code> function to associate the help tag callback with the control. </p></li></ol><p>You should dispose of any UPPs created by your application once the callback functions they refer to are no longer needed; for example, after your application has disposed of the user interface element associated with the help tag callback.</p><a name="//apple_ref/doc/uid/20001325-3-CEGCGGFF" title="Supplying Help Tag Content With Callbacks"></a><h3>Supplying Help Tag Content With Callbacks</h3><p>When the pointer pauses over a user interface element for which you have installed a help tag callback, the Carbon Help Manager calls your callback with the <code>kHMSupplyContent</code> request in the <code>inRequest</code> parameter. When your help tag callback receives this request, it must do the following:</p><ul class="spaceabove"><li class="li"><p>set the hot rectangle of the help tag, in the <code>absHotRect</code> field of the help tag structure</p></li><li class="li"><p>set the location, relative to the hot rectangle, of the help tag in the <code>tagSide</code> field of the help tag structure</p></li><li class="li"><p>set the help content for the specified user interface element in the <code>contents</code> field of the help tag structure</p></li><li class="li"><p>set the <code>outContentProvided</code> parameter to <code>kHMContentProvided</code></p></li><li class="li"><p>return <code>noErr</code></p></li></ul><p>After your callback returns, the Carbon Help Manager displays the help tag supplied by your callback. <span class="content_text">Listing 3-3</span> shows a help tag callback for a control. </p><a name="//apple_ref/doc/uid/20001325-3-DontLinkElementID_23" title="Listing 2-3A help tag callback for a control"></a><p class="codesample"><a name="//apple_ref/doc/uid/20001325-3-CHDEJDAJ" title="Listing 2-3A help tag callback for a control"></a><strong>Listing 2-3&nbsp;&nbsp;</strong>A help tag callback for a control</p><div class="codesample"><table><tr><td scope="row"><pre>pascal OSErr MyControlHelpTagCallback(ControlRef inControl,<span></span></pre></td></tr><tr><td scope="row"><pre>            Point inGlobalMouse, HMContentRequest inRequest,<span></span></pre></td></tr><tr><td scope="row"><pre>            HMContentProvidedType *outContentProvided,<span></span></pre></td></tr><tr><td scope="row"><pre>            HMHelpContentPtr ioHelpContent)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    OSErr status = noErr;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    if (inRequest == kHMSupplyContent) {<span>// 1</span></pre></td></tr><tr><td scope="row"><pre>        GrafPtr savePort;<span></span></pre></td></tr><tr><td scope="row"><pre>        ioHelpContent->version = kMacHelpVersion;<span></span></pre></td></tr><tr><td scope="row"><pre>        ioHelpContent->tagSide = kHMDefaultSide;<span>// 2</span></pre></td></tr><tr><td scope="row"><pre>        if (!QDSwapPort(GetWindowPort(GetControlOwner(inControl)), &amp;savePort)) savePort = NULL;<span>// 3</span></pre></td></tr><tr><td scope="row"><pre>        GetControlBounds(inControl, &amp;ioHelpContent->absHotRect);<span>// 4</span></pre></td></tr><tr><td scope="row"><pre>        LocalToGlobal((Point*)&amp;ioHelpContent->absHotRect.top);<span>// 5</span></pre></td></tr><tr><td scope="row"><pre>        LocalToGlobal((Point*)&amp;ioHelpContent->absHotRect.bottom);<span>// 6</span></pre></td></tr><tr><td scope="row"><pre>        if (savePort != NULL) SetPort(savePort);<span>// 7</span></pre></td></tr><tr><td scope="row"><pre>        ioHelpContent->content[kHMMinimumContentIndex].contentType = kHMCFStringContent;<span>// 8</span></pre></td></tr><tr><td scope="row"><pre>        ioHelpContent->content[kHMMinimumContentIndex].u.tagCFString = CFSTR("Turns help tags on or off.");<span>// 9</span></pre></td></tr><tr><td scope="row"><pre>        ioHelpContent->content[kHMMaximumContentIndex].contentType = kHMCFStringContent;<span>// 10</span></pre></td></tr><tr><td scope="row"><pre>        ioHelpContent->content[kHMMaximumContentIndex].u.tagCFString = CFSTR("Click to enable help tags.  This is the maximum content.");<span>// 11</span></pre></td></tr><tr><td scope="row"><pre>        *outContentProvided = kHMContentProvided;<span>// 12</span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    else if (inRequest == kHMDisposeContent) {<span>// 13</span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> return status;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Here’s what the help tag callback does:</p><ol class="ol"><li class="li"><p>Tests for the help content request. If the Carbon Help Manager makes the <code>kHMSupplyContent</code> request, then the callback provides help tag content.</p></li><li class="li"><p>Sets the location for the help tag. The <code>tagSide</code> field of the help tag structure passed to the callback in the <code>ioHelpContent</code> parameter identifies the location, relative to the absolute hot rectangle, at which the help tag is displayed.</p></li><li class="li"><p>Saves the current port. The Control Manager function <code>GetControlOwner</code> returns a reference to the window containing the control; the Window Manager function <code>GetWindowPort</code> returns a pointer to the color graphics port of this window. The QuickDraw function <code>QDSwapPort</code> sets the current color graphics port (<code>CGrafPort</code>) drawing environment to the window’s <code>CGrafPort</code> and returns a pointer to the previous <code>CGrafPort</code> in the <code>savePort</code> variable. If there was no previous <code>CGrafPort</code>, <code>savePort</code> is set to <code>NULL</code> so that it is not restored in step 7.</p></li><li class="li"><p>Sets the hot rectangle for the help tag to the current control bounds. The hot rectangle defines the area on screen over which the user must pause the pointer for the Carbon Help Manager to display the help tag. When the callback returns, the Carbon Help Manager verifies that the pointer is actually within the absolute hot rectangle before displaying the help tag. </p><p>In Mac OS X version 10.2 and later, you can provide an empty hot rectangle and the Carbon Help Manager will substitute the control’s current bounds before drawing the help tag. If you supply an empty hot rectangle, steps 3 and 5 through 7 are not necessary.</p></li><li class="li"><p>Calls the QuickDraw function <code>LocalToGlobal</code> to convert the coordinates of the hot rectangle’s top-left corner into global coordinates.</p></li><li class="li"><p>Calls the QuickDraw function <code>LocalToGlobal</code> to convert the coordinates of the hot rectangle’s bottom-right corner into global coordinates.</p></li><li class="li"><p>If the saved port is valid, restores the current graphics port to its previous state, as recorded in the <code>savePort</code> variable in step 3. </p></li><li class="li"><p>Sets the format for the help tag’s default, or minimum, content. The help tag content for the control is a <code>CFString</code> object, so the callback sets the <code>contentType</code> field to <code>kHMCFStringContent</code>. </p></li><li class="li"><p>Sets the default help tag content. The <code>CFSTR</code> macro creates a constant <code>CFString</code> containing the help text.</p></li><li class="li"><p>Sets the format for the help tag’s expanded, or maximum, content. Again, the content is a <code>CFString</code> object, represented by the <code>kHMCFStringContent</code> constant.</p></li><li class="li"><p>Sets the expanded help tag content. </p></li><li class="li"><p>Sets the <code>outContentProvided</code> parameter to <code>kHMContentProvided</code>. This notifies the Carbon Help Manager that the callback has fulfilled the content request by supplying help tag content.</p></li><li class="li"><p>Handles the <code>kHMDisposeContent</code> request. Before removing the help tag from the screen, the Carbon Help Manager gives your application the opportunity to perform any necessary cleanup on help tag content provided by your callback, such as releasing memory. Your application would perform this cleanup when it receives the <code>kHMDisposeContent</code> request. In this case, the help tag content is constant and there is nothing to clean up.</p></li></ol><p>If your help tag callback is unable to supply help tag content for the specified user interface element, your help tag callback should return <code>kHMContentNotProvided</code> or <code>kHMContentNotProvidedDontPropagate</code> in the <code>outContentProvided</code> parameter. When the Carbon Help Manager receives either of these constants, it ignores the values returned by your callback in all other parameters. </p><p>If your help tag callback returns the constant <code>kHMContentNotProvided</code>, the Carbon Help Manager next checks whether any help tag content is attached directly to the interface element. If content exists, the Carbon Help Manager displays it in a help tag. If no content is found and the interface element in question is a window, menu item, or menu title, the Carbon Help Manager assumes that no help content is available for that element. If, on the other hand, the object is a control, the Carbon Help Manager searches for help tag content further up the control embedding hierarchy. The Carbon Help Manager requests help content from the next control up the hierarchy, checking first for a help tag callback and then for content directly attached to the control. The Carbon Help Manager continues to propagate the request until it reaches the top of the embedding hierarchy, finds help tag content, or is instructed not to propagate the request. You instruct the Carbon Help Manager not to propagate the request for help tag content by returning the constant <code>kHMContentNotProvidedDontPropagate</code> in the <code>outContentProvided</code> parameter.</p><a name="//apple_ref/doc/uid/20001325-3-TPXREF103" title="Disposing of Help Tag Content"></a><h3>Disposing of Help Tag Content</h3><p>The Carbon Help Manager automatically removes the help tag supplied by your help tag callback from the screen when user input occurs. Before it disposes of the help tag, the Carbon Help Manager calls your help tag callback with the <code>kHMDisposeContent</code> request in the <code>inRequest</code> parameter. When your help tag callback receives this request, it should release any memory allocated for the help tag in the <code>ioHelpContent</code> parameter. See <span class="content_text"><a href="carbon_help_tasks.html#//apple_ref/doc/uid/20001325-3-CHDEJDAJ">Listing 3-3</a></span> for an example of a help tag callback for a control.</p><a name="//apple_ref/doc/uid/20001325-3-TPXREF104" title="Displaying a Help Tag at an Application-Defined Location"></a><h2>Displaying a Help Tag at an Application-Defined Location</h2><p>The Carbon Help Manager also provides the <code>HMDisplayTag</code> and <code>HMHideTag</code> functions, which allow you to explicitly display and hide help tags. For example, you can use <code>HMDisplayTag</code> to display a help tag that is not associated with a control, window, menu item, or menu title. The Finder displays a help tag in this way when the user pauses with the pointer over a truncated filename. <span class="content_text">Figure 3-3</span> shows an example of the help tag used by the Finder to display the full filename.</p><br/><div><a name="//apple_ref/doc/uid/20001325-3-DontLinkElementID_24" title="Figure 2-3A help tag explicitly displayed by the Finder"></a><p><a name="//apple_ref/doc/uid/20001325-3-CHDCEACH" title="Figure 2-3A help tag explicitly displayed by the Finder"></a><strong>Figure 2-3&nbsp;&nbsp;</strong>A help tag explicitly displayed by the Finder</p><img src = "../art/tag_in_finder.gif" alt = "A help tag explicitly displayed by the Finder" width="503" height="345"></div><br/><p>When you display a help tag using <code>HMDisplayTag</code>, you are responsible for tracking the mouse and determining when the user has moved the pointer over an object for which it is appropriate to display a help tag. You must initialize the help tag structure with the same information described in <span class="content_text"><a href="carbon_help_tasks.html#//apple_ref/doc/uid/20001325-3-CHDEFFJD">“Attaching a Help Tag Directly to a User Interface Element.”</a></span> However, you must provide a hot rectangle defining the onscreen area with which the tag is associated; you cannot supply an empty rectangle in the <code>absHotRect</code> field of the help tag structure. </p><p>You are not required to call <code>HMHideTag</code> to hide a tag displayed with <code>HMDisplayTag</code>; the Carbon Help Manager automatically removes the help tag from the screen when user input occurs.</p><a name="//apple_ref/doc/uid/20001325-3-CEGHBAAA" title="Creating a Help Tag for a Menu Title in Versions of Mac OS X Prior to 10.2"></a><h2>Creating a Help Tag for a Menu Title in Versions of Mac OS X Prior to 10.2</h2><p>In versions of Mac OS X prior to Mac OS X 10.2, the Carbon Help Manager does not display menu title help tags correctly. If you set help tag content for a menu title by calling <code>HMSetMenuItemHelpContent</code> with a menu item index of zero and an empty rectangle for the hot rectangle, the Carbon Help Manager does not correctly translate the empty rectangle into the current bounds of the menu title, and no help tag is displayed. To provide menu title help tag content in Mac OS X 10.1.x and earlier, use <code>HMInstallMenuTitleContentCallback</code> to register a help tag callback for the menu title. </p><p>Because the Carbon Help Manager does not correctly interpret an empty rectangle to mean the current location of the menu title, your callback must supply the correct hot rectangle for the menu title tag. However, there is no function for determining the current bounds of a menu title. As a workaround, you can get the current pointer position and initialize the <code>absHotRect</code> field with a rectangle surrounding the current pointer position.</p><a name="//apple_ref/doc/uid/20001325-3-DontLinkElementID_25" title="Listing 2-4A help tag callback for a menu title in Mac OS X 10.1.x and earlier"></a><p class="codesample"><a name="//apple_ref/doc/uid/20001325-3-TPXREF105" title="Listing 2-4A help tag callback for a menu title in Mac OS X 10.1.x and earlier"></a><strong>Listing 2-4&nbsp;&nbsp;</strong>A help tag callback for a menu title in Mac OS X 10.1.x and earlier</p><div class="codesample"><table><tr><td scope="row"><pre>pascal OSStatus MyMenuTitleContentCallback(<span></span></pre></td></tr><tr><td scope="row"><pre>            MenuRef inMenu, HMContentRequest inRequest,<span></span></pre></td></tr><tr><td scope="row"><pre>            HMContentProvidedType *outContentProvided,<span></span></pre></td></tr><tr><td scope="row"><pre>            HMHelpContentPtr ioHelpContent)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    if (inRequest == kHMSupplyContent)<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>        CFStringRef title;<span></span></pre></td></tr><tr><td scope="row"><pre>        Point mouse;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        ioHelpContent->version = kMacHelpVersion;<span></span></pre></td></tr><tr><td scope="row"><pre>        ioHelpContent->tagSide = kHMDefaultSide;<span></span></pre></td></tr><tr><td scope="row"><pre>        GetGlobalMouse(&amp;mouse);<span></span></pre></td></tr><tr><td scope="row"><pre>        SetRect(&amp;ioHelpContent->absHotRect, mouse.h - 5, mouse.v - 5, mouse.h + 5, mouse.v +5);<span></span></pre></td></tr><tr><td scope="row"><pre>        CopyMenuTitleAsCFString(inMenu, &amp;title);<span></span></pre></td></tr><tr><td scope="row"><pre>        ioHelpContent->content[kHMMinimumContentIndex].contentType = kHMCFStringContent;<span></span></pre></td></tr><tr><td scope="row"><pre>        ioHelpContent->content[kHMMinimumContentIndex].u.tagCFString = CFCopyLocalizedString(title, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>        CFRelease(title);<span></span></pre></td></tr><tr><td scope="row"><pre>        ioHelpContent->content[kHMMaximumContentIndex].contentType = kHMNoContent;<span></span></pre></td></tr><tr><td scope="row"><pre>        *outContentProvided = kHMContentProvided;<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    else if (inRequest == kHMDisposeContent)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>if (ioHelpContent->content[kHMMinimumContentIndex].contentType == kHMCFStringContent)<span></span></pre></td></tr><tr><td scope="row"><pre>    CFRelease(ioHelpContent-> content[kHMMinimumContentIndex].u.tagCFString);<span></span></pre></td></tr><tr><td scope="row"><pre>if (ioHelpContent->content[kHMMaximumContentIndex].contentType == kHMCFStringContent)<span></span></pre></td></tr><tr><td scope="row"><pre>    CFRelease(ioHelpContent-> content[kHMMaximumContentIndex].u.tagCFString);<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre>return noErr;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr></table></div><p>Here is what the callback does:</p><ol class="ol"><li class="li"><p>Tests for the Carbon Help Manager request. To handle the <code>kHMSupplyContent</code> request, the callback must supply a help tag for the menu title.</p></li><li class="li"><p>Sets the structure version to the current version.</p></li><li class="li"><p>Sets the display location for the help tag to the default display location.</p></li><li class="li"><p>Calls the Event Manager function <code>GetGlobalMouse</code> to get the current location of the pointer in global screen coordinates. This location is used to construct the hot rectangle for the menu title help tag.</p></li><li class="li"><p>Calls the QuickDraw function <code>SetRect</code> to create the hot rectangle for the help tag. Because there is no function for retrieving the current bounds of a menu title, the callback creates a rectangle around the pointer’s current position.</p></li><li class="li"><p>Calls the Menu Manager function <code>CopyMenuTitleAsCFString</code> to retrieve the menu title.</p></li><li class="li"><p>Sets the format type for the help tag’s default content. In this case, the help tag content is a <code>CFString</code> object.</p></li><li class="li"><p>Sets the default content for the help tag. The Core Foundation Bundle Services function <code>CFCopyLocalizedString</code> retrieves the help string from the <code>Localizable.strings</code> file, using the menu title as the key.</p></li><li class="li"><p>Calls the Core Foundation Base Services function <code>CFRelease</code> to release the memory associated with the <code>CFString</code> object containing the menu title.</p></li><li class="li"><p>Sets the expanded content for the help tag. In this case, there is no expanded content.</p></li><li class="li"><p>Notifies the Carbon Help Manager that help tag content has been supplied.</p></li><li class="li"><p> Handles the Carbon Help Manager’s request to dispose of help tag content.</p></li><li class="li"><p>Tests for <code>CFString</code> content in the help tag structure. If any exists, the callback calls <code>CFRelease</code> to release the memory associated with the content.</p></li></ol>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../carbon_help_concepts/carbon_help_concepts.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../revision_history/revision_history.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2002 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2002-07-01<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Carbon/Conceptual/ProvidingHelpTags/carbon_help_tasks/carbon_help_tasks.html%3Fid%3D20001325-2.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Carbon/Conceptual/ProvidingHelpTags/carbon_help_tasks/carbon_help_tasks.html%3Fid%3D20001325-2.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Carbon/Conceptual/ProvidingHelpTags/carbon_help_tasks/carbon_help_tasks.html%3Fid%3D20001325-2.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>