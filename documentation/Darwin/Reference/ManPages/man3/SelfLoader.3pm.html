<html><head><title>Mac OS X
 Manual Page For SelfLoader(3pm)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/3pm/SelfLoader" title="Mac OS X
 Manual Page for SelfLoader(3pm)"><a name="//apple_ref/doc/man/3/SelfLoader" title="Mac OS X
 Manual Page for SelfLoader(3pm)"><!-- headerDoc=man; indexgroup=Section 3pm; uid="//apple_ref/doc/man/3pm/SelfLoader"; name=SelfLoader(3pm) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
SelfLoader(3pm)                       Perl Programmers Reference Guide                       SelfLoader(3pm)



<b>NAME</b>
       SelfLoader - load functions only on demand

<b>SYNOPSIS</b>
           package FOOBAR;
           use SelfLoader;

           ... (initializing code)

           __DATA__
           sub {....

<b>DESCRIPTION</b>
       This module tells its users that functions in the FOOBAR package are to be autoloaded from after the
       "__DATA__" token.  See also "Autoloading" in perlsub.

       <b>The</b> <b>__DATA__</b> <b>token</b>

       The "__DATA__" token tells the perl compiler that the perl code for compilation is finished. Every-<font color="#ffffff" class="whiteout">thing&nbsp;Everything</font>
       thing after the "__DATA__" token is available for reading via the filehandle FOOBAR::DATA, where FOO-<font color="#ffffff" class="whiteout">BAR&nbsp;FOOBAR</font>
       BAR is the name of the current package when the "__DATA__" token is reached. This works just the same
       as "__END__" does in package 'main', but for other modules data after "__END__" is not automatically
       retrievable, whereas data after "__DATA__" is.  The "__DATA__" token is not recognized in versions of
       perl prior to 5.001m.

       Note that it is possible to have "__DATA__" tokens in the same package in multiple files, and that
       the last "__DATA__" token in a given package that is encountered by the compiler is the one accessi-<font color="#ffffff" class="whiteout">ble&nbsp;accessible</font>
       ble by the filehandle. This also applies to "__END__" and main, i.e. if the 'main' program has an
       "__END__", but a module 'require'd (_not_ 'use'd) by that program has a 'package main;' declaration
       followed by an '"__DATA__"', then the "DATA" filehandle is set to access the data after the
       "__DATA__" in the module, _not_ the data after the "__END__" token in the 'main' program, since the
       compiler encounters the 'require'd file later.

       <b>SelfLoader</b> <b>autoloading</b>

       The <b>SelfLoader</b> works by the user placing the "__DATA__" token <u>after</u> perl code which needs to be com-<font color="#ffffff" class="whiteout">piled&nbsp;compiled</font>
       piled and run at 'require' time, but <u>before</u> subroutine declarations that can be loaded in later -<font color="#ffffff" class="whiteout">usually&nbsp;laterusually</font>
       usually because they may never be called.

       The <b>SelfLoader</b> will read from the FOOBAR::DATA filehandle to load in the data after "__DATA__", and
       load in any subroutine when it is called. The costs are the one-time parsing of the data after
       "__DATA__", and a load delay for the _first_ call of any autoloaded function. The benefits (hope-<font color="#ffffff" class="whiteout">fully)&nbsp;(hopefully)</font>
       fully) are a speeded up compilation phase, with no need to load functions which are never used.

       The <b>SelfLoader</b> will stop reading from "__DATA__" if it encounters the "__END__" token - just as you
       would expect.  If the "__END__" token is present, and is followed by the token DATA, then the <b>Self</b>-<font color="#ffffff" class="whiteout">Loader&nbsp;SelfLoader</font>
       <b>Loader</b> leaves the FOOBAR::DATA filehandle open on the line after that token.

       The <b>SelfLoader</b> exports the "AUTOLOAD" subroutine to the package using the <b>SelfLoader</b>, and this loads
       the called subroutine when it is first called.

       There is no advantage to putting subroutines which will _always_ be called after the "__DATA__"
       token.

       <b>Autoloading</b> <b>and</b> <b>package</b> <b>lexicals</b>

       A 'my $pack_lexical' statement makes the variable $pack_lexical local _only_ to the file up to the
       "__DATA__" token. Subroutines declared elsewhere _cannot_ see these types of variables, just as if
       you declared subroutines in the package but in another file, they cannot see these variables.

       So specifically, autoloaded functions cannot see package lexicals (this applies to both the <b>Self</b>-<font color="#ffffff" class="whiteout">Loader&nbsp;SelfLoader</font>
       <b>Loader</b> and the Autoloader).  The "vars" pragma provides an alternative to defining package-level
       globals that will be visible to autoloaded routines. See the documentation on <b>vars</b> in the pragma sec-<font color="#ffffff" class="whiteout">tion&nbsp;section</font>
       tion of perlmod.

       <b>SelfLoader</b> <b>and</b> <b>AutoLoader</b>

       The <b>SelfLoader</b> can replace the AutoLoader - just change 'use AutoLoader' to 'use SelfLoader' (though
       note that the <b>SelfLoader</b> exports the AUTOLOAD function - but if you have your own AUTOLOAD and are
       using the AutoLoader too, you probably know what you're doing), and the "__END__" token to
       "__DATA__". You will need perl version 5.001m or later to use this (version 5.001 with all patches up
       to patch m).

       There is no need to inherit from the <b>SelfLoader</b>.

       The <b>SelfLoader</b> works similarly to the AutoLoader, but picks up the subs from after the "__DATA__"
       instead of in the 'lib/auto' directory.  There is a maintenance gain in not needing to run AutoSplit
       on the module at installation, and a runtime gain in not needing to keep opening and closing files to
       load subs. There is a runtime loss in needing to parse the code after the "__DATA__". Details of the
       <b>AutoLoader</b> and another view of these distinctions can be found in that module's documentation.

       <b>__DATA__,</b> <b>__END__,</b> <b>and</b> <b>the</b> <b>FOOBAR::DATA</b> <b>filehandle.</b>

       This section is only relevant if you want to use the "FOOBAR::DATA" together with the <b>SelfLoader</b>.

       Data after the "__DATA__" token in a module is read using the FOOBAR::DATA filehandle. "__END__" can
       still be used to denote the end of the "__DATA__" section if followed by the token DATA - this is
       supported by the <b>SelfLoader</b>. The "FOOBAR::DATA" filehandle is left open if an "__END__" followed by a
       DATA is found, with the filehandle positioned at the start of the line after the "__END__" token. If
       no "__END__" token is present, or an "__END__" token with no DATA token on the same line, then the
       filehandle is closed.

       The <b>SelfLoader</b> reads from wherever the current position of the "FOOBAR::DATA" filehandle is, until
       the EOF or "__END__". This means that if you want to use that filehandle (and ONLY if you want to),
       you should either

       1. Put all your subroutine declarations immediately after the "__DATA__" token and put your own data
       after those declarations, using the "__END__" token to mark the end of subroutine declarations. You
       must also ensure that the <b>SelfLoader</b> reads first by  calling 'SelfLoader-&gt;<u>load</u><b>_</b><u>stubs()</u>;', or by using
       a function which is selfloaded;

       or

       2. You should read the "FOOBAR::DATA" filehandle first, leaving the handle open and positioned at the
       first line of subroutine declarations.

       You could conceivably do both.

       <b>Classes</b> <b>and</b> <b>inherited</b> <b>methods.</b>

       For modules which are not classes, this section is not relevant.  This section is only relevant if
       you have methods which could be inherited.

       A subroutine stub (or forward declaration) looks like

         sub stub;

       i.e. it is a subroutine declaration without the body of the subroutine. For modules which are not
       classes, there is no real need for stubs as far as autoloading is concerned.

       For modules which ARE classes, and need to handle inherited methods, stubs are needed to ensure that
       the method inheritance mechanism works properly. You can load the stubs into the module at 'require'
       time, by adding the statement 'SelfLoader-&gt;<u>load</u><b>_</b><u>stubs()</u>;' to the module to do this.

       The alternative is to put the stubs in before the "__DATA__" token BEFORE releasing the module, and
       for this purpose the "Devel::SelfStubber" module is available.  However this does require the extra
       step of ensuring that the stubs are in the module. If this is done I strongly recommend that this is
       done BEFORE releasing the module - it should NOT be done at install time in general.

<b>Multiple</b> <b>packages</b> <b>and</b> <b>fully</b> <b>qualified</b> <b>subroutine</b> <b>names</b>
       Subroutines in multiple packages within the same file are supported - but you should note that this
       requires exporting the "SelfLoader::AUTOLOAD" to every package which requires it. This is done auto-<font color="#ffffff" class="whiteout">matically&nbsp;automatically</font>
       matically by the <b>SelfLoader</b> when it first loads the subs into the cache, but you should really spec-<font color="#ffffff" class="whiteout">ify&nbsp;specify</font>
       ify it in the initialization before the "__DATA__" by putting a 'use SelfLoader' statement in each
       package.

       Fully qualified subroutine names are also supported. For example,

          __DATA__
          sub foo::bar {23}
          package baz;
          sub dob {32}

       will all be loaded correctly by the <b>SelfLoader</b>, and the <b>SelfLoader</b> will ensure that the packages
       'foo' and 'baz' correctly have the <b>SelfLoader</b> "AUTOLOAD" method when the data after "__DATA__" is
       first parsed.



perl v5.8.8                                      2001-09-21                                  SelfLoader(3pm)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man3/SelfLoader.3pm.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man3/SelfLoader.3pm.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man3/SelfLoader.3pm.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
