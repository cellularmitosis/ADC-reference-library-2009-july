<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>GetAppParms (IM: F)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING67></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Files-66.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-68.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Files-2.html"><B>Files</B></A> / <BR><DD><A HREF="Files-12.html"><B>Chapter 1 - Introduction to File Management</B></A> / <A HREF="Files-32.html"><B>File Management Reference</B></A><BR><DL><DD><A HREF="Files-66.html"><B>Application Launch File Routines</B></A> / <A HREF="Files-63.html"><B></B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING67-0></A>
<H3><A NAME=MARKER-11-335></A>GetAppParms<A NAME=MARKER-9-264></A></H3>
 You can use the <CODE>GetAppParms</CODE> procedure to get information about the current application and about files selected by the user for opening or printing.<P>
<PRE>
PROCEDURE GetAppParms(VAR apName: Str255; VAR apRefNum: Integer;
                      VAR apParam: Handle);
</PRE>
<DL>
<DT><CODE>apName</CODE>
<DD> On output, the name of the calling application.
<DT><CODE>apRefNum</CODE>
<DD> On output, the reference number of the application's resource file.
<DT><CODE>apParam</CODE>
<DD> On output, a handle to the Finder information about files to open or print.
</DL>
<A NAME=HEADING67-6></A>
<H5>DESCRIPTION</H5>
 The <CODE>GetAppParms</CODE> procedure returns information about the current application. You can call <CODE>GetAppParms</CODE> at application launch time to determine which files, if any, the user has selected in the Finder for opening or printing. You can call <CODE>GetAppParms</CODE> at any time to determine the current application's name and the reference number of the application's resource fork.<P>
 The <CODE>GetAppParms</CODE> procedure returns the application's name in the <CODE>apName</CODE> parameter and the reference number of its resource fork in the <CODE>apRefNum</CODE> parameter. A handle to the Finder information is returned in <CODE>apParam</CODE>. This information consists of a word that encodes the message or action to be performed, a word that indicates how many files to process, and a list of Finder information about each such file. The Finder information has the structure of an <CODE>AppFile</CODE> record, except that the filename occupies only as many bytes as are required to hold the name (padded to an even number of bytes, if necessary). In general, it is easier to use the <CODE>GetAppFiles</CODE> procedure to access the Finder information.<P>
<A NAME=HEADING67-9></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 If you simply want to determine the application's resource file reference number, you can call the Resource Manager function <CODE>CurResFile</CODE> when your application starts up.<P>
 If you need more extensive information about the application than <CODE>GetAppParms</CODE> provides, you can use the Process Manager function <CODE>GetCurrentProcess</CODE>.<P>
<A NAME=HEADING67-12></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 You can get the application's name, reference number, and handle to the Finder information directly from the global variables <CODE>CurApName</CODE>, <CODE>CurApRefNum</CODE>, and <CODE>AppParmHandle</CODE>.<A NAME=MARKER-2-185></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Files-66.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-68.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Files-3.html">&copy; Apple Computer, Inc.</A><br>2 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
