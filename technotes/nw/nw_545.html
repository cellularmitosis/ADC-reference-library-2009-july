<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note NW545: Link Access Protocol Q&amp;As</title><meta name="keywords" content=""><meta name="Description" content="Technical Note NW545: ">    <meta name="categories" content="Networking"><meta name="week-posted" content="Oct 1, 1990 - Oct 5, 1990"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF" TEXT="#000000"><a name="//apple_ref/doc/uid/DTS10002579" title="Link Access Protocol Q&As"></a><a name="top"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxNetworking-date.html">Networking</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/Networking/index.html" target="_blank">Reference Library > Networking</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note NW545</div>
<div id="pageheadsub">Link Access Protocol Q&amp;As</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->					<p id="menutext">					<a href="#Section1">AppleTalk and VBL task using self-send mode</a><BR><BR>					<a href="#Section2">How to tell if LAP Manager is present</a><BR><BR>					<a href="#Section3">AppleTalk AOpen and AClose codes 7 &amp; 8</a><BR><BR>					<a href="#Downloads">Downloadables</a></p>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">This Technical Note contains a collection of archived Q&amp;As relating to a specifictopic--questions sent the Developer Support Center (DSC) along withanswers from the DSC engineers. Current Q&amp;A's can be found on the <a href="../../qa/index.html">Macintosh Technical Q&amp;A's web site</a>.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Oct 01 1990]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR><!-- begin_content --><a name="Section1"></a><h2>AppleTalk and VBL task using self-send mode</h2><p>Date Written:  5/18/92</p><p>Last reviewed:  6/14/93</p><p>To make all AppleTalk calls asynchronously, I have to split the VBL task inpieces:</p><ul type="disc">	<li><code>Setselfsend</code></li>	<li>check its async finish</li>	<li><code>StartLookup</code></li>	<li>check its async finish</li>	<li><code>Restoreselfsend</code></li>	<li>check its async finish</li></ul><p>This means that while the selfsend is set to true, other software will beconfused when they do a lookup. Also, when the Macintosh is doing I/O on thenetwork, the VBL will set and restore the selfsend flag. Will other AppleTalkcalls fail if the SelfSend flag Is set to true, or does selfsend only work on<code>PLookupName</code>?</p><p>Your method of splitting up the steps of a lookup to yourself during a VBL taskusing self-send mode is correct, except you needn't bother restoring the stateof self-send since you are giving up time to other processes between calls toyour VBL task.</p><p>Self-send mode is a global setting and may affect any AppleTalk calls. When theLAP manager is preparing to send a packet, it checks the destination node. Ifthe destination node is its own node address or the broadcast address, then itsends the packet to itself before putting the packet out on the wire. Thisusually only affects NBP lookup packets because they are sent to the broadcastaddress. Most other AppleTalk protocols do not broadcast.</p><p>Programs using self-send should follow these guidelines:</p><ul type="disc">	<li>If self-send is only needed for a brief period of time, then you should turn self-send on with <code>PSetSelfSend</code> (saving the current setting returned in <code>oldSelfFlag</code>), make the call(s) that require self-send, and then restore self-send to its previous state.</li>	<li>If self-send is needed for an extended period of time (for example, for the life of your application) where your program will give up time to other programs, then you should turn self-send on and leave it on (don't restore it to its previous state). Since other programs running on your system (that aren't well behaved) may turn off self-send at any time, programs that require self-send mode should periodically call <code>PSetSelfSend</code> to make sure self-send stays on. Apple's system software has no compatibility problems with self-send - that is, it doesn't care if it's on or off - so leaving it on won't hurt anything.</li></ul><a name="Section2"></a><P><A HREF="#top">Back to top</A></P><h2>How to tell if LAP Manager is present</h2><p>Date Written:  12/12/91</p><p>Last reviewed:  2/3/92</p><p>What's the recommended technique for telling whether the user has turned offAppleTalk?</p><p>The best way to determine whether AppleTalk has been turned off is to use theAppleTalk Transition Queue to alert you to .MPP closures. (This is one of thereasons why the AppleTalk Transition Queue was implemented.) The AppleTalkTransition Queue is available only in AppleTalk version 53 or later, and isdocumented in the AppleTalk chapter of <i>Inside Macintosh</i> Volume VI,starting on page 32-17. There's also a code snippet, Transition Queue, in theSnippets folder on the <i>Developer CD Series</i> disc.</p><a name="Section3"></a><P><A HREF="#top">Back to top</A></P><h2>AppleTalk AOpen and AClose codes 7 &amp; 8</h2><p>Date Written:  11/1/91</p><p>Last reviewed:  11/27/91</p><p>What are AppleTalk messages 7 and 8? They're documented in lapequ.a as:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    AOpen      EQU         7       ; Open an ATlk</pre>	</TD></TR></TABLE></CENTER><p>but what should the adev do with them and what parameters are passed?</p><p>The <code>AOpen</code> and <code>AClose</code> messages are sent when the .MPP driver is opened andclosed, respectively. When the AppleTalk driver is closed, a shutdown messageis not sent. Instead, the LAP Manager determines whether an adev is version 3or greater and, if true, assumes that the adev can respond to the AClosemessage and sends the message. Conversely, when the .MPP driver is re-openedwhile the adev is active, the AOpen message is sent to the adev (assuming thatthe adev is version 3 or greater).</p><p>An important note on this matter is that if you modify your adev to version 3,additional selectors must be supported. These new selectors will be documentedin a forthcoming Technote.</p><P><A HREF="#top">Back to top</A></P><P><A NAME=Downloads></A></P>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (48K)</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/nw_545.pdf">Download</A></P>               </TD>            </TR>                     </TABLE>         <BR>         <P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/nw/nw_545.html%3Fid%3DDTS10002579-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/nw/nw_545.html%3Fid%3DDTS10002579-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/nw/nw_545.html%3Fid%3DDTS10002579-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>