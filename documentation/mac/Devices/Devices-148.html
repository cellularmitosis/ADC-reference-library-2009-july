<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>SCSIComplete(IM: D)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING148></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->




<!-- Main Body -->

<CENTER>
<P>
<A HREF="Devices-147.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Devices-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Devices-328.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Devices-149.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Devices-2.html"><B>Devices</B></A> / <BR><DD><A HREF="Devices-119.html"><B>Chapter 3 - SCSI Manager</B></A> / <A HREF="Devices-123.html"><B>SCSI Manager Reference</B></A><BR><DL><DD><A HREF="Devices-136.html"><B>SCSI Manager Routines</B></A> / <A HREF="Devices-126.html"><B></B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING148-0></A>
<H3><A NAME=MARKER-9-178></A>SCSIComplete</H3>
 <A NAME=MARKER-2-179></A>You use the <CODE>SCSIComplete</CODE> function to complete a SCSI transaction.<P>
<PRE>
FUNCTION SCSIComplete(VAR stat: Integer; VAR message: Integer; 
                      wait: LongInt): OSErr;
</PRE>
<DL>
<DT><CODE>stat</CODE>
<DD> The low-order byte contains the status byte from the target device.
<DT><CODE>message</CODE>
<DD> The low-order byte contains the message byte from the target device.
<DT><CODE>wait</CODE>
<DD> The number of ticks to wait for the command to complete.
</DL>
<A NAME=HEADING148-6></A>
<H5>DESCRIPTION</H5>
 The <CODE>SCSIComplete</CODE> function performs the tasks necessary to properly complete the current SCSI transaction and leave the bus in the bus free phase. This function must be called at the end of each SCSI transaction, even if the transaction does not complete successfully. <P>
 The <CODE>SCSIComplete</CODE> function waits for the transaction to complete, and then returns one byte of status information and one byte of message information. If the transaction fails to complete within the number of ticks specified by the <CODE>wait</CODE> parameter, the scCommErr result is returned. <P>
 The <CODE>SCSIComplete</CODE> function uses a number of strategies to correct anomalous conditions on the SCSI bus and restore the bus into a known state. These include accepting arbitrary amounts of data sent by the target (and throwing this data away), and sending arbitrary data (bytes with the value of $EE) as requested by the target. The function returns the scComplPhaseErr result if either of these steps were necessary.<P>
<A NAME=HEADING148-10></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The trap macro and routine selector for <CODE>SCSIComplete</CODE> are
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Trap macro<TH>Selector<TR>
<TD>_SCSIDispatch<TD>$0004</TABLE>
<P>
<A NAME=HEADING148-12></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>scCommErr<TD>2<TD>Communications error, operation timeout<TR>
<TD>scPhaseErr<TD><B>X</B><TD>Phase error on the SCSI bus<TR>
<TD>scComplPhaseErr<TD>10<TD>SCSI bus was not in status phase on entry to <CODE>SCSIComplete</CODE></TABLE>
</H5>
<A NAME=HEADING148-13></A>
<H5>SEE ALSO</H5>
 See <A HREF=Devices-122.html#MARKER-9-59>"Using the SCSIComplete Function," beginning on page 3-21</A>, for more information about this function.<A NAME=MARKER-2-180></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Devices-147.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Devices-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Devices-328.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Devices-149.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Devices-3.html">&copy; Apple Computer, Inc.</A><br>3 JUL 1996</center></font><P>
<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->
</BODY>
</HTML>  
