<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>VisibleLength(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING169></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-168.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-170.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-126.html"><B>Chapter 3 - QuickDraw Text</B></A> / <A HREF="Text-143.html"><B>QuickDraw Text Reference</B></A><BR><DL><DD><A HREF="Text-147.html"><B>Routines</B></A> / <A HREF="Text-167.html"><B>Laying Out a Line of Text</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING169-0></A>
<H3>VisibleLength</H3>
 The <A NAME=MARKER-2-372></A><CODE>VisibleLength</CODE> function calculates the length in bytes of a given text segment, excluding trailing white space.<P>
<PRE>
FUNCTION VisibleLength (textPtr: Ptr; 
                        textLength: LongInt): LongInt;
</PRE>
<DL>
<DT><CODE>textPtr</CODE>
<DD> A pointer to a text string.
<DT><CODE>textLength</CODE>
<DD> The number of bytes in the text segment.
</DL>
<A NAME=HEADING169-5></A>
<H5>DESCRIPTION</H5>
 The <CODE>VisibleLength</CODE> function determines how much of a style run to display, without displaying trailing spaces. You call <CODE>VisibleLength</CODE> for the last style run of a line <I>in memory order</I>. The last style run in memory order of the text constituting the line is not always the last style run in display order. For a line of unidirectional left-to-right text, the last style run in memory order is the rightmost style run in display order. For a line of unidirectional right-to-left text, the last style run in memory order is the leftmost style run in display order. However, if the text contains mixed directions, the last style run in memory order may be an interior style run in display order.<P>
 The text justification routines do not automatically exclude trailing spaces, so you pass them the value that <CODE>VisibleLength</CODE> returns as the length of the last style run in memory order.<P>
 The <CODE>VisibleLength</CODE> function behaves differently for various script systems.<P>
<UL>
<LI>For simple script systems, such as Roman and Cryllic, and for 2-byte script systems,<CODE> VisibleLength</CODE> does not include in the byte count it returns trailing spaces that occur at the display end of the text segment. For 2-byte script systems, <CODE>VisibleLength</CODE> does not count them, whether they are 1-byte or 2-byte <BR>space characters.
<LI>For 1-byte complex script systems, <CODE>VisibleLength</CODE> does not include in the byte count that it returns spaces whose character direction is the same as the primary line direction. For 1-byte complex script systems that support bidirectional text, Roman spaces take on a character direction based on the primary line direction. If the Roman spaces then fall at the end of the text, <CODE>VisibleLength</CODE> does not include them in the returned byte count.<P>
</UL>
<DL>
<DT><B>Advancing the pointer in memory in response to VisibleLength</B>
<DD>The purpose of <CODE>VisibleLength</CODE> is to trim off white space at the display end of the line. The <CODE>VisibleLength</CODE> function does not eliminate the white space by removing its character code from memory. Rather, it does not include white space characters in the count that it returns as the length of the range of text for which you call it.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 For more information about <CODE>VisibleLength</CODE>, see the task description <A HREF=Text-139.html#MARKER-9-153>"Eliminating Trailing Spaces (for Justified Text)"</A> on <A HREF=Text-139.html#MARKER-9-153>page 3-36</A>.<A NAME=MARKER-2-40></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-168.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-170.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
