<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE> InterruptHandler11</TITLE></HEAD><BODY BGCOLOR="#ffffff"><DIV><a name="top"></a><!-- start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!-- start of path --><font face="Geneva,Helvetica,Arial" size="1"><b><br>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Documentation</a> &gt; <!-- a href="" target="_top" -->Hardware<!-- /a -->  <b>&gt; </b><a href="../../devicemgrs.html" target="_top">Device Managers and Drivers</a> <b>&gt; </b><a href="../pci_srvcs.html" target="_top">PCI Card Services</a> <b>&gt; </b>Designing PCI Cards and Drivers for Power Macintosh Computers</font><br><br><!-- end of path --><A HREF="PCI_BOOK.17c.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.17c.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.17e.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><HR></DIV><H1 CLASS="RoH.RoutineHeading"><A NAME="pgfId=4363"> </A><A NAME="36133"> </A>InterruptHandler</H1><CODE CLASS="RD.RoutineDeclare"><A NAME="pgfId=19199"> </A>InterruptMemberNumber InterruptHandler (<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InterruptSetMember ISTmember,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void * refCon,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UInt32 theIntCount);</CODE><DL COMPACT><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=19203"> </A><TT CLASS="cv">--&gt; ISTmember</TT><A NAME="marker=19207"> </A></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=4367"> </A>Member set ID of the IST member requesting service.</DD><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=19213"> </A><TT CLASS="cv">--&gt; refCon</TT></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=4368"> </A>32-bit reference constant registered with the IST member.</DD><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=19222"> </A><TT CLASS="cv">--&gt; theIntCount</TT></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=4369"> </A> Count of the number of interrupts processed, including the  current one.</DD></DL COMPACT><DIV><H5 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=4370"> </A>DESCRIPTION</H5><P CLASS="T1.Text1"><A NAME="pgfId=4371"> </A>When an ISR is invoked, <TT CLASS="cv">member</TT> contains the ID of the IST member that is the currently interrupting source. Since an ISR can be registered with multiple IST members, the <TT CLASS="cv">member</TT> parameter allows a single ISR to distinguish multiple interrupt sources. <TT CLASS="cv">RefCon</TT> contains the reference constant that was installed along with the ISR.</P><P CLASS="T1.Text1"><A NAME="pgfId=4372"> </A>If the ISR returns a positive number, the dispatcher uses that number to identify which child member should be invoked next.</P><P CLASS="T1.Text1"><A NAME="pgfId=4373"> </A>If the ISR returns <TT CLASS="cv">kIsrIsComplete</TT>, the interrupt dispatcher stops any further traversal of the IST and treats the interrupt request as serviced. See <A HREF="PCI_BOOK.171.html#25712" CLASS="XRef">Interrupt Dispatching</A> for additional information about the interrupt service process. </P></DIV><DIV><blockquote><H4 CLASS="ImportantHead"><A NAME="pgfId=19235"> </A>IMPORTANT</H4><P CLASS="I.Important"><A NAME="pgfId=4377"> </A>Since an ISR can be invoked when the device the ISR services is not requesting service, an ISR must be able to detect this situation and return <TT CLASS="cv">kIsrIsNotComplete</TT> to the dispatcher. This lets the dispatcher continue looking for the actual ISR that will service the interrupt request. </P></blockauote><P CLASS="T1.Text1"><A NAME="pgfId=4381"> </A>The <TT CLASS="cv">theIntCount</TT> parameter can be used by transversal interrupt handlers to determine if they have been reinvoked by the dispatcher. On each new interrupt tree transversal, this value is unique. This means that <TT CLASS="cv">theIntCount</TT> will be a different value the first time a transversal ISR is invoked. However, if the transversal ISR is reinvoked during the same transversal process, the <TT CLASS="cv">theIntCount</TT> value will be the same as the first time it was invoked. By saving the value of <TT CLASS="cv">theIntCount</TT> during the previous tree traversal and verifying that the current value is the same, a transversal ISR can tell when it is being reinvoked.</P><P CLASS="T1.Text1"><A NAME="pgfId=4382"> </A>Note that the <TT CLASS="cv">theIntCount</TT> value will never be equal to <TT CLASS="cv">0</TT>. On ISR installation, the ISR's saved copy of <TT CLASS="cv">theIntCount</TT> should be initialized to <TT CLASS="cv">0</TT> so that the first invocations of the ISR can behave properly.</P></DIV><DIV><blockquote><H4 CLASS="ImportantHead"><A NAME="pgfId=19237"> </A>IMPORTANT</H4><P CLASS="I.Important"><A NAME="pgfId=4383"> </A>The actual value of <TT CLASS="cv">theIntCount</TT> shouldn't interpreted in any way. How this value is computed may change in the future. The only valid interpretation of <TT CLASS="cv">theIntCount</TT> is that it is unique for each interrupt tree transversal process and that it will never be 0. </P></blockquote></DIV><HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 26 March 99)<P><A HREF="PCI_BOOK.17c.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.17c.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.17e.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></HTML>