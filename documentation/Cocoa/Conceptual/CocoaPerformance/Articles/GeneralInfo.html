<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Cocoa Performance Guidelines: General Recommendations</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="General Recommendations"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001441" title="General Recommendations"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../Performance-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000901" target="_top">Performance</a> &gt; <a href="../index.html" target="_top">Cocoa Performance Guidelines</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../CocoaPerformance.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="UnblockUI.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/TP40001441-CJBHEFAE" title="General Recommendations"></a><hr /><H1>General Recommendations</H1><p>The following sections provide some basic guidance for achieving good performance with the Cocoa framework. </p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="GeneralInfo.html#//apple_ref/doc/uid/TP40001441-112297">Always Measure</a>
				
			<br/>
			
        
			
			
				<a href="GeneralInfo.html#//apple_ref/doc/uid/TP40001441-112319">Use a Scalable Architecture</a>
				
			<br/>
			
        
			
			
				<a href="GeneralInfo.html#//apple_ref/doc/uid/TP40001441-112476">Don’t Fight the Framework</a>
				
			<br/>
			
        
			
			
				<a href="GeneralInfo.html#//apple_ref/doc/uid/TP40001441-112111">Limit Your Use of Autoreleased Objects</a>
				
			<br/>
			
        
			
			
				<a href="GeneralInfo.html#//apple_ref/doc/uid/TP40001441-112125">Be Aware of Indeterminate Time Operations</a>
				
			<br/>
			
        
			
			
				<a href="GeneralInfo.html#//apple_ref/doc/uid/TP40001441-112235">Consider Data Caching Carefully</a>
				
			<br/>
			
        
			
			
				<a href="GeneralInfo.html#//apple_ref/doc/uid/TP40001441-112247">Defer Operations Whenever Possible</a>
				
			<br/>
			
        
			
			
				<a href="GeneralInfo.html#//apple_ref/doc/uid/TP40001441-112658">Defer the Display of Dynamically Updated Data</a>
				
			<br/>
			
        
			
			
				<a href="GeneralInfo.html#//apple_ref/doc/uid/TP40001441-DontLinkElementID_1">Use Binary Serializations Whenever Possible</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001441-112297" title="Always Measure"></a><h2>Always Measure</h2><p>Never assume you know where performance problems lie. The only way to know for sure is to measure the actual performance of your Cocoa application and use data from various tools to identify the real problems. </p><a name="//apple_ref/doc/uid/TP40001441-112319" title="Use a Scalable Architecture"></a><h2>Use a Scalable Architecture</h2><p>Choose a scalable application architecture. Your choice of algorithms can make a big difference in performance. Choose algorithms that scale well to the intended data set. Test your program on large data sets to make sure your performance is appropriate. </p><a name="//apple_ref/doc/uid/TP40001441-112476" title="Don&acirc;&#128;&#153;t Fight the Framework "></a><h2>Don’t Fight the Framework </h2><a name="//apple_ref/doc/uid/TP40001441-DontLinkElementID_23"></a><p>The Cocoa framework provides many of the features you need to implement advanced applications. In addition, improvements to Cocoa are being made regularly. By taking advantage of the facilities Cocoa provides for extending or modifying framework behavior, such as delegation and subclassing, you make your applications more likely to benefit from future improvements. </p><p>Be sure to use data structures and data types that are compatible with the methods you need to call. Constructing or converting a data structure at runtime solely for the purpose of calling a system function adds an unnecessary performance penalty to your application. If you can incorporate a compatible version of the data structure into your model, you can eliminate that penalty. </p><a name="//apple_ref/doc/uid/TP40001441-112111" title="Limit Your Use of Autoreleased Objects "></a><h2>Limit Your Use of Autoreleased Objects </h2><a name="//apple_ref/doc/uid/TP40001441-DontLinkElementID_24"></a><a name="//apple_ref/doc/uid/TP40001441-DontLinkElementID_25"></a><p>Many object factory methods return autoreleased objects by convention. Although this technique ensures that objects are released properly, it is often unnecessary. If you create temporary objects within a method, you know that those objects can be released when the method finishes. Rather than have them linger until the next time the autorelease pool is cleared, it is better to release them immediately. </p><p>Releasing objects right away can help you avoid potential memory spikes. If you allocate thousands of temporary objects before the next sweep of the autorelease pool, those objects could be paged to disk as memory space runs low. During the sweep, those same objects would then be read back into memory so that they could be deleted, which is a waste of time. </p><a name="//apple_ref/doc/uid/TP40001441-112125" title="Be Aware of Indeterminate Time Operations"></a><h2>Be Aware of Indeterminate Time Operations</h2><p>Because of latency<a name="//apple_ref/doc/uid/TP40001441-DontLinkElementID_26"></a> and transfer speeds, file-system and network requests can potentially take much longer to complete than other types of operations. If you access file or network data synchronously, your application might appear frozen while it waits for the data to return. Therefore, it is usually better to perform these types of operations asynchronously or on a secondary thread. You might also want to consider firing off a timer if the operation does not complete within a certain amount of time. You can use this timer to notify the user of the delay or provide an option to cancel the operation.</p><a name="//apple_ref/doc/uid/TP40001441-112235" title="Consider Data Caching Carefully"></a><h2>Consider Data Caching Carefully</h2><a name="//apple_ref/doc/uid/TP40001441-DontLinkElementID_27"></a><p>You should always approach data caching carefully and measure the performance of your implementation. Data caching can significantly improve the speed of your code or hopelessly degrade it. Identifying the right data to cache is a difficult task and is dependent on your design. If you cache the wrong data, you could waste memory storing unused data. Even if you cache the right data, that data could still be paged to disk during low-memory conditions. </p><p>Be sure to test your caching implementation under a variety of circumstances, especially in low-memory situations. If you find your data is being paged out to disk, consider reducing the size of your cache or eliminating it altogether. At that point, caches could cause three disk operations instead of just one. </p><a name="//apple_ref/doc/uid/TP40001441-112247" title="Defer Operations Whenever Possible"></a><h2>Defer Operations Whenever Possible</h2><p>Reducing the amount of work you do at critical moments is one of the best ways to give users the perception of speed in your application. Deferring operations whose results are not needed right away can help improve performance at those critical moments, as well as at other times too. </p><p>Drawing<a name="//apple_ref/doc/uid/TP40001441-DontLinkElementID_28"></a> is a particular area where deferring operations can yield significantly better performance. Rather than force your window to update each time you make a change, simply invalidate areas that need to be redrawn. There is a good chance that more updates might have come before the window contents actually need to be redrawn. By invalidating, you can coalesce those drawing operations and perform them all at once. </p><p>Another place where applications typically take a big performance hit is in loading plug-ins<a name="//apple_ref/doc/uid/TP40001441-DontLinkElementID_29"></a> and other external code modules that are not needed right away. If you load a code module or plug-in that is never used, it is a waste of both CPU time and memory. If you wait until the code is actually called, you may incur a small penalty by loading the code at that time but you guarantee that the code is actually used. </p><a name="//apple_ref/doc/uid/TP40001441-112658" title="Defer the Display of Dynamically Updated Data"></a><h2>Defer the Display of Dynamically Updated Data</h2><p>If you are loading data dynamically and displaying it in a view, avoid telling your view to update itself too often. It is better to delay the display of that data a short amount of time rather than force your view to redraw its contents immediately, especially if more data could arrive at any time. </p><p>For example, suppose you have a script that generates data to be displayed in a table view. If the script provides an initial flood of data and then sends periodic updates, calling the <code>reloadData</code> method each time you received a piece of the data could lead to numerous useless updates. Instead, you should defer the call to the <code>reloadData</code> method until a certain amount of time has passed. If more data comes in during that time, you can then cancel the current request and initiate a new one. <span class="content_text">Listing 1</span> shows you some sample code for how to do this. </p><a name="//apple_ref/doc/uid/TP40001441-112868-CJBJJFIB" title="Listing 1Cancelling and restarting a reloadData operation"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP40001441-112868" title="Listing 1Cancelling and restarting a reloadData operation"></a><strong>Listing 1&nbsp;&nbsp;</strong>Cancelling and restarting a reloadData operation</p><div class="codesample"><table><tr><td scope="row"><pre>// Cancel the old request<span></span></pre></td></tr><tr><td scope="row"><pre>[NSObject cancelPreviousPerformRequestsWithTarget:myTableView selector:@selector(reloadData) object:nil];<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// Initiate a new request after a brief delay.<span></span></pre></td></tr><tr><td scope="row"><pre>[myTableView performSelector:@selector(reloadData) withObject:nil afterDelay:0.3];<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001441-DontLinkElementID_1" title="Use Binary Serializations Whenever Possible"></a><h2>Use Binary Serializations Whenever Possible</h2><p>If you use the NSPropertyListSerialization class to read and write property-list information, you should format your property list files as binary XML whenever possible. Binary data is significantly more compact than its text-based counterpart. As a result, reading and writing binary-based data is significantly faster (often 5 to 20 times faster) than reading and writing the corresponding text-based data. </p><p>Support for the binary XML format was introduced in Mac OS X v10.2. Although users cannot view the contents of a binary property-list file directly using a text editor, they can use the Property List Editor application to read them. </p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001441-DontLinkElementID_3" title="Note"></a><p><strong>Note:</strong>&nbsp;Some classes, such as NSUnarchiver and NSArchiver, already read and write data using binary file formats.</p></div><p>For more information on property lists and binary file formats, see <em><a href="../../PropertyLists/index.html#//apple_ref/doc/uid/10000048i" target="_top">Property List Programming Guide</a></em>.</p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../CocoaPerformance.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="UnblockUI.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2004, 2005 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2005-08-11<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Conceptual/CocoaPerformance/Articles/GeneralInfo.html%3Fid%3DTP40001448-1.2&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Conceptual/CocoaPerformance/Articles/GeneralInfo.html%3Fid%3DTP40001448-1.2&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Conceptual/CocoaPerformance/Articles/GeneralInfo.html%3Fid%3DTP40001448-1.2&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
