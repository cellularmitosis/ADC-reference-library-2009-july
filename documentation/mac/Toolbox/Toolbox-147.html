<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>AppendResMenu(IM:Tb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING147></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Toolbox-146.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-148.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Toolbox-2.html"><B>Macintosh Toolbox Essentials</B></A> / <BR><DD><A HREF="Toolbox-89.html"><B>Chapter 3 - Menu Manager</B></A> / <A HREF="Toolbox-107.html"><B>Menu Manager Reference</B></A><BR><DL><DD><A HREF="Toolbox-112.html"><B>Menu Manager Routines</B></A> / <A HREF="Toolbox-143.html"><B>Adding and Deleting Menu Items</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING147-0></A>
<H3><A NAME=MARKER-9-587></A>AppendResMenu</H3>
 <A NAME=MARKER-11-588></A><A NAME=MARKER-2-589></A>Use the <CODE>AppendResMenu</CODE> procedure to search all resource files open to your application for a given resource type and to append the names of any resources it finds to a specified menu. The specified menu must have been previously created using <CODE>NewMenu</CODE>, <CODE>GetMenu</CODE>, or <CODE>GetNewMBar</CODE>.<P>
 The <CODE>AppendResMenu</CODE> procedure is also available as the <CODE>AddResMenu</CODE> procedure.<P>
<PRE>
PROCEDURE AppendResMenu (theMenu: MenuHandle; theType: ResType); 
</PRE>
<DL>
<DT><CODE>theMenu</CODE>
<DD> A handle to the menu record of the menu to which to append the names of any resources of a given type that <CODE>AppendResMenu</CODE> finds.
<DT><CODE>theType</CODE>
<DD> A four-character code that identifies the resource type for which to search.
</DL>
<A NAME=HEADING147-6></A>
<H5>DESCRIPTION</H5>
 The <CODE>AppendResMenu</CODE> procedure searches all resource files open to your application for resources of the type defined by the parameter <CODE>theType</CODE>. It appends the names of any resources it finds of the given type to the end of the specified menu. <CODE>AppendResMenu</CODE> appends the names of found resources in alphabetical order;<DFN> it </DFN>does not alphabetize items already in the menu. The <CODE>AppendResMenu</CODE> procedure does not add resources with names that begin with a period (<CODE>.</CODE>) or a percent sign (<CODE>%</CODE>) to the menu.<P>
 The <CODE>AppendResMenu</CODE> procedure assigns default characteristics to each menu item. Each appended menu item appears in the menu as an enabled item, without an icon or a mark, in the plain character style, and without a keyboard equivalent. To get the name or to change other characteristics of an item appended by <CODE>AppendResMenu</CODE>, use the Menu Manager routines described in <A HREF=Toolbox-149.html#MARKER-9-602>"Getting and Setting the Appearance of Menu Items" beginning on page 3-132</A>.<P>
 <A NAME=MARKER-16-590></A>If you specify that <CODE>AppendResMenu</CODE> add resources of type <CODE>'DRVR'<DFN> to your Apple menu, AppendResMenu adds the name (and icon) of each item in the Apple Menu Items folder to the menu. </DFN></CODE><P>
 If you specify that <CODE>AppendResMenu</CODE> append resources of ty<DFN>pe <CODE>'FONT'</CODE></DFN> or <CODE>'FOND'</CODE>, the Menu Manager performs special processing for any resources it finds that have font numbers greater than $4000. If the script system associated with the font name is installed in the system, <CODE>AppendResMenu</CODE> stores information in the <CODE>itemDefinitions</CODE> array (in the <CODE>itemIcon</CODE> and <CODE>itemCmd</CODE> fields for that item) in the menu's menu record. This allows the Menu Manager to display the font name in the correct script.<P>
<A NAME=HEADING147-11></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 The <CODE>AppendResMenu</CODE> procedure calls the Resource Manager procedure <CODE>SetResLoad</CODE> (specifying <CODE>TRUE</CODE> in the <CODE>load</CODE> parameter) before returning. The <CODE>AppendResMenu</CODE> procedure reads the resource data of the resources it finds into memory. If your application does not want the Resource Manager to read resource data into memory when your application calls other routines that read resources, you need to call <CODE>SetResLoad</CODE> and specify <CODE>FALSE</CODE> in the <CODE>load</CODE> parameter after <CODE>AppendResMenu</CODE> returns. <P>
<A NAME=HEADING147-13></A>
<H5>SEE ALSO</H5>
 <A HREF=Toolbox-102.html#MARKER-9-367>Listing 3-15 on page 3-69</A> shows a sample that adds items from the Apple Menu Items folder to the Apple menu, and <A HREF=Toolbox-102.html#MARKER-9-376>Listing 3-16 on page 3-70</A> shows a sample that adds font names to a menu. See <I><A HREF="../MoreToolbox/MoreToolbox-2.html">Inside Macintosh: More Macintosh Toolbox</A></I> for information on the Resource Manager.<A NAME=MARKER-2-594></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Toolbox-146.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-148.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Toolbox-3.html">&copy; Apple Computer, Inc.</A><br>11 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
