<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note TB11: GetNextEvent; Blinking Apple Menu</title>                                       <meta name="categories" content="Human Interface Toolbox"><meta name="week-posted" content="Jul 28, 1986 - Aug 1, 1986"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002762" title="GetNextEvent; Blinking Apple Menu"></a><a name="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxMacOS9Earlier-date.html">Mac OS 9 & Earlier</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/Carbon/idxHumanInterfaceToolbox-date.html" target="_blank">Carbon > Human Interface Toolbox</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TB11</div>
<div id="pageheadsub">GetNextEvent; Blinking Apple Menu</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext"><A HREF="#Section1">The obvious</A><BR><BR><A HREF="#Section1">The not-so-obvoius</A><BR><BR><A HREF="#Section1">The more subtle</A><BR><BR><A HREF="#References">References</A><BR><BR><A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">Wherein arcane mysteries are unraveled so you can make the Alarm Clock (or asimilar desk accessory) blink the Apple menu at the appointed second. Also, why<code>GetNextEvent</code> is a good thing.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Mar 01 1988]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><a name=Section1></A><h2>The obvious</h2><p>Don't disable interrupts within an application! There will almost certainlycome a time (or Macintosh) where you won't be able to change the interrupt maskbecause the processor is running in user mode. The one-second interrupt is usedto blink the apple.</p><P><A HREF="#top">Back to top</A></p><a name="Section2"></a><h2>The not-so-obvious</h2><p>You must call <code>GetNextEvent</code> periodically. <code>GetNextEvent</code> uses afilter (GNE filter) which allows for a routine to be installed that overrides(or augments) the behavior of the system. The GNE filter is installed bypointing the low-memory global <code>jGNEFilter</code> (a long word at<code>$29A</code>) to the routine. After all other GNE processing is complete, the<code>routine</code> will be called with <code>A1</code> pointing to the event recordand <code>D0</code> containing the boolean result. The filter may then modify theevent record or change the function result by altering the word on the stack at<code>4(A7)</code>. This word will match <code>D0</code> initially, of course.</p><p>A GNE filter is used to do the blinking when the interrupt handler hasannounced that the moment is at hand. <code>GetOSEvent</code> won't do. If youdon't have a standard main event loop, it is generally a good idea to give<code>GetNextEvent</code> (and <code>SystemTask</code>, too) a call whenever you haveany idle time. <code>GetNextEvent</code> "extra" services include, but aren'tlimited to, the following:</p><ol type="i" start="1">	<li>Calling the GNE filter.</li>	<li>Removing lingering disk-switched windows (uncommon unless memory is tight).</li>	<li>Making Window Manager activate, deactivate and update events happen.</li>	<li>Getting various events from a journaling driver when one is playing.</li>	<li>Giving <code>SystemEvent</code> a chance at each event.</li>	<li>Running command-shift function key routines (e.g., Command-Shift-4 to print the screen to an ImageWriter).</li></ol><P><A HREF="#top">Back to top</A></p><a name="Section3"></a><h3>The more subtle</h3><p>When the (default) GNE filter sees that the interrupt handler has set the "timeto blink" flag, it looks at the first menu in <code>MenuList</code>. The title ofthat menu must consist solely of the "Apple" character or no blinking willoccur. It really just looks at the first word of the string to see if it is<code>$0114</code>. This is a Pascal string which has only the <code>$14</code> "apple"character in it. So you musn't have any spaces or any other characters in thetitle of your first menu or you'll get no blinkin' results.</p><P><A HREF="#top">Back to top</A></p><a name = "References"></a><h2>References</h2><P>The Menu Manager</p><P>The Toolbox Event Manager</p><P>The Desk Manager</p>         <a name="Downloads"></a>       <P><A HREF="#top">Back to top</A></p><h2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (48K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/tb_11.pdf">Download</A></P>               </TD>            </TR>                    </TABLE>         <BR></TD></TR></table></center><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tb/tb_11.html%3Fid%3DDTS10002762-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tb/tb_11.html%3Fid%3DDTS10002762-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tb/tb_11.html%3Fid%3DDTS10002762-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>