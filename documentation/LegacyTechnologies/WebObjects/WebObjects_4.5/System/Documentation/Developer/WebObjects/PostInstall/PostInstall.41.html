<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML EXPERIMENTAL 970324//EN"><HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><TITLE> Troubleshooting WebObjects 4 Request Handling</TITLE></HEAD><body bgcolor="#ffffff"><!--start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!--start of path --><font face="Geneva,Helvetica,Arial" size="1"><b>PATH<spacer type="horizontal" size="5">&nbsp;</b> <a href="../../../../../../index.html" target="_top">Documentation</a> <b>&gt;</b> <a href="../../../../../webobjects.html" target="_top">WebObjects 4.5</a> <b>&gt;</b>Post Install Guide</font><br><br><!--end of path --><DIV><a name="top"></a><A HREF="PostInstall.3b.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PostInstall.40.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PostInstall.42.html"><img src="images/next.gif" border="0" width="49" height="16"></A><nobr>&nbsp;</nobr><HR></DIV><H1><A NAME="pgfId=47171"> </A><A NAME="39759"> </A>Troubleshooting WebObjects 4 Request Handling</H1><A NAME="pgfId=47018"> </A>In previous WebObjects releases, the application, session, request component, and all of the dynamic elements in the request component got a chance to perform the <TT>takeValuesFromRequest:inContext:</TT> and <TT>invokeActionForRequest:inContext:</TT> methods during each cycle of the request-response loop. In WebObjects 4, there are some performance enhancements to this request-handling scheme:</P><UL><LI><A NAME="pgfId=47019"> </A>The take values phase is not always performed.<P><A NAME="pgfId=47020"> </A>If the request has no form values to use as input, the take values phase of the request-response loop (in which the application, the session, the request component, and the component's dynamic elements are sent <TT>takeValuesFromRequest:inContext:</TT>) is not performed.<P><A NAME="pgfId=47021"> </A>If you have overridden <TT>takeValuesFromRequest:inContext:</TT> at the application, session, or component level and your method needs to be invoked even when there are no input values, you must either change your logic or disable WebObjects 4 request handling at the application level. To disable WebObjects 4 request handling, implement the following method in your application class:<P><TT><A NAME="pgfId=47022"> </A>//WARNING! Put this method in Application class, not component.</TT><BR><TT><A NAME="pgfId=47023"> </A>//Java implementation</TT><BR><TT><A NAME="pgfId=47024"> </A>public boolean requiresWOF35RequestHandling() {</TT><BR><TT><A NAME="pgfId=47025"> </A>	return true;</TT><BR><TT><A NAME="pgfId=47026"> </A>}</TT><BR><TT><A NAME="pgfId=47027"> </A>//WebScript implementation</TT><BR><TT><A NAME="pgfId=47028"> </A>- requiresWOF35RequestHandling {</TT><BR><TT><A NAME="pgfId=47029"> </A>	return YES;</TT><BR><TT><A NAME="pgfId=47030"> </A>}</TT><P><A NAME="pgfId=47031"> </A>It is the application object that makes the decision to perform the take values phase of the request-response loop; therefore, you must disable WebObjects 4 request handling in the application class if you want to ensure that the take values phase always occurs.<P><LI><A NAME="pgfId=47032"> </A>The take values phase does not iterate through WOBrowser and WOPopUpButton lists. <P><A NAME="pgfId=47033"> </A>In previous releases, WebObjects would iterate through the <TT>list</TT> attribute of the WOBrowser and WOPopUpButton looking for the item that the user selected. As of release 4 this is no longer necessary because WebObjects can directly access the selected item without iterating. WebObjects is able to do this because the use of the <TT>value</TT> attribute has changed so that by default it is set to the index of the item. <P><UL><LI><A NAME="pgfId=47034"> </A>Use of the <TT>item</TT> attribute as the selection. </P><P CLASS="IndentBodyIndented"><A NAME="pgfId=47035"> </A>The <TT>item</TT> attribute is intended to point to the current item, and it is updated upon each iteration through the list. Because WebObjects used to iterate through the list until it found a selection, the <TT>item</TT> attribute ended up pointing to the selected item. </P><P CLASS="IndentBodyIndented"><A NAME="pgfId=47036"> </A>If you need to refer to the selected item, use the <TT>selection</TT> attribute instead of <TT>item</TT>. Make sure <TT>selection</TT> is bound to a variable in your component's code and then use that variable instead of the one bound to <TT>item</TT>. </P><LI><A NAME="pgfId=47037"> </A>Use of the <TT>value</TT> attribute.</P><A NAME="pgfId=47038"> </A>The <TT>value</TT> attribute was previously used as the string displayed in the browser or pop-up button. It also set the HTML value attribute for the <TT>&lt;OPTION&gt;</TT> tag. In WebObjects 4, this attribute still sets the value in HTML, but it no longer specifies the display string. By default, it is set to an index value, which allows WebObjects to find the selection without iterating through the list.</P><A NAME="pgfId=47039"> </A>If you have a binding for the <TT>value</TT> attribute, change it to <TT>displayString</TT>, which is a new attribute that specifies the display string. Change this:</P><TT><A NAME="pgfId=47040"> </A>value = aCollege.name;</TT><P><A NAME="pgfId=47041"> </A>to this:</P><TT><A NAME="pgfId=47042"> </A>displayString = aCollege.name;</TT><P><A NAME="pgfId=47043"> </A>Use <TT>value</TT> only if you really want to set the HTML value in the <TT>&lt;OPTION&gt;</TT> tag.</P><LI><A NAME="pgfId=47044"> </A>An <TT>item</TT> attribute bound to a method.</P><A NAME="pgfId=47045"> </A>If you bound the <TT>item</TT> attribute to a method, your method used to be invoked several times during the take values phase, and now it is invoked only once (for the selected item). If your component depends upon the previous behavior, you either need to change your logic or use WOApplication's request-handling compatibility flag as described above. </P></UL><LI><A NAME="pgfId=47046"> </A>The invoke action phase does not iterate through a WORepetition's list.<P><A NAME="pgfId=47047"> </A>When a repetition's list is iterated upon, the <TT>item</TT> and <TT>index</TT> attribute values are updated at each iteration. In previous releases, list iteration occurred during the take values phase and during the invoke action phase of the request-response loop. In WebObjects 4, WORepetition list iteration occurs during take values only if the request has input values, and it doesn't occur during the invoke action phase. (WebObjects is able to forgo iterating during the invoke action phase because by default it sets the <TT>identifier</TT> attribute to the item's element ID so that it is able to navigate directly to the list item that responds to the requested action. If you already declare a binding for the <TT>identifier</TT> attribute, your binding is used instead of the element ID, and the invoke action phase does iterate through the list.)<P><A NAME="pgfId=47048"> </A>If you've bound the <TT>item</TT> or <TT>index</TT> attribute to a method, your method used to be invoked several times during the take values phase, and then again several more times during the invoke action phase. In WebObjects 4, your method will only be invoked during the take values phase if there are input values in the request, and it won't be invoked during the invoke action phase (unless you specify a non-default binding for the <TT>identifier</TT> attribute). <P><A NAME="pgfId=47049"> </A>If your component depends upon the previous behavior, you either need to change your logic or use the component's request-handling compatibility flag. To set the component's request handling compatibility flag, implement this method in the component:<P><TT><A NAME="pgfId=47050"> </A>// Java implementation</TT><BR><TT><A NAME="pgfId=47051"> </A>public boolean requiresWOF35RequestHandling() {</TT><BR><TT><A NAME="pgfId=47052"> </A>	return true;</TT><BR><TT><A NAME="pgfId=47053"> </A>}</TT><BR><TT><A NAME="pgfId=47054"> </A>// WebScript implementation</TT><BR><TT><A NAME="pgfId=47055"> </A>- requiresWOF35RequestHandling {</TT><BR><TT><A NAME="pgfId=47056"> </A>	return YES;</TT><BR><TT><A NAME="pgfId=47057"> </A>}</TT><P><A NAME="pgfId=47058"> </A>When you implement this method at the component level, WebObjects uses the old behavior for invoke action on that component only. All other components use the new behavior for the invoke action phase.<P></UL><P><HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 19 Oct 99)<P><A HREF="PostInstall.3b.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PostInstall.40.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PostInstall.42.html"><img src="images/next.gif" border="0" width="49" height="16"></A><nobr>&nbsp;</nobr><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY></HTML>