<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>MacApp's Document Classes (MacApp PG)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING59></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MacAppProgGuide-58.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-60.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MacAppProgGuide-2.html"><B>Programmer's Guide to MacApp</B></A> / <A HREF="MacAppProgGuide-21.html"><B>Part 1 - MacApp Theory and Architecture</B></A><BR><DD><A HREF="MacAppProgGuide-57.html"><B>Chapter 7 - Document Handling</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING59-0></A>
<H1>MacApp's <A NAME=MARKER-2-25></A>Document Classes</H1>
 As the hierarchy in <A HREF=MacAppProgGuide-58.html#MARKER-9-24>Figure 7-1</A> shows, each of MacApp's document classes descends from the <CODE>TCommandHandler</CODE> class and each inherits from the <CODE>MScriptableObject</CODE> class. As a result, each of MacApp's document classes is capable of creating commands to respond to user actions and of working with Apple events.<P>
 MacApp provides the following document classes for your application to build on:<P>
<DL>
<DT><CODE>TDocument<B></B></CODE>
<DD> The <CODE>TDocument</CODE> class is an abstract class that defines methods for performing basic document operations.
<DT><CODE>TFileBasedDocument<B></B></CODE>
<DD> The <CODE>TFileBasedDocument</CODE> subclass of <CODE>TDocument</CODE> adds methods for working with disk files. <CODE>TFileBasedDocument</CODE> is a suitable parent class for many standard documents.
<DT><CODE>TEditionDocument<B></B></CODE>
<DD> The <CODE>TEditionDocument</CODE> subclass of <CODE>TFileBasedDocument</CODE> adds Edition Manager support for publishing and subscribing. Applications that use publish and subscribe can define a subclass of <CODE>TEditionDocument</CODE>.
<DT><CODE>TMailableDocument<B></B></CODE>
<DD> The <CODE>TMailableDocument</CODE> subclass of <CODE>TFileBasedDocument</CODE> adds support for turning a document into an electronic mailer. If your application needs to take advantage of MacApp's PowerTalk mailer support, you can define a subclass of the <CODE>TMailableDocument</CODE> class.
<DT><CODE><A NAME=MARKER-2-26></A>TTEDocument<B></B></CODE>
<DD> This subclass of <CODE>TMailableDocument</CODE> is defined in the DemoText sample application. While not a part of the MacApp class library, it does demonstrate the use of PowerTalk mailers and many text-editing features.
</DL>
 These document classes are described in greater detail in the sections that follow.<P>
<A NAME=HEADING59-9></A>
<H2><A NAME=MARKER-2-27></A>The TDocument Class</H2>
 <A NAME=MARKER-2-28></A>The <CODE>TDocument</CODE> class is an abstract class--you don't normally instantiate objects of this type. Some of the methods defined in <CODE>TDocument</CODE> do nothing and are overridden in MacApp's document subclasses.<P>
 Most of MacApp's document classes are designed primarily for working with disk-based documents. If your application requires other types of documents, such as documents contained in databases or documents contained inside other documents, you can define a subclass of <CODE>TDocument</CODE>.<P>
 The <CODE>TDocument</CODE> class provide basic services, such as creating a document's views, setting up its menu items, and handling document-related menu commands, including Save, Save As, Save a Copy, and Revert to Saved. <CODE>TDocument</CODE> also mixes in the <CODE>MScriptable</CODE> class, so any subclass of <CODE>TDocument</CODE> can be a target for Apple events and can return contained objects. The <CODE>MScriptable</CODE> class is described in <A HREF=MacAppProgGuide-48.html#MARKER-9-19>Chapter 6, "Scripting."</A><P>
 <CODE>TDocument</CODE> defines these methods for responding to Apple event object-specifier queries: <CODE>GetContainedObject</CODE>, <CODE>GetObjectProperty</CODE>, and <CODE>SetObjectProperty</CODE>. These methods can handle certain requests themselves and pass others on to the mixin <CODE>MScriptable</CODE> class.<P>
 <CODE>TDocument</CODE> also defines these methods for handling Apple events: <CODE>DoAEClose</CODE>, <CODE>DoAEPrint</CODE>, and <CODE>DoAESave</CODE>. These methods create command objects to handle the specified operation. For example, <CODE>DoAEClose</CODE> creates a <CODE>TCloseDocCommand</CODE> object to close the document.<A NAME=MARKER-2-29></A><P>
<A NAME=HEADING59-15></A>
<H2><A NAME=MARKER-2-30></A>The TFileBasedDocument Class</H2>
 The <CODE><A NAME=MARKER-2-31></A>TFileBasedDocument</CODE> class is a subclass of <CODE>TDocument</CODE> that adds fields and methods for reading a document from a file, writing a document to a file, and determining how much room a document will take on disk. If the document has an attached script, the <CODE>TFileBasedDocument</CODE> class can write the script to the document's resource fork or read it from the resource fork.<P>
 <CODE>TFileBasedDocument</CODE> works with the <CODE>TFileHandler</CODE> and <CODE>TFile</CODE> classes. <CODE>TFile</CODE> provides a convenient interface to files on disk. <CODE>TFileHandler</CODE> contains much of the code for saving and opening file-based documents. <CODE>TFileBasedDocument</CODE> and <CODE>TFileHandler</CODE> are so tightly integrated that they can be thought of as two parts of the same object. Files and file handlers are described in greater detail in <A HREF=MacAppProgGuide-60.html#MARKER-9-42>"Document Operations," beginning on page 168</A>.<P>
 Subclasses of <CODE>TFileBasedDocument</CODE> typically override methods for reading and writing data and for determining how much room data will require on disk. <CODE>TFileBasedDocument</CODE> also overrides <CODE>DoAEClose</CODE> to create a <CODE>TCloseFileDocCommand</CODE> object to close the document. For recipes and code samples that demonstrate how to work with file-based documents, see <A HREF=MacAppProgGuide-97.html#MARKER-9-19>Chapter 16, "Working With Documents."</A><P>
<A NAME=HEADING59-19></A>
<H2><A NAME=MARKER-2-32></A>The TEditionDocument Class</H2>
 The <CODE><A NAME=MARKER-2-33></A>TEditionDocument</CODE> class is  a subclass of <CODE>TFileBasedDocument</CODE> that adds support for publish and subscribe, using the Edition Manager. This class enables and handles the menu commands Create Publisher, Subscribe To, Publisher/Subscriber Options, Show/Hide Borders, and Stop All Editions.<P>
 When you define a subclass of <CODE>TEditionDocument</CODE>, you don't normally override methods that supply Edition Manager functions. Instead, you override methods involved in reading, writing, or displaying your document's edition data<CODE>.</CODE><P>
 MacApp's Edition Manager support is described in detail in <A HREF=MacAppProgGuide-61.html#MARKER-9-154>"Publish and Subscribe," beginning on page 184</A>. Recipes and code samples are provided in <A HREF=MacAppProgGuide-145.html#MARKER-9-19>Chapter 31, "Working With the Edition Manager."</A> Edition Manager support for publish and subscribe is demonstrated in the Calc sample application.<P>
<A NAME=HEADING59-23></A>
<H2><A NAME=MARKER-2-34></A>The TMailableDocument Class</H2>
 The <CODE><A NAME=MARKER-2-35></A>TMailableDocument</CODE> class is  a subclass of <CODE>TFileBasedDocument</CODE> that adds methods for working with a document as electronic mail, using MacApp's PowerTalk support. Working with the mixin class <CODE><A NAME=MARKER-2-36></A>MMailable</CODE>, which in turn works with the <CODE><A NAME=MARKER-2-37></A>TFileBasedLetter</CODE> class, the <CODE>TMailableDocument</CODE> class enables and handles the Mail menu commands Add/Delete Mailer, Send, Reply, Forward, and Open Next Letter.<P>
 Any document object based on the <CODE>TMailableDocument</CODE> class can be turned into an electronic mailer. Subclasses of <CODE>TMailableDocument</CODE> typically override methods for supplying or extracting their own data, such as <CODE>AddStandardMailContent</CODE>, <CODE>ReadStandardMailContent</CODE>, and <CODE>SetReplyContents</CODE>. The <CODE>TTEDocument</CODE> class from the DemoText sample application provides a detailed example of a mailable document class. <CODE>TTEDocument</CODE> is described in the next section.<P>
 For more information on mailers, see <A HREF=MacAppProgGuide-62.html#MARKER-9-201>"PowerTalk Mailers," beginning on page 192</A>. Recipes and code samples are provided in <A HREF=MacAppProgGuide-139.html#MARKER-9-19>Chapter 29, "Working With PowerTalk Mailers."</A><P>
<A NAME=HEADING59-27></A>
<H2><A NAME=MARKER-9-38></A><A NAME=MARKER-2-39></A>The TTEDocument Class</H2>
 The <CODE><A NAME=MARKER-2-40></A>TTEDocument</CODE> class is  a subclass of <CODE>TFileBasedDocument</CODE> that adds fields and methods for handling text and text-editing views, as well as for adding a PowerTalk electronic mailer to a document. This class demonstrates how to write text data to a file and read it back. It also demonstrates how to read and write mailer data in various formats. The <CODE>TTEDocument</CODE> class is not a part of MacApp itself, but is defined in the DemoText sample application. You can read more about the <CODE>TTEDocument</CODE> class in <A HREF=MacAppProgGuide-139.html#MARKER-9-19>Chapter 29, "Working With PowerTalk Mailers."</A><A NAME=MARKER-2-41></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MacAppProgGuide-58.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-60.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MacAppProgGuide-3.html">&copy; Apple Computer, Inc.</A><br>25 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
