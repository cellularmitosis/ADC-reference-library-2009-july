<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Defining a Document Record (IM: F)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING21></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Files-20.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-22.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Files-2.html"><B>Files</B></A> / <BR><DD><A HREF="Files-12.html"><B>Chapter 1 - Introduction to File Management</B></A> / <A HREF="Files-19.html"><B>Using Files</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING21-0></A>
<H2>Defining a Document Record</H2>
 When a user creates a new document or opens an existing document, your application displays the contents of the document in a window, which provides a standard interface for the user to view and possibly edit the document data. It is useful for your application to define a <B>document record,</B> an application-specific data structure that contains information about the window, any controls in the window (such as scroll bars), and the file (if any) whose contents are displayed in the window. <A HREF=#MARKER-9-126>Listing 1-3</A> illustrates a sample document record for an application that handles text files.<A NAME=MARKER-2-125></A><P>
<B>Listing 1-3  <A NAME=MARKER-9-126></A>A sample document record</B><P>
<PRE>
TYPE
   MyDocRecHnd    = ^MyDocRecPtr;
   MyDocRecPtr    = ^MyDocRec;
   MyDocRec       =
   RECORD
      editRec:       TEHandle;         {handle to TextEdit record}
      vScrollBar:    ControlHandle;    {vertical scroll bar}

      hScrollBar:    ControlHandle;    {horizontal scroll bar}
      fileRefNum:    Integer;          {ref num for window's file}
      fileFSSpec:    FSSpec;           {file's FSSpec}
      windowDirty:   Boolean;          {has window data changed?}
   END;
</PRE>
 Some fields in the <CODE>MyDocRec</CODE> record hold information about the TextEdit record that contains the window's text data. Other fields describe the horizontal and vertical scroll bars in the window. The <CODE>myDocRec</CODE> record also contains a field for the file reference number of the open file (if any) whose data is displayed in the window and a field for the file system specification that identifies that file. The file reference number is needed when the application manipulates the open file (for example, when it reads data from or writes data to the file, and when it closes the file). The <CODE>FSSpec</CODE> record is needed when a "safe-save" procedure is used to save data in a file.<P>
 The last field of the <CODE>MyDocRec</CODE> data type is a Boolean value that indicates whether the contents of the document in the TextEdit record differ from the contents of the document in the associated file. When your application first reads a file into the window, you should set this field to <CODE>FALSE</CODE>. Then, when any subsequent operations alter the contents of the document, you should set the field to <CODE>TRUE</CODE>. Your application can inspect this field whenever appropriate to determine if special processing is needed. For example, when the user closes a document window and the value of the <CODE>windowDirty</CODE> flag is <CODE>TRUE</CODE>, your application should ask the user whether to save the changed version of the document in the file. See <A HREF=Files-211.html#MARKER-11-1286>Listing 1-16</A> (<A HREF=Files-211.html#MARKER-11-1286>page 1-33</A>) for details.<P>
 To associate a document record with a particular window, you can simply set a handle to that record as the reference constant of the window (by using the Window Manager procedure <CODE>SetWRefCon</CODE>). Then you can retrieve the document record by calling the <CODE>GetWRefCon</CODE> function. <A HREF=Files-28.html#MARKER-9-210>Listing 1-15</A> illustrates this process.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Files-20.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-22.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Files-3.html">&copy; Apple Computer, Inc.</A><br>2 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
