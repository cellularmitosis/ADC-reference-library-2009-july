<html><head><title>Mac OS X Server
 Manual Page For mkpassdb(8)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/8/mkpassdb" title="Mac OS X Server
 Manual Page for mkpassdb(8)"><!-- headerDoc=man; indexgroup=Section 8; uid="//apple_ref/doc/man/8/mkpassdb"; name=mkpassdb(8) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac&nbsp;OS&nbsp;X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>

<p style='text-align:justify;'>This manual page is associated with Mac&nbsp;OS&nbsp;X&nbsp;Server.  It is
not available on standard Mac OS X (client) installations.</p>

<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
mkpassdb(8)               BSD System Manager's Manual              mkpassdb(8)

<b>NAME</b>
     <b>mkpassdb</b> -- Mac OS X Server Password Server database creation tool

<b>SYNOPSIS</b>
     <b>mkpassdb</b> <b>-backupdb</b> <u>path</u>
     <b>mkpassdb</b> <b>-changelist</b>
     <b>mkpassdb</b> <b>-deleteslot</b> <u>slot-ID</u>
     <b>mkpassdb</b> <b>-dump</b> [-v]
     <b>mkpassdb</b> <b>-dump</b> [slot-ID]
     <b>mkpassdb</b> <b>-getstats</b> [<u>sample-count</u>]
     <b>mkpassdb</b> <b>-header</b>
     <b>mkpassdb</b> <b>-kerberize</b>
     <b>mkpassdb</b> <b>-key</b>
     <b>mkpassdb</b> <b>-list</b>
     <b>mkpassdb</b> <b>-mergedb</b> <u>path</u>
     <b>mkpassdb</b> <b>-mergeparent</b> <u>path</u> <u>omitfile</u>
     <b>mkpassdb</b> <b>-setadmin</b> <u>slot-ID</u> [admin-class (0-7)]
     <b>mkpassdb</b> <b>-setglobalpolicy</b> "policy1=value1 policy2=value2 etc."
     <b>mkpassdb</b> <b>-setkerberos</b> <u>slot-ID</u> <u>KerberosRealm</u>
     <b>mkpassdb</b> <b>-setkeyagent</b> <u>slot-ID</u>
     <b>mkpassdb</b> <b>-setcomputeraccount</b> [off]
     <b>mkpassdb</b> <b>-setpassword</b> <u>slot-ID</u>
     <b>mkpassdb</b> <b>-setrealm</b> <u>realm</u>
     <b>mkpassdb</b> <b>-getreplicationinterval</b>
     <b>mkpassdb</b> <b>-setreplicationinterval</b> <u>seconds</u> [policy]
     <b>mkpassdb</b> <b>-rekeydb</b> [key-size-in-bits]
     <b>mkpassdb</b> [<b>-u</b> <u>user</u>] [<b>-m</b> <u>mech</u>] [<b>-a</b>] [<b>-b</b>] [<b>-e</b> <u>count</u>] [<b>-n</b> <u>replica-name</u>] [<b>-o</b>] [<b>-p</b>] [<b>-q</b>]

<b>DESCRIPTION</b>
     <b>mkpassdb</b> creates or modifies the password server database directly.

     <b>mkpassdb</b> must be run as root; it will exit otherwise. The <b>-list</b> command is the only exception.

     This tool's purpose is to create and manage the password server database. It performs operations that
     are not supported by the password server protocol because of security concerns. These operations
     include the creation and destruction of the database itself, the creation of the RSA security keys that
     establish the identity of the password server, the trusted mechanism list, and the genesis of adminis-<font color="#ffffff" class="whiteout">trator&nbsp;administrator</font>
     trator accounts. It also allows the root account to make some password server changes on the local sys-<font color="#ffffff" class="whiteout">tem.&nbsp;system.</font>
     tem.

     <b>-backupdb</b>                 This command is a low-level command that is invoked by a higher-level tool in
                               normal usage. Refer to the slapconfig man page.  This command safely creates
                               a snapshot of the password server database whether or not the daemon is run-<font color="#ffffff" class="whiteout">ning.&nbsp;running.</font>
                               ning.
     <b>-changelist</b>               Outputs the password server's list of changed slots that need to be repli-<font color="#ffffff" class="whiteout">cated.&nbsp;replicated.</font>
                               cated.
     <b>-deleteslot</b>               Invalidates a slot ID in the database.
     <b>-dump</b>                     Outputs all of the User IDs and their corresponding user names. If a slot-ID
                               is specified, it prints out more detailed information for a single slot. If
                               the [-v] option is used, additional columns are included.
     <b>-getstats</b>                 Outputs statistical information about the password server activity.  If a
                               sample-count is specified, the output is an array of samples in XML plist
                               format. The sample count is a positive integer.
     <b>-header</b>                   Outputs the database header information.
     <b>-kerberize</b>                Attempts to add kerberos principals for all non-kerberos accounts in password
                               server.
     <b>-key</b>                      Outputs the RSA public key stored in the database.
     <b>-list</b>                     Outputs all of the SASL mechanisms available to the password server.
     <b>-mergedb</b>                  This command is a low-level command that is invoked by a higher-level tool in
                               normal usage. Refer to the restoredb command in the slapconfig man page.
                               This command merges a snapshot of the password server database into the cur-<font color="#ffffff" class="whiteout">rent&nbsp;current</font>
                               rent database whether or not the daemon is running.  The identity elements of
                               the password server, including RSA keys and replica name, are changed to the
                               snapshot's contents.
     <b>-mergeparent</b>              This command is a low-level command that is invoked by a higher-level tool in
                               normal usage. Refer to the mergedb command in the slapconfig man page.  This
                               command merges a snapshot of the password server database into the current
                               database whether or not the daemon is running.  The current identity of the
                               password server is preserved.
     <b>-setadmin</b>                 Promotes a slot-ID to have administrator privileges for the password server.
                               By default, administrators set with mkpassdb receive the most priveleged rank
                               (0).
     <b>-setglobalpolicy</b>          Sets the default policies for all users.
     <b>-setkerberos</b>              Assigns a Kerberos realm to a password server account.
     <b>-setkeyagent</b>              Promotes a slot-ID to have enough administrator privileges to retrieve ses-<font color="#ffffff" class="whiteout">sion&nbsp;session</font>
                               sion keys on behalf of other accounts.
     <b>-setcomputeraccount</b>       Informs the password server that the account belongs to a computer rather
                               than a user. Computer accounts are not subject to policies and do not expire.
                               Using the optional "off" argument changes the state back to a user account.
     <b>-setpassword</b>              Sets an account password.
     <b>-setrealm</b>                 Sets the password server's SASL realm.
     <b>-getreplicationinterval</b>   Gets the number of seconds between replication attempts.
     <b>-setreplicationinterval</b>   Sets the number of seconds between replication attempts.
     <b>-rekeydb</b>                  Generates a new RSA public/private key pair for the database. Valid sizes are
                               1024, 2048, or 3072.  This command should be invoked by a higher-level tool.
                               If run from the command line, existing users will not be able to authenti-<font color="#ffffff" class="whiteout">cate.&nbsp;authenticate.</font>
                               cate. The PasswordService daemon must be turned off with, "NeST -stoppass-<font color="#ffffff" class="whiteout">wordserver"&nbsp;-stoppasswordserver"</font>
                               wordserver" before this command can be used.

<b>OPTIONS</b>
     The following options are available:

     <b>-a</b>    add a new administrator to an existing database.

     <b>-b</b>    add a new non-administrative user to an existing database.

     <b>-e</b>    expand the database to a fixed number of records. If the number is greater than the current size
           of the database, then the database is expanded; otherwise, no action is performed. This option is
           used by other setup tools when establishing a replica database. There is no reason to use it from
           the command line.

     <b>-m</b> <u>mech</u>
           establishes a mechanism as weak. If a mechanism is considered weak, then it can be used to verify
           passwords but the password server will not allow write operations to its database. The mechanisms
           SMB-NT, SMB-LAN-MANAGER, CRYPT, and APOP are always in the weak list. Directory Services uses DHX
           to perform write operations to the password server.

     <b>-n</b> <u>name</u>
           Assign a name to a replica

     <b>-o</b>    overwrite an existing database. Replacing an existing database is extremely destructive and
           should not be done unless all password server users have been removed from the directory system.

     <b>-p</b>    prompt for a password

     <b>-q</b>    quiet

     <b>-u</b> <u>user</u>
           Add this user name to the database.

<b>USAGE</b>
     In typical usage, <b>mkpassdb</b> is invoked by another tool. It is used directly on rare occasion.

<b>FILES</b> <b>&amp;</b> <b>FOLDERS</b>
     /Library/Preferences/com.apple.passwordserver.plist - the PasswordService preferences file
     /usr/sbin/PasswordService - the password service daemon
     /var/db/authserver/authservermain - password database (guard this)
     /var/db/authserver/authserverfree - list of free (reusable) slots in the database
     /var/db/authserver/authserverreplicas - table of password server replicas

<b>SEE</b> <b>ALSO</b>
     <!-- a -->NeST(8)<!-- /a --> <a href="PasswordService.8.html#//apple_ref/doc/man/8/PasswordService">PasswordService(8)</a> <a href="slapconfig.8.html#//apple_ref/doc/man/8/slapconfig">slapconfig(8)</a>

Mac OS X Server                21 February 2002                Mac OS X Server
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man8/mkpassdb.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man8/mkpassdb.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man8/mkpassdb.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
