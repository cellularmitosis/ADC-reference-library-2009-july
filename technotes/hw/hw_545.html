<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"    "http://www.w3.org/TR/1998/REC-html40-19980424/loose.dtd"><HTML><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note HW545: Serial I/O Port Q&amp;As</title>                                       <meta name="categories" content="Hardware"><meta name="week-posted" content="Oct 1, 1990 - Oct 5, 1990"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF" TEXT="#000000"><a name="//apple_ref/doc/uid/DTS10002512" title="Serial I/O Port Q&As"></a><a name="top"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxHardwareDrivers-date.html">Hardware & Drivers</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/HardwareDrivers/index.html" target="_blank">Reference Library > Hardware & Drivers</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note HW545</div>
<div id="pageheadsub">Serial I/O Port Q&amp;As</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->                     <P id = "menutext"> <A HREF="#Downloads">Downloadables</A></p>     <!-- end_toc -->     </td>    </tr>    <tr> <td width=300 align=left scope="row">   <img src="images/tnmenubottom.gif" alt="" width=300 height=16> </td>    </tr>  </table>    </td>    <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">This Technical Note contains a collection of archived Q&amp;As relating to a specifictopic--questions sent the Developer Support Center (DSC) along withanswers from the DSC engineers. Current Q&amp;A's can be found on the <a href="../../qa/index.html">Macintosh Technical Q&amp;A's web site</a>.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Oct 01 1990]</h3><!-- end_date -->    </TD>  </TR> </TABLE> <!-- end_table_box --> <BR> <hr width=500 align=center> <BR><!-- begin_content --><h2>Which Macintosh models support serial port GPi line</h2><P>Date Written:     1/16/92</p><P>Last reviewed:    1/20/93</p><P>I need an updated list indicating which Macintosh models have a functionalserial port GPi line.</p><P>Here's a Macintosh product line GPi support summary:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>Macintosh Plus        noMacintosh Classic     noMacintosh LC          noMacintosh IIsi        yesMacintosh Classic II  yesMacintosh IIci        yesMacintosh IIfx        yesMacintosh Quadra      yesMacintosh IIvx        yesPowerBook 100         yesPowerBook 140         yesPowerBook 145         yesPowerBook 160         yesPowerBook 170         yesPowerBook 180         yesPowerBook 210         yesPowerBook 230         yes</pre>	</TD></TR></TABLE></CENTER><p>We recommend use of the Gestalt call with the gestaltSerialAttr environmentselector to locate machines implemented with the GPi line.</p><h2>Macintosh maximum sustainable serial baud rate</h2><P>Date Written:     8/28/91</p><P>Last reviewed:    10/8/91</p><P>When my hardware device sends data to a Macintosh at 57.6 kilobaud, characterscan get lost if LocalTalk is on and a file server is mounted. Does Apple knowabout the problem? Is there a solution?</p><P>The coherency of a standard serial connection is not guaranteed at any baudrate. Guaranteed delivery requires more complicated protocols like thoseemployed by AppleTalk or by file transfer protocols like Kermit. At high baudrates, particularly over 19.2 kilobaud, a Macintosh serial connection may notbe reliable depending on a number of factors.</p><P>Every single character that's sent or received by the Macintosh serial portrequires an interrupt to alert the processor that a character is available atthe receiver or that the transmitter is ready to send a character. A nastydrawback of interrupts is that they can be masked--equal or higher priorityinterrupts may be in service or other pieces of code running on the machine candisable interrupts altogether. If the period of time interrupts are notserviced becomes too great, the 3-byte receive buffer in the serial chipoverflows with incoming data and characters are lost. This is known as ahardware overrun.</p><P>AppleTalk works a little differently. When a packet comes across the network,an interrupt alerts the processor to that event. AppleTalk code then disablesinterrupts and polls in the entire packet without multiple successiveinterrupts. This is necessary because of the high speed at which data isreceived: 230.4 kilobaud. The overhead of processing an interrupt for each byteof data would be prohibitive.</p><P>A "worst case" situation is that a 603-byte packet (the largest possibleAppleTalk packet) sent to the LocalTalk port takes approximately 26milliseconds to receive. Compare this with asynchronous serial data transmittedat 9600 baud, which would take only 1 millisecond to receive. A very realisticsituation arises in which 26 bits could be lost during a concurrentAppleTalk/Serial Device transmission. This possibility is increased when thereare routers on the network, which send out large RTMPs (Routing TableMaintenance Packets).</p><P>During the time that interrupts are disabled by AppleTalk, AppleTalk codeattempts to poll regular serial data as well (from the modem port only) toprevent the hardware overrun problem. Unfortunately, at very high serial baudrates there may not be enough time to do both; characters may be lost anyway.</p><P>This same loss of characters may also occur in conjunction with the Sonydriver. If a disk is inserted that requires special attention (likeformatting), the odds of losing characters is increased. The Sony driver hasbuilt-in checks like the AppleTalk driver (although not as frequent). So youcan still lose data at high transfer rates if a disk is inserted during thetransfer.</p><P>The character dropout also occurs on systems that aren't currently runningAppleTalk but are receiving serial transmissions from high-speed devices (57.6kilobaud) and are performing CPU tasks that require a high amount of memoryaccess (such as a CPU like the Macintosh IIsi or IIci running on-board video in8-bit mode, or a CPU using virtual memory).</p><P>This is simply a performance problem, asking the machine to process more dataover two separate ports than the processor speed and hardware architecture canallow. Any number of factors affect serial performance at high baud rates.Turning off AppleTalk helps. Turning on 32-bit addressing helps because itreduces interrupt handler overhead. Turning on VM hurts performance for theopposite reason. Running on a faster machine helps. Running on a Macintosh IIfxor Macintosh Quadra 900 with a serial I/O Processor (IOP) helps a lot becausethe IOP handles the serial port regardless of whether the main processor isbusy doing something else.</p><P>There is, however, a way to ensure reception of high-speed serial data withoutcharacter loss--through the use of a Serial NB card or a third-party NuBus(TM)card with a dedicated processor necessary to provide higher speeds. These cardsin essence operate as dedicated port-handling circuitry. They're able toperform necessary buffering while the processor is servicing other interrupts.This is the reason that network cards such as EtherTalk and TokenTalk canaccomplish transactions without data loss; they do at least some of their ownbuffering until being serviced to avoid interference with other operations suchas receiving serial data.</p><P>Alternatively, you may want to develop a custom card yourself that exactly fitsthe needs of your product. In this case you should look into the MacintoshCoprocessor Platform (MCP) and Apple Real-Time Operating System Environment(A/ROSE) as a possible basis of this line of development. Development packagesfor both these products--the Macintosh Coprocessor Platform Developer's Kit(#M0793LL/B) and the A/ROSE Software Kit (#M0794LL/B)--are available fromAPDA.</p><h2>Conditions degrading 57.6 Kbaud transmission</h2><P>We are experiencing intermittent character dropout at 57.6 Kbaud on a MacintoshIIsi in 256-color mode, but if we drop down to 16-color mode, everything workshunky dory. MultiFinder on or off makes no difference. What's the connectionbetween the number of colors and the serial port?</p><P>It turns out that various additions to the system cause performance to degrade,such that serial operation at 57.6 Kbaud cannot reliably be maintained.</p><P>There are various factors here, including the video mode (which requires morememory accesses and wait states to produce the same video rate, thus incurringa higher processor overhead). VM, if turned on, exacts an additionalperformance penalty. These problems are not limited to the Macintosh IIsi;we've had reports that they can also occur on the Macintosh IIci when runningthe on-board video in 256-color mode without a cache card.</p><h2>Where to find information on Coaxial card Twinax connector</h2><P>Date Written:    5/7/91</p><P>Last reviewed:    7/25/91</p><P>Is there any documentation on how to gain access to the Twinax connector on theMacintosh Coaxial card?</p><P>Andrew/KMW Systems has developed a device interface for the Twinax connector onthe Macintosh Coaxial card for their product. For more information, you cancontact them at the following address:</p><P>Andrew/KWM Systems<br>6034 West Courtyard Drive<br>Suite 100<br>Austin, TX<br>78730-5014<br>AppleLink: D0500</p><P>For additional documentation, you might want to contact National Semiconductorfor a copy of their technical documentation on the Biphase CommunicationsProcessor - DP8344A. Also, some Twinax technical documentation might beavailable from IBM.</p><h2>Where to get connectors for making Apple-compatible cables</h2><P>Date Written:     5/3/89</p><P>Last reviewed:    12/17/90</p><P>Where can I get connectors for making Apple-compatible cables?</p><P>Here are some suppliers of the mini-DIN connectors. This list is provided forinformation only--Apple does not endorse any of the vendors.</p><P>Hosiden America/Harmonix Sales<br>Mike Ferrera<br>10090 Pasadena Avenue, Suite A-2<br>Cupertino, CA 95014<br>408-725-2424</p><P>CompuCable<br>Bob Mickey<br>180 Vallecitos De Oro<br>San Marcos, CA 92069<br>619-744-2789<br>800-222-2332 (outside CA)</p><P>TRW<br>Illinois<br>Gene Kazmarek aka Kaz<br>408-720-8727</p><P>HB Associates<br>Hank Lorta<br>415-487-3933<br>Union City, CA</p><P>Harbor Electronics<br>Ron Marsilio<br>650 Danbury Road<br>Ridgefield, CT 06877<br>203-438-9625</p><P>Also try AMP; they may supply the 8-pin variety.</p><h2>SCC and AppleTalk timing</h2><P>Date Written:    5/7/91</p><P>Last reviewed:    7/25/91</p><P>The AppleTalk spec claims a data rate of 230.4 kbaud, which should require a3.6864 MHz input to the SCC, but RTxCB on the Macintosh carries a 3.672 MHzclock. How does the AppleTalk driver reconcile this and what frequency should Iuse?</p><P>The SCC contains a phase-locked loop which is able to lock on and synchronizewith AppleTalk transmissions whose clock rates are not exactly tospecifications, so everything is fine as long as both ends of the communicationare using approximately the same clock frequency. If you are designing your ownAppleTalk hardware from scratch, it is easiest to use a 3.6864 MHz oscillatorand a Z8530. This has been tested and works just fine.</p><h2>Macintosh IIfx Serial Switch 'cdev' for SCC direct access</h2><P>Date Written:    6/29/90</p><P>Last reviewed:    12/17/90</p><P>My application requires direct access to the SCC and I do not find theMacintosh IIfx Serial Switch 'cdev' to be good solution. Is there a way for meto get the support I need from the Serial Driver, or do I need to continuebreaking the rules?</p><P>The Serial Switch 'cdev' is a compromise between not allowing developers anysolution or Apple redesigning the serial driver and waiting for developers toimplement it. For the moment, this Serial Switch 'cdev' is the best solutionavailable; however, Apple is working on improving the Serial Driver to solvethis problem. Unfortunately, it was not possible to produce this improvedSerial Driver in time for the Macintosh IIfx introduction.</p><h2>Where to get detailed Zilog Z8530 SCC documentation</h2><P>Date Written:    3/9/90</p><P>Last reviewed:    12/17/90</p><P>I need to find documentation for the Zilog Z8530 SCC beyond <i>InsideMacintosh.</i> Do you how I can contact Zilog or another vendor for thisdocumentation?</p><P>You can get documentation on the SCC from the following source:</p>          <P>Advanced Micro Devices (AMD Z8530)<br>          901 Thompson Place<br>          P.O. Box 3453<br>          Sunnyvale, CA 94088</p><P><A HREF="#top">Back to top</A></p><P><A NAME=Downloads></A></p>          <h2>Downloadables</h2>          <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">  <TR>   <td width=50 align=left>     <P align=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></p></TD>   <td align="left">     <P>Acrobat version of this Note (52K)</p>   </TD>   <td width=60 align=left>     <P><A HREF="pdf/hw_545.pdf">Download</A></p>   </TD>  </TR></table><BR><P><A HREF="#top">Back to top</A></p></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/hw/hw_545.html%3Fid%3DDTS10002512-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/hw/hw_545.html%3Fid%3DDTS10002512-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/hw/hw_545.html%3Fid%3DDTS10002512-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>