<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><meta name="keywords" content="scrapbook scrap book file format"><meta name="Description" content="Technical Note TB24: This Technical Note talks about theformat of the scrap book file."><title>Technical Note TB24: Scrapbook File Format</title>                                       <meta name="categories" content="Human Interface Toolbox"><meta name="week-posted" content="Apr 26, 1993 - May 7, 1993"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002775" title="Scrapbook File Format"></a><a name="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxCarbon-date.html">Carbon</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/Carbon/idxHumanInterfaceToolbox-date.html" target="_blank">Carbon > Human Interface Toolbox</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TB24</div>
<div id="pageheadsub">Scrapbook File Format</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext"><A HREF="#Section1">Introduction</A><BR><BR><A HREF="#Section2">Example</A><BR><BR><A HREF="#Section3">Scrapbook and QuickTime</A><BR><BR><A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">This Technical Note discusses the format of the System 7.1 Scrapbook fileformat. The format may change in the future so be warned.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[May 01 1993]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><a name=Section1></A><h2>Introduction</h2><p>This Technical Note discusses the format of the Scrapbook file. Previously theformat was undocumented. Developers, however, have consistently asked fordocumentation of the format, so we are providing it with a strong word ofwarning. The format may change in the future, and your application riskscompatibility if you rely on it.</p><p>If you have decided to rely on the Scrapbook format, you should always code fora specific version of the Scrapbook file. The Scrapbook file will always have a'<code>vers' resource,</code> which you can check.</p><h3>Scrapbook Brief Overview</h3><p>The Scrapbook consists of a Scrapbook application and a Scrapbook file. TheScrapbook file is stored at the root of the System Folder. The Scrapbookapplication is usually stored in the Apple Menu Items folder.</p><h3>Scrapbook File Format Overview</h3><p>The resource fork of the Scrapbook file contains two permanent resources(<code>'SMAP'</code> and 'vers'), and up to 255 scrap items. The data fork is empty. Thus,any empty Scrapbook file will contain both a 'vers' resource and an <code>'SMAP'</code>resource. Each scrap item will have a variable number of associated resources.It may also have a dependent alias, as discussed below.</p><h3>Check the 'vers' Resource</h3><p>The Scrapbook file is part of the Scrapbook application. Because the Scrapbookapplication is part of system software, the Scrapbook file format is highlysubject to change. If you choose to open the file, you will need to identifythe Scrapbook file format version by checking the 'vers' resource in theScrapbook file. Your access of the Scrapbook file should be subject to theversion of the file that your application understands. If you do not understandthe version, then your application should not access the file. Your applicationshould <i>never</i> have Scrapbook File format access as a requirement.</p><h3>Format of the 'SMAP' Resource</h3><p>The <code>'SMAP'</code> resource is the key to the Scrapbook file format. The <code>'SMAP'</code>resource is a resource of 255 bytes. It is a three-dimensional table ofinformation. The <code>'SMAP'</code> keeps track of the resource IDs for Scrapbook items onone axis, and it keeps track of the order of the Scrapbook items on theother.</p><h3>Scrapbook Items</h3><p>The Scrapbook application works with Scrapbook items, which are groupings ofrelated resources. Many objects associated with the Macintosh desktop containmore than one resource. An icon, for example, has about six resourcesassociated with it. The Scrapbook, however, needs to treat these groupings asone item. To the end user, he or she is merely pasting in an icon and removingit.</p><p>A Scrapbook item is uniquely identified to the Scrapbook by a resource ID. Allresources with the same resource ID belong to the same Scrapbook item. Thus, anicon's resources would be considered a Scrapbook item.</p><h3>Generating Unique Resource IDs</h3><p>When you paste a Scrapbook item in to the Scrapbook, the Scrapbook needs togenerate a unique resource ID for that item. And because Scrapbook items can becut and pasted at will, this method needs some way of recovering resource IDsthat are no longer being used.</p><p>The location of each of the 255 bytes in the <code>'SMAP'</code> resource represents aunique ID. For example, the first byte in the <code>'SMAP'</code> is associated with aresource ID of -32768. The second byte is associated with a resource ID of-32767. This continues sequentially until the Scrapbook limit of 255 items (aresource ID of -32512) is reached.</p><p>A used resource ID is represented by a nonzero value at that byte's position. Azero indicates an unused resource ID. When the Scrapbook needs a unique ID, itsequentially scans the Scrapbook file for a zero byte, calculates the resourceID, and uses it for the new Scrapbook item.</p><p>On the other hand, when a Scrapbook item is cut, the application first cuts allthe resources of the corresponding resource ID. It then finds the Scrapbookitem's resource ID in the <code>'SMAP'</code> resource, and sets its value to zero.</p><h3>Maintaining the Ordering of Scrapbook Items</h3><p>The <code>'SMAP'</code> file also maintains the order of Scrapbook items in the Scrapbook.The nonzero value at each location in an <code>'SMAP'</code> is the location in theScrapbook of the Scrapbook item. The value of the byte corresponds to the entrynumber in the Scrapbook.</p><P><A HREF="#top">Back to top</A></p><a name="Section2"></a><h2>Example</h2><p>For example, in the <code>'SMAP'</code> resource of your Scrapbook data file you may findthe following (looking with ResEdit at the <code>'SMAP'</code> resource):</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>0A07 0509 0801 0602</pre>	</TD></TR></TABLE></CENTER><p>Thus, if we take the first byte, the tenth Scrapbook item is identified by theresource ID-32768.</p><p>The information further translated:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>Res ID    Byte offset     Entry in Scrapbook    Entry in Scrapbook (Hex$)    Type-32768    00            10            A            moov-32767    01            7            7            PICT-32766    02            5            5            PICT-32765    03            9            9            PICT-32764    04            8            8            PICT-32763    05            1            1            PICT-32762    06            6            6            snd-32761    07            2            2            PICT (QT)-32760    08            4            4            PICT (QT)</pre>	</TD></TR></TABLE></CENTER><p>Thus, the snd resource is the sixth Scrapbook item in the Scrapbook. Itsresource ID is -32768 + 5 = -32762. The fourth item in the Scrapbook is aQuickTime picture with resource ID -32760.</p><P><A HREF="#top">Back to top</A></p><a name="Section3"></a><h2>Scrapbook and QuickTime</h2><p>When you paste a QuickTime movie into the Scrapbook, you will copy only themovie resource. Remember, even if you cut a movie from a self-contained movie,only the movie resource will be cut. When you paste the movie into theScrapbook, the movie gets pasted into the Scrapbook's file and the file is nowa dependent file. The <code>FinderInfo</code> of the Scrapbook file will now haveits shared bit set, and a dependent alias will be put in the resource fork ofthe Scrapbook file. When the movie is cut from the Scrapbook, its shared bitshould be reset and the dependent alias needs to be removed. Unfortunately,this does not occur with all versions of the Scrapbook because they do notsupport QuickTime.</p>         <a name="Downloads"></a>       <P><A HREF="#top">Back to top</A></p><h2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (44K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/tb_24.pdf">Download</A></P>               </TD>            </TR>                    </TABLE>         <BR></TD></TR></table></center><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tb/tb_24.html%3Fid%3DDTS10002775-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tb/tb_24.html%3Fid%3DDTS10002775-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tb/tb_24.html%3Fid%3DDTS10002775-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>