<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>CallComponentFunctionWithStorage (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING374></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-373.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-375.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-333.html"><B>Chapter 6 - Component Manager</B></A> / <A HREF="MoreToolbox-346.html"><B>Component Manager Reference</B></A><BR><DL><DD><A HREF="MoreToolbox-366.html"><B>Routines for Components</B></A> / <A HREF="MoreToolbox-372.html"><B>Dispatching to Component Routines</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING374-0></A>
<H3><A NAME=MARKER-9-315></A>CallComponentFunctionWithStorage</H3>
 <A NAME=MARKER-2-316></A>The <CODE>CallComponentFunctionWithStorage</CODE> function invokes a specified function <BR>of your component with the parameters originally provided by the application that called your component. You pass these parameters by specifying the same component parameters record that was received by your component's main entry point. The <CODE>CallComponentFunctionWithStorage</CODE> function also provides a handle to the memory associated with the current connection. <P>
<PRE>
FUNCTION CallComponentFunctionWithStorage 
               (storage: Handle; params: ComponentParameters;
                func: ComponentFunction): LongInt;
</PRE>
<DL>
<DT><CODE><A NAME=MARKER-2-317></A>storage</CODE>
<DD> A handle to the memory associated with the current connection. The Component Manager provides this handle to your component along with the request.
<DT><CODE>params</CODE>
<DD> The component parameters record that your component received from the Component Manager.
<DT><CODE>func</CODE>
<DD> The address of the function that is to handle the request. The Component Manager calls the routine referred to by the <CODE>func</CODE> parameter as a Pascal function with the parameters that were originally provided by the application. These parameters are preceded by a handle to the memory associated with the current connection. The routine referred to by the <CODE>func</CODE> parameter must return a function result of type <CODE>ComponentResult</CODE> (a long integer) indicating the success or failure of the operation.
</DL>
<A NAME=HEADING374-6></A>
<H5>DESCRIPTION</H5>
 The <CODE>CallComponentFunctionWithStorage</CODE> function returns the value that is returned by the function referred to by the <CODE>func</CODE> parameter. Your component should use this value to set the current error for this connection. <P>
<A NAME=HEADING374-8></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 <CODE>CallComponentFunctionWithStorage</CODE> takes as a parameter a handle to the memory associated with the connection, so subroutines of a component that don't need global data should use the <CODE>CallComponentFunction</CODE> routine described in the previous section instead.<P>
 If your component subroutine requires a handle to the memory associated with the connection, you must use <CODE>CallComponentFunctionWithStorage</CODE>. You allocate the memory for a given connection each time your component is opened. You inform the Component Manager that a connection has memory associated with it by calling the <CODE>SetComponentInstanceStorage</CODE> procedure.<P>
<A NAME=HEADING374-11></A>
<H5>SEE ALSO</H5>
 For an example that uses <CODE>CallComponentFunctionWithStorage</CODE>, <BR>see <A HREF=MoreToolbox-342.html#MARKER-9-56>Listing 6-5 on page 6-16</A>. Use the <CODE>SetComponentInstanceError</CODE> procedure, described on <A HREF=MoreToolbox-382.html#MARKER-9-340>page 6-67</A>, to set the current error for a connection. A description of the <CODE>SetComponentInstanceStorage</CODE> procedure is given next.<A NAME=MARKER-2-318></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-373.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-375.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
