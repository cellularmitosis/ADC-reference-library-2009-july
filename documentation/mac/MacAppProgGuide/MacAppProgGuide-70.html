<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Editing Text (MacApp PG)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING70></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MacAppProgGuide-69.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-71.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MacAppProgGuide-2.html"><B>Programmer's Guide to MacApp</B></A> / <A HREF="MacAppProgGuide-21.html"><B>Part 1 - MacApp Theory and Architecture</B></A><BR><DD><A HREF="MacAppProgGuide-63.html"><B>Chapter 8 - Displaying, Manipulating, and Printing Data</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING70-0></A>
<H1><A NAME=MARKER-9-316></A><A NAME=MARKER-2-317></A>Editing Text</H1>
 MacApp provides the <CODE>TTEView</CODE> class, a subclass of <CODE>TView,</CODE> to supply text-editing capability. Objects of this class represent TextEdit records, as described in <I><A HREF="../Text/Text-2.html">Inside Macintosh: Text</A></I>. TextEdit is a simple text-editing facility built into the operating system. The purpose of <CODE>TTEView</CODE> is to make TextEdit function properly in a MacApp application, for tasks such as scrolling, printing, displaying page breaks, and handling commands.<P>
 <A NAME=MARKER-2-318></A>In addition to the <CODE>TTEView</CODE> class, MacApp's text-editing support includes the following classes:<P>
<DL>
<DT><CODE><A NAME=MARKER-2-319></A>TDialogTEView<B></B></CODE>
<DD> The <CODE>TDialogTEView</CODE> class provides a floating <CODE>TTEView</CODE> that is placed over edit and number text fields to support text editing.
<DT><CODE>TEditText<B></B></CODE>
<DD> This control view class supports entering and modifying text data.
<DT><CODE><A NAME=MARKER-2-321></A>TFloatingTEManager</CODE>
<DD> The <CODE>TFloatingTEManager</CODE> class supplies a <CODE>TDialogTEView</CODE> object on demand. An instance of the <CODE>TFloatingTEManager</CODE> class is created in the <CODE>InitUDialog</CODE> initialization routine and is referenced by <CODE>gFloatingTEManager</CODE>.
<DT><CODE><A NAME=MARKER-2-322></A>TNumberText<B></B></CODE>
<DD> The <CODE>TNumberText</CODE> control view class can accept and validate numeric data.
<DT><CODE><A NAME=MARKER-2-323></A>TTECommand<B></B></CODE>
<DD> This is the base command class for undoable text-editing command classes.
<DT><CODE><A NAME=MARKER-2-324></A>TTECutCopyCommand</CODE>
<DD> The <CODE>TTECutCopyCommand</CODE> class supports cut, copy, and clear of text, with undo.
<DT><CODE><A NAME=MARKER-2-325></A>TTEDragDropCommand</CODE>, <CODE><A NAME=MARKER-2-326></A>TTEDragMoveCommand<BR></CODE>These command classes support dragging text into, out of, and within a view, with undo. MacApp's support for drag and drop is described in <A HREF=MacAppProgGuide-72.html#MARKER-9-29>Chapter 9, "Drag and Drop."</A>
<DD>
<DT><CODE><A NAME=MARKER-2-327></A>TTEPasteCommand<B></B></CODE>
<DD> The <CODE>TTEPasteCommand</CODE> class supports pasting of text, with undo.
<DT><CODE><A NAME=MARKER-2-328></A>TTEStyleCommand<B></B></CODE>
<DD> The <CODE>TTEStyleCommand</CODE> class supports changing of text style, with undo.
<DT><CODE><A NAME=MARKER-2-329></A>TTETypingCommand<B></B></CODE>
<DD> The <CODE>TTETypingCommand</CODE> class supports typing of text, <BR>with undo.
</DL>
 The DemoDialogs sample application demonstrates text editing in various kinds of dialog boxes, with drag and drop implemented in some of the samples. The DemoText sample application implements a document that supports text editing, including drag and drop and support for PowerTalk mailers. For information on using a text-editing view in your application, see <A HREF=MacAppProgGuide-102.html#MARKER-9-87>"Recipe--Using a Document Class With a Text-Editing View," beginning on page 434</A>.<P>
<A NAME=HEADING70-14></A>
<H2><A NAME=MARKER-2-330></A><A NAME=MARKER-9-331></A>The TDialogTEView Class</H2>
 MacApp supplies the <CODE><A NAME=MARKER-2-332></A>TDialogTEView</CODE> class, a subclass of <CODE>TTEView</CODE>, to perform text editing in <CODE>TEditText</CODE> and <CODE>TNumberText</CODE> views. When a <CODE><A NAME=MARKER-2-333></A>TEditText</CODE> or <CODE>TNumberText</CODE> view is the target view, MacApp superimposes a <CODE>TDialogTEView</CODE> object to do the actual editing. The <CODE>TDialogTEView</CODE> object is said to "float" over the current text field. When editing is complete, the edit or number text view extracts the edited text from the <CODE>TDialogTEView</CODE> object.<P>
 The global <CODE>gFloatingTEManager</CODE> object is responsible for supplying a <CODE>TDialogTEView</CODE> view when one is needed. If possible, it reuses an existing <CODE>TDialogTEView</CODE> object.<P>
<A NAME=HEADING70-17></A>
<H3><A NAME=MARKER-2-335></A>Editing With TEditText Objects</H3>
 The <CODE>TDialogTEView</CODE> class is specialized for editing the text in <CODE>TEditText</CODE> or <CODE>TNumberText</CODE> objects:<P>
<UL>
<LI>In its initialization method, the <CODE>TDialogTEView</CODE> class creates a scroller to control scrolling of text.
<LI>The <CODE><A NAME=MARKER-2-336></A>fEditText</CODE> field stores a reference to the edit or number text view that is the current target of editing.
<LI>The <CODE>InstallEditText</CODE> method sets up the <CODE>TDialogTEView</CODE> object to work with the current edit text view, including <P>
<UL>
<LI>resizing itself to fit the edit text view
<LI>setting its text and text style from the edit text view
<LI>installing its scroller as a superview of the edit text view
<LI>setting its <CODE>fEditText</CODE> field to the edit text view<P>
</UL>
</UL>
 You don't normally create <CODE>TDialogTEView</CODE> objects yourself--MacApp creates them as needed, as described in the next section.<P>
<A NAME=HEADING70-27></A>
<H3><A NAME=MARKER-2-338></A>Installing a TDialogTEView Object for the Current View</H3>
 As part of its target management function, MacApp installs a <CODE>TDialogTEView</CODE> object to handle editing whenever a <CODE>TEditText</CODE> or <CODE>TNumberText</CODE> view becomes the current target. This can happen when<P>
<UL>
<LI>the edit text view is the default target in an activated window
<LI>a user clicks in the edit text view with the mouse
<LI>a user tabs into the edit text field<P>
</UL>
 Target management is described in detail in <A HREF=MacAppProgGuide-43.html#MARKER-9-127>"Target Management," beginning on page 113</A>.<P>
 In general, MacApp does the following when a user action or program operation causes a need to change the current target object:<P>
<OL>
<LI>MacApp calls the <CODE><A NAME=MARKER-2-339></A>ResignTarget</CODE> method of the current target object to see if that object is willing to resign as the target. If its contents are invalid, the target object can refuse to resign and can inform the user about the invalid data and how to correct the problem.
<LI>If the current target object is willing to resign, MacApp then calls <CODE>gApplication-&gt;<A NAME=MARKER-2-340></A>SetTarget</CODE> to set the new target. The <CODE>SetTarget</CODE> method<P>
<UL>
<LI>calls the <CODE><A NAME=MARKER-2-341></A>ResignedTarget</CODE> method of the current target, allowing that object to make any final adjustments
<LI>sets the current target to the new target
<LI>calls the <CODE><A NAME=MARKER-2-342></A>BecameTarget</CODE> method of the new target so that it can perform any preparations needed to serve as the target object<P>
</UL>
<LI>For edit and number text views, the <CODE>BecameTarget</CODE> method of the <CODE>TEditText</CODE> class makes the following calls:<P>
<pre>this-&gt;<A NAME=MARKER-2-343></A>InstallFloatingTEView(FALSE);<BR>gApplication-&gt;SetTarget(fTEView);</pre>
<LI>The <CODE>TEditText</CODE>::<CODE>InstallFloatingTEView</CODE> method <P>
<UL>
<LI>gets a <CODE>TDialogTEView</CODE> object from the global <CODE><A NAME=MARKER-2-344></A>gFloatingTEManager</CODE> object
<LI>calls the <CODE>TDialogTEView</CODE> object's <CODE><A NAME=MARKER-2-345></A>InstallEditText</CODE> method
<LI>sets the edit text object's <CODE><A NAME=MARKER-2-346></A>fTEView</CODE> field to refer to the <CODE>TDialogTEView</CODE> object<P>
</UL>
<LI>The <CODE>InstallEditText</CODE> method of the <CODE>TDialogTEView</CODE> object performs a number of tasks to prepare the view for editing and becomes the current target object through the call to <CODE>SetTarget</CODE>.<P>
</OL>
 When a user finishes editing in an edit or number text view, MacApp calls the <CODE>ResignedTarget</CODE> method of the <CODE>TDialogTEView</CODE> object. As a result, the edit text view sets its text to the contents of the <CODE>TDialogTEView</CODE> object and the <CODE>TDialogTEView</CODE> object is removed.<A NAME=MARKER-2-347></A><A NAME=MARKER-2-348></A><A NAME=MARKER-2-349></A><A NAME=MARKER-2-350></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MacAppProgGuide-69.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-71.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MacAppProgGuide-3.html">&copy; Apple Computer, Inc.</A><br>25 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
