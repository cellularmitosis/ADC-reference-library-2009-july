<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>

	<!-- BEGIN META TAG INFO -->
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<link rel="home" href="http://developer.apple.com/">
	<link rel="find" href="http://developer.apple.com/search/">
	<link rel="stylesheet" type="text/css" href="../../documentation/css/adcstyle.css" title="fonts">
	<script language="JavaScript" src="../../documentation/js/adc.js" type="text/javascript"></script>
	<!-- END META TAG INFO -->
	
	<!-- BEGIN TITLE -->
	<title>AuthForAll - /Read Me About AuthForAll.txt</title>
	<!-- END TITLE -->
<script language="JavaScript">
function JumpToNewPage() {
	window.location=document.scpopupmenu.gotop.value;
	return true;
}
</script>

</head>

<!-- BEGIN BODY OPEN -->
<body>
<!--END BODY OPEN -->

<!-- START CENTER OPEN -->
<center>
<!-- END CENTER OPEN -->

	<!-- BEGIN LOGO AND SEARCH -->
	<!--#include virtual="/includes/adcnavbar"-->
	<!-- END LOGO AND SEARCH -->
		
		
	<!-- START BREADCRUMB -->
	<div id="breadcrumb">
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td scope="row"><img width="340" height="10" src="images/1dot.gif" alt=""></td>
			<td><img width="340" height="10" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr valign="middle">
			<td align="left" colspan="2">
			<a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../samplecode/index.html">Sample Code</a> &gt; <a href="../../samplecode/Security/index.html">Security</a> &gt; <a href="../../samplecode/Security/idxAuthorization-date.html">Authorization</a> &gt; <A HREF="javascript:location.replace('index.html');">AuthForAll</A> &gt; 
			</td>
		</tr>
		<tr>
			<td colspan="2" scope="row"><img width="680" height="35" src="images/1dot.gif" alt=""></td>
		</tr>
	</table>
	</div>
	<!-- END BREADCRUMB -->

	

	<!-- START MAIN CONTENT -->
	
	<!-- START TITLE GRAPHIC AND INTRO-->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td><h1><div id="pagehead">AuthForAll</div></h1></td>
		</tr>
	</table>
	<!-- END TITLE GRAPHIC AND INTRO -->
	<!-- START WIDE COLUMN -->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td id="scdetails">
				<h2>/Read Me About AuthForAll.txt</h2>
				<form name="scpopupmenu" onSubmit="return false;" method=post>
				<p><strong>View Source Code:</strong> 
					<select name="gotop" onChange="JumpToNewPage();" style="width:340px"><option selected value="ingnore">Select File</option>
<option value="listing1.html">/AuthForAll.c</option>
<option value="listing2.html">/AuthForAllImpl.c</option>
<option value="listing3.html">/AuthForAllImpl.h</option>
<option value="listing4.html">/AuthForAllImplCompat.c</option>
<option value="listing5.html">/Read Me About AuthForAll.txt</option></select>
				</p>
				</form>
				<p><strong><a href="AuthForAll.zip">Download Sample</a></strong> (&#147;AuthForAll.zip&#148;, 75.6K)<BR>
<strong><a href="AuthForAll.dmg">Download Sample</a></strong> (&#147;AuthForAll.dmg&#148;, 129.3K)</p>
				<!--
				<p><strong><a href="#">Download Sample</a></strong> (&#147;filename.sit&#148;, 500K)</p>
				-->
			</td>
		</tr>
		<tr>
			<td scope="row"><img width="680" height="10" src="images/1dot.gif" alt=""><br>
			<img height="1" width="680" src="images/1dot_919699.gif" alt=""><br>
			<img width="680" height="20" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr>
			<td scope="row">
	<!--googleon: index -->
<pre class="sourcecodebox">Read Me About AuthForAll
========================
1.1

This sample shows how to use Authorization Services to create a self-restricted
application. The techniques shown in this sample are explained in depth in DTS
Technote 2095 &quot;Authorization for Everyone&quot;.

    &lt;http://developer.apple.com/technotes/tn2002/tn2095.html&gt;

The authorization database APIs used by this sample require Mac OS X 10.3 or
higher, however, the sample include a compatibility target that allows it to
run on earlier systems.

Packing List
------------
The sample contains the following items:

o Read Me About AuthForAll.txt \xD1 This document.
o AuthForAll.xcodeproj \xD1 An Xcode 2.1 file for the entire sample.
o AuthForAll_Prefix.pch \xD1 The project pre-compiled header.
o build \xD1 A folder containing the project build results.
o AuthForAll.c \xD1 Source for the main application.
o AuthForAllImpl.h \xD1 Interface between the main application and the
implementation.
o AuthForAllImpl.c \xD1 Source for the implementation that relies on Mac OS X 10.3
or higher.
o AuthForAllImplCompat.c \xD1 Source for the implementation that works for earlier
systems.
o main.nib \xD1 Project user interface.
o en.lproj \xD1 English localized resources.
o en_AU.lproj \xD1 Australian English localised resources.
o Info.plist \xD1 Properties for the application.
o InfoPlist.strings \xD1 Localized properties

Using the Sample
----------------
To run the sample, just double click one of the applications in the build
folder. If you're running on Mac OS X 10.3 or later, you can run either
application. If you're running on an earlier system, you must run the
AuthForAllCompat application. If you click the &quot;Alpha&quot; button, you should get
no authorization dialog. If you click the &quot;Beta&quot; button, you should get the
standard &quot;authorize as an admin user&quot; dialog.

Building the Sample
-------------------
The sample was built using Xcode 2.1 on Mac OS X 10.4. The project contains
three targets, AuthForAll, AuthForAllCompat, and All. The &quot;AuthForAll&quot; target
builds an application that runs only on Mac OS X 10.3 and later. The
&quot;AuthForAllCompat&quot; target builds an application that runs on earlier systems. 
The &quot;All&quot; target builds both applications.

How it Works
------------
For a detailed discussion of how it works, see DTS Technote 2095 &quot;Authorization
for Everyone&quot;.

    &lt;http://developer.apple.com/technotes/tn/tn2095.html&gt;

Caveats
-------
I tested AuthForAllCompat on 10.2.6 and later.  I didn't get a chance to test
it on 10.1, but there's no reason why it shouldn't work.

Mac OS X 10.4 introduced two bugs that affect this code.

o &lt;rdar://problem/4199765&gt; Tiger breaks custom prompts in Auth Services -- This
bug prevents the system from immediately picking up a custom prompt associated
with a new right added using AuthorizationRightSet.  You can work around this
by touching &quot;/etc/authorization&quot;.

o &lt;rdar://problem/4199768&gt; Tiger breaks localised prompts in Auth Services --
This bug causes the system to use the wrong localization for authorization
dialogs.  Specifically, it breaks the Australian English example given in the
&quot;Localization&quot; section of the technote.  I don't know of any workaround.

These problems are related to Mac OS X 10.4 and occur on all architectures.

The AuthForAllCompat target is built for the PowerPC architecture only.  This
is because Xcode 2.1 does not let you use a different version of GCC for
different architectures, and code built with GCC 4.0 will not run prior to Mac
OS 10.3.9.  You can work around this with sufficient application of lipo
&lt;x-man-page://1/lipo&gt;, but I didn't think that this was justified for a
compatibility target.

Credits and Version History
---------------------------
If you find any problems with this sample, mail &lt;dts@apple.com&gt; and I'll try to
fix them up.

1.0a1 (Oct 2003) was the first shipping version.

1.1 (Aug 2005) was an update to produce a universal binary. No code changes
were required.  However, I did make a few minor changes to tidy up the build
system and eliminate compiler warnings.

Share and Enjoy.

Apple Developer Technical Support
Networking, Communications, Hardware

1 Aug 2005
</pre>
	<!--googleoff: index -->
			</td>
		</tr>
	</table>
	<!-- END WIDE COLUMN -->

	<!-- END MAIN CONTENT -->
		<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/samplecode/AuthForAll/listing5.html%3Fid%3DDTS10001084-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/samplecode/AuthForAll/listing5.html%3Fid%3DDTS10001084-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/samplecode/AuthForAll/listing5.html%3Fid%3DDTS10001084-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

	<!-- START BOTTOM APPLE NAVIGATION -->
	<!--#include virtual="/includes/footer"-->
	<!-- END BOTTOM APPLE NAVIGATION -->

<!-- START CENTER CLOSE -->
</center>
<!-- END CENTER CLOSE -->

</body>
</html>