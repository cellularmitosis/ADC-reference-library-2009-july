<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE> Picking in Immediate Mode</TITLE></HEAD><BODY BGCOLOR="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- path goes here --><H1 CLASS="H2.Heading2"><A NAME="pgfId=3570"> </A>Picking in Immediate Mode</H1><P CLASS="T1.Text1"><A NAME="pgfId=3571"> </A>Picking IDs are particularly useful when picking in immediate mode. <A HREF="qd3dpicking.a.htm#40998" CLASS="XRef">Listing&nbsp;7</A> shows how to create a triangle, attach a picking ID to it, and then process hits.</P><P CLASS="L.Listing"><A NAME="pgfId=3826"> </A>Listing&nbsp;7<A NAME="40998"> </A>Picking in immediate mode</P><CODE CLASS="CvF.CodeFull"><A NAME="pgfId=16348"> </A>void MyImmediateModePickID (TQ3ViewObject view, WindowPtr window)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;TQ3WindowRectPickData&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myPickData;<BR>&nbsp;&nbsp;&nbsp;&nbsp;TQ3TriangleData&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myTriangleData;<BR>&nbsp;&nbsp;&nbsp;&nbsp;TQ3PickObject&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myPick;<BR>&nbsp;&nbsp;&nbsp;&nbsp;TQ3ViewStatus&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myViewStatus;<BR>&nbsp;&nbsp;&nbsp;&nbsp;unsigned long&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pickID;<BR>&nbsp;&nbsp;&nbsp;&nbsp;Rect&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myPortRect;<BR>&nbsp;&nbsp;&nbsp;&nbsp;Point&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myCenter;<BR>&nbsp;&nbsp;&nbsp;&nbsp;unsigned long&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myNumHits;<BR></CODE><CODE CLASS="CvF.CodeFull"><A NAME="pgfId=16354"> </A>&nbsp;&nbsp;&nbsp;&nbsp;/*Set up a triangle.*/<BR>&nbsp;&nbsp;&nbsp;&nbsp;Q3Point3D_Set(&amp;myTriangleData.vertices[0].point, -1.0, -0.5, 0.0);<BR>&nbsp;&nbsp;&nbsp;&nbsp;Q3Point3D_Set(&amp;myTriangleData.vertices[1].point,  1.0,  0.0, 0.0);<BR>&nbsp;&nbsp;&nbsp;&nbsp;Q3Point3D_Set(&amp;myTriangleData.vertices[2].point, -0.5,  1.5, 0.0);<BR>&nbsp;&nbsp;&nbsp;&nbsp;myTriangleData.vertices[0].attributeSet = NULL;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myTriangleData.vertices[1].attributeSet = NULL;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myTriangleData.vertices[2].attributeSet = NULL;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myTriangleData.triangleAttributeSet = NULL;<BR></CODE><CODE CLASS="CvF.CodeFull"><A NAME="pgfId=16360"> </A>&nbsp;&nbsp;&nbsp;&nbsp;/*Set up TQ3WindowPointPickData structure.*/<BR>&nbsp;&nbsp;&nbsp;&nbsp;myPickData.data.sort = kQ3PickSortNone;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myPickData.data.mask = kQ3PickDetailMaskPickID | kQ3PickDetailMaskObject;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myPickData.data.numHitsToReturn = kQ3ReturnAllHits;<BR></CODE><CODE CLASS="CvF.CodeFull"><A NAME="pgfId=16366"> </A>&nbsp;&nbsp;&nbsp;&nbsp;myPortRect = ((GrafPtr) window)-&gt;myPortRect;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myCenter.h = (myPortRect.right  - myPortRect.left)/2.0;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myCenter.v = (myPortRect.bottom - myPortRect.top) /2.0;<BR></CODE><CODE CLASS="CvF.CodeFull"><A NAME="pgfId=16372"> </A>&nbsp;&nbsp;&nbsp;&nbsp;Q3Point2D_Set(&amp;myPickData.rect.min, myCenter.h - 5, myCenter.v - 5);<BR>&nbsp;&nbsp;&nbsp;&nbsp;Q3Point2D_Set(&amp;myPickData.rect.max, myCenter.h + 5, myCenter.v + 5);<BR></CODE><CODE CLASS="CvF.CodeFull"><A NAME="pgfId=16378"> </A>&nbsp;&nbsp;&nbsp;&nbsp;/*Create the window rectangle window pick.*/<BR>&nbsp;&nbsp;&nbsp;&nbsp;myPick = Q3WindowRectPick_New(&amp;myPickData);<BR></CODE><CODE CLASS="CvF.CodeFull"><A NAME="pgfId=16384"> </A>&nbsp;&nbsp;&nbsp;&nbsp;/*Submit the pick ID and triangle in immediate mode.*/<BR>&nbsp;&nbsp;&nbsp;&nbsp;Q3View_StartPicking(view, myPick);<BR>&nbsp;&nbsp;&nbsp;&nbsp;do<BR>&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q3PickIDStyle_Submit(kPickID, view);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q3Triangle_Submit(&amp;myTriangleData, view);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myViewStatus = Q3View_EndPicking(view);<BR>&nbsp;&nbsp;&nbsp;&nbsp;} while (myViewStatus == kQ3ViewStatusRetraverse);<BR></CODE><CODE CLASS="CvF.CodeFull"><A NAME="pgfId=16390"> </A>&nbsp;&nbsp;&nbsp;&nbsp;Q3Pick_GetNumHits(myPick, &amp;myNumHits);<BR>&nbsp;&nbsp;&nbsp;&nbsp;if (numHits == 1)<BR>&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*Get the pickID data (for first and only hit) and check if it's <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the expected pick ID.*/<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q3Pick_GetPickDetailData(myPick, 0);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (pickID == kPickID)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*picked on triangle with pick ID*/<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;&nbsp;}<BR></CODE><CODE CLASS="CvF.CodeFull"><A NAME="pgfId=16396"> </A>&nbsp;&nbsp;&nbsp;&nbsp;Q3Object_Dispose(myPick);<BR>}<BR></CODE><hr>&#169; 1997 Apple Computer, Inc.</DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY></HTML>