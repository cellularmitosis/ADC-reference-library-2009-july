<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Determining the Collection Index of an Item(IM: XU)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING194></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="GXEnvironment-193.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="GXEnvironment-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="GXEnvironment-445.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="GXEnvironment-195.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="GXEnvironment-2.html"><B>QuickDraw GX Environment and Utilities</B></A> / <BR><DD><A HREF="GXEnvironment-182.html"><B>Chapter 5 - Collection Manager</B></A> / <A HREF="GXEnvironment-188.html"><B>Using the Collection Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING194-0></A>
<H2><A NAME=MARKER-9-47></A>Determining the Collection Index of an Item</H2>
 <A NAME=MARKER-2-48></A><A NAME=MARKER-2-49></A>Once you have added an item to a collection, you can identify that item in three ways:<P>
<UL>
<LI>You can specify its collection tag and ID.
<LI>You can specify its collection tag and its tag list position.
<LI>You can specify its collection index.<P>
</UL>
 A collection index is a unique value that the Collection Manager assigns to each item in a collection. You can use an item's collection index to identify the item without specifying the item's collection tag or collection ID. In fact, once you've determined the collection index of an item, specifying that item using its collection index results in faster operations than specifying the item using its collection tag and collection ID.<P>
 There are two ways to determine the collection index that the Collection Manager has assigned to an item:<P>
<UL>
<LI>You can use the <CODE>GetCollectionItemInfo</CODE> function. With this function, you specify the collection tag and collection ID of the item, and the function returns the item's collection index.
<LI>You can use the <CODE>GetTaggedCollectionItemInfo</CODE> function. With this function, you specify the collection tag and the tag list position of the item, and the function returns the item's collection index.<P>
</UL>
 Both of these functions optionally return other information about the specified item, as shown in the next two sections.<P>
 <A HREF=#MARKER-9-50>Listing 5-5</A> shows how to use the the <CODE>GetCollectionItemInfo</CODE> function to determine the collection index of an item from the sample collection created in <A HREF=GXEnvironment-193.html#MARKER-9-43>"Adding Items to a Collection" beginning on page 5-17</A>. This listing uses the <CODE>dontWantSize</CODE> and <CODE>dontWantAttributes</CODE> constants, which are equal to <CODE>nil</CODE> and specify that you don't want to determine certain information about the item. These constants are described in <A HREF=GXEnvironment-210.html#MARKER-9-111>"Optional Return Value Constants" on page 5-49</A>.<P>
<B>Listing 5-5  <A NAME=MARKER-9-50></A>Determining the index of an item</B><P>
<PRE>
long index;
.
.
.
anErr = GetCollectionItemInfo(pointsAndQuotes, /* collection */
                              'GXPT', 15,  /* tag and id */
                              &amp;index,  /* returned index */
                              dontWantSize,
                              dontWantAttributes); 
</PRE>
 After this call to <CODE>GetCollectionItemInfo</CODE> function, the <CODE>index</CODE> variable contains the collection index of the item in the <CODE>pointsAndQuotes</CODE> collection with the <CODE>'GXPT'</CODE> collection tag and a collection ID of 15. You can use this value to identify this item when using certain Collection Manager functions, such as <CODE>RemoveIndexedCollectionItem</CODE> and <CODE>GetIndexedCollectionItem</CODE>.<P>
 You can also use the <CODE>GetTaggedCollectionItemInfo</CODE> function to determine the collection index of a collection item. This function allows you to specify the item using the item's collection tag and tag list position. For example, in <A HREF=#MARKER-9-50>Listing 5-5</A>, the item is specified using the <CODE>'GXPT'</CODE> collection tag and collection ID 15. Assuming the Collection Manager has assigned this item a tag list position of 11, you could also use the call<P>
<PRE>
anErr = GetTaggedCollectionItemInfo(pointsAndQuotes, 
                                    'GXPT', /* collection tag */
                                    11, /* tag list position */
                                    dontWantId, 
                                    &amp;index, /* returned index */
                                    dontWantSize, 
                                    dontWantAttributes);
</PRE>
 to determine the collection index for that item.<P>
 For more information about identifying collection items, see <A HREF=GXEnvironment-187.html#MARKER-9-23>"Methods of Identifying Collection Items" on page 5-11</A>. <P>
 For more information about the <CODE>GetCollectionItemInfo</CODE> and <CODE>GetTaggedCollectionItemInfo</CODE> functions, see <A HREF=GXEnvironment-244.html#MARKER-9-206>"Getting Information About a Collection Item" beginning on page 5-76</A>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="GXEnvironment-193.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="GXEnvironment-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="GXEnvironment-445.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="GXEnvironment-195.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="GXEnvironment-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
