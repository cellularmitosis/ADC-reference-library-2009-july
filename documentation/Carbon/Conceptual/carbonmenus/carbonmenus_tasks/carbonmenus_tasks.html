<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Creating Carbon Menus: Carbon Menu Tasks</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Carbon Menu Tasks"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30001065-CH202" title="Carbon Menu Tasks"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000420" target="_top">Carbon</a> &gt; <a href="../../../UserExperience-date.html#//apple_ref/doc/uid/TP30000440-TP30000420-TP30000465" target="_top">User Experience</a> &gt; <a href="../carbonmenus_conc/carbonmenus_conc.html#//apple_ref/doc/uid/TP30001065-CH201-DontLinkElementID_6">Creating Carbon Menus</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../carbonmenus_conc/carbonmenus_conc.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../carbonmenus_rev/carbonmenus_rev.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_20" title="Carbon Menu Tasks"></a><h1>Carbon Menu Tasks</h1><p>This chapter describes how to create Carbon
menus in Interface Builder and load them into your application. </p>


<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="carbonmenus_tasks.html#//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_2">Creating a Menu Using Nibs</a>
				
			<br/>
			
        
			
			
				<a href="carbonmenus_tasks.html#//apple_ref/doc/uid/TP30001065-CH202-TPXREF133">Creating Menus From a Nib file</a>
				
			<br/>
			
        
			
			
				<a href="carbonmenus_tasks.html#//apple_ref/doc/uid/TP30001065-CH202-CGHGBAGC">Simple Event Handling</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_2" title="Creating a Menu Using Nibs"></a><h2>Creating a Menu Using Nibs</h2>
<p>While you can create menus by calling various Carbon Menu
Manager functions, it is much easier to create them using the Interface
Builder tool included with Xcode.</p>
<p><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_45"></a>Interface
Builder is Apple&#8217;s graphical user interface layout tool. In true
WYSIWYG fashion, you simply drag user interface elements onto windows,
menus, and controls to create your interfaces. This information
is stored in a nib file, which your application can access using a
few simple function calls. </p>
<p><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_46"></a>Interface
Builder has many advantages over other layout methods:</p>
<ul class="ul"><li class="li"><p>The WYSIWYG
interface makes it easy to visualize your interface objects.</p></li>
<li class="li"><p>Its ease of use allows for experimenting and rapid prototyping.</p></li>
<li class="li"><p>Special guides makes it easy to conform to Aqua&#8217;s layout
guidelines.</p></li>
<li class="li"><p>Simple APIs make it easy to create interface objects from
nib files. </p></li></ul>
<div class="importantbox"><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_21" title="Important:"></a><p><strong>Important:</strong>&nbsp;

While InterfaceBuilder is associated with Xcode, Apple&#8217;s development
environment, you do not need to use Xcode to take advantage of Interface
Builder&#8217;s nib files. </p><p></p></div>
<p><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_47"></a><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_48"></a>You
can use Interface Builder&#8217;s nib files even if you are working
with legacy code. Applications can support both nib-based and older
resource-based windows and controls at the same time, so you can
make the transition as gradual as you like. Nib file support is available
back to Mac OS 8.6 using CarbonLib. </p>
<p>Interface Builder is included on the Xcode CD available with
Mac OS X. </p>
<a name="//apple_ref/doc/uid/TP30001065-CH202-TPXREF121" title="The Nib File"></a><h3>The Nib File</h3>
<p><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_49"></a><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_50"></a>Interface
Builder stores all the information about your application&#8217;s windows,
menus, and controls in a nib file (typically named <em>filename</em>.<em>nib</em> ).
When creating a new file, Interface Builder gives you the option
of selecting what type of nib file you want to create. When creating
interfaces for Carbon applications, you should always select one
of the Carbon options, as shown in <span class="content_text"><a href="carbonmenus_tasks.html#//apple_ref/doc/uid/TP30001065-CH202-BCICGGAA">Figure 2-1</a></span>. </p>
<br/><div><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_22" title="Figure 2-1Opening dialog for new nib files"></a><p><a name="//apple_ref/doc/uid/TP30001065-CH202-BCICGGAA" title="Figure 2-1Opening dialog for new nib files"></a><strong>Figure 2-1&nbsp;&nbsp;</strong>Opening dialog for new nib files</p>
<img src = "../art/nib_menu_start.gif" alt = "" width="253" height="279"></div><br/>
<p>When you select Menu Bar or Main Window With Menu Bar, Interface
Builder brings up a default menu bar as shown in <span class="content_text"><a href="carbonmenus_tasks.html#//apple_ref/doc/uid/TP30001065-CH202-CGHEGJJE">Figure 2-2</a></span>, which
you can then populate with your menus and menu items. </p>
<br/><div><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_23" title="Figure 2-2The default menu bar"></a><p><a name="//apple_ref/doc/uid/TP30001065-CH202-CGHEGJJE" title="Figure 2-2The default menu bar"></a><strong>Figure 2-2&nbsp;&nbsp;</strong>The default menu bar</p>
<img src = "../art/default_ib_menubar.gif" alt = "" width="236" height="52"></div><br/>
<p>Note that this menu bar already contains the standard menus
required for applications (File, Edit, Window, and so on). Clicking
on any menu opens it, displaying the standard menu items for each
menu. </p>
<p>If your application does not require certain menu items (if
your application does not require printing, for example), you can
simply select the item and hit Delete to remove it. Similarly, if
you do not need an entire menu, you can select its title and delete
it. </p>
<p>If you select a menu and then select the Show Info menu item
in Interface Builder&#8217;s Tools menu, you bring up the Info Palette
for that menu, as shown in <span class="content_text"><a href="carbonmenus_tasks.html#//apple_ref/doc/uid/TP30001065-CH202-CGHGDDHE">Figure 2-3</a></span>. </p>
<br/><div><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_24" title="Figure 2-3The Info panel for a menu"></a><p><a name="//apple_ref/doc/uid/TP30001065-CH202-CGHGDDHE" title="Figure 2-3The Info panel for a menu"></a><strong>Figure 2-3&nbsp;&nbsp;</strong>The Info panel for a menu</p>
<img src = "../art/menu_info_window.gif" alt = "" width="206" height="315"></div><br/>
<p>The Info panel allows you to set various menu attributes,
such as the title, the menu ID, and so on. </p><div class="notebox"><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_25" title="Note"></a><p><strong>Note:</strong>&nbsp;The
popup menu in the Info window lets you select four other panes:
Control, Size, Layout, and Help. However, none of these other panes
apply to menus. </p></div>
<p>The Menu title is self-explanatory. The Menu ID is used to
identify the menu in certain Menu Manager calls. You can also set
these fields programmatically by calling the Menu Manager functions
in <span class="content_text"><a href="carbonmenus_tasks.html#//apple_ref/doc/uid/TP30001065-CH202-CGHCJJHI">Table 2-1</a></span>.</p>
<a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_26" title="Table 2-1Menu features"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">
<caption class="tablecaption"><a name="//apple_ref/doc/uid/TP30001065-CH202-CGHCJJHI" title="Table 2-1Menu features"></a><strong>Table 2-1&nbsp;&nbsp;</strong>Menu features</caption>

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Panel Item</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Menu Manager Function Equivalent</p></th>
</tr>


<tr>
<td  scope="row"><p>Menu ID</p></td>
<td ><p><code>SetMenuID</code></p></td>
</tr>
<tr>
<td  scope="row"><p>Title</p></td>
<td ><p><code>SetMenuTitleWithCFString</code></p></td>
</tr>

</table></div>
<p>The checkboxes correspond to menu attributes that you can
set or unset using the <code>ChangeMenuAttributes</code> function,
as shown in <span class="content_text"><a href="carbonmenus_tasks.html#//apple_ref/doc/uid/TP30001065-CH202-CGHCDBDG">Table 2-2</a></span>.</p><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_27" title="Table 2-2Menu Info panel attributes"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">
<caption class="tablecaption"><a name="//apple_ref/doc/uid/TP30001065-CH202-CGHCDBDG" title="Table 2-2Menu Info panel attributes"></a><strong>Table 2-2&nbsp;&nbsp;</strong>Menu Info panel attributes</caption>

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Panel Checkbox</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>When Checked</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Menu Attribute to Pass to ChangeMenuAttributes</p></th>
</tr>


<tr>
<td  scope="row"><p>Excludes Mark Column </p></td>
<td ><p>Specifies that the menu shouldn&#8217;t allocate any column
space for mark characters</p></td>
<td ><p><code>kMenuAttrExcludesMarkColumn</code> </p></td>
</tr>
<tr>
<td  scope="row"><p>AutoDisable </p></td>
<td ><p>Disables the menu if all its menu items are disabled.</p></td>
<td ><p><code>kMenuAttrAutoDisable</code> </p></td>
</tr>
<tr>
<td  scope="row"><p>Use Pencil Glyph </p></td>
<td ><p>Use the Pencil glyph (Japanese input method menus only)</p></td>
<td ><p><code>kMenuAttrUsePencilGlyph</code> </p></td>
</tr>
<tr>
<td  scope="row"><p>Hidden </p></td>
<td ><p>Menu is hidden</p></td>
<td ><p><code>kMenuAttrHidden</code> </p></td>
</tr>
<tr>
<td  scope="row"><p>Use Condensed Separators </p></td>
<td ><p>Hide extra separators to eliminate blank spaces in the
menu.</p></td>
<td ><p><code>kMenuAttrUseCondensedSeparator</code> </p></td>
</tr>

</table></div>
<p>If you select a menu item, the Show Info palette displays
appropriate menu item attributes, as shown in <span class="content_text"><a href="carbonmenus_tasks.html#//apple_ref/doc/uid/TP30001065-CH202-CGHHBICD">Figure 2-4</a></span>. As with the menu information,
the pop up menu lets you select other panes: Control, Size, Layout,
and Help. However, except for Help, which lets you assign a help
tag (sometimes called a tool tip) to a menu item, none of the other
panes apply to menu items.</p>
<br/><div><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_28" title="Figure 2-4The Info panel for a menu item"></a><p><a name="//apple_ref/doc/uid/TP30001065-CH202-CGHHBICD" title="Figure 2-4The Info panel for a menu item"></a><strong>Figure 2-4&nbsp;&nbsp;</strong>The Info panel for a menu item</p>
<img src = "../art/menu_item_info_window.gif" alt = "" width="209" height="316"></div><br/>
<p>The Menu item title is, again, self-explanatory. The Menu
Key is the letter or number in the menu item&#8217;s keyboard equivalent
(for example, the C in Command-C). You can then check the appropriate
checkbox or checkboxes to select the accompanying combination of
Shift, Option, Control, or Command keys required to activate the
keyboard equivalent. </p>
<p>The Command field is the four-character code that specifies
the menu item&#8217;s command ID. This is the ID that the Carbon Event
Manager sends to your application in a <code>kEventCommandProcess</code> event
when the user selects this menu item. The popup menu lists a number
of predefined command IDs for common menu tasks (such as Cut, Copy,
New, and so on). </p>
<p>You can set these fields programmatically by calling the appropriate
function in <span class="content_text"><a href="carbonmenus_tasks.html#//apple_ref/doc/uid/TP30001065-CH202-CGHFDBII">Table 2-3</a></span>. </p><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_29" title="Table 2-3Menu item features"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">
<caption class="tablecaption"><a name="//apple_ref/doc/uid/TP30001065-CH202-CGHFDBII" title="Table 2-3Menu item features"></a><strong>Table 2-3&nbsp;&nbsp;</strong>Menu item features</caption>

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Panel Item</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Menu Manager Function Equivalent</p></th>
</tr>


<tr>
<td  scope="row"><p>Title</p></td>
<td ><p><code>SetMenuItemTitleWithCFString</code></p></td>
</tr>
<tr>
<td  scope="row"><p>Menu Key and Keyboard Modifier</p></td>
<td ><p><code>SetMenuItemCommandKey</code></p></td>
</tr>
<tr>
<td  scope="row"><p>Command</p></td>
<td ><p><code>SetMenuItemCommandID</code></p></td>
</tr>

</table></div>
<p>The checkboxes correspond to various menu item attributes,
most of which you can set or unset using the <code>ChangeMenuItemAttributes</code> function,
as shown in <span class="content_text"><a href="carbonmenus_tasks.html#//apple_ref/doc/uid/TP30001065-CH202-CGHDFBIC">Table 2-4</a></span>. </p><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_30" title="Table 2-4Menu Item Attributes"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">
<caption class="tablecaption"><a name="//apple_ref/doc/uid/TP30001065-CH202-CGHDFBIC" title="Table 2-4Menu Item Attributes"></a><strong>Table 2-4&nbsp;&nbsp;</strong>Menu Item Attributes</caption>

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Panel Checkbox</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>When Checked</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Menu Item Attribute to Set</p></th>
</tr>


<tr>
<td  scope="row"><p>Enabled</p></td>
<td ><p>The menu item is enabled</p></td>
<td ><p>Unset <code>kMenuItemAttrDisabled</code></p></td>
</tr>
<tr>
<td  scope="row"><p>Checked</p></td>
<td ><p>The menu item has a check mark</p></td>
<td ><p>No attribute. Use the <code>SetItemMark</code> function
to set.</p></td>
</tr>
<tr>
<td  scope="row"><p>Submenu Parent Choosable</p></td>
<td ><p>The user can select this parent of a submenu</p></td>
<td ><p><code>kMenuItemAttrSubmenuParentChoosable</code></p></td>
</tr>
<tr>
<td  scope="row"><p>Dynamic</p></td>
<td ><p>Indicates that this menu item is part of a dynamic group.
See <span class="content_text"><a href="carbonmenus_tasks.html#//apple_ref/doc/uid/TP30001065-CH202-CGHIGHGE">“Dynamic Menu Items”</a></span> for more information. </p></td>
<td ><p><code>kMenuItemAttrDynamic</code></p></td>
</tr>
<tr>
<td  scope="row"><p>Not Previous Alternate</p></td>
<td ><p>Indicates that this menu item is not part of the previous dynamic
group. See <span class="content_text"><a href="carbonmenus_tasks.html#//apple_ref/doc/uid/TP30001065-CH202-CGHIGHGE">“Dynamic Menu Items”</a></span> for more information.</p></td>
<td ><p><code>kMenuItemAttrNotPreviousAlternate</code></p></td>
</tr>
<tr>
<td  scope="row"><p>Hidden</p></td>
<td ><p>Menu item is hidden.</p></td>
<td ><p><code>kMenuItemAttrHidden</code></p></td>
</tr>
<tr>
<td  scope="row"><p>IgnoreMeta</p></td>
<td ><p>Ignore the dash (-) meta character when drawing this item.
Only required if you want to display a dash in your menu item. See
Menu Manager Reference for more details. </p></td>
<td ><p><code>kMenuItemAttrIgnoreMeta</code></p></td>
</tr>
<tr>
<td  scope="row"><p>Section Header</p></td>
<td ><p>Item is a section header. This item is disabled and cannot
be selected. </p></td>
<td ><p><code>kMenuItemAttrSectionHeader</code></p></td>
</tr>
<tr>
<td  scope="row"><p>Custom Draw</p></td>
<td ><p>Indicates that this is a custom menu item. The Menu Manager sends
the appropriate menu drawing events to your application. See Menu
Manager Reference for more details. </p></td>
<td ><p><code>kMenuItemAttrCustomDraw</code></p></td>
</tr>
<tr>
<td  scope="row"><p>Auto Repeat</p></td>
<td ><p>Indicates that <code>IsMenuKeyEvent</code> recognizes
this item when an autorepeating keyboard event occurs. </p></td>
<td ><p><code>kMenuItemAttrAutoRepeat</code></p></td>
</tr>
<tr>
<td  scope="row"><p>Auto Disable</p></td>
<td ><p>Indicates that this item is automatically disabled if
the item does not respond to the <code>kEventCommandUpdateStatus</code> event.
See Menu Manager Reference for more details. </p></td>
<td ><p><code>kMenuItemAttrAutoDisable</code></p></td>
</tr>
<tr>
<td  scope="row"><p>Update Single Item</p></td>
<td ><p>Update only the menu item with the matching command key when
calling <code>IsMenuKeyEvent</code>. See
Menu Manager Reference for more details.</p></td>
<td ><p><code>kMenuItemAttrUpdateSingleItem</code></p></td>
</tr>
<tr>
<td  scope="row"><p>Use in Cmd Key Matching</p></td>
<td ><p>Consider this item when using <code>IsMenuKeyEvent</code> to
match a command key to a menu item. </p></td>
<td ><p><code>kMenuItemAttrIncludeInCmdKeyMatching</code></p></td>
</tr>

</table></div>
<p>Use <code>SetMenuItemIconHandle</code> to
set an icon in a menu item. </p>
<a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_3" title="The Menus Palette"></a><h3>The Menus Palette</h3>
<p>For Carbon applications, Interface Builder provides five different
layout palettes, which are displayed in the Carbon palettes window.
If the window is not already open, you can do so by choosing Palettes
from Interface Builder&#8217;s Tools menu. This document focuses on the
Menu palette, which you can display by selecting the leftmost item
in the palette window toolbar. <span class="content_text"><a href="carbonmenus_tasks.html#//apple_ref/doc/uid/TP30001065-CH202-CGHDGHBB">Figure 2-5</a></span> shows the Menus palette</p>
<div class="notebox"><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_31" title="Note"></a><p><strong>Note:</strong>&nbsp;The
Carbon layout palettes differ from those used for Cocoa applications..
Make sure that you select a Carbon-based nib when creating a new
nib file. </p></div>
<br/><div><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_32" title="Figure 2-5The Menus palette"></a><p><a name="//apple_ref/doc/uid/TP30001065-CH202-CGHDGHBB" title="Figure 2-5The Menus palette"></a><strong>Figure 2-5&nbsp;&nbsp;</strong>The Menus palette</p>
<img src = "../art/carbon_menu_palette.gif" alt = "" width="234" height="170"></div><br/>
<p>You add menus or menu items to the menu bar by simply dragging
the appropriate blue box from the menu palette. </p>
<ul class="spaceabove"><li class="li"><p>The Application
element corresponds to the menu containing the application name immediately
to the left of the Apple menu. You should rename the menu title
to be your application&#8217;s name. By default, this menu contains
only the About <em>AppName</em> menu item, but often
you will want to add more.</p><p>Note that the system automatically
adds additional menu items to the end of the Application menu at
run time (Services, Hide, Hide Others, Show All, and Quit).</p><p>The
system also adds a Preferences menu item at runtime (with the standard Command-,
keyboard shortcut), but this is hidden by default. To access the
menu item, you need to call <code>GetIndMenuItemWithCommandID</code>,
searching for the <code>kHICommandPreferences</code> command
ID. After obtaining the menu item, you can make it visible and otherwise manipulate
it. </p></li>
<li class="li"><p>The File, Edit, and Window elements correspond to those particular
menu types, and they contain the default items for those menu types.
For example, the Edit menu contains the Copy, Cut, and Paste items,
among others. </p></li>
<li class="li"><p>The Submenu element can be used for any nonstandard menus
you want to add to the menu bar. If you drag the Submenu item to
the menu bar, it becomes a new menu, which you can then rename and
populate as necessary. If you drag the Submenu item into an existing
menu, it becomes a submenu. You an position the menu as desired
by simply dragging it to the desired location. </p></li>
<li class="li"><p>The Item element corresponds to a menu item. You can drag
an item into any menu or submenu, and position it as desired. </p></li>
<li class="li"><p>The empty element corresponds to a separator item. This special
menu item appears as a gray line, and is used to group menu items
into logical categories. </p></li></ul>
<p>At run time, the system automatically adds an Apple menu to
the left of the Application menu. You should not add any application-specific
menu items to the Apple menu. </p>
<div class="importantbox"><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_33" title="Important:"></a><p><strong>Important:</strong>&nbsp;
Interface Builder does not provide many built-in guides
for how to arrange menus and menu items, which means that it is
your responsibility to make sure your menus correspond to the Aqua specification.
Be sure to follow the guidelines in <em><a href="../../../../UserExperience/Conceptual/AppleHIGuidelines/index.html#//apple_ref/doc/uid/20000957" target="_top">Apple Human Interface Guidelines</a></em> for naming and arranging menus and menu items.</p><p></p></div>
<a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_4" title="Creating a Simple Menu"></a><h3>Creating a Simple Menu</h3>
<p>This section gives a step-by step example of adding a simple
menu to the menu bar. The ideas and methods used apply to any menu
you may want to create. </p>
<ul class="spaceabove"><li class="li"><p>First, begin
with a menu bar. The default menu bar is already populated with
the standard Application, File, Edit, and Window menus. If your
application uses multiple menu bars, you should assign each a unique
name by selecting the title in the main nib window, as shown in
figure. You specify this name in your application when it comes time
to create a menu bar from the nib. </p></li>
<li class="li"><p>To add a new menu to the menu bar, drag a Submenu item from
the Menu palette. While dragging, a faint red line appears in the
menu bar to indicate where the menu will appear. If you don&#8217;t
like where it ended up, you can simply drag it to a new location,
or simply remove it by selecting it and hitting Delete. </p></li>
<li class="li"><p>You can rename the menu by double-clicking on it or by changing
the title from the Info palette. You can also assign a menu ID if
you like. </p></li>
<li class="li"><p>Clicking on the menu in the menu bar opens it, displaying
a single menu item. If you want to add additional menu items, you
can drag them from the Menu palette. </p></li>
<li class="li"><p>For each item, you assign a name by double-clicking the item
or by changing the title from the Info panel. If desired you can
also assign a keyboard equivalent and check any desired attributes.
You should also assign a command ID to each item, which will be
used in event handling. See <span class="content_text"><a href="carbonmenus_tasks.html#//apple_ref/doc/uid/TP30001065-CH202-CGHGBAGC">“Simple Event Handling”</a></span> for
more details. </p></li></ul>
<a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_5" title="Standalone Menus"></a><h3>Standalone Menus</h3>
<p>Interface Builder also allows you to create standalone menus
that are not part of the menu bar. You may want to create such menus
if you want to insert them into the menu bar at some later time.
For example, you can use these menus in popup or contextual menus. </p>
<p>To create a standalone menu, drag the menu icon in the lower
right of the Menus palette to the Instances pane of the main nib
window. A menu then appears in the Instances pane, and a small menu
window appears containing two items. By selecting the menu in the instance
pane, you can change its title and other attributes in the Info
window. You can modify the menu items in a similar fashion, just
as if they were in a menu installed in the menu bar. </p>
<br/><div><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_34" title="Figure 2-6A Standalone Menu"></a><p><strong>Figure 2-6&nbsp;&nbsp;</strong>A
Standalone Menu</p><img src = "../art/standalonemenu.gif" alt = "" width="455" height="257"></div><br/>
<a name="//apple_ref/doc/uid/TP30001065-CH202-CGHIGHGE" title="Dynamic Menu Items"></a><h3>Dynamic Menu Items</h3>
<p>In some cases, you may want to create menu items that change
depending on the state of the modifier keys held down by the user.
For example, in the default Window menu, a menu item named &#8220;Minimize
Window&#8221; changes to &#8220;Minimize All Windows&#8221; when the user depresses
the Option key while the menu is open. Similarly, if the keyboard equivalent
Command-M activates &#8220;Minimize Window,&#8221; Command-Option-M activates &#8220;Minimize
All Windows.&#8221; Such items are called dynamic menu items. </p>
<p>Creating a dynamic menu item requires you to create two or
more menu items in Interface Builder, one for each possible state.</p>
<p><span class="content_text"><a href="carbonmenus_tasks.html#//apple_ref/doc/uid/TP30001065-CH202-BEIDDDAJ">Figure 2-7</a></span> shows two menu items that make up the Minimize dynamic
item. To indicate that they are dynamic and should work together,
you must check the Dynamic attribute for each item. In addition,
each item must have the same letter or number for its keyboard equivalent.
The modifier keys for the keyboard equivalent do not have to &#8220;stack.&#8221;
For example, you can specify that Command-K activate &#8220;Remove Mark&#8221;
while Option-K activates &#8220;Remove All Marks.&#8221; You can specify
several different modifier keys for a single dynamic menu. </p>
<div class="notebox"><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_35" title="Note"></a><p><strong>Note:</strong>&nbsp;You
do not have to specify a keyboard equivalent to get dynamic behavior.
If you leave the Menu Key blank, depressing only the appropriate
modifer key causes the menu item to change. </p></div>
<br/><div><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_36" title="Figure 2-7Dynamic menu items"></a><p><a name="//apple_ref/doc/uid/TP30001065-CH202-BEIDDDAJ" title="Figure 2-7Dynamic menu items"></a><strong>Figure 2-7&nbsp;&nbsp;</strong>Dynamic menu items</p>
<img src = "../art/dynamic_menu_items.gif" alt = "" width="366" height="326"></div><br/>
<p>The Menu Manager assumes that if multiple sequential menu
items have the same menu key, the are part of the same dynamic group.
However, if there is a case where a menu item with the same command
key (or no command key at all) should not be considered part of the
dynamic group, you can flag it by checking the NotPreviousAlternate
attribute for that item. Any menu items that follow are also not
considered to be part of the dynamic group. </p>
<a name="//apple_ref/doc/uid/TP30001065-CH202-TPXREF133" title="Creating Menus From a Nib file"></a><h2>Creating Menus From a Nib file</h2>
<p><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_51"></a><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_52"></a>After
you have created a nib file containing your menus, you can access
them from your application. </p>
<p>Note that while a nib file can contain multiple windows, menus,
and so on, to make the best use of resources, you may want to break
up your user interface elements among several nib files. For example,
you can put your main menu bar and menus in one nib file, windows
in another, and so on. </p>
<p><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_53"></a><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_54"></a>To
make sure your application can find the nib file, you should place
it in the Resources folder of your application&#8217;s bundle hierarchy,
as shown in <span class="content_text"><a href="carbonmenus_tasks.html#//apple_ref/doc/uid/TP30001065-CH202-BCICBFCI">Figure 2-8</a></span>. For information about creating application bundles,
see <em><a href="../../../../MacOSX/Conceptual/OSX_Technology_Overview/index.html#//apple_ref/doc/uid/TP40001067" target="_top">Mac OS X Technology Overview </a></em>.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_37" title="Note"></a><p><strong>Note:</strong>&nbsp;<a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_55"></a><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_56"></a>If
your nib files contain localizable text, you should create separate
nib files for each language you want to support. Each nib should
be placed in the appropriate <code>.lproj</code> folder
within the Resources folder.</p></div>
<br/><div><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_38" title="Figure 2-8The nib file in an application bundle"></a><p><a name="//apple_ref/doc/uid/TP30001065-CH202-BCICBFCI" title="Figure 2-8The nib file in an application bundle"></a><strong>Figure 2-8&nbsp;&nbsp;</strong>The nib file in an application bundle</p>
<img src = "../art/nibfile.gif" alt = "" width="287" height="210"></div><br/>
<p>When retrieving menus from a nib, you can either load the
entire menu bar with its associated windows, or load a particular
menu.</p>
<p><span class="content_text"><a href="carbonmenus_tasks.html#//apple_ref/doc/uid/TP30001065-CH202-BCIBCDFB">Listing 2-1</a></span> shows how you to load a menu bar from a nib. </p>
<a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_39" title="Listing 2-1Creating a menu bar from a nib file"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP30001065-CH202-BCIBCDFB" title="Listing 2-1Creating a menu bar from a nib file"></a><strong>Listing 2-1&nbsp;&nbsp;</strong>Creating a menu bar from a nib file</p>
<div class="codesample"><table><tr><td scope="row"><pre>OSStatus err;<span></span></pre></td></tr><tr><td scope="row"><pre>IBNibRef theNib;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>err = CreateNibReference (CFSTR("MyGuitar"), &amp;theNib);  <span>// 1</span></pre></td></tr><tr><td scope="row"><pre>if (!err)<span></span></pre></td></tr><tr><td scope="row"><pre>    SetMenuBarFromNib (theNib, CFSTR("GuitarMenu"));  <span>// 2</span></pre></td></tr></table></div>
<p>Here is what the code does:</p>
<ol class="ol"><li class="li"><p>The Interface
Builder Services function <code>CreateNibReference<a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_57"></a></code> simply
creates a nib reference that points to the specified file. In this
case, the file is <code>MyGuitar.nib</code> (you
don&#8217;t need to specify the <code>.nib</code> extension
when calling this function). The <code>CFSTR</code> function converts
the string into a Core Foundation string, which is the format that <code>CreateNibReference</code> expects. </p></li>
<li class="li"><p>The Interface Builder Services function <code>SetMenuBarFromNib</code><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_58"></a> uses
the nib reference to access a menu bar within the nib file. The
name of the menu bar (<code>GuitarMenus</code> in
this example) is the name you assigned to it in the Instances pane
of the nib file window. As with the <code>CreateNibReference</code> function, <code>SetMenuBarFromNib</code> expects
a Core Foundation string for the window name, so it must first be
converted using <code>CFSTR</code>.
The created window is stored as a window reference in <code>theWindow</code>. </p><p>Note
that <code>SetMenuBarFromNib</code> automatically
sets the menu bar you specified to be visible. If for some reason
you want to create a menu bar but don&#8217;t want it to be immediately
visible, you can call <code>CreateMenuBarFromNib</code>. </p></li></ol>
<p>The complete menu bar can now appear in your application.
However, while the facade is there (and the menus and menu items
are functional), this menu bar does not do anything useful. To make
the menu items do useful work, you must attach Carbon event handlers, which
are described in detail in <span class="content_text"><a href="carbonmenus_tasks.html#//apple_ref/doc/uid/TP30001065-CH202-CGHGBAGC">“Simple Event Handling.”</a></span><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_59"></a><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_60"></a><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_61"></a></p>
<a name="//apple_ref/doc/uid/TP30001065-CH202-CGHGBAGC" title="Simple Event Handling"></a><h2>Simple Event Handling</h2>
<p>After you have populated the menu bar with your menus and
menu items, you need to make them functional, which means they must
be able to respond to events. To do so, you must install Carbon
event handlers. To get the most out of this section, you should
be familiar the Carbon Event Manager, as described in Handling Carbon
Events in Carbon Events and Other Input documentation. </p>
<p>For most applications, you should assign a command ID to each
menu item. The command ID is a four-character code that uniquely
identifies a particular action. When the user selects a menu item,
the Carbon Event Manager sends a <code>kEventCommandProcess</code> event containing
the menu item&#8217;s command ID to your application. You application
can then filter the event to determine the command ID and take the
appropriate action. </p><div class="notebox"><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_40" title="Note"></a><p><strong>Note:</strong>&nbsp;Command
IDs are also used in simple controls, such as push buttons, which initiate
a single action when activated. If you have a menu item that performs
the same action as a control, you can assign the same command ID
to both; doing so means you only need one event handler to handle
both cases. </p></div>
<p><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_62"></a><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_63"></a>If you
assigned a command ID to your menu item, your application is sent
command events whenever the menu item is activated. Command events
are of the class <code>kEventClassCommand</code>. </p>
<p>The Carbon Event Manager defines command ID&#8217;s for many common
commands, such as OK, Cancel, Cut, Paste, and so on. You can also
define your own for application-specific commands. Your event handler
for the <code>kEventCommandProcess</code> event
can then determine which command ID was sent and take appropriate
action. </p>
<div class="importantbox"><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_41" title="Important:"></a><p><strong>Important:</strong>&nbsp;
Command IDs containing all lower-case letters are defined
by Apple; if you create nonstandard command IDs, they must contain at
least one upper-case letter. </p><p></p></div>
<p>You assign the command ID to a menu item in the Attributes
pane of Interface Builder&#8217;s Info window, as shown previously in <span class="content_text"><a href="carbonmenus_tasks.html#//apple_ref/doc/uid/TP30001065-CH202-CGHHBICD">Figure 2-4</a></span>. You
can also call the Menu Manager function <code>SetMenuItemCommandID</code>. </p>
<div class="notebox"><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_42" title="Note"></a><p><strong>Note:</strong>&nbsp;You
can also assign command IDs to controls by using Interface Builder
or by calling the Control Manager function <code>SetControlCommandID</code>.</p></div>
<p>The <code>kEventCommandProcess<a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_64"></a></code> event
indicates that your menu item was selected. The actual command ID
is stored within an <code>HICommand</code> structure
in the event reference, so you must call the Carbon Event Manager
function <code>GetEventParameter</code> to
retrieve it, as shown in <span class="content_text"><a href="carbonmenus_tasks.html#//apple_ref/doc/uid/TP30001065-CH202-BCIECIFI">Listing 2-2</a></span>. </p>
<a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_43" title="Listing 2-2Obtaining the command ID from the event reference"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP30001065-CH202-BCIECIFI" title="Listing 2-2Obtaining the command ID from the event reference"></a><strong>Listing 2-2&nbsp;&nbsp;</strong>Obtaining the command ID from the event
reference</p>
<div class="codesample"><table><tr><td scope="row"><pre>HICommand commandStruct;<span></span></pre></td></tr><tr><td scope="row"><pre>UInt32 theCommandID;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>GetEventParameter (event, kEventParamDirectObject,  <span>// 1</span></pre></td></tr><tr><td scope="row"><pre>                    typeHICommand, NULL, sizeof(HICommand),<span></span></pre></td></tr><tr><td scope="row"><pre>                    NULL, &amp;commandStruct);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>theCommandID = commandStruct.commandID; <span>// 2</span></pre></td></tr></table></div>
<p>Here is what the code does:</p>
<ol class="ol"><li class="li"><p>When calling <code>GetEventParameter</code>,
you must specify which parameter you want to obtain. For command
events, the direct object (<code>kEventParamDirectObject</code>)
is the <code>HICommand</code> structure,
which describes the command that occurred. </p></li>
<li class="li"><p>The command ID of the control (or menu) that generated the
event is stored in the <code>commandID</code> field
of the <code>HICommand</code> structure. </p></li></ol>
<p>To respond to events from menus, you should install your command
event handler at the window or application level. Doing so also
allows you to use the same handler to catch command events coming
from controls, if so desired. Also, attaching your handler at the window
level makes sense if you have menu items that apply to one type
of document window but not to another. </p>
<p><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_65"></a><a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_66"></a>After
handling a command, your application may need to change the state
of a menu item. For example, after saving a document, the Save menu
item should be disabled until the document changes. Whenever the
status of a command item might be in question, the system makes
a note of it. When the user takes an action that may require updating
the status (such as pulling down a menu), your application receives
a <code>kEventCommandUpdate<a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_67"></a></code> event.
To make sure that the states of your menus are properly synchronized,
you should install a handler for the <code>kEventCommandUpdate</code> event.
This handler should check the attributes bit of the command event
to determine which items may need updating. Some examples of possible
updates include</p>
<ul class="ul"><li class="li"><p>enabling
or disabling menu items</p></li>
<li class="li"><p>changing the text of a menu item (for example, from Show xxxx
to Hide xxxx).</p></li></ul>
<p>If the <code>kHICommandFromMenu</code> bit
in the <code>attributes</code> field
of the <code>HICommand</code> structure
(shown in <span class="content_text"><a href="carbonmenus_tasks.html#//apple_ref/doc/uid/TP30001065-CH202-BCICECEE">Listing 2-3</a></span>) is set, then you should check the menu item in question
to see if you need to update it. </p>
<a name="//apple_ref/doc/uid/TP30001065-CH202-DontLinkElementID_44" title="Listing 2-3The HICommand structure"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP30001065-CH202-BCICECEE" title="Listing 2-3The HICommand structure"></a><strong>Listing 2-3&nbsp;&nbsp;</strong>The HICommand structure</p>
<div class="codesample"><table><tr><td scope="row"><pre>struct HIComamnd<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    UInt32  attributes;<span></span></pre></td></tr><tr><td scope="row"><pre>    UInt32  commandID;<span></span></pre></td></tr><tr><td scope="row"><pre>    struct<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>        MenuRef         menuRef;<span></span></pre></td></tr><tr><td scope="row"><pre>        MenuItemIndex   menuItemIndex;<span></span></pre></td></tr><tr><td scope="row"><pre>    } menu;<span></span></pre></td></tr><tr><td scope="row"><pre>};<span></span></pre></td></tr></table></div>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../carbonmenus_conc/carbonmenus_conc.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../carbonmenus_rev/carbonmenus_rev.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2004 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2004-02-23<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Carbon/Conceptual/carbonmenus/carbonmenus_tasks/carbonmenus_tasks.html%3Fid%3DTP30001065-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Carbon/Conceptual/carbonmenus/carbonmenus_tasks/carbonmenus_tasks.html%3Fid%3DTP30001065-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Carbon/Conceptual/carbonmenus/carbonmenus_tasks/carbonmenus_tasks.html%3Fid%3DTP30001065-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>