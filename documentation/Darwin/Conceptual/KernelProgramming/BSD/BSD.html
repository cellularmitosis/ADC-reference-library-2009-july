<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Kernel Programming Guide: BSD Overview</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="BSD Overview"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30000905-CH214" title="BSD Overview"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000422" target="_top">Darwin</a> &gt; <a href="../../../Kernel-date.html#//apple_ref/doc/uid/TP30000440-TP30000422-TP30000532" target="_top">Kernel</a> &gt; <a href="../About/About.html#//apple_ref/doc/uid/TP30000905-CH204-TPXREF101">Kernel Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../IOKit/IOKit.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../Filesystem/Filesystem.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP30000905-CH214-TPXREF101" title="BSD Overview"></a><h1>BSD Overview</h1><p><a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_17"></a>The BSD portion of the Mac OS X kernel is derived primarily from <a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_18"></a>FreeBSD, a version of 4.4BSD that offers advanced networking, performance, security, and compatibility features. BSD variants in general are derived (sometimes indirectly) from 4.4BSD-Lite Release 2 from <a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_19"></a>the Computer Systems Research Group (CSRG) at the <a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_20"></a>University of California at Berkeley. BSD provides many advanced features, including the following:</p>
<ul class="ul"><li class="li"><p><a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_21"></a>Preemptive multitasking with dynamic priority adjustment. Smooth and fair sharing of the computer between applications and users is ensured, even under the heaviest of loads. </p></li>
<li class="li"><p><a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_22"></a>Multiuser access. Many people can use a Mac OS X system simultaneously for a variety of things. This means, for example, that system peripherals such as printers and disk drives are properly shared between all users on the system or the network and that individual resource limits can be placed on users or groups of users, protecting critical system resources from overuse. </p></li>
<li class="li"><p>Strong <a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_23"></a>TCP/IP networking with support for industry standards such as <a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_24"></a><a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_25"></a>SLIP, <a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_26"></a><a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_27"></a>PPP, and <a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_28"></a><a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_29"></a>NFS. Mac OS X can interoperate easily with other systems as well as act as an enterprise server, providing vital functions such as NFS (remote file access) and email services, or <a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_30"></a>Internet services such as HTTP, FTP, routing, and firewall (security<a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_31"></a>) services.</p></li>
<li class="li"><p><a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_32"></a>Memory protection. Applications cannot interfere with each other. One application crashing does not affect others in any way.</p></li>
<li class="li"><p><a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_33"></a><a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_34"></a>Virtual memory and dynamic memory allocation. Applications with large appetites for memory are satisfied while still maintaining interactive response to users. With the virtual memory system in Mac OS X, each application has access to its own 4 GB memory address space; this should satisfy even the most memory-hungry applications.</p></li>
<li class="li"><p>Support for kernel threads<a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_35"></a><a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_36"></a> based on <a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_37"></a><a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_38"></a>Mach threads. User-level threading packages are implemented on top of kernel threads. Each kernel thread is an independently scheduled entity. When a thread from a user process blocks in a system call, other threads from the same process can continue to execute on that or other processors. By default, a process in the conventional sense has one thread, the <a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_39"></a><a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_40"></a><strong>main thread</strong>. A user process can use the POSIX thread API to create other user threads.</p></li>
<li class="li"><p><a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_41"></a><a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_42"></a>SMP support. Support is included for computers with multiple CPUs.</p></li>
<li class="li"><p>Source code. Developers gain the greatest degree of control over the BSD programming environment because source is included.</p></li>
<li class="li"><p>Many of the <a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_43"></a>POSIX APIs.</p></li></ul>


<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="BSD.html#//apple_ref/doc/uid/TP30000905-CH214-TPXREF102">BSD Facilities</a>
				
			<br/>
			
        
			
			
				<a href="BSD.html#//apple_ref/doc/uid/TP30000905-CH214-TPXREF103">Differences between Mac OS X and BSD</a>
				
			<br/>
			
        
			
			
				<a href="BSD.html#//apple_ref/doc/uid/TP30000905-CH214-TPXREF104">For Further Reading</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP30000905-CH214-TPXREF102" title="BSD Facilities"></a><h2>BSD Facilities</h2>
<p>The facilities that are available to a user process are logically divided into two parts: kernel facilities and system facilities implemented by or in cooperation with a server process.</p>
<p>The facilities implemented in the kernel define the <a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_44"></a><strong>virtual machine</strong> in which each process runs. Like many real machines, this virtual machine has memory management, an interrupt facility, timers, and counters.</p>
<p>The virtual machine also allows access to files and other objects through a set of descriptors. Each descriptor resembles a device controller and supports a set of operations. Like devices on real machines, some of which are internal to the machine and some of which are external, parts of the descriptor machinery are built into the operating system, while other parts are often implemented in server processes.</p>
<p>The BSD component provides the following kernel facilities:</p>
<ul class="ul"><li class="li"><p>processes and protection</p><ul class="nested">
<li class="nested li"><p>host and process identifiers</p></li>
<li class="nested li"><p>process creation and termination</p></li>
<li class="nested li"><p>user and group IDs</p></li>
<li class="nested li"><p>process groups</p></li></ul></li>
<li class="li"><p><a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_45"></a>memory management</p><ul class="nested"><li class="nested li"><p>text, data, stack, and dynamic shared libraries</p></li>
<li class="nested li"><p>mapping pages</p></li>
<li class="nested li"><p>page protection control</p></li></ul></li>
<li class="li"><p>POSIX synchronization primitives</p></li>
<li class="li"><p>POSIX shared memory</p></li>
<li class="li"><p><a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_46"></a>signals</p><ul class="nested"><li class="nested li"><p>signal types</p></li>
<li class="nested li"><p>signal handlers</p></li>
<li class="nested li"><p>sending signals</p></li></ul></li>
<li class="li"><p>timing and statistics</p><ul class="nested"><li class="nested li"><p>real time</p></li>
<li class="nested li"><p>interval time</p></li></ul></li>
<li class="li"><p><a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_47"></a>descriptors</p><ul class="nested"><li class="nested li"><p>files</p></li>
<li class="nested li"><p>pipes</p></li>
<li class="nested li"><p>sockets</p></li></ul></li>
<li class="li"><p>resource controls</p><ul class="nested"><li class="nested li"><p>process priorities</p></li>
<li class="nested li"><p>resource utilization and resource limits</p></li>
<li class="nested li"><p>quotas</p></li></ul></li>
<li class="li"><p>system operation support</p><ul class="nested"><li class="nested li"><p>bootstrap operations</p></li>
<li class="nested li"><p>shut-down operations</p></li>
<li class="nested li"><p>accounting</p></li></ul></li></ul>
<p>BSD system facilities (facilities that may interact with user space) include</p>
<ul class="ul"><li class="li"><p>generic input/output operations such as read and write, nonblocking, and asynchronous operations</p></li>
<li class="li"><p>file-system operations</p></li>
<li class="li"><p>interprocess communication</p></li>
<li class="li"><p>handling of terminals and other devices</p></li>
<li class="li"><p>process control</p></li>
<li class="li"><p>networking operations</p></li></ul>
<a name="//apple_ref/doc/uid/TP30000905-CH214-TPXREF103" title="Differences between Mac OS X and BSD"></a><h2>Differences between Mac OS X and BSD</h2>
<p>Although the BSD portion of Mac OS X is primarily derived from FreeBSD, some changes have been made:</p>
<ul class="ul"><li class="li"><p>The <code>sbrk()</code> system call for memory management is deprecated. Its use is not recommended in Mac OS X.</p></li>
<li class="li"><p>The Mac OS X runtime model uses a different object file format for executables and shared objects, and a different mechanism for executing some of those executables.</p><p>The primary native format is <a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_48"></a><strong>Mach-O</strong>. This format is supported by the dynamic link editor (<a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_49"></a><strong>dyld</strong>).</p><p>The <a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_50"></a><a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_51"></a><strong>PEF</strong> binary file format is supported by the Code Fragment Manager (<a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_52"></a>CFM).</p><p>The kernel supports <code>execve()</code> with Mach-O binaries. Mapping and management of Mach-O dynamic shared libraries, as well as launching of PEF-based applications, are performed by user-space code.</p></li>
<li class="li"><p>Mac OS X does not support <a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_53"></a><a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_54"></a>memory-mapped devices through the<code> mmap()</code> function. (Graphic device support and other subsystems provide similar functionality, but using different APIs.) In Mac OS X, this interface should be done through user clients. See the Apple I/O Kit documents for additional information.</p></li>
<li class="li"><p>The<code> swapon()</code> call is not supported; <code>macx_swapon()</code> is the equivalent call from the Mach pager.</p></li>
<li class="li"><p>The <a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_55"></a>Unified Buffer Cache implementation in Mac OS X differs from that found in FreeBSD.</p></li>
<li class="li"><p>Mach provides a number of IPC primitives that are not traditionally found in UNIX. See <span class="content_text"><a href="../boundaries/boundaries.html#//apple_ref/doc/uid/TP30000905-CH217-BEHJDFCA">“Boundary Crossings”</a></span> for more information on Mach IPC. Some System V primitives are supported, but their use is discouraged in favor of POSIX equivalents.</p></li>
<li class="li"><p>Several changes have been made to the BSD security model to support single-user and multiple-administrator configurations, including the ability to disable ownership and permissions on a volume-by-volume basis.</p></li><li class="li"><p>The locking mechanism used throughout the kernel differs substantially from the mechanism used in FreeBSD.</p></li><li class="li"><p>The kernel extension mechanism used by Mac OS X is completely different. The Mac OS X driver layer, the I/O Kit, is an object-oriented driver stack written in C++. The general kernel programming interfaces, or KPIs, are used to write non-driver kernel extensions. These mechanisms are described more in <span class="content_text"><a href="../IOKit/IOKit.html#//apple_ref/doc/uid/TP30000905-CH213-SW1">“I/O Kit Overview”</a></span> and <em><a href="../../../Reference/KPI_Reference/index.html#//apple_ref/doc/uid/TP40001274" target="_top">KPI Reference</a></em>, respectively.</p></li></ul>
<p>In addition, several new features have been added that are specific to the Mac OS X (Darwin) implementation of BSD. These features are not found in <a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_56"></a>FreeBSD.</p>
<ul class="ul"><li class="li"><p>enhancements to file-system <a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_57"></a>buffer cache and file I/O clustering</p><ul class="nested"><li class="nested li"><p>adaptive and speculative read ahead</p></li>
<li class="nested li"><p>user-process controlled read ahead</p></li>
<li class="nested li"><p>time aging of the file-system buffer cache</p></li></ul></li></ul>
<ul class="ul"><li class="li"><p>enhancements to file-system support</p><ul class="nested"><li class="nested li"><p>implementation of Apple extensions for ISO-9660 file systems</p></li>
<li class="nested li"><p>multithreaded asynchronous I/O for NFS</p></li>
<li class="nested li"><p>addition of system calls to support semantics of Mac OS Extended (HFS+<a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_58"></a>) file systems</p></li>
<li class="nested li"><p>additions to naming conventions for pathnames, as required for accessing multiple forks in Mac OS Extended file systems</p></li></ul></li></ul>
<a name="//apple_ref/doc/uid/TP30000905-CH214-TPXREF104" title="For Further Reading"></a><h2>For Further Reading</h2>
<p>The BSD component of the Mac OS X kernel is complex. A complete description is beyond the scope of this document. However, many excellent references exist for this component. If you are interested in BSD, be sure to refer to the bibliography for further information.</p>
<p>Although the BSD layer of Mac OS X is derived from 4.4BSD, keep in mind that it is not identical to 4.4BSD. Some functionality of 4.4 BSD has not been included in Mac OS X. Some new functionality has been added. The cited reference materials are recommended for additional reading. However, they should <em>not</em> be presumed as forming a definitive description of Mac OS X.</p>
<p><a name="//apple_ref/doc/uid/TP30000905-CH214-DontLinkElementID_59"></a></p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../IOKit/IOKit.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../Filesystem/Filesystem.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2002, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-11-07<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Conceptual/KernelProgramming/BSD/BSD.html%3Fid%3DTP30000905-5.7&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Conceptual/KernelProgramming/BSD/BSD.html%3Fid%3DTP30000905-5.7&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Conceptual/KernelProgramming/BSD/BSD.html%3Fid%3DTP30000905-5.7&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>