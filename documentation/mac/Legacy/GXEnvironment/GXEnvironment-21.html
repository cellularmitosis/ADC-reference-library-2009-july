<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Using the Macintosh Interface Functions(IM: XU)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING21></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="GXEnvironment-20.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="GXEnvironment-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="GXEnvironment-445.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="GXEnvironment-22.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="GXEnvironment-2.html"><B>QuickDraw GX Environment and Utilities</B></A> / <BR><DD><A HREF="GXEnvironment-15.html"><B>Chapter 1 - QuickDraw GX and the Macintosh Environment</B></A> / <A HREF="GXEnvironment-19.html"><B>Using QuickDraw GX in the Macintosh Environment</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING21-0></A>
<H2>Using the Macintosh Interface Functions</H2>
 <A NAME=MARKER-2-80></A>The QuickDraw GX Macintosh interface functions allow you to integrate QuickDraw GX with the Macintosh Toolbox. These functions allow you to<P>
<UL>
<LI>create and use view ports associated with Macintosh windows
<LI>retrieve a QuickDraw graphics device associated with a QuickDraw GX view device.
<LI>convert between QuickDraw and QuickDraw GX coordinate systems
<LI>intercept QuickDraw GX drawing functions for a view port <P>
</UL>
<A NAME=HEADING21-6></A>
<H3>Creating and Using View Ports with Macintosh Windows</H3>
 <A NAME=MARKER-2-134></A>QuickDraw GX drawing takes place in <B>view ports.</B> You can associate a view port with a window in order to clip drawing to the window's visible region. Once you've created a window, you can create a view port that is associated with that window by the use of the <CODE>GXNewWindowViewPort</CODE> function. When you attach a view port to a window, you guarantee that all the shapes that you draw to the view port will be drawn in the correct location within the window, even when the window is moved. You also guarantee that if the window is underneath others that the QuickDraw GX drawing will be clipped to the QuickDraw GX window's visible region. You can attach a view port to your window with the call<P>
<PRE>
windowParentViewPort = GXNewWindowViewPort(theWindow);
</PRE>
 The resulting <CODE>windowParentViewPort</CODE> contains the view port attached to the window. You cannot change either the mapping or the <B>clip</B> of the window view port. If you need to do either--for example, if you need to control position within the view port (as when scrolling) or clip drawing within the window (so you don't draw over scroll bars), you need to create a <B>child view port</B> of your window view port and draw only to it. Child view ports, <B>view port hierarchies,</B> and how to use them are described in detail in the chapter "View-Related Objects" in <I><A HREF="../../GXObjects/GXObjects-2.html">Inside Macintosh: QuickDraw GX Objects</A></I>. <P>
 Once you've created a view port, you can determine the view port that is associated with a specific window by using the <CODE>GXGetWindowViewPort</CODE> function. If you haven't associated a view port to that window, the function returns <CODE>nil</CODE>.<P>
 You can find out which window is associated with a view port by using the <CODE>GXGetViewPortWindow</CODE> function. The function returns <CODE>nil</CODE> if the view port is not associated with any window.<A NAME=MARKER-9-82></A><P>
 The <A NAME=MARKER-8-54></A>GXNewWindowViewPort function is described on <A HREF=GXEnvironment-32.html#MARKER-9-98>page 1-24</A>. The <CODE>GXGetWindowViewPort</CODE> function is described on <A HREF=GXEnvironment-34.html#MARKER-9-104>page 1-26</A>. The <CODE>GXGetViewPortWindow</CODE> function is described on <A HREF=GXEnvironment-33.html#MARKER-9-101>page 1-25</A>.<P>
<A NAME=HEADING21-13></A>
<H3>Using View Devices With Graphics Devices</H3>
 <A NAME=MARKER-2-108></A>On the Macintosh, every monitor gets a <B>graphics device,</B> described by a <CODE>GDevice</CODE> record. So when QuickDraw GX creates a screen <B>view device</B> for each monitor, there is already a graphics device for it. The <CODE>GXGetViewDeviceGDevice</CODE> and <CODE>GXGetGDeviceViewDevice</CODE> functions link the two worlds together, so that you can work with either description of a display device. <P>
 These functions work only with Macintosh system graphics devices. If you have a screen view device, you can call the <A NAME=MARKER-8-19></A><CODE>GXGetViewDeviceGDevice</CODE> function to get the graphics device that corresponds to that view device. If you create your own offscreen view device, it will not have an associated graphics device. Likewise, there is no view device associated with an offscreen <CODE>GDevice<B> </B></CODE>record.<P>
 The <CODE>GXGetViewDeviceGDevice</CODE> function is described on <A HREF=GXEnvironment-36.html#MARKER-9-109>page 1-27</A>; the <CODE>GXGetGDeviceViewDevice</CODE> function is described on <A HREF=GXEnvironment-37.html#MARKER-9-112>page 1-28</A>.<A NAME=MARKER-9-75></A><P>
<A NAME=HEADING21-17></A>
<H3><A NAME=MARKER-9-39></A>Converting From QuickDraw to QuickDraw GX Coordinates</H3>
 <A NAME=MARKER-9-84></A>QuickDraw GX provides several functions that involve conversion of locations on the QuickDraw coordinate plane into locations expressed in QuickDraw GX <B>local</B> or <B>global</B> <B>coordinates.</B><P>
<A NAME=HEADING21-19></A>
<H4>Converting from QuickDraw Global to QuickDraw GX Local or Global Coordinates</H4>
 <A NAME=MARKER-9-8></A>You can use the <A NAME=MARKER-9-134></A><CODE>GXConvertQDPoint</CODE> function to convert a point having QuickDraw global coordinates to either QuickDraw GX global or QuickDraw GX local coordinates. If a view port is specified in the function's parameters, the QuickDraw point coordinates are converted to the corresponding QuickDraw GX local coordinates. If the view port parameter is <CODE>nil</CODE>, the QuickDraw point coordinates are converted to corresponding QuickDraw GX global coordinates. <A HREF=#MARKER-9-43>Figure 1-1</A> shows how the <CODE>GXConvertQDPoint</CODE> function converts a point having QuickDraw global coordinates of (50, 150) pixels on a monitor to QuickDraw GX coordinates in points (in which 1 point equals 1/72 inch).<P>
<B>Figure 1-1  <A NAME=MARKER-9-43></A>Converting from QuickDraw global to QuickDraw GX local and global coordinates</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/EU-L-67.gif"><p>
 When the view port parameter is <CODE>nil</CODE>, the QuickDraw global coordinates are converted to QuickDraw GX global coordinates (50.0, 150.0). When the view port is specified, the QuickDraw global coordinates are converted to QuickDraw local coordinates (10.0, 10.0) when the view port is located at QuickDraw GX global coordinates (40.0, 140.0). The local coordinates are local relative to the specified view port.<P>
 The <CODE>GXConvertQDPoint</CODE> function is described on <A HREF=GXEnvironment-39.html#MARKER-9-117>page 1-29</A>. For additional information about QuickDraw GX local, global, and device space, see the chapter "View-Related Objects" in <I><A HREF="../../GXObjects/GXObjects-2.html">Inside Macintosh: QuickDraw GX Objects</A></I>.<A NAME=MARKER-9-9></A><P>
<A NAME=HEADING21-25></A>
<H4>Obtaining Mouse Location in Global Coordinates</H4>
 <A NAME=MARKER-2-124></A>The <CODE>GXGetGlobalMouse</CODE> function returns the location of the Macintosh cursor (mouse) in QuickDraw GX global coordinates. If a QuickDraw GX view device has a resolution of 72 dpi and a cursor is located at point (500, 150) pixels in QuickDraw coordinates, the <A NAME=MARKER-9-231></A><CODE>GXGetGlobalMouse</CODE> function would return the QuickDraw GX coordinates (500.0, 150.0) in points. If the resolution of the QuickDraw GX view device is 144 dpi and the cursor were at (1000, 300) pixels, the <CODE>GXGetGlobalMouse</CODE> function would again return coordinates (500.0, 150.0). No matter what the resolution of the device, the QuickDraw GX global coordinates are the same for a cursor located at a given absolute position.<P>
 The <CODE>GXGetGlobalMouse</CODE> function is described on <A HREF=GXEnvironment-40.html#MARKER-9-122>page 1-30</A>. For additional information about local, global, and device spaces, see the chapter "View-Related Objects" in <I><A HREF="../../GXObjects/GXObjects-2.html">Inside Macintosh: QuickDraw GX Objects</A></I>.<A NAME=MARKER-9-115></A><P>
<A NAME=HEADING21-28></A>
<H4>Obtaining Mouse Location in Local Coordinates</H4>
 <A NAME=MARKER-2-75></A>For a given view port, you can use the <A NAME=MARKER-2-49></A><CODE>GXGetViewPortMouse</CODE> function to obtain the mouse position in the coordinate system (local coordinates) of that view port. This function takes any scaling of local space into account; if, for example, you have a zoomed-in view, the coordinates would be relative to the zoomed coordinate system.<P>
 If you obtain the mouse point in QuickDraw global coordinates, you can take the result of the <CODE>GXGetViewPortMouse</CODE> function and immediately turn it into a shape. You can use the <CODE>GXNewShape</CODE> function with the returned point as the shape origin, and QuickDraw GX will draw the shape at the point where the mouse is located with the correct scale. If the scale factor is 10, the shape is drawn enlarged by a factor of 10.<P>
 The <CODE>GXGetViewPortMouse</CODE> function is described on <A HREF=GXEnvironment-41.html#MARKER-9-126>page 1-30</A>. For additional information about local, global, and device spaces, see the chapter "View-Related Objects" in <I><A HREF="../../GXObjects/GXObjects-2.html">Inside Macintosh: QuickDraw GX Objects</A></I>.<A NAME=MARKER-2-50></A>   <A NAME=MARKER-2-187></A><P>
<A NAME=HEADING21-32></A>
<H3>Intercepting Drawing Calls to a View Port</H3>
 <A NAME=MARKER-2-96></A>The <A NAME=MARKER-8-35></A><CODE>GXSetViewPortFilter</CODE> function causes QuickDraw GX to intercept all drawing function calls to a specified view port and pass them instead to an application-defined callback function that you supply. You can use the filter function to perform actions other than screen drawing, or perhaps to collect information about them.<P>
 QuickDraw GX uses this function to install a view port filter for printing. When a page is open and a call is made to draw a shape, instead of actually drawing it to the screen, the printing view port filter records (spools) it to the print file. You can use this kind of function if you want to achieve a similar result or if you otherwise want to manipulate shapes that would be drawn to a view port.<P>
 When you use the <A NAME=MARKER-9-238></A><CODE>GXGetViewPortFilter</CODE> function, you get back what you set with the <CODE>GXSetViewPortFilter</CODE> function. If you want to get rid of your view port filter, use the <CODE>GXSetViewPortFilter</CODE> function and specify a <CODE>nil</CODE> filter function.<P>
 The <CODE>GXSetViewPortFilter</CODE> function is described on <A HREF=GXEnvironment-43.html#MARKER-9-131>page 1-31</A>. The <CODE>GXGetViewPortFilter</CODE> function is described on <A HREF=GXEnvironment-44.html#MARKER-9-134>page 1-32</A>. The application-defined callback filter function is described on <A HREF=GXEnvironment-55.html#MARKER-9-156>page 1-40</A>. <A NAME=MARKER-9-233></A>  <A NAME=MARKER-2-154></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="GXEnvironment-20.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="GXEnvironment-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="GXEnvironment-445.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="GXEnvironment-22.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="GXEnvironment-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
