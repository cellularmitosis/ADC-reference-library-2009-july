<html><head><title>Mac OS X Developer Tools
 Manual Page For exchangedata(2)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/2/exchangedata" title="Mac OS X Developer Tools
 Manual Page for exchangedata(2)"><!-- headerDoc=man; indexgroup=Section 2; uid="//apple_ref/doc/man/2/exchangedata"; name=exchangedata(2) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac&nbsp;OS&nbsp;X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>

<p style='text-align:justify;'>This manual page is associated with the Mac&nbsp;OS&nbsp;X
developer tools.  The software or headers described may not be present on your
Mac&nbsp;OS&nbsp;X installation until you install the developer tools
package.  This package is available on your Mac&nbsp;OS&nbsp;X installation DVD,
and the latest versions can be downloaded from
<a href="http://developer.apple.com/tools/download/">developer.apple.com</a>.</p>

<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
EXCHANGEDATA(2)             BSD System Calls Manual            EXCHANGEDATA(2)

<b>NAME</b>
     <b>exchangedata</b> -- atomically exchange data between two files

<b>SYNOPSIS</b>
     <b>#include</b> <b>&lt;unistd.h&gt;</b>

     <u>int</u>
     <b>exchangedata</b>(<u>const</u> <u>char</u> <u>*</u> <u>path1</u>, <u>const</u> <u>char</u> <u>*</u> <u>path2</u>, <u>unsigned</u> <u>long</u> <u>options</u>);

<b>DESCRIPTION</b>
     The <b>exchangedata</b>() function swaps the contents of the files referenced by <u>path1</u> and <u>path2</u> in an atomic
     fashion.  That is, all concurrent processes will either see the pre-exchanged state or the post-<font color="#ffffff" class="whiteout">exchanged&nbsp;postexchanged</font>
     exchanged state; they can never see the files in an inconsistent state.  The data in all forks is
     swapped in this way.  The <u>options</u> parameter lets you control specific aspects of the function's behav-<font color="#ffffff" class="whiteout">iour.&nbsp;behaviour.</font>
     iour.

     Open file descriptors follow the swapped data.  Thus, a descriptor that previously referenced <u>path1</u>
     will now reference the data that's accessible via <u>path2</u>, and vice versa.

     In general, the file attributes (metadata) are not exchanged.  Specifically, the object identifier
     attributes (that is, the ATTR_CMN_OBJID and ATTR_CMN_OBJPERMANENTID attributes as defined by the
     <a href="getattrlist.2.html#//apple_ref/doc/man/2/getattrlist">getattrlist(2)</a> function) are not swapped.  An exception to this general rule is that the modification
     time attribute ( ATTR_CMN_MODTIME ) is swapped.

     When combined, these features allow you to implement a 'safe save' function that does not break refer-<font color="#ffffff" class="whiteout">ences&nbsp;references</font>
     ences to the file (for example, aliases).  You first save the new contents to a temporary file and then
     exchange the data of the original file and the temporary.  Programs that reference the file via an
     object identifier will continue to reference the original file, but now it has the new data.

     The <u>path1</u> and <u>path2</u> parameters must both reference valid files.  All directories listed in the path
     names leading to these files must be searchable.  You must have write access to the files.

     The <u>options</u> parameter is a bit set that controls the behaviour of <b>exchangedata</b>().  The following option
     bits are defined.

     FSOPT_NOFOLLOW  If this bit is set, <b>exchangedata</b>() will not follow a symlink if it occurs as the last
                     component of <u>path1</u> or <u>path2</u>.

<b>RETURN</b> <b>VALUES</b>
     Upon successful completion a value of 0 is returned.  Otherwise, a value of -1 is returned and <u>errno</u> is
     set to indicate the error.

<b>COMPATIBILITY</b>
     Not all volumes support <b>exchangedata</b>().  You can test whether a volume supports <b>exchangedata</b>() by using
     <a href="getattrlist.2.html#//apple_ref/doc/man/2/getattrlist">getattrlist(2)</a> to get the volume capabilities attribute ATTR_VOL_CAPABILITIES, and then testing the
     VOL_CAP_INT_EXCHANGEDATA flag.

<b>ERRORS</b>
     <b>exchangedata</b>() will fail if:

     [ENOTSUP]          The volume does not support <b>exchangedata</b>().

     [ENOTDIR]          A component of the path prefix is not a directory.

     [ENAMETOOLONG]     A component of a path name exceeded NAME_MAX characters, or an entire path name
                        exceeded PATH_MAX characters.

     [ENOENT]           Either file does not exist.

     [EACCES]           Search permission is denied for a component of the path prefix.

     [ELOOP]            Too many symbolic links were encountered in translating the pathname.

     [EFAULT]           <u>path1</u> or <u>path2</u> points to an invalid address.

     [EXDEV]            <u>path1</u> and <u>path2</u> are on different volumes (mounted file systems).

     [EINVAL]           <u>path1</u> or <u>path2</u> reference the same file.

     [EINVAL]           You try to exchange something other than a regular file (for example, a directory).

     [EIO]              An I/O error occurred while reading from or writing to the file system.

<b>SEE</b> <b>ALSO</b>
     <a href="getattrlist.2.html#//apple_ref/doc/man/2/getattrlist">getattrlist(2)</a>

<b>HISTORY</b>
     A <b>exchangedata</b>() function call appeared in Darwin 1.3.1 (Mac OS X version 10.0).

Darwin                         December 15, 2003                        Darwin
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man2/exchangedata.2.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man2/exchangedata.2.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man2/exchangedata.2.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
