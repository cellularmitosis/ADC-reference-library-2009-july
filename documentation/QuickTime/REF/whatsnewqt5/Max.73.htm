<HTML><head><script language="JavaScript" src="../../RM/frametest.js"></script><TITLE> Codec APIs</TITLE><script language=javascript> window.parent.focus(); </script></HEAD><BODY BGCOLOR="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- path goes here --><!-- QTnavbar start --><P><I>What's New in QuickTime 5</I><P>| <A HREF="Max.72.htm">Previous</A> | <A HREF="Max.1.htm">Chapter Contents</A> | <A HREF="Max.htm">Chapter Top</A> | <A HREF="Max.74.htm">Next</A> |</P></DIV><!-- QTnavbar end --><H1 CLASS="H2.Heading2"><A NAME="pgfId=76292"> </A>Codec APIs</H1><P CLASS="T1.Text1"><A NAME="pgfId=76293"> </A>The following APIs are defined for codecs to support gamma conversion</P><DIV><H3 CLASS="RoH.RoutineHeading"><A NAME="pgfId=76294"> </A><A NAME="marker=88215"> </A>ImageCodecRequestGammaLevel</H3><P CLASS="T1.Text1"><A NAME="pgfId=76295"> </A>Requests the codec to convert from source to destination gamma levels.</P><CODE CLASS="RD.RoutineDeclare"><A NAME="pgfId=97811"> </A>ComponentResult ImageCodecRequestGammaLevel( ComponentInstance ci, Fixed srcGammaLevel, Fixed <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dstGammaLevel, long *codecCanMatch )</code><br><DL COMPACT><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=97813"> </A><TT CLASS="cv">ci</TT></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=76298"> </A>Instance of the codec component.</DD><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=97822"> </A><TT CLASS="cv">srcGammaLevel</TT></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=76299"> </A> Gamma level to convert from.</DD><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=97834"> </A><TT CLASS="cv">dstGammaLevel</TT></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=76300"> </A> Gamma level to convert to.</DD><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=97846"> </A><TT CLASS="cv">codecCanMatch</TT></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=76301"> </A> Indicates if the conversion from <TT CLASS="cv">srcGammaLevel</TT> to <TT CLASS="cv">dstGammaLevel</TT> is supported.</DD></DL COMPACT><DIV><H4 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=76426"> </A>DISCUSSION</H4><P CLASS="T1.Text1"><A NAME="pgfId=76303"> </A>This call tells the codec what the gamma of the source buffer and destination PixMap are so that the codec can try to convert between the two gammas when decompressing. </P><P CLASS="T1.Text1"><A NAME="pgfId=76304"> </A>This call may be made several times as the ICM sets up a gamma conversion chain. The last value takes precedent for future scheduled frames.</P><P CLASS="T1.Text1"><A NAME="pgfId=76305"> </A>The call may also occur while frames are already scheduled, indicating that conditions have changed. The new request is effective on frames that are scheduled after the call is made. Frames previously scheduled should continue to use the previously requested gamma conversion values.</P><P CLASS="T1.Text1"><A NAME="pgfId=76306"> </A>Proper gamma conversion is accomplished by normalizing source data to black and white points to 0 to 1 and raising the result by the ratio of the <TT CLASS="cv">srcGammaLevel</TT> divided by <TT CLASS="cv">dstGammaLevel</TT>. The most accurate correction is done in RGB space, but a visual approximation can be done by raising the luma component alone.</P></DIV></DIV><DIV><H3 CLASS="RoH.RoutineHeading"><A NAME="pgfId=76307"> </A><A NAME="marker=88216"> </A>ImageCodecGetSourceDataGammaLevel</H3><P CLASS="T1.Text1"><A NAME="pgfId=76308"> </A>Requests the native gamma of the compressed data, if any.</P><CODE CLASS="RD.RoutineDeclare"><A NAME="pgfId=97860"> </A>ComponentResult ImageCodecGetSourceDataGammaLevel( ComponentInstance ci, Fixed <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*sourceDataGammaLevel )</code><br><DL COMPACT><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=97862"> </A><TT CLASS="cv">ci</TT></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=76311"> </A>Instance of the codec component.</DD><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=97871"> </A><TT CLASS="cv">sourceDataGammaLevel</TT></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=76312"> </A> Return the native gamma level of the compressed data.</DD></DL COMPACT><DIV><H4 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=76418"> </A>DISCUSSION</H4><P CLASS="T1.Text1"><A NAME="pgfId=76315"> </A>This call asks the codec what the native gamma of the source data is. The ICM uses this information to determine what gamma correction is necessary. Return 0 to indicate the default gamma of the platform.</P><P CLASS="T1.Text1"><A NAME="pgfId=76316"> </A>Example: The Apple DV Codec returns 2.2 to this call.</P></DIV></DIV><hr>&#169; 2001 Apple Computer, Inc.<!-- QTnavbar start --><P><I>What's New in QuickTime 5</I><P>| <A HREF="Max.72.htm">Previous</A> | <A HREF="Max.1.htm">Chapter Contents</A> | <A HREF="Max.htm">Chapter Top</A> | <A HREF="Max.74.htm">Next</A> |</P></DIV><!-- QTnavbar end --></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY></HTML>