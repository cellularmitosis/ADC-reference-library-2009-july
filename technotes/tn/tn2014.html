<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!-- Template 01-05-01 --><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="Stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note TN2014: Insights on OpenGL</title><meta name="keywords" content="OpenGL 3D Graphics AUX Buffer Buffers Stencil Blit Page Flipping AGL OGL NSGL Extensions Packed Pixels ATI NVIDIA QuickTime Mac OS X VBL Sync Frame Tear DrawSprocket"><meta name="Description" content="Technical Note TN2014: This Technote contains a variety of answers to frequently asked questions regarding OpenGL andgraphics  on the Macintosh. "><meta name="categories" content="OpenGL"><meta name="week-posted" content="Mar 26, 2001 - Mar 30, 2001"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10003053" title="Insights on OpenGL"></a><A NAME="top"></A><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxGraphicsImaging-date.html">Graphics & Imaging</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/GraphicsImaging/idxOpenGL-date.html" target="_blank">Graphics & Imaging > OpenGL</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TN2014</div>
<div id="pageheadsub">Insights on OpenGL</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">     <tr>         <td width=300 valign="top" align=left scope="row">             <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>             <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                 </tr>                 <tr bgcolor="#e6e6e6">                     <td background="images/tnmenubody.gif" width=300 align=left>                         <span id="menutitle">                             CONTENTS                             <br>                             <br>                         </span>                     </td>                 </tr>                 <tr bgcolor="#e6e6e6">                     <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->					<p id="menutext">                    <A HREF="#Section1">Missing OpenGL Geometry</A><BR><BR>                   <A HREF="#Section2">QuickTime Movie Output</A><BR>                   <BR>                   <A HREF="#Section3">"Native" Pixel Format</A><BR>                   <BR>                   <A HREF="#Section4">Enabling packed pixels</A><BR>                   <BR>                   <A HREF="#Section5">VBL syncing</A><BR><BR>                   <A HREF="#Section6">Page flipping</A><BR><BR>                   <A HREF="#Section7">Frame Tears</A><BR><BR>                   <A HREF="#Section8">Using OpenGL with DrawSprocket</A><BR><BR>                   <A HREF="#Section9">Using OpenGL with QuickDraw</A><BR><BR>                   <A HREF="#Section10">Buffer Allocation</A><BR><BR>                   <A HREF="#Section11">More to Come</A><BR><BR>                   <A HREF="#references">References</A><BR>                   <BR>                   <A HREF="#Downloads">Downloadables</A></P>                    <!-- end_toc -->                  </td>                 </tr>                 <tr>                     <td width=300 align=left scope="row">                         <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                     </td>                 </tr>             </table>         </td>         <td width=300 valign="top" align=left><!-- begin_intro_text --><p id="introtext">This Technote describes a variety of issues regarding OpenGL and graphics on the Macintosh. It covers items such as integration with QuickTime and DrawSprocket, problems such as frame tearing and unwanted geometry clipping, as well as clarifications and answers to frequently asked questions. </P><p id="introtext">This Note is directed at application developers who are familiar with OpenGL and 3D graphics in general.</P><!-- end_intro_text --><!-- begin_date --><h3>&nbsp;Updated: [Mar 26 2001]</h3><!-- end_date -->                 </TD>              </TR>           </TABLE>  <!-- end_header_box --><BR><BR><hr width=500 align=center><BR><BR>           <!-- begin_content -->           <P><A NAME=Section1></A></P>          <H2>Missing OpenGL Geometry </H2><P>There are many things that can keep portions of OpenGL geometry from drawing on the screen. However, two of the most common are as follows:</p><ol>	<li>Your surfaces(s) are being clipped by one or more of the view frustum planes</li>	<li>Your camera is pointing at the back side(s) of the surface(s)<BR>	- Normals are reversed<BR>	- Camera coordinates or viewpoint coordinates are wrong</li></ol><P>If your view is completely black, chances are your camera is pointed in the wrong direction entirely. Usually this is due to positioning the camera too far up or down the z-axis or having the camera looking at the wrong view coordinates. Note that the default camera position is (0.0, 0.0, 0.0) pointed down the negative Z-axis.</P>  <P><A HREF="#top">Back to top</A></P><P><A NAME=Section2></A></P><H2>QuickTime Movie Output</H2><P>To use OpenGL as an output for a QuickTime movie, each frame of the QuickTime movie should be loaded into a <code>GWorld</code> then uploaded as a texture to an OpenGL polygon to display the surface. Sample code for this is available at the following URL:</p>	 <TABLE BORDER=0 CELLPADDING=5 WIDTH=470>                      <TR>                         <td bgcolor="#E6E6E6" align=left><a href="../../samplecode/Sample_Code/Graphics_3D/OpenGL_Movie.htm" target="_blank">http://developer.apple.com/samplecode/Sample_Code/Graphics_3D/OpenGL_Movie.htm</a>                         </TD>                      </TR>                   </TABLE><BR><P>You have to extract each frame from the movie as a texture and then apply it to a polygon in OpenGL. Note that you'll have to invert your v-coordinate on the texture, or load it in reverse order, otherwise your movie will play upside down. See the sample called "OpenGL Movie" on the Apple Developer web site for more information.</p><P><A HREF="#top">Back to top</A></P>          <P><A NAME=Section3></A></P>          <H2>"Native" Pixel Format </H2><P>The native pixel format is <code>ARGB 8888</code> in 32-bit and in 16-bit, it is <code>ARGB 1555</code>. Packed pixels can be used to support these native formats through the OpenGL pipeline.</P><P><A HREF="#top">Back to top</A></P><P><A NAME=Section4></A></P><H2>Enabling packed pixels</H2><P>Packed pixels is supported in OpenGL 1.2 or later on the Macintosh. This can be verified by checking the version string of the renderer. Renderers may also support packed pixels via the extension "GL_APPLE_PACKED_PIXELS" (note that it the actual string returned by the ATI drivers is "GL_APPLE_PACKED_PIXEL").</p><P>When a pixel format is chosen, you must use 'AGL_NO_RECOVERY' in order to ensure that the pixels are passed through OpenGL in the specified format.</p><P>The following are the optimal choices for pixel formats in OpenGL:</p><BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>        16-Bit:            Pixel Format    : GL_BGRA_EXT            Pixel Type        : GL_UNSIGNED_SHORT_1_5_5_5_REV        32-Bit:            Pixel Format    : GL_BGRA_EXT            Pixel Type        : GL_UNSIGNED_SHORT_1_5_5_5_REV</pre></TD></TR></TABLE></CENTER><BR><BR><P><A HREF="#top">Back to top</A></P><P><A NAME=Section5></A></P><H2>VBL syncing</H2><P>Synchronize the frame rate of my application to the monitor's refresh rate (VBL syncing) can be enabled with the following:</p><BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>        GLint swapInt = 1;        AGLSetInteger(aglContext, AGL_SWAP_INTERVAL, &amp;swapInt);</pre></TD></TR></TABLE></CENTER><BR><BR><P>Note that this will lock your frame rate to a divisible integer of your monitor's current refresh rate.</p>          <P><A HREF="#top">Back to top</A></P><a name="Section6"></a><H2>Page flipping</h2><P>ATI drivers currently enable page flipping on RAGE 128-based systems with a full-screen, non-occluded drawable.  Window-mode page flipping is not supported.</p><P>Note that the benefits of page flipping have become less and less pronounced as hardware and software technology has advanced. The typical gain is only a few frames per second since VRAM to VRAM blitting is so fast on modern hardware. </p><P><A HREF="#top">Back to top</A></P><a name="Section7"></a><h2>Frame Tears</h2><P>Frame tears are a synchronization issue unrelated to swap speeds, contrary to popular belief. A tear occurs when the buffers are swapped while the electron beam is in the middle of painting on the screen. <a name="Section5">VBL synching</a> should solve this problem.</p><P><A HREF="#top">Back to top</A></P><a name="Section8"></a><h2>Using OpenGL with DrawSprocket</h2><P>See the full screen sample at the following URL:		<a href="../../samplecode/Sample_Code/Graphics_3D/">http://developer.apple.com/samplecode/Sample_Code/Graphics_3D/</a></p><P><A HREF="#top">Back to top</A></P><a name="Section9"></a><h2>Using OpenGL with QuickDraw</h2><P>To draw to the front buffer with QuickDraw, you must synchronize your drawing with OpenGL, which entails stalling the OpenGL pipeline (not recommended for performance reasons).</p><P>This can be achieved by calling <code>glFinish()</code> immediately following a call to <code>aglSwapBuffers()</code>. QuickDraw can then be used to draw to the front buffer. Note that since the contents of the buffer will again be invalidated at the next call to <code>aglSwapBuffers()</code>, flickering mayoccur. The recommended solution is to use QuickDraw to draw into a GWorld then use the GWorld as a texture or draw the contents of the GWorld directly into the back buffer using <code>glDrawPixels()</code>. </p><P><A HREF="#top">Back to top</A></P><a name="Section10"></a>	<h2>Buffer Allocation on Mac OS 9 and OS X</h2><P> OS 9 allocates buffers on a per-context basis; each next context that is created has its own set of independent buffers that are exclusive to that context. Buffers can be shared among contexts on Mac OS 9 by specifying context to share with in <code>aglCreateContext()</code>.</p><P>Stencil, AUX (auxiliary) and accumulation buffers are not supported in hardware on Mac OS 9.</p><P>Mac OS X allocates buffers on a per-surface basis; a "surface" is the equivalent of a drawable on Mac OS X. You may create and attach multiple contexts to a single surface in Mac OS X. All contexts created on a given surface will share the same set of buffers.</p><P>Mac OS X also supports AUX (auxiliary) buffers and an 8-bit stencil buffer.  Accumulation buffers are not supported in hardware on Mac OS X.</p><P><A HREF="#top">Back to top</A></P><a name="Section11"></a><H2>More to Come</h2><p>The following issues will be addressed in the future:</p><ul>	<li>Which of the following - NSGL, AGL, and CGL- should be used with Mac OS X</li>	<li>Using OpenGL with CoreGraphics</li>	<li>How does OpenGL on the Macintosh handle extensions? What extensions are supported?</li></ul>          <P><A HREF="#top">Back to top</A></P>          <P>&nbsp;<A NAME=references></A></P>          <H2>References</H2>          <P>OpenGL ARB <A HREF="http://www.opengl.org">OpenGL Programming Guide, 3rd Edition</A> Addision-Wesley</P>          <P>OpenGL ARB <A HREF="http://www.opengl.org">OpenGL Reference Manual, 3rd Edition</A> Addision-Wesley</P>          <P>Foley, van Dam, Feiner, Hughes <A HREF="http://isbn.nu/0201357178">Computer Graphics - Principles and Practices</A> Addision-Wesley</P>          <P><A HREF="#top">Back to top</A></P>          <P><A NAME=Downloads></A></P>          <H2>Downloadables</H2>          <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">             <TR>                <td width=50 align=left>                   <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 align=middle alt="Acrobat gif" height=23></P>                </TD>                <td align="left">                   <P>Acrobat version of this Note (size in bytes,                   size in K)</P>                </TD>                <td width=60 align=left>                   <P><A HREF="pdf/tn2014.pdf">Download</A></P>                </TD>             </TR>               </TABLE>          <BR>          <P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tn/tn2014.html%3Fid%3DDTS10003053-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tn/tn2014.html%3Fid%3DDTS10003053-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tn/tn2014.html%3Fid%3DDTS10003053-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>