<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>AppleScript Studio Programming Guide: Programming With AppleScript Studio</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Programming With AppleScript Studio"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20001251" title="Programming With AppleScript Studio"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../ScriptingAutomation/index.html#//apple_ref/doc/uid/TP30000440-TP40005948" target="_top">Scripting &amp; Automation</a> &gt; <a href="../../../../ScriptingAutomation/AppleScript-date.html#//apple_ref/doc/uid/TP30000440-TP40005948-TP30000481" target="_top">AppleScript</a> &gt; <a href="../chapter01/studio_intro_book.html#//apple_ref/doc/uid/20001248-TPXREF101">AppleScript Studio Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../chapter03/studio_components.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../chapter05/studio_cookbook.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/20001251-TPXREF101" title="Programming With AppleScript Studio"></a><h1>Programming With AppleScript Studio</h1><p>This chapter describes a number of features and issues that will help you get the most from AppleScript Studio. It contains the following sections:</p><ul class="ul"><li class="li"><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-CJBEAFAH">“Additional Information on AppleScript Studio”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-CJBGBHIF">“AppleScript Studio Terminology”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-CJBFIAIB">“Programming Tips”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-CJBGAGHH">“Troubleshooting”</a></span></p></li></ul><p>For related information, see <span class="content_text"><a href="../chapter02/studio_about_book.html#//apple_ref/doc/uid/20001249-TPXREF160">“Strengths and Limitations.”</a></span></p><a name="//apple_ref/doc/uid/20001251-CJBEAFAH" title="Additional Information on AppleScript Studio"></a><h2>Additional Information on AppleScript Studio</h2><p>The following sections describe additional features and issues you’ll want to know more about as you work with AppleScript Studio.</p><ul class="ul"><li class="li"><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-BAJDFDJG">“Organizing an AppleScript Studio Project”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-TPXREF182">“Naming Conventions for Methods and Handlers”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-TPXREF175">“Accessing Code From AppleScript Studio Scripts”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-CJBFGIJH">“Persistent Script Properties”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-CJBCBICD">“Accessing Script Globals”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-TPXREF179">“Overridden Scripting Additions”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-CJBCHHAD">“How Xcode Formats Scripts”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-BAJGFJIH">“Switching Between AppleScript Studio and Script Editor”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-TPXREF178">“Scripting AppleScript Studio Applications”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-CJBDADHI">“Using Script Editor to Test AppleScript Studio Terminology”</a></span></p></li></ul><a name="//apple_ref/doc/uid/20001251-BAJDFDJG" title="Organizing an AppleScript Studio Project"></a><h3>Organizing an AppleScript Studio Project</h3><p>Two questions you may frequently face in organizing an AppleScript Studio project are whether to use one or many script files and whether to use one or many nib files. In each case, the answer depends on the scope and goals of the project.</p><a name="//apple_ref/doc/uid/20001251-TPXREF180" title="Deciding How Many Script Files to Use"></a><h4>Deciding How Many Script Files to Use</h4><p>When you create a new AppleScript Studio project in Xcode with the AppleScript Application or Droplet templates, it contains one script file, <code>Application.applescript</code>. If you use the Document-based template, you get an additional script file, <code>Document.applescript</code>. As the names suggest, these script files are intended for handlers related to the application and its documents, respectively. However, you are free to delete these script files, to rename them, or to add additional script files.</p><p>Given this freedom of choice, how should you organize the handlers and other script statements you write for an AppleScript Studio application? As you might expect, the answer depends on the scope of the project and the complexity of the user interface.</p><p>There are several advantages to putting all of your script statements in one file:</p><ul class="spaceabove"><li class="li"><p>Because they are in one file, handlers and script objects have access to other handlers, script objects, and global properties in the file. When this access is important, use of one file makes sense. Script objects are described in <span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-BCICFHJC">“Additional Handlers and Scripts in Mail Search.”</a></span></p></li><li class="li"><p>There is less overhead with a single script file. For a small application or one with a simple user interface, creating multiple script files may slow the pace of development.</p></li></ul><p>A significant disadvantage of using a single script file is that if many similar objects in the interface (such as buttons) share a handler (such as the <code>clicked</code> handler), you may need to do lengthy testing to determine which object the handler was called for. An example is shown in <span class="content_text">Listing 3-1</span>. Thus using a single script file can have drawbacks in the case of a complex interface with many similar objects, such as a preferences panel. It can also lead to greater complexity in testing and debugging.</p><a name="//apple_ref/doc/uid/20001251-BAJHGJBJ" title="Listing 3-1Detecting which button was clicked"></a><p class="codesample"><strong>Listing 3-1&nbsp;&nbsp;</strong>Detecting which button was clicked</p><div class="codesample"><table><tr><td scope="row"><pre>on clicked theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    if the name of the object is "Dial button" then<span></span></pre></td></tr><tr><td scope="row"><pre>        --do something<span></span></pre></td></tr><tr><td scope="row"><pre>    else if name of the object is "Hang Up button" then<span></span></pre></td></tr><tr><td scope="row"><pre>        --do something else<span></span></pre></td></tr><tr><td scope="row"><pre>    else if name of the object is "Panic button" then<span></span></pre></td></tr><tr><td scope="row"><pre>        --do a third thing<span></span></pre></td></tr><tr><td scope="row"><pre>    else if ...<span></span></pre></td></tr></table></div><p>There are also advantages to using multiple script files:</p><ul class="spaceabove"><li class="li"><p>Modularity is a widely-accepted principle in software development. Grouping like things together can make the application both easier to understand and easier to test and debug.</p></li><li class="li"><p>Having one script per significant object allows you to avoid the code complexity shown in <span class="content_text">Listing 3-1</span>. Within a handler, you know which object triggered the call. In fact, you should put a comment to that affect in the handler itself. </p></li></ul><p>The downside to using multiple script files is a proliferation of small files in the project. That makes multiple script files most appropriate for projects with a significant, but manageable, number of similar user interface objects.</p><p>Finally, you may want to provide one script file per window in your application. This approach may make sense if you are using a similar approach for nib files (as described in the next section).</p><a name="//apple_ref/doc/uid/20001251-TPXREF181" title="Deciding How Many Nib Files to Use"></a><h4>Deciding How Many Nib Files to Use</h4><p>To create an interface with Interface Builder, you create and edit a nib resource file that contains descriptions of the interface elements in your application. A nib file can describe all or part of a user interface. Many applications use two or more nib files, with one of them designated as the main nib file. The main nib file contains the main menu and any windows and panels you want to appear when your application starts up.</p><p>In addition to the main nib file, you can have one or more nib files that you load whenever you need them. Loading a nib file unarchives (or creates instances of) whatever user-interface objects are described in the nib. For example, if your application creates its own document type, you might have a separate nib file for a document window. Each time a user opens a new document, you would create a document window by loading the auxiliary nib file.</p><p>It is certainly possible to put a large number of user interface definitions into a single nib file. However, as you add object instances (and possibly classes, images, and sounds as well) to a nib file, the task of working with the nib in Interface Builder becomes more complicated. For example, you can use Interface Builder to examine the objects in a nib file in an outline view, as described in <span class="content_text"><a href="../chapter09/studio_ms_connect_intf.html#//apple_ref/doc/uid/20001256-BCICCIGJ">“Examining an Object Hierarchy in the Nib View.”</a></span> This mode of display can be very useful for examining an object hierarchy and viewing the connections between objects. However, as you add objects to the nib file, the clarity of the hierarchy and relationships diminishes.</p><p>As a result, using a single nib file probably only makes sense for relatively small AppleScript Studio applications with simple user interfaces, and for applications that are not built with the Document-based project template.</p><p>A rule of thumb for creating nib files is to use one nib for each separate kind of window in the application. For example, the Mail Search application, described in detail in the tutorial beginning in <span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-TPXREF101">“Chapter 7, Mail Search Tutorial: Design the Application,”</a></span> uses four nib files: one for the application and its menus, one for the search window, one for the message window, and one for a status dialog. By using a single nib for a window definition, you can easily create instances of that window object by loading the nib with the <code>load nib</code> command.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001251-DontLinkElementID_19" title="Note"></a><p><strong>Note:</strong>&nbsp;When you load a nib file, Cocoa instantiates all the top level objects archived in the nib. So if you have more than one window defined in a nib file, loading the nib file will instantiate each window. That may be appropriate if your application has several windows that you always want to instantiate on launch, and not again thereafter. And you can use a window object’s <code>visible</code> property to control when the window is visible.</p></div><p>One final advantage of using multiple nib files is that doing so can help simplify the task of finding and correcting interface-related bugs—and in AppleScript Studio, the interface is likely to be a major factor in most applications.</p><a name="//apple_ref/doc/uid/20001251-TPXREF182" title="Naming Conventions for Methods and Handlers"></a><h3>Naming Conventions for Methods and Handlers</h3><p>The Cocoa application framework follows a naming convention that helps explain when certain methods are called. This convention, which is reflected in the terminology for AppleScript Studio’s event handlers, inserts <code>should</code>, <code>will</code>, and <code>did</code> in method names. <span class="content_text">Table 3-1</span> describes the meaning of these terms. Note that to indicate a completed operation, AppleScript Studio uses the past tense, rather than the term <code>did</code>.</p><a name="//apple_ref/doc/uid/20001251-BCIDJGGE" title="Table 3-1Naming conventions in Cocoa and AppleScript Studio"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 3-1&nbsp;&nbsp;</strong>Naming conventions in Cocoa and AppleScript Studio</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Cocoa phrase</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Explanation</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>AppleScript Studio examples</p></th></tr><tr><td  scope="row"><p><code>should</code></p></td><td ><p>Asks whether an operation should take place. You can cancel the operation by returning <code>false</code>.</p></td><td ><p></p><p><code>should open</code></p><p><code>should close</code></p></td></tr><tr><td  scope="row"><p><code>will</code></p></td><td ><p>An operation is about to take place. You can prepare for it, but not prevent it.</p></td><td ><p></p><p><code>will resize</code></p><p><code>will hide</code></p><p><code>will quit</code></p></td></tr><tr><td  scope="row"><p><code>did</code></p></td><td ><p>An operation has completed. You can perform actions in response to it. AppleScript Studio uses past tense, rather than the term <code>did</code>.</p></td><td ><p></p><p><code>activated</code></p><p><code>launched</code></p><p><code>miniaturized</code></p><p><code>zoomed</code></p></td></tr></table></div><p>So, for example, you can add a <code>should close</code> handler to a window object. When the handler is called, it can determine whether the user has performed some essential task—if not, it can return <code>false</code> and refuse to allow the window to close. A <code>will close</code> handler cannot cancel the close operation, but it can perform any necessary tasks to prepare for closing. Finally, a <code>closed</code> handler can perform any tasks required after closing.</p><p>See <em><a href="../../../Reference/StudioReference/index.html#//apple_ref/doc/uid/TP30000892" target="_top">AppleScript Studio Terminology Reference</a></em> for detailed descriptions of the event handlers and other terminology that is available in AppleScript Studio.</p><a name="//apple_ref/doc/uid/20001251-TPXREF175" title="Accessing Code From AppleScript Studio Scripts"></a><h3>Accessing Code From AppleScript Studio Scripts</h3><p>AppleScript Studio provides the <code>call method</code> command for calling methods of Objective-C objects in an AppleScript Studio application.</p><p>The <code>call method</code> command provides the ability to:</p><ul class="spaceabove"><li class="li"><p>target user interface objects</p></li><li class="li"><p>target the application object or its delegate</p></li><li class="li"><p>specify as many parameters as needed</p></li><li class="li"><p>receive a return value; the return value can be another object, from which you can extract more information</p></li></ul><p>Because you can access other languages from Objective-C, the <code>call method</code> command also allows you to:</p><ul class="spaceabove"><li class="li"><p>access code written in C, C++, Objective-C++, and Java (both directly and through the Java bridge—a Mac OS X mechanism for communicating between Objective-C and Java)</p></li><li class="li"><p>access legacy code written in one of these languages</p></li><li class="li"><p>access Mac OS X frameworks, such as the Core Foundation and Carbon frameworks</p></li></ul><p>The Multi-Language application, distributed starting with AppleScript Studio 1.1, demonstrates how to call other languages from an AppleScript Studio application.</p><p><span class="content_text">Figure 3-1</span> shows the syntax for the <code>call method</code> command.</p><br/><div><a name="//apple_ref/doc/uid/20001251-BAJFBGIG" title="Figure 3-1Syntax for the call method command"></a><p><strong>Figure 3-1&nbsp;&nbsp;</strong>Syntax for the call method command</p><img src = "../art/call_method_syntax.gif" alt = "Syntax for the call method command" width="628" height="107"></div><br/><dl class="termdef">	<dt><code>call method</code></dt><dd><p>Invokes the command, with <code>reference</code> specifying the method to call.</p></dd><dt><code>with parameter</code></dt><dd><p>This optional parameter allows you to pass a value to a method that takes a single parameter. You can use the parameter to pass an object or a simple value such as an integer. You can also pass a single list, which can contain multiple items, but only if the called method expects a single parameter that encompasses multiple values, such as an array or dictionary.</p></dd><dt><code>of class</code></dt><dd><p>This optional parameter allows you to specify the Objective-C class whose method is called.</p></dd><dt><code>of object</code></dt><dd><p>This optional parameter allows you to specify the object whose method is called.</p><p>You never use both <code>of object</code> and <code>of class</code>. If you don’t specify either, the call goes to a method of the application’s delegate object or, if the delegate doesn’t support it, to the application object itself.</p><p>The application object is described in <span class="content_text"><a href="../chapter03/studio_components.html#//apple_ref/doc/uid/20001250-TPXREF138">“Cocoa Framework Overview.”</a></span> For information on class methods, delegates, and other Cocoa topics, see the documentation described in <span class="content_text"><a href="../chapter01/studio_intro_book.html#//apple_ref/doc/uid/20001248-CIHDAGAF">“See Also.”</a></span></p></dd><dt><code>with parameters</code></dt><dd><p>This optional parameter is intended for use with methods that have more than one parameter, though you can also use it for a method with a single parameter. You specify a list with one item for each parameter of the specified method. An item within the list of parameters can be a list, if the called method expects a single parameter that encompasses multiple values in that position.</p><p>You never use both <code>with parameter</code> and <code>with parameters</code>. If you don’t use either, it is assumed the method has no parameters.</p></dd></dl><div class="notebox"><a name="//apple_ref/doc/uid/20001251-DontLinkElementID_20" title="Note"></a><p><strong>Note:</strong>&nbsp;If a parameter name is the same as an AppleScript keyword, you can enclose it between vertical bar characters (for example, <code>|Set|</code>) to prevent AppleScript from evaluating it and potentially changing the case during compilation.</p></div><p>It is useful to note that Objective-C associates a colon with each parameter of a method. For example, the following is a method declaration from Cocoa’s NSDocument class:</p><div class="codesample"><table><tr><td scope="row"><pre>- (BOOL) readFromFile: (NSString *) fileName ofType: (NSString *) docType<span></span></pre></td></tr></table></div>	<p>This method has two parameters, so to call it with call method, you use the <code>with parameters</code> option, as shown in listing <span class="content_text">Listing 3-2</span>:</p><a name="//apple_ref/doc/uid/20001251-CJBHFGHF" title="Listing 3-2Calling a document method with two parameters"></a><p class="codesample"><strong>Listing 3-2&nbsp;&nbsp;</strong>Calling a document method with two parameters</p><div class="codesample"><table><tr><td scope="row"><pre>call method "readFromFile:ofType:" of object (document 1 of window 1)<span></span></pre></td></tr><tr><td scope="row"><pre>    with parameters {myFilenameString, myDocTypeString}<span></span></pre></td></tr></table></div><p>In <span class="content_text">Listing 3-2</span>, the list consists of the two string variables (whose values are set prior to the call) enclosed in curly brackets: <code>{myFilenameString, myDocTypeString}</code>.</p><p>For a method with one parameter (and one colon), you use <code>with parameter</code>. The example in <span class="content_text">Listing 3-3</span> calls the <code>performClick:</code> method of a button object, passing as a parameter another button object.</p><a name="//apple_ref/doc/uid/20001251-BAJDCEHG" title="Listing 3-3Calling a method of a button"></a><p class="codesample"><strong>Listing 3-3&nbsp;&nbsp;</strong>Calling a method of a button</p><div class="codesample"><table><tr><td scope="row"><pre>call method "performClick:" of object (button 1 of window 1)<span></span></pre></td></tr><tr><td scope="row"><pre>    with parameter (button 2 of window 2)<span></span></pre></td></tr></table></div><p>The single parameter in <span class="content_text">Listing 3-3</span> is enclosed in parentheses because it is a multi-term reference: <code>(button 2 of window 2)</code>. You could optionally use <code>with parameters</code> and pass a one-item list: <code>{button 2 of window 2}</code>.</p><p><span class="content_text">Listing 3-4</span> shows an example that calls a class method of NSNumber to get back a number object initialized with an integer value. It passes a single value (the number 10) for its one parameter. In this case, the parameter is unambiguous, and does not require parentheses.</p><a name="//apple_ref/doc/uid/20001251-BAJCAEHI" title="Listing 3-4Calling a class method"></a><p class="codesample"><strong>Listing 3-4&nbsp;&nbsp;</strong>Calling a class method</p><div class="codesample"><table><tr><td scope="row"><pre>set theResult to call method "numberWithInt:" of class "NSNumber"<span></span></pre></td></tr><tr><td scope="row"><pre>    with parameter 10<span></span></pre></td></tr></table></div><p><span class="content_text">Listing 3-5</span> shows a hypothetical example that has no parameters. Because it doesn’t specify a class or object, call method will attempt to execute the <code>countMyCustomers</code> method of the application object, returning the customer count. It’s your obligation to make sure the method you call actually exists!</p><a name="//apple_ref/doc/uid/20001251-BAJHEIDE" title="Listing 3-5Calling a method of the application"></a><p class="codesample"><strong>Listing 3-5&nbsp;&nbsp;</strong>Calling a method of the application</p><div class="codesample"><table><tr><td scope="row"><pre>set customerCount to call method "countMyCustomers"<span></span></pre></td></tr></table></div><p>The <code>call method</code> command can accept and return the types NSRect, NSPoint, NSSize, and NSRange, in addition to primitive types such as <code>int</code>, <code>double</code>, <code>char *</code>, and so on. For example, to call the NSView method <code>- (void) setFrame: (NSRect) frameRect</code>, you use a script statement similar to the following:</p><div class="codesample"><table><tr><td scope="row"><pre>call method "setFrame:" of object (view 1 of window 1)<span></span></pre></td></tr><tr><td scope="row"><pre>        with parameter {20, 20, 120, 120}<span></span></pre></td></tr></table></div><p>In this case, the single parameter is a 4-item list that is passed to <code>setFrame</code> as a type NSRect.</p><p><span class="content_text">Table 3-2</span> lists Cocoa types you typically use with the <code>call method</code> command and their AppleScript equivalents.</p><a name="//apple_ref/doc/uid/20001251-BBCGBBFI" title="Table 3-2Cocoa types and their AppleScript equivalents"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 3-2&nbsp;&nbsp;</strong>Cocoa types and their AppleScript equivalents</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Cocoa type</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>AppleScript equivalent</p></th></tr><tr><td  scope="row"><p><span class="content_text"><a href="../../../../Cocoa/Reference/Foundation/Classes/NSArray_Class/Reference/Reference.html#//apple_ref/occ/cl/NSArray" target="_top">NSArray</a></span></p></td><td ><p>list</p></td></tr><tr><td  scope="row"><p><span class="content_text"><a href="../../../../Cocoa/Reference/Foundation/Classes/NSDate_Class/Reference/Reference.html#//apple_ref/occ/cl/NSDate" target="_top">NSDate</a></span></p></td><td ><p>date</p></td></tr><tr><td  scope="row"><p><span class="content_text"><a href="../../../../Cocoa/Reference/Foundation/Classes/NSDictionary_Class/Reference/Reference.html#//apple_ref/occ/cl/NSDictionary" target="_top">NSDictionary</a></span></p></td><td ><p>record</p></td></tr><tr><td  scope="row"><p><span class="content_text"><a href="../../../../Cocoa/Reference/Foundation/Miscellaneous/Foundation_DataTypes/Reference/reference.html#//apple_ref/c/tdef/NSPoint" target="_top">NSPoint</a></span></p></td><td ><p>list of two numbers:</p><p>{x, y}</p></td></tr><tr><td  scope="row"><p><span class="content_text"><a href="../../../../Cocoa/Reference/Foundation/Miscellaneous/Foundation_DataTypes/Reference/reference.html#//apple_ref/c/tdef/NSRange" target="_top">NSRange</a></span></p></td><td ><p>list of two numbers:</p><p>{begin offset, end offset}</p></td></tr><tr><td  scope="row"><p><span class="content_text"><a href="../../../../Cocoa/Reference/Foundation/Miscellaneous/Foundation_DataTypes/Reference/reference.html#//apple_ref/c/tdef/NSRect" target="_top">NSRect</a></span></p></td><td ><p>list of four numbers:</p><p>{left, bottom, right, top}</p></td></tr><tr><td  scope="row"><p><span class="content_text"><a href="../../../../Cocoa/Reference/Foundation/Miscellaneous/Foundation_DataTypes/Reference/reference.html#//apple_ref/c/tdef/NSSize" target="_top">NSSize</a></span></p></td><td ><p>list of two numbers:</p><p>{width, height}</p></td></tr><tr><td  scope="row"><p><span class="content_text"><a href="../../../../Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/cl/NSString" target="_top">NSString</a></span></p></td><td ><p>string</p></td></tr></table></div><p>To see script statements that invoke the <code>call method</code> command in a working project, see the Archive Maker or Drawer sample projects, described in <span class="content_text"><a href="../chapter02/studio_about_book.html#//apple_ref/doc/uid/20001249-CJBJBFAA">“AppleScript Studio Sample Applications.”</a></span></p><a name="//apple_ref/doc/uid/20001251-CJBFGIJH" title="Persistent Script Properties"></a><h3>Persistent Script Properties</h3><p>In AppleScript Studio, script properties are not saved back into the application as they currently are in AppleScript script applications created with Script Editor or other script editing applications. Therefore the values of script properties do not persist between launches of an AppleScript Studio application.</p><p>If you want persistent storage of values, you can write them to a preferences file before your application quits and read them back when it is launched. Starting in version 1.1, AppleScript Studio also provides a mechanism for conveniently saving and restoring values from scripts using the user defaults system available in Mac OS X. This mechanism is described in <em><a href="../../../Reference/StudioReference/index.html#//apple_ref/doc/uid/TP30000892" target="_top">AppleScript Studio Terminology Reference</a></em>—see the <code>user-defaults</code> class and the <code>default entry</code> class.</p><a name="//apple_ref/doc/uid/20001251-CJBCBICD" title="Accessing Script Globals"></a><h3>Accessing Script Globals</h3><p>In AppleScript Studio, global variables declared in one script are not accessible from another script without doing an explicit <code>load script</code> command. (See the Unit Converter sample application for an example of how to load a script.) Even when you load a script, you’re getting a snapshot of the current values of the variables, not access to one variable that can be referenced (and updated) by each script.</p><p>If you need to keep one set of values that can be accessed and updated from multiple scripts, use one of the mechanisms described in <span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-CJBFGIJH">“Persistent Script Properties.”</a></span></p><a name="//apple_ref/doc/uid/20001251-TPXREF179" title="Overridden Scripting Additions"></a><h3>Overridden Scripting Additions</h3><p>AppleScript Studio overrides the <code>display dialog</code> command to provide its own version, which can be displayed as a sheet (a dialog attached to a window).</p><div class="notebox"><a name="//apple_ref/doc/uid/20001251-DontLinkElementID_21" title="Note"></a><p><strong>Note:</strong>&nbsp;The <code>display dialog</code> command is part of AppleScript’s Standard Additions scripting addition, located in <code>/System/Library/ScriptingAdditions</code>.</p></div><p>When specifying a <code>display dialog</code> command, you use a term similar to the following to display the dialog as a sheet with the specified window:</p><div class="codesample"><table><tr><td scope="row"><pre>display dialog ... [other terms] ... attached to window "Window Name"<span></span></pre></td></tr></table></div><div class="importantbox"><a name="//apple_ref/doc/uid/20001251-DontLinkElementID_22" title="Important:"></a><p><strong>Important:</strong>&nbsp;When you work with a dialog displayed as a sheet, you must supply a <code>dialog ended</code> handler to continue processing when the user dismisses the sheet. For details, see the Discussion session for <code>display dialog</code> command, in the “Panel Suite” section of <em><a href="../../../Reference/StudioReference/index.html#//apple_ref/doc/uid/TP30000892" target="_top">AppleScript Studio Terminology Reference</a></em>.</p><p></p></div><p>For a detailed example of how to use AppleScript Studio’s version of <code>display dialog</code>, see the Display Dialog sample application (distributed with AppleScript Studio). The following call to the <code>display dialog</code> command is from that application. Many of the parameters are variables, set before making the call.</p><div class="codesample"><table><tr><td scope="row"><pre>display dialog dialogText buttons<span></span></pre></td></tr><tr><td scope="row"><pre>        {dialogButton1, dialogButton2, dialogButton3}<span></span></pre></td></tr><tr><td scope="row"><pre>    default button dialogDefaultButton<span></span></pre></td></tr><tr><td scope="row"><pre>    giving up after dialogGivingUpAfter<span></span></pre></td></tr><tr><td scope="row"><pre>    with icon dialogIcon attached to window "main"<span></span></pre></td></tr></table></div><p>If you pass a string for the <code>with icon</code> parameter, the command will look for a <code>.tiff</code> resource with that name.</p><div class="importantbox"><a name="//apple_ref/doc/uid/20001251-DontLinkElementID_23" title="Important:"></a><p><strong>Important:</strong>&nbsp;The <code>with icon</code> parameter will accept a number, with 0, 1, and 2 corresponding to the stop, note, and caution icons, respectively. However, use of these icons is no longer recommended. In addition, the AppleScript constants <code>stop</code>, <code>note</code>, and <code>caution</code> do not work.</p><p></p></div><p>The <code>display dialog</code> command generates a “user canceled” error when the cancel button is pressed only if the dialog is not attached to a window. If the dialog is attached, cancel is treated like any other button, and you must check for it in your <code>dialog ended</code> handler. The Display Dialog sample application demonstrates how to display dialogs, both as a plain dialog or as a sheet attached to a window.</p><p>For more information on <code>display dialog</code>, see the “Panel Suite” section in <em><a href="../../../Reference/StudioReference/index.html#//apple_ref/doc/uid/TP30000892" target="_top">AppleScript Studio Terminology Reference</a></em>.</p><a name="//apple_ref/doc/uid/20001251-CJBCHHAD" title="How Xcode Formats Scripts"></a><h3>How Xcode Formats Scripts</h3><p>When you check the syntax for a script, Xcode reformats it according to your formatting preferences. Xcode’s editor window currently uses the same formatting (font, style, and color) you have specified in the Script Editor application (located in <code>/Applications/AppleScript</code>). To change settings in the version of Script Editor released with Mac OS X version 10.3, follow these steps:</p><ol class="ol"><li class="li"><p>Quit Xcode.</p></li><li class="li"><p>Open the Script Editor application (located in <code>/Applications/AppleScript</code>).</p></li><li class="li"><p>Choose Preferences… from the Application menu.</p></li><li class="li"><p>Click the Formatting button.</p></li><li class="li"><p>Choose the fonts and styles you prefer. (Or click the Use Defaults button to go back to the default values.)</p></li><li class="li"><p>Click the Apply button, then quit Script Editor.</p></li><li class="li"><p>Open Xcode. Your formatting changes are now in effect.</p></li></ol><p>Because of differences in Script Editor and Xcode, the same font may be rendered differently in the two applications. For an example of script formatting, see <span class="content_text"><a href="../chapter03/studio_components.html#//apple_ref/doc/uid/20001250-BAJHGJIC">Figure 2-4</a></span>. In that script, AppleScript keywords are shown in blue (<code>on</code>, <code>end</code>) and application keywords in red (<code>clicked</code>, <code>display dialog</code>).</p><div class="notebox"><a name="//apple_ref/doc/uid/20001251-DontLinkElementID_24" title="Note"></a><p><strong>Note:</strong>&nbsp;When you first install AppleScript Studio, editor windows in Xcode may not reflect settings from Script Editor’s AppleScript Formatting menu until after you’ve made some change to those settings and restarted Xcode.</p></div><p>Most scripters are familiar with AppleScript's line-continuation character, "¬", used for dealing with long lines. When a line ends with that character, AppleScript treats the following line as part of the previous line. Long lines are common with some of the user interface terminology in AppleScript Studio. However, Xcode’s ability to wrap lines provides an elegant way to deal with long lines without using continuation characters. You can also set tab widths to improve control script formatting.</p><p>To adjust line wrap and tab settings, choose Preferences in Xcode’s application menu, then click the button for the Text Editing pane, shown in <span class="content_text">Figure 3-2</span>. To choose settings that work well for AppleScript Studio projects:</p><ul class="spaceabove"><li class="li"><p>select the checkbox for “Wrap lines”</p></li><li class="li"><p>select the checkbox for “Indent wrapped lines by:” and enter a value of 4</p></li><li class="li"><p>select the checkbox for “Editor uses tabs”</p></li><li class="li"><p>enter a value of 4 for “Tab width:” and “Indent width:”</p></li></ul><br/><div><a name="//apple_ref/doc/uid/20001251-CJBCGDIB" title="Figure 3-2Setting Text Editing preferences in Xcode"></a><p><strong>Figure 3-2&nbsp;&nbsp;</strong>Setting Text Editing preferences in Xcode</p><img src = "../art/xc_text_editing_prefs.gif" alt = "Setting Text Editing preferences in Xcode" width="487" height="402"></div><br/><a name="//apple_ref/doc/uid/20001251-BAJGFJIH" title="Switching Between AppleScript Studio and Script Editor"></a><h3>Switching Between AppleScript Studio and Script Editor</h3><p>If you copy text from an AppleScript Studio script file to a Script Editor window on a version of Mac OS X prior to version 10.3, you may see the script displayed with many “garbage” characters. The strange characters are probably there because Script Editor can not deal effectively with UNIX-style line endings, while that is the default line-ending style for Project Builder editor windows. You can change the default setting in Project Builder by displaying the script file in an editor window, clicking in the script, then choosing Use Mac Line Endings (CR) from the Line Endings submenu of the Format menu.</p><p>Even if you do not experience the line endings problem (or you are using Mac OS X version 10.3 or later), you may still be unable to compile the script. A likely cause is that Script Editor doesn’t know where to find AppleScript Studio terminology you use in the script. You can tell Script Editor about AppleScript Studio’s terminology by enclosing the copied script statements in a Using Terms From block. The block can specify any AppleScript Studio application, such as any of the sample applications you’ve built. <span class="content_text">Listing 3-6</span> shows how to do this by getting terminology from the Drawer application (shown in <span class="content_text"><a href="../chapter02/studio_about_book.html#//apple_ref/doc/uid/20001249-CJBBHFFB">Figure 1-1</a></span>).</p><a name="//apple_ref/doc/uid/20001251-BAJFBEAF" title="Listing 3-6Telling Script Editor where to look for AppleScript Studio terminology"></a><p class="codesample"><strong>Listing 3-6&nbsp;&nbsp;</strong>Telling Script Editor where to look for AppleScript Studio terminology</p><div class="codesample"><table><tr><td scope="row"><pre>using terms from "Drawer"<span></span></pre></td></tr><tr><td scope="row"><pre>    (* Insert script statements from your AppleScript Studio<span></span></pre></td></tr><tr><td scope="row"><pre>        script file here. *)<span></span></pre></td></tr><tr><td scope="row"><pre>end using terms from<span></span></pre></td></tr></table></div><p>For more information on working with Xcode’s source code editor, see <span class="content_text"><a href="../chapter03/studio_components.html#//apple_ref/doc/uid/20001250-BAJGDDIG">“Source Code Editor.”</a></span></p><a name="//apple_ref/doc/uid/20001251-TPXREF178" title="Scripting AppleScript Studio Applications"></a><h3>Scripting AppleScript Studio Applications</h3><p>AppleScript Studio applications use scripts to respond to user actions and perform operations, but are they themselves scriptable applications? The answer is yes, but perhaps not as fully as you might expect.</p><p>In script files in the sample applications distributed with AppleScript Studio, you will see many examples of statements that operate on user interface objects, particularly by comparing or setting properties of the objects. For example, the Drawer application gets the state of the “Drawer” button and obtains the “Open drawer on” value (Left, Right, Top, or Bottom) from the matrix of radio buttons, then opens or closes the drawer in the specified location.</p><p>You can script similar operations on the running Drawer application from a separate script executed, for example, in Script Editor. The script shown in <span class="content_text">Listing 3-7</span> sets a local variable to the current text from the “Date” text field on the application’s drawer. To identify the field, it uses a statement similar to ones in the Drawer application script file <code>Content Controller.applescript</code>:</p><a name="//apple_ref/doc/uid/20001251-BAJIBHIE" title="Listing 3-7Setting text in the Drawer application from an external script"></a><p class="codesample"><strong>Listing 3-7&nbsp;&nbsp;</strong>Setting text in the Drawer application from an external script</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "Drawer"<span></span></pre></td></tr><tr><td scope="row"><pre>    set theText to contents of text field "Date Field" of drawer<span></span></pre></td></tr><tr><td scope="row"><pre>        "Drawer" of window "Main"<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><div class="notebox"><a name="//apple_ref/doc/uid/20001251-DontLinkElementID_25" title="Note"></a><p><strong>Note:</strong>&nbsp;The line beginning with “set theText” and the following line are all one script statement. As described in <span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-CJBCHHAD">“How Xcode Formats Scripts,”</a></span> you can wrap text in an Xcode editor window without use of the AppleScript continuation character (¬).</p></div><p>However, there are limitations to this approach. AppleScript Studio makes an application’s user interface scriptable—it doesn’t make the underlying object model scriptable. For example, if an application window isn’t currently open, a script won’t be able to access user interface objects in that window. Thus scripts that “script the UI” suffer from the inherent problems of knowing what user interface objects are available when the script runs, as well as how to identify the desired object.</p><p>Because of these limitations, turning your Cocoa application into an AppleScript Studio application will not automatically allow robust scripting of the application’s features. So using AppleScript Studio for QA testing, for example, is likely to be of most value in simple cases, or for Cocoa applications that already support scripting of their object model.</p><p>For related information, see <span class="content_text"><a href="../chapter05/studio_cookbook.html#//apple_ref/doc/uid/20001252-BAJGGHDB">“Performing User Interface Actions,”</a></span> <span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-CJBEEAAG">“Experiment With Script Editor to Find Terminology,”</a></span> and <span class="content_text"><a href="../chapter05/studio_cookbook.html#//apple_ref/doc/uid/20001252-BCIIGFGD">“Adding AppleScript Studio Support to Your Cocoa Application.”</a></span></p><a name="//apple_ref/doc/uid/20001251-CJBDADHI" title="Using Script Editor to Test AppleScript Studio Terminology"></a><h3>Using Script Editor to Test AppleScript Studio Terminology</h3><p>You can use Script Editor (or a third party script editor) to test the terminology you’ll need to access an object in your running AppleScript Studio application. That is, you can target the application, write a statement that gets an object such as the front window, write another statement that gets an object in the front window, and so on. As you execute each script statement to get an object, you can examine the result in the Script Editor’s Result pane. By repeating this process, you can identify terminology that will work in your AppleScript Studio script.</p><p><span class="content_text">Listing 3-8</span> shows script statements for obtaining a value from a text field in the Drawer sample application. Before using these statements, build and run the Drawer application. Then open a script window in Script Editor (located in <code>/Applications/AppleScript</code>) and show the result by clicking the Result tab at the bottom of the window.</p><a name="//apple_ref/doc/uid/20001251-CJBIEGFJ" title="Listing 3-8Scripting the Drawer application from Script Editor"></a><p class="codesample"><strong>Listing 3-8&nbsp;&nbsp;</strong>Scripting the Drawer application from Script Editor</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "Drawer"<span></span></pre></td></tr><tr><td scope="row"><pre>    set theWindow to the front window<span></span></pre></td></tr><tr><td scope="row"><pre>    (*if that works, then add the next line *)<span></span></pre></td></tr><tr><td scope="row"><pre>    set theTextField to text field "content width" of theWindow<span></span></pre></td></tr><tr><td scope="row"><pre>    (* and so on, depending on your object hierarchy *)<span></span></pre></td></tr><tr><td scope="row"><pre>    set theText to contents of text field "content width" of theWindow<span></span></pre></td></tr><tr><td scope="row"><pre>    display dialog (theText)<span></span></pre></td></tr><tr><td scope="row"><pre>    (* and so on *)<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>To work through this example, start with an empty Tell block:</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "Drawer"<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>You can then insert each statement in turn, execute the script, and examine the result. For example, adding the first statement, <code>set theWindow to the front window</code> gives you a result something like (<code>window id 1 of application "Drawer"</code>) in the Result window. You can then keep adding statements and checking the results until you’ve figured out how to specify the object, property, or element you’re interested in.</p><p>In <span class="content_text">Listing 3-8</span>, the <code>display dialog</code> statement merely displays the text extracted from the text field. Starting with AppleScript Studio 1.1, you can obtain a similar result within an AppleScript Studio application script with the <code>log</code> command, using statements such as <code>log theWindow</code>.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001251-DontLinkElementID_26" title="Note"></a><p><strong>Note:</strong>&nbsp;You cannot currently ask for the contents of a reference to a text field—you have to access the text field directly. So replacing the sixth line in <span class="content_text">Listing 3-8</span> with <code>set theText to contents of theTextField</code> will result in an error.</p></div><p><span class="content_text">Listing 3-9</span> shows a script you can run in Script Editor that obtains a list of all the views in the front window of an AppleScript Studio application named “applicationName”. The script logs each view and its class.</p><a name="//apple_ref/doc/uid/20001251-BAJDFGFD" title="Listing 3-9Examining the views of an AppleScript Studio application"></a><p class="codesample"><strong>Listing 3-9&nbsp;&nbsp;</strong>Examining the views of an AppleScript Studio application</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "applicationName"<span></span></pre></td></tr><tr><td scope="row"><pre>    set viewList to (views of window 1)<span></span></pre></td></tr><tr><td scope="row"><pre>    repeat with aView in viewList<span></span></pre></td></tr><tr><td scope="row"><pre>        log aView<span></span></pre></td></tr><tr><td scope="row"><pre>        log class of aView<span></span></pre></td></tr><tr><td scope="row"><pre>    end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>If you run this script for the Currency Converter sample application distributed with AppleScript studio (starting with version 1.1), you will get output something like the following in Script Editor’s the Event Log pane:</p><div class="codesample"><table><tr><td scope="row"><pre>    (*view id 2*)<span></span></pre></td></tr><tr><td scope="row"><pre>    (*text field*)<span></span></pre></td></tr><tr><td scope="row"><pre>    (*view id 3*)<span></span></pre></td></tr><tr><td scope="row"><pre>    (*text field*)<span></span></pre></td></tr><tr><td scope="row"><pre>    (*view id 4*)<span></span></pre></td></tr><tr><td scope="row"><pre>    (*text field*)<span></span></pre></td></tr><tr><td scope="row"><pre>    (*view id 5*)<span></span></pre></td></tr><tr><td scope="row"><pre>    (*text field*)<span></span></pre></td></tr><tr><td scope="row"><pre>    (*view id 6*)<span></span></pre></td></tr><tr><td scope="row"><pre>    (*text field*)<span></span></pre></td></tr><tr><td scope="row"><pre>    (*view id 7*)<span></span></pre></td></tr><tr><td scope="row"><pre>    (*text field*)<span></span></pre></td></tr><tr><td scope="row"><pre>    (*view id 8*)<span></span></pre></td></tr><tr><td scope="row"><pre>    (*box*)<span></span></pre></td></tr><tr><td scope="row"><pre>    (*view id 9*)<span></span></pre></td></tr><tr><td scope="row"><pre>    (*button*)<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/20001251-CJBGBHIF" title="AppleScript Studio Terminology"></a><h2>AppleScript Studio Terminology</h2><p>The primary documentation for AppleScript Studio terminology is <em><a href="../../../Reference/StudioReference/index.html#//apple_ref/doc/uid/TP30000892" target="_top">AppleScript Studio Terminology Reference</a></em>. It provides a complete reference to the available terminology, including classes, events, commands, and enumerations.</p><p>The following sections describe AppleScript Studio terminology and how it is used:</p><ul class="simple"><li><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-TPXREF161">“Overview”</a></span></p></li><li><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-BAJGEACE">“General Sources of Scripting Terminology”</a></span></p></li><li><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-TPXREF167">“Terminology From the AppleScriptKit Framework”</a></span></p></li><li><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-BAJECCHI">“Finding Terminology Information”</a></span></p></li></ul><a name="//apple_ref/doc/uid/20001251-TPXREF161" title="Overview"></a><h3>Overview</h3><p>AppleScript allows you to write scripts that control multiple applications, including many parts of the Mac OS itself. The power in your scripts comes primarily from the scripting terminology provided by the applications and the operating system, not from the relatively small number of terms that are native to AppleScript itself. Scripting additions from Apple and from third parties provide additional terms. (A <strong>scripting addition</strong> is code, stored in Mac OS X in <code>/System/Library/SystemAdditions</code>, that makes additional commands or coercions available to scripts on the same computer.)</p><p>To take full advantage of the capabilities available, you need to know what terminology you can use in your scripts. Scripts in AppleScript Studio applications have access to the basic terminology that is available to all scripts, as well as to additional terminology that is available to Cocoa applications and, finally, to terminology defined by AppleScript Studio itself. Each of these sources of terminology can include class definitions (which include elements and properties), event and command definitions (which have an associated syntax), and enumerations (or predefined constants).</p><div class="notebox"><a name="//apple_ref/doc/uid/20001251-DontLinkElementID_27" title="Note"></a><p><strong>Note:</strong>&nbsp;AppleScript Studio draws a distinction between a command, which is a word or phrase you can use in a script to request an action, and an event, which is an action an object can respond to. That is, scripts can send commands to objects, while events, often the result of user actions, generate calls to event handlers in scripts.</p>When you examine the terminology for an AppleScript Studio application, you’ll see both commands and events listed together in the “Commands” section. For more information, see <span class="content_text"><a href="../chapter03/studio_components.html#//apple_ref/doc/uid/20001250-BAJBFHJJ">“Terminology Browser.”</a></span></p></div><a name="//apple_ref/doc/uid/20001251-BAJGEACE" title="General Sources of Scripting Terminology"></a><h3>General Sources of Scripting Terminology</h3><p>Sources of terminology that are not unique to AppleScript Studio include:</p><ul class="spaceabove"><li class="li"><p>terminology provided by AppleScript</p></li><li class="li"><p>terminology from scriptable parts of the Mac OS</p></li><li class="li"><p>terminology from available Apple and third party scripting additions</p></li><li class="li"><p>terminology from available scriptable applications (whether Carbon or Cocoa applications)</p><ul class="nested"><li class="nested li"><p>Cocoa applications store scripting terminology in a <strong>script suite</strong>, described in <span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-TPXREF167">“Terminology From the AppleScriptKit Framework.”</a></span></p></li><li class="nested li"><p>Carbon applications store scripting terminology in an <code>'aete'</code> resource, described in the AppleScript documentation listed in <span class="content_text"><a href="../chapter01/studio_intro_book.html#//apple_ref/doc/uid/20001248-CIHDAGAF">“See Also.”</a></span></p></li><li class="nested li"><p>You can examine the terminology for either type of application, as described in <span class="content_text"><a href="../chapter03/studio_components.html#//apple_ref/doc/uid/20001250-BAJBFHJJ">“Terminology Browser.”</a></span></p></li></ul></li></ul><div class="notebox"><a name="//apple_ref/doc/uid/20001251-DontLinkElementID_28" title="Note"></a><p><strong>Note:</strong>&nbsp;The name spaces of these various terminologies sometimes conflict, which can result in confusing scripting errors.</p></div><p>Cocoa applications have access to scripting information derived from the script suites of the application itself (including Cocoa’s default suites), any scriptable frameworks the application uses, and any scriptable bundles it loads. An AppleScript Studio application has access to the default terminology that is available to it as a Cocoa application, as well as to terminology it defines in its own framework, which gives the application the ability to script Cocoa user interface objects.</p><a name="//apple_ref/doc/uid/20001251-TPXREF167" title="Terminology From the AppleScriptKit Framework"></a><h3>Terminology From the AppleScriptKit Framework</h3><p>AppleScript Studio applications are built with the Cocoa application framework and provide terminology to allow scripters to make use of Cocoa application, document, user interface, and other objects. That terminology comes from two sources: terms that are available to all Cocoa applications that support scripting, and terms defined by AppleScript Studio’s AppleScriptKit framework.</p><a name="//apple_ref/doc/uid/20001251-BAJIFHCF" title="Terms From Cocoa&acirc;&#128;&#153;s Built-in Suites"></a><h4>Terms From Cocoa’s Built-in Suites</h4><p>Cocoa frameworks and applications provide scripting information in the form of one or more script suites. A <strong>script suite</strong> consists of at least one suite definition and one suite terminology, contained in external files. A <strong>suite definition</strong> describes scriptable objects in terms of their attributes, relationships, and supported commands. This information is stored as key-value pairs (where each pair has an identifying key and a corresponding value) in a property list. A <strong>property list</strong> is a structured, textual representation of data, commonly stored in Extensible Markup Language (XML) format.</p><p>A <strong>suite terminology</strong> provides corresponding AppleScript terminology—the English-like words and phrases you can use in a script—for the class and command descriptions in a suite definition. Suite terminologies are also stored as property lists. Frameworks and applications typically place terminology files in a localized resource directory named <code>English.lproj</code>. (English is currently the only supported dialect in AppleScript.)</p><p>AppleScript Studio applications can take advantage of the built-in Cocoa terminology found in two default suites, the Standard and Text suites.</p><ul class="spaceabove"><li class="li"><p>The Standard suite:</p><ul class="nested"><li class="nested li"><p>Defines the Abstract Object class. This class serves as a parent class for all other classes. It has just one property, the Class of the object.</p></li><li class="nested li"><p>Defines basic classes, including Application, Document, and Window (though you’ll see in the next section that AppleScript Studio defines its own version of these classes in its Application and Document suites).</p></li><li class="nested li"><p>Defines terminology for basic events, including Get, Set, Count, Delete, Print, Quit, and others. In Cocoa applications that turn on scripting support (as previously described in <span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-TPXREF168">“Terms from The AppleScriptKit Framework”</a></span>), objects can support certain key events, such as Get and Set, with little or no extra code.</p></li></ul></li><li class="li"><p>The Text suite defines classes for working with text, such as Character, Paragraph, Word, and Text.</p></li></ul><p>For more information on Cocoa’s built-in scripting support, see the documentation described in <span class="content_text"><a href="../chapter01/studio_intro_book.html#//apple_ref/doc/uid/20001248-CIHDAGAF">“See Also.”</a></span></p><a name="//apple_ref/doc/uid/20001251-TPXREF168" title="Terms from The AppleScriptKit Framework"></a><h4>Terms from The AppleScriptKit Framework</h4><p>AppleScript Studio adds to the two default suites defined by Cocoa so that it can provide additional terminology for scripting Cocoa’s many user interface objects. This terminology is defined in several suite terminology files in AppleScript Studio’s own framework, the AppleScriptKit framework. For detailed information on the classes and events in these suites, see <span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-BAJECCHI">“Finding Terminology Information.”</a></span></p><p>The <strong>Application suite</strong> defines its own version of some common classes that are defined in the Standard suite (described previously), including Application and Window classes. It also defines the Item class, which has Name and ID properties, and the Responder class, which inherits from the Item class and serves as a superclass for the Window, View, and Control classes. These and other classes that inherit from Responder can respond to user actions.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001251-DontLinkElementID_29" title="Note"></a><p><strong>Note:</strong>&nbsp;In AppleScript Studio 1.2, the document class is described in a separate Document suite and a Drag and Drop suite has been added.</p></div><p>To work with the many high-level classes it contains, the Application suite defines a large number of events for working with the application, windows, mouse and keyboard events, and so on. Prior to AppleScript Studio 1.2, the Application suite defined the Document class. That class is now defined in its own suite.</p><p>The <strong>Container View suite</strong> defines the View class, as well as additional classes whose primary purpose is to contain other views. These include Box, Clip View, Drawer, Scroll View, Split View, Tab View, and Tab View Item. Except for Tab View Item, all of the classes in the Container View suite inherit from Responder, either directly or through the View class. The Container View suite also defines events for working with container views and the views they contain.</p><p>The <strong>Control View suite</strong> defines a number of classes for implementing or working with controls, including Button, Cell, Color Well, Control, Image View, Movie View, Popup Button, Progress Indicator, Slider, and Text Field. Controls are graphic objects that cause instant actions or visible results when the user manipulates them with the mouse. The Cell class inherits from the Abstract Object class (described in <span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-BAJIFHCF">“Terms From Cocoa’s Built-in Suites”</a></span>), while other classes in this suite inherit from the View class, either directly or through the Control class.</p><p>The Control View suite defines many events for working with user actions involving controls.</p><p>The <strong>Data View suite</strong> defines classes whose primary purpose is to display rows and columns of data. These include Browser, Browser Cell, Data Cell, Data Column, Data Row, Data Source, Outline View, Table Column, Table Header Cell, Table Header View, and Table View. You’ve worked with several of these classes in building the Mail Search application. The classes in the Data View suite generally inherit from either the View class, the Cell class, or the Abstract Object class (described in <span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-BAJIFHCF">“Terms From Cocoa’s Built-in Suites”</a></span>).</p><p>The Data View suite defines events for working with the items, cells, rows, and columns found in table and outline views.</p><p>The <strong>Document suite</strong> defines AppleScript Studio’s version of the document class defined in the Standard suite (described previously). This suite defines terminology you can use to work with documents in any AppleScript Studio application, but which is most important to document-based applications. The Document suite first became available in AppleScript Studio 1.2. In prior versions, a smaller Document class was defined as part of the Application suite.</p><p>The <strong>Drag and Drop suite</strong> defines terms for working with drag and drop, including the <code>drag info</code> class to provide information about a drag, and events to drag, track, prepare for a drop, and conclude a drop. The Drag and Drop suite first became available in AppleScript Studio 1.2.</p><p>The <strong>Menu suite</strong> is a small suite that defines just two classes and two events for working with menus. The classes are Menu and Menu Item, which both inherit from the Abstract Object class (described in <span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-BAJIFHCF">“Terms From Cocoa’s Built-in Suites”</a></span>). The events are Choose Menu Item and Update Menu Item.</p><p>The <strong>Panel suite</strong> defines classes and events for dealing with dialogs, alerts, and panels. The classes include Alert Reply, Color Panel, Dialog Reply, Font Panel, Open Panel, Panel, and Save Panel. The two reply classes inherit from the Abstract Object class (described in <span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-BAJIFHCF">“Terms From Cocoa’s Built-in Suites”</a></span>), while the other classes inherit from Window, either directly or through the Panel class.</p><p>The <strong>Plugin suite</strong> defines terms for working with application plug-ins. Starting in AppleScript Studio version 1.3, first distributed with Mac OS X version 10.3, Xcode provides a new template for creating AppleScript plug-ins for Xcode. That is, you can use AppleScript Studio to create a plug-in that adds features to Xcode itself. The Plugin suite provides terminology to use with plug-ins of this type. For more information, see <span class="content_text"><a href="../chapter03/studio_components.html#//apple_ref/doc/uid/20001250-CJBEAIDE">“AppleScript Studio Xcode Plug-in Template.”</a></span></p><p>The <strong>Text View suite</strong> defines two classes for displaying and manipulating text: Text and Text View. Text inherits from View and Text View inherits from Text.</p><a name="//apple_ref/doc/uid/20001251-BAJECCHI" title="Finding Terminology Information"></a><h3>Finding Terminology Information</h3><p>The primary documentation for AppleScript Studio terminology is <em><a href="../../../Reference/StudioReference/index.html#//apple_ref/doc/uid/TP30000892" target="_top">AppleScript Studio Terminology Reference</a></em>, available in the <span class="content_text"><!--a target="_top" -->AppleScript Documentation<!--/a--></span> area. This section describes several additional ways to obtain information about the scripting terminology available to AppleScript Studio applications.</p><a name="//apple_ref/doc/uid/20001251-TPXREF163" title="Examine Scripting Dictionaries"></a><h4>Examine Scripting Dictionaries</h4><p>You can get detailed information about the currently available terminology by examining AppleScript Studio’s scripting terminology in a dictionary viewer, as described in <span class="content_text"><a href="../chapter03/studio_components.html#//apple_ref/doc/uid/20001250-BAJBFHJJ">“Terminology Browser.”</a></span> You can open any of the AppleScript Studio sample projects in Xcode and select <code>AppleScriptKit.asdictionary</code> in the Files list of the Groups &amp; Files list. It provides a link to a scripting terminology file in the AppleScriptKit framework. By displaying this file in a dictionary viewer (also known as a terminology browser), you can examine the terms that are available to all Cocoa applications that support scripting (in the Standard and Text suites) and those that are specific to AppleScript Studio applications (the Application, Container View, Control View, Data View, Document, Drag and Drop, Menu, Panel, and Text View suites).</p><p><span class="content_text">Figure 3-3</span> shows the open dictionary in an Xcode window; the classes in the Data View suite are visible, with the Data Source object selected.</p><br/><div><a name="//apple_ref/doc/uid/20001251-BAJCEDBC" title="Figure 3-3The AppleScript Studio scripting dictionary in Xcode"></a><p><strong>Figure 3-3&nbsp;&nbsp;</strong>The AppleScript Studio scripting dictionary in Xcode</p><img src = "../art/asdictionary_in_xc.gif" alt = "The AppleScript Studio scripting dictionary in Xcode" width="918" height="579"></div><br/><p>Each class description in the dictionary shows the plural form for the class (if applicable), its elements (if any), and its properties (if any). Every class except the Abstract object class (described in <span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-BAJIFHCF">“Terms From Cocoa’s Built-in Suites”</a></span>) has an inheritance property, and through it inherits the properties of its superclasses. A property is labeled “[r/o]” if it is read only (you can’t set its value).</p><p>Each command description in the dictionary shows the syntax for invoking the command. Parameters enclosed in brackets, such as <code>[on]</code>, are optional.</p><a name="//apple_ref/doc/uid/20001251-TPXREF164" title="Investigate the Sample Applications"></a><h4>Investigate the Sample Applications</h4><p>The sample applications distributed with AppleScript Studio provide valuable examples of the terminology for working with objects based on most AppleScript Studio classes. Each of the sample applications demonstrates a small number of features, so that you can more easily focus on the details. These applications are described in <span class="content_text"><a href="../chapter02/studio_about_book.html#//apple_ref/doc/uid/20001249-CJBJBFAA">“AppleScript Studio Sample Applications.”</a></span></p><p><span class="content_text">Table 3-3</span> lists some of the sample applications and the key objects used in each application. You can examine the application script files to find examples of terminology for working with these types of objects.</p><a name="//apple_ref/doc/uid/20001251-BAJIJDEI" title="Table 3-3AppleScript Studio sample applications and the objects they use"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 3-3&nbsp;&nbsp;</strong>AppleScript Studio sample applications and the objects they use</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Application</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Objects used</p></th></tr><tr><td  scope="row"><p>Archive Maker</p></td><td ><p>button, checkbox, custom view, panel, progress indicator, text field, text view; uses <code>call method</code> command to call Objective-C methods; uses <code>do shell script</code> command</p></td></tr><tr><td  scope="row"><p>Assistant</p></td><td ><p>box, button, image view, tab view, text field</p></td></tr><tr><td  scope="row"><p>Browser</p></td><td ><p>browser, browser cell, column, Finder items, browser row</p></td></tr><tr><td  scope="row"><p>Currency Converter</p></td><td ><p>box, button, label text, number formatter, text field</p></td></tr><tr><td  scope="row"><p>Display Alert</p></td><td ><p>alert, button, checkbox, matrix (radio buttons), text field, window </p></td></tr><tr><td  scope="row"><p>Display Dialog</p></td><td ><p>dialog, button, checkbox, text field, window </p></td></tr><tr><td  scope="row"><p>Display Panel</p></td><td ><p>dialog, button, checkbox, matrix (radio buttons), panel, text field, window </p></td></tr><tr><td  scope="row"><p>Drag Race</p></td><td ><p>button, dialog, progress indicator, slider, text field, window </p></td></tr><tr><td  scope="row"><p>Drawer</p></td><td ><p>button, drawer, matrix (radio buttons), panel, text field, steppers, window; uses <code>call method</code> command to call Objective-C methods</p></td></tr><tr><td  scope="row"><p>Image</p></td><td ><p>image, image view</p></td></tr><tr><td  scope="row"><p>Language Translator</p></td><td ><p>box, button, popup button (pop-up menu), progress indicator, slider, split view, text field, window; makes SOAP calls</p></td></tr><tr><td  scope="row"><p>Mail Search (formerly Watson)</p></td><td ><p>button, outline view, progress indicator, scroller, split view, table view, window</p></td></tr><tr><td  scope="row"><p>Multi-Language</p></td><td ><p>button, menu, menu item, text field, window</p></td></tr><tr><td  scope="row"><p>Open Panel</p></td><td ><p>button, open-panel, text field, window</p></td></tr><tr><td  scope="row"><p>Outline</p></td><td ><p>child, Finder items, outline view, row, table column</p></td></tr><tr><td  scope="row"><p>Save Panel</p></td><td ><p>button, save-panel, text field, window</p></td></tr><tr><td  scope="row"><p>Simple Shell</p></td><td ><p>text field, text view, window; uses <code>do shell script</code> command</p></td></tr><tr><td  scope="row"><p>SOAP Talk</p></td><td ><p>button, progress indicator, scroll view, text field, window; makes SOAP calls</p></td></tr><tr><td  scope="row"><p>Table</p></td><td ><p>button, column, data cell, data source, row, table view, text field</p></td></tr><tr><td  scope="row"><p>Talking Head</p></td><td ><p>bundle, frame, menu item, movie, movie view, window</p></td></tr><tr><td  scope="row"><p>Unit Converter</p></td><td ><p>box, button, popup button (pop-up menu), text field, window; uses <code>load script</code> command</p></td></tr></table></div><a name="//apple_ref/doc/uid/20001251-CJBEEAAG" title="Experiment With Script Editor to Find Terminology"></a><h4>Experiment With Script Editor to Find Terminology</h4><p>To determine script terminology by targeting an AppleScript Studio application from Script Editor, see <span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-CJBDADHI">“Using Script Editor to Test AppleScript Studio Terminology.”</a></span></p><a name="//apple_ref/doc/uid/20001251-CJBFIAIB" title="Programming Tips"></a><h2>Programming Tips</h2><p>The following sections provide information that may be useful as you build applications with AppleScript Studio:</p><ul class="ul"><li class="li"><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-CJBEGGBD">“Targeting an AppleScript Studio Application”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-TPXREF183">“Using Make, Not Create, to Create New Objects in Scripts”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-BAJCIAJG">“Using the Log Command to Track Your Scripts”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-TPXREF184">“Basic Tips and Reminders”</a></span></p></li></ul><a name="//apple_ref/doc/uid/20001251-CJBEGGBD" title="Targeting an AppleScript Studio Application"></a><h3>Targeting an AppleScript Studio Application</h3><p>You do not have to use a <code>tell application</code> statement in an AppleScript Studio application script because scripts implicitly target the application itself.</p><a name="//apple_ref/doc/uid/20001251-TPXREF183" title="Using Make, Not Create, to Create New Objects in Scripts"></a><h3>Using Make, Not Create, to Create New Objects in Scripts</h3><p>Scripters are familiar with using AppleScript’s <code>make</code> command to create new objects. To make a new object, you specify the class to make, the location, and optionally the properties and data for the object. For example, to make a new “name” data column in a table view, the Table sample application uses the following statement:</p><div class="codesample"><table><tr><td scope="row"><pre>make new data column at the end of the data columns with properties {name:"name"}<span></span></pre></td></tr></table></div>	<p>For more information on tables and data columns, see the Table application, or see <span class="content_text"><a href="../chapter10/studio_write_code.html#//apple_ref/doc/uid/20001257-TPXREF208">“Controller Script Properties and Initialization”</a></span> in the Mail Search tutorial. For more information on the <code>make</code> command, see <span class="content_text"><a href="http://developer.apple.com/documentation/AppleScript/Conceptual/AppleScriptLangGuide/index.html" target="_top">AppleScript Language Guide</a></span>.</p><a name="//apple_ref/doc/uid/20001251-BAJCIAJG" title="Using the Log Command to Track Your Scripts"></a><h3>Using the Log Command to Track Your Scripts</h3><p>During development, you can insert <code>log</code> statements in your AppleScript Studio scripts to help keep track of what’s going on. The <code>log</code> command outputs a value to the console view of Xcode’s "Run" pane if you run the application from Xcode, or to the Console application (located in <code>/Applications/Utilities</code>) if you run the application from the Finder.</p><p>You can log references to objects or strings or variables. The following examples show <code>log</code> statements and their results:</p><div class="codesample"><table><tr><td scope="row"><pre>log "Testing" -- "Testing"<span></span></pre></td></tr><tr><td scope="row"><pre>log theObject -- "view id 23 of view id 10 of window id 1"<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/20001251-TPXREF184" title="Basic Tips and Reminders"></a><h3>Basic Tips and Reminders</h3><p>This section provides a number of tips and reminders that may improve your experience in working with AppleScript Studio.</p><a name="//apple_ref/doc/uid/20001251-TPXREF208" title="Comment AppleScript Studio Handlers"></a><h4>Comment AppleScript Studio Handlers</h4><p>Comments are generally a good thing, and in AppleScript Studio it’s particularly useful to comment event handlers. For example, <span class="content_text">Listing 3-10</span> shows the code AppleScript Studio inserts in your script when you attach a <code>clicked</code> handler to a button (assuming you haven’t already created a <code>clicked</code> handler in the same script).</p><a name="//apple_ref/doc/uid/20001251-BCIJCGHH" title="Listing 3-10A new clicked handler"></a><p class="codesample"><strong>Listing 3-10&nbsp;&nbsp;</strong>A new clicked handler</p><div class="codesample"><table><tr><td scope="row"><pre>on clicked theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    (* Add your script here. *)<span></span></pre></td></tr><tr><td scope="row"><pre>end clicked<span></span></pre></td></tr></table></div><p>There are several things you might do to help make this code more self-explanatory:</p><ul class="spaceabove"><li class="li"><p>If the handler is called for one of several types of control objects, you can add a comment to that effect:</p><div class="codesample"><table><tr><td scope="row"><pre>on clicked theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    (* This handler handles controls on the Search Parameters pane. *)<span></span></pre></td></tr><tr><td scope="row"><pre>    -- Your script statements here<span></span></pre></td></tr><tr><td scope="row"><pre>end clicked<span></span></pre></td></tr></table></div></li><li class="li"><p>If you know the <code>clicked</code> handler will only be called for one object (say a “Search” button), you can change the name of the <code>theObject</code> parameter accordingly (to, for example, <code>theSearchButton</code>). Changing the name has no effect on how the handler operates.</p></li><li class="li"><p>If the handler may called for one of several objects (say a series of buttons), you can both change the parameter name and add a comment:</p><div class="codesample"><table><tr><td scope="row"><pre>on clicked importButton<span></span></pre></td></tr><tr><td scope="row"><pre>    (* This handler handles buttons on the Import pane. *)<span></span></pre></td></tr><tr><td scope="row"><pre>    -- Your script statements here<span></span></pre></td></tr><tr><td scope="row"><pre>end clicked<span></span></pre></td></tr></table></div><p>For an example that shows how to distinguish between multiple named buttons in a handler, see <span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-BAJHGJBJ">Listing 3-1</a></span>.</p></li></ul><a name="//apple_ref/doc/uid/20001251-TPXREF185" title="Save Your Work"></a><h4>Save Your Work</h4><p>Some things are obvious but still need repeating. Any time you’ve done significant work on the code or interface for your AppleScript Studio application, save your work. Even though Mac OS X is very robust. Even if you have an interruptible power supply. And while you’re at it, occasionally save your entire project to another drive. (Pardon the lecture.)</p><a name="//apple_ref/doc/uid/20001251-TPXREF186" title="Occasionally Do a Clean Rebuild"></a><h4>Occasionally Do a Clean Rebuild</h4><p>You should occasionally use Xcode’s “Clean active target” button (or the Clean or Clean All Targets items in the Build menu) to do a full rebuild of your application. Cleaning removes all derived products and files (such as <code>.o</code> files). Doing a clean build can sometimes eliminate odd results when running or debugging the application.</p><a name="//apple_ref/doc/uid/20001251-TPXREF187" title="Give All Important Objects an AppleScript Name"></a><h4>Give All Important Objects an AppleScript Name</h4><p>When you’re adding objects to your nib file in Interface Builder, consider giving an AppleScript name to any objects you may want to script in the future, even if you don’t currently plan to script them. That way you’re prepared when you’re working on a handler and you realize you need to access a particular object.</p><p>You can enhance the benefits of this approach by using a consistent naming convention. For example, you can always name your main window “main” and come up with a standard way of naming buttons, text fields, and so on. Then when you need to access one of those items in a script, it will be easy to remember their names. It may also help eliminate a common bug—spelling an AppleScript name differently in a script than in Interface Builder.</p><a name="//apple_ref/doc/uid/20001251-CJBGAGHH" title="Troubleshooting"></a><h2>Troubleshooting</h2><p>This following sections provide tips that may be useful in troubleshooting your AppleScript Studio applications.</p><ul class="ul"><li class="li"><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-TPXREF196">“My Script Statements Aren’t Working”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-TPXREF201">“Several Windows in My Application Have ID 0”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-TPXREF202">“I Can’t Script My UI to Do QA Testing”</a></span></p></li></ul><a name="//apple_ref/doc/uid/20001251-TPXREF196" title="My Script Statements Aren&acirc;&#128;&#153;t Working"></a><h3>My Script Statements Aren’t Working</h3><p>If your script compiles but doesn’t work in the running application, there are several options for determining the problem:</p><ul class="spaceabove"><li class="li"><p>The runtime error message may point you at the problem. Some runtime messages are notoriously unhelpful—efforts are being made to improve them.</p></li><li class="li"><p>You can use Script Editor (or a third-party script editor) to test the terminology you’re using in your scripts. For details, see <span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-CJBDADHI">“Using Script Editor to Test AppleScript Studio Terminology.”</a></span></p></li><li class="li"><p>You can use the <code>log</code> command to get more information, as described in <span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-BAJCIAJG">“Using the Log Command to Track Your Scripts.”</a></span></p></li><li class="li"><p>You can use the standard basic debugging tactics of inserting <code>beep</code> or <code>display dialog</code> commands in your scripts.</p></li><li class="li"><p>You may be able to use powerful third-party debuggers with AppleScript Studio. Details will be provided as soon as they are available.</p></li></ul><a name="//apple_ref/doc/uid/20001251-TPXREF201" title="Several Windows in My Application Have ID 0"></a><h3>Several Windows in My Application Have ID 0</h3><p>When you add new windows to a nib file in Interface Builder, they all have ID 0. Interface Builder doesn’t attempt to assign serial index numbers to windows (though it does for buttons or other items you place in a window).</p><p>If you so desire, you will still be able to access windows by index in your application, with statements such as</p><div class="codesample"><table><tr><td scope="row"><pre>set myButton to the first button of the second window<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/20001251-TPXREF202" title="I Can&acirc;&#128;&#153;t Script My UI to Do QA Testing"></a><h3>I Can’t Script My UI to Do QA Testing</h3><p>This topic is described in <span class="content_text"><a href="studio_detail.html#//apple_ref/doc/uid/20001251-TPXREF178">“Scripting AppleScript Studio Applications.”</a></span></p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../chapter03/studio_components.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../chapter05/studio_cookbook.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2001, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-04-04<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/chapter04/studio_detail.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/chapter04/studio_detail.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/chapter04/studio_detail.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>