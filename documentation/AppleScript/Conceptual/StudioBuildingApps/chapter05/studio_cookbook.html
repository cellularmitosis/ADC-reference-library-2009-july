<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>AppleScript Studio Programming Guide: AppleScript Studio Cookbook</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="AppleScript Studio Cookbook"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20001252" title="AppleScript Studio Cookbook"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../ScriptingAutomation/index.html#//apple_ref/doc/uid/TP30000440-TP40005948" target="_top">Scripting &amp; Automation</a> &gt; <a href="../../../../ScriptingAutomation/AppleScript-date.html#//apple_ref/doc/uid/TP30000440-TP40005948-TP30000481" target="_top">AppleScript</a> &gt; <a href="../chapter01/studio_intro_book.html#//apple_ref/doc/uid/20001248-TPXREF101">AppleScript Studio Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../chapter04/studio_detail.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../chapter06/studio_cur_converter.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/20001252-TPXREF101" title="AppleScript Studio Cookbook"></a><h1>AppleScript Studio Cookbook</h1><p>This chapter provides step-by-step instructions for performing common AppleScript Studio tasks, in the following sections:</p><ul class="ul"><li class="li"><p><span class="content_text"><a href="studio_cookbook.html#//apple_ref/doc/uid/20001252-BAJGGHDB">“Performing User Interface Actions”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_cookbook.html#//apple_ref/doc/uid/20001252-BCIHJGDB">“Specifying Minimum Requirements for an Application”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_cookbook.html#//apple_ref/doc/uid/20001252-BCIIGFGD">“Adding AppleScript Studio Support to Your Cocoa Application”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_cookbook.html#//apple_ref/doc/uid/20001252-BBCBDHFH">“Setting the Keyboard Focus”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_cookbook.html#//apple_ref/doc/uid/20001252-BBCBDHEE">“Obtaining the Path to the Current Application”</a></span></p></li></ul><a name="//apple_ref/doc/uid/20001252-BAJGGHDB" title="Performing User Interface Actions"></a><h2>Performing User Interface Actions</h2><p>AppleScript Studio provides the ability to perform user interface actions directly in scripts, using the <code>perform action</code> command (defined in the Control View suite). For example, you can tell an interface object, such as a button, to perform its <code>clicked</code> handler, thus providing a way to directly script the user interface (subject to limitations described in <span class="content_text"><a href="../chapter04/studio_detail.html#//apple_ref/doc/uid/20001251-TPXREF178">“Scripting AppleScript Studio Applications”</a></span>). Note, however, that calling the <code>clicked</code> handler will not provide the visual feedback a user would see if they actually clicked the button.</p><p><span class="content_text">Listing 4-1</span> shows a script that tells the “Drawer” button in the Drawer application to perform its <code>clicked</code> handler, which will either open or close the drawer, depending on its current state.</p><a name="//apple_ref/doc/uid/20001252-BAJEFJCH" title="Listing 4-1Manipulating a button in the Drawer application from an external script"></a><p class="codesample"><strong>Listing 4-1&nbsp;&nbsp;</strong>Manipulating a button in the Drawer application from an external script</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "Drawer"<span></span></pre></td></tr><tr><td scope="row"><pre>    set theButton to button "Drawer" of window "Main"<span></span></pre></td></tr><tr><td scope="row"><pre>    tell theButton to perform action<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>The <code>perform action</code> command does nothing unless the specified object has an action handler—a handler such as a <code>clicked</code> or <code>double-clicked</code> handler in the Action group in the Interface Builder Info window for the object. For example, see the Info window in <span class="content_text"><a href="../chapter02/studio_about_book.html#//apple_ref/doc/uid/20001249-CEGFGAGF">Figure 1-15</a></span>.</p><p>To use the <code>perform action</code> command with menus, you can use syntax like the following:</p><div class="codesample"><table><tr><td scope="row"><pre>tell menu item 1 of menu 1 of main menu to perform action<span></span></pre></td></tr></table></div><p>You can also call application methods directly, as described in <span class="content_text"><a href="../chapter04/studio_detail.html#//apple_ref/doc/uid/20001251-TPXREF178">“Scripting AppleScript Studio Applications.”</a></span></p><a name="//apple_ref/doc/uid/20001252-BCIHJGDB" title="Specifying Minimum Requirements for an Application"></a><h2>Specifying Minimum Requirements for an Application</h2><p>To run AppleScript Studio applications, the target machine must include the AppleScript Studio runtime required for the application. The runtime is available if <code>AppleScriptKit.framework</code> is present in <code>/System/Library/Frameworks</code>.</p><p>For example, an application built with AppleScript Studio 1.2 that uses features added in version 1.2 requires the 1.2 runtime. However, a similar application that doesn’t use any features from AppleScript Studio 1.2 can run with the 1.1 runtime. Note that all 1.1 applications can run with the 1.0 runtime distributed with Mac OS X version 10.1.2. For more information on versions and runtimes, see <span class="content_text"><a href="../requirements/scriptStudio_requirements.html#//apple_ref/doc/uid/20001260-TPXREF101">“AppleScript Studio System Requirements and Version Information.”</a></span></p><p>You can install a <code>will finish launching</code> handler for your application to check the version. <span class="content_text"><a href="../chapter09/studio_ms_connect_intf.html#//apple_ref/doc/uid/20001256-TPXREF182">“Connect the Application Object”</a></span> shows how to add a <code>will finish launching</code> handler.</p><p><span class="content_text">Listing 4-2</span> shows a simple example of how the <code>will finish launching</code> handler might check for the application’s required version of AppleScript Studio. In this case, the application quits if the required version isn’t available. Note that the handler doesn’t check AppleScript Studio’s version number directly. Instead, it checks for the corresponding AppleScript version, as shown in <span class="content_text"><a href="../requirements/scriptStudio_requirements.html#//apple_ref/doc/uid/20001260-BAJJBCBC">Table A-1</a></span>.</p><a name="//apple_ref/doc/uid/20001252-BCIEHEFJ" title="Listing 4-2will finish launching handler that checks for required version of AppleScript Studio"></a><p class="codesample"><strong>Listing 4-2&nbsp;&nbsp;</strong>will finish launching handler that checks for required version of AppleScript Studio</p><div class="codesample"><table><tr><td scope="row"><pre>on will finish launching theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    considering numeric strings<span></span></pre></td></tr><tr><td scope="row"><pre>    if AppleScript's version as string is less than "1.10.1" then<span></span></pre></td></tr><tr><td scope="row"><pre>        display dialog "This application requires AppleScript Studio 1.4 or later."<span></span></pre></td></tr><tr><td scope="row"><pre>        quit<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>    end considering<span></span></pre></td></tr><tr><td scope="row"><pre>end will finish launching<span></span></pre></td></tr></table></div>	<a name="//apple_ref/doc/uid/20001252-BCIIGFGD" title="Adding AppleScript Studio Support to Your Cocoa Application"></a><h2>Adding AppleScript Studio Support to Your Cocoa Application</h2><p>You can use the following steps to add AppleScript Studio support to your existing Cocoa application:</p><ol class="ol"><li class="li"><p>Add the AppleScriptKit framework to your project. You can do so by navigating to <code>/System/Library/Frameworks/AppleScriptKit.framework</code> and dragging the framework into the Frameworks group in the Xcode project for your application.</p><p>In the dialog that appears, do not select the checkbox to copy items, but do check the radio button to recursively create groups. If you have more than one target, you’ll have to select any targets the framework should be added to.</p></li><li class="li"><p>Add an AppleScript Studio build phase to the application. To do this, first click the Targets tab, then double-click the desired Target. You should see a pane showing the Files &amp; Build Phases tab.</p><p>Click the section labeled Bundle Resources. You should be able to select the whole section.</p><p>Choose Project > New Build Phase > New AppleScript Build Phase (from the Projects menu).</p></li><li class="li"><p>If you’ve already added any <code>.applescript</code> files to your application, they’ll be in the Bundle Resources phase, and you’ll have to drag them to the new AppleScript phase you just created.</p></li><li class="li"><p>If your application is not already scriptable, make the following modification to its <code>Info.plist</code> file to make it scriptable:</p><p>In the Application Settings pane (after clicking the Expert button), add a new string entry to the property list that sets NSAppleScriptEnabled to “YES”. You can add an entry by clicking the New Sibling button. You can double-click any of the entries in the sibling to edit it.</p></li><li class="li"><p>If your application has a <code>.scriptsuite</code> file, for every class in that file whose superclass belongs to the core suite (NSCoreSuite), change the suite to ASKApplicationSuite. For example, change</p><div class="codesample"><table><tr><td scope="row"><pre>"Superclass" = "NSCoreSuite.NSApplication"<span></span></pre></td></tr></table></div><p>to</p><div class="codesample"><table><tr><td scope="row"><pre>"Superclass" = "ASKApplicationSuite.NSApplication"<span></span></pre></td></tr></table></div></li></ol><a name="//apple_ref/doc/uid/20001252-BBCBDHFH" title="Setting the Keyboard Focus"></a><h2>Setting the Keyboard Focus</h2><p>To make a user interface object, such as a text field, have the keyboard focus, set its window’s <code>first responder</code> property. For example, the following Tell statement causes a text field to become active and be first in line to respond to keyboard events:</p><div class="codesample"><table><tr><td scope="row"><pre>tell window "user information"<span></span></pre></td></tr><tr><td scope="row"><pre>    set first responder to text field "user name"<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>Note that without the Tell statement, you would have to specify the window twice:</p><div class="codesample"><table><tr><td scope="row"><pre>set first responder of window "user information"<span></span></pre></td></tr><tr><td scope="row"><pre>    to text field "user name" of window "user information"<span></span></pre></td></tr></table></div><p>In many cases, you will not have to set keyboard focus, because it is set automatically as a user tabs between fields, clicks on a text field, and so on.</p><a name="//apple_ref/doc/uid/20001252-BBCBDHEE" title="Obtaining the Path to the Current Application"></a><h2>Obtaining the Path to the Current Application</h2><p>To obtain the path to the current (running) AppleScript Studio application, you use the standard scripting addition command <code>path to</code>. For example:</p><div class="codesample"><table><tr><td scope="row"><pre>set myPath to (path to me)<span></span></pre></td></tr><tr><td scope="row"><pre>display dialog (myPath as string)<span></span></pre></td></tr><tr><td scope="row"><pre>-- result, if inserted in on opened handler in Drawer sample application:<span></span></pre></td></tr><tr><td scope="row"><pre>-- MacOSX:Developer:Examples:AppleScript Studio:Drawer:build:Drawer.app<span></span></pre></td></tr></table></div><p>The Standard Additions are automatically installed with Mac OS X.</p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../chapter04/studio_detail.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../chapter06/studio_cur_converter.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2001, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-04-04<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/chapter05/studio_cookbook.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/chapter05/studio_cookbook.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/chapter05/studio_cookbook.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>