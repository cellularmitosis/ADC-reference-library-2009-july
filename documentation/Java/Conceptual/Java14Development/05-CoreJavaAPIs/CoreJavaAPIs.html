<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Java Development Guide for Mac OS X: Core Java APIs and the Java Runtime on Mac OS X</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Core Java APIs and the Java Runtime on Mac OS X"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001902" title="Core Java APIs and the Java Runtime on Mac OS X"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000425" target="_top">Java</a> &gt; <a href="../index.html" target="_top">Java Development Guide for Mac OS X</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../04-JavaUIToolkits/JavaUIToolkits.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../RevisionHistory/RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/TP40001902-SW1" title="Core Java APIs and the Java Runtime on Mac OS X"></a><hr /><H1>Core Java APIs and the Java Runtime on Mac OS X</H1><p>This article discusses the differences between the Core Java APIs on Mac OS X and other platforms. In general, the Core Java APIs behave as you would expect them to on other platforms, so most of them are not discussed in this article. There are a couple of details concerning Preferences that you should be aware of, as discussed in <span class="content_text"><a href="../02-JavaDevTools/JavaDevTools.html#//apple_ref/doc/uid/TP40001884-208031">“Other Tools.”</a></span></p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="CoreJavaAPIs.html#//apple_ref/doc/uid/TP40001902-210706-TPXREF142">Networking</a>
				
			<br/>
			
        
			
			
				<a href="CoreJavaAPIs.html#//apple_ref/doc/uid/TP40001902-210728-TPXREF143">Preferences</a>
				
			<br/>
			
        
			
			
				<a href="CoreJavaAPIs.html#//apple_ref/doc/uid/TP40001902-210780-TPXREF144">JNI</a>
				
			<br/>
			
        
			
			
				<a href="CoreJavaAPIs.html#//apple_ref/doc/uid/TP40001902-SW5">The Java Runtime</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001902-210706" title="Networking"></a><a name="//apple_ref/doc/uid/TP40001902-210706-TPXREF142" title="Networking"></a><h2>Networking</h2><p>Mac OS X v10.3 and later supports IPv6 (Internet Protocol version 6). Because J2SE 5.0 and Java SE 6 use IPv6 on platforms that support it, the default networking stack in Mac OS X is the IPv6 stack. You can make Java use the IPv4 stack by setting the <code>java.net.preferIPv4Stack</code> system property to <code>true</code>.</p><a name="//apple_ref/doc/uid/TP40001902-210728" title="Preferences"></a><a name="//apple_ref/doc/uid/TP40001902-210728-TPXREF143" title="Preferences"></a><h2>Preferences</h2><p>The Preferences API is fully supported in Mac OS X, but there are two details you should be aware of to provide the best experience to users:</p><ul class="ul"><li class="li"><p>The preferences files generated by the Preferences API are named <code>com.apple.java.util.prefs</code>. The user’s preferences file is stored in their home directory (<code>~/Library/Preferences/</code>). The system preferences are stored in <code>/Library/Preferences/</code> and are only persisted to disk if the user is an administrator.</p></li><li class="li"><p>To be consistent with the Mac OS X user experience, your preferences should be available from the application menu. The <code>com.apple.eawt.Application</code> class provides a mechanism for doing this. See <span class="content_text"><a href="http://developer.apple.com/documentation/Java/Reference/1.5.0/appledoc/api/index.html" target="_top">J2SE 5.0 Apple Extensions Reference</a></span> for more information.</p></li></ul><a name="//apple_ref/doc/uid/TP40001902-210780" title="JNI"></a><a name="//apple_ref/doc/uid/TP40001902-210780-TPXREF144" title="JNI"></a><h2>JNI</h2><p>It is recommended that you use the Java JNI Application template in the Xcode Organizer as a starting point for your JNI development. For more on the Xcode Organizer, see <span class="content_text"><a href="../02-JavaDevTools/JavaDevTools.html#//apple_ref/doc/uid/TP40001884-SW3">“The Xcode Organizer.”</a></span> </p><p>JNI libraries are named with the library name used in the <code>System.loadLibrary</code> method of your Java code, prefixed by <code>lib</code> and suffixed with <code>.jnilib</code>. For example, <code>System.loadLibrary("hello") </code>loads the library named <code>libhello.jnilib</code>. Java HotSpot also recognizes <code>.dylib</code> as a valid JNI library format as of Mac OS X v10.5.</p><p>To build as a dynamic shared library, use the <code>-dynamiclib</code> flag. Since your <code>.h</code> file produced by <code>javah</code> includes <code>jni.h</code>, you need to make sure you include its source directory. Putting all of that together looks something like this:</p><p><code>cc -c -I/System/Library/Frameworks/JavaVM.framework/Headers</code><em> sourceFile.c</em></p><p><code>cc -dynamiclib -o  libhello.jnilib</code><em> sourceFile.o</em><code> -framework JavaVM</code></p><p>For example, if the files <code>hello.c</code> and <code>hola.c</code> contain the implementations of the native methods to be built into a dynamic shared JNI library that will be called with <code>System.loadLibrary("hello")</code>, you would build the resultant library, <code>libhello.jnilib</code>, with this code: </p><div class="codesample"><table><tr><td scope="row"><pre>cc -c -I/System/Library/Frameworks/JavaVM.framework/Headers hola.c<span></span></pre></td></tr><tr><td scope="row"><pre>cc -c -I/System/Library/Frameworks/JavaVM.framework/Headers hello.c<span></span></pre></td></tr><tr><td scope="row"><pre>cc -dynamiclib -o libhello.jnilib hola.o hello.o -framework JavaVM<span></span></pre></td></tr></table></div><p>Often JNI libraries have interdependencies. For example assume the following:</p><ul class="ul"><li class="li"><p><code>libA.jnilib</code> contains a function <code><!--a-->foo()<!--/a--></code>.</p></li><li class="li"><p><code>libB.jnilib</code> needs to link against<code> libA.jnilib</code> to make use of <code><!--a-->foo()<!--/a--></code>.</p></li></ul><p>Such an interdependency is not a problem if you build your JNI libraries as dynamic shared libraries, but if you build them as bundles it does not work since symbols are private to a bundle. If you need to use bundles for backward compatibility, one solution is to put the common functions into a separate dynamic shared library and link that to the bundle. For example:</p><ol class="ol"><li class="li"><p>Compile the JNI library. </p><p><code>cc -g -I/System/Library/Frameworks/JavaVM.framework/Headers -c -o myJNILib.o myJNILib.c</code></p></li><li class="li"><p>Compile the file with the common functions. </p><p><code>cc -g -I/System/Library/Frameworks/JavaVM.framework/Headers -c -o CommonFunctions.o CommonFunctions.c</code></p></li><li class="li"><p>Build the object file for your common functions as a dynamic shared library. </p><p><code>cc -dynamiclib  -o libCommonFunctions.dylib CommonFunctions.o</code></p></li><li class="li"><p>Build your JNI library as a bundle and link against the dynamic shared library with your common functions in it. </p><p><code>cc -bundle -lCommonFunctions -o libMyJNILib.jnilib myJNILib.o</code></p></li></ol><div class="notebox"><a name="//apple_ref/doc/uid/TP40001902-DontLinkElementID_3" title="Note"></a><p><strong>Note:</strong>&nbsp;When building JNI libraries, you need to explicitly designate the path to <code>jni.h</code>. This is in <code>/System/Library/Frameworks/JavaVM.framework/Headers/</code>, not <code>/usr/include/</code> as on some other platforms.</p></div><div class="notebox"><a name="//apple_ref/doc/uid/TP40001902-DontLinkElementID_4" title="Note"></a><p><strong>Note:</strong>&nbsp;After you have built your JNI libraries, make sure to let Java know where they are. It is recommended that you do this by putting your libraries into your application bundle and passing in the path with the <code>-Djava.library.path</code> option. It is also possible to do this by putting your libraries in <code>/Library/Java/Extensions/</code>, but this is discouraged, as it breaks the encapsulation of your bundle.</p></div><p>A complete example of JNI development can be found in the <em><a href="../../../../../samplecode/MyFirstJNIProject/index.html#//apple_ref/doc/uid/DTS10003687" target="_top">MyFirstJNIProject</a></em> sample code. More details on JNI can be found in <span class="content_text"><a href="http://developer.apple.com/technotes/tn2005/tn2147.html" target="_top">Tech Note TN2147: JNI Development on Mac OS X</a></span>.</p><a name="//apple_ref/doc/uid/TP40001902-SW5" title="The Java Runtime"></a><h2>The Java Runtime</h2><p>The Java implementation for Mac OS X includes the Java HotSpot VM runtime and the Java HotSpot client VM, both from Sun.  The VM options available with the Java VM in Mac OS X vary slightly from those available on other platforms. The available options are presented in  <span class="content_text"><a href="../../../Reference/Java_VMOptionsRef/Articles/JavaVirtualMachineOptions.html#//apple_ref/doc/uid/TP40001974" target="_top">Java Virtual Machine Options</a></span>.</p><p><span class="content_text">Table 1</span> lists the basic properties of the Java VM in Mac OS X. You can use  <code> System.getProperties().list(System.out)</code> to obtain a complete list of system properties. </p><a name="//apple_ref/doc/uid/TP40001902-SW2" title="Table 1 JVM properties "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/TP40001903-211296" title="Table 1 JVM properties "></a><strong>Table 1&nbsp;&nbsp;</strong> JVM properties </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p> Property </p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p> Sample value </p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p> Notes </p></th></tr><tr><td  scope="row"><p><code> java.version </code></p></td><td ><p> 1.5.0_13 </p></td><td ><p> Mac OS X v10.4 and earlier ships with earlier versions of Java. Use this property to test for the minimal version your application requires. </p></td></tr><tr><td  scope="row"><p><code> java.vm.version </code></p></td><td ><p> 1.5.0_13 </p></td><td ><p></p></td></tr><tr><td  scope="row"><p><code> file.separator </code></p></td><td ><p> ‘/’ </p></td><td ><p> Note that this is a change from Mac OS 9.  </p></td></tr><tr><td  scope="row"><p><code> line.separator </code></p></td><td ><p> ‘\n’ </p></td><td ><p> This is consistent with UNIX-based Java implementations, but different from Mac OS 9 and Windows. </p></td></tr><tr><td  scope="row"><p><code> os.name </code></p></td><td ><p> Mac OS X </p></td><td ><p> Make sure to check for  <code> Mac OS X </code> , not just  <code> Mac OS </code> because  <code> Mac OS </code> returns  <code> true </code> for Mac OS 9 (and earlier) which did not even have a Java 2 VM. </p></td></tr><tr><td  scope="row"><p><code> os.version </code></p></td><td ><p> 10.5.4 </p></td><td ><p> Java 1.5 runs only in Mac OS X v10.4 or later. </p></td></tr></table></div><div class="notebox"><a name="//apple_ref/doc/uid/TP40001902-SW6" title=" Note "></a><p><strong> Note :</strong>&nbsp; The  <code> mrj.version</code> system property is still exposed by the VM in Java 1.5. Although you may still use this to determine if you are running in the Mac OS, for forward compatibility consider using the  <code>os.name</code> property to determine if you are running in Mac OS X. The reason is that this property may go away in future attempts to further synchronize the Apple source with the source from Sun. </p></div>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../04-JavaUIToolkits/JavaUIToolkits.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../RevisionHistory/RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2003, 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-10-15<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Java/Conceptual/Java14Development/05-CoreJavaAPIs/CoreJavaAPIs.html%3Fid%3DTP30001142-5.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Java/Conceptual/Java14Development/05-CoreJavaAPIs/CoreJavaAPIs.html%3Fid%3DTP30001142-5.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Java/Conceptual/Java14Development/05-CoreJavaAPIs/CoreJavaAPIs.html%3Fid%3DTP30001142-5.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
