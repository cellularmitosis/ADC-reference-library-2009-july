<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/1998/REC-html40-19980424/loose.dtd">
<html>
<head>
<title>kpi_socketfilter.h</title>
<meta http-equiv="Content-Type" content="text/html; charset=ascii">
<meta name="generator" content="HeaderDoc">
<style><!--
#tocMenu {
		display: block;
		position:fixed;
		top:0px;
		left:0px;
		width:210px;
		height:100%;
		background:transparent;
}
#bodyText {
		margin-left: 210px;
}
--></style>
<meta id="toc-file" name="toc-file" content="toc.html">
<script language="JavaScript" src="../../../../Resources/JavaScript/page.js" type="text/javascript"></script><link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css">
<style type="text/css"><!--.keyword {background:#ffffff; color:#761550;}.template {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.function {background:#ffffff; color:#000000;}.string {background: #ffffff; color:#891315;}.preprocessor {background:#ffffff; color:#236e25}.comment {background:#ffffff; color:#236e25}.char {background: #ffffff; color:#0000ff;}.var {background:#ffffff; color:#000000;}.type {background:#ffffff; color:#761550;}.param {background:#ffffff; color:#000000;}.graybox {         border-top: 1px solid #919699;         border-left: 1px solid #919699;         margin-bottom: 10px;         }  .graybox th {         padding: 4px 8px 4px 8px;         background: #E2E2E2;         font-size: 12px;         font-weight: bold;         border-bottom: 1px solid #919699;         border-right: 1px solid #919699;         }  .graybox td {         padding: 8px;         font-size: 12px;         text-align: left;         vertical-align: top;         border-bottom: 1px solid #919699;         border-right: 1px solid #919699;         }  --></style>
</head>
<body bgcolor="#ffffff" onload="initialize_page();">
<noscript>
<div id="tocMenu">
<iframe id="toc_content" name="toc_content" src="toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
</div>
</noscript>
<div id="bodyText">
<!-- start of header -->

<!-- start of header -->
<!--#include virtual="/includes/framesetheader"-->
<!-- end of header -->

<table width="600"><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <a href="../../../../../reference/Darwin/index.html#//apple_ref/doc/uid/TP30001281-TP30000422" target="_top">Darwin</a> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/kernel_fw_leo" target="_top">Kernel Framework Reference</a></font>
<!-- end breadcrumb insert request -->
<p>&#160;</p>
</td></tr></table>
<!-- end of header --><a name="top"></a>
<a name="//apple_ref/doc/header/kpi_socketfilter.h" title="kpi_socketfilter.h"></a>
<hr>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h1><a name="kpi_socketfilter.h">kpi_socketfilter.h</a></h1>
</td></tr></table>
<div class="spec_sheet_info_box"><table cellspacing="0" class="specbox"><tr>
<td scope="row"><b>Includes:</b></td>
<td><div style="margin-bottom:1px"><div class="content_text">
<!-- a -->&lt;sys/kernel_types.h&gt;<!-- /a --><br><a href="../kpi_socket_h/index.html#//apple_ref/doc/header/kpi_socket.h" target="_top">&lt;sys/kpi_socket.h&gt;</a>
</div></div></td>
</tr></table></div>
<h2>Overview</h2>
<!-- begin discussion --><p>This header defines an API for intercepting communications at the
socket layer.
</p>
<p>For the most part, socket filters want to do three things: Filter
data in and out, watch for state changes, and intercept a few calls
for security. The number of function pointers supplied by a socket
filter has been significantly reduced. The filter no longer has any
knowledge of socket buffers. The filter no longer intercepts nearly
every internal socket call. There are two data filters, an in
filter, and an out filter. The in filter occurs before data is
placed in the receive socket buffer. This is done to avoid waking
the process unnecessarily. The out filter occurs before the data is
appended to the send socket buffer. This should cover inbound and
outbound data. For monitoring state changes, we've added a notify
function that will be called when various events that the filter can
not intercept occur. In addition, we've added a few functions that a
filter may use to intercept common operations. These functions are:
connect (inbound), connect (outbound), bind, set socket option,
get socket option, and listen. Bind, listen, connect in, and connect
out could be used together to build a fairly comprehensive firewall
without having to do much with individual packets.<!-- end discussion -->
</p>
<hr>
<br><h2>Functions</h2>
<a name="HeaderDoc_functions"></a>
<dl>
<dt><tt><a href="index.html#//apple_ref/c/func/sflt_attach" target="_top">sflt_attach</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/c/func/sflt_detach" target="_top">sflt_detach</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/c/func/sflt_register" target="_top">sflt_register</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/c/func/sflt_unregister" target="_top">sflt_unregister</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/c/func/sock_inject_data_in" target="_top">sock_inject_data_in</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/c/func/sock_inject_data_out" target="_top">sock_inject_data_out</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/c/func/sockopt_copyin" target="_top">sockopt_copyin</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/c/func/sockopt_copyout" target="_top">sockopt_copyout</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/c/func/sockopt_direction" target="_top">sockopt_direction</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/c/func/sockopt_level" target="_top">sockopt_level</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/c/func/sockopt_name" target="_top">sockopt_name</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/c/func/sockopt_valsize" target="_top">sockopt_valsize</a></tt></dt>
<dd></dd>
</dl>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/sflt_attach;   name=sflt_attach --><a name="//apple_ref/c/func/sflt_attach"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sflt_attach">sflt_attach</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><!-- a --><span class="type">errno_t</span><!-- /a --> <a href="index.html#//apple_ref/c/func/sflt_attach" target="_top" class="function"><span class="function">sflt_attach</span></a>(
    <!-- a --><span class="type">socket_t</span><!-- /a --> <span class="param">so</span>,
    <span class="param">sflt_handle</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>socket</code></dt>
<dd><p>The socket the filter should be attached to.</p></dd>
<dt><code>handle</code></dt>
<dd><p>The handle of the registered filter to be attached.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->0 on success otherwise the errno error.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Attaches a socket filter to the specified socket. A
filter must be registered before it can be attached.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/sflt_detach;   name=sflt_detach --><a name="//apple_ref/c/func/sflt_detach"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sflt_detach">sflt_detach</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><!-- a --><span class="type">errno_t</span><!-- /a --> <a href="index.html#//apple_ref/c/func/sflt_detach" target="_top" class="function"><span class="function">sflt_detach</span></a>(
    <!-- a --><span class="type">socket_t</span><!-- /a --> <span class="param">so</span>,
    <span class="param">sflt_handle</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>socket</code></dt>
<dd><p>The socket the filter should be detached from.</p></dd>
<dt><code>handle</code></dt>
<dd><p>The handle of the registered filter to be detached.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->0 on success otherwise the errno error.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Detaches a socket filter from a specified socket.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/sflt_register;   name=sflt_register --><a name="//apple_ref/c/func/sflt_register"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sflt_register">sflt_register</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><!-- a --><span class="type">errno_t</span><!-- /a --> <a href="index.html#//apple_ref/c/func/sflt_register" target="_top" class="function"><span class="function">sflt_register</span></a>(
    <span class="keyword">const</span> <!-- a --><span class="var">struct</span><!-- /a --> <!-- a --><span class="var">sflt_filter</span><!-- /a --> <span class="var">*</span><!-- a --><span class="var">filter</span><!-- /a -->,
    <!-- a --><span class="var">int</span><!-- /a --> <!-- a --><span class="var">domain</span><!-- /a -->, 
    <!-- a --><span class="var">int</span><!-- /a --> <!-- a --><span class="var">type</span><!-- /a -->,
    <!-- a --><span class="var">int</span><!-- /a --> <!-- a --><span class="var">protocol</span><!-- /a -->);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>filter</code></dt>
<dd><p>A structure describing the filter.</p></dd>
<dt><code>domain</code></dt>
<dd><p>The protocol domain these filters will be attached to.</p></dd>
<dt><code>type</code></dt>
<dd><p>The socket type these filters will be attached to.</p></dd>
<dt><code>protocol</code></dt>
<dd><p>The protocol these filters will be attached to.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->0 on success otherwise the errno error.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Registers a socket filter. See 'man 2 socket' for a
desciption of domain, type, and protocol.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/sflt_unregister;   name=sflt_unregister --><a name="//apple_ref/c/func/sflt_unregister"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sflt_unregister">sflt_unregister</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><!-- a --><span class="type">errno_t</span><!-- /a --> <a href="index.html#//apple_ref/c/func/sflt_unregister" target="_top" class="function"><span class="function">sflt_unregister</span></a>(
    <a href="index.html#//apple_ref/c/tdef/sflt_handle" target="_top" class="type"><span class="type">sflt_handle</span></a> <span class="param">handle</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>handle</code></dt>
<dd><p>The sf_handle of the socket filter to unregister.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->0 on success otherwise the errno error.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Unregisters a socket filter. This will not detach the
socket filter from all sockets it may be attached to at the
time, it will just prevent the socket filter from being attached
to any new sockets.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/sock_inject_data_in;   name=sock_inject_data_in --><a name="//apple_ref/c/func/sock_inject_data_in"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sock_inject_data_in">sock_inject_data_in</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><!-- a --><span class="type">errno_t</span><!-- /a --> <a href="index.html#//apple_ref/c/func/sock_inject_data_in" target="_top" class="function"><span class="function">sock_inject_data_in</span></a>(
    <!-- a --><span class="type">socket_t</span><!-- /a --> <span class="param">so</span>,
    <span class="keyword">const</span> <!-- a --><span class="var">struct</span><!-- /a --> <!-- a --><span class="var">sockaddr</span><!-- /a --><span class="var">*</span> <!-- a --><span class="var">from</span><!-- /a -->, 
    <!-- a --><span class="var">mbuf_t</span><!-- /a --> <!-- a --><span class="var">data</span><!-- /a -->,
    <!-- a --><span class="var">mbuf_t</span><!-- /a --> <!-- a --><span class="var">control</span><!-- /a -->,
    <!-- a --><span class="var">sflt_data_flag_t</span><!-- /a --> <!-- a --><span class="var">flags</span><!-- /a -->);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>so</code></dt>
<dd><p>The socket to inject the data on.</p></dd>
<dt><code>from</code></dt>
<dd><p>The address the data is from, only necessary on
un-connected sockets. A copy of the address will be made, caller
is responsible for freeing the address after calling this
function.</p></dd>
<dt><code>data</code></dt>
<dd><p>The data and possibly control mbufs.</p></dd>
<dt><code>control</code></dt>
<dd><p>The separate control mbufs.</p></dd>
<dt><code>flags</code></dt>
<dd><p>Flags indicating the type of data.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->0 on success otherwise the errno error. If the function
returns an error, the caller is responsible for freeing the
mbuf.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Inject data in to the receive buffer of the socket as if
it had come from the network.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/sock_inject_data_out;   name=sock_inject_data_out --><a name="//apple_ref/c/func/sock_inject_data_out"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sock_inject_data_out">sock_inject_data_out</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><!-- a --><span class="type">errno_t</span><!-- /a --> <a href="index.html#//apple_ref/c/func/sock_inject_data_out" target="_top" class="function"><span class="function">sock_inject_data_out</span></a>(
    <!-- a --><span class="type">socket_t</span><!-- /a --> <span class="param">so</span>,
    <span class="keyword">const</span> <!-- a --><span class="var">struct</span><!-- /a --> <!-- a --><span class="var">sockaddr</span><!-- /a --><span class="var">*</span> <!-- a --><span class="var">to</span><!-- /a -->, 
    <!-- a --><span class="var">mbuf_t</span><!-- /a --> <!-- a --><span class="var">data</span><!-- /a -->,
    <!-- a --><span class="var">mbuf_t</span><!-- /a --> <!-- a --><span class="var">control</span><!-- /a -->,
    <!-- a --><span class="var">sflt_data_flag_t</span><!-- /a --> <!-- a --><span class="var">flags</span><!-- /a -->);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>so</code></dt>
<dd><p>The socket to inject the data on.</p></dd>
<dt><code>to</code></dt>
<dd><p>The address the data should be sent to, only necessary on
un-connected sockets. The caller is responsible for freeing the
to address after sock_inject_data_out returns.</p></dd>
<dt><code>data</code></dt>
<dd><p>The data and possibly control mbufs.</p></dd>
<dt><code>control</code></dt>
<dd><p>The separate control mbufs.</p></dd>
<dt><code>flags</code></dt>
<dd><p>Flags indicating the type of data.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->0 on success otherwise the errno error. The data and control
values are always freed regardless of return value.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Inject data in to the send buffer of the socket as if it
had come from the client.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/sockopt_copyin;   name=sockopt_copyin --><a name="//apple_ref/c/func/sockopt_copyin"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sockopt_copyin">sockopt_copyin</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><!-- a --><span class="type">errno_t</span><!-- /a --> <a href="index.html#//apple_ref/c/func/sockopt_copyin" target="_top" class="function"><span class="function">sockopt_copyin</span></a>(
    <!-- a --><span class="type">sockopt_t</span><!-- /a --> <span class="param">sopt</span>,
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">data</span>,
    <!-- a --><span class="type">size_t</span><!-- /a --> <span class="param">length</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>sopt</code></dt>
<dd><p>The socket option.</p></dd>
<dt><code>data</code></dt>
<dd><p>A pointer to the buffer to copy the data in to.</p></dd>
<dt><code>length</code></dt>
<dd><p>The number of bytes to copy.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->An errno error or zero upon success.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Copies the data from the socket option to a buffer.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/sockopt_copyout;   name=sockopt_copyout --><a name="//apple_ref/c/func/sockopt_copyout"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sockopt_copyout">sockopt_copyout</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><!-- a --><span class="type">errno_t</span><!-- /a --> <a href="index.html#//apple_ref/c/func/sockopt_copyout" target="_top" class="function"><span class="function">sockopt_copyout</span></a>(
    <!-- a --><span class="type">sockopt_t</span><!-- /a --> <span class="param">sopt</span>,
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">data</span>,
    <!-- a --><span class="type">size_t</span><!-- /a --> <span class="param">length</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>sopt</code></dt>
<dd><p>The socket option.</p></dd>
<dt><code>data</code></dt>
<dd><p>A pointer to the buffer to copy the data out of.</p></dd>
<dt><code>length</code></dt>
<dd><p>The number of bytes to copy.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->An errno error or zero upon success.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Copies the data from a buffer to a socket option.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/sockopt_direction;   name=sockopt_direction --><a name="//apple_ref/c/func/sockopt_direction"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sockopt_direction">sockopt_direction</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><!-- a --><span class="type">sockopt_dir</span><!-- /a --> <a href="index.html#//apple_ref/c/func/sockopt_direction" target="_top" class="function"><span class="function">sockopt_direction</span></a>(
    <!-- a --><span class="type">sockopt_t</span><!-- /a --> <span class="param">sopt</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>sopt</code></dt>
<dd><p>The socket option.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->sock_opt_get or sock_opt_set.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Retrieves the direction of the socket option (Get or
Set).
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/sockopt_level;   name=sockopt_level --><a name="//apple_ref/c/func/sockopt_level"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sockopt_level">sockopt_level</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><!-- a --><span class="type">int</span><!-- /a --> <a href="index.html#//apple_ref/c/func/sockopt_level" target="_top" class="function"><span class="function">sockopt_level</span></a>(
    <!-- a --><span class="type">sockopt_t</span><!-- /a --> <span class="param">sopt</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>sopt</code></dt>
<dd><p>The socket option.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->The socket option level. See man 2 setsockopt

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Retrieves the socket option level. (SOL_SOCKET, etc).
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/sockopt_name;   name=sockopt_name --><a name="//apple_ref/c/func/sockopt_name"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sockopt_name">sockopt_name</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><!-- a --><span class="type">int</span><!-- /a --> <a href="index.html#//apple_ref/c/func/sockopt_name" target="_top" class="function"><span class="function">sockopt_name</span></a>(
    <!-- a --><span class="type">sockopt_t</span><!-- /a --> <span class="param">sopt</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>sopt</code></dt>
<dd><p>The socket option.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->The socket option name. See man 2 setsockopt

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Retrieves the socket option name. (SO_SNDBUF, etc).
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/sockopt_valsize;   name=sockopt_valsize --><a name="//apple_ref/c/func/sockopt_valsize"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sockopt_valsize">sockopt_valsize</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><!-- a --><span class="type">size_t</span><!-- /a --> <a href="index.html#//apple_ref/c/func/sockopt_valsize" target="_top" class="function"><span class="function">sockopt_valsize</span></a>(
    <!-- a --><span class="type">sockopt_t</span><!-- /a --> <span class="param">sopt</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>sopt</code></dt>
<dd><p>The socket option.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->The length, in bytes, of the data.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Retrieves the size of the socket option data.
<!-- end discussion -->
</p>
<p></p>
<h2>Typedefs</h2>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/sf_accept_func;   name=sf_accept_func --><a name="//apple_ref/c/tdef/sf_accept_func"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sf_accept_func">sf_accept_func</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <!-- a --><span class="type">errno_t</span><!-- /a --> ( <span class="type">*</span><!-- a --><span class="function">sf_accept_func</span><!-- /a -->)(
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">cookie</span>,
    <!-- a --><span class="type">socket_t</span><!-- /a --> <span class="param">so_listen</span>,
    <!-- a --><span class="type">socket_t</span><!-- /a --> <span class="param">so</span>, 
    <span class="keyword">const</span> <!-- a --><span class="var">struct</span><!-- /a --> <!-- a --><span class="var">sockaddr</span><!-- /a --> <span class="var">*</span><!-- a --><span class="var">local</span><!-- /a -->,
    <span class="keyword">const</span> <!-- a --><span class="var">struct</span><!-- /a --> <!-- a --><span class="var">sockaddr</span><!-- /a --> <span class="var">*</span><!-- a --><span class="var">remote</span><!-- /a -->);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>cookie</code></dt>
<dd><p>Cookie value specified when the filter attach was called.</p></dd>
<dt><code>so_listen</code></dt>
<dd><p>The listening socket.</p></dd>
<dt><code>so</code></dt>
<dd><p>The socket that is about to be accepted.</p></dd>
<dt><code>local</code></dt>
<dd><p>The local address of the about to be accepted socket.</p></dd>
<dt><code>remote</code></dt>
<dd><p>The remote address of the about to be accepted socket.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Return:
0 - The caller will continue with normal processing of accept.
EJUSTRETURN - The to be accepted socket will be disconnected
prior to being returned to the caller of accept.  No further
control or data operations on the socket will be allowed.
This is the recommended return value as it has the least
amount of impact, especially to applications which don't
check the error value returned by accept.
Anything Else - The to be accepted socket will be closed and
the error will be returned to the caller of accept.
Note that socket filter developers are advised to exercise
caution when returning non-zero values to the caller,
since some applications don't check the error value
returned by accept and therefore risk breakage.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>sf_accept_func is called after a socket is dequeued
off the completed (incoming) connection list and before
the file descriptor is associated with it.  A filter can
utilize this callback to intercept the accepted socket
in order to examine it, prior to returning the socket to
the caller of accept.  Such a filter may also choose to
discard the accepted socket if it wishes to do so.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/sf_attach_func;   name=sf_attach_func --><a name="//apple_ref/c/tdef/sf_attach_func"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sf_attach_func">sf_attach_func</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <!-- a --><span class="type">errno_t</span><!-- /a --> ( <span class="type">*</span><!-- a --><span class="function">sf_attach_func</span><!-- /a -->)(
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="type">*</span><span class="param">cookie</span>,
    <!-- a --><span class="type">socket_t</span><!-- /a --> <span class="param">so</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>cookie</code></dt>
<dd><p>Used to allow the socket filter to set the cookie for
this attachment.</p></dd>
<dt><code>so</code></dt>
<dd><p>The socket the filter is being attached to.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->If you return a non-zero value, your filter will not be
attached to this socket.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>sf_attach_func is called to notify the filter it has
been attached to a socket. The filter may allocate memory for
this attachment and use the cookie to track it. This filter is
called in one of two cases:
</p>
<ol start="1">
<li> You've installed a global filter and a new socket was created.
</li>
<li> Your non-global socket filter is being attached using the SO_NKE
socket option.
</li>
</ol>
<!-- end discussion --><p></p>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/sf_bind_func;   name=sf_bind_func --><a name="//apple_ref/c/tdef/sf_bind_func"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sf_bind_func">sf_bind_func</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <!-- a --><span class="type">errno_t</span><!-- /a --> ( <span class="type">*</span><!-- a --><span class="function">sf_bind_func</span><!-- /a -->)(
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">cookie</span>,
    <!-- a --><span class="type">socket_t</span><!-- /a --> <span class="param">so</span>, 
    <span class="keyword">const</span> <!-- a --><span class="var">struct</span><!-- /a --> <!-- a --><span class="var">sockaddr</span><!-- /a --> <span class="var">*</span><!-- a --><span class="var">to</span><!-- /a -->);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>cookie</code></dt>
<dd><p>Cookie value specified when the filter attach was
called.</p></dd>
<dt><code>so</code></dt>
<dd><p>The socket the filter is attached to.</p></dd>
<dt><code>to</code></dt>
<dd><p>The local address of the socket will be bound to.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Return:
0 - The caller will continue with normal processing of the bind.
Anything Else - The caller will rejecting the bind.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>sf_bind_func is called before performing a bind
operation on a socket.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/sf_connect_in_func;   name=sf_connect_in_func --><a name="//apple_ref/c/tdef/sf_connect_in_func"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sf_connect_in_func">sf_connect_in_func</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <!-- a --><span class="type">errno_t</span><!-- /a --> ( <span class="type">*</span><!-- a --><span class="function">sf_connect_in_func</span><!-- /a -->)(
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">cookie</span>,
    <!-- a --><span class="type">socket_t</span><!-- /a --> <span class="param">so</span>, 
    <span class="keyword">const</span> <!-- a --><span class="var">struct</span><!-- /a --> <!-- a --><span class="var">sockaddr</span><!-- /a --> <span class="var">*</span><!-- a --><span class="var">from</span><!-- /a -->);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>cookie</code></dt>
<dd><p>Cookie value specified when the filter attach was
called.</p></dd>
<dt><code>so</code></dt>
<dd><p>The socket the filter is attached to.</p></dd>
<dt><code>from</code></dt>
<dd><p>The address the incoming connection is from.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Return:
0 - The caller will continue with normal processing of the connection.
Anything Else - The caller will rejecting the incoming connection.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>sf_connect_in_func is called to filter inbound connections. A
protocol will call this before accepting an incoming connection and
placing it on the queue of completed connections. Warning: This filter
is on the data path. Do not spend excesive time. Do not wait for data on
another socket.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/sf_connect_out_func;   name=sf_connect_out_func --><a name="//apple_ref/c/tdef/sf_connect_out_func"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sf_connect_out_func">sf_connect_out_func</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <!-- a --><span class="type">errno_t</span><!-- /a --> ( <span class="type">*</span><!-- a --><span class="function">sf_connect_out_func</span><!-- /a -->)(
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">cookie</span>,
    <!-- a --><span class="type">socket_t</span><!-- /a --> <span class="param">so</span>, 
    <span class="keyword">const</span> <!-- a --><span class="var">struct</span><!-- /a --> <!-- a --><span class="var">sockaddr</span><!-- /a --> <span class="var">*</span><!-- a --><span class="var">to</span><!-- /a -->);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>cookie</code></dt>
<dd><p>Cookie value specified when the filter attach was
called.</p></dd>
<dt><code>so</code></dt>
<dd><p>The socket the filter is attached to.</p></dd>
<dt><code>to</code></dt>
<dd><p>The remote address of the outbound connection.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Return:
0 - The caller will continue with normal processing of the connection.
Anything Else - The caller will rejecting the outbound connection.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>sf_connect_out_func is called to filter outbound
connections. A protocol will call this before initiating an
outbound connection.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/sf_data_in_func;   name=sf_data_in_func --><a name="//apple_ref/c/tdef/sf_data_in_func"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sf_data_in_func">sf_data_in_func</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <!-- a --><span class="type">errno_t</span><!-- /a --> ( <span class="type">*</span><!-- a --><span class="function">sf_data_in_func</span><!-- /a -->)(
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">cookie</span>,
    <!-- a --><span class="type">socket_t</span><!-- /a --> <span class="param">so</span>, 
    <span class="keyword">const</span> <!-- a --><span class="var">struct</span><!-- /a --> <!-- a --><span class="var">sockaddr</span><!-- /a --> <span class="var">*</span><!-- a --><span class="var">from</span><!-- /a -->,
    <!-- a --><span class="var">mbuf_t</span><!-- /a --> <span class="var">*</span><!-- a --><span class="var">data</span><!-- /a -->, 
    <!-- a --><span class="var">mbuf_t</span><!-- /a --> <span class="var">*</span><!-- a --><span class="var">control</span><!-- /a -->,
    <!-- a --><span class="var">sflt_data_flag_t</span><!-- /a --> <!-- a --><span class="var">flags</span><!-- /a -->);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>cookie</code></dt>
<dd><p>Cookie value specified when the filter attach was
called.</p></dd>
<dt><code>so</code></dt>
<dd><p>The socket the filter is attached to.</p></dd>
<dt><code>from</code></dt>
<dd><p>The addres the data is from, may be NULL if the socket
is connected.</p></dd>
<dt><code>data</code></dt>
<dd><p>The data being received. Control data may appear in the
mbuf chain, be sure to check the mbuf types to find control
data.</p></dd>
<dt><code>control</code></dt>
<dd><p>Control data being passed separately from the data.</p></dd>
<dt><code>flags</code></dt>
<dd><p>Flags to indicate if this is out of band data or a
record.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Return:
0 - The caller will continue with normal processing of the data.
EJUSTRETURN - The caller will stop processing the data, the data will not be freed.
Anything Else - The caller will free the data and stop processing.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>sf_data_in_func is called to filter incoming data. If your
filter intercepts data for later reinjection, it must queue all incoming
data to preserve the order of the data. Use sock_inject_data_in to later
reinject this data if you return EJUSTRETURN. Warning: This filter is on
the data path. Do not spend excesive time. Do not wait for data on
another socket.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/sf_data_out_func;   name=sf_data_out_func --><a name="//apple_ref/c/tdef/sf_data_out_func"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sf_data_out_func">sf_data_out_func</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <!-- a --><span class="type">errno_t</span><!-- /a --> ( <span class="type">*</span><!-- a --><span class="function">sf_data_out_func</span><!-- /a -->)(
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">cookie</span>,
    <!-- a --><span class="type">socket_t</span><!-- /a --> <span class="param">so</span>, 
    <span class="keyword">const</span> <!-- a --><span class="var">struct</span><!-- /a --> <!-- a --><span class="var">sockaddr</span><!-- /a --> <span class="var">*</span><!-- a --><span class="var">to</span><!-- /a -->,
    <!-- a --><span class="var">mbuf_t</span><!-- /a --> <span class="var">*</span><!-- a --><span class="var">data</span><!-- /a -->, 
    <!-- a --><span class="var">mbuf_t</span><!-- /a --> <span class="var">*</span><!-- a --><span class="var">control</span><!-- /a -->,
    <!-- a --><span class="var">sflt_data_flag_t</span><!-- /a --> <!-- a --><span class="var">flags</span><!-- /a -->);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>cookie</code></dt>
<dd><p>Cookie value specified when the filter attach was
called.</p></dd>
<dt><code>so</code></dt>
<dd><p>The socket the filter is attached to.</p></dd>
<dt><code>from</code></dt>
<dd><p>The address the data is from, may be NULL if the socket
is connected.</p></dd>
<dt><code>data</code></dt>
<dd><p>The data being received. Control data may appear in the
mbuf chain, be sure to check the mbuf types to find control
data.</p></dd>
<dt><code>control</code></dt>
<dd><p>Control data being passed separately from the data.</p></dd>
<dt><code>flags</code></dt>
<dd><p>Flags to indicate if this is out of band data or a
record.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Return:
0 - The caller will continue with normal processing of the data.
EJUSTRETURN - The caller will stop processing the data, the data will not be freed.
Anything Else - The caller will free the data and stop processing.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>sf_data_out_func is called to filter outbound data. If
your filter intercepts data for later reinjection, it must queue
all outbound data to preserve the order of the data when
reinjecting. Use sock_inject_data_out to later reinject this
data.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/sf_detach_func;   name=sf_detach_func --><a name="//apple_ref/c/tdef/sf_detach_func"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sf_detach_func">sf_detach_func</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> ( <span class="type">*</span><!-- a --><span class="function">sf_detach_func</span><!-- /a -->)(
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">cookie</span>,
    <!-- a --><span class="type">socket_t</span><!-- /a --> <span class="param">so</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>cookie</code></dt>
<dd><p>Cookie value specified when the filter attach was
called.</p></dd>
<dt><code>so</code></dt>
<dd><p>The socket the filter is attached to.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->If you return a non-zero value, your filter will not be
attached to this socket.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>sf_detach_func is called to notify the filter it has
been detached from a socket. If the filter allocated any memory
for this attachment, it should be freed. This function will
be called when the socket is disposed of.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/sf_getoption_func;   name=sf_getoption_func --><a name="//apple_ref/c/tdef/sf_getoption_func"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sf_getoption_func">sf_getoption_func</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <!-- a --><span class="type">errno_t</span><!-- /a --> ( <span class="type">*</span><!-- a --><span class="function">sf_getoption_func</span><!-- /a -->)(
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">cookie</span>,
    <!-- a --><span class="type">socket_t</span><!-- /a --> <span class="param">so</span>, 
    <!-- a --><span class="type">sockopt_t</span><!-- /a --> <span class="param">opt</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>cookie</code></dt>
<dd><p>Cookie value specified when the filter attach was
called.</p></dd>
<dt><code>so</code></dt>
<dd><p>The socket the filter is attached to.</p></dd>
<dt><code>opt</code></dt>
<dd><p>The socket option to get.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Return:
0 - The caller will continue with normal processing of the getsockopt.
Anything Else - The caller will stop processing and return this error.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>sf_getoption_func is called before performing getsockopt
on a socket.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/sf_getpeername_func;   name=sf_getpeername_func --><a name="//apple_ref/c/tdef/sf_getpeername_func"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sf_getpeername_func">sf_getpeername_func</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <!-- a --><span class="type">int</span><!-- /a --> ( <span class="type">*</span><!-- a --><span class="function">sf_getpeername_func</span><!-- /a -->)(
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">cookie</span>,
    <!-- a --><span class="type">socket_t</span><!-- /a --> <span class="param">so</span>, 
    <span class="keyword">struct</span> <!-- a --><span class="type">sockaddr</span><!-- /a --> <span class="type">*</span><span class="type">*</span><span class="param">sa</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>cookie</code></dt>
<dd><p>Cookie value specified when the filter attach was
called.</p></dd>
<dt><code>so</code></dt>
<dd><p>The socket the filter is attached to.</p></dd>
<dt><code>sa</code></dt>
<dd><p>A pointer to a socket address pointer.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->If you return a non-zero value, processing will stop. If
you return EJUSTRETURN, no further filters will be called
but a result of zero will be returned to the caller of
getpeername.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>sf_getpeername_func is called to allow a filter to
to intercept the getpeername function. When called, sa will
point to a pointer to a socket address that was malloced
in zone M_SONAME. If you want to replace this address, either
modify the currenty copy or allocate a new one and free the
old one.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/sf_getsockname_func;   name=sf_getsockname_func --><a name="//apple_ref/c/tdef/sf_getsockname_func"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sf_getsockname_func">sf_getsockname_func</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <!-- a --><span class="type">int</span><!-- /a --> ( <span class="type">*</span><!-- a --><span class="function">sf_getsockname_func</span><!-- /a -->)(
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">cookie</span>,
    <!-- a --><span class="type">socket_t</span><!-- /a --> <span class="param">so</span>, 
    <span class="keyword">struct</span> <!-- a --><span class="type">sockaddr</span><!-- /a --> <span class="type">*</span><span class="type">*</span><span class="param">sa</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>cookie</code></dt>
<dd><p>Cookie value specified when the filter attach was
called.</p></dd>
<dt><code>so</code></dt>
<dd><p>The socket the filter is attached to.</p></dd>
<dt><code>sa</code></dt>
<dd><p>A pointer to a socket address pointer.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->If you return a non-zero value, processing will stop. If
you return EJUSTRETURN, no further filters will be called
but a result of zero will be returned to the caller of
getsockname.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>sf_getsockname_func is called to allow a filter to
to intercept the getsockname function. When called, sa will
point to a pointer to a socket address that was malloced
in zone M_SONAME. If you want to replace this address, either
modify the currenty copy or allocate a new one and free the
old one.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/sf_ioctl_func;   name=sf_ioctl_func --><a name="//apple_ref/c/tdef/sf_ioctl_func"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sf_ioctl_func">sf_ioctl_func</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <!-- a --><span class="type">errno_t</span><!-- /a --> ( <span class="type">*</span><!-- a --><span class="function">sf_ioctl_func</span><!-- /a -->)(
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">cookie</span>,
    <!-- a --><span class="type">socket_t</span><!-- /a --> <span class="param">so</span>, 
    <!-- a --><span class="type">u_int32_t</span><!-- /a --> <span class="param">request</span>,
    <span class="keyword">const</span> <!-- a --><span class="var">char</span><!-- /a --><span class="var">*</span> <!-- a --><span class="var">argp</span><!-- /a -->);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>cookie</code></dt>
<dd><p>Cookie value specified when the filter attach was
called.</p></dd>
<dt><code>so</code></dt>
<dd><p>The socket the filter is attached to.</p></dd>
<dt><code>request</code></dt>
<dd><p>The ioctl name.</p></dd>
<dt><code>argp</code></dt>
<dd><p>A pointer to the ioctl parameter.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Return:
0 - The caller will continue with normal processing of this ioctl.
Anything Else - The caller will stop processing and return this error.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>sf_ioctl_func is called before performing an ioctl
on a socket.
</p>
<p>All undefined ioctls are reserved for future use by Apple. If
you need to communicate with your kext using an ioctl, please
use SIOCSIFKPI and SIOCGIFKPI.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/sf_listen_func;   name=sf_listen_func --><a name="//apple_ref/c/tdef/sf_listen_func"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sf_listen_func">sf_listen_func</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <!-- a --><span class="type">errno_t</span><!-- /a --> ( <span class="type">*</span><!-- a --><span class="function">sf_listen_func</span><!-- /a -->)(
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">cookie</span>,
    <!-- a --><span class="type">socket_t</span><!-- /a --> <span class="param">so</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>cookie</code></dt>
<dd><p>Cookie value specified when the filter attach was
called.</p></dd>
<dt><code>so</code></dt>
<dd><p>The socket the filter is attached to.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Return:
0 - The caller will continue with normal processing of listen.
Anything Else - The caller will stop processing and return this error.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>sf_listen_func is called before performing listen
on a socket.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/sf_notify_func;   name=sf_notify_func --><a name="//apple_ref/c/tdef/sf_notify_func"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sf_notify_func">sf_notify_func</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> ( <span class="type">*</span><!-- a --><span class="function">sf_notify_func</span><!-- /a -->)(
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">cookie</span>,
    <!-- a --><span class="type">socket_t</span><!-- /a --> <span class="param">so</span>, 
    <a href="index.html#//apple_ref/c/tag/sflt_event_t" target="_top" class="type"><span class="type">sflt_event_t</span></a> <span class="param">event</span>,
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">param</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Fields</font></h5>
<dl>
<dt><code>cookie</code></dt>
<dd><p>Cookie value specified when the filter attach was
called.</p></dd>
<dt><code>so</code></dt>
<dd><p>The socket the filter is attached to.</p></dd>
<dt><code>event</code></dt>
<dd><p>The type of event that has occurred.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Fields</font></h5>
<blockquote>
<dl>
<dt><code>param</code></dt>
<dd><p>Additional information about the event.</p></dd>
</dl>
</blockquote>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>sf_notify_func is called to notify the filter of various
state changes and other events occuring on the socket.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/sf_setoption_func;   name=sf_setoption_func --><a name="//apple_ref/c/tdef/sf_setoption_func"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sf_setoption_func">sf_setoption_func</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <!-- a --><span class="type">errno_t</span><!-- /a --> ( <span class="type">*</span><!-- a --><span class="function">sf_setoption_func</span><!-- /a -->)(
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">cookie</span>,
    <!-- a --><span class="type">socket_t</span><!-- /a --> <span class="param">so</span>, 
    <!-- a --><span class="type">sockopt_t</span><!-- /a --> <span class="param">opt</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>cookie</code></dt>
<dd><p>Cookie value specified when the filter attach was
called.</p></dd>
<dt><code>so</code></dt>
<dd><p>The socket the filter is attached to.</p></dd>
<dt><code>opt</code></dt>
<dd><p>The socket option to set.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Return:
0 - The caller will continue with normal processing of the setsockopt.
Anything Else - The caller will stop processing and return this error.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>sf_setoption_func is called before performing setsockopt
on a socket.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/sf_unregistered_func;   name=sf_unregistered_func --><a name="//apple_ref/c/tdef/sf_unregistered_func"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sf_unregistered_func">sf_unregistered_func</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> ( <span class="type">*</span><!-- a --><span class="function">sf_unregistered_func</span><!-- /a -->)(
    <a href="index.html#//apple_ref/c/tdef/sflt_handle" target="_top" class="type"><span class="type">sflt_handle</span></a> <span class="param">handle</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Fields</font></h5>
<dl>
<dt><code>handle</code></dt>
<dd><p>The socket filter handle used to identify this filter.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>sf_unregistered_func is called to notify the filter it
has been unregistered. This is the last function the stack will
call and this function will only be called once all other
function calls in to your filter have completed. Once this
function has been called, your kext may safely unload.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/sflt_handle;   name=sflt_handle --><a name="//apple_ref/c/tdef/sflt_handle"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sflt_handle">sflt_handle</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>A 4 byte identifier used with the SO_NKE socket option to
identify the socket filter to be attached.
<!-- end abstract --></p>
<p></p>
<pre><span class="keyword">typedef</span> <!-- a --><span class="type">u_int32_t</span><!-- /a --> <!-- a --><span class="var">sflt_handle</span><!-- /a -->;  </pre>
<p></p>
<h2>Structs and Unions</h2>
<hr>
<!-- headerDoc=tag;  uid=//apple_ref/c/tag/sflt_filter;   name=sflt_filter --><a name="//apple_ref/c/tag/sflt_filter"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sflt_filter">sflt_filter</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">struct</span> <a href="index.html#//apple_ref/c/tag/sflt_filter" target="_top" class="type"><span class="type">sflt_filter</span></a> { 
    <a href="index.html#//apple_ref/c/tdef/sflt_handle" target="_top" class="type"><span class="type">sflt_handle</span></a> <!-- a --><span class="var">sf_handle</span><!-- /a -->; 
    <!-- a --><span class="type">int</span><!-- /a --> <!-- a --><span class="var">sf_flags</span><!-- /a -->; 
    <!-- a --><span class="type">char</span><!-- /a --> <span class="type">*</span><!-- a --><span class="var">sf_name</span><!-- /a -->;  
    <a href="index.html#//apple_ref/c/tdef/sf_unregistered_func" target="_top" class="type"><span class="type">sf_unregistered_func</span></a> <!-- a --><span class="var">sf_unregistered</span><!-- /a -->; 
    <a href="index.html#//apple_ref/c/tdef/sf_attach_func" target="_top" class="type"><span class="type">sf_attach_func</span></a> <!-- a --><span class="var">sf_attach</span><!-- /a -->; 
    <a href="index.html#//apple_ref/c/tdef/sf_detach_func" target="_top" class="type"><span class="type">sf_detach_func</span></a> <!-- a --><span class="var">sf_detach</span><!-- /a -->;  
    <a href="index.html#//apple_ref/c/tdef/sf_notify_func" target="_top" class="type"><span class="type">sf_notify_func</span></a> <!-- a --><span class="var">sf_notify</span><!-- /a -->; 
    <a href="index.html#//apple_ref/c/tdef/sf_getpeername_func" target="_top" class="type"><span class="type">sf_getpeername_func</span></a> <!-- a --><span class="var">sf_getpeername</span><!-- /a -->; 
    <a href="index.html#//apple_ref/c/tdef/sf_getsockname_func" target="_top" class="type"><span class="type">sf_getsockname_func</span></a> <!-- a --><span class="var">sf_getsockname</span><!-- /a -->; 
    <a href="index.html#//apple_ref/c/tdef/sf_data_in_func" target="_top" class="type"><span class="type">sf_data_in_func</span></a> <!-- a --><span class="var">sf_data_in</span><!-- /a -->; 
    <a href="index.html#//apple_ref/c/tdef/sf_data_out_func" target="_top" class="type"><span class="type">sf_data_out_func</span></a> <!-- a --><span class="var">sf_data_out</span><!-- /a -->; 
    <a href="index.html#//apple_ref/c/tdef/sf_connect_in_func" target="_top" class="type"><span class="type">sf_connect_in_func</span></a> <!-- a --><span class="var">sf_connect_in</span><!-- /a -->; 
    <a href="index.html#//apple_ref/c/tdef/sf_connect_out_func" target="_top" class="type"><span class="type">sf_connect_out_func</span></a> <!-- a --><span class="var">sf_connect_out</span><!-- /a -->; 
    <a href="index.html#//apple_ref/c/tdef/sf_bind_func" target="_top" class="type"><span class="type">sf_bind_func</span></a> <!-- a --><span class="var">sf_bind</span><!-- /a -->; 
    <a href="index.html#//apple_ref/c/tdef/sf_setoption_func" target="_top" class="type"><span class="type">sf_setoption_func</span></a> <!-- a --><span class="var">sf_setoption</span><!-- /a -->; 
    <a href="index.html#//apple_ref/c/tdef/sf_getoption_func" target="_top" class="type"><span class="type">sf_getoption_func</span></a> <!-- a --><span class="var">sf_getoption</span><!-- /a -->; 
    <a href="index.html#//apple_ref/c/tdef/sf_listen_func" target="_top" class="type"><span class="type">sf_listen_func</span></a> <!-- a --><span class="var">sf_listen</span><!-- /a -->; 
    <a href="index.html#//apple_ref/c/tdef/sf_ioctl_func" target="_top" class="type"><span class="type">sf_ioctl_func</span></a> <!-- a --><span class="var">sf_ioctl</span><!-- /a -->; 
    <span class="comment">/*
         * The following are valid only if SFLT_EXTENDED flag is set.
         * Initialize sf_ext_len to sizeof sflt_filter_ext structure.
         * Filters must also initialize reserved fields with zeroes.</span>
        <span class="comment">*/</span>
    <span class="keyword">struct</span> <!-- a --><span class="type">sflt_filter_ext</span><!-- /a --> { 
        <span class="keyword">unsigned</span> <!-- a --><span class="type">int</span><!-- /a --> <!-- a --><span class="var">sf_ext_len</span><!-- /a -->; 
        <a href="index.html#//apple_ref/c/tdef/sf_accept_func" target="_top" class="type"><span class="type">sf_accept_func</span></a> <!-- a --><span class="var">sf_ext_accept</span><!-- /a -->; 
        <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><!-- a --><span class="type">sf_ext_rsvd</span><!-- /a -->[<span class="number">5</span>]; <span class="comment">/* Reserved */</span>
        } <!-- a --><span class="var">sf_ext</span><!-- /a -->; 
    <span class="">#define</span><span class="preprocessor"> </span><!-- a --><span class="preprocessor">sf_len</span><!-- /a --><span class="preprocessor"> </span><!-- a --><span class="preprocessor">sf_ext</span><!-- /a --><span class="preprocessor">.</span><!-- a --><span class="preprocessor">sf_ext_len</span><!-- /a --> 
    <span class="">#define</span><span class="preprocessor"> </span><!-- a --><span class="preprocessor">sf_accept</span><!-- /a --><span class="preprocessor"> </span><!-- a --><span class="preprocessor">sf_ext</span><!-- /a --><span class="preprocessor">.</span><!-- a --><span class="preprocessor">sf_ext_accept</span><!-- /a --> 
};  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Fields</font></h5>
<dl>
<dt><code>sf_handle</code></dt>
<dd><p>A value used to find socket filters by
applications. An application can use this value to specify that
this filter should be attached when using the SO_NKE socket
option.</p></dd>
<dt><code>sf_flags</code></dt>
<dd><p>Indicate whether this filter should be attached to
all new sockets or just those that request the filter be
attached using the SO_NKE socket option. If this filter
utilizes the socket filter extension fields, it must also
set SFLT_EXTENDED.</p></dd>
<dt><code>sf_name</code></dt>
<dd><p>A name used for debug purposes.</p></dd>
<dt><code>sf_unregistered</code></dt>
<dd><p>Your function for being notified when your
filter has been unregistered.</p></dd>
<dt><code>sf_attach</code></dt>
<dd><p>Your function for handling attaches to sockets.</p></dd>
<dt><code>sf_detach</code></dt>
<dd><p>Your function for handling detaches from sockets.</p></dd>
<dt><code>sf_notify</code></dt>
<dd><p>Your function for handling events. May be null.</p></dd>
<dt><code>sf_data_in</code></dt>
<dd><p>Your function for handling incoming data. May be
null.</p></dd>
<dt><code>sf_data_out</code></dt>
<dd><p>Your function for handling outgoing data. May be
null.</p></dd>
<dt><code>sf_connect_in</code></dt>
<dd><p>Your function for handling inbound
connections. May be null.</p></dd>
<dt><code>sf_connect_out</code></dt>
<dd><p>Your function for handling outbound
connections. May be null.</p></dd>
<dt><code>sf_bind</code></dt>
<dd><p>Your function for handling binds. May be null.</p></dd>
<dt><code>sf_setoption</code></dt>
<dd><p>Your function for handling setsockopt. May be null.</p></dd>
<dt><code>sf_getoption</code></dt>
<dd><p>Your function for handling getsockopt. May be null.</p></dd>
<dt><code>sf_listen</code></dt>
<dd><p>Your function for handling listen. May be null.</p></dd>
<dt><code>sf_ioctl</code></dt>
<dd><p>Your function for handling ioctls. May be null.</p></dd>
<dt><code>sf_len</code></dt>
<dd><p>Length of socket filter extension structure; developers
must initialize this to sizeof sflt_filter_ext structure.
This field and all fields following it will only be valid
if SFLT_EXTENDED flag is set in sf_flags field.</p></dd>
<dt><code>sf_ext_accept</code></dt>
<dd><p>Your function for handling inbound connections
at accept time.  May be null.</p></dd>
<dt><code>sf_ext_rsvd</code></dt>
<dd><p>Reserved for future use; you must initialize
the reserved fields with zeroes.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This structure is used to define a socket filter.
<!-- end discussion -->
</p>
<p></p>
<h2>Enumerations</h2>
<hr>
<!-- headerDoc=tag;  uid=//apple_ref/c/tag/sflt_data_flag_t;   name=sflt_data_flag_t --><a name="//apple_ref/c/tag/sflt_data_flag_t"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sflt_data_flag_t">sflt_data_flag_t</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Inbound and outbound data filters may handle many
different types of incoming and outgoing data. These flags help
distinguish between normal data, out-of-band data, and records.
<!-- end abstract --></p>
<p></p>
<pre><span class="keyword">enum</span> { 
    <a href="../../KPI_Reference/kpi_socketfilter/CompositePage.html#//apple_ref/c/econst/sock_data_filt_flag_oob" target="_top" class="var"><span class="var">sock_data_filt_flag_oob</span></a> = <span class="number">1</span>, 
    <a href="../../KPI_Reference/kpi_socketfilter/CompositePage.html#//apple_ref/c/econst/sock_data_filt_flag_record" target="_top" class="var"><span class="var">sock_data_filt_flag_record</span></a> = <span class="number">2</span> 
};  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Constants</font></h5>
<blockquote>
<dl>
<dt><a name="//apple_ref/c/econst/sflt_data_flag_t/sock_data_filt_flag_oob"><code>sock_data_filt_flag_oob</code></a></dt>
<dd><p>Indicates this data is out-of-band
data.</p></dd>
<dt><a name="//apple_ref/c/econst/sflt_data_flag_t/sock_data_filt_flag_record"><code>sock_data_filt_flag_record</code></a></dt>
<dd><p>Indicates this data is a
record. This flag is only ever seen on inbound data.</p></dd>
</dl>
</blockquote>
<p></p>
<hr>
<!-- headerDoc=tag;  uid=//apple_ref/c/tag/sflt_event_t;   name=sflt_event_t --><a name="//apple_ref/c/tag/sflt_event_t"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sflt_event_t">sflt_event_t</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Events notify a filter of state changes and other various
events related to the socket. These events cannot be prevented
or intercepted, only observed.
<!-- end abstract --></p>
<p></p>
<pre><span class="keyword">enum</span> { 
    <!-- a --><span class="var">sock_evt_connecting</span><!-- /a --> = <span class="number">1</span>, 
    <a href="../../KPI_Reference/kpi_socketfilter/CompositePage.html#//apple_ref/c/econst/sock_evt_connected" target="_top" class="var"><span class="var">sock_evt_connected</span></a> = <span class="number">2</span>, 
    <!-- a --><span class="var">sock_evt_disconnecting</span><!-- /a --> = <span class="number">3</span>, 
    <a href="../../KPI_Reference/kpi_socketfilter/CompositePage.html#//apple_ref/c/econst/sock_evt_disconnected" target="_top" class="var"><span class="var">sock_evt_disconnected</span></a> = <span class="number">4</span>, 
    <a href="../../KPI_Reference/kpi_socketfilter/CompositePage.html#//apple_ref/c/econst/sock_evt_flush_read" target="_top" class="var"><span class="var">sock_evt_flush_read</span></a> = <span class="number">5</span>, 
    <a href="../../KPI_Reference/kpi_socketfilter/CompositePage.html#//apple_ref/c/econst/sock_evt_shutdown" target="_top" class="var"><span class="var">sock_evt_shutdown</span></a> = <span class="number">6</span>, <span class="comment">/* param points to an integer specifying how (read, write, or both) see man 2 shutdown */</span>
    <a href="../../KPI_Reference/kpi_socketfilter/CompositePage.html#//apple_ref/c/econst/sock_evt_cantrecvmore" target="_top" class="var"><span class="var">sock_evt_cantrecvmore</span></a> = <span class="number">7</span>, 
    <a href="../../KPI_Reference/kpi_socketfilter/CompositePage.html#//apple_ref/c/econst/sock_evt_cantsendmore" target="_top" class="var"><span class="var">sock_evt_cantsendmore</span></a> = <span class="number">8</span>, 
    <a href="../../KPI_Reference/kpi_socketfilter/CompositePage.html#//apple_ref/c/econst/sock_evt_closing" target="_top" class="var"><span class="var">sock_evt_closing</span></a> = <span class="number">9</span>, 
    <a href="../../KPI_Reference/kpi_socketfilter/CompositePage.html#//apple_ref/c/econst/sock_evt_bound" target="_top" class="var"><span class="var">sock_evt_bound</span></a> = <span class="number">10</span> 
};  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Constants</font></h5>
<blockquote>
<dl>
<dt><a name="//apple_ref/c/econst/sflt_event_t/sock_evt_connected"><code>sock_evt_connected</code></a></dt>
<dd><p>Indicates this socket has moved to the
connected state.</p></dd>
<dt><a name="//apple_ref/c/econst/sflt_event_t/sock_evt_disconnected"><code>sock_evt_disconnected</code></a></dt>
<dd><p>Indicates this socket has moved to
the disconnected state.</p></dd>
<dt><a name="//apple_ref/c/econst/sflt_event_t/sock_evt_flush_read"><code>sock_evt_flush_read</code></a></dt>
<dd><p>The read socket buffer has been
flushed.</p></dd>
<dt><a name="//apple_ref/c/econst/sflt_event_t/sock_evt_shutdown"><code>sock_evt_shutdown</code></a></dt>
<dd><p>The read and or write side(s) of the
connection have been shutdown. The param will point to an
integer that indicates the direction that has been shutdown. See
'man 2 shutdown' for more information.</p></dd>
<dt><a name="//apple_ref/c/econst/sflt_event_t/sock_evt_cantrecvmore"><code>sock_evt_cantrecvmore</code></a></dt>
<dd><p>Indicates the socket cannot receive
more data.</p></dd>
<dt><a name="//apple_ref/c/econst/sflt_event_t/sock_evt_cantsendmore"><code>sock_evt_cantsendmore</code></a></dt>
<dd><p>Indicates the socket cannot send
more data.</p></dd>
<dt><a name="//apple_ref/c/econst/sflt_event_t/sock_evt_closing"><code>sock_evt_closing</code></a></dt>
<dd><p>Indicates the socket is closing.</p></dd>
<dt><a name="//apple_ref/c/econst/sflt_event_t/sock_evt_bound"><code>sock_evt_bound</code></a></dt>
<dd><p>Indicates this socket has moved to the
bound state (only for PF_INET/PF_INET6 domain).</p></dd>
</dl>
</blockquote>
<p></p>
<hr>
<!-- headerDoc=tag;  uid=//apple_ref/c/tag/sflt_flags;   name=sflt_flags --><a name="//apple_ref/c/tag/sflt_flags"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="sflt_flags">sflt_flags</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Constants defining mbuf flags. Only the flags listed below
can be set or retrieved.
<!-- end abstract --></p>
<p></p>
<pre><span class="keyword">enum</span> { 
    <a href="../../KPI_Reference/kpi_socketfilter/CompositePage.html#//apple_ref/c/econst/SFLT_GLOBAL" target="_top" class="var"><span class="var">SFLT_GLOBAL</span></a> = <span class="number">0x01</span>, 
    <a href="../../KPI_Reference/kpi_socketfilter/CompositePage.html#//apple_ref/c/econst/SFLT_PROG" target="_top" class="var"><span class="var">SFLT_PROG</span></a> = <span class="number">0x02</span>, 
    <!-- a --><span class="var">SFLT_EXTENDED</span><!-- /a --> = <span class="number">0x04</span> 
};  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Constants</font></h5>
<blockquote>
<dl>
<dt><a name="//apple_ref/c/econst/sflt_flags/SFLT_GLOBAL"><code>SFLT_GLOBAL</code></a></dt>
<dd><p>Indicates this socket filter should be
attached to all new sockets when they're created.</p></dd>
<dt><a name="//apple_ref/c/econst/sflt_flags/SFLT_PROG"><code>SFLT_PROG</code></a></dt>
<dd><p>Indicates this socket filter should be attached
only when request by the application using the SO_NKE socket
option.</p></dd>
<dt><a name="//apple_ref/c/econst/sflt_flags/SFLT_EXTENDED"><code>SFLT_EXTENDED</code></a></dt>
<dd><p>Indicates that this socket filter utilizes
the extended fields within the sflt_filter structure.</p></dd>
</dl>
</blockquote>
<p></p>
<p><!-- start of footer -->

<!-- start of footer --> 
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/KernelIOKitFramework/kpi_socketfilter_h/index.html%3Fid%3DTP30000816-3.4&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/KernelIOKitFramework/kpi_socketfilter_h/index.html%3Fid%3DTP30000816-3.4&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/KernelIOKitFramework/kpi_socketfilter_h/index.html%3Fid%3DTP30000816-3.4&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</p>
<p>&#160;</p>
<!--#include virtual="/footer"-->
<!-- end of footer -->


<!-- end of footer -->
Last Updated: 2008-12-19
</div>
<!-- headerDoc=Header;  uid=//apple_ref/doc/header/kpi_socketfilter.h;   name=kpi_socketfilter.h --><a name="//apple_ref/doc/header/kpi_socketfilter.h"></a>
</body>
</html>
