<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Handling Unicode Text Editing With MLTE: MLTE Concepts</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="MLTE Concepts"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30000087" title="MLTE Concepts"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../TextFonts/index.html#//apple_ref/doc/uid/TP30000440-TP30000435" target="_top">Text &amp; Fonts</a> &gt; <a href="../../../../TextFonts/Carbon-date.html#//apple_ref/doc/uid/TP30000440-TP30000435-TP30000494" target="_top">Carbon</a> &gt; <a href="../mlte_intro/mlte_intro.html#//apple_ref/doc/uid/TP30000086-DontLinkElementID_111">Handling Unicode Text Editing With MLTE</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../mlte_intro/mlte_intro.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../mlte_tasks/mlte_tasks.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_1" title="MLTE Concepts"></a><h1><a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF101" title="MLTE Concepts"></a>MLTE Concepts</h1><p>This chapter provides an overview of Macintosh text handling and how MLTE in particular handles Unicode text editing. If you are new to text handling on the Macintosh, you should read the entire chapter. If you have already worked with international text on the Mac OS and are familiar with text handling, you can skip the first two sections and go to <span class="content_text"><a href="mlte_concepts.html#//apple_ref/doc/uid/TP30000983-TP30000087-BAJIBHED">“How MLTE Handles Text.”</a></span></p><p>This chapter covers concepts rather than implementation or programming details. For information about using MLTE functions in your application, and to see sample code, see <span class="content_text"><a href="../mlte_tasks/mlte_tasks.html#//apple_ref/doc/uid/TP30000983-TP30000088-BCIDHIFH">“MLTE Tasks.”</a></span></p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="mlte_concepts.html#//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF102">Introduction to International Text on the Mac OS</a>
				
			<br/>
			
        
			
			
				<a href="mlte_concepts.html#//apple_ref/doc/uid/TP30000983-TP30000087-BAJFJGFF">Overview of Text Handling</a>
				
			<br/>
			
        
			
			
				<a href="mlte_concepts.html#//apple_ref/doc/uid/TP30000983-TP30000087-BAJIBHED">How MLTE Handles Text</a>
				
			<br/>
			
        
			
			
				<a href="mlte_concepts.html#//apple_ref/doc/uid/TP30000983-TP30000087-BAJHGBAA">Text Objects (TXNObject)</a>
				
			<br/>
			
        
			
			
				<a href="mlte_concepts.html#//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF105">Text Attributes</a>
				
			<br/>
			
        
			
			
				<a href="mlte_concepts.html#//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF106">The MLTE User Interface</a>
				
			<br/>
			
        
			
			
				<a href="mlte_concepts.html#//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF117">Keyboard and Font Synchronization</a>
				
			<br/>
			
        
			
			
				<a href="mlte_concepts.html#//apple_ref/doc/uid/TP30000983-TP30000087-BAJECCAI">Font Substitution</a>
				
			<br/>
			
        
			
			
				<a href="mlte_concepts.html#//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF122">MLTE and Carbon Events</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF102" title="Introduction to International Text on the Mac OS"></a><h2>Introduction to International Text on the Mac OS</h2><p>This section defines the terms used to discuss <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_150"></a>international text handling on the Mac OS. If you would like a more detailed introduction to typography on the Mac OS as well as more information on Unicode and related topics, see <em><a href="../../ATSUI_Concepts/index.html#//apple_ref/doc/uid/TP30000984" target="_top">ATSUI Programming Guide</a></em>.</p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF103" title="Characters, Character Encodings, and Unicode"></a><h3>Characters, Character Encodings, and Unicode</h3><p>A <strong>character</strong> is a symbolic representation of a letter, a number, a punctuation mark, or any other mark used in text; it is the concept of, for example, “lowercase a” or “number 3.”<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_151"></a></p><p>In computer memory, text is stored as <strong>character codes</strong>, where each code is a numeric value that defines a particular character. A <strong>character encoding</strong> is the organization of the set of numeric codes that represent all the meaningful characters of a <strong>script system</strong> in memory. There are two fundamental classes of Mac OS character encodings: single-byte and double-byte.<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_152"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_153"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_154"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_155"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_156"></a></p><p>A <strong>writing system</strong><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_157"></a>is a set of characters and the basic rules for using them to create a visual depiction of language. Examples of writing systems are Roman, Japanese, Arabic, and Hebrew. <strong>Unicode</strong><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_158"></a>is an international standard that combines the characters for all commonly used writing systems into a single, coded character set, based upon a 16-bit character encoding standard. With a universal character encoding such as Unicode, the character sets of separate writing systems do not overlap. Furthermore, Unicode resolves the issue of conflicting character encodings within a single writing system. </p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF104" title="Keyboards and Input Methods"></a><h3>Keyboards and Input Methods</h3><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_159"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_160"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_161"></a><p>The user typically enters text through a keyboard that your application then stores as character codes. The system reports the user’s key-down, key-up, and auto-key events to your application<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_162"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_163"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_164"></a>. <strong>Key-down</strong> and <strong>key-up events</strong> indicate the user pressed or released a key, respectively. <strong>Auto-key events</strong> indicate the user has held a key down for a certain amount of time. For keyboard-related events, your application receives both the virtual key code and the character code for the key that is pressed, as well as the state of any <strong>modifier keys</strong><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_165"></a>(For example, Shift, Caps Lock, Command, Option, and Control) at the time of the event. </p><p>For languages with large character sets, it is impractical to manufacture keyboards with keys for every possible character. In such a case, it is usually the job of an input method, working in conjunction with a keyboard, to handle text input. An <strong>input method</strong> is a software module, often independent of the application it serves, that performs complex processing of text input, prior to the application’s processing of the text. A typical example of an input method is a translation service that converts character codes that can be entered from the keyboard into character codes that cannot; text input in Japanese, Chinese, and Korean usually requires an input method. </p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-BAJFJGFF" title="Overview of Text Handling"></a><h2>Overview of Text Handling</h2><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_166"></a><p>An application with simple text editing capabilities has to do several tasks. First of all, the application must get text input from the user. The application must be prepared to convert character sets in the event a user pastes text from a document created on another platform, the Internet, or from any document that uses a character set different from that of the application’s default <strong>script</strong>.</p><p>As the user enters text, the text must be manipulated and stored. <strong>Text manipulation</strong> refers to system-level procedures used to sort and compare characters, determine line breaks, determine <strong>text directionality</strong>, and keep track of character properties, such as case. Calculating line breaks is a difficult text manipulation task for scripts that do not delineate words with spaces, such as the Thai script. <strong>Display order</strong> is complicated for scripts that are <strong>bidirectional</strong>, such as Hebrew. For example, in Hebrew, words are displayed right-to-left while Roman numerals are displayed left-to-right. </p><p>Characters are stored as codes to facilitate searching and other text manipulation tasks. Before text can be displayed, characters must be rendered. <strong>Character rendering</strong> is the process of properly preparing the characters for display, taking into account <strong>line direction</strong>, contextual rules, and character reordering. For example, the formation of <strong>ligatures</strong> and <strong>diphthongs</strong> occurs during the display of text. </p><p>Once text is displayed, an application needs to provide ways for the user to edit the text. The user may want to change the font, add or delete text, or change <strong>font attributes</strong> such as size, color, and <strong>style</strong>. Users may also want to align text, set tabs, or change other attributes that affect text layout. </p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-BAJIBHED" title="How MLTE Handles Text"></a><h2>How MLTE Handles Text</h2><p>When you use MLTE, your application does not need to contain all the code necessary to handle text. It can rely on MLTE and other Mac OS text technologies to do most of the grunt work for you. This section describes what tasks MLTE and other Mac OS text technologies handle for you, and what tasks your application needs to handle. If all your application needs to do is to display static text in a text box, you can skip this section and go to <span class="content_text"><a href="../mlte_tasks/mlte_tasks.html#//apple_ref/doc/uid/TP30000983-TP30000088-BCIBIGAI">“Displaying Static Text.”</a></span> You need only to use one of two MLTE functions to display static text.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_2" title="Note"></a><p><strong>Note:</strong>&nbsp;If you have ever used <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_167"></a>TextEdit in an application, be prepared to write fewer lines of code when you use MLTE. You’ll see that MLTE handles many tasks that TextEdit did not handle.</p></div><p>MLTE supports standard text input from a keyboard. Once your application creates an MLTE document and associates the document with a window, anything your user types is displayed in the window. Your user may type on any keyboard layout using any script currently supported on the Mac OS. MLTE automatically supports <strong>inline input</strong> for Chinese, Japanese, Korean, other double-byte scripts, and Unicode text. </p><p>When your application calls the MLTE initialization <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_168"></a>function <code><a href="../../../Reference/Multilingual_Text_Engine/Reference/reference.html#//apple_ref/doc/c_ref/TXNInitTextension" target="_top">TXNInitTextension</a></code>, MLTE enables the <strong>Text Services Manager</strong> automatically. The Text Services Manager (TSM) is the part of the Mac OS that provides an environment for applications to use input methods that support text entry for languages such as Chinese, Japanese, and Korean. <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_169"></a></p><p>In Mac OS X, once you initialize MLTE, you do not need to do anything else to assure support for text input. Behind the scenes, MLTE calls TSM functions as needed, and TSM passes text input directly to an active MLTE document. </p><p>By default, MLTE stores text as Unicode. If a user enters text in an encoding other than Unicode, MLTE calls the appropriate <strong>Text Encoding Conversion (TEC) Manager</strong> functions to convert the text to Unicode. You do not need to call the TEC Manager functions directly.<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_170"></a></p><p>MLTE uses <strong>Apple Type Services for Unicode Imaging (ATSUI)</strong><em></em>and QuickDraw Text functions to render and draw text. ATSUI handles complex scripts, supports bidirectional text, and implements a number of other advanced typographical features. <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_171"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_172"></a></p><p>Your application does not need to call any ATSUI functions directly; MLTE does it for you. However, if you want to display and support editing text that uses advanced typographic features, such as ligatures or diphthongs,<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_173"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_174"></a> your application must supply ATSUI information to MLTE functions. For example, if you want MLTE to display text using a specific rare ligature, your application needs to pass an ATSUI constant to specify the ligature. ATSUI constants are defined in the reference documentation for ATSUI. The section <span class="content_text"><a href="../mlte_tasks/mlte_tasks.html#//apple_ref/doc/uid/TP30000983-TP30000088-BCIBIGAI">“Displaying Static Text”</a></span> indicates the functions for which ATSUI constants may be used. </p><p>MLTE has a variety of functions your application can use to make changes that affect an entire MLTE document or to change text attributes. For example, when a user changes the style of a selection, your application must call the appropriate MLTE function to set the style attributes for the selection. </p><p>Your application must provide the appropriate user feedback when the user takes any actions that affect what is displayed in any text-related menus, such as the Edit and Format menus. For example, if the user changes the justification for a selection, you application must call the appropriate Menu Manager function to display a check mark next to the appropriate item in the Format menu that applies to the selection.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_3" title="Note"></a><p><strong>Note:</strong>&nbsp;If you set up MLTE to handle edit-command events, you do not need to update the Edit menu.</p></div><p>There are a number of user actions that MLTE handles automatically for your application, such as highlighting selected text, dragging selected text, and moving the <strong>caret</strong> in response to arrow key presses.<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_175"></a></p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-BAJHGBAA" title="Text Objects (TXNObject)"></a><h2>Text Objects (TXNObject)</h2><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_176"></a><p>MLTE supports onscreen text editing by maintaining information about where the text is stored, where to display it, and the text attributes (style, font, and so forth). This information is contained in an opaque structure called a <code>TXNObject</code>, or <strong>text object</strong>. From the user’s perspective, a text object could take many forms. For example, if your application is a simple text editor, a user views the text object as a document that can be saved, opened, and edited. If your application is a drawing program that uses MLTE for labeling support, the user views a text object as a label or caption associated with a graphic object. If your application is a natural-language query program that uses MLTE for query input, a user views the text object as an <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_177"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_178"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_179"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_180"></a>input window. </p><p>When your application calls the MLTE <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_181"></a>function <code><a href="../../../Reference/Multilingual_Text_Engine/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/TXNNewObject" target="_top">TXNNewObject</a></code> to create a text object, you specify the window in which the text is to be drawn. The window defines the <strong>destination rectangle</strong>—<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_182"></a>the area in which the text is drawn. You also have the option to specify the frame. The <strong>frame</strong> is that portion of the window within which the text is actually displayed. It is sometimes referred to as the <strong>view rectangle</strong>.<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_183"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_184"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_185"></a></p><p><span class="content_text">Figure 2-1</span> shows two sets of frames and destination rectangles. The frames are shaded and defined by dotted lines. The text is drawn in the destination rectangle; the part of it that is displayed is defined by the frame. </p><br/><div><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_4" title="Figure 2-1Frames and destination rectangles"></a><p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-BAJFDEBH" title="Figure 2-1Frames and destination rectangles"></a><strong>Figure 2-1&nbsp;&nbsp;</strong>Frames and destination rectangles</p><img src = "../art/mlte_l001.gif" alt = "Frames and destination rectangles" width="331" height="220"></div><br/><p>A <code>TXNObject</code> is an opaque structure, so your application cannot access it directly and the MLTE reference documentation does not define explicitly the fields in the <code>TXNObject</code>. A <code>TXNObject</code> contains references to the window frame and</p><ul class="ul"><li class="li"><p>the text associated with the text object</p></li><li class="li"><p>the options you want the frame to support, such as scroll bars and a size box</p></li><li class="li"><p>the file type of the text object, such as plain text or RTF, and whether the text can contain graphics, movie, and sound data</p></li><li class="li"><p>the <strong>text encoding</strong> to use; Unicode is the default<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_186"></a></p></li><li class="li"><p>the attributes of the text associated with the text object</p></li><li class="li"><p>information about the layout of the text object</p></li></ul><p>MLTE provides a number of functions that operate on the text object for you, allowing you to get and set attributes of the entire text object or of runs of text associated with the object.</p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF105" title="Text Attributes"></a><h2>Text Attributes</h2><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_187"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_188"></a><p>When the MLTE function <code><a href="../../../Reference/Multilingual_Text_Engine/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/TXNNewObject" target="_top">TXNNewObject</a></code> creates a text object, MLTE creates other structures that maintain information about the styles and attributes of the text associated with a text object. </p><p>MLTE keeps track of character attributes as runs. A <strong>run</strong> is a sequence of characters that are contiguous in memory and share a set of common attributes. </p><p>MLTE has two functions your application can use to get or set text attributes. Attributes are passed to and from these functions in a <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_189"></a>type attributes structure. This structure supports your application’s use of ATSUI font features and font variations, should you want to use them. </p><p>A <strong>font feature</strong><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_190"></a> is the set of typographic and layout characteristics that creates a specific appearance for a glyph. For example, displaying text as small caps is a font feature. A <strong>font variation</strong><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_191"></a>is a range of typestyles along a <strong>variation axis</strong><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_192"></a>. For example, a “width” font variation allows your application to condense or expand a line of displayed text. If you want to get or set such ASTUI font features or variations, your application can pass ATSUI font features or variations information in the type attributes structure. See <span class="content_text"><a href="../mlte_tasks/mlte_tasks.html#//apple_ref/doc/uid/TP30000983-TP30000088-BCIBIBFF">“Accessing and Displaying Advanced Typographical Features”</a></span> for an example of how to get ATSUI font features.</p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF106" title="The MLTE User Interface"></a><h2>The MLTE User Interface</h2><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_193"></a><p>MLTE functions follow Mac OS user interface guidelines, so using these functions ensures the presentation of a consistent user interface in your application. </p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF107" title="Menu Support"></a><h3>Menu Support</h3><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_194"></a><p>Although MLTE does not handle any menu except for the Font menu, it provides applications with all the necessary functionality and information to support the standard text editing menus as specified in <em><a href="../../../../UserExperience/Conceptual/AppleHIGuidelines/index.html#//apple_ref/doc/uid/20000957" target="_top">Apple Human Interface Guidelines</a></em>. MLTE supports the Undo, Redo, Cut, Copy, Paste, Clear, and Select All items in the Edit menu, but does not support Publish and Subscribe.</p><p>MLTE supports <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_195"></a>undo for the Cut, Copy, Paste, and Clear <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_196"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_197"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_198"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_199"></a>commands as well as applying a font, size, or style to a non empty selection. However, applying a font, size, or style to an insertion point cannot be undone. Undo cannot be applied to a <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_200"></a>Select All command because Select All is a selection operation.<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_201"></a></p><p>An uninterrupted sequence of keystrokes, whether done as standard input on a keyboard or as inline input using an input method, is treated as a single typing command for purposes of the Undo command. Events that interrupt a typing sequence include selection operations (except for those handled by input methods), deactivating a window, printing, or any undoable command other than typing. </p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF108" title="Font Menu"></a><h3>Font Menu</h3><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_202"></a><p>Because MLTE supports both QuickDraw Text and ATSUI without requiring your application to know which is being used, MLTE provides utility functions for creating and handling a standard Font menu (where standard is defined as what is most appropriate for the imaging system in use)<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_203"></a>.</p><p>MLTE provides an opaque <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_204"></a>structure called <code>TXNFontMenuObject</code> and the <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_205"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_206"></a>functions <code><a href="../../../Reference/Multilingual_Text_Engine/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/TXNNewFontMenuObject" target="_top">TXNNewFontMenuObject</a></code> and <code><a href="../../../Reference/Multilingual_Text_Engine/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/TXNDoFontMenuSelection" target="_top">TXNDoFontMenuSelection</a></code> that you can use to build a Font menu and handle user interaction with the Font menu. If you prefer to have your application build its own Font menu, you can do so. But if you use the MLTE Font menu functions you’ll have fewer lines of code to write.</p><p>When your application uses MLTE on a system that has <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_207"></a>ATSUI (which is the default), the Font menu automatically includes <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_208"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_209"></a>hierarchical submenus for <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_210"></a>ATSUI fonts that share a family name but have different style names. MLTE draws each Font menu item in a single system font. <span class="content_text"><a href="mlte_concepts.html#//apple_ref/doc/uid/TP30000983-TP30000087-BAJECIBC">Figure 2-2</a></span> shows an MLTE Font menu drawn in Mac OS X using ATSUI.</p><br/><div><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_5" title="Figure 2-2Font menu on a system that uses ATSUI"></a><p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-BAJECIBC" title="Figure 2-2Font menu on a system that uses ATSUI"></a><strong>Figure 2-2&nbsp;&nbsp;</strong>Font menu on a system that uses ATSUI</p><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_211"></a><img src = "../art/hier_menu.gif" alt = "Font menu on a system that uses ATSUI" width="348" height="440"></div><br/><p>An MLTE Font menu on a system that uses only QuickDraw Text looks similar to a menu created by calling the Menu Manager function <code><a href="../../../Reference/Menu_Manager/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/AppendResMenu" target="_top">AppendResMenu</a></code>, as shown in <span class="content_text">Figure 2-3</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_6" title="Figure 2-3A Font menu drawn in Mac OS X using QuickDraw"></a><p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF121" title="Figure 2-3A Font menu drawn in Mac OS X using QuickDraw"></a><strong>Figure 2-3&nbsp;&nbsp;</strong>A Font menu drawn in Mac OS X using QuickDraw</p><img src = "../art/quickdrawmenu.gif" alt = "A Font menu drawn in Mac OS X using QuickDraw" width="367" height="359"></div><br/><a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF123" title="Fonts Window"></a><h3>Fonts Window</h3><p>Prior to Mac OS X version 10.1, the Font menu was the only Font interface available to Carbon applications. With the release of Mac OS X version 10.2, Carbon applications can provide a Fonts window, as shown in <span class="content_text">Figure 2-4</span>. The Fonts window is the preferred user interface for applications that run only in Mac OS X. The columns in the Fonts window improve the viewing and selection of large collections of fonts compared to the hierarchical Font menu shown in <span class="content_text"><a href="mlte_concepts.html#//apple_ref/doc/uid/TP30000983-TP30000087-BAJECIBC">Figure 2-2</a></span>. The columns provide easy access for users to select font, style, and size.</p><br/><div><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_7" title="Figure 2-4The Fonts window"></a><p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-BCIDBJEJ" title="Figure 2-4The Fonts window"></a><strong>Figure 2-4&nbsp;&nbsp;</strong>The Fonts window</p><img src = "../art/fontpanel.gif" alt = "The Fonts window" width="268" height="336"></div><br/><p>MLTE does not handle the Fonts window for you. If you choose to use a Fonts window in your application, your application must perform the following tasks: </p><ul class="spaceabove"><li class="li"><p>show and hide the Fonts window</p></li><li class="li"><p>handle a selection event in the Fonts window</p></li><li class="li"><p>programmatically set a selection in the Fonts window</p></li><li class="li"><p>handle a change of user focus from one document to another</p></li></ul><p>For more information and programming examples on supporting a Fonts window in your application, see <em><a href="../../ATS_Concepts/index.html#//apple_ref/doc/uid/TP30000981" target="_top">Apple Type Services for Fonts Programming Guide</a></em>.</p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF109" title="Document-Wide Formatting "></a><h3>Document-Wide Formatting </h3><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_212"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_213"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_214"></a><p><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_215"></a>Tab settings and text <strong>alignment</strong> are characteristics that apply to an entire text object. </p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF110" title="Tab Settings"></a><h4>Tab Settings</h4><p>MLTE interprets tab characters based on the one-tab-per-document standard found in many simple text editors. Each tab character maps to an initial width. As MLTE flows text onto a line, each tab is replaced by the width value necessary to place the start of the text following the tab at a given position on the line. As the text placed before the tab grows, the white space appears to shrink until the preceding text becomes long enough to envelop the entire tab. At that point, the tab assumes its full width and the text following the tab jumps ahead. <span class="content_text">Figure 2-5</span> illustrates this point.</p><br/><div><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_8" title="Figure 2-5Text entry and tab behavior"></a><p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-BAJFFIAC" title="Figure 2-5Text entry and tab behavior"></a><strong>Figure 2-5&nbsp;&nbsp;</strong>Text entry and tab behavior</p><img src = "../art/mlte_l009.gif" alt = "Text entry and tab behavior" width="418" height="260"></div><br/><p>MLTE flows tab widths in the line direction for the line being formatted. If text is wrapped automatically and a tab width extends past the trailing margin (the right margin on a Roman system), MLTE wraps the line and the next visual line begins with the tab width.</p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF111" title="Text Alignment"></a><h4>Text Alignment</h4><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_216"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_217"></a><p>MLTE allows you to specify the alignment of the lines of text, that is, their horizontal placement with respect to the left and right edges of the <strong>text area</strong> or <strong>destination rectangle</strong>. The different types of alignment that MLTE supports accommodate script systems that are read from right to left as well as those that are read from left to right. MLTE supports the following types of alignment:</p><ul class="spaceabove"><li class="li"><p>Default alignment—MLTE positions text according to the line direction of the <strong>system script</strong>. The alignment can be either left or right. Line direction is the direction in which text in a particular language is written and read. The English language has a left-to-right line direction. Arabic and Hebrew have a primarily right-to-left line direction.<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_218"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_219"></a></p></li><li class="li"><p>Center alignment—MLTE positions text so it is centered between the right and left edges of the destination rectangle.<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_220"></a></p></li><li class="li"><p>Right alignment—MLTE positions text so it is flush with the right edge of the destination rectangle.<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_221"></a></p></li><li class="li"><p>Left alignment—MLTE positions text so it is flush with the left edge of the destination rectangle.<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_222"></a></p></li><li class="li"><p>Full <strong>justification</strong>—MLTE positions text so it is flush against both right and left edges of the destination rectangle.<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_223"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_224"></a></p></li></ul><a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF112" title="Typing and Inline Input"></a><h3>Typing and Inline Input</h3><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_225"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_226"></a><p>MLTE assumes that your application filters out all characters it wants to handle. MLTE uses the following list of rules to process the characters it handles. (Unicode encodings are designated as Uxxx and Mac OS encodings are designated as $xxx, where xxx is replaced by a value.)</p><ul class="spaceabove"><li class="li"><p>Inserting: All <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_227"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_228"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_229"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_230"></a>single-byte and double-byte characters starting at ($20, U0020) except <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_231"></a>Forward Delete ($7F, U007F) are inserted into the text. <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_232"></a>Return ($0D, U000D) and <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_233"></a>the Tab character ($09, U0009) are inserted. Characters entered through inline input are always inserted.<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_234"></a></p></li><li class="li"><p>Selecting: All combinations involving the <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_235"></a>arrow keys ($1C–$1F, U001C–U001F) are interpreted as selection operations (see <span class="content_text"><a href="mlte_concepts.html#//apple_ref/doc/uid/TP30000983-TP30000087-BAJIHAFF">“The Selection Range, the Insertion Point, and Highlighting in MLTE”</a></span>). Other than as specified in <em><a href="../../../../UserExperience/Conceptual/AppleHIGuidelines/index.html#//apple_ref/doc/uid/20000957" target="_top">Apple Human Interface Guidelines</a></em>, they do interrupt typing commands in MLTE.<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_236"></a></p></li><li class="li"><p>Scrolling: <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_237"></a>The <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_238"></a>Home ($01, U0001) and <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_239"></a>End ($04, U0004) characters are interpreted to scroll the text block to its logical beginning or end as specified in <em><a href="../../../../UserExperience/Conceptual/AppleHIGuidelines/index.html#//apple_ref/doc/uid/20000957" target="_top">Apple Human Interface Guidelines</a></em>. </p></li><li class="li"><p>Paging: The <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_240"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_241"></a>Page Up ($0B, U000B) and Page Down ($0C, U000C) characters are interpreted to scroll the text up or down once according to the height of the currently visible portion. They are not part of typing commands, but they also don’t interrupt typing commands<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_242"></a>. </p></li><li class="li"><p>Deleting: The <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_243"></a>Backspace ($08,U0008) and <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_244"></a>Forward Delete ($7F, U007F) characters first delete the currently selected text (if the selection is nonempty), then delete individual characters logically preceding (Backspace) or following (Forward Delete) the insertion point . They are part of typing commands.<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_245"></a></p></li><li class="li"><p>All other characters are ignored. This includes all key combinations involving the <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_246"></a>Command key but not involving the arrow keys. They are not part of typing commands, but do not interrupt the typing commands.</p></li></ul><a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF113" title="Caret Position and Movement"></a><h3>Caret Position and Movement</h3><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_247"></a><p>MLTE uses a caret to mark the position in the displayed text where the next editing operation is to occur. When your application uses MLTE to paste text into a text object, MLTE positions a caret after the pasted text. For <strong>unidirectional text</strong>, <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_248"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_249"></a>when the user presses an arrow key to move the caret left or right across the text, MLTE moves the caret in the direction of the arrow key. If the document contains <strong>embedded objects</strong><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_250"></a>—<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_251"></a>graphics, movie, or <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_252"></a>sound data embedded in text—the caret treats the embedded object as a single character.<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_253"></a></p><p>For <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_254"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_255"></a>bidirectional text, the <strong>caret position</strong> at a direction run boundary depends on the direction of the <strong>keyboard script</strong>; <strong>split carets</strong> are not supported<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_256"></a>. <span class="content_text">Figure 2-6</span> shows a sequence of two Right Arrow key presses and their impact on caret display and movement in a line containing bidirectional text. In this example, the <strong>primary line direction</strong> is right to left. </p><br/><div><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_9" title="Figure 2-6Caret movement across a direction boundary"></a><p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-CJBJEDDF" title="Figure 2-6Caret movement across a direction boundary"></a><strong>Figure 2-6&nbsp;&nbsp;</strong>Caret movement across a direction boundary</p><img src = "../art/mlte_l003.gif" alt = "Caret movement across a direction boundary" width="365" height="330"></div><br/><p>In the first instance of the <strong>text segment</strong>, the caret is positioned within the Arabic text. When the user presses the Right Arrow key once, the insertion point is positioned on a <strong>direction boundary</strong> and the caret jumps to the left side of the Arabic text. When the user presses the Right Arrow key again, MLTE displays the caret at the right side of the left parenthesis in the Roman text. </p><p>For <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_257"></a>read-only documents, you can choose among three behaviors for your application. The first behavior is to display a blinking caret and allow selection and copying of text. The second behavior is not to display a caret or allow text to be selected. This is the model used by SimpleText for read-only documents. The third behavior is to display a non-blinking caret and allow selection and copying of text. </p><p>Horizontal arrow keys move in a direction dependent on the line direction of the text. The arrow key moving in the line direction (right for Roman) starts at the trailing edge of the highlight region in the last line of the selection and simulates successive clicks at each character boundary moving in the line direction until it hits the trailing edge of the visual line. At that point, selection wraps to the leading edge of the next visual line. The <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_258"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_259"></a>character boundaries are determined by the <strong>storage order</strong> and not the <strong>display order</strong>.</p><p>The arrow key moving against the line direction (left for Roman) starts at the leading edge of the highlight region in the first line of the selection and simulates successive clicks at each character boundary moving against the line direction until it hits the leading edge of the visual line, then wraps to the trailing edge of the previous visual line.</p><p>For the horizontal arrow keys, a ligature that does not allow for an insertion point between its constituting characters is treated as one character. Combining the Option key with a horizontal arrow key simulates clicks at word boundaries instead of character boundaries. Combining the Command key with a horizontal arrow key in or against the line direction simulates clicks at the trailing edge or leading edge of the last line or first line intersecting with the selection, respectively.</p><p>When the user presses the Up Arrow key, the caret moves up one line, even in lines of text containing fonts of different sizes. When the caret is positioned on the first line of a <strong>text object</strong>, and the user presses the Up Arrow key, MLTE moves the caret to the beginning of the text on that line. This position corresponds to the visible right end of a line when the primary line direction is right to left and to the left end of the line when the primary line direction is left to right.</p><p>Similarly, when the user presses the Down Arrow key, the caret moves down one line. When the caret is positioned on the last line of a text object, and the user presses the Down Arrow key, MLTE moves the caret to the end of the text on that line. That is, the caret moves to the visible left end of a line when the primary line direction is right to left and to the right end of a line when the primary line direction is left to right.</p><p>Combining the Option key with an Up Arrow or Down Arrow key simulates a click at the corresponding edge of the portion of the view shown in the window, paging the view first if the active selection was already at that edge. The starting point for a selection is determined at the beginning of an uninterrupted sequence of Up Arrow and Down Arrow keys.<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_260"></a></p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-BAJIHAFF" title="The Selection Range, the Insertion Point, and Highlighting in MLTE"></a><h3>The Selection Range, the Insertion Point, and Highlighting in MLTE</h3><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_261"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_262"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_263"></a><p>A user can select a range of text to be edited or your application can set the <strong>selection range</strong> programmatically. A user can define a selection by creating a new one or modifying the current one. A new selection is defined by the Select All command, by mouse actions (single-, double-, or triple-clicking or dragging), or by using the arrow keys along with the Shift key (which could be combined with the Command or Option keys). A selection can be modified by pressing the Shift key and performing a mouse-based or arrow key–based selection action. MLTE interprets user actions to modify a selection according to the <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_264"></a>fixed-point model described in the <em><a href="../../../../UserExperience/Conceptual/AppleHIGuidelines/index.html#//apple_ref/doc/uid/20000957" target="_top">Apple Human Interface Guidelines</a></em>. </p><p>The <strong>anchor point</strong><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_265"></a>is the position in the text at which the user positions the pointer and presses the mouse button. When visual feedback shows the desired range, the user releases the mouse button. The point at which the button is released is called the <strong>active end</strong><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_266"></a>of the range. The user can expand or shrink the active selection by performing a modifying action such as pressing and holding the Shift key while pressing an arrow key. If necessary, the text scrolls to make a selection visible in the view rectangle. See <em><a href="../../../../UserExperience/Conceptual/AppleHIGuidelines/index.html#//apple_ref/doc/uid/20000957" target="_top">Apple Human Interface Guidelines</a></em> for more details, including illustrations, on selection behavior.</p><p><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_267"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_268"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_269"></a>Single-clicking defines an insertion point<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_270"></a>. <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_271"></a>Double-clicking selects a word as defined by the Script Manager or ATSUI. <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_272"></a>Triple-clicking selects a visual line from the beginning of the line to the beginning of the next line. <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_273"></a>Quadruple-clicking selects the paragraph. If the user performs a double, triple, or quadruple click, then drags, the selection grows by words, visual lines, or paragraphs respectively. A click in an empty space is mapped to some location that has text.</p><p>Regardless of how text is selected, the selected text becomes the current selection range. MLTE uses a <strong>byte offset</strong><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_274"></a>to identify the position of a character in the text object, and a text object includes fields that specify the byte offsets of the characters that correspond to the beginning and the end of the current selection range in the displayed text. A graphics, movie, or sound object embedded in a text object is treated as a single character.</p><p>When the byte offset values for the beginning and the end of the selection range are the same, the selection range is an insertion point. MLTE displays an insertion point as a blinking caret in the form of a vertical bar (|). You can turn caret display on or off by setting the appropriate frame option when you create a new text object in MLTE.</p><p>MLTE <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_275"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_276"></a>highlights a selection range. Highlight regions for nonempty selections are drawn in the system highlight color, while carets are drawn in black. MLTE modifies the highlighting as shown in <span class="content_text">Figure 2-7</span> for selected text in an inactive window, as required by the Drag Manager.</p><br/><div><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_10" title="Figure 2-7Highlighted text selection in background window"></a><p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-CJBFCBJG" title="Figure 2-7Highlighted text selection in background window"></a><strong>Figure 2-7&nbsp;&nbsp;</strong>Highlighted text selection in background window</p><img src = "../art/outline_highlighting.gif" alt = "Highlighted text selection in background window" width="383" height="218"></div><br/><p>Because MLTE supports bidirectional text, the selection range can appear as <strong>discontinuously highlighted</strong> as shown in <span class="content_text">Figure 2-8</span>. Displayed text is highlighted according to the <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_277"></a>storage order of the characters. When multiple script systems with different line directions are installed, a continuous sequence of characters in memory may appear as a <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_278"></a>discontinuous selection when displayed.</p><br/><div><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_11" title="Figure 2-8Discontinuous highlighting"></a><p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-CJBBBECJ" title="Figure 2-8Discontinuous highlighting"></a><strong>Figure 2-8&nbsp;&nbsp;</strong>Discontinuous highlighting</p><img src = "../art/mlte_l002.gif" alt = "Discontinuous highlighting" width="319" height="138"></div><br/><a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF114" title="Drag and Drop"></a><h3>Drag and Drop</h3><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_279"></a><p>MLTE provides the drag and drop user experience as specified in the <em><a href="../../../../UserExperience/Conceptual/AppleHIGuidelines/index.html#//apple_ref/doc/uid/20000957" target="_top">Apple Human Interface Guidelines</a></em>. MLTE highlights selections in inactive views, so that users can drag between active and inactive views. If the cursor is over the highlighted region in an active view, the cursor changes to an arrow. MLTE automatically distinguishes between selection operations and drag-and-drop operations, and MLTE provides user feedback. If the mouse-down event occurs within the highlighted region of the current selection and the Drag Manager is available, then MLTE waits to see whether the mouse is dragged. If the mouse is dragged, MLTE initiates a drag–and–drop operation. Otherwise, MLTE interprets the mouse event as a <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_280"></a>selection operation.</p><p>Because MLTE has no contextual information, it cannot provide your application feedback about the destination of the dragged text. However, it highlights the insertion point where dropped text gets inserted, performs the actual move, and selects the dragged text in its new location. By default, MLTE recognizes dragging as a move operation. The user can drag a copy by pressing the Option key. </p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF115" title="Line Breaking"></a><h3>Line Breaking</h3><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_281"></a><p>MLTE renders text into a single rectangular frame. You can choose to have your application create arbitrarily wide lines or break lines at a certain width. If you choose to break lines, MLTE uses ATSUI line-breaking algorithms to control where a line breaks. Text is flowed into a visual line as long as it fits, then a new line is started with the first unbreakable unit (such as a word) that did not fit completely in the line. </p><p>If your application turns off ATSUI (this is not recommended), MLTE uses QuickDraw Text line–breaking algorithms. In this case, in scripts that use space characters to separate words, one (and only one) space character at the logical end of the text flowed into a visual line is consumed by the line break—it is ignored for measurements and not displayed. </p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF116" title="ATSUI Font Features and Variations"></a><h3>ATSUI Font Features and Variations</h3><p>Your application can pass <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_282"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_283"></a>ATSUI features and variations to MLTE functions and have them applied to a selection. This, like building the Font menu, requires your application to be aware that it is running on a system that has ATSUI, and further requires you to use some of the moderately complicated ATSUI functions. </p><p>MLTE does not provide a human interface that allows a user to view and select font variations and features on a per font basis. However, your application can create a user interface that displays font variation and font features. Then you can use MLTE functions to get and set font features and font variations in response to items your user changes in the interface your application creates. See <span class="content_text"><a href="../mlte_tasks/mlte_tasks.html#//apple_ref/doc/uid/TP30000983-TP30000088-BCIBIBFF">“Accessing and Displaying Advanced Typographical Features”</a></span> for information on how your application could provide this capability.</p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF117" title="Keyboard and Font Synchronization"></a><h2>Keyboard and Font Synchronization</h2><p><strong>Keyboard and font synchronization</strong> is a process by which the operating system compares the current keyboard script to the script of the font at the current insertion point. If the two do not match, one or the other is changed so the two scripts are the same.</p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF118" title="Keyboard to Font Synchronization "></a><h3>Keyboard to Font Synchronization </h3><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_284"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_285"></a><p>In a multiscript environment, the operating system should display text in a font that supports the character set in which the text is written. In the <strong>WorldScript</strong><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_286"></a> environment, the operating system typically monitors the current keyboard script and compares it to the script of the font at the current insertion point. If the two scripts do not match and the user starts typing, the operating system automatically replaces the font with one that belongs to the keyboard script.</p><p>This behavior is not always appropriate, as there is not a one-to-one correspondence between fonts and keyboards. Typically, non-Roman keyboard layouts support only the characters that are specific to that script, not the ASCII characters that are supported by all fonts designed for the WorldScript environment.<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_287"></a></p><p>Despite these drawbacks, MLTE by default attempts to synchronize the font to the keyboard when the user changes the keyboard. To find the appropriate font, MLTE first searches backwards in the document for an appropriate font, then forward. If it does not find an appropriate font, the <strong>application font</strong> or the <strong>system font</strong> for the keyboard script is used. Font synchronization does not interrupt typing commands.</p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF119" title="Font to Keyboard Synchronization"></a><h3>Font to Keyboard Synchronization</h3><p>Some text editors also support synchronization in the opposite direction: They automatically switch the keyboard script to the script of the font being used at the current selection. For example, this could happen when the user changes the selection. The assumption is that the user is most likely to type additional text in the script already being used for the current selection. Also, the location of the caret in bidirectional text may depend on the direction of the keyboard script. In this context, it is important that the direction of the keyboard script matches the direction of text in which the user clicks.</p><p>In double-byte scripts, the issue of caret placement does not exist, so input methods often allow users to enter <a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_288"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_289"></a>ASCII characters in a <strong>pass-through mode</strong>. Switching the keyboard is not necessary. Users of single-byte scripts can enter ASCII characters only by switching to a <strong>Roman keyboard script</strong>.<a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_290"></a></p><p>MLTE supports font to keyboard synchronization by default. You can turn off keyboard synchronization by using the <code>kTXNNoKeyboardSyncMask</code><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_291"></a>constant when you set the <code>iFrameOptions</code> parameter in the function <code><a href="../../../Reference/Multilingual_Text_Engine/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/TXNNewObject" target="_top">TXNNewObject</a></code>.</p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF120" title="Overriding Font Synchronization "></a><h3>Overriding Font Synchronization </h3><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_292"></a><p>A user can override the behavior by pressing and holding the Control key while changing the font. In this case, the text changes to the selected font no matter what characters are selected. Each character that is not supported by the new font will be represented by a <strong>missing character glyph</strong><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_293"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_294"></a><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_295"></a>(such as an empty rectangle). To represent missing glyphs with a character that resembles the missing one more closely, you can turn on <span class="content_text"><a href="mlte_concepts.html#//apple_ref/doc/uid/TP30000983-TP30000087-BAJECCAI">“Font Substitution.”</a></span></p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-BAJECCAI" title="Font Substitution"></a><h2>Font Substitution</h2><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_296"></a><p>There may be situations in which MLTE cannot draw a character with the assigned font because the font is not installed on the user's system. If you set font substitution options, MLTE will use the transient font matching function supplied by ATSUI. The transient font matching function scans all valid fonts on the user's system until it finds a suitable substitute font. If you do not set this bit, missing character glyphs are used to represent unavailable characters. </p><p>You can use the font fallback mask <code>kTXNUseFontFallBackMask</code> to set fallback options for static text display. If you want to use font substitution for a text object, you can use the font substitution tag <code>kTXNDoFontSubstitution</code>. See <em><a href="../../../Reference/Multilingual_Text_Engine/index.html#//apple_ref/doc/uid/TP30000069" target="_top">Multilingual Text Engine Reference</a></em>  for more information on these constants.</p><a name="//apple_ref/doc/uid/TP30000983-TP30000087-TPXREF122" title="MLTE and Carbon Events"></a><h2>MLTE and Carbon Events</h2><a name="//apple_ref/doc/uid/TP30000087-DontLinkElementID_297"></a><p>Prior to the release of Mac OS X version 10.1, MLTE used the Apple Event Manager to handle text input. Beginning with Mac OS X version 10.1, MLTE uses the Carbon Event Manager instead. Because MLTE uses Carbon events, you have less code to write, as MLTE handles most Carbon events without your intervention. If you prefer to handle some of the Carbon events MLTE now handles, you can. You can install Carbon event handlers on top of MLTE’s handlers, as long as you are careful to call the Carbon Event Manager function <code><a href="../../../Reference/Carbon_Event_Manager_Ref/Reference/reference.html#//apple_ref/doc/c_ref/CallNextEventHandler" target="_top">CallNextEventHandler</a></code> or return <code>eventNotHandledErr</code> if the event should be passed to MLTE for handling. For further details, see <span class="content_text"><a href="../mlte_tasks/mlte_tasks.html#//apple_ref/doc/uid/TP30000983-TP30000088-BBCDIEBB">“Customizing MLTE Support for Carbon Events.”</a></span></p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../mlte_intro/mlte_intro.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../mlte_tasks/mlte_tasks.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-10-15<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Carbon/Conceptual/HandlingUnicodeText_MLTE/mlte_concepts/mlte_concepts.html%3Fid%3DTP30000983-2.3&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Carbon/Conceptual/HandlingUnicodeText_MLTE/mlte_concepts/mlte_concepts.html%3Fid%3DTP30000983-2.3&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Carbon/Conceptual/HandlingUnicodeText_MLTE/mlte_concepts/mlte_concepts.html%3Fid%3DTP30000983-2.3&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>