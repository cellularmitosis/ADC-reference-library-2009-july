<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note NW19: How the Simple Network Management Protocol (SNMP) Manager Finds Network Cards</title><meta name="keywords" content=""><meta name="Description" content="Technical Note NW19: ">    <meta name="categories" content="Networking"><meta name="week-posted" content="May 31, 1993 - Jun 4, 1993"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF" TEXT="#000000"><a name="//apple_ref/doc/uid/DTS10002561" title="How the Simple Network Management Protocol (SNMP) Manager Finds Network Cards"></a><a name="top"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxNetworking-date.html">Networking</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/Networking/index.html" target="_blank">Reference Library > Networking</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note NW19</div>
<div id="pageheadsub">How the Simple Network Management Protocol (SNMP) Manager Finds Network Cards</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->					<p id="menutext"><a href="#Introduction">Introduction</a><BR><BR><a href="#Section1">Network Management Framework</a><BR><BR><a href="#Section2">Finding the Driver</a><BR><BR><a href="#Conclusion">Conclusion</a><BR><BR>					<a href="#References">References</a><BR><BR><a href="#Downloads">Downloadables</a></p>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">Apple provides an SNMP Manager that implements an architecture for doingnetwork management on a Macintosh computer. This Technote describes how theSNMP manager finds network cards on a Macintosh and explains how you can makethe SNMP Manager recognize new types of network cards. This Technote is asupplement to the information provided in the Developers kit for SNMP availableon the E.T.O. CD-ROM in the <i>MacSNMP Programmer's Guide</i>.. The kit definesthe interfaces to actually gather the information.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[June 01 1993]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR><!-- begin_content --><a name="Introduction"></a><h2>Introduction</h2><p>This Technote assumes that you know something about SNMP and how it works. Italso assumes that you know something about the Macintosh computer's resourcemanager and driver architecture. This note provides information additional tothat provided in the <i>MacSNMP Programmer's Guide</i>. The method that theSNMP Manager uses to find a networking card depends on the slot manager;therefore, machines that do not support the slot manager will not supportSNMP-managed network cards.</p><P><A HREF="#top">Back to top</A></P><a name="Section1"></a><h2>Network Management Framework</h2><p>In the IETF (Internet Engineering Task Force) framework for network managementthere are MIBs (Management Information Bases) for practically every knowndevice, including Ethernet cards, Token Ring cards, FDDI cards, LocalTalk,SMDS, ATM, and others. A MIB describes a mini database that a device mustsupport in order to be network manageable. MIBs consist of groups, each ofwhich contains variables and/or rows of variables (tables). One of the standardgroups in the standard TCP/IP MIB II (RFC 1213) is the interfaces (if) group.The ifGroup contains variables that describe any (and <i>every</i>) networkcard. It defines statistics (identified as variables) such as number of packetssent, number of bytes sent, number of bytes received, and so on. As documentedin the <i>MacSNMP Programmer's Guide</i>, the SNMP Manager makes a driver callto a network card to determine this information. But how does it find thedriver?</p><P><A HREF="#top">Back to top</A></P><a name="Section2"></a><h2>Finding the Driver</h2><p>The SNMP Manager looks through all of the slots (including the pseudo slot fora <code>.ENET0</code> device) using the Slot Manager. It searches for any devicethat has the <code>SpBlock.spCategory</code> set to <code>catNetwork</code> (=4.) Itassumes that this (and <i>only</i> this category) is a network card. It thenlooks in its <code>STR#</code> resource (resource ID = 1) for the driver name,using the <code>SpBlock.spCType</code> as the index. The shipping resource islisted below.</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>resource 'STR#' (1,&quot;Driver Names for cards&quot;){{&quot;.ENET&quot;,&quot;.TOKN&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;.FDDI&quot;</pre>	</TD></TR></TABLE></CENTER><p>Please note that since the <code>spCType</code> of an FDDI card is 17, there are 14blank entries in this resource. When the original (pre-FDDI finalspecifications) code for the SNMP Manager was done, FDDI was going to have an<code>spCType</code> of 3. It is unknown why this changed, but Apple DeveloperTechnical Service has promised to be more compact in the future.</p><p>The reason for this hack is that the driver name for many cards is notcorrectly stored in the <code>SpBlock</code>, while the <code>spCType</code> always is.The SNMP Manager then checks to see if a driver of that name is opened for thatslot. If it is, it can then proceed to make the parameter block basedstatistics calls to gather the information defined in the <code>ifTable</code> in the<code>ifGroup</code>.</p><p>The <code>ifTable</code> in the <code>ifGroup</code> is defined in ASN.1 notation in RFC 1213 as:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>          IfEntry ::=              SEQUENCE {                  ifIndex        INTEGER,            ifDescr        DisplayString,                  ifType        INTEGER,                  ifMtu            INTEGER,                  ifSpeed        Gauge,                  ifPhysAddress    PhysAddress,                  ifAdminStatus    INTEGER,                  ifOperStatus    INTEGER,                  ifLastChange    TimeTicks,                  ifInOctets        Counter,                  ifInUcastPkts    Counter,                  ifInNUcastPkts    Counter,                  ifInDiscards    Counter,                  ifInErrors        Counter,                  ifInUnknownProtos    Counter,                  ifOutOctets        Counter,                  ifOutUcastPkts    Counter,                  ifOutNUcastPkts    Counter,                  ifOutDiscards    Counter,                  ifOutErrors        Counter,                  ifOutQLen        Gauge,                  ifSpecific        OBJECT IDENTIFIER</pre>	</TD></TR></TABLE></CENTER><p>The SNMP Manager controls the index, as this must be the same for various othertables. Additionally, the <code>ifTable</code> requires that we return an object ID thatdescribes the <code>ifSpecific </code>system on the card and an integer describingthe <code>ifType</code>. This tells network management stations where to go to getinformation specific to this type of network card (things like how many times aToken Ring got a bad token or how many times packet length overruns occurred onan Ethernet card). The SNMP Manager finds this <code>object</code><code>identifier</code> by using the <code>SpBlock.spCType</code> as the index intoanother resource of type `ifSP'. It also finds the ifType in this resource;this number is defined in RFC 1213 for several networking systems. Thisresources is defined as:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>/*-------------ifSP * ifSpecific Enumerated Object IDs-----------------*/type 'ifSP' {    integer = $$Countof(OIDEnum);     /* Number of specific Object IDs */    wide array OIDEnum {        unsigned long;            /* ifType, from RFC 1213 */        wide array ObjectID {        /* Object ID for this card type */            unsigned integer = $$Countof(ID);    /* Num of IDs in OID */            wide array ID {                unsigned long;            /* an ID */                            };            };        };</pre>	</TD></TR></TABLE></CENTER><p>And the resource that is shipping with the card looks like the following:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>data 'ifSP' (1, &quot;ifSpecific Enumerated&quot;) {    $&quot;0011&quot;           //Three entries in table    $&quot;0000 0006&quot;   // Enet type    $&quot;0008&quot;           //ENET Object ID    $&quot;0000 0001&quot;    $&quot;0000 0003&quot;    $&quot;0000 0006&quot;    $&quot;0000 0001&quot;    $&quot;0000 0002&quot;    $&quot;0000 0001&quot;    $&quot;0000 000A&quot;    $&quot;0000 0007&quot;    $&quot;0000 0009&quot;   // Token ring type    $&quot;0008&quot;           //Token ring Object ID    $&quot;0000 0001&quot;    $&quot;0000 0003&quot;    $&quot;0000 0006&quot;    $&quot;0000 0001&quot;    $&quot;0000 0002&quot;    $&quot;0000 0001&quot;    $&quot;0000 000A&quot;    $&quot;0000 0009&quot;    $&quot;0000 0000 0000&quot;    // #3  type + oid ID    $&quot;0000 0000 0000&quot;    // #4  type + oid ID    $&quot;0000 0000 0000&quot;    // #5  type + oid ID    $&quot;0000 0000 0000&quot;    // #6  type + oid ID    $&quot;0000 0000 0000&quot;    // #7  type + oid ID    $&quot;0000 0000 0000&quot;    // #8  type + oid ID    $&quot;0000 0000 0000&quot;    // #9  type + oid ID    $&quot;0000 0000 0000&quot;    // #10 type + oid ID    $&quot;0000 0000 0000&quot;    // #11 type + oid ID    $&quot;0000 0000 0000&quot;    // #12 type + oid ID    $&quot;0000 0000 0000&quot;    // #13 type + oid ID    $&quot;0000 0000 0000&quot;    // #14 type + oid ID    $&quot;0000 0000 0000&quot;    // #15 type + oid ID    $&quot;0000 0000 0000&quot;    // #16 type + oid ID    $&quot;0000 000F&quot;   // FDDI Type    $&quot;0008&quot;           //FDDI Object ID    $&quot;0000 0001&quot;    $&quot;0000 0003&quot;    $&quot;0000 0006&quot;    $&quot;0000 0001&quot;    $&quot;0000 0002&quot;    $&quot;0000 0001&quot;    $&quot;0000 000A&quot;    $&quot;0000 000E&quot;</pre>	</TD></TR></TABLE></CENTER><p>Please note again that since the <code>spCType</code> of FDDI is 17, there are 14blank entries in this resource.</p><p>Both of these resources are stored in the SNMP Manager file in the Extensionsfolder. If you are releasing a new type of networking card and want it to benetwork manageable, you must perform the following steps.</p><p>To support the generic ifGroup (minimum support to claim network compatibility)you must:</p><ul type="disc">	<li>implement the driver call described in the <i>MacSNMP Programmer's Guide</i> for network cards; specifically, it must support the following driver selector: 242 (<code>LapGetLinkStatus</code>).</li>	<li>ensure that the STR# resource of ID #1 in the SNMP Manager file in the Extensions folder has the name of your network driver in the correct string (the one that has an index equal to the <code>spCType</code> of your card).</li>	<li>ensure that the `ifSP' resource of ID #1 in the same place has the correct entry for your network card's object ID. This object ID will only be used for display.</li></ul><p>When adding your entry to either of these resources, please don't overwrite theentire resource. Just add your specific entries to the resource. Other cards orfuture release may have already altered the resources beyond what is listedabove and you would not want to erase useful information and cause otherpeople's hardware to fail.</p><p>To support the specific MIB for your network group is a bit more complicated.The shipping SNMP Manager defines a driver interface for Ethernet and TokenRing cards to use to return the network specific statistics. And futureversions of the AppleTalk Connection Product will have Agents that can actuallyreport these values to the SNMP Manager. The Agent will depend upon the correctdriver name from the STR# resource described above. Thus, if you are buildingan Ethernet or Token Ring card you will only have to implement the correctdriver calls as documented in the <i>MacSNMP Programmer's Guide</i> to becomefully network manageable. </p><p>If you are building a third type of card, the problem is more difficult. Firstthe IETF has not defined MIBs for most other types of cards, and second thereis no definition for which selector returns which information from the card'sdriver. As new cards become available Apple may provide Link Layer agents thatcan manage these new cards. Apple Developer Technical Support should benotified if you are building a new card. There are several procedures to definenew card interfaces, and they can recommend the best alternative for your cardtype. </p><P><A HREF="#top">Back to top</A></P><a name="Conclusion"></a><h2>Conclusion</h2><p>Please talk to Apple Developer Technical Support if you are developing a newtype of networking card for the Macintosh.</p><P><A HREF="#top">Back to top</A></P><a name="References"></a><h2>References</h2><P><i>Inside Macintosh</i>, Volume V, Slot manager</p><P><i>Designing Cards and Drivers for the Macintosh Family</i></p><P><i>MacSNMP Programmer's Guide</i></p><P><i>RFC 1157, A Simple Network Management Protocol</i></p><P><i>RFC 1213, Management Information Base for Network Management ofTCP/IP-Based Internets: MIB-II</i></p><P><i>RFC 1155, Structure and Identification of Management Information forTCP/IP- Based Internets</i></p>                                      <P><A HREF="#top">Back to top</A></P><P><A NAME=Downloads></A></P>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (72K)</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/nw_19.pdf">Download</A></P>               </TD>            </TR>                     </TABLE>         <BR>         <P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/nw/nw_19.html%3Fid%3DDTS10002561-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/nw/nw_19.html%3Fid%3DDTS10002561-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/nw/nw_19.html%3Fid%3DDTS10002561-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>