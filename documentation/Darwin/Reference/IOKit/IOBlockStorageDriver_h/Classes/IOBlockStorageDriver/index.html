<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/1998/REC-html40-19980424/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=HTML">
<title>IOBlockStorageDriver</title>
<meta name="generator" content="HeaderDoc">
<style><!--
#tocMenu {
		display: block;
		position:fixed;
		top:0px;
		left:0px;
		width:210px;
		height:100%;
		background:transparent;
}
#bodyText {
		margin-left: 210px;
}
--></style>
<meta id="toc-file" name="toc-file" content="toc.html">
<script language="JavaScript" src="../../../../../../Resources/JavaScript/page.js" type="text/javascript"></script><link rel="stylesheet" type="text/css" href="../../../../../../Resources/CSS/frameset_styles.css">
<style type="text/css"><!--.keyword {background:#ffffff; color:#761550;}.template {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.function {background:#ffffff; color:#000000;}.string {background: #ffffff; color:#891315;}.preprocessor {background:#ffffff; color:#236e25}.comment {background:#ffffff; color:#236e25}.char {background: #ffffff; color:#0000ff;}.var {background:#ffffff; color:#000000;}.type {background:#ffffff; color:#761550;}.param {background:#ffffff; color:#000000;}.graybox {         border-top: 1px solid #919699;         border-left: 1px solid #919699;         margin-bottom: 10px;         }  .graybox th {         padding: 4px 8px 4px 8px;         background: #E2E2E2;         font-size: 12px;         font-weight: bold;         border-bottom: 1px solid #919699;         border-right: 1px solid #919699;         }  .graybox td {         padding: 8px;         font-size: 12px;         text-align: left;         vertical-align: top;         border-bottom: 1px solid #919699;         border-right: 1px solid #919699;         }  --></style>
</head>
<body bgcolor="#ffffff" onload="initialize_page();">
<noscript>
<div id="tocMenu">
<iframe id="toc_content" name="toc_content" src="toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
</div>
</noscript>
<div id="bodyText">
<!-- start of header -->

<!-- start of header -->
<!--#include virtual="/includes/framesetheader"-->
<!-- end of header -->

<table width="600"><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <a href="../../../../../../../reference/HardwareDrivers/index.html#//apple_ref/doc/uid/TP30001281-TP40003576" target="_top">Hardware & Drivers</a> <b>&gt;</b> <a href="../../../index.html#//apple_ref/doc/framework/iokit_fw" target="_top">I/O Kit Framework Reference</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header --><a name="top"></a>
<hr>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h1><a name="IOBlockStorageDriver">IOBlockStorageDriver</a></h1>
</td></tr></table>
<div class="spec_sheet_info_box"><table cellspacing="0" class="specbox">
<tr>
<td scope="row"><b>Inherits from:</b></td>
<td><div style="margin-bottom:1px"><div class="content_text">
<a href="../../../IOStorage_h/Classes/IOStorage/index.html#//apple_ref/cpp/cl/IOStorage" target="_top">IOStorage</a>
</div></div></td>
</tr>
<tr>
<td scope="row"><b>Declared In:</b></td>
<td><div style="margin-bottom:1px"><div class="content_text"><a href="../../index.html" target="_top">IOBlockStorageDriver.h</a></div></div></td>
</tr>
</table></div>
<h2>Overview</h2>
<p><!-- begin abstract --></p>
<p>The common base class for generic block storage drivers.
<!-- end abstract --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The IOBlockStorageDriver class is the common base class for generic block
storage drivers.  It matches and communicates via an IOBlockStorageDevice
interface, and connects to the remainder of the storage framework via the
IOStorage protocol. It extends the IOStorage protocol by implementing the
appropriate open and close semantics, deblocking for unaligned transfers,
polling for ejectable media, locking and ejection policies, media object
creation and tear-down, and statistics gathering and reporting.
</p>
<p>Block storage drivers are split into two parts: the generic driver handles
all generic device issues, independent of the lower-level transport
mechanism (e.g. SCSI, ATA, USB, FireWire). All storage operations
at the generic driver level are translated into a series of generic
device operations. These operations are passed via the IOBlockStorageDevice
nub to a transport driver, which implements the appropriate
transport-dependent protocol to execute these operations.
</p>
<p>To determine the write-protect state of a device (or media), for
example, the generic driver would issue a call to the
Transport Driver's reportWriteProtection method. If this were a SCSI
device, its transport driver would issue a Mode Sense command to
extract the write-protection status bit. The transport driver then
reports true or false to the generic driver.
</p>
<p>The generic driver therefore has no knowledge of, or involvement
with, the actual commands and mechanisms used to communicate with
the device. It is expected that the generic driver will rarely, if
ever, need to be subclassed to handle device idiosyncrasies; rather,
the transport driver should be changed via overrides.
</p>
<p>A generic driver could be subclassed to create a different type of
generic device. The generic driver IOCDBlockStorageDriver class is
a subclass of IOBlockStorageDriver, adding CD functions.
<!-- end discussion -->
</p>
<hr>
<br><h2>Functions</h2>
<a name="HeaderDoc_functions"></a>
<dl>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/acceptNewMedia/IOReturn/()" target="_top">acceptNewMedia</a></tt></dt>
<dd><p>React to new media insertion.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/addToBytesTransferred/void/(UInt64,UInt64,UInt64,bool)" target="_top">addToBytesTransferred</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/allocateContext/Context*/()" target="_top">allocateContext</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/breakUpRequest/void/(UInt64,IOMemoryDescriptor*,IOStorageCompletion,Context*)" target="_top">breakUpRequest</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/checkForMedia/IOReturn/()" target="_top">checkForMedia</a></tt></dt>
<dd><p>Check if media has newly arrived or disappeared.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/constrainByteCount/UInt64/(UInt64,bool)" target="_top">constrainByteCount</a></tt></dt>
<dd><p>Constrain the byte count for this IO to device limits.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/deblockRequest/void/(UInt64,IOMemoryDescriptor*,IOStorageCompletion,Context*)" target="_top">deblockRequest</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/decommissionMedia/IOReturn/(bool)" target="_top">decommissionMedia</a></tt></dt>
<dd><p>Decommission an existing piece of media that has gone away.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/deleteContext/void/(Context*)" target="_top">deleteContext</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/ejectMedia/IOReturn/()" target="_top">ejectMedia</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/executeRequest/void/(UInt64,IOMemoryDescriptor*,IOStorageCompletion,Context*)" target="_top">executeRequest</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/formatMedia/IOReturn/(UInt64)" target="_top">formatMedia</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/getDeviceTypeName/constchar*/()" target="_top">getDeviceTypeName</a></tt></dt>
<dd><p>Return the desired device name.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/getFormatCapacities/UInt32/(UInt64*,UInt32)" target="_top">getFormatCapacities</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/getMediaBlockSize/UInt64/()" target="_top">getMediaBlockSize</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/getMediaState/IOMediaState/()" target="_top">getMediaState</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/getStatistic/UInt64/(Statistics)" target="_top">getStatistic</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/getStatistics/UInt32/(UInt64*,UInt32)" target="_top">getStatistics</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/handleClose/void/(IOService*,IOOptionBits)" target="_top">handleClose</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/handleIsOpen/bool/(constIOService*)" target="_top">handleIsOpen</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/handleOpen/bool/(IOService*,IOOptionBits,void*)" target="_top">handleOpen</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/handleStart/bool/(IOService*)" target="_top">handleStart</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/handleYield/bool/(IOService*,IOOptionBits,void*)" target="_top">handleYield</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/incrementErrors/void/(bool)" target="_top">incrementErrors</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/incrementRetries/void/(bool)" target="_top">incrementRetries</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/initMediaState/void/()" target="_top">initMediaState</a></tt></dt>
<dd><p>Initialize media-related instance variables.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/instantiateDesiredMediaObject/IOMedia*/()" target="_top">instantiateDesiredMediaObject</a></tt></dt>
<dd><p>Create an IOMedia object for media.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/instantiateMediaObject/IOMedia*/(UInt64,UInt64,UInt32,char*)" target="_top">instantiateMediaObject</a></tt></dt>
<dd><p>Create an IOMedia object for media.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/isMediaEjectable/bool/()" target="_top">isMediaEjectable</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/isMediaPollExpensive/bool/()" target="_top">isMediaPollExpensive</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/isMediaPollRequired/bool/()" target="_top">isMediaPollRequired</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/lockMedia/IOReturn/(bool)" target="_top">lockMedia</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/mediaStateHasChanged/IOReturn/(IOMediaState)" target="_top">mediaStateHasChanged</a></tt></dt>
<dd><p>React to a new media insertion or a media removal.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/pollMedia/IOReturn/()" target="_top">pollMedia</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/prepareRequest/void/(UInt64,IOMemoryDescriptor*,IOStorageCompletion)" target="_top">prepareRequest</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/read/void/(IOService*,UInt64,IOMemoryDescriptor*,IOStorageCompletion)" target="_top">read</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/recordMediaParameters/IOReturn/()" target="_top">recordMediaParameters</a></tt></dt>
<dd><p>Obtain media-related parameters on media insertion.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/rejectMedia/void/()" target="_top">rejectMedia</a></tt></dt>
<dd><p>Reject new media.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/synchronizeCache/IOReturn/(IOService*)" target="_top">synchronizeCache</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/validateNewMedia/bool/()" target="_top">validateNewMedia</a></tt></dt>
<dd><p>Verify that new media is acceptable.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBlockStorageDriver/write/void/(IOService*,UInt64,IOMemoryDescriptor*,IOStorageCompletion)" target="_top">write</a></tt></dt>
<dd></dd>
</dl>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/acceptNewMedia/IOReturn/();  indexgroup=Storage ;   name=IOBlockStorageDriver::acceptNewMedia --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/acceptNewMedia/IOReturn/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="acceptNewMedia">acceptNewMedia</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>React to new media insertion.
<!-- end abstract --></p>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">acceptNewMedia</span><!-- /a -->(
    <span class="param">void</span>); </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This method logs the media block size and block count, then calls
instantiateMediaObject to get a media object instantiated. The
media object is then attached above us and registered.
</p>
<p>This method can be overridden to control what happens when new media
is inserted. The default implementation deals with one IOMedia object.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/addToBytesTransferred/void/(UInt64,UInt64,UInt64,bool);  indexgroup=Storage ;   name=IOBlockStorageDriver::addToBytesTransferred --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/addToBytesTransferred/void/(UInt64,UInt64,UInt64,bool)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="addToBytesTransferred">addToBytesTransferred</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">addToBytesTransferred</span><!-- /a -->(
    <!-- a --><span class="type">UInt64</span><!-- /a --> <span class="param">bytesTransferred</span>, 
    <!-- a --><span class="type">UInt64</span><!-- /a --> <span class="param">totalTime</span>, 
    <!-- a --><span class="type">UInt64</span><!-- /a --> <span class="param">latentTime</span>, 
    <!-- a --><span class="type">bool</span><!-- /a --> <span class="param">isWrite</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>bytesTransferred</code></dt>
<dd><p>Number of bytes transferred in this operation.</p></dd>
<dt><code>totalTime</code></dt>
<dd><p>Nanoseconds spent performing this operation.</p></dd>
<dt><code>latentTime</code></dt>
<dd><p>Nanoseconds of latency during this operation.</p></dd>
<dt><code>isWrite</code></dt>
<dd><p>Indicates whether this operation was a write, otherwise is was a read.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Update the total number of bytes transferred, the total transfer time,
and the total latency time -- used for statistics.
</p>
<p>This method's implementation is not typically overridden.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/allocateContext/Context*/();  indexgroup=Storage ;   name=IOBlockStorageDriver::allocateContext --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/allocateContext/Context*/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="allocateContext">allocateContext</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">Context</span><!-- /a --> <span class="type">*</span> <!-- a --><span class="function">allocateContext</span><!-- /a -->(); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Context structure.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Allocate a context structure for a read/write operation.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/breakUpRequest/void/(UInt64,IOMemoryDescriptor*,IOStorageCompletion,Context*);  indexgroup=Storage ;   name=IOBlockStorageDriver::breakUpRequest --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/breakUpRequest/void/(UInt64,IOMemoryDescriptor*,IOStorageCompletion,Context*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="breakUpRequest">breakUpRequest</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">breakUpRequest</span><!-- /a -->(
    <!-- a --><span class="type">UInt64</span><!-- /a --> <span class="param">byteStart</span>, 
    <a href="../../../../KernelIOKitFramework/IOMemoryDescriptor_h/Classes/IOMemoryDescriptor/index.html#//apple_ref/cpp/cl/IOMemoryDescriptor" target="_top" class="type"><span class="type">IOMemoryDescriptor</span></a> <span class="type">*</span><span class="param">buffer</span>, 
    <a href="../../../IOStorage_h/index.html#//apple_ref/c/tag/IOStorageCompletion" target="_top" class="type"><span class="type">IOStorageCompletion</span></a> <span class="param">completion</span>, 
    <!-- a --><span class="type">Context</span><!-- /a --> <span class="type">*</span><span class="param">context</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>byteStart</code></dt>
<dd><p>Starting byte offset for the data transfer.</p></dd>
<dt><code>buffer</code></dt>
<dd><p>Buffer for the data transfer.  The size of the buffer implies the size of
the data transfer.</p></dd>
<dt><code>completion</code></dt>
<dd><p>Completion routine to call once the data transfer is complete.</p></dd>
<dt><code>context</code></dt>
<dd><p>Additional context information for the data transfer (e.g. block size).</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The breakUpRequest method checks to see if the incoming request exceeds
our transfer constraints, and if so, breaks up the request into smaller
sub-requests.
</p>
<p>This method is part of a sequence of methods invoked for each read/write
request.  The first is prepareRequest, which allocates and prepares some
context for the transfer; the second is deblockRequest, which aligns the
transfer at the media's block boundaries; third is breakUpRequest, which
breaks up the transfer into multiple sub-transfers when certain hardware
constraints are exceeded; fourth is executeRequest, which implements the
actual transfer from the block storage device.
</p>
<p>This method's implementation is not typically overridden.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/checkForMedia/IOReturn/();  indexgroup=Storage ;   name=IOBlockStorageDriver::checkForMedia --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/checkForMedia/IOReturn/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="checkForMedia">checkForMedia</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Check if media has newly arrived or disappeared.
<!-- end abstract --></p>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">checkForMedia</span><!-- /a -->(
    <span class="param">void</span>); </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This method does most of the work in polling for media, first
calling the block storage device's reportMediaState method. If
reportMediaState reports no change in the media state, kIOReturnSuccess
is returned. If the media state has indeed changed, a call is made to
mediaStateHasChanged to act on the event.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/constrainByteCount/UInt64/(UInt64,bool);  indexgroup=Storage ;   name=IOBlockStorageDriver::constrainByteCount --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/constrainByteCount/UInt64/(UInt64,bool)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="constrainByteCount">constrainByteCount</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Constrain the byte count for this IO to device limits.
<!-- end abstract --></p>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">UInt64</span><!-- /a --> <!-- a --><span class="function">constrainByteCount</span><!-- /a -->(
    <!-- a --><span class="type">UInt64</span><!-- /a --> <span class="param">requestedCount</span>,
    <!-- a --><span class="type">bool</span><!-- /a --> <span class="param">isWrite</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>requestedCount</code></dt>
<dd><p>The requested byte count for the next read or write operation.</p></dd>
<dt><code>isWrite</code></dt>
<dd><p>True if the operation will be a write; False if the operation will be a read.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This function should be called prior to each read or write operation, so that
the driver can constrain the requested byte count, as necessary, to meet
current device limits. Such limits could be imposed by the device depending
on operating modes, media types, or transport protocol (e.g. ATA, SCSI).
</p>
<p>At present, this method is not used.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/deblockRequest/void/(UInt64,IOMemoryDescriptor*,IOStorageCompletion,Context*);  indexgroup=Storage ;   name=IOBlockStorageDriver::deblockRequest --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/deblockRequest/void/(UInt64,IOMemoryDescriptor*,IOStorageCompletion,Context*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="deblockRequest">deblockRequest</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">deblockRequest</span><!-- /a -->(
    <!-- a --><span class="type">UInt64</span><!-- /a --> <span class="param">byteStart</span>, 
    <a href="../../../../KernelIOKitFramework/IOMemoryDescriptor_h/Classes/IOMemoryDescriptor/index.html#//apple_ref/cpp/cl/IOMemoryDescriptor" target="_top" class="type"><span class="type">IOMemoryDescriptor</span></a> <span class="type">*</span><span class="param">buffer</span>, 
    <a href="../../../IOStorage_h/index.html#//apple_ref/c/tag/IOStorageCompletion" target="_top" class="type"><span class="type">IOStorageCompletion</span></a> <span class="param">completion</span>, 
    <!-- a --><span class="type">Context</span><!-- /a --> <span class="type">*</span><span class="param">context</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>byteStart</code></dt>
<dd><p>Starting byte offset for the data transfer.</p></dd>
<dt><code>buffer</code></dt>
<dd><p>Buffer for the data transfer.  The size of the buffer implies the size of
the data transfer.</p></dd>
<dt><code>completion</code></dt>
<dd><p>Completion routine to call once the data transfer is complete.</p></dd>
<dt><code>context</code></dt>
<dd><p>Additional context information for the data transfer (e.g. block size).</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The deblockRequest method checks to see if the incoming request rests
on the media's block boundaries, and if not, deblocks it.  Deblocking
involves rounding out the request to the nearest block boundaries and
transferring the excess bytes into a scratch buffer.
</p>
<p>This method is part of a sequence of methods invoked for each read/write
request.  The first is prepareRequest, which allocates and prepares some
context for the transfer; the second is deblockRequest, which aligns the
transfer at the media's block boundaries; third is breakUpRequest, which
breaks up the transfer into multiple sub-transfers when certain hardware
constraints are exceeded; fourth is executeRequest, which implements the
actual transfer from the block storage device.
</p>
<p>This method's implementation is not typically overridden.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/decommissionMedia/IOReturn/(bool);  indexgroup=Storage ;   name=IOBlockStorageDriver::decommissionMedia --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/decommissionMedia/IOReturn/(bool)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="decommissionMedia">decommissionMedia</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Decommission an existing piece of media that has gone away.
<!-- end abstract --></p>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">decommissionMedia</span><!-- /a -->(
    <!-- a --><span class="type">bool</span><!-- /a --> <span class="param">forcible</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>forcible</code></dt>
<dd><p>True to force forgetting of the media object even if terminate reports
that there was an active client.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This method wraps a call to terminate, to tear down the stack and
the IOMedia object for the media. If "forcible" is true, the media
object will be forgotten, and initMediaState will be called. A
forcible decommission would occur when an unrecoverable error
happens during tear-down (e.g. perhaps a client is still open), but
we must still forget about the media.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/deleteContext/void/(Context*);  indexgroup=Storage ;   name=IOBlockStorageDriver::deleteContext --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/deleteContext/void/(Context*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="deleteContext">deleteContext</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">deleteContext</span><!-- /a -->(
    <!-- a --><span class="type">Context</span><!-- /a --> <span class="type">*</span><span class="param">context</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>context</code></dt>
<dd><p>Context structure to be deleted.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Delete a context structure from a read/write operation.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/ejectMedia/IOReturn/();  indexgroup=Storage ;   name=IOBlockStorageDriver::ejectMedia --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/ejectMedia/IOReturn/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="ejectMedia">ejectMedia</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">ejectMedia</span><!-- /a -->(); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->An IOReturn code.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Eject the media from the device.  The driver is responsible for tearing
down the media object it created before proceeding with the eject.   If
the tear-down fails, an error should be returned.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/executeRequest/void/(UInt64,IOMemoryDescriptor*,IOStorageCompletion,Context*);  indexgroup=Storage ;   name=IOBlockStorageDriver::executeRequest --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/executeRequest/void/(UInt64,IOMemoryDescriptor*,IOStorageCompletion,Context*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="executeRequest">executeRequest</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">executeRequest</span><!-- /a -->(
    <!-- a --><span class="type">UInt64</span><!-- /a --> <span class="param">byteStart</span>, 
    <a href="../../../../KernelIOKitFramework/IOMemoryDescriptor_h/Classes/IOMemoryDescriptor/index.html#//apple_ref/cpp/cl/IOMemoryDescriptor" target="_top" class="type"><span class="type">IOMemoryDescriptor</span></a> <span class="type">*</span><span class="param">buffer</span>, 
    <a href="../../../IOStorage_h/index.html#//apple_ref/c/tag/IOStorageCompletion" target="_top" class="type"><span class="type">IOStorageCompletion</span></a> <span class="param">completion</span>, 
    <!-- a --><span class="type">Context</span><!-- /a --> <span class="type">*</span><span class="param">context</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>byteStart</code></dt>
<dd><p>Starting byte offset for the data transfer.</p></dd>
<dt><code>buffer</code></dt>
<dd><p>Buffer for the data transfer.  The size of the buffer implies the size of
the data transfer.</p></dd>
<dt><code>completion</code></dt>
<dd><p>Completion routine to call once the data transfer is complete.</p></dd>
<dt><code>context</code></dt>
<dd><p>Additional context information for the data transfer (e.g. block size).</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Execute an asynchronous storage request.  The request is guaranteed to be
block-aligned.
</p>
<p>This method is part of a sequence of methods invoked for each read/write
request.  The first is prepareRequest, which allocates and prepares some
context for the transfer; the second is deblockRequest, which aligns the
transfer at the media's block boundaries; third is breakUpRequest, which
breaks up the transfer into multiple sub-transfers when certain hardware
constraints are exceeded; fourth is executeRequest, which implements the
actual transfer from the block storage device.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/formatMedia/IOReturn/(UInt64);  indexgroup=Storage ;   name=IOBlockStorageDriver::formatMedia --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/formatMedia/IOReturn/(UInt64)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="formatMedia">formatMedia</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">formatMedia</span><!-- /a -->(
    <!-- a --><span class="type">UInt64</span><!-- /a --> <span class="param">byteCapacity</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>byteCapacity</code></dt>
<dd><p>Number of bytes to format media to.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->An IOReturn code.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Format the media with the specified byte capacity.  The driver is
responsible for tearing down the media object and recreating it.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/getDeviceTypeName/constchar*/();  indexgroup=Storage ;   name=IOBlockStorageDriver::getDeviceTypeName --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/getDeviceTypeName/constchar*/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="getDeviceTypeName">getDeviceTypeName</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Return the desired device name.
<!-- end abstract --></p>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <span class="keyword">const</span> <!-- a --><span class="var">char</span><!-- /a --> <span class="var">*</span> <!-- a --><span class="var">getDeviceTypeName</span><!-- /a -->(<!-- a --><span class="var">void</span><!-- /a -->); </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This method returns a string, used to compare the 
kIOBlockStorageDeviceTypeKey of our provider. This method is called from
probe.
</p>
<p>The default implementation of this method returns 
kIOBlockStorageDeviceTypeGeneric.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/getFormatCapacities/UInt32/(UInt64*,UInt32);  indexgroup=Storage ;   name=IOBlockStorageDriver::getFormatCapacities --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/getFormatCapacities/UInt32/(UInt64*,UInt32)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="getFormatCapacities">getFormatCapacities</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">UInt32</span><!-- /a --> <!-- a --><span class="function">getFormatCapacities</span><!-- /a -->(
    <!-- a --><span class="type">UInt64</span><!-- /a --> <span class="type">*</span><span class="param">capacities</span>, 
    <!-- a --><span class="type">UInt32</span><!-- /a --> <span class="param">capacitiesMaxCount</span>) <span class="keyword">const</span>; </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>capacities</code></dt>
<dd><p>Buffer that will receive the UInt64 capacity values.</p></dd>
<dt><code>capacitiesMaxCount</code></dt>
<dd><p>Maximum number of capacity values that can be held in the buffer.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Actual number of capacity values copied to the buffer, or if no buffer
is given, the total number of capacity values available.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Ask the driver to report the feasible formatting capacities for the
inserted media (in bytes).  This routine fills the caller's buffer,
up to the maximum count specified if the real number of capacities
would overflow the buffer.   The return value indicates the actual
number of capacities copied to the buffer.
</p>
<p>If the capacities buffer is not supplied or if the maximum count is
zero, the routine returns the proposed count of capacities instead.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/getMediaBlockSize/UInt64/();  indexgroup=Storage ;   name=IOBlockStorageDriver::getMediaBlockSize --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/getMediaBlockSize/UInt64/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="getMediaBlockSize">getMediaBlockSize</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">UInt64</span><!-- /a --> <!-- a --><span class="function">getMediaBlockSize</span><!-- /a -->() <span class="keyword">const</span>; </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Natural block size, in bytes.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Ask the driver about the media's natural block size.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/getMediaState/IOMediaState/();  indexgroup=Storage ;   name=IOBlockStorageDriver::getMediaState --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/getMediaState/IOMediaState/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="getMediaState">getMediaState</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../index.html#//apple_ref/c/tag/IOMediaState" target="_top" class="type"><span class="type">IOMediaState</span></a> <!-- a --><span class="function">getMediaState</span><!-- /a -->() <span class="keyword">const</span>; </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->An IOMediaState value.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Ask the driver about the media's current state.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/getStatistic/UInt64/(Statistics);  indexgroup=Storage ;   name=IOBlockStorageDriver::getStatistic --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/getStatistic/UInt64/(Statistics)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="getStatistic">getStatistic</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">UInt64</span><!-- /a --> <!-- a --><span class="function">getStatistic</span><!-- /a -->(
    <!-- a --><span class="type">Statistics</span><!-- /a --> <span class="param">statistic</span>) <span class="keyword">const</span>; </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>statistic</code></dt>
<dd><p>Statistic index (an IOBlockStorageDriver::Statistics index).</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Statistic value.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Ask the driver to report one of its operating statistics.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/getStatistics/UInt32/(UInt64*,UInt32);  indexgroup=Storage ;   name=IOBlockStorageDriver::getStatistics --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/getStatistics/UInt32/(UInt64*,UInt32)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="getStatistics">getStatistics</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">UInt32</span><!-- /a --> <!-- a --><span class="function">getStatistics</span><!-- /a -->(
    <!-- a --><span class="type">UInt64</span><!-- /a --> <span class="type">*</span><span class="param">statistics</span>, 
    <!-- a --><span class="type">UInt32</span><!-- /a --> <span class="param">statisticsMaxCount</span>) <span class="keyword">const</span>; </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>statistics</code></dt>
<dd><p>Buffer that will receive the UInt64 statistic values.</p></dd>
<dt><code>statisticsMaxCount</code></dt>
<dd><p>Maximum number of statistic values that can be held in the buffer.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Actual number of statistic values copied to the buffer, or if no buffer
is given, the total number of statistic values available.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Ask the driver to report its operating statistics.
</p>
<p>The statistics are each indexed by IOBlockStorageDriver::Statistics
indices.  This routine fills the caller's buffer, up to the maximum
count specified if the real number of statistics would overflow the
buffer.  The return value indicates the actual number of statistics
copied to the buffer.
</p>
<p>If the statistics buffer is not supplied or if the maximum count is
zero, the routine returns the proposed count of statistics instead.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/handleClose/void/(IOService*,IOOptionBits);  indexgroup=Storage ;   name=IOBlockStorageDriver::handleClose --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/handleClose/void/(IOService*,IOOptionBits)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="handleClose">handleClose</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">handleClose</span><!-- /a -->(
    <a href="../../../../KernelIOKitFramework/IOService_h/Classes/IOService/index.html#//apple_ref/cpp/cl/IOService" target="_top" class="type"><span class="type">IOService</span></a> <span class="type">*</span><span class="param">client</span>,
    <a href="../../../USB_h/index.html#//apple_ref/c/tag/IOOptionBits" target="_top" class="type"><span class="type">IOOptionBits</span></a> <span class="param">options</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>client</code></dt>
<dd><p>Client requesting the close.</p></dd>
<dt><code>options</code></dt>
<dd><p>Options for the close.  Set to zero.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The handleClose method closes the client's access to this object.
</p>
<p>This implementation replaces the IOService definition of handleIsOpen().
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/handleIsOpen/bool/(constIOService*);  indexgroup=Storage ;   name=IOBlockStorageDriver::handleIsOpen --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/handleIsOpen/bool/(constIOService*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="handleIsOpen">handleIsOpen</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="function">handleIsOpen</span><!-- /a -->(
    <span class="keyword">const</span> <!-- a --><span class="var">IOService</span><!-- /a --> <span class="var">*</span> <!-- a --><span class="var">client</span><!-- /a -->) <span class="keyword">const</span>; </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>client</code></dt>
<dd><p>Client to check the open state of.  Set to zero to check the open state
of all clients.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Returns true if the client was (or clients were) open, false otherwise.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The handleIsOpen method determines whether the specified client, or any
client if none is specified, presently has an open on this object.
</p>
<p>This implementation replaces the IOService definition of handleIsOpen().
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/handleOpen/bool/(IOService*,IOOptionBits,void*);  indexgroup=Storage ;   name=IOBlockStorageDriver::handleOpen --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/handleOpen/bool/(IOService*,IOOptionBits,void*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="handleOpen">handleOpen</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="function">handleOpen</span><!-- /a -->(
    <a href="../../../../KernelIOKitFramework/IOService_h/Classes/IOService/index.html#//apple_ref/cpp/cl/IOService" target="_top" class="type"><span class="type">IOService</span></a> <span class="type">*</span><span class="param">client</span>, 
    <a href="../../../USB_h/index.html#//apple_ref/c/tag/IOOptionBits" target="_top" class="type"><span class="type">IOOptionBits</span></a> <span class="param">options</span>, 
    <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">access</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>client</code></dt>
<dd><p>Client requesting the open.</p></dd>
<dt><code>options</code></dt>
<dd><p>Options for the open.  Set to zero.</p></dd>
<dt><code>access</code></dt>
<dd><p>Access level for the open.  Set to kIOStorageAccessReader or
kIOStorageAccessReaderWriter.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Returns true if the open was successful, false otherwise.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The handleOpen method grants or denies permission to access this object
to an interested client.  The argument is an IOStorageAccess value that
specifies the level of access desired -- reader or reader-writer.
</p>
<p>This method can be invoked to upgrade or downgrade the access level for
an existing client as well.  The previous access level will prevail for
upgrades that fail, of course.   A downgrade should never fail.  If the
new access level should be the same as the old for a given client, this
method will do nothing and return success.  In all cases, one, singular
close-per-client is expected for all opens-per-client received.
</p>
<p>This implementation replaces the IOService definition of handleIsOpen().
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/handleStart/bool/(IOService*);  indexgroup=Storage ;   name=IOBlockStorageDriver::handleStart --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/handleStart/bool/(IOService*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="handleStart">handleStart</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">bool</span><!-- /a --> <a href="../../../../KernelIOKitFramework/IOHIDEventService_h/index.html#//apple_ref/c/func/handleStart" target="_top" class="function"><span class="function">handleStart</span></a>(
    <a href="../../../../KernelIOKitFramework/IOService_h/Classes/IOService/index.html#//apple_ref/cpp/cl/IOService" target="_top" class="type"><span class="type">IOService</span></a> <span class="type">*</span><span class="param">provider</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>provider</code></dt>
<dd><p>This object's provider.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Returns true on success, false otherwise.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Prepare the block storage driver for operation.
</p>
<p>This is where a media object needs to be created for fixed media, and
optionally for removable media.
</p>
<p>Note that this method is called from within the start() routine;
if this method returns successfully,  it should be prepared to accept
any of IOBlockStorageDriver's APIs.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/handleYield/bool/(IOService*,IOOptionBits,void*);  indexgroup=Storage ;   name=IOBlockStorageDriver::handleYield --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/handleYield/bool/(IOService*,IOOptionBits,void*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="handleYield">handleYield</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="function">handleYield</span><!-- /a -->(
    <a href="../../../../KernelIOKitFramework/IOService_h/Classes/IOService/index.html#//apple_ref/cpp/cl/IOService" target="_top" class="type"><span class="type">IOService</span></a> <span class="type">*</span><span class="param">provider</span>, 
    <a href="../../../USB_h/index.html#//apple_ref/c/tag/IOOptionBits" target="_top" class="type"><span class="type">IOOptionBits</span></a> <!-- a --><span class="type">options</span><!-- /a --> = <span class="number">0</span>, 
    <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><!-- a --><span class="type">argument</span><!-- /a --> = <span class="number">0</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>provider</code></dt>
<dd><p>This object's provider.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Stop the block storage driver.
</p>
<p>This method is called as a result of a kIOMessageServiceIsRequestingClose
provider message.  The argument is passed in as-is from the message.  The
options are unused.
</p>
<p>This is where the driver should clean up its state in preparation for
removal from the system.
</p>
<p>Note that this method is called from within the yield() routine.
</p>
<p>This method is called with the arbitration lock held.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/incrementErrors/void/(bool);  indexgroup=Storage ;   name=IOBlockStorageDriver::incrementErrors --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/incrementErrors/void/(bool)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="incrementErrors">incrementErrors</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">incrementErrors</span><!-- /a -->(
    <!-- a --><span class="type">bool</span><!-- /a --> <span class="param">isWrite</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>isWrite</code></dt>
<dd><p>Indicates whether this operation was a write, otherwise is was a read.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Update the total error count -- used for statistics.
</p>
<p>This method's implementation is not typically overridden.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/incrementRetries/void/(bool);  indexgroup=Storage ;   name=IOBlockStorageDriver::incrementRetries --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/incrementRetries/void/(bool)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="incrementRetries">incrementRetries</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">incrementRetries</span><!-- /a -->(
    <!-- a --><span class="type">bool</span><!-- /a --> <span class="param">isWrite</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>isWrite</code></dt>
<dd><p>Indicates whether this operation was a write, otherwise is was a read.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Update the total retry count -- used for statistics.
</p>
<p>This method's implementation is not typically overridden.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/initMediaState/void/();  indexgroup=Storage ;   name=IOBlockStorageDriver::initMediaState --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/initMediaState/void/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="initMediaState">initMediaState</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Initialize media-related instance variables.
<!-- end abstract --></p>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">initMediaState</span><!-- /a -->(
    <span class="param">void</span>); </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Called when media is not present, this method marks the device state
as not having media present, not spun up, and write-enabled.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/instantiateDesiredMediaObject/IOMedia*/();  indexgroup=Storage ;   name=IOBlockStorageDriver::instantiateDesiredMediaObject --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/instantiateDesiredMediaObject/IOMedia*/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="instantiateDesiredMediaObject">instantiateDesiredMediaObject</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Create an IOMedia object for media.
<!-- end abstract --></p>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOMedia_h/Classes/IOMedia/index.html#//apple_ref/cpp/cl/IOMedia" target="_top" class="type"><span class="type">IOMedia</span></a> <span class="type">*</span> <!-- a --><span class="function">instantiateDesiredMediaObject</span><!-- /a -->(
    <span class="param">void</span>); </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This method creates the exact type of IOMedia object desired. It is called by
instantiateMediaObject. A subclass may override this one-line method to change
the type of media object actually instantiated.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/instantiateMediaObject/IOMedia*/(UInt64,UInt64,UInt32,char*);  indexgroup=Storage ;   name=IOBlockStorageDriver::instantiateMediaObject --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/instantiateMediaObject/IOMedia*/(UInt64,UInt64,UInt32,char*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="instantiateMediaObject">instantiateMediaObject</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Create an IOMedia object for media.
<!-- end abstract --></p>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOMedia_h/Classes/IOMedia/index.html#//apple_ref/cpp/cl/IOMedia" target="_top" class="type"><span class="type">IOMedia</span></a> <span class="type">*</span> <!-- a --><span class="function">instantiateMediaObject</span><!-- /a -->(
    <!-- a --><span class="type">UInt64</span><!-- /a --> <span class="param">base</span>,
    <!-- a --><span class="type">UInt64</span><!-- /a --> <span class="param">byteSize</span>, 
    <!-- a --><span class="type">UInt32</span><!-- /a --> <span class="param">blockSize</span>,
    <!-- a --><span class="type">char</span><!-- /a --> <span class="type">*</span><span class="param">mediaName</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>base</code></dt>
<dd><p>Byte number of beginning of active data area of the media. Usually zero.</p></dd>
<dt><code>byteSize</code></dt>
<dd><p>Size of the data area of the media, in bytes.</p></dd>
<dt><code>blockSize</code></dt>
<dd><p>Block size of the media, in bytes.</p></dd>
<dt><code>mediaName</code></dt>
<dd><p>Name of the IOMedia object.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->A pointer to the created IOMedia object, or a null on error.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This method creates an IOMedia object from the supplied parameters. It is a
convenience method to wrap the handful of steps to do the job.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/isMediaEjectable/bool/();  indexgroup=Storage ;   name=IOBlockStorageDriver::isMediaEjectable --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/isMediaEjectable/bool/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="isMediaEjectable">isMediaEjectable</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="function">isMediaEjectable</span><!-- /a -->() <span class="keyword">const</span>; </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Returns true if the media is ejectable, false otherwise.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Ask the driver whether the media is ejectable.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/isMediaPollExpensive/bool/();  indexgroup=Storage ;   name=IOBlockStorageDriver::isMediaPollExpensive --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/isMediaPollExpensive/bool/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="isMediaPollExpensive">isMediaPollExpensive</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="function">isMediaPollExpensive</span><!-- /a -->() <span class="keyword">const</span>; </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Returns true if polling the media is expensive, false otherwise.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Ask the driver whether a pollMedia() would be an expensive operation,
that is, one that requires the device to spin up or delay for a while.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/isMediaPollRequired/bool/();  indexgroup=Storage ;   name=IOBlockStorageDriver::isMediaPollRequired --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/isMediaPollRequired/bool/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="isMediaPollRequired">isMediaPollRequired</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="function">isMediaPollRequired</span><!-- /a -->() <span class="keyword">const</span>; </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Returns true if polling the media is required, false otherwise.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Ask the driver whether the block storage device requires polling,  which is
typically required for devices without the ability to asynchronously detect
the arrival or departure of the media.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/lockMedia/IOReturn/(bool);  indexgroup=Storage ;   name=IOBlockStorageDriver::lockMedia --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/lockMedia/IOReturn/(bool)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="lockMedia">lockMedia</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">lockMedia</span><!-- /a -->(
    <!-- a --><span class="type">bool</span><!-- /a --> <span class="param">lock</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>lock</code></dt>
<dd><p>Pass true to lock the media, otherwise pass false to unlock the media.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->An IOReturn code.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Lock or unlock the ejectable media in the device, that is, prevent
it from manual ejection or allow its manual ejection.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/mediaStateHasChanged/IOReturn/(IOMediaState);  indexgroup=Storage ;   name=IOBlockStorageDriver::mediaStateHasChanged --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/mediaStateHasChanged/IOReturn/(IOMediaState)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="mediaStateHasChanged">mediaStateHasChanged</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>React to a new media insertion or a media removal.
<!-- end abstract --></p>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">mediaStateHasChanged</span><!-- /a -->(
    <a href="../../index.html#//apple_ref/c/tag/IOMediaState" target="_top" class="type"><span class="type">IOMediaState</span></a> <span class="param">state</span>); </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This method is called on a media state change, that is, an arrival
or removal. If media has just become available, calls are made to
recordMediaParameters and acceptNewMedia. If media has just gone
away, a call is made to decommissionMedia, with the forcible
parameter set to true. The forcible tear-down is needed to enforce
the disappearance of media, regardless of interested clients.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/pollMedia/IOReturn/();  indexgroup=Storage ;   name=IOBlockStorageDriver::pollMedia --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/pollMedia/IOReturn/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="pollMedia">pollMedia</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">pollMedia</span><!-- /a -->(); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->An IOReturn code.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Poll for the presence of media in the device.  The driver is responsible
for tearing down the media object it created should the media have been
removed since the last poll, and vice-versa, creating the media object
should new media have arrived since the last poll.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/prepareRequest/void/(UInt64,IOMemoryDescriptor*,IOStorageCompletion);  indexgroup=Storage ;   name=IOBlockStorageDriver::prepareRequest --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/prepareRequest/void/(UInt64,IOMemoryDescriptor*,IOStorageCompletion)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="prepareRequest">prepareRequest</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">prepareRequest</span><!-- /a -->(
    <!-- a --><span class="type">UInt64</span><!-- /a --> <span class="param">byteStart</span>, 
    <a href="../../../../KernelIOKitFramework/IOMemoryDescriptor_h/Classes/IOMemoryDescriptor/index.html#//apple_ref/cpp/cl/IOMemoryDescriptor" target="_top" class="type"><span class="type">IOMemoryDescriptor</span></a> <span class="type">*</span><span class="param">buffer</span>, 
    <a href="../../../IOStorage_h/index.html#//apple_ref/c/tag/IOStorageCompletion" target="_top" class="type"><span class="type">IOStorageCompletion</span></a> <span class="param">completion</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>byteStart</code></dt>
<dd><p>Starting byte offset for the data transfer.</p></dd>
<dt><code>buffer</code></dt>
<dd><p>Buffer for the data transfer.  The size of the buffer implies the size of
the data transfer.</p></dd>
<dt><code>completion</code></dt>
<dd><p>Completion routine to call once the data transfer is complete.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The prepareRequest method allocates and prepares state for the transfer.
</p>
<p>This method is part of a sequence of methods invoked for each read/write
request.  The first is prepareRequest, which allocates and prepares some
context for the transfer; the second is deblockRequest, which aligns the
transfer at the media's block boundaries; third is breakUpRequest, which
breaks up the transfer into multiple sub-transfers when certain hardware
constraints are exceeded; fourth is executeRequest, which implements the
actual transfer from the block storage device.
</p>
<p>This method's implementation is not typically overridden.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/read/void/(IOService*,UInt64,IOMemoryDescriptor*,IOStorageCompletion);  indexgroup=Storage ;   name=IOBlockStorageDriver::read --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/read/void/(IOService*,UInt64,IOMemoryDescriptor*,IOStorageCompletion)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="read">read</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">read</span><!-- /a -->(
    <a href="../../../../KernelIOKitFramework/IOService_h/Classes/IOService/index.html#//apple_ref/cpp/cl/IOService" target="_top" class="type"><span class="type">IOService</span></a> <span class="type">*</span><span class="param">client</span>, 
    <!-- a --><span class="type">UInt64</span><!-- /a --> <span class="param">byteStart</span>, 
    <a href="../../../../KernelIOKitFramework/IOMemoryDescriptor_h/Classes/IOMemoryDescriptor/index.html#//apple_ref/cpp/cl/IOMemoryDescriptor" target="_top" class="type"><span class="type">IOMemoryDescriptor</span></a> <span class="type">*</span><span class="param">buffer</span>, 
    <a href="../../../IOStorage_h/index.html#//apple_ref/c/tag/IOStorageCompletion" target="_top" class="type"><span class="type">IOStorageCompletion</span></a> <span class="param">completion</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>client</code></dt>
<dd><p>Client requesting the read.</p></dd>
<dt><code>byteStart</code></dt>
<dd><p>Starting byte offset for the data transfer.</p></dd>
<dt><code>buffer</code></dt>
<dd><p>Buffer for the data transfer.  The size of the buffer implies the size of
the data transfer.</p></dd>
<dt><code>completion</code></dt>
<dd><p>Completion routine to call once the data transfer is complete.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The read method is the receiving end for all read requests from the
storage framework (through the media object created by this driver).
</p>
<p>This method initiates a sequence of methods (stages) for each read/write
request.  The first is prepareRequest, which allocates and prepares some
context for the transfer; the second is deblockRequest, which aligns the
transfer at the media's block boundaries; third is breakUpRequest, which
breaks up the transfer into multiple sub-transfers when certain hardware
constraints are exceeded; fourth is executeRequest, which implements the
actual transfer from the block storage device.
</p>
<p>This method's implementation is not typically overridden.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/recordMediaParameters/IOReturn/();  indexgroup=Storage ;   name=IOBlockStorageDriver::recordMediaParameters --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/recordMediaParameters/IOReturn/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="recordMediaParameters">recordMediaParameters</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Obtain media-related parameters on media insertion.
<!-- end abstract --></p>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">recordMediaParameters</span><!-- /a -->(
    <span class="param">void</span>); </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This method obtains media-related parameters via calls to the
Transport Driver's reportBlockSize, reportMaxValidBlock,
reportMaxReadTransfer, reportMaxWriteTransfer, and reportWriteProtection
methods.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/rejectMedia/void/();  indexgroup=Storage ;   name=IOBlockStorageDriver::rejectMedia --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/rejectMedia/void/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="rejectMedia">rejectMedia</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Reject new media.
<!-- end abstract --></p>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">rejectMedia</span><!-- /a -->(
    <span class="param">void</span>); </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This method will be called if validateNewMedia returns False (thus rejecting
the new media. A vendor may choose to override this method to control behavior
when media is rejected.
</p>
<p>The default implementation simply calls ejectMedia.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/synchronizeCache/IOReturn/(IOService*);  indexgroup=Storage ;   name=IOBlockStorageDriver::synchronizeCache --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/synchronizeCache/IOReturn/(IOService*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="synchronizeCache">synchronizeCache</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">synchronizeCache</span><!-- /a -->(
    <a href="../../../../KernelIOKitFramework/IOService_h/Classes/IOService/index.html#//apple_ref/cpp/cl/IOService" target="_top" class="type"><span class="type">IOService</span></a> <span class="type">*</span><span class="param">client</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>client</code></dt>
<dd><p>Client requesting the cache synchronization.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Returns the status of the cache synchronization.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Flush the cached data in the storage object, if any, synchronously.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/validateNewMedia/bool/();  indexgroup=Storage ;   name=IOBlockStorageDriver::validateNewMedia --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/validateNewMedia/bool/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="validateNewMedia">validateNewMedia</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Verify that new media is acceptable.
<!-- end abstract --></p>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="function">validateNewMedia</span><!-- /a -->(
    <span class="param">void</span>); </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This method will be called whenever new media is detected. Return true to accept
the media, or false to reject it (and call rejectMedia). Vendors might override
this method to handle password-protection for new media.
</p>
<p>The default implementation always returns True, indicating media is accepted.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBlockStorageDriver/write/void/(IOService*,UInt64,IOMemoryDescriptor*,IOStorageCompletion);  indexgroup=Storage ;   name=IOBlockStorageDriver::write --><a name="//apple_ref/cpp/instm/IOBlockStorageDriver/write/void/(IOService*,UInt64,IOMemoryDescriptor*,IOStorageCompletion)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="write">write</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">write</span><!-- /a -->(
    <a href="../../../../KernelIOKitFramework/IOService_h/Classes/IOService/index.html#//apple_ref/cpp/cl/IOService" target="_top" class="type"><span class="type">IOService</span></a> <span class="type">*</span><span class="param">client</span>, 
    <!-- a --><span class="type">UInt64</span><!-- /a --> <span class="param">byteStart</span>, 
    <a href="../../../../KernelIOKitFramework/IOMemoryDescriptor_h/Classes/IOMemoryDescriptor/index.html#//apple_ref/cpp/cl/IOMemoryDescriptor" target="_top" class="type"><span class="type">IOMemoryDescriptor</span></a> <span class="type">*</span><span class="param">buffer</span>, 
    <a href="../../../IOStorage_h/index.html#//apple_ref/c/tag/IOStorageCompletion" target="_top" class="type"><span class="type">IOStorageCompletion</span></a> <span class="param">completion</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>client</code></dt>
<dd><p>Client requesting the write.</p></dd>
<dt><code>byteStart</code></dt>
<dd><p>Starting byte offset for the data transfer.</p></dd>
<dt><code>buffer</code></dt>
<dd><p>Buffer for the data transfer.  The size of the buffer implies the size of
the data transfer.</p></dd>
<dt><code>completion</code></dt>
<dd><p>Completion routine to call once the data transfer is complete.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The write method is the receiving end for all write requests from the
storage framework (through the media object created by this driver).
</p>
<p>This method initiates a sequence of methods (stages) for each read/write
request.  The first is prepareRequest, which allocates and prepares some
context for the transfer; the second is deblockRequest, which aligns the
transfer at the media's block boundaries; third is breakUpRequest, which
breaks up the transfer into multiple sub-transfers when certain hardware
constraints are exceeded; fourth is executeRequest, which implements the
actual transfer from the block storage device.
</p>
<p>This method's implementation is not typically overridden.
<!-- end discussion -->
</p>
<p></p>
<h2>Member Data</h2>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOBlockStorageDriver/_ejectable;  indexgroup=Storage ;   name=IOBlockStorageDriver::_ejectable --><a name="//apple_ref/cpp/data/IOBlockStorageDriver/_ejectable"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="_ejectable">_ejectable</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="var">_ejectable</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>True if the media is ejectable under software control.<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOBlockStorageDriver/_lockable;  indexgroup=Storage ;   name=IOBlockStorageDriver::_lockable --><a name="//apple_ref/cpp/data/IOBlockStorageDriver/_lockable"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="_lockable">_lockable</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="var">_lockable</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>True if the media can be locked in the device under software control.<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOBlockStorageDriver/_maxBlockNumber;  indexgroup=Storage ;   name=IOBlockStorageDriver::_maxBlockNumber --><a name="//apple_ref/cpp/data/IOBlockStorageDriver/_maxBlockNumber"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="_maxBlockNumber">_maxBlockNumber</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><!-- a --><span class="type">UInt64</span><!-- /a --> <!-- a --><span class="var">_maxBlockNumber</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The maximum allowable block number for the media, zero-based.<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOBlockStorageDriver/_maxReadByteTransfer;  indexgroup=Storage ;   name=IOBlockStorageDriver::_maxReadByteTransfer --><a name="//apple_ref/cpp/data/IOBlockStorageDriver/_maxReadByteTransfer"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="_maxReadByteTransfer">_maxReadByteTransfer</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><!-- a --><span class="type">UInt64</span><!-- /a --> <!-- a --><span class="var">_maxReadByteTransfer</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The maximum byte transfer allowed for read operations.<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOBlockStorageDriver/_maxWriteByteTransfer;  indexgroup=Storage ;   name=IOBlockStorageDriver::_maxWriteByteTransfer --><a name="//apple_ref/cpp/data/IOBlockStorageDriver/_maxWriteByteTransfer"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="_maxWriteByteTransfer">_maxWriteByteTransfer</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><!-- a --><span class="type">UInt64</span><!-- /a --> <!-- a --><span class="var">_maxWriteByteTransfer</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The maximum byte transfer allowed for write operations.<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOBlockStorageDriver/_mediaBlockSize;  indexgroup=Storage ;   name=IOBlockStorageDriver::_mediaBlockSize --><a name="//apple_ref/cpp/data/IOBlockStorageDriver/_mediaBlockSize"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="_mediaBlockSize">_mediaBlockSize</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><!-- a --><span class="type">UInt64</span><!-- /a --> <!-- a --><span class="var">_mediaBlockSize</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The block size of the media, in bytes.<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOBlockStorageDriver/_mediaObject;  indexgroup=Storage ;   name=IOBlockStorageDriver::_mediaObject --><a name="//apple_ref/cpp/data/IOBlockStorageDriver/_mediaObject"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="_mediaObject">_mediaObject</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><a href="../../../IOMedia_h/Classes/IOMedia/index.html#//apple_ref/cpp/cl/IOMedia" target="_top" class="type"><span class="type">IOMedia</span></a> <span class="type">*</span> <!-- a --><span class="var">_mediaObject</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>A pointer to the media object we have instantiated (if any).<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOBlockStorageDriver/_mediaPresent;  indexgroup=Storage ;   name=IOBlockStorageDriver::_mediaPresent --><a name="//apple_ref/cpp/data/IOBlockStorageDriver/_mediaPresent"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="_mediaPresent">_mediaPresent</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="var">_mediaPresent</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>True if media is present in the device; False if not.<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOBlockStorageDriver/_mediaStateLock;  indexgroup=Storage ;   name=IOBlockStorageDriver::_mediaStateLock --><a name="//apple_ref/cpp/data/IOBlockStorageDriver/_mediaStateLock"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="_mediaStateLock">_mediaStateLock</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>private</tt>
<br><!-- a --><span class="type">IOLock</span><!-- /a --> <span class="type">*</span> <!-- a --><span class="var">_mediaStateLock</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>A lock used to protect during media checks.<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOBlockStorageDriver/_mediaType;  indexgroup=Storage ;   name=IOBlockStorageDriver::_mediaType --><a name="//apple_ref/cpp/data/IOBlockStorageDriver/_mediaType"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="_mediaType">_mediaType</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><!-- a --><span class="type">UInt32</span><!-- /a --> <!-- a --><span class="var">_mediaType</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Type of the media (can be used to differentiate between the
different types of CD media, DVD media, etc).<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOBlockStorageDriver/_pollIsExpensive;  indexgroup=Storage ;   name=IOBlockStorageDriver::_pollIsExpensive --><a name="//apple_ref/cpp/data/IOBlockStorageDriver/_pollIsExpensive"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="_pollIsExpensive">_pollIsExpensive</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="var">_pollIsExpensive</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>True if polling is expensive; False if not.<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOBlockStorageDriver/_pollIsRequired;  indexgroup=Storage ;   name=IOBlockStorageDriver::_pollIsRequired --><a name="//apple_ref/cpp/data/IOBlockStorageDriver/_pollIsRequired"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="_pollIsRequired">_pollIsRequired</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="var">_pollIsRequired</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>True if we must poll to detect media insertion or removal.<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOBlockStorageDriver/_removable;  indexgroup=Storage ;   name=IOBlockStorageDriver::_removable --><a name="//apple_ref/cpp/data/IOBlockStorageDriver/_removable"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="_removable">_removable</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="var">_removable</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>True if the media is removable; False if it is fixed (not removable).<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOBlockStorageDriver/_writeProtected;  indexgroup=Storage ;   name=IOBlockStorageDriver::_writeProtected --><a name="//apple_ref/cpp/data/IOBlockStorageDriver/_writeProtected"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="_writeProtected">_writeProtected</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="var">_writeProtected</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>True if the media is write-protected; False if not.<!-- end discussion -->
</p>
<p></p>
<h2>Enumerations</h2>
<hr>
<!-- headerDoc=tag;  uid=//apple_ref/cpp/tag/IOBlockStorageDriver/Statistics;  indexgroup=Storage ;   name=IOBlockStorageDriver::Statistics --><a name="//apple_ref/cpp/tag/IOBlockStorageDriver/Statistics"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="Statistics">Statistics</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Indices for the different statistics that getStatistics() can report.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">enum</span> <!-- a --><span class="type">Statistics</span><!-- /a --> { 
    <!-- a --><span class="var">kStatisticsReads</span><!-- /a -->, 
    <!-- a --><span class="var">kStatisticsBytesRead</span><!-- /a -->, 
    <!-- a --><span class="var">kStatisticsTotalReadTime</span><!-- /a -->, 
    <!-- a --><span class="var">kStatisticsLatentReadTime</span><!-- /a -->, 
    <!-- a --><span class="var">kStatisticsReadRetries</span><!-- /a -->, 
    <!-- a --><span class="var">kStatisticsReadErrors</span><!-- /a -->,  
    <!-- a --><span class="var">kStatisticsWrites</span><!-- /a -->, 
    <!-- a --><span class="var">kStatisticsSingleBlockWrites</span><!-- /a -->, 
    <!-- a --><span class="var">kStatisticsBytesWritten</span><!-- /a -->, 
    <!-- a --><span class="var">kStatisticsTotalWriteTime</span><!-- /a -->, 
    <!-- a --><span class="var">kStatisticsLatentWriteTime</span><!-- /a -->, 
    <!-- a --><span class="var">kStatisticsWriteRetries</span><!-- /a -->, 
    <!-- a --><span class="var">kStatisticsWriteErrors</span><!-- /a --> 
}; </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Constants</font></h5>
<blockquote>
<dl>
<dt><code>kStatisticsReads</code></dt>
<dd><p>Number of read operations thus far.</p></dd>
<dt><code>kStatisticsBytesRead</code></dt>
<dd><p>Number of bytes read thus far.</p></dd>
<dt><code>kStatisticsTotalReadTime</code></dt>
<dd><p>Nanoseconds spent performing reads thus far.</p></dd>
<dt><code>kStatisticsLatentReadTime</code></dt>
<dd><p>Nanoseconds of latency during reads thus far.</p></dd>
<dt><code>kStatisticsReadRetries</code></dt>
<dd><p>Number of read retries thus far.</p></dd>
<dt><code>kStatisticsReadErrors</code></dt>
<dd><p>Number of read errors thus far.</p></dd>
<dt><code>kStatisticsWrites</code></dt>
<dd><p>Number of write operations thus far.</p></dd>
<dt><code>kStatisticsSingleBlockWrites</code></dt>
<dd><p>Number of write operations for a single block thus far.</p></dd>
<dt><code>kStatisticsBytesWritten</code></dt>
<dd><p>Number of bytes written thus far.</p></dd>
<dt><code>kStatisticsTotalWriteTime</code></dt>
<dd><p>Nanoseconds spent performing writes thus far.</p></dd>
<dt><code>kStatisticsLatentWriteTime</code></dt>
<dd><p>Nanoseconds of latency during writes thus far.</p></dd>
<dt><code>kStatisticsWriteRetries</code></dt>
<dd><p>Number of write retries thus far.</p></dd>
<dt><code>kStatisticsWriteErrors</code></dt>
<dd><p>Number of write errors thus far.</p></dd>
</dl>
</blockquote>
<p></p>
<p><!-- start of footer -->

<!-- start of footer --> 
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/IOKit/IOBlockStorageDriver_h/Classes/IOBlockStorageDriver/index.html%3Fid%3DTP30000815-5.4&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/IOKit/IOBlockStorageDriver_h/Classes/IOBlockStorageDriver/index.html%3Fid%3DTP30000815-5.4&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/IOKit/IOBlockStorageDriver_h/Classes/IOBlockStorageDriver/index.html%3Fid%3DTP30000815-5.4&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</p>
<p>&nbsp;</p>
<!--#include virtual="/footer"-->
<!-- end of footer -->


<!-- end of footer -->
Last Updated: 2009-02-23
</div>
<!-- headerDoc=cl; uid=//apple_ref/cpp/cl/IOBlockStorageDriver; indexgroup=Storage ; name=IOBlockStorageDriver--><a name="//apple_ref/cpp/cl/IOBlockStorageDriver"></a>
</body>
</html>
