<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Document-Based Applications Overview: Frequently Asked Questions</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Frequently Asked Questions"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20000954" title="Frequently Asked Questions"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../DesignGuidelines-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000556" target="_top">Design Guidelines</a> &gt; <a href="../index.html" target="_top">Document-Based Applications Overview</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../Articles/ErrorHandling.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/20000954-BAJDAFAB" title="Frequently Asked Questions"></a><hr /><H1>Frequently Asked Questions</H1><p>This article answers commonly asked questions about the document-handling classes in the Application Kit. This includes the <code>NSDocument</code> class as well as <code>NSDocumentController</code> and <code>NSWindowController</code>.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1080678">How do I start?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1080758-BAJJDDBI">How do I define types?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1080829-BAJBFGAG">How do I implement saving and loading for simple files?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1081069-BAJHBHGJ">How do I implement document packages?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1081125-BAJIGEFI">How do I implement loading and saving when the simple data or file wrapper API won’t do?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1080900">Should I subclass NSWindowController?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1080949-BAJECHFD">How do I subclass NSWindowController?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1081016">When can I do setup operations on my user interface objects?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1081200-BAJEDDHB">How can I support read-only types?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1081225">How can I support write-only types?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1081265-BAJFDEGD">How can I support reading one type and automatically converting (internally) to another?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1081321">How can I customize the Save panel?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1081373">How do I implement printing?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1081403">Should I do anything about print info?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1081429-BAJIEACC">How can I make an NSWindowController subclass that automatically uses a particular nib file?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1081485">How can I use NSWindowController for shared panels (inspectors, find panels, etc.)?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1081525">How can I use multiple NSWindowControllers for a single document?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1081566">How can I customize the window title for a document’s NSWindowController?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1081593">How do I implement undo?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1081668">How do I implement partial undo?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1081692-BAJFAHHE">What if I don't want to support undo?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1081728">What's all this change count stuff?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1081791">Should I subclass NSDocumentController?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1081810">How can I subclass NSDocumentController?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-1081850">How can I create new documents other than through user-action methods?</a>
				
			<br/>
			
        
			
			
				<a href="FAQ.html#//apple_ref/doc/uid/20000954-DontLinkElementID_14">How can I keep my application from creating an untitled document at launch?</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/20000954-1080678" title="How do I start?"></a><h2>How do I start?</h2><p><a name="//apple_ref/doc/uid/20000954-DontLinkElementID_84"></a>To get started writing an <code>NSDocument</code>-based application, use the Cocoa Document-based Application project template when creating a new Xcode project. When you do this, you get a new application project that already contains a subclass of <code>NSDocument</code> and a document nib file.</p><p>The <code>NSDocument</code> subclass is pre-set to load the document nib file. Empty methods are provided for loading and saving; comments explain what you need to fill in. A method is also provided for you to add code that is called after the document nib file is loaded.</p><p>Without writing any additional code, you should be able to compile and run the application. You will see an untitled document with an empty window created when you first launch the application, and the File menu commands all do something reasonable, such as bringing up a Save panel or Open panel. Because you have not yet defined any types or implemented loading and saving, you can't actually open or save anything.</p><p>From here, you should start by defining a document type (see <span class="content_text"><a href="FAQ.html#//apple_ref/doc/uid/20000954-1080758">“How do I define types?”</a></span>) and by implementing the load and save methods (see <span class="content_text"><a href="FAQ.html#//apple_ref/doc/uid/20000954-1080829">“How do I implement saving and loading for simple files?”</a></span>).</p><p>Beyond defining types and implementing loading and saving, you will certainly need to implement other capabilities in your document subclass. The document subclass should contain and own the contents of the document. This means that your <code>NSDocument</code> subclass should provide methods for maintaining and managing the document contents (that is, the document's model objects).</p><p>For more information on writing a document-based application, see <span class="content_text"><a href="ImplementingDocApp.html#//apple_ref/doc/uid/20000029-BCIHAJDA">“Implementing a Document-Based Application.”</a></span> For more information on subclassing <code>NSDocument</code>, see <span class="content_text"><a href="SubclassNSDocument.html#//apple_ref/doc/uid/20000028-BCIJGBIF">“Creating a Subclass of NSDocument.”</a></span> For an example of an application that follows the application design suggestions, see the Sketch example in <code>/Developer/Examples/AppKit/Sketch</code>.</p><a name="//apple_ref/doc/uid/20000954-1080758" title="How do I define types?"></a><a name="//apple_ref/doc/uid/20000954-1080758-BAJJDDBI" title="How do I define types?"></a><h2>How do I define types?</h2><p><a name="//apple_ref/doc/uid/20000954-DontLinkElementID_85"></a>Types are defined in a file called <code>Info.plist</code>, which is managed for you by Xcode. For details on information property lists, see <span class="content_text"><a href="../Concepts/DocTypePList.html#//apple_ref/doc/uid/20000024-BHADAGHF">“Storing Document Types Information in the Application's Property List,”</a></span> as well as <em><a href="../../PropertyLists/index.html#//apple_ref/doc/uid/10000048i" target="_top">Property List Programming Guide</a></em>.</p><p>You can define types for your application in the Target inspector in Xcode. The Target inspector provides an editable list of document types, as shown in <span class="content_text"><a href="../Concepts/DocTypePList.html#//apple_ref/doc/uid/20000024-BHADAGHF">“Storing Document Types Information in the Application's Property List.”</a></span> </p><p>For a new application, you should create a type with a name and extension that make sense for your application. You can add more types as well.</p><p>The application's “main” or most important document type should be listed first in the list of types. This is the type <code>NSDocumentController</code> will use by default when the user asks for a new document.</p><a name="//apple_ref/doc/uid/20000954-1080829" title="How do I implement saving and loading for simple files?"></a><a name="//apple_ref/doc/uid/20000954-1080829-BAJBFGAG" title="How do I implement saving and loading for simple files?"></a><h2>How do I implement saving and loading for simple files?</h2><p><a name="//apple_ref/doc/uid/20000954-DontLinkElementID_86"></a>A new document-based application project comes with empty method implementations for <code>dataRepresentationOfType:</code> and <code>loadDataRepresentation:ofType:</code> in the custom subclass that is automatically created for you. You should implement these methods to support reading and writing of simple files if your application must be able to run on Mac OS X v10.3 or earlier.</p><p>For applications that can require Mac OS X v10.4 and later, override <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/dataOfType:error:" target="_top">dataOfType:error:</a></code> and <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/readFromData:ofType:error:" target="_top">readFromData:ofType:error:</a></code>, respectively, instead. For example implementations of those overrides, see <span class="content_text"><a href="ImplementingDocApp.html#//apple_ref/doc/uid/20000029-BCIHAJDA">“Implementing a Document-Based Application”</a></span> and the Sketch example application at <code>/Developer/Examples/AppKit/Sketch/</code>.</p><p>The <code>dataOfType:error:</code> method should provide the contents of the document as an <code>NSData</code> object, formatted as the requested type.</p><p>The <code>readFromData:ofType:error:</code> method should be able to read in the document contents from the given <code>NSData</code>, interpreting the data as the given type.</p><p>If your document saves document as file wrappers or has other more sophisticated needs, see <span class="content_text"><a href="FAQ.html#//apple_ref/doc/uid/20000954-1081069">“How do I implement document packages?”</a></span> and <span class="content_text"><a href="FAQ.html#//apple_ref/doc/uid/20000954-1081125">“How do I implement loading and saving when the simple data or file wrapper API won’t do?”</a></span> for more information.</p><a name="//apple_ref/doc/uid/20000954-1081069" title="How do I implement document packages?"></a><a name="//apple_ref/doc/uid/20000954-1081069-BAJHBHGJ" title="How do I implement document packages?"></a><h2>How do I implement document packages?</h2><p><a name="//apple_ref/doc/uid/20000954-DontLinkElementID_87"></a>Document packages are really folders, but they appear in the Finder to be opaque documents. Usually, an application that wants its documents to be document packages uses the <code>NSFileWrapper</code> class to construct and access its documents. If this is true for some or all of the types that your document class supports, then instead of overriding <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/dataOfType:error:" target="_top">dataOfType:error:</a></code> and <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/readFromData:ofType:error:" target="_top">readFromData:ofType:error:</a></code>, you should override <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/fileWrapperOfType:error:" target="_top">fileWrapperOfType:error:</a></code> and <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/readFromFileWrapper:ofType:error:" target="_top">readFromFileWrapper:ofType:error:</a></code>.</p><p>These methods are much the same as the data-based methods, but they use <code>NSFileWrapper</code> objects instead.</p><p>You should also specify, in the document types section of your application’s information property list, that documents of the specified type are packages (as described in <span class="content_text"><a href="../Concepts/DocTypePList.html#//apple_ref/doc/uid/20000024-BHADAGHF">“Storing Document Types Information in the Application's Property List”</a></span>).</p><a name="//apple_ref/doc/uid/20000954-1081125" title="How do I implement loading and saving when the simple data or file wrapper API won&acirc;&#128;&#153;t do?"></a><a name="//apple_ref/doc/uid/20000954-1081125-BAJIGEFI" title="How do I implement loading and saving when the simple data or file wrapper API won&acirc;&#128;&#153;t do?"></a><h2>How do I implement loading and saving when the simple data or file wrapper API won’t do?</h2><p>If, for some reason, neither the <code>NSData</code> nor the <code>NSFileWrapper</code> loading and saving API work for you, you can override the three <code>NSDocument</code> methods that load and save a document from a URL. These methods are:</p><ul class="simple"><li><p><code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/readFromURL:ofType:error:" target="_top">readFromURL:ofType:error:</a></code></p></li><li><p><code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/writeToURL:ofType:error:" target="_top">writeToURL:ofType:error:</a></code></p></li><li><p><code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/writeToURL:ofType:forSaveOperation:originalContentsURL:error:" target="_top">writeToURL:ofType:forSaveOperation:originalContentsURL:error:</a></code></p></li></ul><p>You should override the reading method and one of the writing methods if you are going to use these as your only reading and writing methods.</p><p>You might also override these methods not to provide the loading and saving behavior, but rather to do something immediately before or after actually loading or saving. In this case you would add your code before or after a call to the superclass implementation. This type of overriding is discussed in <span class="content_text"><a href="FAQ.html#//apple_ref/doc/uid/20000954-1081265">“How can I support reading one type and automatically converting (internally) to another?.”</a></span></p><a name="//apple_ref/doc/uid/20000954-1080900" title="Should I subclass NSWindowController?"></a><h2>Should I subclass NSWindowController?</h2><p><a name="//apple_ref/doc/uid/20000954-DontLinkElementID_88"></a>The default Document-based Application project template does not subclass <code>NSWindowController</code>. You do not need to subclass <code>NSWindowController</code> if you are writing a simple application. However, if you are writing an application with more advanced requirements, you will almost certainly want to do so. Here are some common situations that would make subclassing <code>NSWindowController</code> desirable:</p><ul class="ul"><li class="li"><p>You need multiple windows to display your application's document. If you are writing an application whose documents are complex enough to require multiple kinds of windows (such as a CAD program that wants to present front, top, and side views, as well as a rendered 3D view), then you will probably want to have one or more subclasses of <code>NSWindowController</code> to manage the different kinds of windows that your document needs.</p></li><li class="li"><p>You want to support multiple views onto a document. If you are writing an application where you want the user to be able to create multiple views onto a document (such as a drawing program that would like the user to be able to open multiple views so they can see different parts of the same document or see the same parts but with different view settings, such as scales), then you should subclass <code>NSWindowController</code>.</p></li><li class="li"><p>Your application's controller layer is complex enough to make splitting it into a back-end controller (your <code>NSDocument</code> subclass) and a front-end controller (an <code>NSWindowController</code> subclass) worthwhile. Especially for larger applications, splitting the controller duties between two classes makes a lot of sense. This strategy allows you to have documents that are open, but not onscreen, to avoid having to allocate memory and other resources of a front end that may not be used in some circumstances.</p></li></ul><p>For more information on the roles of <code>NSDocument</code> and <code>NSWindowController</code> in the document architecture, see <span class="content_text"><a href="../Concepts/RolesOfDocObjects.html#//apple_ref/doc/uid/20000025-BBCJCGHA" target="_self">“The Roles of Key Objects in Document Based Applications.”</a></span></p><a name="//apple_ref/doc/uid/20000954-1080949" title="How do I subclass NSWindowController?"></a><a name="//apple_ref/doc/uid/20000954-1080949-BAJECHFD" title="How do I subclass NSWindowController?"></a><h2>How do I subclass NSWindowController?</h2><p><a name="//apple_ref/doc/uid/20000954-DontLinkElementID_89"></a>Once you've decided to subclass <code>NSWindowController</code>, you need to make a couple of changes to the default document-based application setup. First, you should add any Interface Builder outlets and actions for your document's user interface to the <code>NSWindowController</code> subclass instead of the <code>NSDocument</code> subclass. This is because, now, the <code>NSWindowController</code> subclass is the nib file's owner. Some menu actions can still be implemented in the <code>NSDocument</code> subclass. For example, save and revert are implemented by <code>NSDocument</code>, and you might add other menu actions of your own such as an action for creating new views on a document.</p><p>Second, instead of overriding <code>windowNibName</code> in your <code>NSDocument</code> subclass, override <code>makeWindowControllers</code>. In <code>makeWindowControllers</code> you should create at least one instance of your custom <code>NSWindowController</code> subclass and use <code>addWindowController:</code> to add it to the document. If your document always needs multiple controllers, create them all here. If your document will support multiple views, but by default has one, create the controller for the default view here and provide user actions for creating other views.</p><p>You should not force the windows to be visible in <code>makeWindowControllers</code>. <code>NSDocument</code> will do that for you if it’s appropriate.</p><p>See <span class="content_text"><a href="FAQ.html#//apple_ref/doc/uid/20000954-1081429">“How can I make an NSWindowController subclass that automatically uses a particular nib file?”</a></span> and subsequent questions for more information about <code>NSWindowController</code>.</p><a name="//apple_ref/doc/uid/20000954-1081016" title="When can I do setup operations on my user interface objects?"></a><h2>When can I do setup operations on my user interface objects?</h2><p><a name="//apple_ref/doc/uid/20000954-DontLinkElementID_90"></a>Many applications need to perform setup operations on user interface objects, such as setting the content of a view, after the application's model data has been loaded. In this case, you must remember that the <code>NSDocument</code> data-reading methods, such as <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/readFromData:ofType:error:" target="_top">readFromData:ofType:error:</a></code>, are called <em>before</em> the document's user interface objects contained in its nib file are loaded. Of course, you cannot send messages to user interface objects until after the nib file loads.</p><p>After you load the data, you must store it temporarily and set up your user interface objects after the document's nib file loads. If you do not subclass <code>NSWindowController</code>, then you can override the <code>NSDocument</code> method <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/windowControllerDidLoadNib:" target="_top">windowControllerDidLoadNib:</a></code> instead. Or if you do subclass <code>NSWindowController</code>, you should instead override the <code>NSWindowController</code> method <code><a href="../../../Reference/ApplicationKit/Classes/NSWindowController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSWindowController/windowDidLoad" target="_top">windowDidLoad</a></code>. </p><p>If, on the other hand, you need to do some operation immediately before the nib file loads, you can override the <code>NSDocument</code> method <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/windowControllerWillLoadNib:" target="_top">windowControllerWillLoadNib:</a></code> (if you don't subclass <code>NSWindowController</code>) or the <code>NSWindowController</code> method <code><a href="../../../Reference/ApplicationKit/Classes/NSWindowController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSWindowController/windowWillLoad" target="_top">windowWillLoad</a></code> (if you do subclass <code>NSWindowController</code>).</p><p>For objects that are instantiated in the nib file, you can implement the  <code><a href="../../../Reference/ApplicationKit/Protocols/NSNibAwaking_Protocol/Reference/Reference.html#//apple_ref/occ/instm/NSObject/awakeFromNib" target="_top">awakeFromNib</a></code> method for this purpose. The Application Kit sends <code><a href="../../../Reference/ApplicationKit/Protocols/NSNibAwaking_Protocol/Reference/Reference.html#//apple_ref/occ/instm/NSObject/awakeFromNib" target="_top">awakeFromNib</a></code> to the nib file’s objects after they have all been loaded and all their connections set up. However, the order in which the message is sent is not guaranteed.</p><a name="//apple_ref/doc/uid/20000954-1081200" title="How can I support read-only types?"></a><a name="//apple_ref/doc/uid/20000954-1081200-BAJEDDHB" title="How can I support read-only types?"></a><h2>How can I support read-only types?</h2><p><a name="//apple_ref/doc/uid/20000954-DontLinkElementID_91"></a>If your application has some types that it can read but not write, you can declare this by setting the role for those types to “Viewer” instead of “Editor” in Xcode, as shown in <span class="content_text"><a href="../Concepts/DocTypePList.html#//apple_ref/doc/uid/20000024-BHADAGHF">“Storing Document Types Information in the Application's Property List.”</a></span></p><a name="//apple_ref/doc/uid/20000954-1081225" title="How can I support write-only types?"></a><h2>How can I support write-only types?</h2><p>If your application has some types that it can write, but not read, you can declare this by using the <code><!--a  -->NSExportableAs<!--/a--></code> key. You can include the <code><!--a  -->NSExportableAs<!--/a--></code> key in the type dictionary for another type that your document class supports. Usually this key would go in the type dictionary for the most native type for your document class. Its value is an array of type names that your document class can write, but not read.</p><p>The <a name="//apple_ref/doc/uid/20000954-DontLinkElementID_92"></a>Sketch example uses this key to allow it to export TIFF and EPS images even though it cannot read those types.</p><p>Write-only types can be chosen only when doing Save As operations. They are not allowed for Save operations.</p><a name="//apple_ref/doc/uid/20000954-1081265" title="How can I support reading one type and automatically converting (internally) to another?"></a><a name="//apple_ref/doc/uid/20000954-1081265-BAJFDEGD" title="How can I support reading one type and automatically converting (internally) to another?"></a><h2>How can I support reading one type and automatically converting (internally) to another?</h2><p>Sometimes an application might understand how to read a type, but not how to write it, and when it reads documents of that type, it should automatically convert them to another type that you can write. An example of this would be an application that can read documents from an older version or from a competing product. It might want to read in the old documents and automatically convert them to the new native format.</p><p>The first step is to add the old type as a read-only type (see <span class="content_text"><a href="FAQ.html#//apple_ref/doc/uid/20000954-1081200">“How can I support read-only types?”</a></span>). By doing this, your application is able to open the old files, but they come up as untitled files.</p><p>If you want to automatically convert them to be saved as your new type, you can override the <code>readFrom...</code> methods in your <code>NSDocument</code> subclass to call <code>super</code> and then reset the filename and type afterwards. You should use <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/setFileType:" target="_top">setFileType:</a></code> and <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/setFileURL:" target="_top">setFileURL:</a></code> to set an appropriate type and name for the new document. When setting the filename make sure to strip the filename extension of the old type from the original filename, if it is there, and add the extension for the new type.</p><a name="//apple_ref/doc/uid/20000954-1081321" title="How can I customize the Save panel?"></a><h2>How can I customize the Save panel?</h2><p>You can control whether the default accessory view (which contains a pop-up menu allowing the user to choose what type to save) appears in the Save panel by overriding <code>shouldRunSavePanelWithAccessoryView</code>. The default accessory view is used if that method returns <code>YES</code> and the document supports writing multiple types.</p><p>You can customize the panel more completely by overriding <code>prepareSavePanel:</code> and modifying the panel before calling <code>super</code>. For example, you could replace the accessory view entirely.</p><a name="//apple_ref/doc/uid/20000954-1081373" title="How do I implement printing?"></a><h2>How do I implement printing?</h2><p><a name="//apple_ref/doc/uid/20000954-DontLinkElementID_93"></a>Subclasses of <code>NSDocument</code> that wish to support printing should override <code>printShowingPrintPanel:</code>. Usually this is implemented to create an <code>NSPrintOperation</code> object with the document's print info and run it.</p><p>A document should be prepared to print itself even if it currently has no window controllers.</p><a name="//apple_ref/doc/uid/20000954-1081403" title="Should I do anything about print info?"></a><h2>Should I do anything about print info?</h2><p>Ideally you should treat a document's print info as part of the document, to be saved and loaded along with the rest of the contents. This is not always possible if your document format is already defined and is not flexible enough to allow saving the print info.</p><p>Apart from using it to create your print operations and possibly saving and loading it, you should not have to do anything else about print info.</p><a name="//apple_ref/doc/uid/20000954-1081429" title="How can I make an NSWindowController subclass that automatically uses a particular nib file?"></a><a name="//apple_ref/doc/uid/20000954-1081429-BAJIEACC" title="How can I make an NSWindowController subclass that automatically uses a particular nib file?"></a><h2>How can I make an NSWindowController subclass that automatically uses a particular nib file?</h2><p><a name="//apple_ref/doc/uid/20000954-DontLinkElementID_94"></a>An <code>NSWindowController</code> object expects to be told what nib file to load (through its <code>initWithWindowNib...</code> methods), because it is a generic implementation of the default behavior for all window controllers. However, when you write a subclass of <code>NSWindowController</code>, it is almost always designed to control the user interface contained in a particular nib file, and your subclass would not work with a different nib file. It is therefore inconvenient and error-prone for the client of the subclass to have to tell it which nib file to load.</p><p>This is easily solved by overriding the <code>init</code> method to simply call the superclass's <code>initWithWindowNibName:</code> method with the correct nib name. Now clients just use <code>init</code> and the controller has the correct nib file. You can also override the <code>initWithWindowNib...</code> methods to log an error, because no clients should ever try to tell your subclass which nib file to use. This is a good idea for any <code>NSWindowController</code> subclass designed to work with a specific nib file. You should do otherwise only if you are extending the basic functionality of <code>NSWindowController</code> in your subclass and have not tied that functionality to any particular nib file.</p><a name="//apple_ref/doc/uid/20000954-1081485" title="How can I use NSWindowController for shared panels (inspectors, find panels, etc.)?"></a><h2>How can I use NSWindowController for shared panels (inspectors, find panels, etc.)?</h2><p><a name="//apple_ref/doc/uid/20000954-DontLinkElementID_95"></a>An <code>NSWindowController</code> object without an associated <code>NSDocument</code> object is useful all by itself. <code>NSWindowController</code> can be used as the base class for auxiliary panel controllers in order to gain the use of its nib management abilities.</p><p>One common standalone use of <code>NSWindowController</code> subclasses is as controllers for shared panels such as find panels, inspectors, or preferences panels. In this case, you can make an <code>NSWindowController</code> subclass that implements a shared instance method. For example, you could create a <code>PreferencesController</code> subclass with a <code>sharedPreferenceController</code> class method that creates a single instance the first time it is called and returns that same instance on all subsequent calls.</p><p>Because your subclass derives from <code>NSWindowController</code>, you can just tell it the name of your Preferences nib file and it will handle loading the nib file and managing the window automatically. You add your own outlets and actions, as usual, to hook up the specific user interface for your panel and add methods to manage the panel’s behavior.</p><p>The Sketch application uses <code>NSWindowController</code> subclasses for its various secondary panels.</p><a name="//apple_ref/doc/uid/20000954-1081525" title="How can I use multiple NSWindowControllers for a single document?"></a><h2>How can I use multiple NSWindowControllers for a single document?</h2><p><a name="//apple_ref/doc/uid/20000954-DontLinkElementID_96"></a>If you use <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/makeWindowControllers" target="_top">makeWindowControllers</a></code> to create your window controllers (see <span class="content_text"><a href="FAQ.html#//apple_ref/doc/uid/20000954-1080949">“How do I subclass NSWindowController?”</a></span>), you can create more than one, possibly of different subclasses of <code>NSWindowController</code>, from the beginning. Another possibility is to allow the application to create new controllers later as it needs them. In any event, multiple controllers can be added to a document with <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/addWindowController:" target="_top">addWindowController:</a></code>.</p><p>By default, a document closes when its last remaining window controller closes. Specific window controllers can also be set to close the document when they close even if there are other controllers still open. An example of where this happens is Interface Builder. There is a main window for a nib document with a tab view and top-level instances in it, and there are a number of other windows, which are the window editors for the windows in the nib. If the user closes the main window, all the other windows close as well and the document itself closes. Interface Builder calls <code>setShouldCloseDocument:YES</code> on the main window's controller to implement this behavior.</p><a name="//apple_ref/doc/uid/20000954-1081566" title="How can I customize the window title for a document&acirc;&#128;&#153;s NSWindowController?"></a><h2>How can I customize the window title for a document’s NSWindowController?</h2><p>You can override the <code>NSWindowController</code> method <code><a href="../../../Reference/ApplicationKit/Classes/NSWindowController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSWindowController/windowTitleForDocumentDisplayName:" target="_top">windowTitleForDocumentDisplayName:</a></code> to modify the title for each view. For instance, a CAD program might have the titles of the different windows it uses for a document named “Airplane” as “Airplane – Top,” “Airplane – Side,” and so on.</p><a name="//apple_ref/doc/uid/20000954-1081593" title="How do I implement undo?"></a><h2>How do I implement undo?</h2><p><a name="//apple_ref/doc/uid/20000954-DontLinkElementID_97"></a>Undo is not always easy to implement, but at least the mechanism for implementing it is straightforward. By default, an <code>NSDocument</code> object has its own <code>NSUndoManager</code> object. The <code>NSUndoManager</code> class enables you to easily construct invocations that do the opposite of a preceding change.</p><p>The key is to have well-defined primitives for changing your document. Each model object, plus the <code>NSDocument</code> subclass itself, should define the set of primitive methods that can change it. Each primitive method is then responsible for using the undo manager to enqueue invocations that undo the action of the primitive method. For example, if you decide that <code>setColor:</code> is a primitive method for one of your model objects, then inside of <code>setColor:</code> your object would do something like the following:</p><div class="codesample"><table><tr><td scope="row"><pre> [[[myDocument undoManager] prepareInvocationWithTarget:self] setColor:oldColor]<span></span></pre></td></tr></table></div><p>This call causes the undo manager to construct an invocation and save it away. If the user later chooses Undo, the saved invocation is invoked and your model object receives another <code>setColor:</code> message, this time with the old color. (If you're wondering if you have to keep track of whether things are being undone and avoid doing the undo manager stuff again, you don't. In fact, the way redo works is by watching what invocations get registered as the undo is happening and recording them on the redo stack.)</p><p>Another piece of good undo implementation is to provide action names so the Undo and Redo menu items can have more descriptive titles. Undo action names are usually best set in action methods instead of the change primitives in your model objects because many primitive changes might go into one user action, or different user actions might result in the same primitives being called in different ways. The <a name="//apple_ref/doc/uid/20000954-DontLinkElementID_98"></a>Sketch example application implements undo in action methods.</p><p>For more information on supporting undo in your application, see <em><a href="../../UndoArchitecture/index.html#//apple_ref/doc/uid/10000010i" target="_top">Undo Architecture</a></em>.</p><a name="//apple_ref/doc/uid/20000954-1081668" title="How do I implement partial undo?"></a><h2>How do I implement partial undo?</h2><p><a name="//apple_ref/doc/uid/20000954-DontLinkElementID_99"></a>Because <code>NSUndoManager</code> does multiple-level undo, it is not a good idea to implement undo for only a subset of the possible changes to your document. The undo manager relies on being able to reliably take the document back through history with repeated undos. If some changes get skipped, the undo stack state is no longer synchronized with the contents of the document. Depending on your architecture, that can cause problems that range from merely annoying to fatal.</p><p>If there are some changes that you just can't undo, there are two possibilities for handling the situation when a user makes such a change. If you can be absolutely sure that the change has no relationship to any other changes that can happen to the document (that is, something totally independent of all the rest of the contents of the document has changed), then you can safely just not register any undo action for that change. On the other hand, if the change does have some relationship to the rest of the document contents, you should remove all actions from the undo manager when such a change takes place. Such changes then mark points of no return in your user experience. When designing your application and document format, you should strive to avoid the need for these “point of no return” operations.</p><a name="//apple_ref/doc/uid/20000954-1081692" title="What if I don&#39;t want to support undo?"></a><a name="//apple_ref/doc/uid/20000954-1081692-BAJFAHHE" title="What if I don&#39;t want to support undo?"></a><h2>What if I don't want to support undo?</h2><p><a name="//apple_ref/doc/uid/20000954-DontLinkElementID_100"></a>If you don't wish to support undo at all, the first thing you should do is call <code>setHasUndoManager:NO</code> on your document. This causes the document never to get an undo manager.</p><p>Without an undo manager (and undo support from your model objects), the document cannot automatically track its dirty state. So, if you aren't implementing undo, you need to call <code>updateChangeCount:</code> by hand whenever your document is edited.</p><a name="//apple_ref/doc/uid/20000954-1081728" title="What&#39;s all this change count stuff?"></a><h2>What's all this change count stuff?</h2><p><a name="//apple_ref/doc/uid/20000954-DontLinkElementID_101"></a>Because of undo support, the document must keep more information than just whether the document is dirty or clean. If a user opens a file, makes five changes, and then chooses Undo five times, the document should once again be clean. But if the user chooses Undo only four times, the document is still dirty.</p><p>The <code>NSDocument</code> object keeps a change count to deal with this. The change count can be modified by calling <code>updateChangeCount:</code> with one of the supported change types. The supported changes are <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/doc/c_ref/NSChangeDone" target="_top">NSChangeDone</a></code>, <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/doc/c_ref/NSChangeUndone" target="_top">NSChangeUndone</a></code>, and <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/doc/c_ref/NSChangeCleared" target="_top">NSChangeCleared</a></code>. The <code>NSDocument</code> object itself clears the change count whenever the user saves or reverts the document. If the document has an undo manager, it observes the undo manager and automatically updates the change count when changes are done, undone, or redone.</p><p>If your document subclass does not support undo, then you need to inform <code>NSDocument</code> of edits with <code>updateChangeCount:</code> yourself (see <span class="content_text"><a href="FAQ.html#//apple_ref/doc/uid/20000954-1081692">“What if I don't want to support undo?”</a></span>).</p><a name="//apple_ref/doc/uid/20000954-1081791" title="Should I subclass NSDocumentController?"></a><h2>Should I subclass NSDocumentController?</h2><p><a name="//apple_ref/doc/uid/20000954-DontLinkElementID_102"></a>Usually, you should not need to subclass <code>NSDocumentController</code>. Almost anything that can be done by subclassing can be done just as easily by the application’s delegate. However, it is possible to subclass <code>NSDocumentController</code> if you need to.</p><p>For example, if you need to customize the Open panel, an <code>NSDocumentController</code> subclass is clearly needed. You can override the <code>NSDocumentController</code> method  <code><a href="../../../Reference/ApplicationKit/Classes/NSDocumentController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocumentController/runModalOpenPanel:forTypes:" target="_top">runModalOpenPanel:forTypes:</a></code> to customize the panel or add an accessory view.</p><a name="//apple_ref/doc/uid/20000954-1081810" title="How can I subclass NSDocumentController?"></a><h2>How can I subclass NSDocumentController?</h2><p>There are two ways to subclass <code>NSDocumentController</code>:</p><ul class="ul"><li class="li"><p>You can make an instance of your subclass in your application's main nib file. This instance becomes the shared instance.</p></li><li class="li"><p>You can create an instance of your subclass in your application delegate’s <code><a href="../../../Reference/ApplicationKit/Classes/NSApplication_Class/Reference/Reference.html#//apple_ref/occ/instm/NSObject/applicationWillFinishLaunching:" target="_top">applicationWillFinishLaunching:</a></code> method.</p></li></ul><p>The first <code>NSDocumentController</code> object to be created becomes the shared instance. The Application Kit itself creates the shared instance (using the <code>NSDocumentController</code> class) during the "finish launching" phase of application startup. So if you need a subclass instance, you must create it before the Application Kit does.</p><a name="//apple_ref/doc/uid/20000954-1081850" title="How can I create new documents other than through user-action methods?"></a><h2>How can I create new documents other than through user-action methods?</h2><p><a name="//apple_ref/doc/uid/20000954-DontLinkElementID_103"></a>You can use the <code>NSDocumentController</code> methods <code><a href="../../../Reference/ApplicationKit/Classes/NSDocumentController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocumentController/openUntitledDocumentAndDisplay:error:" target="_top">openUntitledDocumentAndDisplay:error:</a></code> and <code><a href="../../../Reference/ApplicationKit/Classes/NSDocumentController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocumentController/openDocumentWithContentsOfURL:display:error:" target="_top">openDocumentWithContentsOfURL:display:error:</a></code>, which create a document and, if the display parameter is <code><a href="../../../Reference/ObjCRuntimeRef/Reference/reference.html#//apple_ref/doc/c_ref/YES" target="_top">YES</a></code>, also create the document’s window controller (or controllers) and add the document to the list of open documents. These methods also check file paths and return an existing document for the file path if one exists.</p><p>You can also use the <code>NSDocumentController</code> methods <code><a href="../../../Reference/ApplicationKit/Classes/NSDocumentController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocumentController/makeUntitledDocumentOfType:error:" target="_top">makeUntitledDocumentOfType:error:</a></code>, <code><a href="../../../Reference/ApplicationKit/Classes/NSDocumentController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocumentController/makeDocumentWithContentsOfURL:ofType:error:" target="_top">makeDocumentWithContentsOfURL:ofType:error:</a></code>, and <code><a href="../../../Reference/ApplicationKit/Classes/NSDocumentController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocumentController/makeDocumentForURL:withContentsOfURL:ofType:error:" target="_top">makeDocumentForURL:withContentsOfURL:ofType:error:</a></code>, which just create the document, or you can simply create a document yourself with any initializer the subclass supports. In either case, you usually need to call the <code>NSDocumentController</code> method <code><a href="../../../Reference/ApplicationKit/Classes/NSDocumentController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocumentController/addDocument:" target="_top">addDocument:</a></code> to add the document to the document controller's list of documents</p><a name="//apple_ref/doc/uid/20000954-DontLinkElementID_14" title="How can I keep my application from creating an untitled document at launch?"></a><h2>How can I keep my application from creating an untitled document at launch?</h2><p>Implementing the <code><a href="../../../Reference/ApplicationKit/Classes/NSApplication_Class/Reference/Reference.html#//apple_ref/occ/instm/NSObject/applicationShouldOpenUntitledFile:" target="_top">applicationShouldOpenUntitledFile:</a></code> method to return <code>NO</code> in your application delegate prevents the application from opening an untitled file when launched or activated. If you do want to open an untitled file when launched, but don't want to open an untitled file when already running and activated from the dock, you can instead implement <code><a href="../../../Reference/ApplicationKit/Classes/NSApplication_Class/Reference/Reference.html#//apple_ref/occ/instm/NSObject/applicationShouldHandleReopen:hasVisibleWindows:" target="_top">applicationShouldHandleReopen:hasVisibleWindows:</a></code> to return <code>NO</code>.</p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../Articles/ErrorHandling.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2001, 2009 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2009-01-12<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Conceptual/Documents/Tasks/FAQ.html%3Fid%3D10000006i-2.7&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Conceptual/Documents/Tasks/FAQ.html%3Fid%3D10000006i-2.7&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Conceptual/Documents/Tasks/FAQ.html%3Fid%3D10000006i-2.7&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
