<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>The AppleTalk Protocol Stack(IM:N)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING19></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Networking-18.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Networking-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Networking-304.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt= "Book Index"></A> <A HREF="Networking-20.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Networking-2.html"><B>Networking</B></A> / <BR><DD><A HREF="Networking-15.html"><B>Chapter 1 - Introduction to AppleTalk</B></A> / <A HREF="Networking-16.html"><B>About Networking on the Macintosh</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING19-0></A>
<H2><A NAME=MARKER-9-90></A>The AppleTalk Protocol Stack</H2>
 <A NAME=MARKER-9-16></A>This<A NAME=MARKER-2-88></A> section explains what an AppleTalk protocol is, then it provides a brief discussion of each component of the <A NAME=MARKER-2-244></A>AppleTalk protocol stack, followed by a discussion of how the AppleTalk protocols are implemented in software drivers. <P>
 <A NAME=MARKER-9-94></A>This section also introduces the LAP Manager, multivendor support, and multinode architecture, which are components of AppleTalk, although strictly considered, they are not protocols. <P>
 To develop applications that use AppleTalk networking services, you don't need to understand how AppleTalk implements the protocols it supports. However, under-<BR>standing the functions that each protocol provides will help you determine which application programming interfaces to use for your application. <P>
 The AppleTalk system architecture consists of a number of protocols arranged in layers. The various AppleTalk protocols are sets of rules, not computer programs, and so can be implemented in many different ways on many different systems. All of the AppleTalk protocol functions that you can address or control from a Macintosh application are implemented as Macintosh device drivers or managers. Many other features of these protocols are implemented in software located only on internet routers that are not used to run general applications. Some parts of protocols are implemented by server software such as file servers or print servers. <P>
 When this book refers to a protocol as <I>doing</I> or <I>controlling</I> something, you should understand the statement to mean that some program that implements the protocol actually carries out the operation. Each protocol in a specific layer provides services to one or more protocols in a higher-level layer, which is then the client of the lower-level protocol. The higher-level protocol builds on the services provided by the lower-level one. <A HREF=#MARKER-9-95>Figure 1-2 on page 1-11</A> shows the AppleTalk protocols and how they relate to one another in layers. The following sections describe each protocol in turn, beginning with AFP, and progressing through the protocols as they appear in the figure.<P>
<B>Figure 1-2  <A NAME=MARKER-9-95></A>AppleTalk protocol stack </B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/IAT-L-01.jpg"><P>
<A NAME=HEADING19-8></A>
<H3>AppleTalk Filing Protocol (AFP)</H3>
 <A NAME=MARKER-2-183></A>The <A NAME=MARKER-2-242></A><B>AppleTalk Filing Protocol</B> <B>(AFP)</B> allows a workstation on an AppleTalk network to access files on AppleShare file servers. When the user opens a session with an AppleShare file server over an internet, it appears to any application running on the workstation that uses File Manager routines as if the files on the file server were located on a disk drive connected to the workstation. The AFP protocol is not commonly used because the native file system commands allow users to access an AFP server, such as AppleShare, from a workstation. There is no server-based interface. <P>
 The chapter "AppleTalk Filing Protocol (AFP)" in this book describes the application programming interface to the workstation implementation of AFP. For additional information about AFP, see <A HREF=Networking-29.html#MARKER-9-205>"Accessing AppleShare and Other File Servers" on page 1-24</A>.<P>
<A NAME=HEADING19-11></A>
<H3>Zone Information Protocol (ZIP)</H3>
 <A NAME=MARKER-9-36></A>The <B>Zo<A NAME=MARKER-2-157></A>ne Information Protocol</B> <B>(ZIP)</B> provides applications and processes with access to zone names. Each node on a network belongs to a zone. Zone names are typically used to identify groups of nodes belonging to a particular department or area. ZIP allows applications and processes to gain access to<P>
<UL>
<LI>their own node's zone name
<LI>the names of all the zones on their local network
<LI>the names of all the zones throughout the internet<P>
</UL>
 The chapter "Zone Information Protocol (ZIP)" in this book describes the ZIP application programming interface. For additional information about ZIP, see <A HREF=Networking-24.html#MARKER-9-179>"Identifying Zones" on page 1-21</A>.<P>
<A NAME=HEADING19-17></A>
<H3>AppleTalk Session Protocol (ASP)</H3>
 The <B>A<A NAME=MARKER-2-196></A>ppleTalk Session Protocol</B> <B>(ASP)</B> sets up and <A NAME=MARKER-2-82></A>maintains sessions between a workstation and a server. ASP is an <A NAME=MARKER-2-80></A>asymmetrical protocol in which one side of the dialog, the workstation client of ASP, initiates the session and sends commands to the other side of the dialog. <A NAME=MARKER-2-189></A>A higher-level protocol that is built on top of the ASP server interprets and executes the command, and the ASP server returns a reply. ASP also provides a means by which the server can send a message to the workstation; for example, a file server can use this messaging system to notify all of the workstations that are using the file server that it is shutting down. ASP is used by the <A NAME=MARKER-2-3></A>AppleTalk Filing Protocol to allow a user to manipulate files on a file server. Because ADSP provides socket clients at both ends of the connection with equal control, ADSP is more commonly used than ASP when a session protocol is required.<A NAME=MARKER-2-39></A> <P>
 The chapter "AppleTalk Session Protocol (ASP)" in this book describes the ASP applica-<BR>tion programming interface. For additional information about ASP, see <A HREF=Networking-25.html#MARKER-9-191>"AppleTalk Session Protocol" on page 1-22</A>.<P>
<A NAME=HEADING19-20></A>
<H3>AppleTalk Data Stream Protocol (ADSP)</H3>
 The <B>A<A NAME=MARKER-21-195></A>ppleTalk Data Stream Protocol</B> <B>(ADSP)</B> is a <A NAME=MARKER-2-133></A>connection-oriented protocol that supports sessions over which applications and processes that are socket clients can exchange full-duplex streams of data across an AppleTalk internet. ADSP is a symm<A NAME=MARKER-2-197></A>etri-<BR>cal <A NAME=MARKER-2-173></A>protocol; the socket clients at either end of the connection have equal control over the ADSP session and the data exchange. Through attention messages, ADSP also provides for <A NAME=MARKER-2-30></A>out-of-band signaling, a process of sending data outside the normal session dialog so as not to interrupt the data flow. <P>
 The chapter "AppleTalk Data Stream Protocol (ADSP)" in this book describes the ADSP application programming interface. For additional information about ADSP, see <A HREF=Networking-25.html#MARKER-9-186>"AppleTalk Data Stream Protocol" on page 1-21</A>.<P>
<A NAME=HEADING19-23></A>
<H3>AppleTalk Transaction Protocol (ATP) </H3>
 The <B>A<A NAME=MARKER-2-23></A>ppleTalk Transaction Protocol</B> <B>(ATP)</B> is a <A NAME=MARKER-2-44></A>transaction protocol that allows one socket client to transmit a request that some action be performed to another socket client that carries out the action and transmits a response reporting the outcome. ATP provides reliable delivery of data by retransmitting any data packets that are lost and ensuring that the data packets are delivered in the correct sequence. <P>
 The chapter "AppleTalk Transaction Protocol (ATP)" in this book describes the ATP application programming interface. For additional information about ATP, see <A HREF=Networking-26.html#MARKER-9-195>"Performing a Transaction" on page 1-23</A>.<P>
<A NAME=HEADING19-26></A>
<H3>AppleTalk Echo Protocol (AEP)</H3>
 <A NAME=MARKER-2-23></A>The <A NAME=MARKER-2-170></A><B>AppleTalk Echo Protocol</B> <B>(AEP)</B> exists on every node as a DDP client process called the <A NAME=MARKER-2-190></A><B>AEP Echoer.</B> The AEP Echoer uses a special socket to <I>listen</I> for packets sent to it from socket clients on other nodes. When it receives such a packet, the AEP Echoer returns it dir<A NAME=MARKER-2-101></A>ectly to the sender. A socket client can send a packet to the AEP Echoer on another node to determine if that node can be accessed over the internet and to determine how long it takes a packet to reach that node. There is no application programming interface to AEP. A socket client can send packets to an AEP Echoer socket on another node from a DDP socket, but it cannot access the AEP implementation directly. <P>
 The chapter "Datagram Delivery Protocol (DDP)" in this book describes how to send packets to the AEP socket. For additional information about AEP, see <A HREF=Networking-28.html#MARKER-9-202>"Measuring Packet-Delivery Performance" on page 1-24</A>.<P>
<A NAME=HEADING19-29></A>
<H3>Name-Binding Protocol (NBP)</H3>
 <A NAME=MARKER-2-51></A>The <B>Name-<A NAME=MARKER-2-205></A>Binding Protocol</B> <B>(NBP)</B> provides your application or process with a way <BR>to map names that are useful to people using your program to numbers or addresses that are useful to computers. NBP associates a user-friendly three-part name that can be displayed to end users with the internet socket address of the application or process. When a user launches it, your application can register itself with NBP. When a user quits the application or when you no longer wish to advertise your application, your application can delete its entry from the NBP names table. Once your application registers itself with NBP, other applications can locate it.<P>
 All applications and processes that use AppleTalk use NBP to make their services known and available throughout an AppleTalk internet and to locate other applications and processes in the internet. An application or process can use NBP to <P>
<UL>
<LI>register itself with NBP. Registering an application or process with NBP makes that process a network-visible entity. (NBP lets your application or process bind a three-part name to its internet socket address.) 
<LI>look up or confirm the address of another application or process that is registered with NBP.
<LI>remove its entry from the NBP names table when it no longer wants to advertise <BR>its services. <P>
</UL>
 The chapter "Name-Binding Protocol (NBP)" in this book describes the NBP application programming interface. For additional information about NBP, see <A HREF=Networking-23.html#MARKER-9-175>"Making Your Application Available Throughout the Internet" on page 1-20</A>.<P>
<A NAME=HEADING19-36></A>
<H3>Routing Table Maintenance Protocol (RTMP)</H3>
 <A NAME=MARKER-2-9></A><A NAME=MARKER-2-89></A>The <A NAME=MARKER-2-91></A><B>Routing Table Maintenance Protocol</B> <B>(RTMP)</B> provides AppleTalk internet routers with a means of managing routing tables used to determine how to forward a datagram from one socket to another across an internet based on the datagram's destination network number. The RTMP implementation on a router maintains a table called a <B><A NAME=MARKER-2-70></A></B>routing table that specifies the shortest path to each possible destination network number. The AppleTalk protocol software in a workstation (that is, a node other than a router) contains only a small part of RTMP, called the <A NAME=MARKER-2-51></A>RTMP stub, that DDP uses to determine the network number (or range of network numbers) of the network cable to which the node is connected and to determine the network number and node ID of one router on that network cable. There is no application programming interface to the RTMP stub; therefore, RTMP is not discussed in this book.<A NAME=MARKER-2-58></A><P>
<A NAME=HEADING19-38></A>
<H3>Datagram Delivery Protocol (DDP)</H3>
 The <A NAME=MARKER-2-40></A><B>Datagram Delivery Protocol</B> <B>(DDP)</B> is a <A NAME=MARKER-2-72></A>connectionless protocol that transfers <BR>data between sockets as discrete packets, or datagrams, with each packet carrying its destination internet socket address. DDP provides <A NAME=MARKER-2-102></A>best-effort delivery. It does not include support to ensure that all packets sent are received at the destination or that those packets that are received are in the correct order. Higher-level protocols that use the services of DDP provide for reliable delivery of data. DDP uses whichever link-<BR>access protocol the user selects; that is, DDP can send its datagrams through any type of data link and transport media. <P>
 The chapter "Datagram Delivery Protocol (DDP)" in this book describes the DDP application programming interface. For additional information about DDP, see <A HREF=Networking-27.html#MARKER-9-200>"Sending and Receiving Data as Discrete Packets" on page 1-23</A>.<P>
<A NAME=HEADING19-41></A>
<H3>Link-Access Protocols</H3>
 <A NAME=MARKER-2-58></A>AppleTalk supports various network (or link) types and allows the user to select and switch among the types of networks to be used based on how the user's machine is configured; that is, if the machine has the proper hardware and software installed for a link type, the user can select that link. AppleTalk includes the link-access protocols for LocalTalk, EtherTalk, TokenTalk, and FDDITalk (Fiber Distributed Data Interface). AppleTalk uses connection files of type <CODE>'adev'</CODE> that contain software that supports a particular type of data link. <P>
 To achieve <A NAME=MARKER-2-17></A>link independence, AppleTalk relies on <A NAME=MARKER-2-114></A>the <B>Link-Access Protocol (LAP) Manager,</B> which is a set of operating-system utilities, not an AppleTalk protocol. The main function of the LAP Manager is to act as a switching mechanism that connects <BR>the AppleTalk link-access protocol for the link type that the user selects to both the higher-level AppleTalk protocols and the lower-level hardware device driver for that data link. From the Network control panel, a user can select which network is to be <BR>used for the node's AppleTalk connection. <P>
 The AppleTalk connection files of type <CODE>'adev'</CODE> and the LAP Manager work together with the Network control panel file of type <CODE>'cdev'</CODE>. When the user selects a network type from the Network control panel, the LAP Manager routes AppleTalk communi-<BR>cations through the link-access protocol for the selected network. <P>
 The LAP Manager also provides an application with access to the AppleTalk Transition Queue. You can place an entry for your application in the AppleTalk Transition Queue so that the LAP Manager will notify you when an AppleTalk transition occurs or is about to occur. An AppleTalk transition is an event, such as an AppleTalk driver being opened or closed, that can affect your AppleTalk application. <P>
 The chapter "Link-Access Protocol (LAP) Manager" in this book describes the LAP Manager and the AppleTalk Transition Queue. For additional information about the <BR>LAP Manager, <A NAME=MARKER-2-126></A>see the <I>Macintosh AppleTalk Connections Programmer's Guide</I>.<P>
<A NAME=HEADING19-47></A>
<H3>Multivendor Architecture</H3>
 In addition to supporting various types of networks, Apple also provides what is known as <I>multivendor support.</I> The<B> <A NAME=MARKER-2-118></A>multivendor architecture</B> allows for multiple brands of Ethernet, token ring, and FDDI NuBus<Superscript>\xC5<EM></EM> network interface controllers (NICs) to be installed on a single node at the same time. In addition to selecting the type of network connection, the user can now select a particular device to be used for the network connection. The chapter "Ethernet, Token Ring, and Fiber Distributed Data Interface" in this book describes multivendor architecture. <P>
<A NAME=HEADING19-49></A>
<H3>Multinode Architecture</H3>
 <B>Multinode architecture</B> is an AppleTalk feature that allows an application to acquire node IDs in addition to the standard node ID that is assigned to the system when the node joins an AppleTalk network. <A NAME=MARKER-2-95></A>Multinode architecture is provided to meet the needs of special-purpose applications that receive and process AppleTalk packets in a custom manner instead of passing them directly on to a higher-level AppleTalk protocol for processing. A multinode ID allows the system that is running your application to appear as multiple nodes on the network. The prime example of a multinode application is Apple Remote Access (ARA). The chapter "Multinode Architecture" in this book describes this feature.<A NAME=MARKER-2-7></A> <P>
<A NAME=HEADING19-51></A>
<H3>How the AppleTalk Protocols Are Implemented</H3>
 Above <A NAME=MARKER-2-135></A>the data-link level, all of the AppleTalk protocols that you can address or control from a Macintosh application through a programming interface as well as multinode architecture are implemented as Macintosh device drivers. <A HREF=#MARKER-9-1>Table 1-2</A> identifies the <A NAME=MARKER-2-122></A>AppleTalk drivers and the protocols they <A NAME=MARKER-2-134></A>implement. 
<TABLE BORDER="0" CELLPADDING=3>
<CAPTION><A NAME=MARKER-9-1></A><B>Table 1-2 AppleTalk drivers and the protocols they implement</B></CAPTION>
<TH>AppleTalk driver<TH>Protocols it implements<TR>
<TD>.MPP<A NAME=MARKER-2-24></A><TD><A NAME=MARKER-9-141></A>DDP, NBP, <A NAME=MARKER-2-203></A>AEP, RTMP stub, multinode<TR>
<TD>.ATP<TD><A NAME=MARKER-2-53></A>ATP<A NAME=MARKER-2-83></A><TR>
<TD>.XPP <TD><A NAME=MARKER-2-80></A>ASP, <A NAME=MARKER-2-147></A>workstation portions of ZIP and AFP<A NAME=MARKER-2-156></A><TR>
<TD>.DSP<TD><A NAME=MARKER-2-95></A>ADSP</TABLE>
<P>
 <A HREF=#MARKER-9-141>Figure 1-3</A> shows the AppleTalk protocols with the name of the driver that implements the protocol and the connection files of type <CODE>'adev'</CODE> that AppleTalk provides for various types of links. Notice how the LAP Manager acts as a switching <A NAME=MARKER-2-9></A>mechanism between <BR>the higher-level protocols and the link-access protocols. Many other features of these protocols are implemented in software located only on internet routers that are not used to run general applications. Some parts of protocols are implemented by server software such as file servers and print <A NAME=MARKER-2-248></A>servers. <A NAME=MARKER-2-167></A><P>
<B>Figure 1-3  Device drivers and connections files that implement AppleTalk protocols<A NAME=MARKER-9-141></A></B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/IAT-L-02.jpg"><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Networking-18.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Networking-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Networking-304.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt= "Book Index"></A> <A HREF="Networking-20.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Networking-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
