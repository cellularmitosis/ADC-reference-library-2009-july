<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Removing Items From a Collection(IM: XU)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING199></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="GXEnvironment-198.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="GXEnvironment-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="GXEnvironment-445.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="GXEnvironment-200.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="GXEnvironment-2.html"><B>QuickDraw GX Environment and Utilities</B></A> / <BR><DD><A HREF="GXEnvironment-182.html"><B>Chapter 5 - Collection Manager</B></A> / <A HREF="GXEnvironment-188.html"><B>Using the Collection Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING199-0></A>
<H2><A NAME=MARKER-9-70></A>Removing Items From a Collection</H2>
 The Collection Manager provides two methods for removing individual items from a collection:<P>
<UL>
<LI>You can use the <CODE>RemoveCollectionItem</CODE> function, specifying the collection tag and collection ID of the item you want to remove.
<LI>You can use the <CODE>RemoveIndexedCollectionItem</CODE> function, specifying the collection index of the item you want to remove.<P>
</UL>
 The Collection Manager provides three methods for removing multiple items from a collection:<P>
<UL>
<LI>You can use the <CODE>PurgeCollection</CODE> function to remove all the items in a collection whose attributes match criteria you specify.
<LI>You can use the <CODE>PurgeCollectionTag</CODE> function to remove all the items in a collection that have a specified collection tag.
<LI>You can use the <CODE>EmptyCollection</CODE> function to remove every item from a collection.<P>
</UL>
 <A HREF=#MARKER-9-74>Listing 5-12</A> shows how you can use the <CODE>RemoveCollectionItem</CODE> function to remove an item from a collection. (This example uses the collection created in <A HREF=GXEnvironment-193.html#MARKER-9-43>"Adding Items to a Collection" beginning on page 5-17</A>.)<P>
<B>Listing 5-12  <A NAME=MARKER-9-74></A>Removing an item in a collection</B><P>
<PRE>
anErr = RemoveCollectionItem(pointsAndQuotes, 
                             'QUOT', 1); /* tag and id */
</PRE>
 <BR>You can remove a collection item even if its lock attribute is set--the lock attribute only affects replacing. For example, if you have set the lock attribute of the collection item with the collection tag <CODE>'QUOT'</CODE> and the collection ID 0, you can remove this item using<P>
<PRE>
anErr = RemoveCollectionItem(pointsAndQuotes, 
                             'QUOT', 0); /* tag and id */
</PRE>
 You can also remove the item using<P>
<PRE>
anErr = RemoveCollectionItem(pointsAndQuotes, 
                             'QUOT', 0); /* tag and id */
</PRE>
 If you know the index of an item, you can use the <CODE>RemoveIndexedCollectionItem</CODE> function to remove the item. This function finds the specified item more efficiently than the <CODE>RemoveCollectionItem</CODE> function. <A HREF=#MARKER-9-75>Listing 5-13</A> shows an example of this function.<P>
<B>Listing 5-13  <A NAME=MARKER-9-75></A>Removing an item using the item's index</B><P>
<PRE>
long index;
.
.
.
/* get the index */
anErr = GetCollectionItemInfo(pointsAndQuotes, 
                              'QUOT', 1,
                              &amp;index, 
                              dontWantSize, 
                              dontWantAttributes);
.
.
.
/* remove the item */
anErr = RemoveIndexedCollectionItem(pointsAndQuotes, index);
</PRE>
 The example in <A HREF=#MARKER-9-75>Listing 5-13</A> uses the <CODE>GetCollectionItemInfo</CODE> function to find the collection index that the Collection Manager has assigned to the item with a collection tag of <CODE>'QUOT</CODE>' and a collection ID of 1. Finding this collection index requires some processing time. However, once you've found the item's collection index, you can use it to find information about the item quickly, because functions that search for a collection item using the item's collection index operate more efficiently than functions that search using the item's collection tag and collection ID.<P>
 The <CODE>PurgeCollection</CODE> function allows you to remove multiple items from a collection. You provide this function with a collection and a set of attribute values, and it removes any items in the collection whose attributes match these values. You specify which attributes to examine in the second parameter of this function, and you specify the values to compare those attributes against in the third parameter, as shown in<BR> <A HREF=#MARKER-9-76>Listing 5-14</A>.<P>
<B>Listing 5-14  <A NAME=MARKER-9-76></A>Removing multiple items with specific attributes</B><P>
<PRE>
long whichAttributes, attributeValues;
.
.
.
/* specify which attributes to examine: user 0 and user 1 */
whichAttributes = collectionUser0Mask 
                  | collectionUser1Mask;
/* specify the values to test for: user 0 set and user 1 clear */
attributeValues = collectionUser0Mask 
                  &amp; ~collectionUser1Mask; 

/* purge all items with user 0 attribute set and user 1 clear */
PurgeCollection(pointsAndQuotes,
                whichAttributes, 
                attributeValues); 
</PRE>
 This example sets two bits in the <CODE>whichAttributes</CODE> variable--the user 0 attribute and the user 1 attribute--and clears every other bit in this variable, which signifies that the function should test only the user 0 attribute and the user 1 attribute. The <CODE>attributeValues</CODE> variable sets the user attribute 0 flag and clears the user attribute 1 flag. Therefore, this call to <CODE>PurgeCollection</CODE> removes every item in the collection that has the user 0 attribute set and the user 1 attribute clear. It ignores the values of all the other attributes.<P>
 You can use the <CODE>PurgeCollectionTag</CODE> function to remove all of the items in a collection that share a collection tag--even the locked items. To remove all the items with the collection tag <CODE>'GXPT'</CODE> from the <CODE>pointsAndQuotes</CODE> collection (which is defined in <A HREF=GXEnvironment-193.html#MARKER-9-43>"Adding Items to a Collection" beginning on page 5-17</A>), you could use this line of code:<P>
<PRE>
PurgeCollectionTag(pointsAndQuotes, 'GXPT'); 
</PRE>
 Finally, you can remove all of the items in a collection--even the locked items--using the <CODE>EmptyCollection</CODE> function:<P>
<PRE>
EmptyCollection(pointsAndQuotes); 
</PRE>
 For more information about identifying collection items, see <A HREF=GXEnvironment-187.html#MARKER-9-23>"Methods of Identifying Collection Items" on page 5-11</A>. <P>
 For more information about the <CODE>RemoveCollectionItem,</CODE> <CODE>RemoveIndexedCollectionItem</CODE>, <CODE>PurgeCollection</CODE>, <CODE>PurgeCollectionTag</CODE>, and <CODE>EmptyCollection</CODE> functions, see <A HREF=GXEnvironment-231.html#MARKER-9-170>"Removing Items From a Collection" beginning on page 5-65</A>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="GXEnvironment-198.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="GXEnvironment-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="GXEnvironment-445.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="GXEnvironment-200.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="GXEnvironment-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  

