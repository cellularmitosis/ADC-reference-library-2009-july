<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>EOModeler User Guide (Legacy): Modeling Inheritance</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Modeling Inheritance"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../Resources" />
	<meta name="ROBOTS" content="NOINDEX"/>
	<link rel="stylesheet" type="text/css" href="../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30001018-CH207" title="Modeling Inheritance"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../LegacyTechnologies/index.html#//apple_ref/doc/uid/TP30000440-TP30000470" target="_top">Legacy Documents</a> &gt; <a href="../../../LegacyTechnologies/Tools-date.html#//apple_ref/doc/uid/TP30000440-TP30000470-TP30000463" target="_top">Tools</a> &gt; <a href="../Introduction/Introduction.html#//apple_ref/doc/uid/TP30001018-CH201-TP1">EOModeler User Guide (Legacy)</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../6WorkingWithEntities/WorkingWithEntities.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../8WorkingWithFetchSpecifications/8WorkingWithFetchSpecs.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        <script type="text/javascript" language="JavaScript">placeWatermark()</script>
<div id="legacyOuterWrapper"><div align="center" id="watermark">
<div class="legacybox">
<h1>Legacy Document<span class="closebutton"><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>
        <a name="//apple_ref/doc/uid/TP30001018-CH207-TP1" title="Modeling Inheritance"></a><h1>Modeling Inheritance</h1><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_336"></a><p>One of the issues that may arise in designing your enterprise objects—whether you’re creating a schema from scratch or working with an existing database schema—is the modeling of inheritance relationships.</p><p>In object-oriented programming, it’s natural to think of data in terms of inheritance. A Customer object, for example, naturally inherits certain characteristics from a Person object, such as name, address, and phone number. In inheritance hierarchies, the parent object or superclass is usually rather generic so that less generic subclasses of a related type can easily be added. So, in addition to the Customer object, a Client object also naturally derives from a Person object.</p><p>While this kind of thinking is inherent in object-oriented design, relational databases have no explicit support for inheritance. However, using Enterprise Objects, you can build data models that reflect object hierarchies. That is, you can design database tables to support inheritance by also designing enterprise objects that map to multiple tables or particular views of a database table.</p><p>This chapter discusses when to use inheritance, the different kinds of inheritance supported by Enterprise Objects, and how to implement inheritance. It is divided into the following sections:</p><ul class="ul"><li class="li"><p><span class="content_text"><a href="7ModelingInheritance.html#//apple_ref/doc/uid/TP30001018-CH207-CACFDHEB">“Deciding to Use Inheritance”</a></span> discusses the issues involved when deciding to use inheritance.</p></li><li class="li"><p><span class="content_text"><a href="7ModelingInheritance.html#//apple_ref/doc/uid/TP30001018-CH207-CACEGJBA">“Vertical Mapping,”</a></span> <span class="content_text"><a href="7ModelingInheritance.html#//apple_ref/doc/uid/TP30001018-CH207-CACDGBAG">“Horizontal Mapping,”</a></span> and <span class="content_text"><a href="7ModelingInheritance.html#//apple_ref/doc/uid/TP30001018-CH207-CACBBGEB">“Single-Table Mapping”</a></span> discuss the three approaches to inheritance that are supported by the Enterprise Object technology.</p></li></ul><a name="//apple_ref/doc/uid/TP30001018-CH207-CACFDHEB" title="Deciding to Use Inheritance"></a><h2>Deciding to Use Inheritance</h2><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_337"></a><p>Using inheritance adds another level of complexity to your data model, data source, and thus to your application. While it has its advantages, you should use it only if you really need to. This section provides information that will help you make that decision.</p><p>Suppose you’re designing an application that includes Employee and Customer objects. Employees and customers share certain characteristics such as name and address, but they also have specialized characteristics. For example, an employee has a salary and a manager whereas a customer has account information and a sales contact.</p><p>Based on these data requirements, you might design a class hierarchy that has a Person superclass and Employee and Customer subclasses. As subclasses of Person, Employee and Customer inherit Person’s attributes (name and address), but they also implement attributes and behaviors that are specific to their classes, as illustrated in <span class="content_text">Figure 7-1</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP30001018-CH207-TPXREF135" title="Figure 6-1A simple object hierarchy"></a><p><strong>Figure 6-1&nbsp;&nbsp;</strong>A simple object hierarchy</p><img src = "../Art/inh_class_hierarchy.gif" alt = "A simple object hierarchy" width="459" height="271"></div><br/><p>In addition to designing a class hierarchy, you need to decide how to structure your data source so that when objects of the classes are instantiated, the appropriate data is retrieved. These are some of the issues you need to weigh in deciding on an approach:</p><ul class="ul"><li class="li"><p>Are fetches usually directed at the leaves or the root of the class hierarchy?</p><p>When a class hierarchy is mapped onto a relational database, data is accessed in two different ways: by fetching just the leaves (for example, Employee or Customer) or by fetching at the root (Person) to get instances of all levels of the class hierarchy (which includes Employees and Customers).</p></li><li class="li"><p>How deep is the class hierarchy?</p><p>While deep class hierarchies can be a useful technique in object-oriented programming, you should try to avoid them for enterprise objects. When you attempt to map a deep class hierarchy onto a relational database, the result is likely to be poor performance and a database that’s difficult to maintain.</p></li><li class="li"><p>What is the database storage cost for <code>null</code> attributes? </p><p>Some approaches to inheritance result in many <code>null</code> rows of data.</p></li><li class="li"><p>Will I need to modify my schema frequently?</p><p>Depending on the inheritance approach you take, changes to your database schema can result in maintenance headaches for your enterprise object classes.</p></li><li class="li"><p>Will other tools be accessing the database?</p><p>If other tools write to the data source to which an inheritance hierarchy maps, those tools may not write data in a way that supports the inheritance hierarchy. If this is the case, you should avoid using inheritance to prevent conflicts that may compromise the integrity of your data.</p></li><li class="li"><p>Can I ensure unique primary keys across inheritance hierarchies?</p><p>Within a given inheritance hierarchy, all the primary keys in all the tables must be unique. For example, a primary key value of 36 can occur <em>only</em> in one table in an inheritance hierarchy. This may be an issue if you want to apply an inheritance hierarchy to a collection of preexisting database tables that do not have unique primary keys between them.</p></li><li class="li"><p>Do I need to use inheritance at all?</p><p>Don’t use inheritance if you’re not sure you need it. While a compelling feature, inheritance adds complexity to your application and these costs may outweigh the benefits of using it. In short, use inheritance only if you <em>need</em> to—don’t use it just because you <em>want</em> to.</p></li></ul><p>In object-oriented programming, when a subclass inherits from a superclass, the instantiation of the subclass implies that all the superclass’ data is available for use by the subclass. When you instantiate objects of a subclass from database data, all the database tables that contain the data held in each class (whether subclass or superclass) must be accessed so that the data can be retrieved and put in the appropriate enterprise objects. </p><p>There are different approaches to storing the data in databases for entities that are a part of an inheritance hierarchy. <a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_338"></a>The three approaches supported by Enterprise Objects are</p><ul class="ul"><li class="li"><p>vertical mapping</p></li><li class="li"><p>horizontal mapping</p></li><li class="li"><p>single-table mapping</p></li></ul><p>These approaches, along with the advantages and disadvantages of each, are discussed in the following sections. None of them represents a perfect solution—which one is appropriate depends on the needs of your application. Also keep in mind that you can mix inheritance strategies within a model.</p><a name="//apple_ref/doc/uid/TP30001018-CH207-CACEGJBA" title="Vertical Mapping"></a><h2>Vertical Mapping</h2><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_339"></a><p>In this approach<a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_340"></a>, each class is associated with a separate table. There is a Person table, an Employee table, and a Customer table. Each table contains only the attributes defined by that class.</p><br/><div><a name="//apple_ref/doc/uid/TP30001018-CH207-TPXREF136" title="Figure 6-2Vertical mapping"></a><p><strong>Figure 6-2&nbsp;&nbsp;</strong>Vertical mapping</p><img src = "../Art/inh_vertical.gif" alt = "Vertical mapping" width="305" height="349"></div><br/><p>This method of storage directly reflects the class hierarchy. If an object of the Employee class is retrieved, data for the Employee’s Person attributes must be fetched along with Employee data. The relationship between Employee and Person is resolved through a join to give Employee access to its Person data. This is also the case for Customer. Vertical mapping requires a restricting qualifier<a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_341"></a><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_342"></a><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_343"></a> if you want to fetch records from a parent entity (Person in this example).</p><a name="//apple_ref/doc/uid/TP30001018-CH207-TPXREF126" title="Implementing Vertical Mapping in a Model"></a><h3>Implementing Vertical Mapping in a Model</h3><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_344"></a><p>Assuming that the entities for each of the participating tables do not yet exist, follow these steps to easily create subentities from a parent entity:</p><ol class="ol"><li class="li"><p>Select the entity you want to be the parent entity (the superclass).</p></li><li class="li"><p>To create a subentity of the parent entity, choose Create Subclass from the Property menu while the parent entity is selected. Provide a class name and table name for the subentity. In this example, two subentities are added to the model, Employee and Customer, which correspond to two tables you’ll create in the database called EMPLOYEE and CUSTOMER, respectively. The attributes a subentity inherits from its parent are displayed in italics, as shown in <span class="content_text">Figure 6-3</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001018-CH207-CACEGFJD" title="Figure 6-3Inherited attributes appear in italics"></a><p><strong>Figure 6-3&nbsp;&nbsp;</strong>Inherited attributes appear in italics</p><img src = "../Art/inherited_attributes.gif" alt = "Inherited attributes appear in italics" width="594" height="96"></div></li><li class="li"><p>In the Advanced Entity Inspector<a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_345"></a><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_346"></a><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_347"></a><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_348"></a>, mark the parent entity as abstract if you won’t ever instantiate Person objects, as shown in <span class="content_text">Figure 6-4</span>. </p><p>If you need to instantiate the parent entity (Person objects), however, don’t mark the parent entity as abstract. If you want to instantiate objects of the parent entity, you also need to assign a restricting qualifier<a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_349"></a> to it. You need to assign a restricting qualifier to any entity in a vertical inheritance hierarchy that is not abstract and that has subentities (leaf nodes). </p><p>This is necessary so you can fetch objects of the parent type without also fetching the characteristics of the parent’s subentities. That is, when fetching Person objects, you don’t also want to fetch attributes in Person’s subclasses, Employee and Customer. You do this by assigning a restricting qualifier to the Person entity. See <span class="content_text"><a href="7ModelingInheritance.html#//apple_ref/doc/uid/TP30001018-CH207-CACJFAHB">“Implementing a Restricting Qualifier”</a></span> to learn how to do this.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001018-CH207-CACFCIDJ" title="Figure 6-4Mark parent entities as abstract if they won&acirc;&#128;&#153;t ever be instantiated"></a><p><strong>Figure 6-4&nbsp;&nbsp;</strong>Mark parent entities as abstract if they won’t ever be instantiated</p><img src = "../Art/parent_entity_abstract.gif" alt = "Mark parent entities as abstract if they won’t ever be instantiated" width="264" height="392"></div></li></ol><p>Assuming that the entities for each of the participating tables already exist, do the following to implement vertical mapping in an EOModel:</p><ol class="ol"><li class="li"><p>Create a to-one relationship from each of the child entities (Employee and Customer) to the parent entity (Person) joining on the primary keys. Set the relationships so they are not class properties. Refer to <span class="content_text">Figure 6-5</span> for clarity.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001018-CH207-CACDDHDB" title="Figure 6-5To-one relationships to parent entity shown in inspector"></a><p><strong>Figure 6-5&nbsp;&nbsp;</strong>To-one relationships to parent entity shown in inspector</p><img src = "../Art/vmappkeys.gif" alt = "To-one relationships to parent entity shown in inspector" width="271" height="394"></div></li><li class="li"><p>Flatten the Person parent attributes into each child entity (Employee and Customer) and set the flattened attributes as class properties if they are class properties in the Person entity. Do not flatten the primary key. See <span class="content_text"><a href="../4WorkingWithAttributes/WorkingWithAttributes.html#//apple_ref/doc/uid/TP30001018-CH204-BABFBBFF">“Flattening an Attribute”</a></span> to learn how to flatten an attribute. </p><p>If you created the child entities by choosing Create Subclass from the Property menu, you now need to delete the attributes that are inherited from the parent entity. This is necessary to avoid redundancy since the attributes you just flattened reflect the same attributes as the inherited attributes do.</p><p><span class="content_text">Figure 6-6</span> shows the result of flattening Person’s attributes into the Employee entity. The flattened attributes appear in bold typeface in the table view.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001018-CH207-CACBGJHB" title="Figure 6-6Flattened attributes in table view"></a><p><strong>Figure 6-6&nbsp;&nbsp;</strong>Flattened attributes in table view</p><img src = "../Art/customerafterflat.gif" alt = "Flattened attributes in table view" width="451" height="98"></div></li><li class="li"><p>Flatten the Person parent entity’s relationships into each child entity (Employee and Customer) if it has any relationships, and set them as class properties if they are class properties in the Person entity. In this example, the Person entity has no relationships, so there are none to flatten into its child entities. In diagram view, the three entities should appear as in <span class="content_text">Figure 6-7</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001018-CH207-CACGBBIC" title="Figure 6-7Vertical inheritance hierarchy in diagram view"></a><p><strong>Figure 6-7&nbsp;&nbsp;</strong>Vertical inheritance hierarchy in diagram view</p><img src = "../Art/vinhdiagramview.gif" alt = "Vertical inheritance hierarchy in diagram view" width="485" height="112"></div></li><li class="li"><p>Set the parent entity for each child entity (Employee and Customer) to Person in the Advanced Entity Inspector<a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_350"></a><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_351"></a>. This step isn’t necessary if you created the Employee and Customer entities using the Create Subclass command from the Property menu.</p></li><li class="li"><p>Finally, add attributes to each child entity (Employee and Customer) that are specific to those entities (such as <code>manager</code> and <code>customerSince</code> in this case).</p></li><li class="li"><p>Generate SQL for the Employee and Customer entities to create the EMPLOYEE and CUSTOMER tables in the database.</p></li></ol><a name="//apple_ref/doc/uid/TP30001018-CH207-TPXREF127" title="Advantages of Vertical Mapping "></a><h3>Advantages of Vertical Mapping </h3><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_352"></a><p>With vertical mapping, a subclass can be added at any time without modifying the Person table. Existing subclasses can also be modified without affecting the other classes in the inheritance hierarchy. The primary virtue of this approach is its clean, “normalized” design.</p><a name="//apple_ref/doc/uid/TP30001018-CH207-TPXREF128" title="Disadvantages of Vertical Mapping "></a><h3>Disadvantages of Vertical Mapping </h3><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_353"></a><p>Vertical mapping is the least efficient of all the approaches. Every layer of the class hierarchy requires a join table to resolve the relationships. For example, if you want to perform a deep fetch from Person, three fetches are performed: a fetch from Employee (with a join to Person), a fetch from Customer (with a join to Person), and a fetch from Person to retrieve all the Person attributes. If Person is an abstract superclass for which no objects are ever instantiated, the last fetch is not performed<a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_354"></a>.</p><a name="//apple_ref/doc/uid/TP30001018-CH207-CACDGBAG" title="Horizontal Mapping"></a><h2>Horizontal Mapping</h2><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_355"></a><p>In this <a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_356"></a>approach, you have separate tables for Employee and Customer that each contain columns for Person. The Employee and Customer tables contain not only their own attributes, but all of the Person attributes as well. If instances of Person exist that are not classified as Employees or as Customers, a third table would be required. In other words, with horizontal mapping<a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_357"></a>, every concrete class has a self-contained database table that includes all of the attributes necessary to instantiate objects of the class.</p><br/><div><a name="//apple_ref/doc/uid/TP30001018-CH207-TPXREF137" title="Figure 6-8Horizontal inheritance mapping"></a><p><strong>Figure 6-8&nbsp;&nbsp;</strong>Horizontal inheritance mapping</p><img src = "../Art/inh_horizontal.gif" alt = "Horizontal inheritance mapping" width="305" height="297"></div><br/><p>This mapping technique entails the same fetching pattern as vertical mapping except that no joins are performed. Horizontal mapping does not require restricting<a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_358"></a><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_359"></a> qualifiers.</p><a name="//apple_ref/doc/uid/TP30001018-CH207-TPXREF129" title="Implementing Horizontal Mapping in a Model"></a><h3>Implementing Horizontal Mapping in a Model</h3><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_360"></a><p>Assuming that the entities for each of the participating tables do not yet exist, follow these steps to easily create subentities from a parent entity:</p><ol class="ol"><li class="li"><p>Select the entity you want to be the parent entity (the superclass).</p></li><li class="li"><p>To create a subentity of the parent entity, chose Create Subclass from the Property menu while the parent entity is selected. Provide a class name and table name for the subentity. Refer to <span class="content_text"><a href="7ModelingInheritance.html#//apple_ref/doc/uid/TP30001018-CH207-TPXREF126">“Implementing Vertical Mapping in a Model”</a></span> for a more concrete example.</p></li><li class="li"><p>In the Advanced Entity Inspector, mark the parent entity as abstract if you won’t ever instantiate Person objects, as shown in <span class="content_text"><a href="7ModelingInheritance.html#//apple_ref/doc/uid/TP30001018-CH207-CACFCIDJ">Figure 6-4</a></span>. Refer to <span class="content_text"><a href="7ModelingInheritance.html#//apple_ref/doc/uid/TP30001018-CH207-TPXREF126">“Implementing Vertical Mapping in a Model”</a></span> for a more concrete example.</p></li><li class="li"><p>Add attributes to each child entity (Employee and Customer) that are specific to those entities (such as <code>manager</code> and <code>customerSince</code> in this case).</p></li><li class="li"><p>Generate SQL for the Employee and Customer entities to create the EMPLOYEE and CUSTOMER tables in the database.</p></li></ol><p>Unlike vertical mapping, you don’t need to flatten any of Person’s attributes into Employee and Customer since they already include all of its attributes.</p><a name="//apple_ref/doc/uid/TP30001018-CH207-TPXREF130" title="Advantages of Horizontal Mapping "></a><h3>Advantages of Horizontal Mapping </h3><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_361"></a><p>Similar to vertical mapping, a subclass can be added at any time without modifying other tables. Existing subclasses can also be modified without affecting the other classes in the class hierarchy.</p><p>This approach works well for deep class hierarchies as long as the fetch occurs against the leaves of the class hierarchy (Employee and Customer) rather than against the root (Person). In the case of a deep fetch, horizontal mapping is more efficient than vertical mapping since no joins are performed. It’s the most efficient mapping approach if you fetch instances of only one leaf subclass at a time.</p><a name="//apple_ref/doc/uid/TP30001018-CH207-TPXREF131" title="Disadvantages of Horizontal Mapping"></a><h3>Disadvantages of Horizontal Mapping</h3><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_362"></a><p>Problems may occur when attributes need to be added to the Person superclass. The number of tables that need to be altered is equal to the number of subclasses—the more subclasses you have, the more effort is required to maintain the superclass.</p><p>If, for example, you need to add an attribute called <code>middleName</code> to the Person class, you then need to alter its subclasses, Employee and Customer. So if you have deep inheritance hierarchies or many subclasses, this can be tedious. However, if table maintenance happens far less often than fetches, this might be a viable approach for your application<a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_363"></a>.</p><a name="//apple_ref/doc/uid/TP30001018-CH207-CACBBGEB" title="Single-Table Mapping"></a><h2>Single-Table Mapping</h2><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_364"></a><p>With single-table mapping<a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_365"></a>, you put all of the data in one table that contains all superclass and subclass attributes. Each row contains all of the columns for the superclass as well as for all of the subclasses. The attributes that don’t apply for each object have <code>null</code> values. You fetch an Employee or Customer by using a query that returns just objects of the specified type (the table includes a type column to distinguish records of one type from the other).</p><br/><div><a name="//apple_ref/doc/uid/TP30001018-CH207-TPXREF138" title="Figure 6-9Single-table inheritance mapping"></a><p><strong>Figure 6-9&nbsp;&nbsp;</strong>Single-table inheritance mapping</p><img src = "../Art/inh_single_table.gif" alt = "Single-table inheritance mapping" width="252" height="289"></div><br/><a name="//apple_ref/doc/uid/TP30001018-CH207-TPXREF132" title="Implementing Single-Table Mapping in a Model"></a><h3>Implementing Single-Table Mapping in a Model</h3><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_366"></a><p>Assuming that the entities for each of the participating tables do not yet exist, follow these steps to easily create subentities from a parent entity:</p><ol class="ol"><li class="li"><p>Select the entity you want to be the parent entity (the superclass).</p></li><li class="li"><p>Add an attribute to the parent entity called “type” of External Type <code>int</code> and of Internal Data Type Integer. This serves to distinguish each row of data by type. Make this attribute a class property so you can set its value when you insert new objects. Also make sure to add the corresponding column in the database table.</p></li><li class="li"><p>To create a subentity of the parent entity, choose Create Subclass from the Property menu while the parent entity is selected. Provide a class name and table name for the subentity. Refer to <span class="content_text"><a href="7ModelingInheritance.html#//apple_ref/doc/uid/TP30001018-CH207-TPXREF126">“Implementing Vertical Mapping in a Model”</a></span> for a more concrete example.</p></li><li class="li"><p>In the Advanced Entity Inspector, mark the parent entity as abstract if you won’t ever instantiate Person objects, as shown in <span class="content_text"><a href="7ModelingInheritance.html#//apple_ref/doc/uid/TP30001018-CH207-CACFCIDJ">Figure 6-4</a></span>.</p></li><li class="li"><p>In the Advanced Entity Inspector, assign a restricting qualifier<a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_367"></a> to the Employee entity that distinguishes its rows from the rows of other entities. Similarly, assign a restricting qualifier to the Customer entity. In this example, you can use <code>type = 2</code> for Customer and <code>type = 9</code> for Employee. (In <span class="content_text"><a href="7ModelingInheritance.html#//apple_ref/doc/uid/TP30001018-CH207-CACJFAHB">“Implementing a Restricting Qualifier”</a></span> you’ll learn why those two integers are used in this example.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001018-CH207-CACHFJGH" title="Figure 6-10Assign a restricting qualifier"></a><p><strong>Figure 6-10&nbsp;&nbsp;</strong>Assign a restricting qualifier</p><img src = "../Art/rqualifier.gif" alt = "Assign a restricting qualifier" width="266" height="169"></div></li></ol><p>Unlike vertical mapping, you don’t need to flatten any of Person’s attributes into Employee and Customer since these entities already have all of Person’s attributes. Each subentity maps to the same table and contains attributes only for the properties that are relevant for that class. </p><p>When multiple entities are mapped to a single database table, you must set a restricting qualifier<a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_368"></a> on each entity to distinguish its rows from the rows of other entities. A restricting qualifier maps an entity to a subset of rows in a table. This means that this qualifier is always used when fetches are performed on the entity, as well as any other qualifiers used during the fetch. </p><p>The syntax and semantics for restricting qualifiers<a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_369"></a> are the same as for the qualifiers you build in EOModeler. You can use the qualifier builder feature of the fetch specification builder to generate well-formed qualifiers. See <span class="content_text"><a href="../8WorkingWithFetchSpecifications/8WorkingWithFetchSpecs.html#//apple_ref/doc/uid/TP30001018-CH208-BABBCFFB">“Building a Qualifier.”</a></span></p><a name="//apple_ref/doc/uid/TP30001018-CH207-CACJFAHB" title="Implementing a Restricting Qualifier"></a><h3>Implementing a Restricting Qualifier</h3><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_370"></a><p>Finally, for the restricting qualifier to do any good, you need to provide a value for the <code>type</code> attribute you added in step 2 for each object you insert (that is, for each record you add to the table). The restricting qualifier uses the <code>type</code> attribute, so this example assumes that. (If you use an attribute with a different name to identify rows of data in the table, make the necessary substitutions in this example.)</p><p>To provide a value for the <code>type</code> attribute for every new object that is inserted in an inheritance hierarchy, you need to:</p><ul class="spaceabove"><li class="li"><p>define constants for each type</p></li><li class="li"><p>override <code>awakeFromInsertion</code> in a parent enterprise object class</p></li><li class="li"><p>set the type in <code>awakeFromInsertion</code></p></li><li class="li"><p>return a type in each enterprise object subclass</p></li></ul><p>Consider the Person enterprise object parent class. It is an abstract class that has two concrete subclasses, Employee and Customer. You need to provide constants in the Person class to identify these two subclasses:</p><div class="codesample"><table><tr><td scope="row"><pre>public static final Integer CustomerUserType = new Integer(2);<span></span></pre></td></tr><tr><td scope="row"><pre>public static final Integer EmployeeUserType = new Integer(9);<span></span></pre></td></tr></table></div><p>Then, you need to override <code>awakeFromInsertion</code> in the Person subclasses to set the type for each inserted record. An example appears in <span class="content_text">Listing 6-1</span>.</p><a name="//apple_ref/doc/uid/TP30001018-CH207-CACEEFEI" title="Listing 6-1Set type in awakeFromInsertion"></a><p class="codesample"><strong>Listing 6-1&nbsp;&nbsp;</strong>Set type in <code>awakeFromInsertion</code></p><div class="codesample"><table><tr><td scope="row"><pre>public void awakeFromInsertion (EOEditingContext editingContext) {<span></span></pre></td></tr><tr><td scope="row"><pre>    super.awakeFromInsertion(context);<span></span></pre></td></tr><tr><td scope="row"><pre>    setType(_userType());<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>A subclass (such as Employee or Customer in this example) must implement the <code>_userType</code> method to return an Integer representing the object’s type:</p><div class="codesample"><table><tr><td scope="row"><pre>Integer _userType() {<span></span></pre></td></tr><tr><td scope="row"><pre>    return CustomerUserType;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p><span class="content_text">Listing 6-1</span> assumes that the entity corresponding to the enterprise object class in which the method <code>awakeFromInsertion</code> exists includes an attribute named “type” that is a class property. So whenever a new enterprise object is created, its <code>type</code> attribute is automatically set to the name of the class. </p><p>So if the name of the class is Customer, the <code>type</code> attribute is set to the integer 2 as soon as the object is created. Then, when a fetch is performed on the Customer entity (which is performed on the Person table since only one table exists in the database for the objects in this inheritance hierarchy), the restricting qualifier helps to return only those records whose type is “Customer.”</p><p>See the WebObjects Examples (<code>/Developer/Examples/JavaWebObjects/</code>) for a real implementation of this and the other types of inheritance. </p><a name="//apple_ref/doc/uid/TP30001018-CH207-TPXREF133" title="Advantages of Single-Table Mapping"></a><h3>Advantages of Single-Table Mapping</h3><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_371"></a><p>This approach is faster than the other two methods for deep fetches. Unlike vertical or horizontal mapping, you can retrieve superclass objects with a single fetch, without performing joins. Adding a subclass or modifying the superclass requires changes to just one table.</p><a name="//apple_ref/doc/uid/TP30001018-CH207-TPXREF134" title="Disadvantages of Single-Table Mapping"></a><h3>Disadvantages of Single-Table Mapping</h3><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_372"></a><p>Single-table mapping results in tables that have columns for all of the attributes of each entity in the inheritance hierarchy. It also results in many <code>null</code> row values. While these aren’t really disadvantages, they may conflict with some database design philosophies<a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_373"></a><a name="//apple_ref/doc/uid/TP30001018-CH207-DontLinkElementID_374"></a>.</p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../6WorkingWithEntities/WorkingWithEntities.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../8WorkingWithFetchSpecifications/8WorkingWithFetchSpecs.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2002, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-05-23<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/WebObjects/UsingEOModeler/7ModelingInheritance/7ModelingInheritance.html%3Fid%3DTP30001018-2.2&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/WebObjects/UsingEOModeler/7ModelingInheritance/7ModelingInheritance.html%3Fid%3DTP30001018-2.2&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/WebObjects/UsingEOModeler/7ModelingInheritance/7ModelingInheritance.html%3Fid%3DTP30001018-2.2&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>