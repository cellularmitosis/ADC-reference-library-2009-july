<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>ASPGetStatus(IM:N)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING219></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Networking-218.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Networking-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Networking-304.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt= "Book Index"></A> <A HREF="Networking-220.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Networking-2.html"><B>Networking</B></A> / <BR><DD><A HREF="Networking-204.html"><B>Chapter 8 - AppleTalk Session Protocol (ASP)</B></A> / <A HREF="Networking-206.html"><B>ASP Reference</B></A><BR><DL><DD><A HREF="Networking-209.html"><B>Routines</B></A> / <A HREF="Networking-217.html"><B>Obtaining Information About ASP's Maximum Capacities and the Status of the Server</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING219-0></A>
<H3>ASPGetStatus</H3>
 <A NAME=MARKER-11-103></A><A NAME=MARKER-2-40></A>The <A NAME=MARKER-2-17></A><CODE>ASPGetStatus</CODE> function returns status information about the server whose internet socket address you provide. <P>
<PRE>
FUNCTION ASPGetStatus (thePBptr: XPPParmBlkPtr; 
                       async: Boolean): OSErr;
</PRE>
<DL>
<DT><CODE>thePBptr</CODE>
<DD> A pointer to an XPP parameter block.
<DT><CODE>async</CODE>
<DD> A Boolean that specifies whether the function should be executed asynchronously or synchronously. Specify <CODE>TRUE</CODE> for asynchronous execution.
</DL>
<B>
<TABLE BORDER="0" CELLPADDING=3><TD>--><TD>ioCompletion<TD>ProcPtr<TD>A pointer to a completion routine.<TR>
<TD><--<TD>ioResult<TD>OSErr<TD>The function result. <TR>
<TD>--><TD>ioRefNum<TD>Integer<TD>The .XPP driver reference number.<TR>
<TD>--><TD>csCode<TD>Integer<TD>Always getStatus for this function.<TR>
<TD>--><TD>aspTimeout<TD>Byte<TD>The retry interval in seconds.<TR>
<TD>--><TD>aspRetry<TD>Byte<TD>The number of retries.<TR>
<TD>--><TD>serverAddr<TD>AddrBlock<TD>The server socket address<EM>.</EM><TR>
<TD><-><TD>rbSize<TD>Integer<TD>The reply buffer and reply size.<TR>
<TD>--><TD>rbPtr<TD>Ptr<TD>A pointer to the reply buffer.<TR>
<TD><--<TD>ccbStart<TD>Array<TD>The beginning of memory for the CCB.</TABLE>
</B><P>
<DL>
<H5>Field Description</H5>
<DT><CODE>aspTimeout</CODE>
<DD> The time in seconds after which ASP is to retry to obtain information about the status of the server whose address <BR>you provide. 
<DT><CODE>aspRetry</CODE>
<DD> The number of times ASP is to retry to obtain the server status information.
<DT><CODE>serverAddr</CODE>
<DD> The internet socket address of the server about which you want status information. 
<DT><CODE>rbSize</CODE>
<DD> On input, the size in bytes of the buffer that you allocated to contain the reply that you expect to receive from the server. On return, the size in bytes of the reply (status) data that was actually returned. 
<DT><CODE>rbPtr</CODE>
<DD> A pointer to the buffer for the reply data. 
<DT><CODE>ccbStart</CODE>
<DD> The beginning of the memory for the command control block (CCB) that the .XPP driver is to use. The memory allocated for the CCB must not exceed the maximum of 150 bytes.<CODE> </CODE>
</DL>
<A NAME=HEADING219-12></A>
<H5>DESCRIPTION</H5>
 You can use the <CODE>ASPGetStatus</CODE> function to obtain service status information about a server without opening a session between your application and that server. ASP does not impose any structure on the status block. The protocol above ASP defines the structure. The .XPP driver uses the memory at the end of the XPP parameter block defined as <BR>a <CODE>CCBStart</CODE> array as an internal command control block (CCB). To ensure that the function executes successfully, you can specify the maximum size for this array as indicated in particular for the function that uses it. If you want to limit the amount of memory used for the CCB, you can specify the minimum amount of memory required for this array. <P>
<A NAME=HEADING219-14></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 Note that you must provide the .XPP driver reference number as an input parameter <BR>to this function. You can obtain the driver reference number by calling the Device Manager's <CODE>OpenDriver</CODE> function. <P>
<A NAME=HEADING219-16></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 To execute the <CODE>ASPGetStatus</CODE> function from assembly language, call the <CODE>_Control</CODE> trap macro with a value of <CODE>getStatus</CODE> in the <CODE>csCode</CODE> field of the parameter block. <BR>You must also specify the .XPP driver reference number. To execute the <CODE>_Control</CODE> <BR>trap asynchronously, include the value <CODE>,ASYNC</CODE> in the operand field.<A NAME=MARKER-2-101></A><P>
<A NAME=HEADING219-18></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>aspBufTooSmall<TD>-1067<TD>The reply data exceeds the size of the reply buffer; the .XPP driver will fill the buffer and truncate the data<TR>
<TD>aspNoServer<TD>-1069<TD>There was no response from the server whose address you specified as the value of <CODE>serverAddr</CODE></TABLE>
 </H5>
<A NAME=HEADING219-19></A>
<H5>SEE ALSO</H5>
 To determine the minimum amount of memory required for the CCB, refer to the description of the <CODE>ASPUserCommand</CODE> function on <A HREF=Networking-215.html#MARKER-9-68>page 8-15</A>.<A NAME=MARKER-2-75></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Networking-218.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Networking-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Networking-304.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt= "Book Index"></A> <A HREF="Networking-220.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Networking-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
