<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML EXPERIMENTAL 970324//EN">
<HTML>
<HEAD>
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter">
<script language="JavaScript" src="frametest.js"></script>
<TITLE> TECSniffTextEncoding </TITLE><LINK REL="stylesheet" TYPE="text/css" HREF="../../../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../../../Resources/JavaScript/page.js"></script>
</head>
<body bgcolor="#ffffff">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>

<DIV>
<a name="top"></a>
<!-- start of header -->
<!--#include virtual="/includes/framesetheader" -->
<!-- end of header --><A HREF="TEC.53.html"><img src="images/up.gif" border="0" alt="Up"></A><nobr>&nbsp;</nobr><A HREF="TEC.56.html"><img src="images/previous.gif" border="0" alt="Previous"></A><nobr>&nbsp;</nobr><A HREF="TEC.58.html"><img src="images/next.gif" border="0" alt="Next"></A><nobr>&nbsp;</nobr>
<!-- insert Show/Hide frames -->
<a href="javascript:testFrame()">
<script>
<!--
document.write(frameLink);
//	-->
</script><!-- end Show/Hide frames --></A><br>
<font face="Geneva,Helvetica,Arial" size="1"><b><br>
		PATH<spacer type="horizontal" size="5">&nbsp;</b></font><a href="../../../mac8.html"><font face="Geneva,Helvetica,Arial" size="1">Mac OS 8 and 9 Developer Documentation</a>  <b>&gt;</b> Text Encoding Conversion Manager<br>
		<img src="images/im_smblue.gif" width="116" height="8"><img src="images/space.gif" width="6" height="11">Programming With the Text Encoding Conversion Manager</font><br>
		<br>
		<hr>

</DIV>
<H1>
<A NAME="pgfId=15923">
 </A>
<A NAME="31559">
 </A>
TECSniffTextEncoding </H1>
<P>
<A NAME="pgfId=15924">
 </A>
Sniffs a text stream of unknown encoding, based on an array of possible encodings, and returns the probable encodings in a ranked list.</P>
<TT>
<A NAME="pgfId=31532">
 </A>
pascal OSStatus TECSniffTextEncoding (<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TECSnifferObjectRef encodingSniffer, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TextPtr inputBuffer, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteCount inputBufferLength, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TextEncoding testEncodings[], <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ItemCount numTextEncodings, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ItemCount numErrsArray[], <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ItemCount maxErrs, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ItemCount numFeaturesArray[], <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ItemCount maxFeatures);</TT>
<DL COMPACT>
<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=31536">
 </A>
<TT>encodingSniffer</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=15927">
 </A>
 A pointer to a sniffer object. </DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=31547">
 </A>
<TT>inputBuffer</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=17398">
 </A>
The text to be sniffed.</DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=31556">
 </A>
<TT>inputBufferLength</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=16937">
 </A>
 The length of the input buffer.</DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=31566">
 </A>
<TT>testEncodings[]</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=15931">
 </A>
 An array of text encoding specifications. On input, you must specify which text encodings you want to sniff for. On output, this array contains the input array rearranged in the order of most likely to least likely text encodings.</DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=31576">
 </A>
<TT>numTextEncodings</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=15935">
 </A>
 A value of type <TT>ItemCount</TT>. This value refers to the number of entries in the <TT>testEncodings[]</TT> parameter. </DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=31586">
 </A>
<TT>numErrsArray[]</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=15936">
 </A>
 An array of type <TT>ItemCount</TT>. This array must contain at least <TT>numTextEncodings</TT> elements. On return, <TT>numErrsArray</TT> holds the number of errors found for each possible text encoding. The entries are in the same order as the entries in the <TT>testEncodings[]</TT> parameter at output.</DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=31596">
 </A>
<TT>maxErrs</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=18959">
 </A>
The maximum number of errors allowed for a sniffer. The sniffer stops sniffing an encoding after this number is reached when creating the <TT>numErrsArray</TT> list.</DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=31605">
 </A>
<TT>numFeaturesArray[]</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=23035">
 </A>
 An array of type <TT>ItemCount</TT>. This array must contain at least <TT>numTextEncodings</TT> elements. On return, the <TT>numFeaturesArray[]</TT> parameter holds the number of features found for each possible text encoding. The entries are in the same order as the entries in the <TT>testEncodings[]</TT> parameter at output.</DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=31615">
 </A>
<TT>maxFeatures</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=16956">
 </A>
The maximum number of features allowed for a sniffer. The sniffer stops sniffing an encoding after this number is reached when creating the <TT>numFeaturesArray</TT> list.</DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=31624">
 </A>
<I CLASS="italics">
function result</I>
</DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=16958">
 </A>
A result code. See <A HREF="TEC.20.html" CLASS="XRef">
Text Encoding Conversion Manager Result Codes</A>
 for a list of possible values. If this function returns a result code other than <TT>noErr</TT>, then one of the conversion plug-ins accessed by the converter encountered an error condition while accessing a sniffer function. </DD><P>

</DL COMPACT>
<DIV>
<H5 CLASS="RSb.RoutineSbhd">
<A NAME="pgfId=15937">
 </A>
DISCUSSION</H5>
<P>
<A NAME="pgfId=19084">
 </A>
For a specified stream of bytes in an unknown encoding and an array of possible encodings, <TT>TECSniffTextEncoding</TT> returns counts of &quot;errors&quot; and &quot;features&quot; for each of the encodings. Each error indicates a code point or sequence that is illegal in the specified encoding, and a feature indicates the presence of a sequence that is characteristic of that encoding. <A HREF="TEC.57.html#36145" CLASS="XRef">
Table&nbsp;3-1</A>
 shows sample output from a sniffer run.</P>
<TABLE BORDER="1" CELLPADDING="3">

<P>
<A NAME="pgfId=19125">
 </A>
<B>Table&nbsp;3-1&nbsp;<A NAME="36145">
 </A>
Sample Sniffer Output</B></P>
</B>
<TR>
<TH ALIGN = "Left" ROWSPAN="1" COLSPAN="1">
<P>
<A NAME="pgfId=19155">
 </A>
Encoding</P>
</TH>
<TH ALIGN = "Left" ROWSPAN="1" COLSPAN="1">
<P>
<A NAME="pgfId=19157">
 </A>
Errors</P>
</TH>
<TH ALIGN = "Left" ROWSPAN="1" COLSPAN="1">
<P>
<A NAME="pgfId=19159">
 </A>
Features</P>
</TH>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<FONT CLASS="TbT.TblText">
<A NAME="pgfId=19161">
 </A>
EUC</FONT>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<FONT CLASS="TbT.TblText">
<A NAME="pgfId=19163">
 </A>
0</FONT>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<FONT CLASS="TbT.TblText">
<A NAME="pgfId=19165">
 </A>
8</FONT>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<FONT CLASS="TbT.TblText">
<A NAME="pgfId=19167">
 </A>
JIS</FONT>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<FONT CLASS="TbT.TblText">
<A NAME="pgfId=19169">
 </A>
0</FONT>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<FONT CLASS="TbT.TblText">
<A NAME="pgfId=19171">
 </A>
0</FONT>
</TD>
</TR>
<TR>
<TD ROWSPAN="1" COLSPAN="1">
<FONT CLASS="TbT.TblText">
<A NAME="pgfId=19173">
 </A>
Mac&nbsp;OS Japanese</FONT>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<FONT CLASS="TbT.TblText">
<A NAME="pgfId=19175">
 </A>
20</FONT>
</TD>
<TD ROWSPAN="1" COLSPAN="1">
<FONT CLASS="TbT.TblText">
<A NAME="pgfId=19177">
 </A>
20</FONT>
</TD>
</TR>
</TABLE>
<P>
<A NAME="pgfId=16907">
 </A>
For example, the byte sequence which is interpreted in Mac&nbsp;OS Roman as &quot;&auml;&oslash;&eacute;&ouml;&quot; could legally be interpreted either as Mac&nbsp;OS Roman text or as Mac&nbsp;OS Japanese text. Both sniffers would return zero errors, but the Mac&nbsp;OS Japanese sniffer would also return two features of Mac&nbsp;OS Japanese (representing two legal 2-byte characters.)<P>


<A NAME="pgfId=16909">
 </A>
The arrays are returned in a ranked list with the most likely text encodings first. The results are sorted first by number of errors (fewest to most), then by number of features (most to fewest), and then by the original order in the list. Upon return from the function, you can assume the correct encoding is in <TT>testEncodings[0]</TT>, or possibly <TT>testEncodings[1]</TT>.<P>


<A NAME="pgfId=15942">
 </A>
If any of the available encodings are not examined, their number of errors and number of features are set to 0xFFFFFFFF, and they sort to the end of the list.</P>
</DIV>
<DIV>
<H5 CLASS="RSb.RoutineSbhd">
<A NAME="pgfId=15946">
 </A>
SEE ALSO</H5>
<P>
<A NAME="pgfId=19208">
 </A>
The function <A HREF="TEC.54.html" CLASS="XRef"><TT>TECCountAvailableSniffers</TT></A><P>


<A NAME="pgfId=19216">
 </A>
The function <A HREF="TEC.55.html" CLASS="XRef"><TT>TECGetAvailableSniffers</TT></A> <P>


<A NAME="pgfId=19224">
 </A>
The function <A HREF="TEC.56.html" CLASS="XRef"><TT>TECCreateSniffer</TT></A> </P>
</DIV>
<HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 13 Dec 99)<P><A HREF="TEC.53.html"><img src="images/up.gif" border="0" alt="Up"></A><nobr>&nbsp;</nobr><A HREF="TEC.56.html"><img src="images/previous.gif" border="0" alt="Previous"></A><nobr>&nbsp;</nobr><A HREF="TEC.58.html"><img src="images/next.gif" border="0" alt="Next"></A><nobr>&nbsp;</nobr>
<!-- insert Show/Hide frames -->
<a href="javascript:testFrame()">
<script>
<!--
document.write(frameLink);
//	-->
</script><!-- end Show/Hide frames --></A>

<!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY>
</HTML>
