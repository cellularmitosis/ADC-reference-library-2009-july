<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Xcode 2.0 User Guide (Legacy): Linking</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Linking"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../../../../Resources" />
	<meta name="ROBOTS" content="NOINDEX"/>
	<link rel="stylesheet" type="text/css" href="../../../../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001440-CH233" title="Linking"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../../../../LegacyTechnologies/index.html#//apple_ref/doc/uid/TP30000440-TP30000470" target="_top">Legacy Documents</a> &gt; <a href="../../../../../../../LegacyTechnologies/Tools-date.html#//apple_ref/doc/uid/TP30000440-TP30000470-TP30000463" target="_top">Tools</a> &gt; <a href="../intro/intro.html#//apple_ref/doc/uid/TP40001440-CH276-DontLinkElementID_339">Xcode 2.0 User Guide (Legacy)</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../bs_building_product/bs_building_product.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../bs_speed_up_build/bs_speed_up_build.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        <script type="text/javascript" language="JavaScript">placeWatermark()</script>
<div id="legacyOuterWrapper"><div align="center" id="watermark">
<div class="legacybox">
<h1>Legacy Document<span class="closebutton"><a href="javascript:closeWatermark()"><img src="../../../../../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>
        <a name="//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_265" title="Linking"></a><h1>Linking</h1><p>The Link Binary With Libraries build phase
in Xcode projects links frameworks and libraries with object files
to produce a binary file. Source files that use code in a framework or
a library must include a reference to the appropriate programming
interface contained in them.</p>
<p>Libraries and frameworks are linked to object files when building
an executable file. However, this process is slow and can detract
from the development experience. Xcode provides a feature, called
ZeroLink, that eliminates the link step while you work on a project;
see <span class="content_text"><a href="bs_linking.html#//apple_ref/doc/uid/TP40001440-CH233-CHDCEHDD">“Using ZeroLink”</a></span> for details.</p>


<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="bs_linking.html#//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_45">Specifying the Search Order of External Symbols</a>
				
			<br/>
			
        
			
			
				<a href="bs_linking.html#//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_46">Preventing Prebinding</a>
				
			<br/>
			
        
			
			
				<a href="bs_linking.html#//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_47">Linking With System Frameworks</a>
				
			<br/>
			
        
			
			
				<a href="bs_linking.html#//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_48">Linking to a Dynamic Library in a Nonstandard Location</a>
				
			<br/>
			
        
			
			
				<a href="bs_linking.html#//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_49">Reducing the Number of Exported Symbols</a>
				
			<br/>
			
        
			
			
				<a href="bs_linking.html#//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_50">Reducing Paging Activity</a>
				
			<br/>
			
        
			
			
				<a href="bs_linking.html#//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_51">Dead-Code Stripping</a>
				
			<br/>
			
        
			
			
				<a href="bs_linking.html#//apple_ref/doc/uid/TP40001440-CH233-CHDCEHDD">Using ZeroLink</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_45" title="Specifying the Search Order of External Symbols"></a><h2>Specifying the Search Order
of External Symbols</h2>
<p>The order in which frameworks and libraries are listed in
the Link Binary With Libraries build phase specifies the order in
which external symbols are resolved by the static linker at build
time and the dynamic linker at runtime. When either of the linkers
encounters an undefined external symbol, they look for the symbol
starting with the first framework or library listed in the build
phase.</p>
<p>When a program is built, the static linker replaces references
to external symbols with the addresses of the symbols in the referenced
libraries (this is called <strong>prebinding</strong>), or tells the dynamic
linker to resolve the references when a program is loaded or when
a symbol is referenced. Having the dynamic linker resolve references
to external symbols at runtime provides the most flexibility, as
a program can link with new versions of the symbols as they become
available. However, this approach is not recommended for all situations,
as linking with newer versions of a method or a function may cause
problems during a program&#8217;s execution.</p>
<p>In addition, how frameworks and libraries are listed in a Link
Binary With Libraries build phase, tells the static linker the approach
(or the semantics) to use when binding or resolving references to
external symbols defined in libraries.</p>
<p>Placing static libraries after dynamic libraries in the Link
Binary With Libraries build phase, ensures that the static linker
binds references to external symbols defined in static libraries
at build time, even when newer versions of the static libraries
the application originally was linked with are present in the user&#8217;s
system.</p>
<p>When static libraries are listed before a dynamic library
in the Link Binary With Libraries build phase, the static linker
doesn&#8217;t resolve references to symbols in those static libraries. Instead,
those symbols are resolved by the dynamic linker at runtime. This
may cause problems when the static libraries are updated, as the
application links to the new, potentially incompatible versions
of the symbols instead of the ones the developer intended.</p>
<p>For details on how symbols are resolved, see &#8220;Finding Imported
Symbols&#8221; in <span class="content_text"><!--a target="_top" -->&#8220;Executing Mach-O Files&#8221;<!--/a--></span> in <em><a href="../../../../../MachORuntime/index.html#//apple_ref/doc/uid/TP40000895" target="_top">Mac OS X ABI Mach-O File Format Reference</a></em> and the <code>ld</code> man
page.</p>
<a name="//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_46" title="Preventing Prebinding"></a><h2>Preventing Prebinding</h2>
<p>Mac OS X includes a prebinding mechanism used to speed-up
application launch in programs that link against dynamic libraries.
When a user installs an application or upgrades the operating system,
a prebinding agent links the application against new versions of
the dynamic libraries. Sometimes, however, you may want to prevent
this behavior for specific applications.</p>
<p>To link the binary file, framework, library, or plug-in, so
that prebinding is never done on it, you need to add the <code>-nofixprebinding</code> option
to the linker invocation. To do this, add <code>-nofixprebinding</code> to
the Other Linker Flags (OTHER_LDFLAGS) build setting. See the <code>ld</code> man page
for more information.</p>
<a name="//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_47" title="Linking With System Frameworks"></a><h2>Linking With System Frameworks</h2>
<p>When linking with system frameworks (located in <code>/System/Library/Frameworks</code>),
include only the umbrella header files in your source files and
link only with the appropriate umbrella framework for your application.
For example, in a Carbon application that uses the Address Book
framework, you would include the following line in the header files
of modules that access the Address Book programming interface:</p>
<div class="codesample"><table><tr><td scope="row"><pre>#include &lt;Carbon/Carbon.h&gt;<span></span></pre></td></tr></table></div>
<p>You would also add <code>AddressBook.framework</code> to
the list of files in the Frameworks &amp; Libraries build phase.</p>
<a name="//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_48" title="Linking to a Dynamic Library in a Nonstandard Location"></a><h2>Linking to a Dynamic Library
in a Nonstandard Location</h2>
<p>When you need to link with a custom version of a dynamic library
but don&#8217;t want to replace the standard version of the library,
you can use the <code>-dylib_file</code> option
of the linker to tell it where to find the nonstandard version of
the library. Just add <code>-dylib_file</code> <em>standard_library_path</em><code>:</code><em>nonstandard_library_path</em> to
the Other Linker Flags build setting, where <em>standard_library_path</em> is
the path to the standard library and <em>nonstandard_library_path</em> is
the path to the custom version of the library.</p>
<a name="//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_49" title="Reducing the Number of Exported Symbols"></a><h2>Reducing the Number of Exported
Symbols</h2>
<p>By default, Xcode builds binary files that export all their
symbols. To reduce the number of symbols you want to export from
a binary file, create an export file and set the Exported Symbols
File (EXPORTED_SYMBOLS_FILE) build setting to the name of the file.
For more information, see <span class="content_text"><a href="../../../../../../../Performance/Conceptual/CodeFootprint/Articles/ReducingExports.html#//apple_ref/doc/uid/20001864" target="_top">&#8220;Minimizing Your Exported Symbols&#8221;</a></span> in <em><a href="../../../../../../../Performance/Conceptual/CodeFootprint/index.html#//apple_ref/doc/uid/10000149i" target="_top">Code Size Performance Guidelines</a></em>.</p>
<a name="//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_50" title="Reducing Paging Activity"></a><h2>Reducing Paging Activity</h2>
<p>To help reduce your application&#8217;s paging activity at runtime,
you may specify an order file to the linker. You do this by setting
the Symbol Ordering Flags (SECTORDER_FLAGS) build setting to <code>-sectorder
__TEXT __text &lt;order_file&gt;</code>. For information
on order files, see <span class="content_text"><a href="../../../../../../../Performance/Conceptual/CodeFootprint/Articles/ImprovingLocality.html#//apple_ref/doc/uid/20001862" target="_top">&#8220;Improving Locality of Reference&#8221;</a></span> in <em><a href="../../../../../../../Performance/Conceptual/CodeFootprint/index.html#//apple_ref/doc/uid/10000149i" target="_top">Code Size Performance Guidelines</a></em>.</p>
<a name="//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_51" title="Dead-Code Stripping"></a><h2>Dead-Code Stripping</h2>
<p>The static linker (<code>ld</code>)
supports the removal of unused code and data blocks from executable
files. This process (known as dead-code stripping) helps reduce
the overall size of executables, which in turn improves performance
by reducing the memory footprint of the executable. It also allows
programs to link successfully in the situation where unused code
refers to an undefined symbol, something that would normally result
in a link error.</p>
<p>Dead-code stripping is not limited to removing only unused
functions and executable code from a binary. The linker also removes
any unused symbols and data that reside in data blocks. Such symbols
might include global variables, static variables, and string data among
others. </p>
<p>When dead-code stripping is enabled, the static linker searches
for code that is unreachable from an initial set of live symbols
and blocks. The initial list of live symbols and blocks may include
the following:</p>
<ul class="ul"><li class="li"><p>Symbols listed
in an exports file; alternatively, the symbols absent from a list
of items marked as <em>not</em> to be exported. For
dynamic libraries or bundles without an exports file, all global
symbols are part of the initial live list. See <span class="content_text"><a href="bs_linking.html#//apple_ref/doc/uid/TP40001440-CH233-BCIHHADB">“Preventing the Stripping of Unused Symbols”</a></span> for
more information.</p></li>
<li class="li"><p>The block representing the default entry point or the symbol
listed after the <code>-e</code> linker option,
either of which identifies the specific entry point for an executable.
See the <code>ld</code> man page for
more information on the <code>-e</code> option.</p></li>
<li class="li"><p>The symbol listed after the <code>-init</code> linker
option, which identifies the initialization routine for a shared
library. See the <code>ld</code> man
page for more information. </p></li>
<li class="li"><p>Symbols whose declaration includes the <code>used</code> attribute.
See <span class="content_text"><a href="bs_linking.html#//apple_ref/doc/uid/TP40001440-CH233-BCIHHADB">“Preventing the Stripping of Unused Symbols”</a></span> for more information.</p></li>
<li class="li"><p>Objective-C runtime data.</p></li>
<li class="li"><p>Symbols marked as being referenced dynamically (via the <code>REFERENCED_DYNAMICALLY</code> bit
in <code>/usr/include/mach-o/nlist.h</code>). </p></li></ul>
<a name="//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_52" title="Enabling Dead-Code Stripping in Your Project"></a><h3>Enabling Dead-Code Stripping
in Your Project</h3>
<p>To enable dead-code stripping in your project, you must pass
the appropriate command-line options to the linker. From Xcode,
you add these options in the Build pane of the target inspector;
otherwise, you must add these options to your makefile or build
scripts. <span class="content_text">Table 28-2</span> lists
the Xcode build settings that control dead-code stripping. Enabling
either of these build settings causes Xcode to build with the corresponding
linker option.</p><a name="//apple_ref/doc/uid/TP40001440-CH233-CHDIEJGA" title="Table 28-1Xcode build settings for dead stripping"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">
<caption class="tablecaption"><strong>Table 28-1&nbsp;&nbsp;</strong>Xcode build settings for dead stripping</caption>

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Linker option</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Build setting</p></th>
</tr>


<tr>
<td  scope="row"><p><code>-dead_strip</code></p></td>
<td ><p>Dead Code Stripping (DEAD_CODE_STRIPPING)</p></td>
</tr>
<tr>
<td  scope="row"><p><code>-no_dead_strip_inits_and_terms</code></p></td>
<td ><p>Don&#8217;t Dead-Strip Inits and Terms (PRESERVE_DEAD_CODE_INITS_AND_TERMS)</p></td>
</tr>

</table></div>
<p><span class="content_text">Table 28-1</span> lists the basic dead-code stripping options.</p>
<a name="//apple_ref/doc/uid/TP40001440-CH233-BCIBIAFA" title="Table 28-2Linker options for dead stripping"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">
<caption class="tablecaption"><strong>Table 28-2&nbsp;&nbsp;</strong>Linker options for dead stripping</caption>

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Linker option</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>-dead_strip</code></p></td>
<td ><p>Enables basic dead-code stripping by the linker. </p></td>
</tr>
<tr>
<td  scope="row"><p><code>-no_dead_strip_inits_and_terms</code></p></td>
<td ><p>Prevents all constructors and destructors from being
stripped when the <code>-dead_strip</code> option
is in effect, even if they are not live.</p></td>
</tr>

</table></div>
<p>You must recompile all object files using the compiler included
with Xcode 1.5 or later before dead-code stripping can be performed
by the linker. You must also compile the object files with the <code>-gfull</code> option
to ensure that the resulting binaries can be properly debugged.
In Xcode, change the value of the Level of Debug Symbols (GCC_DEBUGGING_SYMBOLS)
build setting to All Symbols (<code>-gfull</code>).</p>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_266" title="Note"></a><p><strong>Note:</strong>&nbsp;The
GCC compiler&#8217;s <code>-g</code> option
normally defaults to <code>-gused</code>,
which reduces the size of <code>.o</code> files
at the expense of symbol information. Although the <code>-gfull</code> option does
create larger <code>.o</code> files,
it often leads to smaller executable files, even without dead-code
stripping enabled. </p></div>
<a name="//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_53" title="Identifying Stripped Symbols"></a><h3>Identifying Stripped Symbols</h3>
<p>If you want to know what symbols were stripped by the static
linker, you can find out by examining the linker-generated load
map. This map lists all of the segments and sections in the linked
executable and also lists the dead-stripped symbols. To have the
linker generate a load map, add the <code>-M</code> option
to your linker command-line options. In Xcode, you can add this
option to the Other Linker Flags build setting. </p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_267" title="Note"></a><p><strong>Note:</strong>&nbsp;If
you are passing this option through the <code>cc</code> compiler
driver, make sure to pass this flag as <code>-Wl,-M</code> so
that it is sent to the linker and not the compiler. </p></div>
<a name="//apple_ref/doc/uid/TP40001440-CH233-BCIHHADB" title="Preventing the Stripping of Unused Symbols"></a><h3>Preventing the Stripping of
Unused Symbols</h3>
<p>If your executable contains symbols that you know should not
be stripped, you need to notify the linker that the symbol is actually
used. You must prevent the stripping of symbols in situations where
external code (such as plug-ins) use those symbols but local code
does not. </p>
<p>There are two ways to tell the linker not to dead strip a
symbol. You can include it in an exports file or mark the symbol
declaration explicitly. To mark the declaration of a symbol, you
include the <code>used</code> attribute
as part of its definition. For example, you would mark a function
as used by declaring it as follows:</p>
<div class="codesample"><table><tr><td scope="row"><pre>void MyFunction(int param1) __attribute__((used));<span></span></pre></td></tr></table></div>
<p>Alternatively, you can provide an exports list for your executable
that lists any symbols you expect to be used by plug-ins or other
external code modules. To specify an exports file from Xcode, use
the Exported Symbols File (EXPORTED_SYMBOLS_FILE) build setting;
enter the path, relative to the project directory, to the exports
file. To specify an exports file from the linker command line use
the <code>-exported_symbols_list</code>.
option. (You can also specify a list of symbols <em>not</em> to
export using the <code>-unexported_symbols_list</code> option.)</p>
<p>If you are using an exports list and building either a shared
library, or an executable that will be used with <code>ld</code>'s <code>-bundle_loader</code> flag,
you need to include the symbols for exception frame information
in the exports list for your exported C++ symbols. Otherwise, they
may be stripped. These symbols end with <code>.eh</code>;
you can view them with the <code>nm</code> tool.</p>
<a name="//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_54" title="Assembly Language Support"></a><h3>Assembly Language Support</h3>
<p>If you are writing assembly language code, the assembler now
recognizes some additional directives to preserve or enhance the
dead-stripping of code and data. You can use these directives to
flag individual symbols or entire sections of assembly code.</p>
<a name="//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_55" title="Preserving Individual Symbols"></a><h4>Preserving
Individual Symbols</h4>
<p>To prevent the dead stripping of an individual symbol, use
the <code>.no_dead_strip</code> directive.
For example, the following code prevents the specified string from
being dead stripped:</p>
<div class="codesample"><table><tr><td scope="row"><pre>.no_dead_strip _my_version_string<span></span></pre></td></tr><tr><td scope="row"><pre>.cstring<span></span></pre></td></tr><tr><td scope="row"><pre>_my_version_string:<span></span></pre></td></tr><tr><td scope="row"><pre>.ascii &quot;Version 1.1&quot;<span></span></pre></td></tr></table></div>
<a name="//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_56" title="Preserving Sections"></a><h4>Preserving
Sections</h4>
<p>To prevent an entire section from being dead stripped, add
the <code>no_dead_strip</code> attribute
to the section declaration. The following example demonstrates the
use of this attribute:</p>
<div class="codesample"><table><tr><td scope="row"><pre>.section __OBJC, __image_info, regular, no_dead_strip<span></span></pre></td></tr></table></div>
<p>You can also add the <code>live_support</code> attribute
to a section to prevent it from being dead stripped if it references
other code that is live. This attribute prevents the dead stripping
of some code that might actually be needed but not referenced in
a detectable way. For example, the compiler adds this attribute
to C++ exception frame information. In your code, you might use
the attribute as follows:</p>
<div class="codesample"><table><tr><td scope="row"><pre>.section __TEXT, __eh_frame, coalesced, no_toc+strip_static_syms+live_support<span></span></pre></td></tr></table></div>
<a name="//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_57" title="Dividing Blocks of Symbols"></a><h4>Dividing
Blocks of Symbols</h4>
<p>The <code>.subsections_via_symbols</code> directive
notifies the assembler that the contents of sections may be safely
divided into individual blocks prior to dead-code stripping. This
directive makes it possible for individual symbols to be stripped
out of a given section if they are not used. This directive applies
to all section declarations in your assembly file and should be
placed outside of any section declarations, as shown below:</p>
<div class="codesample"><table><tr><td scope="row"><pre>.subsections_via_symbols<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>; Section declarations...<span></span></pre></td></tr></table></div>
<p>If you use this directive, make sure that each symbol in the
section marks the beginning of a separate block of code. Implicit
dependencies between blocks of code might result in the removal
of needed code from the executable. For example, the following section contains
three individual symbols, but execution of the code at <code>_plus_three</code> ends
at the <code>blr</code> statement
at the bottom of the code block. </p>
<div class="codesample"><table><tr><td scope="row"><pre>.text<span></span></pre></td></tr><tr><td scope="row"><pre>.globl _plus_three<span></span></pre></td></tr><tr><td scope="row"><pre>_plus_three:<span></span></pre></td></tr><tr><td scope="row"><pre>addi r3, r3, 1<span></span></pre></td></tr><tr><td scope="row"><pre>.globl _plus_two<span></span></pre></td></tr><tr><td scope="row"><pre>_plus_two:<span></span></pre></td></tr><tr><td scope="row"><pre>addi r3, r3, 1<span></span></pre></td></tr><tr><td scope="row"><pre>.global _plus_one<span></span></pre></td></tr><tr><td scope="row"><pre>_plus_one:<span></span></pre></td></tr><tr><td scope="row"><pre>addi r3, r3, 1<span></span></pre></td></tr><tr><td scope="row"><pre>blr<span></span></pre></td></tr></table></div>
<p>If you were to use the <code>.subsections_via_symbols</code> directive
on this code, the assembler would permit the stripping of the symbols <code>_plus_two</code> and <code>_plus_one</code> if
they were not called by any other code. If this occurred, <code>_plus_three</code> would
no longer return the correct value because part of its code would
be missing. In addition, if <code>_plus_one</code> were
dead stripped, the code might crash as it continued executing into
the next block. </p>
<a name="//apple_ref/doc/uid/TP40001440-CH233-CHDCEHDD" title="Using ZeroLink"></a><h2>Using ZeroLink</h2>
<p>ZeroLink speeds application development time by eliminating
the link process from development builds. Instead, Xcode generates
an application stub that contains the full paths to the object files
that make up the application. At runtime, each object (<code>.o</code>)
file is linked as it&#8217;s needed. This works only when running your
application within Xcode. You cannot deploy applications using ZeroLink.</p>
<p>To turn ZeroLink on or off, use the ZeroLink (ZERO_LINK) build
setting. ZeroLink is enabled by default in the Development build
style. If you build with this build style, you automatically get
ZeroLink functionality. See <span class="content_text"><a href="../bs_build_styles/bs_build_styles.html#//apple_ref/doc/uid/TP40001440-CH230-CJAFDIGF">“Build Styles”</a></span> for more information
on using build styles. ZeroLink works only for native targets. </p>
<p>The following sections explain how you can customize ZeroLink
to further reduce application launch times and identify issues you
must keep in mind when using ZeroLink.</p>
<a name="//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_58" title="Customizing ZeroLink"></a><h3>Customizing ZeroLink</h3>
<p>ZeroLink postpones the linking of object files until the last
moment possible. However, there are some symbols that, by default,
are always resolved (that is, the corresponding object files are
linked against the application and the code is executed). These
symbols are static initializers in C++ and <code>+load</code> methods
and categories in Objective-C. You can tell ZeroLink not to search
the object files of your application for these symbols to reduce
the application&#8217;s launch time.</p>
<p>There are situations that require the initialization of objects
before a program&#8217;s <code>main</code> function
is called. For example, a class may declare global variables that
can be accessed by other code before the class has a chance to initialize
them. In Objective-C, the <code>+initialize</code> method
may be executed too late (see <span class="content_text"><!--a target="_top" -->&#8220;Initializing a Class Object&#8221;<!--/a--></span> in <em><a href="../../../../../../../Cocoa/Conceptual/ObjectiveC/index.html#//apple_ref/doc/uid/TP30001163" target="_top">The Objective-C 2.0 Programming Language</a></em>. The purpose of static initializers in C++ and <code>+load</code> methods
in Objective-C is to provide developers with a mechanism to initialize
variables at the earliest possible point during a program&#8217;s launch
process. In Objective-C&#8211;based applications, categories are also
loaded before <code>main</code> is
called.</p>
<p>When you build an application, the static linker adds the
standard entry-point function to the main executable file. This
function sets up the runtime environment state for the kernel and
the application before calling <code>main</code>,
which involves calling static initializers for C++ code and loading
categories and invoking <code>+load</code> methods
for Objective-C code.</p>
<p>When using ZeroLink, you can further reduce the launch time
of the application by postponing the execution of static initializers
and <code>+load</code> methods, and
the loading of categories. But you must be certain that code in
your application doesn&#8217;t rely on static initializers or <code>+load</code> methods
being called before <code>main</code> or
on categories being loaded before <code>main</code> is
called. Otherwise, your application may crash or behave unexpectedly.</p>
<p>There are three linker options you can use to customize ZeroLink
in your project. To use these options, add them to the Other Linker
Flags (OTHER_LDFLAGS) build setting:</p>
<ul class="spaceabove"><li class="li"><p><code>-no-run-initializers-before-main</code>:
If an application contains C++ code, the linker looks for static
initializers at launch time before calling <code>main</code> in
all the object files that make up the application and, if it finds
any, links the object files containing them into the application.
This may slow down application launch. If you&#8217;re developing an application
using C++ and it doesn&#8217;t depend on static initializers being run
before <code>main</code>, use this
option to prevent ZeroLink from scanning object files in search
of static initializers before calling <code>main</code>.</p><p>Keep
in mind that if there&#8217;s code that requires that static initializers
be run before <code>main</code>, your
application could crash. This specially true for applications that
use static initializers to register code with a registry. If the
sole purpose of the static initializers is to perform the registration
(that is, if no other code would ever trigger the execution of the
static initializers by accessing a global variable, for example),
no registration would take place. For example, when reading a serialized
file, the reader reads the name of the class of each serialized
object and tells the class to reconstruct an instance from the data. In
C++ there is no infrastructure to look up a class by name. Instead,
a common idiom is for each class capable of serializing and deserializing
instances of itself to register its class name and deserialization
method address with the reader using a static initializer.</p></li>
<li class="li"><p><code>-no-load-categories-before-main</code>:
If an application contains Objective-C code, the linker looks for
categories at launch time before calling <code>main</code> in
all the object files that make up the application and, if it finds
any, links the object files containing them into the application.
As with <code>-no-run-initializers-before-main</code>,
this may slow application launch. If your application doesn&#8217;t
depend on categories, use this option to prevent ZeroLink from scanning
object files in search of categories before calling <code>main</code>.</p><p>Some
developers rely on the use of categories in the implementation of
their class hierarchies. In such a model, the implementation of
a class spans one or more categories of that class. Using this design
model, a program may run incorrectly when the categories that implement
additional class functionality are not loaded. With ZeroLink, classes
can be loaded when need because there&#8217;s a direct reference to
them, but ZeroLink cannot load categories dynamically. Therefore,
if your application depends on categories, it may crash or behave
unexpectedly if you use the <code>-no-load-categories-before-main</code> flag.</p></li>
<li class="li"><p><code>-no-run-load-methods-before-main</code>:
Similarly to <code>-no-load-categories-before-main</code>,
ZeroLink scans object files for <code>+load</code> methods
in Objective-C code before <code>main</code> is
invoked to link them to the application. Using this option prevents
the scanning of object files for <code>+load</code> methods
before ZeroLink calls <code>main</code>. <code>+load</code> methods
in Objective-C are similar to static initializers in C++: They are
executed early during application launch, before main is called,
to perform tasks that must be performed at the earliest possible
time. However, the order of execution of <code>+load</code> methods
is not guaranteed. If your code depends on <code>+load</code> methods
to be run before <code>main</code>,
your application may crash or run incorrectly if you use this flag.</p></li></ul>
<p>When building an application that uses static libraries (<code>.a</code> files),
each static library is linked to produce a bundle. At runtime, each
bundle is loaded on demand. If your application starts slowly while
using ZeroLink and has a large number (100 or more) of object files,
you can try adding an intermediate static library target, containing
the relatively stable parts of your source code. This gives you
the best of both worlds: static (build time) linking for stable
code and dynamic (runtime) linking for code that changes frequently.</p>
<p>If you want to view information about the loading and linking
of object files as your application runs, set the <code>ZERO_LINK_VERBOSE</code> environment
variable to any value. The information appears in run log of the
application or <code>stderr</code>.</p>
<a name="//apple_ref/doc/uid/TP40001440-CH233-DontLinkElementID_59" title="Caveats When Using ZeroLink"></a><h3>Caveats When Using ZeroLink</h3>
<p>These are some things you should keep in mind when using ZeroLink:</p>
<ul class="spaceabove"><li class="li"><p>ZeroLink
doesn&#8217;t support the use of private external symbols; that is symbols declared
as <code>__private_extern__</code>.</p><p>Private
external symbols are visible only to other modules within the same
Mach-O file as the modules that contain them. If you use a private
external symbol in your project while ZeroLink is turned on, you
get an unknown-symbol error when your code tries to access it. For
example, if you have the definition <code>__private_extern__
int my_extern = 800;</code> in a source file and
the declaration <code>extern int my_extern;</code> in
another source file, when the second module accesses <code>my_extern</code>,
your application exits with the following log output:</p>
<div class="codesample"><table><tr><td scope="row"><pre>ZeroLink: unknown symbol '_my_extern'<span></span></pre></td></tr><tr><td scope="row"><pre>MyApplication has exited due to signal 6 (SIGABRT)<span></span></pre></td></tr></table></div><p>For more information
on private external symbols, see &#8220;Scope and Treatment of Symbol
Definitions&#8221; in <span class="content_text"><!--a target="_top" -->&#8220;Executing Mach-O Files&#8221;<!--/a--></span> in <em><a href="../../../../../MachORuntime/index.html#//apple_ref/doc/uid/TP40000895" target="_top">Mac OS X ABI Mach-O File Format Reference</a></em>.</p></li>
<li class="li"><p>When setting breakpoints on methods, you must use full method
specifiers, not just selectors. For example, if your project has
a class named MyClass with an instance method called <code>myMethod</code>,
you must specify a breakpoint on <code>myMethod</code> like
this:</p><div class="codesample"><table><tr><td scope="row"><pre>-[MyClass myMethod]<span></span></pre></td></tr></table></div></li>
<li class="li"><p>If you get an error similar to this one:</p>
<div class="codesample"><table><tr><td scope="row"><pre>dyld: /Users/user_name/MyApp/build/MyApp.app/Contents/MacOS/MyApp  Undefined symbols:<span></span></pre></td></tr><tr><td scope="row"><pre>Foundation undefined reference to _objc_exception_set_functions  expected to be defined in<span></span></pre></td></tr><tr><td scope="row"><pre>/System/Library/PrivateFrameworks/ZeroLink.framework/Versions/A/Resources/libobjc.A.dylib<span></span></pre></td></tr></table></div><p>delete <code>/System/Library/PrivateFrameworks/ZeroLink.framework/Versions/A/Resources/libobjc.A.dylib</code>.</p><p>You
would get this error if you install the Xcode tools in a system
with a prerelease version of Mac OS X. The <code>libobjc.A.dylib</code> file
contains a developmental copy of the Objective-C runtime. It&#8217;s
not necessary for normal development.</p></li></ul>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../bs_building_product/bs_building_product.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../bs_speed_up_build/bs_speed_up_build.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2004, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-11-07<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/DeveloperTools/Conceptual/XcodeUserGuide20/Contents/Resources/en.lproj/bs_linking/bs_linking.html%3Fid%3DTP40001440-1.2&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/DeveloperTools/Conceptual/XcodeUserGuide20/Contents/Resources/en.lproj/bs_linking/bs_linking.html%3Fid%3DTP40001440-1.2&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/DeveloperTools/Conceptual/XcodeUserGuide20/Contents/Resources/en.lproj/bs_linking/bs_linking.html%3Fid%3DTP40001440-1.2&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>