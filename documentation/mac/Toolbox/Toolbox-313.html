<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Moving and Resizing Scroll Bars(IM:Tb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING313></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Toolbox-312.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-314.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Toolbox-2.html"><B>Macintosh Toolbox Essentials</B></A> / <BR><DD><A HREF="Toolbox-297.html"><B>Chapter 5 - Control Manager</B></A> / <A HREF="Toolbox-308.html"><B>Using the Control Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING313-0></A>
<H2><A NAME=MARKER-9-301></A>Moving and Resizing Scroll Bars</H2>
 <A NAME=MARKER-2-302></A><A NAME=MARKER-2-51></A><A NAME=MARKER-2-304></A>As described earlier in <A HREF=Toolbox-309.html#MARKER-9-152>"Creating Scroll Bars" beginning on page 5-19</A>, your application initially defines the location of a scroll bar within a window--and the size of the scroll bar--by specifying a rectangle in a control resource or in a parameter to <CODE>NewControl</CODE>. However, your application must be able to size and move the scroll bar dynamically in response to the user's resizing of your windows. <P>
 The chapter "Window Manager" in this book describes how to size windows when <BR>your application opens them and how to resize them--for example, in response to <BR>the user dragging the size box or clicking the zoom box. This section describes how to move and resize your scroll bars so that they fit properly on the right and bottom edges of your windows.<P>
 When resizing your windows, your application should perform the following steps to adjust each scroll bar.<P>
<OL>
<LI>Resize the window.
<LI>Use the <CODE>HideControl</CODE> procedure to make each scroll bar invisible.<A NAME=MARKER-2-558></A>
<LI>Use the <CODE>MoveControl</CODE> procedure to move the vertical scroll bar to the right edge of the window, and use the <CODE>MoveControl</CODE> procedure to move the horizontal scroll bar to the bottom edge of the window.
<LI>Use the <CODE>SizeControl</CODE> procedure to lengthen or shorten each scroll bar, so that each extends to the size box in the lower-right corner of the window.
<LI>Recalculate the maximum settings for the scroll bars and use <CODE>SetControlMaximum</CODE> to update the settings and to redraw the scroll boxes appropriately. (Remember, you derive a scroll bar's maximum setting by subtracting the length or width of its window from the length or width of the document.)
<LI>Use the <CODE>ShowControl</CODE> procedure to make each scroll bar visible in its new location.<A NAME=MARKER-21-639></A><P>
</OL>
 <A HREF=#MARKER-9-307>Figure 5-21</A> illustrates how to move and resize scroll bars in a resized window; if your application neglected to use the <CODE>HideControl</CODE> procedure, the user would see each of these steps as it took place.<P>
<B>Figure 5-21  <A NAME=MARKER-9-307></A>Moving and resizing scroll bars </B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/CM-L-17.jpg"><P>
 <A HREF=Toolbox-311.html#MARKER-9-235>Listing 5-14 on page 5-36</A> shows an application-defined routine, <CODE>MyAdjustScrollBars</CODE>, that is called when the user opens a new window, opens an existing document in a window, or resizes a window.<A NAME=MARKER-2-226></A><P>
 When it creates a window, <CODE>MyAdjustScrollBars</CODE> stores handles to each scroll bar <BR>in a document record. By dereferencing the proper fields of the document record, <CODE>MyAdjustScrollBars</CODE> passes handles for the vertical and horizontal scroll bars to <BR>the <CODE>HideControl</CODE> procedure, which makes the scroll bars invisible. By making the scroll bars invisible until it has finished manipulating them, <CODE>MyAdjustScrollBars</CODE> ensures that the user won't see the scroll bars blinking in different locations onscreen.<A NAME=MARKER-2-196></A><P>
 When <CODE>MyAdjustScrollBars</CODE> needs to adjust the size or location of either of the scroll bars, it calls another application-defined routine, <CODE>MyAdjustScrollSizes</CODE>, which is shown in <A HREF=#MARKER-9-310>Listing 5-24</A>.<P>
<B>Listing 5-24  <A NAME=MARKER-9-310></A>Changing the size and location of a window's scroll bars</B><P>
<PRE>
CONST
   kScrollbarWidth = 16;                     {conventional width}
   kScrollbarAdjust = kScrollbarWidth - 1;   {to align with window frame}
   kScrollTweek = 2;                   {to align scroll bars with size box}

PROCEDURE MyAdjustScrollSizes (window: WindowPtr);
VAR
   teRect:                          Rect;
   myData:                          MyDocRecHnd;
   teTop, teRight, teBottom,teLeft: Integer;
BEGIN
   MyGetTERect(window, teRect);  {calculate the teRect based on the }
                                 { portRect, adjusted for the scroll bars}
   myData := MyDocRecHnd(GetWRefCon(window));
   HLock(Handle(myData));
   WITH window^.portRect DO
   BEGIN
      teTop := top;
      teRight := right;
      teBottom := bottom;
      teLeft := left;
   END;
   WITH myData^^ DO
   BEGIN
      editRec^^.viewRect := teRect;    {set the viewRect}
      MyAdjustViewRect(editRec);       {snap to nearest line}
      {move the controls to match the new window size}
      MoveControl(vScrollBar, teRight - kScrollbarAdjust, -1);
      SizeControl(vScrollBar, kScrollbarWidth, (teBottom - teTop) -
                  (kScrollbarAdjust - kScrollTweek));
      MoveControl(hScrollBar, -1, teBottom - kScrollbarAdjust);
      SizeControl(hScrollBar, (teRight - teLeft) - 
            (kScrollbarAdjust - kScrollTweek), kScrollbarWidth);
   END;
   HUnLock(Handle(myData));
END; {of MyAdjustScrollSizes}
</PRE>
 The <CODE>MyAdjustScrollSizes</CODE> routine uses the boundary rectangle of the window's content region--which is stored in the <CODE>portRect</CODE> field of the window record--to determine the size of the window. To move the scroll bars to the edges of the window, <CODE>MyAdjustScrollSizes</CODE> uses the <CODE>MoveControl</CODE> procedure.<P>
 The <CODE>MoveControl</CODE> procedure takes three parameters: a handle to the control being moved, the horizontal coordinate (local to the control's window) for the new location of the upper-left corner of the control's rectangle, and the vertical coordinate for that new location. The <CODE>MoveControl</CODE> procedure moves the control to this new location and changes the rectangle specified in the <CODE>controlRect</CODE> field of the control's control record.<P>
 In <A HREF=#MARKER-9-310>Listing 5-24</A>, <CODE>MyAdjustScrollSizes</CODE> passes to <CODE>MoveControl</CODE> the handles to the scroll bars. (The SurfWriter sample application stores the handle in its document record for the window.)<P>
 <A HREF=#MARKER-9-311>Figure 5-22</A> illustrates the location of a vertical scroll bar before it is moved to a new location within its resized window. <P>
 To determine a new horizontal (that is, left) coordinate of the upper-left corner of the vertical scroll bar, <CODE>MyAdjustScrollSizes</CODE> subtracts 15 from the right coordinate of <BR>the window. As shown in <A HREF=#MARKER-9-312>Figure 5-23</A>, this puts the right edge of the 16-pixel-wide scroll bar directly over the 1-pixel-wide window frame on the right side of the window.<P>
 In <A HREF=#MARKER-9-310>Listing 5-24 on page 5-61</A>, <CODE>MyAdjustScrollSizes</CODE> specifies -1 as the vertical (that is, top) coordinate of the upper-left corner of the vertical scroll bar. As shown in <A HREF=#MARKER-9-312>Figure 5-23</A>, this places the top edge of the scroll bar directly over the 1-pixel-wide line at the bottom of the title bar. (The bottom line of the title bar has a vertical value of -1 in the window's local coordinate system.)<P>
 The <CODE>MyAdjustScrollSizes</CODE> routine specifies -1 as the horizontal coordinate of the upper-left corner of the horizontal scroll bar; this puts the left edge of the horizontal scroll bar directly over the 1-pixel-wide window frame. (The left edge of the window frame has a horizontal value of -1 in the window's local coordinate system.)<P>
 To fit your scroll bars inside the window frame properly, you should set the top coordinate of a vertical scroll bar at -1 and the left coordinate of a horizontal scroll bar <BR>at -1, unless your application uses part of the window's scroll regions opposite the size box for displaying information or additional controls. For example, you may choose to display the current page number of the document in the lower-left corner of a window. In this case, specify a left coordinate so that the horizontal scroll bar doesn't obscure <BR>this area.<P>
<B>Figure 5-22  <A NAME=MARKER-9-311></A>A vertical scroll bar before the application moves it within a resized window</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/CM-L-15.jpg"><P>
<B>Figure 5-23  <A NAME=MARKER-9-312></A>A vertical scroll bar after the application moves its upper-left point</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/CM-L-16.jpg"><P>
 See <I>Macintosh Human Interface Guidelines</I> for a discussion of appropriate uses of a window's scroll areas for items other than scroll bars.<P>
 To determine a new vertical coordinate for the upper-left corner of the horizontal scroll bar, <CODE>MyAdjustScrollSizes</CODE> subtracts 15 from the bottom coordinate of the window; this puts the bottom edge of the scroll bar directly over the window frame at the bottom of the window.<P>
 The <CODE>MoveControl</CODE> procedure moves the upper-left corner of a scroll bar so that it's in the proper location within its window frame. To make the vertical scroll bar fit the height of the window, and to make the horizontal scroll bar fit the width of the window, <CODE>MyAdjustScrollSizes</CODE> then uses the <CODE>SizeControl</CODE> procedure.<A NAME=MARKER-2-77></A><P>
 The <CODE>SizeControl</CODE> procedure takes three parameters: a handle to the control being sized, a width in pixels for the control, and a height in pixels for the control. When resizing a vertical scroll bar, you adjust its height; when resizing a horizontal scroll bar, you adjust its width.<P>
 When using <CODE>SizeControl</CODE> to adjust the vertical scroll bar, <CODE>MyAdjustScrollSizes</CODE> passes a constant representing 16 pixels for the vertical scroll bar's width, which is the conventional size. <P>
 To determine the proper height for this scroll bar, <CODE>MyAdjustScrollSizes</CODE> first derives the height of the window by subtracting the top coordinate of the window's rectangle from its bottom coordinate. Then <CODE>MyAdjustScrollSizes</CODE> subtracts 13 pixels from this window height and passes the result to <CODE>SizeControl</CODE> as the height of the vertical scroll bar. The <CODE>MyAdjustScrollSizes</CODE> routine subtracts 13 pixels from the window height to leave room for the 16-pixel-high size box (at the bottom of the window) minus three 1-pixel overlaps: one at the top of the window frame, one at the top of the size box, and one at the bottom of the size box.<P>
 When using <CODE>SizeControl</CODE> to adjust the horizontal scroll bar, <CODE>MyAdjustScrollSizes</CODE> passes a constant representing 16 pixels--the conventional height of the horizontal scroll bar. To determine the proper width of this scroll bar, <CODE>MyAdjustScrollSizes</CODE> first derives the width of the window by subtracting the left coordinate of the window's rectangle from its right coordinate. From this window width, <CODE>MyAdjustScrollSizes</CODE> then subtracts 13 pixels to allow for the size box (just as it does when determining the height of the vertical scroll bar).<A NAME=MARKER-2-84></A><P>
 When <CODE>MyAdjustScrollSizes</CODE> completes, it returns to <CODE>MyAdjustScrollBars</CODE>, <BR>which then uses another of its own routines, <CODE>MyAdjustScrollValues</CODE>. In <BR>turn, <CODE>MyAdjustScrollValues</CODE> calls <CODE>MyAdjustHV</CODE> (shown in <A HREF=Toolbox-311.html#MARKER-9-238>Listing 5-16 on page 5-38</A>), which recalculates the maximum settings for the scroll bars and uses <CODE>SetControlMaximum</CODE> to update the maximum settings and redraw the scroll <BR>boxes appropriately.<A NAME=MARKER-2-315></A><P>
 When <CODE>MyAdjustHV</CODE> completes, it eventually returns to the SurfWriter application's <CODE>MyAdjustScrollBars</CODE> procedure, which then uses the <CODE>ShowControl</CODE> procedure <BR>to make the newly adjusted scroll bars visible again.<A NAME=MARKER-9-609></A><A NAME=MARKER-2-317></A><A NAME=MARKER-2-318></A><A NAME=MARKER-2-114></A><A NAME=MARKER-2-320></A><A NAME=MARKER-9-106></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Toolbox-312.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-314.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Toolbox-3.html">&copy; Apple Computer, Inc.</A><br>11 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
