<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><TITLE> Spatial Properties</TITLE></HEAD><BODY BGCOLOR="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- path goes here --><!-- QTnavbar start --><P><I>QuickTime API Documentation</I><P><A target="doc" HREF="xxIntroductions.15.htm">Previous</A> | <A target="doc" HREF="xxIntroductions.12.htm">Chapter Top</A> | <A target="doc" HREF="xxIntroductions.1.htm">Chapter Contents</A> | <A target="doc" HREF="xxIntroductions.17.htm">Next</A> | <!-- QTnavbar end --><H1 CLASS="H2.Heading2"><A NAME="pgfId=26058"> </A><A NAME="17431"> </A>Spatial Properties</H1><P CLASS="T0.Text0"><A NAME="pgfId=26059"> </A>When you play a movie that contains visual data, the Movie Toolbox gathers the movie's data from the appropriate tracks and media structures, transforms the data as appropriate, and displays the results in a window. The Movie Toolbox uses only those tracks that </P><UL><LI CLASS="B1.Bullet1"><A NAME="pgfId=26060"> </A>are not empty</LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=26061"> </A>contain media structures that reference data at a specified time</LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=26062"> </A>are enabled in the current movie mode (standard playback, poster mode, or preview mode)</LI></UL><P CLASS="T1.Text1"><A NAME="pgfId=26063"> </A>Consequently, the size, shape, and location of many of these regions may change during movie playback.<A NAME="marker=26064"> </A><A NAME="marker=26065"> </A><A NAME="marker=26066"> </A> This process is quite complicated and involves several phases of clipping and resizing. </P><P CLASS="T1.Text1"><A NAME="pgfId=26067"> </A>The Movie Toolbox shields you from the intricacies of this process by providing two high-level functions, <TT CLASS="cv">GetMovieBox</TT><A NAME="marker=26068"> </A> and <A NAME="marker=26069"> </A><TT CLASS="cv">SetMovieBox</TT>, which allow you to place a movie box at a specific location in the display coordinate system. When you use these functions, the Movie Toolbox automatically adjusts the contents of the movie's matrix to satisfy your request.<A NAME="marker=26076"> </A></P><P CLASS="T1.Text1"><A NAME="pgfId=26080"> </A>Figure 0-22 provides an overview of the entire process of gathering, transforming, and displaying visual data. Each track defines its own spatial characteristics, which are then interpreted within the context of the movie's spatial characteristics. </P><P CLASS="T1.Text1"><A NAME="pgfId=26081"> </A>This section describes the process that the Movie Toolbox uses to display a movie. The process begins with the movie data and ends with the final movie display. The phases, which are described in detail in this section, include </P><OL><LI CLASS="N/.NList=1"><A NAME="pgfId=26085"> </A>the creation of a track rectangle (see Figure 0-23)</LI><LI CLASS="N.NList"><A NAME="pgfId=26089"> </A>the clipping of a track's image (see Figure 0-24)</LI><LI CLASS="N.NList"><A NAME="pgfId=26092"> </A>the transformation of a track into the movie coordinate system (see Figure 0-25) </LI><LI CLASS="N.NList"><A NAME="pgfId=26097"> </A>the clipping of a movie image (see Figure 0-26)</LI><LI CLASS="N.NList"><A NAME="pgfId=26100"> </A>the transformation of a movie into the display coordinate system (see Figure 0-27)</LI><LI CLASS="N.NList"><A NAME="pgfId=26105"> </A>the clipping of a movie for final display (see Figure 0-28)</LI></OL><P CLASS="Note"><A NAME="pgfId=26106"> </A><DIV><IMG SRC="xxIntroductions-4.gif"></DIV>Throughout this book and in <I CLASS="italics">Inside Macintosh: QuickTime Components</I>, the term <I CLASS="italics">time coordinate system</I> denotes QuickTime's time-based system. All other instances of the term <I CLASS="italics">coordinate system</I> refer to QuickDraw's graphic coordinates. </P><P CLASS="Fg.Figure"><A NAME="pgfId=26115"> </A>Figure 0-22	<A NAME="12855"> </A>Spatial processing of a movie and its tracks<DIV><IMG SRC="xxIntroductions-6.gif"></DIV></P><DIV><IMG SRC="xxIntroductions-25.gif"></DIV><P CLASS="T1.Text1"><A NAME="pgfId=26117"> </A><A NAME="marker=26116"> </A>Each track defines a rectangle into which its media is displayed. This rectangle is referred to as the <B CLASS="bold">track rectangle,</B> and it is defined by the <B CLASS="bold">track width</B> and <B CLASS="bold">track height</B> values assigned to the track. The upper-left corner of this rectangle defines the origin point of the track's<I CLASS="italics"> coordinate system</I>.<A NAME="marker=26118"> </A></P><P CLASS="Note"><A NAME="pgfId=26119"> </A><DIV><IMG SRC="xxIntroductions-4.gif"></DIV>Henceforth, the graphic coordinate system for a track is referred to simply as its <I CLASS="italics">coordinate system</I>. </P><P CLASS="T1.Text1"><A NAME="pgfId=26123"> </A>The media handler associated with the track's media is responsible for displaying an image into this rectangle. This process is shown in Figure 0-23.<A NAME="marker=26127"> </A><A NAME="marker=26128"> </A><A NAME="marker=26129"> </A><A NAME="marker=26130"> </A><A NAME="marker=26131"> </A><A NAME="marker=26132"> </A></P><P CLASS="Fg.Figure"><A NAME="pgfId=26138"> </A>Figure 0-23	<A NAME="14207"> </A>A track rectangle<DIV><IMG SRC="xxIntroductions-6.gif"></DIV></P><DIV><IMG SRC="xxIntroductions-26.gif"></DIV><P CLASS="T1.Text1"><A NAME="pgfId=26139"> </A>The Movie Toolbox next mattes the image in the track rectangle by applying the track matte and the track clipping region. This does not affect the shape of the image--only the display. Both the track matte and the track clipping region are optional.</P><P CLASS="T1.Text1"><A NAME="pgfId=26140"> </A>A <B CLASS="bold">track matte</B> provides a mechanism for mixing images. Mattes contain several bits per pixel and are defined in the track's coordinate system. The matte can be used to perform a <A NAME="marker=26141"> </A>deep-mask operation on the image in the track rectangle. The Movie Toolbox displays the weighted average of the track and its destination based on the corresponding pixel value in the matte.<A NAME="marker=26142"> </A></P><P CLASS="T1.Text1"><A NAME="pgfId=26144"> </A><A NAME="marker=26143"> </A>The <B CLASS="bold">track clipping region</B> is a QuickDraw region that defines a portion of the track rectangle to retain. The track clipping region is defined in the track's coordinate system. This clipping operation creates the <B CLASS="bold">track boundary region,</B> which is the intersection of the track rectangle and the track clipping region<A NAME="marker=26145"> </A>.<A NAME="marker=26146"> </A><A NAME="marker=26147"> </A><A NAME="marker=26148"> </A></P><P CLASS="T1.Text1"><A NAME="pgfId=26152"> </A>This process and its results are shown in Figure 0-24.</P><P CLASS="Fg.Figure"><A NAME="pgfId=26158"> </A>Figure 0-24	<A NAME="24415"> </A>Clipping a track's image<DIV><IMG SRC="xxIntroductions-6.gif"></DIV></P><DIV><IMG SRC="xxIntroductions-27.gif"></DIV><P CLASS="T1.Text1"><A NAME="pgfId=26160"> </A><A NAME="marker=26159"> </A>After clipping and matting the track's image, the Movie Toolbox transforms the resulting image into the movie's coordinate system. The Movie Toolbox uses a 3-by-3 transformation matrix to accomplish this operation (see the next section,  &quot;The Transformation Matrix,&quot; for a complete discussion of matrix operations in the Movie Toolbox). The image inside the track boundary region is transformed by  the track's matrix into the movie coordinate system. The resulting area is bounded by the <B CLASS="bold">track movie boundary region.</B> Figure 0-25 shows the results of this transformation operation<A NAME="marker=26167"> </A>.<A NAME="marker=26168"> </A><A NAME="marker=26169"> </A><A NAME="marker=26170"> </A><A NAME="marker=26171"> </A></P><P CLASS="Fg.Figure"><A NAME="pgfId=26177"> </A>Figure 0-25	<A NAME="22002"> </A>A track transformed into a movie coordinate system<DIV><IMG SRC="xxIntroductions-6.gif"></DIV></P><DIV><IMG SRC="xxIntroductions-28.gif"></DIV><P CLASS="T1.Text1"><A NAME="pgfId=26178"> </A>The Movie Toolbox performs this portion of the process for each track in the movie. Once all of the movie's tracks have been processed, the Movie Toolbox proceeds to transform the complete movie image for display.</P><P CLASS="T1.Text1"><A NAME="pgfId=26181"> </A><A NAME="marker=26179"> </A><A NAME="marker=26180"> </A>The union of all track movie boundary regions for a movie defines the movie's <B CLASS="bold">movie boundary region.</B> The Movie Toolbox combines a movie's tracks into this single region where layers are applied. Therefore, tracks in back layers may be partially or completely obscured by tracks in front layers. The Movie Toolbox clips this region to obtain the <B CLASS="bold">clipped movie boundary region.</B> The movie's <B CLASS="bold">movie clipping region</B> defines the portion of the movie boundary region that is to be used. Figure 0-26 shows the process by which a movie is clipped and the resulting clipped movie boundary region.<A NAME="marker=26185"> </A><A NAME="marker=26186"> </A><A NAME="marker=26187"> </A><A NAME="marker=26188"> </A><A NAME="marker=26189"> </A><A NAME="marker=26190"> </A></P><P CLASS="Fg.Figure"><A NAME="pgfId=26196"> </A>Figure 0-26	<A NAME="39286"> </A>Clipping a movie's image<DIV><IMG SRC="xxIntroductions-6.gif"></DIV></P><DIV><IMG SRC="xxIntroductions-29.gif"></DIV><P CLASS="T1.Text1"><A NAME="pgfId=26199"> </A><A NAME="marker=26197"> </A><A NAME="marker=26198"> </A>After clipping the movie's image, the Movie Toolbox transforms the resulting image into the display coordinate system. The Movie Toolbox uses a 3-by-3 transformation matrix to accomplish this operation (see the next section, &quot;The Transformation Matrix,&quot; for a complete discussion of matrix operations in the Movie Toolbox). The image inside the clipped movie boundary region is transformed by the movie's matrix into the display coordinate system. The resulting area is bounded by the movie display boundary region. Figure 0-27 shows the results of this step.<A NAME="marker=26206"> </A><A NAME="marker=26207"> </A><A NAME="marker=26208"> </A></P><P CLASS="Fg.Figure"><A NAME="pgfId=26214"> </A>Figure 0-27	<A NAME="19356"> </A>A movie transformed to the display coordinate system<DIV><IMG SRC="xxIntroductions-6.gif"></DIV></P><DIV><IMG SRC="xxIntroductions-30.gif"></DIV><P CLASS="T1.Text1"><A NAME="pgfId=26215"> </A>The rectangle that encloses the movie display boundary region is called the <B CLASS="bold">movie box,</B> as shown in Figure 0-28. You can control the location of a movie's movie box by adjusting the movie's transformation matrix. <A NAME="marker=26219"> </A><A NAME="marker=26220"> </A><A NAME="marker=26221"> </A><A NAME="marker=26222"> </A><A NAME="marker=26223"> </A></P><P CLASS="Fg.Figure"><A NAME="pgfId=26229"> </A>Figure 0-28	<A NAME="20087"> </A>Clipping a movie for final display<DIV><IMG SRC="xxIntroductions-6.gif"></DIV></P><DIV><IMG SRC="xxIntroductions-31.gif"></DIV><P CLASS="T1.Text1"><A NAME="pgfId=26230"> </A>Once the movie is in the <B CLASS="bold">display coordinate system</B> (that is, the QuickDraw graphics world), the Movie Toolbox performs a final clipping operation to generate the image that is displayed. The movie is clipped with the <B CLASS="bold">movie display clipping region.</B> When a movie is displayed, the Movie Toolbox ignores the graphics port's clipping region--this is why there is a movie display clipping region. Figure 0-28 shows this operation.<A NAME="marker=26234"> </A><A NAME="marker=26235"> </A><A NAME="marker=26236"> </A><A NAME="marker=26237"> </A><A NAME="marker=26238"> </A></P><hr>&#169; 1997 Apple Computer, Inc.<!-- QTnavbar start --><P><I>QuickTime API Documentation</I><P><A target="doc" HREF="xxIntroductions.15.htm">Previous</A> | <A target="doc" HREF="xxIntroductions.12.htm">Chapter Top</A> | <A target="doc" HREF="xxIntroductions.1.htm">Chapter Contents</A> | <A target="doc" HREF="xxIntroductions.17.htm">Next</A> | <!-- QTnavbar end --><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY></HTML>