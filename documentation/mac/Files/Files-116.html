<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Basic File Manager Parameter Block (IM: F)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING116></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Files-115.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-117.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Files-2.html"><B>Files</B></A> / <BR><DD><A HREF="Files-72.html"><B>Chapter 2 - File Manager</B></A> / <A HREF="Files-113.html"><B>File Manager Reference</B></A><BR><DL><DD><A HREF="Files-114.html"><B>Data Structures</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING116-0></A>
<H3>Basic File Manager Parameter Block</H3>
 <A NAME=MARKER-14-746></A>Many of the low-level functions that manipulate files and volumes exchange information with your application using the basic File Manager parameter block, defined by the <CODE>ParamBlockRec</CODE> data type.<A NAME=MARKER-2-747></A><P>
<PRE>
TYPE ParamBlockRec   =                 {basic File Manager parameter block}
RECORD
      qLink:            QElemPtr;      {next queue entry}
      qType:            Integer;       {queue type}
      ioTrap:           Integer;       {routine trap}
      ioCmdAddr:        Ptr;           {routine address}
      ioCompletion:     ProcPtr;       {pointer to completion routine}
      ioResult:         OSErr;         {result code}
      ioNamePtr:        StringPtr;     {pointer to pathname}
      ioVRefNum:        Integer;       {volume specification}
   CASE ParamBlkType OF
   ioParam:       
     (ioRefNum:         Integer;       {file reference number}
      ioVersNum:        SignedByte;    {version number}
      ioPermssn:        SignedByte;    {read/write permission}
      ioMisc:           Ptr;           {miscellaneous}
      ioBuffer:         Ptr;           {data buffer}
      ioReqCount:       LongInt;       {requested number of bytes}
      ioActCount:       LongInt;       {actual number of bytes}
      ioPosMode:        Integer;       {positioning mode and newline char.}
      ioPosOffset:      LongInt);      {positioning offset}
   fileParam:     
     (ioFRefNum:        Integer;       {file reference number}
      ioFVersNum:       SignedByte;    {file version number (unused)}
      filler1:          SignedByte;    {reserved}
      ioFDirIndex:      Integer;       {directory index}
      ioFlAttrib:       SignedByte;    {file attributes}
      ioFlVersNum:      SignedByte;    {file version number (unused)}
      ioFlFndrInfo:     FInfo;         {information used by the Finder}
      ioFlNum:          LongInt;       {file ID}
      ioFlStBlk:        Integer;       {first alloc. blk. of data fork}
      ioFlLgLen:        LongInt;       {logical EOF of data fork}
      ioFlPyLen:        LongInt;       {physical EOF of data fork}
      ioFlRStBlk:       Integer;       {first alloc. blk. of resource fork}
      ioFlRLgLen:       LongInt;       {logical EOF of resource fork}
      ioFlRPyLen:       LongInt;       {physical EOF of resource fork}
      ioFlCrDat:        LongInt;       {date and time of creation}
      ioFlMdDat:        LongInt);      {date and time of last modification}
   volumeParam:   
     (filler2:          LongInt;       {reserved}
      ioVolIndex:       Integer;       {volume index}
      ioVCrDate:        LongInt;       {date and time of initialization}
      ioVLsBkUp:        LongInt;       {date and time of last modification}
      ioVAtrb:          Integer;       {volume attributes}
      ioVNmFls:         Integer;       {number of files in root directory}
      ioVDirSt:         Integer;       {first block of directory}
      ioVBlLn:          Integer;       {length of directory in blocks}
      ioVNmAlBlks:      Integer;       {number of allocation blocks}
      ioVAlBlkSiz:      LongInt;       {size of allocation blocks}
      ioVClpSiz:        LongInt;       {default clump size}
      ioAlBlSt:         Integer;       {first block in block map}
      ioVNxtFNum:       LongInt;       {next unused file ID}
      ioVFrBlk:         Integer);      {number of unused allocation blocks}
   END;
</PRE>
 The first eight fields are common to all three variants. Each variant also includes its own unique fields.<P>
<B>Field descriptions for fields common to all variants</B><P>
<DL>
<DT><CODE>qLink</CODE>
<DD> A pointer to the next entry in the file I/O queue. (This field is used internally by the File Manager to keep track of asynchronous calls awaiting execution.)
<DT><CODE>qType</CODE>
<DD> The queue type. (This field is used internally by the File Manager.)
<DT><CODE>ioTrap</CODE>
<DD> The trap number of the routine that was called. (This field is used internally by the File Manager.)
<DT><CODE>ioCmdAddr</CODE>
<DD> The address of the routine that was called. (This field is used internally by the File Manager.)
<DT><CODE>ioCompletion</CODE>
<DD> A pointer to a completion routine to be executed at the end of an asynchronous call. It should be <CODE>NIL</CODE> for asynchronous calls with <BR>no completion routine and is automatically set to <CODE>NIL</CODE> for all synchronous calls. See <A HREF=Files-299.html#MARKER-9-1483>"Completion Routines" on page 2-238</A> for information about completion routines.
<DT><CODE><A NAME=MARKER-2-170></A>ioResult</CODE>
<DD> The result code of the function. For synchronous calls, this field is the same as the result code of the function call itself. To determine when an asynchronous call has actually been completed, your application can poll this field; it's set to a positive number when <BR>the call is made and receives the actual result code when the call <BR>is completed.
<DT><CODE>ioNamePtr</CODE>
<DD> A pointer to a pathname. Whenever a routine description specifies that <CODE>ioNamePtr</CODE> is used--whether for input, output, or both--<BR>it's very important that you set this field to point to storage for a <CODE>Str255</CODE> value (if you're using a pathname) or to <CODE>NIL</CODE> (if you're not).
<DT><CODE>ioVRefNum</CODE>
<DD> A volume specification (volume reference number, working directory reference number, drive number, or 0 for default volume).
</DL>
<B>Field descriptions for the <CODE>ioParam</CODE> variant</B><P>
<DL>
<DT><CODE>ioRefNum</CODE>
<DD> The file reference number of an open file.
<DT><CODE>ioVersNum</CODE>
<DD> A version number. This field is no longer used and you should always set it to 0.
<DT><CODE>ioPermssn</CODE>
<DD> The access mode.
<DT><CODE>ioMisc</CODE>
<DD> Depends on the routine called. This field contains either a new logical end-of-file, a new version number, or a pointer to a new pathname. Because <CODE>ioMisc</CODE> is of type <CODE>Ptr</CODE>, you'll need to perform type coercion to interpret the value of <CODE>ioMisc</CODE> correctly when it contains an end-of-file (a <CODE>LongInt</CODE> value) or version number (a <CODE>SignedByte</CODE> value).
<DT><CODE>ioBuffer</CODE>
<DD> A pointer to a data buffer into which data is written by <CODE>_Read</CODE> calls and from which data is read by <CODE>_Write</CODE> calls.
<DT><CODE>ioReqCount</CODE>
<DD> The requested number of bytes to be read, written, or allocated.
<DT><CODE>ioActCount</CODE>
<DD> The number of bytes actually read, written, or allocated.
<DT><CODE>ioPosMode</CODE>
<DD> The positioning mode for setting the mark. Bits 0 and 1 of this field indicate how to position the mark; you can use the following predefined constants to set or test their value:
</DL>
<PRE>
               CONST
                  fsAtMark       =  0; {at current mark}
                  fsFromStart    =  1; {from beginning of file}
                  fsFromLEOF     =  2; {from logical end-of-file}
                  fsFromMark     =  3; {relative to current mark}
</PRE>
<DL>
<DT>
<DD> You can set bit 4 of the <CODE>ioPosMode</CODE> field to request that the data be cached, and you can set bit 5 to request that the data not be cached. You can set bit 6 to request that any data written be immediately<BR><BR>read; this ensures that the data written to a volume exactly matches the data in memory. To request a read-verify operation, add the following constant to the positioning mode:
</DL>
<PRE>
               CONST
                  rdVerify       =  64;   {use read-verify mode}
</PRE>
<DL>
<DT>
<DD> You can set bit 7 to read a continuous stream of bytes, and place <BR>the ASCII code of a newline character in the high-order byte to terminate a read operation at the end of a line.
<DT><CODE>ioPosOffset</CODE>
<DD> The offset to be used in conjunction with the positioning mode. 
</DL>
<B>Field descriptions for the <CODE>fileParam</CODE> variant</B><P>
<DL>
<DT><CODE>ioFRefNum</CODE>
<DD> The file reference number of an open file.
<DT><CODE>ioFVersNum</CODE>
<DD> A file version number. This field is no longer used and you should always set it to 0.
<DT><CODE>filler1</CODE>
<DD> Reserved.
<DT><CODE>ioFDirIndex</CODE>
<DD> An index for use with the <CODE>PBHGetFInfo</CODE> function.
<DT><CODE>ioFlAttrib</CODE>
<DD> File attributes. The bits in this field have these meanings:<CODE>
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>&nbsp;<TH>Bit<TH>Meaning<TR>
<TD>&nbsp;<TD>0<TD>Set if file is locked<TR>
<TD>&nbsp;<TD>2<TD>Set if resource fork is open <TR>
<TD>&nbsp;<TD>3<TD>Set if data fork is open<TR>
<TD>&nbsp;<TD>4<TD>Set if a directory<TR>
<TD>&nbsp;<TD>7<TD>Set if file (either fork) is open</TABLE>
</CODE>
<DT><CODE>ioFlVersNum</CODE>
<DD> A file version number. This feature is no longer supported, and you must always set this field to 0.
<DT><CODE>ioFlFndrInfo</CODE>
<DD> Information used by the Finder. (See the chapter "Finder Interface" in <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I> for details.)
<DT><CODE><A NAME=MARKER-2-774></A>ioFlNum</CODE>
<DD> A file ID.
<DT><CODE>ioFlStBlk</CODE>
<DD> The first allocation block of the data fork. This field contains 0 if the file's data fork is empty.
<DT><CODE>ioFlLgLen</CODE>
<DD> The logical end-of-file of the data fork.
<DT><CODE>ioFlPyLen</CODE>
<DD> The physical end-of-file of the data fork.
<DT><CODE>ioFlRStBlk</CODE>
<DD> The first allocation block of the resource fork. This field contains 0 if the file's resource fork is empty.
<DT><CODE>ioFlRLgLen</CODE>
<DD> The logical end-of-file of the resource fork.
<DT><CODE>ioFlRPyLen</CODE>
<DD> The physical end-of-file of the resource fork.
<DT><CODE>ioFlCrDat</CODE>
<DD> The date and time of the file's creation, specified in seconds since midnight, January 1, 1904.
<DT><CODE>ioFlMdDat</CODE>
<DD> The date and time of the last modification to the file, specified in seconds since midnight, January 1, 1904.
</DL>
<B>Field descriptions for the <CODE>volumeParam</CODE> variant</B><P>
<DL>
<DT><CODE>filler2</CODE>
<DD> Reserved.
<DT><CODE>ioVolIndex</CODE>
<DD> The volume index.
<DT><CODE>ioVCrDate</CODE>
<DD> The date and time of volume initialization.
<DT><CODE><A NAME=MARKER-2-786></A>ioVLsBkUp</CODE>
<DD> The date and time the volume information was last modified. (This field is not changed when information is written to a file and does not necessarily indicate when the volume was flushed.)
<DT><CODE>ioVAtrb</CODE>
<DD> The volume attributes.
<DT><CODE>ioVNmFls</CODE>
<DD> The number of files in the root directory.
<DT><CODE><A NAME=MARKER-2-789></A>ioVDirSt</CODE>
<DD> The first block of the volume directory.
<DT><CODE><A NAME=MARKER-2-790></A>ioVBlLn</CODE>
<DD> Length of directory in blocks.
<DT><CODE>ioVNmAlBlks</CODE>
<DD> The number of allocation blocks.
<DT><CODE>ioVAlBlkSiz</CODE>
<DD> The size of allocation blocks.
<DT><CODE>ioVClpSiz</CODE>
<DD> The volume clump size.
<DT><CODE>ioAlBlSt</CODE>
<DD> The first block in the volume map.
<DT><CODE><A NAME=MARKER-2-795></A>ioVNxtFNum</CODE>
<DD> The next unused file number.
<DT><CODE>ioVFrBlk</CODE>
<DD> The number of unused allocation blocks.<A NAME=MARKER-9-101></A>
</DL>
<HR>
<center>
<A HREF="Files-115.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-117.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Files-3.html">&copy; Apple Computer, Inc.</A><br>2 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
