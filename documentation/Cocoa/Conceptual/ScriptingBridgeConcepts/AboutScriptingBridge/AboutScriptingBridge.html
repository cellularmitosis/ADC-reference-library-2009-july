<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Scripting Bridge Programming Guide for Cocoa: About Scripting Bridge</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="About Scripting Bridge"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40006104-CH3" title="About Scripting Bridge"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../Scripting-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000569" target="_top">Scripting &amp; Automation</a> &gt; <a href="../Introduction/Introduction.html#//apple_ref/doc/uid/TP40006104-CH1-DontLinkElementID_17">Scripting Bridge Programming Guide for Cocoa</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../Introduction/Introduction.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../UsingScriptingBridge/UsingScriptingBridge.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40006104-CH3-SW9" title="About Scripting Bridge"></a><h1>About Scripting Bridge</h1><p>Scripting Bridge is a technology that makes it easy for a program written in Objective-C to communicate with scriptable applications. The following sections explain what Scripting Bridge is and point out its value to Cocoa developers.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="AboutScriptingBridge.html#//apple_ref/doc/uid/TP40006104-CH3-SW6">The Advantages of Scripting Bridge</a>
				
			<br/>
			
        
			
			
				<a href="AboutScriptingBridge.html#//apple_ref/doc/uid/TP40006104-CH3-DontLinkElementID_1">How Scripting Bridge Works</a>
				
			<br/>
			
        
			
			
				<a href="AboutScriptingBridge.html#//apple_ref/doc/uid/TP40006104-CH3-SW1">Classes of the Scripting Bridge Framework</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40006104-CH3-SW6" title="The Advantages of Scripting Bridge"></a><h2>The Advantages of Scripting Bridge</h2><p>Many applications on Mac OS X are scriptable. A scriptable application is one that you can communicate with from a script or another application, enabling you to control the application and exchange data with it. To be scriptable, an application must define an interface for responding to commands. This interface and its implementation must conform to an object model (prescribed by Open Systems Architecture, or OSA) that specifies the classes of scripting objects, the accessible properties of those objects, the inheritance and containment relationships of scripting objects, and the commands that the scriptable application responds to. OSA packages commands to scriptable applications as Apple events and uses the Apple Event Manager to dispatch those events and receive data in return. Apple events are a pervasive feature of Mac OS X; for example, the operating system uses them to control the life cycles of applications and coordinate their interactions.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40006104-CH3-DontLinkElementID_14" title="Note"></a><p><strong>Note:</strong>&nbsp;For a complete description of the concepts and techniques relevant to making Cocoa applications scriptable, see <em><a href="../../ScriptableCocoaApplications/index.html#//apple_ref/doc/uid/TP40002164" target="_top">Cocoa Scripting Guide</a></em>.</p></div><p>AppleScript scripts have long been the principal way to communicate with scriptable applications. But an application can also send commands to a scriptable application and receive responses back to it. The “traditional” way of doing this requires you to use the data structures and functions of the OSA framework to create and send Apple events, but this can be a dauntingly complex task. Typical Cocoa applications—until Scripting Bridge, that is—relied on one of two other techniques. They included an AppleScript script in the application bundle and used Cocoa's <code><a href="../../../Reference/Foundation/Classes/NSAppleScript_Class/Reference/Reference.html#//apple_ref/occ/cl/NSAppleScript" target="_top">NSAppleScript</a></code> class to execute the script. Or they used the <code><a href="../../../Reference/Foundation/Classes/NSAppleEventDescriptor_Class/Reference/Reference.html#//apple_ref/occ/cl/NSAppleEventDescriptor" target="_top">NSAppleEventDescriptor</a></code> class to create Apple events which they then send with Apple Event Manager routines. However, both of these approaches are not straightforward for Cocoa developers and can be inefficient.</p><p>The Scripting Bridge framework makes it possible to send and receive Apple events using Objective-C messages instead of AppleScript commands or Apple-event descriptors. For Cocoa programmers, Scripting Bridge provides a simple and clear model for controlling scriptable applications. It makes Cocoa programs that send and receive Apple events more efficient, and it doesn't require you to have detailed knowledge of the target application's Apple event model. Scripting Bridge integrates well with existing Objective-C code and works with standard Cocoa designs, such as key-value coding, target-action, and declared properties. It has other advantages too.</p><ul class="ul"><li class="li"><p>It gives your application access to any scriptable feature of any available scriptable application.</p></li><li class="li"><p>It uses native Cocoa data types—<code>NSString</code>, <code>NSArray</code>, <code>NSURL</code>, and so on—so you'll never have to deal with less familiar Carbon types.</p></li><li class="li"><p>It manages Apple event data structures for you, using standard Cocoa memory management to allocate and free Apple events.</p></li><li class="li"><p>It requires much less code than needed to use <code>NSAppleEventDescriptor</code> and direct Apple Event Manager calls.</p></li><li class="li"><p>It checks for syntax errors at compile time, unlike <code>NSAppleScript</code>.</p></li><li class="li"><p>It runs more than twice as fast as a precompiled <code>NSAppleScript</code>, and up to 100x as fast as an uncompiled <code>NSAppleScript</code>.</p></li></ul><p>Because Scripting Bridge dynamically populates an application’s namespace with Objective-C objects representing the items defined by an application’s scripting definition, it enables other scripting languages bridged to Objective-C—namely RubyCocoa and PyObjC—to communicate with and control scriptable applications. It thus gives those scripting languages the same advantages as AppleScript scripts and Objective-C programs using Scripting Bridge. For more information on using Scripting Bridge in RubyCocoa and PyObjC code, see <em><a href="../../RubyPythonCocoa/index.html#//apple_ref/doc/uid/TP40004936" target="_top">Ruby and Python Programming Topics for Mac OS X</a></em>.</p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40006104-CH3-DontLinkElementID_15" title="Important:"></a><p><strong>Important:</strong>&nbsp;The Ruby and Python bridges to Objective-C use framework metadata to learn about non-introspectable types. However, the classes that Scripting Bridge dynamically generates currently do not include any metadata. This mismatch leads to some limitations when using Scripting Bridge in RubyCocoa and PyObjC code. For example, Scripting Bridge declares enumerated types in its Objective-C headers, but these are not bridged to RubyCocoa and PyObjC as symbolic entities. To use an enumerated value in a script you must specify the corresponding integral value; for instance, the value of iChat’s ‘away’ enumerator would be 0x61776179. Another important mismatch to be aware of are Boolean parameters and return types. Scripting Bridge declares these as <code>BOOL</code>, which is a <code>typedef</code> for <code>signed char</code>. However, Ruby evaluates all numbers, even zero, as logically true because they are Number objects. Consequently when using Scripting Bridge in RubyCocoa you must test Boolean values for equality to zero and not whether they are logically false.</p><p>These limitations apply to the initial version of Scripting Bridge, which was introduced in Mac OS X version 10.5.</p><p></p></div><a name="//apple_ref/doc/uid/TP40006104-CH3-DontLinkElementID_1" title="How Scripting Bridge Works"></a><h2>How Scripting Bridge Works</h2><p>When you request an instance of a scriptable application from Scripting Bridge, it first locates the bundle of the application by bundle identifier, URL, or process identifier (depending on what you specify). It then gets from the bundle the scripting definition of the application contained in its <code>sdef</code> file (or, for older applications, its suite terminology and suite definition files) and parses it. From the items  in the scripting definition—classes, properties, elements, commands, and so on—it dynamically declares and implements Objective-C classes corresponding to the scripting classes of the application. The dynamically generated classes inherit from one of the classes defined by the Scripting Bridge framework, <code><a href="../../../Reference/SBObject_Class/SBObject/SBObject.html#//apple_ref/occ/cl/SBObject" target="_top">SBObject</a></code>. </p><p>The scripting classes of an application frequently exist in hierarchical relationships of inheritance, but there is also a containment hierarchy, or object graph. When you ask an object for the objects it contains, Scripting Bridge instantiates those objects from the appropriate scripting classes and returns them. If you request the objects contained by one of those objects, Scripting Bridge instantiates new scripting objects from the appropriate class and returns those. Usually this continues until you reach a leaf node of the graph, which is typically a property containing actual data. </p><p>At the root of the object graph is the instance of a dynamically generated subclass of <code>SBApplication</code> that represents the application object; in the case of iTunes, for example, that subclass is named <code>iTunesApplication</code>. For other scripting objects in the object graph (for example, “document” or “track”), Scripting Bridge uses an instance of a dynamically generated <code>SBObject</code> subclass; an iTunes track, for example, is represented by an <code>iTunesTrack</code> instance. Elements, which specify to-many relationships with other scripting objects, are implemented as methods that return instances of <code><a href="../../../Reference/SBElementArray_Class/SBElementArray/SBElementArray.html#//apple_ref/occ/cl/SBElementArray" target="_top">SBElementArray</a></code>. <code>SBElementArray</code> is a subclass of <code>NSMutableArray</code>, and so you can send it messages such as <code><a href="../../../Reference/Foundation/Classes/NSMutableArray_Class/Reference/Reference.html#//apple_ref/occ/instm/NSMutableArray/addObject:" target="_top">addObject:</a></code> and <code><a href="../../../Reference/Foundation/Classes/NSArray_Class/Reference/Reference.html#//apple_ref/occ/instm/NSArray/objectAtIndex:" target="_top">objectAtIndex:</a></code>. </p><p>Scripting Bridge implements commands and properties (directly or indirectly) as methods of the <code>SBApplication</code> subclass or of one of the application’s scripting classes. It implements the properties of a class as Objective-C declared properties, which results in the synthesis of accessor methods for those properties. Many of these accessor methods return, and sometimes set, objects of an appropriate Foundation or Application Kit type, such as <code>NSString</code>, <code>NSURL</code>, <code>NSColor</code>, and <code>NSNumber</code>. These properties represent the concrete data of a scriptable application. (See “<span class="content_text"><a href="../../ScriptableCocoaApplications/SApps_about_apps/SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976" target="_top">About Scriptable Cocoa Applications</a></span>“ in <em><a href="../../ScriptableCocoaApplications/index.html#//apple_ref/doc/uid/TP40002164" target="_top">Cocoa Scripting Guide</a></em> for a mapping of Cocoa types to AppleScript types.) For commands, Scripting Bridge evaluates the direct parameter to determine the class to assign the method implementation to. If it’s a specific scripting class (such as <code>document</code>), the command becomes a method of that class; if it’s of a generic class (such as <code>specifier</code>), it becomes a method of the <code>SBApplication</code> subclass.</p><p>Scripting objects in Scripting Bridge—that is, objects derived from <code>SBObject</code>—are essentially object specifiers. That is, they are references to objects in the scriptable application. To get or set concrete data in the application, the scripting object must be evaluated, which results in Scripting Bridge sending an Apple event to the application. For more on scripting objects as object specifiers, see <span class="content_text"><a href="AboutScriptingBridge.html#//apple_ref/doc/uid/TP40006104-CH3-SW7">“Object Specifiers and Evaluation.”</a></span> </p><a name="//apple_ref/doc/uid/TP40006104-CH3-DontLinkElementID_2" title="Example: The Sketch Application"></a><h3>Example: The Sketch Application</h3><p>The best way to understand how Scripting Bridge processes an application’s scripting definition is to look at a “real” application, in this case the Sketch application. The Sketch example project in <code>&lt;Xcode>/Examples/AppKit</code> builds a simple but functionally complete graphics application; with it you can draw and color geometric shapes, lines, and text. The project includes an <code>sdef</code> XML file that defines the scripting interface of the application. <span class="content_text">Listing 1-1</span> shows the part of the <code>sdef</code> file that defines the Sketch <code>document</code> class.</p><a name="//apple_ref/doc/uid/TP40006104-CH3-SW2" title="Listing 1-1The definition of the document class for Sketch"></a><p class="codesample"><strong>Listing 1-1&nbsp;&nbsp;</strong>The definition of the <code>document</code> class for Sketch</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;class name="document" code="docu" description="A Sketch document."><span></span></pre></td></tr><tr><td scope="row"><pre>           &lt;cocoa class="SKTDrawDocument"/><span></span></pre></td></tr><tr><td scope="row"><pre>           &lt;property name="name" code="pnam" type="text" access="r" description="Its name."><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;cocoa key="displayName"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;/property><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;property name="modified" code="imod" type="boolean" access="r" description="Has it been modified since the last save?"><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;cocoa key="isDocumentEdited"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;/property><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;property name="file" code="file" type="file" access="r" description="Its location on disk, if it has one."><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;cocoa key="fileURL"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;/property><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;!-- This is just here for compatibility with old scripts. New scripts should use the more user-friendly file property. --><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;property name="path" code="ppth" type="text" access="r" description="Its location on disk, if it has one, as a POSIX path string." hidden="yes"><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;cocoa key="fileName"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;/property><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;element type="graphic"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;element type="box"><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;cocoa key="rectangles"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;/element><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;element type="circle"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;element type="image"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;element type="line"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;element type="text area"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;responds-to name="close"><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;cocoa method="handleCloseScriptCommand:"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;/responds-to><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;responds-to name="print"><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;cocoa method="handlePrintScriptCommand:"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;/responds-to><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;responds-to name="save"><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;cocoa method="handleSaveScriptCommand:"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;/responds-to><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;/class><span></span></pre></td></tr></table></div>	<p>The Dictionary viewer (accessible from the Script Editor application) displays this XML definition of the <code>document</code> class as shown in <span class="content_text">Figure 1-1</span>. It shows the containment of <code>document</code> by <code>application</code>, and it includes both the common properties of the class (derived from the Standard Suite) as well as the application-specific elements: graphics, boxes, circles, and so on. </p><br/><div><a name="//apple_ref/doc/uid/TP40006104-CH3-SW3" title="Figure 1-1The document class in the Sketch dictionary"></a><p><strong>Figure 1-1&nbsp;&nbsp;</strong>The <code>document</code> class in the Sketch dictionary</p><img src = "../Art/sketch_dict.jpg" alt = "The document class in the Sketch dictionary" ></div><br/><p>Scripting Bridge translates the definition of the Sketch <code>document</code> class into the following Objective-C declarations:</p><div class="codesample"><table><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>@interface SketchDocument : SketchItem<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>@property (readonly) BOOL modified;  // Has the document been modified since the last save?<span></span></pre></td></tr><tr><td scope="row"><pre>@property (copy) NSString *name;  // The document's name.<span></span></pre></td></tr><tr><td scope="row"><pre>@property (copy) NSString *path;  // The document's path.<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>@end<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// More class declarations here.....<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>@interface SketchDocument (SketchSuite)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>- (SBElementArray *) circles;<span></span></pre></td></tr><tr><td scope="row"><pre>- (SBElementArray *) graphics;<span></span></pre></td></tr><tr><td scope="row"><pre>- (SBElementArray *) images;<span></span></pre></td></tr><tr><td scope="row"><pre>- (SBElementArray *) lines;<span></span></pre></td></tr><tr><td scope="row"><pre>- (SBElementArray *) rectangles;<span></span></pre></td></tr><tr><td scope="row"><pre>- (SBElementArray *) textAreas;<span></span></pre></td></tr><tr><td scope="row"><pre>@end<span></span></pre></td></tr></table></div><p>Note that Scripting Bridge makes the declarations for the <code>SketchDocument</code> class in two parts. The initial declared properties are for the common properties of the <code>document</code> scripting class as defined by the Standard Suite. The category adds declarations specific to the Sketch Suite; these declare methods (corresponding to elements in the scripting definition) that return <code><a href="../../../Reference/SBElementArray_Class/SBElementArray/SBElementArray.html#//apple_ref/occ/cl/SBElementArray" target="_top">SBElementArray</a></code> objects.</p><p><span class="content_text"><a href="AboutScriptingBridge.html#//apple_ref/doc/uid/TP40006104-CH3-SW5">Figure 1-2</a></span> depicts how Scripting Bridge converts the Sketch scripting definition of the document class into the implicit graph of objects that constitutes the application’s containment hierarchy. At the root of the graph is an instance of the <code>SketchApplication</code> class, which inherits from the <code><a href="../../../Reference/SBApplication_Class/SBApplication/SBApplication.html#//apple_ref/occ/cl/SBApplication" target="_top">SBApplication</a></code> class. This application object contains one or more instances of the <code>SketchDocument</code> class, which inherits from the <code>SketchItem</code> class, itself a descendent of the <code><a href="../../../Reference/SBObject_Class/SBObject/SBObject.html#//apple_ref/occ/cl/SBObject" target="_top">SBObject</a></code> class.  . Each element contained by the <code>document</code> class is implemented as a method returning an <code><a href="../../../Reference/SBElementArray_Class/SBElementArray/SBElementArray.html#//apple_ref/occ/cl/SBElementArray" target="_top">SBElementArray</a></code> object, which is a subclass of <code><a href="../../../Reference/Foundation/Classes/NSMutableArray_Class/Reference/Reference.html#//apple_ref/occ/cl/NSMutableArray" target="_top">NSMutableArray</a></code>.</p><br/><div><a name="//apple_ref/doc/uid/TP40006104-CH3-SW5" title="Figure 1-2Object graph representing the Sketch document class"></a><p><strong>Figure 1-2&nbsp;&nbsp;</strong>Object graph representing the Sketch <code>document</code> class</p><img src = "../Art/sketch_document.jpg" alt = "Object graph representing the Sketch document class" ></div><br/><p>Thus the <code>graphics</code> method returns zero or more <code>SketchGraphic</code> objects—each corresponds to a <code>graphic</code> object in the scripting definition—using an <code>SBElementArray</code> object as the container. The <code>graphic</code> scripting class of Sketch is particularly interesting because it’s also the superclass of the <code>box</code> objects, <code>circle</code> objects, and the other objects returned by the other element methods. The <code>graphic</code> class defines the properties common to all Sketch graphical objects, including fill color, stroke color, origin, and size; these properties are implemented as Objective-C declared properties, which synthesize accessor methods that get and set the property values. </p><div class="codesample"><table><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>@interface SketchGraphic : SketchItem<span></span></pre></td></tr><tr><td scope="row"><pre>@property (copy) NSColor *fillColor;  // The fill color.<span></span></pre></td></tr><tr><td scope="row"><pre>@property int height;  // The height of the graphic's bounding rectangle.<span></span></pre></td></tr><tr><td scope="row"><pre>@property (copy) NSColor *strokeColor;  // The stroke color.<span></span></pre></td></tr><tr><td scope="row"><pre>@property int strokeThickness;  // The thickness of the stroke.<span></span></pre></td></tr><tr><td scope="row"><pre>@property int width;  // The width of the graphic's bounding rectangle.<span></span></pre></td></tr><tr><td scope="row"><pre>@property int xPosition;  // The x coordinate of the graphic's bounding rectangle.<span></span></pre></td></tr><tr><td scope="row"><pre>@property int yPosition;  // The y coordinate of the graphic's bounding rectangle.<span></span></pre></td></tr><tr><td scope="row"><pre>@end<span></span></pre></td></tr></table></div><p><span class="content_text">Figure 1-3</span> shows both this and the inheritance relationship of the <code>SketchGraphic</code> class that Scripting Bridge implements for the <code>graphic</code> class.</p><br/><div><a name="//apple_ref/doc/uid/TP40006104-CH3-SW4" title="Figure 1-3The graphic scripting class of Sketch becoming the SketchGraphic class"></a><p><strong>Figure 1-3&nbsp;&nbsp;</strong>The <code>graphic</code> scripting class of Sketch becoming the <code>SketchGraphic</code> class</p><img src = "../Art/sketch_graphic_properties.jpg" alt = "The graphic scripting class of Sketch" ></div><br/><p>When you set a property in Scripting Bridge, make sure the value of the property is of an appropriate type. Thus, if you try to set the stroke color of a <code>SketchGraphic</code> object, you should pass in an <code><a href="../../../Reference/ApplicationKit/Classes/NSColor_Class/Reference/Reference.html#//apple_ref/occ/cl/NSColor" target="_top">NSColor</a></code> object as the new value.</p><a name="//apple_ref/doc/uid/TP40006104-CH3-SW7" title="Object Specifiers and Evaluation"></a><h3>Object Specifiers and Evaluation</h3><p>Scripting objects in a Scripting Bridge program inherit from the <code><a href="../../../Reference/SBObject_Class/SBObject/SBObject.html#//apple_ref/occ/cl/SBObject" target="_top">SBObject</a></code> class. <code>SBObject</code> objects represent object specifiers in AppleScript. Object specifiers function as proxies for the remote objects in the target application. They help to locate a scriptable object in that application’s containment hierarchy. For example, a series of messages sent to objects in a scriptable application could be equivalent to an AppleScript statement such as <code>get the first track of the third playlist of the source "Library"</code>. Each segment of this statement, such as <code>third playlist</code>, would be represented by an object specifier.</p><p>In a Scripting Bridge program, object specifiers are initially in a form of reference supplied by the scripting definition. A <code>currentTrack</code> message sent to an <code>iTunesApplication</code> instance, for example, would be a reference such as “the ‘current track’ property of iTunes”. When you <em>evaluate</em> an object specifier, however, an Apple event is sent to the scriptable application and a more precise, canonical form of reference is obtained for the scripting object. The canonical form of reference provides an exact location of an object within the application, using such things as unique numeric or string identifiers. In the case of <code>currentTrack</code>, the canonical reference might be something like “track id 42 of playlist id 23 of source 1”.</p><p>Because the evaluation of an object specifier results in the dispatch of an Apple event—which is an expensive operation—Scripting Bridge restricts the occasions that trigger evaluation. Lazy evaluation occurs when a message requests concrete data, which is always the value of a property. You can also force evaluation of a reference by sending a <code><a href="../../../Reference/SBObject_Class/SBObject/SBObject.html#//apple_ref/occ/instm/SBObject/get" target="_top">get</a></code> message to a scripting object. In both cases, the evaluated object or objects are given a canonical form of reference that doesn’t vary over time. (If concrete data is requested, the message also results in a response Apple event that contains the data.)</p><p>Often you force evaluation when you want to keep a reference to an object in the scriptable application when the non-canonical form of reference could change at any time. For example, the frontmost document in an application is the referenced object at index zero of the application’s <code>documents</code> element array. But the ordering of the documents in the array can change as the user clicks on various documents. So to ensure that you have a reference to the current frontmost document, you could do something similar to this:</p><div class="codesample"><table><tr><td scope="row"><pre>SketchDocument *frontmost_doc = [[[app documents] objectAtIndex:0] get];<span></span></pre></td></tr></table></div><p>For more on lazy evaluation and the use of the <code>get</code> method, see <span class="content_text"><a href="../ImproveScriptingBridgePerf/ImproveScriptingBridgePerf.html#//apple_ref/doc/uid/TP40006104-CH6-SW1">“Improving the Performance of Scripting Bridge Code.”</a></span></p><a name="//apple_ref/doc/uid/TP40006104-CH3-SW1" title="Classes of the Scripting Bridge Framework"></a><h2>Classes of the Scripting Bridge Framework</h2><p>The Scripting Bridge framework has three public classes:</p><ul class="ul"><li class="li"><p><code><a href="../../../Reference/SBApplication_Class/SBApplication/SBApplication.html#//apple_ref/occ/cl/SBApplication" target="_top">SBApplication</a></code>—A class for objects representing scriptable applications</p></li><li class="li"><p><code><a href="../../../Reference/SBElementArray_Class/SBElementArray/SBElementArray.html#//apple_ref/occ/cl/SBElementArray" target="_top">SBElementArray</a></code>—A class for collections of objects returned from elements (implemented as methods)</p></li><li class="li"><p><code><a href="../../../Reference/SBObject_Class/SBObject/SBObject.html#//apple_ref/occ/cl/SBObject" target="_top">SBObject</a></code>—The base class for an application’s scripting objects</p></li></ul><p>The following class factory methods of  <code>SBApplication</code> return an object representing an OSA-compliant application (autoreleased in memory-managed environments):</p><ul class="ul"><li class="li"><p><code>+ (id) applicationWithBundleIdentifier:(NSString *)bundleID;</code></p><p>Finds the application using its bundle identifier, for example <code>@"com.apple.iTunes"</code>. This is the recommended approach for most situations, especially when the application is local, because it dynamically locates the application. </p></li><li class="li"><p><code>+ (id) applicationWithURL:(NSURL *)url;</code></p><p>Finds the application using an object representing a URL with a <code>file:</code> or <code>eppc:</code> file scheme; the latter scheme is used for locating remote applications. </p></li><li class="li"><p><code>+ (id) applicationWithProcessIdentifier:(pid_t)pid;</code></p><p>Finds the application using its BSD process identifier (<code>pid</code>).</p></li></ul><p>Calling one of these methods is the first step when using Scripting Bridge. Before it returns the application instance, Scripting Bridge parses the scripting definition of the designated application and dynamically implements the required classes.<span class="content_text"><a href="../UsingScriptingBridge/UsingScriptingBridge.html#//apple_ref/doc/uid/TP40006104-CH4-SW15">“Creating the Application Object”</a></span> shows how you might use these methods in your Cocoa applications.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40006104-CH3-DontLinkElementID_16" title="Note"></a><p><strong>Note:</strong>&nbsp;There are initializers corresponding to the above class factory methods—for example, <code>initWithProcessIdentifier:</code>—which would require you to allocate a generic <code>SBApplication</code> object first. But the recommended usage pattern is to call one of the <code>applicationWith...</code> methods. </p></div><p>Programs that use Scripting Bridge generally don’t need to call many of the methods declared by <code>SBObject</code>, <code>SBApplication</code>, and <code>SBElementArray</code>. The methods you invoke tend to be the ones that Scripting Bridge dynamically declares and implements for an application and its scripting objects. However, several framework methods (listed in <span class="content_text">Table 1-1</span>) are useful in common situations.</p><a name="//apple_ref/doc/uid/TP40006104-CH3-SW8" title="Table 1-1Commonly called methods of the Scripting Bridge framework"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 1-1&nbsp;&nbsp;</strong>Commonly called methods of the Scripting Bridge framework</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Methods</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Purpose</p></th></tr><tr><td  scope="row"><p><code><a href="../../../Reference/SBObject_Class/SBObject/SBObject.html#//apple_ref/occ/instm/SBObject/initWithProperties:" target="_top">initWithProperties:</a></code> (<code>SBObject</code>)</p><p><code><a href="../../../Reference/SBObject_Class/SBObject/SBObject.html#//apple_ref/occ/instm/SBObject/initWithData:" target="_top">initWithData:</a></code> (<code>SBObject</code>)</p></td><td ><p>Initializes a scripting object with properties or data; used in conjunction <code>classForScriptingClass:</code>. See <span class="content_text"><a href="../UsingScriptingBridge/UsingScriptingBridge.html#//apple_ref/doc/uid/TP40006104-CH4-SW11">“Creating and Adding Scripting Objects”</a></span> for an example.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../Reference/SBObject_Class/SBObject/SBObject.html#//apple_ref/occ/instm/SBObject/get" target="_top">get</a></code> (<code>SBObject</code>)</p></td><td ><p>Forces evaluation of a scripting object which is implemented as an object specifier. Evaluation returns the canonical form of reference for the object. For more information, see <span class="content_text"><a href="AboutScriptingBridge.html#//apple_ref/doc/uid/TP40006104-CH3-SW7">“Object Specifiers and Evaluation”</a></span> and <span class="content_text"><a href="../ImproveScriptingBridgePerf/ImproveScriptingBridgePerf.html#//apple_ref/doc/uid/TP40006104-CH6-SW3">Listing 3-2</a></span>.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../Reference/SBApplication_Class/SBApplication/SBApplication.html#//apple_ref/occ/instm/SBApplication/classForScriptingClass:" target="_top">classForScriptingClass:</a></code> (<code>SBApplication</code>)</p></td><td ><p>Returns the <code>Class</code> object for a scripting class of the application. With this object you can allocate an instance of the scripting class and then initialize it with <code>initWithProperties:</code> or <code>initWithData:</code>.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../Reference/SBApplication_Class/SBApplication/SBApplication.html#//apple_ref/occ/instm/SBApplication/activate" target="_top">activate</a></code> (<code>SBApplication</code>)</p><p><code><a href="../../../Reference/SBApplication_Class/SBApplication/SBApplication.html#//apple_ref/occ/instm/SBApplication/isRunning" target="_top">isRunning</a></code> (<code>SBApplication</code>)</p></td><td ><p>Allow you to monitor and activate an application. <span class="content_text"><a href="../ImproveScriptingBridgePerf/ImproveScriptingBridgePerf.html#//apple_ref/doc/uid/TP40006104-CH6-SW1">“Improving the Performance of Scripting Bridge Code”</a></span> discusses the use of <code>isRunning</code>. </p></td></tr><tr><td  scope="row"><p><code><a href="../../../Reference/SBElementArray_Class/SBElementArray/SBElementArray.html#//apple_ref/occ/instm/SBElementArray/objectWithName:" target="_top">objectWithName:</a></code> (<code>SBElementArray</code>)</p><p><code><a href="../../../Reference/SBElementArray_Class/SBElementArray/SBElementArray.html#//apple_ref/occ/instm/SBElementArray/objectWithID:" target="_top">objectWithID:</a></code> (<code>SBElementArray</code>)</p><p><code><a href="../../../Reference/SBElementArray_Class/SBElementArray/SBElementArray.html#//apple_ref/occ/instm/SBElementArray/objectAtLocation:" target="_top">objectAtLocation:</a></code> (<code>SBElementArray</code>)</p></td><td ><p>Enables you to obtain a scripting object in an element array by specifying its name, unique identifier, or location. See <span class="content_text"><a href="../UsingScriptingBridge/UsingScriptingBridge.html#//apple_ref/doc/uid/TP40006104-CH4-SW12">“Using Element Arrays”</a></span> for an example.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../Reference/SBElementArray_Class/SBElementArray/SBElementArray.html#//apple_ref/occ/instm/SBElementArray/arrayByApplyingSelector:" target="_top">arrayByApplyingSelector:</a></code> (<code>SBElementArray</code>)</p><p><code><a href="../../../Reference/SBElementArray_Class/SBElementArray/SBElementArray.html#//apple_ref/occ/instm/SBElementArray/arrayByApplyingSelector:withObject:" target="_top">arrayByApplyingSelector:withObject:</a></code> (<code>SBElementArray</code>)</p></td><td ><p>Creates an array populated with the objects returned from a message sent to every object in an element array. See <span class="content_text"><a href="../UsingScriptingBridge/UsingScriptingBridge.html#//apple_ref/doc/uid/TP40006104-CH4-SW12">“Using Element Arrays”</a></span> for an example.</p></td></tr></table></div><p>The Scripting Bridge framework also includes the <code><a href="../../../Reference/SBApplicationDelegate_Protocol/SBApplicationDelegate/SBApplicationDelegate.html#//apple_ref/occ/intf/SBApplicationDelegate" target="_top">SBApplicationDelegate</a></code> informal protocol. A delegate may implement the sole method of this protocol (<code><!--a target="_top" -->eventDidFail:withError:<!--/a--></code>) to handle Apple event errors returned from the target application.</p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../Introduction/Introduction.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../UsingScriptingBridge/UsingScriptingBridge.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-03-11<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Conceptual/ScriptingBridgeConcepts/AboutScriptingBridge/AboutScriptingBridge.html%3Fid%3DTP40006104-1.1&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Conceptual/ScriptingBridgeConcepts/AboutScriptingBridge/AboutScriptingBridge.html%3Fid%3DTP40006104-1.1&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Conceptual/ScriptingBridgeConcepts/AboutScriptingBridge/AboutScriptingBridge.html%3Fid%3DTP40006104-1.1&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>