<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Apple Event Attributes and Parameters(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING97></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-96.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-98.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-94.html"><B>Chapter 3 - Introduction to Apple Events</B></A> / <A HREF="IAC-95.html"><B>About Apple Events</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING97-0></A>
<H2><A NAME=MARKER-9-134></A><A NAME=MARKER-21-135></A>Apple Event Attributes and Parameters</H2>
 <A NAME=MARKER-21-170></A>When an application creates and sends an Apple event, the Apple Event Manager uses arguments passed to Apple Event Manager routines to construct the data structures that make up the Apple event. An Apple event consists of attributes (which identify the Apple event and denote its task) and, often, parameters (which contain information to be used by the target application). <P>
 <A NAME=MARKER-2-137></A>An <B>Apple event attribute</B> is a record that identifies the event class, event ID, target application, or some other characteristic of an Apple event. Taken together, the attributes of an Apple event denote the task to be performed on any data specified in the Apple event's parameters. A client application can use Apple Event Manager routines to add attributes to an Apple event. After receiving an Apple event, a server application can use Apple Event Manager routines to extract and examine its attributes. <P>
 <A NAME=MARKER-2-112></A>An <B>Apple event parameter</B> is a record containing data that the target application uses. Unlike Apple event attributes (which contain information that can be used by both the Apple Event Manager and the target application), Apple event parameters contain data used only by the target application. For example, the Apple Event Manager uses the event class and event ID attributes to identify the server application's handler for a specific Apple event, and the server application must have a handler to process the event identified by those attributes. By comparison, the list of documents contained in a parameter to an Open Documents event is used only by the server application. As with attributes, a client application can use Apple Event Manager routines to add parameters to an Apple event, and a server application can use Apple Event Manager routines to extract and examine the parameters of an Apple event it has received.<P>
 Note that Apple event parameters are different from the parameters of Apple Event Manager functions. Apple event parameters are records used by the Apple Event Manager; function parameters are arguments you pass to the function or that the function returns to you. You can specify both Apple event parameters and Apple event attributes in parameters to Apple Event Manager functions. For example, the <CODE>AEGetParamPtr</CODE> function uses a buffer to return the data contained in an Apple event parameter. You can specify the Apple event parameter whose data you want in one of the parameters of the <CODE>AEGetParamPtr</CODE> function.<P>
<A NAME=HEADING97-5></A>
<H3>Apple Event Attributes</H3>
 Apple events are identified by their event class and event ID attributes. The <B>event class</B> is the attribute that identifies a group of related Apple events. The event class appears in the <CODE>message</CODE> field of the event record for an Apple event. For example, the four required Apple events have the value <CODE>'aevt'</CODE> in the <CODE>message</CODE> fields of their event records. The value <CODE>'aevt'</CODE> can also be represented by the <CODE>kCoreEventClass</CODE> constant. Several event classes are shown here:<A NAME=MARKER-21-32></A><A NAME=MARKER-2-33></A>
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Event class<TH>Value<TH>Description<TR>
<TD>kCoreEventClass<TD>'aevt'<TD>A required Apple event<A NAME=MARKER-2-55></A><A NAME=MARKER-2-56></A><TR>
<TD>kAECoreSuite<TD>'core'<TD>A core Apple event<A NAME=MARKER-2-343></A><A NAME=MARKER-2-254></A><A NAME=MARKER-2-57></A><TR>
<TD>kAEFinderEvents<TD>'FNDR'<TD>An event that the Finder accepts<TR>
<TD>kSectionEventMsgClass<TD><CODE>'</CODE>sect'<TD>An event sent by the Edition Manager<A NAME=MARKER-9-79></A><A NAME=MARKER-2-397></A><A NAME=MARKER-2-8></A></TABLE>
<P>
 <A NAME=MARKER-9-60></A>The <B>event ID</B> is the attribute that identifies the particular Apple event within its event class. In conjunction with the event class, the event ID uniquely identifies the Apple event and communicates what action the Apple event should perform. (The event IDs appear in the <CODE>where</CODE> field of the event record for an Apple event. For more information about event records, see the chapter "Event Manager" in <I>Inside Macintosh: Macintosh Toolbox Essentials.</I>) For example, the event ID of an Open Documents event has the value <CODE>'odoc'</CODE> (which can also be represented by the <CODE>kAEOpenDocuments</CODE> constant). The <CODE>kCoreEventClass</CODE> constant in combination with the <CODE>kAEOpenDocuments</CODE> constant identifies the Open Documents event to the Apple Event Manager.<A NAME=MARKER-2-69></A><P>
 Here are the event IDs for the four required Apple events:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Event ID<TH>Value<TH>Description<TR>
<TD>kAEOpenApplication<TD>'oapp'<TD>Perform tasks required when a user opens your application without opening or printing any documents<A NAME=MARKER-2-72></A><A NAME=MARKER-21-74></A><A NAME=MARKER-2-76></A><A NAME=MARKER-2-87></A><TR>
<TD>kAEOpenDocuments<TD>'odoc'<TD>Open documents<A NAME=MARKER-2-342></A><A NAME=MARKER-9-129></A><A NAME=MARKER-9-16></A><A NAME=MARKER-2-18></A><A NAME=MARKER-2-17></A><TR>
<TD>kAEPrintDocuments<TD>'pdoc'<TD>Print documents<A NAME=MARKER-2-81></A><A NAME=MARKER-21-79></A><A NAME=MARKER-21-80></A><A NAME=MARKER-2-90></A><A NAME=MARKER-2-269></A><TR>
<TD>kAEQuitApplication<TD>'quit'<TD>Quit your application<A NAME=MARKER-2-85></A><A NAME=MARKER-21-88></A><A NAME=MARKER-2-89></A><A NAME=MARKER-9-33></A><A NAME=MARKER-2-35></A></TABLE>
<P>
 In addition to the event class and event ID attributes, every Apple event must include an attribute that specifies the target application's address. Remember that the target application is the one addressed to receive the Apple event. Your application can send an Apple event to itself or to another application (on the same computer or on a remote computer connected to the network).<P>
 Every Apple event must include event class, event ID, and target address attributes. Some Apple events can include other attributes; see <A HREF=IAC-98.html#MARKER-9-174>"Keyword-Specified Descriptor Records,"</A> which begins on <A HREF=IAC-98.html#MARKER-9-174>page 3-12</A>, for a complete list.<P>
<A NAME=HEADING97-11></A>
<H3>Apple Event Parameters</H3>
 As with attributes, there are various kinds of Apple event parameters. A <B>direct parameter </B>usually specifies the data to be acted upon by the target application. For example, the direct parameter of the Print Documents event contains a list of documents. Some Apple events also take <B>additional parameters,</B> which the target application uses in addition to the data specified in the direct parameter. Thus, an Apple event for arithmetic operations might include additional parameters that specify operands in an equation. <A NAME=MARKER-21-282></A><A NAME=MARKER-2-98></A><A NAME=MARKER-2-147></A><A NAME=MARKER-21-101></A><A NAME=MARKER-2-102></A><A NAME=MARKER-2-103></A><P>
 <A NAME=MARKER-2-106></A>The <I>Apple Event Registry: Standard Suites</I> describes all parameters as either required or optional. A <B>required parameter</B> is one that must be present for the target application to carry out the task denoted by the Apple event. An <B>optional parameter </B>is a supplemental Apple Event parameter that also can be used to specify data to the target application. Optional parameters need not be included in an Apple event; default values for optional parameters are part of the event definition. The target application that handles the event must supply default values if the optional parameters are omitted. <A NAME=MARKER-21-104></A> <P>
 Direct parameters are usually defined as required parameters in the <I>Apple Event Registry: Standard Suites;</I> additional parameters may be defined as either required or optional. However, the Apple Event Manager does not enforce the definitions of required and optional events. Instead, the source application specifies, when it sends the event, which Apple event parameters the target can treat as if they were optional.<P>
 For more information about optional parameters, see <A HREF=IAC-198.html#MARKER-9-35>"Specifying Optional Parameters for an Apple Event,"</A> which begins on <A HREF=IAC-198.html#MARKER-9-35>page 5-7</A>.<P>
<A NAME=HEADING97-16></A>
<H3>Interpreting Apple Event Attributes and Parameters</H3>
 <A HREF=#MARKER-9-151>Figure 3-3</A> shows the major Apple event attributes and direct parameter for the Open Documents event introduced in <A HREF=IAC-95.html#MARKER-9-120>Figure 3-1</A>.<P>
<B>Figure 3-3  <A NAME=MARKER-9-151></A><A NAME=MARKER-21-152></A>Major attributes and direct parameter of an Open Documents event</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/AE-L-03.jpg"><P>
 When the SurfWriter application receives any high-level event, it calls the <CODE>AEProcessAppleEvent</CODE> function to process the event. For an Apple event such as the Open Documents event shown in <A HREF=#MARKER-9-151>Figure 3-3</A>, the <CODE>AEProcessAppleEvent</CODE> function uses the event class and event ID attributes to dispatch the event to the SurfWriter application's Open Documents handler. In response, the Open Documents handler opens the documents specified in the direct parameter. <P>
 The definition of a given Apple event in the <I>Apple Event Registry: Standard Suites</I> suggests how the source application can organize the data in the Apple event's parameters and how the target application interprets that data. The data in an Apple event parameter may use standard or private data types and may include a description of an Apple event object. Each Apple event handler provided by an application should be written with the format of the expected data in mind.<P>
 Apple events can use standard data types, such as strings of text, long integers, Boolean values, and alias records, for the corresponding data in Apple event parameters. For example, the Get Data event can contain an optional parameter specifying the form in which the requested data should be returned. This optional parameter always consists of a list of four-character codes denoting desired descriptor types in order of preference. Apple events can also use special data types defined by the Apple Event Manager. <P>
 <A NAME=MARKER-2-357></A>Apple event parameters often contain descriptions of Apple event objects. These descriptions make use of a standard classification scheme summarized in <A HREF=IAC-108.html#MARKER-9-247>"The Classification of Apple Event Objects,"</A> which begins on <A HREF=IAC-108.html#MARKER-9-247>page 3-33</A>.<P>
 For example, every Get Data event includes a required parameter that describes the Apple event object containing the data requested by the client application. Thus, one application can send a Get Data event to another application, requesting, for instance, one paragraph of a document, the first and last paragraphs of a document, all pictures in the document, all paragraphs containing the word "sales," or pages 10 through 12 of the document. <P>
 <A HREF=#MARKER-9-154>Figure 3-4</A> shows the Apple event attributes and direct parameter for the Get Data event introduced in <A HREF=IAC-96.html#MARKER-9-133>Figure 3-2</A>. The direct parameter for the Get Data event sent by the SurfCharter application describes the requested Apple event object as a table called "Summary of Sales" in the document "Sales Report." Both the table and the document are Apple event objects. The description of an Apple event object always includes a description of its location. In most cases, Apple event objects are located inside other Apple event objects.<P>
<B>Figure 3-4  <A NAME=MARKER-9-154></A>Major attributes and direct parameter of a Get Data event</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/AE-L-04.jpg"><P>
 To process the information in the Get Data event, the SurfWriter application calls the <CODE>AEProcessAppleEvent</CODE> function. The <CODE>AEProcessAppleEvent</CODE> function uses the event class and event ID attributes to dispatch the event to the SurfWriter application's handler for the Get Data Apple event. The SurfWriter application responds to the Get Data event by <B>resolving</B> the description of the Apple event object--that is, by using the <CODE>AEResolve</CODE> function, other Apple Event Manager routines, and its own application-defined functions to locate the table named "Summary of Sales." After locating the table, SurfWriter adds a copy of the table's data to the reply event, which the Apple Event Manager then sends to the SurfCharter application. The SurfCharter application then displays the data in its active window. <A NAME=MARKER-2-155></A> <P>
 The next section, <A HREF=IAC-98.html#MARKER-9-157>"Data Structures Within Apple Events,"</A> describes the data structures the Apple Event Manager uses for Apple event attributes and parameters. <A NAME=MARKER-2-362></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-96.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-98.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
