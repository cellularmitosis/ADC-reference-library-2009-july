<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Installing Object Accessor Functions That Find Apple Event Objects(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING240></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-239.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-241.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-231.html"><B>Chapter 6 - Resolving and Creating Object Specifier Records</B></A> / <A HREF="IAC-239.html"><B>Installing Entries in the Object Accessor Dispatch Tables</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING240-0></A>
<H2>Installing Object Accessor Functions That Find Apple Event Objects</H2>
 <A HREF=#MARKER-9-140>Listing 6-1</A> demonstrates how to add entries to your application's object accessor dispatch table for the object class <CODE>cText</CODE> and three of its element classes: the object classes <CODE>cWord</CODE>, <CODE>cItem</CODE>, and <CODE>cChar</CODE>. In this example, the container for each of these object classes is identified by a token that consists of a descriptor record of descriptor type <CODE>typeMyText</CODE>. <P>
<B>Listing 6-1  <A NAME=MARKER-9-140></A>Installing object accessor functions that find elements of different classes for container tokens of the same type</B><P>
<PRE>
myErr := AEInstallObjectAccessor(cText, typeMyText, 
                                 @MyFindTextObjectAccessor,
                                 0, FALSE);
IF myErr &lt;&gt; noErr THEN DoError(myErr);
myErr := AEInstallObjectAccessor(cWord, typeMyText, 
                                 @MyFindWordObjectAccessor,
                                 0, FALSE);
IF myErr &lt;&gt; noErr THEN DoError(myErr);
myErr := AEInstallObjectAccessor(cItem, typeMyText, 
                                 @MyFindItemObjectAccessor,
                                 0, FALSE);
IF myErr &lt;&gt; noErr THEN DoError(myErr);
myErr := AEInstallObjectAccessor(cChar, typeMyText, 
                                 @MyFindCharObjectAccessor,
                                 0, FALSE);
IF myErr &lt;&gt; noErr THEN DoError(myErr);    
</PRE>
 The first call to <CODE>AEInstallObjectAccessor</CODE> in <A HREF=#MARKER-9-140>Listing 6-1</A> adds an entry to the application's object accessor dispatch table. This entry indicates that the <CODE>AEResolve</CODE> function should call the <CODE>MyFindTextObjectAccessor</CODE> function when resolving any Apple event object with the <CODE>cText</CODE> object class and a container identified by a token of descriptor type <CODE>typeMyText</CODE>. The other calls to <CODE>AEInstallObjectAccessor</CODE> in <A HREF=#MARKER-9-140>Listing 6-1</A> add entries for Apple event objects of object classes <CODE>cWord</CODE>, <CODE>cItem</CODE>, and <CODE>cChar</CODE> in a container identified by a token of descriptor type <CODE>typeMyText</CODE>. For example, because all the entries created by the code in <A HREF=#MARKER-9-140>Listing 6-1</A> specify the descriptor type <CODE>typeMyText</CODE> for the token that identifies the container, the <CODE>AEResolve</CODE> function calls the <CODE>MyFindWordObjectAccessor</CODE> function to locate a requested word regardless of whether the container for the word is a run of text, another word, a paragraph, or an item. <P>
 The fourth parameter for the <CODE>AEInstallObjectAccessor</CODE> function specifies a reference constant passed to your handler by the Apple Event Manager each time <CODE>AEResolve</CODE> calls your object accessor function. Your application can use this reference constant for any purpose. If your application doesn't use the reference constant, you can use 0 as the value, as shown in <A HREF=#MARKER-9-140>Listing 6-1</A>.<A NAME=MARKER-9-63></A> <P>
 The last parameter for the <CODE>AEInstallObjectAccessor</CODE> function is a Boolean value that determines whether the entry is added to the system object accessor dispatch table (<CODE>TRUE</CODE>) or to your application's object accessor dispatch table (<CODE>FALSE</CODE>). <P>
 If you add an object accessor function to the system object accessor dispatch table, the function that you specify must reside in the system heap. If there was already an entry in the system object accessor dispatch table for the same object class and container descriptor type, that entry is replaced unless you chain it to your system handler. You can do this the same way you chain a previously installed system Apple event handler to your own system handler. See the description of <CODE>AEInstallEventHandler</CODE> on <A HREF=IAC-136.html#MARKER-9-466>page 4-59</A> for details.<P>
<DL>
<DT><B>WARNING</B>
<DD>Before an application calls a system object accessor function, system software has set up the A5 register for the calling application. For this reason, if you provide a system object accessor function, it should never use A5 global variables or anything that depends on a particular context; otherwise, the application that calls the system object accessor function may crash.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 The code shown in <A HREF=#MARKER-9-140>Listing 6-1</A> installs a separate object accessor function for each object class, even though the code specifies the same descriptor type for tokens that identify the containers for Apple event objects of each class. Most word-processing applications can specify the same object accessor function as well as the same token descriptor type for Apple event objects of these four classes, in which case the code shown in <A HREF=#MARKER-9-140>Listing 6-1</A> can be altered as shown in <A HREF=#MARKER-9-142>Listing 6-2</A>.<P>
<B>Listing 6-2  <A NAME=MARKER-9-142></A>Installing one object accessor function that finds elements of different classes for container tokens of one type</B><P>
<PRE>
myErr := AEInstallObjectAccessor(cText, typeMyText, 
                                 @MyFindTextObjectAccessor,
                                 0, FALSE);
IF myErr &lt;&gt; noErr THEN DoError(myErr);
myErr := AEInstallObjectAccessor(cWord, typeMyText, 
                                 @MyFindTextObjectAccessor,
                                 0, FALSE);
IF myErr &lt;&gt; noErr THEN DoError(myErr);
myErr := AEInstallObjectAccessor(cItem, typeMyText, 
                                 @MyFindTextObjectAccessor,
                                 0, FALSE);
IF myErr &lt;&gt; noErr THEN DoError(myErr);
myErr := AEInstallObjectAccessor(cChar, typeMyText, 
                                 @MyFindTextObjectAccessor,
                                 0, FALSE);
IF myErr &lt;&gt; noErr THEN DoError(myErr);
</PRE>
 In some situations you may want to write different object accessor functions to locate Apple event objects of the same object class in containers identified by tokens of different descriptor types. For example, the code in <A HREF=#MARKER-9-143>Listing 6-3</A> installs two different object accessor functions: one that finds a word in a container identified by a token of type <CODE>typeMyTextToken</CODE>, and one that finds a word in a container identified by a token of <CODE>typeMyGraphicTextToken.</CODE><P>
<B>Listing 6-3  <A NAME=MARKER-9-143></A>Installing object accessor functions that find elements of the same class for container tokens of different types</B><P>
<PRE>
myErr := AEInstallObjectAccessor(cWord, typeMyTextToken, 
                                 @MyFindTextObjectAccessor,
                                 0, FALSE);
IF myErr &lt;&gt; noErr THEN DoError(myErr);
myErr := AEInstallObjectAccessor(cWord, typeMyGraphicTextToken, 
                                 @MyFindGrphcTextObjectAccessor,
                                 0, FALSE);
IF myErr &lt;&gt; noErr THEN DoError(myErr);
</PRE>
 Every application must provide one or more object accessor functions that can find Apple event objects in the default container, which is always identified by a token of descriptor type <CODE>typeNull</CODE>. <A HREF=#MARKER-9-145>Listing 6-4</A> demonstrates how to add entries to your application's object accessor dispatch table for the object classes <CODE>cWindow</CODE> and <CODE>cDocument</CODE>. The container for each of these classes is identified by a token of descriptor type <CODE>typeNull</CODE>, which specifies an application's default container.<A NAME=MARKER-2-344></A><P>
<B>Listing 6-4  <A NAME=MARKER-9-145></A>Installing object accessor functions that locate elements of different classes in the default container</B><P>
<PRE>
myErr := AEInstallObjectAccessor(cWindow, typeNull, 
                                 @MyFindWindowObjectAccessor,
                                 0, FALSE);
IF myErr &lt;&gt; noErr THEN DoError(myErr);
myErr := AEInstallObjectAccessor(cDocument, typeNull, 
                                 @MyFindDocumentObjectAccessor,
                                 0, FALSE);
IF myErr &lt;&gt; noErr THEN DoError(myErr);
</PRE>
 For any entry in your object accessor dispatch table, you can specify a wildcard value for the object class, for the descriptor type of the token used to identify the container, or for both. You specify a wildcard by supplying the <CODE>typeWildCard</CODE> constant when installing an entry into the object accessor dispatch table. A wildcard value matches all possible values. <A NAME=MARKER-2-352></A> <A NAME=MARKER-2-301></A> <A NAME=MARKER-2-148></A><P>
 If an object accessor dispatch table contains one entry for a specific object class and a specific token descriptor type, and another entry that is identical except that it specifies a wildcard value for either the object class or the token descriptor type, the Apple Event Manager dispatches the more specific entry. For example, if an object accessor dispatch table includes one entry that specifies the object class as <CODE>cWord</CODE> and the token descriptor type as <CODE>typeMyTextToken</CODE>, and another entry that specifies the object class as <CODE>cWord</CODE> and the token descriptor type as <CODE>typeWildCard</CODE>, the Apple Event Manager dispatches the object accessor function associated with the entry that specifies <CODE>typeMyTextToken</CODE>.<P>
 If you specify <CODE>typeWildCard</CODE> as the first parameter and <CODE>typeMyToken</CODE> as the second parameter for the <CODE>AEInstallObjectAccessor</CODE> function and no other entry in the dispatch table matches more exactly, the Apple Event Manager calls the object accessor function that you specify in the third parameter when resolving Apple event objects of any object class in containers identified by tokens of the <CODE>typeMyToken</CODE> descriptor type.<P>
 If you specify <CODE>cText</CODE> as the first parameter and <CODE>typeWildCard</CODE> as the second parameter for the <CODE>AEInstallObjectAccessor</CODE> function and no other entry in the dispatch table matches more exactly, the Apple Event Manager calls the object accessor function that you specify in the third parameter when resolving Apple event objects of the object class <CODE>cText</CODE> in containers identified by tokens of any descriptor type. <P>
 If you specify <CODE>typeWildCard</CODE> for both the first and second parameters of the <CODE>AEInstallObjectAccessor</CODE> function and no other entry in the dispatch table matches more exactly, the Apple Event Manager calls the object accessor function that you specify in the third parameter when resolving Apple event objects of any object class in containers identified by tokens of any descriptor type.<A NAME=MARKER-2-377></A><A NAME=MARKER-9-59></A> <P>
 Once the Apple Event Manager finds a matching entry, whether exact or involving type <CODE>typeWildCard</CODE>, that is the only object accessor function it calls for that object class and token descriptor type. If that function fails, the Apple Event Manager won't look for another matching entry in the same table.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-239.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-241.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
