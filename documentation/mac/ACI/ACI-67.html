<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Creating a Color World for Color Matching and Checking Using the Low-Level Functions</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING67></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->




<!-- Main Body -->

<CENTER>
<P>
<A HREF="ACI-66.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="ACI-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="ACI-122.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="ACI-68.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="ACI-2.html"><B>Advanced Color Imaging on the Mac OS</B></A> / <BR><DD><A HREF="ACI-55.html"><B>Chapter 4 - Developing ColorSync-Supportive Applications</B></A> / <A HREF="ACI-60.html"><B>Developing Your ColorSync-Supportive Application</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING67-0></A>
<H2><A NAME=MARKER-9-74></A>Creating a Color World for Color Matching and Checking Using the Low-Level Functions</H2>
 A color world is a reference to a private ColorSync structure that represents a unique color-matching session. Although profiles can be large, a color world is a compact representation of the mapping needed to match between profiles. Conceptually, you can think of a color world as a sort of "matrix multiplication" of two or more profiles that distills all the information contained in the profiles into a fast multidimensional lookup table. <P>
 <A NAME=MARKER-2-75></A>For the ColorSync Manager low-level functions, a color world defines the <A NAME=MARKER-2-76></A>aspects that characterize how the color-matching session will occur based on information contained in the profiles that you supply when your application sets up the color world. Your application can define a color world for color transformations between a source profile and a destination profile, or it can define a color world for color transformations among a series of concatenated profiles. <P>
 For the low-level ColorSync Manager functions, a color world is the equivalent of the ColorSync Manager QuickDraw-based functions' source and destination profiles. From your application's perspective, the difference in specifying profiles for the low-level functions is that instead of calling a function and passing it references to the profiles for the session, first you must create a color world using those profile references and pass the color world to the function. <P>
 Your application calls the <A NAME=MARKER-11-77></A><CODE>NCWNewColorWorld</CODE> function to set up a simple color world for color transformations involving two profiles--a source profile and a destination profile--and the function returns a reference to the color world it creates. Setting up a color world for color processing involving a series of <A NAME=MARKER-2-78></A>concatenated <A NAME=MARKER-2-79></A>profiles or a single device-linked profile, which contains a series of profiles, is slightly more complex. Here are the steps you take:<P>
<OL>
<LI><B>Obtain references to the profiles to use for the concatenated color world. </B><P>
For information describing how to obtain references to the profiles for the color world, see <A HREF=ACI-63.html#MARKER-9-52>"Obtaining Profile References" (page 4-16)</A>. 
<LI><B>Set up an array containing references to the profiles comprising the set.</B><P>
Before your application calls the <CODE>CWConcatColorWorld</CODE> function to create the color world, you must establish the profile set. The ColorSync Manager defines the following data structure of type <CODE>CMConcatProfileSet</CODE> that you use to specify the profile set:<P>
<pre><CODE>struct CMConcatProfileSet {<BR> unsigned short     keyIndex;     <BR> unsigned short     count;     <BR> CMProfileRef     profileSet[1];<BR>}; </CODE></pre><P>
Your application also uses the <CODE>CMConcatProfileSet</CODE> data structure to define a profile set for a device-linked profile. See <A HREF=ACI-73.html#MARKER-9-145>"Creating and Using Device-Linked Profiles" (page 4-52)</A> for more information.<P>
Your application must create an array that contains references to the profiles for the color world, specifying these references in processing order. You must specify the number of profile references in the array as the value of the <CODE>CMConcatProfileSet.count</CODE> field, using a one-based number. You assign the profile array to the <CODE>CMConcatProfileSet.profileSet</CODE> field. <P>
The ColorSync Manager defines rules governing the types of profiles you can specify in a profile array. These rules differ depending on whether you are creating a profile set to create a device-linked profile or to create a concatenated color world. For a list of the rules defining the types of profiles you can use for these purposes, see CWNewLinkProfile <A HREF=#nonexistent-marker>(page 3-112)</A> and CWConcatColorWorld <A HREF=#nonexistent-marker>(page 3-110)</A> in <I>Advanced Color Imaging Reference</I>. 
<LI><B>Identify the CMM for color processing.</B><P>
Each of the profiles whose references you give identifies the preferred CMM for color processing involving that profile. To perform color transformation using a series of profiles, the ColorSync Manager uses only one <A NAME=MARKER-2-80></A>CMM. You use the <CODE>CMConcatProfileSet.keyIndex</CODE> field to identify the index into the array corresponding to the profile whose preferred CMM is to be used. The array is zero based, so you must specify the <CODE>CMConcatProfileSet.keyIndex</CODE> value as a number in the range of 0 to <CODE>count</CODE> - 1, where <CODE>count</CODE> is the number of elements in the array.
<LI><B>Call the <B>CWConcatColorWorld</B> function to set up the color world. </B><P>
You pass the <CODE>CWConcatColorWorld</CODE> function a parameter of type <CODE>CMConcatProfileSet</CODE> to specify the profile array, and the function returns a <A NAME=MARKER-2-81></A>color world reference. To perform color matching or gamut checking using the profiles comprising a color world, you call the low-level function passing it the reference to the color world. <P>
</OL>
 Using a device-linked profile for the low-level functions entails additional steps, described in <A HREF=ACI-73.html#MARKER-9-145>"Creating and Using Device-Linked Profiles" (page 4-52)</A>.<A NAME=MARKER-2-82></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="ACI-66.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="ACI-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="ACI-122.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="ACI-68.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="ACI-3.html">&copy; Apple Computer, Inc.</A><br>13 NOV 1996<P>
<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->
</BODY>
</HTML> 
