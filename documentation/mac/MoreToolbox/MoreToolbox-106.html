<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Inserting the ROM Resource Map (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING106></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-105.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-107.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-9.html"><B>Chapter 1 - Resource Manager</B></A> / <A HREF="MoreToolbox-24.html"><B>Resource Manager Reference</B></A><BR><DL><DD><A HREF="MoreToolbox-105.html"><B>ROM Resources</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING106-0></A>
<H3><A NAME=MARKER-9-523></A>Inserting the ROM Resource Map</H3>
 <A NAME=MARKER-2-524></A>Many system resources are stored in ROM. System software calls the <CODE>InitResources</CODE> function during system startup, and the Resource Manager creates a special heap zone in the system heap and builds a resource map that points to the ROM resources.<P>
 The Resource Manager normally searches ROM resources only when you use the <CODE>RGetResource</CODE> function to get a handle to the resource, and even then only after it searches the System file's resource fork. To search for a resource in ROM before searching the System file's resource fork, your application must first alter the resource search order by inserting the ROM resource map in front of the System file's resource map. <A NAME=MARKER-2-525></A><P>
 When the value of the global variable <CODE>RomMapInsert</CODE> is <CODE>TRUE</CODE>, the Resource Manager inserts the ROM resource map before the System file's resource map for the next call only. When the value of <CODE>RomMapInsert</CODE> is <CODE>TRUE</CODE>, the adjacent variable <CODE>TmpResLoad</CODE> determines whether the value of the global variable <CODE>ResLoad</CODE> is considered <CODE>TRUE</CODE> or <CODE>FALSE</CODE>, overriding the actual value of <CODE>ResLoad</CODE> for the next call only. The values of the <CODE>RomMapInsert</CODE> and <CODE>TmpResLoad</CODE> variables are cleared after each call to a Resource Manager routine. <P>
 The <CODE>RGetResource</CODE> function first calls <CODE>GetResource</CODE>. If <CODE>GetResource</CODE> cannot locate the requested resource in the resource chain, <CODE>RGetResource</CODE> sets <CODE>RomMapInsert</CODE> to <CODE>TRUE</CODE>, then calls <CODE>GetResource</CODE> again. <P>
 To set the <CODE>RomMapInsert</CODE> and <CODE>TmpResLoad</CODE> variables in tandem yourself, you can use two global constants. Set the system global variable <CODE>RomMapInsert</CODE> to the global constant <CODE>mapTrue</CODE> to insert the ROM resource map with <CODE>SetResLoad(TRUE)</CODE>. Set <CODE>RomMapInsert</CODE> to the global constant <CODE>mapFalse</CODE> to insert the ROM resource map with <CODE>SetResLoad(FALSE)</CODE>.<A NAME=MARKER-2-526></A><P>
 There is no real resource fork associated with the ROM resources; the ROM resource map has a path number of 1 (an illegal path reference number). There are two ways to determine whether a handle references a ROM resource. First, you can set up <CODE>RomMapInsert</CODE> and <CODE>TmpResLoad</CODE> and call <CODE>HomeResFile</CODE>; if 1 is returned, the handle is to a ROM resource. Second, you can dereference the handle and check whether the master pointer points to ROM by comparing it to the global variable <CODE>ROMBase</CODE>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-105.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-107.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
