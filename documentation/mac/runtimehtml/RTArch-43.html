<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Weak Libraries and Symbols</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING43></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="RTArch-42.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="RTArch-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="RTArch-147.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="RTArch-44.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="RTArch-2.html"><B>Mac OS Runtime Architectures</B></A> / <BR><DD><A HREF="RTArch-35.html"><B>Chapter 3 - Programming for the CFM-Based Runtime Architecture </B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING43-0></A>
<H1><A NAME=MARKER-9-41></A>Weak Libraries and Symbols</H1>
 <A NAME=MARKER-2-42></A>During the build process, you can designate certain symbols or import libraries to be weak (usually with linker options), which indicates to the Code Fragment Manager that the symbol or library is not required for execution. For example, an application <CODE>mooProg</CODE> may designate the QuickTime shared library as a<B> weak library</B>. Then, while it can make use of QuickTime features if the library exists, it can still launch and execute normally without it. Similarly, a <B>weak symbol</B> is an imported symbol that does not have to be present at launch time. Weak symbols are sometimes called soft imports.<P>
<DL>
<DT><B>IMPORTANT</B>
<DD>Although the Code Fragment Manager allows weak imports to remain unresolved at runtime, the application is still responsible for checking to see if the symbol or library was found and taking appropriate action. For example, if a library was not found, the application might display a message and set a flag to avoid accessing routines or data imported from that library.<EM></EM><EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 If the Code Fragment Manager cannot find imported symbols designated as weak, all references to these imports are replaced with the value <CODE>kUnresolvedSymbolAddress</CODE>. <A HREF=#MARKER-9-43>Listing 3-6</A> shows how you can check for weak imports using this value.<P>
<B>Listing 3-6  <A NAME=MARKER-9-43></A>Testing for weak imports</B><P>
<PRE>
extern int dogCow (char *, ...);
...
if (dogCow == kUnresolvedSymbolAddress)
   DebugStr(&quot;\dogCow is not available.&quot;);
else
   printf(&quot;Hi Clarus\n&quot;);
</PRE>
 The Code Fragment Manager checks for weak libraries before doing any preparation (resolving symbols and so on), and if the library exists, it is subsequently handled as a normal import library. For example, if an error occurs during preparation of the library, the Code Fragment Manager may abort the launch procedure, even though the library was designated as weak. <P>
<DL>
<DT><B>WARNING</B>
<DD>You should not use the <CODE>Gestalt</CODE> function to check for weak imports or weak libraries.<EM></EM><EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 If the Code Fragment Manager cannot find a weak library, you cannot subsequently resolve symbols imported from that library by calling Code Fragment Manager routines (<CODE>GetSharedLibrary</CODE>, for example).<EM> <A NAME=MARKER-2-44></A></EM><P>
<HR>
<center>
<A HREF="RTArch-42.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="RTArch-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="RTArch-147.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="RTArch-44.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="RTArch-3.html">&copy; Apple Computer, Inc.</A><br>11 MARCH 1997<P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML> 
