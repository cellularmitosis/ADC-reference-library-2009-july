<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>SetComponentInstanceStorage (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING376></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-375.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-377.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-333.html"><B>Chapter 6 - Component Manager</B></A> / <A HREF="MoreToolbox-346.html"><B>Component Manager Reference</B></A><BR><DL><DD><A HREF="MoreToolbox-366.html"><B>Routines for Components</B></A> / <A HREF="MoreToolbox-375.html"><B>Managing Component Connections</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING376-0></A>
<H3><A NAME=MARKER-9-320></A>SetComponentInstanceStorage</H3>
 <A NAME=MARKER-2-321></A>When an application or component opens a connection to your component, the Component Manager sends your component an open request. In response to this open request, your component should set up an environment to service the connection. Typically, your component should allocate some memory for the connection. Your component can then use that memory to maintain state information appropriate to the connection.<P>
 The <CODE>SetComponentInstanceStorage</CODE> procedure allows your component to pass a handle to this memory to the Component Manager. The Component Manager then provides this handle to your component each time the client application requests service from this connection. <P>
<PRE>
PROCEDURE SetComponentInstanceStorage 
      (aComponentInstance: ComponentInstance; theStorage: Handle);
</PRE>
<DL>
<DT><CODE><A NAME=MARKER-2-322></A>aComponentInstance</CODE>
<DD> The connection to associate with the allocated memory. The Component Manager provides a component instance to your component when the connection is opened.
<DT><CODE><A NAME=MARKER-2-323></A>theStorage</CODE>
<DD> A handle to the memory that your component has allocated for the connection. Your component must allocate this memory in the current heap. The Component Manager saves this handle and provides it to your component, along with other parameters, in subsequent requests to this connection.
</DL>
<A NAME=HEADING376-6></A>
<H5>DESCRIPTION</H5>
 The <CODE>SetComponentInstanceStorage</CODE> procedure associates the handle passed in the parameter <CODE>theStorage</CODE> with the connection specified by the <CODE>aComponentInstance</CODE> parameter. Your component should dispose of any allocated memory for the connection only in response to the close request.<P>
<A NAME=HEADING376-8></A>
<H5>SPECIAL CONSIDERATIONS </H5>
 Note that whenever an open request fails, the Component Manager <BR>always issues the close request. Furthermore, the value stored with <CODE>SetComponentInstanceStorage</CODE> is always passed to the close request, so <BR>it must be valid or <CODE>NIL</CODE>. If the open request tries to dispose of its allocated memory before returning, it should call <CODE>SetComponentInstanceStorage</CODE> again with a <CODE>NIL</CODE> handle to keep the Component Manager from passing an invalid handle to the close request.<P>
<A NAME=HEADING376-10></A>
<H5>SEE ALSO</H5>
 For an example that allocates memory in response to an open request, see <A HREF=MoreToolbox-343.html#MARKER-9-67>Listing 6-6 on page 6-19</A>. <A NAME=MARKER-2-138></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-375.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-377.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
