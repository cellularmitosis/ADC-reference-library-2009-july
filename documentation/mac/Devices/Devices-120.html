<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Introduction to SCSI Concepts(IM: D)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING120></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->




<!-- Main Body -->

<CENTER>
<P>
<A HREF="Devices-119.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Devices-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Devices-328.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Devices-121.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Devices-2.html"><B>Devices</B></A> / <BR><DD><A HREF="Devices-119.html"><B>Chapter 3 - SCSI Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING120-0></A>
<H1><A NAME=MARKER-9-7></A>Introduction to SCSI Concepts</H1>
 The <B>Small Computer System Interface (SCSI)</B> is a computer industry standard for connecting computers to peripheral devices such as hard disk drives, CD-ROM drives, printers, scanners, magnetic tape drives, and any other device that needs to transfer large amounts of data quickly. <P>
 The SCSI standard specifies the hardware and software interface at a level that minimizes dependencies on any specific hardware implementation. The specification allows a wide variety of peripheral devices to be connected to many types of computers. <P>
 A <B>SCSI bus</B> is a bus that conforms to the physical and electrical specifications of the SCSI standard. A <B>SCSI device</B> refers to any unit connected to the SCSI bus, either a peripheral device or a computer. Each SCSI device on the bus is assigned a <A NAME=MARKER-2-8></A><B>SCSI ID</B>, which is an integer value from 0 to 7 that uniquely identifies the device during SCSI transactions. The Macintosh computer is always assigned the SCSI ID value of 7, and its internal hard disk drive is normally assigned the SCSI ID value of 0. In general, only one Macintosh computer can be connected to a SCSI bus at a given time, and most Macintosh models support only a single SCSI bus.<P>
<DL>
<DT><B>SCSI Manager 4.3 Note</B>
<DD>Under the original SCSI Manager, the dual SCSI buses in high-performance computers such as the Macintosh Quadra 950 are treated as though they were a single physical bus. SCSI Manager 4.3 supports multiple SCSI buses and treats each bus separately. <EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 <A NAME=MARKER-9-164></A><A NAME=MARKER-9-163></A>When two SCSI devices communicate, one device acts as the <B>initiator</B> and the other as the <B>target</B>. The initiator begins a transaction by selecting a target device. The target responds to the selection and requests a command. The initiator then sends a SCSI command, and the target carries out the action. After acknowledging the command, the target controls the remainder of the transaction. The role of initiator and target is fixed for each device, and does not usually change. Under the original SCSI Manager, the Macintosh computer always acts as initiator, and peripheral devices are always targets. <P>
<DL>
<DT><B>SCSI Manager 4.3 Note</B>
<DD>SCSI Manager 4.3 allows multiple initiators, meaning that intelligent peripheral devices can initiate SCSI transactions without involving the computer. <EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 SCSI transactions involve interaction between bus signals, bus phases, SCSI commands, and SCSI messages. Although the SCSI Manager masks much of the underlying complexity of SCSI transactions, an understanding of these elements and how they interact will help you understand the role of the SCSI Manager. <P>
 The following sections briefly summarize the elements of a SCSI transaction.<P>
<A NAME=HEADING120-11></A>
<H2><A NAME=MARKER-2-11></A><A NAME=MARKER-9-12></A>SCSI Bus Signals</H2>
 The SCSI specification defines 50 bus signals, half of which are tied to ground. <A HREF=#MARKER-9-2>Table 3-1</A> describes the 18 SCSI bus signals that are relevant to understanding SCSI transactions. Nine of these signals are used to initiate and control transactions, and nine are used for data transfer (8 data bits plus a parity bit).
<TABLE BORDER="0" CELLPADDING=3>
<CAPTION><A NAME=MARKER-9-2></A>  <B>Table 3-1 SCSI bus signals </B></CAPTION>
<TH>Signal<TH>Name<TH>Description<TR>
<TD>/BSY<TD>Busy<TD>Indicates that the bus is in use.<TR>
<TD>/SEL<TD>Select<TD>The initiator uses this signal to select a target.<TR>
<TD>/C/D<TD>Control/Data<TD>The target uses this signal to indicate whether the information being transferred is control information (signal asserted) or data (signal negated).<TR>
<TD>/I/O<TD>Input/Output<TD>The target uses this signal to specify the direction of the data movement with respect to the initiator. When the signal is asserted, data flows to the initiator; when negated, data flows to the target.<TR>
<TD>/MSG<TD>Message<TD>This signal is used by the target during the message phase.<TR>
<TD>/REQ<TD>Request<TD>The target uses this signal to start a request/acknowledge handshake.<TR>
<TD>/ACK<TD>Acknowledge<TD>This signal is used by the initiator to end a request/acknowledge handshake.<TR>
<TD>/ATN<TD>Attention<TD>The initiator uses this signal to inform the target that the initiator has a message ready. The target retrieves the message, at its convenience, by transitioning to a message-out bus phase<TR>
<TD>/RST<TD>Reset<TD>This signal is used to clear all devices and operations from the bus, and force the bus into the bus free phase. The Macintosh computer asserts this signal at startup. SCSI peripheral devices should never assert this signal.<TR>
<TD>/DB0-/DB7, /DBP<TD>Data<TD>Eight data signals, numbered 0 to 7, and the parity signal. Macintosh computers generate proper SCSI parity, but the original SCSI Manager does not detect parity errors in SCSI transactions.<A NAME=MARKER-2-176></A></TABLE>
<P>
<A NAME=HEADING120-13></A>
<H2><A NAME=MARKER-2-13></A><A NAME=MARKER-9-14></A>SCSI Bus Phases</H2>
 A SCSI bus phase is an interval in time during which, by convention, certain control signals are allowed or expected, and others are not. The SCSI bus can never be in more than one phase at any given time.<P>
 For each of the bus phases, there is a set of allowable phases that can follow. For example, the bus free phase can only be followed by the arbitration phase, or by another bus free phase. A data phase can be followed by a command, status, message, or bus free phase.<P>
 Control signals direct the transition from one phase to another. For example, the reset signal invokes the bus free phase, while the attention signal invokes the message phase. <P>
 The SCSI standard specifies eight distinct phases for the SCSI bus:<P>
<UL>
<LI><B>Bus free</B>. This phase means that no SCSI devices are using the bus, and that the bus is available for another SCSI operation.
<LI><B>Arbitration</B>. This phase is preceded by the bus free phase and permits a SCSI device to gain control of the SCSI bus. During this phase, all devices wishing to use the bus assert the /BSY signal and put their SCSI ID onto the bus (using the data signals). The device with highest SCSI ID wins the arbitration.
<LI><B>Selection</B>. This phase follows the arbitration phase. The device that won arbitration uses this phase to select another device to communicate with.
<LI><B>Reselection</B>. This optional phase is used by systems that allow peripheral devices to disconnect and reconnect from the bus during lengthy operations. This phase is not supported by the original Macintosh SCSI Manager, but is by SCSI Manager 4.3.
<LI><B>Command</B>. During this phase, the target requests a command from the initiator.
<LI><B>Data</B>. The data phase occurs when the target requests a transfer of data to or from the initiator. 
<LI><B>Status</B>. This phase occurs when the target requests that status information be sent to the initiator. 
<LI><B>Message</B>. The message phase occurs when the target requests the transfer of a message. Messages are small blocks of data that carry information or requests between the initiator and a target. Multiple messages can be sent during this phase.<P>
</UL>
 Together, the last four phases (command, data, status, and message) are known as the information transfer phases. <A HREF=#MARKER-9-16>Figure 3-1</A> shows the relationship of the SCSI bus phases.<P>
<B>Figure 3-1  <A NAME=MARKER-9-16></A>SCSI bus phases and allowable transitions[Missing image]<A NAME=MARKER-2-17></A></B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/SCSI-L-01.jpg"><p>
<A NAME=HEADING120-29></A>
<H2><A NAME=MARKER-9-18></A><A NAME=MARKER-2-19></A>SCSI Commands</H2>
 A <B>SCSI command</B> is an instruction from an initiator to a target to conduct an operation, such as reading or writing a block of data. Commands are read by the target when it is ready to do so, as opposed to being sent unrequested by the initiator.<P>
 SCSI commands are contained in a data structure called a<B> </B><A NAME=MARKER-2-167></A><B><A NAME=MARKER-9-163></A>command descriptor block (CDB)</B>, which can be 6, 10, or 12 bytes in size. The first byte specifies the operation requested, and the remaining bytes are parameters used by that operation.<P>
 A single SCSI command may cause a peripheral device to undertake a relatively large amount of work, compared with other device interfaces. For example, the read command can specify multiple blocks of data rather than just one. The primary difference between the SCSI protocol and other interfaces typically used for storage devices is that SCSI commands address a device as a series of logical blocks rather than in terms of heads, tracks, and sectors. It is this abstraction from the physical characteristics of the device that allows the SCSI protocol to be used with a wide variety of devices.<A NAME=MARKER-2-22></A><P>
<A NAME=HEADING120-33></A>
<H2><A NAME=MARKER-9-23></A><A NAME=MARKER-2-222></A>SCSI Messages</H2>
 The SCSI standard specifies a number of possible messages between initiator and target. <B>SCSI messages</B> are small blocks of data, often just one byte in size, that indicate the successful completion of an operation (the command complete message), or a variety of other events, requests, and status information. All messages are sent during the message phase.<P>
 The command complete message is required in all SCSI implementations. This message is sent from the target to the initiator and indicates that a command (or series of linked commands) has been completed, either successfully or unsuccessfully. Success or failure of the command is indicated by status information sent earlier during the status phase. The importance of the command complete message is more fully discussed in <A HREF=Devices-122.html#MARKER-9-59>"Using the SCSIComplete Function," beginning on page 3-21</A>.<P>
 Other SCSI messages are optional. During the selection phase, the initiator and target each specify their ability to handle messages other than the command complete message.<A NAME=MARKER-9-165></A><P>
<A NAME=HEADING120-37></A>
<H2><A NAME=MARKER-9-26></A><A NAME=MARKER-2-166></A>SCSI Handshaking</H2>
 The SCSI standard defines the required sequence of transitions of the control and data signals to ensure reliable communication between SCSI devices. Because the request signal (/REQ) and the acknowledge signal (/ACK) both play a major role, this part of the SCSI protocol is often referred to as request/acknowledge handshaking (usually abbreviated as REQ/ACK handshaking).<P>
 The SCSI information transfer phases use REQ/ACK handshaking to transfer data or control information between the initiator and target, in either direction. The direction of the transfer depends on the particular bus phase. The handshaking occurs on every byte transferred, and constitutes the lowest level of the SCSI protocol.<P>
 For example, during the data phase, when a target sends data to the initiator, the target places the data on the SCSI bus data lines and then asserts the /REQ signal. The initiator senses the /REQ signal, reads the data lines, then asserts the /ACK signal. When the target senses the /ACK signal, it releases the data lines and negates the /REQ signal. The initiator then senses that the /REQ signal has been negated, and negates the /ACK signal. After the target senses that the /ACK signal has been negated, it can repeat the whole process again, to transfer another byte of data.<P>
 Unless you are designing a SCSI device, you do not need any special knowledge of SCSI handshaking to write software that uses the SCSI Manager. However, a general understanding of SCSI handshaking can be helpful when debugging. Refer to the SCSI specification for complete information about SCSI handshaking, bus phases, commands, and messages.<A NAME=MARKER-2-28></A><P>

</BLOCKQUOTE>
<HR>
<center>
<A HREF="Devices-119.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Devices-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Devices-328.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Devices-121.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Devices-3.html">&copy; Apple Computer, Inc.</A><br>3 JUL 1996</center></font><P>
<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->
</BODY>
</HTML>  
