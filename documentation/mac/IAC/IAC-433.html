<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Invalidating Users(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING433></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-432.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-434.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-423.html"><B>Chapter 11 - Program-to-Program Communications Toolbox</B></A> / <A HREF="IAC-427.html"><B>Using the PPC Toolbox</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING433-0></A>
<H2><A NAME=MARKER-9-198></A><A NAME=MARKER-21-199></A>Invalidating Users</H2>
 It is your responsibility to invalidate all user reference numbers obtained with the <CODE>StartSecureSession</CODE> function before your application quits. However, while your application remains open, you may want to keep track of a user reference number to start a session with a port, end it, and then later start another session with the same port.<A NAME=MARKER-2-200></A><P>
 Use the <CODE>DeleteUserIdentity</CODE> function to invalidate the user reference number for a particular user.<A NAME=MARKER-2-133></A><P>
<PRE>
err := DeleteUserIdentity (userRef);
</PRE>
 The <CODE>DeleteUserIdentity</CODE> function removes a user by invalidating the specified user reference number. Note that you cannot invalidate the guest reference number (0) and, in most cases, you should not dispose of the default user reference number.<P>
 <A HREF=#MARKER-9-203>Listing 11-20</A> illustrates how you use the <CODE>DeleteUserIdentity</CODE> function to invalidate a user reference number obtained from a <CODE>StartSecureSession</CODE> function. The sample code does not invalidate the user reference number if it is either the default user reference number or the guest reference number (0).<A NAME=MARKER-2-40></A><P>
<B>Listing 11-20  <A NAME=MARKER-9-203></A><A NAME=MARKER-21-204></A>Using the <CODE>DeleteUserIdentity</CODE> function to invalidate a user identity</B><P>
<PRE>
FUNCTION MyDeleteNewUserRefNum(newUserRef: LongInt): OSErr;
VAR
   err:           OSErr;
   defUserRef:    LongInt;
   defUserName:   Str32;
BEGIN
   IF newUserRef &lt;&gt; 0 THEN
   BEGIN {user reference number passed was not the guest}
      err := GetDefaultUser(defUserRef, defUserName);
      IF err = noErr THEN
      BEGIN    {there is a default user}
         IF newUserRef &lt;&gt; defUserRef THEN
            {new user ref number isn't the default user ref num, }
            { so ok to delete}
            err := DeleteUserIdentity(newUserRef);
      END
      ELSE     {there is no default, so delete new user ref num}
         err := DeleteUserIdentity(newUserRef);
      MyDeleteNewUserRefNum := err;
   END
   ELSE {user reference number passed was the guest}
      MyDeleteNewUserRefNum := noErr;
END;
</PRE>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-432.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-434.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
