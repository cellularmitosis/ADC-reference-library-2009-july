<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>IMVideoDataSource Protocol Reference</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="IMVideoDataSource Protocol Reference"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40004742-CH3" title="IMVideoDataSource"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> &gt; <a href="../../../../../reference/Cocoa/index.html#//apple_ref/doc/uid/TP30001281-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../../../reference/Cocoa/idxAppleApplications-date.html#//apple_ref/doc/uid/TP30001281-TP30000416-TP30000900" target="_top">Apple Applications</a> &gt; <a href="../index.html" target="_top">IMVideoDataSource Protocol Reference</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <!-- Previous button --><span style="margin-left: 8px"><a href="../RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/occ/cat/IMVideoDataSource" title="IMVideoDataSource"></a><a name="//apple_ref/doc/uid/TP40004742-CH3-SW5" title="IMVideoDataSource"></a><h1>IMVideoDataSource Protocol Reference</h1><p class="protocol_subtitle">(informal protocol)</p><div class="spec_sheet_info_box"><table cellspacing="0" class="specbox"><tr><td scope="row"><strong><span style="white-space: nowrap;">Framework</span></strong></td><td><div style="margin-bottom:1px">/System/Library/Frameworks/<a href="../../../../AppleApplications/Reference/InstantMessageFramework/index.html#//apple_ref/doc/uid/TP40001249" target="_top">InstantMessage.framework</a></div></td></tr><tr><td scope="row"><strong><span class="noWrap">Companion guide</span></strong></td><td><div style="margin-bottom:1px"><span class="content_text"><a href="../../../../AppleApplications/Conceptual/InstantMessageProgGuide/index.html#//apple_ref/doc/uid/TP40004929" target="_top">Instant Message Programming Guide</a></span><br/></div></td></tr><tr><td scope="row"><strong><span style="white-space: nowrap;">Declared in</span></strong></td><td><div style="margin-bottom:1px"><span class="content_text">IMAVManager.h</span><br/></div></td></tr></table></div><br/><a name="//apple_ref/doc/uid/TP40004742-CH3-DontLinkElementID_1" title="Overview"></a><h2>Overview</h2><p class="spaceabove"><code>IMVideoDataSource</code> is an informal protocol that an <code>IMAVManager</code> data source must conform to in order to provide video data to iChat AV.</p><p>To provide video when the <code>CVPixelBuffer</code> representation is preferred, the data source must implement both the <code><a href="Reference.html#//apple_ref/occ/instm/NSObject/getPixelBufferPixelFormat:">getPixelBufferPixelFormat:</a></code> and <code><a href="Reference.html#//apple_ref/occ/instm/NSObject/renderIntoPixelBuffer:forTime:">renderIntoPixelBuffer:forTime:</a></code> methods. Otherwise, to provide video when the <code>CVOpenGLBuffers</code> representation is preferred, the data source must implement both the  <code><a href="Reference.html#//apple_ref/occ/instm/NSObject/getOpenGLBufferContext:pixelFormat:">getOpenGLBufferContext:pixelFormat:</a></code> and <code><a href="Reference.html#//apple_ref/occ/instm/NSObject/renderIntoOpenGLBuffer:onScreen:forTime:">renderIntoOpenGLBuffer:onScreen:forTime:</a></code> methods. </p><a name="//apple_ref/doc/uid/TP40004742-CH3-DontLinkElementID_2" title="Tasks"></a><h2>Tasks</h2>
<a name="//apple_ref/doc/uid/TP40004742-CH3-SW6" title="Providing Pixel Buffered Video"></a>
		<h3 class="tasks">Providing Pixel Buffered Video</h3>
		
		
		
		
		<ul class="tooltip">
			
				
                <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                    
                    <code><a href="Reference.html#//apple_ref/occ/instm/NSObject/getPixelBufferPixelFormat:">&#8211;&#xA0;getPixelBufferPixelFormat:</a></code>
                    
                    			
                        <img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Returns the pixel buffer format.'/>
                    
                </span></li>
			
				
                <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                    
                    <code><a href="Reference.html#//apple_ref/occ/instm/NSObject/renderIntoPixelBuffer:forTime:">&#8211;&#xA0;renderIntoPixelBuffer:forTime:</a></code>
                    
                    			
                        <img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Provides data for the next video frame using pixel buffering.'/>
                    
                </span></li>
			
		</ul>


<a name="//apple_ref/doc/uid/TP40004742-CH3-SW7" title="Providing OpenGL Buffered Video"></a>
		<h3 class="tasks">Providing OpenGL Buffered Video</h3>
		
		
		
		
		<ul class="tooltip">
			
				
                <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                    
                    <code><a href="Reference.html#//apple_ref/occ/instm/NSObject/getOpenGLBufferContext:pixelFormat:">&#8211;&#xA0;getOpenGLBufferContext:pixelFormat:</a></code>
                    
                    			
                        <img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Returns the pixel OpenGL buffer context and pixel format.'/>
                    
                </span></li>
			
				
                <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                    
                    <code><a href="Reference.html#//apple_ref/occ/instm/NSObject/renderIntoOpenGLBuffer:onScreen:forTime:">&#8211;&#xA0;renderIntoOpenGLBuffer:onScreen:forTime:</a></code>
                    
                    			
                        <img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Provides data for the next video frame using OpenGL buffering.'/>
                    
                </span></li>
			
		</ul>


<a name="//apple_ref/doc/uid/TP40004742-CH3-DontLinkElementID_3" title="Instance Methods"></a><h2>Instance Methods</h2><a name="//apple_ref/occ/instm/NSObject/getOpenGLBufferContext:pixelFormat:" title="getOpenGLBufferContext:pixelFormat:"></a><a name="//apple_ref/doc/uid/TP40004742-CH3-SW3" title="getOpenGLBufferContext:pixelFormat:"></a><a name="//apple_ref/doc/uid/TP40004742-CH3-DontLinkElementID_4"></a><h3 class="verytight">getOpenGLBufferContext:pixelFormat:</h3><p class="spaceabove">Returns the pixel OpenGL buffer context and pixel format.</p><p class="spaceabovemethod">- (void)getOpenGLBufferContext:(<a href="../../../../GraphicsImaging/Reference/CGL_OpenGL/Reference/reference.html#//apple_ref/doc/c_ref/CGLContextObj" target="_top">CGLContextObj</a> *)<em>contextOut</em> pixelFormat:(<a href="../../../../GraphicsImaging/Reference/CGL_OpenGL/Reference/reference.html#//apple_ref/doc/c_ref/CGLPixelFormatObj" target="_top">CGLPixelFormatObj</a> *)<em>pixelFormatOut</em></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>contextOut</em></dt><dd><p>The OpenGL context to be used for the <code>CVOpenGLBufferRef</code> instances passed to the <code>renderIntoOpenGLBuffer:onScreen:forTime:</code> method.</p></dd><dt><em>pixelFormatOut</em></dt><dd><p>The OpenGL pixel format to be used for the <code>CVOpenGLBufferRef</code> instances passed to the <code>renderIntoOpenGLBuffer:onScreen:forTime:</code> method.</p></dd></dl><h5 class="tight">Discussion</h5><p>This method is invoked once after <code><a href="../../IMManager_Class/Reference/Reference.html#//apple_ref/occ/instm/IMAVManager/setVideoDataSource:" target="_top">setVideoDataSource:</a></code> is sent to an <code>IMAVManager</code> object.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="Reference.html#//apple_ref/occ/instm/NSObject/renderIntoOpenGLBuffer:onScreen:forTime:">&#8211;&#xA0;renderIntoOpenGLBuffer:onScreen:forTime:</a></code></li></ul><h5 class="tight">Declared In</h5><code>IMAVManager.h</code><a name="//apple_ref/occ/instm/NSObject/getPixelBufferPixelFormat:" title="getPixelBufferPixelFormat:"></a><a name="//apple_ref/doc/uid/TP40004742-CH3-SW1" title="getPixelBufferPixelFormat:"></a><a name="//apple_ref/doc/uid/TP40004742-CH3-DontLinkElementID_5"></a><h3 class="verytight">getPixelBufferPixelFormat:</h3><p class="spaceabove">Returns the pixel buffer format.</p><p class="spaceabovemethod">- (void)getPixelBufferPixelFormat:(<!--a  -->OSType<!--/a--> *)<em>pixelFormatOut</em></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>pixelFormatOut</em></dt><dd><p>The pixel format to be used for the <code>CVPixelBufferRef</code> instances passed to the <code>renderIntoPixelBuffer:forTime:</code> method.</p></dd></dl><h5 class="tight">Discussion</h5><p>This method is invoked once after <code><a href="../../IMManager_Class/Reference/Reference.html#//apple_ref/occ/instm/IMAVManager/setVideoDataSource:" target="_top">setVideoDataSource:</a></code> is sent to an <code>IMAVManager</code> object.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="Reference.html#//apple_ref/occ/instm/NSObject/renderIntoPixelBuffer:forTime:">&#8211;&#xA0;renderIntoPixelBuffer:forTime:</a></code></li></ul><h5 class="tight">Declared In</h5><code>IMAVManager.h</code><a name="//apple_ref/occ/instm/NSObject/renderIntoOpenGLBuffer:onScreen:forTime:" title="renderIntoOpenGLBuffer:onScreen:forTime:"></a><a name="//apple_ref/doc/uid/TP40004742-CH3-SW4" title="renderIntoOpenGLBuffer:onScreen:forTime:"></a><a name="//apple_ref/doc/uid/TP40004742-CH3-DontLinkElementID_6"></a><h3 class="verytight">renderIntoOpenGLBuffer:onScreen:forTime:</h3><p class="spaceabove">Provides data for the next video frame using OpenGL buffering.</p><p class="spaceabovemethod">- (BOOL)renderIntoOpenGLBuffer:(<a href="../../../../GraphicsImaging/Reference/CoreVideoRef/Reference/reference.html#//apple_ref/doc/c_ref/CVOpenGLBufferRef" target="_top">CVOpenGLBufferRef</a>)<em>buffer</em> onScreen:(int *)<em>screenInOut</em> forTime:(<a href="../../../../GraphicsImaging/Reference/CoreVideoRef/Reference/reference.html#//apple_ref/doc/c_ref/CVTimeStamp" target="_top">CVTimeStamp</a> *)<em>timeStamp</em></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>buffer</em></dt><dd><p>The OpenGL buffer to fill. The receiver should call the <code><a href="../../../../GraphicsImaging/Reference/CoreVideoRef/Reference/reference.html#//apple_ref/c/func/CVOpenGLBufferAttach" target="_top">CVOpenGLBufferAttach</a></code> function and then fill the buffer with video data.</p></dd><dt><em>screenInOut</em></dt><dd><p>The recommended virtual screen number to pass to the <code><a href="../../../../GraphicsImaging/Reference/CoreVideoRef/Reference/reference.html#//apple_ref/c/func/CVOpenGLBufferAttach" target="_top">CVOpenGLBufferAttach</a></code> function for maximum efficiency. The receiver may use a different screen number, but it must write that value back into <em>screenInOut</em> before returning.</p></dd><dt><em>timeStamp</em></dt><dd><p>The frame time for which the buffer should be rendered.</p><p>You should render a video frame that corresponds to the supplied host time, <code>timeStamp->hostTime</code>, and before returning from this method, change the host time to the earliest time for which the rendered video is valid. For example, if the content is a movie, then set the host time to correspond to the rendered frameÃ¢ÂÂtypically, slightly earlier than the original host time. If the content is a photo slideshow, then set the host time to the time the image first appeared which can be several seconds before the original host time. Adjusting the time this way helps synchronize the audio with the video track.</p></dd></dl><h5 class="tight">Return Value</h5><p>Returns <code>YES</code> if the buffer is successfully filled with new frame data. Returns <code>NO</code> if nothing changed or an error was encountered.</p><h5 class="tight">Discussion</h5><p>This method is invoked each time a frame is sent to iChat AV. This method is not invoked on the main thread.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="Reference.html#//apple_ref/occ/instm/NSObject/getOpenGLBufferContext:pixelFormat:">&#8211;&#xA0;getOpenGLBufferContext:pixelFormat:</a></code></li></ul><h5 class="tight">Declared In</h5><code>IMAVManager.h</code><a name="//apple_ref/occ/instm/NSObject/renderIntoPixelBuffer:forTime:" title="renderIntoPixelBuffer:forTime:"></a><a name="//apple_ref/doc/uid/TP40004742-CH3-SW2" title="renderIntoPixelBuffer:forTime:"></a><a name="//apple_ref/doc/uid/TP40004742-CH3-DontLinkElementID_7"></a><h3 class="verytight">renderIntoPixelBuffer:forTime:</h3><p class="spaceabove">Provides data for the next video frame using pixel buffering.</p><p class="spaceabovemethod">- (BOOL)renderIntoPixelBuffer:(<a href="../../../../GraphicsImaging/Reference/CoreVideoRef/Reference/reference.html#//apple_ref/doc/c_ref/CVPixelBufferRef" target="_top">CVPixelBufferRef</a>)<em>buffer</em> forTime:(<a href="../../../../GraphicsImaging/Reference/CoreVideoRef/Reference/reference.html#//apple_ref/doc/c_ref/CVTimeStamp" target="_top">CVTimeStamp</a> *)<em>timeStamp</em></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>buffer</em></dt><dd><p>The pixel buffer to fill with video data. The dimensions can vary. Use the <code><a href="../../../../GraphicsImaging/Reference/CoreVideoRef/Reference/reference.html#//apple_ref/c/func/CVPixelBufferGetWidth" target="_top">CVPixelBufferGetWidth</a></code> and <code><a href="../../../../GraphicsImaging/Reference/CoreVideoRef/Reference/reference.html#//apple_ref/c/func/CVPixelBufferGetHeight" target="_top">CVPixelBufferGetHeight</a></code> functions to get the dimensions each time this method is invoked.</p></dd><dt><em>timeStamp</em></dt><dd><p>The frame time for which the buffer should be rendered.</p><p>You should render a video frame that corresponds to the supplied host time, <code>timeStamp->hostTime</code>, and before returning from this method, change the host time to the earliest time for which the rendered video is valid. For example, if the content is a movie, then set the host time to correspond to the rendered frameÃ¢ÂÂtypically, slightly earlier than the original host time. If the content is a photo slideshow, then set the host time to the time the image first appeared which can be several seconds before the original host time. Adjusting the time this way helps synchronize the audio with the video track.</p></dd></dl><h5 class="tight">Return Value</h5><p>Returns <code>YES</code> if the buffer is successfully filled with new frame data. Returns <code>NO</code> if nothing changed or an error was encountered.</p><h5 class="tight">Discussion</h5><p>This method is invoked each time a frame is sent to iChat AV. This method is not invoked on the main thread.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="Reference.html#//apple_ref/occ/instm/NSObject/getPixelBufferPixelFormat:">&#8211;&#xA0;getPixelBufferPixelFormat:</a></code></li></ul><h5 class="tight">Declared In</h5><code>IMAVManager.h</code>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <!-- Previous button --><span style="margin-left: 8px"><a href="../RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-07-08<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Reference/IMAVDataSource_Protocol/Reference/Reference.html%3Fid%3DTP40004742-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Reference/IMAVDataSource_Protocol/Reference/Reference.html%3Fid%3DTP40004742-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Reference/IMAVDataSource_Protocol/Reference/Reference.html%3Fid%3DTP40004742-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>