<html><head><title>Mac OS X Server
 Manual Page For clamd.conf(5)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/5/clamd.conf" title="Mac OS X Server
 Manual Page for clamd.conf(5)"><!-- headerDoc=man; indexgroup=Section 5; uid="//apple_ref/doc/man/5/clamd.conf"; name=clamd.conf(5) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac&nbsp;OS&nbsp;X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>

<p style='text-align:justify;'>This manual page is associated with Mac&nbsp;OS&nbsp;X&nbsp;Server.  It is
not available on standard Mac OS X (client) installations.</p>

<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
clamd.conf(5)                                  Clam AntiVirus                                  clamd.conf(5)



<b>NAME</b>
       <b>clamd.conf</b> - Configuration file for Clam AntiVirus Daemon

<b>DESCRIPTION</b>
       clamd.conf configures the Clam AntiVirus daemon, <a href="../man8/clamd.8.html#//apple_ref/doc/man/8/clamd">clamd(8)</a>.

<b>FILE</b> <b>FORMAT</b>
       The file consists of comments and options with arguments. Each line which starts with a hash (<b>#</b>) sym-<font color="#ffffff" class="whiteout">bol&nbsp;symbol</font>
       bol is ignored by the parser. Options and arguments are case sensitive and of the form  <b>Option</b>  <b>Argu</b>-<font color="#ffffff" class="whiteout">ment.&nbsp;Argument.</font>
       <b>ment</b>. The arguments are of the following types:

       <b>BOOL</b>   Boolean value (yes/no or true/false or 1/0).

       <b>STRING</b> String without blank characters.

       <b>SIZE</b>   Size in bytes. You can use 'M' or 'm' modifiers for megabytes and 'K' or 'k' for kilobytes.

       <b>NUMBER</b> Unsigned integer.

<b>DIRECTIVES</b>
       When  some  option is not used (commented out or not included in the configuration file at all) clamd
       takes a default action.

       <b>Example</b>
              If this option is set clamd will not run.

       <b>LogFile</b> <b>STRING</b>
              Enable logging to selected file.
              Default: no

       <b>LogFileUnlock</b> <b>BOOL</b>
              Disable a system lock that protects against running clamd with  the  same  configuration  file
              multiple times.
              Default: no

       <b>LogFileMaxSize</b> <b>SIZE</b>
              Limit  the  size  of  the  log  file. The logger will be automatically disabled if the file is
              greater than SIZE. Value of 0 disables the limit.
              Default: 1M

       <b>LogTime</b> <b>BOOL</b>
              Log time for each message.
              Default: no

       <b>LogClean</b> <b>BOOL</b>
              Log clean files.
              Default: no

       <b>LogSyslog</b> <b>BOOL</b>
              Use system logger (can work together with LogFile).
              Default: no

       <b>LogFacility</b> <b>STRING</b>
              Specify the type of syslog messages - please refer to 'man syslog' for facility names.
              Default: LOG_LOCAL6

       <b>LogVerbose</b> <b>BOOL</b>
              Enable verbose logging.
              Default: no

       <b>PidFile</b> <b>STRING</b>
              Save the process identifier of a listening daemon (main thread) to a specified file.
              Default: no

       <b>TemporaryDirectory</b> <b>STRING</b>
              Optional path to the global temporary directory.
              Default: system specific (usually /tmp or /var/tmp).

       <b>DatabaseDirectory</b> <b>STRING</b>
              Path to a directory containing database files.
              Default: /private/var/clamav

       <b>LocalSocket</b> <b>STRING</b>
              Path to a local (Unix) socket the daemon will listen on.
              Default: no

       <b>FixStaleSocket</b> <b>BOOL</b>
              Remove stale socket after unclean shutdown.
              Default: no

       <b>TCPSocket</b> <b>NUMBER</b>
              TCP port number the daemon will listen on.
              Default: no

       <b>TCPAddr</b> <b>STRING</b>
              TCP socket address to bind to. By default clamd binds to INADDR_ANY.
              Default: no

       <b>MaxConnectionQueueLength</b> <b>NUMBER</b>
              Maximum length the queue of pending connections may grow to.
              Default: 15

       <b>MaxThreads</b> <b>NUMBER</b>
              Maximum number of threads running at the same time.
              Default: 10

       <b>ReadTimeout</b> <b>NUMBER</b>
              Waiting for data from a client socket will timeout after this time (seconds).
              Default: 120

       <b>IdleTimeout</b> <b>NUMBER</b>
              Waiting for a new job will timeout after this time (seconds).
              Default: 30

       <b>MaxDirectoryRecursion</b> <b>NUMBER</b>
              Maximum depth directories are scanned at.
              Default: 15

       <b>FollowDirectorySymlinks</b> <b>BOOL</b>
              Follow directory symlinks.
              Default: no

       <b>FollowFileSymlinks</b> <b>BOOL</b>
              Follow regular file symlinks.
              Default: no

       <b>SelfCheck</b> <b>NUMBER</b>
              Perform a database check.
              Default: 1800

       <b>VirusEvent</b> <b>COMMAND</b>
              Execute COMMAND when a virus is found. In the command string %v  will  be  replaced  with  the
              virus name.
              Default: no

       <b>ExitOnOOM</b> <b>BOOL</b>
              Stop daemon when libclamav reports out of memory condition.
              Default: no

       <b>User</b> <b>STRING</b>
              Run as another user (clamd must be started by root to make this option working).
              Default: no

       <b>AllowSupplementaryGroups</b> <b>BOOL</b>
              Initialize supplementary group access (clamd must be started by root).
              Default: no

       <b>Foreground</b> <b>BOOL</b>
              Don't fork into background.
              Default: no

       <b>Debug</b> <b>BOOL</b>
              Enable debug messages from libclamav.

       <b>LeaveTemporaryFiles</b> <b>BOOL</b>
              Do not remove temporary files (for debug purpose).
              Default: no

       <b>StreamMaxLength</b> <b>SIZE</b>
              Clamd uses FTP-like protocol to receive data from remote clients. If you are using clamav-mil-<font color="#ffffff" class="whiteout">ter&nbsp;clamav-milter</font>
              ter to balance load between remote clamd daemons on firewall servers you may need to tune  the
              Stream*  options. This option allows you to specify the upper limit for data size that will be
              transfered to remote daemon when scanning a single file. It should match your MTA's limit  for
              a maximum attachment size.
              Default: 10M

       <b>StreamMinPort</b> <b>NUMBER</b>
              Limit data port range.
              Default: 1024

       <b>StreamMaxPort</b> <b>NUMBER</b>
              Limit data port range.
              Default: 2048

       <b>DetectPUA</b>
              Detect Possibly Unwanted Applications.
              Default: No

       <b>AlgorithmicDetection</b> <b>BOOL</b>
              In  some  cases (eg. complex malware, exploits in graphic files, and others), ClamAV uses spe-<font color="#ffffff" class="whiteout">cial&nbsp;special</font>
              cial algorithms to provide accurate detection. This option controls the algorithmic detection.
              Default: yes

       <b>ScanPE</b> <b>BOOL</b>
              PE  stands  for Portable Executable - it's an executable file format used in all 32 and 64-bit
              versions of Windows operating systems. This option allows ClamAV to perform a deeper  analysis
              of  executable  files  and  it's also required for decompression of popular executable packers
              such as UPX.
              Default: yes

       <b>ScanELF</b> <b>BOOL</b>
              Executable and Linking Format is a standard format for UN*X executables.  This  option  allows
              you to control the scanning of ELF files.
              Default: yes

       <b>DetectBrokenExecutables</b> <b>BOOL</b>
              With  this  option clamd will try to detect broken executables (both PE and ELF) and mark them
              as Broken.Executable.
              Default: no

       <b>ScanOLE2</b> <b>BOOL</b>
              This option enables scanning of OLE2 files, such as Microsoft Office documents and .msi files.
              Default: yes

       <b>ScanPDF</b> <b>BOOL</b>
              This option enables scanning within PDF files.
              Default: no

       <b>ScanHTML</b> <b>BOOL</b>
              Enables HTML detection and normalisation.
              Default: yes

       <b>ScanMail</b> <b>BOOL</b>
              Enable scanning of mail files.
              Default: yes

       <b>MailFollowURLs</b> <b>BOOL</b>
              If  an  email  contains  URLs ClamAV can download and scan them. <b>WARNING:</b> <b>This</b> <b>option</b> <b>may</b> <b>open</b>
              <b>your</b> <b>system</b> <b>to</b> <b>a</b> <b>DoS</b> <b>attack.</b> <b>Never</b> <b>use</b> <b>it</b> <b>on</b> <b>loaded</b> <b>servers.</b>
              Default: no

       <b>MailMaxRecursion</b> <b>NUMBER</b>
              Recursion level limit for the mail scanner.
              Default: 64

       <b>PhishingSignatures</b> <b>BOOL</b>
              With this option enabled ClamAV will try to detect phishing attempts by using signatures.
              Default: yes

       <b>PhishingScanURLs</b> <b>BOOL</b>
              Scan URLs found in mails for phishing attempts using heuristics. This will classify  "Possibly
              Unwanted" phishing emails as Phishing.Heuristics.Email.*
              Default: yes

       <b>PhishingRestrictedScan</b> <b>BOOL</b>
              Use  phishing detection only for domains listed in the .pdb database. It is not recommended to
              have this option turned off, because scanning of all domains may lead to many false positives!
              Default: yes

       <b>PhishingAlwaysBlockSSLMismatch</b> <b>BOOL</b>
              Always  block  SSL mismatches in URLs, even if the URL isn't in the database. This can lead to
              false positives.
              Default: no

       <b>PhishingAlwaysBlockCloak</b> <b>BOOL</b>
              Always block cloaked URLs, even if URL isn't in database. This can lead to false positives.
              Default: no

       <b>ScanArchive</b> <b>BOOL</b>
              Enable archive scanning.
              Default: yes

       <b>ArchiveMaxFileSize</b> <b>SIZE</b>
              Files in archives larger than this limit won't be scanned. Value of 0 disables the limit.
              Default: 10M

       <b>ArchiveMaxRecursion</b> <b>NUMBER</b>
              Limit archive recursion level. Value of 0 disables the limit.
              Default: 8

       <b>ArchiveMaxFiles</b> <b>NUMBER</b>
              Number of files to be scanned within an archive. Value of 0 disables the limit.
              Default: 1000

       <b>ArchiveMaxCompressionRatio</b> <b>NUMBER</b>
              Analyze compression ratio of every file in an archive and  mark  potential  archive  bombs  as
              viruses (0 disables the limit).
              Default: 250

       <b>ArchiveLimitMemoryUsage</b> <b>BOOL</b>
              Use  slower decompression algorithm which uses less memory. This option only affects the bzip2
              decompressor.
              Default: no

       <b>ArchiveBlockEncrypted</b> <b>BOOL</b>
              Mark encrypted archives as viruses (Encrypted.Zip, Encrypted.RAR).
              Default: no

       <b>ArchiveBlockMax</b> <b>BOOL</b>
              Mark archives as viruses (e.g  RAR.ExceededFileSize,  Zip.ExceededFilesLimit)  if  ArchiveMax-<font color="#ffffff" class="whiteout">Files,&nbsp;ArchiveMaxFiles,</font>
              Files, ArchiveMaxFileSize, or ArchiveMaxRecursion limit is reached.
              Default: no

       <b>NodalCoreAcceleration</b> <b>BOOL</b>
              Enable support for Sensory Networks' NodalCore hardware accelerator.
              Default: no

       <b>ClamukoScanOnAccess</b> <b>BOOL</b>
              Enable Clamuko. Dazuko (/dev/dazuko) must be configured and running.
              Default: no

       <b>ClamukoScanOnOpen</b> <b>BOOL</b>
              Scan files on open.
              Default: no

       <b>ClamukoScanOnClose</b> <b>BOOL</b>
              Scan files on close.
              Default: no.

       <b>ClamukoScanOnExec</b> <b>BOOL</b>
              Scan files on execute.
              Default: no

       <b>ClamukoIncludePath</b> <b>STRING</b>
              Set  the  include  paths (all files and directories inside them will be scanned). You can have
              multiple ClamukoIncludePath directives but each directory must be added in a separate line).
              Default: no

       <b>ClamukoExcludePath</b> <b>STRING</b>
              Set the exclude paths. All subdirectories will also be excluded.
              Default: no

       <b>ClamukoMaxFileSize</b> <b>SIZE</b>
              Ignore files larger than SIZE.
              Default: 5M

<b>FILES</b>
       /private/etc/clamd.conf

<b>AUTHOR</b>
       Tomasz Kojm &lt;tkojm@clamav.net&gt;

<b>SEE</b> <b>ALSO</b>
       <a href="../man8/clamd.8.html#//apple_ref/doc/man/8/clamd">clamd(8)</a>, <a href="../man1/clamdscan.1.html#//apple_ref/doc/man/1/clamdscan">clamdscan(1)</a>, <!-- a -->clamav-milter(8)<!-- /a -->, <a href="../man1/clamscan.1.html#//apple_ref/doc/man/1/clamscan">clamscan(1)</a>, <a href="../man1/freshclam.1.html#//apple_ref/doc/man/1/freshclam">freshclam(1)</a>, <a href="../man1/sigtool.1.html#//apple_ref/doc/man/1/sigtool">sigtool(1)</a>



ClamAV 0.91.2                                 February 12, 2007                                clamd.conf(5)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man5/clamd.conf.5.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man5/clamd.conf.5.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man5/clamd.conf.5.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
