<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>QuickTime Transport and Delivery Guide: Using Data Handler Components</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Using Data Handler Components"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents" title="Using Data Handler Components"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000433" target="_top">QuickTime</a> &gt; <a href="../../../../TransportDelivery-date.html#//apple_ref/doc/uid/TP30000440-TP30000433-TP30000580" target="_top">Transport &amp; Delivery</a> &gt; <a href="../A-Intro/1Introduction.html#//apple_ref/doc/uid/TP40000861-IntroductiontoQuickTimeTransportandDeliveryGuide-DontLinkElementID_54">QuickTime Transport and Delivery Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../B-Chapter/2AboutDataHandlerCom.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../D-Chapter/4VideoOutputComponen.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-SW1" title="Using Data Handler Components"></a>
<h1>Using Data Handler Components</h1>

<p>This section describes how applications use data handler components. You should read this section if you are writing your own media handler or your own data handler.</p>



<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="3UsingDataHandlerCom.html#//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_8">Selecting a Data Handler</a>
				
			<br/>
			
        
			
			
				<a href="3UsingDataHandlerCom.html#//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_9">Selecting by Component Type Value</a>
				
			<br/>
			
        
			
			
				<a href="3UsingDataHandlerCom.html#//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_10">Interrogating a Data Handler's Capabilities</a>
				
			<br/>
			
        
			
			
				<a href="3UsingDataHandlerCom.html#//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_11">Managing Data References</a>
				
			<br/>
			
        
			
			
				<a href="3UsingDataHandlerCom.html#//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_12">Working With Data References</a>
				
			<br/>
			
        
			
			
				<a href="3UsingDataHandlerCom.html#//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_13">Retrieving Movie Data</a>
				
			<br/>
			
        
			
			
				<a href="3UsingDataHandlerCom.html#//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_15">Reading Movie Data</a>
				
			<br/>
			
        
			
			
				<a href="3UsingDataHandlerCom.html#//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_16">Storing Movie Data</a>
				
			<br/>
			
        
			
			
				<a href="3UsingDataHandlerCom.html#//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_17">Writing Movie Data</a>
				
			<br/>
			
        
			
			
				<a href="3UsingDataHandlerCom.html#//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_18">Managing the Data Handler</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_8" title="Selecting a Data Handler"></a>
<h2><a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-SelectingaDataHandler" title="Selecting a Data Handler"></a>Selecting a Data Handler</h2>
<p>To help developers choose the best data handler for a specific situation while still making it easy for an application to find a usable data handler, Apple has defined two separate and complementary mechanisms for selecting data handler components. You can use the Component Manager&#8217;s selection mechanisms to find a data handler that meets your needs, or you can interrogate a data handler to determine if it supports a specific data reference. Both mechanisms rely on characteristics of the current data reference in order to make the selection.</p>
<p>Before you can use a data handler component, your application must open a connection to that component. The easiest way to open a connection to a data handler component is to call the Movie Toolbox&#8217;s <code><a href="../../../../Reference/QTRef_TrackAndMedia/Reference/reference.html#//apple_ref/c/func/GetDataHandler" target="_top">GetDataHandler</a></code> function. You supply a data reference and the Movie Toolbox selects an appropriate data handler component for you. This function is preferred for opening a data handler as it reliably chooses the best data handler.</p>
<p>Alternatively, you may use the Component Manager to open your connection. Call the Component Manager&#8217;s <code><a href="../../../../../Carbon/Reference/Component_Manager/Reference/reference.html#//apple_ref/c/func/OpenDefaultComponent" target="_top">OpenDefaultComponent</a></code> or <code><a href="../../../../../Carbon/Reference/Component_Manager/Reference/reference.html#//apple_ref/c/func/OpenComponent" target="_top">OpenComponent</a></code> function to do so, but be aware that these functions are often unable to make the best choice when there are several different data handlers available for a file.</p>

<a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_9" title="Selecting by Component Type Value"></a>
<h2><a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-SelectingbyComponentTypeValue" title="Selecting by Component Type Value"></a>Selecting by Component Type Value</h2>
<p>At the most basic level, your application can use the Component Manager&#8217;s built-in selection mechanisms to find a data handler component for a data reference. You may use the Component Manager&#8217;s <code><a href="../../../../../Carbon/Reference/Component_Manager/Reference/reference.html#//apple_ref/c/func/FindNextComponent" target="_top">FindNextComponent</a></code> function in order to retrieve a list of all data handler components that meet your needs. You specify your request by supplying the component&#8217;s characteristics in a component description record: in particular, in the <code>componentType</code>, <code>componentSubtype</code>, <code>componentManufacturer</code>, and <code>componentFlags</code> fields.</p>
<p>All data handler components have a component type value of <code>'dhlr'</code>, which is defined by the <code>dataHandlerType</code> constant. Data handler components use the value of the component subtype field to indicate the type of data reference they support. As a result of this convention, note that all data handlers that share a component subtype value must be able to recognize and work with data references of the same type. For example, file system data handlers always carry a component subtype value of <code>'alis'</code>, which indicates that their data references are file system aliases (note that this is true for QuickTime on Macintosh and under  Windows, even though there is not, properly, a file system alias under Windows). Apple&#8217;s memory-based data handler for Macintosh has a component subtype value of <code>'hndl'</code>.</p>
<p>Apple has not defined any special manufacturer field values or component flags values for data handler components. You may use the manufacturer field to select data handlers supplied by a specific vendor. To do so, you need to know the correct manufacturer field value for that vendor.</p>

<a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_10" title="Interrogating a Data Handler&#39;s Capabilities"></a>
<h2><a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-InterrogatingaDataHandlersCapabilities" title="Interrogating a Data Handler&#39;s Capabilities"></a>Interrogating a Data Handler's Capabilities</h2>
<p>While you can use the Component Manager&#8217;s selection mechanisms to find a data handler component that can recognize data references of a specific type, your application must interact with the data handler in order to determine whether it can support a specific data reference. Apple has defined two functions, <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHCanUseDataRef" target="_top">DataHCanUseDataRef</a></code> and <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHGetVolumeList" target="_top">DataHGetVolumeList</a></code>, that allow you to query a data handler component in order to find out whether it can work with a data reference. By using these two functions, your application can choose a data handler that is best-suited to its specific needs.</p>
<p>Using the <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHCanUseDataRef" target="_top">DataHCanUseDataRef</a></code> function, you supply a data reference to the data handler component. The component then reports what it can do with that data reference. The returned value indicates the level and, to some extent, the quality of service the data handler can provide (for example, whether the component can read data from or write data to the data reference and whether the component uses any special support when working with that data reference).</p>
<p>Because calling the <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHCanUseDataRef" target="_top">DataHCanUseDataRef</a></code> function in several data handlers can be time consuming, Apple has also defined a function that helps narrow the search. By using the <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHGetVolumeList" target="_top">DataHGetVolumeList</a></code> function, your application can obtain a list of all the file system volumes that a data handler can support. In response to your request, the data handler returns the list and flags indicating the level and quality of service the data handler can provide for containers on that volume.</p>
<p>For more information on these functions, see <span class="content_text"><a href="3UsingDataHandlerCom.html#//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DeterminingDataHandlerCapabilities">Determining Data Handler Capabilities</a></span>.</p>

<a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_11" title="Managing Data References"></a>
<h2><a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-ManagingDataReferences" title="Managing Data References"></a>Managing Data References</h2>
<p>Once you have selected a data handler component, you must provide a data reference to the data handler. Use the <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHSetDataRef" target="_top">DataHSetDataRef</a></code> function to supply a data reference to a data handler. Once you have assigned a data reference to the data handler, your application may start reading or writing movie data from that data reference. The <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHGetDataRef" target="_top">DataHGetDataRef</a></code> function allows your application to obtain a data handler&#8217;s current data reference.</p>
<p>Data handlers also provide a function that allows your application to determine whether two data references are equivalent (that is, refer to the same movie container). Your application provides a data reference to the <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHCompareDataRef" target="_top">DataHCompareDataRef</a></code> function. The data handler returns a Boolean value indicating whether that data reference matches the data handler&#8217;s current data reference.</p>
<p>For more information on these functions, see <span class="content_text"><a href="3UsingDataHandlerCom.html#//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-WorkingWithDataReferences">Working With Data References</a></span>.</p>

<a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_12" title="Working With Data References"></a>
<h2><a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-WorkingWithDataReferences" title="Working With Data References"></a>Working With Data References</h2>
<p>All data handler components use data references to identify and locate a movie&#8217;s container. Different types of containers may require different types of data references. For example, a reference to a memory-based movie may be a handle, while a reference to a file-based movie may be an alias.</p>
<p>Client programs can correlate data references with data handlers by matching the component&#8217;s subtype value with the data reference type; the subtype value indicates the type of data reference the component supports. All data handlers with the same subtype value must support the same data reference type. To continue the previous example, Apple&#8217;s memory-based data handler for Macintosh uses handles (and has a subtype value of <code>'hndl'</code>), while the HFS data handler uses Alias Manager aliases (its subtype value is '<code>alis'</code>).</p>
<p>The <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHSetDataRef" target="_top">DataHSetDataRef</a></code> and <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHGetDataRef" target="_top">DataHGetDataRef</a></code> functions allow applications to assign your data handler&#8217;s current data reference. The <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHCompareDataRef" target="_top">DataHCompareDataRef</a></code> function asks your component to compare a data reference against the current data reference and indicate whether the references are equivalent (that is, refer to the same container). The <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHResolveDataRef" target="_top">DataHResolveDataRef</a></code> permits your component to locate a data reference&#8217;s container.</p>
<p>The DataHSetOSFileRef and DataHGetOSFileRef functions provide an alternative, system-specific mechanism for assigning your data handler&#8217;s current data reference.</p>
<p>For more information on data references, see <span class="content_text"><a href="3UsingDataHandlerCom.html#//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-ManagingDataReferences">Managing Data References</a></span>.</p>

<a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_13" title="Retrieving Movie Data"></a>
<h2><a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-RetrievingMovieData" title="Retrieving Movie Data"></a>Retrieving Movie Data</h2>
<p>Before your application can read data using a data handler component, you must open a read path to the current data reference. Use the <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHOpenForRead" target="_top">DataHOpenForRead</a></code> function to request read access to the current data reference. Once you have gained read access to the data reference, data handlers provide both high- and low-level read functions.</p>
<p>The high-level function, <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHGetData" target="_top">DataHGetData</a></code>, provides an easy-to-use, synchronous read interface. Being a synchronous function, <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHGetData" target="_top">DataHGetData</a></code> does not return control to your application until the data handler has read and delivered the data you request.</p>
<p>If you need more control over the read operation, you can use the low-level function, <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHScheduleData" target="_top">DataHScheduleData</a></code>, to issue asynchronous read requests. When you call this function, you provide detailed information specifying when you need the data from the request. The data handler returns control to your application immediately, and then processes the request when appropriate. When the data handler completes the request, it calls your data-handler completion function to report that the request has been satisfied, see  <span class="content_text"><a href="3UsingDataHandlerCom.html#//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-CompletionFunction">Completion Function</a></span> for more information on the data-handler completion function.</p>
<p>Besides simply scheduling read requests that must be satisfied during a movie&#8217;s playback, another use of the <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHScheduleData" target="_top">DataHScheduleData</a></code> function is to prepare a movie for playback (commonly referred to as prerolling the movie). The <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHScheduleData" target="_top">DataHScheduleData</a></code> function uses several special values to indicate a preroll operation. Your application calls the <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHScheduleData" target="_top">DataHScheduleData</a></code> function one or more times to schedule the preroll read requests, and then uses the <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHFinishData" target="_top">DataHFinishData</a></code> function to tell the data handler to start delivering the requested data.</p>
<p>For more information on these functions and about preroll operations, see  <span class="content_text"><a href="3UsingDataHandlerCom.html#//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-ReadingMovieData">Reading Movie Data</a></span>.</p>
<a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_14" title="Completion Function"></a>
<h3><a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-CompletionFunction" title="Completion Function"></a>Completion Function</h3>
<p>When client programs schedule asynchronous read or write operations (by calling your component&#8217;s <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHScheduleData" target="_top">DataHScheduleData</a></code> or <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHWrite" target="_top">DataHWrite</a></code> functions), they furnish your component a data-handler completion function. Your component must call this function when it completes the read or write operation, whether the operation was a success or a failure.</p>


<a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_15" title="Reading Movie Data"></a>
<h2><a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-ReadingMovieData" title="Reading Movie Data"></a>Reading Movie Data</h2>
<p>Data handler components provide two basic read facilities. The <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHGetData" target="_top">DataHGetData</a></code> function is a fully synchronous read operation, while the <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHScheduleData" target="_top">DataHScheduleData</a></code> function is asynchronous. Applications provide scheduling information when they call your component&#8217;s <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHScheduleData" target="_top">DataHScheduleData</a></code> function. When your component processes the queued request, it calls the application&#8217;s data-handler completion function. By calling your component&#8217;s <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHFinishData" target="_top">DataHFinishData</a></code> function, applications can force your component to process queued read requests. Applications may call your component&#8217;s <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHGetScheduleAheadTime" target="_top">DataHGetScheduleAheadTime</a></code> function in order to determine how far in advance your component prefers to get read requests.</p>
<p>Before any application can read data from a data reference, it must open read access to that reference by calling your component&#8217;s <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHOpenForRead" target="_top">DataHOpenForRead</a></code> function. The <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHCloseForRead" target="_top">DataHCloseForRead</a></code> function closes that read access path.</p>
<p>For more information on reading movie data, see  <span class="content_text"><a href="3UsingDataHandlerCom.html#//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-RetrievingMovieData">Retrieving Movie Data</a></span>.</p>

<a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_16" title="Storing Movie Data"></a>
<h2><a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-StoringMovieData" title="Storing Movie Data"></a>Storing Movie Data</h2>
<p>Before  your application can write data using a data handler component, you must open a write path to the current data reference. Use the <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHOpenForWrite" target="_top">DataHOpenForWrite</a></code>  function to request write access to the current data reference. Once you have gained write access to the data reference, data handler components provide both high- and low-level write functions.</p>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_56" title="Note"></a>
<p><strong>Note:</strong>&nbsp;
QuickTime for Windows version 2.1.1 or earlier does not support writing movie data.  </p>
</div>
<p>The high-level function, <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHPutData" target="_top">DataHPutData</a></code>, allows you to easily append data to the end of the container identified by a data reference. Except when capturing movie data using the sequence grabber component, the Movie Toolbox uses this call when writing data to movie files. However, this function does not allow your application to write to any location other than the end of the container. In addition, this is a synchronous operation, so control is not returned to your program until the write is complete. As a result, this function is not well-suited to high-performance write operations, such as would be required to capture a movie.</p>
<p>If you need a more flexible write facility, or one with higher performance characteristics, you can use the <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHWrite" target="_top">DataHWrite</a></code> function. This function is intended to support high-speed writes, suitable for movie capture operations. For example, Apple&#8217;s sequence grabber component uses this data handler function to capture movies.</p>
<p>When you call this function, you provide detailed information specifying the location in the container that is to receive the data. The data handler returns control to your application immediately, and then processes the request asynchronously. When the data handler completes the request, it calls your data-handler completion function to report that the request has been satisfied, see  <span class="content_text"><a href="3UsingDataHandlerCom.html#//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-CompletionFunction">Completion Function</a></span> for more information on the data-handler completion  function.</p>
<p>In addition to the <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHWrite" target="_top">DataHWrite</a></code> function, data handler components provide several other &#8220;helper&#8221; functions that allow you to create new movie containers and prepare them for a movie capture operation.</p>
<p>For more information on all of these functions, see  <span class="content_text"><a href="3UsingDataHandlerCom.html#//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-WritingMovieData">Writing Movie Data</a></span>.</p>

<a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_17" title="Writing Movie Data"></a>
<h2><a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-WritingMovieData" title="Writing Movie Data"></a>Writing Movie Data</h2>
<p>As  with reading movie data, data handlers provide two distinct  write facilities. The <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHPutData" target="_top">DataHPutData</a></code> function is a simple synchronous interface that allows applications to append data to the end of a container.</p>
<p>The <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHWrite" target="_top">DataHWrite</a></code> function is a more capable, asynchronous write function that is suitable for movie capture operations. As is the case with the <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHScheduleData" target="_top">DataHScheduleData</a></code> function, your component calls the application&#8217;s data-handler completion function when you are done with the write request.</p>
<p>There are several other helper functions that allow applications to prepare your data handler for a movie capture operation. The <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHCreateFile" target="_top">DataHCreateFile</a></code> function asks your component to create a new container. The <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHSetFileSize" target="_top">DataHSetFileSize</a></code> and <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHGetFileSize" target="_top">DataHGetFileSize</a></code> functions work with a container&#8217;s size, in bytes. The <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHGetFreeSpace" target="_top">DataHGetFreeSpace</a></code> function allows applications to determine when to make a container larger. The <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHPreextend" target="_top">DataHPreextend</a></code> function asks your component to make a container larger. Applications may call your component&#8217;s <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHGetPreferredBlockSize" target="_top">DataHGetPreferredBlockSize</a></code> function in order to determine how best to interact with your data handler.</p>
<p>Before writing data to a data reference, applications must call your component&#8217;s <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHOpenForWrite" target="_top">DataHOpenForWrite</a></code> function to open a write path to the container. The <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHCloseForWrite" target="_top">DataHCloseForWrite</a></code> function closes that write path.</p>
<p>Note that some data handlers may not support write operations. For example, some shared devices, such as a CD-ROM &#8220;jukebox,&#8221; may be read-only devices. As a result, it is very important that your data handler correctly report its write capabilities to client programs. See  <span class="content_text"><a href="3UsingDataHandlerCom.html#//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DeterminingDataHandlerCapabilities">Determining Data Handler Capabilities</a></span> for information about the functions that client programs use to interrogate your data handler. For more information on writing movie data, see  <span class="content_text"><a href="3UsingDataHandlerCom.html#//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-StoringMovieData">Storing Movie Data</a></span>.</p>

<a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_18" title="Managing the Data Handler"></a>
<h2><a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-ManagingtheDataHandler" title="Managing the Data Handler"></a>Managing the Data Handler</h2>
<p>Data handler components provide a number of functions that your application can use to manage its connection to the handler. The most important among these is <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHTask" target="_top">DataHTask</a></code>, which provides processor time to the handler. Your application should call this function often so that the handler has enough time to do its work.</p>
<p>Other functions in this category provide playback hints to the data handler and allow your application to influence how the component handles its cached data.</p>
<p>For more information on these functions, see  <span class="content_text"><a href="3UsingDataHandlerCom.html#//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-ManagingDataHandlerBehavior">Managing Data Handler Behavior</a></span>.</p>
<a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_19" title="Managing Data Handler Behavior"></a>
<h3><a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-ManagingDataHandlerBehavior" title="Managing Data Handler Behavior"></a>Managing Data Handler Behavior</h3>
<p>Applications may call your handler&#8217;s <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHPlaybackHints" target="_top">DataHPlaybackHints</a></code> function in order to provide you with some guidelines about how those applications play to use the current data reference.</p>
<p>The <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHFlushData" target="_top">DataHFlushData</a></code> and <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHFlushCache" target="_top">DataHFlushCache</a></code> functions allow applications to influence how your component manages its stored data.</p>

<a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DontLinkElementID_20" title="Determining Data Handler Capabilities"></a>
<h3><a name="//apple_ref/doc/uid/TP40000861-UsingDataHandlerComponents-DeterminingDataHandlerCapabilities" title="Determining Data Handler Capabilities"></a>Determining Data Handler Capabilities</h3>
<p>In order for client programs to choose the best data handler component for a data reference, Apple has defined some functions that allow applications to interrogate a data handler&#8217;s capabilities.</p>
<p>The <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHGetVolumeList" target="_top">DataHGetVolumeList</a></code> function allows an application to obtain a list of the volumes your data handler can support. The <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHCanUseDataRef" target="_top">DataHCanUseDataRef</a></code> function allows your data handler to examine a specific data reference and indicate its ability to work with the associated container. The <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHGetDeviceIndex" target="_top">DataHGetDeviceIndex</a></code> function allows applications to determine whether different data references identify containers that reside on the same device.</p>
<p>By way of illustration, the Movie Toolbox uses the <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHGetVolumeList" target="_top">DataHGetVolumeList</a></code> and <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHCanUseDataRef" target="_top">DataHCanUseDataRef</a></code> functions as follows. During startup, and whenever a new volume is mounted, the Movie Toolbox calls each data handler&#8217;s <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHGetVolumeList" target="_top">DataHGetVolumeList</a></code> function in order to obtain information about each handler&#8217;s general capabilities. Specifically, the Movie Toolbox calls each component&#8217;s <code><a href="../../../../Reference/QTRef_TrackAndMedia/Reference/reference.html#//apple_ref/c/func/GetDataHandler" target="_top">GetDataHandler</a></code>, <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHGetVolumeList" target="_top">DataHGetVolumeList</a></code>, and <code><a href="../../../../../Carbon/Reference/Component_Manager/Reference/reference.html#//apple_ref/c/func/CloseComponent" target="_top">CloseComponent</a></code> functions.</p>
<p>Whenever an application opens a movie, the Movie Toolbox selects the best data handler for the movie&#8217;s container. This may involve calling each appropriate data handler&#8217;s <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHCanUseDataRef" target="_top">DataHCanUseDataRef</a></code> function (in some cases, a data handler may indicate that it does not need to examine a data reference before accessing it; see the description of the <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHGetVolumeList" target="_top">DataHGetVolumeList</a></code> function for more information). For each data handler that can support the data reference (that is, has the correct component subtype value) and needs to be interrogated, the Movie Toolbox calls the component&#8217;s <code><a href="../../../../Reference/QTRef_TrackAndMedia/Reference/reference.html#//apple_ref/c/func/GetDataHandler" target="_top">GetDataHandler</a></code>, <code><a href="../../../../Reference/QTRef_DataComponents/Reference/reference.html#//apple_ref/c/func/DataHCanUseDataRef" target="_top">DataHCanUseDataRef</a></code>, and <code><a href="../../../../../Carbon/Reference/Component_Manager/Reference/reference.html#//apple_ref/c/func/CloseComponent" target="_top">CloseComponent</a></code> functions. Based on the resulting information, the Movie Toolbox selects the best data handler for the application.</p>





        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../B-Chapter/2AboutDataHandlerCom.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../D-Chapter/4VideoOutputComponen.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2005, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-01-10<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/QuickTime/RM/TransportDelivery/DataHandlerComp/C-Chapter/3UsingDataHandlerCom.html%3Fid%3DTP40000861-3.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/QuickTime/RM/TransportDelivery/DataHandlerComp/C-Chapter/3UsingDataHandlerCom.html%3Fid%3DTP40000861-3.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/QuickTime/RM/TransportDelivery/DataHandlerComp/C-Chapter/3UsingDataHandlerCom.html%3Fid%3DTP40000861-3.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>