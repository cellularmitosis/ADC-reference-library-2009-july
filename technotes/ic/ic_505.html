<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"    "http://www.w3.org/TR/1998/REC-html40-19980424/loose.dtd"><HTML><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note IC505: Apple Event Manager Q&amp;As</title><meta name="keywords" content="Mac OS 8 Apple Event Manager isHighLevelEventAware 903 error OpenSelection"><meta name="Description" content="Technical Note IC505: This Technical Note contains a collectionof archived Q&amp;As relating to the Apple Event Manager--questionssent the Developer Support Center (DSC) along with answersfrom the DSC engineers. Archived Q&amp;As include: Not settingthe isHighLevelEventAware bit may cause a -903 error whenan app tries to send an OpenSelection event through AESend;AETracker to detect Apple Events; disposal after AEPutXXXX;How to pass an Apple event to an application at launch time;How applications should handle apple events sent to themselves;-600 error at AESend call; How to flush a high level eventfrom the queue; How to identify the sender of an Apple Event;howto launch an application remotely."><meta name="categories" content="Interapplication Communication"><meta name="week-posted" content="Oct 1, 1990 - Oct 5, 1990"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF" TEXT="#000000"><a name="//apple_ref/doc/uid/DTS10002516" title="Apple Event Manager Q&As"></a><a name="top"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxCarbon-date.html">Carbon</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/Carbon/idxInterapplicationCommunication-date.html" target="_blank">Carbon > Interapplication Communication</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note IC505</div>
<div id="pageheadsub">Apple Event Manager Q&amp;As</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext">                                     <A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><p id = "introtext">This Technical Note contains a collection of archived Q&amp;As relating to a specific topic--questions sent the Developer Support Center (DSC) along with answers from the DSC engineers. Current Q&amp;As can be found on the <a href="../../qa/index.html">Macintosh Technical Q&amp;As web site</a>.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Oct 01 1992]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><a name="Section1"></a><h2>SIZE resource isHighLevelEventAware bit and high-level events</h2><p>Date Written: 11/17/92</p><p>Last reviewed: 7/2/93</p><p>When I try to send an <code>OpenSelection</code> Apple event to the Finder, I get a -903error after calling <code>AESend</code>. Could you tell me what causes this error and how Ican overcome it?</p><p>___</p><p>The application is returning the -903 error because it isn't completely set up to send and receive Apple events. This is why you're getting the error only after calling <code>AESend</code>. The problem is that the <code>isHighLevelEventAware</code> bit isn't set in your SIZE resource, meaning that your application doesn't send or receive high-level events. For more information on setting the <code>isHighLevelEventAware</code> bit, see <i>Inside Macintosh: Macintosh Toolbox Essentials,</i> pages 2-115 through 2-119 (or <i>Inside Macintosh</i> Volume VI, pages 5-14 through 5-17).</p><a name="Section2"></a><h2>AETracker tracks Apple events</h2><p>Date Written:  1/22/93</p><p>Last reviewed:  4/1/93</p><p>Do you have any software that detects Apple events? I need something that willlet me know when my application sends Apple events and if the receivingapplication processes them correctly.</p><p>___</p><p>If brevity is the soul of wit, then I'm one funny dude: Try <A HREF = "downloads/aetracker-3-0.hqx">AETracker</a> on theDeveloper CD (in the Tools &amp; Apps: OS/Toolbox: Apple Events folder).</p><a name="Section3"></a><h2>Descriptor disposal after AEPutXXXX</h2><p>Date Written:  12/7/92</p><p>Last reviewed:  6/14/93</p><p>When a request for information is passed to me through an Apple event, thedirect object parameter of my reply event is a descriptor list that includes an<code>AERecord</code> of my information. When I use <code>AEPutPtr</code> and the <code>AEPutParamDesc</code>, is thedata copied or merely referenced? Should I be disposing of the <code>AERecord</code> and/orthe descriptor list, or should I expect <code>AEProcessAppleEvent</code> to dispose of them?</p><p>___</p><p>Whenever you make an <code>AEPutXXXX</code> call, the Apple Event Manager <i>copies</i> thedata you put into the list, event, or record, so as soon as you do an <code>AEPutXXXX</code>you can dispose of the data you put. Thus, the following is correct:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>AEPutParamDesc(&amp;theEvent, keyDirectObject, &amp;theSpec);AEDisposeDesc(&amp;theSpec);</pre>	</TD></TR></TABLE></CENTER><p>And so is this:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>HLock(myTextHandle);AEPutParamPtr(&amp;theEvent, keyDirectObject, typeText,  (Ptr)*myTextHandle, GetHandleSize(myTextHandle));DisposeHandle(myTextHandle);</pre>	</TD></TR></TABLE></CENTER><p>The <i>only</i> two descriptors disposed of by the Apple Event Manager itself(at the conclusion of <code>AEProcessAppleEvent</code>) are the original Apple event and thereply Apple event. So, anything that you create and manipulate yourself shouldbe disposed of by you when you add it to another Apple event record or whenyou're done with it. The only two you don't dispose of yourself are theEventand reply, which are passed to you, as in:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>pascal OSErr AEXXXHandler(AppleEvent *theEvent, AppleEvent *reply,  long refIn)</pre>	</TD></TR></TABLE></CENTER>  <p>This even holds true for <code>AESend</code>. When you send an event, you can immediatelydispose of your copy of the event, as follows:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>AESend(&amp;myEvent, nil, kAENoReply, kAENormalPriority,  kAEDefaultTimeout, nil, nil);AEDisposeDesc(&amp;myEvent);</pre>	</TD></TR></TABLE></CENTER><a name="Section4"></a><h2>Limit for number of files opened from the Finder using 'odoc' event</h2><p>Date Written:  11/9/92</p><p>Last reviewed:  6/14/93</p><p>Is there some limitation on the number of files you can open from the Finderusing the <code>'odoc'</code> event? I wrote a simple drag-and-drop application, using the<code>'odoc'</code> event. When I tried to drag and drop 190 files over it, it froze.</p><p>___</p><p>These limits aren't officially documented anywhere. For drag and drop, thelimit should be whatever causes the event to be passed going over 64K, sincethe High-Level Event Manager doesn't handle anything over 64K right now. 600files at roughly 250 bytes per alias would push you way over the limit. At thatpoint the Finder is probably not able to recover gracefully from a HLE error.</p><h2>Construction of Apple events</h2><p>Date Written:  4/9/91</p><p>Last reviewed:  6/14/93</p><p>How do I pass an Apple event to an application at launch time?</p><p>___</p><p>You can coerce the Apple event to a data type that doesn't need to be pre-addressed.A sample called <A HREF = "downloads/procdoggie-1a6.hqx">ProcDoggie</a> on the Developer CD demonstrates this. If you look in the UProcessUtils.inc1.p file, you'll find this comment:</p><p>"To create the <code>kAEOpenDocuments</code> or kAEPrintDocuments Apple event, a targetaddress descriptor is needed. Because we're converting the Apple event into a<code>typeAppParameters</code> descriptor rather than sending it somewhere, it doesn'tmatter what target address we use. I just used the process serial number (PSN)of this application as a dummy value. Because this is an application and notsomething like a driver, I can just use the <code>kCurrentProcess</code> constant torepresent this application's PSN. A descriptor is made of this PSN, then thisPSN is used when creating the new <code>kAEOpenDocuments</code> AppleEvent. Once this Appleevent is created, the PSN descriptor is no longer needed and is disposed of."</p><p>In other words, you just dummy up an address and coerce the descriptor to be of type <code>typeAppParameters</code>, and the address will be corrected for you by the AppleEvents Manager. Please refer to the ProcDoggie sample source code or to <A HREF = "downloads/launchwithdoc2.hqx"><code>LaunchWithDoc</code></a> (in the Snippets collection) for the complete picture of how this is done.</p><h2>Apple event application error handling</h2><p>Date Written:  7/22/91</p><p>Last reviewed:  10/15/99</p><p>What do we return to the Apple event handler if we get an application errorwhile processing a standard event, Edition Manager event, or custom Apple eventfor commands and queries? Probably not <code>errAENotHandled</code>, since that means wedidn't handle the event, which is different from trying to handle it andfailing. Would it be <code>errAEFail</code>? What if we want to return more specific errorinformation? Do we define our own errors, or try to use Apple's errors such as<code>memFullErr</code> or <code>parmErr</code>?</p><p>___</p><p><code>errAEEventNotHandled</code> is not the correct value to return. In this case it tells the AppleEvent Manager that your routine did not handle the event and it should attempt to dispatch the event to a system event handler. As a result problems such as low memory may never be reported to the client.  A better way to approach the problem is to never install handlers for events your application does not handle (so it never has to return <code>errAEEventNotHandled</code>).  And, always fill in <code>'errn'</code> and <code>'errs'</code> parameters in the reply event if anything went wrong (as shown on page 6-49 of <i>Inside Macintosh</i> Volume VI). You can be as descriptive as you like in the text - the more the better, in fact, since this text will be seen at the user level. The <code>errn</code> value you pass back should be the system error number that caused the exception. This value will then be passed back to the caller, and they can use this information for their own error recovery.</p><p>&nbsp;</p><p>Date Written:  8/12/91</p><p>Last reviewed:  8/1/92</p><p>If I send Apple events to myself and specify <code>kAEQueueReply</code> to <code>AESend</code>, the eventdoesn't get put in the queue as I requested. It shows up immediately in thereply parameter. According to <i>Inside Macintosh,</i> if I specify<code>kAEQueueReply</code> I should treat the reply event as undefined. Please help; myapplication falls apart because it never receives the event it's supposed to.If this is a bug, will the behavior be changed in the future?</p><p>___</p><p>This isn't a bug; it's an undocumented "feature" of the Apple Event Manager(AEM). If you send an Apple event to yourself, the AEM directly dispatches tothe handler you've installed for that event. So Apple events you send toyourself don't come in through <code>WaitNextEvent</code>. This means that if you reply toan Apple event you sent yourself, your 'ansr' handler will get calleddirectly.</p><p>This was not an arbitrary decision, though it can have some confusingramifications for an application. Two factors influenced the decision -thefirst minor, the second major:</p><ul type="circle">	<li><P>Speed. The AEM has all the handlers for your application in a hashed table, and can dispatch very quickly to them, so for performance reasons direct dispatching was implemented.</p></li>	<li><p>Event priorities and sequencing. Apple events have a lower priority than user-generated events (keystrokes, clicks); they come in right before update events. This created a potentially serious problem for applications that sent Apple events to themselves.</p></li></ul><p>If all Apple events came through the event loop, you could easily create thefollowing scenario:</p><ol type="1">	<li><p>The user selects a menu item, the application sends an Apple event to itself in response, and this Apple event requires a reply or will cause other Apple events to be sent.</p></li>	<li><p>The user clicks the mouse in an application window.</p></li></ol><p>The mouse click has a higher priority than the reply or any Apple events thatare sent in response to the first Apple event, and gets posted ahead of theApple event in the event queue. This means that the mouse click happens andconceivably changes the current context of the application (perhaps switchingwindows, for example); then when the Apple events sent by the menu item handlerare processed through the queue, the application state is not the same as itwas when the menu selection was made, and the menu selection may be totallyinappropriate for the current configuration.</p><p>So, to prevent a loss of sequencing, the AEM directly dispatches. Any non-Appleevents that happen while you're sending and processing an Apple event toyourself will be queued and won't interrupt the Apple event process you'veinitiated. What this means in the case you're describing is that queued repliesdon't happen when you're sending to yourself. The AEM will directly dispatch toyour <code>'ansr'</code> handler, bypassing <code>WaitNextEvent</code> processing of Apple events toprevent any other events from breaking the chain of Apple events you may beprocessing. This isn't a major problem, but it's something you need to be awareof if you're expecting some other events to be processed before you get a replyor other Apple event.</p><h2>Target Process must be valid and high-level event aware</h2><p>Date Written:  8/16/91</p><p>Last reviewed:  6/14/93</p><p>When I send an <code>'odoc'</code> Apple event to an already-running application, I get an-600 error at the <code>AESend</code> call. The process serial number is correct at entry.What is this error, and is it documented anywhere?</p><p>___</p><p>The error -600 means that the process serial number that you sent is eitherinvalid or is the serial number of a process that does not accept Appleevents--that is, the high-level event bit of the destination process's sizeresource isn't set.</p><h2>LaunchApplication and event sequence</h2><p>Date Written:  2/19/92</p><p>Last reviewed:  6/14/93</p><p>Is it true that if I double-click a document belonging to my application, the application will be launched and will receive an <code>'odoc'</code> Apple event, but will not receive an <code>'oapp'</code> event -that is,it will receive either 'odoc' or 'oapp' but not both?</p><p>___</p><p>Yes, except actually it will receive one of <code>'oapp'</code>, <code>'odoc'</code>, or <code>'pdoc'</code>. The<code>'pdoc'</code> will be followed (as the next event) by a <code>'quit'</code> if the <code>'pdoc'</code> was theevent sent as the application was launched.</p><p>This is the normal sequence of events, and should be adhered to by everyone wholaunches applications. However, it isn't enforced by the system or the Finder. It's possible for any application to launch your application with any event, since it can stuff anything in the <code>launchAppParameters</code> field of <code>LaunchApplication</code>, as long as it's a valid high-level (not even Apple) event. Launching another application this way would be bad programming, and would break most applications, but you should be aware that someone who doesn'tunderstand event handling may do this to you.</p><p>Note that if another application launches your application using<code>LaunchApplication</code> and doesn't specify any high-level event in the launchparameter block, the Process Manager will automatically supply the <code>'oapp'</code>event. So, in general, if Apple events and launching have been coded correctly,you'll always receive an <code>'oapp'</code>, <code>'odoc'</code>, or <code>'pdoc'</code>.</p><h2>Ignoring or purging an event from high-level event queue</h2><p>Date Written:  3/6/92</p><p>Last reviewed:  6/14/93</p><p><i>Inside Macintosh</i> Volume VI states that you cannot use <code>FlushEvents</code> to flush high-level events. I need to flush a single <code>newFile</code> event from the high-level event queue. How can I do this?</p><p>___</p><p>Typically, if you need to ignore a particular event which you would otherwisehandle, you can just set a flag to tell the handler routine not to take itsnormal action. For most circumstances, this is the easiest and most appropriateway to ignore a particular event.</p><p>There may be circumstances where you need to purge a specific event from thehigh-level event queue. That can be done by searching for the event with<code>GetSpecificHighLevelEvent</code> and an appropriate filter proc; if the event isfound, just call <code>AcceptHighLevelEvent</code> to dequeue it. Here's an example whichremoves all <code>'pdoc'</code>s from the high-level event queue:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>TYPE  EvtClassIDPtr = ^EvtClassID;  EvtClassID = RECORD    class: OSType;    evtID: OSType;  END;VAR  theEvtClassID: EvtClassID;  retCode: OSErr;  gotHLEFlag: Boolean;  FUNCTION MyGSHLEFilter(myDataPtr: Ptr; msgHLEMPtr: HighLevelEventMsgPtr;    sender: TargetID): BOOLEAN;  VAR    myTarg: TargetID;    myRefCon: LongInt;    myBuff: Ptr;    myLen: LongInt;    myErr: OSErr;  BEGIN    MyGSHLEFilter := FALSE;    IF (OSType(msgHLEMPtr^.theMsgEvent.message) =                                      EvtClassIDPtr(myDataPtr)^.class) AND      (OSType(msgHLEMPtr^.theMsgEvent.where) =                                      EvtClassIDPtr(myDataPtr)^.evtID) THEN      BEGIN        myLen := 0;        myBuff := NIL;        myErr := AcceptHighLevelEvent(myTarg, myRefCon, myBuff, myLen);        IF myErr = bufferIsSmall THEN        BEGIN          myBuff := NewPtr(myLen);          myErr := AcceptHighLevelEvent(myTarg, myRefCon, myBuff, myLen);        END;        IF myErr &lt;&gt; noErr THEN HandleError(myErr);        IF myBuff &lt;&gt; NIL THEN DisposePtr(myBuff);        MyGSHLEFilter := TRUE;      END;  END;...BEGIN     { main }  ...  { purge all print doc Apple events from the HLE queue }  theEvtClassID.class := kCoreEventClass;  theEvtClassID.evtID := kAEPrintDocuments;  REPEAT    gotHLEFlag := GetSpecificHighLevelEvent(@MyGSHLEFilter,                                                   @theEvtClassID, retCode)  UNTIL (NOT gotHLEFlag) OR (retCode &lt;&gt; noErr);  ...END.</pre>	</TD></TR></TABLE></CENTER><p><code>GetSpecificHighLevelEvent</code> is documented in Chapter 5 of <i>Inside Macintosh</i> Volume VI.</p><h2>Apple Event handler: Installation code</h2><p>Date Written:  9/10/91</p><p>Last reviewed:  6/14/93</p><p>I'm writing a small application that uses Apple events, which neither opensdocuments nor prints. <i>Inside Macintosh</i> Volume VI says that all Appleevent-aware applications should support the odoc and pdoc Apple events, butthese are not appropriate in my case. What should I do?</p><p>___</p><p>You don't necessarily need to install a handler for each event, but it makesyour code cleaner. If you don't have a handler, the Apple Event Manager willautomatically return <code>errAEEventNotHandled</code> from your <code>AEProcessAppleEvent</code> call,since it can't find a handler for the event in the handler tables. But werecommend installing handlers for the required Apple events anyway; it makesyour code cleaner and easier to understand, as well as easily allowing you aplace to put a routine when you need to implement it. And it doesn't take upmuch memory. Just install a handler like this (in MPW C):</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>pascal OSErr AEPrintHandler(AppleEvent *messagein,AppleEvent *reply, long refConIn){/* Tell the compiler I'm not using these parameters */#pragma unused (reply,refConIn,messagein)    return(errAEEventNotHandled);  /* and return my error */}</pre>	</TD></TR></TABLE></CENTER><h2>Finding Apple event sender's target ID or process serial number</h2><p>Date Written:  10/25/91</p><p>Last reviewed:  6/14/93</p><p>How can I identify the sender of an Apple event?</p><p>___</p><p>If your application is just sending a reply, it should not be creating an Appleevent or calling <code>AESend</code>. Instead, the Apple event handler should stuff theresponse information into the reply event, as shown on page 6-50 of <i>InsideMacintosh</i> Volume VI. The Apple Event Manager takes care of addressing andsending the event.</p><p>To find the target ID or process serial number of the sender of an Apple event,use <code>AEGetAttributePtr</code> to extract the address attribute, as follows:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>retCode := AEGetAttributePtr(myAppleEvent, keyAddressAttr,                typeWildCard, senderType, @senderBuffer,                sizeof(senderBuffer), senderSize)</pre>	</TD></TR></TABLE></CENTER>                <p>The <code>senderBuffer</code> can later be used with <code>AECreateDesc</code> to create an address to bepassed to <code>AESend</code>. The buffer should be at least as large as data type <code>TargetID</code>.See <i>Inside Macintosh</i> Volume VI, page 5-22, for a description of TargetID.</p><h2>Launching an application remotely</h2><p>Date Written:  4/16/92</p><p>Last reviewed:  6/14/93</p><p>I need to launch an application remotely. How do I do this? The Process Managerdoesn't seem to be able to launch an application on another machine and theFinder Suite doesn't have a Launch Apple event.</p><p>___</p><p>What you need to do is use the <code>OpenSelection</code> Finder event. Send an<code>OpenSelection</code> to the Finder that's running on the machine you want to launchthe other application on, and the Finder will resolve the <code>OpenSelection</code> into alaunch of the application.</p><p>As you can see if you glance at the <code>OpenSelection</code> event in the Apple EventRegistry, there's one difficulty with using it for remote launching: You haveto pass an alias to the application you want to launch. If the machine you wantto launch the application on is already mounted as a file server, this isn'timportant, since you can create an alias to that application right at thatmoment. Or, if you've connected in the past (using that machine as a server)you can send a previously created alias and it will be resolved properly by theFinder on the remote machine.</p><p>However, if you want to launch a file without logging on to the other machineas a server, you'll need to use the <code>NewAliasMinimalFromFullPath</code> routine in theAlias Manager. With this, you'll pass the full pathname of the application onthe machine you want to launch on, and the Alias Manager will make an alias toit in the same way it does for unmounted volumes. The obvious drawback here isthat you'll need to know the full pathname of the application - but there's aprice to pay for everything. The <A HREF = "downloads/finderopenselection-1-0-1.hqx">FinderOpenSel</a> sample code on the <i>Developer CD Series</i> disc illustrates this use of the <code>NewAliasMinimalFromFullPath</code> routine.</p><h2>Opening documents from another application</h2><p>Date Written:  5/2/91</p><p>Last reviewed:  6/14/93</p><p>How can I open Macintosh documents that belong to an application that's already running?</p><p>___</p><p>If you find that you have the Apple Event Manager present, then build <code>'odoc'</code> Apple events to your heart's content, and send them to whomever you wish. The Process Manager will hop in there if the target isn't Apple event-aware andcoerce the required Apple event to the appropriate Puppet String for you. No further hacks on your part are required. You literally don't care (at least for the purposes of the required Apple events) whether your target is Apple eventaware or not.</p><h2>Alert user instead of sending 'quit' Apple event to free RAM</h2><p>Date Written:  5/2/91</p><p>Last reviewed:  6/14/93</p><p>Is it acceptable to force other Macintosh applications to quit to free up memory?</p><p>___</p><p>While it's possible to free up memory by sending a <code>'quit'</code> Apple event, a much better alternative from a human interface standpoint is to pose an alert to the user indicating that you couldn't open the documents they requested due to a lack of memory, and asking the user to please try closing some windows or quitting some other applications and try again. It's better to leave the user in control of the process.</p><h2>High-level Macintosh events and user reference numbers</h2><p>Date Written:  4/24/92</p><p>Last reviewed:  7/13/92</p><p>We're using Apple events with the PPC Toolbox. We call <code>StartSecureSession</code> after<code>PPCBrowser</code> to authenticate the user's identity. The user identity dialog box isdisplayed and everything looks good. However, in the first <code>AESend</code> call we make,the user identity dialog is displayed again. (It isn't displayed after that.)Why is this dialog being displayed from <code>AESend</code> when I've already authenticatedthe user identity with <code>StartSecureSession</code>?</p><p>___</p><p>First, a few PPC facts:</p><ul type="circle">	<li><p>When a PPC session is started, <code>StartSecureSession</code> lets the user authenticate the session (if the session is with a program on another Macintosh) and returns a user reference number for that connection in the <code>userRefNum</code> field of the <code>PPCStartPBRec</code>. That user reference number can be used to start another connection  (using <code>PPCStart</code> instead of <code>StartSecureSession</code>) with the same remote Macintosh, bypassing the authentication dialogs.</p></li>	<li><p>User reference numbers are valid until either they're deleted with the <code>DeleteUserIdentity</code> function or one of the Macintosh systems is restarted.</p></li>	<li><p>If the name and password combination used to start a session is the same as that of the owner of the Macintosh being used, the user reference number returned refers to the default user. The default user reference number normally is never deleted and is valid for connections to the other Macintosh until it's deleted with <code>DeleteUserIdentity</code> or one of the Macintosh systems is restarted.</p></li></ul><p>With that out of the way, here's how user reference numbers are used whensending high-level events and Apple events: When you first send a high-levelevent or an Apple event to another Macintosh, the code that starts the sessionwith the other system doesn't attempt to use the default user reference numberor any other user reference number to start the session, and it doesn't keepthe user reference number returned to it by StartSecureSession. The session iskept open for the life of the application, or until the other side of thesession or a network failure breaks the connection.</p><p>When you started your PPC session, <code>StartSecureSession</code> created a user referencenumber that could be used to start another PPC session without authentication.However, the Event Manager knows nothing of that user reference number, so whenyou send your first Apple event, the Event Manager calls <code>StartSecureSession</code>again to authenticate the new session. Since there isn't any way for you topass the user reference number from the PPC session to the Event Manager tostart its session, there's nothing you can do about this behavior.</p><h2>Sending applications must be high-level event aware</h2><p>Date Written:  7/30/92</p><p>Last reviewed:  6/14/93</p><p>Why do I get error -903 (a PPC Toolbox <code>noPortErr</code>) when I send an Apple event toa running application with <code>AESend</code>?</p><p>___</p><p>The <code>isHighLevelEventAware</code> bit of the sending application's SIZE -1 resource(and SIZE 0 resource, if any) must be set.</p>         <P><A HREF="#top">Back to top</A></P>                  <P><A NAME=Downloads></A></P>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (48K)</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/ic_505.pdf">Download</A></P>               </TD>            </TR>                     </TABLE>         <BR>                  <P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/ic/ic_505.html%3Fid%3DDTS10002516-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/ic/ic_505.html%3Fid%3DDTS10002516-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/ic/ic_505.html%3Fid%3DDTS10002516-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>