<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>HOpenResFile (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING42></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-41.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-43.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-9.html"><B>Chapter 1 - Resource Manager</B></A> / <A HREF="MoreToolbox-24.html"><B>Resource Manager Reference</B></A><BR><DL><DD><A HREF="MoreToolbox-30.html"><B>Resource Manager Routines</B></A> / <A HREF="MoreToolbox-40.html"><B>Opening Resource Forks</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING42-0></A>
<H3><A NAME=MARKER-9-253></A>HOpenResFile</H3>
 <A NAME=MARKER-11-254></A><A NAME=MARKER-2-255></A>If the <CODE>FSpOpenResFile</CODE> function is not available, you can use <CODE>HOpenResFile</CODE> to open a file's resource fork. <P>
<PRE>
FUNCTION HOpenResFile (vRefNum: Integer; dirID: LongInt;
                       fileName: Str255; 
                       permission: SignedByte): Integer;
</PRE>
<DL>
<DT><CODE>vRefNum</CODE>
<DD> The volume reference number of the volume on which the file is located.
<DT><CODE>dirID</CODE>
<DD> The directory ID of the directory where the file is located.
<DT><CODE>fileName</CODE>
<DD> The name of the file whose resource fork is to be opened.
<DT><CODE>permission</CODE>
<DD> A constant for one of the read/write permission combinations.
</DL>
<A NAME=HEADING42-7></A>
<H5>DESCRIPTION</H5>
 The <CODE>HOpenResFile</CODE> function opens the resource fork of the file with the name specified by the <CODE>fileName</CODE> parameter in the directory specified by the <CODE>vRefNum</CODE> and <CODE>dirID</CODE> parameters. It also makes this file the current resource file.<P>
 You can specify the access path permission for the resource fork by setting the <CODE>permission</CODE> parameter to one of these constants:<P>
<PRE>
CONST
   fsCurPerm    = 0; {whatever is currently allowed}
   fsRdPerm     = 1; {read-only permission}
   fsWrPerm     = 2; {write permission}
   fsRdWrPerm   = 3; {exclusive read/write permission}
   fsRdWrShPerm = 4; {shared read/write permission}
</PRE>
 See <A HREF=MoreToolbox-41.html#MARKER-9-250>page 1-55</A> for information about specifying access path permission with <CODE>FSpOpenResFile</CODE>. The same information applies to <CODE>HOpenResFile</CODE>.<P>
 The Resource Manager reads the resource map from the resource fork of the specified file into memory. It also reads into memory every resource whose <CODE>resPreload</CODE> attribute is set.<P>
 The <CODE>HOpenResFile</CODE> function returns a file reference number for the file. You can use this file reference number to refer to the file in other Resource Manager routines. If the file's resource fork is already open, <CODE>HOpenResFile</CODE> returns the file reference number but does not make that file the current resource file.<P>
 If the <CODE>HOpenResFile</CODE> function fails to open the specified file's resource fork (because there's no file with the specified name or because there are permission problems), it returns -1 as the file reference number. Use the <CODE>ResError</CODE> function to determine what kind of error occurred.<P>
 You don't have to call <CODE>HOpenResFile</CODE> to open the System file's resource fork or an application file's resource fork. These files are opened automatically when the system and the application start up, respectively. To get the file reference number for your application, call the <CODE>CurResFile</CODE> function after the application starts up and before you open the resource forks for any other files.<P>
 The <CODE>HOpenResFile</CODE> function checks that the information in the resource map is internally consistent. If it isn't, <CODE>ResError</CODE> returns the result code <CODE>mapReadErr</CODE>.<P>
 To open a resource fork just for block-level operations, such as copying files without reading the resource map into memory, use the File Manager function <CODE>OpenRF</CODE>.<P>
<A NAME=HEADING42-18></A>
<H5><A NAME=MARKER-9-256></A>SPECIAL CONSIDERATIONS</H5>
 The <CODE>HOpenResFile</CODE> function may move or purge memory blocks in the application heap. Your application should not call this function at interrupt time.<P>
 It's possible to create multiple, unique, read-only access paths to a resource fork using <CODE>HOpenResFile</CODE>; however, you should avoid doing so. See <A HREF=MoreToolbox-41.html#MARKER-9-251>page 1-56</A> for discussion of this issue in relation to <CODE>FSpOpenResFile</CODE>. The <CODE>HOpenResFile</CODE> function works the same way. <P>
 Versions of system software before System 7 do not allow you to use <CODE>HOpenResFile</CODE> to open a second access path, with write access, to a resource fork. In this case, <CODE>HOpenResFile</CODE> returns the reference number already assigned to the file.<P>
 If you want to open the resource fork for another application (or any resource fork other than your application's that includes <CODE>'CODE'</CODE> resources), you must bracket your calls to <CODE>HOpenResFile</CODE> with calls to <CODE>SetResLoad</CODE> with the <CODE>load</CODE> parameter set to <CODE>FALSE</CODE> and then to <CODE>TRUE</CODE>. You must also avoid making intersegment calls while the other application's resource fork is open. The discussion of this issue in relation to <CODE>FSpOpenResFile</CODE> (<A HREF=MoreToolbox-41.html#MARKER-9-251>page 1-56</A>) also applies to <CODE>HOpenResFile</CODE>.<P>
<A NAME=HEADING42-23></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 A handle to the resource map for the most recently opened resource fork is stored in the global variable <CODE>TopMapHndl</CODE>.<P>
<A NAME=HEADING42-25></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>nsvErr<TD>-35<TD>No such volume<TR>
<TD>ioErr<TD>-36<TD>I/O error<TR>
<TD>bdNamErr<TD>-37<TD>Bad filename or volume name (perhaps zero length)<TR>
<TD>eofErr<TD>-39<TD>End of file<TR>
<TD>tmfoErr<TD>-42<TD>Too many files open<TR>
<TD>fnfErr<TD>-43<TD>File not found<TR>
<TD>opWrErr<TD>-49<TD>File already open with write permission<TR>
<TD>permErr<TD>-54<TD>Attempt to open locked file for writing<TR>
<TD>extFSErr<TD>-58<TD>Volume belongs to an external file system<TR>
<TD>memFullErr<TD>-108<TD>Not enough room in heap zone<TR>
<TD>dirNFErr<TD>-120<TD>Directory not found<TR>
<TD>mapReadErr<TD>-199<TD>Map inconsistent with operation</TABLE>
</H5>
<A NAME=HEADING42-26></A>
<H5>SEE ALSO</H5>
 To check for errors, call the <CODE>ResError</CODE> function as described on <A HREF=MoreToolbox-35.html#MARKER-9-220>page 1-47</A>.<P>
 For more information about <CODE>permission</CODE> parameter constants and the <CODE>OpenRF</CODE> function, see <I><A HREF="../Files/Files-2.html">Inside Macintosh: Files</A></I>. <A NAME=MARKER-2-257></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-41.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-43.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   

