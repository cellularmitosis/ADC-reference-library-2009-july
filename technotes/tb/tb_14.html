<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note TB14: MultiFinder Frequently Asked Questions</title>                                       <meta name="categories" content="Human Interface Toolbox"><meta name="week-posted" content="Aug 31, 1987 - Sep 4, 1987"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002765" title="MultiFinder Frequently Asked Questions"></a><a name="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxCarbon-date.html">Carbon</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/Carbon/idxHumanInterfaceToolbox-date.html" target="_blank">Carbon > Human Interface Toolbox</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TB14</div>
<div id="pageheadsub">MultiFinder Frequently Asked Questions</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext"><A HREF="#Section1">How can I tell if WaitNextEvent is implemented?</A><BR><BR><A HREF="#Section2">How can I tell if the MultiFinder Temporary Memory Allocation<BR> calls areimplemented?</A><BR><BR><A HREF="#Section3">How can I tell if my application is running in the background?</A><BR><BR><A HREF="#Section4">When exactly does juggling take place?</A><BR><BR><A HREF="#Section5">Can I disable suspend/resume events by passing the <BR>appropriate event mask toWNE/GNE/EventAvail?</A><BR><BR><A HREF="#Section6">Should my application use WaitNextEvent?</A><BR><BR><A HREF="#Section7">Is there anything else that I can do to be MultiFinder friendly?</A><BR><BR><A HREF="#Section8">Can I use a debugger with MultiFinder?</A><BR><BR><A HREF="#Section9">What happened to animated icons under MultiFinder?</A><BR><BR><A HREF="#Section910">How can I ensure maximal compatibility with MultiFinder?</A><BR><BR><A HREF="#References">References</A><BR><BR><A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">This technical note provides answers to some of the more frequently askedquestions about MultiFinder. The development name for MultiFinder was Juggler,so the term "juggle" is used in this technical note to denote a context switch.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Nov 01 1993]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><a name=Section1></A><h2>How can I tell if WaitNextEvent is implemented?</h2><p>Most applications should not need to tell if MultiFinder is running. Most ofthe time, the application really needs to know something like: "How can I tellif <code>WaitNextEvent</code> is implemented?" Here's a Pascal fragment thatdemonstrates how to check to see if <code>WaitNextEvent</code> is implemented:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    FUNCTION TrapAvailable(tNumber: INTEGER; tType: TrapType): BOOLEAN;       CONST          UnimplementedTrapNumber = $A89F;  {number of &quot;unimplemented trap&quot;}    BEGIN {TrapAvailable}    {Check and see if the trap exists.}    {On 64K ROM machines, tType will be ignored.}       TrapAvailable := ( NGetTrapAddress(tNumber, tType) &lt;&gt;                          GetTrapAddress(UnimplementedTrapNumber) );    END;  {TrapAvailable}    FUNCTION WNEIsImplemented: BOOLEAN;       CONST          WNETrapNumber = $A860; {trap number of WaitNextEvent}       VAR          theWorld      : SysEnvRec; {to check if machine has new traps}          discardError  : OSErr; {to ignore OSErr return from SysEnvirons}    BEGIN {WNEIsImplemented}    {  Since WaitNextEvent and HFSDispatch both have the same trap       number ($60), we can only call TrapAvailable for WaitNextEvent       if we are on a machine that supports separate OS and Toolbox       trap tables. We call SysEnvirons and check if machineType &lt; 0.}       discardError := SysEnvirons(1, theWorld);    {  Even if we got an error from SysEnvirons, the SysEnvirons glue       has set up machineType.}       IF theWorld.machineType &lt; 0 THEN          WNEIsImplemented := FALSE          {this ROM doesn't have separate trap tables or WaitNextEvent}       ELSE          WNEIsImplemented := TrapAvailable(WNETrapNumber, ToolTrap);          {check for WaitNextEvent}    END;  {WNEIsImplemented}    {Note that we call SystemTask if WaitNextEvent isn't available.}    ...       hasWNE := WNEIsImplemented;    ...       IF hasWNE THEN BEGIN          {call WaitNextEvent}          ...       END ELSE BEGIN          {call SystemTask and GetNextEvent}          ...       END;</pre>	</TD></TR></TABLE></CENTER><p>Here's a C fragment:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    Boolean TrapAvailable(tNumber, tType)    short    tNumber    TrapType tType    {    /* define trap number for old MPW or non-MPW C */    #ifndef _Unimplemented    #define _Unimplemented 0xA89F    #endif    /* Check and see if the trap exists. */    /* On 64K ROM machines, tType will be ignored. */       return( NGetTrapAddress(tNumber, tType) !=               GetTrapAddress(_Unimplemented) );    }    Boolean WNEIsImplemented()    {    /* define trap number for old MPW or non-MPW C */    #ifndef _WaitNextEvent    #define _WaitNextEvent 0xA860    #endif       SysEnvRec theWorld; /* used to check if machine has new traps */    /* Since WaitNextEvent and HFSDispatch both have the same trap       number ($60), we can only call TrapAvailable for WaitNextEvent       if we are on a machine that supports separate OS and Toolbox       trap tables. We call SysEnvirons and check if machineType &lt; 0. */       SysEnvirons(1, &amp;theWorld);    /* Even if we got an error from SysEnvirons, the SysEnvirons glue       has set up machineType. */       if (theWorld.machineType &lt; 0) {          return(false)          /* this ROM doesn't have separate trap tables or WaitNextEvent */       } else {          return(TrapAvailable(_WaitNextEvent, ToolTrap));           /* check for WaitNextEvent */       }    }    /* Note that we call SystemTask if WaitNextEvent isn't available. */    ...       hasWNE = WNEIsImplemented();    ...       if (hasWNE) {          /* call WaitNextEvent */          ...       } else {          /* call SystemTask and GetNextEvent */          ...       }</pre>	</TD></TR></TABLE></CENTER><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>Note:</B><BR>Testing to see if <code>WaitNextEvent</code> is implemented is<b>not</b> the same as testing to see whether MultiFinder is running. Systems6.0 and newer include <code>WaitNextEvent</code> whether or not MultiFinder isrunning.</P></TD></TR></TABLE></CENTER><BR><P><A HREF="#top">Back to top</A></p><a name="Section2"></a><h2>How can I tell if the MultiFinder Temporary Memory Allocation calls areimplemented?</h2><P>Date Written:  9/87</p><P>Last reviewed:  3/88</p><p>The technique that's used to determine this is similar to the above technique.The TrapAvailable routine above is reused. In Pascal:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    FUNCTION TempMemCallsAvailable: BOOLEAN;       CONST          OSDispatchTrapNumber = $A88F; {number for temporary memory calls}    BEGIN {TempMemCallsAvailable}    {  Since OSDispatch has a trap number that was always defined       to be a toolbox trap ($8F), we can always call TrapAvailable.       If we are on a machine that does not have separate OS and       Toolbox trap tables, we'll still get the right trap address.}       TempMemCallsAvailable := TrapAvailable(OSDispatchTrapNumber, ToolTrap);       {check for OSDispatch}</pre>	</TD></TR></TABLE></CENTER><p>In C:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    Boolean    TempMemCallsAvailable()    {    /* define trap number for old MPW or non-MPW C */    #ifndef _OSDispatch    #define _OSDispatch 0xA88F    #endif    /* Since OSDispatch has a trap number that was always defined to       be a toolbox trap ($8F), we can always call TrapAvailable.       If we are on a machine that does not have separate OS and       Toolbox trap tables, we'll still get the right trap address. */       return(TrapAvailable(_OSDispatch, ToolTrap));       /* check for OSDispatch */</pre>	</TD></TR></TABLE></CENTER><P><A HREF="#top">Back to top</A></p><a name="Section3"></a><h2>How can I tell if my application is running in the background?</h2><P>Date Written:  9/87</p><P>Last reviewed:  3/88</p><p>To run in the background under MultiFinder, an application must have set the<code>canBackground</code> bit (bit 12 of the first word) in the SIZE resource. Inaddition, the <code>acceptSuspendResumeEvents</code> bit (bit 14) should be set. Anapplication can tell it is running in the background if it has received asuspend event but not a resume event.</p><P><A HREF="#top">Back to top</A></p><a name="Section4"></a><h2>When exactly does juggling take place?</h2><P>Date Written:  9/87</p><P>Last reviewed:  3/88</p><p>Juggling takes place at <code>WaitNextEvent/GetNextEvent/EventAvail</code> time. Ifyou have the <code>acceptSuspendResumeEvents</code> bit set in the SIZE resource,you will receive suspend/resume events. When you get a suspend event (or, whenyou call <code>EventAvail</code> and a suspend event has been posted), you will bejuggled out the next time that you call <code>WNE/GNE/EventAvail</code>. When youreceive a suspend event, you are going to be juggled, so don't do anything totry to retain control (such as calling <code>ModalDialog</code>).</p><p>Speaking of <code>ModalDialog</code>, MultiFinder will <b>not</b> suspend yourapplication when the frontmost window is a modal dialog, though backgroundtasks will continue to get time.</p><P><A HREF="#top">Back to top</A></p><a name="Section5"></a><h2>Can I disable suspend/resume events by passing the appropriate event mask toWNE/GNE/EventAvail?</h2><P>Date Written:  9/87</p><P>Last reviewed:  3/88</p><p>suspend/resu,e events are not queued, so be careful when masking out<code>app4Evts</code>. You will still get the event, all that will happen if youmask out <code>app4Evts</code> is that your application won't know when it is goingto be juggled out (your application will still be juggled out when you call<code>WNE/GNE/EventAvail</code>). If your application sets a boolean to tellwhether or not it's in the foreground or the background, you definitely don'twant to mask out <code>app4Evts</code>.</p><P><A HREF="#top">Back to top</A></p><a name="Section6"></a><h2>Should my application use WaitNextEvent?</h2><P>Date Written:  9/87</p><P>Last reviewed:  3/88</p><p>Yes, this will enable background tasks to get as much time as possible. Alluser events that your program needs to handle will be passed to yourapplication as quickly as possible. Applications that run in the backgroundshould try to be as friendly as possible. It's best to do things a small chunkat a time so as to give maximum time to the foreground application."Cooperative multi-tasking" requires cooperation!</p><p>If your application calls <code>WaitNextEvent</code>, it shouldn't call<code>SystemTask</code>.</p><P><A HREF="#top">Back to top</A></p><a name="Section7"></a><h2>Is there anything else that I can do to be MultiFinder friendly?</h2><P>Date Written:  9/87</p><P>Last reviewed:  11/16/93</p><p>It is very important that you save the positions of windows that you open, sothat the next time the user launches your application, the windows will gowhere they had them last. This greatly enhances the usability of MultiFinder.See Technote TB575 - <A HREF = "tb_575.html">Window Manager Q&amp;As: "How to save and restore windowpositions."</a></p> <P><A HREF="#top">Back to top</A></p><a name="Section8"></a><h2>Can I use a debugger with MultiFinder?</h2><P>Date Written:  9/87</p><P>Last reviewed:  3/88</p><p>Yes, MacsBug will load normally, since it is loaded well before MultiFinder.Since TMON is currently installed as a startup application, you should SetStartup to it, then launch MultiFinder manually (by holding down Option-Commandwhile double-clicking the MultiFinder icon) or use a program that will runmultiple startup applications (such as Sequencer), making sure that TMON is runbefore MultiFinder. If you try to run TMON after MultiFinder has beeninstalled, a system crash will result. The latest version of TMON (2.8) has anINIT that loads it before MultiFinder is present.</p><p>It is necessary to check <code>CurApName</code> (<code>$910</code>) when you firstenter a debugger (TMON users can anchor a window to <code>$910</code>) to see whichlayer (whose code, which low-memory globals and so on) is currently executing,especially if you entered the debugger by pressing the interrupt button.</p><P><A HREF="#top">Back to top</A></p><a name="Section9"></a><h2>What happened to animated icons under MultiFinder?</h2><P>Date Written:  9/87</p><P>Last reviewed:  3/88</p><p>Finders 6.0 and newer no longer use the mask that you supply in an ICN# to"punch a hole" in the desktop. Instead, the Finder uses a default mask thatconsists of a solid black copy of the icon with no hole.</p><P><A HREF="#top">Back to top</A></p><a name="Section10"></a><h2>How can I ensure maximal compatibility with MultiFinder?</h2><P>Date Written:  9/87</p><P>Last reviewed:  3/88</p><p>If you follow the guidelines presented in the MultiFinder Developer's Packageyou will stand a very good chance of being fully compatible with MultiFinder.</p><P><A HREF="#top">Back to top</A></p><a name = "References"></a><h2>References</h2><P><A HREF = "../ov/ov_16.html">M.OV.GestaltSysenvirons</a></p><P><A HREF = "../ov/ov_02.html">M.OV.ChkForFunction</a></p><P>MultiFinder Developer's Package</p>         <a name="Downloads"></a>       <P><A HREF="#top">Back to top</A></p><h2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (60K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/tb_14.pdf">Download</A></P>               </TD>            </TR>                    </TABLE>         <BR></TD></TR></table></center><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tb/tb_14.html%3Fid%3DDTS10002765-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tb/tb_14.html%3Fid%3DDTS10002765-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tb/tb_14.html%3Fid%3DDTS10002765-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>