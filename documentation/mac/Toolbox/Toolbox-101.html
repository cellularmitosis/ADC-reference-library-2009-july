<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Changing the Appearance of Items in a Menu(IM:Tb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING101></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Toolbox-100.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-102.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Toolbox-2.html"><B>Macintosh Toolbox Essentials</B></A> / <BR><DD><A HREF="Toolbox-89.html"><B>Chapter 3 - Menu Manager</B></A> / <A HREF="Toolbox-97.html"><B>Using the Menu Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING101-0></A>
<H2><A NAME=MARKER-9-289></A>Changing the Appearance of Items in a Menu</H2>
 You can change the appearance of an item in a menu using Menu Manager routines. For example, you can change the font style, text, or other characteristics of menu items. You can also enable or disable a menu item.<P>
 Most of the Menu Manager routines that get or set characteristics of a particular menu item require three parameters:<P>
<UL>
<LI>a handle to the menu record of the menu containing the desired menu item 
<LI>the number of the menu item 
<LI>a variable that either specifies the data to set or identifies where to return information about that item<P>
</UL>
<A NAME=HEADING101-6></A>
<H3><A NAME=MARKER-9-290></A><A NAME=MARKER-21-291></A>Enabling and Disabling Menu Items</H3>
 <A NAME=MARKER-2-292></A>Using the <CODE>EnableItem</CODE> and <CODE>DisableItem</CODE> procedures, you can enable and disable specific menu items or an entire menu. You pass as parameters to these two procedures a handle to the menu record that identifies the desired menu and either an item number that identifies the particular menu item to enable or disable or a value of 0 to indicate that the entire menu should be enabled or disabled.<P>
 Your application should always enable and disable any menu items as appropriate-- according to the user's content--before calling <CODE>MenuSelect</CODE> or <CODE>MenuKey</CODE>. For example, you should enable the Paste command when the scrap contains data that the user can paste. (<A HREF=Toolbox-103.html#MARKER-9-399>Listing 3-19 on page 3-76</A> shows code that adjusts an application's menus.)<P>
 When you disable or enable an entire menu, call <CODE>DrawMenuBar</CODE> to update the menu bar. The <CODE>DrawMenuBar</CODE> procedure draws the menus in the menu bar according to their current enabled state and as they are defined in the current menu list. <A NAME=MARKER-2-294></A><P>
 If you disable an entire menu, the Menu Manager dims the menu title at your application's next call to <CODE>DrawMenuBar</CODE> and dims all items in the menu when it displays the menu. If you enable an entire menu, the Menu Manager enables only the menu title and any items that you did not previously disable individually; the Menu Manager does not enable any item that your application previously disabled by calling <CODE>DisableItem</CODE> with that menu item's item number. For example, if all items in your application's Edit menu are enabled, you can disable the Cut and Copy commands individually using <CODE>DisableItem</CODE>. If you choose to disable the entire menu by passing 0 as the menu item parameter to <CODE>DisableItem</CODE>, the menu and all its items are disabled. If you then enable the entire menu by passing 0 as the menu item parameter to <CODE>EnableItem</CODE>, the menu and its items are enabled, except for the Cut and Copy commands, which remain disabled. In this case, to enable the Cut and Copy commands, you must enable each one individually using <CODE>EnableItem</CODE>.<P>
 You can use <CODE>DisableItem</CODE> to disable items that aren't appropriate at a given time. For example, you can disable the Cut and Copy commands when the user has not selected anything to cut or copy and disable the Paste command when the scrap is empty. <P>
 This code enables the File menu, disables the Cut and Copy commands in the Edit menu, and disables the application-defined menu Colors.<P>
<PRE>
VAR
   menu: MenuHandle;

   menu := GetMenuHandle(mFile); {get a handle to the File menu}
   EnableItem(menu, 0);          {enable File menu and any items }
                                 { not individually disabled}
   DrawMenuBar;                  {update menu bar's appearance}

   menu := GetMenuHandle(mEdit); {get a handle to the Edit menu}
   DisableItem(menu, iCut);      {disable the Cut command}
   DisableItem(menu, iCopy);     {disable the Copy command}
   menu := GetMenuHandle(mColors);{get a handle to Colors menu}
   DisableItem(menu, 0);         {disable Colors menu &amp; all }
                                 { items in it}
   DrawMenuBar;                  {update menu bar's appearance}
</PRE>
 If you disable or enable an entire menu, call <CODE>DrawMenuBar</CODE> when you need to update the menu bar's appearance. If you do not need to update the menu bar immediately, you can use the <CODE>InvalMenuBar</CODE> procedure instead of <CODE>DrawMenuBar</CODE>, thus reducing flickering in the menu bar. Rather than drawing the menu bar twice as in the previous example, you can use <CODE>InvalMenuBar</CODE> instead of <CODE>DrawMenuBar</CODE>, causing the Event Manager to redraw the menu bar the next time it scans for update events. The <CODE>InvalMenuBar</CODE> procedure is available in System 7 and later. See <A HREF=Toolbox-131.html#MARKER-9-541>page 3-114</A> for additional details on the <CODE>InvalMenuBar</CODE> procedure.<A NAME=MARKER-2-295></A><A NAME=MARKER-2-296></A><P>
<A NAME=HEADING101-16></A>
<H3><A NAME=MARKER-9-297></A><A NAME=MARKER-21-298></A>Changing the Text of an Item</H3>
 <A NAME=MARKER-2-508></A>You can get or set the text of a menu item using Menu Manager routines.<P>
 To get the text of a menu item, use the <CODE>GetMenuItemText</CODE> procedure. For example, you can use the <CODE>GetMenuItemText</CODE> procedure to get the text of a menu item that you added to a menu using <CODE>InsertResMenu</CODE> or <CODE>AppendResMenu</CODE>. <A NAME=MARKER-2-515></A><P>
 To set the text of a menu item, use the <CODE>SetMenuItemText</CODE> procedure. You can use <BR>the <CODE>SetMenuItemText</CODE> procedure as a convenient way to change the text of a menu command that allows the user to toggle between two states. For example, if your application has a menu command that allows the user to either show or hide the Clipboard window, depending on whether the window is currently showing, you can change the text of the menu item at the appropriate time using the <CODE>SetMenuItemText</CODE> procedure.<P>
 <A HREF=#MARKER-9-301>Listing 3-9</A> changes the text of a menu item from Hide Clipboard to Show Clipboard or vice versa, based on the state of an application-defined global variable (<CODE>gToggleState</CODE>) that holds the state information.<P>
<B>Listing 3-9  <A NAME=MARKER-9-301></A>Changing the text of a menu item<A NAME=MARKER-9-139></A></B><P>
<PRE>
PROCEDURE MyToggleHideShow;
VAR
   myMenu:     MenuHandle;
   item:       Integer;
   itemString: Str255;
BEGIN
   myMenu := GetMenuHandle(mEdit);
   item := iToggleHideShow;   
   IF gToggleState = kShow THEN
   BEGIN
      GetIndString(itemString, kMyStrings, kShowClipboard);
      gToggleState := kHide;
   END
   ELSE
   BEGIN
      GetIndString(itemString, kMyStrings, kHideClipboard);
      gToggleState := kShow;
   END;
   SetMenuItemText(myMenu, item, itemString);
END;
</PRE>
 Note that if you use the <CODE>SetMenuItemText</CODE> procedure, you should define the text of the menu item in a string resource or string list resource (for example, using an <CODE>'STR '</CODE> or <CODE>'STR#'</CODE> resource). This makes your application easier to localize. <A NAME=MARKER-2-303></A><A NAME=MARKER-2-304></A><A NAME=MARKER-2-509></A><P>
<A NAME=HEADING101-24></A>
<H3><A NAME=MARKER-21-306></A>Changing the Font Style of Menu Items</H3>
 <A NAME=MARKER-2-510></A>You can change or get the font style of a menu item using the <CODE>SetItemStyle</CODE> or <CODE>GetItemStyle</CODE> procedure. To set the style of a menu item, specify a handle to the menu record of the menu containing the menu item whose style you want to set, specify the number of the menu item to set, and specify the desired style.<A NAME=MARKER-2-308></A><A NAME=MARKER-2-261></A><P>
 You specify the style using values from the set defined by the <CODE>Style</CODE> data type:<P>
<PRE>
TYPE 
      StyleItem = (bold, italic, underline, outline, shadow, 
                   condense, extend);
      Style = SET OF StyleItem;
</PRE>
 You can set the style of a menu item to zero, one, or more than one of the styles defined by the <CODE>StyleItem</CODE> data type. You can set the style of a menu item to the empty set to obtain the plain font style.<P>
 <A HREF=#MARKER-9-310>Listing 3-10</A> shows code that sets the style of menu items listed in an application's <BR>Style menu.<P>
<B>Listing 3-10  <A NAME=MARKER-9-310></A>Setting the font style of menu items</B><P>
<PRE>
VAR
   menu:       MenuHandle;
   itemStyle:  Style;
   menu := GetMenuHandle(mStyle); {get a handle to the Style menu}
   itemStyle := [italic];
   SetItemStyle(menu, iItalic, itemStyle);{set to italic style}
   itemStyle := [bold];
   SetItemStyle(menu, iBold, itemStyle);{set item to bold style}
   itemStyle := [bold, Italic];
   SetItemStyle(menu, iBoldItal, itemStyle);{bold &amp; italic style}
   itemStyle := [];
   SetItemStyle(menu, iPlain, itemStyle);{set item to plain style}
</PRE>
 To get the style of a menu item, you can use the <CODE>GetItemStyle</CODE> procedure. <A NAME=MARKER-2-311></A><A NAME=MARKER-2-513></A><P>
<A NAME=HEADING101-34></A>
<H3><A NAME=MARKER-9-313></A>Changing the Mark of Menu Items</H3>
 <A NAME=MARKER-2-511></A>You can change or get the mark of a menu item using the <CODE>SetItemMark</CODE> or <CODE>GetItemMark</CODE> procedure. To set the mark of a menu item to a checkmark, you <BR>can use either the <CODE>CheckItem</CODE> or the <CODE>SetItemMark</CODE> procedure.<P>
 <A NAME=MARKER-2-531></A>To set the mark of a menu item, specify a handle to the menu record of the menu containing the item whose mark you want to set, specify the number of the menu <BR>item to set, and specify the mark to use as the marking character of the menu item.<P>
 You typically use checkmarks and dashes in menus that contain commands that set attributes and that you have grouped in accumulating groups. For example, you use a combination of checkmarks and dashes in the Style menu to indicate whether the selection contains more than one style. <A HREF=Toolbox-93.html#MARKER-9-100>Figure 3-8 on page 3-14</A> shows an example of using checkmarks and dashes in a menu. <A HREF=Toolbox-93.html#MARKER-9-92>"Groups of Menu Items" beginning on page 3-13</A> gives guidelines for determining how to group your menu items.<P>
 You specify the mark of the menu item by passing a character as one of the parameters to the <CODE>SetItemMark</CODE> procedure. You should use only the standard marking characters, such as the checkmark, diamond, or dash, in your menu items; avoid using other marks that might confuse the user. You can use the constants listed here to specify that the item has no mark or to set the marking character to a checkmark or diamond:<P>
<PRE>
CONST noMark      = 0;     {no marking character}
      checkMark   = $12;   {checkmark}
      diamondMark = $13;   {diamond symbol}
</PRE>
 As another example of the use of marks in menus, <A HREF=#MARKER-9-316>Listing 3-11</A> shows code that sets the mark of items in an application-defined Directory menu. It sets the marking character of the menu item of the last directory accessed to a checkmark, sets the marking character of the second-last directory accessed to the diamond mark, and removes the mark from the third-last directory accessed.<P>
<B>Listing 3-11  <A NAME=MARKER-9-316></A>Adding marks to and removing marks from menu items</B><P>
<PRE>
VAR
   menu:       MenuHandle;
   itemMark:   Char;
                                 {get handle to Directory menu}
   menu := GetMenuHandle(mDirectory);
   itemMark := CHR(checkMark);
   SetItemMark(menu, gLastDir, itemMark); {set mark to checkmark} 
   itemMark := CHR(diamondMark);
   SetItemMark(menu, gOldLastDir, itemMark); {set mark to diamond}
   itemMark := CHR(noMark);
   SetItemMark(menu, gSecondLastDir, itemMark);{remove any mark}
</PRE>
 You can also set the mark of a menu item to a checkmark using the <CODE>CheckItem</CODE> procedure:<P>
<PRE>
VAR
   menu:       MenuHandle;
                                 {get handle to Directory menu}
   menu := GetMenuHandle(mDirectory); 
   CheckItem(menu, gLastDir, TRUE);       {set to checkmark}
   CheckItem(menu, gSecondLastDir, FALSE);{remove checkmark or }
                                          { any other mark} 
</PRE>
<A NAME=HEADING101-48></A>
<H3><A NAME=MARKER-9-317></A><A NAME=MARKER-21-318></A>Changing the Icon or Script Code of Menu Items</H3>
 <A NAME=MARKER-2-319></A>You can change or get the icon of a menu item using the <CODE>SetItemIcon</CODE> or <CODE>GetItemIcon</CODE> procedure. You can also use these procedures to get or set the <BR>script code of a menu item's text.<A NAME=MARKER-2-320></A><P>
 <A NAME=MARKER-2-533></A>To set the script code of a menu item using the <CODE>SetItemIcon</CODE> procedure, you need to<A NAME=MARKER-2-322></A><A NAME=MARKER-2-323></A><P>
<UL>
<LI>specify a handle to the menu record of the menu containing the item whose script code you want to set 
<LI>specify the number of the menu item to set 
<LI>specify the script code<P>
</UL>
 To set a menu item's script code, you must also define the keyboard equivalent field of the item to $1C. If an item contains $1C in its keyboard equivalent field and a script code in its icon field, the Menu Manager draws the item in the script identified by the script code value if the corresponding script system is installed. <A NAME=MARKER-2-324></A><A NAME=MARKER-2-325></A><P>
 To set the icon of a menu item using the <CODE>SetItemIcon</CODE> procedure, you need to<P>
<UL>
<LI>specify a handle to the menu record of the menu containing the item whose icon you want to set 
<LI>specify the number of the menu item to set 
<LI>specify the icon number (the Menu Manager uses the icon number to generate the resource ID of the icon)<P>
</UL>
 The icon number that you specify to <CODE>SetItemIcon</CODE> must be a value from 1 through 255 for color icons or icons, from 1 through 254 for small icons and reduced icons, or 0 to specify that the item doesn't have an icon. The Menu Manager adds 256 to the number you specify and uses this calculated number as the icon's resource ID. For example, if you specify the icon number as 5, the Menu Manager uses the Resource Manager to find the icon with resource ID 261. The Menu Manager first looks for an icon resource of type <CODE>'cicn'</CODE>; if it can't find one with the calculated resource ID number (or if the computer doesn't have Color QuickDraw), it looks for a resource of type <CODE>'SICN'</CODE> if the keyboard equivalent field contains $1E; otherwise, it looks for an <CODE>'ICON'</CODE> resource. <A NAME=MARKER-2-326></A><A NAME=MARKER-2-327></A><A NAME=MARKER-2-328></A><A NAME=MARKER-9-243></A><A NAME=MARKER-2-331></A><A NAME=MARKER-2-332></A><A NAME=MARKER-2-333></A><A NAME=MARKER-9-105></A><A NAME=MARKER-2-335></A><A NAME=MARKER-2-336></A><P>
 Use either an <CODE>'ICON'</CODE> or <CODE>'SICN'</CODE> resource if you want to provide only a black-and-white icon. In addition, provide a <CODE>'cicn'</CODE> resource if you want the Menu Manager to use a color icon when Color QuickDraw is available. <A HREF=#MARKER-9-338>Figure 3-34</A> shows examples of icons in a menu item generated from icon resources: an <CODE>'SICN'</CODE> resource, an <CODE>'ICON'</CODE> resource, an <CODE>'ICON'</CODE> resource reduced to fit in a 16-by-16 bit rectangle, and a <CODE>'cicn'</CODE> resource.<A NAME=MARKER-2-337></A><P>
<B>Figure 3-34  <A NAME=MARKER-9-338></A>Icons in menu items</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/Figure_1-34_MMS-34.jpg"><P>
 The Menu Manager automatically fits the icon in the menu item according to your specifications. If the Menu Manager uses a <CODE>'cicn'</CODE> resource, it automatically enlarges the enclosing rectangle of the menu item according to the rectangle specified in the <CODE>'cicn'</CODE> resource. If the Menu Manager uses an <CODE>'ICON'</CODE> resource and the item specifies the <CODE>nokey</CODE> constant as the keyboard equivalent, the Menu Manager enlarges the rectangle of the menu item to fit the 32-by-32 bit<DFN> <CODE>'ICON'</CODE></DFN> resource. You can request that the Menu Manager<DFN> </DFN>reduce an <CODE>'ICON'</CODE> resource to the size of a 16-by-16 bit small icon by specifying a value of $1D as the item's keyboard equivalent. To request that the Menu Manager use an <CODE>'SICN'</CODE> resource instead of an <CODE>'ICON'</CODE> resource, specify a value of $1E as the item's keyboard equivalent.<P>
 This code sets the icon of a menu item to a specified icon.<P>
<PRE>
VAR
   menu:       MenuHandle;
   itemIcon:   Byte;
   itemIcon := 5;
   menu := GetMenuHandle(mWeather);       
   {set the icon for this item in the Weather menu}
   SetItemIcon(menu, iBeachWeather, itemIcon);
</PRE>
 <A HREF=#MARKER-9-340>Listing 3-12</A> shows the Rez description of three menu items, each of which contains icons. The first menu item has an icon with resource ID 261 (5 plus 256) and is defined by a resource type of either <CODE>'cicn'</CODE> or <CODE>'ICON'</CODE>. The second menu item has an icon with resource ID 262 (6 plus 256) and is identified by either a <CODE>'cicn'</CODE> resource or an <CODE>'ICON'</CODE> resource; however, in this case, the value of $1D requests the Menu Manager to reduce the <CODE>'ICON'</CODE> resource to a small icon. The third menu item has an icon with resource ID 263 (7 plus 256) and is defined by either a <CODE>'cicn'</CODE> resource or<DFN> an <CODE>'SICN'</CODE></DFN> resource.<A NAME=MARKER-2-339></A><P>
<B>Listing 3-12  <A NAME=MARKER-9-340></A>Specifying icons for menu items</B><P>
<PRE>
#define mWeather 138
resource 'MENU' (mWeather, preload) {
      mWeather,                     
      textMenuProc,                 
      0b0000000000000000001011101100111,  
      enabled, "Weather&quot;,              
      {                             
         &quot;Beach Weather&quot;,  /*item has icon or color icon */
                           /* with icon number 5*/
            5, nokey, nomark, plain;
         &quot;Ski Weather&quot;,    /*item has reduced icon or color */
                           /* icon with icon number 6*/
            6, $1D, nomark, plain;
         &quot;Kite-Flying Weather&quot;,/*item has small icon or */
                               /* color icon with icon number 7*/
            7, $1E, nomark, plain
      }
   };
</PRE>
 See the chapter "Finder Interface" in this book for details on how to create icons. <A NAME=MARKER-2-534></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Toolbox-100.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-102.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Toolbox-3.html">&copy; Apple Computer, Inc.</A><br>11 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
