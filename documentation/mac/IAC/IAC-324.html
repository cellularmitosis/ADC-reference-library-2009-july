<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Recording Insertion Points(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING324></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-323.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-325.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-316.html"><B>Chapter 9 - Recording Apple Events</B></A> / <A HREF="IAC-321.html"><B>What to Record</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING324-0></A>
<H2>Recording Insertion Points</H2>
 The insertion point and a selection are synonymous in the Macintosh Operating System. However, scripting languages need a way of specifying a zero-width selection. Sometimes the best way to specify an insertion location is in relation to another object; for example, "after word 5." This section describes recommended methods of specifying an insertion point in a recordable event.<P>
 The insertion point can be specified in Apple events by either an insertion location descriptor record (<CODE>typeInsertionLocation</CODE>) or an object specifier record (<CODE>typeObjectSpecifier</CODE>) that specifies the class <CODE>cInsertionLoc</CODE> and the key form <CODE>formRelativePosition</CODE>. The Move, Clone, and Create events accept an insertion location descriptor record; other events, including Select and Set Data, require an object specifier record. <P>
 Five constants can be used to describe an insertion point in relation to an object or container: 
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Constant<TH>Corresponding insertion point<TR>
<TD>kAEReplace<TD>The specified object will be replaced if not qualified by one of the other phrases<TR>
<TD>kAEBefore<TD>Just before the specified object (either type <CODE>typeObjectSpecifier</CODE> or type <CODE>typeInsertionLocation</CODE>)<TR>
<TD>kAEAfter<TD>Just after the specified object (either type <CODE>typeObjectSpecifier</CODE> or type <CODE>typeInsertionLocation</CODE>)<TR>
<TD>kAEBeginning<TD>In the specified container and before all other elements of the same class in that container (type <CODE>typeInsertionLocation</CODE> only)<TR>
<TD>kAEEnd<TD>In the specified container and after all other elements of the same class in that container</TABLE>
 <P>
 For more information about the way AppleScript uses insertion location descriptor records, see <A HREF=IAC-300.html#MARKER-9-15>"Defining Terminology for Use by the AppleScript Component,"</A> which begins on <A HREF=IAC-300.html#MARKER-9-15>page 8-3</A>, and the <I>Apple Event Registry: Standard Suites.</I> The rest of this section provides examples of object specifier records used to specify insertion points.<P>
 Users usually insert objects after some other object. So, unless the insertion point is clearly at the beginning or end of a container or identifies an object to be replaced, use the constant <CODE>kAEAfter</CODE> to record the location. <P>
 For example, if the user places the insertion point after character 2, your application should send a Select event with this direct parameter:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyDirectObject<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cInsertionLoc<TR>
<TD>  keyAEContainer<TD>  typeObjectSpecifier<TD>  (see indented record)<TR>
<TD>    keyAEDesiredClass<TD>    typeType<TD>    cChar<TR>
<TD>    keyAEContainer<TD>    typeNull<TD>    No data<TR>
<TD>    keyAEKeyForm<TD>    typeEnumerated<TD>    formAbsolutePosition<TR>
<TD>    keyAEKeyData<TD>    typeLongInteger<TD>    2<TR>
<TD>  keyAEKeyForm<TD>  typeEnumerated<TD>  formRelativePosition<TR>
<TD>  keyAEKeyData<TD>  typeEnumerated<TD>  kAEAfter</TABLE>
<P>
 If the selection is not 0 characters wide, the user is replacing the selection with another object, so you can specify the location simply as the object specifier record for the object to be replaced.<P>
 If the user clicks the white space after a paragraph somewhere in the middle of the document, defining the insertion point becomes more complex because different applications deal with this situation in different ways. Some place the insertion point at the end of the current paragraph, while others place the insertion point at the beginning of the next paragraph. Depending on the way your application handles this situation, you should use an object specifier record that specifies either <CODE>kAEBeginning</CODE> or <CODE>kAEEnd</CODE>.<P>
 Remember that the Select event requires an object specifier record. Thus, if you want to place the insertion point at the beginning of a paragraph, use an object specifier record that specifies a location just before the first item of the paragraph, rather than an insertion location descriptor record. <P>
 For example, a Select event with this direct parameter places the insertion point just before the first item of paragraph 3:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyDirectObject<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cInsertionLoc<TR>
<TD>  keyAEContainer<TD>  typeObjectSpecifier<TD>  (see indented record)<TR>
<TD>    keyAEDesiredClass<TD>    typeType<TD>    cItem<TR>
<TD>    keyAEContainer<TD>    typeObjectSpecifier<TD>    (see indented record)<TR>
<TD>      keyAEDesiredClass<TD>      typeType<TD>      cParagraph<TR>
<TD>      keyAEContainer<TD>      typeNull<TD>      No data<TR>
<TD>      keyAEKeyForm<TD>      typeEnumerated<TD>      formAbsolutePosition<TR>
<TD>      keyAEKeyData<TD>      typeLongInteger<TD>      3<TR>
<TD>    keyAEKeyForm<TD>    typeType<TD>    formAbsolutePosition<TR>
<TD>    keyAEKeyData<TD>    typeLongInteger<TD>    1<TR>
<TD>  keyAEKeyForm<TD>  typeEnumerated<TD>  formRelativePosition<TR>
<TD>  keyAEKeyData<TD>  typeEnumerated<TD>  kAEPrevious</TABLE>
<P>
 If the user clicks the left edge of the first line in a paragraph, thus setting the insertion point before the beginning of the paragraph, you should use a similar strategy. However, this is the only situation in which you should use <CODE>kAEPrevious</CODE>.<P>
 When the insertion point is at the end of a document record, use an object specifier record that specifies the location after the last item in the document.<P>
 For example, a Select event with this direct parameter places the insertion point just after the last item in a document:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyDirectObject<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cInsertionLoc<TR>
<TD>  keyAEContainer<TD>  typeObjectSpecifier<TD>  (see indented record)<TR>
<TD>    keyAEDesiredClass<TD>    typeType<TD>    cItem<TR>
<TD>    keyAEContainer<TD>    typeNull<TD>    No data<TR>
<TD>    keyAEKeyForm<TD>    typeEnumerated<TD>    formAbsolutePosition<TR>
<TD>    keyAEKeyData<TD>    typeLongInteger<TD>    -1<TR>
<TD>  keyAEKeyForm<TD>  typeEnumerated<TD>  formRelativePosition<TR>
<TD>  keyAEKeyData<TD>  typeEnumerated<TD>  kAENext</TABLE>
 <P>
 A Select event with this direct parameter places the insertion point just after the last item in paragraph 3:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyDirectObject<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cInsertionLoc<TR>
<TD>  keyAEContainer<TD>  typeObjectSpecifier<TD>  (see indented record)<TR>
<TD>    keyAEDesiredClass<TD>    typeType<TD>    cParagraph<TR>
<TD>    keyAEContainer<TD>    typeNull<TD>    No data<TR>
<TD>    keyAEKeyForm<TD>    typeEnumerated<TD>    formAbsolutePosition<TR>
<TD>    keyAEKeyData<TD>    typeLongInteger<TD>    3<TR>
<TD>  keyAEKeyForm<TD>  typeEnumerated<TD>  formRelativePosition<TR>
<TD>  keyAEKeyData<TD>  typeEnumerated<TD>  kAENext</TABLE>
<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-323.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-325.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
