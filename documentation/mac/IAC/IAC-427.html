<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Using the PPC Toolbox(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING427></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-426.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-428.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-423.html"><B>Chapter 11 - Program-to-Program Communications Toolbox</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING427-0></A>
<H1><A NAME=MARKER-21-39></A>Using the PPC Toolbox</H1>
 This section describes how to <P>
<UL>
<LI>use PPC Toolbox calling conventions
<LI>open a port
<LI>list all available port locations on the network
<LI>indicate that a port is available to accept session requests
<LI>initiate a session
<LI>accept and reject session requests
<LI>read and write data during a session
<LI>end a session after data is transmitted and received
<LI>close a port when it is no longer needed to transmit or receive data
<LI>invalidate users<P>
</UL>
 To begin, you must determine whether the PPC Toolbox is available on the user's computer system by using the <CODE>Gestalt</CODE> function with the selector <CODE>gestaltPPCToolboxAttr</CODE>. A <CODE>noErr</CODE> result code indicates that the PPC Toolbox is present.<P>
 The <CODE>Gestalt</CODE> function returns a combination of the following constants in the <CODE>response</CODE> parameter: <CODE>gestaltPPCToolboxPresent</CODE>, <CODE>gestaltPPCSupportsRealTime</CODE>, <CODE>gestaltPPCSupportsOutGoing</CODE>, and <CODE>gestaltPPCSupportsIncoming</CODE>.<P>
 The PPC Toolbox currently supports only sessions in real time. The <CODE>Gestalt</CODE> function returns <CODE>gestaltPPCSupportsRealTime</CODE> by default. If this bit is not set, you need to initialize the PPC Toolbox.<P>
 The <CODE>Gestalt</CODE> function returns <CODE>gestaltPPCSupportsOutGoing</CODE> to indicate support of outgoing sessions across a network of Macintosh computers. If this bit is not set, the user hasn't enabled AppleTalk in the Chooser.<P>
 The <CODE>Gestalt</CODE> function returns <CODE>gestaltPPCSupportsIncoming</CODE> if the user has enabled program linking in the Sharing Setup control panel. If this bit is not set, the user either hasn't enabled AppleTalk in the Chooser or hasn't enabled program linking in the Sharing Setup control panel.<A NAME=MARKER-2-254></A><P>
 Use the <CODE>PPCInit</CODE> function to initialize the PPC Toolbox.<A NAME=MARKER-2-59></A><P>
<PRE>
err := PPCInit;
</PRE>
 <A HREF=#MARKER-9-42>Listing 11-1</A> illustrates how you use the <CODE>PPCInit</CODE> function to initialize the PPC Toolbox.<P>
<B>Listing 11-1  <A NAME=MARKER-9-42></A><A NAME=MARKER-21-43></A>Initializing the PPC Toolbox using the <CODE>PPCInit</CODE> function</B><P>
<PRE>
FUNCTION MyPPCInit: OSErr;
VAR
   PPCAttributes: LongInt;
   err:           OSErr;
BEGIN
   err := Gestalt(gestaltPPCToolboxAttr, PPCAttributes);
   IF err = noErr THEN           {PPC Toolbox is present}
   BEGIN
      IF BAND(PPCAttributes, gestaltPPCSupportsRealTime) = 0 THEN
      BEGIN          
         MyPPCInit := PPCInit;   {initialize the PPC Toolbox}
         {test the attributes for the PPC Toolbox}
         err := Gestalt(gestaltPPCToolboxAttr, PPCAttributes);
      END;
      IF BAND(PPCAttributes, gestaltPPCSupportsOutGoing) &lt;&gt; 0 THEN
         {ports can be opened to the outside world}
      ELSE     {it's likely that AppleTalk is disabled, so you }
         ;     { may want to tell the user to activate AppleTalk }
               { from the Chooser}
      IF BAND(PPCAttributes, gestaltPPCSupportsIncoming) &lt;&gt; 0 THEN
         {ports can be opened with location names that the }
         { outside world can see}
      ELSE     {it's likely that program linking is disabled, so }
         ;     { you may want to tell the user to start program }
               { linking from the Sharing Setup control panel}
   END
   ELSE
      MyPPCInit := err;
END;  
</PRE>
 <A HREF=#MARKER-9-44>Figure 11-9</A> illustrates a spreadsheet application (on the left) that has initiated a session with a database application (on the right) to exchange data using the PPC Toolbox. This figure includes an example of the sequence of PPC Toolbox routines executed by these applications. Detailed descriptions of the functions appear in the sections that follow.<P>
<B>Figure 11-9  <A NAME=MARKER-9-44></A><A NAME=MARKER-21-45></A>Database and spreadsheet applications using the PPC Toolbox</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/PPC-L-09.jpg"><P>
 To establish a session, each application must first open a port using the <CODE>PPCOpen</CODE> function. The spreadsheet application prepares to receive session requests by calling the <CODE>PPCInform</CODE> function. <P>
 Before initiating a session or opening a port, the database application can let the user browse through the list of available ports (using the <CODE>PPCBrowser</CODE> function). If the user decides to communicate with the spreadsheet application, the database application initiates a session with the spreadsheet application's port using the <CODE>StartSecureSession</CODE> function. After the PPC Toolbox authenticates the user name and password of the initiating port, the spreadsheet application accepts the session request (using the <CODE>PPCAccept</CODE> function).<P>
 Once the session is established, the applications exchange information in the form of message blocks (using the <CODE>PPCRead</CODE> and <CODE>PPCWrite</CODE> functions). During a session, an application can both read from and write message blocks to another application. After the information exchange is done, each application ends the session (<CODE>PPCEnd</CODE>) and then closes its port (<CODE>PPCClose</CODE>) when it quits.<P>
 The <CODE>PPCOpen</CODE> function returns a port reference number. The port reference number is a reference number for the port through which you are requesting a session. The database application uses the port reference number in subsequent calls to the <CODE>StartSecureSession</CODE> and <CODE>PPCClose</CODE> functions. The <CODE>StartSecureSession</CODE> function returns a session reference number. The session reference number is used to identify the session during the exchange of data. It is used in subsequent calls to the <CODE>PPCWrite</CODE>, <CODE>PPCRead</CODE>, and <CODE>PPCEnd</CODE> functions.<P>
 The <CODE>PPCOpen</CODE> function returns a port reference number that the spreadsheet uses in subsequent calls to the <CODE>PPCInform</CODE> and <CODE>PPCClose</CODE> functions. The <CODE>PPCInform</CODE> function returns a session reference number that is used in subsequent calls to the <CODE>PPCAccept</CODE>, <CODE>PPCRead</CODE>, <CODE>PPCWrite</CODE>, and <CODE>PPCEnd</CODE> functions.<P>
<HR>
<B>Subtopics</B>
<B><!-- TOC --><DL>
<DL>
<DT><A HREF="IAC-428.html#HEADING428-0">PPC Toolbox Calling Conventions</A>
<DD>
<DT><A HREF="IAC-429.html#HEADING429-0">Specifying Port Names and Location Names</A>
<DD>
<DT><A HREF="IAC-430.html#HEADING430-0">Preparing for a Session</A>
<DD>
<DT><A HREF="IAC-431.html#HEADING431-0">Exchanging Data During a PPC Session</A>
<DD>
<DT><A HREF="IAC-432.html#HEADING432-0">Ending a Session and Closing a Port</A>
<DD>
<DT><A HREF="IAC-433.html#HEADING433-0">Invalidating Users</A>
<DD>
</DL>
</DL>
</B>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-426.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-428.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
