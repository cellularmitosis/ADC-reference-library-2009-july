<!-- legacy work start --><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"        "http://www.w3.org/TR/html4/loose.dtd"><!-- legacy work end --><HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><TITLE> Playing Sounds Using Low-Level Routines (deprecated)</title><!-- legacy work start -->        <META NAME="Generator" CONTENT="manual">        <META http-equiv="content-type" CONTENT="text/html;charset=utf-8">        <META NAME = "Copyright" CONTENT="Copyright 2007 Apple Inc. All Rights Reserved.">        <META NAME="IndexTitle" CONTENT="Sound Input Manager (Not Recommended)">        <meta name="xcode-display" content="render">        <LINK REL="stylesheet" TYPE="text/css" HREF="../../../Resources/CSS/frameset_styles.css"> <!-- before submitting, globally replace ".." with "developer.apple.com" -->        <script type="text/javascript" language="JavaScript" src="../../../Resources/JavaScript/page.js"></script><!-- legacy work end --></HEAD><BODY BGCOLOR="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- path goes here --><!-- QTnavbar start --><P><I>Inside Macintosh: Sound</I><P>| <A target="doc" HREF="imsoundmgr.25.htm">Previous</A> | <A target="doc" HREF="imsoundmgr.1.htm">Chapter contents</A> | <A target="doc" HREF="imsoundmgr.htm">Chapter top</A> | <A target="doc" HREF="imsoundmgr.24.htm">Section top</A> | <A target="doc" HREF="imsoundmgr.27.htm">Next</a> | <!-- QTnavbar end --><!-- legacy work start --><script type="text/javascript"> placeWatermark()</script><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox" style="position: relative;"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b><i>Sound Input Manager</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="http://developer.apple.com/referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div><!-- legacy work end --><H1 CLASS="H3.Heading3"><A NAME="pgfId=2085"> </A><A NAME="40709"> </A>Playing Sounds Using Low-Level Routines<A NAME="marker=333"> </A></H1><P CLASS="T0.Text0"><A NAME="pgfId=2086"> </A>Once you obtain a pointer to a sampled sound header, you can use the <TT CLASS="cv">bufferCmd</TT> sound command to play a sound without using the high-level Sound Manager routines. Many sampled-sound resources include <TT CLASS="cv">bufferCmd</TT> commands, so the high-level Sound Manager routines often issue the <TT CLASS="cv">bufferCmd</TT> command indirectly. Thus, you might in some cases be able to make your application slightly more efficient by issuing the <TT CLASS="cv">bufferCmd</TT> command directly. Also, you might issue a <TT CLASS="cv">bufferCmd</TT> command directly if you want the Sound Manager to ignore other parts of a sound resource.<A NAME="marker=761"> </A><A NAME="marker=760"> </A></P><P CLASS="T1.Text1"><A NAME="pgfId=2242"> </A>Finally, you might issue <TT CLASS="cv">bufferCmd</TT> commands directly if you want your application to be able to play a large sound resource without loading the entire resource at once. By issuing several successive <TT CLASS="cv">bufferCmd</TT> commands, you can play a large sound resource using a small buffer. In this case, each buffer must contain a sampled sound header. In most cases, the sound will play smoothly, without audible gaps. It's generally easier, however, to play large sampled sounds from disk by using the play-from-disk routines or the <TT CLASS="cv">SndPlayDoubleBuffer</TT> function. See <A target="doc" HREF="imsoundmgr.59.htm#17951" CLASS="XRef">&quot;Managing Double Buffers&quot;</A> for complete details.<A NAME="marker=759"> </A></P><P CLASS="Note"><A NAME="pgfId=2088"> </A>Using the <TT CLASS="cv">bufferCmd</TT> command to play several consecutive compressed samples on the Macintosh Plus, the Macintosh SE, or the Macintosh Classic is not guaranteed to work without an audible pause or click.  <A NAME="marker=763"> </A></P><P CLASS="T1.Text1"><A NAME="pgfId=3593"> </A><A NAME="marker=507"> </A>The pointer in the <TT CLASS="cv">param2</TT> field of a <TT CLASS="cv">bufferCmd</TT> command is the location of a sampled sound header. A <TT CLASS="cv">bufferCmd</TT> command is queued in the channel until the preceding commands have been processed. If the <TT CLASS="cv">bufferCmd</TT> command is contained within an <TT CLASS="cv">'snd&nbsp;'</TT> resource, the high bit of the command must be set. If the sound was loaded in from an <TT CLASS="cv">'snd&nbsp;'</TT> resource, your application is expected to unlock this resource and allow it to be purged after using it. <A target="doc" HREF="imsoundmgr.26.htm#35948" CLASS="XRef">Listing 1-40</A> shows how your application can play a sampled sound stored in a resource using the <TT CLASS="cv">bufferCmd</TT> command.</P><P CLASS="L.Listing"><A NAME="pgfId=2412"> </A>Listing&nbsp;40 <A NAME="35948"> </A>Playing a sound using the <TT CLASS="cv">bufferCmd</TT> command</P><CODE CLASS="CvF.CodeFull"><A NAME="pgfId=9967"> </A>FUNCTION MyLowLevelSampledSndPlay (chan: SndChannelPtr; sndHandle: Handle): <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OSErr;<BR>CONST<BR>&nbsp;&nbsp;&nbsp;&nbsp;kWaitIfFull = TRUE;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{wait for room in queue?}<BR>VAR<BR>&nbsp;&nbsp;&nbsp;&nbsp;mySndHeader:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SoundHeaderPtr;<BR>&nbsp;&nbsp;&nbsp;&nbsp;mySndCmd:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SndCommand;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{a sound command}<BR>BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;mySndHeader := MyGetSoundHeader(sndHandle);<BR>&nbsp;&nbsp;&nbsp;&nbsp;WITH mySndCmd DO<BR>&nbsp;&nbsp;&nbsp;&nbsp;BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd := bufferCmd;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{command is bufferCmd}<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param1 := 0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{unused with bufferCmd}<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param2 := LongInt(mySndHeader);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{pointer to sound header}<BR>&nbsp;&nbsp;&nbsp;&nbsp;END;<BR>&nbsp;&nbsp;&nbsp;&nbsp;IF mySndHeader &lt;&gt; NIL THEN<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MyLowLevelSampledSndPlay := <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SndDoCommand(chan, mySndCmd, NOT kWaitIfFull)<BR>&nbsp;&nbsp;&nbsp;&nbsp;ELSE<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MyLowLevelSampledSndPlay := badFormat;<BR>END;<BR></CODE><P CLASS="T1.Text1"><A NAME="pgfId=2414"> </A><A NAME="marker=9969"> </A>For the <TT CLASS="cv">MyLowLevelSampledSndPlay</TT> function defined in <A target="doc" HREF="imsoundmgr.26.htm#35948" CLASS="XRef">Listing 1-40</A> to play a sound, the channel passed to it must already be configured to play sampled-sound data. Otherwise, the function returns a <TT CLASS="cv">badChannel</TT> result code. Also, because the <TT CLASS="cv">bufferCmd</TT> command works asynchronously, you might want to associate a callback procedure with the sound channel when you create the channel. For more information on playing sounds asynchronously, see <A target="doc" HREF="imsoundmgr.1e.htm#28093" CLASS="XRef">&quot;Playing Sounds Asynchronously&quot;</A>.<A NAME="marker=1109"> </A><A NAME="marker=1108"> </A></P><P CLASS="T1.Text1"><A NAME="pgfId=2089"> </A>You can use the <TT CLASS="cv">bufferCmd</TT> command to handle compressed sound samples in addition to sounds that are not compressed. To expand and play back a buffer of compressed samples, you pass the Sound Manager a <TT CLASS="cv">bufferCmd</TT> command where <TT CLASS="cv">param2</TT> points to a compressed sound header.<A NAME="marker=762"> </A></P><P CLASS="T1.Text1"><A NAME="pgfId=2091"> </A>To play sampled sounds that are not compressed, pass <TT CLASS="cv">bufferCmd</TT> a standard or extended sound header. The extended sound header can be used for stereo sampled sounds. The standard sampled sound header is used for all other noncompressed sampled sounds.<A NAME="marker=764"> </A><A NAME="marker=349"> </A></P><hr>&#169; 1999 Apple Computer, Inc.<!-- QTnavbar start --><P><I>Inside Macintosh: Sound</I><P>| <A target="doc" HREF="imsoundmgr.25.htm">Previous</A> | <A target="doc" HREF="imsoundmgr.1.htm">Chapter contents</A> | <A target="doc" HREF="imsoundmgr.htm">Chapter top</A> | <A target="doc" HREF="imsoundmgr.24.htm">Section top</A> | <A target="doc" HREF="imsoundmgr.27.htm">Next</a> | <!-- QTnavbar end --><!-- legacy work start --><script type="text/javascript"> placeWatermark()</script><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox" style="position: relative;"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b><i>Sound Input Manager</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="http://developer.apple.com/referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div><!-- legacy work end --></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY></HTML>