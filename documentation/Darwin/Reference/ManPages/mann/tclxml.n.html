<html><head><title>Mac OS X
 Manual Page For tclxml(n)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/n/tclxml" title="Mac OS X
 Manual Page for tclxml(n)"><a name="//apple_ref/doc/man/n/tclxml" title="Mac OS X
 Manual Page for tclxml(n)"><!-- headerDoc=man; indexgroup=Section n; uid="//apple_ref/doc/man/n/tclxml"; name=tclxml(n) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
TclXML(n)                                  TclXML Package Commands                                 TclXML(n)



<b>NAME</b>
       ::xml::parser ::xml::parserclass - XML parser support for Tcl


<b>SYNOPSIS</b>
       <b>package</b> <b>require</b> <b>xml</b>

       <b>package</b> <b>require</b> <u>parserclass</u>

       <b>::xml::parserclass</b> <u>option</u> ? <u>arg</u> <u>arg</u> <u>...</u> <u>?</u>

       <b>::xml::parser</b> <b>?</b> <u>name</u>? ? <u>-option</u> <u>value</u> ... ?

       <u>parser</u> <u>option</u> <u>arg</u>


<b>DESCRIPTION</b>
       TclXML  provides event-based parsing of XML documents.  The application may register callback scripts
       for certain document features, and when the parser encounters those features while parsing the  docu-<font color="#ffffff" class="whiteout">ment&nbsp;document</font>
       ment the callback is evaluated.


       The  parser  may also perform other functions, such as normalisation, validation and/or entity expan-<font color="#ffffff" class="whiteout">sion.&nbsp;expansion.</font>
       sion.  Generally, these functions are under the control  of  configuration  options.   Whether  these
       functions can be performed at all depends on the parser implementation.


       The  TclXML package provides a generic interface for use by a Tcl application, along with a low-level
       interface for use by a parser implementation.  Each implementation provides a class  of  XML  parser,
       and  these  register  themselves  using the <b>::xml::parserclass</b> <b>create</b> command.  One of the registered
       parser classes will be the default parser class.


       Loading the package with the generic <b>package</b> <b>require</b> <b>xml</b> command allows the package to  automatically
       determine  the  default  parser  class.  In order to select a particular parser class as the default,
       that class' package may be loaded directly, eg. <b>package</b> <b>require</b> <b>expat</b>.  In all cases,  all  available
       parser  classes are registered with the TclXML package, the difference is simply in which one becomes
       the default.


<b>COMMANDS</b>
   <b>::xml::parserclass</b>
       The <b>::xml::parserclass</b> command is used to manage XML parser classes.

   <b>Command</b> <b>Options</b>
       The following command options may be used:


              <b>create</b>  <u>create</u> <u>name</u> ? <u>-createcommand</u> <u>script</u>? ? <u>-createentityparsercommand</u> <u>script</u>? ? <u>-parsecom</u>-<font color="#ffffff" class="whiteout">mand&nbsp;-parsecommand</font>
                     <u>mand</u> <u>script</u>? ? <u>-configurecommand</u> <u>script</u>? ? <u>-getcommand</u> <u>script</u>? ? <u>-deletecommand</u> <u>script</u>?

              Creates an XML parser class with the given name.


              <b>destroy</b>
                      <u>destroy</u> <u>name</u>

              Destroys an XML parser class.


              <b>info</b>    <u>info</u> <u>names</u> <u>default</u>

              Returns information about registered XML parser classes.


   <b>::xml::parser</b>
       The <b>::xml::parser</b> command creates an XML parser object.  The return value of the command is the  name
       of the newly created parser.


       The  parser  scans an XML document's syntactical structure, evaluating callback scripts for each fea-<font color="#ffffff" class="whiteout">ture&nbsp;feature</font>
       ture found.  At the very least the parser will normalise the document  and  check  the  document  for
       well-formedness.   If  the  document is not well-formed then the  <u>-errorcommand</u> option will be evalu-<font color="#ffffff" class="whiteout">ated.&nbsp;evaluated.</font>
       ated.  Some parser classes may perform additional functions, such as validation.  Additional features
       provided by the various parser classes are described in the section Parser Classes


       Parsing  is  performed  synchronously.  The command blocks until the entire document has been parsed.
       Parsing may be terminated by an application callback, see the section Callback Return Codes.   Incre-<font color="#ffffff" class="whiteout">mental&nbsp;Incremental</font>
       mental parsing is also supported by using the  <u>-final</u> configuration option.

   <b>Configuration</b> <b>Options</b>
       The <b>::xml::parser</b> command accepts the following configuration options:


               <u>-attlistdeclcommand</u>
                      <u>-attlistdeclcommand</u> <u>script</u>

              Specifies  the  prefix of a Tcl command to be evaluated whenever an attribute list declaration
              is encountered in the DTD subset of an XML document.  The command evaluated  is:  <u>script</u>  <u>name</u>
              <u>attrname</u> <u>type</u> <u>default</u> <u>value</u>

              where:


                     <u>name</u> Element type name

                     <u>attrname</u> Attribute name being declared

                     <u>type</u> Attribute type

                     <u>default</u> Attribute default, such as #IMPLIED

                     <u>value</u> Default attribute value.  Empty string if none given.


               <u>-baseuri</u> <u>-baseurl</u>
                      <u>-baseuri</u> <u>URI</u>

                      <u>-baseurl</u> <u>URI</u>

              Specifies  the  base  URI  for resolving relative URIs that may be used in the XML document to
              refer to external entities.


               <u>-baseurl</u> is deprecated in favour of  <u>-baseuri</u>.


               <u>-characterdatacommand</u>
                      <u>-characterdatacommand</u> <u>script</u>

              Specifies the prefix of a Tcl command to be evaluated whenever character data  is  encountered
              in the XML document being parsed.  The command evaluated is: <u>script</u> <u>data</u>

              where:


                     <u>data</u> Character data in the document


               <u>-commentcommand</u>
                      <u>-commentcommand</u> <u>script</u>

              Specifies the prefix of a Tcl command to be evaluated whenever a comment is encountered in the
              XML document being parsed.  The command evaluated is: <u>script</u> <u>data</u>

              where:


                     <u>data</u> Comment data


               <u>-defaultcommand</u>
                      <u>-defaultcommand</u> <u>script</u>

              Specifies the prefix of a Tcl command to be evaluated when no other callback has been  defined
              for a document feature which has been encountered.  The command evaluated is: <u>script</u> <u>data</u>

              where:


                     <u>data</u> Document data


               <u>-defaultexpandinternalentities</u>
                      <u>-defaultexpandinternalentities</u> <u>boolean</u>

              Specifies  whether  entities  declared  in  the  internal  DTD  subset are expanded with their
              replacement text.  If entities are not expanded then the entity references  will  be  reported
              with no expansion.


               <u>-doctypecommand</u>
                      <u>-doctypecommand</u> <u>script</u>

              Specifies  the  prefix  of a Tcl command to be evaluated when the document type declaration is
              encountered.  The command evaluated is: <u>script</u> <u>name</u> <u>public</u> <u>system</u> <u>dtd</u>

              where:


                     <u>name</u> The name of the document element

                     <u>public</u> Public identifier for the external DTD subset

                     <u>system</u> System identifier for the external DTD subset.  Usually a URI.

                     <u>dtd</u> The internal DTD subset


              See also  <u>-startdoctypedeclcommand</u> and  <u>-enddoctypedeclcommand</u>.


               <u>-elementdeclcommand</u>
                      <u>-elementdeclcommand</u> <u>script</u>

              Specifies the prefix of a Tcl command to be evaluated when an element  markup  declaration  is
              encountered.  The command evaluated is: <u>script</u> <u>name</u> <u>model</u>

              where:


                     <u>name</u> The element type name

                     <u>model</u> Content model specification


               <u>-elementendcommand</u>
                      <u>-elementendcommand</u> <u>script</u>

              Specifies  the prefix of a Tcl command to be evaluated when an element end tag is encountered.
              The command evaluated is: <u>script</u> <u>name</u> <u>args</u>

              where:


                     <u>name</u> The element type name that has ended

                     <u>args</u> Additional information about this element


              Additional information about the element takes the form of  configuration  options.   Possible
              options are:


                     <u>-empty</u> <u>boolean</u> The empty element syntax was used for this element

                     <u>-namespace</u> <u>uri</u> The element is in the XML namespace associated with the given URI


               <u>-elementstartcommand</u>
                      <u>-elementstartcommand</u> <u>script</u>

              Specifies  the  prefix  of  a Tcl command to be evaluated when an element start tag is encoun-<font color="#ffffff" class="whiteout">tered.&nbsp;encountered.</font>
              tered.  The command evaluated is: <u>script</u> <u>name</u> <u>attlist</u> <u>args</u>

              where:


                     <u>name</u> The element type name that has started

                     <u>attlist</u> A Tcl list containing the attributes for this element.  The list of  attributes
                     is formatted as pairs of attribute names and their values.

                     <u>args</u> Additional information about this element


              Additional information about the element takes the form of  configuration  options.   Possible
              options are:


                     <u>-empty</u> <u>boolean</u> The empty element syntax was used for this element

                     <u>-namespace</u> <u>uri</u> The element is in the XML namespace associated with the given URI

                     <u>-namespacedecls</u>  <u>list</u>  The  start  tag included one or more XML Namespace declarations.
                     list is a Tcl list giving the namespaces declared.  The list is formatted as  pairs  of
                     values,  the  first  value is the namespace URI and the second value is the prefix used
                     for the namespace in this document.  A default XML namespace declaration will  have  an
                     empty string for the prefix.


               <u>-encoding</u>
                      <u>-encoding</u> <u>value</u>

              Gives  the  character encoding of the document.  This option only has an effect before a docu-<font color="#ffffff" class="whiteout">ment&nbsp;document</font>
              ment is parsed.  The default character encoding is <b>utf-8</b>.  If the value <b>unknown</b> is  given,  or
              any value other than <b>utf-8</b>, then the document text is treated as binary data.  If the value is
              given as <b>unknown</b> then the parser will attempt to automatically determine the character  encod-<font color="#ffffff" class="whiteout">ing&nbsp;encoding</font>
              ing  of  the document (using byte-order-marks, etc).  If any value other than <b>utf-8</b> or <b>unknown</b>
              is given then the parser will read the document text using that character encoding.


               <u>-endcdatasectioncommand</u>
                      <u>-endcdatasectioncommand</u> <u>script</u>

              Specifies the prefix of a Tcl command to be evaluated when end of a CDATA section  is  encoun-<font color="#ffffff" class="whiteout">tered.&nbsp;encountered.</font>
              tered.  The command is evaluated with no further arguments.


               <u>-enddoctypedeclcommand</u>
                      <u>-enddoctypedeclcommand</u> <u>script</u>

              Specifies  the  prefix of a Tcl command to be evaluated when end of the document type declara-<font color="#ffffff" class="whiteout">tion&nbsp;declaration</font>
              tion is encountered.  The command is evaluated with no further arguments.


               <u>-entitydeclcommand</u>
                      <u>-entitydeclcommand</u> <u>script</u>

              Specifies the prefix of a Tcl command to be evaluated when an entity  declaration  is  encoun-<font color="#ffffff" class="whiteout">tered.&nbsp;encountered.</font>
              tered.  The command evaluated is: <u>script</u> <u>name</u> <u>args</u>

              where:


                     <u>name</u> The name of the entity being declared

                     <u>args</u>  Additional  information  about  the entity declaration.  An internal entity shall
                     have a single argument, the replacement text.  An external parsed entity shall have two
                     additional  arguments, the public and system indentifiers of the external resource.  An
                     external unparsed entity shall have three additional arguments, the public  and  system
                     identifiers followed by the notation name.


               <u>-entityreferencecommand</u>
                      <u>-entityreferencecommand</u> <u>script</u>

              Specifies the prefix of a Tcl command to be evaluated when an entity reference is encountered.
              The command evaluated is: <u>script</u> <u>name</u>

              where:


                     <u>name</u> The name of the entity being referenced


               <u>-errorcommand</u>
                      <u>-errorcommand</u> <u>script</u>

              Specifies the prefix of a Tcl command to be evaluated when a fatal  error  is  detected.   The
              error  may  be  due  to  the  XML document not being well-formed.  In the case of a validating
              parser class, the error may also be due to the XML document not obeying validity  constraints.
              By  default,  a callback script is provided which causes an error return code, but an applica-<font color="#ffffff" class="whiteout">tion&nbsp;application</font>
              tion may supply a script which attempts to continue parsing.  The command evaluated is: <u>script</u>
              <u>errorcode</u> <u>errormsg</u>

              where:


                     <u>errorcode</u> A single word description of the error, intended for use by an application

                     <u>errormsg</u> A human-readable description of the error


               <u>-externalentitycommand</u>
                      <u>-externalentitycommand</u> <u>script</u>

              Specifies the prefix of a Tcl command to be evaluated to resolve an external entity reference.
              If the parser has been configured to validate the XML document, a default script  is  supplied
              that  resolves  the  URI given as the system identifier of the external entity and recursively
              parses the entity's data.  If the parser has been configured as a non-validating parser,  then
              by  default  external  entities  are  not  resolved.   This option can be used to override the
              default behaviour.  The command evaluated is: <u>script</u> <u>name</u> <u>baseuri</u> <u>uri</u> <u>id</u>

              where:


                     <u>name</u> The Tcl command name of the current parser

                     <u>baseuri</u> An absolute URI for the current entity which is to be used to resolve  relative
                     URIs

                     <u>uri</u> The system identifier of the external entity, usually a URI

                     <u>id</u> The public identifier of the external entity.  If no public identifier was given  in
                     the entity declaration then id will be an empty string.


              The return result of the callback script determines the action of the parser.  Note that these
              codes are interpreted in a different manner to other callbacks.


                     <b>TCL_OK</b>

                     The  return  result  of the callback script is used as the external entity's data.  The
                     URI passed to the callback script is used as the entity's base URI.


                     This is useful to either override the normal loading of an entity's data, or to  imple-<font color="#ffffff" class="whiteout">ment&nbsp;implement</font>
                     ment  new or alternative URI schemes.  As an example, the script below sets an external
                     entity handler that intercepts "tcl:" URIs and evaluates them as inline Tcl scripts:


                     package require xml

                     proc External {name baseuri uri id} {
                         switch -glob -- $uri {      tcl:*  {            regexp  {^tcl:(.*)$}  $uri  discard
                     script          return [uplevel #0 $script]      }      default {          return -code
                     continue {}      }
                         } }

                     set parser [xml::parser -externalentitycommand External] $parser parse {&lt;!DOCTYPE exam-
                     ple [
                       &lt;!ENTITY example SYSTEM "tcl:set%20example%20HelloWorld"&gt; ]&gt; &lt;example&gt;
                       &amp;example; &lt;/example&gt; }

                     puts $example



                     This script will print "HelloWorld" to stdout.


                     <b>TCL_CONTINUE</b>


                     In a normal (non-safe) interpreter, the default external entity handler is used to load
                     the external entity data as per normal operation of the parser.  If the parser is  exe-<font color="#ffffff" class="whiteout">cuting&nbsp;executing</font>
                     cuting in a Safe Tcl interpreter then the entity is not loaded at all.


                     This  is  useful  to  interpose on the loading of external entities without interfering
                     with the loading of entities.


                     <b>TCL_BREAK</b>


                     No data is returned for this entity, ie. the entity is ignored.   No  error  is  propa-<font color="#ffffff" class="whiteout">gated.&nbsp;propagated.</font>
                     gated.


                     <b>TCL_ERROR</b>


                     No  data is returned for this entity, ie. the entity is ignored.  A background error is
                     registered, using the result of the callback script.



               <u>-final</u>
                      <u>-final</u> <u>boolean</u>

              Specifies whether the XML document being parsed is complete.  If the document is to be  incre-<font color="#ffffff" class="whiteout">mentally&nbsp;incrementally</font>
              mentally  parsed then this option will be set to false, and when the last fragment of document
              is parsed it is set to true.  For example,


              set parser [::xml::parser -final 0] $parser parse $data1 $parser parse $data2 $parser  config-<font color="#ffffff" class="whiteout">ure&nbsp;configure</font>
              ure -final 1 $parser parse $finaldata


               <u>-ignorewhitespace</u>
                      <u>-ignorewhitespace</u> <u>boolean</u>

              If  this option is set to true then spans of character data in the XML document which are com-<font color="#ffffff" class="whiteout">posed&nbsp;composed</font>
              posed only of white-space (CR, LF, space, tab) will not be reported to  the  application.   In
              other  words,  the  data  passed to every invocation of the  <u>-characterdatacommand</u> script will
              contain at least one non-white-space character.


               <u>-notationdeclcommand</u>
                      <u>-notationdeclcommand</u> <u>script</u>

              Specifies the prefix of a Tcl command to be evaluated when a notation declaration  is  encoun-<font color="#ffffff" class="whiteout">tered.&nbsp;encountered.</font>
              tered.  The command evaluated is: <u>script</u> <u>name</u> <u>uri</u>

              where:


                     <u>name</u> The name of the notation

                     <u>uri</u> An external identifier for the notation, usually a URI.


               <u>-notstandalonecommand</u>
                      <u>-notstandalonecommand</u> <u>script</u>

              Specifies  the prefix of a Tcl command to be evaluated when the parser determines that the XML
              document being parsed is not a standalone document.


               <u>-paramentityparsing</u>
                      <u>-paramentityparsing</u> <u>boolean</u>

              Controls whether external parameter entities are parsed.


               <u>-parameterentitydeclcommand</u>
                      <u>-parameterentitydeclcommand</u> <u>script</u>

              Specifies the prefix of a Tcl command to be evaluated when a parameter entity  declaration  is
              encountered.  The command evaluated is: <u>script</u> <u>name</u> <u>args</u>

              where:


                     <u>name</u> The name of the parameter entity

                     <u>args</u>  For  an  internal  parameter  entity  there  is only one additional argument, the
                     replacement text.  For external parameter entities there are two additional  arguments,
                     the system and public identifiers respectively.


               <u>-parser</u>
                      <u>-parser</u> <u>name</u>

              The  name  of the parser class to instantiate for this parser object.  This option may only be
              specified when the parser instance is created.


               <u>-processinginstructioncommand</u>
                      <u>-processinginstructioncommand</u> <u>script</u>

              Specifies the prefix of a Tcl command to be evaluated when a processing instruction is encoun-<font color="#ffffff" class="whiteout">tered.&nbsp;encountered.</font>
              tered.  The command evaluated is: <u>script</u> <u>target</u> <u>data</u>

              where:


                     <u>target</u> The name of the processing instruction target

                     <u>data</u> Remaining data from the processing instruction


               <u>-reportempty</u>
                      <u>-reportempty</u> <u>boolean</u>

              If this option is enabled then when an element is encountered that uses the special empty ele-<font color="#ffffff" class="whiteout">ment&nbsp;element</font>
              ment syntax, additional arguments are appended to the  <u>-elementstartcommand</u> and   <u>-elementend</u>-<font color="#ffffff" class="whiteout">command&nbsp;-elementendcommand</font>
              <u>command</u> callbacks.  The arguments  <u>-empty</u> <u>1</u> <u>are</u> <u>appended.</u>  <u>For</u> <u>example:</u> <u>script</u> <u>-empty</u> <u>1</u>

               <u>-startcdatasectioncommand</u>
                      <u>-startcdatasectioncommand</u> <u>script</u>

              Specifies  the  prefix of a Tcl command to be evaluated when the start of a CDATA section sec-<font color="#ffffff" class="whiteout">tion&nbsp;section</font>
              tion is encountered.  No arguments are appended to the script.


               <u>-startdoctypedeclcommand</u>
                      <u>-startdoctypedeclcommand</u> <u>script</u>

              Specifies the prefix of a Tcl command to be evaluated at the start of a document type declara-<font color="#ffffff" class="whiteout">tion.&nbsp;declaration.</font>
              tion.  No arguments are appended to the script.


               <u>-unknownencodingcommand</u>
                      <u>-unknownencodingcommand</u> <u>script</u>

              Specifies  the prefix of a Tcl command to be evaluated when a character is encountered with an
              unknown encoding.  This option has not been implemented.


               <u>-unparsedentitydeclcommand</u>
                      <u>-unparsedentitydeclcommand</u> <u>script</u>

              Specifies the prefix of a Tcl command to be evaluated when a declaration is encountered for an
              unparsed entity.  The command evaluated is: <u>script</u> <u>system</u> <u>public</u> <u>notation</u>

              where:


                     <u>system</u> The system identifier of the external entity, usually a URI

                     <u>public</u> The public identifier of the external entity

                     <u>notation</u> The name of the notation for the external entity


               <u>-validate</u>
                      <u>-validate</u> <u>boolean</u>

              Enables  validation  of the XML document to be parsed.  Any changes to this option are ignored
              after an XML document has started to be parsed, but the option may be changed after a reset.


               <u>-warningcommand</u>
                      <u>-warningcommand</u> <u>script</u>

              Specifies the prefix of a Tcl command to be evaluated when a warning condition is detected.  A
              warning  condition  is  where  the  XML document has not been authored correctly, but is still
              well-formed and may be valid.  For example, the special empty element syntax may be  used  for
              an  element  which has not been declared to have empty content.  By default, a callback script
              is provided which silently ignores the warning.  The command evaluated is: <u>script</u>  <u>warningcode</u>
              <u>warningmsg</u>

              where:


                     <u>warningcode</u>  A  single word description of the warning, intended for use by an applica-<font color="#ffffff" class="whiteout">tion&nbsp;application</font>
                     tion

                     <u>wanringmsg</u> A human-readable description of the warning


               <u>-xmldeclcommand</u>
                      <u>-xmldeclcommand</u> <u>script</u>

              Specifies the prefix of a Tcl command to be evaluated when the XML declaration is encountered.
              The command evaluated is: <u>script</u> <u>version</u> <u>encoding</u> <u>standalone</u>

              where:


                     <u>version</u> The version number of the XML specification to which this document purports  to
                     conform

                     <u>encoding</u> The character encoding of the document

                     <u>standalone</u> A boolean declaring whether the document is standalone


   <b>Parser</b> <b>Command</b>
       The <b>::xml::parser</b> command creates a new Tcl command with the same name as the parser.   This  command
       may  be  used  to invoke various operations on the parser object.  It has the following general form:
       <u>name</u> <u>option</u> <u>arg</u>

        <u>option</u> and the  <u>arg</u> determine the exact behaviour of the command.  The following commands are possi-<font color="#ffffff" class="whiteout">ble&nbsp;possible</font>
       ble for parser objects:


               <u>cget</u>   <u>cget</u> <u>-option</u>

              Returns  the current value of the configuration option given by  <u>option</u>.   <u>Option</u> may have any
              of the values accepted by the parser object.


               <u>configure</u>
                      <u>configure</u> ? <u>-option</u> <u>value</u> ... ?

              Modify the configuration options of the parser object.   <u>Option</u> may have  any  of  the  values
              accepted by the parser object.


               <u>entityparser</u>
                      <u>entityparser</u> ? <u>option</u> <u>value</u> ... ?

              Creates  a  new  parser object.  The new object inherits the same configuration options as the
              parent parser object, but is able to parse XML data in a parsed entity.  The option   <u>-dtdsub</u>-<font color="#ffffff" class="whiteout">set&nbsp;-dtdsubset</font>
              <u>set</u>  allows markup declarations to be treated as being in the internal or external DTD subset.


               <u>free</u>   <u>free</u> <u>name</u>

              Frees all resources associated with the parser object.  The object is not  usable  after  this
              command has been invoked.


               <u>get</u>    <u>get</u> <u>name</u> <u>args</u>

              Returns information about the XML document being parsed.  Each parser class provides different
              information, see the documentation for the parser class.


               <u>parse</u>  <u>parse</u> <u>xml</u> <u>args</u>

              Parses the XML document.  The usual desired effect is for various application callbacks to  be
              evaluated.  Other functions will also be performed by the parser class, at the very least this
              includes checking the XML document for well-formedness.


               <u>reset</u>  <u>reset</u>

              Initialises the parser object in preparation for parsing a new XML document.



<b>CALLBACK</b> <b>RETURN</b> <b>CODES</b>
       Every callback script evaluated by a parser may return a return  code  other  than   <u>TCL</u><b>_</b><u>OK.</u>   <u>Return</u>
       <u>codes</u> <u>are</u> <u>interpreted</u> <u>as</u> <u>follows:</u>


              <u>break</u>  <u>Suppresses</u>  <u>invocation</u>  <u>of</u>  <u>all</u> <u>further</u> <u>callback</u> <u>scripts.</u>  <u>The</u> <u>parse</u> <u>method</u> <u>returns</u> <u>the</u>
              <u>TCL</u><b>_</b><u>OK</u> <u>return</u> <u>code.</u>

              <u>continue</u>  Suppresses invocation of further callback scripts until the current element has fin-<font color="#ffffff" class="whiteout">ished.&nbsp;finished.</font>
              ished.

              <u>error</u>  Suppresses  invocation  of all further callback scripts.  The parse method also returns
              the TCL_ERROR return code.

              <u>default</u>  Any  other  return  code  suppresses invocation of all further callback scripts.  The
              parse method returns the same return code.


<b>ERROR</b> <b>MESSAGES</b>
       If  an  error or warning condition is detected then an error message is returned.  These messages are
       structured as a Tcl list, as described below:

       {domain level code node line message int1 int2 string1 string2 string3}


              <b>domain</b>

              A code for the subsystem that detected the error.


              <b>level</b>

              Severity level of the problem.


              <b>code</b>

              A one word string describing the error.


              <b>node</b>

              If available, the token of the DOM node associated with the problem.


              <b>line</b>

              If known, the line number in the source XML document where the problem was detected.


              <b>message</b>


              A human-readable description of the problem.


              <b>int1</b>

              Additional integer data.  For the parser domain, this is usually the column number  where  the
              problem was detected.


              <b>int2</b>

              Additional integer data.


              <b>string1</b>


              Additional string data.


              <b>string2</b>


              Additional string data.


              <b>string3</b>


              Additional string data.



<b>APPLICATION</b> <b>EXAMPLES</b>
       This script outputs the character data of an XML document read from stdin.


       package require xml

       proc cdata {data args} {
           puts -nonewline $data }

       set parser [::xml::parser -characterdatacommand cdata] $parser parse [read stdin]



       This script counts the number of elements in an XML document read from stdin.


       package require xml

       proc EStart {varName name attlist args} {
           upvar #0 $varName var
           incr var }

       set  count  0 set parser [::xml::parser -elementstartcommand [list EStart count]] $parser parse [read
       stdin] puts "The XML document contains $count elements"



<b>SAFE</b> <b>XML</b>
       TclXML/Tcl and TclXML/libxml2 may be used in a Safe Tcl interpreter.  When a document is parsed in  a
       Safe  Tcl  interpreter,  any attempt by the XML document to load an external entity is handled by the
       -externalentitycommand callback.  This callback is evaluated in the context of the  safe  interpreter
       and  therefore  is  subject to the security policy in force for that interpreter.  The default entity
       loader will not be invoked, even if the callback script returns a <b>TCL_CONTINUE</b> code.


       See the description of the -externalentitycommand for further details.


<b>PARSER</b> <b>CLASSES</b>
       This section will discuss how a parser class is implemented.

   <b>Tcl</b> <b>Parser</b> <b>Class</b>
       The pure-Tcl parser class requires no compilation - it is a collection of Tcl scripts.   This  parser
       implementation  is  non-validating, ie. it can only check well-formedness in a document.  However, by
       enabling the  <u>-validate</u> option it will read the document's DTD and resolve external  entities.   This
       parser class is referred to as TclXML/tcl.


       This parser implementation aims to implement XML v1.0 and supports XML Namespaces.


       Generally  the  parser  produces  XML Infoset information items.  That is, it gives the application a
       slightly higher-level view than the raw XML syntax.  For example, it does not report CDATA  Sections.


       TclXML/tcl is not able to handle character encodings other than UTF-8.

   <b>Expat</b> <b>Parser</b> <b>Class</b>
       This section will discuss the Expat parser class.

   <b>libxml2</b> <b>Parser</b> <b>Class</b>
       The  libxml2  parser  class  provides a Tcl interface to the libxml2 XML parser library.  This parser
       class is referred to as TclXML/libxml2.


       When the package is loaded the variable <b>::xml::libxml2::libxml2version</b> is set to the  version  number
       of the libxml2 library being used.


       On  MS  Windows,  it  is necessary to load the generic XML package first, and then the TclXML/libxml2
       package.  For example,


       package require xml package require xml::libxml2


   <b>get</b> <b>Method</b>
       TclXML/libxml2 provides the following arguments to the get method:


               <u>document</u>


              Returns the parsed document object.  libxml2 builds an in-memory data  structure  of  the  XML
              document  it parses (a DOM tree).  This method returns a handle (or token) for that structure.


              TclXML/libxml2 manages the document object as a Tcl object.  See the  <u>-keep</u> for further infor-<font color="#ffffff" class="whiteout">mation.&nbsp;information.</font>
              mation.


   <b>Additional</b> <b>Options</b>
               <u>-keep</u>  <u>-keep</u> <u>normal</u> <u>|</u> <u>implicit</u>

              Controls  how  the  TclXML/libxml2 packages manages the document object.  The default value is
              <b>implicit</b>; the document is destroyed when the Tcl Object's internal  representation  is  freed.
              If  the  option  is  given the value <b>normal</b> then the document must be explicit destroyed.  The
              only way to explicitly destroy the document is by using the C API.


               <u>-retainpath</u>
                      <u>-retainpath</u> <u>xpath</u>

              The given XPath location path specifies which part of the document is to  be  kept  after  the
              parsing  operation  has completed.  By default, all document data is discard after it has been
              parsed.


               <u>-retainpathns</u>
                      <u>-retainpathns</u> <u>prefix</u> <u>ns</u> <u>...</u>

              The value of this option is a list of pairs of XML Namespace prefixes and their  corresponding
              namespace URIs.  These are used by the XPath location path given in the  <u>-retainpath</u> <u>option.</u>


   <b>Limitations</b>
       The libxml2 parser classes has the following limitations:



              *   <u>-reportempty</u> has no effect.  libxml2 does not report empty element syntax.


              *  Incremental (push) parsing, ie.   <u>-final</u><b>0</b> is not supported.


              *  TclXML/libxml2 does not provide (DTD) validation, (WXS) schema validation or Relax NG vali-<font color="#ffffff" class="whiteout">dation,&nbsp;validation,</font>
              dation, although the libxml2 library does provide those functions.  These functions  are  pro-<font color="#ffffff" class="whiteout">vided&nbsp;provided</font>
              vided  by  the  TclDOM/libxml2 package, but only in a "posteriori" fashion (ie. only after the
              document has been parsed).


              *  libxml2 supports XML Namespaces.  The use of XML Namespaces can be queried, but the  <u>decla</u>-<font color="#ffffff" class="whiteout">ration&nbsp;declaration</font>
              <u>ration</u> of a XML Namespace is not reported.


<b>SEE</b> <b>ALSO</b>
       TclDOM, a Tcl interface for the W3C Document Object Model.


<b>KEYWORDS</b>
TclXML                                               3.1                                           TclXML(n)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/mann/tclxml.n.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/mann/tclxml.n.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/mann/tclxml.n.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
