<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Data Structures for Components (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING365></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-364.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-366.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-333.html"><B>Chapter 6 - Component Manager</B></A> / <A HREF="MoreToolbox-346.html"><B>Component Manager Reference</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING365-0></A>
<H2><A NAME=MARKER-9-242></A><A NAME=MARKER-21-435></A><A NAME=MARKER-9-244></A>Data Structures for Components</H2>
 <A NAME=MARKER-2-222></A>This section describes the format and content of the data structures used by components.<P>
 Components, and applications that register components, use the component description record to identify a component. A component resource incorporates the information in a component description record and also includes other information. If you are developing a component or an application that registers components, you must be familiar with both the component description record and component resource; see <A HREF=MoreToolbox-400.html#MARKER-9-391>"Resources" beginning on page 6-77</A> for a description of the component resource.<P>
 The Component Manager passes information about a request to your component in a component parameters record.<P>
<A NAME=HEADING365-4></A>
<H3><A NAME=MARKER-9-246></A><A NAME=MARKER-21-247></A>The Component Description Record</H3>
 <A NAME=MARKER-2-92></A>The component description record identifies the characteristics of a component, including the type of services offered by the component and the manufacturer of the component.<P>
 Components use component description records to identify themselves to <BR>the Component Manager. If your component is stored in a component resource, the information in the component description record must be part of that resource (see the description of the component resource, on <A HREF=MoreToolbox-400.html#MARKER-9-396>page 6-77</A>). If you have developed an application that registers your component, that application must supply a component description record to the <CODE>RegisterComponent</CODE> function (see <A HREF=MoreToolbox-367.html#MARKER-9-276>"Registering Components" on page 6-55</A> for information about registering components).<P>
 <A NAME=MARKER-2-249></A>The <CODE>ComponentDescription</CODE> data type defines the component description record. Note that the valid values of fields in the component description record are determined by the component type specification. For example, all image compressor components must use the <CODE>componentSubType</CODE> field to specify the compression algorithm used by the compressor.<P>
<PRE>
TYPE  ComponentDescription = 
      RECORD
         componentType:       OSType;     {type}
         componentSubType:    OSType;     {subtype}
         componentManufacturer:           {manufacturer}
                              OSType;     
         componentFlags:      LongInt;    {control flags}
         componentFlagsMask:  LongInt;    {reserved}
      END;
</PRE>
<DL>
<H5>Field Description</H5>
<DT><CODE><A NAME=MARKER-2-250></A>componentType</CODE>
<DD> <A NAME=MARKER-2-251></A>A four-character code that identifies the type of component. All components of a particular type must support a common set of interface routines. For example, drawing components all have a component type of <CODE>'draw'</CODE>.
<DT>
<DD> Your component must support all of the standard routines for the component type specified by this field. Type codes with all lowercase characters are reserved for definition by Apple. <!--See <I><A HREF="../QTComponents/QTComponents-2.html">Inside Macintosh: QuickTime Components</A></I> for information about the QuickTime components supplied by Apple.--> You can define your own component type code as long as you register it with Apple's Component Registry Group.<A NAME=MARKER-2-252></A>
<DT><CODE><A NAME=MARKER-2-253></A>componentSubType</CODE>
<DD> <A NAME=MARKER-2-254></A>A four-character code that identifies the subtype of the component. Different subtypes of a component type may support additional features or provide interfaces that extend beyond the standard routines for a given component. For example, the subtype of a drawing component indicates the type of object the component draws. Drawing components that draw ovals have a subtype of <CODE>'oval'</CODE>.
<DT>
<DD> Your component may use this field to indicate more specific information about the capabilities of the component. There are no restrictions on the content you assign to this field. If no additional information is appropriate for your component type, you may set the <CODE>componentSubType</CODE> field to 0.<A NAME=MARKER-2-255></A>
<DT><CODE><A NAME=MARKER-2-85></A>componentManufacturer</CODE>
<DD> <A NAME=MARKER-2-257></A>A four-character code that identifies the manufacturer of the component. This field allows for further differentiation between individual components. For example, components made by a specific manufacturer may support an extended feature set. Components provided by Apple use a manufacturer value of <CODE>'appl'</CODE>.
<DT>
<DD> Your component uses this field to indicate the manufacturer of the component. You obtain your manufacturer code, which can be the same as your application signature, from Apple's Component Registry Group.<A NAME=MARKER-2-258></A>
<DT><CODE><A NAME=MARKER-2-86></A>componentFlags</CODE>
<DD> A 32-bit field that provides additional information about a particular component.
<DT>
<DD> The high-order 8 bits are reserved for definition by the Component Manager and provide information about the component. The following bits are currently defined:
</DL>
<PRE>
               CONST
                cmpWantsRegisterMessage = $80000000;
                cmpFastDispatch         = $40000000;
</PRE>
<DL>
<DT>
<DD> The setting of the <CODE>cmpWantsRegisterMessage</CODE> bit determines whether the Component Manager calls this component during registration. Set this bit to 1 if your component should be called when it is registered; otherwise, set this bit to 0. If you want to automatically dispatch requests to your component to the appropriate routine that handles the request (rather than your component calling <CODE>CallComponentFunction</CODE> or <CODE>CallComponentFunctionWithStorage</CODE>), set the <CODE>cmpFastDispatch</CODE> bit. If you set this bit, you must write your component's entry point in assembly language. If you set this <BR>bit, the Component Manager calls your component's entry point with the call's parameters, the handle to that instance's storage, and the caller's return address already on the stack. The Component Manager passes the request code in register D0 and passes the stack location of the instance's storage in register A0. Your component can then use the request code in register D0 to directly dispatch the request itself (for example, by using this value as an index into a table of function addresses). Be sure to note that the standard request codes have negative values. Also note that the function parameter that the caller uses to specify the component instance instead contains a handle to the instance's storage. When the component function completes, control returns to the calling application.
<DT>
<DD> For more information about component registration and initialization, see <A HREF=MoreToolbox-343.html#MARKER-9-86>"Responding to the Register Request" on page 6-22</A>.
<DT>
<DD> The low-order 24 bits are specific to each component type. You can use these flags to indicate any special capabilities or features of your component. Your component may use all 24 bits, as appropriate to its component type. You must set all unused bits to 0.
<DT><CODE><A NAME=MARKER-2-260></A>componentFlagsMask</CODE>
<DD> Reserved. (However, note that applications can use this field when performing search operations, as described on <A HREF=MoreToolbox-347.html#MARKER-9-164>page 6-37</A>.)
<DT>
<DD> Your component must set the <CODE>componentFlagsMask</CODE> field in its component description record to 0.<A NAME=MARKER-21-97></A><A NAME=MARKER-2-395></A>
</DL>
<A NAME=HEADING365-23></A>
<H3><A NAME=MARKER-9-263></A><A NAME=MARKER-21-264></A>The Component Parameters Record</H3>
 <A NAME=MARKER-2-265></A>The Component Manager uses the component parameters record to pass information to your component about a request from an application. The information in this record completely defines the request. Your component services the request as appropriate.<P>
 <A NAME=MARKER-2-95></A>The <CODE>ComponentParameters</CODE> data type defines the component parameters record.<P>
<PRE>
ComponentParameters = 
      PACKED RECORD
         flags:      Char;                   {reserved}
         paramSize:  Char;                   {size of parameters}
         what:       Integer;                {request code}
         params:     ARRAY[0..0] OF LongInt; {actual parameters}
      END;
</PRE>
<DL>
<H5>Field Description</H5>
<DT><CODE><A NAME=MARKER-2-100></A>flags</CODE>
<DD> Reserved for use by Apple.
<DT><CODE><A NAME=MARKER-2-102></A>paramSize</CODE>
<DD> Specifies the number of bytes of parameter data for this request. The actual parameters are stored in the <CODE>params</CODE> field.
<DT><CODE><A NAME=MARKER-2-269></A>what</CODE>
<DD> Specifies the type of request. Component designers define the meaning of positive values and assign them to requests that are supported by components of a given type. Negative values are reserved for definition by Apple. Apple has defined these request codes:
</DL>
<PRE>
               CONST
                  kComponentOpenSelect       = -1; {required}
                  kComponentCloseSelect      = -2; {required}
                  kComponentCanDoSelect      = -3; {required}
                  kComponentVersionSelect    = -4; {required}
                  kComponentRegisterSelect   = -5; {optional}
                  kComponentTargetSelect     = -6; {optional}
                  kComponentUnregisterSelect = -7; {optional}
</PRE>
<DL>
<DT><CODE><A NAME=MARKER-2-270></A>params</CODE>
<DD> An array that contains the parameters specified by the <BR>application that called your component. <BR>You can use the <CODE>CallComponentFunction</CODE> or <CODE>CallComponentFunctionWithStorage</CODE> routine to convert this array into a Pascal-style invocation of a subroutine in your component.
</DL>
 For information on how your component responds to requests, see <A HREF=MoreToolbox-343.html#MARKER-9-59>"Handling Requests for Service" beginning on page 6-18</A>. <A NAME=MARKER-2-71></A><A NAME=MARKER-9-107></A><A NAME=MARKER-2-273></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-364.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-366.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
