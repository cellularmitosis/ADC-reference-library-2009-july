<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Tree-Based XML Programming Guide for Cocoa: Modifying an XML Document</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Modifying an XML Document"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001259" title="Modifying an XML Document"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../DataManagement-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000445" target="_top">Data Management</a> &gt; <a href="../index.html" target="_top">Tree-Based XML Programming Guide for Cocoa</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="QueryingXML.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="TransformObjectValues.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/TP40001259-CJBDBDED" title="Modifying an XML Document"></a><hr /><H1>Modifying an XML Document</H1><a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_123"></a><p>You can modify an XML document with NSXML methods in two general ways:</p><ul class="ul"><li class="li"><p>By changing the values of node objects</p></li><li class="li"><p>By adding, removing, or replacing nodes, or by changing their locations within the tree</p></li></ul><p>This article discusses both aspects of XML modification.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001259-SW1" title="Note"></a><p><strong>Note:</strong>&nbsp;Although some of the information contained in this article applies to attribute and namespace nodes, <span class="content_text"><a href="AttributesNamespaces.html#//apple_ref/doc/uid/TP40001260-BAJFIGFC">“Handling Attributes and Namespaces”</a></span> discusses how to create and modify these types of nodes in more detail.</p></div>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="ModifyingXML.html#//apple_ref/doc/uid/TP40001259-97363-CJBJCBIJ">Changing the Values of Nodes</a>
				
			<br/>
			
        
			
			
				<a href="ModifyingXML.html#//apple_ref/doc/uid/TP40001259-97609">Adding, Removing, and Relocating Nodes</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001259-97363" title="Changing the Values of Nodes"></a><a name="//apple_ref/doc/uid/TP40001259-97363-CJBJCBIJ" title="Changing the Values of Nodes"></a><h2>Changing the Values of Nodes</h2><a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_124"></a><p>Most kinds of NSXMLNode objects<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_125"></a> have values associated with them. The NSXMLNode class lets you set a node’s value either to a string object or to some other type of object. The two major value-setting NSXMLNode methods reflect this choice:</p><ul class="simple"><li><p><code>- (void)setStringValue:<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_126"></a>(NSString *)string;</code></p></li><li><p><code>- (void)setObjectValue:<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_127"></a>(id)value;</code></p></li></ul><div class="notebox"><a name="//apple_ref/doc/uid/TP40001259-SW2" title="Note"></a><p><strong>Note:</strong>&nbsp;NSXMLNode also declares the <code>setStringValue:resolvingEntities:<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_128"></a></code> method which, if the <code>resolvingEntities:</code> parameter is <code>YES</code>, resolves character references and references to predefined and user-defined entities in the string. (References to user-defined entities require an associated DTD in which the entitiy is declared). The <code>setStringValue:</code> method of NSXMLNode invokes this primitive method with a “resolvingEntities” flag of <code>NO</code>.</p></div><p>When NSXML processes an input file or other source of XML, it automatically sets the values of nodes as string objects. (It has no other indication of the types of values other than the form it finds them in: strings.) Keeping the value of nodes as strings is acceptable for most applications. Changing the string value<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_129"></a> is simply a matter of finding a particular node and sending <code>setStringValue:</code> or <code>setStringValue:resolvingEntities:</code> to it. The value itself often comes from the user interface, as shown in <span class="content_text">Listing 1</span>.</p><a name="//apple_ref/doc/uid/TP40001259-98812-BCIDDDEA" title="Listing 1Setting the string value of a node"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP40001259-98812" title="Listing 1Setting the string value of a node"></a><strong>Listing 1&nbsp;&nbsp;</strong>Setting the string value of a node</p><div class="codesample"><table><tr><td scope="row"><pre>int index = [form indexOfSelectedItem];<span></span></pre></td></tr><tr><td scope="row"><pre>NSXMLNode *node;<span></span></pre></td></tr><tr><td scope="row"><pre>switch (index) {<span></span></pre></td></tr><tr><td scope="row"><pre>    case 0: // idField<span></span></pre></td></tr><tr><td scope="row"><pre>        [[person attributeForName:@"idnum"] setStringValue:<span></span></pre></td></tr><tr><td scope="row"><pre>            [idField stringValue]];<span></span></pre></td></tr><tr><td scope="row"><pre>        break;<span></span></pre></td></tr><tr><td scope="row"><pre>    case 1: // lastName<span></span></pre></td></tr><tr><td scope="row"><pre>        node = [[person elementsForName:@"lastName"] objectAtIndex:0];<span></span></pre></td></tr><tr><td scope="row"><pre>        if (!node) {<span></span></pre></td></tr><tr><td scope="row"><pre>            node = [NSXMLElement elementWithName:@"lastName"];<span></span></pre></td></tr><tr><td scope="row"><pre>            [person addChild:node];<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>        [node setStringValue:[lastName stringValue]];<span></span></pre></td></tr><tr><td scope="row"><pre>        break;<span></span></pre></td></tr><tr><td scope="row"><pre>// ...<span></span></pre></td></tr></table></div><p>Setting the value of a node to an object<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_130"></a> other than an NSString object can give you certain advantages. As an example, suppose your application has element nodes for such financial values as item price, quantity, tax, and total. By converting the values of these nodes from strings (<code>"45.99"</code>) to numbers (<code>45.99</code>), your application can perform calculations directly with the object values of the nodes.</p><p>You can set any arbitrary object as the object value of the node. When an NSXMLNode object is asked to emit its object value as an XML string, it produces a string representation<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_131"></a> of the value. For the standard atomic types, this value is in a canonical form<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_132"></a> for the type (as defined by the W3C XML Schema Data Types specification). To take advantage of this default behavior, the object you set should be an instance of a Foundation class that corresponds to one of the atomic types<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_133"></a> in the XQuery data model<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_134"></a>. <span class="content_text">Table 1</span> lists these classes and their corresponding types.</p><a name="//apple_ref/doc/uid/TP40001259-98903-BCIBDAFF" title="Table 1Equivalent classes and atomic types"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/TP40001259-98903" title="Table 1Equivalent classes and atomic types"></a><strong>Table 1&nbsp;&nbsp;</strong>Equivalent classes and atomic types</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Foundation class</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Atomic type</p></th></tr><tr><td  scope="row"><p>NSString </p></td><td ><p>string (use <code>setObjectValue:</code>)</p></td></tr><tr><td  scope="row"><p>NSNumber</p></td><td ><p>integer, decimal, float, double, Boolean</p></td></tr><tr><td  scope="row"><p>NSCalendarDate</p></td><td ><p>date</p></td></tr><tr><td  scope="row"><p>NSData</p></td><td ><p>base64 and hexadecimal binary</p></td></tr><tr><td  scope="row"><p>NSURL</p></td><td ><p>URI</p></td></tr><tr><td  scope="row"><p>NSArray</p></td><td ><p><code>NMTOKENS</code>, <code>IDREFS</code>, <code>ENTITIES</code></p></td></tr></table></div><p>You can also create value transformers<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_135"></a> that render string values representative of custom objects. For more on this subject, and for further information on the standard string representations, see <span class="content_text"><a href="TransformObjectValues.html#//apple_ref/doc/uid/TP40001497-BAJDFDDC">“Representing Object Values as Strings.”</a></span></p><p>You must set the object value<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_136"></a> of each node in a document yourself—NSXML does not do it for you automatically. Typically you would first set object values globally after NSXML processes a source of XML and produces a tree representation of the document. You can walk the tree or otherwise search for the nodes of the document whose values you want to set to objects. If thereafter you create new nodes, you can set their object values at that point. </p><p>The code fragment in <span class="content_text">Listing 2</span> uses the NSTableView data-source method <code>tableView:objectValueForTableColumn:row:</code> as the point in which to set the object values of attribute nodes representing dates. The string values of these attributes must conform to a pattern of “mm/dd/yy” where “mm” is the month number, “dd” is the day of the month, and “yy” is the last two digits of the year. (You can attach an NSDateFormatter object to an input field to ensure that newly entered dates conform to this pattern too.) The code fragment uses the NSCalendarDate method <code>dateWithString:calendarFormat:</code> to effect the conversion from string value to object value.</p><a name="//apple_ref/doc/uid/TP40001259-98567-BCIDFJHB" title="Listing 2Setting an object value based on a string pattern"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP40001259-98567" title="Listing 2Setting an object value based on a string pattern"></a><strong>Listing 2&nbsp;&nbsp;</strong>Setting an object value based on a string pattern</p><div class="codesample"><table><tr><td scope="row"><pre>// in tableView:objectValueForTableColumn:row:...<span></span></pre></td></tr><tr><td scope="row"><pre> if ([columnID isEqualToString:@"Hire Date"]) {<span></span></pre></td></tr><tr><td scope="row"><pre>        NSXMLNode *attrNode = [[employeeArray objectAtIndex:rowIndex]<span></span></pre></td></tr><tr><td scope="row"><pre>            attributeForName:@"hireDate"];<span></span></pre></td></tr><tr><td scope="row"><pre>        if (attrNode) {<span></span></pre></td></tr><tr><td scope="row"><pre>            if (![[attrNode objectValue] isKindOfClass:<span></span></pre></td></tr><tr><td scope="row"><pre>                [NSCalendarDate class]]) {<span></span></pre></td></tr><tr><td scope="row"><pre>                NSCalendarDate *date = [NSCalendarDate dateWithString:<span></span></pre></td></tr><tr><td scope="row"><pre>                    [attrNode stringValue] calendarFormat:@"%m/%d/%y"];<span></span></pre></td></tr><tr><td scope="row"><pre>                [attrNode setObjectValue:date];<span></span></pre></td></tr><tr><td scope="row"><pre>            }<span></span></pre></td></tr><tr><td scope="row"><pre>            return [attrNode objectValue];<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>// ...<span></span></pre></td></tr></table></div><p>Once the object values of the <code>hireDate</code> attributes have been set, the application can go about comparing dates, computing periods between dates, and anything else that can be done with the methods of the NSCalendarDate and NSDate classes. <span class="content_text">Listing 3</span> is a method that uses the NSCalendarDate object values to identify the employee that has worked the longest for a hypothetical company.</p><a name="//apple_ref/doc/uid/TP40001259-98602-BCIIAJHC" title="Listing 3Using the object value of an attribute"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP40001259-98602" title="Listing 3Using the object value of an attribute"></a><strong>Listing 3&nbsp;&nbsp;</strong>Using the object value of an attribute</p><div class="codesample"><table><tr><td scope="row"><pre>- (NSXMLElement *)earliestHire {<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    NSXMLElement *earliest;<span></span></pre></td></tr><tr><td scope="row"><pre>    int i;<span></span></pre></td></tr><tr><td scope="row"><pre>    NSError *err;<span></span></pre></td></tr><tr><td scope="row"><pre>    NSArray *nodes = [xmlDoc nodesForXPath:@".//employee" error:&amp;err];<span></span></pre></td></tr><tr><td scope="row"><pre>    if (!nodes || [nodes count] == 0)<span></span></pre></td></tr><tr><td scope="row"><pre>        return nil;<span></span></pre></td></tr><tr><td scope="row"><pre>    earliest = [nodes objectAtIndex:0];<span></span></pre></td></tr><tr><td scope="row"><pre>    for (i = 1; i &lt; [nodes count]; i++) {<span></span></pre></td></tr><tr><td scope="row"><pre>        NSXMLElement *current = [nodes objectAtIndex:i];<span></span></pre></td></tr><tr><td scope="row"><pre>        id date1 = [[earliest attributeForName:@"hireDate"] objectValue];<span></span></pre></td></tr><tr><td scope="row"><pre>        id date2 = [[current attributeForName:@"hireDate"] objectValue];<span></span></pre></td></tr><tr><td scope="row"><pre>        if ([date1 isKindOfClass:[NSDate class]] &amp;&amp;<span></span></pre></td></tr><tr><td scope="row"><pre>            [date2 isKindOfClass:[NSDate class]] ) {<span></span></pre></td></tr><tr><td scope="row"><pre>            if ([(NSDate *)date2 compare:(NSDate *)date1]<span></span></pre></td></tr><tr><td scope="row"><pre>                        == NSOrderedAscending) {<span></span></pre></td></tr><tr><td scope="row"><pre>                earliest = current;<span></span></pre></td></tr><tr><td scope="row"><pre>            }<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    return earliest;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><div class="importantbox"><a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_3" title="Important:"></a><p><strong>Important:</strong>&nbsp;Setting the string or object value of an NSXMLNode object removes all existing children, including processing instructions and comments. Setting the string or object value of an NSXMLElement object creates a text node as the sole child.</p><p></p></div><a name="//apple_ref/doc/uid/TP40001259-97609" title="Adding, Removing, and Relocating Nodes"></a><h2>Adding, Removing, and Relocating Nodes</h2><a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_137"></a><a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_138"></a><p>In addition to modifying an XML document’s content, you can modify a document’s structure using NSXML methods. Structure modification entails adding, deleting, and replacing nodes, as well as moving existing nodes to new locations in the XML tree. <span class="content_text">Table 2</span> lists the methods that enable you to perform these operations.</p><a name="//apple_ref/doc/uid/TP40001259-98342-CJBFGDGA" title="Table 2NSXML methods for manipulating nodes"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/TP40001259-98342" title="Table 2NSXML methods for manipulating nodes"></a><strong>Table 2&nbsp;&nbsp;</strong>NSXML methods for manipulating nodes</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Method</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Declared in classes</p></th></tr><tr><td  scope="row"><p><code>detach<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_139"></a></code></p></td><td ><p>NSXMLNode</p></td></tr><tr><td  scope="row"><p><code>addChild:<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_140"></a></code></p></td><td ><p>NSXMLElement, NSXMLDocument, and NSXMLDTD</p></td></tr><tr><td  scope="row"><p><code>setChildren:<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_141"></a></code></p></td><td ><p>NSXMLElement, NSXMLDocument, and NSXMLDTD</p></td></tr><tr><td  scope="row"><p><code>insertChild:atIndex:<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_142"></a></code></p></td><td ><p>NSXMLElement, NSXMLDocument, and NSXMLDTD</p></td></tr><tr><td  scope="row"><p><code>insertChildren:atIndex:<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_143"></a></code></p></td><td ><p>NSXMLElement, NSXMLDocument, and NSXMLDTD</p></td></tr><tr><td  scope="row"><p><code>removeChildAtIndex:<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_144"></a></code></p></td><td ><p>NSXMLElement, NSXMLDocument, and NSXMLDTD</p></td></tr><tr><td  scope="row"><p><code>replaceChildAtIndex:withNode:<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_145"></a></code></p></td><td ><p>NSXMLElement, NSXMLDocument, and NSXMLDTD</p></td></tr></table></div><p>The <code>detach<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_146"></a><a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_147"></a></code> method is different from the others in this list in that you invoke it on the child node itself and not the parent of the node. You can send <code>detach</code> to any NSXMLNode object (not just the ones allowed to have children) to break the connection between that node and its parent. Once a node is detached from its parent, you are free to reattach it to another parent elsewhere in the tree using one of the methods for inserting, adding, or replacing child nodes. </p><p>All the other methods in <span class="content_text">Table 2</span> are sent to the parent of the node being added, removed, or replaced. The parent must be an object that is an instance of the NSXMLElement<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_148"></a>, NSXMLDocument<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_149"></a>, or NSXMLDTD<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_150"></a> class. Some of these classes place restrictions on what kinds of children can be added, depending on the class of the parent:</p><ul class="ul"><li class="li"><p>NSXMLDocument objects can take only comment nodes, processing-instruction nodes, and a single element node (the root element) as children. </p></li><li class="li"><p>NSXMLDTD objects can take only children that are comment nodes, processing-instruction nodes, and NSXMLDTDNode objects with kinds as specified by <code>NSXMLDTDNodeKind </code><a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_151"></a> constants.</p></li></ul><p>The node-manipulation methods of these classes are identical. And they are straightforward, with their intended uses made unambiguous by their names. They may require you to do one or more things before invoking them:</p><ul class="ul"><li class="li"><p>Find the parent node<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_152"></a>, the receiver of the message. </p><p>If you already have a reference to an existing child node, you can get its parent by sending the child a <code>parent<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_153"></a></code> message.</p></li><li class="li"><p>Find the index<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_154"></a> of the child to replace, remove, or insert the new child before. </p><p>You can get the index by sending the node object an <code>index<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_155"></a></code> message. </p></li><li class="li"><p>Create the node<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_156"></a> object to be added to the parent. </p><p>The methods that add or replace children usually (but not always) require you to create the child node first. Create the required node object using the <code>initWithKind:<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_157"></a></code> method of the NSXMLNode class, one of the class factory methods of the same class, one of the initializers of the NSXMLElement class, or the <code>initWithXMLString:<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_158"></a></code> method of the NSXMLDTDNode class.</p></li></ul><p>The most common receiver of node-manipulation messages is an instance of the NSXMLElement<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_159"></a> class. The following code examples illustrate how the NSXMLElement node-manipulation methods might be used in your application. <span class="content_text">Listing 4</span> includes code that creates nested elements (the inner one containing an attribute) with the following XML string form:</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;Figure>&lt;Graphic href="../Art/cc_finalui.gif">&lt;/Graphic><span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001259-98187-CJBFEBEB" title="Listing 4Adding nested elements"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP40001259-98187" title="Listing 4Adding nested elements"></a><strong>Listing 4&nbsp;&nbsp;</strong>Adding nested elements</p><div class="codesample"><table><tr><td scope="row"><pre>// Note: relativePathToFilename is a custom method<span></span></pre></td></tr><tr><td scope="row"><pre>NSString *relativePathToArt = [[self fileName]<span></span></pre></td></tr><tr><td scope="row"><pre>    relativePathToFilename:selectedFile];<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>NSXMLElement *newFigureElement = [NSXMLElement elementWithName:@"Figure"];<span></span></pre></td></tr><tr><td scope="row"><pre>NSXMLElement *newGraphicElement = [NSXMLElement elementWithName:@"Graphic"];<span></span></pre></td></tr><tr><td scope="row"><pre>NSXMLNode *pathToHrefAttribute = [NSXMLNode attributeWithName:@"href"<span></span></pre></td></tr><tr><td scope="row"><pre>    stringValue:relativePathToArt];<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>[newGraphicElement addAttribute:pathToHrefAttribute];<span></span></pre></td></tr><tr><td scope="row"><pre>[newFigureElement addChild:newGraphicElement];<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>NSXMLElement *selectedParent = [treeView selectedItem];<span></span></pre></td></tr><tr><td scope="row"><pre>[selectedParent addChild:newFigureElement];<span></span></pre></td></tr><tr><td scope="row"><pre>// ...<span></span></pre></td></tr></table></div><p><span class="content_text">Listing 5</span> is a method that replaces a child node with a text node containing the child’s string value.</p><a name="//apple_ref/doc/uid/TP40001259-128350-CJBDFIJA" title="Listing 5Replacing an element"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP40001259-128350" title="Listing 5Replacing an element"></a><strong>Listing 5&nbsp;&nbsp;</strong>Replacing an element</p><div class="codesample"><table><tr><td scope="row"><pre>- (void)unwrapElement:(NSXMLElement *)childToUnwrap {<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    id parent = [childToUnwrap parent];<span></span></pre></td></tr><tr><td scope="row"><pre>    int indexOfChildToUnwrap = [childToUnwrap index];<span></span></pre></td></tr><tr><td scope="row"><pre>    NSXMLNode *textNode = [NSXMLNode textWithStringValue:[childToUnwrap stringValue]];<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // Unwrapping is defined as replacing the selected element<span></span></pre></td></tr><tr><td scope="row"><pre>    // with a text representation of itself.<span></span></pre></td></tr><tr><td scope="row"><pre>    [parent replaceChildAtIndex:indexOfChildToUnwrap withNode:textNode];<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>As you add and relocate nodes, you may occasionally want to validate<a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_160"></a> the document to verify that the changes conform to the governing schema. To validate a document, send the <code>validateAndReturnError: <a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_161"></a></code> message to the NSXMLDocument object. If the operation is not valid, the method returns <code>NO</code>; the reasons for invalidity are returned by indirection in the method’s NSError parameter.</p><p><a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_162"></a><a name="//apple_ref/doc/uid/TP40001259-DontLinkElementID_163"></a></p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="QueryingXML.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="TransformObjectValues.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2004, 2009 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2009-02-04<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Conceptual/NSXML_Concepts/Articles/ModifyingXML.html%3Fid%3DTP40001269-2.3&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Conceptual/NSXML_Concepts/Articles/ModifyingXML.html%3Fid%3DTP40001269-2.3&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Conceptual/NSXML_Concepts/Articles/ModifyingXML.html%3Fid%3DTP40001269-2.3&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
