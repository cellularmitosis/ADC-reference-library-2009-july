<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Summary of the Vertical Retrace Manager (IM: Pr)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING104></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Processes-103.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Processes-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Processes-171.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Processes-105.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html"><B>Inside Macintosh:</B></A> <A HREF="Processes-2.html"><B>Processes</B></A><BR><DD><A HREF="Processes-74.html"><B>Chapter 4 - Vertical Retrace Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING104-0></A>
<H1><A NAME=MARKER-9-184></A>Summary of the Vertical Retrace Manager</H1>
<A NAME=HEADING104-1></A>
<H2>Pascal Summary</H2>
<A NAME=HEADING104-2></A>
<H3>Data Type</H3>
<PRE>
TYPE VBLTask   =              {VBL queue element}
   RECORD
      qLink:      QElemPtr;   {next entry in vertical retrace queue}
      qType:      Integer;    {queue type}
      vblAddr:    ProcPtr;    {pointer to task procedure}
      vblCount:   Integer;    {interrupts until next execution}
      vblPhase:   Integer;    {task phase}
   END;
</PRE>
<A NAME=HEADING104-4></A>
<H3>Vertical Retrace Manager Routines</H3>
<A NAME=HEADING104-5></A>
<H4>Slot-Based Installation and Removal Routines</H4>
<PRE>
FUNCTION SlotVInstall(vblTaskPtr: QElemPtr; theSlot: Integer): OSErr;
FUNCTION SlotVRemove(vblTaskPtr: QElemPtr; theSlot: Integer): OSErr;
</PRE>
<A NAME=HEADING104-8></A>
<H4>System-Based Installation and Removal Routines</H4>
<PRE>
FUNCTION VInstall(vblTaskPtr: QElemPtr): OSErr;
FUNCTION VRemove(vblTaskPtr: QElemPtr): OSErr;
</PRE>
<A NAME=HEADING104-11></A>
<H4>Utility Routines</H4>
<PRE>
FUNCTION AttachVBL(theSlot: Integer): OSErr;
FUNCTION DoVBLTask(theSlot: Integer): OSErr;
FUNCTION GetVBLQHdr: QHdrPtr;
</PRE>
<A NAME=HEADING104-15></A>
<H3>Application-Defined Routine</H3>
<PRE>
PROCEDURE MyVBLTask;
</PRE>
<A NAME=HEADING104-17></A>
<H2>C Summary</H2>
<A NAME=HEADING104-18></A>
<H3>Data Types</H3>
<PRE>
typedef pascal void (*VBLProcPtr)(void);
typedef struct {              /*VBL queue element*/
      QElemPtr    qLink;      /*next entry in vertical retrace queue*/
      short       qType;      /*queue type*/
      VBLProcPtr  vblAddr;    /*pointer to task procedure*/
      short       vblCount;   /*interrupts until next execution*/
      short       vblPhase;   /*task phase*/
} VBLTask;
</PRE>
<A NAME=HEADING104-21></A>
<H3>Vertical Retrace Manager Routines</H3>
<A NAME=HEADING104-22></A>
<H4>Slot-Based Installation and Removal Routines</H4>
<PRE>
pascal OSErr SlotVInstall(QElemPtr vblTaskPtr, short theSlot);
pascal OSErr SlotVRemove(QElemPtr vblTaskPtr, short theSlot);
</PRE>
<A NAME=HEADING104-25></A>
<H4>System-Based Installation and Removal Routines</H4>
<PRE>
pascal OSErr VInstall(QElemPtr vblTaskPtr);
pascal OSErr VRemove(QElemPtr vblTaskPtr);
</PRE>
<A NAME=HEADING104-28></A>
<H4>Utility Routines</H4>
<PRE>
pascal OSErr AttachVBL(short theSlot);
pascal OSErr DoVBLTask(short theSlot);
#define GetVBLQHdr()((QHdrPtr) 0x0160)
</PRE>
<A NAME=HEADING104-32></A>
<H3>Application-Defined Routine</H3>
<PRE>
pascal void MyVBLTask(void);
</PRE>
<A NAME=HEADING104-34></A>
<H2>Assembly-Language Summary</H2>
<A NAME=HEADING104-35></A>
<H3>Constants</H3>
<PRE>
vType             EQU      1        ;VBL queue element type
inVBL             EQU      6        ;bit index for VBL active flag
</PRE>
<A NAME=HEADING104-37></A>
<H3>Data Structures</H3>
<A NAME=HEADING104-38></A>
<H4>VBL Queue Element
<TABLE BORDER="0" CELLPADDING=3><TD>0<CODE></CODE><TD>vblink<TD>long<TD>next entry in vertical retrace queue<TR>
<TD>4<CODE></CODE><TD>vblType<TD>word<TD>queue type<TR>
<TD>6<CODE></CODE><TD>vblAddr<TD>long<TD>address of task procedure<TR>
<TD>10<CODE></CODE><TD>vblCount<TD>word<TD>interrupts until next execution<TR>
<TD>12<CODE></CODE><TD>vblPhase<TD>word<TD>phase count</TABLE>
</H4>
<A NAME=HEADING104-39></A>
<H3>Global Variables
<TABLE BORDER="0" CELLPADDING=3><TD>CrsrBusy<TD>byte<TD>Set to <CODE>TRUE</CODE> if the cursor is being changed.<TR>
<TD>jDoVBLTask<TD>long<TD>Jump vector for <CODE>DoVBLTask</CODE> routine.<TR>
<TD>ScrnVBLPtr<TD>long<TD>Pointer to the primary monitor's vertical retrace queue's header.<TR>
<TD>VBLQueue<TD>10 bytes<TD>Header of the vertical retrace queue.</TABLE>
</H3>
<A NAME=HEADING104-40></A>
<H2>Result Codes<DFN>
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>qErr<TD>-1<TD>Task entry isn't in the queue<TR>
<TD>vTypErr<TD>-2<TD>Invalid <CODE>qType</CODE> value (must be <CODE>ORD(vType)</CODE>)<TR>
<TD>slotNumErr<TD>-360<TD>Invalid slot number</TABLE>
</DFN></H2>
 <A NAME=MARKER-2-137></A><P>
</BLOCKQUOTE><P>
<HR>
<center>
<A HREF="Processes-103.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Processes-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Processes-171.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Processes-105.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Processes-3.html">&copy; Apple Computer, Inc.</A><br>17 JUN 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
