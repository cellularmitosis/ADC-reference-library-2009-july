<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note PT15: HyperCard And You: Economy Edition</title><meta name="categories" content="Platforms and Tools"><meta name="week-posted" content="Oct 26, 1987 - Nov 6, 1987"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002669" title="HyperCard And You: Economy Edition"></a><a name="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxTools-date.html">Tools</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/Java/idxTools-date.html" target="_blank">Reference Library > Tools</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note PT15</div>
<div id="pageheadsub">HyperCard And You: Economy Edition</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext"><A HREF="#Section1">The 15 Billion Horsemen of the Apocalypse</A><BR><BR><A HREF="#Section2">HyperCard File Format</A><BR><BR><A HREF="#Section3">Import(ant) Tip</A><BR><BR><A HREF="#Section4">Playing Sounds</A><BR><BR><A HREF="#Section5">Visual Effects On Monitors With Multiple Bit Depths</A><BR><BR><A HREF="#Section6">High Disk Space Requirement For BackGround Printing</A><BR><BR><A HREF="#Section7">Possible Printing Problems</A><BR><BR><A HREF="#Section8">Word Wrap</A><BR><BR><A HREF="#Section9">Beware The on idle Handler</A><BR><BR><A HREF="#Section10">find Command</A><BR><BR><A HREF="#Section11">Paint Tools and HyperTalk</A><BR><BR><A HREF="#Section12">Selecting Contents Of A Field With HyperTalk</A><BR><BR><A HREF="#Section13">Dialing The Telephone</A><BR><BR><A HREF="#Section14">Launching Applications Under MultiFinder With open</A><BR><BR><A HREF="#Section15">mouseDown and mouseUp Messages in Scrolling Fields</A><BR><BR><A HREF="#Section16">Passing it As A Parameter To Handlers</A><BR><BR><A HREF="#Section17">Disappearing Resource Forks</A><BR><BR><A HREF="#Section18">Using Globals From 'XCMD' Resources</A><BR><BR><A HREF="#Section19">La Bomba (Ya No Soy Marinero)</A><BR><BR><A HREF="#References">References</A><BR><BR><A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><p id="introtext">This Technical Note describes some HyperCard anomalies with which developersshould be familiar when developing stackware, and it documents differencesbetween HyperCard versions where appropriate.  </p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Nov 01 1987]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><a name=Section1></A>         <h2>The 15 Billion Horsemen of the Apocalypse</h2><p>With the introduction of HyperCard 2.0, many of the old bugs were quashed, andabsolutely no new bugs were created.  In fact, the software was so bug-freethat it immediately attained Nirvana and Apple has had problems getting it todo anything since.  Just kidding.</p> <a name="Section2"></a><P><A HREF="#top">Back to top</A></p><h2>HyperCard File Format</h2><p>The HyperCard file format is available for licensing on a case-by-case basis.Since HyperCard has moved to Claris, developers should contact Claris for moreinformation if you feel that your product is a substantial and importantaddition to HyperCard and the Macintosh.</p><p>Since HyperCard allows developers to control data input and output to filesusing HyperTalk, most "needs" for file formats may be easily met by usingHyperTalk and writing scripts.  In particular, the following HyperTalk commandsare useful:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    open file fileName    close file fileName</pre>	</TD></TR></TABLE></CENTER><p>Versions of HyperCard after 1.0.1 come with examples of how to use thesecommands.  For those with HyperCard 2.0 release stacks, look in the Power Toolsstack for the "Export Stack Scripts" card, which provides frameworks forbuilding custom file I/O routines.</p><a name="Section3"></a> <P><A HREF="#top">Back to top</A></p><h2>Import(ant) Tip</h2><p>Scripts which create many new cards, e.g., scripts which import data, should besure to keep a counter of the number of cards created and call <code>doMenu"Compact Stack"</code> every 200 or so cards.  Scripts which lack this featuremay cause a variety of strange results, including stack corruption, which arerevealed when Compact Stack is eventually selected.</p> <P><A HREF="#top">Back to top</A></p><a name="Section4"></a><h2>Playing Sounds</h2><p>In versions prior to 2.0, HyperCard could only play format 2 <code>'snd '</code>resources.  In version 2.0 and later, HyperCard supports both format 1 andformat 2 <code>'snd '</code> resources, which are documented in <i>InsideMacintosh</i>, Volume V, The Sound Manager (earlier versions did not includethe format 2 description).</p> <P><A HREF="#top">Back to top</A></p> <a name="Section5"></a><h2>Visual Effects On Monitors With Multiple Bit Depths</h2><p>With HyperCard 2.0, visual effects work with all monitor depths up to eightbits, although these effects are faster on a one-bit depth screen.  In previousversions of HyperCard, the monitor had to be set to a one-bit depth for visualeffects to be visible.</p> <P><A HREF="#top">Back to top</A></p> <a name="Section6"></a><h2>High Disk Space Requirement For BackGround Printing</h2><p>Running HyperCard under MultiFinder with Background Printing enabled requiresextensive disk space for printing large jobs, such as printing a stack (withPrint Stack... in the File menu) of 100 cards.  For example, a ten card stackmay only be 20K in size, but the spool file might be greater than 1MB.  Thisrequirement is due to Print Monitor's spooling the job to disk.  Note that thisrequirement does not hold true for report printing, where no graphics need tobe spooled.</p> <P><A HREF="#top">Back to top</A></p> <a name="Section7"></a><h2>Possible Printing Problems</h2><h3>LaserWriter Timeout Errors</h3><p>The LaserWriter IINT and LaserWriter drivers prior to 6.0.1 had a bug whichresulted in long jobs failing to print due to a timeout error afterapproximately one hour.  Version 6.0.1 of the LaserWriter driver addressed thisproblem; however, you may still want to print large jobs in batches using aHyperTalk script.</p><h3>Printing To Non-PostScript Printers</h3><p>HyperCard 2.0 would not print to non-PostScriptprinters.  HyperCard 2.0v2 fixes this bug.</p> <P><A HREF="#top">Back to top</A></p> <a name="Section8"></a><h2>Word Wrap</h2><p>HyperCard 2.0 uses TextEdit's word break routine with some optimizations.While it fixes bugs in the old HyperCard word break routine, it does thingssomewhat differently.  Therefore, there may be significant changes in the waytext fields are wrapped, and this may adversely affect the visual design ofstacks intended for use with earlier versions of HyperCard.  One of thesechanges is that HyperCard no longer considers quotation marks to be separatefrom their attached words.</p><p>Note that stacks designed under versions of HyperCard prior to 2.0 continue touse the old word break routine until converted to 2.0 format.</p> <P><A HREF="#top">Back to top</A></p> <a name="Section9"></a><h2>Beware The on idle Handler</h2><p>An <code>on idle </code>handler in a HyperCard script executes while the user typesinto a field.  A nasty side-effect is that the insertion point may disappearwhile the user types into a field, resulting in the Macintosh beeping since itcannot interpret the characters entered, or in the characters being displayedin the Message Box if it is open.  A particularly insidious example is thefollowing handler in a background script:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    on idle      put the time into bkgnd field &quot;Time&quot;</pre>	</TD></TR></TABLE></CENTER><p>If the user types into a field with the example handler in a background script,the insertion point disappears from the field whenever the time changes, forexample from "6:42 PM" to "6:43 PM," requiring HyperCard to change the contentsof background field "Time."</p><p>A solution to work around this problem involves checking the selection withinthe <code>on idle </code>handler, and reselecting the selection after the <code>onidle </code>handler has done its dirty work.  The following handler fixes theproblem with the preceding one:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    on idle      put the selectedChunk into oldSelectedChunk      put the time into bkgnd field &quot;Time&quot;      select oldSelectedChunk</pre>	</TD></TR></TABLE></CENTER><p>Note that if the <code>on idle </code>handler changes field contents frequently,this technique produces unsightly blinking of the selection or of the insertionpoint.  However, if the <code>on idle </code>handler is well-behaved, it avoidssuch behavior and uses this technique only as insurance.</p> <P><A HREF="#top">Back to top</A></p> <a name="Section10"></a><h2>find Command</h2><p>Previous versions of HyperCard had various bugs with the <code>find</code> command.HyperCard 2.0 fixes these bugs, and <code>find</code> now works with all fields,except those for which the <code>dontSearch</code> property is set to<code>true</code>.  If <code>dontSearch</code> has been set to <code>true</code> for a cardor a background none of the fields within the card or background aresearched.</p><p>Note that when <code>dontSearch</code> is set to <code>true</code> for a background,<b>none</b> of the fields on the background or on cards which belong to thatbackground are searched.</p><h3>Optimizing find</h3><p>HyperTalk's <code>find</code> command works best when at least three characters perfind criteria are specified, and the stack has recently been compacted with theCompact Stack item in the File menu.  Please note that specifying less thanthree characters or using word break characters, such as the dash (--) or space(&nbsp;), for any of these three characters results in a slower find.</p><p>The more trigrams that are specified for the <code>find</code> (strings with atleast three characters), the faster the find; thus, the following <code>find</code>in a company phone list:</p><p>would find "Thanasis Kehagias" in "Metagreek Appraisal Department" faster thanwould:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    find &quot;Th&quot;    find &quot;Thanasis&quot;    find &quot;Thanasis K&quot;</pre>	</TD></TR></TABLE></CENTER> <P><A HREF="#top">Back to top</A></p> <a name="Section11"></a><h2>Paint Tools and HyperTalk</h2><p>HyperTalk can control all painting tools and commands except the polygon tooland the special effects tools (Rotate, Distort, Slant, and Perspective).</p> <a name="Section12"></a><P><A HREF="#top">Back to top</A></p><h2>Selecting Contents Of A Field With HyperTalk</h2><p>There are several ways of selecting text in a field with HyperTalk: bysimulating a double click, a Shift-click, or a drag.  The three button scriptspresented here show how to do this.</p><p>The first shows a method of simulating a double click.  This script performs adouble click at the <code>loc</code> of a card field (approximately the center ofthe field's rectangle) then puts the selection into another card field:</p><P align=center><img src="images/pt_15_001.gif" alt="Figure 1. Simulating A Double Click." width=416 height=43></p><P align=center><b>Figure 1</b>.  Simulating A Double Click</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>        on mouseUp -- card button &quot;Double Click&quot;          click at the loc of field &quot;myField1&quot;          click at the loc of field &quot;myField1&quot;          if the selection is empty          then put &quot;No selection&quot; into card field &quot;DoubleClickSelection&quot;          else put the selection into card field &quot;DoubleClickSelection&quot;</pre>	</TD></TR></TABLE></CENTER><p>This second script demonstrates a method of selecting text in a card field withthe shift-click and puts the selection in another card field:</p><P align=center><img src="images/pt_15_002.gif" alt="Figure 2. Simulating A Shift-Click." width=416 height=43></p><P align=center><b>Figure 2</b>. Simulating A Shift-Click</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>        on mouseUp -- card button &quot;Shift Click&quot;          get the rect of bkgnd field &quot;myField2&quot;          click at item 3 to 4 of it          click at item 1 to 2 of it with ShiftKey          if the selection is empty          then put &quot;No selection&quot; into card field &quot;ShiftClickSelection&quot;          else put the selection into card field &quot;ShiftClickSelection&quot;</pre>	</TD></TR></TABLE></CENTER><p>The third script presents a method of selecting text by dragging over it.  Thismethod, however, requires <code>with shiftKey </code>as a parameter to<code>drag</code> in order to work correctly:</p><P align=center><img src="images/pt_15_003.gif" alt="Figure 3. Simulating A Drag." width=416 height=43></p><P align=center><b>Figure 3</b>. Simulating A Drag</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>        on mouseUp -- card button &quot;Drag Shift&quot;          get the rect of bkgnd field &quot;myField3&quot;          drag from item 1 to 2 of it to item 3 to 4 of it with shiftKey          if the selection is empty          then put &quot;No selection&quot; into card field &quot;DragShiftSelection&quot;          else put the selection into card field &quot;DragShiftSelection&quot;</pre>	</TD></TR></TABLE></CENTER> <P><A HREF="#top">Back to top</A></p> <a name="Section13"></a><h2>Dialing The Telephone</h2><h3>dial Command</h3><p>System Software 6.0.7 has a bug on the Macintosh IIsi which causes HyperCard2.0 to run the tones together when executing a <code>dial</code> command.  Version2.0v2 fixes this bug; however, it contains another bug in which a comma (,) inthe <code>dial</code> command is ignored if it is preceded by more than threecharacters which produce tones.</p><p>HyperCard 2.0v2 fixes all known bugs with the dial command other than the onejust documented.  In addition, the dial command now supports the A, B, C, and Dbuttons found on military telephones.</p><h3>.TouchTone 'DRVR'</h3><p>Note that the .TouchTone <code>'DRVR'</code> was removed in HyperCard 1.1.</p> <P><A HREF="#top">Back to top</A></p> <a name="Section14"></a><h2>Launching Applications Under MultiFinder With open</h2><p>HyperCard 2.0 returns a value in <code>the result </code>if an application launchwith the <code>open</code> command fails; this message is either "out of memory" or"couldn't open that application," depending upon the reason it could not launchthe given application.</p> <P><A HREF="#top">Back to top</A></p> <a name="Section15"></a><h2>mouseDown and mouseUp Messages in Scrolling Fields</h2><p>HyperCard does not send the <code>mouseDown</code> and <code>mouseUp</code> messages toscrolling fields when it detects a mouse click in the field's scroll bar.</p> <P><A HREF="#top">Back to top</A></p> <a name="Section16"></a><h2>Passing it As A Parameter To Handlers</h2><p>Passing <code>it</code> as a parameter to a handler is no different than passingany other parameter to a handler.  This means that: it is always a localvariable to the handler in which it is used, and it is passed to a handler byvalue, not by reference.</p> <P><A HREF="#top">Back to top</A></p> <a name="Section17"></a><h2>Disappearing Resource Forks</h2><p>If an <code>'XCMD'</code> adds a resource fork to a currently open stack, HyperCarddoes not know about it.  When a stack is compacted, and HyperCard does notthink that the stack has a resource fork, then the resource fork is notpreserved after the compaction.  The solution to work around this is to <code>gohome </code>before compacting the stack.  Then, when the stack is opened again,HyperCard recognizes that the stack contains a resource fork and behavesappropriately.</p> <P><A HREF="#top">Back to top</A></p> <a name="Section18"></a><h2>Using Globals From 'XCMD' Resources</h2><p>It used to be the case that one could not create a global from an<code>'XCMD'</code>.  HyperCard 2.0 fixed this bug; however, there is an issue inthat messages an <code>'XCMD'</code> passes back to HyperTalk are executed in thescope of the handler which called the <code>'XCMD'</code>.  This situation meansthat the calling handler must declare <code>global someGlobal </code>for thefollowing to work:</p><p>Some people may notice that there is still the problem of how to make sure thehandler declares the global if you do not want the <code>'XCMD'</code> to bedependent upon its calling script.  Simply replace the example with thefollowing code:</p><p>Note the return character (\n) in the second example above--the message passedto HyperCard becomes a two-line message (yes, it is possible).  The first linemakes the handler's scope aware of the global <code>someGlobal</code>, while thesecond line does what you want with the global.  It is now safe to pass aglobal variable back to HyperTalk since the <code>'XCMD'</code> has added it to thelocal scope of the handler.</p> <P><A HREF="#top">Back to top</A></p> <a name="Section19"></a><h2>La Bomba (Ya No Soy Marinero)</h2><p>It is imperative that scripts test the global property <code>the heapspace</code>in a variety of scripting situations which reduce the amount of availableheap space.  HyperTalk needs to have about 32K of heap space available at alltimes when a script is running.  If <code>the heapspace </code>drops below thisvalue, HyperCard aborts the script with an "out of memory" error.  Furthermore,in its attempts to clean up, HyperCard may empty those global variables uponwhich it was working when the error occurred.</p><p>Unfortunately, there is no way for a script to trap for out of memory errorswhen they occur, although it is sometimes possible to enter the debugger todetermine exactly what was happening when memory ran out like so many gammaparticles from Einsteinium.  However, scripts can check <code>the heapspace</code>whenever they are about to do something which might require much memory,then either fall back to a less memory-intensive way of performing the sameoperation or simply report the error and abort safely.</p><p>For example, in scripts which import large amounts of data into a variable,test <code>the heapspace </code>frequently, and when it gets small, dump thecontents of the variable into a field.</p><p>Another good use for <code>the heapspace </code>is in testing whether or not<code>'XCMD'</code> or <code>'XFCN'</code> resources are properly disposing of memory.A test script can call the external command repeatedly, displaying <code>theheapspace </code>in the Message Box each time.  For example, the following scriptrepeatedly calls the <code>'XCMD'</code> flash, putting <code>the heapspace </code>intothe Message Box after each call, until the Shift key is pressed.  If the valuedisplayed in the Message Box decreases consistently, it should be clear thatthe <code>'XCMD'</code> is eating memory, perhaps by allocating blocks with callsto <code>_NewHandle</code> which are not disposed of with a corresponding call to<code>_DisposHandle</code>.</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    on mouseUp      repeat while the shiftKey is up -- depress the Shift Key to stop        flash 2 -- call your XCMD or XFCN        put the heapspace -- monitor this value to see if it's decreasing      end repeat</pre>	</TD></TR></TABLE></CENTER><BR><br><a name="References"></a><h2>References</h2><P>   HyperCard Script Language Guide</p><P>   Getting Started With HyperCard 2.0</p><P>   HyperCard 2.0 Release Notes</p><P>   The Age of Reason</p><P>PostScript is a registered trademark of Adobe Systems Incorporated.</p>         <a name=Downloads></A>                  <P><A HREF="#top">Back to top</A></p><h2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (88K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/pt_15.pdf">Download</A></P>               </TD>            </TR>                    </TABLE>         <BR></TD></TR></table></center><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/pt/pt_15.html%3Fid%3DDTS10002669-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/pt/pt_15.html%3Fid%3DDTS10002669-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/pt/pt_15.html%3Fid%3DDTS10002669-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>