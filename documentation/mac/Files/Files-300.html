<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>MyCompletionProc (IM: F)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING300></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Files-299.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-301.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Files-2.html"><B>Files</B></A> / <BR><DD><A HREF="Files-72.html"><B>Chapter 2 - File Manager</B></A> / <A HREF="Files-113.html"><B>File Manager Reference</B></A><BR><DL><DD><A HREF="Files-298.html"><B>Application-Defined Routines</B></A> / <A HREF="Files-299.html"><B>Completion Routines</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING300-0></A>
<H3>MyCompletionProc</H3>
 A File Manager completion routine has the following syntax:<P>
<PRE>
PROCEDURE MyCompletionProc;
</PRE>
<A NAME=HEADING300-3></A>
<H5>DESCRIPTION</H5>
 When you execute a File Manager routine asynchronously (by setting its <CODE>async</CODE> parameter to <CODE>TRUE</CODE>), you can specify a completion routine by passing the routine's address in the <CODE>ioCompletion</CODE> field of the parameter block passed to the routine. Because you requested asynchronous execution, the File Manager places an I/O request in the file I/O queue and returns control to your application--possibly even before the actual I/O operation is completed. The File Manager takes requests from the queue one at a time and processes them; meanwhile, your application is free to do other processing.<P>
 A routine executed asynchronously returns control to your application with the result code <CODE>noErr</CODE> as soon as the call is placed in the file I/O queue. This result code does not indicate that the call has successfully completed, but simply indicates that the call was successfully placed in the queue. To determine when the call is actually completed, you can inspect the <CODE>ioResult</CODE> field of the parameter block. This field is set to a positive number when the call is made and set to the actual result code when the call is completed. If you specify a completion routine, it is executed after the result code is placed in <CODE>ioResult</CODE>.<P>
<A NAME=HEADING300-6></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 When your completion routine is called, register A0 contains a pointer to the parameter block of the asynchronous call, and register D0 contains the result code. The value in register D0 is always identical to the value in the <CODE>ioResult</CODE> field of the parameter block.<P>
 A completion routine must preserve all registers other than A0, A1, and D0-D2.<P>
<A NAME=HEADING300-9></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 Because a completion routine is executed at interrupt time, it should not allocate, move, or purge memory (either directly or indirectly) and should not depend on the validity of handles to unlocked blocks.<P>
 If your completion routine uses application global variables, it must also ensure that register A5 contains the address of the boundary between your application global variables and your application parameters. For details, see the discussion of the functions <CODE>SetCurrentA5</CODE> and <CODE>SetA5</CODE> in the chapter "Memory Management Utilities" <BR>in <I><A HREF="../Memory/Memory-2.html">Inside Macintosh: Memory</A></I>.<A NAME=MARKER-2-1485></A><P>
<A NAME=HEADING300-12></A>
<H5>SEE ALSO</H5>
 For a more complete discussion of interrupt-level processing and its limitations, see the chapter "Introduction to Processes and Tasks" in <I><A HREF="../Processes/Processes-2.html">Inside Macintosh: Processes</A></I>.<A NAME=MARKER-2-1486></A><A NAME=MARKER-2-1487></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Files-299.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-301.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Files-3.html">&copy; Apple Computer, Inc.</A><br>2 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
