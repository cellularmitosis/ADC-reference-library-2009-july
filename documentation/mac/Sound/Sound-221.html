<!-- legacy work start -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<!-- legacy work end -->


<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)

LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>SpeakBuffer (IM: S)  (deprecated)</Title>

<!-- legacy work start -->
        <META NAME="Generator" CONTENT="manual">
        <META http-equiv="content-type" CONTENT="text/html;charset=utf-8">
        <META NAME = "Copyright" CONTENT="Copyright 2007 Apple Inc. All Rights Reserved.">
        <META NAME="IndexTitle" CONTENT="Inside Macintosh: Sound (Not Recommended)">
        <meta name="xcode-display" content="render">

        <LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css"> <!-- before submitting, globally replace ".." with "developer.apple.com" -->
        <script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
<!-- legacy work end -->

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<A NAME=HEADING221></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Sound-220.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Sound-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Sound-336.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Sound-222.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Sound-2.html"><B>Sound</B></A> / <BR><DD><A HREF="Sound-187.html"><B>Chapter 4 - Speech Manager</B></A> / <A HREF="Sound-203.html"><B>Speech Manager Reference</B></A><BR><DL><DD><A HREF="Sound-217.html"><B>Speech Manager Routines</B></A> / <A HREF="Sound-218.html"><B>Starting, Stopping, and Pausing Speech</B></A></DL></DL></FONT><P>
<HR>

<!-- legacy work start -->
<script type="text/javascript"> placeWatermark()</script>
<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
<i>Inside Macintosh: Sound</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="http://developer.apple.com/referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div>
<!-- legacy work end -->


<BLOCKQUOTE>
<A NAME=HEADING221-0></A>
<H3><A NAME=MARKER-9-444></A>SpeakBuffer<A NAME=MARKER-2-445></A></H3>
 You can use the SpeakBuffer function to have the Speech Manager speak a buffer of text, using certain flags to control speech behavior.<P>
<PRE>
FUNCTION SpeakBuffer (chan: SpeechChannel; textBuf: Ptr; 
                        textBytes: LongInt; 
                        controlFlags: LongInt): OSErr;
</PRE>
<DL>
<DT><CODE>chan</CODE>
<DD> The speech channel through which speech is to be spoken.
<DT><CODE>textBuf</CODE>
<DD> A pointer to the first byte of text to spoken.
<DT><CODE>textBytes</CODE>
<DD> The number of bytes of text to spoken.
<DT><CODE>controlFlags</CODE>
<DD> Control flags to customize speech behavior.
</DL>
<A NAME=HEADING221-7></A>
<H5>DESCRIPTION</H5>
 The <CODE>SpeakBuffer</CODE> function behaves identically to the <CODE>SpeakText</CODE> function, but allows control of several speech parameters by setting values of the <CODE>controlFlags</CODE> parameter. The <CODE>controlFlags</CODE> parameter relies on the following constants, which may be applied additively:<P>
<PRE>
CONST
   kNoEndingProsody        = 1;  {disable prosody at end of sentences}
   kNoSpeechInterrupt      = 2;  {do not interrupt current speech}
   kPreflightThenPause     = 4;  {compute speech without generating}
</PRE>
 Each constant specifies a flag bit of the <CODE>controlFlags</CODE> parameter, so by passing the constants additively you can enable multiple capabilities of <CODE>SpeakBuffer</CODE>. If you pass 0 in the <CODE>controlFlags</CODE> parameter, <CODE>SpeakBuffer</CODE> works just like <CODE>SpeakText</CODE>. By passing <CODE>kNoEndingProsody + kNoSpeechInterrupt</CODE> in the <CODE>controlFlags</CODE> parameter, <CODE>SpeakBuffer</CODE> works like <CODE>SpeakText</CODE> except that the <CODE>kNoEndingProsody</CODE> and <CODE>kNoSpeechInterrupt</CODE> features have been selected. Future versions of the Speech Manager may define additional constants. <A NAME=MARKER-2-446></A><P>
 The <CODE>kNoEndingProsody</CODE> flag bit is used to control whether or not the speech synthesizer automatically applies ending prosody, the speech tone and cadence that normally occur at the end of a statement. Under normal circumstances (for example, when the flag bit is not set), ending prosody is applied to the speech when the end of the <CODE>textBuf</CODE> data is reached. This default behavior can be disabled by setting the <CODE>kNoEndingProsody</CODE> flag bit.<A NAME=MARKER-9-25></A><A NAME=MARKER-2-448></A><P>
 Some synthesizers do not speak until the <CODE>kNoEndingProsody</CODE> flag bit is reset, or they encounter a period in the text, or <CODE>textBuf</CODE> is full.<A NAME=MARKER-2-34></A><P>
 The <CODE>kNoSpeechInterrupt</CODE> flag bit is used to control the behavior of <CODE>SpeakBuffer</CODE> when called on a speech channel that is still busy. When the flag bit is not set, <CODE>SpeakBuffer</CODE> behaves similarly to <CODE>SpeakString</CODE> and <CODE>SpeakText</CODE>. Any speech currently being produced on the specified speech channel is immediately interrupted, and then the new text buffer is spoken. When the <CODE>kNoSpeechInterrupt</CODE> flag bit is set, however, a request to speak on a channel that is still busy processing a prior text buffer will result in an error. The new buffer is ignored and the error <CODE>synthNotReady</CODE> is returned. If the prior text buffer has been fully processed, the new buffer is spoken normally. One way of achieving continuous speech without using callback procedures is to continually call <CODE>SpeakBuffer</CODE> with the <CODE>kNoSpeechInterrupt</CODE> flag bit set until the function returns <CODE>noErr</CODE>. The function will then execute as soon as the first text buffer has been processed.<A NAME=MARKER-2-450></A><A NAME=MARKER-2-451></A><A NAME=MARKER-2-452></A><P>
 The <CODE>kPreflightThenPause</CODE> flag bit is used to minimize the latency experienced when the speech synthesizer is attempting to speak. Ordinarily, whenever a call to <CODE>SpeakString</CODE>, <CODE>SpeakText</CODE>, or <CODE>SpeakBuffer</CODE> is made, the speech synthesizer must perform a certain amount of initial processing before speech output is heard. This startup latency can vary from a few milliseconds to several seconds depending upon which speech synthesizer is being used. Recognizing that larger startup delays might be detrimental to certain applications, a mechanism exists to allow the synthesizer to perform any necessary computations at noncritical times. Once the computations have been completed, the speech is able to start instantly. When the <CODE>kPreflightThenPause</CODE> flag bit is set, the speech synthesizer will process the input text as necessary to the point where it is ready to begin producing speech output. At this point, the synthesizer will enter a paused state and return to the caller. When the application is ready to produce speech, it should call the <CODE>ContinueSpeech</CODE> function to begin speaking.<A NAME=MARKER-2-453></A><A NAME=MARKER-2-454></A><A NAME=MARKER-2-455></A><A NAME=MARKER-2-456></A><A NAME=MARKER-2-457></A><P>
 When the <CODE>controlFlags</CODE> parameter is set to 0, <CODE>SpeakBuffer</CODE> behaves identically to <CODE>SpeakText</CODE>.<P>
<A NAME=HEADING221-16></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 Because the <CODE>SpeakBuffer</CODE> function might move memory, you should not call it at interrupt time.<P>
<A NAME=HEADING221-18></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The trap macro and routine selector for the <CODE>SpeakBuffer</CODE> function are
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Trap macro<TH>Selector<TR>
<TD><CODE>_SoundDispatch</CODE><TD>$0828000C</TABLE>
<P>
<A NAME=HEADING221-20></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>synthNotReady<TD>-242<TD>Speech channel is still busy speaking<TR>
<TD>invalidComponentID<TD>-3000<TD>Speech channel is uninitialized or bad<A NAME=MARKER-2-6></A></TABLE>
</H5>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Sound-220.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Sound-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Sound-336.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Sound-222.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Sound-3.html">&copy; Apple Computer, Inc.</A><br>2 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
