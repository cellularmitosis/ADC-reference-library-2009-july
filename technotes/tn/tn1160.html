<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!-- Template 01-05-01 --><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note TN1160: What's New With ColorSync 2.6</title><meta name="keywords" content="Mac OS 8 ColorSync 2.6 Manager Windows API NCMMConcatInit  NCMUnflattenProfile"><meta name="Description" content="Technical Note TN1160: This Technical Note describes in detailthe changes in ColorSync 2.6. Topics include: System Requirements,how to check for ColorSync on both Macintosh and Windowssystems, the Version information, the ColorSync 2.6 APIs,the ColorSync 2.6 for Windows APIs, and Compatibility issues."><meta name="categories" content="Color"><meta name="week-posted" content="Mar 29, 1999 - Apr 2, 1999"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002999" title="What's New With ColorSync 2.6"></a><A NAME="top"></A><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/GraphicsImaging/index.html">Graphics & Imaging</a> &gt; <a href="../../technicalnotes/GraphicsImaging/idxColorSync-date.html">ColorSync</a> &gt; </p><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TN1160</div>
<div id="pageheadsub">What's New With ColorSync 2.6</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left">   <!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">     <tr><td width=300 valign="top" align=left scope="row">    <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>            <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>  </tr>  <tr bgcolor="#e6e6e6">   <td background="images/tnmenubody.gif" width=300 align=left> <span id="menutitle">CONTENTS   <br>  <br> </span>   </td>  </tr>  <tr bgcolor="#e6e6e6">   <td background="images/tnmenubody.gif" width=300 align=left> <!-- begin_toc --><P id = "menutext"><A HREF="#Requirements">System Requirements</A><BR><BR><A HREF="#Checking">Checking for ColorSync 2.6</A><BR><BR><A HREF="#Gettinginfo">ColorSync 2.6 Version Information</A><BR><BR><A HREF="#NewAPIs">New ColorSync 2.6 APIs</A><BR><BR><A HREF="#Compatibility">ColorSync 2.6 Compatibility Issues</A><BR><BR><A HREF="#References">References</A><BR><BR><A HREF="#Changes">Change History</A><BR><BR><A HREF="#Downloads">Downloadables</A></p>       <!-- end_toc --></td>  </tr>  <tr>   <td width=300 align=left scope="row"> <img src="images/tnmenubottom.gif" alt="" width=300 height=16>   </td>  </tr>    </table></td>  <td width=300 valign="top" align=left>            <!-- begin_intro_text --><P id = "introtext">ColorSync 2.6 is         the latest version of Apple Computer's color management         architecture for Mac OS. This Technote describes in detail         the changes in this new version of ColorSync. This note is         primarily intended for developers who are using the         ColorSync APIs.</p>      <!-- end_intro_text --><!-- begin_date --><h3>&nbsp;Updated: [April 26 1999]</h3><!-- end_date --></TD> </TR>    </TABLE> <!-- end_header_box --><BR><BR><hr width=500 align=center><BR><BR>      <!-- begin_content -->             <P><A NAME="Requirements"></A></P>                  <H2>System Requirements</H2>                  <BR><P>ColorSync 2.6 for Macintosh requires a PowerPC machine         running Mac OS 8.1 or later.</p>      <P><A HREF="#top">Back to top</A></P>         <P><A NAME="Checking"></A></P>                  <H2>Checking for ColorSync 2.6</H2>                  <P><B>Macintosh</B></p>                  <p>                  To determine if the ColorSync Manager shared libraries have         been loaded on a PowerPC machine, use the         <CODE>Gestalt</CODE> function with the         <CODE>gestaltColorMatchingAttr</CODE> selector. Test the bit         field (bit 1) indicated by the         <CODE>gestaltColorMatchingLibLoaded</CODE> constant in the         response parameter. If the bit is set, the ColorSync Manager         shared libraries are loaded. The following code snippet         shows how this is done. This code snippet initializes the         <CODE>ColorSyncAvailable</CODE> Boolean variable to         <CODE>false</CODE>.</p>      <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>Boolean CheckIfColorSyncAvailableOnPPC (void){     Boolean ColorSyncAvailable = false;     long gestaltResponse;&nbsp;         if (Gestalt(gestaltColorMatchingAttr, &amp;gestaltResponse) == noErr)         {              ColorSyncAvailable =                   gestaltResponse &amp; (1 &lt;&lt; gestaltColorMatchingLibLoaded);         }         return ColorSyncAvailable;}&nbsp;</pre></TD></TR></TABLE></CENTER><BR><BR>               <P>Alternately, you can use the new ColorSync 2.6 function         <CODE>CMGetColorSyncVersion</CODE> (see the section         "<A HREF="#NewAPIs">New ColorSync 2.6 APIs</A>" below for         the details) to check for the presence of ColorSync.</P>                  <P>The <CODE>CMGetColorSyncVersion</CODE> function also         returns the ColorSync version information. Here's a code         snippet that checks for ColorSync version 2.:</p>     <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>#define  kColorSync26  0x00000260&nbsp;CMError err;UInt32 version;&nbsp;err = CMGetColorSyncVersion(&amp;version);if (err == noErr){    if (version &gt;= kColorSync26)    {       /* ColorSync 2.6 or better is installed */    }}else{    /* ColorSync not present */}</pre></TD></TR></TABLE></CENTER><BR><BR>    <P><A HREF="#top">Back to top</A></P>         <P><A NAME="Gettinginfo"></A></P>                  <H2>Getting ColorSync 2.6 Version Information</H2>                  <p>As described in the section "<A HREF="#Checking">Checking         for ColorSync 2.6</A>", use the new ColorSync 2.6 function         <CODE>CMGetColorSyncVersion</CODE> to get ColorSync version         information.</p><BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left>         <P><B>Important Note:</B></p>                 <P> On Macintosh systems with ColorSync 2.6 installed, the         <CODE>CMGetColorSyncVersion</CODE> function returns the         value <CODE>0x00026000</CODE> in the version field. However,         to remain consistent with <CODE>Gestalt</CODE> return values         this function should return the value         <CODE>0x00000260</CODE>. Future versions of ColorSync 2.6 on         the Macintosh will correct this problem and return values         which are consistent with <CODE>Gestalt</CODE>.</p>                  <p>                  Alternately, you can use the <CODE>Gestalt</CODE> function         with the <CODE>gestaltColorMatchingVersion</CODE> selector         to get ColorSync version information.</p>                  <p>                  You can modify and use the following sample code to test for         version 2.6 of the ColorSync Manager. This function         initializes the Boolean variable         <CODE>ColorSyncAvailable</CODE> to <CODE>false</CODE> and         sets it to <CODE>true</CODE> if version 2.6 or later of the         ColorSync Manager is installed.</p>     </TD></TR></TABLE></CENTER><BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>#define  kColorSync26  0x00000260&nbsp;Boolean CheckForColorSyncVersion26(void){    Boolean ColorSyncAvailable = false;    long version;&nbsp;        if (Gestalt(gestaltColorMatchingVersion, &amp;version) == noErr)        {            if (version &gt;= kColorSync26)            {                ColorSyncAvailable = true;            }        }&nbsp;    return ColorSyncAvailable;}</pre></TD></TR></TABLE></CENTER><BR><BR>     <P><A HREF="#top">Back to top</A></P>         <P><A NAME="NewAPIs"></A></P>                  <H2>New ColorSync 2.6 APIs</H2>                  <P>The following new APIs were added to ColorSync 2.6:</P>         <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>CMError CMGetProfileDescriptions (CMProfileRef          prof,                                  char                 *aName,                                  UInt32               *aCount,                                  Str255                mName,                                  ScriptCode           *mCode,                                  UniChar              *uName,                                  UniCharCount         *uCount);&nbsp;</pre></TD></TR></TABLE></CENTER><BR><BR>                               <P><B>Field Descriptions</B></p>                  <TABLE BORDER=1 WIDTH=500>            <TR>               <td valign=top align=left>                  <P>prof</p></td><td valign=top align=left>                  <P>A reference to the profile from which to obtain                  the desc tag info.</p></td></TR>            <TR>               <td valign=top align=left>                  <P>aName</p></td><td valign=top align=left>                  <P>A pointer to a field which is to receive the                  profile name as a 7-bit Roman ASCII string.</p></td></TR>            <TR>               <td valign=top align=left>                  <P>aCount</p></td><td valign=top align=left>                  <P>A pointer to a field which is to receive a count                  of the number of characters returned in the aName                  field above.</p></td></TR>            <TR>               <td valign=top align=left>                  <P>mName</p></td><td valign=top align=left>                  <P>A pointer to a field which is to receive the                  localized profile name string in Mac script-code                  format.</p></td></TR>            <TR>               <td valign=top align=left>                  <P>mCode</p></td><td valign=top align=left>                  <P>A pointer to a field which is to receive the                  script code corresponding to the name string                  returned in the mName parameter above.</p></td></TR>            <TR>               <td valign=top align=left>                  <P>uName</p></td><td valign=top align=left>                  <P>A pointer to a field which is to receive the                  Unicode localized profile name string.</p></td></TR>            <TR>               <td valign=top align=left>                  <P>uCount</p></td><td valign=top align=left>                  <P>A pointer to a field which is to receive a count                  of the number of Unicode (2-byte) characters                  returned in the uName field above.</p></td></TR>         </TABLE>         <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>CMError CMSetProfileDescriptions (CMProfileRef           prof,                                  const char            *aName,                                  UInt32                 aCount,                                  ConstStr255Param       mName,                                  ScriptCode             mCode,                                  const UniChar         *uName,                                  UniCharCount           uCount);&nbsp;</pre></TD></TR></TABLE></CENTER><BR><BR>                  <P><B>Field Descriptions</B></p>                  <BR>                  <TABLE BORDER=1 WIDTH=500>            <TR>               <td valign=top align=left>                  <P>prof</p></td><td valign=top align=left>                  <P>A reference to the profile into which to set the                  desc tag info.</p></td></TR>            <TR>               <td valign=top align=left>                  <P>aName</p></td><td valign=top align=left>                  <P>A pointer to a field containing a 7-bit Roman                  ASCII profile name string which is to be set for                  the profile. This string must be null-terminated.</p></td></TR>            <TR>               <td valign=top align=left>                  <P>aCount</p></td><td valign=top align=left>                  <P>A count of the number of characters in the aName                  field above.</p></td></TR>            <TR>               <td valign=top align=left>                  <P>mName</p></td><td valign=top align=left>                  <P>A pointer to a field containing the localized                  profile name string in Mac script-code format which                  is to be set for the profile. This string must be                  null-terminated.</p></td></TR>            <TR>               <td valign=top align=left>                  <P>mCode</p></td><td valign=top align=left>                  <P>The script code corresponding to the name string                  in the mName parameter above.</p></td></TR>            <TR>               <td valign=top align=left>                  <P>uName</p></td><td valign=top align=left>                  <P>A pointer to a field containing the Unicode                  localized profile name string which is to be set                  for the profile. This string must be                  null-terminated.</p></td></TR>            <TR>               <td valign=top align=left>                  <P>uCount</p></td><td valign=top align=left>                  <P>A count of the number of Unicode characters in                  the uName field above (do not confuse this with a                  byte count, because each Unicode character requires                  two bytes).</p></td></TR>         </TABLE><BR>                  <P><B>DESCRIPTION</B></p>                                    <P>Use these functions to get/set the description tag data         for a given profile. The ICC Profile Format Specification         (available at         &lt;<A HREF="http://www.color.org">http://www.color.org</A>&gt;)         includes a Description tag (<CODE>'desc'</CODE>), designed         to provide more information about a profile than can be         contained in a file name. This is especially critical on         file systems with 8.3 names. The tag data can consist of up         to three separate pieces (strings) of information for a         profile. These different strings are designed to allow for         display in different languages or on different computer         systems. Applications typically use one of the strings to         show profiles in a list or a pop-up menu. ColorSync 2.6         includes these new APIs for accessing this information, and         also checks for the validity of the <CODE>'desc'</CODE> tag         according to the ICC Spec.</p>            <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>CMError NCWConcatColorWorld (CMWorldRef             *cw,                             NCMConcatProfileSet    *profileSet,                             CMConcatCallBackUPP     proc,                             void                   *refCon);&nbsp;</pre></TD></TR></TABLE></CENTER><BR><BR>      <p><B>Field Descriptions</B></p><TABLE BORDER=1 WIDTH=500>   <TR>      <td valign=top align=left>         <P>cw</p>      </TD><td valign=top align=left>         <P>A reference to a color world that the ColorSync Manager         returns if the function completes successfully. You pass         this reference to other functions that use the color world         for color-matching and color-checking sessions.</p>      </TD></TR>   <TR>      <td valign=top align=left>         <P>profileSet</p>      </TD><td valign=top align=left>         <P>An array of profiles describing the processing to be         carried out. The array is in processing order source through         destination.</p>      </TD></TR>   <TR>      <td valign=top align=left>         <P>proc</p>      </TD><td valign=top align=left>         <P>A calling-program-supplied callback function that allows         your application to monitor progress or abort the operation.      </p>      </TD></TR>   <TR>      <td valign=top align=left>         <P>refCon</p>      </TD><td valign=top align=left>         <P>A reference constant containing data specified by the         calling application program.</p>      </TD></TR></TABLE><BR><p><B>New structures for use with this function:</B></p>         <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>struct NCMConcatProfileSet {   OSType          cmm;              /* e.g., 'KCMS'. Uniquely IDs the CMM, or 0000 */   unsigned long   flags;            /* specify quality */   unsigned long   flagsMask;        /* which bits of flags to use to override profile.*/   unsigned long   profileCount;     /* how many ProfileSpecs in the following set */   NCWConcatProfileSpec   profileSpecs[]; /* A new structure, defined below */};&nbsp;struct NCWConcatProfileSpec {   unsigned long   renderingIntent;  /* intent to use along with transformTag. */   unsigned long   transformTag;     /* one of a set of tag identifiers, defined below*/   CMProfileRef    profile;          /* the profile to extract the transform from */};&nbsp;enum {  kNoTransform    = 0,               /* Not used */  kUseAtoB        = 1,               /* Use 'A2B*' tag from this profile or equivalent */  kUseBtoA        = 2,               /* Use 'B2A*' tag from this profile or equivalent */  kUseBtoB        = 3,               /* Use 'pre*' tag from this profile or equivalent */      /* For typical device profiles the following synonyms may be useful */&nbsp;  kDeviceToPCS    = kUseAtoB,        /* Device Dependent to Device Independent */  kPCSToDevice    = kUseBtoA,        /* Device Independent to Device Dependent */  kPCSToPCS       = kUseBtoB,        /* Independent, through device's gamut */&nbsp;/* This is provided for default behavior when specifying rendering intent in the/* NCMConcatProfileSpec*/&nbsp;  kUseProfileIntent       = (long)0xFFFFFFFF                                     /* For renderingIntent in NCMConcatProfileSpec*/};&nbsp;/*  Caller-supplied progress function for NCMMConcatInit &amp; NCMMNewLinkProfile routines&nbsp;*/&nbsp;typedef STACK_UPP_TYPE(CMConcatCallBackProcPtr)  CMConcatCallBackUPP;typedef CALLBACK_API( Boolean, CMConcatCallBackProcPtr )                    (long progress, void *refCon);&nbsp;/*  Callback Proc Creation example:*/&nbsp;CMConcatCallBackUPP myCallBackUpp = NewCMConcatCallBackProc(myCallBackProc);&nbsp;</pre></TD></TR></TABLE></CENTER><BR><BR>     <P><B>DESCRIPTION</B></p>         <P>The <CODE>NCWConcatColorWorld</CODE> function defines a         color world for color transformations among a series of         concatenated profiles. The caller can override the CMM that         would normally be selected by ColorSync by providing a CMM         identifier in the <CODE>NCMConcatProfileSet</CODE>         structure, or pass 0 to accept ColorSync's CMM selection         (note that this could either be the user's preferred CMM         selection or the CMM called for in the profile). The         <CODE>flags</CODE> and <CODE>flagsMask</CODE> parameters are         provided to allow easy customization of such attributes as         quality and gamut-checking, while preserving the other         settings. Each profile in the set can be customized by         overriding the intent, and the selection of the transform         tag. Together with other profiles, a custom-rendering         environment can be set up to transform to or from         device-dependent spaces with a minimum of gamut compression         and/or unnecessary transformations to and from connection         spaces. This flexibility comes at the price of specific         knowledge of the profile contents and how device gamuts         overlap.</P>                  <P>Note that for standard input and output device profiles,         <CODE>A2B</CODE> and <CODE>B2A</CODE> tags represent         transforms from data space to connection space and from         connection space to data space, respectively. Under these         circumstances, the caller would not normally be able to use         the same transform tags (e.g., <CODE>kUseAtoB</CODE>)         consecutively, since a connection space would not be the         same as the subsequent data space. If the spaces aren't the         same, the caller will get a         <CODE>cmCantConcatenateError</CODE> error (-178) returned.         For profiles of type <CODE>cmLinkClass, cmAbstractClass,         cmColorSpaceClass</CODE>, and         <CODE>cmNamedColorClass</CODE>, these constants are not         always meaningful, and the caller is encouraged to think in         terms of the actual tags present in the profiles (e.g.,         <CODE>A2B0</CODE> or <CODE>B2A0</CODE>). Under these         conditions, it may well be appropriate to specify two         transform tags of the same type consecutively, as long as         the actual color spaces align in between tags. If this is         not the case, a <CODE>cmCantConcatenateError</CODE> error         (-178) is returned.</P>                  <P>The <CODE>Callback</CODE> proc is provided as protection         against the appearance of a stalled machine during lengthy         color world processing. If a CMM takes more than several         seconds to process the information and create a color world,         it will call the <CODE>Callback</CODE> proc, if one is         provided, and pass it the <CODE>refCon</CODE> provided. This         is also true for <CODE>NCWNewLinkProfile</CODE>, described         below:</p>                   <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>CMError NCWNewLinkProfile (CMProfileRef              *prof,                           const CMProfileLocation   *targetLocation,                           NCMConcatProfileSet       *profileSet,                           CMConcatCallBackUPP        proc,                           void                      *refCon);</pre></TD></TR></TABLE></CENTER><BR><BR>      <P><B>Field Descriptions</B></p><TABLE BORDER=1 WIDTH=500>   <TR>      <td valign=top align=left>         <P>prof</p>      </TD><td valign=top align=left>         <P>The returned profile reference.</p>      </TD></TR>   <TR>      <td valign=top align=left>         <P>targetLocation</p>      </TD><td valign=top align=left>         <P>The location of the profile, which you specify using the         <CODE>CMProfileLocation</CODE> data type. Commonly a profile         is disk-file based. However, the profile may be a file-based         profile, a handle-based profile, or a pointer-based profile.      </p>      </TD></TR>   <TR>      <td valign=top align=left>         <P>profileSet</p>      </TD><td valign=top align=left>         <P>The profile set structure.</p>      </TD></TR>   <TR>      <td valign=top align=left>         <P>proc</p>      </TD><td valign=top align=left>         <P>A calling-program-supplied callback function that allows         your application to monitor progress or abort the operation.      </p>      </TD></TR>   <TR>      <td valign=top align=left>         <P>refCon</p>      </TD><td valign=top align=left>         <P>A reference constant containing data specified by the         calling application program.</p>      </TD></TR></TABLE><BR>         <P><B>DESCRIPTION</B></p>                  <P>The same new flexibility in creating color worlds is         extended to link profiles, which are now not assumed to go         from input device color space to output device color space.         The returned profile is open, and should be closed when you         are finished with it.</P>                         <TABLE BORDER=1 WIDTH=500>            <TR>               <td valign=top align=left>                  <P>CMError</p></td><td valign=top align=left>                  <P><CODE>NCMSetSystemProfile</CODE> <CODE>(const                  CMProfileLocation *profLoc);</CODE></p>               </TD></TR>         </TABLE><BR>                  <P><B>Field Descriptions</B></p>                  <BR>                  <TABLE BORDER=1 WIDTH=500>            <TR>               <td valign=top align=left>                  <P>profLoc</p>               </TD><td valign=top align=left>                  <P>The location of the profile, which you specify                  using the <CODE>CMProfileLocation</CODE> data type.                  Commonly a profile is disk-file based. However, the                  profile may be a file-based profile, a handle-based                  profile, or a pointer-based profile.</p>               </TD></TR>         </TABLE><BR>                  <B>DESCRIPTION</B><P>Prior to ColorSync 2.6, the API for setting the System         Profile supported only the <CODE>FSSpec</CODE> file         specification type as a way of specifying a profile. This         new API allows for greater flexibility when specifying a         system profile.</P>               <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>CMError NCMUnflattenProfile (CMProfileLocation *targetLocation,                             CMFlattenUPP       proc,                             void              *refCon,                             Boolean           *preferredCMMnotfound);&nbsp;</pre></TD></TR></TABLE></CENTER><BR><BR>                                 <P><B>Field Descriptions</B></p>                  <BR>                  <TABLE BORDER=1 WIDTH=500>            <TR>               <td valign=top align=left>                  <P>targetLocation</p>               </TD><td valign=top align=left>                  <P>The location of the profile you wish to                  unflatten, which you specify using the                  <CODE>CMProfileLocation</CODE> data type. Commonly                  a profile is disk-file based. However, the profile                  may be a file-based profile, a handle-based                  profile, or a pointer-based profile.</p>               </TD></TR>            <TR>               <td valign=top align=left>                  <P>proc</p>               </TD><td valign=top align=left>                  <P>A user-defined procedure which is called during                  the unflatten operation.</p>               </TD></TR>            <TR>               <td valign=top align=left>                  <P>refCon</p>               </TD><td valign=top align=left>                  <P>A reference constant containing data specified                  by the calling application program.</p>               </TD></TR>            <TR>               <td valign=top align=left>                  <P>preferredCMMnotfound</p>               </TD><td valign=top align=left>                  <P>A return value indicating whether or not the CMM                  specified in the profile was found.</p>               </TD></TR>         </TABLE><BR>                  <P><B>DESCRIPTION</B></p>          <P>Use this function to unflatten a profile.</p>         <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>CMError CMIterateCMMInfo (CMMIterateUPP          proc,                          UInt32                *count,                          void                  *refCon);&nbsp;</pre></TD></TR></TABLE></CENTER><BR><BR>                        <P><B>Field Descriptions</B></p>                  <BR>                  <TABLE BORDER=1 WIDTH=500>            <TR>               <td valign=top align=left>                  <P>proc</p>               </TD><td valign=top align=left>                  <P>A calling-program-supplied callback function                  that allows your application to monitor progress or                  abort the operation.</p>                                                </TD></TR>            <TR>               <td align="left">                  <P>count</p>               </TD><td valign=top align=left>                  <P>A count of the number of CMMs referenced is                  returned here.</p>                                                </TD></TR>            <TR>               <td valign=top align=left>                  <P>refCon</p>               </TD><td valign=top align=left>                  <P>A reference constant containing data specified                  by the calling application program.</p>               </TD></TR>         </TABLE><BR>                  <P><B>NEW STRUCTURES FOR USE WITH THIS FUNCTION</B></p>                <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>OSErr CMMIterateUPP(        CMMInfo*  iterateData,       /* Ptr to a structure containing                                     /* information about a particular CMM */        void*     refcon             /* Caller-defined data, passed through from                                     /* CMIterateCMMInfo API */);&nbsp;struct CMMInfo  {  unsigned long   dataSize;          /* Size of this structure - for compatibility */  OSType          CMMType;           /* Signature of CMM */  OSType          CMMMfr;            /* Vendor, e.g. 'appl */  unsigned long   CMMVersion;        /* Version number */  Handle          CMMIcons;          /* If available, can be a group with varying size&amp; depth */  unsigned char   ASCIIName[32];     /* Pascal string - name */  unsigned char   ASCIIDesc[256];    /* Pascal string - description or copyright */  UniCharCount    UniCodeNameCount;  /* Count of UniChars in following array */  UniChar         UniCodeName[32];   /* The name in UniCode chars */  UniCharCount    UniCodeDescCount;  /* Count of UniChars in following array */  UniChar         UniCodeDesc[256];  /* The description in UniCode chars */};&nbsp;</pre></TD></TR></TABLE></CENTER><BR><BR>                               <P><B>DESCRIPTION</B></p>               <P>The <CODE>CMIterateCMMInfo</CODE> function returns         information for all CMMs installed on the system. The caller         can pass nil for the <CODE>CMMIterateUPP</CODE> param to         simply get a count of CMMs. If a <CODE>CMMIterateUPP</CODE>         proc is provided, it will be called once for each CMM         installed - with the <CODE>CMMInfo</CODE> structure filled         accordingly. The caller can pass a data reference to         <CODE>CMIterateCMMInfo</CODE> which will then be passed to         the <CODE>CMMIterateUPP</CODE>. This might be used to allow         some of the information in the <CODE>CMMInfo</CODE> data         structure to be put into a menu, for example, by passing a         menu reference as the refcon. Either the proc or the count         parameter must be provided. The caller will get a paramErr         if both are nil.</P>                             <TABLE BORDER=1 WIDTH=500>            <TR>               <td align="left">                  <P>CMError</p>               </TD><td align="left">                  <P><CODE>CMGetColorSyncVersion (UInt32                  *version);</CODE></p>               </TD></TR>         </TABLE><BR>                  <P><B>Field Descriptions</B></p>                  <BR>                  <TABLE BORDER=1 WIDTH=500>            <TR>               <td align="left">                  <P>version</p>               </TD><td align="left">                  <P>The version of ColorSync installed on the                  machine is returned here</p>               </TD></TR>         </TABLE><BR>                  <P><B>DESCRIPTION</B></p>         <P>Returns ColorSync version information.         <CODE>CMGetColorSyncVersion</CODE> relieves the Mac OS         developer from having to call <CODE>Gestalt</CODE> to find         out the version of ColorSync installed on the system.</P>               <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>Important Note:</B><BR>                  The return value for ColorSync 2.6 is                  <CODE>0x00026000</CODE> on the Macintosh. This is                  not consistent with what is currently returned by                  <CODE>Gestalt</CODE> (<CODE>0x00000260</CODE>).                  Future versions of ColorSync on the Macintosh will                  be fixed so they are consistent with                  <CODE>Gestalt</CODE> return values.</p> </TD></TR></TABLE></CENTER><BR><BR>                           <P><A HREF="#top">Back to top</A></P>                  <p><B>Deprecated APIs</B></p>                 <p> Support for the following APIs will be eliminated or limited         in the future:</p>                  <BR>                  <TABLE BORDER=1 WIDTH=500>            <TR>               <TH>                  <P>API</p>               </TH><TH>                  <P>ColorSyncVersion</p>               </TH><TH>                  <P>Reason for Deprecation</p>               </TH></TR>            <TR>               <TD align=center align="left">                  <P align = center>(CM)BeginMatching</p>               </TD><TD align=center align="left">                  <P align = center>1.x</p>               </TD><TD align=center align="left">                  <P align = center>Pict-based, uses 1.x Profiles</p>               </TD></TR>            <TR>               <TD align=center align="left">                  <P align = center>(CM)UseProfile(Comment)</p>               </TD><TD align=center align="left">                  <P align = center>1.x</p>               </TD><TD align=center align="left">                  <P align = center>Pict-based, uses 1.x Profiles</p>               </TD></TR>            <TR>               <TD align=center align="left">                  <P align = center>NCMUseProfileComment</p>               </TD><TD align=center align="left">                  <P align = center>2.x</p>               </TD><TD align=center align="left">                  <P align = center>Pict-based, uses 2.x Profiles</p>               </TD></TR>            <TR>               <TD align=center align="left">                  <P align = center>(CM)DrawMatchedPicture</p>               </TD><TD align=center align="left">                  <P align = center>1.x</p>               </TD><TD align=center align="left">                  <P align = center>Pict-based, uses 1.x Profiles</p>               </TD></TR>            <TR>               <TD align=center align="left">                  <P align = center>NCMDrawMatchedPicture</p>               </TD><TD align=center align="left">                  <P align = center>2.x</p>               </TD><TD align=center align="left">                  <P align = center>Pict-based, uses 2.x Profiles</p>               </TD></TR>            <TR>               <TD align=center align="left">                  <P align = center>(CM)GetProfileName</p>               </TD><TD align=center align="left">                  <P align = center>1.x</p>               </TD><TD align=center align="left">                  <P align = center>Uses 1.x Profiles</p>               </TD></TR>            <TR>               <TD align=center align="left">                  <P align = center>(CM)GetProfileAdditionalDataOffset                  </p>               </TD><TD align=center align="left">                  <P align = center>1.x</p>               </TD><TD align=center align="left">                  <P align = center>Uses 1.x Profiles</p>               </TD></TR>            <TR>               <TD align=center align="left">                  <P align = center>(CM)GetProfile</p>               </TD><TD align=center align="left">                  <P align = center>1.x</p>               </TD><TD align=center align="left">                  <P align = center>Profile Responder function</p>               </TD></TR>            <TR>               <TD align=center align="left">                  <P align = center>(CM)SetProfile</p>               </TD><TD align=center align="left">                  <P align = center>1.x</p>               </TD><TD align=center align="left">                  <P align = center>Profile Responder function</p>               </TD></TR>            <TR>               <TD align=center align="left">                  <P align = center>(CM)SetProfileDescription</p>               </TD><TD align=center align="left">                  <P align = center>1.x</p>               </TD><TD align=center align="left">                  <P align = center>Profile Responder function</p>               </TD></TR>            <TR>               <TD align=center align="left">                  <P align = center>(CM)GetIndexedProfile</p>               </TD><TD align=center align="left">                  <P align = center>1.x</p>               </TD><TD align=center align="left">                  <P align = center>Profile Responder function</p>               </TD></TR>            <TR>               <TD align=center align="left">                  <P align = center>(CM)DeleteDeviceProfile</p>               </TD><TD align=center align="left">                  <P align = center>1.x</p>               </TD><TD align=center align="left">                  <P align = center>Profile Responder function</p>               </TD></TR>            <TR>               <TD align=center align="left">                  <P align = center>ConcatenateProfiles</p>               </TD><TD align=center align="left">                  <P align = center>1.x</p>               </TD><TD align=center align="left">                  <P align = center>Uses 1.x Profiles</p>               </TD></TR>            <TR>               <TD align=center align="left">                  <P align = center>CWNewColorWorld</p>               </TD><TD align=center align="left">                  <P align = center>1.x</p>               </TD><TD align=center align="left">                  <P align = center>Uses 1.x Profiles</p>               </TD></TR>            <TR>               <TD align=center align="left">                  <P align = center>CMAccelerationLoadTables</p>               </TD><TD align=center align="left">                  <P align = center>2.x</p>               </TD><TD align=center align="left">                  <P align = center>CMM Function - HW acceleration no longer                  supported</p>               </TD></TR>            <TR>               <TD align=center align="left">                  <P align = center>CMAccelerationCalculateData</p>               </TD><TD align=center align="left">                  <P align = center>2.x</p>               </TD><TD align=center align="left">                  <P align = center>CMM Function - HW acceleration no longer                  supported</p>               </TD></TR>         </TABLE>                  <P><A HREF="#top">Back to top</A></P>         <P><B>New CMM APIs</B></p>         <P>The following APIs specify new CMM entry points which         ColorSync will call to handle the creation of new color         worlds or link profiles as returned by the         <CODE>NCWConcatColorWorld</CODE> and         <CODE>NCWNewLinkProfile</CODE> functions respectively. These         APIs are of interest to CMM developers only.</P>       <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>CMError NCMMConcatInit (CMMStorageHdl              hStorage,                        NCMConcatProfileSet       *profileSet,                        CMConcatCallBackUPP        proc,                        void                      *refCon);&nbsp;</pre></TD></TR></TABLE></CENTER><BR><BR>                                <P><B>Field Descriptions</B></p>                           <TABLE BORDER=1 WIDTH=500>            <TR>               <td valign=top align=left>                  <P>hStorage</p>               </TD><td valign=top align=left>                  <P>The CMM's private instance storage.</p>               </TD></TR>            <TR>               <td valign=top align=left>                  <P>profileSet</p>               </TD><td valign=top align=left>                  <P>Set of profiles to concatenate into a color                  world.</p>               </TD></TR>            <TR>               <td valign=top align=left>                  <P>proc</p>               </TD><td valign=top align=left>                  <P>Callback procedure.</p>               </TD></TR>            <TR>               <td valign=top align=left>                  <P>refCon</p>               </TD><td valign=top align=left>                  <P>User data passed on to callback procedure.</p>               </TD></TR>         </TABLE><BR>         <P><B>DESCRIPTION</B></P><P>This is the API which ColorSync calls when an application         calls the <SAMP>NCWConcatColorWorld</SAMP> function. The new         selector for this function is <CODE>kNCMMConcatInit</CODE>.         The CMM is responsible for validating the profiles specified         in the profile set and for building a transform using these         profiles. If the CMM cannot build such a transform, it         should return a <CODE>cmCantConcatenateErr</CODE> error, or         another appropriate error code.</P>       <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>CMError NCMMNewLinkProfile (CMMStorageHdl        hStorage,                            CMProfileRef         prof,                            NCMConcatProfileSet *profileSet,                            CMConcatCallBackUPP  proc,                            void                *refCon);&nbsp;</pre></TD></TR></TABLE></CENTER><BR><BR>                                 <P><B>Field Descriptions</b></p>                           <TABLE BORDER=1 WIDTH=500>            <TR>               <td valign=top align=left>                  <P>hStorage</p>               </TD><td valign=top align=left>                  <P>The CMM's private instance storage.</p>               </TD></TR>            <TR>               <td valign=top align=left>                  <P>prof</p>               </TD><td valign=top align=left>                  <P>The CMM will add the appropriate tags to this                  profile.</p>               </TD></TR>            <TR>               <td valign=top align=left>                  <P>profileSet</p>               </TD><td valign=top align=left>                  <P>Set of profiles to concatenate into a link                  profile.</p>               </TD></TR>            <TR>               <td valign=top align=left>                  <P>proc</p>               </TD><td valign=top align=left>                  <P>Callback procedure.</p>               </TD></TR>            <TR>               <td valign=top align=left>                  <P>refCon</p>               </TD><td valign=top align=left>                  <P>User data passed on to callback procedure.</p>               </TD></TR>         </TABLE><BR>                  <P><B>DESCRIPTION</B></p>                  <BR>                                <P>This is the API which ColorSync calls when an application         calls the <CODE>NCWNewLinkProfile</CODE> function. The new         selector for this function is         <CODE>kNCMMNewLinkProfile</CODE>. The CMM is responsible for         validating the profiles specified in the profile set and for         building a link profile using these profiles. If the CMM         cannot build a link profile, it should return a         <CODE>cmCantConcatenateErr</CODE> error, or another         appropriate error code. ColorSync will create the profile         (via <CODE>CMNewProfile</CODE>) before calling the CMM, so         the CMM need only add the appropriate tags to the profile         before returning. ColorSync will also ensure that the tags         are written to the profile by calling         <CODE>CMUpdateProfile</CODE>, before returning it to the         caller.</P>                  <P><A HREF="#top">Back to top</A></P>                  <P><B>New ColorSync Scripting Library APIs</B></p>                  <P>ColorSync 2.6 provides a new set of scripting library         APIs which are designed to give applications access to the         same file format utilities provided by the new ColorSync 2.6         AppleEvent terminology. In fact, the code in ColorSync which         responds to AppleEvents actually calls this same library.         Listed below are the functions introduced in this new         scripting library:</P>                <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>CMError CMValidImage (const FSSpec *spec);</pre></TD></TR></TABLE></CENTER><BR><BR>                                <P><B>Field Descriptions</B></p>                  <BR>                  <TABLE BORDER=1 WIDTH=500>            <TR>               <td valign=top align=left>                  <P>spec</p>               </TD><td valign=top align=left>                  <P>A file specification for the image file you                  wish to validate.</p>               </TD></TR>         </TABLE><BR>                  <P><B>DESCRIPTION</B></p>                  <BR>         <P>This function validates the specified image file.         ColorSync will check with any installed scripting plug-ins         to see if they recognize the image's file format. If a         scripting plug-in is found which recognizes the image's file         format, <CODE>CMValidateImage</CODE> will return         <CODE>noErr</CODE>. If the image's file format is not         recognized, <CODE>CMValidateImage</CODE> will return the         <CODE>cmInvalidImageFile</CODE> error.</P><BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>CMError CMGetImageSpace (const FSSpec *spec,                               OSType *space);&nbsp;</pre></TD></TR></TABLE></CENTER><BR><BR>                                <P><B>Field Descriptions</B></p>                  <BR>                  <TABLE BORDER=1 WIDTH=500>            <TR>               <td align="left">                  <P>spec</p>               </TD><td align="left">                  <P>A file specification for the image file.</p>               </TD></TR>            <TR>               <td align="left">                  <P>space</p>               </TD><td align="left">                  <P>The signature of the data color space of the                  color values of colors for the image file is                  returned here.</p>               </TD></TR>         </TABLE><BR>         <P><B>DESCRIPTION</B></p>         <P>This function returns the signature of the data color         space in which the color values of colors in an image are         expressed.</P>                <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>CMError CMEmbedImage (const FSSpec *specFrom,                      const FSSpec *specInto,                      Boolean       repl,                      CMProfileRef  embProf);&nbsp;</pre></TD></TR></TABLE></CENTER><BR><BR>                                          <P><B>Field Descriptions</B></p>                  <BR>                  <TABLE BORDER=1 WIDTH=500>            <TR>               <td valign=top align=left>                  <P>specFrom</p>               </TD><td valign=top align=left>                  <P>A file specification for the image file.</p>               </TD></TR>            <TR>               <td valign=top align=left>                  <P>specInto</p>               </TD><td valign=top align=left>                  <P>If this parameter is a file, it specifies the                  resulting image. If this parameter is a folder, it                  specifies the location of the resulting image which                  will have the same name as the original file. If                  this parameter is not provided, the original file                  is modified.</p>               </TD></TR>            <TR>               <td valign=top align=left>                  <P>repl</p>               </TD><td valign=top align=left>                  <P>If a file with the same name already exists, it                  will be replaced if this parameter is set to true.</p>               </TD></TR>            <TR>               <td valign=top align=left>                  <P>embProf</p>               </TD><td valign=top align=left>                  <P>The profile to embed in the image.</p>               </TD></TR>         </TABLE><BR>                  <P><B>DESCRIPTION</B></p>                           <P>This function will embed an image with an ICC profile.</P>                  <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>CMError CMUnembedImage (const FSSpec *specFrom,                        const FSSpec *specInto,                        Boolean       repl);&nbsp;</pre></TD></TR></TABLE></CENTER><BR><BR>                                 <P><B>Field Descriptions</B></p>                  <BR>                  <TABLE BORDER=1 WIDTH=500>            <TR>               <td valign=top align=left>                  <P>specFrom</p>               </TD><td valign=top align=left>                  <P>A file specification for the image file.</p>               </TD></TR>            <TR>               <td valign=top align=left>                  <P>specInto</p>               </TD><td valign=top align=left>                  <P>If this parameter is a file, it specifies the                  resulting image. If this parameter is a folder, it                  specifies the location of the resulting image which                  will have the same name as the original file. If                  this parameter is not provided, the original file                  is modified.</p>               </TD></TR>            <TR>               <td valign=top align=left>                  <P>repl</p>               </TD><td valign=top align=left>                  <P>If a file with the same name already exists, it                  will be replaced if this parameter is set to true.</p>               </TD></TR>         </TABLE><BR>                  <P><B>DESCRIPTION</B></p>                           <P>This function will remove any ICC profiles embeded in an         image.</P>         <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>CMError CMMatchImage (const FSSpec *specFrom,                      const FSSpec *specInto,                      Boolean       repl,                      UInt32        qual,                      CMProfileRef  srcProf,                      UInt32        srcIntent,                      CMProfileRef  dstProf);&nbsp;</pre></TD></TR></TABLE></CENTER><BR><BR>                     <P><B>Field Descriptions</B></p>                  <BR>                  <TABLE BORDER=1 WIDTH=500>            <TR>               <td align="left">                  <P>specFrom</p>               </TD><td align="left">                  <P>A file specification for the image file.</p>               </TD></TR>            <TR>               <td align="left">                  <P>specInto</p>               </TD><td align="left">                  <P>If this parameter is a file, it specifies the                  resulting image. If this parameter is a folder, it                  specifies the location of the resulting image which                  will have the same name as the original file. If                  this parameter is not provided, the original file                  is modified.</p>               </TD></TR>            <TR>               <td align="left">                  <P>repl</p>               </TD><td align="left">                  <P>If a file with the same name already exists, it                  will be replaced if this parameter is set to true.</p>               </TD></TR>            <TR>               <td align="left">                  <P>qual</p>               </TD><td align="left">                  <P>The optional quality for the match - normal,                  draft or best (<CODE>cmNormalMode</CODE>,                  <CODE>cmDraftMode</CODE> or                  <CODE>cmBestMode</CODE>).</p>               </TD></TR>            <TR>               <td align="left">                  <P>srcProf</p>               </TD><td align="left">                  <P>The optional source profile for the match.</p>               </TD></TR>            <TR>               <td align="left">                  <P>srcIntent</p>               </TD><td align="left">                  <P>The rendering intent for the match - perceptual                  intent, relative colorimetric intent, saturation                  intent, or absolute colorimetric intent                  (<CODE>cmPerceptual</CODE>,                  <CODE>cmRelativecolorimetric</CODE>,                  <CODE>cmSaturation</CODE> or                  <CODE>cmAbsoluteColorimetric</CODE>).</p>               </TD></TR>            <TR>               <td align="left">                  <P>dstProf</p>               </TD><td align="left">                  <P>The destination profile for the match.</p>               </TD></TR>         </TABLE><BR>                  <P><B>DESCRIPTION</B></p>                           <P>Use this function to color match an image file.</P>         <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>CMError CMProofImage (const FSSpec *specFrom,                      const FSSpec *specInto,                      Boolean       repl,                      UInt32        qual,                      CMProfileRef  srcProf,                      UInt32        srcIntent,                      CMProfileRef  dstProf,                      CMProfileRef  prfProf);&nbsp;</pre></TD></TR></TABLE></CENTER><BR><BR>                       <P><B>Field Descriptions</B></p>                  <BR>                  <TABLE BORDER=1 WIDTH=500>            <TR>               <td align="left">                  <P>specFrom</p>               </TD><td align="left">                  <P>A file specification for the image file.</p>               </TD></TR>            <TR>               <td align="left">                  <P>specInto</p>               </TD><td align="left">                  <P>If this parameter is a file, it specifies the                  resulting image. If this parameter is a folder, it                  specifies the location of the resulting image which                  will have the same name as the original file. If                  this parameter is not provided, the original file                  is modified.</p>               </TD></TR>            <TR>               <td align="left">                  <P>repl</p>               </TD><td align="left">                  <P>If a file with the same name already exists, it                  will be replaced if this parameter is set to true.</p>               </TD></TR>            <TR>               <td align="left">                  <P>qual</p>               </TD><td align="left">                  <P>The optional quality for the match - normal,                  draft or best (<CODE>cmNormalMode,                  cmDraftMode</CODE> or <CODE>cmBestMode</CODE>).</p>               </TD></TR>            <TR>               <td align="left">                  <P>srcProf</p>               </TD><td align="left">                  <P>The optional source profile for the match.</p>               </TD></TR>            <TR>               <td align="left">                  <P>srcIntent</p>               </TD><td align="left">                  <P>The rendering intent for the match between the                  source and destination profiles - perceptual                  intent, relative colorimetric intent, saturation                  intent, or absolute colorimetric intent                  (<CODE>cmPerceptual, cmRelativecolorimetric,                  cmSaturation</CODE> or                  <CODE>cmAbsoluteColorimetric</CODE>).</p>               </TD></TR>            <TR>               <td align="left">                  <P>dstProf</p>               </TD><td align="left">                  <P>The destination profile for the match.</p>               </TD></TR>            <TR>               <td align="left">                  <P>prfProf</p>               </TD><td align="left">                  <P>The proof profile for the match between the                  destination and proof profiles.</p>               </TD></TR>         </TABLE><BR>                  <P><B>DESCRIPTION</B></p>                  <P>Use this function to proof an image file.</p>         <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>CMError CMLinkImage (const FSSpec *specFrom,                     const FSSpec *specInto,                     Boolean       repl,                     UInt32        qual,                     CMProfileRef  lnkProf,                     UInt32        lnkIntent);&nbsp;</pre></TD></TR></TABLE></CENTER><BR><BR>                      <P><B>Field Descriptions</B></p>                  <BR>                  <TABLE BORDER=1 WIDTH=500>            <TR>               <td align="left">                  <P>specFrom</p>               </TD><td align="left">                  <P>A file specification for the image file.</p>               </TD></TR>            <TR>               <td align="left">                  <P>specInto</p>               </TD><td align="left">                  <P>If this parameter is a file, it specifies the                  resulting image. If this parameter is a folder, it                  specifies the location of the resulting image which                  will have the same name as the original file. If                  this parameter is not provided, the original file                  is modified.</p>               </TD></TR>            <TR>               <td align="left">                  <P>repl</p>               </TD><td align="left">                  <P>If a file with the same name already exists, it                  will be replaced if this parameter is set to true.</p>               </TD></TR>            <TR>               <td align="left">                  <P>qual</p>               </TD><td align="left">                  <P>The optional quality for the match - normal,                  draft or best (<CODE>cmNormalMode,                  cmDraftMode</CODE> or <CODE>cmBestMode</CODE>).</p>               </TD></TR>            <TR>               <td align="left">                  <P>lnkProf</p>               </TD><td align="left">                  <P>The device link profile for the match.</p>               </TD></TR>            <TR>               <td align="left">                  <P>lnkIntent</p>               </TD><td align="left">                  <P>The rendering intent for the match - perceptual                  intent, relative colorimetric intent, saturation                  intent or absolute colorimetric intent                  (<CODE>cmPerceptual, cmRelativecolorimetric,                  cmSaturation</CODE> or                  <CODE>cmAbsoluteColorimetric</CODE>).</p>               </TD></TR>         </TABLE><BR>                  <P><B>DESCRIPTION</B></p>                           <P>Use this function to match an image file with a device         link profile.</P>         <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>CMError CMCountImageProfiles (const FSSpec *spec,                              UInt32       *count);&nbsp;</pre></TD></TR></TABLE></CENTER><BR><BR>                                 <P><B>Field Descriptions</B></p>                  <BR>                  <TABLE BORDER=1 WIDTH=500>            <TR>               <td align="left">                  <P>spec</p>               </TD><td align="left">                  <P>A file specification for the image file.</p>               </TD></TR>            <TR>               <td align="left">                  <P>count</p>               </TD><td align="left">                  <P>A count of the embeded profiles for the image is                  returned here.</p>               </TD></TR>         </TABLE><BR>                  <P><B>DESCRIPTION</B></p>                           <P>Use this function to obtain a count of the number of         embeded profiles for a given image.</P><BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>CMError CMGetIndImageProfile (const FSSpec *spec,                              UInt32        index,                              CMProfileRef *prof);&nbsp;</pre></TD></TR></TABLE></CENTER><BR><BR>                        <P><B>Field Descriptions</B></p>                  <BR>                  <TABLE BORDER=1 WIDTH=500>            <TR>               <td align="left">                  <P>spec</p>               </TD><td align="left">                  <P>A file specification for the image file.</p>               </TD></TR>            <TR>               <td align="left">                  <P>index</p>               </TD><td align="left">                  <P>The numeric index of the profile to return.</p>               </TD></TR>            <TR>               <td align="left">                  <P>prof</p>               </TD><td align="left">                  <P>The profile is returned here.</p>               </TD></TR>         </TABLE><BR>                  <P><B>DESCRIPTION</B></p>                           <P>Use this function to obtain a specific embeded profile         for a given image.</P>         <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>CMError CMSetIndImageProfile (const FSSpec *specFrom,                              const FSSpec *specInto,                              Boolean       repl,                              UInt32        index,                              CMProfileRef  prof);&nbsp;</pre></TD></TR></TABLE></CENTER><BR><BR>                               <P><B>Field Descriptions</B></p>                  <BR>                  <TABLE BORDER=1 WIDTH=500>            <TR>               <td align="left">                  <P>specFrom</p>               </TD><td align="left">                  <P>A file specification for the image file.</p>               </TD></TR>            <TR>               <td align="left">                  <P>specInto</p>               </TD><td align="left">                  <P>If this parameter is a file, it specifies the                  resulting image. If this parameter is a folder, it                  specifies the location of the resulting image which                  will have the same name as the original file. If                  this parameter is not provided, the original file                  is modified.</p>               </TD></TR>            <TR>               <td align="left">                  <P>repl</p>               </TD><td align="left">                  <P>If a file with the same name already exists, it                  will be replaced if this parameter is set to true.</p>               </TD></TR>            <TR>               <td align="left">                  <P>index</p>               </TD><td align="left">                  <P>The numeric index of the profile to set.</p>               </TD></TR>            <TR>               <td align="left">                  <P>prof</p>               </TD><td align="left">                  <P>The profile to set at the index designated by                  the index parameter.</p>               </TD></TR>         </TABLE><BR>                  <P><B>DESCRIPTION</B></p>                           <P>Use this function to set a specific embeded profile for a         given image.</P>                  <P><B>New CMBitmap Types</B></p>                           <P>Several new <CODE>CMBitmap</CODE> spaces were added in         ColorSync 2.6 (see below) to provide developers with a wide         range of data formats appropriate for multiple platforms.         </P>                  <P>Several bitmap spaces now can have a new space attribute         flag <CODE>cmLittleEndianPacking</CODE> set to indicate         Little-Endian data. Another new variant         <CODE>cmReverseChannelPacking</CODE>, which can apply to         just about all of the new and old spaces is a "reverse         channels" attribute.</P>                  <P><B>Bitmap spaces supported in ColorSync 2.5</B></p>                  <BR>                  <UL>            <LI>cmGray16Space = cmGraySpace,</li>                        <LI>cmGrayA32Space = cmGrayASpace,</li>                        <LI>cmRGB16Space = cmWord5ColorPacking + cmRGBSpace,</li>                        <LI>cmRGB24Space = cm24_8ColorPacking + cmRGBSpace,</li>                        <LI>cmRGB32Space = cm32_8ColorPacking + cmRGBSpace,</li>                        <LI>cmRGB48Space = cm48_16ColorPacking + cmRGBSpace,</li>                        <LI>cmARGB32Space = cm32_8ColorPacking +            cmAlphaFirstPacking + cmRGBASpace,</li>                        <LI>cmRGBA32Space = cm32_8ColorPacking +            cmAlphaLastPacking + cmRGBASpace,</li>                        <LI>cmCMYK32Space = cm32_8ColorPacking + cmCMYKSpace,</li>                        <LI>cmCMYK64Space = cm64_16ColorPacking + cmCMYKSpace,</li>                        <LI>cmHSV32Space = cmLong10ColorPacking + cmHSVSpace,</li>                        <LI>cmHLS32Space = cmLong10ColorPacking + cmHLSSpace,</li>                        <LI>cmYXY32Space = cmLong10ColorPacking + cmYXYSpace,</li>                        <LI>cmXYZ32Space = cmLong10ColorPacking + cmXYZSpace,</li>                        <LI>cmLUV32Space = cmLong10ColorPacking + cmLUVSpace,</li>                        <LI>cmLAB24Space = cm24_8ColorPacking + cmLABSpace,</li>                        <LI>cmLAB32Space = cmLong10ColorPacking + cmLABSpace,</li>                        <LI>cmLAB48Space = cm48_16ColorPacking + cmLABSpace,</li>                        <LI>cmGamutResult1Space = cmOneBitDirectPacking +            cmGamutResultSpace,</li>                        <LI>cmNamedIndexed32Space = cm32_32ColorPacking +            cmNamedIndexedSpace,</li>                        <LI>cmMCFive8Space = cm40_8ColorPacking + cmMCFiveSpace,</li>                        <LI>cmMCSix8Space = cm48_8ColorPacking + cmMCSixSpace,</li>                        <LI>cmMCSeven8Space = cm56_8ColorPacking +            cmMCSevenSpace,</li>                        <LI>cmMCEight8Space = cm64_8ColorPacking + cmMCEightSpace</li>                  </UL>                  <P><B>New Spaces added for 2.6</B></p>                  <BR>                  <UL>            <LI>cmGray8Space = cmGraySpace + cm8_8ColorPacking, 8-bit            gray</li>                        <LI>cmGrayA16Space = cmGrayASpace + cm16_8ColorPacking,            8-bit gray + 8-bit alpha</li>                        <LI>cmGray16LSpace = cmGraySpace + cmLittleEndianPacking,            16-bit gray, little-endian</li>                        <LI>cmGrayA32LSpace = cmGrayASpace +            cmLittleEndianPacking, 16-bit gray + 16-bit alpha,            little-endian</li>                        <LI>cmRGB565Space = cmRGBSpace + cmWord565ColorPacking,            Variant of 1.5.5.5</li>                        <LI>cmRGB565LSpace = cmRGBSpace + cmWord565ColorPacking +            cmLittleEndianPacking, Variant of 1.5.5.5, little-endian</li>                        <LI>cmRGB16LSpace = cmRGBSpace + cmWord5ColorPacking +            cmLittleEndianPacking, 1.5.5.5, little-endian</li>                        <LI>cmRGB48LSpace = cmRGBSpace + cm48_16ColorPacking +            cmLittleEndianPacking, 16-bits per channel RGB,            little-endian</li>                        <LI>cmARGB64Space = cmRGBASpace + cm64_16ColorPacking +            cmAlphaFirstPacking, 16-bits per channel RGB w/leading            alpha channel</li>                        <LI>cmARGB64LSpace = cmRGBASpace + cm64_16ColorPacking +            cmAlphaFirstPacking + cmLittleEndianPacking, bits / chl            RGB w/leading alpha, little-endian</li>                        <LI>cmRGBA64Space = cmRGBASpace + cm64_16ColorPacking +            cmAlphaLastPacking, 16-bits / chl RGB with trailing alpha            channel</li>                        <LI>cmRGBA64LSpace = cmRGBASpace + cm64_16ColorPacking +            cmAlphaLastPacking + cmLittleEndianPacking bits / chl RGB            w/trailing alpha, little-endian</li>                        <LI>cmCMYK64LSpace = cmCMYKSpace + cm64_16ColorPacking +            cmLittleEndianPacking, 16-bits per channel CMYK,            little-endian</li>                        <LI>cmXYZ24Space = cmXYZSpace + cm24_8ColorPacking, 8-bit            per channel XYZ</li>                        <LI>cmXYZ48Space = cmXYZSpace + cm48_16ColorPacking,            16-bits per channel XYZ</li>                        <LI>cmXYZ48LSpace = cmXYZSpace + cm48_16ColorPacking +            cmLittleEndianPacking, 16-bits</li>                        <LI>per channel XYZ, little-endian</li>                        <LI>cmLAB48LSpace = cmLABSpace + cm48_16ColorPacking +            cmLittleEndianPacking, 16-bits per channel Lab,            little-endian</li>                        <LI>cmNamedIndexed32LSpace = cm32_32ColorPacking +            cmNamedIndexedSpace + cmLittleEndianPacking, 32-bit            index, little-endian</li>         </UL>                  <P><B>ICC Profile Description (<CODE>'desc'</CODE>) Tag         Handling</B></p>                           <P>One important change in the recent release of ColorSync         (version 2.6) is how it handles the description         (<CODE>'desc'</CODE>) tag of ICC profiles.</P>                  <P>The <CODE>'desc'</CODE> tag of a profile, as defined by         the ICC, contains up to three strings. The first is a         required 7-bit Roman ASCII string. The second is an optional         localized Unicode string. The third, also optional, is a         localized string in Mac script-code format. Applications         typically use one of the available strings to show the name         of profiles in a list or pop-up menu. There are a few other         important devilish details in the ICC definition of the         <CODE>'desc'</CODE> tag. One is that all three strings must         be null terminated. Another is that all three strings are         preceded by a character count that includes the null         terminator. It is also worth noting that for the Unicode         string, the character count must not be confused with a byte         count because each Unicode character requires two bytes.         </P>                  <P>Previous releases of ColorSync only make partial use of         this tag and, as a result, only performed limited error         checking on its contents. For example, The ColorSync         function <CODE>CMGetScriptProfileDescription</CODE> would         return the Mac script-code from a profile if it was present         and, if not, it would return the 7-bit Roman ASCII string.         The Unicode string was simply ignored and in some cases, if         the Unicode and/or Mac script-code string were         non-compliant, ColorSync would return garbage (or the ASCII         string if you were lucky) without returning         <CODE>cmProfileErr</CODE> code.</P>                  <P>ColorSync 2.6 provides a new function,         <CODE>CMGetProfileDescriptions</CODE>, to give the user         access to all three possible strings in the <CODE>'desc'         </CODE>tag. In doing so, much stricter attention had to be         paid to the compliance of the <CODE>'desc'</CODE> tag. For         example, if either the ASCII string or the Mac script-code         strings is not null terminated, or if any of the string's         character counts are invalid or beyond the range of the         <CODE>'desc'</CODE> tag, the and <CODE>cmProfileErr</CODE>         code is returned.</P>                  <P>In order to achieve optimal performance when applications         add profiles to a list or pop-up menu, ColorSync maintains a         cache of all the profiles installed in the "ColorSync         Profiles" folder and its sub-directories. Among other things         this cache file contains the three possible names of each         profile obtained by calling         <CODE>CMGetProfileDescriptions</CODE>. If         <CODE>CMGetProfileDescriptions</CODE> returns an error         because the <CODE>'desc'</CODE> tag is non-compliant, then         the profile is not added to the cache. This is why         non-compliant profiles, even though they are properly         installed in the "ColorSync Profiles" folder, no longer show         up in the ColorSync control panel or the ColorSync plug-ins         pop-up menus with ColorSync 2.6 installed.</P>                  <P>The remedy for this problem is to repair the affected         profiles. Unfortunately, the "Rename Profile" AppleScript         that is installed as part of ColorSync 2.6 can not be used         to repair profiles with bad <CODE>'desc'</CODE> tags because         it can only operate on profiles in the ColorSync profile         cache. Instead, a simple stand-alone tool called "Profile         First Aid" to verify and repair any profile will be made         available on the ColorSync web site         &lt;<A HREF="http://www.apple.com/colorsync/">http://www.apple.com/colorsync/</A>&gt;.         </P>                  <BR><P><A HREF="#top">Back to top</A></P>                  <P><A NAME="Compatibility"></A></P>                  <H2>ColorSync 2.6 Compatibility Issues</H2>                  <P><B>ColorSync 1.X/2.X Support</B></p>                  <P>Support for version 1.0 profiles and hybrid (1.0/2.0)         color worlds has been removed in ColorSync 2.6. ColorSync         1.0 profiles, APIs and CMMs are not supported.</P>                  <P><B>CMM</B></p>                  <P>No longer required to support ColorSync 1.0 Profiles.         Existing CMMs will be compatible.</P>                  <P>New CMM APIs: <CODE>NCMConcatInit</CODE>,         <CODE>NCMMNewLinkProfile</CODE> (see section         "<A HREF="#NewAPIs">New CMM APIs</A>" for the details) which         a CMM may choose to implement. If a given CMM does not         implement these new APIs, the default CMM is invoked         instead.</P>                  <P><B>Profile Searching</B></p>                  <P>ColorSync 2.6 will support new profile locations (System         Folder) for Profile searches made with the search functions         (<CODE>CMNewProfileSearch</CODE>, etc.). Profiles in         subfolders within the profiles folder will be found as well.         </P>                  <P><B>Color Worlds</B></p>                  <P>New API <CODE>NCWConcatColorWorld</CODE> (see section         "<A HREF="#NewAPIs">New ColorSync 2.6 APIs</A>" for the         details) puts power and responsibility of color world design         into the hands of developers. Callers can select which         profile tags and rendering intents to use. It also allows         for new combinations of profiles which were previously not         supported (e.g., more than one device-link profile).</P>                  <P><B>QuickDraw Matching</B></p>                  <P>                  2.X QuickDraw calls will continue to be supported         (<CODE>N/NCMBeginMatching</CODE>,         <CODE>CMEndMatching</CODE>,         <CODE>N/CMDrawMatchedPicture</CODE>,         <CODE>CWMatchPixMap</CODE>, <CODE>CWCheckPixMap</CODE>).</p>                  <P>                  <B>Scripting &amp; File Formats</B></p>                  <P>                  JPEG, GIF, as well as TIFF file format plug-ins are now         supported.</p>               <P><A HREF="#top">Back to top</A></P><a name="References"></a><H2>References</H2><P><a href="http://developer.apple.com/macos/color.html">Inside Macintosh:Managing Color With ColorSync.</A></p>         <P><A HREF="#top">Back to top</A></P><a name="Changes"></a><H2>Change History</H2>            <TABLE BORDER=0 CELLPADDING=3 WIDTH=544>            <TR>               <td width=100 align=left>                  <P ALIGN=center>01-April-1999</P>               </TD>               <td align="left">                  <P>Originally written.</P>               </TD>            </TR>            <TR>               <td width=100 align=left>                  <P ALIGN=center>26-April-1999</P>               </TD>               <td align="left">                  <P>Corrected the <code>NCMConcatProfileSet</code> structure            definition.</P>               </TD>            </TR>           </table>          <P><A HREF = "#top">Back to top</a></p><BR><A NAME="Downloads"></A> <h2>Downloadables</h2><center><TABLE BORDER=0 CELLPADDING=3 WIDTH="600"> <TR> <td width=50 align=left>   <P ALIGN=center><img src="images/acrobatsmall.gif" align=middle alt="Acrobat" width=22 height=23></P></TD><td align="left">   <p>Acrobat version of this Note (96K).</P></TD><td width=60 align=left>   <p><A HREF="pdf/tn1160.pdf">Download</A></P></TD>  </TR> </table></center><BR><p><a href="#top">Back to top</a></p></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tn/tn1160.html%3Fid%3DDTS10002999-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tn/tn1160.html%3Fid%3DDTS10002999-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tn/tn1160.html%3Fid%3DDTS10002999-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>