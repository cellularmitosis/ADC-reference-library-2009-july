<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>DBGetItem(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING516></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-515.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-517.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-469.html"><B>Chapter 12 - Data Access Manager</B></A> / <A HREF="IAC-487.html"><B>Data Access Manager Reference</B></A><BR><DL><DD><A HREF="IAC-492.html"><B>Data Access Manager Routines</B></A> / <A HREF="IAC-515.html"><B>Low-Level Interface: Retrieving Results</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING516-0></A>
<H3><A NAME=MARKER-9-382></A>DBGetItem</H3>
 <A NAME=MARKER-2-383></A>After you have executed a query and the <CODE>DBState</CODE> function returns the <CODE>rcDBValue</CODE> result code, indicating that data is available, you can use the <CODE>DBGetItem</CODE> function to retrieve the next data item. You can also use this function to obtain information about the next data item without retrieving the data. <P>
<PRE>
FUNCTION DBGetItem (sessID: LongInt; timeout: LongInt; 
                    VAR dataType: DBType; VAR len: Integer;
                    VAR places: Integer; VAR flags: Integer;
                    buffer: Ptr; asyncPB: DBAsyncParmBlkPtr)
                    : OSErr;
</PRE>
<DL>
<DT><CODE>sessID</CODE>
<DD> The session ID that was returned by the <CODE>DBInit</CODE> function.
<DT><CODE>timeout</CODE>
<DD> The maximum amount of time that the database extension should wait to receive results from the data server before canceling the function. Specify the <CODE>timeout</CODE> parameter in ticks (sixtieths of a second). To disable the timeout feature, set the <CODE>timeout</CODE> parameter to the <CODE>kDBWaitForever</CODE> constant. If the timeout period expires, the <CODE>DBGetItem</CODE> function returns the <CODE>rcDBBreak</CODE> result code. The <CODE>DBGetItem</CODE> function ignores the <CODE>timeout</CODE> parameter if you call the function asynchronously. 
<DT>
<DD> One use for the <CODE>timeout</CODE> parameter is to call the <CODE>DBGetItem</CODE> function periodically with a short value set for this parameter in order to return control to your application while a query is executing. Your application can then retrieve the next data item as soon as execution of the query is complete without having to call the <CODE>DBState</CODE> function to determine when data is available.
<DT><CODE>dataType</CODE>
<DD> The data type that you expect the next data item to be. If the item is not of the expected data type, the database extension returns the <CODE>rcDBBadType</CODE> result code. If you want to retrieve the next data item regardless of type, set the <CODE>dataType</CODE> parameter to the <CODE>typeAnyType</CODE> constant. To skip the next data item, set the <CODE>dataType</CODE> parameter to the <CODE>typeDiscard</CODE> constant. The data server sets the <CODE>dataType</CODE> parameter to the actual type of the data item when it retrieves the data item or returns information about the data item.
<DT><CODE>len</CODE>
<DD> The length of the data buffer pointed to by the <CODE>buffer</CODE> parameter. If you use the <CODE>DBGetItem</CODE> function to obtain information only (by setting the <CODE>buffer</CODE> parameter to <CODE>NIL</CODE>), then the data server ignores the <CODE>len</CODE> parameter. The data server sets the <CODE>len</CODE> parameter to the actual length of the data item when it retrieves the data item or returns information about the data item.
<DT><CODE>places</CODE>
<DD> Returns the number of decimal places in data items of types <CODE>typeMoney</CODE> and <CODE>typeDecimal</CODE>. For all other data types, the data server returns 0 for the <CODE>places</CODE> parameter.
<DT><CODE>flags</CODE>
<DD> If the least significant bit of the <CODE>flags</CODE> parameter is set to 1, the data item is in the last column of the row. If the third bit of this parameter is set to 1, the data item is <CODE>NULL</CODE>. You can use the constants <CODE>kDBLastColFlag</CODE> and <CODE>kDBNullFlag</CODE> to test for these flag bits.
<DT><CODE>buffer</CODE>
<DD> A pointer to the location where you want the retrieved data item to be stored. You must ensure that the location you specify contains enough space for the data item that will be returned. To determine the data type, length, and number of decimal places of the next data item without retrieving it, specify <CODE>NIL</CODE> for the <CODE>buffer</CODE> parameter. 
<DT><CODE>asyncPB</CODE>
<DD> A pointer to an asynchronous parameter block. If you do not want to call the function asynchronously, set this parameter to <CODE>NIL</CODE>.
</DL>
<A NAME=HEADING516-12></A>
<H5>DESCRIPTION</H5>
 The <CODE>DBGetItem</CODE> function retrieves the next data item from the data server. You can repeat the <CODE>DBGetItem</CODE> function as many times as is necessary to retrieve all of the data returned by the data source in response to a query.<P>
<A NAME=HEADING516-14></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 The <CODE>DBGetItem</CODE> function may move or purge memory. You should not call this routine from within an interrupt, such as in a completion routine or a VBL task.<P>
<A NAME=HEADING516-16></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The trap macro and routine selector for the <CODE>DBGetItem</CODE> function are
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Trap macro<TH>Selector<TR>
<TD>_DBGetItem<TD>$100C</TABLE>
<P>
<A NAME=HEADING516-18></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>rcDBNull<TD>-800<TD>The data item was <CODE>NULL</CODE><TR>
<TD>rcDBValue<TD>-801<TD>Data available was successfully retrieved<TR>
<TD>rcDBError<TD>-802<TD>Error executing function<TR>
<TD>rcDBBadType<TD>-803<TD>Next data item not of requested data type<TR>
<TD>rcDBBreak<TD>-804<TD>Function timed out<TR>
<TD>rcDBBadSessID<TD>-806<TD>Session ID is invalid<TR>
<TD>rcDBAsyncNotSupp<TD>-809<TD>The database extension does not support asynchronous calls<TR>
<TD>rcDBPackNotInited<TD>-813<TD>The <CODE>InitDBPack</CODE> function has not yet been called</TABLE>
</H5>
<A NAME=HEADING516-19></A>
<H5>SEE ALSO</H5>
 For a discussion of data types, see <A HREF=IAC-481.html#MARKER-9-171>"Getting Query Results" beginning on page 12-37</A>. To retrieve all of a query's data items at once, use the high-level function <CODE>DBGetQueryResults</CODE>; a description of that function begins on <A HREF=IAC-500.html#MARKER-9-311>page 12-66</A>. For a description of the asynchronous parameter block, see <A HREF=IAC-489.html#MARKER-9-246>page 12-56</A>. See <A HREF=IAC-479.html#MARKER-9-157>Listing 12-5</A> beginning on <A HREF=IAC-479.html#MARKER-9-157>page 12-34</A> for an example that illustrates the use of the <CODE>DBGetItem</CODE> function. <A NAME=MARKER-2-384></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-515.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-517.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->

</BODY>
</HTML>  

