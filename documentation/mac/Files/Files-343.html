<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Search Strategies (IM: F)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING343></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Files-342.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-344.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Files-2.html"><B>Files</B></A> / <BR><DD><A HREF="Files-340.html"><B>Chapter 4 - Alias Manager</B></A> / <A HREF="Files-341.html"><B>About the Alias Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING343-0></A>
<H2><A NAME=MARKER-9-21></A>Search Strategies</H2>
 <A NAME=MARKER-2-22></A><A NAME=MARKER-2-23></A><A NAME=MARKER-2-76></A>Some of the key features of the Alias Manager are the search strategies built into the alias-resolution functions. The search strategies are designed to find the original target <BR>of an alias record, even if the target has been moved, renamed, copied, or restored from backup. Which strategy you use to resolve a particular alias record usually depends on a number of factors, including whether you are willing to sacrifice time to find as many potential targets as possible and whether the target is known to be in a particular volume. This section describes the available search strategies.<P>
 You can request either a relative or an absolute search. If you request an absolute search, you can specify whether the search should be either fast or exhaustive. (A relative search is always a fast search.) As you can see, there are three general search strategies available to your application for resolving alias records:<P>
<UL>
<LI>relative search (always fast)
<LI>absolute fast search
<LI>absolute exhaustive search<P>
</UL>
 The following sections describe these search strategies.<P>
<A NAME=HEADING343-7></A>
<H3><A NAME=MARKER-9-25></A>Relative Searches<A NAME=MARKER-2-26></A></H3>
 <A NAME=MARKER-2-27></A>During a <B>relative search,</B> the Alias Manager starts in a specified directory and <BR>searches for the target of an alias record by ascending the file system hierarchy to <BR>a predetermined common parent of the target and the starting directory and then descending the hierarchy from that common parent.<A NAME=MARKER-2-72></A><P>
 Suppose, for example, that you are writing a word-processing application that allows the user to build a customized, supplemental dictionary for each document. You might create the dictionary as a separate document in the same directory as the document it serves. In this case, the <B>common parent</B> of the document and the dictionary file (that is, the lowest-level directory that appears in the pathnames of both) is simply the directory containing both files.<P>
 More generally, you might want to store all document-specific dictionary files in their own directory, as illustrated in <A HREF=#MARKER-9-29>Figure 4-1</A>. Here, the common parent of the document file "File 2" and its associated dictionary file "Dict 2" is the directory named "Sample."<P>
<B>Figure 4-1  <A NAME=MARKER-9-29></A>Resolving a relative path</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/AL-01.jpg"> <p>
 To resolve an alias record using a relative search, the Alias Manager needs several pieces of information, which are recorded in the alias record at the time you create it. The Alias Manager needs a relative path, that is, a path to the target from another file or directory on the same volume. (Relative paths don't work across volumes.) To record a relative path, the Alias Manager saves the distances from the target and the starting file or directory to their common parent. The Alias Manager can later use those distances in conjunction with the full pathname to conduct a relative search.<A NAME=MARKER-9-66></A><A NAME=MARKER-2-31></A><A NAME=MARKER-2-32></A><P>
 When resolving the alias record by using a relative path, the Alias Manager looks at the directory at the specified distance above the starting file or directory. The Alias Manager then constructs a partial pathname by extracting one field of the absolute pathname for each step from the target to the common parent. In <A HREF=#MARKER-9-29>Figure 4-1</A>, the distance is 2, so the partial pathname is "Dictionary:Dict 2".<A NAME=MARKER-2-33></A><A NAME=MARKER-2-34></A><P>
<A NAME=HEADING343-15></A>
<H3>Absolute Searches</H3>
 <A NAME=MARKER-2-35></A><A NAME=MARKER-2-36></A>In contrast to a relative search, an <B>absolute search</B> always begins at the root directory <BR>of the file system hierarchy and always descends the hierarchy. The first step in any absolute search is to identify the volume on which the target resides. When conducting a volume search, the Alias Manager considers the volume's name, its creation date (which acts almost as a unique identifier for a volume), and its type (for example, a hard disk, a 3.5-inch floppy disk, or an AppleShare volume).<A NAME=MARKER-9-49></A><A NAME=MARKER-2-74></A><P>
 The Alias Manager first looks for a volume that matches all three criteria: name, creation date, and type. The search succeeds if the volume is mounted and if its name and creation date have not changed since the record was created. If the search fails, the Alias Manager attempts to match by creation date and type only. This step locates volumes that have been renamed. Finally, the Alias Manager attempts to match by volume name and type only.<P>
 If the target is on an unmounted AppleShare volume, the Alias Manager attempts to mount the volume. It presents a name and password dialog box if appropriate. If the target is on an unmounted ejectable volume, the Alias Manager displays a dialog box prompting the user to insert the volume. Your application can suppress the automatic mounting, as explained in the description of the <CODE>MatchAlias</CODE> function on <A HREF=Files-361.html#MARKER-9-106>page 4-20</A>.<P>
<DL>
<DT><B>Note</B>
<DD>Any time that your application needs to resolve a large number of aliases and the resolution of each alias might require user interaction, you should ensure that if the user cancels any of the dialog boxes, all remaining user interaction is canceled as well.<EM></EM><A NAME=MARKER-2-39></A>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 In some circumstances, a relative search identifies the correct target when an absolute search cannot. For example, suppose the user of your word-processing application creates a working copy of a document and dictionary by copying the entire folder <CODE>Sample</CODE> to another disk. The user later updates the original document and dictionary <BR>by copying the folder from the working disk. All of the underlying file and directory identifications change, but the filenames and relative path remain the same. When the user later runs the spelling checker on the document, a relative-path search finds the correct target dictionary.<A NAME=MARKER-2-40></A><A NAME=MARKER-2-41></A><A NAME=MARKER-2-42></A><P>
<A NAME=HEADING343-21></A>
<H3><A NAME=MARKER-9-43></A>Fast Searches</H3>
 A <B>fast search</B> employs an algorithm designed to find the target of an alias record quickly. Depending on how you invoke it, the fast-search algorithm starts with either a relative search or an absolute search. The Alias Manager can perform a relative fast search whether or not it has identified the target volume, but it cannot perform an absolute fast search unless the volume has been identified.<A NAME=MARKER-2-75></A><A NAME=MARKER-2-44></A><A NAME=MARKER-2-125></A><P>
 During an absolute fast search, the Alias Manager first searches by file ID (if the target <BR>is a file) or directory ID (if the target is a directory). (File IDs and directory IDs are described in the chapter "File Manager" in this book.) Even if a file has been renamed <BR>or moved on a volume, the Alias Manager can find it quickly through its file ID.<A NAME=MARKER-2-47></A><A NAME=MARKER-2-48></A><P>
 If the search by file ID or directory ID fails, the Alias Manager searches by name in the original parent directory. This search locates the target if its file or directory ID has changed but it still exists by the same name in the parent directory (for example, if the target was restored from a backup). The Alias Manager compares file numbers of files found by name in the correct parent directory. If the file numbers do not match, the file is treated as a possible match--that is, it is put on the list of candidates--and the search continues. If the target is not found by name in the parent directory, the Alias Manager looks for a file by file number in the parent directory. A file with the same file number but a different name replaces a file with the same name but a different file number in the list of matches.<P>
 If the search by file ID or directory ID fails and if the Alias Manager cannot find the original parent directory, it searches for the target by full pathname. This search succeeds if the target resides in the same location on the volume but the directory ID of its parent directory has changed (for example, if the entire parent directory was restored from <BR>a backup).<P>
 If the search by full pathname fails, the Alias Manager attempts to find the file by tracing partial pathnames up through all parent directories, using parent directory IDs instead of directory names. For example, consider this full pathname:<P>
<PRE>
MyDisk:Fruits:Tropical:Ackees
</PRE>
 If the search by full pathname fails, Alias Manager first looks for the partial pathname ":Ackees" in the directory with the ID that the directory "MyDisk:Fruits:Tropical" had when the alias record was created. If that search fails, it looks for ":Tropical:Ackees" in the directory with the ID that "MyDisk:Fruits" had, and so on.<P>
 If you do not ask for a search by relative path first but do provide a starting point for a relative search, and if the alias record contains relative path information, the Alias Manager performs a relative search after the absolute search. The relative search succeeds if the relative path is the same as when the record was created and if the names of the target and its intervening parent directories have not changed.<A NAME=MARKER-2-49></A><A NAME=MARKER-2-50></A><P>
<A NAME=HEADING343-30></A>
<H3>Exhaustive Searches</H3>
 <A NAME=MARKER-2-51></A>An <B>exhaustive search</B> uses an algorithm that scans an entire volume to look for possible matches. The Alias Manager typically performs an exhaustive search by calling the File Manager function <CODE>PBCatSearch</CODE>, searching for files or directories with a matching creation date, creator, and type. (See the chapter "File Manager" in this book for a description of <CODE>PBCatSearch</CODE>.)<A NAME=MARKER-2-52></A><A NAME=MARKER-2-53></A><A NAME=MARKER-2-54></A><P>
 The <CODE>PBCatSearch</CODE> function is available only on volumes that support the HFS routines and only on systems running system software version 7.0 and later. When <CODE>PBCatSearch</CODE> is not available, an exhaustive search of the entire volume is performed by making a series of indexed File Manager calls, searching for objects with matching creation date, type, creator, or file number.<A NAME=MARKER-2-55></A><A NAME=MARKER-2-56></A><A NAME=MARKER-2-57></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Files-342.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-344.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Files-3.html">&copy; Apple Computer, Inc.</A><br>2 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
