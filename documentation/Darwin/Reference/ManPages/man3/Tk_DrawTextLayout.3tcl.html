<html><head><title>Mac OS X
 Manual Page For Tk_DrawTextLayout(3tcl)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/3tcl/Tk_DrawTextLayout" title="Mac OS X
 Manual Page for Tk_DrawTextLayout(3tcl)"><a name="//apple_ref/doc/man/3/Tk_DrawTextLayout" title="Mac OS X
 Manual Page for Tk_DrawTextLayout(3tcl)"><!-- headerDoc=man; indexgroup=Section 3tcl; uid="//apple_ref/doc/man/3tcl/Tk_DrawTextLayout"; name=Tk_DrawTextLayout(3tcl) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
Tk_ComputeTextLayout(3)                     Tk Library Procedures                    <a href="Tk_ComputeTextLayout.3tcl.html#//apple_ref/doc/man/3/Tk_ComputeTextLayout">Tk_ComputeTextLayout(3)</a>



____________________________________________________________________________________________________________

<b>NAME</b>
       Tk_ComputeTextLayout,  Tk_FreeTextLayout,  Tk_DrawTextLayout, Tk_UnderlineTextLayout, Tk_PointToChar,
       Tk_CharBbox, Tk_DistanceToTextLayout, Tk_IntersectTextLayout, Tk_TextLayoutToPostscript - routines to
       measure and display single-font, multi-line, justified text.

<b>SYNOPSIS</b>
       <b>#include</b> <b>&lt;tk.h&gt;</b>

       Tk_TextLayout
       <b>Tk_ComputeTextLayout(</b><u>tkfont,</u> <u>string,</u> <u>numChars,</u> <u>wrapLength,</u> <u>justify,</u> <u>flags,</u> <u>widthPtr,</u> <u>heightPtr</u><b>)</b>

       void
       <b>Tk_FreeTextLayout(</b><u>layout</u><b>)</b>

       void
       <b>Tk_DrawTextLayout(</b><u>display,</u> <u>drawable,</u> <u>gc,</u> <u>layout,</u> <u>x,</u> <u>y,</u> <u>firstChar,</u> <u>lastChar</u><b>)</b>

       void
       <b>Tk_UnderlineTextLayout(</b><u>display,</u> <u>drawable,</u> <u>gc,</u> <u>layout,</u> <u>x,</u> <u>y,</u> <u>underline</u><b>)</b>

       int
       <b>Tk_PointToChar(</b><u>layout,</u> <u>x,</u> <u>y</u><b>)</b>

       int
       <b>Tk_CharBbox(</b><u>layout,</u> <u>index,</u> <u>xPtr,</u> <u>yPtr,</u> <u>widthPtr,</u> <u>heightPtr</u><b>)</b>

       int
       <b>Tk_DistanceToTextLayout(</b><u>layout,</u> <u>x,</u> <u>y</u><b>)</b>

       int
       <b>Tk_IntersectTextLayout(</b><u>layout,</u> <u>x,</u> <u>y,</u> <u>width,</u> <u>height</u><b>)</b>

       void
       <b>Tk_TextLayoutToPostscript(</b><u>interp,</u> <u>layout</u><b>)</b>


<b>ARGUMENTS</b>
       Tk_Font         <u>tkfont</u>         (in)      Font  to use when constructing and displaying a text layout.
                                                The <u>tkfont</u> must remain valid for the lifetime  of  the  text
                                                layout.   Must  have  been  returned  by  a previous call to
                                                <b>Tk_GetFont</b>.

       const char      <u>*string</u>        (in)      Potentially multi-line string whose  dimensions  are  to  be
                                                computed  and  stored  in  the text layout.  The <u>string</u> must
                                                remain valid for the lifetime of the text layout.

       int             <u>numChars</u>       (in)      The number of characters to consider from <u>string</u>.   If  <u>num</u>-<font color="#ffffff" class="whiteout">Chars&nbsp;numChars</font>
                                                <u>Chars</u> is less than 0, then assumes <u>string</u> is null terminated |
                                                and uses <b>Tcl_NumUtfChars</b> to determine the length of  <u>string</u>.

       int             <u>wrapLength</u>     (in)      Longest permissible line length, in pixels.  Lines in <u>string</u>
                                                will automatically be broken at word boundaries and  wrapped
                                                when they reach this length.  If <u>wrapLength</u> is too small for
                                                even a single character  to  fit  on  a  line,  it  will  be
                                                expanded  to  allow  one  character to fit on each line.  If
                                                <u>wrapLength</u> is &lt;= 0, there is no  automatic  wrapping;  lines
                                                will  get as long as they need to be and only wrap if a new-
                                                line/return character is encountered.

       Tk_Justify      <u>justify</u>        (in)      How to justify the lines in a multi-line text layout.   Pos-<font color="#ffffff" class="whiteout">sible&nbsp;Possible</font>
                                                sible  values  are  TK_JUSTIFY_LEFT,  TK_JUSTIFY_CENTER,  or
                                                TK_JUSTIFY_RIGHT.  If the text layout only occupies a single
                                                line, then <u>justify</u> is irrelevant.

       int             <u>flags</u>          (in)      Various flag bits OR-ed together.  TK_IGNORE_TABS means that
                                                tab characters should not be expanded to the next tab  stop.
                                                TK_IGNORE_NEWLINES   means  that  newline/return  characters
                                                should not cause a line  break.   If  either  tabs  or  new-<font color="#ffffff" class="whiteout">lines/returns&nbsp;newlines/returns</font>
                                                lines/returns are ignored, then they will be treated as reg-<font color="#ffffff" class="whiteout">ular&nbsp;regular</font>
                                                ular characters, being measured and displayed in a platform-<font color="#ffffff" class="whiteout">dependent&nbsp;platformdependent</font>
                                                dependent  manner  as described in <b>Tk_MeasureChars</b>, and will
                                                not have any special behaviors.

       int             <u>*widthPtr</u>      (out)     If non-NULL, filled with either the width, in pixels, of the
                                                widest  line in the text layout, or the width, in pixels, of
                                                the bounding box for the character specified by <u>index</u>.

       int             <u>*heightPtr</u>     (out)     If non-NULL, filled with either the total height, in pixels,
                                                of  all the lines in the text layout, or the height, in pix-<font color="#ffffff" class="whiteout">els,&nbsp;pixels,</font>
                                                els, of the bounding box  for  the  character  specified  by
                                                <u>index</u>.

       Tk_TextLayout   <u>layout</u>         (in)      A  token that represents the cached layout information about
                                                the single-font, multi-line, justified piece of text.   This
                                                token is returned by <b>Tk_ComputeTextLayout</b>.

       Display         <u>*display</u>       (in)      Display on which to draw.

       Drawable        <u>drawable</u>       (in)      Window or pixmap in which to draw.

       GC              <u>gc</u>             (in)      Graphics  context  to use for drawing text layout.  The font
                                                selected in this GC must correspond to the <u>tkfont</u> used  when
                                                constructing the text layout.

       int             <u>x,</u> <u>y</u>           (in)      Point, in pixels, at which to place the upper-left hand cor-<font color="#ffffff" class="whiteout">ner&nbsp;corner</font>
                                                ner of the text layout when it is being drawn, or the  coor-<font color="#ffffff" class="whiteout">dinates&nbsp;coordinates</font>
                                                dinates of a point (with respect to the upper-left hand cor-<font color="#ffffff" class="whiteout">ner&nbsp;corner</font>
                                                ner of the text layout) to check against the text layout.

       int             <u>firstChar</u>      (in)      The index of the first character to draw from the given text
                                                layout.  The number 0 means to draw from the beginning.

       int             <u>lastChar</u>       (in)      The  index  of  the last character up to which to draw.  The
                                                character specified by <u>lastChar</u> itself will not be drawn.  A
                                                number  less than 0 means to draw all characters in the text
                                                layout.

       int             <u>underline</u>      (in)      Index of the single character to underline in the text  lay-<font color="#ffffff" class="whiteout">out,&nbsp;layout,</font>
                                                out, or a number less than 0 for no underline.

       int             <u>index</u>          (in)      The  index  of  the character whose bounding box is desired.
                                                The bounding box is computed with respect to the  upper-left
                                                hand corner of the text layout.

       int             <u>*xPtr,</u> <u>*yPtr</u>   (out)     Filled  with  the  upper-left hand corner, in pixels, of the
                                                bounding box for the character specified by  <u>index</u>.   Either
                                                or  both <u>xPtr</u> and <u>yPtr</u> may be NULL, in which case the corre-<font color="#ffffff" class="whiteout">sponding&nbsp;corresponding</font>
                                                sponding value is not calculated.

       int             <u>width,</u> <u>height</u>  (in)      Specifies the width and height, in pixels, of the  rectangu-<font color="#ffffff" class="whiteout">lar&nbsp;rectangular</font>
                                                lar  area  to compare for intersection against the text lay-<font color="#ffffff" class="whiteout">out.&nbsp;layout.</font>
                                                out.

       Tcl_Interp      <u>*interp</u>        (out)     Postscript code that will print the text layout is  appended
                                                to <u>interp-&gt;result</u>.
____________________________________________________________________________________________________________


<b>DESCRIPTION</b>
       These  routines are for measuring and displaying single-font, multi-line, justified text.  To measure
       and display simple single-font, single-line strings, refer to the documentation for  <b>Tk_MeasureChars</b>.
       There  is  no programming interface in the core of Tk that supports multi-font, multi-line text; sup-<font color="#ffffff" class="whiteout">port&nbsp;support</font>
       port for that behavior must be built on top of simpler layers.  Note that unlike the lower level text |
       display  routines, the functions described here all operate on character-oriented lengths and indices |
       rather than byte-oriented values.  See the description of <b>Tcl_UtfAtIndex</b> for more details on convert- |
       ing between character and byte offsets.

       The  routines  described  here are built on top of the programming interface described in the <b>Tk_Mea</b>-<font color="#ffffff" class="whiteout">sureChars&nbsp;Tk_MeasureChars</font>
       <b>sureChars</b> documentation.  Tab characters and newline/return characters may be  treated  specially  by
       these procedures, but all other characters are passed through to the lower level.

       <b>Tk_ComputeTextLayout</b>  computes  the  layout  information needed to display a single-font, multi-line,
       justified <u>string</u> of text and returns a Tk_TextLayout token that holds this information.   This  token
       is  used  in  subsequent  calls to procedures such as <b>Tk_DrawTextLayout</b>, <b>Tk_DistanceToTextLayout</b>, and
       <b>Tk_FreeTextLayout</b>.  The <u>string</u> and <u>tkfont</u> used when computing the layout must remain  valid  for  the
       lifetime of this token.

       <b>Tk_FreeTextLayout</b>  is  called  to  release  the  storage  associated with <u>layout</u> when it is no longer
       needed.  A <u>layout</u> should not be used in any other text layout procedures once it has been released.

       <b>Tk_DrawTextLayout</b> uses the information in <u>layout</u> to  display  a  single-font,  multi-line,  justified
       string of text at the specified location.

       <b>Tk_UnderlineTextLayout</b>  uses  the  information  in <u>layout</u> to display an underline below an individual
       character.  This procedure does not draw the text, just the underline.  To  produce  natively  under-<font color="#ffffff" class="whiteout">lined&nbsp;underlined</font>
       lined  text, an underlined font should be constructed and used.  All characters, including tabs, new-<font color="#ffffff" class="whiteout">line/return&nbsp;newline/return</font>
       line/return characters, and spaces at the ends of lines, can be underlined using this  method.   How-<font color="#ffffff" class="whiteout">ever,&nbsp;However,</font>
       ever,  the  underline will never be drawn outside of the computed width of <u>layout</u>; the underline will
       stop at the edge for any character that would extend partially outside of <u>layout</u>, and  the  underline
       will  not be visible at all for any character that would be located completely outside of the layout.

       <b>Tk_PointToChar</b> uses the information in <u>layout</u> to determine the character closest to the given  point.
       The  point is specified with respect to the upper-left hand corner of the <u>layout</u>, which is considered
       to be located at (0, 0).  Any point whose <u>y</u>-value is less that 0 will be considered  closest  to  the
       first  character  in  the text layout; any point whose <u>y</u>-value is greater than the height of the text
       layout will be considered closest to the last character in the text layout.  Any point whose  <u>x</u>-value
       is  less  than  0  will be considered closest to the first character on that line; any point whose <u>x</u>-<font color="#ffffff" class="whiteout">value&nbsp;xvalue</font>
       value is greater than the width of the text layout will be considered closest to the  last  character
       on that line.  The return value is the index of the character that was closest to the point.  Given a
       <u>layout</u> with no characters, the value 0 will always be returned, referring  to  a  hypothetical  zero-<font color="#ffffff" class="whiteout">width&nbsp;zerowidth</font>
       width placeholder character.

       <b>Tk_CharBbox</b>  uses the information in <u>layout</u> to return the bounding box for the character specified by
       <u>index</u>.  The width of the bounding box is the advance width of the character, and does not include any
       left  or  right  bearing.  Any character that extends partially outside of <u>layout</u> is considered to be
       truncated at the edge.  Any character that would be located completely outside of <u>layout</u>  is  consid-<font color="#ffffff" class="whiteout">ered&nbsp;considered</font>
       ered to be zero-width and pegged against the edge.  The height of the bounding box is the line height
       for this font, extending from the top of the ascent to the bottom of the descent;  information  about
       the  actual  height  of individual letters is not available.  For measurement purposes, a <u>layout</u> that
       contains no characters is considered to contain a single zero-width placeholder character at index 0.
       If  <u>index</u>  was  not  a  valid character index, the return value is 0 and <u>*xPtr</u>, <u>*yPtr</u>, <u>*widthPtr</u>, and
       <u>*heightPtr</u> are unmodified.  Otherwise, if <u>index</u> did specify a valid, the return  value  is  non-zero,
       and  <u>*xPtr</u>,  <u>*yPtr</u>,  <u>*widthPtr</u>,  and  <u>*heightPtr</u> are filled with the bounding box information for the
       character.  If any of <u>xPtr</u>, <u>yPtr</u>, <u>widthPtr</u>, or <u>heightPtr</u> are NULL, the  corresponding  value  is  not
       calculated or stored.

       <b>Tk_DistanceToTextLayout</b>  computes  the shortest distance in pixels from the given point (<u>x,</u> <u>y</u>) to the
       characters in <u>layout</u>.  Newline/return characters and non-displaying space characters  that  occur  at
       the  end of individual lines in the text layout are ignored for hit detection purposes, but tab char-<font color="#ffffff" class="whiteout">acters&nbsp;characters</font>
       acters are not.  The return value is 0 if the point actually hits the <u>layout</u>.  If  the  point  didn't
       hit the <u>layout</u> then the return value is the distance in pixels from the point to the <u>layout</u>.

       <b>Tk_IntersectTextLayout</b>  determines  whether a <u>layout</u> lies entirely inside, entirely outside, or over-<font color="#ffffff" class="whiteout">laps&nbsp;overlaps</font>
       laps a given rectangle.  Newline/return characters and non-displaying space characters that occur  at
       the  end  of  individual  lines  in the <u>layout</u> are ignored for intersection calculations.  The return
       value is -1 if the <u>layout</u> is entirely outside of the rectangle, 0 if it overlaps,  and  1  if  it  is
       entirely inside of the rectangle.

       <b>Tk_TextLayoutToPostscript</b> outputs code consisting of a Postscript array of strings that represent the
       individual lines in <u>layout</u>.  It is the responsibility of the caller to take the Postscript  array  of
       strings  and add some Postscript function operate on the array to render each of the lines.  The code
       that represents the Postscript array of strings is appended to <u>interp-&gt;result</u>.


<b>DISPLAY</b> <b>MODEL</b>
       When measuring a text layout, space characters that occur at the end of  a  line  are  ignored.   The
       space  characters still exist and the insertion point can be positioned amongst them, but their addi-<font color="#ffffff" class="whiteout">tional&nbsp;additional</font>
       tional width is ignored when justifying lines or returning the total width of  a  text  layout.   All
       end-of-line space characters are considered to be attached to the right edge of the line; this behav-<font color="#ffffff" class="whiteout">ior&nbsp;behavior</font>
       ior is logical for left-justified text and reasonable for center-justified text, but not very  useful
       when  editing right-justified text.  Spaces are considered variable width characters; the first space
       that extends past the edge of the text layout is clipped to the edge, and any  subsequent  spaces  on
       the  line  are considered zero width and pegged against the edge.  Space characters that occur in the
       middle of a line of text are not suppressed and occupy their normal space width.

       Tab characters are not ignored for measurement calculations.  If wrapping is turned on and there  are
       enough tabs on a line, the next tab will wrap to the beginning of the next line.  There are some pos-<font color="#ffffff" class="whiteout">sible&nbsp;possible</font>
       sible strange interactions between tabs and justification; tab positions are calculated and the  line
       length computed in a left-justified world, and then the whole resulting line is shifted so it is cen-<font color="#ffffff" class="whiteout">tered&nbsp;centered</font>
       tered or right-justified, causing the tab columns not to align any more.

       When wrapping is turned on, lines may  wrap  at  word  breaks  (space  or  tab  characters)  or  new-<font color="#ffffff" class="whiteout">line/returns.&nbsp;newline/returns.</font>
       line/returns.   A  dash  or  hyphen character in the middle of a word is not considered a word break.
       <b>Tk_ComputeTextLayout</b> always attempts to place at least one word on each line.  If it  cannot  because
       the  <u>wrapLength</u>  is too small, the word will be broken and as much as fits placed on the line and the
       rest on subsequent <!-- a -->line(s)<!-- /a -->.  If <u>wrapLength</u> is so small that not even one character can fit on a given
       line,  the  <u>wrapLength</u>  is ignored for that line and one character will be placed on the line anyhow.
       When wrapping is turned off, only newline/return characters may cause a line break.

       When a text layout has been created using an underlined <u>tkfont</u>, then any space characters that  occur
       at  the  end  of  individual  lines, newlines/returns, and tabs will not be displayed underlined when
       <b>Tk_DrawTextLayout</b> is called, because those characters are never actually  drawn  -  they  are  merely
       placeholders maintained in the <u>layout</u>.

<b>KEYWORDS</b>
       font



Tk                                                   8.1                             <a href="Tk_ComputeTextLayout.3tcl.html#//apple_ref/doc/man/3/Tk_ComputeTextLayout">Tk_ComputeTextLayout(3)</a>
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man3/Tk_DrawTextLayout.3tcl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man3/Tk_DrawTextLayout.3tcl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man3/Tk_DrawTextLayout.3tcl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
