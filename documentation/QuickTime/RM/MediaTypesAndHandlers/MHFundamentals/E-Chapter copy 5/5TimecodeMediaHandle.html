<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>QuickTime Media Types and Media Handlers Guide: Timecode Media Handlers</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Timecode Media Handlers"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40000899-TimecodeMediaHandlers" title="Timecode Media Handlers"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000433" target="_top">QuickTime</a> &gt; <a href="../../../../MediaTypesMediaHandlers-date.html#//apple_ref/doc/uid/TP30000440-TP30000433-TP30000543" target="_top">Media Types &amp; Media Handlers</a> &gt; <a href="../A-Intro/1Introduction.html#//apple_ref/doc/uid/TP40000899-IntroductiontoQuickTimeMediaTypesandMediaHandlersGuide-DontLinkElementID_81">QuickTime Media Types and Media Handlers Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../D-Chapter/4TextMediaHandlers.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../F-Chapter copy 4/6TweensandTweenOpera.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40000899-TimecodeMediaHandlers-SW1" title="Timecode Media Handlers"></a>
<h1>Timecode Media Handlers</h1>

<p>Timecode media handlers allow QuickTime movies to store timing information derived from the movie&#8217;s original source material, such as SMPTE timecodes, as distinct from the time base data which is a part of any QuickTime movie.</p>
<p>Every QuickTime movie contains QuickTime-specific timing information, such as frame duration. This information affects how QuickTime interprets and plays the movie. The timecode media handler allows QuickTime movies to store additional timing information that is not created by or for QuickTime. This additional timing information would typically be derived from the original source material; for example, as a SMPTE timecode. In essence, you can think of the timecode media handler as providing a link between the &#8220;digital&#8221; QuickTime-specific timing information and the original &#8220;analog&#8221; timing information from the source material.</p>



<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="5TimecodeMediaHandle.html#//apple_ref/doc/uid/TP40000899-TimecodeMediaHandlers-DontLinkElementID_13">Timecode Tracks</a>
				
			<br/>
			
        
			
			
				<a href="5TimecodeMediaHandle.html#//apple_ref/doc/uid/TP40000899-TimecodeMediaHandlers-DontLinkElementID_14">Timecode Samples</a>
				
			<br/>
			
        
			
			
				<a href="5TimecodeMediaHandle.html#//apple_ref/doc/uid/TP40000899-TimecodeMediaHandlers-DontLinkElementID_15">Timecode Media Handler Functions</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40000899-TimecodeMediaHandlers-DontLinkElementID_13" title="Timecode Tracks"></a>
<h2><a name="//apple_ref/doc/uid/TP40000899-TimecodeMediaHandlers-TimecodeTracks" title="Timecode Tracks"></a>Timecode Tracks</h2>
<p>A movie&#8217;s timecode is stored in a timecode track. Timecode tracks contain</p>
<ul class="ul">
<li class="li"><p>source identification information (this identifies the source; for example, a given videotape)</p></li>
<li class="li"><p>timecode format information (this specifies the characteristics of the timecode and how to interpret the timecode information)</p></li>
<li class="li"><p>frame numbers (these allow QuickTime to map from a given movie time, in terms of QuickTime time values, to its corresponding timecode value)</p></li>
</ul>
<p>Apple Computer has defined the information that is stored in the track in a manner that is independent of any specific timecode standard. The format of this information is sufficiently flexible to accommodate all known timecode standards, including SMPTE timecoding. The timecode format information provides QuickTime the parameters for understanding the timecode and converting QuickTime time values into timecode time values (and vice versa).</p>
<p>One key timecode attribute relates to the technique used to synchronize timecode values with video frames. Most video source material is recorded at whole-number frame rates. For example, both PAL and SECAM video contain exactly 25 frames per second. However, some video source material is not recorded at whole-number frame rates. In particular, NTSC color video contains 29.97 frames per second (though it is typically referred to as 30 frames-per-second video). However, NTSC timecode values correspond to the full 30 frames-per-second rate; this is a holdover from NTSC black-and-white video. For such video sources, you need a mechanism that corrects the error that will develop over time between timecode values and actual video frames.</p>
<p>A common method for maintaining synchronization between timecode values and video data is called <strong>dropframe.</strong> Contrary to its name, the dropframe technique actually skips timecode values at a predetermined rate in order to keep the timecode and video data synchronized. It does not actually drop video frames. In NTSC color video, which uses the dropframe technique, the timecode values skip two frame values every minute, except for minute values that are evenly divisible by ten. So NTSC timecode values, which are expressed as HH:MM:SS:FF (hours, minutes, seconds, frames) skip from 00:00:59:29 to 00:01:00:02 (skipping 00:01:00:00 and 00:01:00:01). There is a flag in the timecode definition structure that indicates whether the timecode uses the dropframe technique.</p>
<p>You can make QuickTime display the timecode when a movie is played. Use the <code><a href="../../../../Reference/QTRef_MovieComponents/Reference/reference.html#//apple_ref/c/func/TCSetTimeCodeFlags" target="_top">TCSetTimeCodeFlags</a></code> function to turn the timecode display on and off. Note that the timecode track must be enabled for this display to work.</p>
<p>You store the timecode&#8217;s source identification information in a user data item. Create a user data item with a type value of <code>TCSourceRefNameType</code>. Store the source information as a text string. This information might contain the name of the videotape from which the movie was created, for example.</p>
<p>The timecode media handler provides functions that allow you to manipulate the source identification information. The following sample code demonstrates one way to set the source tape name in a timecode media&#8217;s sample description.</p>

<div class="codesample"><table><tr><td scope="row"><pre>void setTimeCodeSourceName (Media timeCodeMedia,<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;TimeCodeDescriptionHandle tcdH, <span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Str255 tapeName, ScriptCode tapeNameScript)  <span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;UserData srcRef;<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;if (NewUserData(&#38;srcRef) == noErr) {<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Handle nameHandle;<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (PtrToHand(&#38;tapeName[1], &#38;nameHandle, tapeName[0]) == noErr) {<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (AddUserDataText (srcRef, nameHandle,'name', 1,<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;tapeNameScript) == noErr) { <span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;TCSetSourceRef (GetMediaHandler (timeCodeMedia),<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;tcdH, <span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;srcRef); <span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;DisposeHandle(nameHandle);<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;DisposeUserData(srcRef);<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;}<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div>

<p>You can create a timecode track and media in the same manner that you create any other track. Call the <code><a href="../../../../Reference/QTRef_TrackAndMedia/Reference/reference.html#//apple_ref/c/func/NewMovieTrack" target="_top">NewMovieTrack</a></code> function to create the timecode track, and use the <code><a href="../../../../Reference/QTRef_TrackAndMedia/Reference/reference.html#//apple_ref/c/func/NewTrackMedia" target="_top">NewTrackMedia</a></code> function to create the track&#8217;s media. Be sure to specify a media type value of <code>TimeCodeMediaType</code> when you call the <code><a href="../../../../Reference/QTRef_TrackAndMedia/Reference/reference.html#//apple_ref/c/func/NewTrackMedia" target="_top">NewTrackMedia</a></code> function.</p>
<p>You can define the relationship between a timecode track and one or more movie tracks using the toolbox&#8217;s new track reference functions. You then proceed to add samples to the track, as appropriate.</p>

<a name="//apple_ref/doc/uid/TP40000899-TimecodeMediaHandlers-DontLinkElementID_14" title="Timecode Samples"></a>
<h2><a name="//apple_ref/doc/uid/TP40000899-TimecodeMediaHandlers-TimecodeSamples" title="Timecode Samples"></a>Timecode Samples</h2>
<p>Each sample in the timecode track provides timecode information for a span of movie time. The sample includes duration information. As a result, you typically add each timecode sample after you have created the corresponding content track or tracks.</p>
<p>The timecode media sample description contains the control information that allows QuickTime to interpret the samples. This includes the timecode format information. The actual sample data contains a frame number that identifies one or more content frames that use this timecode. Stored as a <code>long</code>, this value identifies the first frame in the group of frames that use this timecode. In the case of a movie made from source material that contains no edits, you would only need one sample. When the source material contains edits, you typically need one sample for each edit, so that QuickTime can resynchronize the timecode information with the movie. Those samples contain the frame numbers of the frames that begin each new group of frames.</p>
<p>The timecode description structure defines the format and content of a timecode media sample description, as follows:</p>

<div class="codesample"><table><tr><td scope="row"><pre>typedef struct TimeCodeDescription {<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;long&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;descSize;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* size of the structure */ <span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;long&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;dataFormat;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* sample type */ <span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;long&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;resvd1;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* reserved--set to 0 */ <span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;short&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;resvd2;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* reserved--set to 0 */ <span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;short&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;dataRefIndex;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* data reference index */ <span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;long&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;flags;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* reserved--set to 0 */ <span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;TimeCodeDef&#160;timeCodeDef;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* timecode format information */<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;long&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;srcRef[1];&#160;&#160;&#160;&#160;&#160;&#160;/* source information */<span></span></pre></td></tr><tr><td scope="row"><pre>} TimeCodeDescription, *TimeCodeDescriptionPtr, **TimeCodeDescriptionHandle;<span></span></pre></td></tr></table></div>

<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Term</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Definition</p></th>
</tr>


<tr>
<td  scope="row"><p><code>descSize</code></p></td>
<td ><p>Specifies the size of the sample description, in bytes.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>dataFormat</code></p></td>
<td ><p>Indicates the sample description type (<code>TimeCodeMediaType</code>).</p></td>
</tr>
<tr>
<td  scope="row"><p><code>resvd1</code></p></td>
<td ><p>Reserved for use by Apple. Set this field to 0.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>resvd2</code></p></td>
<td ><p>Reserved for use by Apple. Set this field to 0.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>dataRefIndex</code></p></td>
<td ><p>Contains an index value indicating which of the media's data references contains the sample data for this sample description.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>flags</code></p></td>
<td ><p>Reserved for use by Apple. Set this field to 0.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>timeCodeDef</code></p></td>
<td ><p>Contains a timecode definition structure that defines timecode format information.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>srcRef</code></p></td>
<td ><p>Contains the timecode's source information. This is formatted as a user data item that is stored in the sample description. The media handler provides functions that allow you to get and set this data.</p></td>
</tr>

</table></div>
<p>The timecode definition structure contains the timecode format information. This structure is defined as follows:</p>

<div class="codesample"><table><tr><td scope="row"><pre>typedef struct TimeCodeDef {<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;long&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;flags;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* timecode control flags */ <span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;TimeScale&#160;&#160;&#160;&#160;&#160;&#160;&#160;fTimeScale;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* timecode's time scale */<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;TimeValue&#160;&#160;&#160;&#160;&#160;&#160;&#160;frameDuration;&#160;&#160;&#160;&#160;&#160;&#160;/* how long each frame lasts */<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;unsigned char&#160;&#160;&#160;numFrames;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* number of frames per second */<span></span></pre></td></tr><tr><td scope="row"><pre>} TimeCodeDef;<span></span></pre></td></tr></table></div>

<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Term</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Definition</p></th>
</tr>


<tr>
<td  scope="row"><p><code>flags</code></p></td>
<td ><p>Contains flags that provide some timecode format information.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>fTimeScale</code></p></td>
<td ><p>Contains the time scale for interpreting the <code>frameDuration</code> field. This field indicates the number of time units per second.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>frameDuration</code></p></td>
<td ><p>Specifies how long each frame lasts, in the units defined by the <code>fTimeScale</code> field.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>numFrames</code></p></td>
<td ><p>Indicates the number of frames stored per second. In the case of timecodes that are interpreted as counters, this field indicates the number of frames stored per timer "tick".</p></td>
</tr>

</table></div>
<p>The following flags are defined in the <code>flags</code> parameter:</p>
<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Term</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Definition</p></th>
</tr>


<tr>
<td  scope="row"><p><code>tcDropFrame</code></p></td>
<td ><p>Indicates that the timecode "drops" frames occasionally in order to stay in synchronization. Some timecodes run at other than a whole number of frames per second. For example, NTSC video runs at 29.97 frames per second. In order to resynchronize between the timecode rate and a 30 frames-per-second playback rate, the timecode drops a frame at a predictable time (in much the same way that leap years keep the calendar synchronized). Set this flag to 1 if the timecode uses the dropframe technique.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>tc24HourMax</code></p></td>
<td ><p>Indicates that the timecode values wrap at 24 hours. Set this flag to 1 if the timecode hour value wraps (that is, returns to 0) at 24 hours.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>tcNegTimesOK</code></p></td>
<td ><p>Indicates that the timecode supports negative time values. Set this flag to 1 if the timecode allows negative values.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>tcCounter</code></p></td>
<td ><p>Indicates that the timecode should be interpreted as a simple counter, rather than as a time value. This allows the timecode to contain either time information or counter (such as a tape counter) information. Set this flag to 1 if the timecode contains counter information.</p></td>
</tr>

</table></div>
<p>The best way to understand how to format and interpret the timecode definition structure is to consider an example. If you were creating a movie from an NTSC video source recorded at 29.97 frames per second, using SMPTE timecodes, you would format the timecode definition structure as follows:</p>

<div class="codesample"><table><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;TimeCodeDef.flags = tcDropFrame | tc24HourMax;<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;TimeCodeDef.fTimeScale = 2997;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* units */<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;TimeCodeDef.frameDuration = 100;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* relates units to frames */<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;TimeCodeDef.numFrames = 30;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* whole frames per second */<span></span></pre></td></tr></table></div>

<p>The movie&#8217;s natural frame rate of 29.97 frames per second is obtained by dividing the <code>fTimeScale</code> value by the <code>frameDuration</code> (2997 / 100). Note that the <code>flags</code> field indicates that the timecode uses the dropframe technique to resync the movie&#8217;s natural frame rate of 29.97 frames per second with its playback rate of 30 frames per second.</p>
<p>Given a timecode definition, you can freely convert from frame numbers to time values and from time values to frame numbers. For a time value of 00:00:12:15 (HH:MM:SS:FF), you would obtain a frame number of 375 ((12*30) + 15). The timecode media handler provides a number of functions that allow you to perform these conversions.</p>
<p>When you use the timecode media handler to work with time values, the media handler uses timecode records to store the time values. The timecode record allows you to interpret the time information as either a time value (HH:MM:SS:FF) or a counter value. The timecode record is defined as follows:</p>

<div class="codesample"><table><tr><td scope="row"><pre>typedef union TimeCodeRecord {<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;TimeCodeTime&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;t;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* value interpreted as time */<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;TimeCodeCounter&#160;&#160;&#160;&#160;&#160;c;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;/* value interpreted as counter */<span></span></pre></td></tr><tr><td scope="row"><pre>} TimeCodeRecord;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>typedef struct TimeCodeTime {<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;unsigned char&#160;&#160;&#160;&#160;&#160;&#160;&#160;hours;&#160;&#160;&#160;&#160;&#160;&#160;/* time: hours */<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;unsigned char&#160;&#160;&#160;&#160;&#160;&#160;&#160;minutes;&#160;&#160;&#160;&#160;/* time: minutes */<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;unsigned char&#160;&#160;&#160;&#160;&#160;&#160;&#160;seconds;&#160;&#160;&#160;&#160;/* time: seconds */<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;unsigned char&#160;&#160;&#160;&#160;&#160;&#160;&#160;frames;&#160;&#160;&#160;&#160;&#160;/* time: frames */<span></span></pre></td></tr><tr><td scope="row"><pre>} TimeCodeTime;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>typedef struct TimeCodeCounter {<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;long&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;counter;&#160;&#160;&#160;&#160;/* counter value */<span></span></pre></td></tr><tr><td scope="row"><pre>} TimeCodeCounter;<span></span></pre></td></tr></table></div>

<p>When you are working with timecodes that allow negative time values, the <code>minutes</code> field of the <code><!--a target="_top" -->TimeCodeTime<!--/a--></code> structure (<code>TimeCodeRecord</code>.<code>t</code>.<code>minutes</code>) indicates whether the time value is positive or negative. If the <code>tctNegFlag</code> bit of the <code>minutes</code> field is set to 1, the time value is negative.</p>

<a name="//apple_ref/doc/uid/TP40000899-TimecodeMediaHandlers-DontLinkElementID_15" title="Timecode Media Handler Functions"></a>
<h2><a name="//apple_ref/doc/uid/TP40000899-TimecodeMediaHandlers-TimecodeMediaHandlerFunctions" title="Timecode Media Handler Functions"></a>Timecode Media Handler Functions</h2>
<p>The following functions are specific to the timecode media handler:</p>
<ul class="ul">
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieComponents/Reference/reference.html#//apple_ref/c/func/TCGetCurrentTimeCode" target="_top">TCGetCurrentTimeCode</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieComponents/Reference/reference.html#//apple_ref/c/func/TCGetTimeCodeAtTime" target="_top">TCGetTimeCodeAtTime</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieComponents/Reference/reference.html#//apple_ref/c/func/TCTimeCodeToFrameNumber" target="_top">TCTimeCodeToFrameNumber</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieComponents/Reference/reference.html#//apple_ref/c/func/TCFrameNumberToTimeCode" target="_top">TCFrameNumberToTimeCode</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieComponents/Reference/reference.html#//apple_ref/c/func/TCTimeCodeToString" target="_top">TCTimeCodeToString</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieComponents/Reference/reference.html#//apple_ref/c/func/TCSetSourceRef" target="_top">TCSetSourceRef</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieComponents/Reference/reference.html#//apple_ref/c/func/TCGetSourceRef" target="_top">TCGetSourceRef</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieComponents/Reference/reference.html#//apple_ref/c/func/TCSetTimeCodeFlags" target="_top">TCSetTimeCodeFlags</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieComponents/Reference/reference.html#//apple_ref/c/func/TCGetTimeCodeFlags" target="_top">TCGetTimeCodeFlags</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieComponents/Reference/reference.html#//apple_ref/c/func/TCSetDisplayOptions" target="_top">TCSetDisplayOptions</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieComponents/Reference/reference.html#//apple_ref/c/func/TCGetDisplayOptions" target="_top">TCGetDisplayOptions</a></code></p></li>
</ul>




        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../D-Chapter/4TextMediaHandlers.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../F-Chapter copy 4/6TweensandTweenOpera.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2005, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-01-10<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/QuickTime/RM/MediaTypesAndHandlers/MHFundamentals/E-Chapter copy 5/5TimecodeMediaHandle.html%3Fid%3DTP40000899-3.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/QuickTime/RM/MediaTypesAndHandlers/MHFundamentals/E-Chapter copy 5/5TimecodeMediaHandle.html%3Fid%3DTP40000899-3.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/QuickTime/RM/MediaTypesAndHandlers/MHFundamentals/E-Chapter copy 5/5TimecodeMediaHandle.html%3Fid%3DTP40000899-3.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>