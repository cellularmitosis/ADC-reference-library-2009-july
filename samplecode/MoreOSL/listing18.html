<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>

	<!-- BEGIN META TAG INFO -->
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<link rel="home" href="http://developer.apple.com/">
	<link rel="find" href="http://developer.apple.com/search/">
	<link rel="stylesheet" type="text/css" href="../../documentation/css/adcstyle.css" title="fonts">
	<script language="JavaScript" src="../../documentation/js/adc.js" type="text/javascript"></script>
	<!-- END META TAG INFO -->
	
	<!-- BEGIN TITLE -->
	<title>MoreOSL - /MoreOSL/MoreOSLHelpers.c</title>
	<!-- END TITLE -->
<script language="JavaScript">
function JumpToNewPage() {
	window.location=document.scpopupmenu.gotop.value;
	return true;
}
</script>

</head>

<!-- BEGIN BODY OPEN -->
<body>
<!--END BODY OPEN -->

<!-- START CENTER OPEN -->
<center>
<!-- END CENTER OPEN -->

	<!-- BEGIN LOGO AND SEARCH -->
	<!--#include virtual="/includes/adcnavbar"-->
	<!-- END LOGO AND SEARCH -->
		
		
	<!-- START BREADCRUMB -->
	<div id="breadcrumb">
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td scope="row"><img width="340" height="10" src="images/1dot.gif" alt=""></td>
			<td><img width="340" height="10" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr valign="middle">
			<td align="left" colspan="2">
			<a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../samplecode/index.html">Sample Code</a> &gt; <a href="../../samplecode/Carbon/index.html">Carbon</a> &gt; <a href="../../samplecode/Carbon/idxInterapplicationCommunication-date.html">Interapplication Communication</a> &gt; <A HREF="javascript:location.replace('index.html');">MoreOSL</A> &gt; 
			</td>
		</tr>
		<tr>
			<td colspan="2" scope="row"><img width="680" height="35" src="images/1dot.gif" alt=""></td>
		</tr>
	</table>
	</div>
	<!-- END BREADCRUMB -->

	

	<!-- START MAIN CONTENT -->
	
	<!-- START TITLE GRAPHIC AND INTRO-->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td><h1><div id="pagehead">MoreOSL</div></h1></td>
		</tr>
	</table>
	<!-- END TITLE GRAPHIC AND INTRO -->
	<!-- START WIDE COLUMN -->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td id="scdetails">
				<h2>/MoreOSL/MoreOSLHelpers.c</h2>
				<form name="scpopupmenu" onSubmit="return false;" method=post>
				<p><strong>View Source Code:</strong> 
					<select name="gotop" onChange="JumpToNewPage();" style="width:340px"><option selected value="ingnore">Select File</option>
<option value="listing1.html">/MIB_Carbon.h</option>
<option value="listing2.html">/MoreAppearance/MoreAppearance.cp</option>
<option value="listing3.html">/MoreAppearance/MoreAppearance.h</option>
<option value="listing4.html">/MoreAppleEvents/MoreAEObjects.c</option>
<option value="listing5.html">/MoreAppleEvents/MoreAEObjects.h</option>
<option value="listing6.html">/MoreAppleEvents/MoreAppleEvents.cp</option>
<option value="listing7.html">/MoreAppleEvents/MoreAppleEvents.h</option>
<option value="listing8.html">/MoreDebugging/MoreBBLog.c</option>
<option value="listing9.html">/MoreDebugging/MoreBBLog.h</option>
<option value="listing10.html">/MoreDialogs/MoreDialogs.cp</option>
<option value="listing11.html">/MoreDialogs/MoreDialogs.h</option>
<option value="listing12.html">/MoreMemory/MoreMemory.c</option>
<option value="listing13.html">/MoreMemory/MoreMemory.h</option>
<option value="listing14.html">/MoreNavigation/MoreNavigation.c</option>
<option value="listing15.html">/MoreNavigation/MoreNavigation.h</option>
<option value="listing16.html">/MoreOSL/MoreOSL.c</option>
<option value="listing17.html">/MoreOSL/MoreOSL.h</option>
<option value="listing18.html">/MoreOSL/MoreOSLHelpers.c</option>
<option value="listing19.html">/MoreOSL/MoreOSLHelpers.h</option>
<option value="listing20.html">/MoreOSL/MoreOSLStringCompare.c</option>
<option value="listing21.html">/MoreOSL/MoreOSLStringCompare.h</option>
<option value="listing22.html">/MoreOSL/MoreOSLTokens.c</option>
<option value="listing23.html">/MoreOSL/MoreOSLTokens.h</option>
<option value="listing24.html">/MoreOSL/ReadMe.html</option>
<option value="listing25.html">/MoreOSL/TestMoreOSL/TestMoreOSL.c</option>
<option value="listing26.html">/MoreOSL/TestMoreOSL/TestMoreOSLTerminology.h</option>
<option value="listing27.html">/MoreOSL/TestMoreOSL/TestMoreOSLTerminology.r</option>
<option value="listing28.html">/MoreProcesses/MoreProcesses.cp</option>
<option value="listing29.html">/MoreProcesses/MoreProcesses.h</option>
<option value="listing30.html">/MoreQuickDraw/MoreQuickDraw.cp</option>
<option value="listing31.html">/MoreQuickDraw/MoreQuickDraw.h</option>
<option value="listing32.html">/MoreResources/MoreResources.c</option>
<option value="listing33.html">/MoreResources/MoreResources.h</option>
<option value="listing34.html">/MoreSetup.h</option>
<option value="listing35.html">/MoreSetup.r</option>
<option value="listing36.html">/MoreTextUtils/MoreTextUtils.cp</option>
<option value="listing37.html">/MoreTextUtils/MoreTextUtils.h</option>
<option value="listing38.html">/MoreToolbox/MoreToolbox.cp</option>
<option value="listing39.html">/MoreToolbox/MoreToolbox.h</option>
<option value="listing40.html">/MoreWindows/MoreWindows.cp</option>
<option value="listing41.html">/MoreWindows/MoreWindows.h</option></select>
				</p>
				</form>
				<p><strong><a href="MoreOSL.zip">Download Sample</a></strong> (&#147;MoreOSL.zip&#148;, 211.7K)<BR>
<strong><a href="MoreOSL.dmg">Download Sample</a></strong> (&#147;MoreOSL.dmg&#148;, 285.5K)</p>
				<!--
				<p><strong><a href="#">Download Sample</a></strong> (&#147;filename.sit&#148;, 500K)</p>
				-->
			</td>
		</tr>
		<tr>
			<td scope="row"><img width="680" height="10" src="images/1dot.gif" alt=""><br>
			<img height="1" width="680" src="images/1dot_919699.gif" alt=""><br>
			<img width="680" height="20" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr>
			<td scope="row">
	<!--googleon: index -->
<pre class="sourcecodebox">/*  File:    MoreOSLHelpers.c  Contains:  Property getters and setters for standard system objects.  Written by:  Quinn  Copyright:  Copyright &copy; 2000 by Apple Computer, Inc., all rights reserved.        You may incorporate this Apple sample source code into your program(s) without        restriction. This Apple sample source code has been provided &quot;AS IS&quot; and the        responsibility for its operation is yours. You are not permitted to redistribute        this Apple sample source code as &quot;Apple sample source code&quot; after having made        changes. If you're going to re-distribute the source, we require that you make        it clear in the source that the code was descended from Apple sample source        code, but that you've made changes.  Change History (most recent first):         &lt;3&gt;     20/3/00    Quinn   Tested and fleshed out the various supported properties.         &lt;2&gt;      9/3/00    Quinn   Changes to support strings beyond Str255.         &lt;1&gt;      6/3/00    Quinn   First checked in.*//////////////////////////////////////////////////////////////////// MoreIsBetter Setup#include &quot;MoreSetup.h&quot;// Mac OS Interfaces#include &lt;AEDataModel.h&gt;#include &lt;AERegistry.h&gt;#include &lt;MacWindows.h&gt;#include &lt;Processes.h&gt;#include &lt;PLStringFuncs.h&gt;#include &lt;Resources.h&gt;// MIB Prototypes#include &quot;MoreMemory.h&quot;#include &quot;MoreResources.h&quot;#include &quot;MoreProcesses.h&quot;#include &quot;MoreAppleEvents.h&quot;#include &quot;MoreOSL.h&quot;// Our Prototypes#include &quot;MoreOSLHelpers.h&quot;/////////////////////////////////////////////////////////////////  extern pascal OSStatus MOSLCApplicationGetPropHelper(DescType propName, AEDesc *result)  // See comment in header.{  OSStatus       err;  Str255         tmpStr;  Boolean       tmpBool;  VersRecHndl     versH;  OSType        tmpType;  MoreAENullDesc(result);    switch (propName) {    case keyAEBestType:      tmpType = cApplication;      err = AECreateDesc(typeType, &amp;tmpType, sizeof(tmpType), result);      break;    case pName:      err = MoreProcGetProcessName(nil, tmpStr);      if (err == noErr) {        err = AECreateDesc(typeText, &amp;tmpStr[1], tmpStr[0], result);      }      break;    case pIsFrontProcess:      tmpBool = MoreProcIsProcessAtFront(nil);      err = AECreateDesc(typeBoolean, &amp;tmpBool, sizeof(tmpBool), result);      break;    case pVersion:      versH = (VersRecHndl) Get1Resource('vers', 1);      err = MoreResError(versH);      if (err == noErr) {        PLstrcpy(tmpStr, (**versH).shortVersion);        err = AECreateDesc(typeText, &amp;tmpStr[1], tmpStr[0], result);      }      break;    default:      err = errAENoSuchObject;      break;  }    return err;}static OSStatus IsWindowZoomed(WindowRef window, Point idealSize, Boolean *result)  // Determines whether the window is currently zoomed using the  // Mac OS 8.5 Window Manager routine IsWindowInStandardState.{  OSStatus      err;  WindowAttributes winAttr;  Rect       junkRect;    MoreAssert(window != nil);  MoreAssert(result != nil);    err = GetWindowAttributes(window, &amp;winAttr);  if (err == noErr) {    if ((winAttr &amp; kWindowFullZoomAttribute) != 0) {      *result = IsWindowInStandardState(window, &amp;idealSize, &amp;junkRect);    } else {      *result = false;    }  }  return err;}extern pascal OSStatus MOSLCWindowGetPropHelper(WindowRef window, DescType propName, Point idealSize, AEDesc *result)  // See comment in header.{  OSStatus      err;  Str255        tmpStr;  WindowRef      thisWindow;  Boolean      found;  SInt32        index;  Rect        bounds;  WindowAttributes winAttr;  WindowAttributes attrMask;  WindowClass    winClass;  Boolean      tmpBool;  Boolean      tmpBoolValid;  RgnHandle     tmpRgn;  MoreAENullDesc(result);  tmpBoolValid = false;  err = noErr;  switch (propName) {    case pName:      GetWTitle(window, tmpStr);      err = AECreateDesc(typeText, &amp;tmpStr[1], tmpStr[0], result);      break;    case pIndex:      thisWindow = FrontWindow();      index = 1;      found = false;      do {        if (thisWindow != nil) {          found = (thisWindow == window);          if (!found) {            thisWindow = GetNextWindow(thisWindow);            index += 1;          }        }      } while (!found &amp;&amp; (thisWindow != nil));      if (found) {        err = AECreateDesc(typeLongInteger, &amp;index, sizeof(index), result);      } else {        err = paramErr;      }      break;    case kAESetPosition:      err = GetWindowBounds(window, kWindowStructureRgn, &amp;bounds);      if (err == noErr) {        // In Pascal, Rect is a tagless case variant record that lets        // you access the data as either four coordinates or two Points.        // In C, we have no such luxury (defective language), so we        // just sleaze it.        err = AECreateDesc(typeQDPoint, &amp;bounds, sizeof(Point), result);      }      break;    case keyAEBounds:      err = GetWindowBounds(window, kWindowStructureRgn, &amp;bounds);      if (err == noErr) {        err = AECreateDesc(typeQDRectangle, &amp;bounds, sizeof(bounds), result);      }      break;    case pIsResizable:    case pIsZoomable:    case pHasCloseBox:      err = GetWindowAttributes(window, &amp;winAttr);      if (err == noErr) {        switch (propName) {          case pIsResizable:            attrMask = kWindowResizableAttribute;            break;          case pIsZoomable:            attrMask = kWindowFullZoomAttribute;            break;          case pHasCloseBox:            attrMask = kWindowCloseBoxAttribute;            break;          default:            MoreAssertQ(false);            break;        }        tmpBool = ((winAttr &amp; attrMask) != 0);        tmpBoolValid = true;      }      break;    case pIsFloating:      err = GetWindowClass(window, &amp;winClass);      if (err == noErr) {        tmpBool = (winClass == kFloatingWindowClass);        tmpBoolValid = true;      }      break;    case pIsModal:      err = GetWindowClass(window, &amp;winClass);      if (err == noErr) {        tmpBool = ((winClass == kModalWindowClass)) || ((winClass == kMovableModalWindowClass));        tmpBoolValid = true;      }      break;    case pHasTitleBar:      // We determine whether a window has a title bar by getting its      // region and checking for the empty region.  Note that GetWindowRegion      // may well return an error for a window with no title bar, so we      // just treat that as false.      tmpRgn = NewRgn();      err = MoreMemError(tmpRgn);      if (err == noErr) {        tmpBool = (GetWindowRegion(window, kWindowTitleBarRgn, tmpRgn) == noErr)              &amp;&amp; !EmptyRgn(tmpRgn);        tmpBoolValid = true;        DisposeRgn(tmpRgn);      }      break;    case pIsZoomed:      err = IsWindowZoomed(window, idealSize, &amp;tmpBool);      if (err == noErr) {        tmpBoolValid = true;      }      break;    case pVisible:      tmpBool = IsWindowVisible(window);      tmpBoolValid = true;      break;    case pIsFrontProcess:      tmpBool = (FrontWindow() == window);      tmpBoolValid = true;      break;    default:      err = errAENoSuchObject;      break;  }  // As numerous branches of the switch statement return a Boolean, we  // factor out the AECreateDesc and set tmpBoolValid to indicate that  // we should create the Boolean descriptor before we leave.    if ((err == noErr) &amp; tmpBoolValid) {    err = AECreateDesc(typeBoolean, &amp;tmpBool, sizeof(tmpBool), result);  }    return err;}extern pascal OSStatus MOSLCWindowSetPropHelper(WindowRef window, DescType propName, Point idealSize, const AEDesc *data)  // See comment in header.{  OSStatus      err;  OSStatus      junk;  Str255        tmpStr;  Boolean      tmpBool;  Boolean      tmpBool2;  UInt32        winAttr;  WindowPartCode zoomPart;  Rect       bounds;  Point       pt;  err = noErr;  switch (propName) {    case pName:      err = MOSLCoerceObjDescToPtr(data, typePString, tmpStr, sizeof(Str255));      if (err == noErr) {        SetWTitle(window, tmpStr);      }      break;    case kAESetPosition:      err = MOSLCoerceObjDescToPtr(data, typeQDPoint, &amp;pt, sizeof(pt));      if (err == noErr) {              err = GetWindowBounds(window, kWindowStructureRgn, &amp;bounds);      }      if (err == noErr) {        OffsetRect(&amp;bounds, -bounds.left, -bounds.top);        OffsetRect(&amp;bounds, pt.h, pt.v);        err = SetWindowBounds(window, kWindowStructureRgn, &amp;bounds);      }      break;    case keyAEBounds:      err = GetWindowBounds(window, kWindowStructureRgn, &amp;bounds);      if (err == noErr) {        pt.v = bounds.bottom - bounds.top;        pt.h = bounds.right  - bounds.left;        err = MOSLCoerceObjDescToPtr(data, typeQDRectangle, &amp;bounds, sizeof(bounds));      }      if (err == noErr) {        err = GetWindowAttributes(window, &amp;winAttr);      }      // You can only change the size of the window if the window      // is resizable.      if (err == noErr) {        if ( ((winAttr &amp; kWindowResizableAttribute) == 0)            &amp;&amp; (   ((bounds.bottom - bounds.top)  != pt.v)              || ((bounds.right  - bounds.left) != pt.h) ) ) {          err = paramErr;        }      }      if (err == noErr) {        err = SetWindowBounds(window, kWindowStructureRgn, &amp;bounds);      }      break;    case pIsZoomed:      err = MOSLCoerceObjDescToPtr(data, typeBoolean, &amp;tmpBool, sizeof(tmpBool));      if (err == noErr) {        err = IsWindowZoomed(window, idealSize, &amp;tmpBool2);      }      if ((err == noErr) &amp;&amp; (tmpBool != tmpBool2)) {        err = GetWindowAttributes(window, &amp;winAttr);        if (err == noErr) {          if ((winAttr &amp; kWindowFullZoomAttribute) != 0) {            if (tmpBool) {              zoomPart = inZoomOut;            } else {              zoomPart = inZoomIn;            }            junk = ZoomWindowIdeal(window, zoomPart, &amp;idealSize);            MoreAssertQ(junk == noErr);          } else {            if (tmpBool) {              err = errAENotModifiable;            }          }        }      }      break;    case pVisible:      err = MOSLCoerceObjDescToPtr(data, typeBoolean, &amp;tmpBool, sizeof(tmpBool));      if (err == noErr) {        if (tmpBool) {          ShowWindow(window);        } else {          HideWindow(window);        }      }      break;    case pIsFrontProcess:      err = MOSLCoerceObjDescToPtr(data, typeBoolean, &amp;tmpBool, sizeof(tmpBool));      if (err == noErr &amp; tmpBool) {        SelectWindow(window);      }      break;    default:      err = errAENoSuchObject;      break;  }    return err;}</pre>
	<!--googleoff: index -->
			</td>
		</tr>
	</table>
	<!-- END WIDE COLUMN -->

	<!-- END MAIN CONTENT -->
		<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/samplecode/MoreOSL/listing18.html%3Fid%3DDTS10000670-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/samplecode/MoreOSL/listing18.html%3Fid%3DDTS10000670-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/samplecode/MoreOSL/listing18.html%3Fid%3DDTS10000670-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

	<!-- START BOTTOM APPLE NAVIGATION -->
	<!--#include virtual="/includes/footer"-->
	<!-- END BOTTOM APPLE NAVIGATION -->

<!-- START CENTER CLOSE -->
</center>
<!-- END CENTER CLOSE -->

</body>
</html>