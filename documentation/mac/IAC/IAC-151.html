<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>AEGetArray(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING151></A>


<!-- Top of Header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- Bottom of Header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-150.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-152.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-115.html"><B>Chapter 4 - Responding to Apple Events</B></A> / <A HREF="IAC-130.html"><B>Reference to Responding to Apple Events</B></A><BR><DL><DD><A HREF="IAC-134.html"><B>Routines for Responding to Apple Events</B></A> / <A HREF="IAC-148.html"><B>Getting Items From Descriptor Lists</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING151-0></A>
<H3><A NAME=MARKER-9-519></A>AEGetArray</H3>
 You can use the <CODE>AEGetArray</CODE> function to convert an Apple event array (an array created with the <CODE>AEPutArray</CODE> function and stored in a descriptor list) to the corresponding Pascal or C array and place the converted array in a buffer for which you have provided a pointer.<A NAME=MARKER-2-112></A><P>
<PRE>
FUNCTION AEGetArray (theAEDescList: AEDescList; 
                     arrayType: AEArrayType; 
                     arrayPtr: AEArrayDataPointer; 
                     maximumSize: Size; 
                     VAR itemType: DescType; VAR itemSize: Size; 
                     VAR itemCount: LongInt): OSErr;
</PRE>
<DL>
<DT><CODE>theAEDescList</CODE>
<DD> <BR>A descriptor list containing the desired array. If the array is of type <CODE>kAEDataArray</CODE>, <CODE>kAEPackedArray</CODE>, or <CODE>kAEHandleArray</CODE>, the descriptor list must be factored. 
<DT><CODE>arrayType</CODE> 
<DD> The Apple event array type to be converted. This is specified by one of the following constants: <CODE>kAEDataArray</CODE>, <CODE>kAEPackedArray</CODE>, <CODE>kAEHandleArray</CODE>, <CODE>kAEDescArray</CODE>, or <CODE>kAEKeyDescArray</CODE>.
<DT><CODE>arrayPtr</CODE> 
<DD> A pointer to the buffer for storing the array.
<DT><CODE>maximumSize</CODE>
<DD> <BR>The maximum length, in bytes, of the buffer for storing the array.
<DT><CODE>itemType</CODE>
<DD> For arrays of type <CODE>kAEDataArray</CODE>, <CODE>kAEPackedArray</CODE>, or <CODE>kAEHandleArray</CODE>, the <CODE>AEGetArray</CODE> function returns the descriptor type of the returned array items in this parameter. 
<DT><CODE>itemSize</CODE>
<DD> For arrays of type <CODE>kAEDataArray</CODE> or <CODE>kAEPackedArray</CODE>, the <CODE>AEGetArray</CODE> function returns the size (in bytes) of the returned array items in this parameter.
<DT><CODE>itemCount</CODE> 
<DD> The <CODE>AEGetArray</CODE> function returns the number of items in the resulting array in this parameter.
</DL>
<A NAME=HEADING151-10></A>
<H5>DESCRIPTION</H5>
 The <CODE>AEGetArray</CODE> function uses a buffer identified by the pointer in the <CODE>arrayPtr</CODE> parameter to return the converted data for the Apple event array specified by the <CODE>theAEDescList</CODE> parameter. Even if the descriptor list that contains the array is factored, the converted data for each array item includes the data common to all the descriptor records in the list. The Apple Event Manager automatically reconstructs the common data for each item when you call <CODE>AEGetArray</CODE>.<P>
<A NAME=HEADING151-12></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>memFullErr<TD>-108<TD>Not enough room in heap zone<TR>
<TD>errAEWrongDataType<TD>-1703<TD>Wrong descriptor type<TR>
<TD>errAENotAEDesc<TD>-1704<TD>Not a valid descriptor record<TR>
<TD>errAEReplyNotArrived<TD>-1718<TD>Reply has not yet arrived</TABLE>
</H5>
<A NAME=HEADING151-13></A>
<H5>SEE ALSO</H5>
 For more information about data types and constants used with <CODE>AEGetArray</CODE>, see <A HREF=IAC-133.html#MARKER-9-457>"Apple Event Array Data Types" on page 4-60</A>.<P>
 For information about creating and factoring descriptor lists for Apple event arrays, see the description of <CODE>AECreateList</CODE> on <A HREF=IAC-212.html#MARKER-9-153>page 5-29</A>. For information about adding an Apple event array to a descriptor list, see the description of <CODE>AEPutArray</CODE> on <DFN><A HREF=IAC-216.html#MARKER-9-163>page 5-32</A>.</DFN><A NAME=MARKER-21-293></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-150.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-152.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
