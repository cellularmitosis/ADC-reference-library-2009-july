<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Supporting Stationery Pads(IM:Tb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING456></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Toolbox-455.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-457.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Toolbox-2.html"><B>Macintosh Toolbox Essentials</B></A> / <BR><DD><A HREF="Toolbox-443.html"><B>Chapter 7 - Finder Interface</B></A> / <A HREF="Toolbox-446.html"><B>Using the Finder Interface</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING456-0></A>
<H2><A NAME=MARKER-9-383></A>Supporting Stationery Pads</H2>
 <A NAME=MARKER-2-384></A>Stationery pads are special documents that the user creates as templates. Opening <BR>a stationery pad should not open the document itself; instead, it should open a new document with the same contents as the stationery pad. To turn any document into <BR>a stationery pad, the user selects it, chooses Get Info from the File menu, and clicks <BR>the Stationery pad checkbox in the information window. The Finder tags a document as being a stationery pad by setting the <CODE>isStationery</CODE> bit in the file's Finder flags field.<A NAME=MARKER-2-385></A><A NAME=MARKER-2-386></A><P>
 When the user opens a stationery pad from the Finder, the Finder first checks your application's size resource to see if your application supports stationery. The <CODE>'SIZE'</CODE> resource tells the Finder and the Process Manager which features your application supports and how much memory to allocate when it starts up your application. <BR><A HREF=#MARKER-9-391>Listing 7-10</A> illustrates a size resource.<A NAME=MARKER-2-387></A><A NAME=MARKER-2-388></A><A NAME=MARKER-2-389></A><A NAME=MARKER-2-390></A><P>
<B>Listing 7-10  <A NAME=MARKER-9-391></A>Rez input for a size resource</B><P>
<PRE>
resource 'SIZE' (-1, purgeable)  {
   reserved,
   acceptSuspendResumeEvents,
   reserved,
   canBackground, 
   doesActivateOnFGSwitch, 
   backgroundAndForeground,
   dontGetFrontClicks,
   ignoreAppDiedEvents,
   is32BitCompatible,
   isHighLevelEventAware,
   localAndRemoteHLEvents,
   isStationeryAware,         /*support stationery pads*/
   dontUseTextEditServices,
   reserved, reserved, reserved,
   kPrefSize * 1024,
   kMinSize * 1024
};
</PRE>
 Notice that the twelfth field, <CODE>isStationeryAware</CODE>, tells the Finder that this application supports stationery pads.<P>
 If the <CODE>isStationeryAware</CODE> bit is not set in the size resource, the Finder creates a <BR>new document from the template and prompts the user for a name. The Finder then starts up your application as usual, passing it the name of the new document.<P>
 If the <CODE>isStationeryAware</CODE> bit is set, as shown in <A HREF=#MARKER-9-391>Listing 7-10</A>, the Finder informs your application that the user has opened a document and passes your application the name of the stationery pad. <P>
 To support stationery, your application should<P>
<UL>
<LI>specify the <CODE>isStationeryAware</CODE> constant in its size resource
<LI>always check the <CODE>isStationery</CODE> bit of a document before opening it<P>
</UL>
 <A HREF=#MARKER-9-392>Listing 7-11 on page 7-33</A> illustrates a simple function that takes a file system specification record and returns <CODE>TRUE</CODE> or <CODE>FALSE</CODE>, indicating whether the file is a stationery document or not.<P>
<B>Listing 7-11  <A NAME=MARKER-9-392></A>Determining whether a document is a stationery pad</B><P>
<PRE>
FUNCTION IsStationeryDoc (myFSSpec: FSSpec): Boolean;
VAR
    myErr:      OSErr;
    myFInfo:    FInfo;
BEGIN
    myErr := FSpGetFInfo(myFSSpec, myFInfo);
    IF myErr = noErr THEN
        IsStationeryDoc := BTST(myFInfo.fdFlags, isStationery)
    ELSE
        IsStationeryDoc := FALSE;
END;
</PRE>
 The <CODE>isStationery</CODE> bit alone identifies whether a document is stationery. If the <CODE>isStationery</CODE> bit is set for a file that the user wants to open, your application should copy the template's contents into a new document and open the document in an untitled window. (For information about opening documents and about the File Manager function <CODE>FSpGetFInfo</CODE>, see <I><A HREF="../Files/Files-2.html">Inside Macintosh: Files</A></I>.)<P>
 Your application can check the <CODE>sfFlags</CODE> field of the standard file reply record to determine whether the <CODE>isStationery</CODE> bit is set. Unlike the Finder, the Standard File Package always passes your application the stationery pad itself, not a copy of it, regardless of the setting of the <CODE>isStationery</CODE> bit. When the user opens a stationery <BR>pad from within your application, the Standard File Package checks your application's size resource. If your application does not support stationery, the Standard File Package displays an alert box warning the user that the stationery pad itself, not a copy of it, <BR>is being opened. As you can see, the user can still easily change the template and mistakenly write over it by choosing Save without assigning a new name. You can prevent this unnecessary user frustration by making your application stationery-aware.<P>
 You can supply the icon to be displayed for stationery pads created from your application's documents by using the resources described in <A HREF=Toolbox-448.html#MARKER-9-139>"Creating Icons for the Finder" beginning on page 7-10</A>.<A NAME=MARKER-2-393></A> If you do not supply your own stationery pad icon, the Finder uses the default stationery pad icon illustrated in <A HREF=Toolbox-448.html#MARKER-9-166>Figure 7-5 on page 7-12</A>.<P>
 In your documentation, tell users to choose the Get Info command to make stationery pads. You may also want to give examples of useful stationery pads created with your application. For example, if your application supports text and graphics, you may provide samples of stationery pads for business letterheads or billing statements.<A NAME=MARKER-2-394></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Toolbox-455.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-457.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Toolbox-3.html">&copy; Apple Computer, Inc.</A><br>11 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
