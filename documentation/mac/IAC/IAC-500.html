<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>DBGetQueryResults(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING500></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-499.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-501.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-469.html"><B>Chapter 12 - Data Access Manager</B></A> / <A HREF="IAC-487.html"><B>Data Access Manager Reference</B></A><BR><DL><DD><A HREF="IAC-492.html"><B>Data Access Manager Routines</B></A> / <A HREF="IAC-499.html"><B>High-Level Interface: Handling Query Results</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING500-0></A>
<H3><A NAME=MARKER-9-311></A>DBGetQueryResults</H3>
 <A NAME=MARKER-2-312></A>You can use the <CODE>DBGetQueryResults</CODE> function to retrieve the results of a query. <P>
<PRE>
FUNCTION DBGetQueryResults (sessID: LongInt; 
                            VAR results: ResultsRecord; 
                            timeout: LongInt; statusProc: ProcPtr; 
                            asyncPB: DBAsyncParmBlkPtr): OSErr;
</PRE>
<DL>
<DT><CODE>sessID</CODE>
<DD> The session ID of the session from which you wish to retrieve results.
<DT><CODE>results</CODE>
<DD> The results record, which contains handles to the retrieved data. 
<DT><CODE>timeout</CODE> 
<DD> The value that the <CODE>DBGetQueryResults</CODE> function uses for the <CODE>timeout</CODE> parameter each time it calls the <CODE>DBGetItem</CODE> function. The <CODE>timeout</CODE> parameter specifies the maximum amount of time that the database extension should wait to receive results from the data server before canceling the <CODE>DBGetItem</CODE> function. Specify the <CODE>timeout</CODE> parameter in sixtieths of a second. To disable the timeout feature, set the <CODE>timeout</CODE> parameter to the <CODE>kDBWaitForever</CODE> constant. Some database extensions ignore the <CODE>timeout</CODE> parameter when you specify a nonzero value for the <CODE>asyncPB</CODE> parameter.
<DT><CODE>statusProc</CODE>
<DD> A pointer to a status routine that you provide. The <CODE>DBGetQueryResults</CODE> function calls your status routine after it calls the <CODE>DBGetItem</CODE> function to retrieve a data item. When it calls the status routine, the <CODE>DBGetQueryResults</CODE> function provides the result of the <CODE>DBGetItem</CODE> function, the data type, the data length, the number of decimal places, the flags associated with the data item, and a pointer to the data item. 
<DT><CODE>asyncPB</CODE>
<DD> A pointer to an asynchronous parameter block. If specified, the <CODE>DBGetQueryResults</CODE> function calls the <CODE>DBGetItem</CODE> function asynchronously for each data item. As soon as the <CODE>DBGetItem</CODE> function has started execution, it returns control to your application. Your application must then call the Event Manager's <CODE>WaitNextEvent</CODE> function periodically to allow this asynchronous routine to run, and it must check the result field of the asynchronous parameter block to determine when the routine has completed execution.
</DL>
<A NAME=HEADING500-8></A>
<H5>DESCRIPTION</H5>
 The <CODE>DBGetQueryResults</CODE> function retrieves the results returned by a query and places them in memory. If there is sufficient memory available, this function retrieves all of the results at once. If the <CODE>DBGetQueryResults</CODE> function runs out of memory, it places as much data as possible in memory, up to the last whole row. You can then make more memory available and call the <CODE>DBGetQueryResults</CODE> function again to retrieve more data. <P>
 You must allocate the results record and pass this record to the <CODE>DBGetQueryResults</CODE> function. The Data Access Manager allocates the handles inside the results record. When your application is finished using the results record, you must deallocate both the results record and the handles inside the results record.<P>
 The <CODE>DBGetQueryResults</CODE> function can be used to retrieve the results of any query, not only queries sent and executed by the <CODE>DBStartQuery</CODE> function.<P>
<A NAME=HEADING500-12></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 The <CODE>DBGetQueryResults</CODE> function may move or purge memory. You should not call this routine from within an interrupt, such as in a completion routine or a VBL task.<P>
<A NAME=HEADING500-14></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The trap macro and routine selector for the <CODE>DBGetQueryResults</CODE> function are
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Trap macro<TH>Selector<TR>
<TD>_DBGetQueryResults<TD><CODE>$0A12</CODE></TABLE>
<P>
<A NAME=HEADING500-16></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>userCanceledErr<TD>-128<TD>Function canceled by status routine<TR>
<TD>rcDBValue<TD>-801<TD>Data available <TR>
<TD>rcDBError<TD>-802<TD>Query execution ended in an error<TR>
<TD>rcDBBreak<TD>-804<TD>Function timed out<TR>
<TD>rcDBExec<TD>-805<TD>Query currently executing <TR>
<TD>rcDBBadSessID<TD>-806<TD>Session ID is invalid<TR>
<TD>rcDBAsyncNotSupp<TD>-809<TD>The database extension does not support asynchronous calls<TR>
<TD>rcDBPackNotInited<TD>-813<TD>The <CODE>InitDBPack</CODE> function has not yet been called</TABLE>
</H5>
<A NAME=HEADING500-17></A>
<H5>SEE ALSO</H5>
 See <A HREF=IAC-477.html#MARKER-9-125>Listing 12-1</A> beginning on <A HREF=IAC-477.html#MARKER-9-125>page 12-18</A> for an example of the use of the <CODE>DBGetQueryResults</CODE> function. See <A HREF=IAC-489.html#MARKER-9-246>page 12-56</A> for a description of the asynchronous parameter block. Descriptions of the <CODE>DBStartQuery</CODE> and <CODE>DBGetItem</CODE> functions begin on <A HREF=IAC-498.html#MARKER-9-305>page 12-64</A> and <A HREF=IAC-516.html#MARKER-9-382>page 12-84</A>, respectively. For more information on results records, see <A HREF=IAC-491.html#MARKER-9-276>"The Results Record" beginning on page 12-59</A> and <A HREF=IAC-481.html#MARKER-9-171>"Getting Query Results" beginning on page 12-37</A>. For more information on status routines, see <A HREF=IAC-478.html#MARKER-9-129>"Writing a Status Routine for High-Level Functions" beginning on page 12-22</A>. <A NAME=MARKER-2-313></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-499.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-501.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
