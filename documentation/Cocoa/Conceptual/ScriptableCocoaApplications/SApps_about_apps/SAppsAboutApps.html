<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Cocoa Scripting Guide: Overview of Cocoa Support for Scriptable Applications</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Overview of Cocoa Support for Scriptable Applications"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001976" title="Overview of Cocoa Support for Scriptable Applications"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../Scripting-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000569" target="_top">Scripting &amp; Automation</a> &gt; <a href="../SApps_intro/SAppsIntro.html#//apple_ref/doc/uid/TP40001982-BCICHGIE">Cocoa Scripting Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../SApps_intro/SAppsIntro.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../SApps_design_apps/SAppsDesignApp.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40001976-BBCBCIJE" title="Overview of Cocoa Support for Scriptable Applications"></a><h1>Overview of Cocoa Support for Scriptable Applications</h1><p>This chapter provides an overview of Cocoa scripting and how your application takes advantage of it, and provides links to more detailed information in other chapters and documents.</p><p>A scriptable application is one that scripters can control with AppleScript scripts. To create a scriptable application, you specify a dictionary of terms that scripters can use with your application, implement classes and methods to support scriptable features, and provide a road map of scriptability information that AppleScript and Cocoa use to allow scripts to control the application.</p><p><strong><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_21"></a>Cocoa scripting</strong> refers to the support provided by the Cocoa application framework for creating scriptable applications. It includes classes, categories, and scriptability information that specifies the supported AppleScript terminology and the class information needed to work with it.</p><p>Cocoa scripting makes use of standard mechanisms and design patterns used throughout Cocoa, including key-value coding (KVC) and Model-View-Controller (MVC). When an AppleScript command targets your application, the goal of the scripting support is to send the command directly to the application's model objects to perform the work. To do that, it relies on the KVC mechanism to get and set values in your application's scriptable model objects, based on a set of keys you define for them.</p><p>Through the use of these mechanisms, you can make your application scriptable with a minimum of additional code.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-BBCCJHBA">AppleScript and Scriptable Applications</a>
				
			<br/>
			
        
			
			
				<a href="SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-SW3">The AppleScript Object Model</a>
				
			<br/>
			
        
			
			
				<a href="SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-SW17">Scriptability Information</a>
				
			<br/>
			
        
			
			
				<a href="SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-SW7">Reliance on Key-Value Coding</a>
				
			<br/>
			
        
			
			
				<a href="SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-SW13">Interaction With Cocoa Bindings and Core Data</a>
				
			<br/>
			
        
			
			
				<a href="SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-SW20">Scriptability and Undo</a>
				
			<br/>
			
        
			
			
				<a href="SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-SW6">Snapshot of Cocoa Scripting</a>
				
			<br/>
			
        
			
			
				<a href="SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-1149806">A Real World Scripting Example</a>
				
			<br/>
			
        
			
			
				<a href="SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-SW21">Current Limitations of Cocoa Scripting Support</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001976-1150259" title="AppleScript and Scriptable Applications"></a><a name="//apple_ref/doc/uid/TP40001976-BBCCJHBA" title="AppleScript and Scriptable Applications"></a><h2>AppleScript and Scriptable Applications</h2><p><strong>AppleScript</strong> <a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_22"></a>is a scripting language<a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_23"></a> that makes possible direct control of scriptable applications and scriptable parts of the Mac OS (such as the Finder). The AppleScript language doesn’t supply an exhaustive or a task-specific terminology. Instead, it defines common commands, such as <code>get</code>, <code>set</code>, <code>make</code>, and <code>delete</code>, which can be applied to a wide variety of objects or their properties in a scriptable application. Scriptable applications define additional terms as needed for their unique operations.</p><p>A <strong>scriptable application</strong><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_24"></a> is one that makes its operations and data available in response to AppleScript messages, called Apple events. An <strong>Apple event</strong><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_25"></a> is a kind of interprocess message that can specify complex operations and data. Apple events make it possible to encapsulate a high-level task in a single package that can be passed across process boundaries, performed, and responded to with a reply event.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001976-SW14" title="Note"></a><p><strong>Note:</strong>&nbsp;Mac OS X mechanisms for communicating between processes are described in <span class="content_text"><a href="../../../../MacOSX/Conceptual/OSX_Technology_Overview/SystemTechnology/SystemTechnology.html#//apple_ref/doc/uid/TP40001067-CH207" target="_top">System-Level Technologies</a></span> in <em><a href="../../../../MacOSX/Conceptual/OSX_Technology_Overview/index.html#//apple_ref/doc/uid/TP40001067" target="_top">Mac OS X Technology Overview</a></em>.</p></div><p>A scriptable application specifies the set of scripting terms it understands and provides information that AppleScript uses to compile scripts that use those terms. When a user executes a script that targets the application, Apple events are sent to the application. Apple events can also be sent by other applications and by the Mac OS.</p><p>Applications handle Apple events by registering with the <a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_26"></a>Apple Event Manager for the events they expect to receive and by supplying handler routines to process the events. Cocoa scripting simplifies this process by automatically registering and responding to Apple events your application can handle, based on the scriptability information you supply. That means you don't need to write low-level code to interact with Apple events and the Apple Event Manager.</p><p>AppleScript and Apple events are built on the <a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_27"></a>Open Scripting Architecture (OSA), which is described in <span class="content_text"><a href="../../../../AppleScript/Conceptual/AppleScriptX/Concepts/osa.html#//apple_ref/doc/uid/TP40001571" target="_top">Open Scripting Architecture</a></span> in <em><a href="../../../../AppleScript/Conceptual/AppleScriptX/index.html#//apple_ref/doc/uid/10000156i" target="_top">AppleScript Overview</a></em>.</p><a name="//apple_ref/doc/uid/TP40001976-SW3" title="The AppleScript Object Model"></a><h2>The AppleScript Object Model</h2><p>Every scriptable application defines an <strong>AppleScript object model</strong><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_28"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_29"></a> to specify the classes of objects a scripter can work with in scripts, the accessible properties of those objects, and the inheritance and containment relationships for those classes. <em>Inheritance</em> allows a class to access the properties of its ancestors. <em>Containment</em> specifies where an object resides within the hierarchy of objects in the running application.</p><p>The objects in the object model often correspond closely to object classes in the application that implement scripting support, but there is no requirement that they do so. For example, a text application might provide script access to words in a document, but it would not be efficient for the application to maintain a corresponding object for each word.</p><p>Application classes have <em>attributes</em>, <em>to-one relationships</em>, and <em>to-many relationships</em>. AppleScript classes in the object model have <em>properties</em> and <em>elements</em>—properties are synonymous with attributes and to-one relationships, while elements are synonymous with to-many relationships. For more information on these and related terms, see the <span class="content_text"><a href="../SApps_glossary/SAppsGlossary.html#//apple_ref/doc/uid/TP40002164-CH20-SW12">“Glossary.”</a></span></p><p><span class="content_text">Figure 1-1</span> shows the object-model <a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_30"></a>containment hierarchy for a specific document (shown in <span class="content_text"><a href="SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-SW5">Figure 1-2</a></span>) in the Sketch application. On the left are the objects a scripter uses to work with the application. On the right are the objects that Sketch uses to represent its object model.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001976-SW15" title="Note"></a><p><strong>Note:</strong>&nbsp;Sketch is a sample application available from Apple.<a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_31"></a></p></div><br/><div><a name="//apple_ref/doc/uid/TP40001976-SW8" title="Figure 1-1Object-model containment hierarchy for Sketch application"></a><p><strong>Figure 1-1&nbsp;&nbsp;</strong>Object-model containment hierarchy for Sketch application</p><img src = "../Art/contaiment_hierarchy.gif" alt = "Object-model containment hierarchy for Sketch application" width="434" height="243"></div><br/><p>In this object model, documents are elements of the application object and graphics are elements of document objects, while the name of a document is a property of the document. For a script to access an object in the hierarchy, it must locate the object within its containment hierarchy. (In the application, the <code>orderedDocuments</code> array is a to-many relationship of the <code><a href="../../../Reference/ApplicationKit/Classes/NSApplication_Class/Reference/Reference.html#//apple_ref/occ/cl/NSApplication" target="_top">NSApplication</a></code> object.)</p><p>Consider, for example, the following sample script:</p><div class="codesample"><table><tr><td scope="row"><pre>tell app "Sketch" to set the x position of rectangle 1 of document "SketchDocOne" to 25<span></span></pre></td></tr></table></div><p>This script specifies a rectangle, in a document, in the application. If applied to the following Sketch document, it would set the horizontal (x) position for whichever of the two rectangle shapes is first in the document's ordered list of graphics.</p><br/><div><a name="//apple_ref/doc/uid/TP40001976-SW5" title="Figure 1-2Sketch window with graphics"></a><p><strong>Figure 1-2&nbsp;&nbsp;</strong>Sketch window with graphics</p><img src = "../Art/sketch_doc_one.gif" alt = "Sketch window with graphics" width="447" height="322"></div><br/><p>A script can ask for <code>rectangle 1 of document "SketchDocOne"</code> without having to specify either <code>graphics</code> or <code>documents</code> (though they are part of the hierarchy shown above) because an AppleScript class definition implicitly specifies the relationships of its contained elements.</p><p>Sketch's object model uses inheritance for its graphics objects. All such objects (<code>rectangle</code>, <code>circle</code>, <code>image</code>, <code>line</code>, and <code>text area</code>) inherit from a common ancestor (<code>graphic</code>). Thus the term <code>graphic 1 of document "SketchDocOne"</code> might specify the same object as <code>rectangle 1 of document "SketchDocOne"</code>, depending on the ordering of the objects in the graphics array.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001976-SW16" title="Note"></a><p><strong>Note:</strong>&nbsp;Cocoa applications typically follow the Model-View-Controller (MVC) design pattern, where model objects encapsulate and manipulate the data used by the application. It is generally recommended that you support scriptability through your model objects, which tend to be more persistent. For more information, see <span class="content_text"><a href="../SApps_implement/SAppsImplement.html#//apple_ref/doc/uid/20000037-1088066">“Concentrate Scriptable Behavior in Model Objects.”</a></span></p>Don't confuse the <em>AppleScript object model</em> with <em>MVC model objects</em>: the former is a structure you define; the latter are objects in your application that may or may not be part of your AppleScript object model.</p></div><a name="//apple_ref/doc/uid/TP40001976-SW17" title="Scriptability Information"></a><h2>Scriptability Information</h2><p><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_32"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_33"></a>A scriptable application supplies <strong>scriptability information</strong> that formally lays out the AppleScript object model for the application and maps it to application objects. This scriptability information does two things:</p><ul class="ul"><li class="li"><p>It specifies the terminology available for use in scripts that target the application and supplies comments on the purpose and usage for that terminology.</p></li><li class="li"><p>It provides information, used by AppleScript and by Cocoa, about how support for that terminology is implemented in the application.</p><p>This information includes the KVC keys that Cocoa scripting uses to gain access to attribute and relationship information in the application's classes. Without these keys, scripts would not be able to manipulate properties of scriptable objects in the application's object model.</p></li></ul><p>To uniquely identify terms in its scriptability information, an application uses constants called four-character codes (or Apple event codes). A <strong>four-character code</strong><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_34"></a> is just four bytes of data that can be expressed as a string of four characters in the Mac OS Roman encoding. These codes are described in <span class="content_text"><a href="../SApps_creating_sdef/SAppsCreateSdef.html#//apple_ref/doc/uid/TP40001977-1144251">“Code Constants Used in Scriptability Information.”</a></span></p><p>Within an application's scriptability information, terminology associated with related functionality (for example, operations involving text, graphics, or databases) are generally collected into <strong>suites</strong>. Cocoa provides the predefined suites described in <span class="content_text"><a href="SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-1156585">“Built-in Support for Standard and Text Suites.”</a></span></p><p>AppleScript uses the application’s scriptability information, including four-character codes, to compile scripts and send Apple events to the application. Cocoa uses the information to interpret received Apple events and create script command objects to perform the specified operations.</p><a name="//apple_ref/doc/uid/TP40001976-1155419" title="Scriptability Information Formats"></a><a name="//apple_ref/doc/uid/TP40001976-BBCIGFFB" title="Scriptability Information Formats"></a><h3>Scriptability Information Formats</h3><p><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_35"></a>You define your application’s scriptability information using one of two formats. The first is the <strong>scripting definition</strong><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_36"></a> or <strong>sdef</strong> <a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_37"></a>format.  This is an XML-based format that describes a set of scriptability terms and the commands, classes, constants, and other information that describe the application's scriptability. The sdef format was introduced in Mac OS X version 10.2 and is used natively by Cocoa starting in Mac OS X version 10.4.  In the sdef format, an application's scriptability information is contained in a single <a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_38"></a><strong>scripting definition (or sdef) file</strong><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_39"></a>, with the extension <code>.sdef</code>. The word <em>sdef</em> can be used to describe either the format or a file in that format.</p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_3" title="Important:"></a><p><strong>Important:</strong>&nbsp;You can read about additional refinements to sdef usage in Cocoa applications for Mac OS X v10.5 in the Scripting section of <em><a href="../../../../../releasenotes/Cocoa/Foundation.html#//apple_ref/doc/uid/TP30000742" target="_top">Foundation Release Notes</a></em>.</p><p></p></div><p>A second, older format uses property list files and is referred to as the <strong>script suite</strong> <a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_40"></a>format. It supplies Cocoa and AppleScript with roughly the same information, in the form of a script suite file and a corresponding script terminology file:</p><ul class="spaceabove"><li class="li"><p>A <strong>script suite file</strong> describes scriptable objects in terms of their attributes, relationships, and supported commands, and has the extension <code>.scriptSuite</code>.</p></li><li class="li"><p>A <strong>script terminology file</strong> provides AppleScript terminology—the English-like words and phrases a scripter can use in a script—for the class and command descriptions in the corresponding script suite file. Script terminology files have the extension <code>.scriptTerminology</code>.</p></li></ul><p>Defining scriptability information with either of these formats is a bit like defining your application interface with nib files, though you work with text rather than a graphic editor. In both cases you provide information up front that Cocoa uses at specific times to create objects and provide support for the task at hand. The information from an sdef (or the older property list form) is loaded just once per application launch, as described in <span class="content_text"><a href="SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-SW1">“Loading Scriptability Information.”</a></span> The loaded information is then used as needed to create script command objects to perform scriptable operations.</p><p>A scripting definition file follows the XML format defined in the sdef man page and described in more detail in <span class="content_text"><a href="../SApps_creating_sdef/SAppsCreateSdef.html#//apple_ref/doc/uid/TP40001979-BBCBCIJE">“Preparing a Scripting Definition File.”</a></span> <span class="content_text">Figure 1-3</span> shows the main XML elements in an sdef file.<a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_41"></a></p><br/><div><a name="//apple_ref/doc/uid/TP40001976-SW9" title="Figure 1-3Structure of an sdef file"></a><p><strong>Figure 1-3&nbsp;&nbsp;</strong>Structure of an sdef file</p><img src = "../Art/sdef_struct.gif" alt = "Structure of an sdef file" width="242" height="398"></div><br/><p>As an example of specific sdef elements,  <span class="content_text">Listing 1-1</span> shows the <code>graphic</code> and <code>rectangle</code> definitions from Sketch's sdef file. The <code>graphic</code> class defines several properties (such as <code>x position</code> and <code>y position</code>) that are inherited by other shape classes. The <code>rectangle</code> class adds an <code>orientation</code> property and specifies that the object responds to the <code>rotate</code> command, which is specific to rectangles.<a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_42"></a></p><a name="//apple_ref/doc/uid/TP40001976-SW4" title="Listing 1-1Graphic and rectangle elements from Sketch&#39;s sdef file"></a><p class="codesample"><strong>Listing 1-1&nbsp;&nbsp;</strong>Graphic and rectangle elements from Sketch's sdef file</p><div class="codesample"><table><tr><td scope="row"><pre>... (from the Sketch suite)<span></span></pre></td></tr><tr><td scope="row"><pre>&lt;class name="graphic" code="grph"<span></span></pre></td></tr><tr><td scope="row"><pre>    description="A graphic. This abstract class represents the<span></span></pre></td></tr><tr><td scope="row"><pre>        individual shapes in a Sketch document.<span></span></pre></td></tr><tr><td scope="row"><pre>        There are subclasses for each specific type of graphic."><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;cocoa class="SKTGraphic"/><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;property name="x position" code="xpos" type="real"<span></span></pre></td></tr><tr><td scope="row"><pre>        description="The x coordinate of the graphic's bounding rectangle."/><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;property name="y position" code="ypos" type="real"<span></span></pre></td></tr><tr><td scope="row"><pre>        description="The y coordinate of the graphic's bounding rectangle."/><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;property name="width" code="widt" type="real"<span></span></pre></td></tr><tr><td scope="row"><pre>        description="The width of the graphic's bounding rectangle."/><span></span></pre></td></tr><tr><td scope="row"><pre>... (some properties omitted)<span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/class><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;class name="rectangle" code="d2rc" inherits="graphic"<span></span></pre></td></tr><tr><td scope="row"><pre>        description="A rectangle graphic."><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;cocoa class="SKTRectangle"/><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;property name="orientation" code="orin" type="orientation"/><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;responds-to name="rotate"><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;cocoa method="rotate:"/><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/responds-to><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/class><span></span></pre></td></tr></table></div>	<a name="//apple_ref/doc/uid/TP40001976-SW18" title="Viewing Scripting Terminology"></a><h3>Viewing Scripting Terminology</h3><p><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_43"></a>Users typically examine scripting terminology in a dictionary viewer to discover which features are scriptable and how to script an application. You can view the scripting terminology for a scriptable application with <a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_44"></a>Script Editor or Xcode. <span class="content_text">Figure 1-4</span> shows the sdef file from the Sketch application in a dictionary viewer, with the graphic and rectangle classes visible.<a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_45"></a></p><br/><div><a name="//apple_ref/doc/uid/TP40001976-SW10" title="Figure 1-4An sdef displayed in a dictionary viewer"></a><p><strong>Figure 1-4&nbsp;&nbsp;</strong>An sdef displayed in a dictionary viewer</p><img src = "../Art/sketch_dict_w_graphic.gif" alt = "An sdef displayed in a dictionary viewer" width="534" height="505"></div><br/><p>Double-clicking an sdef file in the Finder opens it in a dictionary viewer like the one shown above. Double-clicking an sdef file in an Xcode project similarly opens it in a dictionary viewer window. To view or edit the XML for the file, open the sdef file with any plain text editor; in Xcode, select the sdef file and choose File > Open As > Plain Text File.</p><p>For related information, see <span class="content_text"><a href="../SApps_evolution/SAppsEvolution.html#//apple_ref/doc/uid/TP40002164-CH19-SW6">“Editing Scriptability Information.”</a></span></p><a name="//apple_ref/doc/uid/TP40001976-1156585" title="Built-in Support for Standard and Text Suites"></a><a name="//apple_ref/doc/uid/TP40001976-BAJFJGCF" title="Built-in Support for Standard and Text Suites"></a><h3>Built-in Support for Standard and Text Suites</h3><p><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_46"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_47"></a>A scriptable application typically supports certain standard AppleScript terms, such as the <code>count</code> and <code>make</code> commands and the <code>application</code> class. Cocoa provides built-in support for these terms in the <strong>Standard suite</strong>.<a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_48"></a> It also provides command classes, including <code><a href="../../../Reference/Foundation/Classes/NSCountCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSCountCommand" target="_top">NSCountCommand</a></code> and <code><a href="../../../Reference/Foundation/Classes/NSCreateCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSCreateCommand" target="_top">NSCreateCommand</a></code>, to implement standard commands. In addition, classes such as <code><a href="../../../Reference/ApplicationKit/Classes/NSApplication_Class/Reference/Reference.html#//apple_ref/occ/cl/NSApplication" target="_top">NSApplication</a></code> and <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/cl/NSDocument" target="_top">NSDocument</a></code> implement certain aspects of standard scripting support.</p><p>Cocoa scripting also provides support for the <code>get</code> and <code>set</code> commands, including implementation of the command classes <code><a href="../../../Reference/Foundation/Classes/NSGetCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSGetCommand" target="_top">NSGetCommand</a></code> and <code><a href="../../../Reference/Foundation/Classes/NSSetCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSSetCommand" target="_top">NSSetCommand</a></code>. These commands are not part of the Standard suite, but are considered built-in AppleScript commands. Allowing scripters to get and set the values of properties and elements of scriptable objects is a key part of making an application scriptable.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001976-SW19" title="Note"></a><p><strong>Note:</strong>&nbsp;Though "Standard suite" is the current name, you may see it referred to as the "Core suite" (and you may see filenames that include “Core”). That usage dates back to the early days of AppleScript.</p></div><p>The Standard suite defines the following AppleScript commands: (for all classes) <code>copy</code>, <code>count</code>, <code>create</code>, <code>delete</code>, <code>exists</code>, and <code>move</code>; (for documents and windows) <code>print</code>, <code>save</code>, <code>close</code>. Note that there is no default implementation for the <code>print</code> command—see <span class="content_text"><a href="../SApps_handle_AEs/SAppsHandleAEs.html#//apple_ref/doc/uid/20001239-1122706">“Print”</a></span> for information on how to support printing.</p><p>To support text-related classes such as <code>rich text</code>, <code>word</code>, and <code>paragraph</code>, Cocoa implements the <strong>Text suite</strong>.</p><p>Cocoa’s built-in support for the Standard and Text suites is described in more detail in <span class="content_text"><a href="../SApps_implement/SAppsImplement.html#//apple_ref/doc/uid/20000037-1089105">“Use the Document Architecture”</a></span> and <span class="content_text"><a href="../SApps_implement/SAppsImplement.html#//apple_ref/doc/uid/20000037-1001820">“Access the Text Suite.”</a></span> To include it in your application, you follow the steps described in <span class="content_text"><a href="../SApps_implement/SAppsImplement.html#//apple_ref/doc/uid/20000037-1081046">“Turn On Scripting Support in Your Application”</a></span><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_49"></a>.<a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_50"></a></p><a name="//apple_ref/doc/uid/TP40001976-SW12" title="Built-in Support for Basic AppleScript Types"></a><h3>Built-in Support for Basic AppleScript Types</h3><p>Cocoa scripting provides built-in support for basic <a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_51"></a>AppleScript types and automatically associates them with appropriate Cocoa data types, as shown in <span class="content_text">Table 1-1</span>. You can use these types without declaring them in your sdef file.<a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_52"></a></p><a name="//apple_ref/doc/uid/TP40001976-SW11" title="Table 1-1Support for basic AppleScript types"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 1-1&nbsp;&nbsp;</strong>Support for basic AppleScript types</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>AppleScript type</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Cocoa type</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Code</p></th></tr><tr><td  scope="row"><p><code>any</code><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_53"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_54"></a></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSAppleEventDescriptor_Class/Reference/Reference.html#//apple_ref/occ/cl/NSAppleEventDescriptor" target="_top">NSAppleEventDescriptor</a></code></p></td><td ><p><code>"****"</code></p></td></tr><tr><td  scope="row"><p><code>boolean</code><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_55"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_56"></a></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSNumber_Class/Reference/Reference.html#//apple_ref/occ/cl/NSNumber" target="_top">NSNumber</a></code></p></td><td ><p><code>"bool"</code></p></td></tr><tr><td  scope="row"><p><code>date</code><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_57"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_58"></a></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSDate_Class/Reference/Reference.html#//apple_ref/occ/cl/NSDate" target="_top">NSDate</a></code></p></td><td ><p><code>"ldt "</code></p></td></tr><tr><td  scope="row"><p><code>file</code><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_59"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_60"></a></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSURL_Class/Reference/Reference.html#//apple_ref/occ/cl/NSURL" target="_top">NSURL</a></code></p></td><td ><p><code>"file"</code></p></td></tr><tr><td  scope="row"><p><code>integer</code><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_61"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_62"></a></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSNumber_Class/Reference/Reference.html#//apple_ref/occ/cl/NSNumber" target="_top">NSNumber</a></code></p></td><td ><p><code>"long"</code></p></td></tr><tr><td  scope="row"><p><code>location specifier</code><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_63"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_64"></a></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSPositionalSpecifier_Class/Reference/Reference.html#//apple_ref/occ/cl/NSPositionalSpecifier" target="_top">NSPositionalSpecifier</a></code></p></td><td ><p><code>"insl"</code></p></td></tr><tr><td  scope="row"><p><code>number</code><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_65"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_66"></a></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSNumber_Class/Reference/Reference.html#//apple_ref/occ/cl/NSNumber" target="_top">NSNumber</a></code></p></td><td ><p><code>"nmbr"</code></p></td></tr><tr><td  scope="row"><p><code>point</code><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_67"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_68"></a></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSData_Class/Reference/Reference.html#//apple_ref/occ/cl/NSData" target="_top">NSData</a></code> containing a QuickDraw <code>Point</code></p></td><td ><p><code>"QDpt"</code></p></td></tr><tr><td  scope="row"><p><code>real</code><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_69"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_70"></a></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSNumber_Class/Reference/Reference.html#//apple_ref/occ/cl/NSNumber" target="_top">NSNumber</a></code></p></td><td ><p><code>"doub"</code></p></td></tr><tr><td  scope="row"><p><code>record</code><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_71"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_72"></a></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSDictionary_Class/Reference/Reference.html#//apple_ref/occ/cl/NSDictionary" target="_top">NSDictionary</a></code></p><p>This type is used as the type of the <code>properties</code> property for the <code>item</code> class, and the type of the <code>with properties</code> parameters of the <code>duplicate</code> and <code>make</code> commands. Declaring something to be of type <code>record</code> doesn't provide enough information to convert Apple event record descriptors to <code>NSDictionary</code> objects, so various Cocoa scripting command classes have special code to handle that situation. In your code, instead of using the <code>record</code> type, you should declare specific record types (see <span class="content_text"><a href="../SApps_creating_sdef/SAppsCreateSdef.html#//apple_ref/doc/uid/TP40001977-1131361">“Record-Type Elements”</a></span>) and use those for <code>class</code> properties and <code>command</code> parameters.</p></td><td ><p><code>"reco"</code></p></td></tr><tr><td  scope="row"><p><code>rectangle</code><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_73"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_74"></a></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSData_Class/Reference/Reference.html#//apple_ref/occ/cl/NSData" target="_top">NSData</a></code> containing a QuickDraw <code>Rect</code></p></td><td ><p><code>"qdrt"</code></p></td></tr><tr><td  scope="row"><p><code>specifier</code><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_75"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_76"></a></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSScriptObjectSpecifier_Class/Reference/Reference.html#//apple_ref/occ/cl/NSScriptObjectSpecifier" target="_top">NSScriptObjectSpecifier</a></code></p></td><td ><p><code>"obj "</code></p></td></tr><tr><td  scope="row"><p><code>text</code><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_77"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_78"></a></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/cl/NSString" target="_top">NSString</a></code></p><ul class="simple"><li><p>Internally, Cocoa scripting always uses Unicode text when converting to get information from or add it to an Apple event.</p></li></ul></td><td ><p><code>"ctxt"</code></p></td></tr><tr><td  scope="row"><p><code>type</code><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_79"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_80"></a></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSNumber_Class/Reference/Reference.html#//apple_ref/occ/cl/NSNumber" target="_top">NSNumber</a></code></p></td><td ><p><code>"type"</code></p></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001976-SW1" title="Loading Scriptability Information"></a><h3>Loading Scriptability Information</h3><p><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_81"></a>When an application first needs to work with scriptability information, Cocoa scripting uses a global instance of <a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_82"></a><code><a href="../../../Reference/Foundation/Classes/NSScriptSuiteRegistry_Class/Reference/Reference.html#//apple_ref/occ/cl/NSScriptSuiteRegistry" target="_top">NSScriptSuiteRegistry</a></code> to load information from the application's sdef file:</p><ul class="spaceabove"><li class="li"><p>For each class described in the sdef file, it instantiates a <a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_83"></a>class description object (<code><a href="../../../Reference/Foundation/Classes/NSScriptClassDescription_Class/Reference/Reference.html#//apple_ref/occ/cl/NSScriptClassDescription" target="_top">NSScriptClassDescription</a></code>) that stores information about objects of that type.</p><p>This information includes the KVC keys that Cocoa scripting uses to access values of the application's scriptable objects.</p></li><li class="li"><p>For each script command described in the sdef file, it registers a handler routine for Apple events that specify that command.</p><p>It also instantiates a <a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_84"></a>command description object (<code><a href="../../../Reference/Foundation/Classes/NSScriptCommandDescription_Class/Reference/Reference.html#//apple_ref/occ/cl/NSScriptCommandDescription" target="_top">NSScriptCommandDescription</a></code>) that stores information such as the name of the scripting command class to instantiate to perform the command, as well as the command's arguments, and return type (if any).</p></li></ul><p><span class="content_text">Figure 1-5</span> shows the loaded class and command descriptions for an application. Cocoa uses the information to create instances of command classes and descriptions of application objects that it needs to handle Apple events received by the application.</p><br/><div><a name="//apple_ref/doc/uid/TP40001976-SW2" title="Figure 1-5An application&#39;s loaded scriptability information"></a><p><strong>Figure 1-5&nbsp;&nbsp;</strong>An application's loaded scriptability information</p><img src = "../Art/loaded_script_info2.gif" alt = "An application's loaded scriptability information" width="248" height="317"></div><br/><div class="importantbox"><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_4" title="Important:"></a><p><strong>Important:</strong>&nbsp;You don't typically instantiate scripting commands in your application—you list the commands your application supports in your sdef file and Cocoa instantiates them when your application receives the corresponding Apple events.</p><p>See <span class="content_text"><a href="../SApps_handle_AEs/SAppsHandleAEs.html#//apple_ref/doc/uid/20001239-BBCBCIJE">“How Cocoa Applications Handle Apple Events”</a></span> for information on how Cocoa handles Apple events other than those that are part of your application's scriptability information.</p><p></p></div><p>Application scriptability information automatically includes information to support the basic AppleScript types listed in <span class="content_text"><a href="SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-SW11">Table 1-1</a></span> and to make the <code>get</code> and <code>set</code> commands available to all applications.<a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_85"></a></p><a name="//apple_ref/doc/uid/TP40001976-SW7" title="Reliance on Key-Value Coding"></a><h2>Reliance on Key-Value Coding</h2><p><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_86"></a><strong>Key-value coding (KVC)</strong> is a mechanism for accessing object properties indirectly by key. A <strong>key</strong> is just a string that identifies a property, such as <code>"xPosition"</code> for the horizontal coordinate of a graphic object (shown in <span class="content_text"><a href="SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-SW4">Listing 1-1</a></span>). The KVC API provides a generic way to query an object for the values of its keys and to set new values for those keys.</p><p>Cocoa scripting relies on KVC for the following purposes:</p><ul class="ul"><li class="li"><p>Command objects use KVC to find the specified scriptable objects on which to operate.</p></li><li class="li"><p>For many commands, Cocoa uses KVC to access properties of the specified objects to get or set their values.</p></li></ul><p>As you design the object classes for your application, you also define keys for their scriptable properties. Your application provides these keys in <code>class</code> definitions in its sdef file. Then, when you implement accessor methods (or declare instance variables) that correspond to these keys, you make it possible for Cocoa scripting and KVC to get and set the corresponding values.</p><p>Default naming for keys is described in <span class="content_text"><a href="../SApps_implement/SAppsImplement.html#//apple_ref/doc/uid/20000037-SW1">“Provide Keys for Key-Value Coding.”</a></span>  For information on naming accessor methods, see  <span class="content_text"><a href="../SApps_get_set/SAppsGetSet.html#//apple_ref/doc/uid/TP40002164-CH18-SW4">“Maintain KVC Compliance.”</a></span></p><a name="//apple_ref/doc/uid/TP40001976-SW13" title="Interaction With Cocoa Bindings and Core Data"></a><h2>Interaction With Cocoa Bindings and Core Data</h2><p><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_87"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_88"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_89"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_90"></a>Cocoa scripting, Cocoa bindings, and Core Data are three development technologies available in Mac OS X that rely on key-value coding: </p><ul class="ul"><li class="li"><p>Cocoa scripting, described throughout this document, provides support for creating scriptable applications.</p></li><li class="li"><p>The Core Data framework provides generalized and automated solutions to common tasks associated with object life-cycle and object graph management, including persistence. It is described in detail in <em><a href="../../CoreData/index.html#//apple_ref/doc/uid/TP40001075" target="_top">Core Data Programming Guide</a></em>.</p></li><li class="li"><p>Cocoa bindings provides a means of keeping model and view values synchronized, without having to write a lot of "glue code," such that a change in one is reflected in the other. It is described in detail in <em><a href="../../CocoaBindings/index.html#//apple_ref/doc/uid/10000167i" target="_top">Cocoa Bindings Programming Topics</a></em>.</p></li></ul><p>As noted, all three of these technologies rely on KVC, so you will gain by making your application KVC-compliant. Cocoa bindings and Core Data also make use of key-value observing, but Cocoa scripting does not.</p><p>While these technologies are not closely tied together, here are some rules of thumb that may aid in combining their use:</p><ul class="ul"><li class="li"><p>Core Data and Cocoa bindings: These technologies neither aid nor interfere with each other, so you can mix them as needed for your application.</p></li><li class="li"><p>Core Data and Cocoa scripting: Because Cocoa scripting deals in ordered to-many relationships, and Core Data deals in unordered to-many relationships, you must do extra work to expose the to-many relationships of your managed objects as scriptable element classes. For each managed-object to-many relationship that you want to make scriptable, you can add an unmanaged, derived, to-many relationship solely for access by Cocoa scripting. For information about how to implement these derived to-many relationships, see "Indexed Accessor Patterns for To-Many Properties" in <span class="content_text"><a href="../../KeyValueCoding/Concepts/AccessorConventions.html#//apple_ref/doc/uid/20002174" target="_top">Key-Value Coding Accessor Methods</a></span> in <em><a href="../../KeyValueCoding/index.html#//apple_ref/doc/uid/10000107i" target="_top">Key-Value Coding Programming Guide</a></em> and <span class="content_text"><a href="../SApps_get_set/SAppsGetSet.html#//apple_ref/doc/uid/TP40002164-CH18-SW1">“Getting and Setting Properties and Elements”</a></span> in this document.</p></li><li class="li"><p>Cocoa scripting and Cocoa bindings: Again, these technologies neither aid nor interfere with each other. If you're using bindings but not Core Data, you probably have ordered relationships, which will work with Cocoa scripting.<a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_91"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_92"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_93"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_94"></a></p></li></ul><p>For related information, see <span class="content_text"><a href="../SApps_get_set/SAppsGetSet.html#//apple_ref/doc/uid/TP40002164-CH18-SW10">“Interaction With Key-Value Observing.”</a></span></p><a name="//apple_ref/doc/uid/TP40001976-SW20" title="Scriptability and Undo"></a><h2>Scriptability and Undo</h2><p><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_95"></a>Scriptable applications should generally support undo of scripted operations as they would any user-initiated operation. That is, after a script causes the application to perform one or more operations, a user should be able to sequentially undo the operations in the normal manner.</p><p>Cocoa scripting provides no special support for undo, but neither does it interfere with normal undo operations. Applications that take advantage of the Model-View-Controller paradigm and Cocoa's key-value coding mechanism, as scriptable applications are designed to do, are well-positioned to support both scriptability and undo.</p><p>For more information on supporting undo, see <em><a href="../../UndoArchitecture/index.html#//apple_ref/doc/uid/10000010i" target="_top">Undo Architecture</a></em>.</p><a name="//apple_ref/doc/uid/TP40001976-SW6" title="Snapshot of Cocoa Scripting"></a><h2>Snapshot of Cocoa Scripting</h2><p><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_96"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_97"></a>The work done by your scriptable application is divided between the application and Cocoa scripting. Your application implements classes and methods that perform its scriptable operations; it also provides information that describes its scriptability. Cocoa receives Apple events and uses your scriptability information to interpret them and perform the specified operations, calling on your code to do the actual work.</p><p>Here is a summary of how this process works:</p><ol class="ol"><li class="li"><p>The application defines scriptability information (in an sdef file, or in the older style script suite and script terminology files) that includes both the terms a scripter can use and the application information for supporting those terms. This information typically includes the Standard suite (implemented by Cocoa scripting), which supports standard AppleScript commands and classes.</p><p>The application defines classes for the scriptable objects it supports and provides keys for their scriptable properties and elements. It also defines additional script command classes if it has scriptable operations that can't be performed by one of the standard command classes provided by Cocoa.</p><p>Scriptability is generally provided through the application's model objects (in terms of the Model-View-Controller paradigm).</p></li><li class="li"><p>The application is key-value coding (KVC) compliant in naming the instance variables or accessor methods for the scriptable properties and elements of its scriptable classes.</p></li><li class="li"><p>For each scriptable class, the application implements an object specifier method, which locates a scriptable object of that type within the application’s containment hierarchy.</p></li><li class="li"><p>The application’s <code>Info.plist</code> file has entries that activate Cocoa scripting and specify an sdef file, as shown in <span class="content_text"><a href="../SApps_implement/SAppsImplement.html#//apple_ref/doc/uid/20000037-1081046">“Turn On Scripting Support in Your Application.”</a></span></p></li><li class="li"><p>When it is first needed, Cocoa loads the application's scriptability information and automatically registers event handlers for the supported commands.</p></li><li class="li"><p>When the application receives an Apple event for a registered command, Cocoa instantiates a script command object containing all the information needed to identify the application objects on which the command should operate. All command objects use KVC to locate the specified scriptable objects to operate on.</p><p>Cocoa then executes the command, which sends messages to the appropriate application objects to perform the work. For many commands, Cocoa uses KVC to get or set values of the specified objects.</p></li><li class="li"><p>When a command needs to return a value, Cocoa scripting packages the information in a reply Apple event and returns it.</p><p>If an error occurs while executing the command, Cocoa returns the error information (including any information added by the application) in the reply Apple event. For details, see <span class="content_text"><a href="../SApps_script_cmds/SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW3">“Error Handling.”</a></span></p></li><li class="li"><p>If a command requires asynchronous processing (such as the gathering of information through a sheet), the application can suspend it, so that the application doesn't receive additional Apple events during processing. For details, see <span class="content_text"><a href="../SApps_handle_AEs/SAppsHandleAEs.html#//apple_ref/doc/uid/20001239-1134778">“Suspending and Resuming Apple Events and Script Commands.”</a></span><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_98"></a></p></li></ol><a name="//apple_ref/doc/uid/TP40001976-1149806" title="A Real World Scripting Example"></a><h2>A Real World Scripting Example</h2><p><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_99"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_100"></a><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_101"></a>To track a scripting command from the execution of an AppleScript script to the operation it performs in the targeted application, consider again the following one-line script, which attempts to set a value in a document of the Sketch application:</p><div class="codesample"><table><tr><td scope="row"><pre>tell app "Sketch" to set the x position of rectangle 1 of document "SketchDocOne" to 25<span></span></pre></td></tr></table></div><p>When this script is compiled against Sketch's scriptability information and executed, it results in an Apple event being sent to the Sketch application.  The Apple event encapsulates the <code>set</code> command and specifies an operation on  an object in the <code>"SketchDocOne"</code> document shown in <span class="content_text"><a href="SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-SW5">Figure 1-2</a></span>. <span class="content_text">Figure 1-6</span> illustrates the actions that result when the application receives the <code>set</code> Apple event.</p><br/><div><a name="//apple_ref/doc/uid/TP40001976-CJBDDFFI" title="Figure 1-6A Cocoa application responding to an Apple event "></a><p><a name="//apple_ref/doc/uid/TP40001976-1152305" title="Figure 1-6A Cocoa application responding to an Apple event "></a><strong>Figure 1-6&nbsp;&nbsp;</strong>A Cocoa application responding to an Apple event </p><img src = "../Art/cocoascriptapp2.gif" alt = "A Cocoa application responding to an Apple event" width="529" height="316"></div><br/><p>Here is a description of the steps shown in this figure:</p><ol class="ol"><li class="li"><p>The application receives the Apple event specifying a <code>set</code> command.</p></li><li class="li"><p>The <a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_102"></a><strong>Apple event translator</strong>, a part of Cocoa scripting, uses scriptability information supplied by the application to evaluate the Apple event. This information is pictured in more detail in <span class="content_text"><a href="SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-SW2">Figure 1-5</a></span>.</p></li><li class="li"><p>The translator creates an instance of an <code>NSSetCommand</code> script command and initializes it with the information need to perform the command:</p><ul class="ul"><li class="li"><p>The direct parameter of the <code>set</code> command specifies the object or objects to set the value for (in this case, the first rectangle), and becomes the receivers specifier in the  <code>NSSetCommand</code> object.</p></li><li class="li"><p>The <code>to</code> parameter provides the value to set (in this case, <code>25</code>) and becomes the "Value" argument in the <code>NSSetCommand</code> object.</p></li></ul><p>These values are stored in the command object as an argument dictionary. For information on how your application works with that information, see <span class="content_text"><a href="../SApps_script_cmds/SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW15">“Script Command Components.”</a></span></p></li><li class="li"><p>When the <code>set</code> command is executed, it uses KVC to locate the specified object or objects. It also relies on KVC to set the specified value. For additional detail, see <span class="content_text"><a href="../SApps_get_set/SAppsGetSet.html#//apple_ref/doc/uid/TP40002164-CH18-SW1">“Getting and Setting Properties and Elements.”</a></span></p><p>Some commands return a value, but the <code>set</code> command does not.</p></li></ol><p>As this example and the information in <span class="content_text"><a href="SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-SW6">“Snapshot of Cocoa Scripting”</a></span> show, an application can support the <code>set</code> command with a relatively modest effort: it modifies its <code>Info.plist</code> file to indicate it is scriptable and to specify its sdef file; it provides command and class information in the sdef file; and it maintains KVC compliance for scriptable properties in its scriptable classes.</p><p>If the application also implements an <code>objectSpecifier</code> method for each of its scriptable classes, it can support the <code>get</code> command as well. Cocoa scripting uses KVC to get the specified value from the application and package it up in a return Apple event.</p><p>As a result, an application can rather quickly supply a great deal of scriptability just by supporting <code>get</code> and <code>set</code> access to properties of a few key objects.<a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_103"></a></p><a name="//apple_ref/doc/uid/TP40001976-SW21" title="Current Limitations of Cocoa Scripting Support"></a><h2>Current Limitations of Cocoa Scripting Support</h2><p><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_104"></a>There are some scripting-related features for which Cocoa scripting currently provides little or no support.</p><ul class="ul"><li class="li"><p><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_105"></a>Sending individual Apple events. Applications might want to send events to other scriptable applications or to themselves to obtain data or services or to support recording (see next item).</p><p>However, Cocoa applications are free to use C functions from the Apple Event Manager. So, for example, your application could use an instance of <code><a href="../../../Reference/Foundation/Classes/NSAppleEventDescriptor_Class/Reference/Reference.html#//apple_ref/occ/cl/NSAppleEventDescriptor" target="_top">NSAppleEventDescriptor</a></code> to assemble the information for an Apple event, invoke the <code>aeDesc</code> method to get an Apple event data structure, and use that structure with the C functions described in <em><a href="../../../../AppleScript/Conceptual/AppleEvents/index.html#//apple_ref/doc/uid/TP40001449" target="_top">Apple Events Programming Guide</a></em> to send the Apple event.</p></li><li class="li"><p><a name="//apple_ref/doc/uid/TP40001976-DontLinkElementID_106"></a>Recording. A recordable application sends itself Apple events, which can be assembled by the Script Editor application into a script that “records” the user’s actions (when recording is turned on in Script Editor).</p></li></ul><p>Cocoa scripting does not currently enforce the <code>read/write</code> status specified in an sdef, so marking a property as read-only does not ensure that it cannot be written. (Read/write access is described in <span class="content_text"><a href="../SApps_creating_sdef/SAppsCreateSdef.html#//apple_ref/doc/uid/TP40001979-1145406">“Property Elements.”</a></span>)</p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../SApps_intro/SAppsIntro.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../SApps_design_apps/SAppsDesignApp.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-03-11<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Conceptual/ScriptableCocoaApplications/SApps_about_apps/SAppsAboutApps.html%3Fid%3DTP40002164-2.4&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Conceptual/ScriptableCocoaApplications/SApps_about_apps/SAppsAboutApps.html%3Fid%3DTP40002164-2.4&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Conceptual/ScriptableCocoaApplications/SApps_about_apps/SAppsAboutApps.html%3Fid%3DTP40002164-2.4&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>