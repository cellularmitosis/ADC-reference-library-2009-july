<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>QuickTime Initialization Guide: Initializing QuickTime</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Initializing QuickTime"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001435-2" title="Initializing QuickTime"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000433" target="_top">QuickTime</a> &gt; <a href="../../../MovieBasics-date.html#//apple_ref/doc/uid/TP30000440-TP30000433-TP30000545" target="_top">Movie Basics</a> &gt; <a href="../InitializingQTAIntroduction/Introduction_intro.html#//apple_ref/doc/uid/TP40001435-CH000-IntroductiontoIntroductiontoQuickTimeInitializationGuide">QuickTime Initialization Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../InitializingQTAIntroduction/Introduction_intro.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../InitializingQTRevHistory/revisionhistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40001435-2-InitializingQuickTime" title="Initializing QuickTime"></a><h1>Initializing QuickTime</h1><p>QuickTime must be initialized before applications or components can make calls to the QuickTime Movie Toolbox.</p><p>If you are writing a threaded application, and intend to call QuickTime functions from multiple threads, you need to initialize QuickTime for each worker thread explicitly.</p><p>Windows applications must initialize the QuickTime Media Layer (QTML), prior to initializing QuickTime itself. This also serves to verify that QuickTime for Windows is installed.</p><p>As part of the initialization process, it is usually advisable to check the installed version of QuickTime to ensure that all required features are present on the user’s machine. This can also serve as a method to verify that QuickTime is installed prior to initializing it.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="InitializingQTfinal.html#//apple_ref/doc/uid/TP40001435-2-InitializingQuickTimeMediaLayerforWindows">Initializing QuickTime Media Layer for Windows</a>
				
			<br/>
			
        
			
			
				<a href="InitializingQTfinal.html#//apple_ref/doc/uid/TP40001435-2-CheckingtheQuickTimeVersion">Checking the QuickTime Version</a>
				
			<br/>
			
        
			
			
				<a href="InitializingQTfinal.html#//apple_ref/doc/uid/TP40001435-2-InitializingaQuickTimeEnvironment">Initializing a QuickTime Environment</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001435-2-InitializingQuickTimeMediaLayerforWindows" title="Initializing QuickTime Media Layer for Windows"></a><h2>Initializing QuickTime Media Layer for Windows</h2><p>If your application runs on a Windows operating system, you need to verify that QuickTime is installed and initialize the QuickTime Media Layer (QTML). A single call to <code><!--a target="_top" -->InitializeQTML<!--/a--></code> does both. <span class="content_text"><a href="InitializingQTfinal.html#//apple_ref/doc/uid/TP40001435-2-SW1">Listing 2-1</a></span> shows the call to <code><!--a target="_top" -->InitializeQTML<!--/a--></code>.</p><a name="//apple_ref/doc/uid/TP40001435-2-SW1" title="Listing 2-1Calling InitializeQTML"></a><p class="codesample"><strong>Listing 2-1&nbsp;&nbsp;</strong>Calling InitializeQTML</p><div class="codesample"><table><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>static void QuickTimeQTML (void)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>  OSErr err;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    err = InitializeQTML(0L);<span></span></pre></td></tr><tr><td scope="row"><pre>    CheckError (err, "InitializeQTML error" );<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Use the <code><!--a target="_top" -->InitializeQTML<!--/a--></code> function to initialize QuickTime before calling any other QuickTime function. It is recommended that you call <code><!--a target="_top" -->InitializeQTML<!--/a--></code> at the very beginning of your program, in your  <code>WinMain</code>  function, before creating your main window.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001435-2-SW2" title="WARNING"></a><p><strong>WARNING:</strong>&nbsp;Do not call <code><!--a target="_top" -->InitializeQTML<!--/a--></code> from the <code>DllMain</code> procedure of a DLL! Instead, call InitializeQTML from the same routine that initializes your DLL. </p></div><p><code><!--a target="_top" -->InitializeQTML<!--/a--></code> supports flags that allow you to specify how QuickTime should behave. For example, you can tell QuickTime to operate exclusively in full-screen mode, or to use the Windows Graphics Device Interface (GDI) for all drawing, rather than the DirectDraw or DCI services.</p><p>If QuickTime is not installed, the <code><!--a target="_top" -->InitializeQTML<!--/a--></code> function is not available and an error is returned.</p><p>If your application is distributed on a CD, you should include QuickTime installers on the disc and run the Windows installer if QuickTime is not present. (Including the installer requires a license from Apple, but there is currently no fee for such a license. To obtain a license, click the QuickTime link at <span class="content_text"><a href="http://developer.apple.com/softwarelicensing/agreements/quicktime.html" target="_top">http://developer.apple.com/softwarelicensing/agreements/quicktime.html</a></span> and follow the instructions there.) Alternatively, you may prompt the user to download QuickTime at <span class="content_text"><a href="http://www.apple.com/quicktime/download/" target="_blank">http://www.apple.com/quicktime/download/</a></span>.</p><p>If you are writing a routine that does not know whether <code><!--a target="_top" -->InitializeQTML<!--/a--></code> has already been called, call <code><!--a target="_top" -->InitializeQTML<!--/a--></code> at the beginning of the routine and <code><!--a target="_top" -->TerminateQTML<!--/a--></code> at the end.</p><p>It does no harm to call <code><!--a target="_top" -->InitializeQTML<!--/a--></code> more than once, as long as each call is nested with a matching call to <code><!--a target="_top" -->TerminateQTML<!--/a--></code>. If this function has already been called, subsequent calls do nothing except increment a counter. Calls to <code><!--a target="_top" -->TerminateQTML<!--/a--></code> just decrement the counter (if it is nonzero). Only the first nested call and the last nested call to <code><!--a target="_top" -->TerminateQTML<!--/a--></code> do any actual work, so there is no penalty for having multiple nested calls.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001435-2-SW3" title="Important"></a><p><strong>Important:</strong>&nbsp;You should not make this call from a QuickTime component such as an image decompressor; it is provided only for host applications. QuickTime components can assume that QTML has been initialized. </p></div><p>Once the QuickTime Media Layer has been initialized, Windows programmers should follow the same steps that Mac OS programmers follow to test the QuickTime version and initialize QuickTime itself.</p><a name="//apple_ref/doc/uid/TP40001435-2-CheckingtheQuickTimeVersion" title="Checking the QuickTime Version"></a><h2>Checking the QuickTime Version</h2><p>Your application may want to check the version of QuickTime installed on the user’s system at runtime, to determine if all the needed features are supported. You should do this before initializing QuickTime.</p><p>To get the version of QuickTime installed on the user’s computer, call the <code>Gestalt</code> function (the necessary parts of which are included in QuickTime for Windows). The <code>Gestalt</code> function returns the  QuickTime version if the appropriate selectors are passed in, as shown in <span class="content_text"><a href="InitializingQTfinal.html#//apple_ref/doc/uid/TP40001435-2-SW4">Listing 2-2</a></span>.</p><a name="//apple_ref/doc/uid/TP40001435-2-SW4" title="Listing 2-2Getting the QuickTime version with Gestalt"></a><p class="codesample"><strong>Listing 2-2&nbsp;&nbsp;</strong>Getting the QuickTime version with Gestalt</p><div class="codesample"><table><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    /* check the version of QuickTime installed */<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    long version;<span></span></pre></td></tr><tr><td scope="row"><pre>    OSErr result;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    result = Gestalt(gestaltQuickTime,&amp;version);<span></span></pre></td></tr><tr><td scope="row"><pre>    if ((result == noErr) &amp;&amp; (version >= 0x05020000))<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>        /* we have version 5.0.2 or later */<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001435-2-InitializingaQuickTimeEnvironment" title="Initializing a QuickTime Environment"></a><h2>Initializing a QuickTime Environment</h2><p>Your application initializes a working QuickTime environment by calling <code><a href="../../../Reference/QTRef_MovieManager/Reference/reference.html#//apple_ref/c/func/EnterMovies" target="_top">EnterMovies</a></code>.</p><div class="codesample"><table><tr><td scope="row"><pre>    EnterMovies();<span></span></pre></td></tr></table></div><p>If you are writing a routine that does not know whether QuickTime has already been initialized, go ahead and call <code><a href="../../../Reference/QTRef_MovieManager/Reference/reference.html#//apple_ref/c/func/EnterMovies" target="_top">EnterMovies</a></code>; repeated calls do no harm.</p><p>You do not need to balance calls to <code><a href="../../../Reference/QTRef_MovieManager/Reference/reference.html#//apple_ref/c/func/EnterMovies" target="_top">EnterMovies</a></code> with calls to <code><a href="../../../Reference/QTRef_MovieManager/Reference/reference.html#//apple_ref/c/func/ExitMovies" target="_top">ExitMovies</a></code>. Call <code><a href="../../../Reference/QTRef_MovieManager/Reference/reference.html#//apple_ref/c/func/ExitMovies" target="_top">ExitMovies</a></code> only if you are done using QuickTime and want to free the resources as soon as possible without terminating your application. <code><a href="../../../Reference/QTRef_MovieManager/Reference/reference.html#//apple_ref/c/func/ExitMovies" target="_top">ExitMovies</a></code> is called automatically when your application quits.</p><p>Windows users need to initialize QTML before calling <code><a href="../../../Reference/QTRef_MovieManager/Reference/reference.html#//apple_ref/c/func/EnterMovies" target="_top">EnterMovies</a></code>, as shown in <span class="content_text"><a href="InitializingQTfinal.html#//apple_ref/doc/uid/TP40001435-2-SW5">Listing 2-3</a></span>.</p><a name="//apple_ref/doc/uid/TP40001435-2-SW5" title="Listing 2-3Initializing QTML and QuickTime for Windows"></a><p class="codesample"><strong>Listing 2-3&nbsp;&nbsp;</strong>Initializing QTML and QuickTime for Windows</p><div class="codesample"><table><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>static void InitQTMLandQuickTime (void)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>  OSErr err;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    err = InitializeQTML(0L);<span></span></pre></td></tr><tr><td scope="row"><pre>    CheckError (err, "InitializeQTML error" );<span></span></pre></td></tr><tr><td scope="row"><pre>    EnterMovies();<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><div class="notebox"><a name="//apple_ref/doc/uid/TP40001435-2-SW6" title="Note"></a><p><strong>Note:</strong>&nbsp;QuickTime components for Windows must call <code><a href="../../../Reference/QTRef_MovieManager/Reference/reference.html#//apple_ref/c/func/EnterMovies" target="_top">EnterMovies</a></code> if they call any QuickTime functions, even though they do not call <code><!--a target="_top" -->InitializeQTML<!--/a--></code>. </p></div><p><code><a href="../../../Reference/QTRef_MovieManager/Reference/reference.html#//apple_ref/c/func/EnterMovies" target="_top">EnterMovies</a></code> initializes a single, non-reentrant QuickTime environment for your application.</p><p>If your application uses QuickTime on multiple threads simultaneously, call <code>EnterMoviesOnThread</code> from each thread that uses QuickTime to create a local QuickTime environment for that thread (requires QuickTime 6 or later).</p><p>For more information about threaded programming and QuickTime, see Technical Note TN2125, <span class="content_text"><a href="../../../../../technotes/tn/tn2125.html" target="_top">Thread-safe programming in QuickTime.</a></span></p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../InitializingQTAIntroduction/Introduction_intro.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../InitializingQTRevHistory/revisionhistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2004, 2005 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2005-04-08<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/QuickTime/Conceptual/QT_InitializingQT/InitializingQT/InitializingQTfinal.html%3Fid%3DTP40001435-1.2&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/QuickTime/Conceptual/QT_InitializingQT/InitializingQT/InitializingQTfinal.html%3Fid%3DTP40001435-1.2&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/QuickTime/Conceptual/QT_InitializingQT/InitializingQT/InitializingQTfinal.html%3Fid%3DTP40001435-1.2&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>