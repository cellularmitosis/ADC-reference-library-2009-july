<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Writing Your Own Balloon Definition Function (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING156></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-155.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-157.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-138.html"><B>Chapter 3 - Help Manager</B></A> / <A HREF="MoreToolbox-143.html"><B>Using the Help Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING156-0></A>
<H2><A NAME=MARKER-9-412></A><A NAME=MARKER-21-413></A>Writing Your Own Balloon Definition Function</H2>
 <A NAME=MARKER-9-406></A>The Help Manager takes care of positioning, sizing, and drawing your help balloons, and the standard balloon definition function provides a consistent and attractive shape to balloons across all applications.<P>
 Although it takes extra work on your part, and your balloons will not share the consistent appearance of help balloons used by the Finder and by other applications, you can create your own balloon definition function. The balloon definition function defines the appearance of the help balloon, which is a special type of window. You implement a balloon definition function by writing a window definition function that performs the tasks described in this section. The standard balloon definition function is of type <CODE>'WDEF'</CODE> with resource ID 126.<P>
 A balloon definition function is responsible for calculating the content region and structure region of the help balloon window and drawing the frame of the help balloon. The content region is the area inside the balloon frame; it contains the help message. The structure region is the boundary region of the entire balloon, including the content area and the pointer that extends from one of the help balloon's corners. (<A HREF=MoreToolbox-140.html#MARKER-9-48>Figure 3-4 on page 3-9</A> illustrates the structure regions of the eight standard help balloons.)<A NAME=MARKER-2-163></A><A NAME=MARKER-2-416></A><A NAME=MARKER-2-168></A><A NAME=MARKER-2-171></A><P>
 The Help Manager first calculates the size of the rectangle that can enclose the help message and determines where to display the help balloon. The Help Manager uses TextEdit to determine any word and line breaks in the help message. The Help Manager determines where to display the help balloon based on the tip and alternate rectangle.<P>
 The Help Manager then adds a system-defined distance to the size of the rectangle. This distance allows for the tip of the help balloon. Note that the tip must always align with an edge of the boundary rectangle. The Help Manager uses the resulting rectangle as the boundary rectangle for the help balloon window.<P>
 To create the help balloon, the Help Manager uses the Window Manager function <CODE>NewWindow</CODE>. The Help Manager specifies the calculated rectangle and the window definition ID as parameters to <CODE>NewWindow</CODE>.<P>
 The <CODE>NewWindow</CODE> function calls the balloon definition function in the same manner as a window definition function. See the chapter "Window Manager" in <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I> for more information on writing a window definition function.<P>
 The <CODE>NewWindow</CODE> function calls your balloon definition function with four parameters: the variation code that specifies the shape and relative tip position of the help balloon, a pointer to the window, the action to perform, and a parameter that has variable contents depending on the action to perform.<P>
 Here's an example that shows the declaration for a balloon definition function called <CODE>MyBalloonDef</CODE>.<P>
<PRE>
FUNCTION MyBalloonDef (variant: Integer; theBalloon: WindowPtr; 
                       message: Integer; 
                       param: LongInt): LongInt;
</PRE>
 The <CODE>variant</CODE> parameter is the variation code used to specify the shape and position of the help balloon. You should use the same relative position for the tip of the help balloon that the standard variation codes 0 through 7 specify (see <A HREF=MoreToolbox-140.html#MARKER-9-48>Figure 3-4 on page 3-9</A>). This ensures that the tip of the help balloon points to the object that the help balloon describes.<P>
 The parameter <CODE>theBalloon</CODE> is a pointer to the window of the help balloon.<P>
 The <CODE>message</CODE> parameter identifies the action your balloon definition function should perform. Your balloon definition function can be sent the same messages as a window definition function, but the only ones your balloon definition function needs to process are the <CODE>wDraw</CODE> and <CODE>wCalcRgns</CODE> messages.<P>
 When your balloon definition function receives the <CODE>wCalcRgns</CODE> message, your function should calculate the content region and structure region of the help balloon. When your balloon definition function receives the <CODE>wDraw</CODE> message, your function should draw the frame of the help balloon. If you want to process other messages in your balloon definition function (for example, performing any additional initialization), you can also process the other standard <CODE>'WDEF'</CODE> messages. These messages, along with the <CODE>wDraw</CODE> and <CODE>wCalcRgns</CODE> messages, are described in the chapter "Window Manager" in <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I>.<P>
 The value of the <CODE>param</CODE> parameter depends on the value of the <CODE>message</CODE> parameter. The <CODE>wCalcRgns</CODE> and <CODE>wDraw</CODE> messages do not use this parameter.<P>
 If you want the Help Manager to use your balloon definition function, you specify its resource ID and the desired variation code either in the <CODE>HMShowBalloon</CODE> function or in the appropriate elements of the <CODE>'hmnu'</CODE>, <CODE>'hdlg'</CODE>, or <CODE>'hrct'</CODE> resource. The Help Manager derives your balloon's window definition ID from its resource ID.<A NAME=MARKER-2-139></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-155.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-157.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
