<html><head><title>Mac OS X
 Manual Page For vfs_full_audit(8)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/8/vfs_full_audit" title="Mac OS X
 Manual Page for vfs_full_audit(8)"><!-- headerDoc=man; indexgroup=Section 8; uid="//apple_ref/doc/man/8/vfs_full_audit"; name=vfs_full_audit(8) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
VFS_FULL_AUDIT(8)                                                                          VFS_FULL_AUDIT(8)



<b>NAME</b>
       vfs_full_audit - record Samba VFS operations in the system log

<b>SYNOPSIS</b>
       vfs objects = full_audit

<b>DESCRIPTION</b>
       This VFS module is part of the <a href="../man7/samba.7.html#//apple_ref/doc/man/7/samba"><b>samba</b>(7)</a> suite.

       The vfs_full_audit VFS module records selected client operations to the system log using <a href="../man3/syslog.3.html#//apple_ref/doc/man/3/syslog"><b>syslog</b>(3)</a>.

       vfs_full_audit is able to record the complete set of Samba VFS operations:

          aio_cancel

          aio_error

          aio_fsync

          aio_read

          aio_return

          aio_suspend

          aio_write

          chdir

          chflags

          chmod

          chmod_acl

          chown

          close

          closedir

          connect

          disconnect

          disk_free

          fchmod

          fchmod_acl

          fchown

          fget_nt_acl

          fgetxattr

          flistxattr

          fremovexattr

          fset_nt_acl

          fsetxattr

          fstat

          fsync

          ftruncate

          get_nt_acl

          get_quota

          get_shadow_copy_data

          getlock

          getwd

          getxattr

          kernel_flock

          lgetxattr

          link

          linux_setlease

          listxattr

          llistxattr

          lock

          lremovexattr

          lseek

          lsetxattr

          lstat

          mkdir

          mknod

          open

          opendir

          pread

          pwrite

          read

          readdir

          readlink

          realpath

          removexattr

          rename

          rewinddir

          rmdir

          seekdir

          sendfile

          set_nt_acl

          set_quota

          setxattr

          stat

          statvfs

          symlink

          sys_acl_add_perm

          sys_acl_clear_perms

          sys_acl_create_entry

          sys_acl_delete_def_file

          sys_acl_free_acl

          sys_acl_free_qualifier

          sys_acl_free_text

          sys_acl_get_entry

          sys_acl_get_fd

          sys_acl_get_file

          sys_acl_get_perm

          sys_acl_get_permset

          sys_acl_get_qualifier

          sys_acl_get_tag_type

          sys_acl_init

          sys_acl_set_fd

          sys_acl_set_file

          sys_acl_set_permset

          sys_acl_set_qualifier

          sys_acl_set_tag_type

          sys_acl_to_text

          sys_acl_valid

          telldir

          unlink

          utime

          write

       In  addition  to  these  operations,  vfs_full_audit recognizes the special operation names "all" and
       "none ", which refer to all the VFS operations and none of the VFS operations respectively.

       vfs_full_audit records operations in fixed format consisting of fields separated by  '|'  characters.
       The format is:


                 smbd_audit: PREFIX|OPERATION|RESULT|FILE


       The record fields are:

         PREFIX - the result of the full_audit:prefix string after variable substitutions

         OPERATION - the name of the VFS operation

         RESULT - whether the operation succeeded or failed

         FILE - the name of the file or directory the operation was performed on

       This module is stackable.

<b>OPTIONS</b>
       vfs_full_audit:prefix = STRING
          Prepend audit messages with STRING. STRING is processed for standard substitution variables listed
          in <a href="../man5/smb.conf.5.html#//apple_ref/doc/man/5/smb.conf"><b>smb.conf</b>(5)</a>. The default prefix is "%u|%I".

       vfs_full_audit:success = LIST
          LIST is a list of VFS operations that should be recorded if they succeed. Operations are specified
          using the names listed above.

       vfs_full_audit:failure = LIST
          LIST  is a list of VFS operations that should be recorded if they failed. Operations are specified
          using the names listed above.

       full_audit:facility = FACILITY
          Log messages to the named <a href="../man3/syslog.3.html#//apple_ref/doc/man/3/syslog"><b>syslog</b>(3)</a> facility.

       full_audit:priority = PRIORITY
          Log messages with the named <a href="../man3/syslog.3.html#//apple_ref/doc/man/3/syslog"><b>syslog</b>(3)</a> priority.

<b>EXAMPLES</b>
       Log file and directory open operations on the [records] share using the  LOCAL7  facility  and  ALERT
       priority, including the username and IP address:


               <u>[records]</u>
            path = /data/records
            vfs objects = full_audit
            full_audit:prefix = %u|%I
            full_audit:success = open opendir
            full_audit:failure = all
            full_audit:facility = LOCAL7
            full_audit:priority = ALERT


<b>VERSION</b>
       This man page is correct for version 3.0.25 of the Samba suite.

<b>AUTHOR</b>
       The  original  Samba  software  and  related  utilities were created by Andrew Tridgell. Samba is now
       developed by the Samba Team as an Open Source project similar to the way the Linux kernel  is  devel-<font color="#ffffff" class="whiteout">oped.&nbsp;developed.</font>
       oped.




                                                                                           VFS_FULL_AUDIT(8)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man8/vfs_full_audit.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man8/vfs_full_audit.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man8/vfs_full_audit.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
