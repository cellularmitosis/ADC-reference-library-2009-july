<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>QuickTime Movie Creation Guide: Sequence Grabber Panel Components</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Sequence Grabber Panel Components"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents" title="Sequence Grabber Panel Components"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000433" target="_top">QuickTime</a> &gt; <a href="../../../../MovieCreation-date.html#//apple_ref/doc/uid/TP30000440-TP30000433-TP30000501" target="_top">Movie Creation</a> &gt; <a href="../A-Intro/1Introduction.html#//apple_ref/doc/uid/TP40000906-IntroductiontoQuickTimeMovieCreationGuide-DontLinkElementID_142">QuickTime Movie Creation Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../D-Chapter/4SequenceGrabberComp.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../F-Chapter/6SequenceGrabberChan.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-SW1" title="Sequence Grabber Panel Components"></a>
<h1>Sequence Grabber Panel Components</h1>

<p>This chapter describes sequence grabber panel components and explains how they are used. Because applications never call sequence grabber panel components directly, only developers planning to create panel components need to read this chapter.</p>
<p>A sequence grabber panel component presents a settings dialog box to the user that affects the behavior of a channel component. For example, a dialog might let the user control the frame capture rate of a video digitizer and the image quality of an image compressor. The user settings dialog box can be customized to include any required options by creating a new component.</p>



<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="5SequenceGrabberPane.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-DontLinkElementID_67">How Sequence Grabber Panel Components Work</a>
				
			<br/>
			
        
			
			
				<a href="5SequenceGrabberPane.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-DontLinkElementID_68">Creating Sequence Grabber Panel Components</a>
				
			<br/>
			
        
			
			
				<a href="5SequenceGrabberPane.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-DontLinkElementID_69">Managing Your Panel Component</a>
				
			<br/>
			
        
			
			
				<a href="5SequenceGrabberPane.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-DontLinkElementID_74">Managing the Dialog Box</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-DontLinkElementID_67" title="How Sequence Grabber Panel Components Work"></a>
<h2><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-HowSequenceGrabberPanelComponentsWork" title="How Sequence Grabber Panel Components Work"></a>How Sequence Grabber Panel Components Work</h2>
<p>This section provides background information about sequence grabber panel components. After reading this section, you should understand why these components exist and whether you need to create one.</p>
<p>Sequence grabber panel components augment the capabilities of sequence grabber components and sequence grabber channel components by allowing sequence grabbers to obtain configuration information from the user for a particular digitizing source that is managed by a channel component. Consequently, sequence grabbers, channel components, and panel components have a close relationship.</p>
<p>Figure 4-1 shows this relationship and how these components interact with one another to place digitized data into a QuickTime movie.</p>
<br/><div><img src = "../Art/seq_grab_panel_components.jpg" alt = "../art/QTC-L-34.eps" ></div><br/>
<p>Sequence grabbers present a settings dialog box to the user whenever an application calls the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSettingsDialog" target="_top">SGSettingsDialog</a></code> function (see <span class="content_text"><a href="../D-Chapter/4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-SW1">Sequence Grabber Component Functions</a></span> for more information about this sequence grabber function). Applications never call sequence grabber panel components directly; application developers use panel components only by calling the sequence grabber component.</p>
<p>Although the sequence grabber creates the dialog box and manages its interactions with the user, portions of the dialog box are controlled by panel components and channel components.</p>
<p>Figure 4-2 shows a sample dialog box and identifies the various parts of the dialog box.</p>
<br/><div><img src = "../Art/seq_grabber_dialog_box.jpg" alt = "A sample sequence grabber settings dialog box" ></div><br/>
<p>The sequence grabber creates the dialog box itself and manages the OK and Cancel buttons and the panel pop-up menu. Channel components are responsible for the monitor area on the right side of the dialog box. Panel components manage the settings area immediately below the panel pop-up menu. Only one panel component is active at any given time; the user selects a panel component by manipulating the panel pop-up menu.</p>
<p>When the user selects a specific panel component, the sequence grabber works with that component to build the panel settings dialog area and present it to the user. The panel component processes dialog events and mouse clicks as appropriate and validates the user’s settings. The sequence grabber then retrieves the settings from the panel component and stores those settings.</p>
<p>There are two circumstances under which you should consider creating a sequence grabber panel component:</p>
<ul class="ul">
<li class="li"><p>First, if you want to support special digitizing equipment in the QuickTime environment;</p></li>
<li class="li"><p>Second, if you have created your own sequence grabber channel component.</p></li>
</ul>
<p>If you have created special digitizing equipment, you may not have to create a special channel component for your equipment; the channel components provided by Apple may be sufficient for your needs. By providing a special panel component, however, you can allow the user to take advantage of your equipment’s special capabilities.</p>
<p>If you have created your own channel component, you must create an accompanying panel component to allow the user to configure your channel.</p>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-DontLinkElementID_68" title="Creating Sequence Grabber Panel Components"></a>
<h2><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-CreatingSequenceGrabberPanelComponents" title="Creating Sequence Grabber Panel Components"></a>Creating Sequence Grabber Panel Components</h2>
<p>This section discusses how to create a sequence grabber panel component. You should read this section if you are creating a panel component.</p>
<p>Applications do not call panel components directly. Rather, they invoke a sequence grabber’s settings dialog box by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSettingsDialog" target="_top">SGSettingsDialog</a></code> function. In response, the sequence grabber presents the settings dialog box to the user. When the user selects a specific settings panel, the sequence grabber invokes the appropriate panel component.</p>
<p>Panel components provide a number of functions that allow sequence grabbers to manage their relationships with panel components. See <span class="content_text"><a href="5SequenceGrabberPane.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-ManagingYourPanelComponent">Managing Your Panel Component</a></span> for complete descriptions of these functions.</p>
<p>Panel components are not responsible for saving their settings information. Sequence grabbers manage this information on behalf of panel components, and a sequence grabber may combine configuration information from several panel components in order to build up the complete configuration for an elaborate digitizing environment. Panel components provide functions that allow sequence grabbers to obtain this configuration information. See <span class="content_text"><a href="5SequenceGrabberPane.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-ManagingYourPanelsSettings">Managing Your Panel’s Settings</a></span> for more information about these functions.</p>
<p>Sequence grabbers store this configuration data in user data items. The Movie Toolbox provides a number of functions that allow you to create and manage user data items.</p>
<p>Apple has defined a component type value for sequence grabber panel components. You can use the following constant to specify this component type:</p>

<div class="codesample"><table><tr><td scope="row"><pre>#define     SeqGrabPanelType 'sgpn'         /* panel component type */<span></span></pre></td></tr></table></div>

<p>Sequence grabber panel components use their component subtype and manufacturer values to indicate the type of configuration services they provide. The subtype value indicates the media type supported by the panel component. This value should correspond to the component subtype value of channel components that may be configured by the panel component. For example, a panel component that manages video settings would have a subtype of <code><!--a target="_top" -->'vide'<!--/a--></code> (this value is defined by the Movie Toolbox’s <code>VideoMediaType</code> constant).</p>
<p>The manufacturer field contains a unique identifier for each panel component. The value should indicate something about the specific services provided by the component. For example, Apple has defined the following manufacturer values:</p>

<div class="codesample"><table><tr><td scope="row"><pre>#define   SeqGrabCompressionPanelType  'sour'  /* input source selection */<span></span></pre></td></tr><tr><td scope="row"><pre>#define   SeqGrabSourcePanelType       'cmpr'  /* compression settings */<span></span></pre></td></tr></table></div>

<p>In general, Apple has reserved all lowercase values of component subtypes and manufacturer codes.</p>
<p>Apple has defined a functional interface for sequence grabber panel components. You may use the following constants to refer to the request codes for each of the functions that your component must support:</p>

<div class="codesample"><table><tr><td scope="row"><pre>enum {<span></span></pre></td></tr><tr><td scope="row"><pre>    /* sequence grabber panel request codes */<span></span></pre></td></tr><tr><td scope="row"><pre>    kSGCPanelGetDitlSelect         = 0x200,    /* SGPanelGetDITL */<span></span></pre></td></tr><tr><td scope="row"><pre>    kSGCPanelCanRunSelect          = 0x202,    /* SGPanelCanRun */<span></span></pre></td></tr><tr><td scope="row"><pre>    kSGCPanelInstallSelect         = 0x203,    /* SGPanelInstall */<span></span></pre></td></tr><tr><td scope="row"><pre>    kSGCPanelEventSelect           = 0x204,    /* SGPanelEvent */<span></span></pre></td></tr><tr><td scope="row"><pre>    kSGCPanelItemSelect            = 0x205,    /* SGPanelItem */<span></span></pre></td></tr><tr><td scope="row"><pre>    kSGCPanelRemoveSelect          = 0x206,    /* SGPanelRemove */<span></span></pre></td></tr><tr><td scope="row"><pre>    kSGCPanelSetGrabberSelect      = 0x207,    /* SGPanelSetGrabber */<span></span></pre></td></tr><tr><td scope="row"><pre>    kSGCPanelSetResFileSelect      = 0x208,    /* SGPanelSetResFile */<span></span></pre></td></tr><tr><td scope="row"><pre>    kSGCPanelGetSettingsSelect     = 0x209,    /* SGPanelGetSettings */<span></span></pre></td></tr><tr><td scope="row"><pre>    kSGCPanelSetSettingsSelect     = 0x20A,    /* SGPanelSetSettings */<span></span></pre></td></tr><tr><td scope="row"><pre>    kSGCPanelValidateInputSelect   = 0x20B<span></span></pre></td></tr><tr><td scope="row"><pre>};<span></span></pre></td></tr></table></div>

<p>Before reading the rest of this chapter, you should have a basic understanding of how to create components. To create a sequence grabber panel component, you set up the global variables and implement the required Component Manager request codes and the functions that are private to your particular component. Then you manage the dialog box and work with the settings in the dialog box.</p>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-DontLinkElementID_69" title="Managing Your Panel Component"></a>
<h2><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-ManagingYourPanelComponent" title="Managing Your Panel Component"></a>Managing Your Panel Component</h2>
<p>Sequence grabber components load, configure, and unload your panel component. As part of this process, the sequence grabber installs your panel’s dialog items into the settings dialog box and may open your component’s resource file. Panel components provide a number of functions that allow the sequence grabber to manage its relationship with panel components. This section discusses those functions.</p>
<p>After opening a connection to your panel component, the sequence grabber identifies itself to your component by calling your <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPanelSetGrabber" target="_top">SGPanelSetGrabber</a></code> function. The sequence grabber then tries to determine whether your component can work with its associated channel component by calling your <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPanelCanRun" target="_top">SGPanelCanRun</a></code> function. The sequence grabber calls this function only if you have set the <code>channelFlagHasDependency</code> component flag to 1.</p>
<p>Once the sequence grabber has determined that your panel component can work with its channel component, the sequence grabber may open your component’s resource file (unless you have set the <code>channelFlagDontOpenResFile</code> component flag to 1). Once it has opened the resource file, it passes the file’s reference number to you by calling your <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPanelSetResFile" target="_top">SGPanelSetResFile</a></code> function.</p>
<p>Next, the sequence grabber prepares to add your component’s items to the settings dialog box. The sequence grabber obtains your item list by calling your <code>SGPanelGetDITL</code> function. Once it has installed the items, it calls your <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPanelInstall" target="_top">SGPanelInstall</a></code> function, giving you an opportunity to set initial values.</p>
<p>Before the sequence grabber removes your items from the settings dialog box, it calls your <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPanelRemove" target="_top">SGPanelRemove</a></code> function.</p>
<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-DontLinkElementID_70" title="Managing Your Panel&#39;s Settings"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-ManagingYourPanelsSettings" title="Managing Your Panel&#39;s Settings"></a>Managing Your Panel's Settings</h3>
<p>Sequence grabber components store their configuration information in Movie Toolbox user data items. This configuration information includes settings for each of the channels used by the sequence grabber. Because your panel component configures sequence grabber channels, your panel component is responsible for creating and formatting the contents of its user data items. The sequence grabber component calls your component whenever it wants to retrieve these settings. The sequence grabber may also use previously stored settings to restore your panel’s settings. This section discusses the functions that allow the sequence grabber to work with your panel’s settings.</p>
<p>The sequence grabber calls your <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPanelGetSettings" target="_top">SGPanelGetSettings</a></code> function in order to retrieve your panel’s current settings. The sequence grabber uses your <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPanelSetSettings" target="_top">SGPanelSetSettings</a></code> function to restore those settings to some previous values.</p>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-DontLinkElementID_71" title="Component Flags for Sequence Grabber Panel Components"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-ComponentFlagsforSequenceGrabberPanelComponents" title="Component Flags for Sequence Grabber Panel Components"></a>Component Flags for Sequence Grabber Panel Components</h3>
<p>The Component Manager allows you to specify information about your component’s capabilities in the <code>componentFlags</code> field of the component description record. Sequence grabber panel components use the <code>componentFlags</code> field to indicate specific information about their capabilities.</p>
<p>The following flags are defined:</p>

<div class="codesample"><table><tr><td scope="row"><pre>enum {<span></span></pre></td></tr><tr><td scope="row"><pre>    channelFlagDontOpenResFile = 2,   /* do not open resource file */<span></span></pre></td></tr><tr><td scope="row"><pre>    channelFlagHasDependency = 4      /* needs special hardware */<span></span></pre></td></tr><tr><td scope="row"><pre>};<span></span></pre></td></tr></table></div>

<p>These flags control how sequence grabbers manage their connection with your panel component. The <code>channelFlagDontOpenResFile</code> flag instructs the sequence grabber not to open your component’s resource file. By default, the sequence grabber opens your component’s resource file for you, and then provides you with the appropriate file reference number. In general, this is convenient. However, if your component is linked with your application and does not have its own resource file, you may not want the sequence grabber to try to open the resource file. In such cases, set this flag to 1.</p>
<p>The <code>channelFlagHasDependency</code> flag allows you to tell the sequence grabber that your panel component requires special digitizing hardware. If you set this flag to 1, the sequence grabber gives your component an opportunity to verify that it can work in the current hardware environment by calling your component’s <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPanelCanRun" target="_top">SGPanelCanRun</a></code> function.</p>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-DontLinkElementID_72" title="Processing Your Panel&#39;s Events"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-ProcessingYourPanelsEvents" title="Processing Your Panel&#39;s Events"></a>Processing Your Panel's Events</h3>
<p>When your panel component is loaded into the settings dialog box and active, you may receive and process dialog events and mouse clicks.</p>
<p>Your component’s <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPanelEvent" target="_top">SGPanelEvent</a></code> function acts like a modal-dialog filter function, allowing you to process individual dialog events. The sequence grabber calls your <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPanelItem" target="_top">SGPanelItem</a></code> function whenever the user clicks a dialog item.</p>
<p>Whenever the user clicks the OK button, the sequence grabber calls your <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPanelValidateInput" target="_top">SGPanelValidateInput</a></code> function. Your panel component may then validate the user’s settings.</p>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-DontLinkElementID_73" title="Implementing the Required Component Functions"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-ImplementingtheRequiredComponentFunctions" title="Implementing the Required Component Functions"></a>Implementing the Required Component Functions</h3>
<p>Listing 4-1 illustrates the component dispatchers for a sequence grabber panel component together with the required functions for open, close, can do, and version.</p>
<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-DontLinkElementID_166" title="Listing 4-1Implementing functions for open, close, can do, and version"></a>
<p class="codesample"><strong>Listing 4-1&nbsp;&nbsp;</strong>Implementing functions for open, close, can do, and version</p>
<div class="codesample"><table><tr><td scope="row"><pre>#define sgcPictShowTicksType 'TICK'<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>typedef struct {<span></span></pre></td></tr><tr><td scope="row"><pre>    ComponentInstance           self;<span></span></pre></td></tr><tr><td scope="row"><pre>    ControlHandle               ch;<span></span></pre></td></tr><tr><td scope="row"><pre>} PictPanelGlobalsRecord, *PictPanelGlobals;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>/* only for PICT channels */<span></span></pre></td></tr><tr><td scope="row"><pre>pascal ComponentResult SGSetShowTickCount (SGChannel c,<span></span></pre></td></tr><tr><td scope="row"><pre>                    Boolean show) = {0x2f3c,2,0x100,0x7000,0xA82A};<span></span></pre></td></tr><tr><td scope="row"><pre>pascal ComponentResult SGGetShowTickCount (SGChannel c,<span></span></pre></td></tr><tr><td scope="row"><pre>                    Boolean *show) = {0x2f3c,4,0x101,0x7000,0xA82A};<span></span></pre></td></tr><tr><td scope="row"><pre>pascal ComponentResult PictPanelDispatcher<span></span></pre></td></tr><tr><td scope="row"><pre>                    (ComponentParameters *params, Handle storage)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    OSErr err = badComponentSelector;<span></span></pre></td></tr><tr><td scope="row"><pre>    ComponentFunction componentProc = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>    switch (params->what) {<span></span></pre></td></tr><tr><td scope="row"><pre>        case kComponentOpenSelect:<span></span></pre></td></tr><tr><td scope="row"><pre>            componentProc = PictPanelOpen; break;<span></span></pre></td></tr><tr><td scope="row"><pre>        case kComponentCloseSelect:<span></span></pre></td></tr><tr><td scope="row"><pre>            componentProc = PictPanelClose; break;<span></span></pre></td></tr><tr><td scope="row"><pre>        case kComponentCanDoSelect:<span></span></pre></td></tr><tr><td scope="row"><pre>            componentProc = PictPanelCanDo; break;<span></span></pre></td></tr><tr><td scope="row"><pre>        case kComponentVersionSelect:<span></span></pre></td></tr><tr><td scope="row"><pre>            componentProc = PictPanelVersion; break;<span></span></pre></td></tr><tr><td scope="row"><pre>        case kSGCPanelGetDitlSelect:<span></span></pre></td></tr><tr><td scope="row"><pre>            componentProc = PictPanelPanelGetDitl; break;<span></span></pre></td></tr><tr><td scope="row"><pre>        case kSGCPanelInstallSelect:<span></span></pre></td></tr><tr><td scope="row"><pre>            componentProc = PictPanelPanelInstall; break;<span></span></pre></td></tr><tr><td scope="row"><pre>        case kSGCPanelItemSelect:<span></span></pre></td></tr><tr><td scope="row"><pre>            componentProc = PictPanelPanelItem; break;<span></span></pre></td></tr><tr><td scope="row"><pre>        case kSGCPanelRemoveSelect:<span></span></pre></td></tr><tr><td scope="row"><pre>            componentProc = PictPanelPanelRemove; break;<span></span></pre></td></tr><tr><td scope="row"><pre>        case kSGCPanelGetSettingsSelect:<span></span></pre></td></tr><tr><td scope="row"><pre>            componentProc = PictPanelPanelGetSettings; break;<span></span></pre></td></tr><tr><td scope="row"><pre>        case kSGCPanelSetSettingsSelect:<span></span></pre></td></tr><tr><td scope="row"><pre>            componentProc = PictPanelPanelSetSettings; break;<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    if (componentProc)<span></span></pre></td></tr><tr><td scope="row"><pre>        err = CallComponentFunctionWithStorage (storage, params,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                  componentProc);<span></span></pre></td></tr><tr><td scope="row"><pre>    return err;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre>pascal ComponentResult PictPanelCanDo (PictPanelGlobals store,<span></span></pre></td></tr><tr><td scope="row"><pre>                                          short ftnNumber)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    switch (ftnNumber) {<span></span></pre></td></tr><tr><td scope="row"><pre>        case kComponentOpenSelect:<span></span></pre></td></tr><tr><td scope="row"><pre>        case kComponentCloseSelect:<span></span></pre></td></tr><tr><td scope="row"><pre>        case kComponentCanDoSelect:<span></span></pre></td></tr><tr><td scope="row"><pre>        case kComponentVersionSelect:<span></span></pre></td></tr><tr><td scope="row"><pre>        case kSGCPanelGetDitlSelect:<span></span></pre></td></tr><tr><td scope="row"><pre>        case kSGCPanelInstallSelect:<span></span></pre></td></tr><tr><td scope="row"><pre>        case kSGCPanelItemSelect:<span></span></pre></td></tr><tr><td scope="row"><pre>        case kSGCPanelRemoveSelect:<span></span></pre></td></tr><tr><td scope="row"><pre>        case kSGCPanelGetSettingsSelect:<span></span></pre></td></tr><tr><td scope="row"><pre>        case kSGCPanelSetSettingsSelect:<span></span></pre></td></tr><tr><td scope="row"><pre>            return true;<span></span></pre></td></tr><tr><td scope="row"><pre>        default:<span></span></pre></td></tr><tr><td scope="row"><pre>            return false;<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre>pascal ComponentResult PictPanelVersion (PictPanelGlobals store)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    return 0x00020001;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>pascal ComponentResult PictPanelOpen (PictPanelGlobals store,<span></span></pre></td></tr><tr><td scope="row"><pre>                                        ComponentInstance self)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    OSErr err;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    /* allocate global variables */<span></span></pre></td></tr><tr><td scope="row"><pre>    store = (PictPanelGlobals) NewPtrClear<span></span></pre></td></tr><tr><td scope="row"><pre>                (sizeof(PictPanelGlobalsRecord));<span></span></pre></td></tr><tr><td scope="row"><pre>    if (err = MemError()) goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre>    SetComponentInstanceStorage (self, (Handle)store);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    /* remember the component instance identification number */<span></span></pre></td></tr><tr><td scope="row"><pre>    store->self = self;<span></span></pre></td></tr><tr><td scope="row"><pre>bail:<span></span></pre></td></tr><tr><td scope="row"><pre>    return err;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre>pascal ComponentResult PictPanelClose (PictPanelGlobals store,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         ComponentInstance self)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    if (store) DisposePtr ((Ptr)store);<span></span></pre></td></tr><tr><td scope="row"><pre>    return noErr;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div>



<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-DontLinkElementID_74" title="Managing the Dialog Box"></a>
<h2><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-ManagingtheDialogBox" title="Managing the Dialog Box"></a>Managing the Dialog Box</h2>
<p>This section gives details on the functions that a panel component must provide so that the sequence grabber can load the component’s items into the settings dialog box and receive and process dialog events.</p>
<ul class="ul">
<li class="li"><p>To prepare to add the component’s items to the settings dialog box, the sequence grabber obtains the item list by calling the <code>SGPanelGetDITL</code> function.</p></li>
<li class="li"><p>Once it has installed the items, the sequence grabber calls the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPanelInstall" target="_top">SGPanelInstall</a></code> function, which sets up the state of the dialog box (for example, a checkbox) and gives the panel component an opportunity to set initial values.</p></li>
<li class="li"><p>When the panel component is loaded into the settings dialog box and active, it may receive and process dialog events and mouse clicks. The component’s <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPanelEvent" target="_top">SGPanelEvent</a></code> function processes individual dialog events.</p></li>
<li class="li"><p>Whenever the user clicks a dialog item, the sequence grabber calls the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPanelItem" target="_top">SGPanelItem</a></code> function.</p></li>
<li class="li"><p>Before the sequence grabber removes the items from the settings dialog box, it calls the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPanelRemove" target="_top">SGPanelRemove</a></code> function.</p></li>
</ul>
<p>Listing 4-2 provides an example of the management of the settings dialog box for a sequence grabber that displays PICT images. The component item displayed in the dialog box in this case is a tick count checkbox.</p>
<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-DontLinkElementID_167" title="Listing 4-2Managing the settings dialog box"></a>
<p class="codesample"><strong>Listing 4-2&nbsp;&nbsp;</strong>Managing the settings dialog box</p>
<div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult PictPanelPanelGetDitl<span></span></pre></td></tr><tr><td scope="row"><pre>                         (PictPanelGlobals store, Handle *ditl)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    /*<span></span></pre></td></tr><tr><td scope="row"><pre>        Get and detach the dialog box template. Note that<span></span></pre></td></tr><tr><td scope="row"><pre>        the sequence grabber has already opened the resource file.<span></span></pre></td></tr><tr><td scope="row"><pre>    */<span></span></pre></td></tr><tr><td scope="row"><pre>    *ditl = GetResource ('DITL', 7001);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (!*ditl) return resNotFound;<span></span></pre></td></tr><tr><td scope="row"><pre>    DetachResource (*ditl);<span></span></pre></td></tr><tr><td scope="row"><pre>    return noErr;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>pascal ComponentResult PictPanelPanelInstall<span></span></pre></td></tr><tr><td scope="row"><pre>                                (PictPanelGlobals store, SGChannel c,<span></span></pre></td></tr><tr><td scope="row"><pre>                                 DialogPtr d, short itemOffset)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    Rect r;<span></span></pre></td></tr><tr><td scope="row"><pre>    short kind;<span></span></pre></td></tr><tr><td scope="row"><pre>    Handle h;<span></span></pre></td></tr><tr><td scope="row"><pre>    Boolean ticksShowing;<span></span></pre></td></tr><tr><td scope="row"><pre>    /* set up the initial state of the checkbox */<span></span></pre></td></tr><tr><td scope="row"><pre>    GetDItem (d, 1 + itemOffset, &amp;kind, &amp;h, &amp;r);<span></span></pre></td></tr><tr><td scope="row"><pre>    store->ch = (ControlHandle)h;<span></span></pre></td></tr><tr><td scope="row"><pre>    SGGetShowTickCount (c, &amp;ticksShowing);<span></span></pre></td></tr><tr><td scope="row"><pre>    SetCtlValue (store->ch, ticksShowing);<span></span></pre></td></tr><tr><td scope="row"><pre>    return noErr;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre>pascal ComponentResult PictPanelPanelItem<span></span></pre></td></tr><tr><td scope="row"><pre>                                (PictPanelGlobals store, SGChannel c,<span></span></pre></td></tr><tr><td scope="row"><pre>                                 DialogPtr d, short itemOffset,<span></span></pre></td></tr><tr><td scope="row"><pre>                                 short itemNum)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    /* if the item clicked was your checkbox, update its state */<span></span></pre></td></tr><tr><td scope="row"><pre>    if ((itemNum - itemOffset) == 1) {<span></span></pre></td></tr><tr><td scope="row"><pre>        Boolean showing = GetCtlValue (store->ch);<span></span></pre></td></tr><tr><td scope="row"><pre>        SetCtlValue (store->ch, !showing);<span></span></pre></td></tr><tr><td scope="row"><pre>        SGSetShowTickCount (c, !showing);<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    return noErr;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre>pascal ComponentResult PictPanelPanelRemove<span></span></pre></td></tr><tr><td scope="row"><pre>                                        (PictPanelGlobals store,<span></span></pre></td></tr><tr><td scope="row"><pre>                                        SGChannel c, DialogPtr d,<span></span></pre></td></tr><tr><td scope="row"><pre>                                        short itemOffset)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    /* forget that it ever had a control */<span></span></pre></td></tr><tr><td scope="row"><pre>    store->ch = nil;<span></span></pre></td></tr><tr><td scope="row"><pre>    return noErr;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div>

<p>To allow the sequence grabber to work with your panel’s settings, your panel component must allow the sequence grabber to</p>
<ul class="ul">
<li class="li"><p>retrieve the panel’s current settings by calling your <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPanelGetSettings" target="_top">SGPanelGetSettings</a></code> function</p></li>
<li class="li"><p>restore those settings to some previous values by using your <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPanelSetSettings" target="_top">SGPanelSetSettings</a></code> function</p></li>
</ul>
<p>Listing 4-3 gives an example in which the settings are managed in a user list that contains tick count information for a panel component for PICT images.</p>
<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberPanelComponents-DontLinkElementID_168" title="Listing 4-3Managing the settings for a panel component"></a>
<p class="codesample"><strong>Listing 4-3&nbsp;&nbsp;</strong>Managing the settings for a panel component</p>
<div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult PictPanelPanelGetSettings<span></span></pre></td></tr><tr><td scope="row"><pre>                            (PictPanelGlobals store, SGChannel c,<span></span></pre></td></tr><tr><td scope="row"><pre>                             UserData *result, long flags)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    OSErr           err;<span></span></pre></td></tr><tr><td scope="row"><pre>    UserData        ud;<span></span></pre></td></tr><tr><td scope="row"><pre>    Boolean         ticksShowing;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    /* create a user data list containing your state */<span></span></pre></td></tr><tr><td scope="row"><pre>    if (err = NewUserData (&amp;ud)) goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre>    if (err = SGGetShowTickCount (c, &amp;ticksShowing)) goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre>    if (err = SetUserDataItem (ud, &amp;ticksShowing,<span></span></pre></td></tr><tr><td scope="row"><pre>                                 sizeof (ticksShowing),<span></span></pre></td></tr><tr><td scope="row"><pre>                                 sgcPictShowTicksType, 1)) goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre>bail:<span></span></pre></td></tr><tr><td scope="row"><pre>    if (err) {<span></span></pre></td></tr><tr><td scope="row"><pre>        DisposeUserData(ud);<span></span></pre></td></tr><tr><td scope="row"><pre>        ud = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    *result = ud;<span></span></pre></td></tr><tr><td scope="row"><pre>    return err;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre>pascal ComponentResult PictPanelPanelSetSettings<span></span></pre></td></tr><tr><td scope="row"><pre>                          (PictPanelGlobals store, SGChannel c,<span></span></pre></td></tr><tr><td scope="row"><pre>                           UserData ud, long flags)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    Boolean ticksShowing;<span></span></pre></td></tr><tr><td scope="row"><pre>    /* restore the state from the specified user data list */<span></span></pre></td></tr><tr><td scope="row"><pre>    if (GetUserDataItem (ud, &amp;ticksShowing,<span></span></pre></td></tr><tr><td scope="row"><pre>                                sizeof (ticksShowing),<span></span></pre></td></tr><tr><td scope="row"><pre>                                sgcPictShowTicksType, 1) == noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        SGSetShowTickCount (c, ticksShowing);<span></span></pre></td></tr><tr><td scope="row"><pre>    return noErr;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div>





        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../D-Chapter/4SequenceGrabberComp.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../F-Chapter/6SequenceGrabberChan.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2005, 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-01-08<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/QuickTime/RM/CreatingMovies/MTCreateMovies/E-Chapter/5SequenceGrabberPane.html%3Fid%3DTP40000906-3.1&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/QuickTime/RM/CreatingMovies/MTCreateMovies/E-Chapter/5SequenceGrabberPane.html%3Fid%3DTP40000906-3.1&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/QuickTime/RM/CreatingMovies/MTCreateMovies/E-Chapter/5SequenceGrabberPane.html%3Fid%3DTP40000906-3.1&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>