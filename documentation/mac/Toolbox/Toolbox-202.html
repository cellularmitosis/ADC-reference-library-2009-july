<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Managing Multiple Windows(IM:Tb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING202></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Toolbox-201.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-203.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Toolbox-2.html"><B>Macintosh Toolbox Essentials</B></A> / <BR><DD><A HREF="Toolbox-188.html"><B>Chapter 4 - Window Manager</B></A> / <A HREF="Toolbox-201.html"><B>Using the Window Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING202-0></A>
<H2><A NAME=MARKER-9-133></A>Managing Multiple Windows</H2>
 <A NAME=MARKER-2-66></A>Your application is likely to have multiple windows on the desktop at once: one or more document windows, possibly one or more dialog boxes, and possibly some special-<BR>purpose windows of your own. Only one window is active at a time, however.<P>
 When your application receives an event, it responds according to what kind of window is currently active and where the event occurred. When it receives a mouse-down event in the content region of an active document window, your application follows its own conventions: inserting text, making a selection, or adding graphics, for example. When it receives a mouse-down event in the menu bar, your application enables and disables menu items as appropriate--which again depends on what kind of window is active and what is selected in that window. If the user has the insertion point in an editable text field in a modal dialog box, for example, the only menu item available might be Paste in the Edit menu--and then only if there is something in the scrap to be pasted.<P>
 You can use various strategies for keeping track of different kinds of windows. The <CODE>refCon</CODE> field in the window record is set aside specifically for use by applications. <BR>You can use the <CODE>refCon</CODE> field to store different kinds of data, such as a number that represents a window type or a handle to a record that describes the window.<P>
 The sample code in this chapter--excerpts from the SurfWriter application used throughout this book--uses a hybrid strategy:<P>
<UL>
<LI>For document windows, the <CODE>refCon</CODE> field holds a handle to a document record.
<LI>For modeless or movable modal dialog boxes, the <CODE>refCon</CODE> field holds a number that represents a type of dialog box.<P>
</UL>
 You may well find other approaches more practical.<P>
 The SurfWriter application stores document information about the user's data, the window display, and the file, if any, associated with the data in a document record. The document record takes this form:<P>
<PRE>
TYPE MyDocRec = 
   RECORD
      editRec:       TEHandle;      {handle to text being edited}
      vScrollBar:    ControlHandle; {control handle to the }
                                    { vertical scroll bars}
      hScrollBar:    ControlHandle; {control handle to the }
                                    { horizontal scroll bars}
      fileRefNum:    Integer;       {reference number for file}
      fileFSSpec:    FSSpec;        {FSSpec record for file}
      windowDirty:   Boolean;       {whether data has changed }
                                    { since last save}
   END;
   MyDocRecPtr       = ^MyDocRec;
   MyDocRecHnd       = ^MyDocRecPtr;
</PRE>
 The SurfWriter application creates a document record every time it creates a document window, and it stores a handle to the document record in the <CODE>refCon</CODE> field of the window record. (See the chapter "Introduction to File Management" in Inside Macintosh: Files for a more complete illustration of how to use document records.)<P>
 When SurfWriter creates a modeless dialog box or a movable modal dialog box, it stores a constant that represents that dialog box (that is, it specifies the constant in the dialog resource, and the Window Manager sets the <CODE>refCon</CODE> field to that value when it creates the window record). For example, a <CODE>refCon</CODE> value of 20 might specify a modeless dialog box that accepts input for the <DFN>Find</DFN> command, and a value of 21 might specify a modeless dialog box that accepts input for the spelling checker.<P>
 When SurfWriter receives notification of an event in one of its windows, it first determines the function of the window and then dispatches the event as appropriate. <A HREF=#MARKER-9-136>Listing 4-1</A> illustrates an application-defined routine <CODE>MyGetWindowType</CODE> that determines the window's type. <P>
<DL>
<DT><B>Note</B>
<DD>The <CODE>MyGetWindowType</CODE> function determines the type of a window from among a set of application-defined window types, which reflect the different kinds of windows the application creates. These window types are different from the standard window types defined by the definition functions, which determine how windows look and behave. To find out which one of the standard window types a window is, call the Window Manager function <CODE>GetWVariant</CODE>.<A NAME=MARKER-2-172></A><EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 The sample code later in this chapter calls the <CODE>MyGetWindowType</CODE> function as part of its event-handling procedure, described in the section <A HREF=Toolbox-207.html#MARKER-9-188>"Handling Events in Windows"</A> beginning on <A HREF=Toolbox-207.html#MARKER-9-188>page 4-36</A>. <P>
<B>Listing 4-1  <A NAME=MARKER-9-136></A><A NAME=MARKER-21-137></A>Determining the window type</B><P>
<PRE>
FUNCTION MyGetWindowType (thisWindow: WindowPtr): Integer;
VAR
   myWindowType:  Integer;
BEGIN
  IF thisWindow &lt;&gt; NIL THEN
  BEGIN
    myWindowType := WindowPeek(thisWindow)^.windowKind;
    IF myWindowType &lt; 0 THEN                 {window belongs to }
      MyGetWindowType := kDAWindow           { a desk accessory}
    ELSE
      IF myWindowType = userKind THEN        {document window}
        MyGetWindowType := kMyDocWindow
      ELSE                                   {dialog window}
         MyGetWindowType := GetWRefCon(window);    {get dialog ID}
  END
  ELSE
   MyGetWindowType := kNil;
END;
</PRE>
 Notice that <CODE>MyGetWindowType</CODE> checks whether the window belongs to a desk accessory. This step ensures compatibility with older versions of system software. When your application is running in System 7, it should receive events only for its own windows and for windows belonging to desk accessories that were launched in its partition. See Inside Macintosh: Memory for information about partitions and Inside Macintosh: Processes for information about launching applications and desk accessories. <A NAME=MARKER-2-59></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Toolbox-201.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-203.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Toolbox-3.html">&copy; Apple Computer, Inc.</A><br>11 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
