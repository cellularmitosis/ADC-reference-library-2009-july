<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>GrafPort (IM: Im)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING27></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!--end of header -->

<center>
<A HREF="QuickDraw-26.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="QuickDraw-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="QuickDraw-476.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="QuickDraw-28.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="QuickDraw-2.html"><B>Imaging With QuickDraw</B></A> / <BR><DD><A HREF="QuickDraw-18.html"><B>Chapter 2 - Basic QuickDraw</B></A> / <A HREF="QuickDraw-21.html"><B>Basic QuickDraw Reference</B></A><BR><DL><DD><A HREF="QuickDraw-22.html"><B>Data Structures</B></A> / </DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING27-0></A>
<H3><A NAME=MARKER-9-138></A>GrafPort</H3>
 <A NAME=MARKER-14-140></A><A NAME=MARKER-14-140></A><A NAME=MARKER-9-247></A><A NAME=MARKER-2-52></A>A basic graphics port, which is a data structure of type <CODE>GrafPort</CODE>, defines a complete drawing environment that determines where and how black-and-white graphics operations take place. (Using the basic eight-color system described in the chapter "QuickDraw Drawing," you can also use a basic graphics port to display eight predefined colors.) <P>
 All graphics operations are performed in graphics ports. Before a basic graphics port can be used, it must be allocated and initialized with the <CODE>OpenPort</CODE> procedure. Normally, you don't call <CODE>OpenPort</CODE> yourself. In most cases your application draws into a window you've created with the <CODE>GetNewWindow</CODE> or <CODE>NewWindow</CODE> function (or, for color windows, <CODE>GetNewCWindow</CODE> or <CODE>NewCWindow</CODE>), or it draws into an offscreen graphics world created with the <CODE>NewGWorld</CODE> function. These Window Manager functions (described in the chapter "Window Manager" in <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I>) and the <CODE>NewGWorld</CODE> function (described in the chapter "Offscreen Graphics Worlds" in this book) call <CODE>OpenPort</CODE> to create a basic graphics port. See the description of the <CODE>OpenPort</CODE> procedure on <A HREF=QuickDraw-32.html#MARKER-9-209>page 2-35</A> for a table of initial graphics port values.<P>
 You can have many graphics ports open at once; each one has its own local coordinate system, pen pattern, background pattern, pen size and location, font and font style, and bitmap in which drawing takes place. Using the <CODE>SetPort</CODE> procedure (described on <A HREF=QuickDraw-37.html#MARKER-9-236>page 2-39</A>), you can instantly switch from one port to another.<P>
 Several fields in the <CODE>GrafPort</CODE> record define your application's drawing area: all drawing in a graphics port occurs in the intersection of the graphics port's boundary rectangle and its port rectangle, and, within that intersection, all drawing is cropped to the graphics port's visible region and its clipping region.<P>
<PRE>
TYPE GrafPtr = ^GrafPort;
GrafPort =
RECORD
   device:     Integer;    {device-specific information}
   portBits:   BitMap;     {bitmap}
   portRect:   Rect;       {port rectangle}
   visRgn:     RgnHandle;  {visible region}
   clipRgn:    RgnHandle;  {clipping region}
   bkPat:      Pattern;    {background pattern}
   fillPat:    Pattern;    {fill pattern}
   pnLoc:      Point;      {pen location}
   pnSize:     Point;      {pen size}
   pnMode:     Integer;    {pattern mode}
   pnPat:      Pattern;    {pen pattern}
   pnVis:      Integer;    {pen visibility}
   txFont:     Integer;    {font number for text}
   txFace:     Style;      {text's font style}
   txMode:     Integer;    {source mode for text}
   txSize:     Integer;    {font size for text}
   spExtra:    Fixed;      {extra space}
   fgColor:    LongInt;    {foreground color}
   bkColor:    LongInt;    {background color}
   colrBit:    Integer;    {color bit}
   patStretch: Integer;    {used internally}
   picSave:    Handle;     {picture being saved, used internally}
   rgnSave:    Handle;     {region being saved, used internally}
   polySave:   Handle;     {polygon being saved, used internally}
   grafProcs:  QDProcsPtr; {low-level drawing routines}
END;
WindowPtr = GrafPtr;
</PRE>
<DL>
<DT><A NAME=MARKER-9-143><B>WARNING</B>
<DD></A>You can read the fields of a <CODE>GrafPort</CODE> record directly, but you should not store values directly into them. Use the QuickDraw routines described in this book to alter the fields of a graphics port.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
<H5>Field Description</H5>
<DT><CODE>device</CODE>
<DD> Device-specific information that's used by the Font Manager to achieve the best possible results when drawing text in the graphics port. There may be physical differences in the same logical font for different output devices, to ensure the highest-quality printing on the device being used. For best results on the screen, the default value of the device field is 0. <A NAME=MARKER-9-88></A>
<DT><CODE>portBits</CODE>
<DD> The bitmap (described on <A HREF=QuickDraw-26.html#MARKER-9-125>page 2-26</A>) that describes the boundary rectangle for the graphics port and contains a pointer to the bit image used by the graphics port.<A NAME=MARKER-9-84></A><A NAME=MARKER-2-125></A> 
<DT><CODE>portRect</CODE>
<DD> <A NAME=MARKER-2-157></A><A NAME=MARKER-9-248></A><A NAME=MARKER-9-198></A>The port rectangle that defines a subset of the bitmap to be used for drawing.\xDDAll drawing done by the application occurs inside the port rectangle. (In a window's graphics port, the port rectangle is also called the <I>content region</I>.) The port rectangle uses the local coordinate system defined by the boundary rectangle in the <CODE>portBits</CODE> field of the <CODE>BitMap</CODE> record. The upper-left corner (which for a window is called the <I>window origin</I>) of the port rectangle usually has a vertical coordinate of 0 and a horizontal coordinate of 0, although you can use the <CODE>SetOrigin</CODE> procedure (described on <A HREF=QuickDraw-40.html#MARKER-9-253>page 2-42</A>) to change the coordinates of the window origin. The port rectangle usually falls within the boundary rectangle, but it's not required to do so.<A NAME=MARKER-2-318></A>
<DT><CODE>visRgn</CODE>
<DD> <A NAME=MARKER-2-217></A>The region of the graphics port that's actually visible on the <BR>screen--that is, the part of the window that's not covered by other windows. By default, the visible region is equivalent to the port rectangle. The visible region has no effect on offscreen images.
<DT><CODE>clipRgn</CODE>
<DD> <A NAME=MARKER-2-68></A>The graphics port's clipping region, an arbitrary region that you can use to limit drawing to any region within the port rectangle. The default clipping region is set arbitrarily large; using the <CODE>ClipRect</CODE> procedure (described on <A HREF=QuickDraw-45.html#MARKER-9-279>page 2-45</A>), you have full control over its setting. Unlike the visible region, the clipping region affects the image even if it isn't displayed on the screen.
<DT><CODE>bkPat</CODE> 
<DD> <A NAME=MARKER-2-243></A><A NAME=MARKER-2-150></A>The background bit pattern that's used by procedures such as <CODE>ScrollRect</CODE> (described on <A HREF=QuickDraw-39.html#MARKER-9-247>page 2-40</A>) and <CODE>EraseRect</CODE> (described in the chapter "QuickDraw Drawing") for filling scrolled or erased areas. Your application can use the <CODE>BackPat</CODE> procedure (described in the chapter "QuickDraw Drawing") to change the background bit pattern. This pattern, like all other patterns drawn in the graphics port, is always aligned with the port's coordinate system.\xDDThe upper-left corner of the pattern is aligned with the upper-left corner of the port rectangle, so that adjacent areas of the same pattern blend into a continuous, coordinated pattern. Bit patterns are described in the chapter "QuickDraw Drawing."<A NAME=MARKER-2-81></A><A NAME=MARKER-2-220></A>
<DT><CODE>fillPat</CODE>
<DD> The bit pattern that's used when you use a procedure such as <CODE>FillRect</CODE> to fill an area. Bit patterns are described in the chapter "QuickDraw Drawing."<A NAME=MARKER-2-151></A><A NAME=MARKER-2-225></A><A NAME=MARKER-2-140></A><A NAME=MARKER-2-243></A>
<DT><CODE>pnLoc</CODE>
<DD> <A NAME=MARKER-2-179></A><A NAME=MARKER-2-237></A>The point where QuickDraw will begin drawing the next line, shape, or character. It can be anywhere on the coordinate plane; there are no restrictions on the movement or placement of the pen. The location of the graphics pen is a point in the graphics port's coordinate system, not a pixel in a bit image. The upper-left corner of the pen is at the pen location; the graphics pen hangs below and to the right of this point. You can use the <CODE>Move</CODE>, <CODE>MoveTo</CODE>, <CODE>Line</CODE>, and <CODE>LineTo</CODE> procedures (described in the chapter "QuickDraw Drawing") to move the location of the graphics pen. <A NAME=MARKER-2-451></A>
<DT><CODE>pnSize</CODE>
<DD> <A NAME=MARKER-2-439></A>The vertical and horizontal dimensions of the graphics pen. By default, the pen is 1 pixel high by 1 pixel wide; the height and width can range from 0 by 0 to 32,767 by 32,767. If either the pen width or the pen height is 0, the pen does not draw. Heights or widths of less than 0 are undefined. You can use the <CODE>PenSize</CODE> procedure (described in the chapter "QuickDraw Drawing") to change the value in this field.<A NAME=MARKER-2-387></A>
<DT><CODE>pnMode</CODE>
<DD> <A NAME=MARKER-9-120></A>The pattern mode--that is, a Boolean operation that determines the how QuickDraw transfers the pen pattern to the bitmap during drawing operations. When the graphics pen draws into a bitmap, QuickDraw first determines what bits in the bit image are affected and then finds their corresponding bits in the pen pattern. QuickDraw then does a bit-by-bit comparison based on the pattern mode, which specifies one of eight Boolean transfer operations to perform. QuickDraw stores the resulting bit in its proper place in the bit image. Pattern modes for a basic graphics port are described in the chapter "QuickDraw Drawing." <A NAME=MARKER-2-188></A>
<DT><CODE>pnPat</CODE>
<DD> <A NAME=MARKER-9-440></A><A NAME=MARKER-2-113></A><A NAME=MARKER-2-39></A>A bit pattern that's used like the ink in the pen. As described in the chapter "QuickDraw Drawing," basic QuickDraw uses this pattern when you use the <CODE>Line</CODE> and <CODE>LineTo</CODE> procedures to draw lines with the pen, framing procedures such as <CODE>FrameRect</CODE> to draw shape outlines with the pen, or painting procedures such as <CODE>PaintRect</CODE> to paint shapes with the pen.<A NAME=MARKER-2-148></A><A NAME=MARKER-2-189></A>
<DT><CODE>pnVis</CODE>
<DD> <A NAME=MARKER-2-444></A><A NAME=MARKER-2-181></A><A NAME=MARKER-2-135></A>The graphics pen's visibility--that is, whether it draws on the screen. The graphics pen is described in detail in the chapter "QuickDraw Drawing."
<DT><CODE>txFont</CODE>
<DD> <A NAME=MARKER-2-307></A><A NAME=MARKER-2-183></A>A font number that identifies the font to be used in the graphics port. The font number 0 represents the system font. (A font is defined as a collection of images that represent the individual characters of the font. A font can consist of up to 255 distinct characters, yet not all characters need to be defined in a single font. In addition, each font contains a missing symbol to be drawn in case of a request to draw a character that's missing from the font.) Fonts are described in detail in <I><A HREF="../Text/Text-2.html">Inside Macintosh: Text</A></I>.
<DT><CODE>txFace</CODE>
<DD> <A NAME=MARKER-2-184></A>The font style of the text, with values from the set defined by the <CODE>Style</CODE> data type, which includes such styles as bold, italic, and shaded. You can apply stylistic variations either alone or in combination. Font styles are described in detail in <I><A HREF="../Text/Text-2.html">Inside Macintosh: Text</A></I>.
<DT><CODE>txMode</CODE>
<DD> <A NAME=MARKER-2-187></A>One of three Boolean source modes that determines the way characters are placed in the bit image. This mode functions much like a pattern mode specified in the <CODE>pnMode</CODE> field: when drawing a character, QuickDraw determines which bits in the bit image are affected, does a bit-by-bit comparison based on the mode, and stores the resulting bits into the bit image. Only three source modes--<CODE>srcOr</CODE>, <CODE>srcXor</CODE>, and <CODE>srcBic</CODE>--should be used for drawing text. See the chapter "QuickDraw Text" in <I><A HREF="../Text/Text-2.html">Inside Macintosh: Text</A></I> for more information about QuickDraw's text-handling capabilities. 
<DT><CODE>txSize</CODE>
<DD> <A NAME=MARKER-2-191></A>The text size in pixels. The Font Manager uses this information to provide the bitmaps for text drawing. (The Font Manager is described in detail in the chapter "Font Manager" in <I><A HREF="../Text/Text-2.html">Inside Macintosh: Text</A></I>.) The value in this field can be represented by
<DT>
<DD> point size  device resolution / 72 dpi
<DT>
<DD> where <I>point</I> is a typographical term meaning approximately <BR>1/72 inch.
<DT><CODE>spExtra</CODE>
<DD> A fixed-point number equal to the average number of pixels by which each space character should be widened to fill out the line. The <CODE>spExtra</CODE> field is useful when a line of characters is to be aligned with both the left and the right margins (sometimes called <I>full justification</I>).<A NAME=MARKER-2-181></A> <A NAME=MARKER-2-253></A>
<DT><CODE>fgColor</CODE>
<DD> <A NAME=MARKER-2-49></A>The color of the "ink" that QuickDraw uses to draw with. By default, this color is black. You can use the <CODE>ForeColor</CODE> procedure, as described in the chapter "QuickDraw Drawing," to specify any color from the eight-color system to be the foreground color in a basic graphics port. This color is recorded when drawing into a QuickDraw picture (described in the chapter "Pictures" in this book)--for example, drawing a line with a red foreground color stores a red line in the picture--but this color cannot be stored in a bitmap. When running in System 7, your application should use the <CODE>GetForeColor</CODE> procedure (described in the chapter "Color QuickDraw") to determine the foreground color instead of checking the value of this field.
<DT><CODE>bkColor</CODE>
<DD> <A NAME=MARKER-2-184></A>The color of the pixels in the bitmap into which QuickDraw draws. By default, this color is white. You can use the <CODE>BackColor</CODE> procedure, as described in the chapter "QuickDraw Drawing," to specify any color from the eight-color system to be the background color in a basic graphics port. This color is recorded when drawing into a QuickDraw picture, but this color cannot be stored in a bitmap. When running in System 7, your application should use the <CODE>GetBackColor</CODE> procedure (described in the chapter "Color QuickDraw") to determine the background color instead of checking the value of this field.
<DT><CODE>colrBit</CODE>
<DD> <A NAME=MARKER-2-185></A><A NAME=MARKER-2-404></A>The plane of the color picture to draw into when printing. As in the preceding two fields, this color cannot be stored in a bitmap.
<DT><CODE>patStretch</CODE>
<DD> A value used during output to a printer to expand patterns if necessary. Your application should not change this value.<A NAME=MARKER-2-123></A><A NAME=MARKER-2-219></A>
<DT><CODE>picSave</CODE>
<DD> <A NAME=MARKER-2-9></A>The state of the picture definition. If no picture is open, this field contains <CODE>NIL</CODE>; otherwise it contains a handle to information related to the picture definition. Your application shouldn't be concerned about exactly what information the handle leads to; you may, however, save the current value of this field, set the field to <CODE>NIL</CODE> to disable the picture definition, and later restore it to the saved value to resume defining the picture. Pictures are described in the chapter "Pictures" in this book.
<DT><CODE>rgnSave</CODE>
<DD> <A NAME=MARKER-2-154></A>The state of the region definition. If no region is open, this field contains <CODE>NIL</CODE>; otherwise it contains a handle to information related to the region definition. Your application shouldn't be concerned about exactly what information the handle leads to; you may, however, save the current value of this field, set the field to <CODE>NIL</CODE> to disable the region definition, and later restore it to the saved value to resume defining the region.
<DT><CODE>polySave</CODE>
<DD> <A NAME=MARKER-2-255></A>The state of the polygon definition. If no polygon is open, this field contains <CODE>NIL</CODE>; otherwise it contains a handle to information related to the polygon definition. Your application shouldn't be concerned about exactly what information the handle leads to; you may, however, save the current value of this field, set the field to <CODE>NIL</CODE> to disable the polygon definition, and later restore it to the saved value to resume defining the polygon.
<DT><CODE>grafProcs</CODE>
<DD> <A NAME=MARKER-2-50></A>An optional pointer to a special data structure that your application can store into if you want to customize QuickDraw drawing routines or use QuickDraw in other advanced, highly specialized ways. See the chapter "QuickDraw Drawing" for more information. 
</DL>
 All QuickDraw operations refer to a graphics port by a pointer defined by the data type <CODE>GrafPtr</CODE>. (For historical reasons, a graphics port is one of the few objects in the Macintosh system software that's referred to by a pointer rather than a handle.) All Window Manager routines that accept a window pointer also accept a pointer to a graphics port.<A NAME=MARKER-2-228></A><A NAME=MARKER-2-177></A><A NAME=MARKER-9-335></A><A NAME=MARKER-2-164></A><P>
 Your application should never need to directly change the fields of a <CODE>GrafPort</CODE> record. If you find it absolutely necessary for your application to do so, immediately use the <CODE>PortChanged</CODE> procedure to notify QuickDraw that your application has changed the <CODE>GrafPort</CODE> record. The <CODE>PortChanged</CODE> procedure is described in the chapter "Color QuickDraw" in this book.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="QuickDraw-26.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="QuickDraw-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="QuickDraw-476.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="QuickDraw-28.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="QuickDraw-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
