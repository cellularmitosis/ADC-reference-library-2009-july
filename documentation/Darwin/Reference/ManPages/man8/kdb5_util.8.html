<html><head><title>Mac OS X
 Manual Page For kdb5_util(8)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/8/kdb5_util" title="Mac OS X
 Manual Page for kdb5_util(8)"><!-- headerDoc=man; indexgroup=Section 8; uid="//apple_ref/doc/man/8/kdb5_util"; name=kdb5_util(8) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
KDB5_UTIL(8)                                                                                    KDB5_UTIL(8)



<b>NAME</b>
       kdb5_util - Kerberos database maintainance utility

<b>SYNOPSIS</b>
       <b>kdb5_util</b>  [<b>-r</b> <u>realm</u>]  [<b>-d</b> <u>dbname</u>] [<b>-k</b> <u>mkeytype</u>] [<b>-M</b> <u>mkeyname</u>] [<b>-sf</b> <u>stashfilename</u>] [<b>-m</b>] <u>command</u> <u>[com</u>-<font color="#ffffff" class="whiteout">mand_options]&nbsp;[command_options]</font>
       <u>mand</u><b>_</b><u>options]</u>

<b>DESCRIPTION</b>
       <b>kdb5_util</b> allows an administrator to perform low-level maintainance procedures on  the  Kerberos  and
       KADM5  database.   Databases  can  be  created, destroyed, and dumped to and loaded from ASCII files.
       Additionally, <b>kdb5_util</b> can create a Kerberos master key stash file.  <b>kdb5_util</b>  subsumes  the  func-<font color="#ffffff" class="whiteout">tionality&nbsp;functionality</font>
       tionality  of  and makes obsolete the previous database maintainance programs <b>kdb5_create</b>, <b>kdb5_edit</b>,
       <b>kdb5_destroy</b>, and <b>kdb5_stash</b>.

       When <b>kdb5_util</b> is run, it attempts to acquire the master key and open the database.  However,  execu-<font color="#ffffff" class="whiteout">tion&nbsp;execution</font>
       tion  continues  regardless  of whether or not <b>kdb5_util</b> successfully opens the database, because the
       database may not exist yet or the stash file may be corrupt.

       Note that some KDB plugins may not support all <b>kdb5_util</b> commands.

<b>COMMAND-LINE</b> <b>OPTIONS</b>
       <b>-r</b> <u>realm</u>
              specifies  the  Kerberos  realm  of  the  database;  by  default   the   realm   returned   by
              <!-- a --><u>krb5</u><b>_</b><u>default</u><b>_</b><u>local</u><b>_</b><u>realm</u>(3)<!-- /a --> is used.

       <b>-d</b> <u>dbname</u>
              specifies  the  name  under which the principal database is stored; by default the database is
              that listed in <a href="../man5/kdc.conf.5.html#//apple_ref/doc/man/5/kdc.conf"><u>kdc.conf</u>(5)</a>.  The KADM5 policy database and lock file  are  also  derived  from
              this value.

       <b>-k</b> <u>mkeytype</u>
              specifies  the  key  type  of  the  master  key  in the database; the default is that given in
              <u>kdc.conf</u>.

       <b>-M</b> <u>mkeyname</u>
              principal name for the master key in the database; the default is that given in <u>kdc.conf</u>.

       <b>-m</b>     specifies that the master database password should be read from the TTY  rather  than  fetched
              from a file on disk.

       <b>-sf</b> <u>stash</u><b>_</b><u>file</u>
              specifies the stash file of the master database password.

       <b>-P</b> <u>password</u>
              specifies the master database password.  This option is not recommended.

<b>COMMANDS</b>
       <b>create</b> [<b>-s</b>]
              Creates  a new database.  If the <b>-s</b> option is specified, the stash file is also created.  This
              command fails if the database already exists.  If the command is successful, the  database  is
              opened just as if it had already existed when the program was first run.

       <b>destroy</b> [<b>-f</b>]
              Destroys  the database, first overwriting the disk sectors and then unlinking the files, after
              prompting the user for confirmation.  With the <b>-f</b> argument, does not prompt the user.

       <b>stash</b> [<b>-f</b> <u>keyfile</u>]
              Stores the master principal's keys in a stash file.  The <b>-f</b> argument can be used  to  override
              the keyfile specified at startup.

       <b>dump</b> [<b>-old</b>] [<b>-b6</b>] [<b>-b7</b>] [<b>-ov</b>]
              [<b>-verbose</b>]  [<b>-mkey_convert</b>]  [<b>-new_mkey_file</b>  <u>mkey</u><b>_</b><u>file</u>]  [<b>-rev</b>] [<b>-recurse</b>] [<u>filename</u> [<u>princi</u>-<font color="#ffffff" class="whiteout">pals...]]&nbsp;[principals...]]</font>
              <u>pals...</u>]]
              Dumps the current Kerberos and KADM5 database into an ASCII file.  By default, the database is
              dumped in current format, "kdb5_util load_dumpversion 5".  If <u>filename</u> is not specified, or is
              the string "-", the dump is sent to standard output.  Options:

              <b>-old</b>   causes the dump to be in the Kerberos 5 Beta 5  and  earlier  dump  format  ("kdb5_edit
                     load_dump version 2.0").

              <b>-b6</b>    causes  the  dump  to  be in the Kerberos 5 Beta 6 format ("kdb5_edit load_dump version
                     3.0").

              <b>-b7</b>    causes the dump to be in the Kerberos 5 Beta 7  format  ("kdb5_util  load_dump  version
                     4").  This was the dump format produced on releases prior to 1.2.2.

              <b>-ov</b>    causes the dump to be in <u>ovsec</u><b>_</b><u>adm</u><b>_</b><u>export</u> format.

              <b>-verbose</b>
                     causes the name of each principal and policy to be printed as it is dumped.

              <b>-mkey_convert</b>
                     prompts  for  a new master key.  This new master key will be used to re-encrypt the key
                     data in the dumpfile.  The key data in the database will not be changed.

              <b>-new_mkey_file</b> <u>mkey</u><b>_</b><u>file</u>
                     the filename of a stash file.  The master key in this stash file will be  used  to  re-<font color="#ffffff" class="whiteout">encrypt&nbsp;reencrypt</font>
                     encrypt  the  key  data  in  the  dumpfile.   The  key data in the database will not be
                     changed.

              <b>-rev</b>   dumps in reverse order.  This may recover principals that  do  not  dump  normally,  in
                     cases where database corruption has occured.

              <b>-recurse</b>
                     causes  the dump to walk the database recursively (btree only).  This may recover prin-<font color="#ffffff" class="whiteout">cipals&nbsp;principals</font>
                     cipals that do not dump normally, in cases where database corruption has  occured.   In
                     cases  of  such corruption, this option will probably retrieve more principals than the
                     <b>-rev</b> option will.

       <b>load</b> [<b>-old</b>] [<b>-b6</b>] [<b>-b7</b>] [<b>-ov</b>] [<b>-hash</b>]
              [<b>-verbose</b>] [<b>-update</b>] <u>filename</u> <u>[dbname</u>] [<u>admin</u><b>_</b><u>dbname</u>]
              Loads a database dump from the named file into the named database.  Unless  the  <b>-old</b>  or  <b>-b6</b>
              option  is  given, the format of the dump file is detected automatically and handled as appro-<font color="#ffffff" class="whiteout">priate.&nbsp;appropriate.</font>
              priate.  Unless the <b>-update</b> option is given, <b>load</b> creates a new database containing  only  the
              principals  in  the  dump  file, overwriting the contents of any previously existing database.
              Note that when using the LDAP KDB plugin the <b>-update</b> must be given.  Options:

              <b>-old</b>   requires the database to be in the Kerberos 5 Beta 5  and  earlier  format  ("kdb5_edit
                     load_dump version 2.0").

              <b>-b6</b>    requires  the database to be in the Kerberos 5 Beta 6 format ("kdb5_edit load_dump ver-<font color="#ffffff" class="whiteout">sion&nbsp;version</font>
                     sion 3.0").

              <b>-b7</b>    requires the database to be in the Kerberos 5 Beta 7 format ("kdb5_util load_dump  ver-<font color="#ffffff" class="whiteout">sion&nbsp;version</font>
                     sion 4").

              <b>-ov</b>    requires  the database to be in <u>ovsec</u><b>_</b><u>adm</u><b>_</b><u>import</u> format.  Must be used with the <b>-update</b>
                     option.

              <b>-hash</b>  requires the database to be stored as a hash.  If this option  is  not  specified,  the
                     database  will  be  stored  as  a  btree.  This option is not recommended, as databases
                     stored in hash format are known to corrupt data and lose principals.

              <b>-verbose</b>
                     causes the name of each principal and policy to be printed as it is dumped.

              <b>-update</b>
                     records from the dump file are added to or updated in the existing database; otherwise,
                     a  new  database  is  created  containing only what is in the dump file and the old one
                     destroyed upon successful completion.

              <b>dbname</b> is optional and, when provided, overrides the value specified on the  command  line  or
                     the default.

              <b>admin_dbname</b>
                     is optional and is derived from <b>dbname</b> if not specified.

       <b>dump_v4</b> [<b>-S</b>] [<u>filename</u>]
              Dumps  the current database into the Kerberos 4 database dump format.  The -S option specifies
              the short lifetime algorithm.

       <b>load_v4</b> [<b>-T</b>] [<b>-v</b>] [<b>-h</b>] [<b>-S</b>]
              [<b>-t</b>] [<b>-n</b>] [<b>-K</b>] [<b>-s</b> <u>stashfile</u>] <u>inputfile</u>
              Loads a Kerberos 4 database dump file.  Options:

              <b>-K</b>     prompts for the V5 master key instead of using the stashed version.

              <b>-n</b>     prompts for the V4 master key, instead of reading from the stash file.

              <b>-s</b> <u>stashfile</u>
                     gets the V4 master key out of <u>stashfile</u> instead of /.k

              <b>-T</b>     creates a new <u>krbtgt</u> instead of converting the V4 one.  The V5  server  will  thus  not
                     recognize outstanding tickets, so this should be used with caution.

              <b>-v</b>     lists each principal as it is converted or ignored.

              <b>-t</b>     uses  a  temporary  database, then moves that into place, instead of adding the keys to
                     the current database.

              <b>-S</b>     Uses the short lifetime algorithm for conversion.

              <b>-h</b>     Stores the database as a hash instead of a btree.  This option is not  recommended,  as
                     databases stored in hash format are known to corrupt data and lose principals.

              Note:  if  the  Kerberos  4 database had a default expiration date of 12/31/1999 or 12/31/2009
              (the compiled in defaults for older or newer Kerberos releases) then any  entries  which  have
              the  same  expiration  date will be converted to "never" expire in the version 5 database.  If
              the default did not match either value, all expiration dates will be preserved.

              Also, Kerberos 4 stored a single modification time for any  change  to  a  record;  Version  5
              stores  a  seperate  modification  time and last password change time.  In practice, Version 4
              "modifications" were always password changes.  <u>load</u><b>_</b><u>v4</u> copies the value into both fields.

       <b>ark</b>    Adds a random key.

<b>SEE</b> <b>ALSO</b>
       <a href="kadmin.8.html#//apple_ref/doc/man/8/kadmin">kadmin(8)</a>



                                                                                                KDB5_UTIL(8)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man8/kdb5_util.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man8/kdb5_util.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man8/kdb5_util.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
