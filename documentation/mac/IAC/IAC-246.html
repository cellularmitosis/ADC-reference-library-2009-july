<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Handling Whose Tests(IM:IC)</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000" ="A" NAME="HEADING246"></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-245.html"><IMG ALIGN="BOTTOM" SRC="prev.gif" BORDER="none" HSPACE="20" ALT="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN="BOTTOM" SRC="content.gif" BORDER="none" HSPACE="20" ALT="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN="BOTTOM" SRC="index.gif" BORDER="none" HSPACE="20" ALT="Book Index"></A> <A HREF="IAC-247.html"><IMG ALIGN="BOTTOM" SRC="next.gif" BORDER="none" HSPACE="20" ALT="Next"></A> </CENTER><P>
<FONT SIZE="-1"><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-231.html"><B>Chapter 6 - Resolving and Creating Object Specifier Records</B></A> / <A HREF="IAC-242.html"><B>Writing Object Accessor Functions</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME="HEADING246-0"></A>
<H2><A NAME="MARKER-9-186"></A>Handling Whose Tests</H2>
 If your application provides an object-counting function and an object-comparison function in addition to the appropriate object accessor functions, the Apple Event Manager can resolve object specifier records that specify <CODE>formTest</CODE> without any other assistance from your application. The Apple Event Manager translates object specifier records of key form <CODE>formTest</CODE> into object specifier records of key form <CODE>formWhose</CODE>. This involves collapsing the key form and key data from two object specifier records in a container hierarchy into one object specifier record with the key form <CODE>formWhose</CODE>. <P>
 Some applications may find it more efficient to translate whose tests into their own query languages rather than letting the Apple Event Manager handle the tests. This is useful only for applications that can make use of a test combined with either an absolute position or a range to locate objects. If you want the Apple Event Manager to let your application handle whose tests, set the <CODE>kAEIDoWhose</CODE> flag in the <CODE>callbackFlags</CODE> parameter of the <CODE>AEResolve</CODE> function. If for any reason one of your application's object accessor functions chooses not to handle a particular whose descriptor record, it should return <CODE>errAEEventNotHandled</CODE> as the result code, and the Apple Event Manager will try again using the original object specifier records, just as if the <CODE>kAEIDoWhose</CODE> flag were not set.<P>
 The key data for <CODE>formWhose</CODE> is specified by a <B>whose descriptor record,</B> which is a coerced AE record of descriptor type <CODE>typeWhoseDescriptor</CODE>. The data for a whose descriptor record consists of the two keyword-specified descriptor records shown in <A HREF="#MARKER-9-43">Table 6-5</A>.<A NAME="MARKER-2-187"></A> <A NAME="MARKER-2-188"></A> <A NAME="MARKER-2-189"></A> <A NAME="MARKER-2-190"></A>
<TABLE BORDER="0" CELLPADDING="3">
<CAPTION><A NAME="MARKER-9-43"></A>Keyword-specified descriptor records for <CODE>typeWhoseDescriptor</CODE></CAPTION>
<TH>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyAEIndex<TD>typeLongInteger <TD>Offset of requested element in group of elements that pass a test <A NAME="MARKER-2-32"></A> <TR>
<TD>&nbsp;<TD>typeAbsoluteOrdinal<TD>kAEFirst<BR>kAEMiddle<BR>kAELast<BR>kAEAny<BR>kAEAll<TR>
<TD>&nbsp;<TD>typeWhoseRange<TD>Whose range descriptor record<TR>
<TD>keyAETest<TD>typeCompDescriptor<TD>Comparison descriptor record <A NAME="MARKER-2-45"></A><TR>
<TD>&nbsp;<TD>typeLogicalDescriptor<TD>Logical descriptor record</TABLE>
<P>
 A whose descriptor record is never created directly by an application. The Apple Event Manager creates a whose descriptor record whenever an object specifier record of key form <CODE>formTest</CODE> is used to describe the container for elements described by an object specifier record of key form <CODE>formAbsolutePosition</CODE> or <CODE>formRange</CODE>, with some exceptions as noted in this section. <A NAME="MARKER-2-248"></A><P>
 For example, <A HREF="IAC-238.html#MARKER-9-120">Figure 6-3 on page 6-22</A> shows four object specifier records that show the container hierarchy for the first row that meets a test in the table "MyAddresses" of the database "SurfDB." The top two object specifier records in that figure use the key forms <CODE>formAbsolutePosition</CODE> and <CODE>formTest</CODE> to describe elements in a container. When it receives these two object specifier records, the Apple Event Manager collapses them into one, as shown in <A HREF="#MARKER-9-192">Figure 6-7</A>. It then calls the application's object-counting function to find out how many objects of class <CODE>cRow</CODE> the table contains and the object-comparison function to test the rows in the table until it finds the first row that passes the test. <P>
<B>Figure 6-7  <A NAME="MARKER-9-192"></A>A container hierarchy created by the Apple Event Manager using a whose descriptor record</B><P>
<IMG ALIGN="BOTTOM" SRC="graphics/AE-L-24.jpg"><P>
 If the elements to be tested are described by an object specifier record of key form <CODE>formAbsolutePosition</CODE> or <CODE>formRange</CODE> but are not of the same object class as their container, the Apple Event Manager cannot collapse the existing object specifier records into a whose descriptor record. Instead, the Apple Event Manager creates a whose descriptor record as if a third object specifier record of key form <CODE>formAbsolutePosition</CODE> and <CODE>kAEAll</CODE> were inserted between the object specifier record for the container and that for the tested elements. For example, the Apple Event Manager would interpret a request for "character 1 of word whose first letter = 'a'" as "character 1 of every word whose first letter = 'a'".<P>
 When an object specifier record of key form <CODE>formTest</CODE> is used to describe the container for elements described by an object specifier record of key form <CODE>formRange</CODE>, the Apple Event Manager will, under certain conditions, coerce the corresponding range descriptor record to a <B>whose range descriptor record,</B> which is a coerced AE record of <CODE>typeWhoseRange</CODE>. The data for a whose range descriptor record consists of two keyword-specified descriptor records with the descriptor types and data shown in <BR><A HREF="#MARKER-9-46">Table 6-6</A>. <A NAME="MARKER-2-193"></A>
<TABLE BORDER="0" CELLPADDING="3">
<CAPTION><A NAME="MARKER-9-46"></A>Keyword-specified descriptor records for <CODE>typeWhoseRange</CODE></CAPTION>
<TH>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyAEWhoseRangeStart<TD>typeLongInteger <TD>Offset of beginning of range<TR>
<TD>&nbsp;<TD>typeAbsoluteOrdinal<TD>kAEFirst<BR>kAEMiddle<BR>kAELast<BR>kAEAny<BR>kAEAll<A NAME="MARKER-2-47"></A><TR>
<TD>keyAEWhoseRangeStop<TD>typeLongInteger <TD>Offset of end of range<TR>
<TD>&nbsp;<TD>typeAbsoluteOrdinal<TD>kAEFirst<BR>kAEMiddle<BR>kAELast<BR>kAEAny<BR>kAEAll<A NAME="MARKER-2-48"></A> <A NAME="MARKER-9-149"></A></TABLE>
<P>
 A whose range descriptor record describes the absolute position of the boundary elements, within the set of all elements that pass a test, that identify the beginning and end of the desired range.<P>
 The Apple Event Manager coerces a range descriptor record to a whose range descriptor record if the specified container and its elements are of the same class, if the container for the specified range of elements is a group of Apple event objects that pass a test, and if the boundary objects in the original range descriptor record meet these conditions: <A NAME="MARKER-2-61"></A><P>
<UL>
<LI>Both boundary objects are of the same object class as the Apple event objects in the range they specify.
<LI>The object specifier record for each boundary object specifies its container with a descriptor record of descriptor type <CODE>typeCurrentContainer</CODE>.
<LI>The object specifier record for each boundary object specifies a key form of <CODE>formAbsolutePosition</CODE>.<A NAME="MARKER-2-195"></A> <A NAME="MARKER-2-5"></A><P>
</UL>
 If these conditions are not met, the Apple Event Manager doesn't create a whose range descriptor record. Instead, as described earlier in this section, the Apple Event Manager creates a whose descriptor record as if the original request specified every element that passed the test.<P>
 If your application sets the <CODE>kAEIDoWhose</CODE> flag in the <CODE>callbackFlags</CODE> parameter of <CODE>AEResolve</CODE>, you should provide object accessor functions that can handle <CODE>formWhose</CODE>. These functions should coerce the whose descriptor record specified as key data for an object specifier record to an AE record and extract the data from the AE record by calling the <CODE>AEGetKeyPtr</CODE> and <CODE>AEGetKeyDesc</CODE> functions. If the keyword-specified descriptor record with the keyword <CODE>keyAEIndex</CODE> specifies descriptor type <CODE>typeWhoseRange</CODE>, your object accessor function must also coerce that descriptor record to an AE record and extract the data. Your object accessor function should then attempt to locate the requested objects and, if successful, return a token that identifies them.<P>
 <A NAME="MARKER-9-197"></A>If your application sets the <CODE>kAEIDoWhose</CODE> flag and attempts to resolve every whose descriptor record it receives, the Apple Event Manager does not attempt to resolve object specifier records of any key form. The object-counting and object-comparison functions are never called, and your application is solely responsible for determining the formats and types of all tokens.<A NAME="MARKER-2-284"></A> <A NAME="MARKER-2-199"></A><A NAME="MARKER-2-127"></A><A NAME="MARKER-2-195"></A> <P>
</BLOCKQUOTE>
<HR>
<CENTER>
<A HREF="IAC-245.html"><IMG ALIGN="BOTTOM" SRC="prev.gif" BORDER="none" HSPACE="20" ALT="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN="BOTTOM" SRC="content.gif" BORDER="none" HSPACE="20" ALT="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN="BOTTOM" SRC="index.gif" BORDER="none" HSPACE="20" ALT="Book Index"></A> <A HREF="IAC-247.html"><IMG ALIGN="BOTTOM" SRC="next.gif" BORDER="none" HSPACE="20" ALT="Next"></A> </CENTER><P>
<CENTER><FONT SIZE="-1"><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><BR>7 JUL 1996</CENTER></FONT><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
