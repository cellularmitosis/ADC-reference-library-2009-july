<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Preference Panes: Managing User Preferences</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Managing User Preferences"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20000703" title="Managing User Preferences"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../Cocoa/index.html#//apple_ref/doc/uid/TP30000440-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../../Cocoa/UserExperience-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000465" target="_top">User Experience</a> &gt; <a href="../index.html" target="_top">Preference Panes</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="Application.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="Running.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/20000703-BABGHFDE" title="Managing User Preferences"></a><hr /><H1>Managing User Preferences</H1>

<p>The Preference Panes framework defines the interface through which an application interacts with the preference pane object, but the application is responsible only for displaying the preference pane’s user interface. The preference pane object is responsible for handling the preferences themselves. This section describes techniques by which the preference pane can store and communicate preferences to the target application.</p>

<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="Managing.html#//apple_ref/doc/uid/20000703-BABHJCCA">Preference Services</a>
				
			<br/>
			
        
			
			
				<a href="Managing.html#//apple_ref/doc/uid/20000703-105381">Configuration Files</a>
				
			<br/>
			
        
			
			
				<a href="Managing.html#//apple_ref/doc/uid/20000703-102786">Interprocess Communication</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/20000703-102499" title="Preference Services"></a><a name="//apple_ref/doc/uid/20000703-BABHJCCA" title="Preference Services"></a><h2>Preference Services</h2>
<p>At the heart of the Mac OS X user preference system is Core Foundation Preference Services. This collection of routines defines a set of domains according to the user name, host name, and application ID to which a given preference value applies. Each component of the domain is specified by a CFString. Predefined constant strings are available to easily select either the “Current” instance of a component (such as the current application or current user) or a shared component available to “Any” instance. </p><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<td  scope="row"><p><code><a href="../../../../CoreFoundation/Reference/CFPreferencesUtils/Reference/reference.html#//apple_ref/doc/c_ref/kCFPreferencesCurrentUser" target="_top">kCFPreferencesCurrentUser</a></code></p></td>
<td ><p><code><a href="../../../../CoreFoundation/Reference/CFPreferencesUtils/Reference/reference.html#//apple_ref/doc/c_ref/kCFPreferencesAnyUser" target="_top">kCFPreferencesAnyUser</a></code></p></td>
</tr>
<tr>
<td  scope="row"><p><code><a href="../../../../CoreFoundation/Reference/CFPreferencesUtils/Reference/reference.html#//apple_ref/doc/c_ref/kCFPreferencesCurrentApplication" target="_top">kCFPreferencesCurrentApplication</a></code></p></td>
<td ><p><code><a href="../../../../CoreFoundation/Reference/CFPreferencesUtils/Reference/reference.html#//apple_ref/doc/c_ref/kCFPreferencesAnyApplication" target="_top">kCFPreferencesAnyApplication</a></code></p></td>
</tr>
<tr>
<td  scope="row"><p><code><a href="../../../../CoreFoundation/Reference/CFPreferencesUtils/Reference/reference.html#//apple_ref/doc/c_ref/kCFPreferencesCurrentHost" target="_top">kCFPreferencesCurrentHost</a></code></p></td>
<td ><p><code><a href="../../../../CoreFoundation/Reference/CFPreferencesUtils/Reference/reference.html#//apple_ref/doc/c_ref/kCFPreferencesAnyHost" target="_top">kCFPreferencesAnyHost</a></code></p></td>
</tr>

</table></div>
<p>These constants combine to form the eight preference domains shown in <span class="content_text"><a href="Managing.html#//apple_ref/doc/uid/20000703-105184">Table 1</a></span>.</p><a name="//apple_ref/doc/uid/20000703-105184" title="Table 1Preference domains in precedence order"></a><a name="//apple_ref/doc/uid/20000703-BABBBIEB" title="Table 1Preference domains in precedence order"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">
<caption class="tablecaption"><strong>Table 1&nbsp;&nbsp;</strong>Preference domains in precedence order</caption>

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>User name</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Application ID</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Host name</p></th>
</tr>


<tr>
<td  scope="row"><p>Current</p></td>
<td ><p>Current</p></td>
<td ><p>Current</p></td>
</tr>
<tr>
<td  scope="row"><p>Current</p></td>
<td ><p>Current</p></td>
<td ><p>Any</p></td>
</tr>
<tr>
<td  scope="row"><p>Current</p></td>
<td ><p>Any</p></td>
<td ><p>Current</p></td>
</tr>
<tr>
<td  scope="row"><p>Current</p></td>
<td ><p>Any</p></td>
<td ><p>Any</p></td>
</tr>
<tr>
<td  scope="row"><p>Any</p></td>
<td ><p>Current</p></td>
<td ><p>Current</p></td>
</tr>
<tr>
<td  scope="row"><p>Any</p></td>
<td ><p>Current</p></td>
<td ><p>Any</p></td>
</tr>
<tr>
<td  scope="row"><p>Any</p></td>
<td ><p>Any</p></td>
<td ><p>Current</p></td>
</tr>
<tr>
<td  scope="row"><p>Any</p></td>
<td ><p>Any</p></td>
<td ><p>Any</p></td>
</tr>

</table></div>
<p>By providing your own string, you can access domains other than those defined by the current context. Access to the preferences of other users, though, requires special privileges.</p>
<p>Preferences located in domains higher on the list in <span class="content_text"><a href="Managing.html#//apple_ref/doc/uid/20000703-105184">Table 1</a></span> (in other words, the more specific domains) take precedence over those located in lower domains (the more general domains).</p>
<p>The NSUserDefaults class, which is part of the Cocoa Foundation framework, is used by Cocoa applications to manage their user preferences. Because it writes preferences to the second domain listed in <span class="content_text"><a href="Managing.html#//apple_ref/doc/uid/20000703-105184">Table 1</a></span>, using the “Current” application domain, it cannot be used by a preference pane within a preference application. It would write any changed preferences to the preference application’s preference file, instead of to the target application’s file. If the preference pane is embedded in the target application, NSUserDefaults works, but it then breaks the modular and reusable design of the preference pane.</p>
<p>For details on how to read and write preferences to a preference file, see <span class="content_text"><a href="../Tasks/Preferences.html#//apple_ref/doc/uid/20000707-BABFCABJ">“Using Preference Services.”</a></span> For more information about Preferences, see <span class="content_text"><a href="../../../../CoreFoundation/Conceptual/CFPreferences/index.html#//apple_ref/doc/uid/10000129i" target="_top">Preferences</a></span>.</p>
<a name="//apple_ref/doc/uid/20000703-105381" title="Configuration Files"></a><h2>Configuration Files</h2>
<p>When dealing with a cross-platform target application, such as standard BSD daemons, Core Foundation Preference Services cannot be used. Instead, you need to manipulate custom configuration files. For BSD applications, the file is normally a plain text file, but the specific format varies from program to program. Your preference pane needs to include its own code to read, parse, modify, and save these files rather than use Preference Services.</p>
<a name="//apple_ref/doc/uid/20000703-102786" title="Interprocess Communication"></a><h2>Interprocess Communication</h2>
<p>Storing the new preferences on disk is not sufficient when the change applies to a running application or an integrated part of the operating system; you need to inform the target of the change if it is to take effect immediately instead of waiting for a restart. You achieve this by sending a message from the preference pane to the target application. In some cases the message may be a simple function call to an operating system routine.</p>
<p>In Mac OS X there is an abundance of ways to communicate with other processes; each layer and framework has its own preferred methods. Although preference panes are written using the Cocoa Objective-C framework, you are not restricted to its particular implementation of messaging—use what is best for the situation. When the target application is not under your control, your choice is limited to those methods understood by the target.</p>
<p>You could forego saving the preferences in the preference pane altogether if the changes are communicated directly to an omnipresent part of the system that manages its preferences itself. The preference pane could merely send the updated preferences to the target and the target would take responsibility for storing them in a persistent location (typically a file on the disk).</p>
<p>If the target is not guaranteed to always be running, the preference pane needs to update the preference file itself. Use the following communication methods only for auxiliary information or to notify the target, if it is currently running, that its preferences have changed.</p>
<a name="//apple_ref/doc/uid/20000703-101380" title="Apple Events"></a><h3>Apple Events</h3>
<p>At the highest level of interprocess communication are Apple events, the long-time standard for interapplication communication in Mac OS. An Apple event is a high-level message that an application can send to itself, other applications on the same computer, or applications on a remote computer. Apple event objects have a well-defined data structure with support for extensible, hierarchical data types. A well-defined set of Apple events can provide support for a rich scripting interface through AppleScript.</p>
<p>Apple events are the preferred method for applications to communicate with each other in Mac OS X. They are available to both Carbon and Cocoa applications through the Apple Event Manager.</p>
<p>Apple events are beyond the scope of this document. For detailed information on using Apple events, see documentation on the <span class="content_text"><!--a target="_top" -->Apple Event Manager<!--/a--></span> in Carbon.</p>
<a name="//apple_ref/doc/uid/20000703-101402" title="Distributed Objects"></a><h3>Distributed Objects</h3>
<p>The Objective-C language runtime supports an interprocess messaging solution called “distributed objects.” This mechanism enables a Cocoa application to call an object in a different Cocoa application. Calls may be synchronous, meaning the sending process is blocked while waiting for a reply from the receiver, or asynchronous, meaning no reply is expected and the sender is not blocked.</p>
<p>The receiving application “vends,” or makes public, an object to which other applications can connect. Invoking one of the vended object’s methods then takes place as if the object existed in your own application—the syntax does not change. The runtime system handles the necessary transmission of data between the applications. </p>
<br/><div><a name="//apple_ref/doc/uid/20000703-130392" title="Figure 1Distributed object architecture"></a><p><strong>Figure 1&nbsp;&nbsp;</strong>Distributed object architecture</p>
<img src = "Art/distribution.gif" alt = "Distributed object architecture" width="259" height="150"></div><br/>
<p>If your preference pane is to be used to control a faceless Cocoa application, this is a very simple technique for interapplication communication. Since it allows two-way communication, you can provide greater interaction between the user and the application. The preference application can obtain the current settings directly from the target application instead of a preference file. It can then get immediate feedback on whether the user’s modifications are accepted by the target.</p>
<p>For details on how to use distributed objects in a preference pane, see <span class="content_text"><a href="../Tasks/Communication.html#//apple_ref/doc/uid/20000708-101533">“Using Distributed Objects.”</a></span> For more information on distributed objects, see <em>Inside Mac OS X: The Objective-C Programming Language</em> and the <span class="content_text"><a href="../../../../Cocoa/Reference/Foundation/Classes/NSConnection_Class/Reference/Reference.html#//apple_ref/occ/cl/NSConnection" target="_top">NSConnection</a></span> and <span class="content_text"><a href="../../../../Cocoa/Reference/Foundation/Classes/NSDistantObject_Class/Reference/Reference.html#//apple_ref/occ/cl/NSDistantObject" target="_top">NSDistantObject</a></span> class descriptions in the Foundation Framework Reference.</p>
<a name="//apple_ref/doc/uid/20000703-104755" title="Distributed Notifications"></a><h3>Distributed Notifications</h3>
<p>An alternative to the direct and bidirectional communication of distributed objects and Apple events is a one-way distributed notification. A distributed notification is a message posted by any application to a per-machine notification center, which in turn broadcasts the message to any applications interested in receiving it. Included with the notification is an identifier of the sender, and, optionally, a dictionary containing additional information. The receiver of the notification cannot communicate any information back to the sender. <span class="content_text"><a href="Managing.html#//apple_ref/doc/uid/20000703-104661">Figure 2</a></span> illustrates this architecture.</p>
<br/><div><a name="//apple_ref/doc/uid/20000703-104661" title="Figure 2Distributed Notification Model"></a><a name="//apple_ref/doc/uid/20000703-BABECBCA" title="Figure 2Distributed Notification Model"></a><p><strong>Figure 2&nbsp;&nbsp;</strong>Distributed Notification Model</p>
<img src = "Art/notification.gif" alt = "Distributed Notification Model" width="259" height="155"></div><br/>
<p>The distributed notification mechanism is accessible through the Core Foundation CFNotificationCenter object and through the Cocoa NSDistributedNotificationCenter class. A Cocoa application, such as your preference application, can use either interface. A Carbon application, perhaps the target application, can use only the Core Foundation interface. A notification posted using one interface can be received by either.</p><div class="notebox"><a name="//apple_ref/doc/uid/20000703-DontLinkElementID_2" title="Note"></a><p><strong>Note:</strong>&nbsp;Core Foundation and Cocoa notifications are unrelated to the Notification Manager, which is part of Carbon.</p></div>
<p>A benefit of the distributed notification model is the model’s one-to-many capabilities. If you have a suite of tools that share a common set of preferences, each running tool can register for and receive the same notifications for preference changes. Distributed notifications are also sent asynchronously. Your preference pane can post the notification and return immediately; you do not need to wait for the target application to receive the notification and finish processing it.</p>
<p>Further, the target application does not need to be running. If no application is listening for the notification, nothing happens. Because of this, distributed notifications are especially useful for notifying an application of a modified preference file. The preference pane can modify the preference file and post a notification about the change without being dependent on whether someone is listening to it.</p>
<p>Distributed notifications are a system-wide resource shared by all applications. To avoid name conflicts, select notification names that are certain to be unique to your application. See <span class="content_text"><a href="../Tasks/Conflicts.html#//apple_ref/doc/uid/20000706-BAJIAGFD">“Preventing Name Conflicts”</a></span> for details.</p>
<p>For details on how to use distributed notifications in a preference pane, see <span class="content_text"><a href="../Tasks/Communication.html#//apple_ref/doc/uid/20000708-101674">“Using Distributed Notifications.”</a></span> For more information on distributed notifications, see the <span class="content_text"><a href="../../../../Cocoa/Reference/Foundation/Classes/NSDistributedNotificationCenter_Class/Reference/Reference.html#//apple_ref/occ/cl/NSDistributedNotificationCenter" target="_top">NSDistributedNotificationCenter</a></span> class description in the Foundation Framework Reference.</p>
<a name="//apple_ref/doc/uid/20000703-104331" title="Sockets and Ports"></a><h3>Sockets and Ports</h3>
<p>Cross-platform applications cannot make use of the above Mac OS X–specific techniques for interprocess communication. However, Mac OS X supports BSD sockets, a standard communication method on BSD platforms. You can make use of the standard POSIX socket APIs or take advantage of higher-level abstractions in the Cocoa class NSSocketPort or a Core Foundation CFSocket object. The production and parsing of the raw data stream sent over the sockets are the responsibilities of the preference pane object and the target application.</p>
<a name="//apple_ref/doc/uid/20000703-104683" title="Signals"></a><h3>Signals</h3>
<p>BSD signals are also available in Mac OS X. Signals are software interrupts that can be sent to a specific application. By default, the signal terminates the receiving application, but the application can override this by installing a signal handler that runs when a particular signal is received. The only information passed by the signal is a single integer identifying the signal.</p>
<p>Traditional BSD services (such as <code>inetd</code>) frequently use the predefined signal <code><a href="../../../../Carbon/Reference/Open_Transport/Reference/reference.html#//apple_ref/doc/c_ref/SIGHUP" target="_top">SIGHUP</a></code> (hangup signal) to reset themselves. When modifying the preferences of one of these services, write the updated settings to the application’s preference file and send the <code><a href="../../../../Carbon/Reference/Open_Transport/Reference/reference.html#//apple_ref/doc/c_ref/SIGHUP" target="_top">SIGHUP</a></code> signal to the application. In response, the application can reread its preferences.</p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="Application.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="Running.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2003, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-10-03<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/UserExperience/Conceptual/PreferencePanes/Concepts/Managing.html%3Fid%3D10000110i-3.2&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/UserExperience/Conceptual/PreferencePanes/Concepts/Managing.html%3Fid%3D10000110i-3.2&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/UserExperience/Conceptual/PreferencePanes/Concepts/Managing.html%3Fid%3D10000110i-3.2&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
