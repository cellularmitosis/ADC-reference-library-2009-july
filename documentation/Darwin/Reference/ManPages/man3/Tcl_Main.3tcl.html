<html><head><title>Mac OS X Developer Tools
 Manual Page For Tcl_Main(3tcl)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/3tcl/Tcl_Main" title="Mac OS X Developer Tools
 Manual Page for Tcl_Main(3tcl)"><a name="//apple_ref/doc/man/3/Tcl_Main" title="Mac OS X Developer Tools
 Manual Page for Tcl_Main(3tcl)"><!-- headerDoc=man; indexgroup=Section 3tcl; uid="//apple_ref/doc/man/3tcl/Tcl_Main"; name=Tcl_Main(3tcl) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac&nbsp;OS&nbsp;X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>

<p style='text-align:justify;'>This manual page is associated with the Mac&nbsp;OS&nbsp;X
developer tools.  The software or headers described may not be present on your
Mac&nbsp;OS&nbsp;X installation until you install the developer tools
package.  This package is available on your Mac&nbsp;OS&nbsp;X installation DVD,
and the latest versions can be downloaded from
<a href="http://developer.apple.com/tools/download/">developer.apple.com</a>.</p>

<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
Tcl_Main(3)                                Tcl Library Procedures                                Tcl_Main(3)



____________________________________________________________________________________________________________

<b>NAME</b>
       Tcl_Main, Tcl_SetMainLoop - main program and event loop definition for Tcl-based applications

<b>SYNOPSIS</b>
       <b>#include</b> <b>&lt;tcl.h&gt;</b>

       <b>Tcl_Main</b>(<u>argc,</u> <u>argv,</u> <u>appInitProc</u>)

       <b>Tcl_SetMainLoop</b>(<u>mainLoopProc</u>)

<b>ARGUMENTS</b>
       int               <u>argc</u>           (in)      Number of elements in <u>argv</u>.

       char              <u>*argv[]</u>        (in)      Array of strings containing command-line arguments.

       Tcl_AppInitProc   <u>*appInitProc</u>   (in)      Address  of  an application-specific initialization proce-<font color="#ffffff" class="whiteout">dure.&nbsp;procedure.</font>
                                                  dure.  The value for this argument is usually <b>Tcl_AppInit</b>.

       Tcl_MainLoopProc  <u>*mainLoopProc</u>  (in)      Address of an application-specific event loop procedure.
____________________________________________________________________________________________________________


<b>DESCRIPTION</b>
       <b>Tcl_Main</b>  can serve as the main program for Tcl-based shell applications.  A ``shell application'' is
       a program like tclsh or wish that supports both interactive interpretation of Tcl and evaluation of a
       script contained in a file given as a command line argument.  <b>Tcl_Main</b> is offered as a convenience to
       developers of shell applications, so they do not have to reproduce all of the code  for  proper  ini-<font color="#ffffff" class="whiteout">tialization&nbsp;initialization</font>
       tialization  of the Tcl library and interactive shell operation.  Other styles of embedding Tcl in an
       application are not supported by <b>Tcl_Main</b>.  Those must be achieved by calling lower  level  functions
       in the Tcl library directly.

       The  <b>Tcl_Main</b>  function has been offered by the Tcl library since release Tcl 7.4.  In older releases
       of Tcl, the Tcl library itself defined a function <b>main</b>, but that lacks flexibility of embedding style
       and  having a function <b>main</b> in a library (particularly a shared library) causes problems on many sys-<font color="#ffffff" class="whiteout">tems.&nbsp;systems.</font>
       tems.  Having <b>main</b> in the Tcl library would also make it hard to use Tcl in C++ programs,  since  C++
       programs must have special C++ <b>main</b> functions.

       Normally each shell application contains a small <b>main</b> function that does nothing but invoke <b>Tcl_Main</b>.
       <b>Tcl_Main</b> then does all the work of creating and running a <b>tclsh</b>-like application.

       <b>Tcl_Main</b> is not provided by the public interface of Tcl's stub library.  Programs that call  <b>Tcl_Main</b>
       must  be  linked against the standard Tcl library.  Extensions (stub-enabled or not) are not intended
       to call <b>Tcl_Main</b>.

       <b>Tcl_Main</b> is not thread-safe.  It should only be called by a single master thread of a  multi-threaded
       application.  This restriction is not a problem with normal use described above.

       <b>Tcl_Main</b>  and therefore all applications based upon it, like <b>tclsh</b>, use <b>Tcl_GetStdChannel</b> to initial-<font color="#ffffff" class="whiteout">ize&nbsp;initialize</font>
       ize the standard channels to their default values. See <b>Tcl_StandardChannels</b> for more information.

       <b>Tcl_Main</b> supports two modes of operation, depending on the values  of  <u>argc</u>  and  <u>argv</u>.   If  <u>argv[1]</u>
       exists  and  does  not  begin with the character <u>-</u>, it is taken to be the name of a file containing a
       <u>startup</u> <u>script</u>, which <b>Tcl_Main</b> will attempt to evaluate.  Otherwise, <b>Tcl_Main</b> will enter an  interac-<font color="#ffffff" class="whiteout">tive&nbsp;interactive</font>
       tive mode.

       In  either  mode, <b>Tcl_Main</b> will define in its master interpreter the Tcl variables <u>argc</u>, <u>argv</u>, <u>argv0</u>,
       and <u>tcl</u><b>_</b><u>interactive</u>, as described in the documentation for <b>tclsh</b>.

       When it has finished its own initialization, but before it processes  commands,  <b>Tcl_Main</b>  calls  the
       procedure  given by the <u>appInitProc</u> argument.  This procedure provides a ``hook'' for the application
       to perform its own initialization of the interpreter created by <b>Tcl_Main</b>, such as  defining  applica-<font color="#ffffff" class="whiteout">tion-specific&nbsp;application-specific</font>
       tion-specific commands.  The procedure must have an interface that matches the type <b>Tcl_AppInitProc</b>:
              typedef int Tcl_AppInitProc(Tcl_Interp *<u>interp</u>);

       <u>AppInitProc</u>  is  almost  always a pointer to <b>Tcl_AppInit</b>; for more details on this procedure, see the
       documentation for <b>Tcl_AppInit</b>.

       When the <u>appInitProc</u> is finished, <b>Tcl_Main</b> enters one of its two modes.  If a startup script has been
       provided,  <b>Tcl_Main</b>  attempts to evaluate it.  Otherwise, interactive mode begins with examination of
       the variable <u>tcl</u><b>_</b><u>rcFileName</u> in the master interpreter.  If that variable exists and holds the name of
       a readable file, the contents of that file are evaluated in the master interpreter.  Then interactive
       operations begin, with prompts and command evaluation results written to the standard output channel,
       and  commands  read  from  the standard input channel and then evaluated.  The prompts written to the
       standard output channel may be customized by defining the Tcl variables <u>tcl</u><b>_</b><u>prompt1</u>  and  <u>tcl</u><b>_</b><u>prompt2</u>
       as  described in the documentation for <b>tclsh</b>.  The prompts and command evaluation results are written
       to the standard output channel only if the Tcl variable <u>tcl</u><b>_</b><u>interactive</u>  in  the  master  interpreter
       holds a non-zero integer value.

       <b>Tcl_SetMainLoop</b> allows setting an event loop procedure to be run.  This allows, for example, Tk to be |
       dynamically loaded and set its event loop.  The event loop will run following the startup script.  If |
       you  are  in  interactive  mode,  setting  the  main  loop  procedure will cause the prompt to become |
       fileevent based and then the loop procedure is called.  When the loop procedure returns  in  interac- |
       tive  mode, interactive operation will continue.  The main loop procedure must have an interface that |
       matches the type <b>Tcl_MainLoopProc</b>:                                                                    |
              typedef void Tcl_MainLoopProc(void);                                                           |

       <b>Tcl_Main</b> does not return.  Normally a program based on <b>Tcl_Main</b> will terminate when the <b>exit</b>  command
       is  evaluated.   In interactive mode, if an EOF or channel error is encountered on the standard input
       channel, then <b>Tcl_Main</b> itself will evaluate the <b>exit</b> command after the main loop procedure  (if  any)
       returns.   In  non-interactive  mode,  after <b>Tcl_Main</b> evaluates the startup script, and the main loop
       procedure (if any) returns, <b>Tcl_Main</b> will also evaluate the <b>exit</b> command.


<b>SEE</b> <b>ALSO</b>
       <a href="../man1/tclsh.1tcl.html#//apple_ref/doc/man/1/tclsh">tclsh(1)</a>, <a href="Tcl_GetStdChannel.3tcl.html#//apple_ref/doc/man/3/Tcl_GetStdChannel">Tcl_GetStdChannel(3)</a>, <a href="Tcl_StandardChannels.3tcl.html#//apple_ref/doc/man/3/Tcl_StandardChannels">Tcl_StandardChannels(3)</a>, <a href="Tcl_AppInit.3tcl.html#//apple_ref/doc/man/3/Tcl_AppInit">Tcl_AppInit(3)</a>, <a href="../mann/exit.ntcl.html#//apple_ref/doc/man/n/exit">exit(n)</a>


<b>KEYWORDS</b>
       application-specific initialization, command-line arguments, main program



Tcl                                                  8.4                                         Tcl_Main(3)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man3/Tcl_Main.3tcl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man3/Tcl_Main.3tcl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man3/Tcl_Main.3tcl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
