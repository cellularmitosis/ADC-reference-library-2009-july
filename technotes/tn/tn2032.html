<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html>	<!-- Template 01-August-01 -->	<!-- Includes revisions to graphics tags -->	<head>		<meta http-equiv="content-type" content="text/html;charset=iso-8859-1">		<meta name="generator" content="Adobe GoLive 4">		<title>Technical Note TN2032: Getting Started with GDB</title>		<meta name="keywords" content="TN2032, tn, 2032, technote, GDB">		<meta name="Description" content="Technical Note TN2032: This Technote explains how to do commondebugging tasks in GDB (Mac OS X's debugger) on Mac OS Xin C, C++ and Objective-C (Java has its own debugger), aswell as various tips and tricks that developers may findhelpful.">		<link rel="stylesheet" href="../../adcstyle.css" type="text/css">		<link rel="Stylesheet" href="../../style.css" type="text/css">	<meta name="categories" content="Platforms and Tools"><meta name="week-posted" content="Dec 3, 2001 - Dec 7, 2001"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></head>	<body bgcolor="white"><a name="//apple_ref/doc/uid/DTS10003069" title="Getting Started with GDB"></a>		<a name="top"></a><!-- top_of_header_marker_comment -->		<!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/DeveloperTools/index.html">Tools</a> &gt; <a href="../../technicalnotes/DeveloperTools/idxCompilersDebuggers-date.html">Compiling & Debugging</a> &gt; </p><!-- end_header_information -->		<!-- bottom_of_header_marker_comment -->		<!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TN2032</div>
<div id="pageheadsub">Getting Started with GDB</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER>		<center>			<p>			<table border="0" cellspacing="1" width="600">				<tr>					<td align="left" scope="row"><!-- begin_header_box -->						<table width="600" cellpadding="0" cellspacing="0" border="0">							<tr>								<td width=300 valign="top" align=left>									<table border="0" width="300" cellpadding="0" cellspacing="0">										<tr>											<td width=300 align=left><img src="images/tnmenutop.gif" align="bottom" width=300 height=7></td>										</tr>										<tr bgcolor="#e6e6e6">											<td background="images/tnmenubody.gif" width=300 align=left><span id="menutitle">CONTENTS<br>												<br>												</span></td>										</tr>										<tr bgcolor="#e6e6e6">											<td background="images/tnmenubody.gif" width=300 align=left><!-- begin_toc -->												<p id="menutext"><a href="#Section1">GDB in Project Builder</a><br>												<a href="#Section2">Launching, Quitting, and Connecting to Apps with GDB</a></p>												<p id="menutext2"><a href="#commandconventions">Command Conventions</a> <a href="#launchingquitting">Launching/Quitting GDB and Attaching/Running Applications For Debugging</a><br>												<a href="#launchingcfm">Launching CFM Applications in GDB</a></p>												<p id="menutext"><a href="#Section3">Breakpoints, Backtraces, and Disassembling</a></p>												<p id="menutext2"><a href="#regularbreakpoints">Setting/Viewing/Removing Regular Breakpoints,<br>												Stepping, and Continuing</a><br>												<a href="#conditionalbreakpoints">Working With Conditional Breakpoints</a><br>												<a href="#backtraces">Backtraces, Selecting Stack Frames,<br>												and Disassembling</a></p>												<p id="menutext"><a href="#Section4">Source Files, Routines, Expressions, and Variables</a></p>												<p id="menutext2"><a href="#sourcefiles">Listing and Working with Source Files</a><br>												<a href="#expressions">Routines/Expressions in GDB</a><br>												<a href="#variables">Viewing/Setting the Value of Objects, Variables, and Routines</a></p>												<p id="menutext"><a href="#Section5">Additional Notes and Cool Stuff</a><br>												<br>												<a href="#Section6">References</a><br>												<br>												<a href="#Downloads">Downloadables</a></p>												<p><!-- end_toc -->											</td>										</tr>										<tr>											<td width=300 align=left scope="row"><img src="images/tnmenubottom.gif" width=300 height=16></td>										</tr>									</table>								</td>								<td width=300 valign="top" align=left><!-- begin_intro_text -->									<p id="introtext">This Technote explains how to do common debugging tasks in GDB (Mac OS X's debugger) on Mac OS X in C, C++ and Objective-C (Java has its own debugger), as well as various tips and tricks that developers may find helpful.</p>									<p id="introtext">This is not intended to be in any way comprehensive documentation for GDB (see the References section for the full manual), but instead to answer the common questions that a developer new to GDB might have, in a way that you can easily reference in the future. It also has a specifically Mac OS X focus, as opposed to other documentation designed to cover GDB in a more platform-agnostic manner.</p>									<p id="introtext">This technote is divided into four sections: GDB in Project Builder, Launching, Quitting, and Connecting to Apps with GDB, Breakpoints, Backtraces, and Disassembling, and Additional Notes and Cool Stuff.</p>									<p><!-- end_intro_text -->									<!-- begin_date -->									<h3 align=center>[Dec 07 2001]</h3>									<p><!-- end_date -->								</td>							</tr>						</table>						<!-- end_table_box -->						<br>						<br>						<hr width=500 align=center>						<br>						<br>						<!-- begin_content -->						<p><a name="Section1"></a></p>						<h2>GDB in Project Builder</h2>						<p>Project Builder is Apple's own Integrated Development Environment for use on Mac OS X, supporting development in C, C++, Objective-C, Objective-C++, and Java. Project Builder provides a feature-rich GUI development environment in its own right, but doesn't try to do all the work itself - it leverages open-source tools that are familiar to many in the development community. One of these tools is GDB, and is used by Project Builder to provide debugging information to the IDE. Thus, when you debug your app in Project Builder, you are really interacting with GDB. When you debug your application, your window will look something like this:</p>						<center>							<p><img src="images/tn2032_001.jpg" alt="Project Builder's debugging interface" width=600 height=313></p>						</center>						<center>							<p><b>Figure 1</b>. Project Builder's debugging interface.</p>						</center>						<p>Project Builder itself provides GUI control over your app for such tasks as setting breakpoints (the little arrow in the left margin of the source), stepping through code, and viewing code. Toolbar buttons are provided for stepping, pausing, and continuing, and when breakpoints are hit, stack frames are presented for easy inspection along with variables in scope.</p>						<p>Sometimes, however, you will want to take advantage of debugger functionality that is not yet presented in Project Builder's user interface. At times like these you want to interact with GDB directly: you can do this through the &quot;Console&quot; tab that shows up right below the toolbar. Bringing down this tab lets you talk to the GDB session in progress that Project Builder itself talks to; that means that you don't have to attach GDB to the application yourself, establish breakpoints yourself, etc., and can instead focus on viewing variables in different formats, disassembling, and other features that Project Builder may not yet provide. Much of this technote applies just fine to using GDB in this manner. This hybrid approach - mixing the use of GDB directly with Project Builder - is good for those situations where the IDE's functionality is good enough for most of what you are doing, but there are a few things for which you need direct access to GDB.</p>						<center>							<p><img src="images/tn2032_002.jpg" alt="Typing help in Project Builder's Console produces basic help for GDB" width=600 height=283></p>						</center>						<center>							<p><b>Figure 2</b>. Typing &quot;help&quot; in Project Builder's Console produces basic help for GDB.</p>						</center>						<p>While waiting for new Project Builder versions to implement more GUI debugging functionality, one thing that you can do from the GUI in Project Builder is take advantage of one of the features introduced in version 1.1 that you may not have noticed: the new &quot;Print Description to Console&quot; feature that shows up in the contextual menu that you get when control-clicking on objects in the debugger pane. This works on CoreFoundation (&quot;CF&quot;)-based objects, as well as Objective-C &quot;NS&quot; objects. Selecting that menu item will automatically print the contents of the object to the console pane.</p>						<center>							<p><img src="images/tn2032_003.jpg" alt="Print Description to Console prints the contents of a CF or NS-type object" width=600 height=424></p>						</center>						<center>							<p><b>Figure 3</b>. &quot;Print Description to Console&quot; prints the contents of a CF or NS-type object.</p>						</center>						<p>If you aren't already familiar with it, feel free to peruse the Project Builder Help documentation (available from the Help menu in Project Builder) for more information on general debugging using Project Builder. We are going to move on now and assume that in the course of your development you have found that Project Builder itself is not able to provide the debugging functionality that you need, and that you are going back to the Console tab too often for it to be less than cumbersome. When such a time arrives, it is time to just fire up Terminal and interact with GDB directly and completely yourself. This technote will follow that approach. Next up: an explanation of the conventions and basics of using GDB.</p>						<p><a href="#top">Back to top</a></p>						<p><a name="Section2"></a></p>						<h2>Launching, Quitting, and Connecting to Applications With GDB</h2>						<h3><a name="commandconventions"></a>Command Conventions</h3>						<ul>							<li>Throughout this technote you will see GDB commands introduced with the first letter or letters in parenthesis, like this: <b><code>(b)reak</code></b>. GDB can do tab completion and automatic command expansion, and thus you only need sufficient letters of the command name to make it non-ambiguous. The letters in parenthesis are the minimum needed to invoke that command; for example, typing &quot;b&quot; at the command prompt is equivalent to typing &quot;break.&quot; Some commands have special hard-coded abbreviations even if the abbreviation would be ambiguous, providing quick access to frequently used commands.							<li>You will also see GDB commands introduced that optionally take arguments, and the arguments will be placed in brackets like so: <b><code>(d)elete [breakpoints]</code></b>							<li>GDB commands are &quot;sticky.&quot; This means that if you hit Return on a blank line, GDB will (in general) execute the previous command over again, saving you typing. A few commands (explained as needed) even auto-construct new arguments when auto-repeated this way.							<li>Hitting up-arrow will take you to the previous GDB command, just like the command line.							<li>You can always get help in GDB by simply typing <b><code>help [commandname]</code> </b>or just <b><code>help</code></b>. GDB's man page has some of the basics in it as well.						</ul>						<h3><a name="launchingquitting"></a>Launching/Quitting GDB and Attaching/Running Applications For Debugging</h3>						<ul>							<li>GDB can be launched from the command-line by simply typing <b><code>gdb</code></b>							<li>You can run GDB on a given application by typing <b><code>gdb path-to-your-binary</code></b>, or if the app is already running, typing <b><code>gdb path-to-your-binary process-id</code></b>							<li>A common way to attach GDB to a currently running application in order to debug it is to simply launch GDB, and then type (<b><code>at)tach process-id</code></b>. For instance, you might launch your app in Project Builder, notice that you need to debug it, and then attach to it with GDB via the command-line.							<li>Whenever you attach to a process that is already running, GDB pauses that process to give you a chance to do any setup that you may want to do. You can continue execution of the process by typing <b><code>(c)ontinue</code></b>							<li>When attaching to a process that is already running, GDB may not have a chance to automatically determine what programming language to use for evaluating expressions. This happens most often when debugging Cocoa programs written in Objective-C. The common symptom of this problem is strange parse errors when trying to work with expressions like conditional breakpoints after attaching. The solution is to type <b><code>set language objective-c</code></b> after attaching to tell it what language you will be using.							<li>If you launched GDB by giving it the path to your application binary, you will need to invoke the <b><code>(r)un [arguments to pass to your application]</code></b> command to launch your application.							<li>Quit GDB when you are done by simply typing <b><code>(q)uit</code></b>						</ul>						<h3><a name="launchingcfm"></a>Launching CFM Applications in GDB</h3>						<ul>							<li>CFM (Code Fragment Manager) applications (the format used by Mac OS 9-compatible Carbon applications) rely on the LaunchCFMApp application to run on Mac OS X. Thus, to debug a CFM application under GDB, you will want to launch GDB with the path to LaunchCFMApp, and then use the run command, passing in the path to your CFM binary as an argument.							<li>Warnings about not being able to find various symbol files can be safely ignored; GDB is merely noticing that CFM isn't providing it with as much information as a Mach-O binary would.						</ul>						<center>							<p>							<table border="0" cellpadding="0" width="480">								<tr>									<td align="left" scope="row"><b>Listing 1</b>. Here we load LaunchCFMApp, and use it to run iTunes under GDB. We Control-C to stop execution, and then quit GDB.										<p>										<table border="0" cellpadding="5" width="470">											<tr>												<td bgcolor="#e6e6e6" align=left>													<pre>[rivendell:~] mformica% <b><code>gdb /System/Library/Frameworks/Carbon.framework/Versions</code></b><b><code>/A/Support/LaunchCFMApp</code></b>GNU gdb 5.0-20001113 (Apple version gdb-200) (Tue Oct  9 18:01:34GMT 2001) (UI_OUT)Copyright 2000 Free Software Foundation, Inc.GDB is free software, covered by the GNU General Public License, and you arewelcome to change it and/or distribute copies of it under certain conditions.Type &quot;show copying&quot; to see the conditions.There is absolutely no warranty for GDB.  Type &quot;show warranty&quot; for details.This GDB was configured as &quot;powerpc-apple-macos10&quot;.Reading symbols for shared libraries .... done(gdb) <b><code>run /Applications/iTunes.app/Contents/MacOS/iTunes</code></b>Starting program: /System/Library/Frameworks/Carbon.framework/Versions/A/Support/LaunchCFMApp /Applications/iTunes.app/Contents/MacOS/iTunes[Switching to thread 1 (process 1115 thread 0x1603)]Reading symbols for shared libraries........................................... doneReading symbols for shared libraries . doneunable to open symbol file: DrawSprocketLib: No such file or directory.warning: Unable to read symbols from &quot;DrawSprocketLib&quot;; reading from memory.Reading symbols for shared libraries . done...^CProgram received signal SIGINT, Interrupt.0x70001308 in mach_msg_overwrite_trap ()(gdb) <b><code>q</code></b>The program is running.  Exit anyway? (y or n) y                          </pre>												</td>											</tr>										</table>										<br>									</td>								</tr>							</table>						</center>						<p><a href="#top">Back to top</a></p>						<h2><a name="Section3"></a>Breakpoints, Backtraces, and Disassembling</h2>						<h3><a name="regularbreakpoints"></a>Setting/Viewing/Removing Regular Breakpoints, Stepping, and Continuing</h3>						<ul>							<li>You can set a breakpoint in GDB by typing <b><code>(b)reak functionname</code></b>,<b><code> (b)reak sourcefilename:linenum</code></b>, <b><code>(b)reak linenum</code></b> (where the last file whose source text was printed is assumed), or <b><code>(b)reak sourcefilename:functionname</code></b>. Examples:							<ul>								<li>C function: <b><code>b foo</code></b>								<li>C++ method: <b><code>b Foo::bar </code></b>(a choice will be presented if there is more than one match)								<li>Objective-C method: <b><code>b -[Foo bar]</code></b>, or for an action method example, <b><code>b -[Foo bar:]</code></b>							</ul>							<li>Each breakpoint is numbered; you can get a listing of all current breakpoints by typing <b><code>(i)nfo break</code></b>							<li>You can delete a breakpoint or breakpoints by typing <b><code>(d)elete breakpoint-nums-separated-by-spaces</code></b> - for example, <b><code>delete 1 2 3</code></b>, or you can use a dash to indicate a range of breakpoints like so:<b><code> delete 1-3</code></b>							<li>You can also temporarily disable/enable breakpoints by typing <b><code>(dis)able</code></b> or <b><code>(en)able breakpoint-nums-separated-by-spaces</code></b>							<li>After stopping at a breakpoint, type <b><code>(c)ontinue</code></b> to continue execution of your program							<li>After stopping at a breakpoint, type <b><code>(n)ext</code></b> to step over the next line of your program							<li>After stopping at a breakpoint, type <b><code>(s)tep</code></b> to step into the next line of your program							<li>If the location/symbol of the breakpoint you want to set does not yet exist in the program's address space (it is in a loadable bundle that is yet to be loaded, etc.), you can use the <b><code>fb functionname</code></b> command to set a &quot;future breakpoint&quot;							<li>Hitting Control-C will pause your program and take you back to a GDB prompt, ready for your input.						</ul>						<h3><a name="conditionalbreakpoints"></a>Working With Conditional Breakpoints</h3>						<ul>							<li>You can set a conditional breakpoint in GDB by typing <b><code>(b)reak functionname if condition</code></b> where condition is some expression; conversely, you can add/change a condition on an existing breakpoint by typing <b><code>condition breaknum expression</code></b> where breaknum is the breakpoint number you wish to operate on. For example, you might type: <b><code>b foobar if x&gt;25</code></b> or <b><code>condition 3 x&gt;25</code></b>							<li>Conditions can include function calls. For example, you might type: <b><code>b foobar if bigEnough(x)</code></b>							<li>See the section on GDB expressions further down; expressions (in conditional breakpoints, for example) that contain calls to system functions/methods may need those functions/methods to have their return type explicitly cast for GDB to be able to execute them. For example, you might need to do something like this: <b><code>b 9 if (bool)[(NSString *)[myString description] isEqual:@&quot;Hi there!&quot;]</code></b>							<li>Conditions are removed from breakpoints by typing <b><code>condition breaknum</code></b>							<li>A note on watchpoints: Watchpoints are currently not very functional on Mac OS X due to a lack of hardware watchpoints and a conflict with certain PPC instructions. Thus, watchpoints should be avoided, and will not be explained in this technote. You can get similar functionality through the use of conditional breakpoints instead.						</ul>						<h3><a name="backtraces"></a>Backtraces, Selecting Stack Frames, and Disassembling</h3>						<ul>							<li>When you are stopped at a breakpoint, often you will want to see the steps your program has taken to get where it is. GDB gives you such a listing, printing out stack frames starting with the currently executing frame (frame zero) and then working its way back up the stack (to frame one, frame two, etc), by giving you a <i>backtrace</i> when you type <b><code>backtrace [number-of-frames]</code></b> or just <b><code>bt [number-of-frames]</code></b>. This is one of the most common commands you will use in GDB. The optional number of frames argument tells the backtrace command how many levels up the stack (in the call chain) to list; often, you will want to use this argument to help prevent the backtrace information from scrolling off the terminal window due to irrelevant stack frames way up near the beginning of your program.							<li>While stack frame zero is the currently selected frame by default, a specific frame number can be selected by the programmer to bring relevant instance variables into scope by typing: <b><code>frame n</code></b>							<li>You can get information on local variables and arguments to the currently executing routine in your program by typing <b><code>info locals</code></b> or <b><code>info args</code></b>.							<li>You can find the memory address range of a line or routine of source code by typing <b><code>info line [linenum or routinename]</code></b> where the current line is assumed if you don't pass in a linenum or routine name.							<li>You can disassemble the routine you are currently stopped in by simply typing <b><code>(disas)semble</code></b>.							<li>On the other hand, you can disassemble some other chunk of memory by typing <b><code>(disas)semble startaddr, endaddr</code></b> after getting the memory address range you are interested in from <b><code>info line</code></b>. Note that the ending address is optional, and that it will disassemble not just the lines that you give it, but the surrounding lines (usually the whole surrounding routine) as well.						</ul>						<center>							<p>							<table border="0" cellpadding="0" width="480">								<tr>									<td align="left" scope="row"><b>Listing 2</b>. Here we list some code (explained in the next section), get the memory address of line 21, and then disassemble that line and the surrounding Objective-C action method.										<p>										<table border="0" cellpadding="5" width="470">											<tr>												<td bgcolor="#e6e6e6" align=left>													<pre>(gdb) <b><code>list 20,25</code></b>2021          for (i=0;i&lt;10;i++)22          NSLog([someObject whichOne:i]);23      }2425      @end(gdb) <b><code>info line 21</code></b>Line 21 of &quot;MyObject.m&quot; starts at address 0x3dcc &lt;-[MyObjectmyAction:]+72&gt; and ends at 0x3de4 &lt;-[MyObject myAction:]+96&gt;.(gdb) <b><code>disassemble 0x3dcc</code></b>Dump of assembler code for function -[MyObject myAction:]:0x3d84 &lt;-[MyObject myAction:]&gt;: mflr    r00x3d88 &lt;-[MyObject myAction:]+4&gt;:       stmw    r30,-8(r1)0x3d8c &lt;-[MyObject myAction:]+8&gt;:       stw     r0,8(r1)...0x3dcc &lt;-[MyObject myAction:]+72&gt;:      li      r0,0...                          </pre>												</td>											</tr>										</table>										<br>									</td>								</tr>							</table>						</center>						<p><a href="#top">Back to top</a></p>						<h2><a name="Section4"></a>Source Files, Routines, Expressions, and Variables</h2>						<h3><a name="sourcefiles"></a>Listing and Working with Source Files</h3>						<p>Ok, so now you know how to manage breakpoints in your application, but say you forget the name of that important function you wanted to break on? Or, what if you want to list the source code to your program right around the breakpoint? Here's how:</p>						<ul>							<li>You can display the source code of a given file with <b><code>(l)ist filename:startline,endline</code></b>. Other examples:							<ul>								<li>List specific lines from a specific file: <b><code>list SomeFile.c:1,5</code></b>								<li>List specific lines assuming the current file: <b><code>list 20,30</code></b>								<li>List a specific Objective-C method (and surrounding lines): <b><code>list -[MyObject myAction:]</code></b>								<li>List a specific function from a specific file: <b><code>list MyFile.cpp:FooFunction</code></b>								<li>List more lines, continuing from the current spot (breakpoint, etc.): <b><code>list +</code></b>								<li>List previous lines to the current spot (breakpoint, etc.): <b><code>list -</code></b>							</ul>						</ul>						<h3><a name="expressions"></a>Routines/Expressions in GDB</h3>						<ul>							<li>An arbitrary function/method can be called in GDB by typing <b><code>call functionname</code></b>							<li>If you have an expression (in a conditional breakpoint, etc.) that includes a function/method call from one of Apple's system frameworks, chances are that the call won't contain return type information. This is typical for example when making CoreFoundation calls (like CFShow) or Objective-C calls into the AppKit and Foundation frameworks. If the return type is not available to GDB, GDB will not be able to execute the function/method, unless you explicitly cast the function/method call to the proper return type. For example:							<ul>								<li>Including NSString calls in a conditional breakpoint: <b><code>b 9 if (bool)[(NSString *)[myString description] isEqual:@&quot;Hi there!&quot;]</code></b>								<li>Calling CFShow: <b><code>call (void)CFShow(someCFObj)</code></b>							</ul>						</ul>						<h3><a name="variables"></a>Viewing/Setting the Value of Objects, Variables, and Routines</h3>						<ul>							<li>The basic format for viewing the contents of a variable or expression in a given format is <b><code>(p)rint [/format] [expression]</code></b>, with the default format if you omit the format specifier being GDB's best guess based on the variable's data type. For example, you can type <b><code>print /d someVar</code></b> to display it as a signed decimal. Different format specifiers can be given to view the results in different ways. Here are the most commonly used format specifiers:						</ul>						<center>							<p>							<table border="4" cellpadding="0" cellspacing="2" width="312">								<tr>									<td width=22 align=left scope="row">/x</td>									<td align="left">interprets and prints the variable/expression as hex</td>								</tr>								<tr>									<td width=22 align=left scope="row">/d</td>									<td align="left">interprets and prints as signed decimal</td>								</tr>								<tr>									<td width=22 align=left scope="row">/u</td>									<td align="left">interprets and prints as unsigned decimal</td>								</tr>								<tr>									<td width=22 align=left scope="row">/c</td>									<td align="left">interprets and prints as a character constant</td>								</tr>								<tr>									<td width=22 align=left scope="row">/f</td>									<td align="left">interprets and prints as floating point</td>								</tr>								<tr height="24">									<td width=22 height=24 align=left>/a</td>									<td height=24 align=left>interprets and prints as address in hex and offset from nearest preceding symbol</td>								</tr>							</table>						</center>						<ul>							<li>Feel free to use the format specifier in combination with explicit casting to particular data types. Also, GDB does a pretty good job of figuring out complex data types on its own; for example:						</ul>						<center>							<p>							<table border="0" cellpadding="5" width="470">								<tr>									<td bgcolor="#e6e6e6" align=left scope="row">										<pre>(gdb) <b><code>list 18,18</code></b>18          char * someString=&quot;Hello, World!&quot;;(gdb) <b><code>p someString</code></b>$2 = 0x3e70 &quot;Hello, World!\000&quot;...(gdb) <b><code>p (char[5])*someString</code></b>$3 = &quot;Hello&quot;...           </pre>									</td>								</tr>							</table>						</center>						<ul>							<li>Something to be aware of is that you don't really need the space between the word print and the /format because GDB commands can't contain a slash. For example, you can do this: <b><code>p/x someVar</code></b>							<li>When you print a variable or expression in GDB, it will print the results in the form &quot;$somenum = yourvalue.&quot; The $somenum represents the value history, and it increments over the life of your debug session - you can later work with that value again by referring to the appropriate $num.							<li>You can reprint the last value in the value history in a different format by simply specifying <b><code>(p)rint /format</code></b> and leaving off the expression.							<li>Typing <b><code>whatis [variable]</code></b> tells you what type your variable is. For example:						</ul>						<center>							<p>							<table border="0" cellpadding="5" width="470">								<tr>									<td bgcolor="#e6e6e6" align=left scope="row">										<pre>(gdb) <b><code>list 18,18</code></b>18          char * someString=&quot;Hello, World!&quot;;(gdb) <b><code>whatis someString</code></b>type = char *          </pre>									</td>								</tr>							</table>						</center>						<ul>							<li>Cocoa and CoreFoundation opaque objects don't print very well using the print command, because they are objects, not just pointers to data. For these objects, use the <b><code>po</code></b> command (short for print object) to print the object's description, or for CoreFoundation objects, you can also call <b><code>CFShow()</code></b>. For example:						</ul>						<center>							<p>							<table border="0" cellpadding="5" width="470">								<tr>									<td bgcolor="#e6e6e6" align=left scope="row">										<pre>(gdb) <b><code>list 18,19</code></b>18          CFStringRef testString=CFSTR(&quot;just a test&quot;);19          NSString *aString=@&quot;Hi there!&quot;;(gdb) <b><code>po aString</code></b>Hi there!(gdb) <b><code>call (void)CFShow(testString)</code></b>just a test         </pre>									</td>								</tr>							</table>						</center>						<ul>							<li>Note that if you are debugging an already running program that you have attached to in GDB (as opposed to launching the app from within GDB), stdout and stderr will not be hooked up to the Terminal (they will point most likely to the Console or to Project Builder's Run tab, depending upon how you have launched your app). Thus calling CFShow won't print the results in the Terminal, which can be annoying. You can rehook stdout and stderr to point to your Terminal window in GDB like so:						</ul>						<center>							<p>							<table border="0" cellpadding="0" width="480">								<tr>									<td align="left" scope="row"><b>Listing 3</b>. Here we close the existing connections to stdout and stderr, determine the device used by the current shell session, and reopen the connections, passing in the correct device to redirect the output.										<p>										<table border="0" cellpadding="5" width="470">											<tr>												<td bgcolor="#e6e6e6" align=left>													<pre>(gdb) <b><code>call (void) close(1)</code></b>(gdb) <b><code>call (void) close(2)</code></b>(gdb) <b><code>shell tty</code></b>/dev/ttyp1(gdb) <b><code>call (int) open(&quot;/dev/ttyp1&quot;, 2, 0)</code></b>$1 = 1(gdb) <b><code>call (int) open(&quot;/dev/ttyp1&quot;, 2, 0)</code></b>$2 = 2                           </pre>												</td>											</tr>										</table>										<br>									</td>								</tr>							</table>						</center>						<ul>							<li>The value of a variable can be set by typing <b><code>set var someVar=someValue</code></b>; for example, <b><code>set var x=5</code></b>						</ul>						<p><a name="Section5"></a></p>						<h2>Additional Notes &amp; Cool Stuff</h2>						<p>The following are some important items that you may want to investigate further when working with GDB, as well as some tips/tricks that might come in handy:</p>						<ul>							<li><b>MacsBug plugin for GDB:</b> A GDB plugin exists to make GDB look more like MacsBug. You can find it and more information about it in /usr/libexec/gdb/plugins/MacsBug on a system with the Mac OS X Developer Tools installed. Also see Technote 2030 for more information on using GDB from a &quot;MacsBug veteran&quot; approach.							<li><b>Breakpoint tip:</b> A useful thing to do when debugging Cocoa applications is to set a breakpoint on -[NSException raise] to let you study your program at the exact point that something goes wrong.							<li><b>Breakpoint tip:</b> When using MallocDebug in conjunction with GDB to track down double-free bugs, it is quite useful to set a breakpoint on malloc_printf, because when you double-free, it will try to alert you via stderr and your breakpoint will be hit, allowing you to get a backtrace at the exact point where you double-freed.							<li><b>Convenience Variables:</b> GDB sets and permits you to set convenience variables for your use; they all start with &quot;$&quot; and you have probably noticed them already when executing commands and printing variables (whenever you print a variable GDB sets a convenience variable to that value, i.e. &quot;$3='Hello'...&quot;). After establishing a convenience variable, you can refer to it for the rest of your program, to compare old values with new values of the same variable or to use as part of the input to some other command. It is often convenient to do this when diving down into complex data structures for example, instead of having to type the whole long thing every time. For example, instead of this: <b><code>print ((TkWindow *) ((Interp *) interp)-&gt;mainWin)-&gt;display</code></b>, you could type this:						</ul>						<center>							<p>							<table border="0" cellpadding="5" width="470">								<tr>									<td bgcolor="#e6e6e6" align=left scope="row">										<pre>(gdb) <b><code>print (Interp *) interp</code></b>$1 = ...(gdb) <b><code>print ((TkWindow *) $1)-&gt;mainWin</code></b>$2 = ...(gdb) <b><code>print $2-&gt;display</code></b>        </pre>									</td>								</tr>							</table>						</center>						<ul>							<li><b>Program execution location:</b> You can tell GDB to continue execution at a given line using the <b><code>jump linenum</code></b> command. Be careful with this command, as changing your program's execution point to an incorrect point can cause strange execution behavior.							<li><b>Examining memory:</b> GDB has an <b><code>x</code></b> command (short for examine), similar to <b><code>(p)rint</code></b>, which is useful for examining chunks of memory and slicing them in different ways. It has two extra format specifiers: '<b><code>s</code></b>' (null-terminated string) and '<b><code>i</code></b>' (machine instruction).							<li><b>Auto-display of expressions:</b> GDB can be configured using the <b><code>display [/format] expression</code></b> command to automatically display a given expression whenever it stops for a breakpoint. You use <b><code>info display</code></b> to get the list of expressions to display, and <b><code>undisplay displaynums</code></b> is used to remove a given auto-display item.							<li><b>Thread support:</b> For a multi-threaded application, you can use <b><code>thread threadnum</code></b> to switch context to a given thread, <b><code>info threads</code></b> to see what threads exist, and <b><code>thread apply [threadnums] [all] commands</code></b> to apply given commands to a range of threads. For example, <b><code>thread apply all bt</code></b> dumps backtraces of all threads in your application.							<li>GDB has much more functionality than could be covered in this technote; although most of your source-level debugging needs will be met by the commands presented here, don't be afraid to go study the manual as needed; chances are, there is a command or option that will do what you want.						</ul>						<p><br>						</p>						<p><a href="#top">Back to top</a></p>						<p><a name="Section6"></a></p>						<h2>References</h2>						<p>Richard Stallman et al, <a href="http://developer.apple.com/documentation/DeveloperTools/gdb/gdb/gdb_toc.html">Debugging with GDB</a>, Free Software Foundation, March 2000</p>						<p><a href="tn2030.html">Technical Note TN2030, &quot;GDB for MacsBug Veterans&quot;</a></p>						<p><a href="#top">Back to top</a></p>						<p><a name="Downloads"></a></p>						<h2>Downloadables</h2>						<p>						<table border="0" cellpadding="3" width="100%">							<tr>								<td width=50 align=left scope="row">									<center>										<img src="images/acrobatsmall.gif" width=22 height=23 align="middle" alt="Acrobat gif"></center>								</td>								<td align="left">Acrobat version of this Note (340K)</td>								<td width=60 align=left><a href="pdf/tn2032.pdf">Download </a></td>							</tr>						</table>						<br>						<p><a href="#top">Back to top</a></td>				</tr>			</table>		</center>		<p><!-- end_content -->		</CENTER><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tn/tn2032.html%3Fid%3DDTS10003069-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tn/tn2032.html%3Fid%3DDTS10003069-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tn/tn2032.html%3Fid%3DDTS10003069-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information -->	</body></html>