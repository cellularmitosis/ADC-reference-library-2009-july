<html><head><title>Mac OS X
 Manual Page For Encode::Unicode(3pm)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/3pm/Encode::Unicode" title="Mac OS X
 Manual Page for Encode::Unicode(3pm)"><a name="//apple_ref/doc/man/3/Encode::Unicode" title="Mac OS X
 Manual Page for Encode::Unicode(3pm)"><!-- headerDoc=man; indexgroup=Section 3pm; uid="//apple_ref/doc/man/3pm/Encode::Unicode"; name=Encode::Unicode(3pm) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
Encode::Unicode(3pm)                  Perl Programmers Reference Guide                  Encode::Unicode(3pm)



<b>NAME</b>
       Encode::Unicode -- Various Unicode Transformation Formats

<b>SYNOPSIS</b>
           use Encode qw/encode decode/;
           $ucs2 = encode("UCS-2BE", $utf8);
           $utf8 = decode("UCS-2BE", $ucs2);

<b>ABSTRACT</b>
       This module implements all Character Encoding Schemes of Unicode that are officially documented by
       Unicode Consortium (except, of course, for UTF-8, which is a native format in perl).

       &lt;<a href="http://www.unicode.org/glossary/">http://www.unicode.org/glossary/</a> says:
           <u>Character</u> <u>Encoding</u> <u>Scheme</u> A character encoding form plus byte serialization. There are Seven
           character encoding schemes in Unicode: UTF-8, UTF-16, UTF-16BE, UTF-16LE, UTF-32 (UCS-4),
           UTF-32BE (UCS-4BE) and UTF-32LE (UCS-4LE), and UTF-7.

           Since UTF-7 is a 7-bit (re)encoded version of UTF-16BE, It is not part of Unicode's Character
           Encoding Scheme.  It is separately implemented in Encode::Unicode::UTF7.  For details see
           Encode::Unicode::UTF7.

       Quick Reference
                           Decodes from <!-- a -->ord(N)<!-- /a -->           Encodes <!-- a -->chr(N)<!-- /a --> to...
                  octet/char BOM S.P d800-dfff  ord &gt; 0xffff     \x{1abcd} ==
             ---------------+-----------------+------------------------------<font color="#ffffff" class="whiteout">UCS-2BE&nbsp;---------------+-----------------+-----------------------------UCS-2BE</font>
             UCS-2BE       2   N   N  is bogus                  Not Available
             UCS-2LE       2   N   N     bogus                  Not Available
             UTF-16      2/4   Y   Y  is   S.P           S.P            BE/LE
             UTF-16BE    2/4   N   Y       S.P           S.P    0xd82a,0xdfcd
             UTF-16LE      2   N   Y       S.P           S.P    0x2ad8,0xcddf
             UTF-32        4   Y   -  is bogus         As is            BE/LE
             UTF-32BE      4   N   -     bogus         As is       0x0001abcd
             UTF-32LE      4   N   -     bogus         As is       0xcdab0100
             UTF-8       1-4   -   -     bogus   &gt;= 4 octets   \xf0\x9a\af\8d
             ---------------+-----------------+------------------------------<font color="#ffffff" class="whiteout">Size,&nbsp;---------------+-----------------+-----------------------------Size,</font>

<b>Size,</b> <b>Endianness,</b> <b>and</b> <b>BOM</b>
       You can categorize these CES by 3 criteria:  size of each character, endianness, and Byte Order Mark.

       <b>by</b> <b>size</b>

       UCS-2 is a fixed-length encoding with each character taking 16 bits.  It <b>does</b> <b>not</b> support <u>surrogate</u>
       <u>pairs</u>.  When a surrogate pair is encountered during <u>decode()</u>, its place is filled with \x{FFFD} if
       <u>CHECK</u> is 0, or the routine croaks if <u>CHECK</u> is 1.  When a character whose ord value is larger than
       0xFFFF is encountered, its place is filled with \x{FFFD} if <u>CHECK</u> is 0, or the routine croaks if
       <u>CHECK</u> is 1.

       UTF-16 is almost the same as UCS-2 but it supports <u>surrogate</u> <u>pairs</u>.  When it encounters a high surro-<font color="#ffffff" class="whiteout">gate&nbsp;surrogate</font>
       gate (0xD800-0xDBFF), it fetches the following low surrogate (0xDC00-0xDFFF) and "desurrogate"s them
       to form a character.  Bogus surrogates result in death.  When \x{10000} or above is encountered dur-<font color="#ffffff" class="whiteout">ing&nbsp;during</font>
       ing <u>encode()</u>, it "ensurrogate"s them and pushes the surrogate pair to the output stream.

       UTF-32 (UCS-4) is a fixed-length encoding with each character taking 32 bits.  Since it is 32-bit,
       there is no need for <u>surrogate</u> <u>pairs</u>.

       <b>by</b> <b>endianness</b>

       The first (and now failed) goal of Unicode was to map all character repertoires into a fixed-length
       integer so that programmers are happy.  Since each character is either a <u>short</u> or <u>long</u> in C, you have
       to pay attention to the endianness of each platform when you pass data to one another.

       Anything marked as BE is Big Endian (or network byte order) and LE is Little Endian (aka VAX byte
       order).  For anything not marked either BE or LE, a character called Byte Order Mark (BOM) indicating
       the endianness is prepended to the string.

       CAVEAT: Though BOM in utf8 (\xEF\xBB\xBF) is valid, it is meaningless and as of this writing Encode
       suite just leave it as is (\x{FeFF}).

       BOM as integer when fetched in network byte order
                         16         32 bits/char
             -------------------------<font color="#ffffff" class="whiteout">BE&nbsp;------------------------BE</font>
             BE      0xFeFF 0x0000FeFF
             LE      0xFFeF 0xFFFe0000
             -------------------------<font color="#ffffff" class="whiteout">This&nbsp;------------------------This</font>

       This modules handles the BOM as follows.

          When BE or LE is explicitly stated as the name of encoding, BOM is simply treated as a normal
           character (ZERO WIDTH NO-BREAK SPACE).

          When BE or LE is omitted during <u>decode()</u>, it checks if BOM is at the beginning of the string; if
           one is found, the endianness is set to what the BOM says.  If no BOM is found, the routine dies.

          When BE or LE is omitted during <u>encode()</u>, it returns a BE-encoded string with BOM prepended.  So
           when you want to encode a whole text file, make sure you <u>encode()</u> the whole text at once, not
           line by line or each line, not file, will have a BOM prepended.

          "UCS-2" is an exception.  Unlike others, this is an alias of UCS-2BE.  UCS-2 is already regis-<font color="#ffffff" class="whiteout">tered&nbsp;registered</font>
           tered by IANA and others that way.

<b>Surrogate</b> <b>Pairs</b>
       To say the least, surrogate pairs were the biggest mistake of the Unicode Consortium.  But according
       to the late Douglas Adams in <u>The</u> <u>Hitchhiker's</u> <u>Guide</u> <u>to</u> <u>the</u> <u>Galaxy</u> Trilogy, "In the beginning the Uni-<font color="#ffffff" class="whiteout">verse&nbsp;Universe</font>
       verse was created. This has made a lot of people very angry and been widely regarded as a bad move".
       Their mistake was not of this magnitude so let's forgive them.

       (I don't dare make any comparison with Unicode Consortium and the Vogons here ;)  Or, comparing
       Encode to Babel Fish is completely appropriate -- if you can only stick this into your ear :)

       Surrogate pairs were born when the Unicode Consortium finally admitted that 16 bits were not big
       enough to hold all the world's character repertoires.  But they already made UCS-2 16-bit.  What do
       we do?

       Back then, the range 0xD800-0xDFFF was not allocated.  Let's split that range in half and use the
       first half to represent the "upper half of a character" and the second half to represent the "lower
       half of a character".  That way, you can represent 1024 * 1024 = 1048576 more characters.  Now we can
       store character ranges up to \x{10ffff} even with 16-bit encodings.  This pair of half-character is
       now called a <u>surrogate</u> <u>pair</u> and UTF-16 is the name of the encoding that embraces them.

       Here is a formula to ensurrogate a Unicode character \x{10000} and above;

         $hi = ($uni - 0x10000) / 0x400 + 0xD800;
         $lo = ($uni - 0x10000) % 0x400 + 0xDC00;

       And to desurrogate;

        $uni = 0x10000 + ($hi - 0xD800) * 0x400 + ($lo - 0xDC00);

       Note this move has made \x{D800}-\x{DFFF} into a forbidden zone but perl does not prohibit the use of
       characters within this range.  To perl, every one of \x{0000_0000} up to \x{ffff_ffff} (*) is <u>a</u> <u>char</u>-<font color="#ffffff" class="whiteout">acter.&nbsp;character.</font>
       <u>acter</u>.

         (*) or \x{ffff_ffff_ffff_ffff} if your perl is compiled with 64-bit
         integer support!

<b>Error</b> <b>Checking</b>
       Unlike most encodings which accept various ways to handle errors, Unicode encodings simply croaks.

         % perl -MEncode -e '$_ = "\xfe\xff\xd8\xd9\xda\xdb\0\n"' \
                -e 'Encode::from_to($_, "utf16","shift_jis", 0); print'
         UTF-16:Malformed LO surrogate d8d9 at /path/to/Encode.pm line 184.
         % perl -MEncode -e '$a = "BOM missing"' \
                -e ' Encode::from_to($a, "utf16", "shift_jis", 0); print'
         UTF-16:Unrecognised BOM 424f at /path/to/Encode.pm line 184.

       Unlike other encodings where mappings are not one-to-one against Unicode, UTFs are supposed to map
       100% against one another.  So Encode is more strict on UTFs.

       Consider that "division by zero" of Encode :)

<b>SEE</b> <b>ALSO</b>
       Encode, Encode::Unicode::UTF7, &lt;<a href="http://www.unicode.org/glossary/">http://www.unicode.org/glossary/</a>, &lt;<a href="http://www.unicode.org/unicode/faq/utf_bom.html">http://www.unicode.org/uni-</a>
       <a href="http://www.unicode.org/unicode/faq/utf_bom.html">code/faq/utf_bom.html</a>,

       RFC 2781 &lt;<a href="http://rfc.net/rfc2781.html">http://rfc.net/rfc2781.html</a>,

       The whole Unicode standard &lt;<a href="http://www.unicode.org/unicode/uni2book/u2.html">http://www.unicode.org/unicode/uni2book/u2.html</a>

       Ch. 15, pp. 403 of "Programming Perl (3rd Edition)" by Larry Wall, Tom Christiansen, Jon Orwant;
       O'Reilly &amp; Associates; ISBN 0-596-00027-8



perl v5.8.8                                      2001-09-21                             Encode::Unicode(3pm)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man3/Encode__Unicode.3pm.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man3/Encode__Unicode.3pm.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man3/Encode__Unicode.3pm.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
