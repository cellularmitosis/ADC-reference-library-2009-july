<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE> Metafile External References</TITLE></HEAD><BODY BGCOLOR="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- path goes here --><H1 CLASS="H2.Heading2"><A NAME="pgfId=7017"> </A><A NAME="marker=11658"> </A>Metafile External References</H1><P CLASS="T1.Text1"><A NAME="pgfId=7023"> </A>Suppose E is a metafile that contains an object R that you wish to reference from another metafile M. E must have an entry to object R in its Table of Contents (TOC).  There are two ways to achieve this: you can write E out in database mode or make sure that R is written out twice in E while E is in normal mode.  </P><P CLASS="T1.Text1"><A NAME="pgfId=7024"> </A>With such a metafile E, the first step in writing object R out as an external reference is to read R from E. You must open E using the <TT CLASS="cv">UnixPath</TT> storage class. While E is still open for reading, call <TT CLASS="cv">Q3File_MarkAsExternalReference</TT> on R and the <TT CLASS="cv">TQ3FileObject</TT> associated with E.  This marks R as an object that will always be written out as an external reference.  This means that whenever a <TT CLASS="cv">Q3..._Submit</TT> call is made on the object in a write loop, an external reference object is written out that specifies the location of the object in E. </P><P CLASS="T1.Text1"><A NAME="pgfId=7027"> </A>The process of reading metafiles containing external references is transparent to the user, so long as no problems arise. If the location of the object is not given correctly by the UNIX pathname, then the read call on the external reference object will return <TT CLASS="cv">NULL</TT>.  Also, the file object containing the externally referenced object must not currently be open for reading or writing.  </P><P CLASS="T1.Text1"><A NAME="pgfId=7028"> </A>The external reference object contains two pieces of information: the name (or pathname) of the metafile that's being externally referenced (E in this example), and the reference ID of the object R. </P><P CLASS="T1.Text1"><A NAME="pgfId=7029"> </A>Once a file containing external references has been created, calling <TT CLASS="cv">Q3File_GetExternalReferences</TT> returns the names of the files that are externally referred to by M. If no files are externally referred to, the call returns <TT CLASS="cv">NULL</TT>. If one or more files are externally referred to, <TT CLASS="cv">Q3File_GetExternalReferences</TT> returns a group that contains one <TT CLASS="cv">Q3String</TT> object for each external reference object in the metafile. The <TT CLASS="cv">Q3String</TT> object contains the name (in general, the pathname) of the file in question. Because one <TT CLASS="cv">Q3String</TT> object is produced per external reference, it is possible for the same name to appear in several <TT CLASS="cv">Q3String</TT> objects. </P><P CLASS="T1.Text1"><A NAME="pgfId=7018"> </A>Routines that let you access and manipulate external references in metafiles are described in <A HREF="qd3dfileobj.1d.htm#36773" CLASS="XRef">&quot;Custom File Object Routines&quot;</A>. For general information about metafiles, see the document <I CLASS="italics">QuickDraw 3D 1.5 Metafile Reference.</I></P><hr>&#169; 1997 Apple Computer, Inc.</DIV></DIV></DIV></DIV></DIV><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY></HTML>