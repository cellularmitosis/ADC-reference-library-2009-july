<html><head><title>Mac OS X
 Manual Page For security(1)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/1/security" title="Mac OS X
 Manual Page for security(1)"><!-- headerDoc=man; indexgroup=Section 1; uid="//apple_ref/doc/man/1/security"; name=security(1) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
security(1)               BSD General Commands Manual              security(1)

<b>NAME</b>
     <b>security</b> -- Command line interface to keychains and Security.framework

<b>SYNOPSIS</b>
     <b>security</b> [<b>-hilqv</b>] [<b>-p</b> <u>prompt</u>] [<u>command</u>] [<u>command</u><b>_</b><u>options</u>] [<u>command</u><b>_</b><u>args</u>]

<b>DESCRIPTION</b>
     A simple command line interface which lets you administer Keychains, manipulate keys and certificates,
     and do just about anything the Security framework is capable of from the command line.  New commands
     are constantly being added over time.

     By default <b>security</b> will execute the <u>command</u> supplied and report if anything went wrong.

     If the <b>-i</b> or <b>-p</b> options are provided, <b>security</b> will enter interactive mode and allow the user to enter
     multiple commands on stdin.  When EOF is read from stdin <b>security</b> will exit.

     Here is a complete list of the options available:

     <b>-h</b>       If no arguments are specified show a list of all commands.  If arguments are provided show
              usage for each the specified commands.  This options is basically the same as the <b>help</b> com-<font color="#ffffff" class="whiteout">mand.&nbsp;command.</font>
              mand.

     <b>-i</b>       Run <b>security</b> in interactive mode.  A prompt (security&gt; by default) will be displayed and the
              user will be able to type commands on stdin until an EOF is encountered.

     <b>-l</b>       Before <b>security</b> exits run
                    /usr/bin/leaks -nocontext
              on itself to see if the <!-- a -->command(s)<!-- /a --> you executed leaks.

     <b>-p</b> <u>prompt</u>
              This option implies the <b>-i</b> option but changes the default prompt to the argument specified
              instead.

     <b>-q</b>       Will make <b>security</b> less verbose.

     <b>-v</b>       Will make <b>security</b> more verbose.

<b>SECURITY</b> <b>COMMAND</b> <b>SUMMARY</b>
     <b>security</b> provides a rich variety of commands (<u>command</u> in the <u>SYNOPSIS</u>), each of which often has a
     wealth of options, to allow access to the broad functionality provided by the Security framework.  How-<font color="#ffffff" class="whiteout">ever,&nbsp;However,</font>
     ever, you don't have to master every detail for <b>security</b> to be useful to you.

     Here are brief descriptions of all the <b>security</b> commands:

     <b>help</b>                    Show all commands. Or show usage for a command.
     <b>list-keychains</b>          Display or manipulate the keychain search list.
     <b>default-keychain</b>        Display or set the default keychain.
     <b>login-keychain</b>          Display or set the login keychain.
     <b>create-keychain</b>         Create keychains and add them to the search list.
     <b>delete-keychain</b>         Delete keychains and remove them from the search list.
     <b>lock-keychain</b>           Lock the specified keychain.
     <b>unlock-keychain</b>         Unlock the specified keychain.
     <b>set-keychain-settings</b>   Set Nm settings for a keychain.
     <b>show-keychain-info</b>      Show the settings for keychain.
     <b>dump-keychain</b>           Dump the contents of one or more keychains.
     <b>create-keypair</b>          Create an asymmetric key pair.
     <b>add-generic-password</b>    Add a generic password item.
     <b>add-internet-password</b>   Add an internet password item.
     <b>add-certificates</b>        Add certificates to a keychain.
     <b>find-generic-password</b>   Find a generic password item.
     <b>find-internet-password</b>  Find an internet password item.
     <b>find-certificate</b>        Find a certificate item.
     <b>create-db</b>               Create a db using the DL.
     <b>import</b>                  Import <!-- a -->item(s)<!-- /a --> into a keychain.
     <b>export</b>                  Export <!-- a -->item(s)<!-- /a --> from a keychain.
     <b>install-mds</b>             Install (or re-install) the MDS database.
     <b>add-trusted-cert</b>        Add a certificate to Trust Settings.
     <b>remove-trusted-cert</b>     Remove a certificate to Trust Settings.
     <b>dump-trust-settings</b>     Display contents of Trust Settings.
     <b>user-trust-settings-enable</b>
                             Display or manipulate user-level Trust Settings.
     <b>trust-settings-export</b>   Export Trust Settings.
     <b>trust-settings-import</b>   Import Trust Settings.
     <b>verify-cert</b>             Verify <!-- a -->certificate(s)<!-- /a -->.
     <b>authorize</b>               Authorize rights.
     <b>authorizationdb</b>         Make changes to the authorization policy database.
     <b>execute-with-privileges</b>
                             Execute tool with privileges.
     <b>leaks</b>                   Run <u>/usr/bin/leaks</u> on this proccess.

<b>COMMON</b> <b>COMMAND</b> <b>OPTIONS</b>
     This section describes the <u>command</u><b>_</b><u>options</u> that are available across all <b>security</b> commands.

     <b>-h</b>       Show a usage message for the specified command.  This option is basically the same as the <u>help</u>
              command.

<b>SECURITY</b> <b>COMMANDS</b>
     Here (finally) are details on all the <b>security</b> commands and the options each accepts.

     <b>help</b> [<b>-h</b>]
            Show all commands. Or show usage for a command.

     <b>list-keychains</b> [<b>-h</b>] [<b>-d</b> <u>user</u>|<u>system</u>|<u>common</u>] [<b>-s</b> [<u>keychain...</u>]]
            Display or set the keychain search list.

            Options:
            <b>-d</b> <u>user</u>|<u>system</u>|<u>common</u>
                     Specify the preferences domain to be used.
            <b>-s</b>       Set the search list to the specified keychains

     <b>default-keychain</b> [<b>-h</b>] [<b>-d</b> <u>user</u>|<u>system</u>|<u>common</u>] [<b>-s</b> [<u>keychain</u>]]
            Display or set the default keychain.

            Options:
            <b>-d</b> <u>user</u>|<u>system</u>|<u>common</u>
                     Specify the preferences domain to be used.
            <b>-s</b>       Set the default keychain to the specified <u>keychain</u>.  Unset it if no keychain is speci-<font color="#ffffff" class="whiteout">fied.&nbsp;specified.</font>
                     fied.

     <b>login-keychain</b> [<b>-h</b>] [<b>-d</b> <u>user</u>|<u>system</u>|<u>common</u>] [<b>-s</b> [<u>keychain</u>]]
            Display or set the login keychain.

            Options:
            <b>-d</b> <u>user</u>|<u>system</u>|<u>common</u>
                     Specify the preferences domain to be used.
            <b>-s</b>       Set the login keychain to the specified <u>keychain</u>.  Unset it if no keychain is speci-<font color="#ffffff" class="whiteout">fied.&nbsp;specified.</font>
                     fied.

     <b>create-keychain</b> [<b>-hP</b>] [<b>-p</b> <u>password</u>] [<u>keychain...</u>]
            Create keychains and add them to the search list.  if no keychains are specified the user is
            prompted for one.

            Options:
            <b>-P</b>              Prompt the user for a password using the SecurityAgent.
            <b>-p</b> <u>password</u>     Use <u>password</u> as the password for the keychains being created.

            If neither <b>-P</b> or <b>-p</b> <u>password</u> are specified the user is prompted for a password.

     <b>delete-keychain</b> [<b>-h</b>] [<u>keychain...</u>]
            Delete keychains and remove them from the search list.

     <b>lock-keychain</b> [<b>-h</b>] [<b>-a</b>|<u>keychain</u>]
            Lock <u>keychain</u>. Or the default is none is specified.  If the <b>-a</b> options is specified all key-<font color="#ffffff" class="whiteout">chains&nbsp;keychains</font>
            chains are locked.

     <b>unlock-keychain</b> [<b>-hu</b>] [<b>-p</b> <u>password</u>] [<u>keychain</u>]
            Unlock <u>keychain</u>. Or the default is none is specified.

     <b>set-keychain-settings</b> [<b>-hlu</b>] [<b>-t</b> <u>timeout</u>] [<u>keychain</u>]
            Set settings for <u>keychain</u>. Or the default is none is specified.
            <b>-l</b>              Lock keychain when the system sleeps
            <b>-u</b>              Lock keychain after certain period of time specified using <b>-t</b>.
            <b>-t</b> <u>timeout</u>      Automatically lock keychain after <u>timeout</u> seconds of inactivity.

     <b>show-keychain-info</b> [<b>-h</b>]
            Show the settings for keychain.

     <b>dump-keychain</b> [<b>-adhir</b>]
            Dump the contents of one or more keychains.
            <b>-a</b>              Dump acl of items.
            <b>-d</b>              Dump cleartext data of items.
            <b>-i</b>              Interactive acl editing mode.
            <b>-r</b>              Dump raw (possibly ciphertext) data of items.

     <b>create-keypair</b> [<b>-h</b>] [<b>-a</b> <u>alg</u>] [<b>-s</b> <u>size</u>] [<b>-f</b> <u>from</u><b>_</b><u>date</u>] [<b>-t</b> <u>to</u><b>_</b><u>date</u>] [<b>-v</b> <u>days</u>] [<b>-k</b> <u>keychain</u>] [<b>-n</b> <u>name</u>]
     [<b>-A</b>|<b>-T</b> <u>app1:app2:...</u>]
            Create an asymmetric key pair.

     <b>add-generic-password</b> [<b>-h</b>] [<b>-a</b> <u>account</u><b>_</b><u>name</u>] [<b>-s</b> <u>service</u><b>_</b><u>name</u>] [<b>-w</b> <u>password</u><b>_</b><u>data</u>] [<u>keychain</u>]
            Add a generic password item.

     <b>add-internet-password</b> [<b>-h</b>] [<b>-a</b> <u>account</u><b>_</b><u>name</u>] [<b>-d</b> <u>security</u><b>_</b><u>domain</u>] [<b>-p</b> <u>path</u>] [<b>-P</b> <u>port</u>] [<b>-r</b> <u>protocol</u>] [<b>-s</b>
     <u>server</u><b>_</b><u>name</u>] [<b>-t</b> <u>authentication</u><b>_</b><u>type</u>] [<b>-w</b> <u>password</u><b>_</b><u>data</u>] [<u>keychain</u>]
            Add an internet password item.

     <b>add-certificates</b> [<b>-h</b>] [<b>-k</b> <u>keychain</u>] <u>file...</u>
            Add certficates contained in the specified <u>files</u> to the default keychain.  The files must con-<font color="#ffffff" class="whiteout">tain&nbsp;contain</font>
            tain one DER encoded X509 certificate each.
            <b>-k</b> <u>keychain</u>     Use <u>keychain</u> rather than the default keychain.

     <b>find-generic-password</b> [<b>-gh</b>] [<b>-a</b> <u>account-name</u>] [<b>-s</b> <u>service-name</u>] [<b>-</b><u>keychain...</u>]
            Find a generic password item.

     <b>find-internet-password</b> [<b>-gh</b>] [<b>-a</b> <u>account</u><b>_</b><u>name</u>] [<b>-d</b> <u>security</u><b>_</b><u>domain</u>] [<b>-p</b> <u>path</u>] [<b>-P</b> <u>port</u>] [<b>-r</b> <u>protocol</u>]
     [<b>-s</b> <u>server</u><b>_</b><u>name</u>] [<b>-t</b> <u>authentication</u><b>_</b><u>type</u>] [<u>keychain...</u>]
            Find an internet password item.

     <b>find-certificate</b> [<b>-ahmp</b>] [<b>-e</b> <u>email</u><b>_</b><u>address</u>] [<u>keychain...</u>]
            Find a certificate item.  If no <u>keychain</u> arguments are provided, <b>security</b> will search the
            default search list.

            Options:
            <b>-a</b>              Find all matching certificates, not just the first one.
            <b>-g</b> <u>dl</u>|<u>cspdl</u>     Use the AppleDL (default) or AppleCspDL
            <b>-e</b> <u>email</u><b>_</b><u>address</u>
                            Match on "email_address" when searching.
            <b>-m</b>              Show the email addresses in the certificate.
            <b>-p</b>              Output certificate in pem form.  The default is to dump the attributes and key-<font color="#ffffff" class="whiteout">chain&nbsp;keychain</font>
                            chain the cert is in.

            <b>Examples</b>

            security&gt; find-certificate -a -p &gt; allcerts.pem
                     Exports all certificates from all keychains into a pem file called allcerts.pem.

            security&gt; find-certificate -a -e me@foo.com -p &gt; certs.pem
                     Exports all certificates from all keychains with the email address mb@foo.com into a
                     pem file called certs.pem.

     <b>create-db</b> [<b>-aho0</b>] [<b>-g</b> <u>dl</u>|<u>cspdl</u>] [<b>-m</b> <u>mode</u>] [<u>name</u>]
            Create a db using the DL.  If <u>name</u> isn't provided <b>security</b> will prompt the user to type a name.

            Options:
            <b>-a</b>              Turn off autocommit
            <b>-g</b> <u>dl</u>|<u>cspdl</u>     Use the AppleDL (default) or AppleCspDL
            <b>-m</b> <u>mode</u>         Set the file permissions to <u>mode</u>.
            <b>-o</b>              Force using openparams argument
            <b>-0</b>              Force using version 0 openparams

            <b>Examples</b>

            security&gt; create-db -m 0644 test.db

            security&gt; create-db -g cspdl -a test2.db

     <b>export</b> [<b>-k</b> <u>keychain</u>] [<b>-t</b> <u>item</u><b>_</b><u>type</u>] [<b>-f</b> <u>item</u><b>_</b><u>format</u>] [<b>-w</b>] [<b>-p</b> <u>item</u><b>_</b><u>format</u>] [<b>-P</b> <u>passphrase</u>] [<b>-o</b> <u>outfile</u>]
            Export one or more items from a keychain to one of a number of external representations.  If
            <u>keychain</u> isn't provided, items will be exported from the user's default keychain.

            Options:
            <b>-k</b> <u>keychain</u>     Specify keychain from which <!-- a -->item(s)<!-- /a --> will be exported.
            <b>-t</b> <u>item</u><b>_</b><u>type</u>    Specify the type of items to export. Possible types are certs, allKeys, pubKeys,
                            privKeys, identities, and all. The default is all. An identity consists of both
                            a certificate and the corresponding provate key.
            <b>-f</b> <u>item</u><b>_</b><u>format</u>  Specify the format of the exported data. Possible formats are openssl, bsafe,
                            pkcs7, pkcs8, pkcs12, x509, openssh1, openssh2, and pemseq. The default is pem-<font color="#ffffff" class="whiteout">seq&nbsp;pemseq</font>
                            seq if more than one item is being exported. The default is openssl if one key
                            is being exported. The default is x509 if one certificate is being exported.
            <b>-w</b>              Specifies that private keys are to be wrapped on export.
            <b>-p</b>              Specifies that PEM armour is to be applied to the output data.
            <b>-P</b> <u>passphrase</u>   Specify the wrapping passphrase immediately. The default is to obtain a secure
                            passphrase via GUI.
            <b>-o</b> <u>outfile</u>      Write the output data to <u>outfile</u>. Default is to write data to stdout.

            <b>Examples</b>

            security&gt; export -k login.keychain -t certs -o /tmp/certs.pem

            security&gt; export -k newcert.keychain -t identities -f pkcs12 -o /tmp/mycerts.p12

     <b>import</b> inputfile [<b>-k</b> <u>keychain</u>] [<b>-t</b> <u>item</u><b>_</b><u>type</u>] [<b>-f</b> <u>item</u><b>_</b><u>format</u>] [<b>-w</b>] [<b>-P</b> <u>passphrase</u>] [<b>-a</b> <u>attributeName</u>
     <u>attributeValue</u>]
            Import one or more items from <u>inputfile</u> into a keychain. If <u>keychain</u> isn't provided, items will
            be imported into the user's default keychain.

            Options:
            <b>-k</b> <u>keychain</u>     Specify keychain into which <!-- a -->item(s)<!-- /a --> will be imported.
            <b>-t</b> <u>item</u><b>_</b><u>type</u>    Specify the type of items to import. Possible types are cert, pub, priv, ses-<font color="#ffffff" class="whiteout">sion,&nbsp;session,</font>
                            sion, cert, and agg. Pub, priv, and session refer to keys; agg is one of the
                            aggregate types (pkcs12 and PEM sequence). The command can often figure out what
                            item_type an item contains based in the filename and/or item_format.
            <b>-f</b> <u>item</u><b>_</b><u>format</u>  Specify the format of the exported data. Possible formats are openssl, bsafe,
                            raw, pkcs7, pkcs8, pkcs12, x509, openssh1, openssh2, and pemseq. The command can
                            often figure out what format an item is in based in the filename and/or
                            item_type.
            <b>-w</b>              Specifies that private keys are wrapped and must be unwrapped on import.
            <b>-P</b> <u>passphrase</u>   Specify the unwrapping passphrase immediately. The default is to obtain a secure
                            passphrase via GUI.
            <b>-a</b> <u>attributeName</u> <u>attributeValue</u>
                            Specify Optional extended attribute name and value. Can be used multiple times.
                            This is only valid when importing keys (only).

            <b>Examples</b>

            security&gt; import /tmp/certs.pem -k

            security&gt; import /tmp/mycerts.p12 -t agg -k newcert.keychain

            security&gt; import /tmp/mycerts.p12 -f pkcs12 -k newcert.keychain

     <b>install-mds</b>
            Install (or re-install) the Module Directory Services (MDS) database. This is a system tool
            which is not normally used by users. There are no options.

     <b>add-trusted-cert</b> [<b>-d</b>] [<b>-r</b> <u>resultType</u>] [<b>-p</b> <u>policy</u>] [<b>-a</b> <u>appPath</u>] [<b>-s</b> <u>policyString</u>] [<b>-e</b> <u>allowedError</u>] [<b>-u</b>
     <u>keyUsage</u>] [<b>-k</b> <u>keychain</u>] [<b>-i</b> <u>settingsFileIn</u>] [<b>-o</b> <u>settingsFileOut</u>] [<b>-D</b>] certFile
            Add certificate (in DER or PEM format) from <u>certFile</u> to per-user or local Admin Trust Settings.
            When modifying per-user Trust Settings, user authentication is required via an authentication
            dialog. When modifying admin Trust Settings, the process must be running as root, or admin
            authentication is required.

            Options:
            <b>-d</b>              Add to admin cert store; default is user.
            <b>-r</b> <u>resultType</u>   resultType = trustRoot|trustAsRoot|deny|unspecified; default is trustRoot.
            <b>-p</b> <u>policy</u>       Specify policy constraint (ssl, smime, codeSign, IPSec, iChat, basic, swUpdate,
                            pkgSign, pkinitClient, pkinitServer, eap).
            <b>-r</b> <u>resultType</u>   resultType = trustRoot|trustAsRoot|deny|unspecified; default is trustRoot.
            <b>-a</b> <u>appPath</u>      Specify application constraint.
            <b>-s</b> <u>policyString</u>
                            Specify policy-specific string.
            <b>-e</b> <u>allowedError</u>
                            Specify allowed error, an integer.
            <b>-u</b> <u>keyUsage</u>     Specify key usage, an integer.
            <b>-k</b> <u>keychain</u>     Specify keychain to which cert is added.
            <b>-i</b> <u>settingsFileIn</u>
                            Input trust settings file; default is user domain.
            <b>-o</b> <u>settingsFileOut</u>
                            Output trust settings file; default is user domain.
            <b>-D</b>              Add default setting instead of per-cert setting. No certFile is specified when
                            using this option

            <b>Examples</b>
                  security&gt; add-trusted-cert /tmp/cert.der
                  security&gt; add-trusted-cert -d .tmp/cert.der

   <b>remove-trusted-cert</b> [<b>-d</b>] [<b>-D</b>] certFile
          Remove certificate (in DER or PEM format) in <u>certFile</u> from per-user or local Admin Trust Settings.
          When modifying per-user Trust Settings, user authentication is required via an authentication dia-<font color="#ffffff" class="whiteout">log.&nbsp;dialog.</font>
          log. When modifying admin Trust Settings, the process must be running as root, or admin authenti-<font color="#ffffff" class="whiteout">cation&nbsp;authentication</font>
          cation is required.

          Options:
          <b>-d</b>              Remove from admin cert store; default is user.
          <b>-D</b>              Remove Default Root Cert setting instead of an actual cert setting. No certFile is
                          specified when using this option.

   <b>dump-trust-settings</b> [<b>-s</b>] [<b>-d</b>]
          Display Trust Settings.

          Options:
          <b>-s</b>              Display trusted system certs; default is user.
          <b>-d</b>              Display trusted admin certs; default is user.

   <b>user-trust-settings-enable</b> [<b>-d</b>] [<b>-e</b>]
          Display or manipulate user-level Trust Settings. With no arguments, shows the current state of the
          user-level Trust Settings enable. Otherwise enables or disables user-level Trust Settings.

          Options:
          <b>-d</b>              Disable user-level Trust Settings.
          <b>-e</b>              Enable user-level Trust Settings.

   <b>trust-settings-export</b> [<b>-s</b>] [<b>-d</b>] settings_file
          Export Trust Settings to the specified file.

          Options:
          <b>-s</b>              Export system Trust Settings; default is user.
          <b>-d</b>              Export admin Trust Settings; default is user.

   <b>trust-settings-import</b> [<b>-d</b>] settings_file
          Import Trust Settings from the specified file. When modifying per-user Trust Settings, user
          authentication is required via an authentication dialog. When modifying admin Trust Settings, the
          process must be running as root, or admin authentication is required.

          Options:
          <b>-d</b>              Import admin Trust Settings; default is user.

   <b>verify-cert</b> [<b>-c</b> <u>certFile</u>] [<b>-r</b> <u>rootCertFile</u>] [<b>-p</b> <u>policy</u>] [<b>-k</b> <u>keychain</u>] [<b>-n</b>] [<b>-l</b>] [<b>-e</b> <u>emailAddress</u>] [<b>-s</b>
   <u>sslHost</u>] [<b>-q</b>]
          Verify one or more certificates.

          Options:
          <b>-c</b> <u>certFile</u>     Certificate to verify, in DER or PEM format. Can be specified more than once; leaf
                          certificate has to be specified first.
          <b>-r</b> <u>rootCertFile</u>
                          Root certificate, in DER or PEM format. Can be specified more than once. If not
                          specified, the system anchor certificates are used. If one root certificate is
                          specified, and zero (non-root) certificates are specified, the root certificate is
                          verified against itself.
          <b>-p</b> <u>policy</u>       Specify verification policy (ssl, smime, codeSign, IPSec, iChat, basic, swUpdate,
                          pkgSign, pkinitClient, pkinitServer, eap). Default is basic.
          <b>-k</b> <u>keychain</u>     Keychain to search for intermediate certs. Can be specified multiple times.
                          Default is the current user's keychain search list.
          <b>-n</b>              Avoid searching any keychains.
          <b>-l</b>              Species that the leaf certificate is a CA cert. By default, a leaf certificate
                          with a Basic Constraints extension with the CA bit set fails verification.
          <b>-e</b> <u>emailAddress</u>
                          Specify email address for the smime policy.
          <b>-s</b> <u>sslHost</u>      Specify SSL host name for the ssl policy.
          <b>-q</b>              Quiet, no stdout or stderr.

          <b>Examples</b>

          security&gt; verify-cert -c applestore0.cer -c applestore1.cer -p ssl -s store.apple.com

          security&gt; verify-cert -r serverbasic.crt

   <b>authorize</b> [<b>-updPiew</b>] [<u>right...</u>]
          Authorize requested <!-- a -->right(s)<!-- /a -->.  The extend-rights flag will be passed by default.

          Options:
          <b>-u</b>              Allow user interaction.
          <b>-p</b>              Allow returning partial rights.
          <b>-d</b>              Destroy acquired rights.
          <b>-P</b>              Pre-authorize rights only.
          <b>-l</b>              Operate authorization in least privileged mode.
          <b>-i</b>              Internalize authref passed on stdin.
          <b>-e</b>              Externalize authref to stdout
          <b>-w</b>              Wait while holding AuthorizationRef until stdout is closed. This will allow client
                          to read externalized AuthorizationRef from pipe.

          <b>Examples</b>

          security&gt; security authorize -ud my-right
                   Basic authorization of my-right.

          security&gt; security -q authorize -uew my-right | security -q authorize -i my-right
                   Authorizing a right and passing it to another command as a way to add authorization to
                   shell scripts.

   <b>authorizationdb</b> <u>read</u> <u>&lt;right-name&gt;</u>

   <b>authorizationdb</b> <u>write</u> <u>&lt;right-name&gt;</u> <u>[allow|deny|&lt;rulename&gt;]</u>

   <b>authorizationdb</b> <u>remove</u> <u>&lt;right-name&gt;</u>
          Read/Modify authorization policy database. Without a rulename write will read a dictionary as a
          plist from stdin.

          <b>Examples</b>

          security&gt; security authorizationdb read system.privilege.admin &gt; /tmp/aewp-def
                   Read definition of system.privilege.admin right.

          security&gt; security authorizationdb write system.preferences &lt; /tmp/aewp-def
                   Set system.preferences to definition of system.privilege.admin right.

          security&gt; security authorizationdb write system.preferences authenticate-admin
                   Every change to preferences requires an Admin user to authenticate.

   <b>execute-with-privileges</b> <u>&lt;program&gt;</u> [<u>args...</u>]
          Execute tool with privileges.  On success stdin will be read and forwarded to the tool.

   <b>leaks</b> [<b>-h</b>] [<b>-cycles</b>] [<b>-nocontext</b>] [<b>-nostacks</b>] [<b>-exclude</b> <u>symbol</u>]
          Run /usr/bin/leaks on this proccess.  This is to help find memory leaks after running certain com-<font color="#ffffff" class="whiteout">mands.&nbsp;commands.</font>
          mands.

          Options:
          <b>-cycles</b>         Use a stricter algorithm (See <a href="leaks.1.html#//apple_ref/doc/man/1/leaks">leaks(1)</a> for details).
          <b>-nocontext</b>      Withhold the hex dumps of the leaked memory.
          <b>-nostacks</b>       Don't show stack traces of leaked memory.
          <b>-exclude</b> <u>symbol</u>
                          Ignore leaks called from <u>symbol</u>.

<b>ENVIRONMENT</b>
     MallocStackLogging
              When using the <b>leaks</b> command or the <b>-l</b> option it's probably a good idea to set this environ-<font color="#ffffff" class="whiteout">ment&nbsp;environment</font>
              ment variable before <b>security</b> is started.  Doing so will allow leaks to display symbolic back-<font color="#ffffff" class="whiteout">traces.&nbsp;backtraces.</font>
              traces.

<b>FILES</b>
     ~/Library/Preferences/com.apple.security.plist

              Propertylist file containing the current users default keychain and keychain search list.

     /Library/Preferences/com.apple.security.plist

              Propertylist file containing the system default keychain and keychain search list.  This is
              used by processes started at boottime, or those requesting to use the system search domain,
              such as system daemons.

     /Library/Preferences/com.apple.security-common.plist

              Propertylist file containing the a common keychain search list which is appended to every
              users searchlist and to the system search list as well.

<b>SEE</b> <b>ALSO</b>
     <a href="certtool.1.html#//apple_ref/doc/man/1/certtool">certtool(1)</a>, <a href="leaks.1.html#//apple_ref/doc/man/1/leaks">leaks(1)</a>

<b>HISTORY</b>
     <b>security</b> was first introduced in Mac OS X version 10.3

<b>AUTHORS</b>
     Michael Brouwer

<b>BUGS</b>
     <b>security</b> still needs a lot more commands before it can be considered complete.  In particular it should
     someday supersede both the certtool and systemkeychain commands.

Darwin                           April 2, 2008                          Darwin
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man1/security.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man1/security.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man1/security.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
