<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Plug-ins: Conceptual Building Blocks</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Conceptual Building Blocks"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20001160" title="Conceptual Building Blocks"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000421" target="_top">Core Foundation</a> &gt; <a href="../../../ProcessManagement-date.html#//apple_ref/doc/uid/TP30000440-TP30000421-TP30000456" target="_top">Process Management</a> &gt; <a href="../index.html" target="_top">Plug-ins</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="anatomy.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="registration.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/20001160-CJBEJBHH" title="Conceptual Building Blocks"></a><hr /><H1>Conceptual Building Blocks</H1><p>In the plug-in model, the host application defines one or more types that each consist of one or more interfaces. A plug-in implements all of the functions in all of the interfaces for each type the plug-in supports. A plug-in also provides creation functions called factories for each type it wants to implement. When the host application loads a plug-in, a factory function is registered with the host for each of the plug-in’s types. The host can then use a type’s factory function to instantiate the type and obtain a pointer to its IUnknown interface. The host uses IUnknown to query the type for its interface function tables. The function tables give the host access to the plug-in’s interface implementations. <span class="content_text"><a href="conceptual.html#//apple_ref/doc/uid/20001160-102716-BCIHGGEE">Figure 1</a></span> illustrates the relationships between these various components.</p><br/><div><a name="//apple_ref/doc/uid/20001160-102716-BCIHGGEE" title="Figure 1Building blocks of the Core Foundation plug-in model."></a><p><a name="//apple_ref/doc/uid/20001160-102716" title="Figure 1Building blocks of the Core Foundation plug-in model."></a><strong>Figure 1&nbsp;&nbsp;</strong>Building blocks of the Core Foundation plug-in model.</p><img src = "Art/cfpugindetails.gif" alt = "Building blocks of the Core Foundation plug-in model." width="339" height="264"></div><br/><p>The following sections describe each aspect of the plug-in model in detail. In addition, the tasks in this topic provide a complete example of how to build a simple plug-in host and plug-in.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="conceptual.html#//apple_ref/doc/uid/20001160-102738-TPXREF104">UUIDs (Universally Unique Identifiers)</a>
				
			<br/>
			
        
			
			
				<a href="conceptual.html#//apple_ref/doc/uid/20001160-102752-BAJJBBJD">Interfaces</a>
				
			<br/>
			
        
			
			
				<a href="conceptual.html#//apple_ref/doc/uid/20001160-102809-BAJJAIBC">Types</a>
				
			<br/>
			
        
			
			
				<a href="conceptual.html#//apple_ref/doc/uid/20001160-102882-BAJDEBAG">Factories</a>
				
			<br/>
			
        
			
			
				<a href="conceptual.html#//apple_ref/doc/uid/20001160-102910-BAJFDFFC">Instances</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/20001160-102738" title="UUIDs (Universally Unique Identifiers)"></a><a name="//apple_ref/doc/uid/20001160-102738-TPXREF104" title="UUIDs (Universally Unique Identifiers)"></a><h2>UUIDs (Universally Unique Identifiers)</h2><p>UUIDs are used by plug-ins to uniquely identify types, interfaces, and factories. When creating a new type, host developers must generate UUIDs to identify the type as well as its interfaces and factories.</p><p>UUIDs (Universally Unique Identifiers), also known as GUIDs (Globally Unique Identifiers) or IIDs (Interface Identifiers), are 128-bit values guaranteed to be unique. A UUID is made unique over both space and time by combining a value unique to the computer on which it was generated—usually the Ethernet hardware address—and a value representing the number of 100-nanosecond intervals since October 15, 1582 at 00:00:00.</p><p>To create a UUID for a plug-in you typically use the commandline utility <code>uuidgen</code>. If you need to generate UUIDs programmatically you can do so using the functions defined in <code>CFUUID.h</code> (see <span class="content_text"><a href="../Tasks/GeneratingUUID.html#//apple_ref/doc/uid/20001166-CJBEHAAG">“Generating a UUID Programmatically”</a></span>). The standard format for UUIDs represented in ASCII is a string punctuated by hyphens, for example <code>68753A44-4D6F-1226-9C60-0050E4C00067</code>. The hex representation looks, as you might expect, like a list of numerical values preceded by <code>0x</code>. For example, <code>0xD7, 0x36, 0x95, 0x0A, 0x4D, 0x6E, 0x12, 0x26, 0x80, 0x3A, 0x00, 0x50, 0xE4, 0xC0, 0x00, 0x67</code>. In order to use a UUID, you simply create it and then copy the resulting strings into your header and C language source files. Note that Core Foundation’s UUID API is available only on Mac OS X.</p><a name="//apple_ref/doc/uid/20001160-102752" title="Interfaces"></a><a name="//apple_ref/doc/uid/20001160-102752-BAJJBBJD" title="Interfaces"></a><h2>Interfaces</h2><p>An interface is the fundamental abstraction a host uses to define an area of functionality to be implemented by plug-in developers. All interactions between a host and plug-in occur through an interface. In programming terms, an interface represents a function table where each function has a specific semantic meaning.</p><p>An interface constitutes a contract between the host and plug-in. This contract includes</p><ul class="ul"><li class="li"><p>the order of the functions in the interface</p></li><li class="li"><p>the interface functions’ parameter types and return types</p></li><li class="li"><p>the expected behavior of each function</p></li></ul><p>A group of functions cannot rightly be considered an interface unless there is a specific definition of exactly what each function is supposed to do.</p><p>For example, consider an interface with one function that takes a single integer and returns an integer. Without a definition of behavior, any function that takes and returns an integer might be considered an implementation of that interface. To address this ambiguity, the expected behavior of each function in the interface is also “part” of that interface. A plug-in host developer must provide a header file and documentation to potential plug-in developers describing the functions that make up the interface, and exactly how the functions are expected to behave. It is critical that the plug-in developer know exactly what is required to correctly implement the interface.</p><p>Interfaces in the plug-in model are identical to the interfaces defined by Microsoft’s COM architecture. When implemented in C++, all plug-in interfaces inherit the IUnknown interface, and in C, all plug-in interface function tables must include the IUnknown functions. At runtime, the host uses the IUnknown interface to find and obtain access to other interfaces implemented by the plug-in. See <span class="content_text"><a href="../Tasks/defining.html#//apple_ref/doc/uid/20001163-CJBEHAAG">“Defining Types and Interfaces”</a></span> for more information about IUnknown and implementing a plug-in interface.</p><a name="//apple_ref/doc/uid/20001160-102809" title="Types"></a><a name="//apple_ref/doc/uid/20001160-102809-BAJJAIBC" title="Types"></a><h2>Types</h2><p>A type represents an aggregation of interfaces. Like interfaces, types are also defined by the host and implemented by the plug-in. A type is an entirely abstract entity that groups related interfaces together, providing a conceptual umbrella for the different APIs represented by the type’s constituent interfaces. Types allow for a high-level representation of a feature to be implemented or problem to be solved. Interfaces express the way you intend to factor the problem represented by the type. You can think of interfaces as the implementation of a type.</p><p>For example, say you’re developing an application called ImageViewer and you want to allow third parties to add file format support for different types of images using plug-ins. You might define the type <code>ImageAdaptorType</code>, which would consist of two interfaces, <code>ImageIOInterface</code> and <code>ImageSnifferInterface</code>. <code>ImageIOInterface</code> might consist of two functions. The first function would take a parameter of type <code>CFURLRef</code> and return a special <code>ImageViewerImage</code> type defined by ImageViewer to represent an image. The second function would take parameters of type <code>CFURLRef</code> and <code>ImageViewerImage</code> and write the image to the location described by the URL. <code>ImageSnifferInterface</code> might define a function that would take a <code>CFURLRef</code> parameter and return a <code>Boolean</code> value indicating whether the file pointed to could be read. </p><p>Because an interface cannot ever change once it has been published, types must support multiple interfaces. Instead of changing a type’s interface, you simply add a new interface to the type with the changed or additional functionality. In this way, a single plug-in might support different versions of a host application by implementing a different interface for each version. The type would remain the same; it would be up to the host application to locate and use the appropriate interface.</p><p>It is also possible to define optional interfaces for a type. For example, a host application might define a type with an optional interface specific to a piece of add-on hardware. The host application could test for the presence of that hardware at runtime and, if it exists, the host could request the hardware-specific plug-in interface. If a plug-in implementor doesn’t want to support the hardware specific functionality, they need not implement that interface.</p><a name="//apple_ref/doc/uid/20001160-102882" title="Factories"></a><a name="//apple_ref/doc/uid/20001160-102882-BAJDEBAG" title="Factories"></a><h2>Factories</h2><p>A factory represents a function that can create an instance of one or more types. Calling a type’s factory function is analogous to the calling operator <code>new</code> on a class in Java or C++. When called by the plug-in host, the factory function allocates memory for an instance of the type being requested, sets up the function tables for its interfaces, and returns a pointer to the type’s IUnknown interface. The plug-in host can then use the IUnknown interface to search for other interfaces supported by the type.</p><p>When a CFPlugin is created, the system registers all types the plug-in supports along with their associated factory functions. When the plug-in host wants to create an instance of a given type, it uses the type’s UUID to search for any registered factory functions. It can then use a factory function to create an instance of the type. </p><p>Note that it is possible for a plug-in to have multiple factory functions for the same type. It is up to the developer to define appropriate usage for the different functions.</p><a name="//apple_ref/doc/uid/20001160-102910" title="Instances"></a><a name="//apple_ref/doc/uid/20001160-102910-BAJFDFFC" title="Instances"></a><h2>Instances</h2><p>Because the Core Foundation 1.3 and later plug-in APIs use the COM model, <code>CFPlugInInstanceRefs</code> are no longer necessary. In the post-1.2 API an instance is not a Core Foundation data type that can be directly manipulated, it is rather a generic term referring to the resources used by a plug-in to implement a type.</p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="anatomy.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="registration.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2003, 2005 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2005-03-03<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/CoreFoundation/Conceptual/CFPlugIns/Concepts/conceptual.html%3Fid%3D10000128i-2.3&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/CoreFoundation/Conceptual/CFPlugIns/Concepts/conceptual.html%3Fid%3D10000128i-2.3&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/CoreFoundation/Conceptual/CFPlugIns/Concepts/conceptual.html%3Fid%3D10000128i-2.3&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
