<!-- legacy work start -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<!-- legacy work end -->


<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)

LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Creating a Sound Component (IM: S)  (deprecated)</Title>

<!-- legacy work start -->
        <META NAME="Generator" CONTENT="manual">
        <META http-equiv="content-type" CONTENT="text/html;charset=utf-8">
        <META NAME = "Copyright" CONTENT="Copyright 2007 Apple Inc. All Rights Reserved.">
        <META NAME="IndexTitle" CONTENT="Inside Macintosh: Sound (Not Recommended)">
        <meta name="xcode-display" content="render">

        <LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css"> <!-- before submitting, globally replace ".." with "developer.apple.com" -->
        <script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
<!-- legacy work end -->

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<A NAME=HEADING272></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Sound-271.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Sound-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Sound-336.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Sound-273.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Sound-2.html"><B>Sound</B></A> / <BR><DD><A HREF="Sound-266.html"><B>Chapter 5 - Sound Components</B></A> / <A HREF="Sound-271.html"><B>Writing a Sound Component</B></A></DL></FONT><P>
<HR>

<!-- legacy work start -->
<script type="text/javascript"> placeWatermark()</script>
<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
<i>Inside Macintosh: Sound</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="http://developer.apple.com/referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div>
<!-- legacy work end -->


<BLOCKQUOTE>
<A NAME=HEADING272-0></A>
<H2>Creating a Sound Component</H2>
 <A NAME=MARKER-2-35></A><A NAME=MARKER-2-36></A>A sound component is a component. It contains a number of resources, including icons, strings, and the standard component resource (a resource of type <CODE>'thng'</CODE>) required of any Component Manager component. In addition, a sound component must contain code to handle required selectors passed to it by the Component Manager as well as selectors specific to the sound component.<P>
<DL>
<DT><B>Note</B>
<DD>For complete details on components and their structure, see the chapter "Component Manager" in <I><A HREF="../MoreToolbox/MoreToolbox-2.html">Inside Macintosh: More Macintosh Toolbox</A></I>. This section provides specific information about sound components.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 The component resource binds together all the relevant resources contained in a component; its structure is defined by the <CODE>ComponentResource</CODE> data type.<P>
<PRE>
struct ComponentResource {
   ComponentDescription    cd;
   ResourceSpec            component;
   ResourceSpec            componentName
   ResourceSpec            componentInfo;
   ResourceSpec            componentIcon;
};
</PRE>
 The <CODE>component</CODE> field specifies the resource type and resource ID of the component's executable code. By convention, this field should be set to the value <CODE>kSoundComponentCodeType</CODE>:<P>
<PRE>
#define kSoundComponentCodeType     'sift'   /*sound component code type*/
</PRE>
 (You can, however, specify some other resource type if you wish.) The resource ID can be any integer greater than or equal to 128. See the following section for further information about this code resource. The <CODE>ResourceSpec</CODE> data type has this structure:<P>
<PRE>
typedef struct {
   OSType                  resType;
   short                   resID;
} ResourceSpec;
</PRE>
 The <CODE>componentName</CODE> field specifies the resource type and resource ID of the resource that contains the component's name. Usually the name is contained in a resource of type <CODE>'STR '</CODE>. This string should be as short as possible.<P>
 The <CODE>componentInfo</CODE> field specifies the resource type and resource ID of the resource that contains a description of the component. Usually the description is contained in a resource of type <CODE>'STR '</CODE>.<A NAME=MARKER-2-37></A><P>
 The <CODE>componentIcon</CODE> field specifies the resource type and resource ID of the resource that contains an icon for the component. Usually the icon is contained in a resource of type <CODE>'ICON'</CODE>.<A NAME=MARKER-2-38></A><P>
 The <CODE>cd</CODE> field of the <CODE>ComponentResource</CODE> structure is a <B>component description record,</B> which contains additional information about the component. A component description record is defined by the <CODE>ComponentDescription</CODE> data type.<P>
<PRE>
typedef struct {
   OSType                  componentType;
   OSType                  componentSubType;
   OSType                  componentManufacturer;
   unsigned long           componentFlags;
   unsigned long           componentFlagsMask;
} ComponentDescription;
</PRE>
 <A NAME=MARKER-2-39></A>For sound components, the <CODE>componentType</CODE> field must be set to a value recognized by the Sound Manager. Currently, there are five available component types for sound components:<P>
<PRE>
#define kSoundComponentType      'sift'   /*utility component*/
#define kMixerType               'mixr'   /*mixer component*/
#define kSoundHardwareType       'sdev'   /*sound output device component*/
#define kSoundCompressor         'scom'   /*compression component*/
#define kSoundDecompressor       'sdec'   /*decompression component*/
</PRE>
 In addition, the <CODE>componentSubType</CODE> field must be set to a value that indicates the type of audio services your component provides. For example, the Apple-supplied sound output device components have these subtypes:<A NAME=MARKER-2-40></A><P>
<PRE>
#define kClassicSubType          'clas'   /*Classic hardware*/
#define kASCSubType              'asc '   /*ASC device*/
#define kDSPSubType              'dsp '   /*DSP device*/
</PRE>
 If you add your own sound output device component, you should define some other subtype.<P>
<DL>
<DT><B>Note</B>
<DD>Apple Computer, Inc., reserves for its own use all types and subtypes composed solely of lowercase letters.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 You can assign any value you like to the <CODE>componentManufacturer</CODE> field; typically you put the signature of your sound component in this field.<P>
 The <CODE>componentFlags</CODE> field of the component description for a sound component contains bit flags that encode information about the component. You can use this field to specify that the Component Manager should send your component the <CODE>kComponentRegisterSelect</CODE> selector.<P>
<PRE>
enum {
   cmpWantsRegisterMessage    = 1L&lt;&lt;31 /*send register request*/
};
</PRE>
 This bit is most useful for sound output device components, which might need to test for the presence of the appropriate hardware to determine whether to register with the Component Manager. When your component gets the <CODE>kComponentRegisterSelect</CODE> selector at system startup time, it should make sure that all the necessary hardware is available. If it isn't available, your component shouldn't register. See <A HREF=Sound-275.html#MARKER-9-54>"Registering and Opening a Sound Component" beginning on page 5-16</A> for more information on opening and registering your sound component.<P>
 You also use the <CODE>componentFlags</CODE> field of the component description to define the characteristics of your component. For example, you can set a bit in that field to indicate that your sound component can accept stereo sound data. See <A HREF=Sound-273.html#MARKER-9-46>"Specifying Sound Component Capabilities" on page 5-11</A> for more details on specifying the features of your sound component.<P>
 You should set the <CODE>componentFlagsMask</CODE> field to 0.<P>
 <A HREF=#MARKER-9-41>Listing 5-1</A> shows, in Rez format, a component resource for a sample sound output device component named SurfBoard.<P>
<B>Listing 5-1  <A NAME=MARKER-9-41></A>Rez input for a component resource</B><P>
<PRE>
#define kSurfBoardID                      128
#define kSurfBoardSubType                 'SURF'
resource 'thng' (kSurfBoardID, purgeable) {
   'sdev',                       /*component type*/
   kSurfBoardSubType,            /*component subtype*/
   'appl',                       /*component manufacturer*/
   cmpWantsRegisterMessage,      /*component flags*/
   0,                            /*component flags mask*/
   'sift',                       /*component code resource type*/
   kSurfBoardID,                 /*component code resource ID*/
   'STR ',                       /*component name resource type*/
   kSurfBoardID,                 /*component name resource ID*/
   'STR ',                       /*component info resource type*/
   kSurfBoardID+1,               /*component info resource ID*/
   'ICON',                       /*component icon resource type*/
   kSurfBoardID                  /*component icon resource ID*/
};
</PRE>
 Your sound component is contained in a resource file. You can assign any type you wish to be the file creator, but the type of the file must be <CODE>'thng'</CODE>. If the sound component contains a <CODE>'BNDL'</CODE> resource, then the file's bundle bit must be set.<A NAME=MARKER-2-42></A><A NAME=MARKER-2-43></A><A NAME=MARKER-2-44></A><A NAME=MARKER-2-45></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Sound-271.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Sound-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Sound-336.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Sound-273.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Sound-3.html">&copy; Apple Computer, Inc.</A><br>2 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
