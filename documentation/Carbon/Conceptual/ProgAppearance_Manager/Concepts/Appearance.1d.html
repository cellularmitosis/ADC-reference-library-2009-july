<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML EXPERIMENTAL 970324//EN"><HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><TITLE> Creating Custom Themes</TITLE></HEAD><body bgcolor="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><DIV><a name="top"></a><!-- start of banner -->			<!-- end of banner --><!-- start of path --><font face="Geneva,Helvetica,Arial" size="1"><b>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Documentation</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000420" target="_top">Carbon</a> &gt; <a href="../../../UserExperience-date.html#//apple_ref/doc/uid/TP30000420-TP30000465" target="_top">User Experience</a></font><br><br><!-- end of path --></DIV><!-- top navigation --><P><A HREF="Appearance.f.html"><img src="images/up.gif" border="0" alt="Up"></A>   <A HREF="Appearance.1c.html"><img src="images/previous.gif" border="0" alt="Previous"></A>   <A HREF="Appearance.ba.html"><img src="images/next.gif" border="0" alt="Next"></a> <!-- insert Show/Hide frames --><script type="text/javascript" language="JavaScript"><!--function loadFrames(){if (top == self || (parent.frames[1].name != doc))    top.location.href = '../index.html?' + location.href;}if (self != top) {  // loaded in frames  document.write('<a href="'+self.location+'" target="_top"><img src="../images/hideframes.gif" border="0" alt="Hide Frames"></a>');  }else {  // not loaded frames	document.write('<a href="JavaScript:loadFrames()"><img src="../images/showframes.gif" border="0" alt="Show Frames"></a>');}//--></script><!-- end Show/Hide frames --><!-- end of top navigation --><hr alt=""><H1 CLASS="H1.Heading1"><A NAME="pgfId=256138"> </A><A NAME="marker=260646"> </A><A NAME="30259"> </A>Creating <A NAME="marker=260650"> </A>Custom Themes</H1><P CLASS="T1.Text1"><A NAME="pgfId=260069"> </A>There are two common cases where you may wish to create a custom theme. The first is to set up a custom theme environment for your program, to be used only when your program is active. This is useful for some programs, such as games, that need to control the entire user environment while they are active. The second is to create a theme environment that you want to be user-selectable and to have systemwide effect.</P><P CLASS="T1.Text1"><A NAME="pgfId=256144"> </A>In the first case, if you set up a custom theme environment for your application, you don't need the theme you create to show up in the Appearance control panel (that is, to be user-selectable). The steps to create a custom theme that is not user-selectable are as follows:</P><OL><LI CLASS="N.NList"><A NAME="pgfId=256145"> </A>Create a collection, using the Collection Manager function <TT CLASS="cv">NewCollection</TT>.</LI><LI CLASS="N.NList"><A NAME="pgfId=256149"> </A>Using theme collection tags and Collection Manager functions, add collection items describing attributes of the theme to the collection. Note that you do not need to add collection items for every tag defined by the Appearance Manager; you need to include collection items only for those attributes that you want to change. See Theme Collection Tags for descriptions of available tag values.</LI><LI CLASS="N.NList"><A NAME="pgfId=256153"> </A>Call the function <TT>GetTheme</TT> to get a collection containing a copy of the data for the theme that is currently running.</LI><LI CLASS="N.NList"><A NAME="pgfId=256154"> </A>Call <TT CLASS="cv">SetTheme</TT> to set your collection as the current theme.</LI><LI CLASS="N.NList"><A NAME="pgfId=257704"> </A>After you have finished using the custom theme environment for your program, restore the previous theme by calling <TT CLASS="cv">SetTheme</TT>. Pass <TT CLASS="cv">SetTheme</TT> a reference to the collection for the previous theme, which you obtained with your call to <TT CLASS="cv">GetTheme</TT> in Step 3.</LI><LI CLASS="N.NList"><A NAME="pgfId=257740"> </A>Dispose of the collection and its contents when you are done.</LI></OL><P CLASS="T1.Text1"><A NAME="pgfId=257741"> </A>In the second case, if you want the theme to be user-selectable and to have systemwide effect, you need the theme to show up in the Appearance control panel and must therefore follow these steps:</P><OL><LI CLASS="N/.NList=1"><A NAME="pgfId=256157"> </A>Create a collection, using the Collection Manager function <TT CLASS="cv">NewCollection</TT>.</LI><LI CLASS="N.NList"><A NAME="pgfId=256161"> </A>Using theme collection tags and Collection Manager functions, add collection items describing attributes of the theme to the collection. Note that you do not need to add collection items for every tag defined by the Appearance Manager; you need to include collection items only for those attributes that you want to change. See Theme Collection Tags for descriptions of available tag values.</LI><LI CLASS="N.NList"><A NAME="pgfId=256162"> </A>Flatten the collection to a handle, using the Collection Manager function <TT CLASS="cv">FlattenCollectionToHdl</TT>.</LI><LI CLASS="N.NList"><A NAME="pgfId=260310"> </A>Use the Resource Manager to save the flattened collection as a resource of type <TT CLASS="cv">'scen'</TT>. Save the <TT CLASS="cv">'scen'</TT> resource into a custom theme file (that is, in a file of type <TT CLASS="cv">'scen'</TT>) in the Theme Files folder; see Appearance Manager File Type Constants for a description of the <TT CLASS="cv">'scen'</TT> file type. See <I CLASS="italics">More Macintosh Toolbox</I> for a discussion of the Resource Manager and how resources are added to files and released.</LI><LI CLASS="N.NList"><A NAME="pgfId=257769"> </A>Dispose of the collection and its contents when you are done.</LI></OL><hr alt="">&#169 1999, 2000 Apple Computer, Inc. &#150 (Last Updated 27 Nov 00)<P><A HREF="Appearance.f.html"><img src="images/up.gif" border="0" alt="Up"></A> <A HREF="Appearance.1c.html"><img src="images/previous.gif" border="0" alt="Previous"></A><!-- insert Show/Hide frames --><script type="text/javascript" language="JavaScript"><!--function loadFrames(){if (top == self || (parent.frames[1].name != doc))    top.location.href = '../index.html?' + location.href;}if (self != top) {  // loaded in frames  document.write('<a href="'+self.location+'" target="_top"><img src="../images/hideframes.gif" border="0" alt="Hide Frames"></a>');  }else {  // not loaded frames	document.write('<a href="JavaScript:loadFrames()"><img src="../images/showframes.gif" border="0" alt="Show Frames"></a>');}//--></script><!-- end Show/Hide frames --><!--#include virtual="/includes/framesetfooter" --> </body></HTML>