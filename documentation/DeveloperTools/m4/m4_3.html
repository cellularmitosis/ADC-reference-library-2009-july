<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html401/loose.dtd">
<html>
<!--
This manual is for GNU M4 (version 1.4.6, 24 August 2006),
a package containing an implementation of the m4 macro language.

Copyright C 1989, 1990, 1991, 1992, 1993, 1994, 2004, 2005,
2006 Free Software Foundation, Inc.


Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License,
Version 1.2 or any later version published by the Free Software
Foundation; with no Invariant Sections, no Front-Cover Texts, and no
Back-Cover Texts.  A copy of the license is included in the section
entitled "GNU Free Documentation License."

-->
<!-- Created on September, 23 2007 by texi2html 1.70 -->
<!--
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people <dev@texi2html.cvshome.org>
Send bugs and suggestions to <users@texi2html.cvshome.org>

-->
<head>
<title>GNU M4, version 1.4.6: 3. How to invoke macros</title>

<meta name="description" content="GNU M4, version 1.4.6: 3. How to invoke macros">
<meta name="keywords" content="GNU M4, version 1.4.6: 3. How to invoke macros">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.70">
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
ul.toc {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">

<a name="NOD14"></a>
<a name="SEC13"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left" scope="row">[<a href="m4_2.html#SEC12" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC14" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="m4_2.html#SEC7" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="m4.html#SEC_Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="m4_4.html#SEC19" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="m4.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="m4_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="m4_18.html#SEC83" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="m4_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1 class="chapter"> 3. How to invoke macros </h1>

<p>This chapter covers macro invocation, macro arguments and how macro
expansion is treated.

</p><table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top" scope="row"><a href="#SEC14">3.1 Macro invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
<tr><td align="left" valign="top" scope="row"><a href="#SEC15">3.2 Preventing macro invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
<tr><td align="left" valign="top" scope="row"><a href="#SEC16">3.3 Macro arguments</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
<tr><td align="left" valign="top" scope="row"><a href="#SEC17">3.4 Quoting macro arguments</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           On Quoting Arguments to macros
</td></tr>
<tr><td align="left" valign="top" scope="row"><a href="#SEC18">3.5 Macro expansion</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             Expanding macros
</td></tr>
</table>

<hr size="6">
<a name="NOD15"></a>
<a name="SEC14"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left" scope="row">[<a href="#SEC13" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC15" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC13" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC13" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="m4_4.html#SEC19" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="m4.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="m4_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="m4_18.html#SEC83" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="m4_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 3.1 Macro invocation </h2>

<p>Macro invocations has one of the forms

</p><table><tr><td scope="row">&nbsp;</td><td><pre class="example">name
</pre></td></tr></table>

<p>which is a macro invocation without any arguments, or

</p><table><tr><td scope="row">&nbsp;</td><td><pre class="example">name(arg1, arg2, &hellip;, arg<var>n</var>)
</pre></td></tr></table>

<p>which is a macro invocation with <var>n</var> arguments.  Macros can have any
number of arguments.  All arguments are strings, but different macros
might interpret the arguments in different ways.

</p><p>The opening parenthesis <em>must</em> follow the <var>name</var> directly, with
no spaces in between.  If it does not, the macro is called with no
arguments at all.

</p><p>For a macro call to have no arguments, the parentheses <em>must</em> be
left out.  The macro call

</p><table><tr><td scope="row">&nbsp;</td><td><pre class="example">name()
</pre></td></tr></table>

<p>is a macro call with one argument, which is the empty string, not a call
with no arguments.

</p><hr size="6">
<a name="NOD16"></a>
<a name="SEC15"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left" scope="row">[<a href="#SEC14" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC16" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC13" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC13" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="m4_4.html#SEC19" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="m4.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="m4_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="m4_18.html#SEC83" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="m4_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 3.2 Preventing macro invocation </h2>

<p>An innovation of the <code>m4</code> language, compared to some of its
predecessors (like Stratchey's <code>GPM</code>, for example), is the ability
to recognize macro calls without resorting to any special, prefixed
invocation character.  While generally useful, this feature might
sometimes be the source of spurious, unwanted macro calls.  So, GNU
<code>m4</code> offers several mechanisms or techniques for inhibiting the
recognition of names as macro calls.

</p><p>First of all, many builtin macros cannot meaningfully be called
without arguments.  For any of these macros, whenever an opening
parenthesis does not immediately follow their name, the builtin macro
call is not triggered.  This solves the most usual cases, like for
`<samp>include</samp>' or `<samp>eval</samp>'.  Later in this document, the sentence
&quot;This macro is recognized only with parameters&quot; refers to this
specific provision.

</p><p>There is also a command line option (`<samp>--prefix-builtins</samp>', or
`<samp>-P</samp>', see section <a href="m4_1.html#SEC4">Invoking <code>m4</code></a>) which requires all builtin macro names
to be prefixed
by `<samp>m4_</samp>' for them to be recognized.  The option has no effect
whatsoever on user defined macros.  For example, with this option,
one has to write <code>m4_dnl</code> and even <code>m4_m4exit</code>.

</p><p>Another alternative is to redefine problematic macros to a name less
likely to cause conflicts, See section <a href="m4_4.html#SEC19">How to define new macros</a>.

</p><p>If your version of GNU <code>m4</code> has the <code>changeword</code> feature
compiled in, it offers far more flexibility in specifying the
syntax of macro names, both builtin or user-defined.  See section <a href="m4_7.html#SEC41">Changing the lexical structure of words</a>,
for more information on this experimental feature.

</p><p>Of course, the simplest way to prevent a name from being interpreted
as a call to an existing macro is to quote it.  The remainder of
this section studies a little more deeply how quoting affects macro
invocation, and how quoting can be used to inhibit macro invocation.

</p><p>Even if quoting is usually done over the whole macro name, it can also
be done over only a few characters of this name (provided, of course,
that the unquoted portions are not also a macro).  It is also possible
to quote the empty string, but this works only <em>inside</em> the name.
For example:

</p><table><tr><td scope="row">&nbsp;</td><td><pre class="example">`divert'
&rArr;divert
`d'ivert
&rArr;divert
di`ver't
&rArr;divert
div`'ert
&rArr;divert
</pre></td></tr></table>

<p>all yield the string `<samp>divert</samp>'.  While in both:

</p><table><tr><td scope="row">&nbsp;</td><td><pre class="example">`'divert
&rArr;
divert`'
&rArr;
</pre></td></tr></table>

<p>the <code>divert</code> builtin macro will be called, which expands to the
empty string.

</p><p>The output of macro evaluations is always rescanned.  The following
example would yield the string `<samp>de</samp>', exactly as if <code>m4</code>
has been given `<samp>substr(`abcde', `3', `2')</samp>' as input:

</p><table><tr><td scope="row">&nbsp;</td><td><pre class="example">define(`x', `substr(ab')
&rArr;
define(`y', `cde, `3', `2')')
&rArr;
x`'y
&rArr;de
</pre></td></tr></table>
<p>Unquoted strings on either side of a quoted string are subject to
being recognized as macro names.  In the following example, quoting the
empty string allows for the second <code>macro</code> to be recognized as such:

</p><table><tr><td scope="row">&nbsp;</td><td><pre class="example">define(`macro', `m')
&rArr;
macro(`m')macro
&rArr;mmacro
macro(`m')`'macro
&rArr;mm
</pre></td></tr></table>
<p>Quoting may prevent recognizing as a macro name the concatenation of a
macro expansion with the surrounding characters.  In this example:

</p><table><tr><td scope="row">&nbsp;</td><td><pre class="example">define(`macro', `di$1')
&rArr;
macro(`v')`ert'
&rArr;divert
macro(`v')ert
&rArr;
</pre></td></tr></table>

<p>the input will produce the string `<samp>divert</samp>'.  When the quotes were
removed, the <code>divert</code> builtin was called instead.

</p><hr size="6">
<a name="NOD17"></a>
<a name="SEC16"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left" scope="row">[<a href="#SEC15" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC17" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC13" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC13" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="m4_4.html#SEC19" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="m4.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="m4_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="m4_18.html#SEC83" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="m4_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 3.3 Macro arguments </h2>

<p>When a name is seen, and it has a macro definition, it will be expanded
as a macro.

</p><p>If the name is followed by an opening parenthesis, the arguments will be
collected before the macro is called.  If too few arguments are
supplied, the missing arguments are taken to be the empty string.
However, some builtins are documented to behave differently for a
missing optional argument than for an explicit empty string.  If
there are too many arguments, the excess arguments are ignored.
Unquoted leading whitespace is stripped off all arguments.

</p><p>Normally <code>m4</code> will issue warnings if a builtin macro is called
with an inappropriate number of arguments, but it can be suppressed with
the `<samp>-Q</samp>' command line option (see section <a href="m4_1.html#SEC4">Invoking <code>m4</code></a>).  For user
defined macros, there is no check of the number of arguments given.

</p><p>Macros are expanded normally during argument collection, and whatever
commas, quotes and parentheses that might show up in the resulting
expanded text will serve to define the arguments as well.  Thus, if
<var>foo</var> expands to `<samp>, b, c</samp>', the macro call

</p><table><tr><td scope="row">&nbsp;</td><td><pre class="example">bar(a foo, d)
</pre></td></tr></table>

<p>is a macro call with four arguments, which are `<samp>a </samp>', `<samp>b</samp>',
`<samp>c</samp>' and `<samp>d</samp>'.  To understand why the first argument contains
whitespace, remember that leading unquoted whitespace is never part
of an argument, but trailing whitespace always is.

</p><p>It is possible for a macro's definition to change during argument
collection, in which case the expansion uses the definition that was in
effect at the time the opening `<samp>(</samp>' was seen.

</p><table><tr><td scope="row">&nbsp;</td><td><pre class="example">define(`f', `1')
&rArr;
f(define(`f', `2'))
&rArr;1
f
&rArr;2
</pre></td></tr></table>
<p>It is an error if the end of file occurs while collecting arguments.

</p><table><tr><td scope="row">&nbsp;</td><td><pre class="example">define(
^D
error--&gt;m4:stdin:1: ERROR: end of file in argument list
</pre></td></tr></table>
<hr size="6">
<a name="NOD18"></a>
<a name="SEC17"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left" scope="row">[<a href="#SEC16" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC18" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC13" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC13" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="m4_4.html#SEC19" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="m4.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="m4_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="m4_18.html#SEC83" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="m4_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 3.4 Quoting macro arguments </h2>

<p>Each argument has leading unquoted whitespace removed.  Within each
argument, all unquoted parentheses must match.  For example, if
<var>foo</var> is a macro,

</p><table><tr><td scope="row">&nbsp;</td><td><pre class="example">foo(() (`(') `(')
</pre></td></tr></table>

<p>is a macro call, with one argument, whose value is `<samp>() (() (</samp>'.
Commas separate arguments, except when they occur inside quotes,
comments, or unquoted parentheses, See section <a href="m4_4.html#SEC22">Special arguments to macros</a>, for
examples.

</p><p>It is common practice to quote all arguments to macros, unless you are
sure you want the arguments expanded.  Thus, in the above
example with the parentheses, the `right' way to do it is like this:

</p><table><tr><td scope="row">&nbsp;</td><td><pre class="example">foo(`() (() (')
</pre></td></tr></table>
<p>It is, however, in certain cases necessary or convenient to leave out
quotes for some arguments, and there is nothing wrong in doing it.  It
just makes life a bit harder, if you are not careful.  For consistency,
this manual follows the rule of thumb that each layer of parentheses
introduces another layer of single quoting, except when showing the
consequences of quoting rules.  This is done even when the quoted string
cannot be a macro, such as with integers.

</p><hr size="6">
<a name="NOD19"></a>
<a name="SEC18"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left" scope="row">[<a href="#SEC17" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="m4_4.html#SEC19" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC13" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC13" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="m4_4.html#SEC19" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="m4.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="m4_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="m4_18.html#SEC83" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="m4_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 3.5 Macro expansion </h2>

<p>When the arguments, if any, to a macro call have been collected, the
macro is expanded, and the expansion text is pushed back onto the input
(unquoted), and reread.  The expansion text from one macro call might
therefore result in more macros being called, if the calls are included,
completely or partially, in the first macro calls' expansion.

</p><p>Taking a very simple example, if <var>foo</var> expands to `<samp>bar</samp>', and
<var>bar</var> expands to `<samp>Hello world</samp>', the input

</p><table><tr><td scope="row">&nbsp;</td><td><pre class="example">foo
</pre></td></tr></table>

<p>will expand first to `<samp>bar</samp>', and when this is reread and
expanded, into `<samp>Hello world</samp>'.

</p><hr size="6">
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left" scope="row">[<a href="#SEC13" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="m4_4.html#SEC19" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="m4.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="m4_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="m4_18.html#SEC83" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="m4_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<p>
 <font size="-1">
  This document was generated by <em>System Administrator</em> on <em>September, 23 2007</em> using <a href="http://texi2html.cvshome.org/"><em>texi2html 1.70</em></a>.
 </font>
 <br>

</p>
</body>
</html>
