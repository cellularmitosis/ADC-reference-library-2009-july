<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML EXPERIMENTAL 970324//EN"><HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><TITLE> Invoking Server Methods Remotely</TITLE></HEAD><body bgcolor="#ffffff"><!--start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!--start of path --><font face="Geneva,Helvetica,Arial" size="1"><b>PATH<spacer type="horizontal" size="5">&nbsp;</b> <a href="../../../../../../index.html" target="_top">Documentation</a> <b>&gt;</b> <a href="../../../../../webobjects.html" target="_top">WebObjects 4.5</a> <b>&gt;</b>Creating a Java Client Application: A Tutorial</font><br><br><!--end of path --><DIV><a name="top"></a><A HREF="JavaClientTutorial.2e.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="JavaClientTutorial.32.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="JavaClientTutorial.34.html"><img src="images/next.gif" border="0" width="49" height="16"></A><nobr>&nbsp;</nobr><HR></DIV><H1><A NAME="pgfId=1007184"> </A>Invoking Server Methods Remotely</H1><A NAME="pgfId=1007185"> </A>In a Java Client application you may want some methods to execute only on the server. This is particularly the case when security is an issue, but performance can be a reason as well (as when the method consumes a lot of system resources). Objects on the client side of a Java Client application can use two methods to invoke a server method:</P><UL><LI><A NAME="pgfId=1007186"> </A><B>invokeRemoteMethod</B>. An enterprise object on the client side can use this method to invoke a method in the corresponding enterprise object on the server. The arguments are the name of the method to invoke and an array of arguments. Before the method is invoked on the server, the current state of the client-side editing context is &quot;pushed&quot; to the server to ensure that the method executes in an identical context. (Note that EODistributedObjectStore has a version of this method that includes a flag as an argument; setting this flag to <B>false</B> prevents the client from pushing its editing-context state to the server.)<P><LI><A NAME="pgfId=1007187"> </A><B>invokeRemoteMethodWithKeyPath</B>. You can send a message to <I>any</I> object on the server with this method, which is defined in EODistributedObjectStore. For more on this method, see the specification for this EODistribution class.<P></UL><A NAME="pgfId=1007188"> </A>In our StudioManager example, let's say that you want to give studios the ability to buy all of the movies that star a specified actor, but you consider this a sensitive computation. You can implement a method such as the following in <B>Studio</B><EM CLASS="Bold(TradeGothic)">.</EM><B>java</B>:</P><H4><A NAME="pgfId=1007189"> </A>Studio.java (client)</H4><TT>public void buyAllMoviesStarringTalent(Talent talent) {<P>	invokeRemoteMethod(&quot;clientSideRequestBuyAllMoviesStarringTalent&quot;, <BR>&nbsp;&nbsp;&nbsp;new Object[] {talent});<BR>}<P></TT><A NAME="pgfId=1007193"> </A>The method begins with &quot;clientSideRequest&quot;; this is not accidental. The EODistributionContext object on the server-side EODistribution layer will reject a remote invocation unless it has this prefix <I>or</I> its delegate implements the proper delegation methods (see the reference documentation for EODistributionContext or EODistributedObjectStore for more information). </P><A NAME="pgfId=1007194"> </A>The following is the invoked method, which is implemented in the server's <B>Studio.java</B>:</P><H4><A NAME="pgfId=1007195"> </A>Studio.java (server)</H4><TT><BR>public void clientSideRequestBuyAllMoviesStarringTalent(Talent talent) {<BR>&nbsp;&nbsp;&nbsp;int i, count;<BR>&nbsp;&nbsp;&nbsp;NSArray talentMovies;<BR>&nbsp;&nbsp;&nbsp;EOEnterpriseObject movie, studio;<p>&nbsp;&nbsp;&nbsp;talentMovies = talent.moviesStarredIn();<BR>&nbsp;&nbsp;&nbsp;count = talentMovies.count();<BR>&nbsp;&nbsp;&nbsp;for (i = 0; i &lt; count; i++) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movie =<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(EOEnterpriseObject)(talentMovies.objectAtIndex(i));<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!(movies().containsObject(movie))) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;studio =<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(EOEnterpriseObject)(movie.valueForKey(&quot;studio&quot;));<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (studio != null)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;studio.<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;removeObjectFromBothSidesOfRelationshipWithKey<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(movie,&quot;movies&quot;);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addObjectToBothSidesOfRelationshipWithKey<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(movie,&quot;movies&quot;);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;}<BR>}</TT><P><A NAME="pgfId=1007218"> </A>This method invokes the <B>moviesStarredIn</B> method:</P><H4><A NAME="pgfId=1007219"> </A>Talent.java (server)</H4><TT><BR>public NSArray moviesStarredIn() {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int i, count;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSArray movies;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSMutableArray moviesStarredIn;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EOEnterpriseObject movie;<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;moviesStarredIn = new NSMutableArray();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movies = (NSArray)(roles().valueForKey(&quot;movie&quot;));<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count = movies.count();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i = 0; i &lt; count; i++) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movie = (EOEnterpriseObject)(movies.objectAtIndex(i));<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!(moviesStarredIn.containsObject(movie))) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;moviesStarredIn.addObject(movie);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return moviesStarredIn;<BR>}</TT><P><A NAME="pgfId=1007238"> </A>You can associate the <B>buyAllMoviesStarringTalent</B> method with a user interface control. But first you need to add to your user interface a table view that lists all actors (talent).</P><OL><LI><A NAME="pgfId=1007239"> </A>Add a new table view to your user interface.<P><A NAME="pgfId=1007240"> </A>Drag the Talent entity from your model into the nib file window in Interface Builder.<P><A NAME="pgfId=1007241"> </A>Drag a table view from the Palette onto your window.<P><A NAME="pgfId=1007242"> </A>Control-drag from each table view column to the Talent EODisplayGroup. <P><A NAME="pgfId=1007243"> </A>Using the <B CLASS="Bold-(Sidebar)">value</B> aspect of the EOColumnAssoc, connect the table view columns to the <B CLASS="Bold-(Sidebar)">firstName</B> and <B CLASS="Bold-(Sidebar)">lastName</B> class keys, respectively.</P><LI><A NAME="pgfId=1007244"> </A>Add a button to the window.<P><A NAME="pgfId=1007245"> </A>Drag a button into the window.<P><A NAME="pgfId=1007246"> </A>Place it below the Revenue field.<P><A NAME="pgfId=1007247"> </A>Resize it.<P><A NAME="pgfId=1007248"> </A>Give it the title &quot;Buy Movies Starring Selected Talent&quot;.</P><A NAME="pgfId=1007252"> </A></P><DIV><IMG SRC="images/TabView.gif"><P></DIV><A NAME="pgfId=1007253"> </A>Now that you've added the table view, connected it to the <B>firstName</B> and <B>lastName</B> properties of the Talent EODisplayGroup, and added a Buy button to the window, you're ready to use an EOActionAssociation to connect the button to the <B>buyAllMoviesStarringTalent</B> method. </P><LI><A NAME="pgfId=1007254"> </A>Associate a method with a user interface control.<P><A NAME="pgfId=1007255"> </A>Display the Attributes view of the Inspector for the Studio EODisplayGroup.<P><A NAME="pgfId=1007256"> </A>In the text field type the name of the method (<B CLASS="Bold-(Sidebar)">buyAllMoviesStarringTalent</B>) you want to use in an association.<P><A NAME="pgfId=1007257"> </A>Click Add.</P><A NAME="pgfId=1007261"> </A></P><DIV><IMG SRC="images/buyAllMoviesProp.gif"><P></DIV><A NAME="pgfId=1007262"> </A>You can now use the <B CLASS="Bold-(Sidebar)">buyAllMoviesStarringTalent</B> method in associations.<P><A NAME="pgfId=1007263"> </A>Control-drag from the &quot;Buy Movies Starring Selected Talent&quot; button to the Studio EODisplayGroup.<P><A NAME="pgfId=1007264"> </A>In the Connections Inspector, choose EOActionAssociation from the pop-up list at the top of the left column.<P><A NAME="pgfId=1007265"> </A>Select <B CLASS="Bold-(Sidebar)">action</B> in the left column, and the method you want to connect to (<B CLASS="Bold-(Sidebar)">buyAllMoviesStarringTalent</B>) in the right column. <P><A NAME="pgfId=1007266"> </A>Click Connect.</P><A NAME="pgfId=1007270"> </A></P><DIV><IMG SRC="images/connectBuyAssoc.gif"><P></DIV><A NAME="pgfId=1007271"> </A>Because the <B>buyAllMoviesStarringTalent</B> method takes a Talent object as an argument, you also need to make a connection from the Buy button to the Talent EODisplayGroup.<P><A NAME="pgfId=1007272"> </A>Control-drag from the &quot;Buy Movies Starring Selected Talent&quot; button to the Talent EODisplayGroup.<P><A NAME="pgfId=1007273"> </A>In the Inspector, select <B CLASS="Bold-(Sidebar)">argument</B> in the left column. The <B CLASS="Bold-(Sidebar)">argument</B> aspect takes the destination of the connection (Talent) as an argument, which will be supplied to the <B CLASS="Bold-(Sidebar)">buyAllMoviesStarringTalent</B> method.<P><A NAME="pgfId=1007274"> </A>Click Connect.</P><A NAME="pgfId=1007278"> </A></P><DIV><IMG SRC="images/bindBuyArgument.gif"><P></DIV><A NAME="pgfId=1007279"> </A>Once you finish connecting the button, you can use it to purchase all of the movies starring the selected actor for the selected studio.</P></OL><HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 13 Sep 99)<P><A HREF="JavaClientTutorial.2e.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="JavaClientTutorial.32.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="JavaClientTutorial.34.html"><img src="images/next.gif" border="0" width="49" height="16"></A><nobr>&nbsp;</nobr></BODY></HTML>