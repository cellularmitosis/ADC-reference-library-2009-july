<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>UpdateTranslationProgress (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING441></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-440.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-442.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-402.html"><B>Chapter 7 - Translation Manager</B></A> / <A HREF="MoreToolbox-432.html"><B>Translation Extension Reference</B></A><BR><DL><DD><A HREF="MoreToolbox-438.html"><B>Translation Extension Routines</B></A> / <A HREF="MoreToolbox-439.html"><B>Managing Translation Progress Dialog Boxes</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING441-0></A>
<H3>UpdateTranslationProgress<A NAME=MARKER-2-268></A></H3>
 A translation extension can call <CODE>UpdateTranslationProgress</CODE> to update the progress dialog box that is displayed during file and scrap translation and to give the user a chance to click the Cancel button.<P>
<PRE>
FUNCTION UpdateTranslationProgress (refNum: TranslationRefNum; 
                                    percentDone: Integer; 
                                    VAR canceled: Boolean) 
                                    : OSErr;
</PRE>
<DL>
<DT><CODE>refNum</CODE>
<DD> A translation reference number.
<DT><CODE>percentDone</CODE>
<DD> An integer in the range 0-100 that indicates the percentage of the translation that has been completed.
<DT><CODE>canceled</CODE>
<DD> On exit, <CODE>UpdateTranslationProgress</CODE> returns <CODE>TRUE</CODE> in this parameter if the user clicked the Cancel button in the progress dialog box; otherwise, <CODE>UpdateTranslationProgress</CODE> returns <CODE>FALSE</CODE> in this parameter.
</DL>
<A NAME=HEADING441-6></A>
<H5>DESCRIPTION</H5>
 The <CODE>UpdateTranslationProgress</CODE> function updates the translation progress dialog box. You should call this function periodically during a translation to update the progress bar and to give the user an opportunity to cancel the translation. If the user clicks the Cancel button in the dialog box (or types Command-period while the box is displayed), the <CODE>canceled</CODE> parameter is set to <CODE>TRUE</CODE>; otherwise, it is set to <CODE>FALSE</CODE>. When <CODE>canceled</CODE> returns <CODE>TRUE</CODE>, you should stop the translation, and your application-defined routine <CODE>DoTranslateFile</CODE> or <CODE>DoTranslateScrap</CODE> should return the result code <CODE>userCancelledErr</CODE>.<P>
 The <CODE>percentDone</CODE> parameter specifies the approximate percentage of time elapsed until completion. You should call <CODE>UpdateTranslationProgress</CODE> periodically at reasonable time intervals to allow the user to cancel the translation. When the translation is complete, you should call <CODE>UpdateTranslationProgress</CODE> with <CODE>percentDone</CODE> set to 100 so that the user can see that the translation is complete.<P>
 You should set the <CODE>refNum</CODE> parameter to the translation reference number passed to your <CODE>DoTranslateFile</CODE> or <CODE>DoTranslateScrap</CODE> routine. The Translation Manager uses that number internally.<P>
<A NAME=HEADING441-10></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 Your translation extension should call <CODE>UpdateTranslationProgress</CODE> only in response to the <CODE>kTranslateTranslateFile</CODE> or <CODE>kTranslateTranslateScrap</CODE> request code (that is, in your <CODE>DoTranslateFile</CODE> or <CODE>DoTranslateScrap</CODE> routine). Do not call this function in response to any other request code or from any code that isn't a translation extension.<P>
 You should already have called <CODE>SetTranslationAdvertisement</CODE> before calling <CODE>UpdateTranslationProgress</CODE>.<P>
 The <CODE>UpdateTranslationProgress</CODE> function might cause memory to be moved or purged; you should not call it at interrupt time.<P>
<A NAME=HEADING441-14></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The trap macro and routine selector for the <CODE>UpdateTranslationProgress</CODE> function are
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Trap macro<TH>Selector<TR>
<TD>_TranslationDispatch<TD>$0001</TABLE>
<P>
<A NAME=HEADING441-16></A>
<H5><A NAME=MARKER-2-269></A><A NAME=MARKER-2-270></A><A NAME=MARKER-2-271></A>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>paramErr<TD>-50<TD>Parameter error<TR>
<TD>memFullErr<TD>-108<TD>Not enough memory</TABLE>
</H5>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-440.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-442.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
