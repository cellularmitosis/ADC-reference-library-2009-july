<HTML>		<HEAD>		<meta http-equiv="content-type" content="text/html;charset=iso-8859-1">		<meta name="Copyright" content="Copyright 2001 Apple Computer, Inc. All Rights Reserved.">        <title>Modifying the Authors Project</title>		</HEAD>	<BODY bgcolor="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- start of path --><table cellspacing=0 border=0 width=600 valign="left"><tr><td scope="row"><font face="Geneva,Helvetica,Arial" size="1"><b>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="../../../index.html" target="_top">Documentation</a> <b>&gt;</b> <a href="../../webobjects.html" target="_top">WebObjects</a></font></td></tr></table><br><!-- end of path --><a href="Generating_a_Custom_Class.html" target="_right"><img src="../Images/previous.gif" border="0" alt="Previous"></a><a href="Adding_Custom_Logic.html" target="_right"><img src="../Images/next.gif" border="0" alt="Next"></a>&nbsp;<br><!-- apple_doc: pageHeadingStart --><a name = "TPXREF105"></a><h2><font face="Lucida Grande,Helvetica,Arial">Modifying the Authors Project</font></h2><!-- apple_doc: pageHeadingEnd --><p>Your code is written to work with EOGenericRecords. To takeadvantage of the Author class, you need to alter the definitionsof variables and methods that interact with Author objects in yourprogram, making them Author objects rather than EOGenericRecords.</p><p>Make the following changes to the <code>Main.java</code> class:</p><ol><li>Change the <code>@TypeInfo</code> lineabove the <code>authorList</code>'sdefinition so that it reads<pre>/** @TypeInfo Author */</pre></font></li><li>Change the class of the <code>authorItem</code> and <code>author</code> instancevariables from EOGenericRecord to Author.</font></li><li>Delete the <code>authorClassDescription</code> instance-variabledefinition and its assignment in the constructor.<p>You onlyneeded the class description to create new instances of EOGenericRecord withthe correct type information. Now that you'll be using the Authorclass, the class description is no longer needed.</p></font></li><li>Change the constructor, <code>addAuthor</code>,and <code>updateAuthor</code> methods to create a newAuthor object instead of a new EOGenericRecord object.<pre>author = new Author();</pre></font></li><li>Save <code>Main.java</code>.</font></li></ol><p>After making those changes, Main.java shouldlook similar to  <a href="#BAJBBJBE">Listing 11-2</a>.</p><a name = "BAJBBJBE"></a><p><b><font face="Geneva,Helvetica,Arial" size="2">Listing11-2 Main.java modified to use Author classinstead of EOGenericRecord</font></b></p><pre>Main.java modified to use custom Author class instead of EOGenericRecordimport com.webobjects.foundation.*;import com.webobjects.appserver.*;import com.webobjects.eocontrol.*;import com.webobjects.eoaccess.*;public class Main extends WOComponent {    protected Author author;    protected Author authorItem;    private EOEditingContext editingContext;    private EOFetchSpecification fetchSpec;    /** @TypeInfo Author */    protected NSMutableArray authorList;        public Main(WOContext context) {        super(context);        // build fetch specification        fetchSpec = new EOFetchSpecification("Author", null, null);                // get editing context        editingContext = session().defaultEditingContext();                // fetch        authorList = new  NSMutableArray(editingContext.objectsWithFetchSpecification(fetchSpec));        // create a new Author object (where form data is stored)        author = new Author();    }    public WOComponent addAuthor() {        // add only if the author is not already in the list        if (! authorList.containsObject(author)) {            // add author to list            authorList.addObject(author);                    // insert author into editing context            editingContext.insertObject(author);                    // create a new author            author = new Author();        }        return null;    }    public WOComponent deleteAuthor() {        // remove author from authorList        authorList.removeObject(authorItem);         // get object's editing context        EOEditingContext ec = authorItem.editingContext();        // remove author from object graph        ec.deleteObject(authorItem);                return null;    }    public WOComponent editAuthor() {        // set the author to edit to the one the user selected        author = authorItem;        return null;    }    public WOComponent revertChanges() {        // revert changes made in editing context        editingContext.revert();        // refetch        authorList = new  NSMutableArray(editingContext.objectsWithFetchSpecification(fetchSpec));                return null;    }    public WOComponent saveChanges() {        // save changes made in editing context to object store        editingContext.saveChanges();                return null;    }    public WOComponent updateAuthor() {        // create a new author        author = new Author();                return null;    }}</pre><p>No further changes need to be made for the application torun just as before. Because Author is a subclass of EOGenericRecord,it still responds to the keypaths in the WOD file of the Main component.Build and run the application to confirm it.</p><br>    <br><a href="Generating_a_Custom_Class.html" target="_right"><img src="../Images/previous.gif" border="0" alt="Previous"></a><a href="Adding_Custom_Logic.html" target="_right"><img src="../Images/next.gif" border="0" alt="Next"></a>&nbsp;<hr alt=""><p><font face="Palatino" size="1">&#169; 2001 Apple Computer, Inc.</font></p><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></html>