<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE> Initializing and Terminating QuickDraw&nbsp;3D</TITLE></HEAD><BODY BGCOLOR="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- path goes here --><H1 CLASS="H2.Heading2"><A NAME="pgfId=3718"> </A>Initializing and Terminating QuickDraw&nbsp;3D</H1><P CLASS="T1.Text1"><A NAME="pgfId=3727"> </A><A NAME="marker=3719"> </A><A NAME="marker=3720"> </A>Before calling any QuickDraw&nbsp;3D routines, you need to verify that the QuickDraw&nbsp;3D software is available in the current operating environment. Then you need to create and initialize a connection to the QuickDraw&nbsp;3D software.</P><P CLASS="T1.Text1"><A NAME="pgfId=3734"> </A>On the Mac&nbsp;OS, you can verify that QuickDraw&nbsp;3D is available by calling the <TT CLASS="cv">MyEnvironmentHasQuickDraw3D</TT> function defined in <A HREF="qd3dintroduction.a.htm#37755" CLASS="XRef">Listing&nbsp;1</A>.</P><P CLASS="L.Listing"><A NAME="pgfId=3742"> </A>Listing&nbsp;1<A NAME="37755"> </A>Determining whether QuickDraw&nbsp;3D is available</P><CODE CLASS="Cv.Code"><A NAME="pgfId=10979"> </A>Boolean MyEnvironmentHasQuickDraw3D (void)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;return (long) Q3Initialize != kUnresolvedSymbolAddress;<BR>}<BR></CODE><P CLASS="T1.Text1"><A NAME="pgfId=5589"> </A><A NAME="marker=10981"> </A>The <TT CLASS="cv">MyEnvironmentHasQuickDraw3D</TT> function checks to see whether the address of the <TT CLASS="cv">Q3Initialize</TT> function has been resolved. If it hasn't been resolved (that is, if the Code Fragment Manager couldn't find the QuickDraw&nbsp;3D shared library when launching your application), <TT CLASS="cv">MyEnvironmentHasQuickDraw3D</TT> returns the value <TT CLASS="cv">FALSE</TT> to its caller. Otherwise, if the address of the <TT CLASS="cv">Q3Initialize</TT> function was successfully resolved, <TT CLASS="cv">MyEnvironmentHasQuickDraw3D</TT> returns <TT CLASS="cv">TRUE</TT>.</P><P CLASS="Note"><A NAME="pgfId=3749"> </A>For the function <TT CLASS="cv">MyEnvironmentHasQuickDraw3D</TT> to work properly, you must establish soft links (also called <I CLASS="italics">weak links</I>) between your application and the QuickDraw&nbsp;3D shared library. For information on soft links, see the book <I CLASS="italics">Inside Macintosh: PowerPC System Software.</I> For specific information on establishing soft links, see the documentation for your software development system. </P><P CLASS="T1.Text1"><A NAME="pgfId=5609"> </A>On the Mac&nbsp;OS, you can verify that QuickDraw&nbsp;3D is available in the current operating environment by calling the <TT CLASS="cv">Gestalt</TT> function with the <TT CLASS="cv">gestaltQD3D</TT> selector. <TT CLASS="cv">Gestalt</TT> returns a long word whose value indicates the availability of QuickDraw&nbsp;3D. Currently these values are defined:</P><CODE CLASS="Cv.Code"><A NAME="pgfId=10985"> </A>enum {<BR>&nbsp;&nbsp;&nbsp;&nbsp;gestaltQD3DNotPresent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 0,<BR>&nbsp;&nbsp;&nbsp;&nbsp;gestaltQD3DAvailable&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 1<BR>}<BR></CODE><P CLASS="T1.Text1"><A NAME="pgfId=5614"> </A>You should ensure that the value <TT CLASS="cv">gestaltQD3DAvailable</TT> is returned before calling any QuickDraw&nbsp;3D routines.</P><P CLASS="Note"><A NAME="pgfId=5618"> </A>For more information on the <TT CLASS="cv">Gestalt</TT> function, see <I CLASS="italics">Inside Macintosh: Operating System Utilities</I>. </P><P CLASS="T1.Text1"><A NAME="pgfId=3759"> </A>You create and initialize a connection to the QuickDraw&nbsp;3D software by calling the <TT CLASS="cv">Q3Initialize</TT> function, as illustrated in <A HREF="qd3dintroduction.a.htm#41828" CLASS="XRef">Listing&nbsp;2</A>.<A NAME="marker=3763"> </A></P><P CLASS="L.Listing"><A NAME="pgfId=3768"> </A>Listing&nbsp;2<A NAME="41828"> </A>Initializing a connection with QuickDraw&nbsp;3D</P><CODE CLASS="Cv.Code"><A NAME="pgfId=10989"> </A>OSErr MyInitialize (void)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;TQ3Status&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myStatus;<BR>&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myStatus = Q3Initialize();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*initialize QuickDraw&nbsp;3D*/<BR></CODE><CODE CLASS="Cv.Code"><A NAME="pgfId=10993"> </A>&nbsp;&nbsp;&nbsp;&nbsp;if (myStatus == kQ3Failure)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DebugStr(&quot;\pQ3Initialize returned failure.&quot;);<BR>&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;return (noErr);<BR>}<BR></CODE><P CLASS="T1.Text1"><A NAME="pgfId=3774"> </A><A NAME="marker=10995"> </A>Once you've successfully called <TT CLASS="cv">Q3Initialize</TT>, you can safely call other QuickDraw&nbsp;3D routines. If <TT CLASS="cv">Q3Initialize</TT> returns unsuccessfully (as indicated by the <TT CLASS="cv">kQ3Failure</TT> result code), you shouldn't call any QuickDraw&nbsp;3D routines other than the error-reporting routines (such as <TT CLASS="cv">Q3Error_Get</TT> or <TT CLASS="cv">Q3Error_IsFatalError</TT>) or the <TT CLASS="cv">Q3IsInitialized</TT> function. See the chapter <A HREF="qd3derrormgr.htm" CLASS="XRef">&quot;Error Manager&quot;</A> for details on QuickDraw&nbsp;3D's error-handling capabilities.</P><P CLASS="T1.Text1"><A NAME="pgfId=3790"> </A>When you have finished using QuickDraw&nbsp;3D, you should call <TT CLASS="cv">Q3Exit</TT> to close your connection with QuickDraw&nbsp;3D. In most cases, you'll do this when terminating your application. <A HREF="qd3dintroduction.a.htm#24333" CLASS="XRef">Listing&nbsp;3</A> illustrates how to call <TT CLASS="cv">Q3Exit</TT>.<A NAME="marker=3797"> </A></P><P CLASS="L.Listing"><A NAME="pgfId=3802"> </A>Listing&nbsp;3<A NAME="24333"> </A>Terminating QuickDraw&nbsp;3D</P><CODE CLASS="Cv.Code"><A NAME="pgfId=10999"> </A>void MyFinishUp (void)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;TQ3Status&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myStatus;<BR>&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myStatus = Q3Exit();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*unload QuickDraw&nbsp;3D*/<BR>&nbsp;&nbsp;&nbsp;&nbsp;if (myStatus == kQ3Failure)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DebugStr(&quot;\pQ3Exit returned failure.&quot;);<BR>}<BR></CODE><hr>&#169; 1997 Apple Computer, Inc.</DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY></HTML>