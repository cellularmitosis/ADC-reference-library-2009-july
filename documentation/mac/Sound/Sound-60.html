<!-- legacy work start -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<!-- legacy work end -->


<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)

LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Sound Resources (IM: S)  (deprecated)</Title>

<!-- legacy work start -->
        <META NAME="Generator" CONTENT="manual">
        <META http-equiv="content-type" CONTENT="text/html;charset=utf-8">
        <META NAME = "Copyright" CONTENT="Copyright 2007 Apple Inc. All Rights Reserved.">
        <META NAME="IndexTitle" CONTENT="Inside Macintosh: Sound (Not Recommended)">
        <meta name="xcode-display" content="render">

        <LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css"> <!-- before submitting, globally replace ".." with "developer.apple.com" -->
        <script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
<!-- legacy work end -->

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<A NAME=HEADING60></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Sound-59.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Sound-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Sound-336.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Sound-61.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Sound-2.html"><B>Sound</B></A> / <BR><DD><A HREF="Sound-44.html"><B>Chapter 2 - Sound Manager</B></A> / <A HREF="Sound-59.html"><B>Sound Storage Formats</B></A></DL></FONT><P>
<HR>

<!-- legacy work start -->
<script type="text/javascript"> placeWatermark()</script>
<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
<i>Inside Macintosh: Sound</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="http://developer.apple.com/referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div>
<!-- legacy work end -->


<BLOCKQUOTE>
<A NAME=HEADING60-0></A>
<H2><A NAME=MARKER-9-400></A>Sound Resources<A NAME=MARKER-2-25></A><A NAME=MARKER-2-33></A></H2>
 A <B>sound resource</B> is a resource of type <CODE>'snd '</CODE> that contains sound commands and possibly also sound data. Sound resources are widely used by Macintosh applications that produce sounds. These resources provide a simple and portable way for you to incorporate sounds into your application. For example, the sounds that a user can select in the Sound control panel as the system alert sound are stored in the System file as <CODE>'snd '</CODE> resources.<P>
 There are two types of <CODE>'snd '</CODE> resources, known as format 1 and format 2. <A HREF=#MARKER-9-404>Figure 2-4</A> illustrates the structures of both kinds of <CODE>'snd '</CODE> resources.<A NAME=MARKER-2-22></A><P>
<B>Figure 2-4  <A NAME=MARKER-9-404></A>The structure of<CODE> 'snd '</CODE> resources</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/SM-L-03.jpg"><P>
<DL>
<DT><B>IMPORTANT</B>
<DD>The format 2 <CODE>'snd '</CODE> resource is obsolete. Your application should create only format 1 <CODE>'snd '</CODE> resources. The format 2 <CODE>'snd '</CODE> resource was designed for use by HyperCard and can be used with sampled-sound data only.<EM></EM><A NAME=MARKER-2-18></A><A NAME=MARKER-2-314></A>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 Resource IDs for <CODE>'snd '</CODE> resources in the range 0 to 8191 are reserved for use by Apple Computer, Inc. The <CODE>'snd '</CODE> resources numbered 1 through 4 are defined to be the standard system alert sounds, although more recent versions of system software have included more standard system alert sounds.<A NAME=MARKER-2-248></A><P>
 <A NAME=MARKER-2-16></A>When a sound command contained in an <CODE>'snd '</CODE> resource has associated sound data, the high bit of the command is set. This changes the meaning of the <CODE>param2</CODE> field of the command from a pointer to a location in RAM to an offset value that specifies the offset in bytes from the resource's beginning to the location of the associated sound data (such as a sampled sound header). <A HREF=#MARKER-9-409>Figure 2-5</A> illustrates the location of this data offset bit.<P>
<B>Figure 2-5  <A NAME=MARKER-9-409></A>The location of the data offset bit</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/SM-L-04.jpg"><P>
 The offset bit is used only by sound commands that are stored in sound resources of type <CODE>'snd '</CODE> and that have associated sound data (that is, sampled-sound or wave-table data).<P>
 You can use a constant to access that flag.<P>
<PRE>
CONST
   dataOffsetFlag    = $8000;  {sound command data offset bit}
</PRE>
 If the <CODE>dataOffsetFlag</CODE> bit is not set, <CODE>param2</CODE> is interpreted instead as a pointer to the location in memory (outside the sound resource) where the data is located.<A NAME=MARKER-2-3></A><A NAME=MARKER-2-88></A><A NAME=MARKER-2-49></A><P>
 The first few bytes of the resource contain <CODE>'snd '</CODE> header information and are a different size for each format. An audio data type specified in a format 1 <CODE>'snd '</CODE> requires 6 bytes. The number of data types multiplied by 6 is added to this offset. The number of commands multiplied by 8 bytes, the size of a sound command, is added to the offset.<P>
<A NAME=HEADING60-15></A>
<H3><A NAME=MARKER-9-413></A>The Format 1 Sound Resource<A NAME=MARKER-9-51></A></H3>
 <A HREF=#MARKER-9-404>Figure 2-4</A> shows the fields of a format 1 <CODE>'snd '</CODE> resource. A format 1 <CODE>'snd '</CODE> resource header contains information about the format of the resource (namely, 1), the data type, and the initialization options for that data type. A format 1 <CODE>'snd '</CODE> resource contains sound commands and might also contain the actual sound data for wave-table sounds or sampled sounds. Note that if a sound resource includes sampled-sound data, then part of the sound data section is devoted to a sound header that describes the sampled-sound data in the remainder of the sound data section.<P>
 If an <CODE>'snd '</CODE> resource specifies a data type, it can supply an initialization option in the field immediately following the type. You specify the number of commands in the resource in the number of sound commands field. The sound commands follow, in the order in which they should be sent to the sound channel.<P>
 The format 1 <CODE>'snd '</CODE> resource might contain only a sequence of commands describing a sound. In this case, the number of data types should be 0, and there should be no data type specification or initialization option in the <CODE>'snd '</CODE> resource. This allows the <CODE>'snd '</CODE> resource to be used with any kind of sound data.<P>
 <A HREF=#MARKER-9-416>Listing 2-36</A> shows the output of the MPW tool DeRez when applied to the <CODE>'snd '</CODE> resource with resource ID 1 contained in the System file.<A NAME=MARKER-2-318></A><P>
<B>Listing 2-36  <A NAME=MARKER-9-416></A>A format 1<CODE> 'snd '</CODE> resource</B><P>
<PRE>
data 'snd ' (1, &quot;Simple Beep&quot;, purgeable) {
   /*the sound resource header*/
   $&quot;0001&quot;     /*format type*/
   $&quot;0001&quot;     /*number of data types*/
   $&quot;0001&quot;     /*square-wave data*/
   $&quot;00000000&quot; /*initialization option*/
   /*the sound commands*/
   $&quot;001B&quot;     /*number of sound commands (27)*/
   $&quot;002C&quot;     /*command 1--timbreCmd 090 000*/
   $&quot;005A00000000&quot;
   $&quot;002B&quot;     /*command 2--ampCmd  224 000*/
   $&quot;00E000000000&quot;
   $&quot;002A&quot;     /*command 3--freqCmd 000 069*/
   $&quot;000000000045&quot;
   $&quot;000A&quot;     /*command 4--waitCmd 040 000*/
   $&quot;002800000000&quot;
   $&quot;002B&quot;     /*command 5--ampCmd  200 000*/
   $&quot;00C800000000&quot;
   /*commands 6 through 26 are omitted; they are */
   /* alternating pairs of waitCmd and ampCmd commands */
   /* where the first parameter of ampCmd has the */
   /* values 192, 184, 176, 168, 160, 144, 128, 96, */
   /* 64, and 32*/
   $&quot;002B&quot;     /*command 27--ampCmd  000 000*/
   $&quot;000000000000&quot;
};
</PRE>
 As you can see, the Simple Beep is actually a rather sophisticated sound, in which the loudness (or amplitude) of the beep gradually decreases from an initial value of 224 to 0.<P>
 Notice that the sound shown in <A HREF=#MARKER-9-416>Listing 2-36</A> is defined using square-wave data and is completely determined by a sequence of specific commands. ("Play an A at loudness 224, wait 20 milliseconds, play it at loudness 200....") Often, an <CODE>'snd '</CODE> resource consists only of a single sound command (usually the <CODE>bufferCmd</CODE> command) together with data that describes a sampled sound to be played. <A HREF=#MARKER-9-418>Listing 2-37</A> shows an example like this.<A NAME=MARKER-2-7></A><P>
<B>Listing 2-37  <A NAME=MARKER-9-418></A> A format 1<CODE> 'snd '</CODE> resource containing sampled-sound data</B><P>
<PRE>
data 'snd ' (19068, &quot;hello daddy&quot;, purgeable) {
   /*the sound resource header*/
   $&quot;0001&quot;        /*format type*/
   $&quot;0001&quot;        /*number of data types*/
   $&quot;0005&quot;        /*sampled-sound data*/
   $&quot;00000080&quot;    /*initialization option: initMono*/
   /*the sound commands*/
   $&quot;0001&quot;        /*number of sound commands that follow (1)*/
   $&quot;8051&quot;        /*command 1--bufferCmd*/
   $&quot;0000&quot;        /*param1 = 0*/
   $&quot;00000014&quot;    /*param2 = offset to sound header (20 bytes)*/
   /*the sampled sound header*/
   $&quot;00000000&quot;    /*pointer to data (it follows immediately)*/
   $&quot;00000BB8&quot;    /*number of bytes in sample (3000 bytes)*/
   $&quot;56EE8BA3&quot;    /*sampling rate of this sound (22 kHz)*/
   $&quot;000007D0&quot;    /*starting of the sample's loop point*/
   $&quot;00000898&quot;    /*ending of the sample's loop point*/
   $&quot;00&quot;          /*standard sample encoding*/
   $&quot;3C&quot;          /*baseFrequency at which sample was taken*/
                  /*the sampled-sound data*/
   $&quot;80 80 81 81 81 81 81 81 80 80 80 80 80 81 82 82&quot;
   $&quot;82 83 82 82 81 80 80 7F 7F 7F 7E 7D 7D 7D 7C 7C&quot;
   $&quot;7C 7C 7D 7D 7D 7D 7E 7F 80 80 81 81 82 82 83 83&quot;
   $&quot;83 83 82 81 81 80 80 81 81 81 81 81 82 81 81 80&quot;
   $&quot;80 80 81 81 81 83 83 83 82 81 81 80 7F 7E 7D 7D&quot;
   $&quot;7F 7F 7F 7F 7E 7F 7F 7F 7F 7F 7F 7F 7F 7F 7F 80&quot;
   /*rest of data omitted in this example*/
};
</PRE>
 This <CODE>'snd '</CODE> resource indicates that the sound is defined using sampled-sound data. The resource includes a call to a single sound command, the <CODE>bufferCmd</CODE> command. The offset bit of the command number is set to indicate that the sound data is contained in the resource itself. Following the command and its two parameters is the sampled sound header, the first part of which contains important information about the sample. The second parameter to the <CODE>bufferCmd</CODE> command indicates the offset from the beginning of the resource to the sampled sound header, in this case 20 bytes. After the sound commands, this resource includes a sampled sound header, which includes the sampled-sound data. The format of a sampled sound header is described in <A HREF=Sound-74.html#MARKER-9-657>"Sound Header Records" on page 2-104</A>.<P>
 For compressed sound data, the sampled sound header is replaced by a compressed sampled sound header. <A HREF=#MARKER-9-419>Listing 2-38</A> illustrates the structure of an <CODE>'snd '</CODE> resource that contains compressed sound data.<P>
<B>Listing 2-38  <A NAME=MARKER-9-419></A>An<CODE> 'snd '</CODE> resource containing compressed sound data</B><P>
<PRE>
data 'snd ' (9004, &quot;Raisa's Cry&quot;, purgeable) {
   /*the sound resource header*/
   $&quot;0001&quot;     /*format type*/
   $&quot;0001&quot;     /*number of data types*/
   $&quot;0005&quot;     /*first data type*/
   $&quot;00000380&quot; /*initialization option: initMACE3 + initMono*/
   /*the sound command*/
   $&quot;0001&quot;     /*number of sound commands that follow (1)*/
   $&quot;8051&quot;     /*cmd: bufferCmd*/
   $&quot;0000&quot;     /*param1: unused*/
   $&quot;00000014&quot; /*param2: offset to sound header (20 bytes)*/
   /*the compressed sampled sound header*/
   $&quot;00000000&quot; /*pointer to data (it follows immediately)*/
   $&quot;00000001&quot; /*number of channels in sample*/
   $&quot;56EE8BA3&quot; /*sampling rate of this sound (22 kHz)*/
   $&quot;00000000&quot; /*starting of the sample's loop point; not used*/
   $&quot;00000000&quot; /*ending of the sample's loop point; not used*/
   $&quot;FE&quot;       /*compressed sample encoding*/
   $&quot;00&quot;       /*baseFrequency; not used*/
   $&quot;00006590&quot; /*number of frames in sample (26,000)*/
   $&quot;400DADDD1745D145826B&quot; 
               /*AIFFSampleRate (22 kHz in extended type)*/
   $&quot;00000000&quot; /*markerChunk; NIL for 'snd ' resource*/
   $&quot;4D414333&quot; /*format; MACE 3:1 compression*/
   $&quot;00000000&quot; /*futureUse2; NIL for 'snd ' resource*/
   $&quot;00000000&quot; /*stateVars; NIL for 'snd ' resource*/
   $&quot;00000000&quot; /*leftOverBlockPtr; not used here*/
   $&quot;FFFF&quot;     /*compressionID, -1 means use format field*/
   $&quot;0010&quot;     /*packetSize, packetSize for 3:1 is 16 bits*/
   $&quot;0000&quot;     /*snthID is 0*/
   $&quot;0008&quot;     /*sampleSize, sound was 8-bit before processing*/
   $&quot;2F 85 81 32 64 87 33 86&quot;    /*the compressed sound data*/
   $&quot;6F 48 6D 65 72 6B 82 88&quot;
   $&quot;91 FE 8D 8E 86 4E 7C E9&quot;
   $&quot;6F 6D 71 70 7E 79 4F 83&quot;
   $&quot;59 8F 8F 65&quot; /*rest of data omitted in this example*/
};
</PRE>
 This resource has the same general structure as the <CODE>'snd '</CODE> resource illustrated in <A HREF=#MARKER-9-416>Listing 2-36</A>. The principal difference is that the standard sound header is replaced by the compressed sound header. This example resource specifies a monophonic sound compressed by using the 3:1 compression algorithm. A multichannel compressed sound's data would be interleaved on a packet basis. See <A HREF=Sound-76.html#MARKER-9-702>"Compressed Sound Header Records" beginning on page 2-108</A> for a complete explanation of the compressed sound header.<P>
 As you've seen, it is not always necessary to specify <CODE>'snd '</CODE> resources by listing the raw data stream contained in them; indeed, for certain types of format 1 <CODE>'snd '</CODE> resources, it can be easier to supply a resource specification like the one given in <A HREF=#MARKER-9-420>Listing 2-39</A>.<P>
<B>Listing 2-39  <A NAME=MARKER-9-420></A>A resource specification</B><P>
<PRE>
resource 'snd ' (9000, &quot;Nathan's Beep&quot;, purgeable) {
   FormatOne {
      {  /*array of data types: 1 element*/
      /*[1]*/
      squareWaveSynth, 0
      }
   },
   {     /*array SoundCmnds: 3 elements*/
   /*[1]*/ noData, timbreCmd {90},
   /*[2]*/ noData, freqDurationCmd {480, $00000045},
   /*[3]*/ noData, quietCmd {},
      },
   {     /*array DataTables: 0 elements*/
   };
};
</PRE>
 When you pass a handle to this resource to the <CODE>SndPlay</CODE> function, three commands are executed by the Sound Manager: a <CODE>timbreCmd</CODE> command, a <CODE>freqDurationCmd</CODE> command, and a <CODE>quietCmd</CODE> command. The sound specified in <A HREF=#MARKER-9-420>Listing 2-39</A> is just like the Simple Beep, except that there is no gradual reduction in the loudness. <A HREF=#MARKER-9-421>Listing 2-40</A> shows a resource specification for the Simple Beep.<P>
<B>Listing 2-40  <A NAME=MARKER-9-421></A>A resource specification for the Simple Beep</B><P>
<PRE>
resource 'snd ' (9001, &quot;Copy of Simple Beep&quot;, purgeable) {
   FormatOne {
      {  /*array of data types: 1 element*/
         /*[1]*/
         squareWaveSynth, 0
      }
   },
   {  /*array SoundCmnds: 27 elements*/
      /*[1]*/     nodata, timbreCmd {90},
      /*[2]*/     nodata, ampCmd {224},
      /*[3]*/     nodata, freqCmd {69},
      /*[4]*/     nodata, waitCmd {40},
      /*[5]*/     nodata, ampCmd {200},
      /*[6]*/     nodata, waitCmd {40},
      /*[7]*/     nodata, ampCmd {192},
      /*[8]*/     nodata, waitCmd {40},
      /*[9]*/     nodata, ampCmd {184},
      /*[10]*/    nodata, waitCmd {40},
      /*[11]*/    nodata, ampCmd {176},
      /*[12]*/    nodata, waitCmd {40},
      /*[13]*/    nodata, ampCmd {168},
      /*[14]*/    nodata, waitCmd {40},
      /*[15]*/    nodata, ampCmd {160},
      /*[16]*/    nodata, waitCmd {40},
      /*[17]*/    nodata, ampCmd {144},
      /*[18]*/    nodata, waitCmd {40},
      /*[19]*/    nodata, ampCmd {128},
      /*[20]*/    nodata, waitCmd {40},
      /*[21]*/    nodata, ampCmd {96},
      /*[22]*/    nodata, waitCmd {40},
      /*[23]*/    nodata, ampCmd {64},
      /*[24]*/    nodata, waitCmd {40},
      /*[25]*/    nodata, ampCmd {32},
      /*[26]*/    nodata, waitCmd {40},
      /*[27]*/    nodata, ampCmd {0},
   },
   {  /*array DataTables: 0 elements*/
   }
};
</PRE>
<A NAME=HEADING60-37></A>
<H3>The Format 2 Sound Resource <A NAME=MARKER-2-135></A></H3>
 The <CODE>SndPlay</CODE> function can also play format 2 <CODE>'snd '</CODE> resources, which are designed for use only with sampled sounds. The <CODE>SndPlay</CODE> function supports this format by automatically opening a sound channel and using the <CODE>bufferCmd</CODE> command to send the data contained in the resource to the channel.<P>
 <A HREF=#MARKER-9-404>Figure 2-4</A> illustrates the fields of a format 2 <CODE>'snd '</CODE> resource. The reference count field is for your application's use and is not used by the Sound Manager. The number of sound commands field and the sound command fields are the same as described in a format 1 resource. The last field of this resource contains the sampled sound. The first command should be either a <CODE>soundCmd</CODE> command or <CODE>bufferCmd</CODE> command with the data offset bit set in the command to specify the location of this sampled sound header.<P>
 <A HREF=#MARKER-9-423>Listing 2-41</A> shows a resource specification that illustrates the structure of a format 2 <CODE>'snd '</CODE> resource.<P>
<B>Listing 2-41  <A NAME=MARKER-9-423></A>A format 2 <CODE>'snd '</CODE> resource</B><P>
<PRE>
data 'snd ' (9003, &quot;Pig Squeal&quot;, purgeable) {
   /*the sound resource header*/
   $&quot;0002&quot;        /*format type*/
   $&quot;0000&quot;        /*reference count for application's use*/
   /*the sound command*/
   $&quot;0001&quot;        /*number of sound commands that follow (1)*/
   $&quot;8051&quot;        /*command 1--bufferCmd*/
   $&quot;0000&quot;        /*param1 = 0*/
   $&quot;0000000E&quot;    /*param2 = offset to sound header (14 bytes)*/
   /*the sampled sound header*/
   $&quot;00000000&quot;    /*pointer to data (it follows immediately)*/
   $&quot;00000BB8&quot;    /*number of bytes in sample (3000 bytes)*/
   $&quot;56EE8BA3&quot;    /*sampling rate of this sound (22 kHz)*/
   $&quot;000007D0&quot;    /*starting of the sample's loop point*/
   $&quot;00000898&quot;    /*ending of the sample's loop point*/
   $&quot;00&quot;          /*standard sample encoding*/
   $&quot;3C&quot;          /*baseFrequency at which sample was taken*/
   $&quot;80 80 81 82 84 87 93 84&quot;    /*the sampled-sound data*/
   $&quot;6F 68 6D 65 72 7B 82 88&quot;
   $&quot;91 8E 8D 8F 86 7E 7C 79&quot;
   $&quot;6F 6D 71 70 70 79 7F 81&quot;
   $&quot;89 8F 8D 8B&quot; /*rest of data omitted in this example*/
};
</PRE>
<DL>
<DT><B>Note</B>
<DD>Remember that format 2 <CODE>'snd '</CODE> resources are obsolete. You should create only format 1 <CODE>'snd '</CODE> resources.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Sound-59.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Sound-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Sound-336.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Sound-61.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Sound-3.html">&copy; Apple Computer, Inc.</A><br>2 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
