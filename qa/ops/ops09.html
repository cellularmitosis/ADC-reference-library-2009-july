<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Q&amp;A OPS09: Locking an Area Using PBLockRange</title><meta name="keywords" content="Mac OS 8 PBLockRange FSRead -45 error locking file"><meta name="Description" content="Technical Q&amp;A OPS09: Q&amp;A describes the function of PBLockRangefocusing on what locking an area using PBLockRange accomplishes."><meta name="categories" content="Operating System Utilities"><meta name="week-posted" content="May 13, 1996 - May 17, 1996"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF" TEXT="#000000"><a name="//apple_ref/doc/uid/DTS10001490" title="Locking an Area Using PBLockRange"></a> <!-- white background --><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalqas/index.html">Technical Q&As</a> &gt; <a href="../../technicalqas/Carbon/index.html">Carbon</a> &gt; <a href="../../technicalqas/Carbon/idxFileManagement-date.html">File Management</a> &gt; </p><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Q&amp;A OPS09</div>
<div id="pageheadsub">Locking an Area Using PBLockRange</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment -->			<!-- -->						<!-- Document Body --><CENTER><table cellspacing="0" cellpadding="0" border="0" WIDTH="600"><tr><td align="left" scope="row"><font size="+4">Q</font>  I'm locking a small area of a shared file, using PBLockRange, so others cannot write to it. When I try to <i>read</i> the locked area from anothermachine (by calling FSRead),  it returns a -45 (file locked) error. If I try toread over an unlocked area, it works fine. <p>I've never used PBLockRange before, but all of the documentation on it (thatI've found, anyway) says that the locking is for <i>writing</i> not reading,and the documentation on FSRead never suggests that it might return a "filelocked" error code.</p><font size="+4">A</font>  PBLockRange is behaving properly in this situation, and has always behavedthis way.  The idea is that by locking a section of a file you want to controlall access to the section.  While the section is locked and you are makingchanges to it, other users should not be able to read the portion of the filethat is changing.  The information might not be properly synched with thechanges made, so readers might be reading old information.  By denying readersaccess to the locked portion of the file, you guarantee the integrity of thedata to which readers have access.<p>As page 2-50 of <i>Inside Macintosh: Files</i> states:</p> <p>"When a user needs to modify a portion of a file that has been opened withshared read/write permission, it is usually desirable to make that portion ofthe file unavailable to other users while the changes are made.  You can callthe PBLockRange function to lock a range of bytes before modifying the file andthen PBUnlockRange to unlock that range after your changes are safely recordedin the file.</p> <p>"Locking a range of bytes in a file gives the user exclusive read/write accessto that range and makes it inaccessible to other users.  Other users canneither write nor read the bytes in that range until you unlock it.  If otherusers attempt to read data from a portion of a file that you have locked, theyreceive the fLckdErr result code."<br>For a thorough description of working with files in a shared environment, seeTechnical Note <a href = "../../technotes/fl/fl_37.html" target="_blank">FL 37- "Want Permission to do What."</a></p><!-- begin_date --><H4 ALIGN=center>Updated: 14-May-96</H4><!-- end_date --></td></tr></table></CENTER><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/qa/ops/ops09.html%3Fid%3DDTS10001490-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/qa/ops/ops09.html%3Fid%3DDTS10001490-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/qa/ops/ops09.html%3Fid%3DDTS10001490-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>