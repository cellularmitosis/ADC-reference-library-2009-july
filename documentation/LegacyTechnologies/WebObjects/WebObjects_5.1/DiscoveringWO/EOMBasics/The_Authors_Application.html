<HTML>		<HEAD>		<meta http-equiv="content-type" content="text/html;charset=iso-8859-1">		<meta name="Copyright" content="Copyright 2001 Apple Computer, Inc. All Rights Reserved.">        <title>The Authors Application</title>		</HEAD>	<BODY bgcolor="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- start of path --><table cellspacing=0 border=0 width=600 valign="left"><tr><td scope="row"><font face="Geneva,Helvetica,Arial" size="1"><b>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="../../../index.html">Documentation</a> <b>&gt;</b> <a href="../../webobjects.html" target="_top">WebObjects</a></font></td></tr></table><br><!-- end of path --><a href="Working_Wit_ng_Contexts.html" target="_right"><img src="../Images/previous.gif" border="0" alt="Previous"></a><a href="Further_Exploration.html" target="_right"><img src="../Images/next.gif" border="0" alt="Next"></a>&nbsp;<br><!-- apple_doc: pageHeadingStart --><a name = "TPXREF111"></a><h2><font face="Lucida Grande,Helvetica,Arial">The Authors Application</font></h2><!-- apple_doc: pageHeadingEnd --><p>In this section you'll create an application to edit theAUTHOR table of the Books database. The table stores the first andlast names of book authors. Your application provides facilitiesfor adding, editing, and deleting authors.</p><p>The AUTHORS table contains three columns: FIRST_NAME, LAST_NAME,and, AUTHOR_ID. The AUTHOR_ID column serves as the table's primarykey, and it's not shown in the application's user interface.You don't even need to worry about updating the value of thatcolumn; Enterprise Objects does it for you.</p><br><a name = "TPXREF112"></a><h3><font face="Lucida Grande,Helvetica,Arial">Creating the Authors Database</font></h3><p>The first step is to create the Authors database. You'lluser OpenBase Manager to create it.</p><ol><li>Launch OpenBaseManager.<p>The OpenBase Manager application is located in the <code>/Applications/OpenBase</code> directory.</p><br> <img src = "../Art/openbasemain.gif" alt = "[image: ../Art/openbasemain.gif]"></font></li><li>Create a new database.<ol><li>Choose Database &gt;New.</font></li><li>Enter <code>Authors</code> inthe Database Name text field.</font></li><li>Select the Start Database at Boot option.</font></li><li>Choose ASCII from the Internal Encoding pop-up menu.<br> <img src = "../Art/openbaseadddatabase.gif" alt = "[image: ../Art/openbaseadddatabase.gif]"></font></li><li>Click Set.</font></li></ol></font></li><li>Start the database.<ol><li>Select the localhost/Authorsdatabase in the list.</font></li><li>Click Start.</font></li></ol></font></li><li>Quit OpenBase Manager.</font></li></ol><p>You now have an empty database called Authors.</p><br><a name = "BAJEFFEH"></a><h3><font face="Lucida Grande,Helvetica,Arial">Creating the Authors Model</font></h3><p>EOModeler is the tool you use to model your data. In it youdefine the entities that serve as the interface between your codeand the database. In this section, you'll use EOModeler to adda table to the Authors database.</p><ol><li>Launch EOModeler.<p>TheEOModeler application is located in the <code>/Developer/Applications </code>directory.</p></font></li><li>Choose Model &gt; New.</font></li><li>Select the adaptor to use.<p>With the JDBC adaptor providedwith your WebObjects installation, you can communicate with anydatabase that includes a JDBC driver.</p><br> <img src = "../Art/eomadaptor.gif" alt = "[image: ../Art/eomadaptor.gif]"><p>Select JDBC from the list andclick Next.</p></font></li><li>Provide JDBC connection information.<p>Your model includesthe information necessary to connect to your database. The JDBC Connectiondialog is where you enter that information. For this exercise, youonly need to specify the URL used to connect to the database.</p><br> <img src = "../Art/eomauthorsjdbcconn.gif" alt = "[image: ../Art/eomauthorsjdbcconn.gif]"><p>Enter <code>jdbc:openbase://localhost/Authors</code> inthe URL text field and click OK.</p></font></li><li>Select what to include in your model.<p>This pane is whereyou tell EOModeler how to configure the model entities from an existingdatabase. Because you are creating a new database, none of theseoptions needs to be selected.</p><br> <img src = "../Art/eomwzrdwhat.gif" alt = "[image: ../Art/eomwzrdwhat.gif]"><p>Deselect all the options andclick Finish.</p></font></li></ol><br> <img src = "../Art/eomemptymodel.gif" alt = "[image: ../Art/eomemptymodel.gif]"><br><a name = "TPXREF113"></a><h4><font face="Lucida Grande,Helvetica,Arial">Adding the Author Entity tothe Model</font></h4><p>In this section you'll add an entity called Author to thenew model. This entity maps to the AUTHOR table that EOModeler generatesfrom the entity's properties. </p><ol><li>Add the entity.<p>ChooseProperty &gt; Add Entity.</p></font></li><li>Configure the entity. <p>Choose Tools &gt; Inspector.</p><p>TheEntity Inspector appears. It allows you to enter a variety of informationpertaining to the new entity.</p><ol><li>Name the entity Author.</font></li><li>Enter <code>AUTHOR</code> inthe Table Name text field.</font></li><li>Enter <code>Author</code> inthe Class text field.<br> <img src = "../Art/eomauthor.gif" alt = "[image: ../Art/eomauthor.gif]"></font></li></ol></font></li><li>Add and configure Author's attributes.<p>The Author entityhas two significant attributes: <code>firstName</code> and <code>lastName</code>.An additional attribute, <code>authorId</code>,serves as the entity's primary key.</p><ol><li>Make sure the Authorentity is selected in the entity list.</font></li><li>Choose Property &gt; Add Attribute.</font></li><li>Name the attribute <code>firstName</code>.</font></li><li>Enter <code>FIRST_NAME</code> asthe column name.</font></li><li>Enter <code>char</code> in theExternal Type text field.</font></li><li>Choose String as the internal data type.</font></li><li>Enter <code>30</code> in theExternal Width text field.<br> <img src = "../Art/eomauthorfirstname.gif" alt = "[image: ../Art/eomauthorfirstname.gif]"></font></li><li>Click  <img src = "../Art/eomadvancedattributeicon.gif" alt = "[image: ../Art/eomadvancedattributeicon.gif]"> to display the Advanced AttributeInspector.</font></li><li>Select the Allow Null Value option.<br> <img src = "../Art/eomauthorfirstname2.gif" alt = "[image: ../Art/eomauthorfirstname2.gif]"></font></li><li>Repeat steps a through i to add the <code>lastName</code> attribute.</font></li></ol><p>Now,you'll add the attribute that serves as the primary key.</p><ol><li>Add a new attributeand name it <code>authorId</code>.</font></li><li>Enter <code>AUTHOR_ID</code> asthe column name.</font></li><li>Enter <code>int</code> in theExternal Type text field.</font></li><li>Choose Integer as the internal data type.</font></li></ol><br> <img src = "../Art/eomauthorauthorid.gif" alt = "[image: ../Art/eomauthorauthorid.gif]"></font></li><li>Select a primary key for the Author entity.<ol><li>In the <code>authorId</code> rowof the Author Attributes list, click in the column with a key as itsheading so that a key appears in the row.</font></li><li>Click in the diamond column of the <code>authorId</code> rowso that the diamond disappears.<p>The <code>authorId</code> attributeis nothing more than a database artifact, required to make surethat rows in the AUTHOR table are unique; it has no meaning to youor the application's users. The diamond icon indicates that anattribute is a property that is made available to an application'scustom logic and, if necessary, the application's user. Because <code>authorId</code> providesno additional information about an author, it is not required forthe application's normal operation.</p></font></li></ol></font></li></ol><br><a name = "BAJGEBGH"></a><p><b><font face="Geneva,Helvetica,Arial" size="2">Figure10-1 Authors model with Authors entity</font></b></p> <img src = "../Art/eomauthorcomplt.gif" alt = "[image: ../Art/eomauthorcomplt.gif]"><p>Save the model and name it Authors.</p><br><a name = "TPXREF114"></a><h4><font face="Lucida Grande,Helvetica,Arial">The EOModeler Window</font></h4><p>The left pane of EOModeler's main window lists the entitiespresent in the model. If you click an entity, details about itsattributes are displayed in the right pane. </p><p>In  <a href="#BAJGEBGH">Figure 10-1</a>, you see the Author entity and the definitions ofeach of its attributes. The values of the columns indicate the propertiesof each attribute.</p><p>By default, the most commonly used columns are enabled inthis view. To enable other columns, use the Add Column menu in thebottom frame of the window. These are the available columns andtheir meanings:</p><dl><dt>PrimaryKey</dt><dd>The primary key icon in the first column indicates thatthe attribute is used to uniquely identify a row. In the Authorentity, only <code>authorId</code> isa primary key.</dd></dl><dl><dt>Class Property</dt><dd>The presence of a diamond in the second column indicatesthat the attribute is a class property. A class property is onefor which EOModeler generates Java access methods. Generally, anyattributes that are actually a property of the entity are made classproperties, and attributes that are used for database level functionality(such as the <code>authorId</code> attribute)are not.</dd></dl><dl><dt>Locking</dt><dd>Indicates whether an attribute should be used for lockingwhen an update is performed. That is, whether Enterprise Objectsuses this attribute to determine whether changes have been made.</dd></dl><dl><dt>Allows Null</dt><dd>Indicates whether the database column can have a <code>null</code> value.</dd></dl><dl><dt>Name</dt><dd>The name of the attribute, which determines the Javamethod names that EOModeler generates when it creates the classdefinition.</dd></dl><dl><dt>Value Class (Java)</dt><dd>The class used to represent this attribute.</dd></dl><dl><dt>External Type</dt><dd>The data type used by the database to represent thisattribute.</dd></dl><dl><dt>Width</dt><dd>The maximum width of an attribute, usually used forString attributes.</dd></dl><dl><dt>Column</dt><dd>The name of the database column that corresponds tothis attribute.</dd></dl><dl><dt>Definition</dt><dd>The definition for a derived column. A derived attributedoesn't actually exist in the database and hence an attributecan't have both a Definition and a Column. Setting one clearsthe other.</dd></dl><dl><dt>Precision</dt><dd>The number of significant digits to include. Used forsome numerical types.</dd></dl><dl><dt>Prototype</dt><dd>The prototype from which this attribute inherits itscharacteristics. You can use prototypes to set up default attributetypes.</dd></dl><dl><dt>Read Only</dt><dd>Controls whether the attribute can be modified or onlyread.</dd></dl><dl><dt>Scale</dt><dd>The number of characters to the right of the decimalpoint in a number attribute.</dd></dl><dl><dt>Value Type</dt><dd>This type is used in decoding values for enterpriseobjects represented by Objective-C classes rather than Java classesand is not used in this text.</dd></dl><dl><dt>Write Format</dt><dd>Used in tandem with Read Format to write data to thedatabase in a custom format.</dd></dl><p>The External Type attribute must be one of the types definedby the JDBC adaptor. These are the most common ones:</p><dl><dt><code>blob</code></dt><dd>A Binary Large Object. Used to store images and largedata files. Usually represented as an NSData object.</dd></dl><dl><dt><code>char</code></dt><dd>Used to store character information and representedwith a Java String. An attribute declared to be a char must haveits width set, as well.</dd></dl><dl><dt><code>date</code>, <code>datetime</code></dt><dd>Used to store date information and usually representedby an NSTimestamp object.</dd></dl><dl><dt><code>double</code></dt><dd>Used to store floating-point numbers and genericallyrepresented by a Java Number.</dd></dl><dl><dt><code>int</code></dt><dd>Used to store integer numbers and usually representedby a Java Number. Foreign and primary keys are usually best modeledas integers.</dd></dl><dl><dt><code>long</code></dt><dd>Used to store very large integers.</dd></dl><br><a name = "BAJHJHAH"></a><h4><font face="Lucida Grande,Helvetica,Arial">Creating the AUTHOR Table</font></h4><p>Now that you have created the Author entity, it is time tocreate the AUTHOR table behind it.</p><ol><li>Select theAuthor entity from the entity list.</font></li><li>Choose Property &gt; Generate SQL.</font></li><li>Make sure that only the Create Tables option is selected.<br> <img src = "../Art/eomauthortblcreate.gif" alt = "[image: ../Art/eomauthortblcreate.gif]"></font></li><li>Click Execute SQL.</font></li><li>Quit EOModeler.</font></li></ol><br><a name = "TPXREF115"></a><h3><font face="Lucida Grande,Helvetica,Arial">Creating the Application</font></h3><p>In this section you'll create the Authors application. Theapplication allows its users to add, edit, and remove authors fromthe Authors database.</p><p>This section introduces the use of enterprise object classes(custom Java classes derived from entities defined in a model toaccess database information) and the methods used to add objectsinto the data store (adding rows to the AUTHOR table in the Authors database).You'll use EOModeler to create the <code>Author.java</code> class.After adding it to your project, you'll be able to create Authorobjects in your code. You'll then add those objects to the datastore. </p><p>Follow these steps to create the Authors application:</p><ol><li>Create anew WebObjects application project and name it Authors.</font></li><li>Add the Authors model to the project.<ol><li>Select Resources fromthe Groups & Files list.</font></li><li>Choose Project &gt; Add Files.</font></li><li>Choose the <code>Authors.eomodeld</code> fileyou created in  <a href="#BAJEFFEH">"Creating the Authors Model"</a> and click Open.</font></li><li>Select the "Copy items into destination group's folder(if needed)" option.</font></li><li> Select the Application Server target and click Add.<br> <img src = "../Art/authorsaddmodel.gif" alt = "[image: ../Art/authorsaddmodel.gif]"></font></li></ol></font></li></ol><br><a name = "TPXREF116"></a><h3><font face="Lucida Grande,Helvetica,Arial">Customizing the Main component</font></h3><p>The entire application's functionality is provided by theMain component. It includes an <code>authorList</code> arraywhere the authors are maintained while the application runs. Whenthe users clicks Save, the changes made to <code>authorList</code> aresaved to the database. <code>Main.wo</code> includeselements to edit an author's information and actions to add, edit,update, and delete authors. A WORepetition shows all the contentsof <code>authorList</code>.</p><br><a name = "TPXREF117"></a><h4><font face="Lucida Grande,Helvetica,Arial">Customizing Main.wo</font></h4><p>After following these steps, <code>Main.wo</code> shouldlook like  <a href="#BAJEBCED">Figure 10-2</a>.</p><ol><li>Open <code>Main.wo</code> inWebObjects Builder.</font></li><li>Add three keys.<ol><li>Name the first key <code>author</code>,set its type as EOGenericRecord, and do not include accessor methods.</font></li><li>Name the second key <code>authorItem</code>,set its type as EOGenericRecord, and do not include accessor methods<code></code>.</font></li><li>Name the third key <code>authorList</code>,choose "Mutable array of" and EOGenericRecord for its type,and do not include accessor methods.</font></li></ol></font></li><li>Add six actions, all of them returning <code>null</code>,which tells WebObjects to return the current page, Main, insteadof a new one (the same instance of Main persists throughout the application'soperation):<ul><li><code>addAuthor</code></font></li><li><code>deleteAuthor</code></font></li><li><code>editAuthor</code></font></li><li><code>revertChanges</code></font></li><li><code>saveChanges</code></font></li><li><code>updateAuthor</code></font></li></ul></font></li><li>Add a WOForm element to edit author information.<ol><li>Choose Forms &gt;WOForm.</font></li><li>In the WOForm Binding Inspector, choose <code>true</code> forthe <code>multipleSubmit</code> attribute.</font></li><li>Inside the WOForm, enter the text "<code>LastName: </code>", follow it with a WOTextField, and pressShift-Enter.</font></li><li>Bind the Last Name WOTextField's <code>value</code> attributeto <code>author.lastName</code>.<br><table border = "0" BGCOLOR="#E6E6E6"><tr><td scope="row"><b>Note: </b>Since <code>author</code>, <code>authorItem</code>,and <code>authorList</code> are EOGenericRecords,WebObjects Builder does not know what their properties are. Youmust type the keypaths for them manually.</td></tr></table><br></font></li><li>Enter the text "<code>First Name: </code>",follow it with a WOTextField, and press Shift-Enter.</font></li><li>Bind the First Name WOTextField's <code>value</code> attributeto <code>author.firstName</code>.</font></li><li>Add two WOSubmitButtons to the WOForm.<p>Enter<code> "Update"</code> forthe first WOSubmitButton's <code>value</code> attribute(include the quotation marks), and bind its <code>action</code> attributeto the <code>updateAuthor</code> action.</p><p>Enter<code> "Add"</code> forthe second WOSubmitButton's <code>value</code> attribute,and bind its <code>action</code> attributeto the <code>addAuthor</code> action.</p></font></li></ol></font></li><li>Add a second WOForm below the first one for the Save and RevertWOSubmitButtons.<ol><li>Set the WOForm's <code>multipleSubmit</code> attributeto <code>true</code>.</font></li><li>Add a WOSubmitButton inside the WOForm, enter<code> "Revert"</code> forits value attribute, and bind its action attribute to <code>revertChanges</code>.</font></li><li>Add another WOSubmitButton to the right of the Revert WOSubmitButton,enter <code>"Save"</code> forits <code>value</code> attribute,and bind its <code>action</code> attributeto <code>saveChanges</code>.</font></li></ol></font></li><li>Add a WORepetition to display the list of authors.<ol><li>Add the WORepetitionbelow the second WOForm.</font></li><li>Add two WOHyperlinks, separated by a space character, insidethe WORepetition.<p>Enter <code>Edit</code> asthe first WOHyperlink's caption and bind its <code>action</code> attributeto <code>editAuthor</code>.</p><p>Enter <code>Delete</code> asthe second WOHyperlink's caption and bind its <code>action</code> attributeto <code>deleteAuthor</code>.</p></font></li><li>Add two WOStrings, separated by ", " to the right of theDelete WOHyperlink.<p>Bind the first WOString to <code>authorItem.lastName</code> andthe second to <code>authorItem.firstName</code>.</p><p>Putthe cursor on the right of the second WOString and press Shift-Enter.</p></font></li><li>Bind WORepetition's <code>list</code> attributeto <code>authorList</code>, and its <code>item</code> attributeto <code>authorItem</code>.</font></li></ol></font></li><li>Save <code>Main.wo</code>.</font></li></ol><br><a name = "BAJEBCED"></a><p><b><font face="Geneva,Helvetica,Arial" size="2">Figure10-2 Main.wo with elements to maintainauthor information</font></b></p> <img src = "../Art/authorsmainwo.gif" alt = "[image: ../Art/authorsmainwo.gif]"><br><a name = "TPXREF118"></a><h4><font face="Lucida Grande,Helvetica,Arial">Customizing Main.java</font></h4><p>Now you'll edit <code>Main.java</code> toadd the application's custom logic.</p><ol><li>Add the followinginstance variables:<pre>private EOEditingContext editingContext;private EOClassDescription authorClassDescription;private EOFetchSpecification fetchSpec;</pre><p>Severalmethods in the Main class require the use of the editing context,class description, and fetch specification. Having the class'sconstructor store these objects in instance variables reduces thelines of code required to implement those methods.</p></font></li><li>Edit the constructor to perform custom initialization.<p>Whenthe Main component is created, it needs to request and store theediting context and retrieve the authors stored in the database(the first time you run the application, there's nothing to retrieve).</p><p>Editthe constructor so that it looks like  <a href="#BAJEAEJF">Listing 10-1</a>.</p><a name = "BAJEAEJF"></a><p><b><font face="Geneva,Helvetica,Arial" size="2">Listing10-1  The constructor in Main.java</font></b></p><pre>public Main(WOContext context) {    super(context);            // build fetch specification    fetchSpec = new EOFetchSpecification("Author", null, null);            // get editing context    editingContext = session().defaultEditingContext();            // fetch    authorList = new  NSMutableArray(editingContext.objectsWithFetchSpecification(fetchSpec));    // get Author class description    authorClassDescription =  EOClassDescription.classDescriptionForEntityName("Author");    // create a new Author object (where form data is stored)    author = new EOGenericRecord(authorClassDescription);}</pre><p>Thereare three parts to retrieving data from a database with WebObjects:the fetch specification, the editing context, and the fetch.</p><ul><li><b>EOFetchSpecification</b> AnEOFetchSpecification is an object representation of a request forobjects from the object store (database). It describes the objectsthat you want to retrieve. You can create fetch specifications programmaticallyor define them in the EOModel file.<p>A fetch specification isdefined in three parts&#151;the entity to fetch, restrictions used tofilter the fetched objects, and the order of the result. The lasttwo are optional, but the first one must be provided when the fetchspecification is created.</p></font></li><li><b>Editing Context</b> Fetches are performedthrough an editing context, which is responsible for maintainingthe object graph for the fetched objects.</font></li><li><b>Fetch</b> After a fetch specification hasbeen defined, it can be used to fetch data from the object store.WebObjects translates the fetch specification into SQL statements thatyour database system can understand. The database returns a listof rows that WebObjects translates into enterprise objects (instancesof EOGenericRecord) before returning them in an NSArray.</font></li></ul></font></li><li>Edit the <code>addAuthor</code> methodto that it looks like  <a href="#BAJFEFGF">Listing 10-2</a>.<a name = "BAJFEFGF"></a><p><b><font face="Geneva,Helvetica,Arial" size="2">Listing10-2  The addAuthor method in Main.java</font></b></p><pre>public WOComponent addAuthor() {    // add only if the author is not already in the list    if (! authorList.containsObject(author)) {        // add author to list        authorList.addObject(author);                // insert author into editing context        editingContext.insertObject(author);                // create a new author        author = new EOGenericRecord(authorClassDescription);    }    return null;}</pre><p>Becauseof Enterprise Objects's Java integration, inserting a new rowin your database is almost as simple as adding an item to an array.Once your class is defined as a subclass of EOGenericRecord, allyou need to do is insert the object into an editing context; itis then maintained in the object graph like other objects fetchedfrom the database. When the <code>saveChanges</code> methodis called, a new row is created in the database for each objectadded to the editing context.</p><p>The <code>addAuthor</code> methodis invoked when the user clicks Add. If the user isn't editingan existing author, it inserts the Author object that the user edited(through the first form's text fields) into <code>authorList</code>,and inserts it in the object graph maintained by the editing contextas well. It then creates a new Author object, where another author'sdata can be stored. (Note that the new instance is added to theobject graph only if the user clicks Add again.)</p></font></li><li>Edit the <code>deleteAuthor</code> methodso that it looks like  <a href="#BAJHHEAJ">Listing 10-3</a>.<a name = "BAJHHEAJ"></a><p><b><font face="Geneva,Helvetica,Arial" size="2">Listing10-3  The deleteAuthor method in Main.java</font></b></p><pre>public WOComponent deleteAuthor() {    // remove author from authorList    authorList.removeObject(authorItem);     // get object's editing context    EOEditingContext ec = authorItem.editingContext();    // remove author from object graph    ec.deleteObject(authorItem);            return null;}</pre><p>Inmultiuser applications an object can be in a different editing contextthan the default one. When you need to delete an enterprise objectfrom a data store, you should ask the object itself for its editingcontext. Then you invoke that editing context's <code>deleteObject</code> method.</p></font></li><li>Edit the <code>editAuthor</code> methodso that it looks like  <a href="#BAJBABFC">Listing 10-4</a>.<a name = "BAJBABFC"></a><p><b><font face="Geneva,Helvetica,Arial" size="2">Listing10-4  The editAuthor method in Main.java</font></b></p><pre>public WOComponent editAuthor() {    // set the author to edit to the one the user selected    author = authorItem;    return null;}</pre><p>Whenthe user clicks Edit, <code>authorItem</code> containsthe author object to be edited. The next time the page is drawn,the text fields are populated with the information for the selectedauthor.</p></font></li><li>Edit the <code>updateAuthor</code> methodso that it looks like  <a href="#BAJEAFDI">Listing 10-5</a>.<a name = "BAJEAFDI"></a><p><b><font face="Geneva,Helvetica,Arial" size="2">Listing10-5  The updateAuthor method in Main.java</font></b></p><pre>public WOComponent updateAuthor() {    // create a new author    author = new EOGenericRecord(authorClassDescription);    return null;}</pre><p>Whenthe user clicks Update, the Author object she edited gets updatedwith the values entered in the form's text fields (the objectis already in the list). Therefore, the only thing this method needsto do is create a new Author object. The next time the page is drawn,the text fields are populated with nothing (because they get theirdata from the new, empty Author object), enabling the user to enterthe information for a new author.</p></font></li><li>Edit the <code>saveChanges</code> methodso that it looks like  <a href="#BAJFAAAC">Listing 10-6</a>.<a name = "BAJFAAAC"></a><p><b><font face="Geneva,Helvetica,Arial" size="2">Listing10-6  The saveChanges method in Main.java</font></b></p><pre>public WOComponent saveChanges() {    // save changes made in editing context to object store    editingContext.saveChanges();    return null;}</pre></font></li><li>Edit the <code>revertChanges</code> methodso that it looks like  <a href="#BAJBFFCJ">Listing 10-7</a>.<a name = "BAJBFFCJ"></a><p><b><font face="Geneva,Helvetica,Arial" size="2">Listing10-7  The revertChanges method in Main.java</font></b></p><pre>public WOComponent revertChanges() {    // revert changes made in editing context    editingContext.revert();    // re-fetch    authorList = new  NSMutableArray(editingContext.objectsWithFetchSpecification(fetchSpec));    return null;}</pre><p>Whenthe user clicks Revert, the <code>revertChanges</code> methodtells the editing context to discard any changes made since theenterprise objects in it were last fetched or saved. However, the <code>authorList</code> arrayisn't tied to the editing context in any way. Therefore, you mustretrieve a new list of authors from the object store and assignit to <code>authorList</code>, sothat the user sees up-to-date information. (The previous list isgarbage-collected by the Java runtime after it is no longer referencedby variables in your application.)</p></font></li><li>Save <code>Main.java</code>.</font></li></ol><br><a name = "TPXREF119"></a><h3><font face="Lucida Grande,Helvetica,Arial">Running the Authors Application</font></h3><p> <a href="#BAJHEDIG">Figure 10-3</a> shows the Authors application after the names ofsome authors have been entered. </p><br><a name = "BAJHEDIG"></a><p><b><font face="Geneva,Helvetica,Arial" size="2">Figure10-3 The Authors application</font></b></p> <img src = "../Art/authorsie.gif" alt = "[image: ../Art/authorsie.gif]"><p>There is only one instance of Main throughout the application'sexecution (all the actions return <code>null</code>).When Main is created, it reads the authors from the database andstores them in the <code>authorList</code> instancevariable. As the user makes changes, <code>authorList</code> (andits editing context) is updated. The WORepetition element displaysthe contents of <code>authorList</code> and linksso that the user can edit or delete a particular author. Changesare saved when the user clicks Save.</p><p>Notice that all the complexities normally required when dealingwith databases have been replaced with the straightforward use ofenterprise objects.</p><br><a name = "TPXREF120"></a><h3><font face="Lucida Grande,Helvetica,Arial">Browsing the Database</font></h3><p>It is frequently convenient to browse the raw data in a database,including attributes that may not be displayed by your WebObjectscomponents. EOModeler has the ability to browse tables and performbasic filtering, which is useful during application development. Thissimple facility lets you get a "behind the scenes" look at yourdata.</p><ol><li>Open theAuthors model in EOModeler</font></li><li>Select the Author entity.</font></li><li>Choose Tools &gt; Data Browser.<br><a name = "TPXREF122"></a><p><b><font face="Geneva,Helvetica,Arial" size="2">Figure 10-4  EOModeler'sData Browser</font></b></p> <img src = "../Art/databrowser.gif" alt = "[image: ../Art/databrowser.gif]"><p>Currentdatabase data is displayed. The Refetch button allows you to refreshthis data on demand.</p><p>EOModeler also lets you performsimple filters to limit the number of rows displayed as  <a href="#BAJGGDEG">Figure 10-5</a> shows.</p><br><a name = "BAJGGDEG"></a><p><b><font face="Geneva,Helvetica,Arial" size="2">Figure10-5 Data Browser using filter</font></b></p> <img src = "../Art/databrowser2.gif" alt = "[image: ../Art/databrowser2.gif]"></font></li></ol><br>    <br><a href="Working_Wit_ng_Contexts.html" target="_right"><img src="../Images/previous.gif" border="0" alt="Previous"></a><a href="Further_Exploration.html" target="_right"><img src="../Images/next.gif" border="0" alt="Next"></a>&nbsp;<hr alt=""><p><font face="Palatino" size="1">&#169; 2001 Apple Computer, Inc.</font></p><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></html>