<HTML>		<HEAD>		<TITLE>					</TITLE>		</HEAD>	<body bgcolor="#ffffff"><!--start of banner --><!-- #include virtual="/techpubs/navbar" --><!-- end of banner --><!--start of path --><font face="Geneva,Helvetica,Arial" size="1"><b>PATH<spacer type="horizontal" size="5">&nbsp;</b> <a href="../../../../../../index.html" target="_top">Documentation</a> <b>&gt;</b> <a href="../../../../../webobjects.html" target="_top">WebObjects 4.5</a> <b>&gt;</b>OracleEOAdaptor Reference</font><br><br><!--end of path --><a href="OracleEOAdaptorTOC.html"><img src="../../../../../images/up.gif" border="0" alt="Table of Contents"></a> <br><h1><FONT COLOR=\"#000066\">OracleEOAdaptorFramework</FONT></h1><br><blockquote><b>Framework: </b>System/Library/Frameworks/OracleEOAdaptor.framework</blockquote><blockquote><b>Header File Directories: </b>System/Library/Frameworks/OracleEOAdaptor.framework/Headers</blockquote><br><h2>Introduction</h2><p>The OracleEOAdaptor framework is a set of classes that allowyour programs to connect to an Oracle server. These classes provideOracle-specific method implementations for the EOAccess framework's EOAdaptor,EOAdaptorChannel, EOAdaptorContext, and EOSQLExpression abstractclasses.</p><p>The following table lists the classes in the OracleEOAdaptorFramework and provides a brief description of each class.</p><br><table border = \"1\"><tr><td scope="row"><b>Class</b></td><td><b>Description</b></td></tr><tr><td scope="row">OracleAdaptor</td><td>Representsa single connection to a Oracle database server, and is responsiblefor keeping login and model information, performing Oracle-specificformatting of SQL expressions, and reporting errors. </td></tr><tr><td scope="row">OracleChannel</td><td>Representsan independent communication channel to the database server itsOracleAdaptor is connected to.</td></tr><tr><td scope="row">OracleContext</td><td>Representsa single transaction scope on the database server to which its adaptorobject is connected.</td></tr><tr><td scope="row">OracleSQLExpression</td><td>Defineshow to build SQL statements for OracleChannels.</td></tr></table><br><br><a name = "BICEHBHI"><h2>The Connection Dictionary</h2></a><p>The connection dictionary contains items needed to connectto an Oracle server, such as the server name and database (it'scommon to omit the user name and password from the connection dictionary, andprompt users to enter those values in a login panel). The keys ofthis dictionary identify the information the server expects, andthe values of those keys are the values that the adaptor uses when tryingto connect to the server.</p><p>The Oracle adaptor defines string constants for use as connectiondictionary keys:</p><ul><li> <a frame= "conv" href="Classes/OracleAdaptor.html#CDBFDEHF">ServerIdKey</a></li><li> <a frame= "conv" href="Classes/OracleAdaptor.html#CDBCEDBE">HostMachineKey</a></li><li> <a frame= "conv" href="Classes/OracleAdaptor.html#CDBFCJAG">UserNameKey</a></li><li> <a frame= "conv" href="Classes/OracleAdaptor.html#CDBBEEJE">PasswordKey</a></li><li> <a frame= "conv" href="Classes/OracleAdaptor.html#CDBDIAFC">ConnectionStringKey</a></li><li> <a frame= "conv" href="Classes/OracleAdaptor.html#CDBIABFI">NlsLangKey</a></li></ul><p>The OracleAdaptor attempts to connect with a connection stringof the form "userName/password@serverId". If all the valuesexcept the one for <code>ServerIdKey</code> areabsent, then OracleAdaptor attempts to connect with just the valuefor <code>ServerIdKey</code>.</p><p>The <code>ConnectionStringKey</code> and <code>NlsLangKey</code> areoptional. The value for <code>ConnectionStringKey</code> isa string to be used to login to the database server. If the <code>ConnectionStringKey</code> ispresent in the connection dictionary, the other logon keys (<code>ServerIdKey</code>, <code>HostMachineKey</code>, <code>UserNameKey</code>,and <code>PasswordKey</code>) are ignoredand the value for the <code>ConnectionStringKey</code> isused to connect to the database.</p><p>The value for <code>NlsLangKey</code> isused to set the Oracle NLS_LANG environment variable. NLS_LANG declaresto the Oracle server the character set being used by the client,as well as the language in which you want server error messagesto appear. The format is as follows:</p><tt>language_territory. characterSet</tt><p>For example, supplying the value <code>japanese_japan.jeuc</code> forthe <code>NlsLangKey</code> tellsthe server that the language is Japanese, the territory is Japan,and the character set is jeuc. See your Oracle documentation fora complete list of types available for this field.</p><p>To add the <code>NlsLangKey</code> anda value to your connection dictionary, you can manually edit yourmodel file. For example:</p><blockquote><pre>connectionDictionary = {    password = tiger;     serverId = sjOracle;     userName = scott;    NLS_LANG = american_america.us7ascii;};</pre></blockquote><br><p>Subsequently changing the connection dictionary in your modelfile using the Set Adaptor Info command in EOModeler has no effecton these keys and their values-they are preserved unless you edit thefile to remove them.</p><p>The default character set for Japanese systems is jeuc. Ifyou are using a non-Japanese system, the default is whatever Oracleprovides. You only need to add the <code>NlsLangKey</code> toyour connection dictionary if you are using a character set otherthan your system's default.</p><br><table border = \"1\"><tr><td scope="row">Enterprise Objects Framework uses Mac OS XServer encoding to represent string data, and it passes stringsto the database without converting them to the database characterset. If you require that the data passed to your server is in anencoding other than Mac OS X Server encoding, you need to subclassNSString.</td></tr</table><br><br><h2>Locking</h2><p>All adaptors use the database server's native locking facilitiesto lock rows on the server. The Oracle adaptor locks a row by usingthe SELECT... FOR UPDATE... statement. This occurs when:</p><ul><li>You send the adaptor channel a <b>selectAttributes:fetchSpecification:lock:entity:</b> messagewith YES specified as the value for the <b>lock:</b> keyword.</li><li>You explicitly lock an object's row with the EODatabaseContext's <b>lockObjectWithGlobalID:editingContext:</b> message.</li><li>You set pessimistic locking at the database level and fetchobjects.</li></ul><br><h2>Data Type Mapping</h2><p>Every adaptor provides a mapping between each server datatype and the Objective-C type to which a database value will becoerced when it's fetched from the database. The following tablelists the mapping used by OracleAdaptor.</p><br><table border = \"1\"><tr><td><b>OracleData Type</b></td><td><b>Objective-C Data Type</b></td></tr><tr><td scope="row"><code>VARCHAR2</code></td><td>NSString</td></tr><tr><td scope="row"><code>NUMBER</code></td><td>NSDecimalNumber</td></tr><tr><td scope="row"><code>LONG</code></td><td>NSString</td></tr><tr><td scope="row"><code>DATE</code></td><td>NSCalendarDate</td></tr><tr><td scope="row"><code>RAW</code></td><td>NSData</td></tr><tr><td scope="row"><code>LONGRAW</code></td><td>NSData</td></tr><tr><td scope="row"><code>CHAR</code></td><td>NSString</td></tr><tr><td scope="row"><code>MLSLABEL</code></td><td>NSString</td></tr><tr><td scope="row"><code>REFCURSOR</code></td><td>OracleChannel</td></tr></table><br><p>The type mapping methods-<b>externalTypesWithModel:</b>, <b>internalTypeForExternalType:model:</b>,and <b>isValidQualifierType:model:</b>-allowfor an adaptor to supplement its set of type mappings with additionalmappings for user-defined database types. OracleAdaptor does notmake use of the model argument if one is provided.</p><br><h2>Prototype Attributes</h2><p>The OracleAdaptor Framework provides the following set ofprototype attributes:</p><br><table border = \"1\"><tr><td scope="row"><b>Name</b></td><td><b>External Type</b></td><td><b>ValueClass Name</b></td><td><b>Other Attributes</b></td></tr><tr><td scope="row"><code>binaryID</code></td><td><code>RAW</code></td><td>NSData</td><td><code>width= 12</code></td></tr><tr><td scope="row"><code>city</code></td><td><code>VARCHAR2</code></td><td>NSString</td><td><code>columnName= CITY</code><code>width = 50</code></td></tr><tr><td scope="row"><code>date</code></td><td><code>DATE</code></td><td>NSCalendarDate</td><td><code>columnName= ""</code></td></tr><tr><td scope="row"><code>longText</code></td><td><code>LONG</code></td><td>NSString</td><td>&nbsp;</td></tr><tr><td scope="row"><code>money</code></td><td><code>NUMBER</code></td><td>NSDecimalNumber</td><td><code>columnName= ""</code></td></tr><tr><td scope="row"><code>phoneNumber</code></td><td><code>VARCHAR2</code></td><td>NSString</td><td><code>columnName= PHONE</code><code>width = 20</code></td></tr><tr><td scope="row"><code>rawImage</code></td><td><code>LONGRAW</code></td><td>NSData</td><td><code>columnName= RAW_IMAGE</code></td></tr><tr><td scope="row"><code>state</code></td><td><code>VARCHAR2</code></td><td>NSString</td><td><code>columnName= STATE</code><code>width = 2</code></td></tr><tr><td scope="row"><code>streetAddress</code></td><td><code>VARCHAR2</code></td><td>NSString</td><td><code>columnName= STREET_ADDRESS</code><code>width = 100</code></td></tr><tr><td scope="row"><code>tiffImage</code></td><td><code>LONGRAW</code></td><td>NSImage</td><td><code>adaptorValueConversionMethodName=    TIFFRepresentation</code><code>columnName = PHOTO</code><code>valueFactoryMethodName =    "imageWithData:"</code></td></tr><tr><td scope="row"><code>uniqueID</code></td><td><code>NUMBER</code></td><td>NSNumber</td><td><code>columnName= ""</code><code>valueType = i</code></td></tr><tr><td scope="row"><code>zipCode</code></td><td><code>VARCHAR2</code></td><td>NSString</td><td><code>columnName= ZIP</code><code>width = 10</code></td></tr></table><br><br><h2>Handling Errors</h2><p>OracleChannel provides a method for handling errors:  <a frame= "conv" href="Classes/OracleChannel.html#//apple_ref/occ/instm/OracleChannel/raiseOracleError">raiseOracleError</a>. This method isinvoked whenever the channel encounters an error reported by theOracle server. The methods  <a frame= "conv" href="Classes/OracleChannel.html#//apple_ref/occ/instm/OracleChannel/cursorDataArea">cursorDataArea</a>,  <a frame= "conv" href="Classes/OracleContext.html#//apple_ref/occ/instm/OracleContext/hostDataArea">hostDataArea</a>, and  <a frame= "conv" href="Classes/OracleContext.html#//apple_ref/occ/instm/OracleContext/logonDataArea">logonDataArea</a> are used to retrieveOracle-specific data structures from the channel and context todetermine what error has occurred. The  <a frame= "conv" href="Classes/OracleContext.html#//apple_ref/occ/instm/OracleContext/hostDataArea">hostDataArea</a> and  <a frame= "conv" href="Classes/OracleContext.html#//apple_ref/occ/instm/OracleContext/logonDataArea">logonDataArea</a> methods are declaredin the OracleContext class.</p><br><h2>Generating Primary Keys</h2><p>Each adaptor provides a database-specific implementation ofthe method <b>primaryKeyForNewRowWithEntity:</b> forgenerating primary keys. The OracleChannel's implementation usessequence objects to provide primary key values. The statement usedto create the sequence is:</p><blockquote><pre>create sequence table_SEQ</pre></blockquote><br><p>where table is the name of the table for which the adaptorprovides primary key values. The adaptor sets the sequence startvalue to the corresponding table's maximum primary key value plusone.</p><p>To use OracleChannel's database-specific primary key generationmechanism, be sure that your database accommodates the adaptor'sscheme. To modify your database so that it supports the adaptor'smechanism for generating primary keys, use EOModeler. For more informationon this topic, see <i>Enterprise Objects Framework Developer'sGuide</i>.</p><br><h2>Bind Variables</h2><p>The OracleAdaptor uses bind variables. A bind variable isa placeholder used in an SQL statement that is replaced with anactual value after the database server determines an execution plan.You use the following OracleSQLExpression methods to operate onbind variables:</p><ul><li>bindVariableDictionaryForAttribute:value:</li><li>mustUseBindVariableForAttribute:</li><li>shouldUseBindVariableForAttribute:</li></ul><p></p><br><a href="OracleEOAdaptorTOC.html"><img src="../../../../../images/up.gif" border="0" alt="Table of Contents"></a> </BODY></HTML>