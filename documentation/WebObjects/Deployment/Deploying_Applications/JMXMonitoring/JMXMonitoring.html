<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>WebObjects Deployment Guide Using JavaMonitor: JMX Monitoring</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="JMX Monitoring"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30001009-CH216" title="JMX Monitoring"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../MacOSXServer/index.html#//apple_ref/doc/uid/TP30000440-TP30000426" target="_top">Mac OS X Server</a> &gt; <a href="../../../../MacOSXServer/WebObjects-date.html#//apple_ref/doc/uid/TP30000440-TP30000426-TP30000592" target="_top">WebObjects</a> &gt; <a href="../Introduction/Introduction.html#//apple_ref/doc/uid/TP30000059-TPXREF101">WebObjects Deployment Guide Using JavaMonitor</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../ApplicationURL/ApplicationURL.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../SpecialDeploymentIssues/SpecialDeploymentIssues.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP30001009-CH216-SW1" title="JMX Monitoring"></a><h1>JMX Monitoring</h1>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="JMXMonitoring.html#//apple_ref/doc/uid/TP30001009-CH216-DontLinkElementID_10">Introduction</a>
				
			<br/>
			
        
			
			
				<a href="JMXMonitoring.html#//apple_ref/doc/uid/TP30001009-CH216-DontLinkElementID_11">Enabling JMX Monitoring</a>
				
			<br/>
			
        
			
			
				<a href="JMXMonitoring.html#//apple_ref/doc/uid/TP30001009-CH216-DontLinkElementID_12">Using jconsole</a>
				
			<br/>
			
        
			
			
				<a href="JMXMonitoring.html#//apple_ref/doc/uid/TP30001009-CH216-DontLinkElementID_13">Viewing WebObjects Statistics</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP30001009-CH216-DontLinkElementID_10" title="Introduction"></a><h2>Introduction</h2><div class="importantbox"><a name="//apple_ref/doc/uid/TP30001009-CH216-DontLinkElementID_55" title="Important:"></a><p><strong>Important:</strong>&nbsp;The WOStatisticsStore MBean Interface is available in WebObjects 5.4 and later. JMX is available on computers with Sun’s Java JDK 1.5 or later installed.</p><p></p></div><p>You can monitor WebObjects applications using Sun's Java JDK 1.5 Java Management Extensions (JMX) management and monitoring tools. Specifically, you use Sun’s <code>jconsole</code> tool to collect statistics on running WebObjects applications. This appendix explains how to set the Java virtual machine (JVM) system properties for local and remote monitoring of a WebObjects application and how to view the WebObjects statistics with JMX. </p><p>This appendix provides only a brief introduction to JMX. They can be an alternative solution for monitoring your applications instead of using JavaMonitor and can be useful for tracing memory and thread usage during development. See Sun’s <span class="content_text"><a href="http://java.sun.com/j2se/1.5.0/docs/guide/management/mxbeans.html" target="_blank">Using the Platform MBean Server and Platform MBeans</a></span> for more information on accessing Sun’s MBeans. </p><a name="//apple_ref/doc/uid/TP30001009-CH216-DontLinkElementID_11" title="Enabling JMX Monitoring"></a><h2>Enabling JMX Monitoring</h2><p>To enable the JMX agent and use <code>jconsole</code> to configure its operation, you must first set some system properties when you start the JVM. Note that properties specified on the command line override properties specified in a configuration file. You can either monitor a WebObjects application locally as described in <span class="content_text">“Local Monitoring”</span> or remotely as described in <span class="content_text"><a href="JMXMonitoring.html#//apple_ref/doc/uid/TP30001009-CH216-SW2">“Remote Monitoring.”</a></span> Local monitoring is useful in a development environment, but not for deployment, since running <code>jconsole</code> is very resource intensive.  </p><a name="//apple_ref/doc/uid/TP30001009-CH216-SW4" title="Local Monitoring"></a><h3>Local Monitoring</h3><p>To enable JMX local monitoring, add the property either via the command line or in the <code>build-properties.xml</code> file of the WebObjects application. For reference, see a sample<code> build-properties.xml</code> in the <code>/Developer/Examples/JavaWebObjects/HelloWorld</code> folder. </p><p>From the command line, set the <code>com.sun.management.jmxremote</code> property  to <code>true</code> when starting the WebObjects application as follows: </p><p><code>cd MyApplication.woa</code></p><p><code>./MyApplication -Dcom.sun.management.jmxremote=true</code></p><p>To set this property in the <code>build-properties.xml</code> file located in your project directory, open the file using a text editor, and modify it as follows:</p><p><code>&lt;jvmopts>-Dcom.sun.management.jmxremote=true&lt;/jvmopts></code></p><p>To turn off JMX monitoring, make sure that you do not define the property anywhere in your application. For example, if the property is set in the<code> build-properties.xml</code> file, you should delete the definition of the property in that file.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP30001009-CH216-DontLinkElementID_56" title="Note"></a><p><strong>Note:</strong>&nbsp;Local monitoring is useful for development or prototyping, but you should use remote monitoring during deployment, because <code>jconsole</code> consumes significant system resources. Remote monitoring isolates <code>jconsole</code> from the WebObjects application being monitored. </p></div><a name="//apple_ref/doc/uid/TP30001009-CH216-SW2" title="Remote Monitoring"></a><h3>Remote Monitoring</h3><p>To enable JMX remote monitoring, use either the command line or add the following JVM properties to the <code>build-properties.xml</code> file of the WebObjects application.</p><p>From the command line, set the port number for <code>com.sun.management.jmxremote.port</code> to some unused port number. Setting the port number automatically enables JMX monitoring. In a development environment, you can turn off authentication by setting the <code>com.sun.management.jmxremote.authenticate</code> and <code>com.sun.management.jmxremote.ssl</code> properties to <code>false</code>.</p><p>To set these properties in the <code>build-properties.xml</code> file for remote monitoring in a development environment, set the following JVM properties as follows:</p><ul class="simple"><li><p><code>&lt;jvmopts>-Dcom.sun.management.jmxremote.port=9000&lt;/jvmopts></code></p></li><li><p><code>&lt;jvmopts>-Dcom.sun.management.jmxremote.authenticate=false&lt;/jvmopts></code></p></li><li><p><code>&lt;jvmopts>-Dcom.sun.management.jmxremote.ssl=false&lt;/jvmopts></code></p></li></ul><div class="warningbox"><img src="../../../../Resources/Images/icon_warning.gif" alt="!" width="20" height="20" border="0" class="warningicon" /><a name="//apple_ref/doc/uid/TP30001009-CH216-DontLinkElementID_57" title="Warning:"></a><p><strong>Warning:</strong>&nbsp;This sample configuration is insecure. Any remote user who knows (or guesses) your JMX port number and host name is able to monitor and control your WebObjects application and platform. While this configuration is OK for development, it is not recommended for deployment. See Sun’s <span class="content_text"><a href="http://java.sun.com/j2se/1.5.0/docs/guide/management/agent.html" target="_blank">Monitoring and Management using JMX</a></span> for how to set up SSL authentication for secure monitoring of your applications.</p><p></p><div class="clear"></div></div><a name="//apple_ref/doc/uid/TP30001009-CH216-DontLinkElementID_12" title="Using jconsole"></a><h2>Using jconsole</h2><p>After enabling JMX monitoring, you can view various measurements about the performance and resource consumption of your WebObjects application using Sun’s <code>jconsole</code> tool. </p><p>To monitor locally, start <code>jconsole</code> in a terminal shell and select the WebObjects application process ID (PID) as shown in <span class="content_text">Figure A-1</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP30001009-CH216-SW5" title="Figure A-1Local monitoring"></a><p><strong>Figure A-1&nbsp;&nbsp;</strong>Local monitoring</p><img src = "../Art/jmxlocalmonitor.jpg" alt = "../Art/jmxlocalmonitor.jpg" ></div><br/><p>To monitor remotely, start your WebObjects application on the remote machine with the proper JVM properties set as described in <span class="content_text"><a href="JMXMonitoring.html#//apple_ref/doc/uid/TP30001009-CH216-SW2">“Remote Monitoring.”</a></span> Start <code>jconsole</code> in a terminal shell on a local machine and select the Remote tab as shown in <span class="content_text"><a href="JMXMonitoring.html#//apple_ref/doc/uid/TP30001009-CH216-SW6">Figure A-2</a></span>. Enter the host name and port number for the remote machine, and a user name and password if password authentication is enabled.</p><br/><div><a name="//apple_ref/doc/uid/TP30001009-CH216-SW6" title="Figure A-2Remote monitoring"></a><p><strong>Figure A-2&nbsp;&nbsp;</strong>Remote monitoring</p><img src = "../Art/jmxremotemonitor.jpg" alt = "../Art/jmxremotemonitor.jpg" ></div><br/><div class="notebox"><a name="//apple_ref/doc/uid/TP30001009-CH216-DontLinkElementID_58" title="Note"></a><p><strong>Note:</strong>&nbsp;For more information on using <code>jconsole</code>, see Sun’s <span class="content_text"><a href="http://java.sun.com/j2se/1.5.0/docs/guide/management/jconsole.html" target="_blank">Using JConsole</a></span>.</p></div><a name="//apple_ref/doc/uid/TP30001009-CH216-DontLinkElementID_13" title="Viewing WebObjects Statistics"></a><h2>Viewing WebObjects Statistics</h2><p>You can define what to monitor by declaring Java standard MBean interfaces for your Java classes. Whenever you want to monitor your object, you register your object with the MBean server. Similarly, you can unregister your object with the MBean server whenever you are no longer interested in monitoring your object.  </p><p>To accomplish these tasks, use the following WOApplication methods:</p><div class="codesample"><table><tr><td scope="row"><pre>public MBeanServer getMBeanServer() throws IllegalAccessException<span></span></pre></td></tr><tr><td scope="row"><pre>public String getJMXDomain()<span></span></pre></td></tr><tr><td scope="row"><pre>public void registerMBean(Object aMBean, ObjectName aName)<span></span></pre></td></tr><tr><td scope="row"><pre>public void registerMBean(Object aMBean, String aDomainName, String  aMBeanName) throws IllegalArgumentException<span></span></pre></td></tr><tr><td scope="row"><pre>public void unregisterMBean(ObjectName aName)<span></span></pre></td></tr></table></div><p>For example, registering your application with WOStatisticsStore MBean server gives you a view of various runtime statistics using <code>jconsole</code>. The WOStatisticsStore object records the bulk of its statistics at the end of each cycle of the request-response loop. </p><p><span class="content_text">Listing A-1</span> shows how to register your WebObjects application with WOStatisticsStore MBean. To view the WebObjects statistics, start your application, launch <code>jconsole</code>, and select the MBeans tab to view various information as shown in <span class="content_text"><a href="JMXMonitoring.html#//apple_ref/doc/uid/TP30001009-CH216-SW7">Figure A-3</a></span>. </p><a name="//apple_ref/doc/uid/TP30001009-CH216-SW3" title="Listing A-1Registering your application with the WOStatisticsStore MBean"></a><p class="codesample"><strong>Listing A-1&nbsp;&nbsp;</strong>Registering your application with the WOStatisticsStore MBean</p><div class="codesample"><table><tr><td scope="row"><pre>// JMX API<span></span></pre></td></tr><tr><td scope="row"><pre>import javax.management.MBeanServer;<span></span></pre></td></tr><tr><td scope="row"><pre>public class Application extends WOApplication {<span></span></pre></td></tr><tr><td scope="row"><pre>    public static void main(String argv[]) {<span></span></pre></td></tr><tr><td scope="row"><pre>        WOApplication.main(argv, Application.class);<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    public Application() {<span></span></pre></td></tr><tr><td scope="row"><pre>        super();<span></span></pre></td></tr><tr><td scope="row"><pre>        System.out.println("Welcome to " + this.name() + "!");<span></span></pre></td></tr><tr><td scope="row"><pre>        /* ** Put your application initialization code here ** */<span></span></pre></td></tr><tr><td scope="row"><pre>        try {<span></span></pre></td></tr><tr><td scope="row"><pre>            MBeanServer server = getMBeanServer();<span></span></pre></td></tr><tr><td scope="row"><pre>            String mbeanClassName = "com.webobjects.appserver.WOStatisticsStore";<span></span></pre></td></tr><tr><td scope="row"><pre>            String mbeanObjectNameStr = getJMXDomain() + ":type=" + mbeanClassName;<span></span></pre></td></tr><tr><td scope="row"><pre>            registerMBean((Object)statisticsStore(), getJMXDomain(), mbeanClassName);<span></span></pre></td></tr><tr><td scope="row"><pre>        } catch (Exception iae) {<span></span></pre></td></tr><tr><td scope="row"><pre>            NSLog.debug.appendln("WARNING: couldn't initialize JMX monitoring due to "+iae.getMessage()+"\n");<span></span></pre></td></tr><tr><td scope="row"><pre>            iae.printStackTrace();<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><br/><div><a name="//apple_ref/doc/uid/TP30001009-CH216-SW7" title="Figure A-3Viewing WebObjects statistics"></a><p><strong>Figure A-3&nbsp;&nbsp;</strong>Viewing WebObjects statistics</p><img src = "../Art/jmxmbean1.jpg" alt = "../Art/jmxmbean1.jpg" ></div><br/>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../ApplicationURL/ApplicationURL.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../SpecialDeploymentIssues/SpecialDeploymentIssues.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2001, 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-10-31<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/WebObjects/Deployment/Deploying_Applications/JMXMonitoring/JMXMonitoring.html%3Fid%3DTP30001009-4.2&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/WebObjects/Deployment/Deploying_Applications/JMXMonitoring/JMXMonitoring.html%3Fid%3DTP30001009-4.2&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/WebObjects/Deployment/Deploying_Applications/JMXMonitoring/JMXMonitoring.html%3Fid%3DTP30001009-4.2&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>