<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>

	<!-- BEGIN META TAG INFO -->
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<link rel="home" href="http://developer.apple.com/">
	<link rel="find" href="http://developer.apple.com/search/">
	<link rel="stylesheet" type="text/css" href="../../documentation/css/adcstyle.css" title="fonts">
	<script language="JavaScript" src="../../documentation/js/adc.js" type="text/javascript"></script>
	<!-- END META TAG INFO -->
	
	<!-- BEGIN TITLE -->
	<title>ProcDoggie - /UProcessLDEF.p</title>
	<!-- END TITLE -->
<script language="JavaScript">
function JumpToNewPage() {
	window.location=document.scpopupmenu.gotop.value;
	return true;
}
</script>

</head>

<!-- BEGIN BODY OPEN -->
<body>
<!--END BODY OPEN -->

<!-- START CENTER OPEN -->
<center>
<!-- END CENTER OPEN -->

	<!-- BEGIN LOGO AND SEARCH -->
	<!--#include virtual="/includes/adcnavbar"-->
	<!-- END LOGO AND SEARCH -->
		
		
	<!-- START BREADCRUMB -->
	<div id="breadcrumb">
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td scope="row"><img width="340" height="10" src="images/1dot.gif" alt=""></td>
			<td><img width="340" height="10" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr valign="middle">
			<td align="left" colspan="2">
			<a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../samplecode/index.html">Sample Code</a> &gt; <a href="../../samplecode/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../samplecode/LegacyTechnologies/idxCarbon-date.html">Carbon</a> &gt; <A HREF="javascript:location.replace('index.html');">ProcDoggie</A> &gt; 
			</td>
		</tr>
		<tr>
			<td colspan="2" scope="row"><img width="680" height="35" src="images/1dot.gif" alt=""></td>
		</tr>
	</table>
	</div>
	<!-- END BREADCRUMB -->

	<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/Carbon/idxProcessManagement-date.html" target="_blank">Carbon > Process Management</a></li>
	</ul>
</div>




</div></div></div>

	<!-- START MAIN CONTENT -->
	
	<!-- START TITLE GRAPHIC AND INTRO-->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td><h1><div id="pagehead">ProcDoggie</div></h1></td>
		</tr>
	</table>
	<!-- END TITLE GRAPHIC AND INTRO -->
	<!-- START WIDE COLUMN -->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td id="scdetails">
				<h2>/UProcessLDEF.p</h2>
				<form name="scpopupmenu" onSubmit="return false;" method=post>
				<p><strong>View Source Code:</strong> 
					<select name="gotop" onChange="JumpToNewPage();" style="width:340px"><option selected value="ingnore">Select File</option>
<option value="listing1.html">/ProcDoggie.p</option>
<option value="listing2.html">/StubLDEF/StubLDEF.p</option>
<option value="listing3.html">/UDialogUtils.p</option>
<option value="listing4.html">/UEmergMem.p</option>
<option value="listing5.html">/UEvents.p</option>
<option value="listing6.html">/UGlobals.p</option>
<option value="listing7.html">/UMenuHandler.p</option>
<option value="listing8.html">/UProcessGuts.p</option>
<option value="listing9.html">/UProcessLDEF.p</option>
<option value="listing10.html">/UProcessUtils.p</option></select>
				</p>
				</form>
				<p><strong><a href="ProcDoggie.zip">Download Sample</a></strong> (&#147;ProcDoggie.zip&#148;, 94.4K)<BR>
<strong><a href="ProcDoggie.dmg">Download Sample</a></strong> (&#147;ProcDoggie.dmg&#148;, 163.0K)</p>
				<!--
				<p><strong><a href="#">Download Sample</a></strong> (&#147;filename.sit&#148;, 500K)</p>
				-->
			</td>
		</tr>
		<tr>
			<td scope="row"><img width="680" height="10" src="images/1dot.gif" alt=""><br>
			<img height="1" width="680" src="images/1dot_919699.gif" alt=""><br>
			<img width="680" height="20" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr>
			<td scope="row">
	<!--googleon: index -->
<pre class="sourcecodebox">{  File:    UProcessLDEF.p  Contains:  This LDEF is a simple replacement for the standard LDEF.  The only advantange        this LDEF has over the standard LDEF is that it contains information specific        to processes that aren't displayed.  This is to make identifying processes in        the Process List window easier.          Once the icon utilities are released to the developer community, this LDEF        will be updated to display the icon of each process in the list.  Written by: Forrest Tanaka    Copyright:  Copyright &copy; 1988-1999 by Apple Computer, Inc., All Rights Reserved.        You may incorporate this Apple sample source code into your program(s) without        restriction. This Apple sample source code has been provided &quot;AS IS&quot; and the        responsibility for its operation is yours. You are not permitted to redistribute        this Apple sample source code as &quot;Apple sample source code&quot; after having made        changes. If you're going to re-distribute the source, we require that you make        it clear in the source that the code was descended from Apple sample source        code, but that you've made changes.  Change History (most recent first):        7/27/1999  Karl Groethe  Updated for Metrowerks Codewarror Pro 2.1        }UNIT UProcessLDEF;{[j=20/57/1$] Pasmat Options}INTERFACE(******************************************************************************** Used Units*******************************************************************************)  USES    Processes    ,Lists    ;(******************************************************************************** Types*******************************************************************************)  TYPE    ProcessListInfoRec = RECORD      processName:    Str255;               {Process's name}      serialNumber:   ProcessSerialNumber  {Process's serial number}    END;    ProcessListInfoPtr = ^ProcessListInfoRec;(******************************************************************************** ProcessList - Entry point to the List Definition Procedure** This is the entry point to the custom list defproc used in ProcDoggie.  ProcDoggie* actually uses the world's simplest LDEF.  All that LDEF does is call through* the ListRec's refCon field.  So we jam the address of ProcessListLDEF into that* field and, voila, we don't have to have a separate LDEF and we can debug* our LDEF in a high-level debugger.  It's kinda like the classic &quot;6 byte LDEF&quot;* trick, except we don't have to worry about cache flushing.*******************************************************************************)  PROCEDURE ProcessListLDEF (message:    Integer;                         selectCell: Boolean;                         VAR cellRect:   Rect;                         theCell:    Cell;                         dataOffset: Integer;                         dataLength: Integer;                         theList:    ListHandle);IMPLEMENTATION  USES    Script    ,TextEdit    ,LowMem    ,ToolUtils    ;  CONST    kCellMargin = 3; {Margin between list contents and list edge in pixels}  {$S Main}  (*******************************************************************************  * Private: HilightCell - Hilight the specified cell  *  * This routine hilights the cell whose rectangle is cellRect.  I also clear the  * hilight bit of the HiliteMode low-memory global.  If this is running on a  * Color QuickDraw machine, then background hilighting is done instead of  * the usual inversion.  *******************************************************************************)  PROCEDURE HilightCell (cellRect: Rect);  VAR    hiliteModeValue:  ByteParameter;      BEGIN    (* Do the fancy, new kind of hilighting on a Color QuickDraw Mac *)    hiliteModeValue := LMGetHiliteMode;    BitClr(Ptr(@hiliteModeValue), pHiliteBit);    LMSetHiliteMode(hiliteModeValue);    (* Now, hilight the cell *)    InvertRect (cellRect)  END;  {$S Main}  (*******************************************************************************  * Private: DrawCell - Draw the contents of the specified cell  *  * This routine draws the contents of the cell specified by theCell into it's  * rectangle, which is specified by cellRect.  In case the font is too large for  * the cell rectangle, I set the clip region to cellRect before drawing the cell  * text, then set it back to what it was afterwards.  *  * If selected is TRUE, then theCell is selected.  In that case, my HilightCell  * routine is called to hilight the cell.  *  * The list that this all takes place in is specified by theList.  *******************************************************************************)  PROCEDURE DrawCell (cellRect:   Rect;                      theCell:    Cell;                      selected:   Boolean;                      theList:    ListHandle;                      dataOffset: Integer);    VAR      cellInfo:   ProcessListInfoRec; {Information for cell to be drawn}      currClip:   RgnHandle;          {Handle to the current clip region}      currPen:    PenState;           {Current pen characteristics}      currFont:   FontInfo;           {Current font characteristics}      dataLen:    Integer;            {Length of cell data in bytes}      marginRect: Rect;               {Rect that process name is drawn into}      alignment:  Integer;            {Alignment of process name text}      spareSpace: Integer;            {marginRect width - text width}  BEGIN    {$unused dataOffset}        (* Save the current pen state and set the default pen characteristics *)    GetPenState ((*&lt;*)currPen);    PenNormal;    (* Save the current clip region and set it to cellRect *)    currClip := NewRgn;    GetClip ((*&lt;*)currClip);    ClipRect (cellRect);    (* Will draw text into the cell rect with a margin on left and right *)    marginRect := cellRect;    InsetRect ((*\xD7*)marginRect, kCellMargin, 0);    (* Get the information for the specified cell *)    dataLen := SIZEOF (ProcessListInfoRec);    LGetCell ((*&lt;*)Ptr(@cellInfo), (*\xD7*)dataLen, theCell, theList);    (* To find where to draw the cell's text, get current font information *)    GetFontInfo ((*&lt;*)currFont);    (* Position the pen for drawing the text *)    MoveTo (marginRect.left, marginRect.top + currFont.ascent);    (* Determine whether system script is left-to-right or right-to-left *)    IF GetSysDirection = 0 THEN      alignment := teFlushLeft    ELSE      alignment := teFlushRight;    (* Adjust the pen for right-aligned text if script is right-to-left *)    IF alignment = teFlushRight THEN      BEGIN        spareSpace := marginRect.right - marginRect.left -            StringWidth (cellInfo.processName);        Move (spareSpace, 0);      END;    (* Draw the cell's contents *)    EraseRect (cellRect);    DrawString (cellInfo.processName);    (* If the cell is selected, hilight it *)    IF selected THEN      HilightCell (cellRect);    (* Restore the current clip region and pen *)    SetClip (currClip);    DisposeRgn (currClip);    SetPenState (currPen);  END;  {$S Main}  (*******************************************************************************  * Public: ProcessList  *  * Here's the entry point to my custom LDEF.  Yup.  *******************************************************************************)  PROCEDURE ProcessListLDEF (message:    Integer;                         selectCell: Boolean;                         VAR cellRect:   Rect;                         theCell:    Cell;                         dataOffset: Integer;                         dataLength: Integer;                         theList:    ListHandle);  BEGIN    IF message = lDrawMsg THEN      BEGIN        IF dataLength &gt; 0 THEN          DrawCell (cellRect, theCell, selectCell, theList, dataOffset)      END    ELSE IF message = lHiliteMsg THEN      HilightCell (cellRect)  END;END.</pre>
	<!--googleoff: index -->
			</td>
		</tr>
	</table>
	<!-- END WIDE COLUMN -->

	<!-- END MAIN CONTENT -->
		<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/samplecode/ProcDoggie/listing9.html%3Fid%3DDTS10000315-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/samplecode/ProcDoggie/listing9.html%3Fid%3DDTS10000315-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/samplecode/ProcDoggie/listing9.html%3Fid%3DDTS10000315-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

	<!-- START BOTTOM APPLE NAVIGATION -->
	<!--#include virtual="/includes/footer"-->
	<!-- END BOTTOM APPLE NAVIGATION -->

<!-- START CENTER CLOSE -->
</center>
<!-- END CENTER CLOSE -->

</body>
</html>