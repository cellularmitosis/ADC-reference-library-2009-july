<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>The TextEdit User Interface(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING46></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-45.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-47.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-40.html"><B>Chapter 2 - TextEdit</B></A> / <A HREF="Text-41.html"><B>About TextEdit</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING46-0></A>
<H2>The TextEdit User Interface</H2>
 This section describes the TextEdit user interface, that is, how TextEdit displays text on the screen and the methods it uses to communicate information about that text to an application user. It explains some of the processes that TextEdit performs automatically for your application, including how TextEdit uses highlighting or a caret to identify where the next editing operation is to occur, how TextEdit handles line measurement for your application, and how TextEdit uses buffering to handle 2-byte characters. <BR>This section also covers some aspects of the user interface that your application can control through TextEdit routines, such as the kind of text <A NAME=MARKER-2-322></A>alignment and the use of buffering to enhance performance.<P>
<A NAME=HEADING46-2></A>
<H3><A NAME=MARKER-9-56></A>The Selection Range, the Insertion Point, and Highlighting in TextEdit</H3>
 Depending on the purpose of an application, a user might select a range of text to be edited or the application might set the selection range. In either case, the selected text becomes the current selection range. TextEdit uses a byte offset to identify the position of a character in the text buffer of an edit record, and an edit record includes fields that specify the byte offsets of the characters in the text buffer that correspond to the beginning and the end of the current selection range in the displayed text. (See <A HREF=Text-48.html#MARKER-9-112>"An Overview of the Edit Record" on page 2-14</A> for more about edit records.)<A NAME=MARKER-2-254></A><P>
 When the byte offset values for the beginning and the end of the selection range are the same, the selection range is an <B>insertion point. </B>TextEdit marks an insertion point with a<A NAME=MARKER-2-233></A> blinking <B>caret</B> in the form of a vertical bar (|).<A NAME=MARKER-2-16></A><P>
 TextEdit uses <A NAME=MARKER-2-465></A><A NAME=MARKER-2-328></A>highlighting to display a<A NAME=MARKER-2-399></A> selection range. Because TextEdit supports mixed-directional text, the selection range can appear as discontinuous text. Displayed text is highlighted according to the storage order of the characters. When multiple script systems having different line directions are installed, a continuous sequence of characters in memory may appear as a discontinuous <A NAME=MARKER-2-515></A>selection when displayed. <BR><A HREF=#MARKER-9-65>Figure 2-3</A> shows how TextEdit highlights a range of text whose displayed glyphs are not contiguous, although their corresponding byte offsets are contiguous in memory. In this example, the primary line direction is left to right.<A NAME=MARKER-2-977></A><P>
<B>Figure 2-3  <A NAME=MARKER-9-65></A><A NAME=MARKER-21-66></A>Discontinuous highlighting display</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/TE_L-11.jpg">
 TextEdit provides a function that lets you to turn <B>outline highlighting,</B> the f<A NAME=MARKER-2-81></A>raming of text in a selection range, in an inactive window, on or off. See <A HREF=#MARKER-9-69>Figure 2-4</A>. (For more information about outline highlighting, see <A HREF=Text-120.html#MARKER-9-542>"TEFeatureFlag" on page 2-102</A>.)<A NAME=MARKER-2-291></A><P>
<B>Figure 2-4  <A NAME=MARKER-9-69></A>Outline highlighted text selection in background window</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/TE_S-02.jpg">
<A NAME=HEADING46-11></A>
<H3><A NAME=MARKER-2-300></A>Caret Position and Movement</H3>
 This section describes how TextEdit displays and moves a caret. For more information, see the discussion of caret handling in the chapter "Introduction to Text on the Macintosh" in this book.<P>
 TextEdit marks the position in the displayed text where the next editing operation is to occur with a caret. When TextEdit pastes text into a record, it positions a caret after the newly pasted text on the screen. TextEdit uses a single caret for text that does not include mixed directions. When TextEdit displays a single caret in unidirectional text and the user presses an arrow key to move the caret left or right across the text, TextEdit moves the caret in the direction of the arrow key.<P>
 <A NAME=MARKER-2-9></A>When the text includes mixed directions, TextEdit uses <A NAME=MARKER-2-275></A>either a <A NAME=MARKER-2-367></A><A NAME=MARKER-2-380></A>moving caret or a <A NAME=MARKER-9-263></A>dual caret, depending on the value of a Script Manager flag. For example, if this flag specifies a moving caret, TextEdit displays the caret at the screen location where the next glyph is to appear, based on the text direction of the keyboard script.<P>
 <A NAME=MARKER-2-76></A>If this flag specifies a dual caret, TextEdit displays a <A NAME=MARKER-2-154></A>high caret and a <A NAME=MARKER-2-8></A>low caret, each measuring half the line's height. The high caret is displayed at the screen location associated with the glyph that has the same direction as the primary line direction, and the low caret is displayed at the screen location associated with the glyph that has a different direction from the primary line direction.<P>
 When TextEdit displays a dual caret on a direction boundary, only the primary caret moves in the direction of the arrow. <A HREF=#MARKER-9-79>Figure 2-5</A> shows a sequence of two Right Arrow keypresses and their impact on caret display and movement in a line containing mixed-directional text. In this example, the primary line direction is right to left.<P>
<B>Figure 2-5  <A NAME=MARKER-9-79></A>Caret movement across a direction boundary</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/TE_L-17.jpg">
 In the first instance of the text segment, the caret is positioned within the Arabic text. When the user presses the Right Arrow key once, the insertion point is positioned on a direction boundary and the caret splits into a dual caret. When the user presses the Right Arrow key again, TextEdit displays a single, full caret after the parenthesis in the Roman text. Because the caret position is again in the middle of a style run, TextEdit no longer uses the dual caret.<A NAME=MARKER-9-81></A><P>
<DL>
<DT><B>Note</B>
<DD>TextEdit currently deviates from this model for caret movement in monostyled left-to-right text (displayed in a non-Roman font) on any primary right-to-left script system. On the Arabic script system, for example, it is possible to display the low-ASCII Roman characters from an Arabic font. If a user presses the arrow keys to move through these characters, the caret moves in the opposite direction of the arrow.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 Vertical movement of the caret is less complex. <A NAME=MARKER-2-73></A>When the user presses the Up Arrow key, the caret moves up by one line, even in lines of text containing fonts of different sizes. When the caret is positioned on the first line of an edit record, and the user presses the Up Arrow key, TextEdit moves the caret to the beginning of the text on that line, at primary caret position 0. (This position corresponds to the visible right end of a line when the primary line direction is right to left and to the left end of the line when the primary line direction is left to right.)<P>
 Similarly, when the user presses the Down Arrow key, the caret moves down one line. When the caret is positioned on the last line of an edit record, and the user presses the Down Arrow key, TextEdit moves the caret to the end of the text on that line (that is, the visible left end of a line when the primary line direction is right to left and to the right end of a line when the primary line direction is left to right).<P>
<DL>
<DT><B>Note</B>
<DD>TextEdit does not support the use of modifier keys, such as the Shift key or the Option key, in conjunction with the arrow keys.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 If spaces at the end of a text line extend beyond the view rectangle, TextEdit draws the caret at the edge of the view rectangle, not beyond it. Whether TextEdit displays a caret at the beginning or end of a line when a mouse-down event occurs at a line's end depends on the current caret position and the value in a field (<CODE>clikStuff</CODE>) of the edit record. TextEdit sets this field to reflect whether the most recent mouse-down event occurred on the leading or trailing edge of a glyph.<P>
 For example, if the mouse-down event occurs on the <A NAME=MARKER-2-944></A>leading edge of a glyph, TextEdit displays the caret at the caret position corresponding to the leading edge of that glyph. If the mouse-down event is on the<A NAME=MARKER-2-525></A> trailing edge of a glyph, TextEdit displays the caret at the beginning of the next line. For more information about determining a caret position, see the sections that discuss caret handling in the chapters "Introduction to Text on the Macintosh" and "QuickDraw Text" in this book.<A NAME=MARKER-2-299></A><A NAME=MARKER-2-302></A><P>
<A NAME=HEADING46-26></A>
<H3>Text Alignment</H3>
 TextEdit allows you to specify the alignment of the lines of text, that is, their horizontal placement with respect to the left and right edges of the text area or destination rect<A NAME=MARKER-2-206></A>angle. The different types of alignment that TextEdit supports accommodate script systems that are read from right to left, as well as those that are read from left to right. The types of alignment supported are<P>
<UL>
<LI>default alignment (positions the text according to the line direction of the system script. It can be either left or right. Line direction is the direction in which text in a particular language is written and read. The English language has a rightward, or left-to-right, line direction. Arabic and Hebrew have a [primarily] leftward, or right-to-left, line direction.)
<LI>center alignment (centers each line of text between the left and right edges of the destination rectangle)
<LI>right alignment (positions the text along the right edge of the destination rectangle)
<LI>left alignment (lines up the text with the left edge of the destination rectangle)<P>
</UL>
 If your application requires justified alignment, you can use the QuickDraw routines that support full justification; TextEdit does not support justified alignment. See the chapter "QuickDraw Text" in this book for more information.<A NAME=MARKER-2-25></A><P>
<A NAME=HEADING46-33></A>
<H3>Line Measurement</H3>
 <A NAME=MARKER-2-5></A>TextEdit measures a line of text appropriately for all script systems by removing any trailing white space from the end of it, taking the line direction into account. It uses the QuickDraw <CODE>VisibleLength</CODE> <A NAME=MARKER-2-406></A>function to exclude trailing white space, based on the script system, the text direction, and the primary line direction. For more information about the behavior of <CODE>VisibleLength</CODE> for various script systems, see the chapter "QuickDraw Text" in this book.<P>
 An anomaly exists, however, in the way TextEdit draws at the end of a line. When the primary line direction of a script system is right to left (for instance, on a Hebrew system), when the alignment is left or center, and when<A NAME=MARKER-2-20></A> spaces are entered in a right-to-left font, TextEdit measures spaces at the end of the line and therefore may draw the text beyond the edge of the view rectangle. The caret, however, remains in view and is pinned to the left edge of the view rectangle.<P>
 This anomaly also exists when the primary line direction of a script system is left to right and the alignment is center. In this instance, TextEdit measures spaces at the end of the line, and as more spaces are added (and, therefore, measured), the visible text in the line is drawn out of view beyond the left edge of the view rectangle. The caret, however, remains in view and is pinned to the right edge of the view rectangle.<A NAME=MARKER-2-107></A><P>
<A NAME=HEADING46-37></A>
<H3><A NAME=MARKER-2-82></A>Text Buffering</H3>
 TextEdit uses two methods of text buffering; one method, which is automatic, is used to handle 2-byte characters properly. The other method, which you can enable or disable, improves performance in relation to how TextEdit handles input of 2-byte characters.<P>
 For the first method, which is automatic, TextEdit relies on the Script Manager. The Script Manager handles 2-byte characters properly, and TextEdit takes advantage of this. If a 2-byte character, such as a Kanji character, is typed, TextEdit buffers the first byte until it processes the second byte, at which time it displays the character. The internal buffer that TextEdit uses for a 2-byte character is unique to each edit record. For example, TextEdit can buffer the first byte of a 2-byte character in a record, then the application can call the TextEdit <CODE>TEKey</CODE> procedure for another edit record. While <CODE>TEKey</CODE> processes the character for the second edit record, the first byte of the 2-byte character remains in the first edit record's buffer until TextEdit processes the second byte of that 2-byte character, and then displays the character.<P>
 The second method of text buffering enhances performance, and you can turn it on or off through the TextEdit function, <CODE>TEFeatureFlag</CODE>. In this case, TextEdit uses a global buffer--it differs from the <CODE>TEKe</CODE>y procedure's internal 2-byte buffer--that is used across all active edit records. These records may be in a single application or in multiple applications. Because of this, you should exercise care when you enable the text-buffering capability in more than one active record; otherwise, the bytes that are buffered from one edit record may appear in another edit record.<P>
<UL>
<LI>Ensure that buffering is not turned off in the middle of processing a 2-byte character. To guarantee the integrity of your record, it is important that you wait for an idle event before you disable buffering or enable buffering in a second edit record.
<LI>When text buffering i<A NAME=MARKER-2-44></A>s enabled, ensure that <CODE>TEIdle</CODE> is called before any pause of more than a few ticks--for example, before <CODE>WaitNextEvent</CODE>. A possibility of a long delay before characters appear on the screen exists--especially in non-Roman systems. If you do not call <CODE>TEIdle</CODE>, the characters may end up in the edit record of another application.<P>
</UL>
 If you enable text buffering for performance enhancement on a non-Roman script system and the keyboard has changed, TextEdit flushes the text of the current script from the buffer before buffering characters in the new script<A NAME=MARKER-2-764></A>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-45.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-47.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  

