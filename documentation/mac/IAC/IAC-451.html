<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>StartSecureSession(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING451></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-450.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-452.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-423.html"><B>Chapter 11 - Program-to-Program Communications Toolbox</B></A> / <A HREF="IAC-434.html"><B>PPC Toolbox Reference</B></A><BR><DL><DD><A HREF="IAC-439.html"><B>PPC Toolbox Routines</B></A> / <A HREF="IAC-449.html"><B>Starting and Ending a Session</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING451-0></A>
<H3>StartSecureSession</H3>
 The <CODE>StartSecureSession</CODE> function prompts for user name and password and calls <CODE>PPCStart</CODE>--all in one synchronous procedure call. Use the <CODE>StartSecureSession</CODE> function whenever a port destination requires authentication.<A NAME=MARKER-21-169></A><P>
<PRE>
FUNCTION StartSecureSession (pb: PPCStartPBPtr; 
                             VAR userName: Str32; 
                             useDefault: Boolean; 
                             allowGuest: Boolean; 
                             VAR guestSelected: Boolean; 
                             prompt: Str255): OSErr;
</PRE>
<DL>
<DT><CODE>pb</CODE>
<DD> A pointer to a <CODE>PPCStart</CODE> parameter block.
<DT><CODE>userName</CODE>
<DD> A pointer to a 32-byte character string to be displayed as the user's name.
<DT><CODE>useDefault</CODE>
<DD> A Boolean value that indicates whether you want the <CODE>StartSecureSession</CODE> function to use the default user identity (and possibly prevent the user identity dialog box from appearing). If so, specify <CODE>TRUE</CODE>; otherwise, specify <CODE>FALSE</CODE>.
<DT><CODE>allowGuest</CODE>
<DD> A Boolean value that determines whether the Guest radio button in the user identity dialog box is active (<CODE>TRUE</CODE>) or inactive (<CODE>FALSE</CODE>).
<DT><CODE>guestSelected</CODE>
<DD> Returns <CODE>TRUE</CODE> if the user has logged on as a guest.
<DT><CODE>prompt</CODE>
<DD> A line of text that the dialog box displays in place of the default prompt. Specify <CODE>NIL</CODE> or an empty string to use the default prompt.
</DL>
<A NAME=HEADING451-9></A>
<H5>DESCRIPTION</H5>
 Your program fills out a parameter block just as though it were calling the <CODE>PPCStart</CODE> function. You specify all input fields in the parameter block except for the <CODE>userRefNum</CODE> field. The <CODE>userRefNum</CODE> field is returned when the <CODE>StartSecureSession</CODE> function successfully completes.<P>
 The <CODE>userName</CODE> parameter is a pointer to a 32-byte character string to be displayed as the user's name. If the Pascal string length is 0, the default user name is used. The default user name is the name specified in the Sharing Setup control panel. The default user name is returned in the <CODE>userName</CODE> buffer.<P>
 Set the <CODE>useDefault</CODE> parameter to <CODE>TRUE</CODE> if you want the <CODE>StartSecureSession</CODE> function to use the default user identity (and possibly prevent the user identity dialog box from appearing). The <CODE>allowGuest</CODE> parameter specifies whether the Guest radio button in the user identity dialog box is active. You usually set it to the inverse of the <CODE>authRequired</CODE> field in the port information record. For example, if <CODE>authRequired</CODE> is <CODE>TRUE</CODE>, then <CODE>allowGuest</CODE> should be set to <CODE>FALSE</CODE>.<P>
 The <CODE>guestSelected</CODE> parameter returns <CODE>TRUE</CODE> if the user has logged on as a guest. The <CODE>prompt</CODE> parameter of the <CODE>StartSecureSession</CODE> function allows you to specify a line of text that the dialog box can display. Specify <CODE>NIL</CODE> or an empty string for the <CODE>prompt</CODE> parameter to enable the PPC Toolbox to use the default prompt. The PPC Toolbox uses the default string "Link to &lt;<I>port name</I>&gt; on &lt;<I>object string</I>&gt; as:". The port name is obtained from the name string of the port name, and the object string is obtained from the object string of the location name. <P>
<DL>
<DT><B>Note</B>
<DD>Do not call the <CODE>StartSecureSession</CODE> function from an application that is running in the background, because the function displays several dialog boxes on the user's screen.<EM></EM>   <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
<A NAME=HEADING451-15></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The trap macro and routine selector for the <CODE>StartSecureSession</CODE> function are
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Trap macro<TH>Selector<TR>
<TD>_PPC<TD>$000E</TABLE>
<P>
 The registers on entry and exit for this routine are
<TABLE BORDER="0" CELLPADDING=3><TH colspan=2>Registers on entry<TR>
<TD>A0<TD>Pointer to a <CODE>StartSecureParams</CODE> record<TR>
<TD>D0<TD>Selector code</TABLE>

<TABLE BORDER="0" CELLPADDING=3><TH colspan=2>Registers on exit<TR>
<TD>D0<TD>Result code</TABLE>
<P>
<A NAME=HEADING451-18></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>userCanceledErr<TD>-128<TD>User decided not to conduct a session<TR>
<TD>notInitErr<TD>-900<TD>PPC Toolbox has not been initialized yet<TR>
<TD>nameTypeErr<TD>-902<TD><CODE>locationKindSelector</CODE> is not <CODE>ppcNBPLocation</CODE> or <CODE>ppcNoLocation</CODE><TR>
<TD>noPortErr<TD>-903<TD>Bad port reference number<TR>
<TD>noGlobalsErr<TD>-904<TD>System unable to allocate memory, critical error<TR>
<TD>localOnlyErr<TD>-905<TD>Network activity is currently disabled<TR>
<TD>destPortErr<TD>-906<TD>Port does not exist at destination<TR>
<TD>sessTableErr<TD>-907<TD>PPC Toolbox is unable to create a session<TR>
<TD>noResponseErr<TD>-915<TD>Unable to contact application<TR>
<TD>portClosedErr<TD>-916<TD>The port was closed<TR>
<TD>badPortNameErr<TD>-919<TD>PPC port record is invalid<TR>
<TD>noUserRefErr<TD>-924<TD>Unable to create a new user reference number<TR>
<TD>networkErr<TD>-925<TD>An error has occurred in the network<TR>
<TD>noInformErr<TD>-926<TD><CODE>PPCStart</CODE> failed because target application did not have an inform pending<TR>
<TD>badServiceMethodErr<TD>-930<TD>Service method is other than <CODE>ppcServiceRealTime</CODE><TR>
<TD>guestNotAllowedErr<TD>-932<TD>Destination port requires authentication</TABLE>
</H5>
<A NAME=HEADING451-19></A>
<H5>SEE ALSO</H5>
 For an example of the use of the <CODE>StartSecureSession</CODE> function, see <A HREF=IAC-430.html#MARKER-9-104>"Initiating a PPC Session" beginning on page 11-29</A>. <P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-450.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-452.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
