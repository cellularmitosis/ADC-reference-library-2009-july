<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note PR12: SetLineWidth Revealed</title>                                       <meta name="categories" content="Printing"><meta name="week-posted" content="Oct 26, 1987 - Nov 6, 1987"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002633" title="SetLineWidth Revealed"></a><a name="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxMacOS9Earlier-date.html">Mac OS 9 & Earlier</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/index.html" target="_blank">Reference Library</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note PR12</div>
<div id="pageheadsub">SetLineWidth Revealed</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext">					 <A HREF="#Section1">Introduction</A><BR><BR>					  <A HREF="#References">References</A><BR><BR> <A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><p id="introtext">This technical note describes the internal implementation, and correct methodof using, the <code>SetLineWidth</code> Picture Comment.</p> <!-- end_intro_text --><!-- begin_date --><h3 align=center>[Nov 01 1987]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><a name=Section1></A><h2>Introduction</h2><P>The <code>SetLineWidth</code> picture comment provides a way of accessingPostScript's 'setlinewidth' operator. Since the LaserWriter resolution isroughly four times that of the Macintosh screen, fractional line widths can beprinted. The <code>SetLineWidth</code> PicComment provides a way for applicationsto access these fractional line widths through PostScript, without having touse floating point numbers.</p><p>First of all, the LaserWriter has an internal state that is stored in a numberof PostScript variables. For more information on PostScript variables, see the<i>PostScript Language Reference Manual</i>. Some operations performed on theLaserWriter cause the values of these variables to change. One of thesevariables contains the width of the printer's pen. The <code>SetLineWidth</code>picture comment works by changing the value of this variable.</p><p>Before we look at what the <code>SetLineWidth</code> comment does, let's look atthe argument passed to the comment. The argument is represented as a QuickDrawPoint, however it is interpreted by the LaserWriter as a fraction. TheLaserWriter interprets a <code>point(h,v)</code> to be a real number whose value is<code>(v / h)</code>. This means that a point whose value is h=2, v=1, will beconverted to 0.5 before being used by the LaserWriter. If you wanted to pass avalue of 0.25, you would pass a point whose value is h=4, v=1. For 1.25, pass apoint, h=4, v= 5.</p><p>In addition to the pen width variable, there is a variable that is used forscaling the pen's width. This variable, named <code>pnm</code> for PeN Multiplier,contains a real number which is applied to the pen width. The default value of<code>pnm</code> is 1.0, which causes no scaling of the line width.</p><p>Whenever the <code>SetLineWidth</code> PicComment is sent to the LaserWriter, thecurrent value of <code>pnm</code> is replaced by the value passed to thePicComment. The current pen size is then scaled by the new value of<code>pnm</code>. The following example will display four lines of different sizes.It is meant to illustrate the interaction between the QuickDraw<code>PenSize</code> procedure and the <code>SetLineWidth</code> PicComment.</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>TYPE    widthHdl    = ^widthPtr;    widthPtr    = ^widthPt;    widthPt     = Point;VAR    theWidth:   widthHdl;BEGIN</pre>	</TD></TR></TABLE></CENTER><p>At this point, it is assumed that <code>PrPageOpen</code> has been called, and theprint manager is ready to accept data.</p><p>The first thing we do is set the scaling factor to 1.0. This way, no scalingwill be performed when we call <code>PenSize</code>.</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    theWidth := widthHdl(NewHandle(SizeOf(widthPt)));    (*Real programs do error checking here... *)    SetPt(theWidth^^, 1, 1);</pre>	</TD></TR></TABLE></CENTER><p>Here we call <code>PenSize</code>. Because the <code>pnm</code> has been set to 1.0,the pen size(1,1) times the multiplier (1.0) yields 1,1.</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    PenSize(1, 1);    MoveTo(50, 100);    LineTo(500, 100);    MoveTo(50, 125);</pre>	</TD></TR></TABLE></CENTER><p>Now we will use the <code>SetLineWidth</code> PicComment to change the pen size.Note that when we change the scaling factor, the pen size changes as well.</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    SetPt(theWidth^^, 1, 5);    PicComment(SetLineWidth, SIZEOF(widthPt), Handle(theWidth));    MoveTo(50, 200);    LineTo(500, 200);    MoveTo(50, 225);</pre>	</TD></TR></TABLE></CENTER><p>If any calls to <code>PenSize</code> are made at this point, the new pen size willbe scaled by 5.0. This is because the <code>SetLineWidth</code> PicComment is stillin effect. We will now send a <code>SetLineWidth</code> PicComment to revert thescaling factor back to 1.0.</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    SetPt(theWidth^^, 5, 1);    PicComment(SetLineWidth, SIZEOF(widthPt), Handle(theWidth));    MoveTo(50, 300);    LineTo(500,300);    MoveTo(50, 325);</pre>	</TD></TR></TABLE></CENTER><p>Since the scaling is once again 1.0, <code>PenSize</code> calls at this point willnot be scaled. Here we explicitly set the scaling factor to 1.0 before changingthe pen size. This makes it easier to see what scaling will be applied to thenext call to <code>PenSize</code>.</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    SetPt(theWidth^^, 1, 1);    PicComment(SetLineWidth, SIZEOF(widthPt), Handle(theWidth));    PenSize(1, 1);    MoveTo(50, 400);    LineTo(500,400);    MoveTo(50, 425);    DrawString('1.0 times 1 point pen size = 1 point thickness');    (* Dispose of the handle when you are through with it! *)</pre>	</TD></TR></TABLE></CENTER><p>When printed, the above example will produce the following:</p><P align=center><img src="images/pr_12_001.gif" alt="lines drawn in varying thickness with descriptive text" width=416 height=240></p><p>To summarize, there are four things to remember when using the<code>SetLineWidth</code> PicComment:</p><ol type="1" start="1">	<li>The argument to the <code>SetLineWidth</code> PicComment is specified as a point, though it is actually interpreted by the LaserWriter as a real number. The point value is specified as <code>h,v</code>, and the LaserWriter interprets the value as <code>v / h</code>.</li>	<li>The <code>SetLineWidth</code> PicComment affects both the height and width of the pen, even though the name suggests otherwise.</li>	<li> When you send the <code>SetLineWidth</code> PicComment, the current pen size will be scaled. Any drawing that is done after the PicComment is set, will be done with the scaled pen size.</li>	<li>When you call the QuickDraw <code>PenSize</code> procedure, the pen size will be scaled after it has been set. For example, if your scaling factor is 0.5, and you set the pen size to 2,2, the  actual pen size will be 1,1. If you don't want the scaling to occur, make sure to send a  <code>SetLineWidth</code> PicComment, with the point argument set to 1,1.  The next call to <code>PenSize</code> will then be scaled by 1.0, which will have no effect.</li></ol><P><A HREF="#top">Back to top</A></P><a name="References"></a><h2>References</h2>     <P>LaserWriter Reference Manual</P>     <P>PostScript Language Reference Manual</P>     <P>PostScript Language Tutorial and Cookbook</P>         <P><A HREF="#top">Back to top</A></P>         <a name=Downloads></A>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (80K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/pr_12.pdf">Download</A></P>               </TD>            </TR>                    </TABLE>         <BR></TD></TR></table></center><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/pr/pr_12.html%3Fid%3DDTS10002633-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/pr/pr_12.html%3Fid%3DDTS10002633-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/pr/pr_12.html%3Fid%3DDTS10002633-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>