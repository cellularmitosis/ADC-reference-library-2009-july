<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Factors in Translation(IM: XU)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING23></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="GXEnvironment-22.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="GXEnvironment-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="GXEnvironment-445.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="GXEnvironment-24.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="GXEnvironment-2.html"><B>QuickDraw GX Environment and Utilities</B></A> / <BR><DD><A HREF="GXEnvironment-15.html"><B>Chapter 1 - QuickDraw GX and the Macintosh Environment</B></A> / <A HREF="GXEnvironment-22.html"><B>Using the QuickDraw-to-QuickDraw GX Translator</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING23-0></A>
<H2><A NAME=MARKER-9-59></A>Factors in Translation</H2>
 This section describes some of the factors that influence the translation process, and how you can manipulate them.<P>
<A NAME=HEADING23-2></A>
<H3>Graphics Port and View Port</H3>
 <A NAME=MARKER-2-60></A>The translation from QuickDraw to QuickDraw GX takes into account the current QuickDraw grafPort origin. Therefore, each resulting QuickDraw GX shape incorporates, either in its shape geometry or in its transform mapping, the origin of the graphics port that was active at the time of translation. <B></B><P>
 The QuickDraw GX shape that results from the translation must be associated with a view port. This can be accomplished by<P>
<UL>
<LI>setting the view port for each shape
<LI>setting the view port for the parent picture shape of the individual shapes contained in a picture<A NAME=MARKER-9-11></A> <B></B><P>
</UL>
<A NAME=HEADING23-7></A>
<H3>Scaling During Translation</H3>
 <A NAME=MARKER-2-214></A>The translator allows you to scale the QuickDraw data as it is converted. For example, you can use scaling to convert from a screen resolution of 72 dpi to a printer resolution of 300 dpi. You specify the scaling factor in the form of source and destination rectangles. <P>
 Also, in order to allow the translator to properly scale dash picture comments and other items, you can supply a pair of integer scale factors, which may be different in the x and y directions. The scale factors for both the source and destination rectangles and the pattern-stretch parameters are usually the destination resolution divided by the screen resolution (72 dpi), rounded to the nearest integer. Typical examples are shown in <BR><A HREF=#MARKER-9-1>Table 1-1</A>.
<TABLE BORDER="0" CELLPADDING=3>
<CAPTION><A NAME=MARKER-9-1></A><B>Table 1-1 Translation scaling factors</B></CAPTION>
<TH>Source<TH>Destination<TH>Scale Factor<TR>
<TD>72 <EM></EM> 72<TD>72 <EM></EM> 72<TD>1 <EM></EM> 1<TR>
<TD>72 <EM></EM> 72<TD>72 <EM></EM> 80<TD>1 <EM></EM> 1<TR>
<TD>72 <EM></EM> 72<TD>144 <EM></EM> 144<TD>2 <EM></EM> 2<TR>
<TD>72 <EM></EM> 72<TD>150 <EM></EM> 150<TD>2 <EM></EM> 2<TR>
<TD>72 <EM></EM> 72<TD>300 <EM></EM> 300<TD>4 <EM></EM> 4<A NAME=MARKER-2-2></A></TABLE>
<P>
<A NAME=HEADING23-10></A>
<H3>Translation Options</H3>
 <A NAME=MARKER-2-179></A>When you translate QuickDraw data to QuickDraw GX shapes, you specify one or more <B>translation options.</B> You can use either the default translation option provided by QuickDraw GX or a combination of the other available options. Some translation options provide simpler and faster translations, but with a resulting loss of pixel-for-pixel matching. <A HREF=#MARKER-9-3>Table 1-2</A> lists and describes the available translation options; the constants are defined in the gxTranslationOptions <A NAME=MARKER-2-283></A>enumeration. 
<TABLE BORDER="0" CELLPADDING=3>
<CAPTION><A NAME=MARKER-9-3></A><B>Table 1-2 Translation options settings</B> </CAPTION>
<TH>Constant<TH>Value<TH>Explanation<TR>
<TD><A NAME=MARKER-4-4></A>gxDefaultOptionsTranslation<TD>0x0000<TD>This is the default setting used for translation. This option generates the most accurate representation of the QuickDraw data that the translator is capable of producing. <TR>
<TD><A NAME=MARKER-4-5></A>gxOptimizedTranslation<TD>0x0001<TD>This option allows for optimizations to be applied during translation. For example, a sequence of QuickDraw lines can be combined into one polygon. In most cases, this results in the generation of a smaller number of QuickDraw GX shapes.<TR>
<TD><A NAME=MARKER-4-6></A>gxReplaceLineWidthTranslation<TD>0x0002<TD>The width of a resulting QuickDraw GX line is the average of the original pen's width and height. This option also affects the way in which the SetLineWidth <CODE>PicComment</CODE> is interpreted. The LaserWriter driver scales the current line width with the newly specified picture comment. The translator normally uses the LaserWriter mechanism. When you specify this option, the translator uses a mechanism in which the line is replaced with the newly specified width; this mimics the behavior of the LaserWriter SC driver.<TR>
<TD><A NAME=MARKER-4-7></A>gxSimpleScalingTranslation<TD>0x0004<TD>This option causes the translator to scale data from source resolution to destination resolution by using a simple multiplication, which is incorporated into the shape's transform. The translator makes no attempt to compensate for this increase in resolution. The resulting scaled image will not render the original QuickDraw data accurately, but will be similar to what QuickDraw would have produced when it attempted to scale the data. <TR>
<TD><A NAME=MARKER-4-8></A>gxSimpleGeometryTranslation<TD>0x0008<TD>This option results in a translation of QuickDraw data without taking into account the QuickDraw hanging pen. Normally the translator reproduces a QuickDraw triangle, for example, as a 6-sided or 7-sided polygon. This option sacrifices accuracy in order to produce an image that draws faster with QuickDraw GX and can be more useful for pen-based output devices. For example, QuickDraw lines become QuickDraw GX lines with flat endcaps. This option also turns on the simple lines translation and the simple scaling translation.<TR>
<TD><A NAME=MARKER-4-9></A>gxSimpleLinesTranslation<TD>0x000C<TD>This option results in simple geometry and scaling. The translator maintains the width of lines that are at an angle. Because QuickDraw uses a hanging pen, a diagonal line appears to be thicker than a horizontal or vertical line with the same pen size. Using this option causes the line width to be the same as the pen width, at the expense of the accuracy of the original QuickDraw data. This option also turns on the simple scaling translation and the simple geometry translation.<TR>
<TD><A NAME=MARKER-4-10></A>gxLayoutTextTranslation<TD>0x0010<TD>Normally the translator turns off layout-shape-specific capabilities when translating QuickDraw text into layout shapes. This option restores layout features such as default glyph substitutions. This results in a more attractive text; however it can be different from the original QuickDraw data.<TR>
<TD><A NAME=MARKER-4-11></A>gxRasterTargetTranslation<TD>0x0020<TD>This option causes PostScript picture comments to be discarded. The bitmap proxies sent along with such comments are preserved.<TR>
<TD><A NAME=MARKER-4-12></A>gxPostScriptTargetTranslation<TD>0x0040<TD>This option causes PostScript picture comments to be incorporated as tags attached to picture shapes. The bitmap proxies sent along with such comments are discarded. <TR>
<TD><A NAME=MARKER-4-13></A>gxVectorTargetTranslation<TD>0x0080<TD>This option causes PostScript picture comments to be discarded. The bitmap proxies sent along with such comments are preserved. Also, when this option is combined with the option <CODE>gxOptimizedTranslation</CODE>, lines are preserved and not combined in thick framed polygons. <A NAME=MARKER-2-121></A></TABLE>
<P>
<A NAME=HEADING23-12></A>
<H3>How Option Settings Affect Translation of Lines</H3>
 <A NAME=MARKER-2-65></A>The translation of QuickDraw lines is affected by the translation options setting you choose. Consider the simple line generated by the QuickDraw commands given in <A HREF=#MARKER-9-66>Listing 1-2</A>.<P>
<B>Listing 1-2  <A NAME=MARKER-9-66></A>QuickDraw commands to draw a simple line</B><P>
<PRE>
PenSize(5, 3);
MoveTo(100, 40);
LineTo(120, 70);
</PRE>
 The QuickDraw commands in <A HREF=#MARKER-9-66>Listing 1-2</A> produce the line shown in <A HREF=#MARKER-9-67>Figure 1-2</A>.<P>
<B>Figure 1-2  <A NAME=MARKER-9-67></A>A QuickDraw line[Missing image]</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/EU-L-02.jpg"><p>
 The <CODE>gxDefaultOptionsTranslation</CODE> setting produces the best replication of the original QuickDraw picture. However, it is also the slowest translation. If you use the <CODE>gxDefaultOptionsTranslation</CODE> setting for the translation of the original QuickDraw line shown in <A HREF=#MARKER-9-67>Figure 1-2</A>, the resulting QuickDraw GX polygon shape mimics the QuickDraw hanging pen. Furthermore, any scaling between the source and destination rectangles is incorporated into the translated shape's geometry. The original QuickDraw line would be translated to the QuickDraw GX shape shown in <A HREF=#MARKER-9-68>Figure 1-3</A>.<P>
<B>Figure 1-3  <A NAME=MARKER-9-68></A>Translation of the QuickDraw line using <CODE>gxDefaultOptionsTranslation</CODE>[Missing image]</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/EU-L-04.gif"<p>
 If you use the <CODE>gxSimpleGeometryTranslation</CODE> option setting, the resulting QuickDraw GX line shape runs along the center of the original QuickDraw line and covers all the pixels of the QuickDraw line and more; it is a superset. The resulting QuickDraw GX shape looks like the line shape shown in <A HREF=#MARKER-9-69>Figure 1-4</A>.<P>
<B>Figure 1-4  <A NAME=MARKER-9-69></A>Translation of the QuickDraw line using <CODE>gxSimpleGeometryTranslation</CODE>[Missing image]</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/EU-L-05.gif"><p>
 If you use the <CODE>gxReplaceLineWidthTranslation</CODE> option setting, the resulting QuickDraw GX line shape has a width that is the average of the QuickDraw pen width and height. The line runs along the center of the original QuickDraw line between the extreme pixels at each end of the original QuickDraw line. The translation results in the QuickDraw GX shape shown in <A HREF=#MARKER-9-70>Figure 1-5</A>.<P>
<B>Figure 1-5  <A NAME=MARKER-9-70></A>Translation of the QuickDraw <A NAME=MARKER-9-22></A>line using <CODE>gxReplaceLineWidthTranslation</CODE>[Missing image]</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/EU-L-03.gif"><p>
<A NAME=HEADING23-28></A>
<H3>Translation of Fill Patterns</H3>
 <A NAME=MARKER-2-103></A>The QuickDraw-to-QuickDraw GX translator converts those 8-bit <EM></EM> 8-bit QuickDraw fill patterns that are commonly used to represent gray patterns to colors that are blends of the foreground and background colors. In the case of QuickDraw black-and-white patterns, a uniform grayscale shade that ranges from 0 to 100 percent black is produced, depending on the overall apparent density of the original pattern, as shown in <A HREF=#MARKER-9-73>Figure 1-6</A>.<P>
<B>Figure 1-6  <A NAME=MARKER-9-73></A>Conversion of standard <A NAME=MARKER-9-20></A>QuickDraw fill patterns to QuickDraw GX shape fills[Missing image]</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/EU-L-06.jpg"><p>
<A NAME=HEADING23-32></A>
<H3>Translation of QuickDraw Picture Comments </H3>
 <A NAME=MARKER-9-103></A>The capabilities of QuickDraw GX exceed those of QuickDraw. This means that a picture comment (<CODE>picComment</CODE>) can be incorporated into the translated shapes as part of the conversion process. With QuickDraw alone, picture comments can only be seen when the picture is printed, because the comments are interpreted at the printer level.<P>
 It is common practice for developers to include QuickDraw drawing commands (usually one or more <B>bitmaps</B>) within a picture comment as a proxy that provides an alternate representation of the picture comment. That way, if the <CODE>picComment</CODE> is not supported by a printer, some output--although at a lower resolution-- is produced.<P>
 When processing a picture comment, the QuickDraw-to-QuickDraw GX translator typically discards the QuickDraw proxy and applies the <CODE>picComment</CODE> to the object--for example, by rotating the shape's transform or setting a dash in the shape's style. When processing PostScript picture comments, however, the translator creates a picture shape that contains QuickDraw GX <B>shape objects</B> (based on the QuickDraw proxies) as well as <B>tag objects</B> (containing the PostScript data). In this way, QuickDraw GX can render the picture both on a raster device (by drawing the items in the picture shape) and on a PostScript device (by applying the information in the tag objects).<P>
 Sample code for applying a <CODE>picComment</CODE> for rotation is shown in <A HREF=#MARKER-9-76>Listing 1-3</A>.<P>
<B>Listing 1-3  <A NAME=MARKER-9-76></A>QuickDraw picture data that includes a <CODE>picComment</CODE></B><P>
<PRE>
RotComHandle   rInfo = NewHandle(sizeof(RotComRecord));

(*rInfo)-&gt;rFlip = 0
(*rInfo)-&gt;rAngle = 90;

MoveTo(100,100);
PicComment(RotateBegin, sizeof(RotComRecord), (Handle)rInfo);
LineTo(100, 200);
PicComment(RotateEnd, 0, nil);
</PRE>
 The output of the sample code in <A HREF=#MARKER-9-76>Listing 1-3</A> is shown in <A HREF=#MARKER-9-77>Figure 1-7</A>. Notice that the QuickDraw screen output is not rotated. This is because QuickDraw picture comments are interpreted by the printer. In contrast, the printed QuickDraw output and the translated QuickDraw GX shape (both printed and displayed onscreen) correctly represent the intent of the original QuickDraw data.<P>
<B>Figure 1-7  <A NAME=MARKER-9-77></A>Translating QuickDraw data containing a <A NAME=MARKER-9-279></A>rotation <CODE>picComment</CODE>[Missing image]</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/EU-L-01.jpg"><p>
<A NAME=HEADING23-42></A>
<H3>Translation Statistics</H3>
 <A NAME=MARKER-2-186></A>The translator keeps various statistics about the QuickDraw picture data that it translates. You can examine these statistics after the translation if you are interested in this information. The statistics information is returned in the form of bit flags, as shown in <A HREF=#MARKER-9-15>Table 1-3</A>.
<TABLE BORDER="0" CELLPADDING=3>
<CAPTION><A NAME=MARKER-9-15></A><B>Table 1-3 Translation statistics options</B> </CAPTION>
<TH>Constant<TH>Value<TH>Explanation<TR>
<TD><A NAME=MARKER-4-16></A>gxContainsFormsBegin<TD>0x0001<TD>The data that was translated contained "<CODE>formsBegin</CODE>" picture comments.<TR>
<TD><A NAME=MARKER-4-17></A>gxContainsFormsEnd<TD>0x0002<TD>The data that was translated contained "<CODE>formsEnd</CODE>" picture comments.<TR>
<TD><A NAME=MARKER-4-18></A>gxContainsPostScript<TD>0x0004<TD>The data that was translated contained PostScript picture comments.<TR>
<TD><A NAME=MARKER-4-19></A>gxContainsEmptyPostScript<TD>0x0008<TD>The data that was translated contained PostScript picture comments in which there was no actual PostScript data.<A NAME=MARKER-2-142></A></TABLE>
<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="GXEnvironment-22.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="GXEnvironment-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="GXEnvironment-445.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="GXEnvironment-24.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="GXEnvironment-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
