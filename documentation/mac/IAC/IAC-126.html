<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Interacting With the User(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING126></A>


<!-- Top of Header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- Bottom of Header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-125.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-127.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-115.html"><B>Chapter 4 - Responding to Apple Events</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING126-0></A>
<H1><A NAME=MARKER-9-408></A><A NAME=MARKER-21-409></A>Interacting With the User</H1>
 When your application receives an Apple event, it may need to interact with the user. For example, it may need to display a dialog box asking the user for additional information or confirmation. You must use the <CODE>AEInteractWithUser</CODE> function to make sure your application is in the foreground before it actually interacts with the user. <P>
 Both the client application and the server application specify their preferences for user interaction.<A NAME=MARKER-2-198></A><A NAME=MARKER-2-20></A><A NAME=MARKER-9-286></A> The <CODE>AEInteractWithUser</CODE> function checks the user interaction preferences set by each application. If both the client and the server allow user interaction, <CODE>AEInteractWithUser</CODE> usually posts a notification request, and the Notification Manager brings the server to the foreground after the user responds to the notification request. <P>
 The <CODE>AEInteractWithUser</CODE> function can also bring the server application directly to the foreground, but only if the client application is the active application on the same computer and has set two flags in the <CODE>sendMode</CODE> parameter of the <CODE>AESend</CODE> function: the <CODE>kAEWaitReply</CODE> flag, which indicates that it is waiting for a reply, and the <CODE>kAECanSwitchLayer</CODE> flag, which indicates that it wants the server application to come directly to the foreground rather than posting a notification request.<P>
 To specify its preferences for how the server application should interact with the user, the client application sets various flags in the <CODE>sendMode</CODE> parameter to <CODE>AESend</CODE>. The Apple Event Manager sets the corresponding flags in the <CODE>keyInteractLevelAttr</CODE> attribute of the Apple event.<A NAME=MARKER-2-258></A><A NAME=MARKER-2-247></A><P>
 The server application sets its preferences with the <CODE>AESetInteractionAllowed</CODE> function. This function lets your application specify whether it allows interaction with the user as a result of receiving an Apple event from itself; from itself and other processes on the local computer; or from itself, local processes, and processes from another computer on the network.<P>
 Your application calls the <CODE>AEInteractWithUser</CODE> function before interacting with the user. If <CODE>AEInteractWithUser</CODE> returns the <CODE>noErr</CODE> result code, then your application is currently in the front and free to interact with the user. If <CODE>AEInteractWithUser</CODE> returns the <CODE>errAENoUserInteraction</CODE> result code, the conditions didn't allow user interaction and your application should not interact with the user.<P>
 The rest of this section explains how to set user interactions for the client and server applications and the practical effect these settings have when a server needs to interact with a user.<P>
<HR>
<B>Subtopics</B>
<B><!-- TOC --><DL>
<DL>
<DT><A HREF="IAC-127.html#HEADING127-0">Setting the Client Application's User Interaction Preferences</A>
<DD>
<DT><A HREF="IAC-128.html#HEADING128-0">Setting the Server Application's User Interaction Preferences</A>
<DD>
<DT><A HREF="IAC-129.html#HEADING129-0">Requesting User Interaction</A>
<DD>
</DL>
</DL>
</B>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-125.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-127.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
