<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Defining Terminology for Use by the AppleScript Component(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING300></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-299.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-301.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-299.html"><B>Chapter 8 - Apple Event Terminology Resources</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING300-0></A>
<H1><A NAME=MARKER-9-15></A><A NAME=MARKER-9-16></A>Defining Terminology for Use by the AppleScript Component</H1>
 <A NAME=MARKER-2-301></A>You should keep two principles in mind when you are defining the Apple event object hierarchy and corresponding terminology for your application:<A NAME=MARKER-2-18></A> <A NAME=MARKER-2-19></A><P>
<UL>
<LI>Avoid defining new Apple events unless absolutely necessary. For example, instead of defining a custom Find event, use the Get Data event with whose tests. (For more information about whose tests, see the chapter "Resolving and Creating Object Specifier Records" in this book.)
<LI>Use existing object classes, or if you must define your own, define them in a general fashion.<P>
</UL>
 This section describes how the terms you specify in your application's <CODE>'aete'</CODE> resource are used in AppleScript statements that control your application. Before you implement the Apple event object hierarchy for your application, try out your proposed user terminology in AppleScript statements that use the standard syntax forms described here. This will help you discover some of the advantages and disadvantages of both your proposed object hierarchy and the human-language terminology you are planning to use.<P>
 Some AppleScript commands, such as <CODE>if</CODE>, <CODE>repeat</CODE>, and <CODE>tell</CODE>, are executed directly by the AppleScript component and do not correspond to Apple events. Other commands trigger Apple events when the AppleScript component evaluates them.
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>AppleScript<BR>command<TH>Corresponding <BR>Apple event<TR>
<TD>open<TD>Open<TR>
<TD>close<TD>Close<TR>
<TD>save<TD>Save<TR>
<TD>move<TD>Move<TR>
<TD>delete<TD>Delete<TR>
<TD>set<TD>Set Data</TABLE>
<P>
 The AppleScript component interprets the terms used in scripts according to rules defined by the AppleScript language. For example, the <CODE>open</CODE> command must be followed by an argument that specifies the objects to open, and the <CODE>save</CODE> command must be followed by an argument that specifies the objects to save. The AppleScript component uses the information in an application's <CODE>'aete'</CODE> resource to map the human-language terms used in these arguments to specific Apple event keywords and codes, so that it can construct object specifier records that describe the objects on which the Open and Save events act. <P>
 In general, the syntax for AppleScript commands that trigger Apple events follows this pattern: <P>
 <I>event name expression parameter name expression . . . parameter name expression</I><P>
 The underlined terms are supplied by the AppleScript component's <CODE>'aeut'</CODE> resource, by the application's <CODE>'aete'</CODE> resource, or by the <CODE>'aeut'</CODE> resource available on the current computer. The argument that follows <I>event name</I> corresponds to the direct parameter for the event, if there is one. Each subsequent argument corresponds to an additional parameter. <P>
 An argument that corresponds to a direct parameter can use any of the syntax forms shown in <A HREF=#MARKER-9-1>Table 8-1</A>. These forms correspond to the key forms that can be used to identify the key data in an object specifier record.
<TABLE BORDER="0" CELLPADDING=3>
<CAPTION><A NAME=MARKER-9-1></A><B>Table 8-1 Syntax for AppleScript arguments that correspond to direct parameters</B></CAPTION>
<TH>Syntax of argument<TH>AppleScript example<TH>Key form<TR>
<TD><I>property name<EM> </EM></I><TD>the font<TD>formPropertyID<TR>
<TD><I>class name expression</I> <TD>table "Fred"<BR>table 4<TD>formName<BR>formAbsolutePosition<TR>
<TD><EM>class name</EM> <CODE>before | after</CODE> <I>expression</I> <TD>word after table 2<TD>formRelativePosition<TR>
<TD><EM>class name <I>expression</I></EM> <CODE>thru</CODE> <I>expression</I><TD>words 1 thru 30<TD>formRange<TR>
<TD><CODE>every</CODE> <EM>class name</EM> <CODE>whose</CODE> <I>expression</I><TD>every word whose\xA8<BR>  font = "Palatino"<TD>formWhose<TR>
<TD><I>expression</I> of <I>expression</I> <TD>first row of\xA8<BR>  table "Fred"<TD>Any key form; sets container for elements or properties</TABLE>
<P>
 If the Apple event object hierarchy for your application requires you to specify terms in your <CODE>'aete'</CODE> resource that are not included in the <CODE>'aeut'</CODE> resource, make sure those terms read naturally when they appear in AppleScript statements that use the syntax shown in <A HREF=#MARKER-9-1>Table 8-1</A>. Any of the underlined terms in the table may be supplied by your application's <CODE>'aete'</CODE> resource.<P>
 For example, in the AppleScript statement <P>
 <CODE>copy</CODE> <I>name</I> <CODE>to</CODE> <I>expression</I><P>
 the argument <I>name</I> corresponds to a direct parameter that can use any of the syntax variations shown in <A HREF=#MARKER-9-1>Table 8-1</A>. The word <CODE>to</CODE> and the expression that follows it correspond to an additional parameter that describes the location to which to copy the objects described by the direct parameter.<P>
 <A NAME=MARKER-9-20></A><A NAME=MARKER-2-21></A>Many AppleScript commands, including the <CODE>copy</CODE> command, take additional arguments that correspond to <B>insertion location descriptor records</B>, which are descriptor records of type <CODE>typeInsertionLoc</CODE> defined as part of the Core suite. An insertion location descriptor record is a coerced AE record that consists of two keyword-specified descriptor records with the following keywords:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Keyword<TH>Description<TR>
<TD>keyAEObject<TD>An object specifier record that identifies a single container<A NAME=MARKER-2-3></A><TR>
<TD>keyAEPosition<TD>A constant that specifies where to put the Apple event object described in an Apple event's direct parameter in relation to the container specified in the descriptor record with the keyword <CODE>keyAEObject</CODE> <A NAME=MARKER-2-4></A></TABLE>
<P>
 You can specify one of these constants for the data in a descriptor record identified by the keyword <CODE>keyAEPosition</CODE>:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Constant<TH>Meaning<TR>
<TD>kAEBefore<TD>Before the container <A NAME=MARKER-2-5></A><TR>
<TD>kAEAfter<TD>After the container<A NAME=MARKER-2-6></A><TR>
<TD>kAEBeginning<TD>In the container and before all other elements of the same class as the object being inserted<A NAME=MARKER-2-7></A> <TR>
<TD>kAEEnd<A NAME=MARKER-2-8></A><TD>In the container and after all other objects of the same class as the object being inserted<A NAME=MARKER-2-9></A><TR>
<TD>kAEReplace<TD>Replace the container<A NAME=MARKER-2-10></A></TABLE>
<P>
 The syntax that corresponds to an insertion descriptor record can take any of the forms shown in <A HREF=#MARKER-9-2>Table 8-2</A>.
<TABLE BORDER="0" CELLPADDING=3>
<CAPTION><A NAME=MARKER-9-2></A><B>Table 8-2 Syntax for AppleScript arguments that correspond to insertion location descriptor records</B></CAPTION>
<TH>Syntax of argument<TH>AppleScript example<TH><CODE>keyAEPosition</CODE> constant<TR>
<TD><CODE>before | after</CODE> <I>expression</I><TD>before Figure 1<TD>kAEBefore | kAEAfter<TR>
<TD><CODE>beginning of | end of</CODE> <I>expression</I><TD>end of window 2<TD>kAEBeginning | kAEEnd<TR>
<TD><I>expression</I><TD>Figure 1<TD>kAEReplace</TABLE>
<P>
 For example, in the AppleScript statement <P>
<PRE>
copy Chart 1 of document &quot;Sales Chart&quot; to before Figure 1
</PRE>
 the term <CODE>copy</CODE> corresponds to a Clone event, and <CODE>Chart 1 of document "Sales Chart"</CODE> corresponds to the direct parameter for the Clone event. The term <CODE>to</CODE> is the human-language name specified by the <CODE>'aeut'</CODE> resource for the additional parameter identified by the keyword <CODE>kAEInsertHere</CODE>, which always consists of an insertion location descriptor record. The term <CODE>before</CODE> corresponds to the constant <CODE>kAEBefore</CODE> in the descriptor record identified by the keyword <CODE>keyAEPosition</CODE>, and <CODE>Figure 1</CODE> corresponds to the object specifier record identified by the keyword <CODE>keyAEObject</CODE>. <P>
 The AppleScript component handles statements that describe the replacement of one object with another differently from statements that specify an insertion location before, after, at the beginning of, or at the end of an object. <P>
 For example, in the statement<P>
<PRE>
copy Chart 1 of document &quot;Sales Chart&quot; to Figure 1
</PRE>
 the term <CODE>to</CODE> is the human-language name for the additional parameter identified by the keyword <CODE>kAEInsertHere</CODE>. When <CODE>to</CODE> is followed immediately by an element expression like <CODE>Figure 1</CODE>, the Clone Apple event sent by the AppleScript component includes an additional parameter that consists of an object specifier record for Figure 1. When your application requests the parameter as an insertion location descriptor record, a system coercion handler installed by the AppleScript component converts the object specifier record to an insertion location descriptor record that specifies <CODE>kAEReplace</CODE> in the descriptor record identified by the keyword <CODE>keyAEPosition</CODE>.<P>
 If your application defines any extensions to the standard Apple events or object classes that require the use of insertion locations, use standard insertion location descriptor records to specify them, and make sure your Apple event object hierarchy and the corresponding human terminology in your <CODE>'aete'</CODE> resource allow the AppleScript component to translate insertion location descriptor records into meaningful statements in an AppleScript dialect. <P>
 Unlike most other AppleScript commands, the <CODE>copy</CODE> command causes the AppleScript component to send different Apple events under different circumstances. In the examples just discussed, the <CODE>copy</CODE> command corresponds to a Clone event. However, after evaluating the statements<P>
<PRE>
tell application &quot;SurfWriter&quot;
      copy table &quot;Summary of Sales&quot; of document\xA8
         &quot;Sales Report&quot; to Totals
end tell
</PRE>
 the AppleScript component sends a Get Data event and sets the variable <CODE>Sales91</CODE> to the value of the returned data; and the statements<P>
<PRE>
tell application &quot;SurfCharter&quot;
      copy Totals to Chart 1 of document &quot;Sales Chart&quot;
end tell
</PRE>
 cause the AppleScript component to send a Set Data event that sets the data in the specified chart to the value of the variable <CODE>Totals</CODE>.<P>
 All scriptable applications should support the Get Data, Set Data, and Clone events for all Apple event objects that a user might want to manipulate from a script with the <CODE>copy</CODE> command. Scriptable applications should also support the other core events and any appropriate functional-area events.<P>
 If you find it difficult to come up with meaningful AppleScript statements based on your proposed implementation of Apple events, you may need to rethink your implementation. <A NAME=MARKER-2-204></A> <A NAME=MARKER-2-23></A> <A NAME=MARKER-9-238></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-299.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-301.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
