<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Document-Based Applications Overview: The Roles of Key Objects in Document-Based Applications</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="The Roles of Key Objects in Document-Based Applications"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20000025" title="The Roles of Key Objects in Document-Based Applications"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../DesignGuidelines-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000556" target="_top">Design Guidelines</a> &gt; <a href="../index.html" target="_top">Document-Based Applications Overview</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="OverviewDocArchitecture.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../Tasks/ImplementingDocApp.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/20000025-BBCJCGHA" title="The Roles of Key Objects in Document-Based Applications"></a><hr /><H1>The Roles of Key Objects in Document-Based Applications</H1><p>Instances of the three major classes in the document architecture play distinct but cooperating roles, as described in this article.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="RolesOfDocObjects.html#//apple_ref/doc/uid/20000025-1055733">The Role of NSDocumentController</a>
				
			<br/>
			
        
			
			
				<a href="RolesOfDocObjects.html#//apple_ref/doc/uid/20000025-1055677">The Role of NSDocument</a>
				
			<br/>
			
        
			
			
				<a href="RolesOfDocObjects.html#//apple_ref/doc/uid/20000025-997446">The Role of NSWindowController</a>
				
			<br/>
			
        
			
			
				<a href="RolesOfDocObjects.html#//apple_ref/doc/uid/20000025-DontLinkElementID_10">Typical Usage Patterns</a>
				
			<br/>
			
        
			
			
				<a href="RolesOfDocObjects.html#//apple_ref/doc/uid/20000025-DontLinkElementID_11">Documents and Scripting</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/20000025-1055733" title="The Role of NSDocumentController"></a><h2>The Role of NSDocumentController</h2><p>The primary job of an application’s <a name="//apple_ref/doc/uid/20000025-DontLinkElementID_66"></a><code>NSDocumentController</code> object is to create and open documents, and to track and manage those documents. When a user chooses New from the File menu, an <code>NSDocumentController</code> object gets the appropriate <code>NSDocument</code> subclass from the <code>CFBundleDocumentTypes</code> property in the application’s information property list, allocates an instance of this class, and initializes this instance by invoking the <code>NSDocument</code> method <a name="//apple_ref/doc/uid/20000025-DontLinkElementID_67"></a> <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/initWithType:error:" target="_top">initWithType:error:</a></code>. When the user chooses Open from the File menu, the <code>NSDocumentController</code> object displays the Open panel, gets the user’s selection, finds the <code>NSDocument</code> subclass for the file (based on its document type information), allocates an instance of this class, and initializes the object and loads document data by invoking the <code>NSDocument</code> method <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/initWithContentsOfURL:ofType:error:" target="_top">initWithContentsOfURL:ofType:error:</a></code><a name="//apple_ref/doc/uid/20000025-DontLinkElementID_68"></a>. In both cases, the <code>NSDocumentController</code> object adds a reference to the document object to an internal list to facilitate the management of its documents. It has a notion of the current document as the document whose window is currently main. (The foremost application window that is the focus of the user’s attention is called the main window.)</p><p>The <code>NSDocumentController</code> object manages the Open Recent menu for the application, maintaining a list of the URLs of documents the application has recently handled. It notes recent documents during the opening, saving, reverting, and closing of documents.</p><p><code>NSDocumentController</code> is hard-wired to respond appropriately to certain application <a name="//apple_ref/doc/uid/20000025-DontLinkElementID_69"></a>events, such as when the application starts up, when it terminates, when the system is shutting down, and when documents are opened or printed from the Finder. If you wish, you can make a custom object the application delegate and implement the delegate methods invoked as a result of the same events, and these methods will be invoked instead. However, the default <code>NSDocumentController</code> object is an adequate application controller for most situations, and typically you should not need to subclass it. If you require additional behavior, such as displaying About panels and handling application preferences, you can have a custom controller object perform these duties rather than a subclass of <code>NSDocumentController</code>. Nonetheless, it is possible to subclass <code>NSDocumentController</code> if necessary, as described in <span class="content_text"><a href="../Tasks/SubclassController.html#//apple_ref/doc/uid/20000953-BCIJGBIF">“Creating a Subclass of NSDocumentController.”</a></span></p><a name="//apple_ref/doc/uid/20000025-1055677" title="The Role of NSDocument"></a><h2>The Role of NSDocument</h2><p>The primary job of an <a name="//apple_ref/doc/uid/20000025-DontLinkElementID_70"></a><code>NSDocument</code> object is to represent, manipulate, store, and load the persistent data associated with a document. As such it is a model-controller. Based on the document types it claims to understand (as specified in the <code>CFBundleDocumentTypes</code> property of the application’s information property list), a document must be prepared to:</p><ul class="ul"><li class="li"><p>Provide the data displayed in windows (and represented internally) in a supported document type.</p></li><li class="li"><p>Store document data in a file at a specified location in the file system.</p></li><li class="li"><p>Read document data stored in a file.</p></li></ul><p>With the assistance of its window controllers, an <code>NSDocument</code> object manages the display and capture of the data in its windows. By some special hard-wiring of the Application Kit, the <code>NSDocument</code> object associated with the key window is the recipient of first-responder action messages when users save, print, revert, and close documents. In response to the appropriate action, it knows how to run and manage the Save panel and the Page Layout panel.</p><p>A fully implemented <code>NSDocument</code> object knows how to track its edited status, print document data, and perform undo and redo operations. Although these behaviors aren’t completely provided by default, the <code>NSDocument</code> object does assist the developer in implementing each. For edited-status tracking, the <code>NSDocument</code> object provides an API for updating a change counter. For undo/redo operations, the <code>NSDocument</code> object by default lazily creates an <code>NSUndoManager</code> instance when one is requested, responds appropriately to Undo and Redo menu commands, and updates the change counter when undo and redo operations are performed. For printing, the <code>NSDocument</code> object facilitates the display of the Page Layout panel and the subsequent modification of the <code>NSPrintInfo</code> object used in printing.</p><a name="//apple_ref/doc/uid/20000025-997446" title="The Role of NSWindowController"></a><h2>The Role of NSWindowController</h2><p>An <a name="//apple_ref/doc/uid/20000025-DontLinkElementID_71"></a><code>NSWindowController</code> object manages one window associated with a document, which is usually stored in a nib file. As such it is a view-controller. If a document has multiple windows, each window has its own window controller. For example, a document might have a main data-entry window and a window listing records for selection; each window would have its own <code>NSWindowController</code> object. When requested by its owning <code>NSDocument</code> object, an <code>NSWindowController</code> object loads the nib file containing a window and displays it. It also assumes responsibility for closing windows properly (after ensuring that the data they display is saved).</p><p>The <code>NSWindowController</code> class offers additional behavior to document-based applications, such as cascading document windows in relation to each other, so they don’t completely obstruct one another.</p><p>Subclasses of <code>NSWindowController</code> are optional. Applications can often use the default instance. Subclasses can augment <code>NSWindowController</code> to perform different nib-loading and setup tasks or to customize the titles of windows.</p><a name="//apple_ref/doc/uid/20000025-DontLinkElementID_10" title="Typical Usage Patterns"></a><h2>Typical Usage Patterns</h2><p>This section describes three ways to use the document architecture, starting with the simplest and proceeding to the most complex.</p><p>The simplest way to use the document architecture is appropriate for documents that have only one window and are simple enough that there isn’t much benefit in splitting the controller layer into a model-controller and a view-controller. In this case, you need only to create a subclass of <code>NSDocument</code>. The <code>NSDocument</code> subclass provides storage for the model and the ability to load and save document data. It also has any outlets and actions required for the user interface. It overrides <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/windowNibName" target="_top">windowNibName</a></code> to return the nib file name used for documents of this type. The <code>NSDocument</code> object automatically creates an <code>NSWindowController</code> object to manage that nib file, but the <code>NSDocument</code> object serves as the nib file's owner.</p><p>If your document has only one window, but it is complex enough that you’d like to split up some of the logic in the controller layer, you can subclass <code>NSWindowController</code> as well as <code>NSDocument</code>. In this case, any outlets and actions and any other behavior that is specific to the management of the user interface goes into the <code>NSWindowController</code> subclass. Your <code>NSDocument</code> subclass must override <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/makeWindowControllers" target="_top">makeWindowControllers</a></code> instead of <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/windowNibName" target="_top">windowNibName</a></code>. The <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/makeWindowControllers" target="_top">makeWindowControllers</a></code> method should create an instance of your <code>NSWindowController</code> subclass and add it to the list of managed window controllers with <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/addWindowController:" target="_top">addWindowController:</a></code>. The <code>NSWindowController</code> object should be the file’s owner for the nib file because this creates better separation between the view-related logic and the model-related logic. This approach is recommended for all but the simplest cases.</p><p>If your document requires or allows multiple windows for a single document, you should subclass <code>NSWindowController</code> as well as <code>NSDocument</code>. In your <code>NSDocument</code> subclass you override <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/makeWindowControllers" target="_top">makeWindowControllers</a></code> just as in the second procedure described above. However, in this case you might create more than one instance of <code>NSWindowController</code>, possibly from different subclasses of <code>NSWindowController</code>. Some applications need several different windows to represent one document. Therefore you probably need several different subclasses of <code>NSWindowController</code> and you must create one of each in <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/makeWindowControllers" target="_top">makeWindowControllers</a></code>. Some applications need only one window for a document but want to allow the user to create several copies of the window for a single document (sometimes this is called a multiple-view document) so that the user can have each window scrolled to a different position or displayed in different ways. In this case, your <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/makeWindowControllers" target="_top">makeWindowControllers</a></code> override may create only one <code>NSWindowController</code> object, but there will be a menu command or similar control that allows the user to create others.</p><a name="//apple_ref/doc/uid/20000025-DontLinkElementID_11" title="Documents and Scripting"></a><h2>Documents and Scripting</h2><p>Scripting support is mostly automatic for applications based on the document architecture, for several reasons. First, <code>NSDocument</code> and the other classes in the document architecture directly implement the standard document scripting class (as expected by AppleScript) and automatically support many of the scripting commands that apply to documents. Second, because the document architecture is intended to work with application designs that use model-view-controller (MVC) separation, and because scripting support depends on many of the same design points, applications that use the document architecture are already in better shape to support scripting than other applications that are not designed that way. Finally, the document plays an important role in the scripting API of most applications; the <code>NSDocument</code> class fills that role and provides a good starting point for allowing scripted access to the model layer of your application.</p><p>If an application is not based on the document architecture, making it scriptable requires you to duplicate work you would otherwise get for free. The TextEdit example application shows how to make a document-based application that is not based on <code>NSDocument</code> scriptable. See the <a name="//apple_ref/doc/uid/20000025-DontLinkElementID_72"></a>Sketch example project for an example of how to implement a scriptable <code>NSDocument</code>-based application.</p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="OverviewDocArchitecture.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../Tasks/ImplementingDocApp.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2001, 2009 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2009-01-12<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Conceptual/Documents/Concepts/RolesOfDocObjects.html%3Fid%3D10000006i-2.7&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Conceptual/Documents/Concepts/RolesOfDocObjects.html%3Fid%3D10000006i-2.7&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Conceptual/Documents/Concepts/RolesOfDocObjects.html%3Fid%3D10000006i-2.7&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
