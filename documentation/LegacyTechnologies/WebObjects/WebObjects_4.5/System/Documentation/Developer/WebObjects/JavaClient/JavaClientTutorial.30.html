<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML EXPERIMENTAL 970324//EN"><HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><TITLE> Writing Derived Methods</TITLE></HEAD><body bgcolor="#ffffff"><!--start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!--start of path --><font face="Geneva,Helvetica,Arial" size="1"><b>PATH<spacer type="horizontal" size="5">&nbsp;</b> <a href="../../../../../../index.html" target="_top">Documentation</a> <b>&gt;</b> <a href="../../../../../webobjects.html" target="_top">WebObjects 4.5</a> <b>&gt;</b>Creating a Java Client Application: A Tutorial</font><br><br><!--end of path --><DIV><a name="top"></a><A HREF="JavaClientTutorial.2e.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="JavaClientTutorial.2f.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="JavaClientTutorial.31.html"><img src="images/next.gif" border="0" width="49" height="16"></A><nobr>&nbsp;</nobr><HR></DIV><H1><A NAME="pgfId=1007081"> </A><A NAME="18330"> </A>Writing <A NAME="marker=1007080"> </A>Derived Methods</H1><A NAME="pgfId=1007082"> </A>One kind of behavior you might want to add to your enterprise object class is the ability to perform computations based on the values of class properties. For example, studios have movies, and the total revenue of the movies times 1.5 constitutes the studio's portfolio value. To calculate a studio's portfolio value, you could have a method in <B>Studio.java</B> like the following:</P><H4><A NAME="pgfId=1007083"> </A>Studio.java</H4><TT>public Number portfolioValue() {<BR>&nbsp;&nbsp;&nbsp;int i,count;<BR>&nbsp;&nbsp;&nbsp;double total;<BR>&nbsp;&nbsp;&nbsp;NSArray revenues;<BR>&nbsp;&nbsp;&nbsp;total = 0.0;<BR>&nbsp;&nbsp;&nbsp;revenues = (NSArray)(movies().valueForKey(&quot;revenue&quot;));<BR>&nbsp;&nbsp;&nbsp;count = revenues.count();<BR>&nbsp;&nbsp;&nbsp;for (i=0; i&lt;count; i++) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total +=<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((Number)(revenues.objectAtIndex(i))).doubleValue();<BR>&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;return new BigDecimal(total * 1.5);<BR>}</TT><P><BR><A NAME="pgfId=1007099"> </A>You can display the results of this method in the user interface by forming an association between a control and the method. That way, whenever a new studio is selected or when a selected studio's movie revenues change, its portfolio value is dynamically recalculated and displayed.</P><OL><LI><A NAME="pgfId=1007100"> </A>Add the code above to the client-side Studio.java file.<P><LI CLASS="TaskNumber"><A NAME="pgfId=1007101"> </A>Add a method as a display-group property.<P><A NAME="pgfId=1007102"> </A>Display the Attributes view of the Inspector for the Studio EODisplayGroup.<P><A NAME="pgfId=1007103"> </A>Add the name of the method (<B CLASS="Bold-(Sidebar)">portfolioValue</B>) you want to use in an association.<P><A NAME="pgfId=1007104"> </A>Click Add.</P><A NAME="pgfId=1007108"> </A></P><DIV><IMG SRC="images/AddPortofolioValue.gif"><P></DIV><A NAME="pgfId=1007109"> </A>Once you've added the method as a class key, you can use it in associations. But before you do this, add the necessary user-interface control.</P><LI><A NAME="pgfId=1007110"> </A>Add text fields to the user interface.<P><A NAME="pgfId=1007111"> </A>Drag three text fields from the Views palette.<P><A NAME="pgfId=1007112"> </A>Make them the same size and align them in a column.<P><A NAME="pgfId=1007113"> </A>Add labels (as shown at right) to each text field.<P><A NAME="pgfId=1007114"> </A>Justify the fields' contents (as shown).</P><A NAME="pgfId=1007118"> </A></P><DIV><IMG SRC="images/addTextFields.gif"><P></DIV><A NAME="pgfId=1007119"> </A>Now make an association between the Revenue text field and the <B>portfolioValue</B> method.</P><LI><A NAME="pgfId=1007121"> </A>Associate a <A NAME="marker=1007120"> </A>method with a user interface control.<P><A NAME="pgfId=1007122"> </A>Control-drag from the Revenue text field to the Studio EODisplayGroup.<P><A NAME="pgfId=1007123"> </A>In the Connections Inspector, choose EOControlAssoc from the pop-up list at the top of the left column.<P><A NAME="pgfId=1007124"> </A>Select <B CLASS="Bold-(Sidebar)">value</B> in the left column.<P><A NAME="pgfId=1007125"> </A>In the right column select the method (<B CLASS="Bold-(Sidebar)">portfolioValue</B>) you want to associate with the control.<P><A NAME="pgfId=1007126"> </A>Double-click <B CLASS="Bold-(Sidebar)">portfolioValue</B> to connect.<P><A NAME="pgfId=1007127"> </A>Repeat the above steps, connecting the Name field to Studio's <B CLASS="Bold-(Sidebar)">name</B> attribute and the Budget field to the <B CLASS="Bold-(Sidebar)">budget</B> attribute.</P><A NAME="pgfId=1007131"> </A></P><DIV><IMG SRC="images/BindToMethod.gif"><P></DIV><A NAME="pgfId=1007132"> </A>You now need to add a formatter to the Revenue and Budget fields. The formatter isn't added automatically, because the field has no way of knowing that it's going to be used to display currency values--it's just connected to a property.</P><LI><A NAME="pgfId=1007133"> </A>From the DataViews palette, drag the currency formatter into the new text field.<P><A NAME="pgfId=1007137"> </A></P><DIV><IMG SRC="images/PlaceFormatter.gif"><P></DIV><A NAME="pgfId=1007138"> </A>Once you've added the formatter, you can use the Inspector to change the format.</P><LI><A NAME="pgfId=1007139"> </A>Set the format.<P><A NAME="pgfId=1007140"> </A>Select the text field, and display the Formatter view of the NSTextField Inspector. Change the format as shown.</P><A NAME="pgfId=1007144"> </A></P><DIV><IMG SRC="images/FormatInspector.gif"><P></DIV><LI><A NAME="pgfId=1007145"> </A>Build and test the application on the client.<P><A NAME="pgfId=1007149"> </A>(See &quot;<A HREF="JavaClientTutorial.21.html#11413" CLASS="XRef">Building and Testing Your Application</A>&quot; for details.)</P><A NAME="pgfId=1007150"> </A></P></OL><HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 13 Sep 99)<P><A HREF="JavaClientTutorial.2e.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="JavaClientTutorial.2f.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="JavaClientTutorial.31.html"><img src="images/next.gif" border="0" width="49" height="16"></A><nobr>&nbsp;</nobr></BODY></HTML>