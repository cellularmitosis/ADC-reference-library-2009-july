<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>WebObjects Tutorial: Creating a WebObjects Database Application</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Creating a WebObjects Database Application"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40008108-CH100" title="Creating a WebObjects Database Application"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000436" target="_top">Tools</a> &gt; <a href="../../../WebObjects-date.html#//apple_ref/doc/uid/TP30000440-TP30000436-TP30000592" target="_top">WebObjects</a> &gt; <a href="../Introduction/Introduction.html#//apple_ref/doc/uid/TP40008108-CH1-SW1">WebObjects Tutorial</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../InstallingEclipseandtheWOLipsPlug-in/InstallingEclipseandtheWOLipsPlug-in.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../DeployingAWebObjectsApplication/DeployingAWebObjectsApplication.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40008108-CH100-SW5" title="Creating a WebObjects Database Application"></a><h1>Creating a WebObjects Database Application</h1><p>This tutorial introduces you to the basic concepts and procedures of developing WebObjects applications by showing you how to create a simple database application. To provide access to a database, WebObjects uses a framework called the Enterprise Objects Framework. The Enterprise Objects Framework is at the heart of every WebObjects database application, managing the interaction between the database and objects in the application. The steps you take in creating this application demonstrate the principles you use in every other application you develop with WebObjects and the Enterprise Objects Framework.</p><p>The application you create in this tutorial is called Movies. It uses a sample Apache Derby database, the Movies database, that comes with WebObjects. If you have not installed Eclipse and the WOLips plug-in, follow the steps in <span class="content_text"><a href="../InstallingEclipseandtheWOLipsPlug-in/InstallingEclipseandtheWOLipsPlug-in.html#//apple_ref/doc/uid/TP40008108-CH101-SW1">“Installing WebObjects, Eclipse, and the WOLips Plug-in”</a></span> before you continue with this tutorial.</p><p>In this tutorial, you will:</p><ul class="ul"><li class="li"><p>Use the Entity Modeler included in the WOLips plug-in to maintain a model file</p></li><li class="li"><p>Create custom enterprise object classes</p></li><li class="li"><p>Create a Main component that reads from the Movies database</p></li><li class="li"><p>Create a MovieDetails component that edits and deletes from the Movies database</p></li></ul><p>Along the way, you will learn basic Enterprise Objects Framework concepts you can use to design your own database applications.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40008108-CH100-SW6" title="Note"></a><p><strong>Note:</strong>&nbsp;You can also develop database applications using Direct to Web, a high-level technology based on WebObjects. Direct to Web instantly generates a generic database application and allows you to modify its user interface, which makes it a useful starting point for simple projects with flexible user interface requirements. See <em><a href="../../../../WebObjects/Developing_With_D2W/index.html#//apple_ref/doc/uid/TP30001015" target="_top">WebObjects Direct to Web Guide</a></em> for more information.</p></div>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="DatabaseApplication.html#//apple_ref/doc/uid/TP40008108-CH100-SW7">The Movies Application</a>
				
			<br/>
			
        
			
			
				<a href="DatabaseApplication.html#//apple_ref/doc/uid/TP40008108-CH100-SW8">Setting Up the Application</a>
				
			<br/>
			
        
			
			
				<a href="DatabaseApplication.html#//apple_ref/doc/uid/TP40008108-CH100-SW12">Developing an Enterprise Object Model</a>
				
			<br/>
			
        
			
			
				<a href="DatabaseApplication.html#//apple_ref/doc/uid/TP40008108-CH100-SW18">Designing the Main Webpage</a>
				
			<br/>
			
        
			
			
				<a href="DatabaseApplication.html#//apple_ref/doc/uid/TP40008108-CH100-SW23">Adding the MovieDetails Webpage</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40008108-CH100-SW7" title="The Movies Application"></a><h2>The Movies Application</h2><p>The Movies application has two webpages, each of which allows you to access information from the database in two different ways:</p><ul class="ul"><li class="li"><p>MovieSearch (the main webpage) lets you search for movies that match user-specified criteria. For example, you can search for all comedies starting with the letter “A”. After you find the movie you are looking for, you can access its details to edit or delete it. <span class="content_text">Figure 2-1</span> shows the completed MovieSearch webpage.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP40008108-CH100-SW30" title="Figure 2-1The MovieSearch webpage"></a><p><strong>Figure 2-1&nbsp;&nbsp;</strong>The MovieSearch webpage</p><img src = "../Art/search.jpg" alt = "" ></div></li><li class="li"><p>MovieDetails displays the title, category, and release date of a movie. You can edit these properties or delete the movie from the database. <span class="content_text">Figure 2-2</span> shows the completed MovieDetails webpage.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP40008108-CH100-SW31" title="Figure 2-2The MovieDetails webpage"></a><p><strong>Figure 2-2&nbsp;&nbsp;</strong>The MovieDetails webpage</p><img src = "../Art/details.jpg" alt = "" ></div></li></ul><a name="//apple_ref/doc/uid/TP40008108-CH100-SW8" title="Setting Up the Application"></a><h2>Setting Up the Application</h2><p>Properly setting up your WebObjects application before beginning development is critical to avoiding complications later on. This section leads you through installing the Movies database, creating a new WebObjects project, and configuring the project’s connection to the database.</p><a name="//apple_ref/doc/uid/TP40008108-CH100-SW9" title="Installing the Movies Database"></a><h3>Installing the Movies Database</h3><p>This tutorial uses a sample Apache Derby database called Movies. The Apple developer tools include a script for installing the database at <code>/Developer/Examples/JavaWebObjects/installDatabases.sh</code>. The script must be run as root and requires your user name as an argument. After you run the script, the Movies database, along with several other sample databases, is installed in <code>~/Library/Databases/derby-10.3.2.1/data</code>. For reference, the SQL commands that create and populate the databases can be found in <code>/Developer/Examples/JavaWebObjects/Databases</code>.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40008108-CH100-DontLinkElementID_4" title="Note"></a><p><strong>Note:</strong>&nbsp;If you provide a value other than your user name to the database installation script, the script still creates the full directory structure rooted at the value specified.</p></div><a name="//apple_ref/doc/uid/TP40008108-CH100-SW10" title="Creating a New WebObjects Application"></a><h3>Creating a New WebObjects Application</h3><ol class="ol"><li class="li"><p>In Eclipse, choose File > New > Project.</p></li><li class="li"><p>Choose WebObjects Application from the WOLips folder in the New Project dialog. Click Next.</p></li><li class="li"><p>Enter <code>Movies</code> as the project name in the New WebObjects Project dialog. Click Finish.</p></li></ol><p>The new project appears in the Package Explorer window. <span class="content_text">Figure 2-3</span> shows the structure of the WebObjects application template.</p><br/><div><a name="//apple_ref/doc/uid/TP40008108-CH100-SW1" title="Figure 2-3The WebObjects application template"></a><p><strong>Figure 2-3&nbsp;&nbsp;</strong>The WebObjects application template</p><img src = "../Art/newprojectexplorer.jpg" alt = "" ></div><br/><p>The following files are of particular importance:</p><ul class="spaceabove"><li class="li"><p><code>Application.java</code> defines application variables that persist as long as the application does.</p></li><li class="li"><p><code>DirectAction.java</code> defines a subclass of <code>WODirectAction</code> that you use as a container class for your action methods. You can rename this class or create multiple subclasses of <code>WODirectAction</code> depending on your application needs.</p></li><li class="li"><p><code>Session.java</code> defines session variables that persist for the lifetime of one user’s session.</p></li><li class="li"><p><code>Main.java</code> is a file that allows you to specify behavior associated with the Main component. A corresponding file is generated for each subsequent component.</p></li><li class="li"><p><code>Main WO</code> is the Main component, which comprises three files:</p><ul class="nested"><li class="nested li"><p><code>Main.html</code> is the HTML template for your webpage. It can include tags for dynamic WebObjects elements as well as regular HTML.</p></li><li class="nested li"><p><code>Main.wod</code> is the declarations file that specifies bindings between the dynamic elements and variables or methods in your Java code. </p></li><li class="nested li"><p><code>Main.woo</code> contains information that describes <code>WODisplayGroup</code> objects and other information for build tools, such as text encodings. </p></li></ul></li><li class="li"><p><code>Properties</code> defines Java system properties for the application.</p></li></ul><p>This template builds and runs without any modifications. Control-click the Movies project folder in Package Explorer and choose Run As > WOApplication. The first time you run the application, Eclipse prompts you for the main class. Select “Application - your.app”. Your default web browser opens and displays a white page with Hello World in the upper-left corner. Click the red Terminate button located above the Eclipse console to terminate the application.</p><a name="//apple_ref/doc/uid/TP40008108-CH100-SW11" title="Linking to the Movies Database and derby.jar"></a><h3>Linking to the Movies Database and derby.jar</h3><p>In order for your application to find the Movies database, you must provide it with the path to the Derby home directory. Double-click the Properties file in the Resources folder in Package Explorer to open it and add the following, replacing the indicated portion with your user name:</p><div class="codesample"><table><tr><td scope="row"><pre>derby.system.home=/Users/&lt;REPLACE WITH YOUR USERNAME>/Library/Databases/derby-10.3.2.1/data<span></span></pre></td></tr></table></div><p>Java applications require a driver class to connect to a database. WebObjects provides a Derby JDBC driver in the <code>derby.jar</code> library. To reference the library, control-click your project folder in Package Explorer and choose Build Path > Add External Archives. Navigate to <code>/Library/WebObjects/Extensions</code> in the file chooser and select <code>derby.jar</code>. The library appears in the Package Explorer under Referenced Libraries. You provide the name of the driver when you configure your EOModel.</p><a name="//apple_ref/doc/uid/TP40008108-CH100-SW12" title="Developing an Enterprise Object Model"></a><h2>Developing an Enterprise Object Model</h2><p>The Enterprise Objects Framework manages the interaction between the database and objects in a WebObjects application. Its primary responsibility is to fetch data from relational databases and represent them as enterprise objects. An enterprise object, like any other object, couples data with methods for operating on that data. In addition, an enterprise object has properties that map to stored data. An EOModel represents the entity-relationship model that maps tables and rows to enterprise objects. Enterprise object classes typically correspond to database tables. An enterprise object instance corresponds to a single row or record in a database table.</p><a name="//apple_ref/doc/uid/TP40008108-CH100-SW13" title="Creating a New EOModel"></a><h3>Creating a New EOModel</h3><p>To create the EOModel for the Movies database, do the following:</p><ol class="ol"><li class="li"><p>Control-click your project folder in Package Explorer and choose New > Other.</p></li><li class="li"><p>Choose EOModel from the WOLips folder in the New dialog. Click Next.</p></li><li class="li"><p>Specify <code>Movies/Resources</code> as the parent folder for the model. WebObjects expects EOModel files to be in this folder.</p></li><li class="li"><p>Specify <code>Movies</code> as the name of the model.</p></li><li class="li"><p>Select JDBC as the Adaptor Type.</p></li><li class="li"><p>Ensure that the Use EOGenerator checkbox is selected. EOGenerator is a tool that generates Java classes from an EOModel.</p></li><li class="li"><p>Click Finish.</p></li></ol><p>Eclipse will open the EOModel in a new perspective, called the Entity Modeler perspective. <span class="content_text">Figure 2-4</span> shows this perspective.</p><br/><div><a name="//apple_ref/doc/uid/TP40008108-CH100-SW3" title="Figure 2-4The Entity Modeler perspective"></a><p><strong>Figure 2-4&nbsp;&nbsp;</strong>The Entity Modeler perspective</p><img src = "../Art/eomodeler.jpg" alt = "" ></div><br/><p>The Entity Modeler perspective uses three primary windows:</p><ul class="spaceabove"><li class="li"><p>The Outline window, located in the upper left, shows the entities, attributes, and database configurations in the EOModel. A new EOModel contains only a single database configuration, named Default.</p></li><li class="li"><p>The Properties window, located in the lower left, shows the properties for whatever element is selected in the Outline window.</p></li><li class="li"><p>The Entity Modeler window, located on the right, shows an EOModel’s list of entities or an entity’s list of attributes, depending on what is selected in the Outline window.</p></li></ul><div class="notebox"><a name="//apple_ref/doc/uid/TP40008108-CH100-SW14" title="Note"></a><p><strong>Note:</strong>&nbsp;Whenever you create, open, or switch to an EOModel file, Eclipse automatically enters the Entity Modeler perspective. This perspective is necessary for EOModel development, but it is poorly suited for other tasks. Whenever you switch from an EOModel to another file type, you should change to the WOLips perspective by choosing Window > Open Perspective > Other and selecting WOLips from the dialog.</p></div><a name="//apple_ref/doc/uid/TP40008108-CH100-SW15" title="Connecting the EOModel to the Movies Database"></a><h3>Connecting the EOModel to the Movies Database</h3><p>Immediately after creating an EOModel, you should provide it with information about the database it communicates with—in this case, the Movies database:</p><ol class="ol"><li class="li"><p>Select the Default database configuration in the Outline window. The properties for the configuration will appear in the Properties window.</p></li><li class="li"><p>Change the value of the Name field to <code>Movies</code>.</p></li><li class="li"><p>Ensure that JDBC is specified as the adaptor type.</p></li><li class="li"><p>Leave the Username and Password fields blank—the Movies database requires neither.</p></li><li class="li"><p>In the URL field, enter <code>jdbc:derby:movies</code>.</p></li><li class="li"><p>In the Driver field, enter <code>org.apache.derby.jdbc.AutoloadedDriver</code>. This is the Derby JDBC driver included in <code>derby.jar</code>.</p></li></ol><p>The EOModel is now configured to communicate with the Movies database.</p><a name="//apple_ref/doc/uid/TP40008108-CH100-SW16" title="Creating the Movie Entity"></a><h3>Creating the Movie Entity</h3><p>Each entity in an EOModel corresponds to a table in the database. Each attribute in an entity corresponds to a column in the table. You can use entities and attributes to represent whatever portion of your database you want to interact with. For instance, the <code>MOVIE</code> table in the Movies database has nine columns, but this tutorial only uses four of them. If a column can have a null value, you do not need to create an attribute for it.</p><p>To create and configure the entity for the <code>MOVIE</code> table, do the following:</p><ol class="ol"><li class="li"><p>Control-click the Movies EOModel in the Outline window and choose New Entity. The entity’s properties appear in the Properties window.</p></li><li class="li"><p>Change the value of the Name field to <code>Movie</code> in the Properties window.</p></li><li class="li"><p>Change the value of the Table Name field to <code>MOVIE</code>. This is the name of the table in the database.</p></li><li class="li"><p>Change the value of the Class Name field to <code>your.app.eo.Movie</code>. This is the name of the Java class that will be generated by EOGenerator.</p></li></ol><p>This tutorial uses four columns in the <code>MOVIE</code> table: <code>MOVIE_ID</code> (the primary key for the table), <code>TITLE</code>, <code>CATEGORY</code>, and <code>DATE_RELEASED</code>. A separate attribute must be created for each of these columns.</p><p>To create and configure the attribute for the <code>MOVIE_ID</code> column, do the following:</p><ol class="ol"><li class="li"><p>Control-click the Movie entity in the Outline window and choose New Attribute. The attribute’s properties appear in the Properties window.</p></li><li class="li"><p>Change the value of the Name field to <code>movieid</code>.</p></li><li class="li"><p>Ensure that the menu for the second field is set to <code>Column</code>. Enter <code>MOVIE_ID</code> as the value.</p></li><li class="li"><p>Change the value of the External Type field to <code>INTEGER</code>. This is the data type stored in the column.</p></li><li class="li"><p>Ensure that the Allows Null checkbox is not selected.</p></li><li class="li"><p>Select <code>Integer - Integer i</code> from the menu for the Data Type field. This is the Java class that corresponds to the data type in the column.</p></li></ol><p>Repeat this process for the remaining three attributes. <span class="content_text">Table 2-1</span> indicates the values you should provide for each attribute in the Properties window.</p><a name="//apple_ref/doc/uid/TP40008108-CH100-SW2" title="Table 2-1Values for entity attributes"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 2-1&nbsp;&nbsp;</strong>Values for entity attributes</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Column</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>External Type</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Allows Null</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data Type</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>External Width</p></th></tr><tr><td  scope="row"><p><code>title</code></p></td><td ><p><code>TITLE</code></p></td><td ><p><code>CHAR</code></p></td><td ><p>Not selected</p></td><td ><p><code>String - String S</code></p></td><td ><p><code>100</code></p></td></tr><tr><td  scope="row"><p><code>category</code></p></td><td ><p><code>CATEGORY</code></p></td><td ><p><code>CHAR</code></p></td><td ><p>Selected</p></td><td ><p><code>String - String S</code></p></td><td ><p><code>20</code></p></td></tr><tr><td  scope="row"><p><code>datereleased</code></p></td><td ><p><code>DATE_RELEASED</code></p></td><td ><p><code>TIMESTAMP</code></p></td><td ><p>Selected</p></td><td ><p><code>Timestamp - NSTimestamp T</code></p></td><td ><p>N/A</p></td></tr></table></div><div class="notebox"><a name="//apple_ref/doc/uid/TP40008108-CH100-DontLinkElementID_5" title="Note"></a><p><strong>Note:</strong>&nbsp;When populating the <code>datereleased</code> attribute, leave the Server Timezone field blank. It is not used in this application.</p></div><p><span class="content_text">Figure 2-5</span> shows the state of the EOModeler window after the remaining steps in this section are performed.</p><br/><div><a name="//apple_ref/doc/uid/TP40008108-CH100-SW29" title="Figure 2-5Attributes in the Movies EOModeler window"></a><p><strong>Figure 2-5&nbsp;&nbsp;</strong>Attributes in the Movies EOModeler window</p><img src = "../Art/eomodel.jpg" alt = "" ></div><br/><p>Most of the columns in the Entity Modeler window correspond to fields in the Properties window and are self-explanatory. The four leftmost columns are more cryptic in appearance; their purposes are the following:</p><ul class="spaceabove"><li class="li"><p>The key column is used to indicate that an attribute represents a primary key in the table.</p></li><li class="li"><p>The diamond column is used to indicate that accessors for an attribute should be added to the Java class generated for the attribute’s entity.</p></li><li class="li"><p>The lock column is used to indicate that an attribute is well suited for detecting failures in optimistic locking. Data types of constant size are best suited for this.</p></li><li class="li"><p>The zero column is used to indicate that an attribute can be null.</p></li></ul><p>The primary key for the <code>MOVIE</code> table is <code>MOVIE_ID</code>. Click the key cell in the <code>movieid</code> row to indicate this fact. A key symbol appears in the cell. WOLips also automatically removes the diamond symbol from the row, as it is usually the case that the primary key for a table should not be exposed to the front end of an application.</p><a name="//apple_ref/doc/uid/TP40008108-CH100-SW17" title="Generating Enterprise Objects from an EOModel"></a><h3>Generating Enterprise Objects from an EOModel</h3><p>After you have finished configuring your EOModel, WOLips can automatically generate the enterprise object classes. </p><ol class="ol"><li class="li"><p>Choose Window > Open Perspective > Other, choose WOLips from the dialog, and click OK to return to the WOLips perspective. Double-click the <code>Movies.eogen</code> file in the <code>Resources</code> folder in the Package Explorer window. The EOGenerator Editor appears, providing options for customizing the behavior of generating classes. No customization is necessary in this tutorial, so close the file.</p></li><li class="li"><p>Control-click <code>Movies.eogen</code> in the Package Explorer and choose EOGenerate. <code>Movie.java</code> appears in the <code>Sources</code> folder in Package Explorer. An additional file, <code>_Movie.java</code>, is created in the same folder but does not appear in the Package Explorer. </p><p><code>_Movie.java</code> is a fully functional enterprise object that enables you to create instances representing new or existing rows in the <code>MOVIE</code> table. <code>Movie.java</code> is a subclass of <code>_Movie.java</code> that you can customize and enhance to suit your needs. You should only alter the subclass of an enterprise object class. If you ever need to modify an enterprise object class, you can see it in the Package Explorer by switching to the standard Java perspective.</p></li></ol><a name="//apple_ref/doc/uid/TP40008108-CH100-SW18" title="Designing the Main Webpage"></a><h2>Designing the Main Webpage</h2><p>Every WebObjects application has at least one component—usually named Main—that represents the first webpage the application displays. Each component has four parts: an HTML file that defines the visual layout, a Java file that queries the database and maintains instance variables for dynamic portions of the webpage, a WOD file that binds the elements of the HTML to the logic of the Java, and a WOO file that describes <code>WODisplayGroup</code> objects and other information for build tools. The next three sections walk you through creating the HTML, Java, and WOD files for your Main component, which represents the MovieSearch webpage. The WOO file does not need to be modified in this tutorial.</p><a name="//apple_ref/doc/uid/TP40008108-CH100-SW19" title="Designing Main.html"></a><h3>Designing Main.html</h3><p>A webpage consists of elements. In addition to the standard static HTML elements found in all webpages, WebObjects allows you to create dynamic elements, whose look and behavior are determined at runtime. In this step, you will create a basic interface for searching for information contained in the Movies database.</p><p>Double-click <code>Components > Main WO</code> in the Package Explorer to open both the HTML and WOD files for the component. The WOD file, displayed in the lower half of the main window, is blank, and the HTML file, displayed in the upper half of the main window, consists of the following template:</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN"><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;html><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;head><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;title>Untitled&lt;/title><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/head><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;body><span></span></pre></td></tr><tr><td scope="row"><pre>Hello World<span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/body><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/html><span></span></pre></td></tr></table></div><p>Change the text within the <code>title</code> element from <code>Untitled</code> to something more descriptive, such as <code>Movie Search</code>. Replace the “Hello World” text in the <code>body</code> element with the following HTML:</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;h2>Search for Movies&lt;/h2><span></span></pre></td></tr><tr><td scope="row"><pre>Specify which movies to display below:&lt;br><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;webobject name="SearchForm"><span></span></pre></td></tr><tr><td scope="row"><pre>    Title:&lt;webobject name="TitleField">&lt;/webobject>&lt;br><span></span></pre></td></tr><tr><td scope="row"><pre>    Category:&lt;webobject name="CategoryField">&lt;/webobject>&lt;br><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;webobject name="Submit">&lt;/webobject><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/webobject><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;br>&lt;br><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;h2>Results&lt;/h2><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;webobject name = "Results"><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;webobject name = "ResultTitle">&lt;/webobject>&lt;br><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/webobject><span></span></pre></td></tr></table></div><p>The six <code>webobject</code> elements in this block of HTML compose the search form and the portion of the webpage that will display search results. Every <code>webobject</code> element requires a <code>name</code> attribute to map it to a definition that you will add to the WOD file.</p><p>Choose File > Save to save the Main component. When you save, Eclipse notes six errors in the application, one for each <code>webobject</code> HTML element. The Problems window explains that the elements have not been defined in <code>Main.wod</code>.</p><a name="//apple_ref/doc/uid/TP40008108-CH100-SW20" title="Configuring Main.wod"></a><h3>Configuring Main.wod</h3><p>A WOD file is a list of definitions that bind the <code>webobject</code> elements of a component’s HTML file to variables and methods in the component’s Java class. To match the <code>webobject</code> elements defined in <code>Main.html</code>, add the following to <code>Main.wod</code>:</p><div class="codesample"><table><tr><td scope="row"><pre>SearchForm : WOForm {<span></span></pre></td></tr><tr><td scope="row"><pre>    enctype = "multipart/form-data";<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>TitleField : WOTextField {<span></span></pre></td></tr><tr><td scope="row"><pre>    value = title;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>CategoryField : WOTextField {<span></span></pre></td></tr><tr><td scope="row"><pre>    value = category;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Submit : WOSubmitButton {<span></span></pre></td></tr><tr><td scope="row"><pre>    action = searchMovies;<span></span></pre></td></tr><tr><td scope="row"><pre>    value = "Search";<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Results : WORepetition {<span></span></pre></td></tr><tr><td scope="row"><pre>    list = resultsList;<span></span></pre></td></tr><tr><td scope="row"><pre>    item = movie;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>ResultTitle : WOString {<span></span></pre></td></tr><tr><td scope="row"><pre>    value = movie.title;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Every dynamic element definition follows the same format: the name and type of the element, separated by a colon, followed by a bracketed list of attribute assignments. Each attribute is assigned either a constant value or a value that refers to a variable or method contained in the component’s Java file. For example, in the above code, <code>Submit</code> is of type <code>WOSubmitButton</code>, its attribute <code>value</code> is assigned the constant value <code>Search</code>, and its attribute <code>action</code> is assigned the value <code>searchMovies</code>, which will correspond to a method in <code>Main.java</code>.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40008108-CH100-SW21" title="Note"></a><p><strong>Note:</strong>&nbsp;An element’s type can be any of the dynamic elements included with WebObjects (see <em><a href="../../../../WebObjects/Reference/DynamicElements/index.html#//apple_ref/doc/uid/TP30001055" target="_top">WebObjects Dynamic Elements Reference</a></em> for descriptions of these elements) or any other component you include in your project. This nesting of components makes it easy to create modular components that can be used in several places in a single application or across multiple applications.</p></div><p>Save the Main component. Eclipse notes six new errors, this time because <code>Main.java</code> does not yet have corresponding variables or methods for <code>title</code>, <code>category</code>, <code>searchMovies</code>, <code>resultsList</code>, or <code>movie</code>.</p><a name="//apple_ref/doc/uid/TP40008108-CH100-SW22" title="Configuring Main.java"></a><h3>Configuring Main.java</h3><p>A component’s Java file must define any instance variables and methods that are mentioned in the component’s WOD file. In the Movies application, instance variables are defined to keep track of the user’s title and category search terms, and to store the results from a search. Methods are defined to provide access to these variables and to perform the search.</p><p>The Main class uses several classes to communicate with the Movie enterprise object. Add the following import statements to <code>Main.java</code>:</p><div class="codesample"><table><tr><td scope="row"><pre>import com.webobjects.appserver.WOComponent;<span></span></pre></td></tr><tr><td scope="row"><pre>import com.webobjects.appserver.WOContext;<span></span></pre></td></tr><tr><td scope="row"><pre>import com.webobjects.eoaccess.EOUtilities;<span></span></pre></td></tr><tr><td scope="row"><pre>import com.webobjects.eocontrol.EOQualifier;<span></span></pre></td></tr><tr><td scope="row"><pre>import com.webobjects.eocontrol.EOSortOrdering;<span></span></pre></td></tr><tr><td scope="row"><pre>import com.webobjects.foundation.NSArray;<span></span></pre></td></tr><tr><td scope="row"><pre>import your.app.eo.Movie;<span></span></pre></td></tr></table></div><p>Add the following instance variables to the body of the Main class:</p><div class="codesample"><table><tr><td scope="row"><pre>private String title;               // Stores the value of the Title search field.<span></span></pre></td></tr><tr><td scope="row"><pre>private String category;            // Stores the value of the Category search field.<span></span></pre></td></tr><tr><td scope="row"><pre>private Movie movie;                // Stores the current movie when looping through search results.<span></span></pre></td></tr><tr><td scope="row"><pre>private NSArray&lt;Movie> resultsList; // Stores the results of a search.<span></span></pre></td></tr></table></div><p>Each instance variable in a component’s Java file that contributes to HTML content requires standard setter and getter methods in order for your application to be able to access it. Each setter method should have a name of the form <code>set&lt;Variablename></code>, and each getter method should be the name of the instance variable. All of the instance variables in <code>Main.java</code> contribute to HTML content, so create setter and getter methods for all of them. All of the setter and getter methods in <code>Main.java</code> should consist of simple assignment statements and return statements, respectively.</p><p>Finally, <code>Main.java</code> needs to define the <code>searchMovies</code> method that is called when the Search button is clicked. Add the following method to the Main class:</p><div class="codesample"><table><tr><td scope="row"><pre>public WOComponent searchMovies() {<span></span></pre></td></tr><tr><td scope="row"><pre>    if (title == null &amp;&amp; category == null) {<span></span></pre></td></tr><tr><td scope="row"><pre>        return context().page();<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    if (title == null) {<span></span></pre></td></tr><tr><td scope="row"><pre>        title = "";<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    if (category == null) {<span></span></pre></td></tr><tr><td scope="row"><pre>        category = "";<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    NSArray&lt;EOSortOrdering> sortOrdering = new NSArray&lt;EOSortOrdering>(new EOSortOrdering("title", EOSortOrdering.CompareAscending));<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    String[] argArray = new String[2];<span></span></pre></td></tr><tr><td scope="row"><pre>    argArray[0] = title + "*";<span></span></pre></td></tr><tr><td scope="row"><pre>    argArray[1] = category + "*";<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    NSArray&lt;String> args = new NSArray&lt;String>(argArray);<span></span></pre></td></tr><tr><td scope="row"><pre>    EOQualifier qualifier = EOQualifier.qualifierWithQualifierFormat("title LIKE %@ AND category LIKE %@", args);<span></span></pre></td></tr><tr><td scope="row"><pre>    resultsList = Movie.fetchMovies(session().defaultEditingContext(), qualifier, sortOrdering);<span></span></pre></td></tr><tr><td scope="row"><pre>    return context().page();<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>The first <code>if</code> statement in the method ensures that a value has been supplied for at least one search field, and reloads the current webpage without querying the database if this is not the case. The two subsequent <code>if</code> statements provide the empty string for any field the user chooses to omit. The remaining lines perform the following actions:</p><ol class="ol"><li class="li"><p>A sort ordering is created to indicate that results retrieved from the database should be sorted in ascending order by title.</p></li><li class="li"><p>An array of arguments for a formatting string is created. An asterisk is added to the end of both the <code>title</code> and <code>category</code> strings to indicate a wildcard suffix in a SQL LIKE clause.</p></li><li class="li"><p>A qualifier is created to specify the movies to be returned from the database query. The string passed into <code>EOQualifier.qualifierWithQualifierFormat</code> is the equivalent of a WHERE clause in a SQL statement that begins with <code>SELECT * FROM MOVIE</code>. The <code>%@</code> substring indicates a placeholder to be filled by an object in <code>args</code>.</p></li><li class="li"><p>The static method <code>Movie.fetchMovies</code> populates <code>resultsList</code> with the movies that meet the requirements set by <code>qualifier</code>, in the order specified by <code>sortOrdering</code>.</p></li><li class="li"><p>The response webpage is returned, in this case the same webpage. The Results section of the page is now populated with the titles of movies in <code>resultsList</code>.</p></li></ol><p>Save your project and run it. Performing a search with <code>The</code> in the Title field and <code>Comedy</code> in the Category field produces the webpage shown in <span class="content_text">Figure 2-6</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP40008108-CH100-SW4" title="Figure 2-6The main webpage with search results"></a><p><strong>Figure 2-6&nbsp;&nbsp;</strong>The main webpage with search results</p><img src = "../Art/searchresults.jpg" alt = "" ></div><br/><div class="notebox"><a name="//apple_ref/doc/uid/TP40008108-CH100-DontLinkElementID_6" title="Note"></a><p><strong>Note:</strong>&nbsp;The application in this tutorial performs very few error checks in order to maintain focus on WebObjects concepts. Make sure to handle all possible exceptions when writing your future WebObjects applications.</p></div><a name="//apple_ref/doc/uid/TP40008108-CH100-SW23" title="Adding the MovieDetails Webpage"></a><h2>Adding the MovieDetails Webpage</h2><p>The MovieDetails webpage shows you the detailed information about a movie you select in the Main webpage. For this to work, the Main webpage has to tell the MovieDetails webpage which movie the user selected. The MovieDetails page keeps track of the selected movie in its own instance variable. In this section, you will perform the following tasks:</p><ul class="ul"><li class="li"><p>Create a new component.</p></li><li class="li"><p>Assign a movie selected on the Main webpage to a variable in the MovieDetails webpage.</p></li><li class="li"><p>Create an interface for editing or deleting a movie’s information.</p></li><li class="li"><p>Create a way to navigate from Main to MovieDetails and back.</p></li></ul><p>Following this section, you will possess all of the fundamental skills necessary to create a dynamic multipage WebObjects database application.</p><a name="//apple_ref/doc/uid/TP40008108-CH100-SW24" title="Creating a new Component"></a><h3>Creating a new Component</h3><p>To create a the MovieDetails component, control-click the Components folder in the Package Explorer and choose New > WOComponent. In the New WebObjects Component dialog, change the name of the component to <code>MovieDetails</code> and click Finish. The new component appears in the Components folder below <code>Main WO</code>.</p><a name="//apple_ref/doc/uid/TP40008108-CH100-SW25" title="Configuring MovieDetails.html and MovieDetails.wod"></a><h3>Configuring MovieDetails.html and MovieDetails.wod</h3><p>The MovieDetails webpage is very similar to the Main webpage in structure and appearance, consisting of an input form with two submit buttons: a Save button and a Delete Movie button. Consequently, the HTML and WOD files for the MovieDetails webpage are nearly identical to their Main webpage counterparts.</p><p>Add the following HTML to <code>MovieDetails.html</code>:</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN"><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;html><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;head><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;title>Movie Details&lt;/title><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/head><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;body><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;h2>Movie Details&lt;/h2><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;webobject name="Message">&lt;/webobject>&lt;br><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;webobject name="EditForm"><span></span></pre></td></tr><tr><td scope="row"><pre>            Title:&lt;webobject name="TitleField">&lt;/webobject>&lt;br><span></span></pre></td></tr><tr><td scope="row"><pre>            Category:&lt;webobject name="CategoryField">&lt;/webobject>&lt;br><span></span></pre></td></tr><tr><td scope="row"><pre>            Date Released:&lt;webobject name="DateField">&lt;/webobject>&lt;br><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;webobject name="Save">&lt;/webobject>&lt;webobject name="Delete">&lt;/webobject><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;/webobject><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;webobject name="LinkToMain">Back to Movie Search&lt;/webobject><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/body><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/html><span></span></pre></td></tr></table></div><p>Add the following dynamic element definitions to <code>MovieDetails.wod</code>:</p><div class="codesample"><table><tr><td scope="row"><pre>Message : WOString {<span></span></pre></td></tr><tr><td scope="row"><pre>    value = message;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>EditForm : WOForm {<span></span></pre></td></tr><tr><td scope="row"><pre>    enctype = "multipart/form-data";<span></span></pre></td></tr><tr><td scope="row"><pre>    multipleSubmit = true;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>TitleField : WOTextField {<span></span></pre></td></tr><tr><td scope="row"><pre>    value = title;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>CategoryField : WOTextField {<span></span></pre></td></tr><tr><td scope="row"><pre>    value = category;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>DateField : WOTextField {<span></span></pre></td></tr><tr><td scope="row"><pre>    value = datereleased;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Save : WOSubmitButton {<span></span></pre></td></tr><tr><td scope="row"><pre>    action = saveMovie;<span></span></pre></td></tr><tr><td scope="row"><pre>    value = "Save";<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Delete : WOSubmitButton {<span></span></pre></td></tr><tr><td scope="row"><pre>    action = deleteMovie;<span></span></pre></td></tr><tr><td scope="row"><pre>    value = "Delete Movie";<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>LinkToMain : WOHyperlink {<span></span></pre></td></tr><tr><td scope="row"><pre>    pageName = "Main";<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Setting the <code>multipleSubmit</code> attribute of a <code>WOForm</code> element to <code>true</code> allows more than one submit button to be associated with that form. In this case, the Save and Delete Movie buttons are associated with the same form.</p><a name="//apple_ref/doc/uid/TP40008108-CH100-SW26" title="Configuring MovieDetails.java"></a><h3>Configuring MovieDetails.java</h3><p>Whereas the Java logic in the Main component deals with reading from the Movies database, the MovieDetails component deals with modifying the database. Users can change the title, category, and release date of a movie, or delete the movie from the database entirely.</p><p>Open <code>MovieDetails.java</code>. If Eclipse displays an error in the file, make sure that the <code>MovieDetails</code> class extends from the correct class, namely <code>WOComponent</code>.</p><p>Add the following import statements to <code>MovieDetails.java</code>:</p><div class="codesample"><table><tr><td scope="row"><pre>import com.webobjects.foundation.NSTimestamp;<span></span></pre></td></tr><tr><td scope="row"><pre>import java.text.SimpleDateFormat;<span></span></pre></td></tr><tr><td scope="row"><pre>import java.text.ParseException;<span></span></pre></td></tr><tr><td scope="row"><pre>import java.util.Date;<span></span></pre></td></tr><tr><td scope="row"><pre>import your.app.eo.Movie;<span></span></pre></td></tr></table></div><p>The <code>MovieDetails</code> class requires the following instance variables:</p><div class="codesample"><table><tr><td scope="row"><pre>private Movie movie;                   // The movie for which the details are displayed.<span></span></pre></td></tr><tr><td scope="row"><pre>private SimpleDateFormat formatter;    // A utility class for converting between date formats.<span></span></pre></td></tr><tr><td scope="row"><pre>private String category;               // The value of the Category text field.<span></span></pre></td></tr><tr><td scope="row"><pre>private String datereleased;           // The value of the Date Released text field.<span></span></pre></td></tr><tr><td scope="row"><pre>private String message;                // The value of a message that indicates operation success or errors.<span></span></pre></td></tr><tr><td scope="row"><pre>private String title;                  // The value of the Title text field.<span></span></pre></td></tr></table></div><p>Create setter and getter accessor methods for each variable as you did in <code>Main.java</code>. The <code>formatter</code> instance variable does not directly contribute to HTML content, so it does not require setter or getter methods. The <code>MovieDetails</code> class populates the <code>category</code>, <code>datereleased</code>, and <code>title</code> instance variables with values taken from <code>movie</code>. As a result, <code>setMovie</code> requires slightly more logic than a simple assignment statement.</p><div class="codesample"><table><tr><td scope="row"><pre>public void setMovie (Movie m) {<span></span></pre></td></tr><tr><td scope="row"><pre>    movie = m;<span></span></pre></td></tr><tr><td scope="row"><pre>    setTitle(movie.title().trim());<span></span></pre></td></tr><tr><td scope="row"><pre>    setCategory(movie.category().trim());<span></span></pre></td></tr><tr><td scope="row"><pre>    setDatereleased(formatter.format(movie.datereleased()));<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Two instance variables, <code>formatter</code> and <code>message</code>, need to be instantiated in the constructor of <code>MovieDetails</code>. Add the following two lines to the constructor:</p><div class="codesample"><table><tr><td scope="row"><pre>formatter = new SimpleDateFormat("M/d/y");<span></span></pre></td></tr><tr><td scope="row"><pre>message = "";<span></span></pre></td></tr></table></div><p>The <code>MovieDetails</code> class requires two additional methods, one for each submit button. The first, <code>saveMovie</code>, alters the current movie’s row in the database to reflect changes made by the user:</p><div class="codesample"><table><tr><td scope="row"><pre>public WOComponent saveMovie() {<span></span></pre></td></tr><tr><td scope="row"><pre>    if (movie.title() == null) {<span></span></pre></td></tr><tr><td scope="row"><pre>        setMessage("Error: Title is required.");<span></span></pre></td></tr><tr><td scope="row"><pre>        return context().page();<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    Date newDate = null;<span></span></pre></td></tr><tr><td scope="row"><pre>    try {<span></span></pre></td></tr><tr><td scope="row"><pre>        newDate = formatter.parse(datereleased);<span></span></pre></td></tr><tr><td scope="row"><pre>    } catch (ParseException e) {<span></span></pre></td></tr><tr><td scope="row"><pre>        setMessage("Error: Date must be in mm/dd/yy format.");<span></span></pre></td></tr><tr><td scope="row"><pre>        return context().page();<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    movie.setTitle(title);<span></span></pre></td></tr><tr><td scope="row"><pre>    movie.setCategory(category);<span></span></pre></td></tr><tr><td scope="row"><pre>    movie.setDatereleased(new NSTimestamp(newDate));<span></span></pre></td></tr><tr><td scope="row"><pre>    session().defaultEditingContext().saveChanges();<span></span></pre></td></tr><tr><td scope="row"><pre>    setMessage("Movie Saved.");<span></span></pre></td></tr><tr><td scope="row"><pre>    return context().page();<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Calling <code>saveChanges</code> on the default editing context will save any modifications of enterprise objects to the database. This includes alterations to a row, inserting a row, and deleting a row.</p><p>The second method, <code>deleteMovie</code>, deletes the movie from the database:</p><div class="codesample"><table><tr><td scope="row"><pre>public WOComponent deleteMovie() {<span></span></pre></td></tr><tr><td scope="row"><pre>    session().defaultEditingContext().deleteObject(movie);<span></span></pre></td></tr><tr><td scope="row"><pre>    session().defaultEditingContext().saveChanges();<span></span></pre></td></tr><tr><td scope="row"><pre>    return pageWithName("Main");<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Because deleting a movie should prevent the user from subsequently editing it, <code>deleteMovie</code> returns the user to the Main webpage instead of reloading the MovieDetails webpage.</p><a name="//apple_ref/doc/uid/TP40008108-CH100-SW27" title="Connecting the Main Webpage to the MovieDetails Webpage"></a><h3>Connecting the Main Webpage to the MovieDetails Webpage</h3><p>So far, there is no way to reach the MovieDetails webpage from the Main webpage, because the search results produced by the Main webpage are in plaintext. Each result should instead be a hyperlink to a corresponding MovieDetails webpage. This requires small changes to the HTML and WOD files of the Main component.</p><p>In <code>Main.html</code>, change the line that reads:</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;webobject name = "ResultTitle">&lt;/webobject>&lt;br><span></span></pre></td></tr></table></div><p>To the following:</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;webobject name = "MovieLink">&lt;webobject name = "ResultTitle">&lt;/webobject>&lt;/webobject>&lt;br><span></span></pre></td></tr></table></div><p>Add the following dynamic element definition to <code>Main.wod</code>:</p><div class="codesample"><table><tr><td scope="row"><pre>MovieLink : WOHyperlink {<span></span></pre></td></tr><tr><td scope="row"><pre>    action = showDetails;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Finally, add the <code>showDetails</code> method to <code>Main.java</code>:</p><div class="codesample"><table><tr><td scope="row"><pre>public WOComponent showDetails() {<span></span></pre></td></tr><tr><td scope="row"><pre>    MovieDetails detailsPage = (MovieDetails)pageWithName("MovieDetails");<span></span></pre></td></tr><tr><td scope="row"><pre>    detailsPage.setMovie(movie);<span></span></pre></td></tr><tr><td scope="row"><pre>    return detailsPage;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40008108-CH100-SW28" title="Inserting Movies into the Database"></a><h3>Inserting Movies into the Database</h3><p>Database applications that support deleting from a database most likely support inserting into the database as well. The steps for creating this functionality are essentially identical to the steps you took to create the search functionality.</p><ol class="ol"><li class="li"><p>Add necessary <code>webobject</code> elements to <code>Main.html</code> to create a form that allows the user to specify a title, category, and release date.</p></li><li class="li"><p>Add corresponding element definitions to <code>Main.wod</code>.</p></li><li class="li"><p>Add necessary instance variables to <code>Main.java</code>, along with a method for adding a new movie. The main logic of the method looks like the following:</p><div class="codesample"><table><tr><td scope="row"><pre>public WOComponent insertMovie() {<span></span></pre></td></tr><tr><td scope="row"><pre>    Movie newMovie = Movie.createMovie(session().defaultEditingContext(), newtitle);<span></span></pre></td></tr><tr><td scope="row"><pre>    newMovie.setCategory(newcategory);<span></span></pre></td></tr><tr><td scope="row"><pre>    newMovie.setDatereleased(formatter.format(newdatereleased));<span></span></pre></td></tr><tr><td scope="row"><pre>    session().defaultEditingContext().saveChanges();<span></span></pre></td></tr><tr><td scope="row"><pre>    return context().page();<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>For improved user experience, add error checking and message updates to the method.</p></li></ol>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../InstallingEclipseandtheWOLipsPlug-in/InstallingEclipseandtheWOLipsPlug-in.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../DeployingAWebObjectsApplication/DeployingAWebObjectsApplication.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2009 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2009-02-04<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/DeveloperTools/Conceptual/WOTutorial/DatabaseApplication/DatabaseApplication.html%3Fid%3DTP40008108-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/DeveloperTools/Conceptual/WOTutorial/DatabaseApplication/DatabaseApplication.html%3Fid%3DTP40008108-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/DeveloperTools/Conceptual/WOTutorial/DatabaseApplication/DatabaseApplication.html%3Fid%3DTP40008108-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>