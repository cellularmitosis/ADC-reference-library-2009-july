<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>InsertResMenu(IM:Tb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING148></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Toolbox-147.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-149.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Toolbox-2.html"><B>Macintosh Toolbox Essentials</B></A> / <BR><DD><A HREF="Toolbox-89.html"><B>Chapter 3 - Menu Manager</B></A> / <A HREF="Toolbox-107.html"><B>Menu Manager Reference</B></A><BR><DL><DD><A HREF="Toolbox-112.html"><B>Menu Manager Routines</B></A> / <A HREF="Toolbox-143.html"><B>Adding and Deleting Menu Items</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING148-0></A>
<H3><A NAME=MARKER-9-595></A>InsertResMenu</H3>
 <A NAME=MARKER-11-596></A><A NAME=MARKER-2-597></A>Use the <CODE>InsertResMenu</CODE> procedure to search all resource files open to your application for a given resource type and to insert the names of any resources it finds to a specified menu. The items are inserted after the specified menu item. The specified menu must have been previously created using <CODE>NewMenu</CODE>, <CODE>GetMenu</CODE>, or <CODE>GetNewMBar</CODE>.<P>
<PRE>
PROCEDURE InsertResMenu (theMenu: MenuHandle; theType: ResType;
                         afterItem: Integer); 
</PRE>
<DL>
<DT><CODE>theMenu</CODE>
<DD> A handle to the menu record of the menu to which to add the names of any resources of a given type that <CODE>InsertResMenu</CODE> finds.
<DT><CODE>theType</CODE>
<DD> A four-character code that identifies the resource type for which to search.
<DT><CODE>afterItem</CODE>
<DD> A number that indicates where in the menu to insert the names of any resources of the given type that <CODE>InsertResMenu</CODE> finds. Specify 0 in the <CODE>afterItem</CODE> parameter to insert the items before the first menu item; specify the item number of a menu item already in the menu to insert the items after the specified item number. If you specify a number greater than or equal to the last item in the menu, the items are inserted at the end of the menu.
</DL>
<A NAME=HEADING148-6></A>
<H5>DESCRIPTION</H5>
 The <CODE>InsertResMenu</CODE> procedure searches all resource files open to your application for resources of the type defined by the parameter <CODE>theType</CODE>. It inserts the names of any resources it finds of the given type at the specified location in the specified menu. <CODE>InsertResMenu</CODE> adds the names of found resources in alphabetical order; it does not alphabetize items already in the menu. <P>
 The <CODE>InsertResMenu</CODE> procedure does not add resources with names that begin with a period (<CODE>.</CODE>) or a percent sign (<CODE>%</CODE>) to the menu.<P>
 The <CODE>InsertResMenu</CODE> procedure assigns default characteristics to each menu item. Each appended menu item appears in the menu as an enabled item, without an icon or a mark, in the plain character style, and without a keyboard equivalent. To get the name or to change other characteristics of an item appended by <CODE>InsertResMenu</CODE>, use the Menu Manager routines described in the next section, <A HREF=Toolbox-149.html#MARKER-9-602>"Getting and Setting the Appearance of Menu Items."</A><P>
 If you specify that <CODE>InsertResMenu</CODE> add resources of type <CODE>'DRVR'<DFN> to your Apple menu, InsertResMenu adds the name (and icon) of each item in the Apple Menu Items folder to the menu. <A NAME=MARKER-2-598></A><A NAME=MARKER-2-599></A></DFN></CODE><P>
 If you specify that <CODE>InsertResMenu</CODE> add resources of type <CODE>'FONT'</CODE> or <CODE>'FOND'<DFN>,</DFN></CODE> the Menu Manager performs special processing for any resources it finds that have font numbers greater than $4000. If the script associated with the font name is currently active, <CODE>InsertResMenu</CODE> stores information in the <CODE>itemDefinitions</CODE> array (in the <CODE>itemIcon</CODE> and <CODE>itemCmd</CODE> fields for that item) in the menu's menu record that allows the Menu Manager to display the font name in the correct script.<A NAME=MARKER-2-600></A><P>
<A NAME=HEADING148-12></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 The <CODE>InsertResMenu</CODE> procedure calls the Resource Manager procedure <CODE>SetResLoad</CODE> (specifying <CODE>TRUE</CODE> in the <CODE>load</CODE> parameter) before returning. The <CODE>InsertResMenu</CODE> procedure reads the resource data of the resources it finds into memory. If your application does not want the Resource Manager to read resource data into memory when your application calls other routines that read resources, you need to call <CODE>SetResLoad</CODE> and specify <CODE>FALSE</CODE> in the <CODE>load</CODE> parameter after <CODE>InsertResMenu</CODE> returns. <A NAME=MARKER-2-601></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Toolbox-147.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-149.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Toolbox-3.html">&copy; Apple Computer, Inc.</A><br>11 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
