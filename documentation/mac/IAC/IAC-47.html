<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Calling a Format I/O Function(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING47></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-46.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-48.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-23.html"><B>Chapter 2 - Edition Manager</B></A> / <A HREF="IAC-40.html"><B>Subscribing to Non-Edition Files</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING47-0></A>
<H2><A NAME=MARKER-9-378></A><A NAME=MARKER-21-379></A>Calling a Format I/O Function</H2>
 To indicate to the Edition Manager which format I/O function to use, use the <CODE>CallFormatIOProc</CODE> function.<A NAME=MARKER-2-271></A><P>
<PRE>
err := CallFormatIOProc (selector, PB, routine);
</PRE>
 Set the <CODE>selector</CODE> parameter to one of the format I/O verbs. The format I/O verbs include <A NAME=MARKER-2-277></A><P>
<UL>
<LI><CODE>ioHasFormat</CODE>
<LI><CODE>ioReadFormat</CODE>
<LI><CODE>ioNewFormat</CODE>
<LI><CODE>ioWriteFormat</CODE><P>
</UL>
 The <CODE>PB</CODE> parameter of the <CODE>CallFormatIOProc</CODE> function contains a format I/O parameter block.<A NAME=MARKER-2-382></A><P>
<PRE>
TYPE FormatIOParamBlock = 
   RECORD
      ioRefNum:      LongInt;       {reference number}
      format:        FormatType;    {edition format type}
      formatIndex:   LongInt;       {opener-specific enumeration }
                                    { of formats}
      offset:        LongInt;       {offset into format}
      buffPtr:       Ptr;           {data starts here}
      buffLen:       LongInt;       {length of data}
   END;
</PRE>
 The <CODE>routine</CODE> parameter of the <CODE>CallFormatIOProc</CODE> function is a pointer to a format<BR>I/O function.<P>
 The following list shows which fields of <CODE>FormatIOParamBlock</CODE> are used by the format I/O verbs:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Format I/O verb<TH>&nbsp;<TH>Parameter<TH>Description<TH>Called by  <TR>
<TD>ioHasFormat<TD>--><TD>ioRefNum<TD>I/O reference number returned by opener.<TD rowspan=5><CODE>EditionHasFormat</CODE>, <CODE>GetStandardFormats</CODE>, and <CODE>ReadEdition</CODE> functions<TR>
<TD>&nbsp;<TD>--><TD>format<TD>Check for this format.<TR>
<TD>&nbsp;<TD><--<TD>formatIndex<TD>An optional enumeration of the supplied format.<TR>
<TD>&nbsp;<TD><--<TD>buffLen<TD>If found, return the length size or -1 if size is unknown.<TR>
<TD>&nbsp;<TD><--<TD>Return value<TD>A <CODE>noErr</CODE> or <CODE>noTypeErr</CODE> code.<TR>
<TD>&nbsp;<TD>&nbsp;<TD>&nbsp;<TD>&nbsp;<TD>&nbsp;<TR>
<TD>ioReadFormat<TD>--><TD>ioRefNum<TD>I/O reference number returned by opener.<TD rowspan=5><CODE>ReadEdition</CODE> and <CODE>GetStandardFormats</CODE> functions<TR>
<TD>&nbsp;<TD>--><TD>format<TD>Get this format.<TR>
<TD>&nbsp;<TD>--><TD>formatIndex<TD>Value returned by <CODE>ioHasFormat</CODE>.<TR>
<TD>&nbsp;<TD>--><TD>offset<TD>Read format beginning from this offset.<TR>
<TD>&nbsp;<TD>--><TD>buffPtr<TD>Put data beginning here.<TR>
<TD>&nbsp;<TD><-><TD>buffLen<TD>Specify buffer length to read, and return actual amount received.<TD>&nbsp;<TR>
<TD>&nbsp;<TD><--<TD>Return value<TD>A <CODE>noErr</CODE> code, or appropriate error code.<TD>&nbsp;<TR>
<TD>ioNewFormat<TD>--><TD>ioRefNum<TD>I/O reference number returned by opener.<TD rowspan=4><CODE>SetEditionFormatMark</CODE>and <CODE>WriteEdition</CODE> functions<TR>
<TD>&nbsp;<TD>--><TD>format<TD>Create this format.<TR>
<TD>&nbsp;<TD><--<TD>formatIndex<TD>An optional enumeration of the supplied format.<TR>
<TD>&nbsp;<TD><--<TD>Return value<TD>A <CODE>noErr</CODE> code, or appropriate error code.<TR>
<TD>ioWriteFormat<TD>--><TD>ioRefNum<TD>I/O reference number returned by opener.<TD><CODE>WriteEdition</CODE> function<TR>
<TD>&nbsp;<TD>--><TD>format<TD>Get this format.<TD>&nbsp;<TR>
<TD>&nbsp;<TD>--><TD>formatIndex<TD>Value returned by <CODE>ioNewFormat</CODE>.<TD>&nbsp;<TR>
<TD>&nbsp;<TD>--><TD>offset<TD>Write format beginning from this offset.<TD>&nbsp;<TR>
<TD>&nbsp;<TD>--><TD><CODE>buffPtr</CODE><TD>Get data beginning here.<TD>&nbsp;<TR>
<TD>&nbsp;<TD><-><TD><CODE>buffLen</CODE><TD>Specify buffer length to write.<TD>&nbsp;<TR>
<TD>&nbsp;<TD><--<TD>Return value<TD>A <CODE>noErr</CODE> code or appropriate error code.<TD>&nbsp;</TABLE>
<P>
 The marks for each format are kept by the Edition Manager. The format I/O function only needs to be able to read or write, beginning at any offset. If you know that your application always reads an entire format sequentially, you can ignore the offset. <A NAME=MARKER-2-383></A><A NAME=MARKER-9-276></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-46.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-48.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
