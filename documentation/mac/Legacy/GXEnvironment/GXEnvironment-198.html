<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Replacing Items in a Collection(IM: XU)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING198></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="GXEnvironment-197.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="GXEnvironment-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="GXEnvironment-445.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="GXEnvironment-199.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="GXEnvironment-2.html"><B>QuickDraw GX Environment and Utilities</B></A> / <BR><DD><A HREF="GXEnvironment-182.html"><B>Chapter 5 - Collection Manager</B></A> / <A HREF="GXEnvironment-188.html"><B>Using the Collection Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING198-0></A>
<H2><A NAME=MARKER-9-65></A>Replacing Items in a Collection</H2>
 The Collection Manager provides two methods for replacing items in a collection:<P>
<UL>
<LI>You can use the <CODE>AddCollectionItem</CODE> function, specifying the collection tag and collection ID of an existing item.
<LI>You can use the <CODE>ReplaceIndexedCollectionItem</CODE> function, specifying the collection index of an existing item.<P>
</UL>
<DL>
<DT><B>Note</B>
<DD>The Collection Manager also provides the utility functions, <CODE>AddCollectionItemHdl</CODE> and <CODE>ReplaceCollectionItemHdl</CODE>, which allow you to specify a handle, rather than a pointer, to the item's data. See <A HREF=GXEnvironment-259.html#MARKER-9-245>"Working With Macintosh Memory Manager Handles" beginning on page 5-92</A> for more information about these functions.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 The new item does not have to be the same size as the replaced item. For example, <A HREF=#MARKER-9-68>Listing 5-10</A> shows how you can use the <CODE>AddCollectionItem</CODE> function to replace the data in a collection item with a new data of a different length. (This example uses the collection created in <A HREF=GXEnvironment-193.html#MARKER-9-43>"Adding Items to a Collection" beginning on page 5-17</A>, in which the item identified by the collection tag <CODE>'QUOT'</CODE> and the collection ID 1 contains the 29-character string "Fourscore and seven years ago")<P>
<B>Listing 5-10  <A NAME=MARKER-9-68></A>Replacing an item in a collection</B><P>
<PRE>
anErr = AddCollectionItem(pointsAndQuotes, 
                          'QUOT', 1, 
                          22, &quot;Eighty-seven years ago&quot;);
</PRE>
 <BR>You cannot replace a collection item if its lock attribute is set. For example, the previous section shows how to set the lock attribute of the item with the collection tag <CODE>'QUOT'</CODE> and the collection ID 0. If you try to replace this item using<P>
<PRE>
anErr = AddCollectionItem(pointsAndQuotes, 
                          'QUOT', 0, 
                          24, &quot;Plus c'est la meme chose&quot;);
</PRE>
 the code sets the <CODE>anErr</CODE> variable to the <CODE>collectionItemLockedErr</CODE> value and the Collection Manager does not replace the item.<P>
 If you know the collection index of an item, you can use the <CODE>ReplaceIndexedCollectionItem</CODE> function to replace the item. This function finds the specified item more efficiently than the <CODE>AddCollectionItem</CODE> function. <A HREF=#MARKER-9-69>Listing 5-11</A> shows an example of this function.<P>
<B>Listing 5-11  <A NAME=MARKER-9-69></A>Replacing an item using the item's index</B><P>
<PRE>
long index;
.
.
.
/* find the index. */
anErr = GetCollectionItemInfo(pointsAndQuotes, 
                              'QUOT', 1,
                              &amp;index,
                              dontWantSize,
                              dontWantAttributes);
.
.
.
/* replace the item. */
anErr = ReplaceIndexedCollectionItem(pointsAndQuotes, 
                                     index,
                                     22, 
                                     &quot;Eighty-seven years ago&quot;);
</PRE>
 The example in <A HREF=#MARKER-9-69>Listing 5-11</A> uses the <CODE>GetCollectionItemInfo</CODE> function to find the collection index that the Collection Manager has assigned to the item with a collection tag of <CODE>'QUOT</CODE>' and a collection ID of 1. Finding this collection index requires some processing time. However, once you've found the item's collection index, you can use it to find information about the item quickly, because functions that search for a collection item using the item's collection index operate more efficiently than functions that search using the item's collection tag and collection ID. Typically, if you want to search for an item only once, you use the item's collection tag and collection ID. If you know that you have to search for the same item repeatedly, you find the item's collection index and use the collection index when examining or editing the item.<P>
 For more information about identifying collection items, see <A HREF=GXEnvironment-187.html#MARKER-9-23>"Methods of Identifying Collection Items" on page 5-11</A>. <P>
 For more information about the <CODE>AddCollectionItem</CODE> function and the <CODE>ReplaceIndexedCollectionItem</CODE> function, see <A HREF=GXEnvironment-228.html#MARKER-9-159>"Adding and Replacing Items in a Collection" beginning on page 5-62</A>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="GXEnvironment-197.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="GXEnvironment-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="GXEnvironment-445.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="GXEnvironment-199.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="GXEnvironment-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
