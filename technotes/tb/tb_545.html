<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note TB545: List Manager Q&amp;As</title>                                       <meta name="categories" content="Human Interface Toolbox"><meta name="week-posted" content="Oct 1, 1990 - Oct 5, 1990"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002802" title="List Manager Q&As"></a><a name="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxMacOS9Earlier-date.html">Mac OS 9 & Earlier</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/Carbon/idxHumanInterfaceToolbox-date.html" target="_blank">Carbon > Human Interface Toolbox</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TB545</div>
<div id="pageheadsub">List Manager Q&amp;As</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext"><A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">This Technical Note contains a collection of archived Q&amp;As relating to a specifictopic--questions sent the Developer Support Center (DSC) along withanswers from the DSC engineers. Current Q&amp;A's can be found on the <A HREF = "../../qa/index.html">Macintosh Technical Q&amp;A's web site</a>.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Oct 01 1990]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><a name=Section1></A><h2>Avoid Macintosh List Manager for manipulating large matrices</h2><p>Avoid using the Macintosh List Manager for manipulating large matrices likespreadsheet cells.</p><p>The Macintosh List Manager becomes ungainly when handling more than about 500cells. With several thousand cells, such as a 100x100 matrix, it becomesdownright klunky.</p><p>Using standard techniques, the List Manager can store only 32K of data in alist. For 10,000 cells, this gives you only about 3.2 characters in a cell.It's possible to switch to a system where each cell contains a pointer to textto be drawn, but with only 3.2 characters, it's not possible to store a fullpointer (4 bytes). After about 500 cells, the time needed to actually set thedata in the cells becomes noticeable, on the order of 10 to 15 seconds.</p><p>Finally, the List Manager has some pretty fundamental restrictions. You cannot,for instance, create variable-width rows or columns, or hide a single row orcolumn from a list.</p><p>For manipulating large matrices, you're much better off bypassing the ListManager entirely and writing your own spreadsheet-type mechanism. Considercaching the cells to a temporary file, depending on your memory requirements.You'll need to use the Control Manager to set up and process scroll bars, andyou should use QuickDraw to draw the contents of the cells.</p><p>Basically, writing a spreadsheet shares many of the same necessary functionsand problems as writing a text editor (replacing TextEdit). Neither one issimple, but both are possible.</p><P><A HREF="#top">Back to top</A></p><h2>Creating Macintosh columns with various widths</h2><P>Date Written:  2/8/91</p><P>Last reviewed:  6/14/93</p><p>How can I create a Macintosh List Manager list with different size cells forsome columns and different size cells for other columns?</p><p>The List Manager doesn't allow variable-sized cells. One cell size fits all, or<i>not!</i> The List Manager was designed for simple lists (such the standardget file dialog), but not for spreadsheets. The source of the limitation isfound in the <code>ListRec</code> as documented in <i>Inside Macintosh</i> Volume IV. The<code>cellSize</code> is a single variable (a Point). If multiple column widths wereallowed, some sort of array would be required to store the width for eachcolumn, and you can see from looking at the <code>ListRec</code> data structure that noprovision was made for this.</p><p>You can write your own List definition procedure, which can display alternativedata types (PICTS, ICONS, or perhaps some data type of your own devising), butthese are still limited to one cell size for the entire list. If you wish tohave columns with various widths, you will need to treat each column as aseparate list, or handle the lists entirely yourself as spreadsheet anddatabase applications do.</p><P><A HREF="#top">Back to top</A></p><h2>Code for putting a list in a modal dialog box</h2><P>Date Written:  1/23/92</p><P>Last reviewed:  6/14/93</p><p>How do I put a list in a Macintosh modal dialog box?</p><p>The sample code below puts a list in a modal dialog. There are several pointsto note to ensure success: You need to pass a draw procedure to the modaldialog for your list item. It's important to test for <code>mousedown</code> events in yourmodal dialog filter, because the List Manager doesn't check to see if you'rekidding when you tell it you have a <code>mousedown</code> (that's what calling <code>lClick</code>does...). Also, calling <code>Setport</code> on your dialog in your filter procedure is notdone for you automatically and is important when using <code>GlobalToLocal</code>.</p><p>The sample also tests <code>lGetSelect</code> to see that it works OK on these lists (itdoes). The dialog in question simply needs two items in its <code>ditl</code>, a button asitem 1 and a user item as item 2. This should work for any sized user item.</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>pascal listDraw(WindowPtr theWindow, short itemNo){    short       aItemType;    Handle      aControl;    Rect        aRect;    Rect        dBounds;    Point       aPoint;    GetDItem((DialogPtr)theWindow,itemNo,&amp;aItemType,&amp;aControl,&amp;aRect);    PenNormal();    InsetRect(&amp;aRect,-1,-1);    FrameRect(&amp;aRect);    LUpdate(theWindow-&gt;visRgn,(ListHandle)GetWRefCon(theWindow));}pascal Boolean MyFilter( DialogPtr theDialog, EventRecord *theEvent,                         short *itemHit){    short       aItemType;    Handle      aControl;    Rect        aRect;    Rect        dBounds;    Point       aPoint;    SetPort(theDialog);    GetDItem(theDialog,2,&amp;aItemType,&amp;aControl,&amp;aRect);    aPoint = theEvent-&gt;where;    GlobalToLocal(&amp;aPoint);    if (PtInRect(aPoint,&amp;aRect))      if (theEvent-&gt;what==mouseDown) {          *itemHit = 2;        LClick(aPoint,theEvent-&gt;modifiers,               (ListHandle)GetWRefCon((WindowPtr)theDialog));        return true;    };    return false ;}void DialogFiddle(){    DialogPtr   aDLog;    short       aItemType;    Handle      aControl;    Rect        aRect;    Rect        dBounds;    Point       aPoint;    ListHandle  myList;    Str255      dummy = &quot;&quot;Unselected Item&quot;&quot;;    Str255      wally = &quot;&quot;I am Selected!&quot;&quot;;    aDLog = GetNewDialog(987,(Ptr) 0, (WindowPtr) -1);    GetDItem(aDLog,2,&amp;aItemType,&amp;aControl,&amp;aRect);    SetDItem(aDLog,2,aItemType,(Handle)&amp;listDraw,&amp;aRect);    aRect.right -= 16;    dBounds.top = 0;    dBounds.bottom = 0;    dBounds.left = 0;    dBounds.right = 1;    aPoint.h = 0;    aPoint.v = 0;    myList = LNew(&amp;aRect,&amp;dBounds,aPoint,0,(WindowPtr)aDLog,                  true,false,false,true);    aItemType = LAddRow(5,0,myList);    LSetCell(&amp;dummy,15,aPoint,myList);    aPoint.v+=1;    LSetCell(&amp;dummy,15,aPoint,myList);    aPoint.v+=1;    LSetCell(&amp;dummy,15,aPoint,myList);    aPoint.v+=1;    LSetCell(&amp;dummy,15,aPoint,myList);    aPoint.v+=1;    LSetCell(&amp;dummy,15,aPoint,myList);    (**myList).selFlags = -128;    SetWRefCon((WindowPtr)aDLog,(long)myList);    do {        aPoint.h = 0;        aPoint.v = 0;        ModalDialog(&amp;MyFilter,&amp;aItemType);        if (aItemType=2)          if (LGetSelect(true,&amp;aPoint,myList))            LSetCell(&amp;wally,14,aPoint,myList);    } while (aItemType==2);    DisposDialog(aDLog);</pre>	</TD></TR></TABLE></CENTER>         <a name="Downloads"></a>       <P><A HREF="#top">Back to top</A></p><h2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (44K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/tb_545.pdf">Download</A></P>               </TD>            </TR>                    </TABLE>         <BR></TD></TR></table></center><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tb/tb_545.html%3Fid%3DDTS10002802-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tb/tb_545.html%3Fid%3DDTS10002802-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tb/tb_545.html%3Fid%3DDTS10002802-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>