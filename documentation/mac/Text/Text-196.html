<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>How the Font Manager Scales Fonts(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING196></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-195.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-197.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-181.html"><B>Chapter 4 - Font Manager</B></A> / <A HREF="Text-193.html"><B>About the Font Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING196-0></A>
<H2><A NAME=MARKER-9-147></A>How the Font Manager Scales Fonts</H2>
 <B><A NAME=MARKER-2-176></A>Font scaling<A NAME=MARKER-2-8></A></B> is the process of changing a glyph from one size or shape to another. The Font Manager and QuickDraw can scale bitmapped and outline fonts in three ways: changing a glyph's point size, modifying the glyph (but not its point size) for display on a different device, and altering the shape of the glyph. <P>
 For bitmapped fonts, the Font Manager does not actually perform scaling of the glyph bitmaps. Instead, the Font Manager finds an appropriate font and computes the horizontal and vertical scaling factors that QuickDraw must apply to scale the bitmaps. QuickDraw performs all modifications of bitmapped font glyphs.<P>
 The simplest form of scaling occurs when the Font Manager returns scaling factors for QuickDraw to change a glyph from one point size to another on the same display device. If the glyph is bitmapped and the requested font size is not available, there are certain rules the Font Manager follows to create a new bitmapped glyph from an existing one (see <A HREF=#MARKER-9-162>"The Scaling Process for a Bitmapped Font" on page 4-21</A>). If the glyph is from an outline font, the Font Manager uses the outline for that glyph to create a bitmap.<P>
 <A HREF=#MARKER-9-152>Figure 4-4</A> shows how the Font Manager and QuickDraw scale a bitmapped font and an outline font from 9 points to 40 points for screen display. The sizes of the bitmapped fonts available to the Font Manager to create all 32 sizes were 9, 10, 12, 14, 18, and 24 points. A single glyph outline produces a smoother bitmap in all point sizes.<A NAME=MARKER-2-183></A> <A NAME=MARKER-2-65></A><P>
<B>Figure 4-4  <A NAME=MARKER-9-152></A>A comparison of scaled bitmapped and outline fonts</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/FM-05.jpg">
 The Font Manager produces better results by scaling glyphs from outline fonts, because it changes the font's original outline to the new size or shape, and then makes the bitmap. Outlines give better results than bitmaps when scaled, because the outlines are intended for use at all point sizes, whereas the bitmaps are not.<P>
 The Font Manager also determines that a glyph must be scaled when moving it from one device to another device with a different resolution: for instance, from the screen to a printer. A bitmap that is 72 pixels high on a 72-dpi screen measures one inch, but on a 144-dpi printer it measures a half inch. In order to print a figure the same size as the original screen bitmap, QuickDraw needs a bitmap twice the size of the original. If there are no bitmaps available in twice the point size of the bitmap that appears on the screen, the Font Manager returns the proper scaling factors, and QuickDraw scales the original bitmap to twice its original size in order to draw it on the printer.<P>
 With some QuickDraw calls, your application can also use the Font Manager to explicitly scale a glyph by stretching or shrinking it, which changes the glyph from a familiar point size to something a little stranger--for example, a glyph that is 12 points high but as wide as a whole page of text. Your application tells the Font Manager how to scale a glyph using <A NAME=MARKER-2-392></A><B>font scaling factors,</B> which are represented as proportions or fractions that indicate how the Font Manager should scale the glyph in the vertical and horizontal directions. The ratio given by the font scaling factors determines whether the glyph grows or shrinks: if the ratio is greater than one, the glyph increases in size, and if it is less than one, the glyph decreases in size. If the font scaling factors are 1-to-1 (1/1) for both horizontal and vertical scaling, the glyph does not change size.<A NAME=MARKER-2-936></A> <A NAME=MARKER-2-58></A><P>
 In some circumstances, the Font Manager finds a font and returns different scaling factors to QuickDraw. The scaling factors in a QuickDraw font request tell the Font Manager how much QuickDraw wants to scale the font, and the scaling factors returned by the Font Manager tell QuickDraw how much to actually scale the glyphs before drawing them.<P>
 <BR><BR>In <A HREF=#MARKER-9-156>Figure 4-5</A>, the font scaling factors are 2/1 in the horizontal direction and 1/1 in the vertical direction. The glyph stays the same height, but grows twice as large in width. <P>
<B>Figure 4-5  <A NAME=MARKER-9-156></A>A glyph stretched horizontally</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/FM-06.jpg">
 <BR><BR>In <A HREF=#MARKER-9-157>Figure 4-6</A>, the font scaling factors are 2/1 in the vertical direction and 1/1 in <BR>the horizontal direction. The glyph stays the same width, but grows to twice its <BR>original height.<P>
<B>Figure 4-6  <A NAME=MARKER-9-157></A>A glyph stretched vertically</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/FM-07.jpg">
<BR><BR> In <A HREF=#MARKER-9-158>Figure 4-7</A>, the font scaling factors are 1/1 in the vertical direction and 1/2 in the horizontal direction. The glyph stays the same height but retains only half its width.<P>
<B>Figure 4-7  <A NAME=MARKER-9-158></A>A glyph condensed horizontally</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/FM-08.jpg">
 If the font scaling factors are 2/1 in both directions and the font is an outline font, then the Font Manager computes the size of the glyph as twice the specified size and QuickDraw draws the glyph. With bitmapped fonts, QuickDraw first looks for a bitmap at twice the size of the original before redrawing the glyph at the new point size. <P>
 Many routines use the value of the font scaling factors in order to calculate the best measurements for text in the current graphics port record. You can find the current horizontal and vertical scaling factors in the global variables <CODE>FScaleHFact</CODE> and <CODE>FScaleVFact</CODE>. The exact value of the font output scaling factors can be found by multiplying the value of the global width table's <CODE>hOutput</CODE> and <CODE>vOutput</CODE> fields by the values of the <CODE>hFactor</CODE> and <CODE>vFactor</CODE> fields, also of the global width table, respectively. The description of the global width table begins on <A HREF=Text-213.html#MARKER-9-315>page 4-39</A><A NAME=MARKER-2-159></A>.<A NAME=MARKER-2-160></A><P>
<A NAME=HEADING196-22></A>
<H3><A NAME=MARKER-2-161></A><A NAME=MARKER-9-162></A>The Scaling Process for a Bitmapped Font</H3>
 Although the Font Manager does not scale the glyph bitmaps of a bitmapped font, it does compute the scaling factors that QuickDraw uses to perform the scaling. The Font Manager computes scaling factors other than 1/1 when the exact point size requested is not available. Font scaling is the default behavior; however, you can disable it, as described below. When the Font Manager cannot find the proper bitmapped font that QuickDraw has requested and font scaling is enabled, it uses the following procedure:<P>
<OL>
<LI>The Font Manager looks for a font of the same font family that is twice the size of the font requested. If it finds that font, the Font Manager computes and returns to QuickDraw factors to scale it down to the requested size.
<LI>The Font Manager looks for a font of the same font family that is half the size of the font requested. If it finds that font, the Font Manager computes and returns to QuickDraw factors to scale it up to the requested size.
<LI>The Font Manager looks for a font of the same font family that is the next larger size of the font requested. If it finds that font, the Font Manager computes and returns to QuickDraw factors to scale it down to the requested size.
<LI>The Font Manager looks for a font of the same font family that is the next smaller size of the font requested. If it finds that font, the Font Manager computes and returns to QuickDraw factors to scale it up to the requested size.
<LI>If the Font Manager cannot find any size of that font family, it returns the application font, system font, or neighborhood base font, as described in the section <A HREF=Text-195.html#MARKER-9-142>"How the Font Manager Responds to a Font Request" beginning on page 4-17</A>. The Font Manager computes and returns to QuickDraw the factors to scale that font to the requested size.<P>
</OL>
 You can disable the scaling of bitmapped fonts in your programs by calling the <CODE>SetFScaleDisable</CODE> procedure. When the Font Manager cannot find the proper bitmapped font that QuickDraw has requested and font scaling is disabled, the Font Manager looks for a different font to substitute instead of scaling. The <CODE>SetFScaleDisable</CODE> procedure is described on <A HREF=Text-237.html#MARKER-9-384>page 4-55</A>.<A NAME=MARKER-2-584></A><P>
 With scaling disabled, the Font Manager looks for a font with characters with the correct width, which may mean that their height is smaller than the requested size. The Font Manager returns this font and returns scaling factors of 1/1, so that QuickDraw does not scale the bitmaps. QuickDraw draws the smaller font, the widths of which produce the spacing of the requested font. This is faster than font scaling and accurately mirrors the word spacing and line breaks that the document will have when printed, especially if fractional character widths are used. Disabling and enabling of font scaling are described in the section <A HREF=Text-208.html#MARKER-9-282>"Using Fractional Glyph Widths and Font Scaling" on page 4-34</A>.<P>
<DL>
<DT><B>Note</B>
<DD>A font request made with scaling disabled does not necessarily return the same result as an identical request with scaling enabled. The widths are sure to be the same only if fractional widths are enabled, the font does not have a glyph-width table, and the font is a member of a family record with a family character-width table. Fractional widths and width tables are discussed in <A HREF=Text-197.html#MARKER-9-170>"How the Font Manager Calculates Glyph Widths" on page 4-22</A>.<EM></EM><A NAME=MARKER-2-164></A><A NAME=MARKER-9-675></A>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
<A NAME=HEADING196-32></A>
<H3><A NAME=MARKER-2-166></A>The Scaling Process for an Outline Font</H3>
 The Font Manager always scales an outline font in order to produce a bitmapped glyph in the requested size, regardless of whether font scaling for bitmapped fonts is enabled or disabled. An outline font is considered to be the model for all possible point sizes, so the Font Manager is not scaling it from one "real" size to a "created" size, the way it does with a bitmapped font; it is drawing the outline in the requested point size, so that it can then create the bitmapped glyph. <A NAME=MARKER-2-74></A><A NAME=MARKER-2-783></A><A NAME=MARKER-2-846></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-195.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-197.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
