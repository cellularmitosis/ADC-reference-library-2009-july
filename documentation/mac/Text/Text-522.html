<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>About WorldScript I(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING522></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-521.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-523.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-514.html"><B>Appendix A - Built-in Script Support</B></A> / <A HREF="Text-521.html"><B>WorldScript I</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING522-0></A>
<H2>About WorldScript I</H2>
 Script<DFN> </DFN>systems developed prior <DFN>to system software version 7.1 contain their own code to handle language-specific text processing. Each script system also has its own initialization and configuration code, installing itself at startup and adding its own modifications to the system. This process can result in a layering of patches to the same traps, inconsistent behavior, and inefficient use of memory.</DFN><P>
 WorldScript I redefines what a script system consists of by combining the executable code for many routines for all 1-byte script systems. It includes initialization and formatting routines that support all contextual forms required by all 1-byte scripts; script-specific behavior is encoded in resource-based tables. This approach reduces memory requirements for multiscript systems and avoids layering of patches.<P>
 WorldScript I routes script-aware calls through each universal script's own <I>dispatch table;</I> the dispatch table initially points back to the <I>script utility</I> routines in WorldScript I. This indirection allows your application to add to or replace existing routines on a script-by-script basis. Script Manager calls allow you to modify or add to any script's utility routine or patch. You can even replace an individual script system's routine completely if you need features significantly different from those provided by WorldScript I. Script utilities and dispatch tables are described in the next section and under <A HREF=#MARKER-9-107>"Flexible Dispatching Method" beginning on page A-28</A>.<P>
<A NAME=HEADING522-4></A>
<H3><A NAME=MARKER-9-101></A>Shared Script Utilities and QuickDraw Patches</H3>
 <A NAME=MARKER-2-59></A>The <A NAME=MARKER-9-60></A><B>script utilities</B> are the low-level routines through which an individual script system implements script-aware Text Utilities, QuickDraw, and Script Manager routines. When an application makes a script-aware call, the script management system converts it to a script utility call and passes it on to the appropriate script system. Previous to system software version 7.1, individual script systems provided their own script utilities. With WorldScript I, a single set of script utilities can work with all 1-byte complex scripts.<P>
 Two Script Manager routines, <CODE>GetScriptUtilityAddress</CODE> and <CODE>SetScriptUtilityAddress<DFN>, </DFN></CODE>allow you to access and override a script's <BR>utility routines.<P>
 <A HREF=#MARKER-9-43>Table A-11</A> lists the script utilities implemented by WorldScript I, along with the chapters in this book that describe their corresponding high-level routines.
<TABLE BORDER="0" CELLPADDING=3>
<CAPTION><A NAME=MARKER-9-43></A>Script utilities supported by WorldScript I (Continued)</CAPTION>
<TH>Script utility<TH>Chapter in this book<TH>&nbsp;<TR>
<TD><A NAME=MARKER-2-181></A>CharacterByteType<TD>Script Manager<TD>&nbsp;<TR>
<TD><A NAME=MARKER-2-182></A>CharacterType<TD>Script Manager<TD>&nbsp;<TR>
<TD><A NAME=MARKER-2-183></A>CharToPixel<TD>QuickDraw Text<TD>&nbsp;<TR>
<TD><A NAME=MARKER-2-65></A>DrawJustified<TD>QuickDraw Text<TD>&nbsp;<TR>
<TD><A NAME=MARKER-2-185></A>FillParseTable<TD>Script Manager<TD>&nbsp;<TR>
<TD><A NAME=MARKER-9-20></A><A NAME=MARKER-2-272></A>FindScriptRun<A HREF="#FOOTNOTE-9">[9]</A><TD>Text Utilities<TD>&nbsp;<TR>
<TD><A NAME=MARKER-2-16></A>FindWordBreaks <A HREF=#FOOTNOTE-9><EM>[9]</EM></A><TD>Text Utilities<TD>&nbsp;<TR>
<TD><A NAME=MARKER-2-22></A>GetScriptQDPatchAddress<TD>Script Manager<TD>&nbsp;<TR>
<TD><A NAME=MARKER-2-23></A>GetScriptUtilityAddress<TD>Script Manager<TD>&nbsp;<TR>
<TD><A NAME=MARKER-2-24></A>GetScriptVariable<A HREF="#FOOTNOTE-10">[10]</A><TD>Script Manager<TD>&nbsp;<TR>
<TD><A NAME=MARKER-2-94></A>HiliteText<TD>QuickDraw Text<TD>&nbsp;<TR>
<TD><A NAME=MARKER-9-76></A>MeasureJustified<TD>QuickDraw Text<TD>&nbsp;<TR>
<TD><A NAME=MARKER-21-77></A>PixelToChar<TD>QuickDraw Text<TD>&nbsp;<TR>
<TD><A NAME=MARKER-2-27></A>PortionLine<TD>QuickDraw Text<TD>&nbsp;<TR>
<TD><A NAME=MARKER-9-78></A>SetScriptQDPatchAddress<TD>Script Manager<TD>&nbsp;<TR>
<TD><A NAME=MARKER-2-79></A>SetScriptUtilityAddress<TD>Script Manager<TD>&nbsp;<TR>
<TD><A NAME=MARKER-2-80></A>SetScriptVariable<TD>Script Manager<TD>&nbsp;<TR>
<TD><A NAME=MARKER-2-201></A>TransliterateText<TD>Script Manager<TD>&nbsp;<TR>
<TD><A NAME=MARKER-2-73></A>VisibleLength<TD>QuickDraw Text<TD>&nbsp;<TR>
<TD colspan=3>WorldScript I supports the following script utilities for backward compatibility. They call newer versions of themselves to handle their tasks. They are: <CODE>Pixel2Char</CODE> (calls <CODE>PixelToChar</CODE>), <CODE>Char2Pixel</CODE> (calls <CODE>CharToPixel</CODE>), <CODE>DrawJust</CODE> (calls <CODE>DrawJustified</CODE>), <CODE>MeasureJust</CODE> (calls <CODE>MeasureJustified</CODE>), <CODE>PortionText</CODE> (calls <CODE>PortionLine</CODE>), <CODE>CharByte</CODE> (calls <CODE>CharacterByteType</CODE>), <CODE>CharType</CODE> (calls <CODE>CharacterType</CODE>), <CODE>ParseTable</CODE> (calls <CODE>FillParseTable</CODE>), <CODE>Transliterate</CODE> (calls <CODE>TransliterateText</CODE>).</TABLE>
<P>
 <A NAME=MARKER-2-104></A>WorldScript I also patches four standard QuickDraw text-handling routines: <CODE>StdText</CODE>, <CODE>StdTxMeas</CODE>, <CODE>MeasureText</CODE>, and <CODE>FontMetrics</CODE>. (<CODE>FontMetrics</CODE> is a Font Manager routine, but for simplicity all four routines and patches are referred to in this appendix as QuickDraw routines and patches.) The purpose of the QuickDraw patches is to lay out text according to context and line direction. The original QuickDraw routine is called after the text is laid out properly. The QuickDraw dispatch table has special entries to support developer patching of routines for printing as well as for display.<P>
 Two Script Manager routines, <CODE>GetScriptQDPatchAddress</CODE> and <CODE>SetScriptQDPatchAddress</CODE>, allow you to access and override a script's <BR>QuickDraw patches.<P>
 <A HREF=#MARKER-9-35>Table A-12</A> lists the QuickDraw patches implemented by WorldScript I, along with the chapters in this book that describe the original routines.
<TABLE BORDER="0" CELLPADDING=3>
<CAPTION><A NAME=MARKER-9-35></A><B>Table A-12 QuickDraw patches supported by WorldScript I</B></CAPTION>
<TH>QuickDraw patch<TH>Chapter in this book<TR>
<TD><A NAME=MARKER-2-32></A>FontMetrics<TD>Font Manager<TR>
<TD><A NAME=MARKER-2-33></A>MeasureText<TD>QuickDraw Text<TR>
<TD><A NAME=MARKER-2-203></A>StdText<TD>QuickDraw Text<TR>
<TD><A NAME=MARKER-9-83></A>StdTxMeas<TD>QuickDraw Text<A NAME=MARKER-9-12></A></TABLE>
<P>
<A NAME=HEADING522-11></A>
<H3>Table-Based Script Behavior</H3>
 <A NAME=MARKER-2-206></A>The shared script utilities determine script-specific characteristics from the tables in each script system's international resources.<P>
 WorldScript I uses tables in a script system's string-manipulation (<CODE>'itl2'</CODE>) resource for analyzing character types, finding word breaks, and performing case conversion. This use of tables predates the existence of WorldScript I, but WorldScript I extends the use of tables to all routines for 1-byte complex script systems. New tables that are required are put in the script's encoding/rendering (<CODE>'itl5'</CODE>) resource, using a tagged-table index for storage and retrieval. For example, the contextual formatting routines (described in the next section) uses tables in the encoding/rendering resource.<P>
 The international resources are described in the appendix "International Resources" in this book.<P>
<A NAME=HEADING522-15></A>
<H3>Contextual Formatting Routines</H3>
 <A NAME=MARKER-2-207></A>WorldScript I uses a set of table-driven routines to format text according to each script's requirements and attributes. The WorldScript I script utilities and QuickDraw patches that perform text formatting and layout rely on these table-driven routines. Each script has several tables in its encoding/rendering <DFN>(<CODE>'itl5'</CODE></DFN>) resource to specify the display characteristics of its text.<P>
<A NAME=HEADING522-17></A>
<H3><A NAME=MARKER-9-107></A>Flexible Dispatching Method</H3>
 <A NAME=MARKER-9-84></A>Each enabled script system has a<B> <A NAME=MARKER-2-85></A>script record,</B> a private data structure that holds information and addresses pertinent to that script. When an application makes a script-aware call, the script management system determines the current script and consults that script's script record for the address of the script's <A NAME=MARKER-2-86></A><B>dispatch routine</B> (which is actually part of WorldScript I). It passes the call to the dispatch routine, which uses the script's <A NAME=MARKER-2-212></A><B>dispatch table</B> to execute the proper script utility. <DFN>Every script system has its own pointer to the dispatch routine and its own </DFN>dispatch table, separate from other scripts. When the application makes a script-aware QuickDraw call, WorldScript I uses the script's QuickDraw dispatch table to execute the proper QuickDraw patch.<P>
 At run time, the application call has been converted to a lower-level script utility call or QuickDraw call. Each script utility call includes a <A NAME=MARKER-2-213></A><I>script utility selector</I>, a number that the dispatch routine uses to select the proper routine from the dispatch table.<A NAME=MARKER-2-214></A><P>
<HR>

<A NAME="FOOTNOTE-9">[9] The Script Manager handles these routines directly if the necessary tables are in the script's <CODE>'itl2'</CODE> resource. Otherwise, they are passed to WorldScript I.
<HR>

<A NAME="FOOTNOTE-10">[10] The Script Manager handles these routines directly if the standard selectors documented in this book are used. The routines are passed to WorldScript I if private selectors are used. <A NAME=MARKER-2-126></A>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-521.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-523.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
