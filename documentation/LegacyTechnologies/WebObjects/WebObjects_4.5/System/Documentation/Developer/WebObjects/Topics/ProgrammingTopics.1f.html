<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML EXPERIMENTAL 970324//EN"><HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><TITLE> Fetching Distinct Results</TITLE></HEAD><body bgcolor="#ffffff"><!--start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!--start of path --><font face="Geneva,Helvetica,Arial" size="1"><b>PATH<spacer type="horizontal" size="5">&nbsp;</b> <a href="../../../../../../index.html" target="_top">Documentation</a> <b>&gt;</b> <a href="../../../../../webobjects.html" target="_top">WebObjects 4.5</a> <b>&gt;</b>Programming Topics</font><br><br><!--end of path --><DIV><a name="top"></a><A HREF="TopicsTOC.html"><img src="up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="ProgrammingTopics.1e.html"><img src="previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="ProgrammingTopics.20.html"><img src="next.gif" border="0" width="49" height="16"></A></DIV><H1 CLASS="TopictTitle"><A NAME="pgfId=606100"> </A><A NAME="21824"> </A>Fetching Distinct Results</H1><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606101"> </A>Synopsis</H2><P CLASS="Body"><A NAME="pgfId=606102"> </A>Describes how to use the EOFetchSpecification <TT CLASS="Code">setUsesDistinct</TT> method to omit duplicate records during a fetch. </P></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606103"> </A>Discussion</H2><P CLASS="Body"><A NAME="pgfId=606104"> </A>Duplicate records sometimes appear in database fetches, usually when the fetch involves joining multiple tables to satisfy the fetch qualifier. The EOFetchSpecification allows you to specify whether you want these duplicate records with the <TT CLASS="Code">setUsesDistinct</TT> method. The EOF adaptor modifies its query based on this setting. The standard relational database adaptors add the SQL keyword <TT CLASS="Code">DISTINCT</TT> to the SQL <TT CLASS="Code">Select</TT> statement when <TT CLASS="Code">usesDistinct</TT> is set to <TT CLASS="Code">YES</TT>.</P><P CLASS="Warning"><A NAME="pgfId=613978"> </A><DIV><IMG SRC="ProgrammingTopics-10.gif"></DIV><EM CLASS="BulletSymbol">Note</EM>	EOFetchSpecification's default is <TT CLASS="Code">setUsesDistinct(NO)</TT>, which omits the<BR>	<TT CLASS="Code">DISTINCT</TT> keyword in the SQL <TT CLASS="Code">Select</TT> statement and therefore allows duplicates. <DIV><IMG SRC="ProgrammingTopics-10.gif"></DIV></P><P CLASS="Body"><A NAME="pgfId=606106"> </A>The simplest way to fetch with no duplicate records is to explicitly create the EOFetchSpecification. </P><P CLASS="Body"><A NAME="pgfId=606107"> </A>As an example, assume you want to fetch all of the movies from the Movies example database whose titles begin with &quot;S&quot; having one or more talents whose last names begin with &quot;F&quot;.</P><DIV><H4 CLASS="Code-Listing"><A NAME="pgfId=607109"> </A>Creating a fetch specification using <TT CLASS="Code">DISTINCT</TT> (Java)</H4><PRE CLASS="Code"><A NAME="pgfId=607111"> </A>public NSArray movies;<A NAME="pgfId=607115"> </A>public WOComponent fetch() {<A NAME="pgfId=607117"> </A>    EOEditingContext ec=session().defaultEditingContext();<A NAME="pgfId=607119"> </A>    EOQualifier qual=EOQualifier.qualifierWithQualifierFormat<A NAME="pgfId=614977"> </A>        (&quot;title like 'S*' AND roles.talent.lastName like 'F*'&quot;, null);<A NAME="pgfId=607121"> </A>    EOFetchSpecification fs=new EOFetchSpecification(&quot;Movie&quot;, qual, null);<A NAME="pgfId=614980"> </A>    fs.setUsesDistinct(true);<A NAME="pgfId=607125"> </A>    movies=ec.objectsWithFetchSpecification(fs);<A NAME="pgfId=607127"> </A>    return null;<A NAME="pgfId=607129"> </A>}</PRE></DIV><DIV><H4 CLASS="Code-Listing"><A NAME="pgfId=607146"> </A>Creating a fetch specification using <TT CLASS="Code">DISTINCT</TT> (Objective-C)</H4><PRE CLASS="Code"><A NAME="pgfId=607148"> </A>NSArray *movies=nil;<A NAME="pgfId=607150"> </A>- (WOComponent  *) fetch {<A NAME="pgfId=607152"> </A>    EOEditingContext *ec=[[self session] defaultEditingContext];<A NAME="pgfId=607154"> </A>    EOQualifier *qual=[EOQualifier qualifierWithQualifierFormat: <A NAME="pgfId=614967"> </A>        @&quot;title like 'S*' AND roles.talent.lastName like 'F*'&quot;];<A NAME="pgfId=607156"> </A>    EOFetchSpecification *fs=[EOFetchSpecification<A NAME="pgfId=614972"> </A>        fetchSpecificationWithEntityName: @&quot;Movie&quot;<A NAME="pgfId=614976"> </A>        qualifier: qual sortOrderings: nil];<A NAME="pgfId=607158"> </A>    [fs setUsesDistinct: YES];<A NAME="pgfId=607160"> </A>    movies =[ec objectsWithFetchSpecification: fs];<A NAME="pgfId=607162"> </A>    return nil;<A NAME="pgfId=607164"> </A>}</PRE></DIV><DIV><H4 CLASS="Code-Listing"><A NAME="pgfId=607178"> </A>SQL log</H4><PRE CLASS="Code"><A NAME="pgfId=607180"> </A>[&lt;ODBCChannel: 0xa416a0&gt; evaluateExpression: &lt;ODBCSQLExpression: &quot;SELECT DISTINCT  t0.`CATEGORY`, t0.`DATE_RELEASED`, t0.`LANGUAGE`, t0.`MOVIE_ID`, t0.`POSTER_NAME`, t0.`REVENUE`, t0.`STUDIO_ID`, t0.`TITLE`, t0.`TRAILER_NAME` FROM `TALENT` t2 , `MOVIE_ROLE` t1 , `MOVIE` t0  WHERE (t0.`TITLE` like ? AND t2.`LAST_NAME` like ?) AND t1.`TALENT_ID` = t2.`TALENT_ID` and t0.`MOVIE_ID` = t1.`MOVIE_ID`&quot; withBindings:(1:S%(title), 2:F%(lastName))&gt;]</PRE><P CLASS="Body"><A NAME="pgfId=614946"> </A></P></DIV><DIV><H3 CLASS="Heading2"><A NAME="pgfId=606136"> </A>Using DISTINCT with Large Data Types</H3><P CLASS="Body"><A NAME="pgfId=606138"> </A>Many databases do not allow the <TT CLASS="Code">DISTINCT</TT> keyword on fetches that contain columns of large data types. These data types include <TT CLASS="Code">BLOB,</TT> <TT CLASS="Code">LONG RAW</TT>, <TT CLASS="Code">LONG</TT>, and <TT CLASS="Code">MEMO</TT> columns. </P><P CLASS="Body"><A NAME="pgfId=614030"> </A>One technique to solve this problem is to split up the large data type columns into another table, and set up a to-one relationship from the master row to the row containing the large data types. This allows you to fetch using <TT CLASS="Code">DISTINCT</TT> on all the columns except the large data type column. Once you have the desired master records, you can walk the to-one relationship and get the extra large data. This technique may also save time--very large data is not retrieved until it's needed.</P></DIV></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606143"> </A>See Also</H2><UL><LI CLASS="Bulleted"><A NAME="pgfId=606144"> </A><A HREF="ProgrammingTopics.1c.html#39919" CLASS="XRef">Creating Fetch Specifications Programmatically</A></LI><LI CLASS="Bulleted"><A NAME="pgfId=606146"> </A><A HREF="ProgrammingTopics.1a.html#15933" CLASS="XRef">Fetching with an Editing Context</A></LI><LI CLASS="Bulleted"><A NAME="pgfId=606147"> </A><A HREF="ProgrammingTopics.19.html#19760" CLASS="XRef">Working with Unnormalized Tables</A></LI></UL></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606149"> </A>Questions</H2><UL><LI CLASS="Bulleted"><A NAME="pgfId=606150"> </A>	How can I eliminate duplicate records from my fetch?</LI><LI CLASS="Bulleted"><A NAME="pgfId=615000"> </A>How can I fetch from the database?</LI><LI CLASS="Bulleted"><A NAME="pgfId=614996"> </A>What is the EOF equivalent of the SQL <TT CLASS="Code">DISTINCT</TT> keyword?</LI><LI CLASS="Bulleted"><A NAME="pgfId=606151"> </A>	How do I fetch distinct records with entities that contain the <TT CLASS="Code">BLOB</TT> data type?</LI><LI CLASS="Bulleted"><A NAME="pgfId=606152"> </A>	How do I fetch distinct records using an EOFetchSpecification that I did not create?</LI></UL></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606154"> </A>Keywords</H2><UL><LI CLASS="Bulleted"><A NAME="pgfId=606155"> </A><TT CLASS="Code">DISTINCT</TT></LI><LI CLASS="Bulleted"><A NAME="pgfId=606156"> </A>SQL</LI><LI CLASS="Bulleted"><A NAME="pgfId=619457"> </A>Duplicate</LI><LI CLASS="Bulleted"><A NAME="pgfId=615010"> </A>Fetch</LI><LI CLASS="Bulleted"><A NAME="pgfId=619452"> </A>Specification</LI></UL></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606161"> </A>Revision History</H2><P CLASS="Body"><A NAME="pgfId=606162"> </A>20 July, 1998. David Scheck. First Draft.</P><P CLASS="Body"><A NAME="pgfId=615011"> </A>19 November, 1998. Clif Liu. Second Draft.</P><PRE CLASS="Code"><A NAME="pgfId=602450"> </A></PRE></DIV><HR>&#169 1999 Apple Computer, Inc.<P><A HREF="TopicsTOC.html"><img src="up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="ProgrammingTopics.1e.html"><img src="previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="ProgrammingTopics.20.html"><img src="next.gif" border="0" width="49" height="16"></A><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></BODY></HTML>