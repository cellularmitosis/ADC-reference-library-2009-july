<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>WebObjects Java Client Programming Guide (Legacy): Adding Custom Actions to Controllers</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Adding Custom Actions to Controllers"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../Resources" />
	<meta name="ROBOTS" content="NOINDEX"/>
	<link rel="stylesheet" type="text/css" href="../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30001017-CH311" title="Adding Custom Actions to Controllers"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../LegacyTechnologies/index.html#//apple_ref/doc/uid/TP30000440-TP30000470" target="_top">Legacy Documents</a> &gt; <a href="../../../LegacyTechnologies/Tools-date.html#//apple_ref/doc/uid/TP30000440-TP30000470-TP30000463" target="_top">Tools</a> &gt; <a href="../Introduction/Introduction.html#//apple_ref/doc/uid/TP30001017-CH297-TP1">WebObjects Java Client Programming Guide (Legacy)</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../T4CustomMenuItems/T4CustomMenuItems.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../T5CommonCustRules/T5CommonCustRules.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        <script type="text/javascript" language="JavaScript">placeWatermark()</script>
<div id="legacyOuterWrapper"><div align="center" id="watermark">
<div class="legacybox">
<h1>Legacy Document<span class="closebutton"><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>
        <a name="//apple_ref/doc/uid/TP30001017-CH311-TP1" title="Adding Custom Actions to Controllers"></a><h1>Adding Custom Actions to Controllers</h1><p>When building Direct to Java Client applications, it’s common to want to add actions to the application’s controllers. The default actions in a form controller are insert, delete, revert, save, and open. There are many ways to add actions to controllers and still preserve the dynamism of the application. This chapter describes some of the possible ways.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="T3CustomActions.html#//apple_ref/doc/uid/TP30001017-CH311-CIHCEJJG">Subclassing Controller Classes</a>
				
			<br/>
			
        
			
			
				<a href="T3CustomActions.html#//apple_ref/doc/uid/TP30001017-CH311-TPXREF39">Writing Custom Controller Classes</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP30001017-CH311-CIHCEJJG" title="Subclassing Controller Classes"></a><h2>Subclassing Controller Classes</h2><p><strong>Problem:</strong> You need to add actions to a controller yet still preserve the dynamic character of the controller.</p><p><strong>Solution:</strong> Subclass the controller class and use the rule system to use it throughout the application.</p><p>This technique is used in <span class="content_text"><a href="../AdvancedTutorial/AdvancedTutorial.html#//apple_ref/doc/uid/TP30001017-CH303-TPXREF137">“Extend a Controller Class”</a></span> in the chapter <span class="content_text"><a href="../AdvancedTutorial/AdvancedTutorial.html#//apple_ref/doc/uid/TP30001017-CH303-TP1">“Enhancing the Application.”</a></span> </p><p>Subclassing a controller class and writing a rule to use it is the best way to add custom actions to your application’s controllers. As well as taking real advantage of object-oriented programming, it preserves the dynamism of Direct to Java Client applications. The other mechanisms to add actions require freezing XML, and anytime you freeze XML, you lose a lot of the dynamism of the rule system.</p><p>The dynamically generated user interfaces in Java Client rely on a core set of controller classes: EOFormController, EOQueryController, and EOListController. In an application that, for example, stores images in records, you need custom actions to both select images from the file system and download them to the file system. This requires two additional action buttons in a form window, Download Image and Update Image.</p><p>To add these actions, create a new class called FormController, as shown in <span class="content_text">Listing 14-1</span>.</p><a name="//apple_ref/doc/uid/TP30001017-CH311-CIHGEFEF" title="Listing 14-1Subclassing EOFormController"></a><p class="codesample"><strong>Listing 14-1&nbsp;&nbsp;</strong>Subclassing EOFormController</p><div class="codesample"><table><tr><td scope="row"><pre>package assetmanager.client;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>import javax.swing.*;<span></span></pre></td></tr><tr><td scope="row"><pre>import com.webobjects.foundation.*;<span></span></pre></td></tr><tr><td scope="row"><pre>import com.webobjects.eocontrol.*;<span></span></pre></td></tr><tr><td scope="row"><pre>import com.webobjects.eoapplication.*;<span></span></pre></td></tr><tr><td scope="row"><pre>import com.webobjects.eogeneration.*;<span></span></pre></td></tr><tr><td scope="row"><pre>import com.webobjects.eodistribution.client.*;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>public class FormController extends EOFormController {<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    public FormController(EOXMLUnarchiver unarchiver) {<span></span></pre></td></tr><tr><td scope="row"><pre>        super(unarchiver);<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    public NSArray defaultActions() {<span></span></pre></td></tr><tr><td scope="row"><pre>        Icon icon =<span></span></pre></td></tr><tr><td scope="row"><pre>            EOUserInterfaceParameters.localizedIcon("ActionIconInspect");<span></span></pre></td></tr><tr><td scope="row"><pre>        NSMutableArray actions = new NSMutableArray();<span></span></pre></td></tr><tr><td scope="row"><pre>        actions.addObject(EOAction.actionForControllerHierarchy("saveImageToDisk",<span></span></pre></td></tr><tr><td scope="row"><pre>           "Download Image", "Download Image", icon, null, null, 300, 50, false));<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        icon = EOUserInterfaceParameters.localizedIcon("ActionIconOk");<span></span></pre></td></tr><tr><td scope="row"><pre>        actions.addObject(EOAction.actionForControllerHierarchy("updateImageInRecord",<span></span></pre></td></tr><tr><td scope="row"><pre>            "Update Image", "Update Image", icon, null, null, 300, 50, false));<span></span></pre></td></tr><tr><td scope="row"><pre>        return EOAction.mergedActions(actions, super.defaultActions());<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    public boolean canPerformActionNamed(String actionName) {<span></span></pre></td></tr><tr><td scope="row"><pre>        return actionName.equals("saveImageToDisk") ||<span></span></pre></td></tr><tr><td scope="row"><pre>           super.canPerformActionNamed(actionName));<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    public void saveImageToDisk() {<span></span></pre></td></tr><tr><td scope="row"><pre>        //some code<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    public void updateImageInRecord() {<span></span></pre></td></tr><tr><td scope="row"><pre>        //some code<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr></table></div>	<p>Subclasses of the core controller classes must contain these methods: a method overriding <code>defaultActions</code>, a method overriding <code>canPerformActionNamed</code>, and a method for each action defined in <code>defaultActions</code>. By overriding <code>defaultActions</code>, you are adding to the controller’s actions, and by overriding <code>canPerformActionNamed</code>, you are authorizing the additional actions.</p><p>To use this class in all form windows throughout the application, you need only write a simple rule:</p><dl class="table-display"><dt>Left-Hand Side:</dt><dd><code>((task='form') and (controllerType='entityController'))</code></dd><dt>Key:</dt><dd><code>className</code></dd><dt>Value:</dt><dd><code>"assetmanager.client.FormController"</code></dd><dt>Priority:</dt><dd><code>50</code></dd></dl><p class="clear"></p><p>So, without needing to freeze XML, these customizations change the default form window to include new actions, as shown in <span class="content_text">Figure 14-1</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP30001017-CH311-CIHIHIJI" title="Figure 14-1Image form window with new actions"></a><p><strong>Figure 14-1&nbsp;&nbsp;</strong>Image form window with new actions</p><img src = "../Art/imageformactions.gif" alt = "Image form window with new actions" width="555" height="657"></div><br/><p>The standard actions delete and insert are disabled by another rule:</p><dl class="table-display"><dt>Left-Hand Side:</dt><dd><code>*true*</code></dd><dt>Key:</dt><dd><code>disabledActionNames</code></dd><dt>Value:</dt><dd><code>(insertWithTask, delete)</code></dd><dt>Priority:</dt><dd><code>50</code></dd></dl><p class="clear"></p><p>This rule is described in <span class="content_text"><a href="../T1RestrictingAccess/T1RestrictingAccess.html#//apple_ref/doc/uid/TP30001017-CH308-TP1">“Restricting Access to an Application.”</a></span></p><a name="//apple_ref/doc/uid/TP30001017-CH311-TPXREF39" title="Writing Custom Controller Classes"></a><h2>Writing Custom Controller Classes</h2><p><strong>Problem:</strong> For any number of reasons, subclassing the core controller classes to provide custom actions doesn’t meet your needs.</p><p><strong>Solution:</strong> Subclass EOController and write a rule or XML to use it.</p><p>This mechanism of writing a custom action is very similar to that described in <span class="content_text"><a href="T3CustomActions.html#//apple_ref/doc/uid/TP30001017-CH311-CIHCEJJG">“Subclassing Controller Classes,”</a></span> except that you subclass EOController instead of an entity-level controller like EOFormController and EOQueryController. <span class="content_text"><a href="T3CustomActions.html#//apple_ref/doc/uid/TP30001017-CH311-CIHEBAFF">Listing 14-2</a></span> shows the code for the class that adds an action that displays a simple information dialog.</p><a name="//apple_ref/doc/uid/TP30001017-CH311-CIHEBAFF" title="Listing 14-2A custom controller class"></a><p class="codesample"><strong>Listing 14-2&nbsp;&nbsp;</strong>A custom controller class</p><div class="codesample"><table><tr><td scope="row"><pre>package businesslogic.client;<span></span></pre></td></tr><tr><td scope="row"><pre>import java.awt.event.*;<span></span></pre></td></tr><tr><td scope="row"><pre>import javax.swing.*;<span></span></pre></td></tr><tr><td scope="row"><pre>import com.webobjects.foundation.*;<span></span></pre></td></tr><tr><td scope="row"><pre>import com.webobjects.eoapplication.*;<span></span></pre></td></tr><tr><td scope="row"><pre>import com.webobjects.eogeneration.*;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>public class NewController extends EOController {<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    public NewController(EOXMLUnarchiver unarchiver) {<span></span></pre></td></tr><tr><td scope="row"><pre>        super(unarchiver);<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    protected NSArray defaultActions() {<span></span></pre></td></tr><tr><td scope="row"><pre>        Icon icon =<span></span></pre></td></tr><tr><td scope="row"><pre>           EOUserInterfaceParameters.localizedIcon("ActionIconInspect");<span></span></pre></td></tr><tr><td scope="row"><pre>          NSMutableArray actions = new NSMutableArray();<span></span></pre></td></tr><tr><td scope="row"><pre>            actions.addObject(EOAction.actionForControllerHierarchy("runInfoDialog", "Run<span></span></pre></td></tr><tr><td scope="row"><pre>            Info Dialog", "Run Info Dialog", icon, null, null, 300, 50, false));<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        return EOAction.mergedActions(actions, super.defaultActions());<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    public boolean canPerformActionNamed(String actionName) {<span></span></pre></td></tr><tr><td scope="row"><pre>        return actionName.equals("runInfoDialog") ||<span></span></pre></td></tr><tr><td scope="row"><pre>                super.canPerformActionNamed(actionName);<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    public void runInfoDialog() {<span></span></pre></td></tr><tr><td scope="row"><pre>        EODialogs.runInformationDialog("Hello World!", "Hello World!");<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr></table></div>	<p>The most common way to use this custom controller in an application is in a frozen XML component. You can add a <code>CONTROLLER</code> tag specifying the fully qualified class name of the new class:</p><div class="codesample"><table><tr><td scope="row"><pre>CONTROLLER className="businesslogic.client.NewController"/><span></span></pre></td></tr></table></div><p>You can also write a rule to use the custom controller:</p><dl class="table-display"><dt>Left-Hand Side:</dt><dd><code>((task='query') and (controllerType='entityController'))</code></dd><dt>Key:</dt><dd><code>className</code></dd><dt>Value:</dt><dd><code>"businesslogic.client.NewController"</code></dd><dt>Priority:</dt><dd><code>50</code></dd></dl><p class="clear"></p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../T4CustomMenuItems/T4CustomMenuItems.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../T5CommonCustRules/T5CommonCustRules.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2002, 2005 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2005-08-11<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/WebObjects/DesktopApplications/T3CustomActions/T3CustomActions.html%3Fid%3DTP30001017-2.1&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/WebObjects/DesktopApplications/T3CustomActions/T3CustomActions.html%3Fid%3DTP30001017-2.1&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/WebObjects/DesktopApplications/T3CustomActions/T3CustomActions.html%3Fid%3DTP30001017-2.1&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>