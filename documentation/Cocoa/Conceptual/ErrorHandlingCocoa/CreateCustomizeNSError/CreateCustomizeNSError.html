<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Error Handling Programming Guide For Cocoa: Using and Creating Error Objects</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Using and Creating Error Objects"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001806-CH204" title="Using and Creating Error Objects"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../DesignGuidelines-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000556" target="_top">Design Guidelines</a> &gt; <a href="../ErrorHandling/ErrorHandling.html#//apple_ref/doc/uid/TP40001806-CH201-SW1">Error Handling Programming Guide For Cocoa</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../ErrorRespondRecover/ErrorRespondRecover.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../HandleReceivedError/HandleReceivedError.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40001806-CH204-BAJIIGCC" title="Using and Creating Error Objects"></a><h1>Using and Creating Error Objects</h1><p>The following sections describe how to deal with NSError<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_7"></a> objects returned from framework methods, how to display error messages using error objects, how to create error objects, and how to implement methods that return error objects by reference. </p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="CreateCustomizeNSError.html#//apple_ref/doc/uid/TP40001806-CH204-SW1">Handling Error Objects Returned From Methods</a>
				
			<br/>
			
        
			
			
				<a href="CreateCustomizeNSError.html#//apple_ref/doc/uid/TP40001806-CH204-BAJCIGIA">Displaying Information From Error Objects</a>
				
			<br/>
			
        
			
			
				<a href="CreateCustomizeNSError.html#//apple_ref/doc/uid/TP40001806-CH204-SW5">Creating and Returning NSError Objects</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001806-CH204-SW1" title="Handling Error Objects Returned From Methods"></a><h2>Handling Error Objects Returned From Methods</h2><p><a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_8"></a><a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_9"></a>Beginning with Mac OS X v10.4, many methods in the Cocoa frameworks include as their last parameter an indirect reference to an NSError object.<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_10"></a> Typically these are methods that create a document, write a file, load a URL, access a resource, or perform a similar operation. For example, the following method declaration is from the NSDocument class header file:</p><div class="codesample"><table><tr><td scope="row"><pre>- (BOOL)writeToURL:(NSURL *)absoluteURL<span></span></pre></td></tr><tr><td scope="row"><pre>    ofType:(NSString *)typeName<span></span></pre></td></tr><tr><td scope="row"><pre>    error:(NSError **)outError;<span></span></pre></td></tr></table></div><p>If this method<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_11"></a> encounters an error in its implementation, it directly returns <code>NO</code> to indicate failure and indirectly returns (if the client code requests it) an NSError object in the last parameter to describe the error. If you want to evaluate the error<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_12"></a>, declare an NSError object variable before calling a method such as <code>writeToURL:ofType:error:</code>. When you invoke the method, pass in a pointer to this variable. (If you are not interested in the error, just pass <code>NULL</code>.) If the method directly returns <code>nil</code> or <code>NO</code>, inspect the NSError object to determine the cause of the error or simply display an error alert. <span class="content_text">Listing 3-1</span> illustrates this approach.</p><a name="//apple_ref/doc/uid/TP40001806-CH204-BBCFBBBH" title="Listing 3-1Handling an NSError object returned from a Cocoa method"></a><p class="codesample"><strong>Listing 3-1&nbsp;&nbsp;</strong>Handling an NSError object returned from a Cocoa method</p><div class="codesample"><table><tr><td scope="row"><pre>NSError *theError;<span></span></pre></td></tr><tr><td scope="row"><pre>BOOL success = [myDoc writeToURL:[self docURL]<span></span></pre></td></tr><tr><td scope="row"><pre>                    ofType:@"html"<span></span></pre></td></tr><tr><td scope="row"><pre>                    error:&amp;theError];<span></span></pre></td></tr><tr><td scope="row"><pre>if (success == NO) {<span></span></pre></td></tr><tr><td scope="row"><pre>    // maybe try to determine cause of error and recover first<span></span></pre></td></tr><tr><td scope="row"><pre>    NSAlert *theAlert = [NSAlert alertWithError:theError];<span></span></pre></td></tr><tr><td scope="row"><pre>    [theAlert runModal]; // ignore return value<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><div class="notebox"><a name="//apple_ref/doc/uid/TP40001806-CH204-SW2" title="Note"></a><p><strong>Note:</strong>&nbsp;Cocoa methods that indirectly return error objects in the Cocoa error domain are guaranteed to return such objects if the method indicates failure by directly returning <code>nil</code> or <code>NO</code>.</p></div><p>This code fragment uses the returned NSError to display an error alert <a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_13"></a>to the user immediately. Error objects in the Cocoa domain<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_14"></a> are always localized and ready to present to users, so they can often be presented without further evaluation. (The example in <span class="content_text">Listing 3-1</span> is just one of the several approaches you could take for displaying errors<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_15"></a>; see the following section, <span class="content_text"><a href="CreateCustomizeNSError.html#//apple_ref/doc/uid/TP40001806-CH204-BAJCIGIA">“Displaying Information From Error Objects,”</a></span> for more on this topic). </p><p>Instead of merely displaying an error message returned from a framework call, you could examine the NSError object<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_16"></a> to determine if you can do something else:</p><ul class="ul"><li class="li"><p>You might be able to perform the operation again in a slightly different way that circumvents the error—without notifying the user.</p></li><li class="li"><p>If you know how to recover from the error, but require the user’s approval, you could create a new version of the error object that adds a recovery attempter to it (see <span class="content_text"><a href="../RecoverFromErrors/RecoverFromErrors.html#//apple_ref/doc/uid/TP40001806-CH206-BCIDEGGF">“Recovering From Errors”</a></span>). </p></li><li class="li"><p>You might be able supplement the information in the error from the current programming context and then create a new error object that contains this enriched information. </p></li><li class="li"><p>Send the error object up the error-responder chain<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_17"></a> so that other objects in the application can add to it or try to recover from the error.</p></li><li class="li"><p>If you use the returned NSError as the basis of a new error object, either by adding a recovery attempter<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_18"></a> or supplementary information, you can either:</p><ul class="nested"><li class="nested li"><p>Display the message immediately.</p></li><li class="nested li"><p> Pass the error on to the next error responder.</p></li></ul><p>For more on customizing errors passed up the error-responder chain, see <span class="content_text"><a href="../HandleReceivedError/HandleReceivedError.html#//apple_ref/doc/uid/TP40001806-CH205-BAJEHAJC">“Handling Received Errors.”</a></span></p></li></ul><div class="importantbox"><a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_3" title="Important:"></a><p><strong>Important:</strong>&nbsp;You should always special-case test for the <code>NSUserCancelledError</code><a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_19"></a> error code (in the <code>NSCocoaErrorDomain</code>). This code indicates that the user cancelled the operation (for example, by pressing Command-period). In this case, you should not display any error dialog.</p><p></p></div><p>When evaluating<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_20"></a><a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_21"></a> an NSError object, always use the object’s domain and error code as the bases of tests and not the strings describing the error or how to recover from it. Strings are typically localized and are thus likely to vary. With a few exceptions, pre-existing errors returned from Cocoa framework methods are always in the <code><a href="../../../Reference/Foundation/Miscellaneous/Foundation_Constants/Reference/reference.html#//apple_ref/doc/c_ref/NSCocoaErrorDomain" target="_top">NSCocoaErrorDomain</a></code> domain; however, because there are exceptions you might want to test whether the top-level error belongs to that domain. Error objects returned from Cocoa methods can often contain underlying error<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_22"></a> objects representing errors returned by lower subsystems, such as the BSD layer (<code><!--a  -->NSPOSXIErrorDomain<!--/a--></code>). </p><p>Of course, to make a successful evaluation of an error, you have to anticipate the errors that might be returned from a method invocation. And you should ensure that your code deals adequately with new errors that might be returned in the future.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001806-CH204-SW3" title="Note"></a><p><strong>Note:</strong>&nbsp;Some methods of the Cocoa frameworks can give you error objects in ways other than indirection. For example, some methods of the NSXMLParser class<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_23"></a>, such as <code>parser:validationErrorOccurred:</code><a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_24"></a>, pass an NSError object to the delegate if an fatal error has occurred. Other methods, such as <code>streamError<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_25"></a></code> of the NSStream class<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_26"></a>, return an NSError object directly. What you can do with the error object is the same in all cases.<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_27"></a><a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_28"></a></p></div><a name="//apple_ref/doc/uid/TP40001806-CH204-BAJCIGIA" title="Displaying Information From Error Objects"></a><h2>Displaying Information From Error Objects</h2><p><a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_29"></a><a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_30"></a><a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_31"></a>There are several different ways to display the information in NSError objects. You could extract the localized description (or failure reason), recovery suggestion, and the recovery options from the error object and use them to initialize an NSAlert object<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_32"></a> with message text, informative text, and button titles. Although this approach is the most painstaking, it does give you a large degree of control over the content and presentation of the error alert.</p><p>Fortunately, the Application Kit provides a few shortcuts for displaying error alerts. The <code>presentError:<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_33"></a></code> and the <code>presentError:modalForWindow:delegate:didPresentSelector:contextInfo: <a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_34"></a></code> methods permit you to originate an error alert that is eventually displayed by the application object, NSApp<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_35"></a>; the former method requests an application-modal alert<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_36"></a><a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_37"></a> and the latter a document-modal alert<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_38"></a><a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_39"></a>. You must send either of these present-error messages to an objects in the error-responder chain<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_40"></a> (see <span class="content_text"><a href="../ErrorRespondRecover/ErrorRespondRecover.html#//apple_ref/doc/uid/TP40001806-CH203-CJBHABAA">“The Error-Responder Chain”</a></span>): a view<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_41"></a> object, a window<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_42"></a> object, an NSDocument object<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_43"></a>, an NSWindowController object<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_44"></a>, an NSDocumentController object<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_45"></a>, or NSApp<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_46"></a>. (If you send the message to a view, it should ideally be a view object associated in some way with the condition that produced the error.) <span class="content_text">Listing 3-2</span> illustrates how you might invoke the document-modal <code>presentError:modalForWindow:delegate:didPresentSelector:contextInfo:</code> method.</p><a name="//apple_ref/doc/uid/TP40001806-CH204-BBCFCCBC" title="Listing 3-2Displaying a document-modal error alert"></a><p class="codesample"><strong>Listing 3-2&nbsp;&nbsp;</strong>Displaying a document-modal error alert</p><div class="codesample"><table><tr><td scope="row"><pre>NSError *theError;<span></span></pre></td></tr><tr><td scope="row"><pre>NSData *theData = [doc dataOfType:@"xml" error:&amp;theError];<span></span></pre></td></tr><tr><td scope="row"><pre>if (!theData &amp;&amp; theError)<span></span></pre></td></tr><tr><td scope="row"><pre>    [anyView presentError:theError<span></span></pre></td></tr><tr><td scope="row"><pre>            modalForWindow:[doc windowForSheet]<span></span></pre></td></tr><tr><td scope="row"><pre>            delegate:self<span></span></pre></td></tr><tr><td scope="row"><pre>            didPresentSelector:<span></span></pre></td></tr><tr><td scope="row"><pre>                @selector(didPresentErrorWithRecovery:contextInfo:)<span></span></pre></td></tr><tr><td scope="row"><pre>            contextInfo:nil];<span></span></pre></td></tr></table></div><p>After the user dismisses the alert, NSApp invokes a method (identified in the <code>didPresentSelector:</code> keyword) implemented by the modal delegate<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_47"></a>. As <span class="content_text">Listing 3-3</span> shows, the modal delegate in this method checks whether the recovery-attempter<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_48"></a> object (if any) managed to recover from the error and responds accordingly.</p><a name="//apple_ref/doc/uid/TP40001806-CH204-BBCHAEBA" title="Listing 3-3Modal delegate handling the user response"></a><p class="codesample"><strong>Listing 3-3&nbsp;&nbsp;</strong>Modal delegate handling the user response</p><div class="codesample"><table><tr><td scope="row"><pre>- (void)didPresentErrorWithRecovery:(BOOL)recover<span></span></pre></td></tr><tr><td scope="row"><pre>            contextInfo:(void *)info {<span></span></pre></td></tr><tr><td scope="row"><pre>    if (recover == NO) { // recovery did not succeed, or no recovery attempter<span></span></pre></td></tr><tr><td scope="row"><pre>        // proceed accordingly<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>For more on the recovery-attempter object, see <span class="content_text"><a href="../RecoverFromErrors/RecoverFromErrors.html#//apple_ref/doc/uid/TP40001806-CH206-BCIDEGGF">“Recovering From Errors.”</a></span></p><p>Sometimes you might not want to send an error object up the error-responder chain to be displayed by NSApp. You would rather show an error alert to the user immediately, and not have to construct it yourself. The NSAlert class provides the <code>alertWithError: <a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_49"></a></code> method for this purpose.<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_50"></a><a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_51"></a><a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_52"></a></p><a name="//apple_ref/doc/uid/TP40001806-CH204-SW4" title="Listing 3-4Directly displaying an error alert dialog"></a><p class="codesample"><strong>Listing 3-4&nbsp;&nbsp;</strong>Directly displaying an error alert dialog</p><div class="codesample"><table><tr><td scope="row"><pre>NSAlert *theAlert = [NSAlert alertWithError:theError];<span></span></pre></td></tr><tr><td scope="row"><pre>int button = [theAlert runModal];<span></span></pre></td></tr><tr><td scope="row"><pre>if (button != NSAlertFirstButtonReturn) {<span></span></pre></td></tr><tr><td scope="row"><pre>    // handle<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><div class="notebox"><a name="//apple_ref/doc/uid/TP40001806-CH204-SW7" title="Note"></a><p><strong>Note:</strong>&nbsp;The <code><a href="../../../Reference/ApplicationKit/Classes/NSResponder_Class/Reference/Reference.html#//apple_ref/occ/instm/NSResponder/presentError:" target="_top">presentError:</a></code> and <code><a href="../../../Reference/ApplicationKit/Classes/NSResponder_Class/Reference/Reference.html#//apple_ref/occ/instm/NSResponder/presentError:modalForWindow:delegate:didPresentSelector:contextInfo:" target="_top">presentError:modalForWindow:delegate:didPresentSelector:contextInfo:</a></code> methods silently ignore <code><a href="../../../Reference/Foundation/Miscellaneous/Foundation_Constants/Reference/reference.html#//apple_ref/c/econst/NSUserCancelledError" target="_top">NSUserCancelledError</a></code> errors in the <code><a href="../../../Reference/Foundation/Miscellaneous/Foundation_Constants/Reference/reference.html#//apple_ref/c/data/NSCocoaErrorDomain" target="_top">NSCocoaErrorDomain</a></code> domain.</p></div><a name="//apple_ref/doc/uid/TP40001806-CH204-SW5" title="Creating and Returning NSError Objects"></a><h2>Creating and Returning NSError Objects</h2><p><a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_53"></a><a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_54"></a><a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_55"></a>You can declare and implement your own methods that indirectly return an NSError object. Methods that are good candidates for NSError parameters<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_56"></a> are those that open and read files, load resources, parse formatted text, and so on. In general, these methods should not indicate an error through the existence of an NSError object. Instead, they should return <code>NO</code> or <code>nil</code> from the method to indicate that an error occurred. Return the NSError object to describe the error. </p><p>If you are going to return an NSError object by reference in an implementation of such a method, you must create the NSError object. You create an error object either by allocating it and then initializing it with the <code>initWithDomain:code:userInfo: <a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_57"></a></code> method of NSError or by using the class factory method <code>errorWithDomain:code:userInfo: <a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_58"></a></code>. As the keywords of both methods indicate, you must supply the initializer with a domain<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_59"></a> (string constant), an error code<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_60"></a> (a signed integer), and a “user info” dictionary<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_61"></a> containing descriptive and supporting information. (See <span class="content_text"><a href="../ErrorObjectsDomains/ErrorObjectsDomains.html#//apple_ref/doc/uid/TP40001806-CH202-CJBGAIBJ">“Error Objects, Domains, and Codes”</a></span> for full descriptions of these data items.) You should ensure that all strings in the user info dictionary are localized. If you create an NSError object with <code>initWithDomain:code:userInfo:</code>, you should send <code>autorelease</code> to it before you return it to the caller.</p><p><span class="content_text">Listing 3-5</span> is an example of a method that, for the purpose of illustration, calls the POSIX-layer <code>open</code> function to open a file. If this function returns an error, the method creates an NSError object of the <code><a href="../../../Reference/Foundation/Classes/NSError_Class/Reference/Reference.html#//apple_ref/doc/c_ref/NSPOSIXErrorDomain" target="_top">NSPOSIXErrorDomain</a></code><a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_62"></a> that is used as the underlying error of a custom error domain returned to the caller. </p><a name="//apple_ref/doc/uid/TP40001806-CH204-BBCIEBDA" title="Listing 3-5Implementing a method that returns an NSError object"></a><p class="codesample"><strong>Listing 3-5&nbsp;&nbsp;</strong>Implementing a method that returns an NSError object</p><div class="codesample"><table><tr><td scope="row"><pre>- (NSString *)fooFromPath:(NSString *)path error:(NSError **)anError {<span></span></pre></td></tr><tr><td scope="row"><pre>    const char  *fileRep = [path fileSystemRepresentation];<span></span></pre></td></tr><tr><td scope="row"><pre>    int fd = open(fileRep, O_RDWR|O_NONBLOCK, 0);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (fd == -1) {<span></span></pre></td></tr><tr><td scope="row"><pre>        NSString *descrip;<span></span></pre></td></tr><tr><td scope="row"><pre>        NSDictionary *uDict;<span></span></pre></td></tr><tr><td scope="row"><pre>        int errCode;<span></span></pre></td></tr><tr><td scope="row"><pre>        if (errno == ENOENT) {<span></span></pre></td></tr><tr><td scope="row"><pre>                descrip = NSLocalizedString(@"No such file or directory at<span></span></pre></td></tr><tr><td scope="row"><pre>                        requested location", @"");<span></span></pre></td></tr><tr><td scope="row"><pre>                errCode = MyCustomNoFileError;<span></span></pre></td></tr><tr><td scope="row"><pre>        } else if (errno == EIO) {<span></span></pre></td></tr><tr><td scope="row"><pre>            // continues for each possible POSIX error...<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        // Make underlyining error<span></span></pre></td></tr><tr><td scope="row"><pre>        NSError *undError = [[[NSError alloc] initWithDomain:NSPOSIXErrorDomain<span></span></pre></td></tr><tr><td scope="row"><pre>            code:errno userInfo:nil] autorelease];<span></span></pre></td></tr><tr><td scope="row"><pre>        // Make and return custom domain error<span></span></pre></td></tr><tr><td scope="row"><pre>        NSArray *objArray = [NSArray arrayWithObjects:descrip, undError, path, nil];<span></span></pre></td></tr><tr><td scope="row"><pre>        NSArray *keyArray = [NSArray arrayWithObjects:NSLocalizedDescriptionKey,<span></span></pre></td></tr><tr><td scope="row"><pre>            NSUnderlyingErrorKey, NSFilePathErrorKey, nil];<span></span></pre></td></tr><tr><td scope="row"><pre>        NSDictionary *eDict = [NSDictionary dictionaryWithObjects:objArray<span></span></pre></td></tr><tr><td scope="row"><pre>            forKeys:keyArray];<span></span></pre></td></tr><tr><td scope="row"><pre>        if (anError != NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>            *anError = [[[NSError alloc] initWithDomain:MyCustomErrorDomain<span></span></pre></td></tr><tr><td scope="row"><pre>                code:errCode userInfo:eDict] autorelease];<span></span></pre></td></tr><tr><td scope="row"><pre>        return nil;<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    // ...<span></span></pre></td></tr></table></div>	<p>In this example, the returned error object includes in its user info dictionary the path that caused the error.</p><p>As the example in <span class="content_text">Listing 3-5</span> shows, you can use errors that originate from underlying<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_63"></a> subsystems as the basis for error objects that you return to callers. You can use raised exceptions that your code handles in the same way. An NSException object<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_64"></a> is compatible with an NSError object in that its attributes are a name, a reason, and an user info dictionary. You can easily transfer information in the exception object over to the error object.<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_65"></a><a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_66"></a><a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_67"></a></p><a name="//apple_ref/doc/uid/TP40001806-CH204-SW6" title="A Note on Errors and Exceptions"></a><h3>A Note on Errors and Exceptions</h3><p>It is important to keep in mind the difference between NSError objects<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_68"></a> and NSException objects, and when to use one or the other in your code. They serve different purposes and should not be confused.</p><p>Exceptions (represented by NSException objects) are for programming errors<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_69"></a>, such as an array index that is out of bounds or an invalid method argument. User-level errors (represented by NSError objects) are for runtime errors, such as when a file cannot be found or a string in a certain encoding cannot be read. Conditions giving rise to exceptions are due to programming errors; you should deal with these errors before you ship a product. Runtime errors<a name="//apple_ref/doc/uid/TP40001806-CH204-DontLinkElementID_70"></a> can always occur, and you should communicate these (via NSError objects) to the user in as much detail as they require. </p><p>Although exceptions should ideally be taken care of before deployment, a shipped application can still experience exceptions as a result of some truly exceptional situation such as “out of memory” or “boot volume not available.” It is best to allow the highest level of the application—NSApp itself—to deal with these situations.</p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../ErrorRespondRecover/ErrorRespondRecover.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../HandleReceivedError/HandleReceivedError.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2005, 2009 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2009-03-04<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Conceptual/ErrorHandlingCocoa/CreateCustomizeNSError/CreateCustomizeNSError.html%3Fid%3DTP40001806-1.4&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Conceptual/ErrorHandlingCocoa/CreateCustomizeNSError/CreateCustomizeNSError.html%3Fid%3DTP40001806-1.4&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Conceptual/ErrorHandlingCocoa/CreateCustomizeNSError/CreateCustomizeNSError.html%3Fid%3DTP40001806-1.4&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>