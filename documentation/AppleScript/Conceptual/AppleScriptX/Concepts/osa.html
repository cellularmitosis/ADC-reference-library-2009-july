<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>AppleScript Overview: Open Scripting Architecture</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Open Scripting Architecture"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001571" title="Open Scripting Architecture"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../ScriptingAutomation/index.html#//apple_ref/doc/uid/TP30000440-TP40005948" target="_top">Scripting &amp; Automation</a> &gt; <a href="../../../../ScriptingAutomation/AppleScript-date.html#//apple_ref/doc/uid/TP30000440-TP40005948-TP30000481" target="_top">AppleScript</a> &gt; <a href="../index.html" target="_top">AppleScript Overview</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="ScriptingOnOSX.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="work_with_as.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/TP40001571-BABEBGCF" title="Open Scripting Architecture"></a><hr /><H1>Open Scripting Architecture</H1><p>The <strong>Open Scripting Architecture (OSA)</strong> provides a standard and extensible mechanism for interapplication communication in Mac OS X. Communication takes place through the exchange of Apple events, a type of message designed to encapsulate commands and data of any complexity.</p><p>Apple events provide an event dispatching and data transport mechanism that can be used within a single application, between applications on the same computer, and between applications on different computers. The OSA defines data structures, a set of common terms, and a library of functions, so that applications can more easily create and send Apple events, as well as receive them and extract data from them.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001571-DontLinkElementID_5" title="Note"></a><p><strong>Note:</strong>&nbsp;Apple events are not always the most efficient or appropriate mechanism for communicating between processes. Mac OS X offers other mechanisms, including distributed objects, notifications, sockets, ports, streams, shared memory, and Mach messaging. These mechanisms are described in “IPC and Notification Mechanisms” in <span class="content_text"><a href="../../../../MacOSX/Conceptual/OSX_Technology_Overview/SystemTechnology/SystemTechnology.html#//apple_ref/doc/uid/TP40001067-CH207" target="_top">System-Level Technologies</a></span> in <em><a href="../../../../MacOSX/Conceptual/OSX_Technology_Overview/index.html#//apple_ref/doc/uid/TP40001067" target="_top">Mac OS X Technology Overview</a></em>.</p></div><p>The OSA supports several powerful features in Mac OS X:</p><ul class="ul"><li class="li"><p>the ability to create scriptable applications (described in <span class="content_text"><a href="scriptable_apps.html#//apple_ref/doc/uid/TP40001569-BABEBGCF">“Scriptable Applications”</a></span>)</p></li><li class="li"><p>the ability for users to write scripts that combine operations from multiple scriptable applications</p></li><li class="li"><p>the ability to communicate between applications with Apple events</p></li></ul>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="osa.html#//apple_ref/doc/uid/TP40001571-1147859-BCIBHFFA">The Parts of the Open Scripting Architecture</a>
				
			<br/>
			
        
			
			
				<a href="osa.html#//apple_ref/doc/uid/TP40001571-1155023">Apple Events</a>
				
			<br/>
			
        
			
			
				<a href="osa.html#//apple_ref/doc/uid/TP40001571-1152144-BAJFBDEI">Apple Events Sent by the Mac OS</a>
				
			<br/>
			
        
			
			
				<a href="osa.html#//apple_ref/doc/uid/TP40001571-1151905">Script Execution in the Open Scripting Architecture</a>
				
			<br/>
			
        
			
			
				<a href="osa.html#//apple_ref/doc/uid/TP40001571-1164068-BCIJDFCE">Extending AppleScript with Coercions, Scripting Additions, and Faceless Background Applications</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001571-1147859" title="The Parts of the Open Scripting Architecture"></a><a name="//apple_ref/doc/uid/TP40001571-1147859-BCIBHFFA" title="The Parts of the Open Scripting Architecture"></a><h2>The Parts of the Open Scripting Architecture</h2><p>Applications that need full access to the Open Scripting Architecture can get it by linking with the Carbon framework. Some applications that work with Apple events (especially those with minimal user interface requirements) may be able to obtain all the services they need by linking to the Core Services framework.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001571-DontLinkElementID_6" title="Note"></a><p><strong>Note:</strong>&nbsp;A <strong>framework</strong> is a type of bundle (or directory in the file system) that packages software with the resources that software requires, including the headers that define its interface. Frameworks are typically located in <code>/System/Library/Frameworks</code>, though they may be nested inside other frameworks.</p></div><p>The Open Scripting Architecture is made up of the following parts:</p><ul class="ul"><li class="li"><p>The <strong>Apple Event Manager</strong> provides an API for sending and receiving Apple events and working with the information they contain. It supplies the underlying support for creating scriptable applications. It is implemented in <code>AE.framework</code>, a subframework of <code>CoreServices.framework</code>. (Prior to Mac OS X version 10.5, the <code>AE.framework</code> was a subframework of <code>ApplicationServices.framework</code>.)</p><p>This framework also defines constants that developers can use to support a standard vocabulary for Apple events among different applications.</p><p>For API documentation, see <em><a href="../../../../Carbon/Reference/Apple_Event_Manager/index.html#//apple_ref/doc/uid/TP30000134" target="_top">Apple Event Manager Reference</a></em>. For conceptual documentation and code samples, see <em><a href="../../AppleEvents/index.html#//apple_ref/doc/uid/TP40001449" target="_top">Apple Events Programming Guide</a></em>. </p></li><li class="li"><p>The <strong>Carbon umbrella framework</strong> includes the HIToolbox framework, which in turn defines certain functions used in processing and sending Apple events (for example, in the header file <code>Interaction.h</code>).</p></li><li class="li"><p>The <strong>Open Scripting framework</strong> defines standard data structures, routines, and resources for creating scripting components, which support scripting languages. Because of its standard interface, applications can interact with any scripting component, regardless of its language. This framework provides API for compiling, executing, loading, and storing scripts. It is implemented in <code>OpenScripting.framework</code>, a subframework of <code>Carbon.framework</code>.</p><p>For documentation, see <em><a href="../../../../Carbon/Reference/Open_Scripti_Architecture/index.html#//apple_ref/doc/uid/TP30000083" target="_top">Open Scripting Architecture Reference</a></em>.</p></li><li class="li"><p>The AppleScript component (in <code>System/Library/Components</code>) implements the AppleScript language, which provides a way for scripts to control scriptable applications.</p><p>The AppleScript language is described in <em><a href="../../AppleScriptLangGuide/index.html#//apple_ref/doc/uid/TP40000983" target="_top">AppleScript Language Guide</a></em>, as well as in a number of third-party books.</p></li></ul><a name="//apple_ref/doc/uid/TP40001571-1155023" title="Apple Events"></a><h2>Apple Events</h2><p>The Apple event is the basic message for interprocess communication in the Open Scripting Architecture. With Apple events, you can gather all the data necessary to accomplish a high level task into a single package that can be passed across process boundaries, evaluated, and returned with results.</p><p>An Apple event consists of a series of nested data structures, each identified by one or more four-character codes (also referred to as Apple event codes). These data structures, as well as the codes and the header files in which they are defined, are described in <em><a href="../../AppleEvents/index.html#//apple_ref/doc/uid/TP40001449" target="_top">Apple Events Programming Guide</a></em>. That document also provides conceptual information about Apple events and programming examples that work with them. For a list of four-character codes and their related terminology used by Apple, see <em><a href="../../../../../releasenotes/AppleScript/ASTerminology_AppleEventCodes/TermsAndCodes.html#//apple_ref/doc/uid/TP40004532" target="_top">AppleScript Terminology and Apple Event Codes Reference</a></em>. Your application can reuse these terms and codes whenever it performs an equivalent function.</p><a name="//apple_ref/doc/uid/TP40001571-1152144" title="Apple Events Sent by the Mac OS"></a><a name="//apple_ref/doc/uid/TP40001571-1152144-BAJFBDEI" title="Apple Events Sent by the Mac OS"></a><h2>Apple Events Sent by the Mac OS</h2><p>The Mac OS takes advantage of Apple events to communicate with applications, such as to notify an application that it has been launched or should open or print a list of documents. Applications that present a graphical user interface must be able to respond to whichever of these events make sense for the application. For example, all such applications can be launched and quit, but some may not be able to open or print documents.</p><p>For detailed information on the events sent by the Mac OS and how to respond to them, see:</p><ul class="ul"><li class="li"><p>For Carbon applications: “Handling Events Sent by the Mac OS” in <span class="content_text"><a href="../../AppleEvents/responding_aepg/responding_aepg.html#//apple_ref/doc/uid/TP40001449-CH206" target="_top">Responding to Apple Events</a></span> in <em><a href="../../AppleEvents/index.html#//apple_ref/doc/uid/TP40001449" target="_top">Apple Events Programming Guide</a></em>.</p></li><li class="li"><p>For Cocoa applications: <span class="content_text"><a href="../../../../Cocoa/Conceptual/ScriptableCocoaApplications/SApps_handle_AEs/SAppsHandleAEs.html#//apple_ref/doc/uid/20001239" target="_top">How Cocoa Applications Handle Apple Events</a></span> in <em><a href="../../../../Cocoa/Conceptual/ScriptableCocoaApplications/index.html#//apple_ref/doc/uid/TP40002164" target="_top">Cocoa Scripting Guide</a></em>.</p></li></ul><a name="//apple_ref/doc/uid/TP40001571-1151905" title="Script Execution in the Open Scripting Architecture"></a><h2>Script Execution in the Open Scripting Architecture</h2><p>The Open Scripting Architecture allows users to control multiple applications with scripts written in a variety of scripting languages. Each scripting language has a corresponding scripting component. The AppleScript component supports the AppleScript language. When a scripting component executes a script, statements in the script may result in Apple events being sent to applications.</p><p>Although AppleScript is the most widely used language (and the only one provided by Apple), developers are free to use the Open Scripting Architecture to create scripting components for other scripting languages. Depending on the implementation, scripts written in these languages may be able to communicate with scriptable applications.</p><p><span class="content_text">Figure 1</span> shows what happens when the <span class="content_text"><a href="work_with_as.html#//apple_ref/doc/uid/TP40001568-1152365">“Script Editor”</a></span> application executes an AppleScript script that targets the Mail application. Script Editor calls functions in the Open Scripting framework. The Open Scripting framework communicates through the AppleScript component, which in turn uses the Apple Event Manager to send any required Apple events to the Mail application. If a reply is requested, the Mail application returns information in a reply Apple event.</p><br/><div><a name="//apple_ref/doc/uid/TP40001571-1152867-BAJECDEI" title="Figure 1How parts of the OSA work together in executing scripts"></a><p><a name="//apple_ref/doc/uid/TP40001571-1152867" title="Figure 1How parts of the OSA work together in executing scripts"></a><strong>Figure 1&nbsp;&nbsp;</strong>How parts of the OSA work together in executing scripts</p><img src = "../art/execute_script.gif" alt = "How parts of the OSA work together in executing scripts." width="571" height="325"></div><br/><p>Applications can also call Apple Event Manager functions directly to send Apple events to other applications and get replies from them (not shown in <span class="content_text">Figure 1</span>).</p><a name="//apple_ref/doc/uid/TP40001571-1164068" title="Extending AppleScript with Coercions, Scripting Additions, and Faceless Background Applications"></a><a name="//apple_ref/doc/uid/TP40001571-1164068-BCIJDFCE" title="Extending AppleScript with Coercions, Scripting Additions, and Faceless Background Applications"></a><h2>Extending AppleScript with Coercions, Scripting Additions, and Faceless Background Applications</h2><p>Developers can extend AppleScript by creating bundles that provide command handlers and coercion handlers. The bundles can be applications or scripting additions. However, in many cases the best solution for extending AppleScript is to provide features through a faceless background application—that is, a sort of invisible server application.</p><a name="//apple_ref/doc/uid/TP40001571-1164081" title="Coercions"></a><h3>Coercions</h3><p><strong>Coercion</strong> is the process of converting the information in an Apple event from one type to another. A <strong>coercion handler</strong> is a function that provides coercion between two (or possibly more) data types. Mac OS X provides default coercion between many standard types. For a complete listing, see <span class="content_text"><a href="../../AppleEvents/appendix3_aepg/appendix3_aepg.html#//apple_ref/doc/uid/TP40001449-CH213" target="_top">Default Coercion Handlers</a></span> in <em><a href="../../AppleEvents/index.html#//apple_ref/doc/uid/TP40001449" target="_top">Apple Events Programming Guide</a></em>.</p><p>Coercion is available to both scripts and applications. In a script, for example, the following statement coerces the numeric value 1234 to the string value “1234”.</p><div class="codesample"><table><tr><td scope="row"><pre>set myString to 1234 as text<span></span></pre></td></tr></table></div><p>A scriptable application can specify a type when it uses an Apple Event Manager function to extract data from an Apple event. If the data is not already in the specified type, the Apple Event Manager will attempt to coerce it to that type. An application can provide coercion handlers for its own data types, as described in <span class="content_text"><a href="../../AppleEvents/coercions_aepg/coercions_aepg.html#//apple_ref/doc/uid/TP40001449-CH208" target="_top">Writing and Installing Coercion Handlers</a></span> in <em><a href="../../AppleEvents/index.html#//apple_ref/doc/uid/TP40001449" target="_top">Apple Events Programming Guide</a></em>.</p><a name="//apple_ref/doc/uid/TP40001571-1164142" title="Scripting Additions"></a><h3>Scripting Additions</h3><p>A <strong>scripting addition</strong> is a file or bundle that provides AppleScript commands or coercions. A single scripting addition can contain multiple handlers. For example, the Standard Additions scripting addition in Mac OS X (filename <code>StandardAdditions.osax</code>), includes commands for using the Clipboard, obtaining the path to a file, speaking text, executing shell scripts, and more. The commands provided by the Standard Additions are available to all scripts. To see what terminology a scripting addition provides, you can examine its dictionary, as described in <span class="content_text"><a href="work_with_as.html#//apple_ref/doc/uid/TP40001568-1153006">“Displaying Scripting Dictionaries.”</a></span></p><p>Terms introduced by scripting additions exist in the same name space as AppleScript terms and application-defined terms. While this has the advantage of making a service globally available, it also means that terms from scripting additions can conflict with other terms, polluting the global name space. Debugging scripting additions can also be difficult. Because you can not simply set breakpoints in your own code, you may need to use sampling, profiling, and various other tools to determine where a problem lies. (See <span class="content_text"><a href="osa.html#//apple_ref/doc/uid/TP40001571-SW1">“Faceless Background Applications”</a></span> for an approach that avoids these problems.)</p><p>A scripting addition provides its services by installing event handlers (for commands) or coercion handlers (for coercions) in an application’s system dispatch tables. The handlers for the Standard Additions (and for any other scripting additions installed by the Mac OS in <code>/System/Library/ScriptingAdditions</code>) get installed if the application calls API in the Open Scripting framework, or if the application specifically loads a scripting addition. An application can also specifically load other scripting additions from other locations.</p><p>For information on writing scripting additions, see Technical Note TN1164, <span class="content_text"><a href="../../../../../technotes/tn/tn1164.html" target="_top">Native Scripting Additions</a></span>. For information on loading scripting additions, see Technical Q&amp;A QA1070, <span class="content_text"><a href="../../../../../qa/qa2001/qa1070.html" target="_top">Loading Scripting Additions Without Initializing Apple Script in Mac OS X</a></span>.</p><a name="//apple_ref/doc/uid/TP40001571-SW1" title="Faceless Background Applications"></a><h3>Faceless Background Applications</h3><p>A faceless background application (now more commonly referred to as an agent), is one that, as its name implies, runs in the background and has no visible user interface. By creating a scriptable agent, you can provide services without some of the disadvantages of scripting additions. For example, you can develop and debug in a standard application environment, and any terminology you provide does not pollute the global name space—it is available only within a script’s <code>tell</code> statement that targets the agent.</p><p></p><p>You can install your agent directly, but if it is intended for use with another application, you can put it in the <code>Resources</code> folder of the application it supports. That promotes ease of use by allowing a drag-and-drop installation process, and will minimize users stumbling across the agent and asking “What is this for?“ The agent will be launched whenever it is referenced in a <code>tell</code> statement. It can be told to quit, and you can also set it up to time out, so it can get unloaded when it is no longer in use.</p><p>Apple provides a number of scriptable services through agents, as described in <span class="content_text"><a href="as_related_apps.html#//apple_ref/doc/uid/TP40001570-1149074">“System Events and GUI Scripting,”</a></span> <span class="content_text"><a href="as_related_apps.html#//apple_ref/doc/uid/TP40001570-1147921">“Image Events,”</a></span> and <span class="content_text"><a href="as_related_apps.html#//apple_ref/doc/uid/TP40001570-SW1">“Database Events.”</a></span> For example, scripts can use the System Events application to perform operations on property list files.</p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="ScriptingOnOSX.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="work_with_as.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2002, 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-10-31<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleScript/Conceptual/AppleScriptX/Concepts/osa.html%3Fid%3D10000156i-4.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleScript/Conceptual/AppleScriptX/Concepts/osa.html%3Fid%3D10000156i-4.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleScript/Conceptual/AppleScriptX/Concepts/osa.html%3Fid%3D10000156i-4.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
