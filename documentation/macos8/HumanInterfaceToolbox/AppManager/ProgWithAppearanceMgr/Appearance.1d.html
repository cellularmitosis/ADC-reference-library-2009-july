<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML EXPERIMENTAL 970324//EN">
<HTML>
<HEAD>
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter">

<script language="JavaScript" src="frametest.js"></script>

<TITLE> Creating Custom Themes</TITLE><LINK REL="stylesheet" TYPE="text/css" HREF="../../../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../../../Resources/JavaScript/page.js"></script>
</head>
<body bgcolor="#ffffff">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>

<DIV>
<a name="top"></a><!-- start of banner -->			
<!--#include virtual="/includes/framesetheader" -->
<!-- end of banner -->

<!-- start of path -->
<table border="0" cellpadding="0" cellspacing="2" width="450">	
	<tr>
	<td scope="row"><font face="Geneva,Helvetica,Arial" size="1">
	<b>PATH<img src="../../../images/space.gif" width="6" height="12"></b><a href="../../../../index.html" target="_top">Documentation</a> <b>&gt;</b> <a href="../../../mac8.html" target="_top">Mac OS 8 and 9</a> 
	<b>&gt;</b> Human Interface Toolbox
	<b>&gt;</b> <a href="../appearancemanager.html" target="_top">Appearance Manager</a> 
	<b>&gt;</b>
	</font></td>
	</tr>
	<tr><td align="left" scope="row"><br>
	<img src="../../../images/im_smblue.gif" width="116" height="8"><img src="../../../images/space.gif" width="6" height="11">
	<font face="Geneva,Helvetica,Arial">Programming With the Appearance Manager</font>
	</td></tr>
</table><br>
<!-- end of path -->
</DIV>

<!-- top navigation -->
<P><A HREF="Appearance.f.html"><img src="images/up.gif" border="0"></A> <A HREF="Appearance.1c.html"><img src="images/previous.gif" border="0"></A> <A HREF="Appearance.1e.html"><img src="images/next.gif" border="0"></a>

<!-- insert Show/Hide frames -->
<a href="javascript:testFrame()">
<script>
<!--
 document.write(frameLink);
//-->
</script><!-- end Show/Hide frames --></a>

<!-- end of top navigation -->

<hr>



<H1 CLASS="H1.Heading1">
<A NAME="pgfId=256138">
 </A>
<A NAME="marker=260646">
 </A>
<A NAME="30259">
 </A>
Creating <A NAME="marker=260650">
 </A>
Custom Themes</H1>
<P CLASS="T1.Text1">
<A NAME="pgfId=260069">
 </A>
There are two common cases where you may wish to create a custom theme. The first is to set up a custom theme environment for your program, to be used only when your program is active. This is useful for some programs, such as games, that need to control the entire user environment while they are active. The second is to create a theme environment that you want to be user-selectable and to have systemwide effect.</P>
<P CLASS="T1.Text1">
<A NAME="pgfId=256144">
 </A>
In the first case, if you set up a custom theme environment for your application, you don't need the theme you create to show up in the Appearance control panel (that is, to be user-selectable). The steps to create a custom theme that is not user-selectable are as follows:</P>
<OL>
<LI CLASS="N.NList">
<A NAME="pgfId=256145">
 </A>
Create a collection, using the Collection Manager function <TT CLASS="cv">
NewCollection</TT>
.</LI>
<LI CLASS="N.NList">
<A NAME="pgfId=256149">
 </A>
Using theme collection tags and Collection Manager functions, add collection items describing attributes of the theme to the collection. Note that you do not need to add collection items for every tag defined by the Appearance Manager; you need to include collection items only for those attributes that you want to change. See <A HREF="Appearance.9c.html#22374" CLASS="XRef">
Theme Collection Tags</A>
 for descriptions of available tag values.</LI>
<LI CLASS="N.NList">
<A NAME="pgfId=256153">
 </A>
Call the function <A HREF="Appearance.26.html#35755" CLASS="XRef">
GetTheme</A>
 to get a collection containing a copy of the data for the theme that is currently running.</LI>
<LI CLASS="N.NList">
<A NAME="pgfId=256154">
 </A>
Call <TT CLASS="cv">
SetTheme</TT>
 to set your collection as the current theme.</LI>
<LI CLASS="N.NList">
<A NAME="pgfId=257704">
 </A>
After you have finished using the custom theme environment for your program, restore the previous theme by calling <TT CLASS="cv">
SetTheme</TT>
. Pass <TT CLASS="cv">
SetTheme</TT>
 a reference to the collection for the previous theme, which you obtained with your call to <TT CLASS="cv">
GetTheme</TT>
 in Step 3.</LI>
<LI CLASS="N.NList">
<A NAME="pgfId=257740">
 </A>
Dispose of the collection and its contents when you are done.</LI>
</OL>
<P CLASS="T1.Text1">
<A NAME="pgfId=257741">
 </A>
In the second case, if you want the theme to be user-selectable and to have systemwide effect, you need the theme to show up in the Appearance control panel and must therefore follow these steps:</P>
<OL>
<LI CLASS="N/.NList=1">
<A NAME="pgfId=256157">
 </A>
Create a collection, using the Collection Manager function <TT CLASS="cv">
NewCollection</TT>
.</LI>
<LI CLASS="N.NList">
<A NAME="pgfId=256161">
 </A>
Using theme collection tags and Collection Manager functions, add collection items describing attributes of the theme to the collection. Note that you do not need to add collection items for every tag defined by the Appearance Manager; you need to include collection items only for those attributes that you want to change. See <A HREF="Appearance.9c.html#22374" CLASS="XRef">
Theme Collection Tags</A>
 for descriptions of available tag values.</LI>
<LI CLASS="N.NList">
<A NAME="pgfId=256162">
 </A>
Flatten the collection to a handle, using the Collection Manager function <TT CLASS="cv">
FlattenCollectionToHdl</TT>
.</LI>
<LI CLASS="N.NList">
<A NAME="pgfId=260310">
 </A>
Use the Resource Manager to save the flattened collection as a resource of type <TT CLASS="cv">
'scen'</TT>
. Save the <TT CLASS="cv">
'scen'</TT>
 resource into a custom theme file (that is, in a file of type <TT CLASS="cv">
'scen'</TT>
) in the Theme Files folder; see <A HREF="Appearance.95.html#15589" CLASS="XRef">
Appearance Manager File Type Constants</A>
 for a description of the <TT CLASS="cv">
'scen'</TT>
 file type. See <I CLASS="italics">
More Macintosh Toolbox</I>
 for a discussion of the Resource Manager and how resources are added to files and released.</LI>
<LI CLASS="N.NList">
<A NAME="pgfId=257769">
 </A>
Dispose of the collection and its contents when you are done.</LI>
</OL>
<HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 29 April  99)<P><A HREF="Appearance.f.html"><img src="images/up.gif" border="0"></A> <A HREF="Appearance.1c.html"><img src="images/previous.gif" border="0"></A> <A HREF="Appearance.1e.html"><img src="images/next.gif" border="0"></A>

<!-- insert Show/Hide frames -->
<a href="javascript:testFrame()">
<script>
<!--
 document.write(frameLink);
//-->
</script><!-- end Show/Hide frames --></a>

<!-- start of footer -->
<!--#include virtual="/includes/framesetfooter" -->
<!-- end of footer -->

</body>
</HTML>
