<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Q&amp;A QA1145: Preserving embedded ICC profiles when using QuickTime Graphics Importer/Exporters</title><meta name="keywords" content="ICC profile embed QuickTime graphics import export"><meta name="Description" content="Technical Q&amp;A QA1145: This Q&amp;A shows how to preserve theICC profile embedded in a document when using the QuickTimeGraphics Importer/Exporter routines"><meta name="categories" content="QuickTime Components and Color"><meta name="week-posted" content="Sep 2, 2002 - Sep 6, 2002"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10001690" title="Preserving embedded ICC profiles when using QuickTime Graphics Importer/Exporters"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalqas/index.html">Technical Q&As</a> &gt; <a href="../../technicalqas/QuickTime/index.html">QuickTime</a> &gt; <a href="../../technicalqas/QuickTime/idxImportExport-date.html">Import & Export</a> &gt; </p><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Q&amp;A QA1145</div>
<div id="pageheadsub">Preserving embedded ICC profiles when using QuickTime Graphics Importer/Exporters</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600> <TR> <td align="left"><!-- begin_content --><hr width=500 align=center>                  <P id=p2>Q:      I have a number of image files which contain embedded ICC      profiles. I'm using the QuickTime Graphics Importer/Exporter      routines to import and manipulate the images, then export      them into different formats. However, once I export the images      I notice the ICC profiles are lost. What can I do to preserve      the profiles?</p>                   <P id=p4>A: You'll need to first save-off the embedded profile using             the GraphicsImportGetColorSyncProfile function when the image is imported,             then embed this same profile in the image using the GraphicsExportSetColorSyncProfile             function when the export operation is performed. Listing 1 shows how             this is done.</p><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left>                  <pre>OSErr err;FSSpec importFile, outputFile;GraphicsImportComponent importer;GraphicsExportComponent exporter;Handle profHandle = NULL;unsigned long actualSizeWritten;err = GetGraphicsImporterForFile(&amp;importFile, &amp;importer);if (err == noErr){        /* save the embedded profile */    err = GraphicsImportGetColorSyncProfile(importer, &amp;profHandle);        /* get an exporter, then perform our image manipulations */    err = OpenADefaultComponent(GraphicsExporterComponentType,                                        kQTFileTypeTIFF, &amp;exporter);    if (err == noErr)    {        err = GraphicsExportSetInputGraphicsImporter(exporter, importer);        err = GraphicsExportSetDepth (exporter, 24);              .              .              .        if (profHandle)        {            /* now restore the profile before            performing the export */            err = GraphicsExportSetColorSyncProfile(exporter, profHandle);        }            /* perform the export operation */        err = GraphicsExportSetOutputFile(exporter, &amp;outputFile);        err = GraphicsExportDoExport(exporter, &amp;actualSizeWritten);    }    .    .    .    if (profHandle)    {        DisposeHandle(profHandle);    }}</pre></TD></TR><TR><td align="left"><P><B>Listing 1</B>. Code showing how to preserve the ICC profile embedded in      a document when using the QuickTime Graphics Importer/Exporter      routines</P></TD></TR></TABLE></CENTER><BR><BR><hr width=500 align=center> <!-- begin_date --><H4 ALIGN=center>[Sep 04 2002]</H4><!-- end_date --></TD> </TR> </TABLE></CENTER><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/qa/qa2001/qa1145.html%3Fid%3DDTS10001690-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/qa/qa2001/qa1145.html%3Fid%3DDTS10001690-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/qa/qa2001/qa1145.html%3Fid%3DDTS10001690-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>