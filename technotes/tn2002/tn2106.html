<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- BEGIN META TAG INFO --><link rel="home" href="http://developer.apple.com/">
<link rel="find" href="http://developer.apple.com/search/">
<link rel="stylesheet" type="text/css" href="../../documentation/css/adcstyle.css" title="fonts">
<script language="JavaScript" type="text/javascript" src="../../documentation/js/busnav.js"></script><script language="JavaScript" src="../../documentation/js/adc.js" type="text/javascript"></script><!-- END META TAG INFO --><!-- BEGIN TITLE --><title>Technical Note TN2106: Scripting Interface Guidelines</title>
<!-- END TITLE --><style>
			.sourcecodebox {
				white-space: pre-wrap;
				white-space: -moz-pre-wrap !important;
				white-space: -pre-wrap;
				white-space: -o-pre-wrap;
				word-wrap: break-word;
			}
			</style>
</head>
<!-- BEGIN BODY OPEN --><body bgcolor="#ffffff"><a name="//apple_ref/doc/uid/DTS10003199" title="Scripting Interface Guidelines"></a>
<!-- END BODY OPEN --><!-- START CENTER OPEN --><center>
<!-- END CENTER OPEN --><a name="top"></a><!-- BEGIN LOGO AND SEARCH --><!--#include virtual="/includes/adcnavbar" --><!-- END LOGO AND SEARCH --><!-- START BREADCRUMB --><div id="breadcrumb"><table width="680" border="0" cellpadding="0" cellspacing="0">
<tr>
<td scope="row"><img width="340" height="10" src="images/1dot.gif" alt=""></td>
<td><img width="340" height="10" src="images/1dot.gif" alt=""></td>
</tr>
<tr valign="middle"><td align="left" colspan="2">
<a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/ScriptingAutomation/index.html">Scripting &amp; Automation</a> &gt; <a href="../../technicalnotes/ScriptingAutomation/idxCarbon-date.html">Carbon</a> &gt; </td></tr>
<tr><td colspan="2" scope="row"><img width="680" height="35" src="images/1dot.gif" alt=""></td></tr>
</table></div>
<!-- END BREADCRUMB --><!-- START MAIN CONTENT --><!-- START TITLE GRAPHIC AND INTRO --><table width="680" border="0" cellpadding="0" cellspacing="0"><tr align="left" valign="top"><td><h1>
<div id="pagehead">Technical Note TN2106</div>
<div id="pageheadsub">Scripting Interface Guidelines</div>
</h1></td></tr></table>
<!-- END TITLE GRAPHIC AND INTRO --><!-- BEGIN WIDE COLUMN --><table width="680" border="0" cellpadding="0" cellspacing="0"><tr align="left" valign="top"><td align="left" width="680">
<!-- BEGIN CONTENTS --><table width="680" border="0" cellpadding="0" cellspacing="0">
<tr align="left" valign="top"><td>
<p>This document describes what you need to do in order to provide a clean and consistent scripting interface for your application. If you follow these guidelines</p>
<ul>
<li><p>new and experienced users will learn your application faster, because it looks and works like applications they're already familiar with</p></li>
<li><p>users will accomplish their tasks quickly, because well-designed applications don't get in the user's way</p></li>
<li><p>your application will be easier to document, because an intuitive interface and standard behaviors don't require as much explanation</p></li>
<li><p>customer support calls will be reduced (for the reasons cited above)</p></li>
</ul>
</td></tr>
<tr><td scope="row">
<img width="680" height="10" src="images/1dot.gif" alt=""><br><img width="680" height="1" src="images/1dot_919699.gif" alt=""><br><img width="680" height="20" src="images/1dot.gif" alt="">
</td></tr>
</table>
<table width="680" border="0" cellpadding="0" cellspacing="0">
<tr align="left" valign="top"><td width="680"><ul>
<li><a href="#INTRODUCTION">Introduction</a></li>
<li><a href="#BASICS">Basics</a></li>
<li><a href="#STYLE">Style</a></li>
<ul>
<li><a href="#STYLE-GENERAL">General</a></li>
<li><a href="#STYLE-CHOOSING_LANGUAGE_ELEMENTS">Choosing Language Elements</a></li>
<li><a href="#STYLE-NAMING_RULES">Naming Rules</a></li>
<li><a href="#STYLE-COMMENT_STYLE">Comment style</a></li>
</ul>
<li><a href="#OBJECTS">Objects</a></li>
<ul>
<li><a href="#OBJECTS-DESIGNING_YOUR_OBJECTS">Designing Your Objects</a></li>
<li><a href="#OBJECTS-OBJECT_SPECIFIERS">Object Specifiers</a></li>
<li><a href="#OBJECTS-STANDARD_CLASSES">Standard Classes</a></li>
<li><a href="#OBJECTS-STANDARD_PROPERTIES">Standard Properties</a></li>
</ul>
<li><a href="#COMMANDS">Commands</a></li>
<ul>
<li><a href="#COMMANDS-DESIGNING_YOUR_COMMANDS">Designing Your Commands</a></li>
<li><a href="#STANDARD-COMMANDS">Standard Commands</a></li>
</ul>
<li><a href="#VIEW">Scripting the View</a></li>
<ul>
<li><a href="#VIEW-SCRIPTING_WINDOWS">Scripting Windows</a></li>
<li><a href="#SELECTION">Scripting the Selection</a></li>
</ul>
<li><a href="#GENERAL_TIPS">General Tips</a></li>
<li><a href="#TIPS_FOR_USING_COCOA_SCRIPTING">Tips for Using Cocoa Scripting</a></li>
<li><a href="#REFERENCES">References</a></li>
<li><a href="#document_revision_summary">Document Revision History</a></li>
</ul></td></tr>
<tr><td colspan="3" scope="row">
<img width="680" height="10" src="images/1dot.gif" alt=""><br><img width="680" height="1" src="images/1dot_919699.gif" alt=""><br><img width="680" height="20" src="images/1dot.gif" alt="">
</td></tr>
</table>
<a name="INTRODUCTION"></a><h2>Introduction</h2>
<a name="INTRODUCTION-WHY_DO_THESE_GUIDELINES_EXIST_"></a><h3>Why do these guidelines exist?</h3>
<p>These guidelines serve a similar purpose to the <a href="../../documentation/UserExperience/Conceptual/AquaHIGuidelines/index.html">Human Interface Guidelines</a>: to promote basic design principles and consistency in the scripting interface of all Macintosh applications. The design principles are all about being task-specific; the more closely you match the user's mental model of your application, the more useful it will be. Consistency in the scripting interface is valuable for the same reasons it is in the regular interface: it makes it easier for users to learn new applications and decreases the chances that they will make mistakes by following old habits, which in turn reduces the number of support calls you will have to field. Additionally, consistency among applications promotes AppleScript as a coherent system, not just a thin bit of glue holding together a hodgepodge of what are practically different languages.</p>
<p>By following these guidelines, you can make your users happier, your own life easier, and help promote AppleScript as a useful tool.</p>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="INTRODUCTION-WHAT_IS_SCRIPTING_"></a><h3>What is scripting?</h3>
<p>Scripting is programming using a scripting language. That wasn't very helpful: what is a scripting language? A scripting language is a task-specific programming language, as opposed to a systems programming language such as C, C++, or Java. Systems programming languages are designed to build applications from the ground up and are very general purpose – you can build anything, but you also have to build everything, often out of very small pieces. Scripting languages, on the other hand, are designed with a particular task in mind. They can express things appropriate to the task very easily, but are awkward or even mute on other matters. For example, <code>awk</code> is very good at manipulating columnar text, and ActionScript is very good at multimedia, but you wouldn't want to use either of them for financial reporting.</p>
<p>Being task-specific is a good thing for several reasons. Not only does it let you write less code, but humans do much better at cognitive tasks (like programming) when the content is set in a familiar domain. Therefore, a publisher who is bewildered by pointers and bit arithmetic would still be able to write a complex script that works in terms of text flows and illustrations.</p>
<p>When thinking about what is task-specific, it is helpful to consider not only what the task is, but also what it is not. For example, the publisher above is concerned with box measurements and kerning, but does not want to be concerned with memory management or declaring variable types. Accordingly, scripting languages tend to allocate and deallocate memory automatically, not require variable types, and generally take care of a lot of the details that a systems programming language would require you to deal with.</p>
<p>All this focus and convenience comes at a cost, of course: some scripting languages are wildly inappropriate for some problems, and programs written in a scripting language generally run slower than an equivalent one written in a systems programming language. On the other hand, the scripter might not be able to write the faster version at all, or might simply not have the time, and an unwritten program runs only as fast as a human can do the task by hand.</p>
<p>For a complementary take on this subject, see John Ousterhout's paper <a href="http://home.pacbell.net/ouster/scripting.html">Scripting: Higher Level Programming for the 21st Century</a>. </p>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="INTRODUCTION-WHAT_IS_SCRIPTABILITY_"></a><h3>What is scriptability?</h3>
<p>Scriptability is the ability of your application to be controlled by a script – that is, a program – rather than a person armed with a keyboard and mouse. By making your application scriptable, users can customize it, tie it into automated workflows, and generally make it more useful to themselves in ways that were too specific for you to bother with, or that you never even imagined in the first place.</p>
<p>There are several ways to approach scriptability, but the most interesting and useful one is to expose your application's model layer. This term comes from the model-view-controller (MVC) design pattern: the model layer holds the application data and logic for operating on it; the view layer presents that data in a visible form, say in a window; and the controller layer mediates between them, updating the view as the model changes and updating the model as the user manipulates the view. For a full description, see <a href="../../documentation/Cocoa/Conceptual/CocoaFundamentals/CocoaDesignPatterns/chapter_5_section_4.html">The Model-View-Controller Design Pattern</a>. </p>
<p>Exposing the model rather than the view has two key advantages. First, the model is generally more stable than the view. As you produce new versions of your application, buttons may move and commands may change, but what your application actually does is relatively constant. If scripting is in terms of the model, then existing scripts and scripters' knowledge stay valid. Second, the model is more useful, because it has to do with the actual task, rather than how to do it. For example, if you want to change the name of a file in the Finder, you can say to set the name of that file, rather than describing the view-oriented steps: select the file, click on the name part, and type some characters.</p>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="INTRODUCTION-WHAT_IS_APPLESCRIPT_"></a><h3>What is AppleScript?</h3>
<p>AppleScript is a scripting language created by Apple Computer, and is the primary language for controlling scriptable Macintosh applications. It has an English-like syntax, is strongly object-oriented, and has several features that make it uniquely well-suited to working with large collections of objects. For full details, see the <a href="../../documentation/AppleScript/Conceptual/AppleScriptLangGuide/">AppleScript Language Guide</a>.</p>
<p>AppleScript approaches the problem of being task-specific in an unusual way. The base language does very little, and has no task-specific functions at all. What it does do is provide a framework into which you can plug any number of task-specific functions, namely applications. Depending on which object you are referring to, the vocabulary changes. For example, when talking to the Finder, you can speak of disks, folders, and files; when talking to Mail, you can speak of messages and mailboxes; and so on. In other words, applications are responsible for providing task-specific functions for the tasks that they know about; AppleScript provides the basic infrastructure and glue to pass information from one application to another.</p>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="BASICS"></a><h2>Basics</h2>
<p>Your application's scripting interface is advertised to the rest of the world, both the system and human users, by your dictionary. It lists all the objects and commands your application understands, along with how they are related and simple explanations of what they mean. AppleScript reads it to determine how to compile scripts, and it is the primary reference for scripters who want to know what your application can do. (This is not to say that it should be the only reference you provide. It shouldn't; ideally, you will also provide documentation and sample scripts. The dictionary is required, though.)</p>
<p>This section describes some general guidelines for creating your dictionary. Later sections contain specific guidance on particular topics such as objects or commands.</p>
<p>Opinion varies on whether you should write your whole dictionary first and then implement it, or write and implement iteratively bit by bit. Both have their advantages – the former makes it easier to be consistent, the latter makes it easier to ship at any time – choose whichever works for you.</p>
<p>Dictionaries currently come in three different formats:</p>
<ul>
<li><p><code>aete</code>: The original dictionary format. It is stored as a Resource Manager resource of type <code>aete</code>, hence the name. See <a href="../../documentation/mac/IAC/IAC-302.html">Creating an Apple Event Terminology Extension Resource</a> for further documentation.</p></li>
<li><p>script suite: Cocoa's native format. A script suite is a pair of plist files, one suite definition (.scriptSuite) and one suite terminology (.scriptTerminology). An application contains one or more script suites. In addition to the AppleScript terms, a script suite also contains information on how the terms connect to implementation classes and methods, and tells Cocoa's built-in scripting support what to do. See <a href="../../documentation/Cocoa/Conceptual/ScriptableCocoaApplications/SApps_suites/chapter_13_section_1.html">Specifying Application Scripting Support</a> for further documentation.</p></li>
<li><p>sdef: Short for scripting definition, an XML-based dictionary format. sdef is the recommended format for writing a dictionary, since it is a superset of the other two formats and has explicit support for features missing or not well supported in the others, such as synonyms. While you cannot currently use an sdef directly, you can turn it into either of the other two formats using the <code>sdp</code> tool. See the sdef(5) and <code>sdp</code>(1) man pages for further documentation.</p></li>
</ul>
<p>To see your dictionary as a user would, open it in Script Editor: launch Script Editor, choose Open Dictionary from the File menu, and select your application. If you are new to scripting, examine some other dictionaries. The Finder is a good example: it follows the guidelines reasonably well, and is complex enough to be interesting, but simple enough to be comprehensible.</p>
<p class="caption"><strong>Figure 1: </strong>Part of the Finder dictionary.</p>
<p><img src="images/tn2106_1.png" width="640" height="517" alt="Figure 1, Part of the Finder dictionary."></p>
<a name="BASICS-BEFORE_YOU_BEGIN"></a><h3>Before You Begin</h3>
<a name="BASICS_BEFORE_YOU_BEGIN-THINK_ABOUT_SCRIPTABILITY_EARLIER_RATHER_THAN_LATER_"></a><h4>Think about scriptability earlier rather than later.</h4>
<p>Thinking about how to make your application scriptable early in the design process will save you considerable time and agony. First, it is always easier to implement a feature that is planned for from the beginning than to bolt it on at the end. Second, and more importantly, scriptability forces you to think about your model. If you know what your conceptual model objects are, you can create implementation objects that match. This not only makes scriptability easier, it's just a good design practice.</p>
<a name="BASICS_BEFORE_YOU_BEGIN-KNOW_YOUR_MODEL_"></a><h4>Know your model.</h4>
<p>Scriptability means being task-specific, and being task-specific means revealing the things your application does: that is, your model. Therefore, it is essential that you have a firm grasp of your application model. What are the objects and commands that define what your application does, and how do they relate to each other? For example, Mail has mailboxes, mailboxes contain messages, messages have addressees and text and can be sent or forwarded, and so on. Notice that this says nothing about buttons, menu commands, or dialogs. Remember: model, not view.</p>
<p>If you can't figure out what your model is, or think you don't have one, you're probably either looking at it the wrong way or your application design needs work. Talking to your users can be helpful here – ask them what they do, and listen for the common objects and commands.</p>
<a name="BASICS_BEFORE_YOU_BEGIN-KNOW_YOUR_USERS_"></a><h4>Know your users.</h4>
<p>Being task-specific means being user task-specific, not programmer task-specific. Think of your application in terms of things users do with it, not in terms of how you, the implementor, make things happen behind the scenes. For any object or command in your dictionary, it should be immediately obvious to a normal user of your application what it is. If you have a very large and complicated application, knowing your users is also helpful in prioritizing what to make scriptable first. You are not obliged to do it all at once.</p>
<a name="BASICS_BEFORE_YOU_BEGIN-KNOW_APPLESCRIPT_"></a><h4>Know AppleScript.</h4>
<p>You do not have to learn AppleScript in every detail, but you should develop a feel for typical application command syntax, and for what AppleScript will do for you (and you therefore do not have to do yourself). The <a href="../../documentation/AppleScript/Conceptual/AppleScriptLangGuide/">AppleScript Language Guide</a> is the official Apple documentation for AppleScript, but there are a number of third-party books available as well. Playing with a scriptable application that follows the guidelines, such as the Finder, is also a good way to learn.</p>
<a name="BASICS_BEFORE_YOU_BEGIN-USE_AN_APPLICATION_FRAMEWORK_"></a><h4>Use an application framework.</h4>
<p>A large part of implementing scriptability properly involves implementing standard behavior. Using a framework will eliminate much of the drudgery and reduce the number of errors (or at least ensure that you have the same errors as everyone else using the framework). Apple's Cocoa and Metrowerks' PowerPlant both have good support for scriptability.</p>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="BASICS-DESIGNING_YOUR_DICTIONARY"></a><h3>Designing Your Dictionary</h3>
<a name="BASICS_DESIGNING_YOUR_DICTIONARY-STAY_ON_TASK_"></a><h4>Stay on-task.</h4>
<p>Yes, we've said it before, but it's important. Good scriptability is focused on tasks that are meaningful to the user. If you find yourself talking about error codes, bitfields, or other things that the user does not normally see, then you are drifting off-task. Also remember that tasks are based on the model – that is, the what – not the view, which is the how. If you find yourself talking about buttons and menus (and you are not working on an interface-building application), then you are attempting to script the view. Some view scripting is important – see <a href="#VIEW">Scripting the View</a> – but it is not the focus. If you have trouble thinking of tasks, remember these two directives instead: talk to the user, not the programmer; and script the model, not the view.</p>
<p>If you find yourself having trouble expressing your model in a way a user would consider sane, it may be a sign that your model needs fixing. (It may also be a sign that you need a break, so try that, too.) This happens sometimes: viewing your model from a different angle can reveal problems that were not apparent before. Perhaps one complex operation needs to be split, or two merged, or maybe you didn't understand the task domain as well as you thought you did. Go ahead and fix it, and fix it in your graphical interface too, if you can – you'll have a better application for it.</p>
<a name="BASICS_DESIGNING_YOUR_DICTIONARY-BE_OBJECT_ORIENTED_"></a><h4>Be object-oriented.</h4>
<p>Being object-oriented means that your scripting is mostly organized around objects, not commands. Objects can respond to commands – documents can be printed, messages can be sent, and so on – but the focus is on the objects, not the commands. This has several benefits:</p>
<p>First, it matches how the rest of AppleScript, and to some extent the Macintosh as a whole, works. It is therefore more consistent and makes more sense to users.</p>
<p>Second, it lets you exploit various features of AppleScript, like <code>tell</code> blocks and <code>whose</code> clauses, so users can create more concise and powerful scripts.</p>
<p>Third, it lets you create a smaller, more comprehensible dictionary, because you can apply a multiplicative effect: <code>n</code> commands times <code>m</code> objects yields <code>n</code>×<code>m</code> actions, but using only <code>n</code>+<code>m</code> terms. Consider an application that defines a <code>widget</code> object with eight properties. To make getters and setters for all the properties using only commands, we would need 16 commands with distressingly repetitive names: <code>GetWidgetName</code>, <code>SetWidgetName</code>, <code>GetWidgetColor</code>, and so on. Being object-oriented, however, lets us define the same power using only 11 terms: <code>widget</code>, <code>get</code>, <code>set</code>, and one for each property, with the added bonus that <code>get</code> and <code>set</code> can be re-used.</p>
<a name="BASICS_DESIGNING_YOUR_DICTIONARY-BE_ACCURATE_"></a><h4>Be accurate.</h4>
<p>Make sure you actually support everything you claim to in your dictionary. Be conservative in your dictionary if you need to; sdef provides a way to hide terms if you feel they are not yet ready for prime time. (So does the older <code>aete</code> format, but it's much harder to use.)</p>
<p>On a similar point, make sure that the types your dictionary defines for properties and parameters are accurate. Bear in mind that accurate refers to the scripter's (that is, the user's) perspective, not the implementor's. For example, there is no file URL type in AppleScript, but there is a file type, so even though your application fetches the parameter as <code>typeFileURL</code>, define it in your dictionary as <code>file</code>.</p>
<a name="BASICS_DESIGNING_YOUR_DICTIONARY-DON_T_RE_INVENT_THE_WHEEL_"></a><h4>Don't re-invent the wheel.</h4>
<p>The less you invent, the more consistent you will be, and the less your users will need to learn.</p>
<ul>
<li><p>Take advantage of inheritance – if two or more classes have common aspects, use inheritance to make a common base class for them so your dictionary doesn't repeat itself.</p></li>
<li><p>Learn from the system – AppleScript defines a number of common objects, properties, and commands.</p></li>
<li><p>Learn from the market – if another application already does something that you do, look for common terminology.</p></li>
</ul>
<p>A corollary to this is that you will probably not need to define many of your own commands. The standard commands take care of basic application functions and object manipulation (<code>open</code>, <code>quit</code>, <code>make</code>, <code>delete</code>, and so on – see <a href="#STANDARD-COMMANDS">Commands</a> for a complete list.) For example, Sketch, a sample drawing program, does not define any of its own commands – everything Sketch does can be expressed in terms of the standard commands, mostly by getting and setting object properties.</p>
<a name="BASICS_DESIGNING_YOUR_DICTIONARY-IT_S_OK_TO_DO_LESS_THAN_YOUR_GUI_"></a><h4>It's OK to do less than your GUI.</h4>
<p>Some operations possible through your graphical user interface may not be appropriate for a scripting interface, because they assume a level of dynamic interaction that simply isn't practical – for example, freehand sketching, or scrubbing through a movie. Do not feel obligated to include a function in your scripting interface just because it exists in your graphical interface.</p>
<p>Also, it may not be practical to make everything in your application scriptable all at once: you don't have the time, you expect a feature to change in the next release, whatever. Provide what you can, make it useful, and do the rest later.</p>
<a name="BASICS_DESIGNING_YOUR_DICTIONARY-IT_S_OK_TO_DO_MORE_THAN_YOUR_GUI_"></a><h4>It's OK to do more than your GUI.</h4>
<p>Scriptability is a great way to expose features in your application without having to implement a graphical interface for them. Sometimes these features are implicit in how AppleScript works: for example, the Finder has no command to delete files that meet a condition, but the <code>delete</code> command combined with a filter object specifier will accomplish just that, as in <code>delete every file whose name ends with ".jpg"</code>. You can also expose aspects of your model via scripting but not via the graphical interface, whether because you haven't got the time, don't know how, or simply don't want to clutter up the GUI. For example, Address Book exposed nickname and prefix properties for people via AppleScript one release before adding any graphical interface for them.</p>
<a name="BASICS_DESIGNING_YOUR_DICTIONARY-GET_FEEDBACK_"></a><h4>Get feedback.</h4>
<p>Find some users who care about scripting, let them play with your application, and listen to what they say. You may find some on staff already – testers tend to be fond of scripting, because it makes their jobs easier.</p>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="BASICS-WHEN_YOU_THINK_YOU_RE_DONE"></a><h3>When You Think You're Done</h3>
<a name="BASICS_WHEN_YOU_THINK_YOU_RE_DONE-TEST__TEST__TEST_"></a><h4>Test, test, test.</h4>
<p>Scriptability needs testing just like any other feature. Knowledge of AppleScript will be very helpful here, not just so you can write scripts, but so you can truly exercise the language. Newcomers often do not grasp the implications of object specifiers, and create commands that do not work with ranges or filter clauses.</p>
<a name="BASICS_WHEN_YOU_THINK_YOU_RE_DONE-GET_MORE_FEEDBACK_"></a><h4>Get more feedback.</h4>
<p>Internal development and testing is all well and good, but nothing substitutes for real-world usage. Let real users try your scriptable application. If you discover a mistake in your scriptability after you ship, you can still change it without breaking existing scripts by exploiting synonyms – see the sdef man page for details.</p>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="STYLE"></a><h2>Style</h2>
<p>This section describes style guidelines for your dictionary: organization, how to name things, comment style, and so on. </p>
<a name="STYLE-GENERAL"></a><h3>General</h3>
<a name="STYLE_GENERAL-USE_SUITES_AS_APPROPRIATE_"></a><h4>Use suites as appropriate.</h4>
<p>Dictionaries are broken into suites, which are clusters of related classes and commands. These are purely for the reader's benefit, and have no impact on your application or AppleScript. There is no technical limit, either upper or lower, on the number of items in a suite, but ten to fifteen is considered a comfortable size. However, do not force artificial distinctions just to break up a large suite or combine small ones – the ultimate point is to help the user find things.</p>
<p>Put system-defined suites first, followed by your own. Sort them in order of generality or frequency of use, or, failing that, alphabetically.</p>
<p>Within a suite, and for properties in a class, order items in some sensible manner. For a sufficiently small group, you may sort by importance or frequency of use, but this can be hard to judge. Alphabetical ordering is always a good fallback.</p>
<p>Within a command, order the parameters in a way that makes sense in a sentence. If this is impossible, use alphabetic order.</p>
<a name="STYLE_GENERAL-BE_ACCURATE_WITH_TYPES_"></a><h4>Be accurate with types.</h4>
<p>When specifying the type of a property or parameter, use the most specific type that is both accurate and meaningful to a user. Often, this is a simple choice of a single application-defined class or a primitive data type, but sometimes it's more interesting:</p>
<ul>
<li><p>If there are several possible types that all descend from a common base class, and all descendants of the base class are legal, use the base class.</p></li>
<li><p>If the type is a list of some other type, say so. (See sdef's <code>type="list of ..."</code> or <code>aete</code>'s <code>listOfItems</code> bit.)</p></li>
<li><p>Do not claim to accept all types unless you really mean it. (See sdef's <code>any</code> type, or <code>aete</code>'s <code>typeWildCard</code>.)</p></li>
<li><p>If you support two or more unrelated types – that is, not related by inheritance, as in the first case – say so. (See sdef's <code>type="T1 | T2 | ..."</code>. Doing this in <code>aete</code> is possible, but awkward.)</p></li>
</ul>
<a name="STYLE_GENERAL-THINGS_THAT_REFER_TO_OBJECTS_SHOULD_BE_OBJECTS_"></a><h4>Things that refer to objects should be objects.</h4>
<p>If a property or parameter refers to an object, its type should be an actual object, never data that signifies an object. Consider this command from many web browsers that breaks this guideline (and several others):</p>
<div class="notebox">
<p><strong>CloseWindow</strong></p>
<p>   [<strong>ID</strong> integer]  -- ID of the window to close. (Use -1 for topmost)</p>
<p>   [<strong>Title</strong> string]  -- Title of the window to close.</p>
</div>
<p>The correct way to do this is to define a <code>close</code> command that operates on <code>window</code> objects, which can then be specified by name, id, or several other ways. This allows more flexibility, and is simpler to define.</p>
<p><strong>A few words about files</strong></p>
<p>Files in AppleScript are considered to be objects. Therefore, properties and parameters that point to files should also be <code>file</code> objects. Do not use file path strings for this purpose. Similarly, do not have use file path strings anywhere – use a <code>file</code> object, and let scripts use the <code>path</code> property of files if they really need to. (Cocoa Scripting got this wrong when it was first implemented. This is being corrected; you should not consider it as granting permission.) Use sdef's <code>file</code> type; it will do the correct thing (or at least the most correct thing possible).</p>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="STYLE-CHOOSING_LANGUAGE_ELEMENTS"></a><h3>Choosing Language Elements</h3>
<a name="STYLE_CHOOSING_LANGUAGE_ELEMENTS-PROPERTIES_VS__ELEMENTS"></a><h4>Properties vs. elements</h4>
<p>Objects may contain other objects; these are either named properties (<code>inbox of application "Mail"</code>) or indexed elements (<code>mailbox 3 of application "Mail"</code>). The general rule is that if there is exactly one object, use a property; if there can be any number, use an element. For complete details, see <a href="#OBJECTS">Objects</a>.</p>
<a name="STYLE_CHOOSING_LANGUAGE_ELEMENTS-PROPERTIES_VS__COMMANDS"></a><h4>Properties vs. commands</h4>
<p>Sometimes setting a property can cause an immediate change on the screen. In deciding whether to use a property in this situation, a helpful rule is: When an action is initiated, use a command; when an attribute changes (even if it produces immediate visible results), use a property. Another way of looking at this is if a visible change is immediate, use a property, but if an action has a duration, use a command.</p>
<p>For example, the following command causes an immediate change on the screen:</p>
<pre class="sourcecodebox">set the font of the third paragraph to "Courier"</pre>
<p>Even though setting the font property creates a visible change, the font is still an attribute of the text, not an action. On the other hand, naming a property or enumerator <code>playing</code>, as shown in the next two commands, is a poor choice, because playing actually initiates an action:</p>
<pre class="sourcecodebox">set playing to true 
set [the] status to playing</pre>
<p>The <code>playing</code> enumerator value in the second command is fine for obtaining state information, but a status property should be read-only. Instead of creating a property to control an action, use a command. Commands such as play or start playing are better suited for actions, as shown here:</p>
<pre class="sourcecodebox">play the movie "Wowie Zowie" 
start playing the movie "Wowie Zowie"</pre>
<p>Note that the commands are <code>play</code> and <code>start playing</code>, not <code>play movie</code> and <code>start playing movie</code>. In a proper scripting model, <code>movie</code> would be an object class.</p>
<a name="STYLE_CHOOSING_LANGUAGE_ELEMENTS-ENUMERATIONS"></a><h4>Enumerations</h4>
<p>An enumeration is a set of constants (enumerators) which represent a fixed set of choices. Use an enumeration as the type of a parameter or property whenever there is a choice to be made from a specific list of possibilities. This helps the user see that there is a choice, and lets them know exactly what the choices are.</p>
<p class="smalltext"><strong>Table 1 : </strong>Enumerations</p>
<table cellspacing="0" class="graybox">
<tr>
<th>BAD</th>
<td scope="row"><code>property status integer -- 0=cold, 1=warm, 2=hot  set status to 1</code></td>
</tr>
<tr>
<th>GOOD</th>
<td scope="row"><code>property status cold/warm/hot  set status to warm</code></td>
</tr>
</table>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="STYLE-NAMING_RULES"></a><h3>Naming Rules</h3>
<a name="STYLE_NAMING_RULES-USE_USER_TERMS__NOT_IMPLEMENTATION_TERMS_"></a><h4>Use user terms, not implementation terms.</h4>
<p>Remember that you are speaking to a user, and should therefore use the terms they will find familiar. Ideally, the terms used in your graphical interface, scripting, and documentation should all match.</p>
<a name="STYLE_NAMING_RULES-USE_THE_THE_TEST_"></a><h4>Use the the test.</h4>
<p>AppleScript allows you to add or remove the word <code>the</code> almost anywhere in a script without changing the meaning of the script. Many script writers precede object and property names with the word <code>the</code> to make their scripts easier to read. Writing your test scripts in this way helps you determine the degree to which your property names facilitate forming natural sentences.</p>
<pre class="sourcecodebox">set the service to "America Online"
if the priority is high then ...</pre>
<p>Do not use <code>the</code> as part of a term. Scripters are accustomed to <code>the</code> being optional, but using it in a term makes it required.</p>
<a name="STYLE_NAMING_RULES-USE_LOWERCASE_"></a><h4>Use lowercase.</h4>
<p>Use all lowercase letters for your terms, except as required for proper names, trade names, and acronyms.</p>
<p class="smalltext"><strong>Table 2 : </strong>Capitalization</p>
<table cellspacing="0" class="graybox">
<tr>
<th>BAD</th>
<td scope="row"><code>Title</code></td>
</tr>
<tr>
<th>GOOD</th>
<td scope="row"><code>title</code></td>
</tr>
<tr>
<th>OK</th>
<td scope="row"><code>Macintosh, IEEE</code></td>
</tr>
</table>
<a name="STYLE_NAMING_RULES-USE_MULTIPLE_WORDS__NOT_INTERCAPS_OR_UNDERSCORES_"></a><h4>Use multiple words, not InterCaps or underscores.</h4>
<p>If a term consists of more than one word, separate the words with spaces. Do not join the words together with capital letters or underscores. Again, trade names are an exception to this.</p>
<p class="smalltext"><strong>Table 3 : </strong>Examples.</p>
<table cellspacing="0" class="graybox">
<tr>
<th>BAD </th>
<td scope="row">
<code>TransferProtocol, network_address</code> </td>
</tr>
<tr>
<th>GOOD </th>
<td scope="row">
<code>transfer protocol, network address</code> </td>
</tr>
<tr>
<th>OK </th>
<td scope="row">
<code>AppleTalk</code> </td>
</tr>
</table>
<a name="STYLE_NAMING_RULES-TERMS_MUST_FOLLOW_APPLESCRIPT_IDENTIFIER_RULES_"></a><h4>Terms must follow AppleScript identifier rules.</h4>
<p>Each word in a term must be a valid AppleScript identifier. That means they must begin with a letter or underscore, and be followed by any number of letters, numbers or underscores, the same as C-like languages. Punctuation is not allowed; underscores are not recommended as mentioned above.</p>
<a name="STYLE_NAMING_RULES-DO_NOT_CREATE_COMMANDS_THAT_LOOK_LIKE_OBJECTS__OR_OBJECTS_THAT_LOOK_LIKE_COMMANDS_"></a><h4>Do not create commands that look like objects, or objects that look like commands.</h4>
<p>Creating terms that look like other parts of speech will confuse scripters and lead them to try things that will not work. Consider the Standard Additions command <code>set the clipboard to</code>: seeing it in a script, you might think that it is a <code>set</code> command operating on a <code>clipboard</code> property, but it really isn't, so the supposedly equivalent <code>copy x to the clipboard</code> would not work.</p>
<a name="STYLE_NAMING_RULES-DO_NOT_START_PROPERTY_NAMES_WITH_IMPERATIVE_VERBS_"></a><h4>Do not start property names with imperative verbs.</h4>
<p>Starting property names with verbs leads to confusion when the property appears in the middle of a sentence. For example, naming a property <code>disable call waiting</code> leads to commands that do not read smoothly:</p>
<pre class="sourcecodebox">set disable call waiting to true 
if disable call waiting then ...</pre>
<p>Also, the name disable call waiting looks like a command. A user might be tempted to say</p>
<pre class="sourcecodebox">disable call waiting</pre>
<p>This will compile and run, but does not disable anything – it merely returns the current value of the property. You can prevent such confusion by using a participle instead. This is somewhat clearer:</p>
<pre class="sourcecodebox">set call waiting enabled to false 
if not call waiting enabled ...</pre>
<p>Even better would be to name the property <code>call waiting</code> and use an enumeration as its value type. The choices <code>enabled</code> and <code>disabled</code> allow grammatically correct sentences:</p>
<pre class="sourcecodebox">set call waiting to enabled 
if call waiting is disabled ...</pre>
<a name="STYLE_NAMING_RULES-AVOID_BEGINNING_TERMS_WITH_LANGUAGE_KEYWORDS_"></a><h4>Avoid beginning terms with language keywords.</h4>
<p>Using a language keyword as the first word in a term may make it impossible to use that keyword in certain contexts. For example, consider an application that defines a <code>mailbox</code> class that contains <code>message</code> objects. Adding an application property named <code>in mailbox</code> would prevent scripters from using the keyword <code>in</code> as a synonym for <code>of</code> in some cases: <code>messages in mailbox 1</code> would be parsed as <code>messages in mailbox 1</code>, which is illegal, instead of the intended <code>messages in mailbox 1</code>.</p>
<p>It is possible to successfully begin terms with keywords – consider the Standard Additions command <code>set the clipboard to</code> – but it is not recommended. Terms may use language keywords in the middle or at the end of terms, but see some of the following guidelines.</p>
<p class="smalltext"><strong>Table 4 : </strong>Reserved words in AppleScript 1</p>
<table cellspacing="0" class="graybox">
<tr>
<td scope="row">after </td>
<td>does </td>
<td>get </td>
<td>my </td>
<td>second </td>
<td>to </td>
</tr>
<tr>
<td scope="row">and </td>
<td>eighth </td>
<td>given </td>
<td>ninth </td>
<td>set </td>
<td>transaction </td>
</tr>
<tr>
<td scope="row">as </td>
<td>else </td>
<td>global </td>
<td>not </td>
<td>seventh </td>
<td>true </td>
</tr>
<tr>
<td scope="row">back </td>
<td>end </td>
<td>if </td>
<td>of </td>
<td>sixth </td>
<td>try </td>
</tr>
<tr>
<td scope="row">before </td>
<td>equal </td>
<td>ignoring </td>
<td>on </td>
<td>some </td>
<td>until </td>
</tr>
<tr>
<td scope="row">beginning </td>
<td>equals </td>
<td>in </td>
<td>or </td>
<td>tell </td>
<td>where </td>
</tr>
<tr>
<td scope="row">behind </td>
<td>error </td>
<td>into </td>
<td>prop </td>
<td>tenth </td>
<td>while </td>
</tr>
<tr>
<td scope="row">but </td>
<td>every </td>
<td>is </td>
<td>property </td>
<td>that </td>
<td>whose </td>
</tr>
<tr>
<td scope="row">by </td>
<td>exit </td>
<td>it </td>
<td>put </td>
<td>the </td>
<td>with </td>
</tr>
<tr>
<td scope="row">considering </td>
<td>false </td>
<td>its </td>
<td>ref </td>
<td>then </td>
<td>without </td>
</tr>
<tr>
<td scope="row">contain </td>
<td>fifth </td>
<td>last </td>
<td>reference </td>
<td>third </td>
<td>&nbsp;</td>
</tr>
<tr>
<td scope="row">contains </td>
<td>first </td>
<td>local </td>
<td>repeat </td>
<td>through </td>
<td>&nbsp;</td>
</tr>
<tr>
<td scope="row">continue </td>
<td>fourth </td>
<td>me </td>
<td>return </td>
<td>thru </td>
<td>&nbsp;</td>
</tr>
<tr>
<td scope="row">copy </td>
<td>from </td>
<td>middle </td>
<td>returning </td>
<td>timeout </td>
<td>&nbsp;</td>
</tr>
<tr>
<td scope="row">div </td>
<td>front </td>
<td>mod </td>
<td>script </td>
<td>times </td>
<td>&nbsp;</td>
</tr>
</table>
<a name="STYLE_NAMING_RULES-AVOID_USING__IS__IN_BOOLEAN_PROPERTY_AND_PARAMETER_NAMES_"></a><h4>Avoid using 'is' in Boolean property and parameter names.</h4>
<p>This is a specific case of the previous rule: <code>is</code> is a reserved word meaning is equal to. For example, instead of <code>is minimized</code>, <code>is encrypted</code>, or <code>is busy</code>, use <code>minimized</code>, <code>encrypted</code>, and <code>busy</code>. </p>
<p>Also, the AppleScript parser pulls a few special tricks on Boolean properties and parameters that make them read better without the is.</p>
<p>AppleScript will change <code>true</code> and <code>false</code> in Boolean parameters to <code>with</code> and <code>without</code>. For example, if a scripter writes</p>
<pre class="sourcecodebox">send message "Fred" queuing true</pre>
<p>it compiles to</p>
<pre class="sourcecodebox">send message "Fred" with queuing</pre>
<p>Also, tests of Boolean properties can be written specially: instead of saying <code>property</code> of <code>object</code> is true (or false), you can say <code>object</code> is (or is not) <code>property</code>. For example, the following two lines are equivalent:</p>
<pre class="sourcecodebox">if miniaturized of window 1 is true then ... 
if window 1 is miniaturized then ...</pre>
<p>If the property were named <code>is miniaturized</code>, the second line would have to be written <code>if window 1 is is miniaturized</code>, which is awkward. Notice that these special forms read best if the property name is simply an adjective, not an adjectival phrase such as <code>has x</code> or <code>wants x</code>.</p>
<a name="STYLE_NAMING_RULES-AVOID_USING__OF__IN_A_NAME_"></a><h4>Avoid using 'of' in a name.</h4>
<p><code>Of</code> is a reserved word used between parts of an object specifier. AppleScript will let you get away with this, but it can be very confusing to read, because it makes the term look like a property of an object, which it isn't.</p>
<a name="STYLE_NAMING_RULES-AVOID_USING__END__AS_THE_FIRST_WORD_IN_A_COMMAND_"></a><h4>Avoid using 'end' as the first word in a command.</h4>
<p>Several AppleScript constructs use <code>end</code> to end a block: <code>end if</code>, <code>end repeat</code>, and so on. In these cases, AppleScript will fill in the word after the <code>end</code> automatically. Users may be tempted to try the same thing with your command, and it won't work.</p>
<p class="smalltext"><strong>Table 5 : </strong>Examples of terms.</p>
<table cellspacing="0" class="graybox">
<tr>
<th>BAD </th>
<td scope="row">
<code>begin animating, end animating</code> </td>
</tr>
<tr>
<th>GOOD </th>
<td scope="row">
<code>start animating, stop animating</code> </td>
</tr>
</table>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="STYLE-COMMENT_STYLE"></a><h3>Comment style</h3>
<p>Any dictionary term can have an associated comment (sdef's and suite terminology's <code>description</code> attributes, or <code>aete</code>'s comment fields). Use them to help clarify how your vocabulary is to be used. Since your dictionary is often the initial window through which a user looks to figure out what to do, descriptive comments can make the user's task a lot easier. Remember that your users are not necessarily programmers, so avoid implementation terms in your comments.</p>
<ul>
<li><p>For Boolean parameters and properties, if there are two possible states, include a description of the true and false conditions, such as true if the script will modify the original images, false if the images will be left alone.</p></li>
<li><p>If the possible states are on and off, you need only include the true condition (If true, then screen refresh is turned on) or ask a question starting with is or does (Is the window zoomed?).</p></li>
<li><p>For enumerations, include a general description of what the parameter or property represents; the individual enumerators should be self-explanatory. For example, yes | no | ask -- Specifies whether or not changes should be saved before closing.</p></li>
<li><p>Don't use the comment field to explain a set of possible numeric values when an enumeration (with descriptive enumerators) is better. Instead of 0=read, 1=unread, … use read | unread | …</p></li>
<li><p>If you allow more than one type (see sdef's <code>type="T1 | T2 | ..."</code>), include a description of the choices for the types listed: the connection's window (either a reference or name can be used).</p></li>
<li><p>If the parameter or property has a default value (used when the user doesn't include an optional parameter or set the property), mention it. This applies to values of any type: replacing yes | no | ask -- Replace the file if it exists? (defaults to ask).</p></li>
</ul>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="OBJECTS"></a><h2>Objects</h2>
<p>Because AppleScript is so object-centric, defining a sensible object and class hierarchy and making it behave in all the standard ways is perhaps the most important part of creating a good scripting interface for your application. To paraphrase Fred Brooks slightly: Show me your code and conceal your objects, and I shall continue to be mystified. Show me your objects, and I won't usually need your code; it will be obvious.</p>
<a name="OBJECTS-DESIGNING_YOUR_OBJECTS"></a><h3>Designing Your Objects</h3>
<p>As always, the basic rule is be task specific. Reveal objects that have a direct bearing on things the user will do with your application. Expose the model, not the interface. Do not reveal implementation details – users will not care, or worse, it will confuse them.</p>
<p>There are two different hierarchies to consider: the inheritance hierarchy – what behaves like what – and the containment hierarchy – who owns what. Make your hierarchies match what a user would expect.</p>
<a name="OBJECTS_DESIGNING_YOUR_OBJECTS-INHERITANCE"></a><h4>Inheritance</h4>
<p>AppleScript supports single inheritance, so you can define a class to be just like another class, but with additional properties or elements. A subclass does not have to define any new parts; sometimes just being a different class is enough. Mail's <code>recipient</code> classes do this.</p>
<p>Use inheritance to effectively shrink your dictionary by removing redundant information. If several classes share common elements or properties, make them all inherit from a base class that defines the common parts. Do not use inheritance if a class has only one descendant, because that just complicates the dictionary.</p>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="OBJECTS_DESIGNING_YOUR_OBJECTS-CONTAINMENT"></a><h4>Containment</h4>
<p>AppleScript defines two kinds of containment relationships: elements and properties. In <a href="../../documentation/Cocoa/Conceptual/CocoaFundamentals/CocoaDesignPatterns/chapter_5_section_5.html">entity-relationship modeling</a> terms, an element is a to-many relationship, and a property is either an attribute or a to-one relationship. (Entity-relationship modeling distinguishes between primitive data and other objects; AppleScript does not.) A property is a single value, while there may be any number of elements. Special cases such as zero-or-one or any-number-in-a-range can be emulated using properties or elements with additional behavior, as shown here:</p>
<p class="smalltext"><strong>Table 6 : </strong>Containment terminology.</p>
<table cellspacing="0" class="graybox">
<tr>
<th>how many? </th>
<th>use </th>
<th>example </th>
</tr>
<tr>
<td scope="row">exactly one </td>
<td>property </td>
<td>
<code>name</code> </td>
</tr>
<tr>
<td scope="row">any number </td>
<td>element </td>
<td>
<code>documents</code> </td>
</tr>
<tr>
<td scope="row">zero or one </td>
<td>property, value may be <code>missing value</code> </td>
<td>
<code>current printer</code> </td>
</tr>
<tr>
<td scope="row">exactly <code>n</code>, <code>n</code> &gt; 1 </td>
<td>element, but can't <code>make</code> or <code>delete</code> </td>
<td>
<code>domains of application "System Events"</code> </td>
</tr>
</table>
<p>In general, prefer an element to a property whose value is a list of objects – it is more consistent and is easier to implement. In particular, do not do something like this: </p>
<pre class="sourcecodebox">class widget (pl. widgets)...

class box:

     property widgets: list of widget</pre>
<p>This is especially evil, because it makes <code>widget</code> look like an element of <code>box</code> when it really isn't. For example, <code>widgets of box 1</code> works, and looks like an every specifier, but the supposedly equivalent <code>every widget of box 1</code> will fail, because it was really a property specifier.</p>
<p>If you do implement such a property (see the standard <code>selection</code> property for an example), make sure that it works exactly as a normal container in object specifiers – element subclasses, filters, and so on should all work. </p>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="OBJECTS-OBJECT_SPECIFIERS"></a><h3>Object Specifiers</h3>
<p>All objects in an application, aside from the root <code>application</code> object, are contained by some other object. To select a particular object or set of objects, a script uses an object specifier, or specifier for short, which is an expression of the form <code>object-expression of container</code>. <code>Container</code> is itself an object specifier, so the application recursively works its way up the containment chain until it reaches the (often implied) root <code>application</code> object, which contains everything. For example:</p>
<div style="font-family: Courier New, monospace; font-size: 12px; color: black; background: #e6e6e6; white-space: pre; padding: 5px; width: 470px; margin-left: auto; margin-right: auto;">
<span style="text-decoration: underline">length</span> of <span style="text-decoration: underline">word 1</span> of <span style="text-decoration: underline">every paragraph</span> of <span style="text-decoration: underline">document "Smith Project"</span>
</div>
<p>The underlined portions show each component. Notice that each component uses a different key form. The complete set of key forms is listed in the table below. Most key forms imply the existence of a particular property for that object: if the object has that property, then it should support that key form, and vice versa.</p>
<p class="smalltext"><strong>Table 7 : </strong>Object Specifiers</p>
<table cellspacing="0" class="graybox">
<tr>
<th>key form </th>
<th>property </th>
<th>example </th>
</tr>
<tr>
<td scope="row">arbitrary </td>
<td>— </td>
<td><code><span style="text-decoration: underline">some</span> file of the startup disk</code></td>
</tr>
<tr>
<td scope="row">every </td>
<td>index </td>
<td><code><span style="text-decoration: underline">every</span> word of document 1</code></td>
</tr>
<tr>
<td scope="row">filter </td>
<td>— </td>
<td><code>every document <span style="text-decoration: underline">whose name starts with "Smith"</span><br>
	    first paragraph <span style="text-decoration: underline">where it contains "Anderson"</span></code></td>
</tr>
<tr>
<td scope="row">ID </td>
<td>id </td>
<td><code>application file <span style="text-decoration: underline">id "com.apple.finder"</span><br>
	    message viewer <span style="text-decoration: underline">id 4871536</span></code></td>
</tr>
<tr>
<td scope="row">index </td>
<td>index </td>
<td><code>word <span style="text-decoration: underline">3</span><br>paragraph <span style="text-decoration: underline">index -1</span></code></td>
</tr>
<tr>
<td scope="row">middle </td>
<td>index </td>
<td><code><span style="text-decoration: underline">middle</span> shape of drawing 1</code></td>
</tr>
<tr>
<td scope="row">name </td>
<td>name </td>
<td><code>folder <span style="text-decoration: underline">"Bob"</span><br>
	    file <span style="text-decoration: underline">named "Smith Project"</span></code></td>
</tr>
<tr>
<td scope="row">property </td>
<td>— </td>
<td><code><span style="text-decoration: underline">name</span> of document 1</code></td>
</tr>
<tr>
<td scope="row">range </td>
<td>index </td>
<td><code>words <span style="text-decoration: underline">3 through 8</span><br>every word <span style="text-decoration: underline">from character 1 to paragraph 3</span></code></td>
</tr>
<tr>
<td scope="row">relative </td>
<td>index </td>
<td><code>word <span style="text-decoration: underline">after word 4</span></code></td>
</tr>
</table>
<p>Additionally, allowable key forms for a container are determined by the nature of the container and its elements. This also determines what locations, if any, are meaningful for the <code>make</code> and <code>move</code> commands. There are, broadly, three types of containers: </p>
<p>In an ordered container, the user determines exactly how the items are arranged. Any item can be placed before (or after) any other item using <code>make</code> or <code>move</code>, and it will stay there. Paragraphs of a text document are ordered, as are items in an AppleScript list.</p>
<p>In an unordered container, the data itself determines the order of the items – for example, alphabetical order – or there simply is no particular order. While you can ask for the <code>n</code>th item, iterate through all of them, or speak of the item before or after another one, asking to make an item at or move it to a particular position is meaningless – all you can do is ask to put it in the container. People in Address Book, files in the Finder, and items in an AppleScript record are all unordered.</p>
<p>In an uncounted container, the application does not know how many items there are. All index forms are meaningless, as is the idea of <code>every</code>. To get an item, you must know something else about it: its name, its id, some property, or similar. Web servers on the Internet are uncounted.</p>
<p class="smalltext"><strong>Table 8 : </strong>Object Specifier Types</p>
<table cellspacing="0" class="graybox">
<tr>
<th>container type </th>
<th>example </th>
<th>access by </th>
<th>make at </th>
</tr>
<tr>
<td scope="row">ordered </td>
<td>an AppleScript list </td>
<td>indexed, relative, arbitrary </td>
<td>indexed, relative, container </td>
</tr>
<tr>
<td scope="row">unordered </td>
<td>an AppleScript record,<br>people in Address Book </td>
<td>indexed, relative, arbitrary </td>
<td>container </td>
</tr>
<tr>
<td scope="row">uncounted </td>
<td>all Web servers on the Internet </td>
<td>- </td>
<td>container </td>
</tr>
</table>
<a name="KEY-FORMS"></a><h4>Key Forms</h4>
<p>This section gives behavior details for each of the key forms. It does not give syntax or usage details; for that, see Chapter 5 of the AppleScript Language Guide.</p>
<p><strong>Arbitrary</strong></p>
<p>If you support this key form, it should return a genuinely random object, not always the same one. This key form is useful whenever a script needs random behavior. For example, a script could select a random signature in Mail by saying <code>some signature</code>, rather than the more complicated <code>signature (random number from 1 to (count signatures))</code>.</p>
<p><strong>Every</strong></p>
<p><code>every item</code> is equivalent to <code>items 1 through -1</code>, except that <code>every</code> returns an empty list if there are no elements, instead of an error. See <a href="#RANGE">Range</a> for more details.</p>
<p><strong>Filter</strong></p>
<p>For historical reasons, Filter is considered its own key form, though it would be more accurate to think of it as a modifier to index-based key forms (index, arbitrary, middle, range, and every). While the filter key form is most often used with a test on a property of the object (such as <code>files whose name contains "Smith"</code>), tests on an element or the object itself are also valid. For example: </p>
<pre class="sourcecodebox">paragraphs where it starts with "The"
albums where it contains photo "White Rabbit" 
documents whose first paragraph contains the word "Metacortex"</pre>
<p>In theory, any boolean expression should be valid, but AppleScript currently cannot deal with function calls in a filter expression.</p>
<p>If an object under consideration does not have an attribute specified in the filter, it is not an error – consider the value to be <code>missing value</code> and respond appropriately.</p>
<p><strong>ID</strong></p>
<p>Returns a single object whose <code>id</code> property matches the specified value. ID data should not honor the current AppleScript considerations, such as <code>considering case</code>. Treat IDs as always case-insensitive, or as always case-sensitive if case is relevant (that is, if <code>"ijkl"</code> and <code>"IJKL"</code> are both valid and different).</p>
<p><strong>Index</strong></p>
<p>Item indicies should match the user's model of a first-to-last or front-to-back ordering. (In fact, <code>first</code> and <code>front</code> are synonyms in AppleScript, as are <code>last</code> and <code>back</code>.) This means that <code>window 1</code> should always be the front window, <code>table 1</code> should be the first table in the document, and so on. Negative indicies go backwards from the end, so <code>item -1</code> and <code>last item</code> mean the same thing, <code>item -2</code> is the second-to-last item, and so on.</p>
<p>If the items are unordered as defined above, then ideally the index should match how the items are currently displayed. Failing that, pick a consistent order – say, alphabetical – and use that.</p>
<p><strong>Named</strong></p>
<p>Returns a single object whose <code>name</code> property matches the specified string. String matching should honor the current AppleScript considerations, such as <code>considering case</code> or <code>ignoring diacriticals</code>. Name data may come to your application as plain or Unicode text, so be prepared to handle either, even if you do not use full Unicode internally.</p>
<a name="RANGE"></a><p><strong>Range</strong></p>
<p>Ranges may be specified as either two indicies or two endpoint objects, which are included in the range. If either endpoint does not exist, or if they are not both in the same container, return an error. Guidelines for the meaning of indicies apply as for the index key form above.</p>
<p>The order of the endpoints does not matter – always return the objects in order, lowest index to highest. For example, <code>words 8 through 1</code> should return the same thing as <code>words 1 through 8</code>.</p>
<p>Text presents a special case: because of how its containment works, it is possible to specify two endpoints where one is inside the other. (Normally, this would be an invalid range, because the two objects would have different containers.) To resolve this, find the beginnings of both endpoints, start from the one closest to the beginning of the text, and then go to the end of the other endpoint object. For example:</p>
<pre class="sourcecodebox">set t to "Through three cheese trees three free fleas flew"

words from paragraph 1 to word 3 of t
--&gt; {"Through", "three", "cheese"}

characters from character 10 to word 2 of t
--&gt; {"h", "r", "e", "e"}</pre>
<p>Range specifiers always return a list, even if the range contains only one object (or, in the case of every, no objects). If a range reference is used as the container for another property or object, the result is that property or object of every item in the range. For example: </p>
<pre class="sourcecodebox">name of files 2 thru 3 of home
--&gt; {"Memory report", "BBEdit update.dmg"}</pre>
<p>The list of values returned should always parallel the list that would have been returned for the range. That is, it should be in the same order and have the same number of values. For example: </p>
<pre class="sourcecodebox">every duck --&gt; {mallard "Daffy", pintail "Marvin", decoy duck "Q-36"}

name of every duck
--&gt; {"Daffy", "Marvin", "Q-36"}</pre>
<p>This applies even if some of the objects do not have the specified property or element. For such objects, return <code>missing value</code>. Continuing the example, consider a feet are webbed property, given that decoys do not have feet:</p>
<pre class="sourcecodebox">feet are webbed of every duck
--&gt; {true, true, missing value}</pre>
<p>If the specified element is another range, then the result is a list of lists. For example:</p>
<pre class="sourcecodebox">every duck of every flock
--&gt; {{mallard "Ned", mallard "Ted"}, {pintail "Ann", pintail "Dan"}}</pre>
<p><strong>Relative</strong></p>
<p>Relative specifiers are of the form <code>class (before | after) specifier</code>, where <code>specifier</code> may be any other specifier, including another relative specifier. Therefore, <code>word after word after word 1</code> is a perfectly valid way to describe the third word. This may seem peculiar, but is relevant when working with text selections: if the selection is an insertion point, say, <code>insertion point after word 12</code> the word after that point would be <code>word after insertion point after word 12</code>.</p>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="OBJECTS_OBJECT_SPECIFIERS-ELEMENTS_AND_INHERITANCE"></a><h4>Elements and Inheritance</h4>
<p>A container does not need to define a distinct element relationship for every class it holds – it may imply them by inheritance. If an object contains objects of some class, a specifier may specify any subclass and the request will be restricted to objects of that class. For example, consider the fictitious application DuckTracker:</p>
<div class="notebox">
<p>class <strong>duck</strong>: …</p>
<p>class <strong>canvasback</strong>: inherits from <strong>duck</strong> …</p>
<p>class <strong>mallard</strong>: inherits from <strong>duck</strong> …</p>
<p>class <strong>pintail</strong>: inherits from <strong>duck</strong> …</p>
<p>class <strong>application</strong></p>
<p>    element <strong>duck</strong> by index, by name…</p>
</div>
<p>Even though it only explicitly specifies <code>duck</code> as an element, a script could ask for <code>every mallard</code> and receive a list of all the mallards.</p>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="BUILDING-OSPECS"></a><h4>Returning Object Specifiers</h4>
<p>An object in your application can typically be referenced in one of several ways. For example, <code>window 1</code>, <code>window "Lister"</code>, and <code>window id 743</code> might all refer to the same window. If you need to return an object, though – say a script asks to get the first window whose name begins with "L" – you will need to pick a particular key form. The form you choose is known as a canonical object specifier, and should be the most reliable way to refer to that object. That is, it stands the best chance of referring to the same object later as things change.</p>
<p>The general rule for the form to use is:</p>
<ul>
<li><p>If the object has an <code>id</code> property, use that. (<code>window id 743</code>)</p></li>
<li><p>If the object has a <code>name</code> property, use that. (<code>window "Lister"</code>)</p></li>
<li><p>Otherwise, use its index (<code>window 1</code>). The index should always be positive.</p></li>
</ul>
<p>The class of an object specifier should be the actual class of the object. Continuing the DuckTracker example from above, this would be something like <code>mallard id 8237</code>, not <code>duck id 8237</code>, even though both refer to the same object.</p>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="OBJECTS_OBJECT_SPECIFIERS-UNUSUAL_CONCERNS"></a><h4>Unusual Concerns</h4>
<p><strong>Many-to-one and many-to-many relationships</strong></p>
<p>In most applications, all object relationships are one-to-one or one-to-many, the result being that all objects are contained by exactly one other object. Some applications, however, have many-to-one or many-to-many relationships, so a single object may appear in several different containers. iPhoto behaves like this: a <code>photo</code> object may be in any number of <code>albums</code>. There is nothing wrong with this model, but it does require certain adjustments.</p>
<p>First, you must support the commands <code>add</code> and <code>remove</code>. These commands are designed to only manipulate containment, as opposed to creating and destroying objects like <code>make</code> and <code>delete</code> do. The distinction is important because <code>make</code> and <code>delete</code> do not have the proper meanings for some tasks. Say you want to add an existing photo to an album in iPhoto. <code>make</code> is not really appropriate, since you're not making anything. Similarly, say you want to remove a photo from an album. <code>delete</code> is ambiguous: will it merely remove the photo from that album, or will it delete the photo entirely? You could resolve the problem without different commands by introducing a photo reference object, except that there is no such thing in the user model, and would therefore violate the stay on-task guideline. </p>
<p>Second, is it possible for your objects (call them photos, to continue the iPhoto analogy) to not belong to any specific container (album)? For example, in iPhoto, a photo may not be in any album. If this is the case, then you will need to designate a single master container that holds all the photos; they may be added to and removed from albums from there. (iPhoto uses <code>application</code> for this.) If not, then you do not need a master container, but removing a photo from its last album must delete it.</p>
<a name="NONSYMMETRIC"></a><p><strong>Non-symmetric specifiers</strong></p>
<p>In general, if an object is obtained by a particular property, then the object's property ought to match. For example, <code>name of thing "Bob"</code> ought to always be <code>"Bob"</code>, <code>id of thing id 427</code> ought to always be <code>427</code>, and so on.</p>
<p>In some applications, however, this may not be the case. Typically, the reason is that an object may have more than one valid name (or id, and so on). For example, the Finder's <code>application file</code> class responds to an id of either the old-style creator type or the new-style bundle id: <code>application file id "emal"</code> and <code>application file id "com.apple.mail"</code> both return the same thing.</p>
<p>It is perfectly acceptable for multiple key data to return the same object. (If this creates ambiguities, then see below.) However, you should have some way for the user to discover all the different data an object can be specified by. The basic property (for example, <code>name</code>) should reflect the canonical data; add other properties for the rest. For example, if a file's extension is hidden in the Finder, it will respond to either the visible name (without the extension) or on-disk name (with the extension). The on-disk name is considered the canonical name; the visible name is available via the <code>displayed name</code> property.</p>
<p><strong>Non-unique key forms</strong></p>
<p>Typically, names and IDs are unique at least within in a container, so there is only one object <code>folder "Bob"</code> could possibly return. However, this is not always the case – for example, in some applications, names are purely for the user's reference, and the application makes no attempt to keep them unique.</p>
<p>For such applications, invoke the be consistent about return types rule: named and indexed key forms normally return a single object, so they should still do so even in the face of ambiguous objects. If one object is a better match than the other, return that one; if there is no best match, return the first one. However, ensure that users can select all the matching objects using a filter expression of some sort, such as <code>every item whose name is ...</code></p>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="OBJECTS-STANDARD_CLASSES"></a><h3>Standard Classes</h3>
<p>There are a few standard classes that applications should define. The only one that an application must define is <code>application</code>, the root of the containment hierarchy. (The root of the inheritance hierarchy, <code>item</code>, is defined by AppleScript itself and does not need to appear in your dictionary.) The properties shown here are merely starting points; a real application will need to define more, since the ones shown here do almost nothing. Classes and properties may be omitted if they are not relevant to an application. For example, not all applications have documents, or even a selection. Similarly, properties marked here as read-only might be writable (or vice versa) in some applications.</p>
<div class="notebox">
<p><strong>application</strong></p>
<p>    <strong>name</strong> text [r/o]  -- The name of the application.</p>
<p>    <strong>frontmost</strong> boolean  -- Is this the frontmost application?</p>
<p>    <strong>version</strong> text [r/o]  -- The short version string of the application.</p>
<p>    <strong>selection</strong> <code>varies</code>  -- The current selection; the exact type depends on the application.</p>
<p>    element <strong>window</strong></p>
<p>    element <strong>document</strong> </p>
</div>
<p><code>application</code> is the root of the containment hierarchy. That is, it contains, directly or indirectly, all the objects belonging to the application. <code>window</code> elements are only those application windows that contain other scriptable objects, such as document windows – modal dialogs, sheets, and formatting or tool palettes should not be included. (Palettes may be included as properties, however.)</p>
<div class="notebox">
<p><strong>document</strong></p>
<p>    <strong>name</strong> text [r/o]  -- The name of the document.</p>
<p>    <strong>modified</strong> boolean [r/o]  -- Does the document have unsaved changes?</p>
<p>    <strong>file</strong> file [r/o]  -- The file for the document; may be missing value if the document has never been saved. </p>
</div>
<p>An application document. The <code>name</code> property is user-visible name, not the on-disk name. <code>name</code> and <code>file</code> are typically read-only; use the <code>save</code> command to change them.</p>
<div class="notebox">
<p><strong>window</strong></p>
<p>    <strong>name</strong> text [r/o]  -- The title of the window.</p>
<p>    <strong>bounds</strong> rectangle  -- The bounding rectangle of the window.</p>
<p>    <strong>closeable</strong> boolean [r/o]  -- Can the window be closed?</p>
<p>    <strong>minimizable</strong> boolean [r/o]  -- Can the window be minimized?</p>
<p>    <strong>minimized</strong> boolean  -- Is the is window minimized?</p>
<p>    <strong>resizable</strong> boolean [r/o]  -- Can the window be resized?</p>
<p>    <strong>visible</strong> boolean  -- Is the window visible?</p>
<p>    <strong>zoomable</strong> boolean [r/o]  -- Can the window be zoomed?</p>
<p>    <strong>zoomed</strong> boolean  -- Is the window zoomed?</p>
</div>
<p>A window, which may be a document window or palette, but not a sheet or modal dialog. <code>bounds</code> is given as a list of four numbers: {top, left, bottom, right}, with the origin at the top left of the display and x, y values increasing to the right and down, respectively. (In other words, a Quickdraw rectangle. This differs from AppleScript Studio, which returns bounds as {left, bottom, right, top}, with the origin at the bottom left and x, y values increasing to the right and up.) <code>visible</code> refers to whether or not the window is visible as with a show/hide command, not whether or not the window has been moved to lie mostly off-screen.</p>
<div class="notebox">
<p><strong>item</strong></p>
<p>    <strong>class</strong> class [r/o]  -- The class of the object.</p>
<p>    <strong>properties</strong> record  -- All the properties of the object.</p>
</div>
<p>The root of the inheritance hierarchy, and the ultimate ancestor of all classes. See below for complete descriptions of the <code>class</code> and <code>properties</code> properties. Since <code>item</code> is defined by AppleScript, it should not appear in your dictionary. In particular, do not redefine <code>item</code> with additional properties or elements – create your own class with a different name. Classes do not need to explicitly define that they inherit from <code>item</code> – if there is no other parent, <code>item</code> is assumed.</p>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="OBJECTS-STANDARD_PROPERTIES"></a><h3>Standard Properties</h3>
<a name="OBJECTS_STANDARD_PROPERTIES-CLASS"></a><h4>class</h4>
<p>The class of the object. This should always be the precise class, never a superclass, and is always read-only. You do not need to explicitly define <code>class</code> in your dictionary, since it is defined by <code>item</code>, which is the ultimate ancestor of all classes.</p>
<a name="OBJECTS_STANDARD_PROPERTIES-CONTAINER"></a><h4>container</h4>
<p>Objects in a containment hierarchy may define a container property that points to their enclosing object. (This property is purely optional because it is often difficult to implement.) The precise name depends on the possible container classes: if there is exactly one, name the property the same as the class. For example, messages in Mail always belong to a mailbox, and therefore have a <code>mailbox</code> property. If there are several possibilities, use the generic term <code>container</code>. For example, a file in the Finder may belong to either a folder or a disk. Do not use the term <code>parent</code>, since that refers to the object's immediate ancestor in the inheritance hierarchy.</p>
<p>The container property is read-only. Writing to the container property to move objects is not recommended; use the <code>move</code> command instead.</p>
<p>Objects in many-to-<code>x</code> relationships may not have a single meaningful container. Such objects should omit this property, but be sure to support specifiers of the form <code>containers where it contains object</code>.</p>
<a name="OBJECTS_STANDARD_PROPERTIES-CONTENTS"></a><h4>contents</h4>
<p>If an object's contents can be represented as a single value, it should define a <code>contents</code> property. For example, documents in a word processor would define a <code>contents</code> property that returned all the text as a string. <code>contents</code> is usually writable.</p>
<a name="OBJECTS_STANDARD_PROPERTIES-ENTIRE_CONTENTS"></a><h4>entire contents</h4>
<p>Recursive containers – that is, objects that have their own class as elements – should define an <code>entire contents</code> property, which returns a flat list containing every descendant element. <code>entire contents</code> itself is always read-only, but elements of it may be writable.</p>
<a name="OBJECTS_STANDARD_PROPERTIES-ID"></a><h4>id</h4>
<p>A value that uniquely identifies the object. IDs are never localized and are typically not under the user's control and therefore are read-only. They should at least be unique within a container – in most applications, they are unique within the entire application – and must remain valid for at least the lifetime of the application process or the object, whichever ends first.</p>
<p>The type of value may be anything: common choices are an integer, a UUID, or a bundle identifier. The type of value for any particular class should always be the same.</p>
<a name="OBJECTS_STANDARD_PROPERTIES-NAME"></a><h4>name</h4>
<p>An object's <code>name</code> property is its user-visible name, never a system identifier. (Some applications may have a somewhat flexible notion of what the user-visible name is; see <a href="#NONSYMMETRIC">Non-symmetric Specifiers</a> above.) <code>name</code> is usually writable, though in some applications it may be read-only.</p>
<a name="OBJECTS_STANDARD_PROPERTIES-PROPERTIES"></a><h4>properties</h4>
<p>All objects should have a <code>properties</code> property, which returns a record containing all the properties of the object. You do not need to explicitly define <code>properties</code> in your dictionary, since it is defined by <code>item</code>, which is the ultimate ancestor of all classes. If any properties are writable, then <code>properties</code> is as well, and can accept a record containing any number of the properties for that object. For example:</p>
<p>get the properties of paragraph 4 -- Returns font, size, style, and so on. set the properties of paragraph 4 to {font:"Helvetica", size:14} -- Sets just the font and size.</p>
<p>The <code>properties</code> property need not include every property of an object. Typically, properties that can be derived from other properties are not included, such as the <code>reverse</code> property of a list.</p>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="COMMANDS"></a><h2>Commands</h2>
<p>Commands in AppleScript are defined independently of any particular object; a class may then list the commands that it responds to. To Java and Objective-C programmers, commands therefore resemble protocols more than member functions. There is currently no straightforward way to define a command differently (say, with different parameters) for a particular class. The best you can do is either to list all possible parameters and use the comments to say which parameters are meaningful when, or to define separate commands with different names.</p>
<a name="COMMANDS-DESIGNING_YOUR_COMMANDS"></a><h3>Designing Your Commands</h3>
<a name="COMMANDS_DESIGNING_YOUR_COMMANDS-BE_ENGLISH_LIKE_"></a><h4>Be English-like.</h4>
<p>AppleScript commands normally look like imperative English sentences:</p>
<div style="font-family: Courier New, monospace; font-size: 12px; color: black; background: #e6e6e6; white-space: pre; padding: 5px; width: 470px; margin-left: auto; margin-right: auto;">verb [noun] [preposition value]...

<span style="text-decoration: underline">save</span> <span style="text-decoration: underline">the front document</span> <span style="text-decoration: underline"><span style="border-bottom: thin solid black">in</span> file "Goofballs:Razor"</span>
</div>
<p>Try to emulate this style with your own commands. However, bear in mind that this is a guideline, so your English style does not have to be perfect. Also, you are by no means obliged to support all possible English sentences. Synonyms are fine where they make sense, but don't go overboard.</p>
<a name="COMMANDS_DESIGNING_YOUR_COMMANDS-DON_T_INVENT_COMMANDS_IF_YOU_DON_T_HAVE_TO_"></a><h4>Don't invent commands if you don't have to.</h4>
<p>Try to use the standard commands where it makes sense, and only create your own custom commands if there is a clear need. For example, Mail's send action does not fit into the standard commands in any obvious way, so it gets its own command. On the other hand, the Finder does not define a <code>rename</code> command, because it can simply set the value of the object's <code>name</code> property. </p>
<a name="COMMANDS_DESIGNING_YOUR_COMMANDS-SINGULAR_SPECIFIERS_RETURN_VALUES__RANGES_AND__EVERY__RETURN_LISTS_"></a><h4>Singular specifiers return values, ranges and 'every' return lists.</h4>
<p>In general, commands that return a result should return the same shape of result as the direct parameter specifier: singular specifiers return bare values, range and <code>every</code> specifiers return lists. (There are exceptions to this; see <code>count</code> and <code>exists</code>.) A range specifier where one or both endpoints do not exist is an error; an <code>every</code> specifier that specifies no objects is not. This rule also applies to filtered range and <code>every</code> specifiers. For example:</p>
<pre class="sourcecodebox">-- Singular specifiers like index return a value.
get name of person 1
--&gt; "Fillmore"

-- Range and "every" specifiers return a list... 
get name of every person
--&gt; {"Fillmore", "Poppleton"}

-- ...even if there is only one object... 
get name of every person whose name starts with "P" 
--&gt; {"Poppleton"} 

-- ...or even no objects for "every"... 
get name of every person whose name starts with "Q" 
--&gt; {} 

-- ...but both endpoints must exist for a range. 
get name of people 1 through 17 
--&gt; Error: Can't get person 17.</pre>
<p>Commands that break this rule – for example, given a range they sometimes return a value and sometimes a list – are annoying to use, because they require the user to write logic to find out what happened. See <a href="#KEY-FORMS">Key Forms</a> for more details.</p>
<a name="COMMANDS_DESIGNING_YOUR_COMMANDS-EXPLOIT_THE_TARGET_"></a><h4>Exploit the target.</h4>
<p>The subject of the innermost <code>tell</code> block is the target. Use the target to complete parameters that the script omits. In some cases, AppleScript will do this for you: since the target usually corresponds to the direct parameter, AppleScript will automatically pass the target as the direct parameter if the command requires one and the script does not supply it. In some cases, however, the target makes sense as a prepositional parameter. Consider <code>add x to y</code>: it would be reasonable to say <code>tell y to add x</code> instead. Your application can detect the missing <code>to</code> parameter and pick the target out of the subject parameter, an extra parameter that AppleScript passes the target in.</p>
<a name="COMMANDS_DESIGNING_YOUR_COMMANDS-USE_ERROR_RETURN_PARAMETERS__NOT_STATUS_CODES_"></a><h4>Use error return parameters, not status codes.</h4>
<p>The return value of an AppleScript command should always be the value or object result of the command, never a status code or message. If there is no result – that is, the command only performs an action – return nothing.</p>
<p>To signal an error, return a non-zero error code from your event handler, or set the <code>kOSAErrorNumber</code> parameter in the reply. Use standard error codes where appropriate, in particular the AppleEvent error range from -1700 to -1799 (described in Result Codes in <a href="../../documentation/Carbon/Reference/Apple_Event_Manager/index.html">Apple Event Manager Reference</a>). Use of the additional error parameters such as <code>kOSAErrorOffendingObject</code> (see OSA.h for a complete list) is highly recommended – the idea is to return as specific an error as possible. For example, say a script passes a list where your command wanted a number:</p>
<p class="smalltext"><strong>Table 9 : </strong>Error handling.</p>
<table cellspacing="0" class="graybox">
<tr>
<th>BAD </th>
<td scope="row">Return <code>paramErr</code><br><code>→ error: Parameter error.</code>
</td>
</tr>
<tr>
<th>BETTER </th>
<td scope="row">Return <code>errAECoercionFail</code><br><code>→ error: Can't make some data into the expected type.</code>
</td>
</tr>
<tr>
<th>BEST </th>
<td scope="row">Return <code>errAECoercionFail</code>,<br>set <code>kOSAErrorOffendingObject</code> to the given value,<br>set <code>kOSAErrorExpectedType</code> to <code>cNumber</code><br><code>→ error: Couldn't make {1, 2, 3} into a number.</code>
</td>
</tr>
</table>
<p>The user canceling an operation is considered an error; use <code>userCanceledErr</code> (-128) when this happens.</p>
<a name="COMMANDS_DESIGNING_YOUR_COMMANDS-NO_INTERACTION_REQUIRED_"></a><h4>No interaction required.</h4>
<p>Scripting commands should not require any user interaction, since part of the point of scripting is to create completely automated functions. It is acceptable to interact with the user if information was omitted from the command, such as attempting to <code>save</code> a never-before-saved file without specifying a location, but there should always be parameters available so a script can work without any interaction. Commands should never ask for confirmation. For example, the <code>empty trash</code> script command in the Finder does not ask for confirmation, even though the menu command does.</p>
<p>Before attempting to interact with the user in response to a scripting command, call <code>AEInteractWithUser</code>. If it returns an error, do not interact – either do without the user interface, or fail. This lets scripts specify whether or not they want to allow interaction.</p>
<a name="COMMANDS_DESIGNING_YOUR_COMMANDS-CONTROL_THE_NUMBER_OF_PARAMETERS_"></a><h4>Control the number of parameters.</h4>
<p>Sometimes you may find yourself implementing a command that contains lots of options, for which you might be tempted to make separate Boolean parameters. When the number of parameters is small, it looks good to be able to say with a, b, and c. Excessive use of this technique, however, can lead to unwieldy dictionary entries for these events with long lists of parameters.</p>
<p>There are two solutions to this: either make a parameter or parameters that accept a list of enumerators for the option or set of options, or break the command into separate commands with more focused functionality, reducing the number of options for each one.</p>
<p>For example, suppose a statistics package creates a single command to perform any type of analysis with lots of parameters, like this:</p>
<div class="notebox"><p><strong>analyze</strong> data set  -- 25 Boolean options</p></div>
<p>It would be better to split the analysis capability into multiple commands, each with a small group of Boolean parameters, such as</p>
<div class="notebox">
<p><strong>cluster</strong> data set</p>
<p><strong>correlate</strong> data set</p>
<p><strong>fit curve</strong> data set</p>
</div>
<p>and so on. If you find yourself with parameters that can never appear together, it's a sign you may need to break up the command.</p>
<a name="COMMANDS_DESIGNING_YOUR_COMMANDS-EXTRA_INFORMATION_IS_NOT_AN_ERROR_"></a><h4>Extra information is not an error.</h4>
<p>If you receive a command with extra parameters you were not expecting, just ignore them and do not return an error. Similarly, do not bother checking the <code>keyMissedKeywordAttr</code> event attribute – it serves no useful purpose any more, and always returns false in Mac OS X 10.2 and later.</p>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="STANDARD-COMMANDS"></a><h3>Standard Commands</h3>
<p>The Standard Suite defines 15 commands. Applications should use these in preference to creating their own. Not all the commands are meaningful to all applications. Irrelevant ones (for example, <code>open</code> in an application without documents, like System Preferences) should not appear in your dictionary.</p>
<p>In most cases, parameters of type specifier can specify any number of objects. Be sure your commands function correctly with singular, range, and <code>every</code> specifiers, and that they follow the ranges return lists rule described above.</p>
<p><strong>A few words about location parameters</strong></p>
<p>Several commands take parameters of type location specifier. This may be an insertion point specifier or a container object specifier, and may even be a range in most cases.</p>
<p>An insertion point is a location where an object may be inserted: <code>beginning</code>, <code>end</code>, or <code>before</code> or <code>after</code> another specifier. The other specifier may be a range or <code>every</code> specifier, in which case the operation is repeated for all the resulting insertion points.</p>
<pre class="sourcecodebox">add photo "On the beach" to end of album "Vacation"
move paragraph 1 to after paragraph 3
make new word at beginning of every paragraph with data "Note:"</pre>
<p>A container object specifier is a container in which the objects are to be added, moved, made, or whatever. The application chooses a reasonable location within the container. Again, the specifier may be a range or <code>every</code> specifier.</p>
<pre class="sourcecodebox">add photo "On the beach" to album "Vacation"
duplicate message 1 to every mailbox whose name contains "backup"</pre>
<p>Some containers may accept only container specifiers; see <a href="#BUILDING-OSPECS">Object Specifiers</a> for details.</p>
<a name="STANDARD_COMMANDS-ADD"></a><h4>add</h4>
<div class="notebox">
<p><strong>add</strong> specifier [<strong>to</strong> location specifier]</p>
<p>-- Returns a specifier to the object in its new location.</p>
</div>
<p>Adds the specified objects to a (position within a) container, and returns their new locations. If the <code>to</code> parameter is omitted, it is inferred from the target. (For example, in <code>tell album "Waterfowl" to add photo 4</code>, the <code>to</code> location is the target, <code>album "Waterfowl"</code>.) Do not support this command if your application has only one-to-one and one-to-many relationships; see <a href="#UNUSUAL-CONCERNS">Many-to-many relationships</a> for more details. Use of a range or <code>every</code> specifier in the <code>to</code> parameter assumes that an object may be added to any number of containers; this may not be true for all applications.</p>
<a name="STANDARD_COMMANDS-CLOSE"></a><h4>close</h4>
<div class="notebox"><p><strong>close</strong> specifier [<strong>saving</strong> yes | no | ask] </p></div>
<p>Closes the specified objects. Documents and windows should be closeable if they exist; applications may apply <code>close</code> to other objects as well, and may add additional parameters. </p>
<a name="STANDARD_COMMANDS-COUNT"></a><h4>count</h4>
<div class="notebox">
<p><strong>count</strong> specifier</p>
<p>-- Returns the number of specified objects.</p>
</div>
<p>Returns the number of specified objects. This command is an exception to the ranges return lists rule; <code>count</code> with a range or <code>every</code> returns the number of objects specified, which may be zero for <code>every</code> specifiers. Attempting to <code>count</code> non-existent objects is an error. Using <code>count</code> with a singular specifier such as by-name is valid but not very useful, since it will either return 1 or fail if there is no such object. (Scripts should use <code>exists</code> in such cases.) For historical reasons, <code>count</code> used to define an <code>each</code> parameter, but it was not necessary and has been deprecated.</p>
<a name="STANDARD_COMMANDS-DELETE"></a><h4>delete</h4>
<div class="notebox"><p><strong>delete</strong> specifier</p></div>
<p>Removes the specified objects from any containers they may be in and destroys them. <code>delete</code> should always delete the object, no questions asked. If you want to have a trash of some sort (such as the Finder does), define a <code>trash</code> object and let users <code>move</code> objects to it. Depending on the application model, deleting an object may cause its container to be deleted as well – it may not be possible for a container to have no elements.</p>
<a name="STANDARD_COMMANDS-DUPLICATE"></a><h4>duplicate</h4>
<div class="notebox">
<p><strong>duplicate</strong> specifier</p>
<p>   [<strong>to</strong> location specifier]</p>
<p>   [<strong>with properties</strong> record]</p>
<p>-- Returns a specifier for the new object.</p>
</div>
<p>Duplicates the specified objects to the specified locations, optionally changing some of their properties using the <code>with properties</code> parameter, and returns specifiers for the new objects. If the <code>to</code> location is not specified, create the new objects in the same container, suitably altered. (For example, <code>duplicate thing "Bob"</code> might result in a new thing named "Bob copy".) It is not specified what happens if the new object would create a conflict; an application can simply fail, or it can resolve the conflict by tweaking the new object, or it can define additional parameters to specify how to handle conflicts.</p>
<a name="STANDARD_COMMANDS-EXISTS"></a><h4>exists</h4>
<div class="notebox">
<p><strong>exists</strong> specifier</p>
<p>-- Returns true if the object exists, false if not.</p>
</div>
<p>Returns true if all of the specified objects exist, or false if they do not. Unlike most commands, specifying non-existent objects is not an error; it merely means the result is false. Like <code>count</code>, <code>exists</code> is an exception to the ranges return lists rule; range specifiers return true if and only if all the objects in the range exist, <code>every</code> specifiers return true if at least one such object exists.</p>
<a name="STANDARD_COMMANDS-GET"></a><h4>get</h4>
<div class="notebox">
<p><strong>get</strong> specifier [<strong>as</strong> class]</p>
<p>-- Returns the value of the specified object.</p>
</div>
<p>Returns the value of the specified objects. You do not need to define <code>get</code> in your dictionary, since it is built into AppleScript. You may not redefine <code>get</code> with different parameters.</p>
<a name="STANDARD_COMMANDS-MAKE"></a><h4>make</h4>
<div class="notebox">
<p><strong>make</strong> [<strong>new</strong>] class</p>
<p>   [<strong>at</strong> location specifier]</p>
<p>   [<strong>with properties</strong> record]</p>
<p>   [<strong>with data</strong> anything]</p>
<p>-- Returns a specifier to the new object.</p>
</div>
<p>Makes a new object and returns a specifier to it. <code>at</code> should be optional. If it is omitted, pick a reasonable default location – the beginning or end of the current document are common choices. Ideally, the <code>with</code> parameters are optional, but one or the other (but not both) may be required for some classes. Be careful to distinguish between <code>with properties</code> and <code>with data</code>. Use <code>with properties</code> when you are overriding default properties on an application-created object. When the object is effectively defined by data from an outside source – say, a string or a file – use <code>with data</code>, even if one of the created object's properties is (a pointer to) that data.</p>
<a name="STANDARD_COMMANDS-MOVE"></a><h4>move</h4>
<div class="notebox">
<p><strong>move</strong> specifier <strong>to</strong> location specifier</p>
<p>-- Returns a specifier to the object in its new location.</p>
</div>
<p>Moves the specified objects to a new location and returns specifiers for them in their new locations. The <code>to</code> parameter is always required, and may not be a range or <code>every</code> specifier.</p>
<a name="STANDARD_COMMANDS-OPEN"></a><h4>open</h4>
<div class="notebox">
<p><strong>open</strong> file | list of files</p>
<p>-- Returns a specifier to the created application object.</p>
</div>
<p>Opens the specified files, and returns the new application objects for them – probably <code>documents</code>. The standard version is designed for opening document files, but applications may apply <code>open</code> to other objects and add additional parameters.</p>
<a name="STANDARD_COMMANDS-PRINT"></a><h4>print</h4>
<div class="notebox">
<p><strong>print</strong> specifier</p>
<p>   [<strong>with properties</strong> print settings]</p>
<p>   [<strong>print dialog</strong> boolean]</p>
</div>
<p>Prints the specified objects. For most applications, the objects are always documents, but this is not required. Support for the <code>with properties</code> and <code>print dialog</code> parameters was added in Mac OS X 10.3 (Panther); see <a href="../../technotes/tn2002/tn2082.html">TN2082</a> for details.</p>
<a name="STANDARD_COMMANDS-QUIT"></a><h4>quit</h4>
<div class="notebox"><p><strong>quit</strong> [<strong>saving</strong> yes | no | ask]</p></div>
<p>Quits the application. The value of the <code>saving</code> parameter, which defaults to <code>ask</code>, is passed to any resulting <code>close</code> commands. Applications that automatically save everything should not define the <code>saving</code> parameter.</p>
<a name="STANDARD_COMMANDS-REMOVE"></a><h4>remove</h4>
<div class="notebox"><p><strong>remove</strong> specifier [<strong>from</strong> specifier]</p></div>
<p>Removes the specified objects from their container. If the <code>from</code> parameter is omitted, it is inferred from the direct parameter if possible. (For example, in <code>remove first photo of album 1</code>, the <code>from</code> parameter is understood to be <code>album 1</code>. However, in <code>remove photo id 437</code>, it is impossible to tell, and the application should return an error.) Do not support this command if your application has only one-to-one and one-to-many relationships. <code>remove</code> may or may not delete the object, depending on the application model; see <a href="#UNUSUAL-CONCERNS">Many-to-many relationships</a> for details. Depending on the application model, removing an object may cause its container to be deleted – it may not be possible for a container to have no elements.</p>
<a name="STANDARD_COMMANDS-SAVE"></a><h4>save</h4>
<div class="notebox"><p><strong>save</strong> specifier [<strong>in</strong> file]</p></div>
<p>Saves the specified objects, possibly in a specified file. <code>save</code> without <code>in</code> acts like the Save menu command, and may ask the user for a file location; <code>save in</code> with an unsaved file acts like Save As; <code>save in</code> with an already-saved file acts like Save A Copy.</p>
<a name="STANDARD_COMMANDS-SELECT"></a><h4>select</h4>
<div class="notebox"><p><strong>select</strong> specifier</p></div>
<p>Selects the specified objects in the user interface. See <a href="#SELECTION">Scripting the Selection</a> for details on behavior.</p>
<a name="STANDARD_COMMANDS-SET"></a><h4>set</h4>
<div class="notebox">
<p><strong>set</strong> specifier <strong>to</strong> value</p>
<p>-- Returns the value assigned.</p>
</div>
<p>Sets the specified objects to a value and returns the value assigned, that is, the value of the completely evaluated <code>to</code> parameter. This is not necessarily the same thing as the original value of the parameter, in particular if it was an object specifier. In most applications, the direct parameter must be a property specifier, since they do not allow setting of actual objects to values. You do not need to define <code>set</code> in your dictionary, since it is built into AppleScript. You may not redefine <code>set</code> with different parameters.</p>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="VIEW"></a><h2>Scripting the View</h2>
<p>After all this talk about scripting the model, not the view, this section probably comes as a bit of a surprise. Nonetheless, a small amount of view-oriented scriptability is valuable. One of things users do with scripting is to add new commands to their applications, and in order to do that effectively, they need to be able to find out what is visible and what is selected.</p>
<a name="VIEW-SCRIPTING_WINDOWS"></a><h3>Scripting Windows</h3>
<p>As mentioned in Objects, windows should be indexed front to back, so <code>window 1</code> or <code>first window</code> is always the frontmost window, and <code>window -1</code> or <code>last window</code> is always the rearmost. This is implicit in the AppleScript language, because it allows <code>front</code> and <code>back</code> as synonyms for <code>first</code> and <code>last</code>, respectively.</p>
<p>If you have more than one kind of window – say, document windows and palette windows – create different <code>window</code> subclasses to handle them. Given a window specifier, a script should be able to determine what kind of window it is by inspecting the <code>class</code> property.</p>
<p>Windows that display model objects should have appropriately named properties to get the object (or objects) that they display. The most common case of this is document windows, which should have a <code>document</code> property that points to the document for that window. If there is exactly one model object for a window, the property should be the implicit subcontainer for the window. (In sdef terms, define it using a <code>contents</code> element.) That way, a script can ask for model elements of a window without having to explicitly go through the model object property. For example, if <code>documents</code> have <code>words</code>, then <code>get word 1 of window 1</code> should work. Without the implicit subcontainer, a script would have to say <code>word 1 of document of window 1</code>. The reverse relationship is not recommended; for instance, documents do not have windows as implicit subcontainers.</p>
<a name="VIEW_SCRIPTING_WINDOWS-THE_ACTIVATE_COMMAND"></a><h4>The activate command</h4>
<p>To activate a window – that is, to bring it to the front – use the <code>activate</code> command and specify a window. Calling <code>activate</code> with no direct object should bring the entire application forward. <code>activate</code> should also work with objects that are one-to-one mapped with windows, such as documents. The system will automatically handle the activate-whole-application case for you, but applications must handle the other cases themselves.</p>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="SELECTION"></a><h3>Scripting the Selection</h3>
<p>The selection, in scripting terms, refers only to selected model objects. Do not attempt to represent the selection in dialog boxes. Not all applications need to support scripting the selection – for some very simple ones, such as control panel-like applications, it may not be meaningful.</p>
<p>There are two ways to work with the selection: the <code>select</code> command, and <code>selection</code> properties. To find out what is selected, get the value of the <code>selection</code> property. To select something, either <code>select</code> it, or set the appropriate <code>selection</code> property. </p>
<a name="SELECTION-THE_SELECT_COMMAND"></a><h4>The select command</h4>
<p><code>select</code>, given an object specifier, will select that object in the user interface and make it active. This means </p>
<ul>
<li><p>bringing the containing window to the front.</p></li>
<li><p>changing input focus to the appropriate part of the window.</p></li>
<li><p>scrolling the view so that the object is visible.</p></li>
</ul>
<p>Whenever you <code>select</code> something, the appropriate <code>selection</code> properties should change to that same something.</p>
<a name="SELECTION-THE_SELECTION_PROPERTY"></a><h4>The selection property</h4>
<p>The <code>selection</code> property is the current selection for that object. There may be more than one <code>selection</code> property in an application: </p>
<ul>
<li><p>The application class should always have a <code>selection</code> property. Setting it behaves as the <code>select</code> command.</p></li>
<li><p>If you have one window per document and each document maintains its own selection (as, for example, TextEdit), then your document class should have a <code>selection</code> property. Setting it changes the selection for that document, but does not change focus, so a scripter can change the selection of an inactive window without making it active.</p></li>
<li><p>If you can have multiple windows viewing the same model objects (as, for example, Mail can), then windows should have a <code>selection</code> property. Setting it changes the selection for that window, as the previous case. If selection is purely a view concept, then the document class (if any) should not have a <code>selection</code> property.</p></li>
</ul>
<p>Other objects that have their own selection should also have a <code>selection</code> property.</p>
<p>As much as possible, <code>selection</code> properties should always be the same type of value: always a single object, always a list of objects, or whatever is appropriate. In an application that has several different kinds of selectable data, the application's <code>selection</code> property will often change type; this is acceptable. For example, in Mail, the selection could be a list of messages, a list of addresses, or text.</p>
<a name="SELECTION-SELECTING_TEXT"></a><h4>Selecting Text</h4>
<p>In a text-based object model, the value of the selection is a specifier that gives the location of the selected text, not the actual text – for example, <code>characters 1 through 3 of document 1</code>, not <code>"The"</code>. This allows scripts to change both what is selected and the selected text (see below), and allows them to speak of positions relative to the selection. To get the selected text, get the <code>contents of the selection</code>.</p>
<p>If the selection is a range of characters, then you should return a range of some sort, such as <code>characters 1 through 3</code>. (However, see the following paragraph.) If the selection is just an insertion point and contains no characters, then use the <code>insertion point</code> class, as shown in the table below.</p>
<p>Some applications are aware enough of the text object model to report the selection in terms of units larger than characters. For example, if the user selected the third paragraph, the <code>selection</code> property would report <code>paragraph 3</code>, not <code>characters 173 through 254</code>; selecting the second word of that paragraph would yield <code>word 2 of paragraph 3</code>. This behavior is encouraged, but not required.</p>
<p>If you support disjoint text selections, then the <code>selection</code> property should be a single specifier if the selection is not disjoint, but should be a list of specifiers if it is. This breaks the always be the same type of value guideline, but yields less surprising behavior in most cases.</p>
<p class="smalltext"><strong>Table 10 : </strong>Selecting Text.</p>
<table cellspacing="0" class="graybox">
<tr>
<td scope="row">
<span style="border-left: thin dotted black">Now</span> is the time</td>
<td><code>insertion point before character 1</code></td>
</tr>
<tr>
<td scope="row">
<span style="border-right: thin dotted black">Now</span> is the time</td>
<td>
<code>insertion point after character 3</code><br><code>insertion point after word 1</code>
</td>
</tr>
<tr>
<td scope="row">
<span style="background-color: yellow">Now</span> is the time</td>
<td>
<code>characters 1 through 3</code><br><code>word 1</code>
</td>
</tr>
<tr>
<td scope="row">
<span style="background-color: yellow">Now</span> is the <span style="background-color: yellow">time</span>
</td>
<td>
<code>{characters 1 through 3, characters 12 through 15}</code><br><code>{word 1, word 4}</code>
</td>
</tr>
</table>
<p>(In real life, the various specifiers would continue on with something like of document 1. This has been removed for brevity.)</p>
<a name="SELECTION-WRITING_TO_THE_SELECTION"></a><h4>Writing to the selection</h4>
<p>Since writing to the selection property itself merely changes what is selected, you must write to a property or element of the selection to change the actual text. As mentioned above, <code>selection</code> should allow access to sub-elements – in this case, <code>characters</code>, <code>words</code>, and so on. To get at the whole selection, use a <code>contents</code> property. Setting a property or element changes the text, and may change the length of the selection. For example:</p>
<p class="smalltext"><strong>Table 11 : </strong>Writing to the selection.</p>
<table cellspacing="0" class="graybox">
<tr>
<td scope="row"><code>select word 3</code></td>
<td>one two <span style="background-color: yellow">four</span>
</td>
</tr>
<tr>
<td scope="row"><code>set contents of the selection to "thref"</code></td>
<td>one two <span style="background-color: yellow">thref</span>
</td>
</tr>
<tr>
<td scope="row"><code>set last character of the selection to "e"</code></td>
<td>one two <span style="background-color: yellow">three</span>
</td>
</tr>
</table>
<a name="SELECTION-MOVING_THE_SELECTION"></a><h4>Moving the selection</h4>
<p>The text model allows moving the selection relative to itself by use of <code>before</code> and <code>after</code> specifiers using the selection as a base. To select a point, use the <code>insertion point</code> class. Use of <code>beginning</code> and <code>end</code> is also allowed.</p>
<p class="smalltext"><strong>Table 12 : </strong>Moving the selection</p>
<table cellspacing="0" class="graybox">
<tr>
<td scope="row"><code>select word 1</code></td>
<td>
<span style="background-color: yellow">Now</span> is the time</td>
</tr>
<tr>
<td scope="row"><code>select word after the selection</code></td>
<td>Now <span style="background-color: yellow">is</span> the time</td>
</tr>
<tr>
<td scope="row"><code>select insertion point after the selection</code></td>
<td>Now <span style="border-right: thin dotted black">is</span> the time</td>
</tr>
<tr>
<td scope="row"><code>select beginning</code></td>
<td>
<span style="border-left: thin dotted black">Now</span> is the time</td>
</tr>
<tr>
<td scope="row"><code>select end</code></td>
<td>Now is the <span style="border-right: thin dotted black">time</span>
</td>
</tr>
</table>
<p>As stated above, using <code>set the selection to</code> would have had the same effect.</p>
<a name="UNUSUAL-CONCERNS"></a><h4>Unusual Concerns</h4>
<p><strong>Multiple selections in one window</strong></p>
<p>Some applications have multiple views in one window, each with its own selection. For example, viewer windows in Mail can have as many as three selections: the selected mailboxes, the selected messages within that mailbox, and the selected text within a message. Only one of them should have focus, and this determines the value of the <code>selection</code> property for the application and the window as a whole. (If you have trouble determining where the focus is, think of it as if I select Cut or Copy, what data will go onto the clipboard?) In such cases, you should add additional selected <code>thing</code> elements to get at the various sub-selections. For example, Mail would define the element types <code>selected mailbox</code>, <code>selected message</code>, and <code>selected text</code>.</p>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="GENERAL_TIPS"></a><h2>General Tips</h2>
<a name="GENERAL_TIPS-BE_CAREFUL_WHEN_REUSING_CODES_"></a><h3>Be careful when reusing codes.</h3>
<p>If you use the same term in more than one place in your dictionary, all of them must use the same 4-byte code. For example, if you use <code>input</code> as a parameter, again as a property, and later as an enumerator, use the same type code in all three places. Conversely, if you use the same type code in more than one place, all of them must use the same term. This also applies to terms and codes inherited from system- or framework-supplied dictionaries. For example, if you define a <code>color</code> property for a class, its code must be <code>'colr'</code>, because that is how it is defined in the AppleScript dictionary and Cocoa's NSCoreSuite script suite. Failure to follow this rule will cause your scripts to fail or change in odd ways when they are compiled or decompiled – AppleScript will change the original term to be the last one defined.</p>
<p><code>aete</code> dictionaries actually exploit breaking this rule in order to define synonymous terms or codes. sdef provides direct support for synonyms with its synonym elements; see the sdef documentation for details.</p>
<a name="GENERAL_TIPS-DON_T_LOCALIZE_YOUR_TERMS"></a><h3>Don't localize your terms</h3>
<p>For one thing, basic AppleScript syntax is oriented towards English; having identifiers in another language would be odd. For another, it probably would not work: AppleScript identifiers cannot contain non-ASCII characters, which severely restricts what you can say in most languages.</p>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="TIPS_FOR_USING_COCOA_SCRIPTING"></a><h2>Tips for Using Cocoa Scripting</h2>
<p>Cocoa is Apple's application framework: it is strongly object-oriented, and makes it easy to add scriptability. For documentation, see <a href="../../documentation/Cocoa/Conceptual/Scriptability/index.html">Scriptable Applications</a>. However, Cocoa's default scripting support does not follow the scripting interface guidelines in all cases. Fortunately, there are workarounds:</p>
<a name="TIPS_FOR_USING_COCOA_SCRIPTING-FOR_EVERYONE"></a><h3>For Everyone</h3>
<a name="TIPS_FOR_USING_COCOA_SCRIPTING_FOR_EVERYONE-ADD_AN__AETE__TO_YOUR_APPLICATION_"></a><h4>Add an 'aete' to your application.</h4>
<p>Cocoa applications currently define their scriptability by providing a set of script suites. Each script suite is a pair of plist files, a suite definition (.scriptSuite) and a suite terminology (.scriptTerminology). Cocoa can generate an <code>aete</code> format dictionary from these if you let it, but the result tends to be sub-standard, because script suites cannot express certain concepts. (Also, your application will have to be launched to get the dictionary, which tends to annoy scripters.)</p>
<p>Therefore, you should build a parallel <code>aete</code> dictionary as part of your application. The easiest way to do this is to write your dictionary using an sdef, and then generate all three files (.scriptSuite, .scriptTerminology, and aete.r) from it using <code>sdp</code>(1).</p>
<a name="TIPS_FOR_USING_COCOA_SCRIPTING_FOR_EVERYONE-DO_NOT_REQUIRE_THE__AT__PARAMETER_FOR__MAKE__"></a><h4>Do not require the 'at' parameter for 'make'.</h4>
<p>Because of an early design mistake, Cocoa requires the <code>at</code> parameter for <code>make</code> by default. You should always override this using the <code>LocationRequiredToCreate</code> attribute – see the <a href="../../documentation/ReleaseNotes/Cocoa/CocoaScripting.html">Cocoa Scripting release notes</a> for more details. If you write your dictionary using an sdef, <code>sdp</code>(1) will add the correct attribute for you.</p>
<a name="TIPS_FOR_USING_COCOA_SCRIPTING-FOR_THE_AMBITIOUS"></a><h3>For The Ambitious</h3>
<a name="TIPS_FOR_USING_COCOA_SCRIPTING_FOR_THE_AMBITIOUS-MAKE_SPECIFIC_DEFINITIONS_INSTEAD_OF_USING_THE_GENERIC_ONES_"></a><h4>Make specific definitions instead of using the generic ones.</h4>
<p>Cocoa Scripting suite definitions have trouble being completely accurate. Definitions you inherit from the frameworks – in particular, the Standard and Text Suites – are almost completely generic. Commands that your application does not support are still visible, direct parameters are defined as merely type reference, and <code>application</code> has <code>document</code> elements whether it needs them or not. You can work around this by creating an <code>aete</code> dictionary for your application (see above), but it is more work. If you use an sdef to generate your <code>aete</code>, you will have to modify the sdef version of the Standard Suite (<code>/Developer/Examples/Scripting Definitions/NSCoreSuite.sdef</code>), since it currently will have the same problem.</p>
<a name="TIPS_FOR_USING_COCOA_SCRIPTING_FOR_THE_AMBITIOUS-PROVIDE_GOOD_ERROR_MESSAGES_"></a><h4>Provide good error messages.</h4>
<p>Cocoa Scripting's default error messages are written in generic programmerese (such as NSReceiverEvaluationScriptError: 4) rather than specific English (such as Can't get window 17). As of Mac OS X 10.3 (Panther), you can set your own error numbers and messages by calling <code>[NSScriptCommand currentCommand]</code> and then calling <code>-setScriptErrorNumber:</code> and <code>-setScriptErrorString:</code> on the returned object. See the <a href="../../documentation/Cocoa/Reference/Foundation/Classes/NSScriptCommand_Class/index.html">NSScriptCommand documentation</a> for further details.</p>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="REFERENCES"></a><h2>References</h2>
<ul>
<li><p><a href="http://www.apple.com/applescript/developers/">AppleScript developer page</a></p></li>
<li><p><a href="../../documentation/AppleScript/Conceptual/AppleScriptX/index.html">AppleScript on Mac OS X</a></p></li>
<li><p><a href="../../documentation/AppleScript/index.html">AppleScript documentation</a></p></li>
<li><p><a href="../../documentation/Cocoa/Conceptual/Scriptability/index.html">Scriptable Applications</a></p></li>
</ul>
<p style="margin-top:-10px"><a href="#top">Back to Top </a><a href="#top"><img src="images/arrow_linkup.gif" height="7" width="10" border="0" alt=""></a></p>
<a name="document_revision_summary"></a><h2>Document Revision History</h2>
<table cellspacing="0" class="graybox" width="680">
<tr>
<th width="100">Date</th>
<th width="580">Notes</th>
</tr>
<tr>
<td scope="row">2004-03-01</td>
<td>Directions for providing a clean and consistent scripting interface for your application.</td>
</tr>
</table>
<p><b>Posted: </b>2004-03-01</p>
<!-- END CONTENTS -->
</td></tr></table>
<!-- END WIDE COLUMN --><!-- END MAIN CONTENT --><!-- START BOTTOM APPLE NAVIGATION -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tn2002/tn2106.html%3Fid%3DDTS10003199-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tn2002/tn2106.html%3Fid%3DDTS10003199-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tn2002/tn2106.html%3Fid%3DDTS10003199-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer" --><!-- END BOTTOM APPLE NAVIGATION --><!-- START CENTER CLOSE -->
</center>
<!-- END CENTER CLOSE -->
</body>
</html>
