<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>MatchAlias (IM: F)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING361></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Files-360.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-362.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Files-2.html"><B>Files</B></A> / <BR><DD><A HREF="Files-340.html"><B>Chapter 4 - Alias Manager</B></A> / <A HREF="Files-350.html"><B>Alias Manager Reference</B></A><BR><DL><DD><A HREF="Files-353.html"><B>Alias Manager Routines</B></A> / <A HREF="Files-359.html"><B>Resolving and Reading Alias Records</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING361-0></A>
<H3><A NAME=MARKER-9-106></A>MatchAlias</H3>
 You use the <CODE>MatchAlias</CODE> function to identify a list of possible matches and pass the list through an optional selection filter. The filter can return more than one possible match.<A NAME=MARKER-2-54></A><P>
<PRE>
FUNCTION MatchAlias (fromFile: FSSpecPtr; rulesMask: LongInt;
                     alias: AliasHandle; VAR aliasCount: Integer;
                     aliasList: FSSpecArrayPtr; 
                     VAR needsUpdate: Boolean; 
                     aliasFilter: AliasFilterProcPtr;
                     yourDataPtr: UNIV Ptr): OSErr;
</PRE>
<DL>
<DT><CODE>fromFile</CODE>
<DD> The starting point for a relative search. If you do not want <CODE>MatchAlias</CODE> to perform a relative search, set <CODE>fromFile</CODE> to <CODE>NIL</CODE>. If you want <CODE>MatchAlias</CODE> to perform a relative search, pass a pointer to a file system specification record that describes the starting point for the search.
<DT><CODE>rulesMask</CODE>
<DD> A set of rules to guide the resolution. Pass the sum of all of the rules you want to invoke.
<DT><CODE>alias</CODE>
<DD> A handle to the alias record to be resolved.
<DT><CODE>aliasCount</CODE>
<DD> On input, the maximum number of possible matches to return. On output, the actual number of matches returned.
<DT><CODE>aliasList</CODE>
<DD> A pointer to the array that holds the results of the search.
<DT><CODE>needsUpdate</CODE>
<DD> A Boolean flag that indicates whether the alias record to be resolved needs to be updated.
<DT><CODE>aliasFilter</CODE>
<DD> <BR>An application-defined filter function.
<DT><CODE>yourDataPtr</CODE>
<DD> A pointer to data to be passed to the filter function.
</DL>
<A NAME=HEADING361-11></A>
<H5>DESCRIPTION</H5>
 The <CODE>MatchAlias</CODE> function resolves the alias record specified by the <CODE>alias</CODE> parameter, following the rules specified by the <CODE>rulesMask</CODE> parameter. Then it returns, in the structure specified by the <CODE>aliasList</CODE> parameter, a list of possible candidates. The <CODE>MatchAlias</CODE> function places, in the <CODE>aliasCount</CODE> parameter, the number of <BR>candidates identified.<P>
 You specify the matching criteria by passing a sum of these constants in the <BR><CODE>rulesMask</CODE> parameter.<P>
<PRE>
CONST
   kARMMountVol         =  $00000001;{mount volume automatically}
   kARMNoUI             =  $00000002;{suppress user interface}
   kARMMultVols         =  $00000008;{search on multiple volumes}
   kARMSearch           =  $00000100;{do a fast search}
   kARMSearchMore       =  $00000200;{do an exhaustive search}
   kARMSearchRelFirst   =  $00000400;{do a relative search first}
</PRE>
<B>Constant descriptions</B><P>
<DL>
<DT><CODE>kARMMountVol</CODE>
<DD> Automatically try to mount the target's volume if it is not <BR>mounted.<A NAME=MARKER-2-8></A>
<DT><CODE><A NAME=MARKER-2-110></A>kARMNoUI</CODE>
<DD> Stop if a search requires user interaction, such as a password dialog box when mounting a remote volume. If user interaction is needed and <CODE>kARMNoUI</CODE> is in effect, the search fails.<A NAME=MARKER-2-1></A>
<DT><CODE><A NAME=MARKER-2-112></A>kARMMultVols</CODE>
<DD> Search all mounted volumes. The search begins with the volume on which the target resided when the record was created. When you specify a fast search of all mounted volumes, <CODE>MatchAlias</CODE> performs a formal fast search only on the volume described in the alias record. On all other volumes it looks for the target by ID or by name in the directory with the specified parent directory ID. When you specify an exhaustive search of multiple volumes, <CODE>MatchAlias</CODE> performs the same search on all volumes. When resolving an alias record created by <CODE>NewAliasMinimalFromFullPath</CODE>, <CODE>MatchAlias</CODE> ignores this flag.<A NAME=MARKER-2-112></A>
<DT><CODE>kARMSearch</CODE>
<DD> Perform a fast search for the alias target. If <CODE>kARMSearchRelFirst</CODE> is not set, perform an absolute search first, followed by a relative search only if the value of the <CODE>fromFile</CODE> parameter is not <CODE>NIL</CODE> and the list of matches is not full.<A NAME=MARKER-2-113></A>
<DT><CODE><A NAME=MARKER-2-115></A>kARMSearchMore</CODE>
<DD> Perform an exhaustive search for the alias target. On HFS volumes, the exhaustive search uses the File Manager function <CODE>PBCatSearch</CODE> to identify candidates with matching creation date, type, and creator. The <CODE>PBCatSearch</CODE> function is available only on HFS volumes and only on systems running version 7.0 or later. On MFS volumes or HFS volumes that do not support <CODE>PBCatSearch</CODE>, the exhaustive search makes a series of indexed calls to File Manager functions, using the same search criteria. If you set <CODE>kARMSearchMore</CODE> and either or both of <CODE>kARMSearch</CODE> and <CODE>kARMSearchRelFirst</CODE>, <CODE>MatchAlias</CODE> performs the fast search first.<A NAME=MARKER-2-115></A>
<DT><CODE><A NAME=MARKER-2-117></A>kARMSearchRelFirst</CODE>
<DD> <BR>If <CODE>kARMSearch</CODE> is also set, perform a relative search before the absolute search. (If <CODE>kARMSearch</CODE> is also set and the target is found through the absolute search, <CODE>MatchAlias</CODE> sets the <CODE>needsUpdate</CODE> flag to <CODE>TRUE</CODE>.) If neither <CODE>kARMSearch</CODE> nor <CODE>kARMSearchMore</CODE> is set, perform only a relative search. If <CODE>kARMSearch</CODE> is not set but <CODE>kARMSearchMore</CODE> is set, perform a relative search followed by an exhaustive search.<A NAME=MARKER-2-21></A>
</DL>
 You must specify at least one of the last three parameters: <CODE>kARMSearch</CODE>, <CODE>kARMSearchMore</CODE>, and <CODE>kARMSearchRelFirst</CODE>.<P>
 Your application can specify a maximum number of possible matches by setting the <CODE>aliasCount</CODE> parameter. <CODE>MatchAlias</CODE> changes the <CODE>aliasCount</CODE> parameter to the <BR>actual number of candidates identified. If <CODE>MatchAlias</CODE> finds the parent directory on the correct volume but does not find the target, it sets the <CODE>aliasCount</CODE> parameter to 1, puts the file system specification record for the target in the results list, and returns <CODE>fnfErr</CODE>. The <CODE>FSSpec</CODE> record is valid, although the object it describes does not exist. This information is intended as a "hint" that lets you explore possible solutions to the resolution failure. You can, for example, use the <CODE>FSSpec</CODE> record and the File Manager function <CODE>FSpCreate</CODE> to create a replacement for a missing file.<P>
 The <CODE>needsUpdate</CODE> flag is a signal to your application that the record might need to be updated. After it identifies a target, <CODE>MatchAlias</CODE> compares some key information about the target with the same information in the record. If the information does not match, <CODE>MatchAlias</CODE> sets the <CODE>needsUpdate</CODE> flag to <CODE>TRUE</CODE>. The key information is<P>
<UL>
<LI>the name of the target
<LI>the directory ID of the target's parent
<LI>the file ID or directory ID of the target
<LI>the name and creation date of the volume on which the target resides<P>
</UL>
 The <CODE>MatchAlias</CODE> function also sets the <CODE>needsUpdate</CODE> flag to <CODE>TRUE</CODE> if it identifies a list of possible matches rather than a single match or if <CODE>kARMsearchRelFirst</CODE> is set but the target is identified through either an absolute search or an exhaustive search. Otherwise, the <CODE>MatchAlias</CODE> function sets the <CODE>needsUpdate</CODE> flag to <CODE>FALSE</CODE>. <CODE>MatchAlias</CODE> always sets the <CODE>needsUpdate</CODE> flag to <CODE>FALSE</CODE> when resolving an alias created by <CODE>NewAliasMinimal</CODE>. If you want to update the alias record to reflect the final <BR>results of the resolution, call <CODE>UpdateAlias</CODE>.<P>
 The <CODE>aliasFilter</CODE> parameter points to a filter function supplied by your application. The Alias Manager executes this function each time it identifies a possible match and after the search has continued for three seconds without a match. Your filter function returns a Boolean value that determines whether the possible match is discarded (<CODE>TRUE</CODE>) or added to the list of possible targets (<CODE>FALSE</CODE>). It can also terminate the search by setting the variable parameter <CODE>quitFlag</CODE>. See <A HREF=Files-364.html#MARKER-9-130>"Filtering Possible Targets" on page 4-25</A> for a description of the filter function.<P>
 The <CODE>yourDataPtr</CODE> parameter can point to any data that your application might need in the filter function.<P>
<A NAME=HEADING361-32></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The trap macro and routine selector for <CODE>MatchAlias</CODE> are
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Trap macro<TH>Selector<TR>
<TD>_AliasDispatch<TD>$0005</TABLE>
<P>
<A NAME=HEADING361-34></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>nsvErr<TD>-35<TD>The volume is not mounted<TR>
<TD>fnfErr<TD>-43<TD>Target not found, but volume and parent directory found<TR>
<TD>paramErr<TD>-50<TD>The value of the <CODE>target</CODE> or <CODE>alias</CODE> parameter, or both, is <CODE>NIL</CODE>, or the alias record is corrupt<TR>
<TD>usrCanceledErr<TD>-128<TD>The user canceled the operation<A NAME=MARKER-2-2></A></TABLE>
</H5>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Files-360.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-362.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Files-3.html">&copy; Apple Computer, Inc.</A><br>2 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
