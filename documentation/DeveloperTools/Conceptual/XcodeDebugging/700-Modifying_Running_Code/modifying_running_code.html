<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Xcode Debugging Guide: Modifying Running Code</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Modifying Running Code"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40007057-CH10" title="Modifying Running Code"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000436" target="_top">Tools</a> &gt; <a href="../../../Xcode-date.html#//apple_ref/doc/uid/TP30000440-TP30000436-TP30000557" target="_top">Xcode</a> &gt; <a href="../000-Introduction/Introduction.html#//apple_ref/doc/uid/TP40007057-CH1-SW1">Xcode Debugging Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../600-Viewing_Variables_and_Memory/variables_and_memory.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../800-Debugging_Programs_Remotely/remote_debugging.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40007057-CH10-SW7" title="Modifying Running Code"></a><h1>Modifying Running Code</h1><a name="//apple_ref/doc/uid/TP40007057-CH10-DontLinkElementID_57"></a><a name="//apple_ref/doc/uid/TP40007057-CH10-DontLinkElementID_58"></a><a name="//apple_ref/doc/uid/TP40007057-CH10-DontLinkElementID_59"></a><p>A very powerful feature of Xcode is the ability to modify your executable while it is running and see the results of your modification. This feature is implemented through the Fix command.</p><p>This feature is useful when it takes a significant amount of time to reach the place in your application’s execution cycle that you want to debug. You can use the feature to learn more about potential bug fixes or to see the immediate results of code changes.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="modifying_running_code.html#//apple_ref/doc/uid/TP40007057-CH10-SW1">Fix Command Overview</a>
				
			<br/>
			
        
			
			
				<a href="modifying_running_code.html#//apple_ref/doc/uid/TP40007057-CH10-SW5">Using Fix and Continue</a>
				
			<br/>
			
        
			
			
				<a href="modifying_running_code.html#//apple_ref/doc/uid/TP40007057-CH10-SW30">Fix Command Restrictions</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40007057-CH10-SW1" title="Fix Command Overview"></a><h2>Fix Command Overview</h2><a name="//apple_ref/doc/uid/TP40007057-CH10-DontLinkElementID_60"></a><p>The Fix command in Xcode is a way to modify an application at debug time and see the results of your modification without restarting your debugging session. This feature can be particularly useful if it takes a lot of time to reach your application’s current state of execution in the debugger. Rather than recompile your project and restart your debugging session, you can make minor changes to your code, patch your executable, and see the immediate results of your changes.</p><p>The Fix command is not intended as a replacement for building your product regularly. Instead, it is a convenience feature for viewing the effect of small changes without restarting your debugging session.</p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40007057-CH10-DontLinkElementID_6" title="Important:"></a><p><strong>Important:</strong>&nbsp;Use of the Fix command is subject to certain requirements and restrictions, which are listed in <span class="content_text"><a href="modifying_running_code.html#//apple_ref/doc/uid/TP40007057-CH10-SW30">“Fix Command Restrictions.”</a></span></p><p></p></div><a name="//apple_ref/doc/uid/TP40007057-CH10-SW2" title="Supported Fixes"></a><h3>Supported Fixes</h3><p>Although there are many restrictions to what you can fix, there are also some features that are explicitly supported by the Fix command, including the following:</p><ul class="spaceabove"><li class="li"><p>Storing pointers to a patched function. GDB inserts code to jump from the old function to the newly patched function. Thus, despite your code having a pointer to the original function, using that pointer executes the patched version.</p></li><li class="li"><p>You can add file-local static variables to a file, but remember that GDB does not execute any initialization code associated with them. Thus, if you declare a new class instance as a global static, GDB does not execute any constructors or static initializers for the instance. there are also limitations on how those variables behave after multiple patches.</p></li><li class="li"><p>You can add new C++ classes as part of a patch.</p></li></ul><p>To learn about restrictions on the Fix command, see <span class="content_text"><a href="modifying_running_code.html#//apple_ref/doc/uid/TP40007057-CH10-SW30">“Fix Command Restrictions.”</a></span></p><a name="//apple_ref/doc/uid/TP40007057-CH10-SW3" title="GDB and the Fix Command"></a><h3>GDB and the Fix Command</h3><p>The process of fixing source files while debugging is tricky. GDB must manipulate your executable while it is running, and insert new code without disturbing the state of your program execution. The actual process involves compiling your code with special flags and rewriting portions of your binary to call the new code when appropriate. At all times, the Fix command modifies the in-memory image of your executable. It does not permanently modify the files of your original application binary.</p><p>When it receives a patched binary, GDB compares that binary against the code in the application’s original binary. GDB checks for several modifications that cannot be patched into a running application. If it detects any of these modifications, it reports back to Xcode that it could not incorporate the patch. If this occurs, you can stop debugging and rebuild your application, or continue debugging without the patch.</p><p>If GDB does not report any problems with your patch, it integrates the patched code into your application’s memory image. It does this by making the following modifications:</p><ul class="spaceabove"><li class="li"><p>Modifies functions in your original binary to jump to any patched versions</p></li><li class="li"><p>Modifies any static or global variables in the patched file to point back to the versions in the original binary</p></li></ul><a name="//apple_ref/doc/uid/TP40007057-CH10-SW4" title="Debugging with Patched Code"></a><h3>Debugging with Patched Code</h3><p>After patching your application, you should be able to continue debugging your code as before. The next time you encounter a patched function, you should see the changes you made appear in the debugger. However, there are some caveats to be aware of when working with patched code. </p><p>If you patch a function that is on the stack, you may not see the results of that patch immediately. GDB is capable of patching the function that is currently at the top of the stack. However, if you patch a function that is further down the calling chain, the patch does not take effect until the next time you call it. Thus, the function must return and be called again before it receives the patch. Until that time, the function on the stack continues to execute the original code. </p><p>While your program is paused in the debugger, you can move the program counter around and resume execution from any point in the current function. This feature lets you rerun a patched function from the beginning, or from any point, to account for the changes you made. </p><p>If you quit your debugging session for any reason, you must rebuild your program to acquire any changes made by patching. The effects of the Fix command are only applicable to your executable while it is active in the debugger. The reason is that the command does not modify your program’s compiled object files. Instead, it creates temporary object files and loads them into the memory space of your process dynamically. When you quit the debugger, GDB discards the temporary object files containing the patches. Recompiling your project recreates your application’s original object files from the patched code.</p><a name="//apple_ref/doc/uid/TP40007057-CH10-SW5" title="Using Fix and Continue"></a><h2>Using Fix and Continue</h2><p>If you are running your executable in the debugger and you make changes to your source code, you can patch your executable by choosing Run > Fix.</p><p>If you change more than one source file, you must fix each file separately. Xcode compiles the changes, patches the executable to use the new code, and resumes execution from the location at which the program was paused. If the changes to your code appear before the line at which execution is set to resume, you will not see the effect of your change until that code is called again. To see the effect of your change, you can manually alter the location at which execution resumes: When your program is paused, drag the PC indicator—the red arrow pointing to the line of code where execution is paused—to the location at which you want to resume execution.</p><p>Xcode automatically locates the correct target to use when creating the fix bundle. For example, if you are debugging an application suite that relies on a framework you created, you can make a change in the framework code. When you execute the Fix command, Xcode automatically uses the correct framework target, instead of the target associated with the running executable, to create the fix. Xcode will also follow cross-project references to targets in other projects.</p><a name="//apple_ref/doc/uid/TP40007057-CH10-SW30" title="Fix Command Restrictions"></a><h2>Fix Command Restrictions</h2><p>The Fix command in Xcode is a powerful way to make small changes to a source file without restarting your debugging session. Although powerful, there are some things you need to do before you can take advantage of the Fix command. The command itself is enabled only when you are debugging an executable. In addition, you must make sure you build your program as follows:</p><ul class="ul"><li class="li"><p>Build using native targets</p></li><li class="li"><p>Compile your code with GCC version 3.3 or later</p></li><li class="li"><p>Build your code without optimizations</p></li><li class="li"><p>Build your code with debugging symbols enabled</p></li></ul><p>In general, if you build using the Debug build configurations provided by Xcode, the correct settings are used. However, if you try to patch your executable and get a file-not-found error, check the build settings of your target and make sure that debugging symbols are turned on, as described in <span class="content_text"><a href="../../XcodeProjectManagement/070-Building_Products/building.html#//apple_ref/doc/uid/TP40002693-BABICFFG" target="_top">“Building for Debugging”</a></span> in <em><a href="../../XcodeProjectManagement/index.html#//apple_ref/doc/uid/TP40006917" target="_top">Xcode Project Management Guide</a></em>. You can also check the build log to make sure that the patch bundle was created.</p><p>The Fix command works on only one file at a time. If you make changes to multiple source files, you must patch each file separately before continuing with your debugging session.</p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40007057-CH10-DontLinkElementID_7" title="Important:"></a><p><strong>Important:</strong>&nbsp;If you attempt to patch multiple files, pause your application until you finish integrating all of the patches.</p><p></p></div><a name="//apple_ref/doc/uid/TP40007057-CH10-SW6" title="Fix Command Restrictions Reported by GDB"></a><h3>Fix Command Restrictions Reported by GDB</h3><p>There are many types of code changes that cannot be patched. The GDB debugger reports an error if it cannot integrate any of your changes because of a known restriction. If GDB reports one of these errors, you must rebuild your program and restart your debugging session, or continue debugging the program without the changes.</p><p>GDB recognizes the following changes to your code and reports an error if you try to include them as part of a fix:</p><ul class="spaceabove"><li class="li"><p>Changes to the number or type of arguments in a function or method that is currently on the stack</p></li><li class="li"><p>Changes to the return type or name of a function or method that is currently on the stack</p></li><li class="li"><p>Changes to the number or type of local variables in a function or method that is currently on the stack</p></li><li class="li"><p>Changes to the type of global or file-static variables</p></li><li class="li"><p>Symbol type redefinitions, that is, changing a function to a variable or a variable to a function</p></li></ul><a name="//apple_ref/doc/uid/TP40007057-CH10-SW31" title="Additional Fix Command Restrictions"></a><h3>Additional Fix Command Restrictions</h3><p>In addition to the restrictions reported by GDB, there are additional restrictions that GDB currently does not check. If you attempt to include any of these changes in a patch, your application may crash or exhibit other undefined behavior when it encounters the code. The solution is to avoid using the Fix command for the change. Instead, rebuild your program and restart your debugging session.</p><p>The following is a list of changes that cannot be included as part of a fix: </p><ul class="spaceabove"><li class="li"><p>Changes to a nib file.</p></li><li class="li"><p>Changes to the definition of a structure or union.</p></li><li class="li"><p>The addition of an Objective-C class.</p></li><li class="li"><p>The addition or removal of class instance variables.</p></li><li class="li"><p>The addition or removal of class methods.</p></li><li class="li"><p>The addition or removal of methods to an Objective-C category. These methods are not registered with the Objective-C runtime and thus cannot be called. (You can fix existing methods in a category.)</p></li><li class="li"><p>Any reference to an unresolved external variable or function. Link errors of this nature cannot be resolved by the dynamic linker.</p></li><li class="li"><p>The addition of a static variable across multiple patches in one session. GDB maintains a copy of the static in each patch; however, because there is no original variable to refer to, each variable remains separate from the others, which can lead to unpredictable results.</p></li><li class="li"><p>The addition of a function to one file when it is called from a different patched file. New functions are private to the patch file in which they appear.</p></li><li class="li"><p>The addition of a <code>try</code> block or the addition of a <code>catch</code> handler to an existing <code>try</code> block.</p></li><li class="li"><p>The addition of a C++ template class specialization.</p></li><li class="li"><p>Changes to functions that require two-level namespaces during linking to prevent known symbol conflicts across different libraries. GDB supports patching two-level namespace binaries but currently does so using flat namespace conventions.</p></li></ul><div class="importantbox"><a name="//apple_ref/doc/uid/TP40007057-CH10-DontLinkElementID_8" title="Important:"></a><p><strong>Important:</strong>&nbsp;Be aware that other conditions may also cause patched code to fail or exhibit other undefined behavior. If you encounter such a problem, you should rebuild your program and start a new debugging session.</p><p></p></div>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../600-Viewing_Variables_and_Memory/variables_and_memory.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../800-Debugging_Programs_Remotely/remote_debugging.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2009 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2009-01-06<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/DeveloperTools/Conceptual/XcodeDebugging/700-Modifying_Running_Code/modifying_running_code.html%3Fid%3DTP40007057-1.3&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/DeveloperTools/Conceptual/XcodeDebugging/700-Modifying_Running_Code/modifying_running_code.html%3Fid%3DTP40007057-1.3&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/DeveloperTools/Conceptual/XcodeDebugging/700-Modifying_Running_Code/modifying_running_code.html%3Fid%3DTP40007057-1.3&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>