<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!--Template 06-20-02--><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Q&amp;A FL14: Finding your application's directory</title>	<meta name="keywords" content="Process Manager,directory,volume reference,GetProcessInformation,GetProcessInformation">	<meta name="Description" content="Technical Q&amp;A FL14: Find the directory ID and volume referencenumber for the folder containing application."><meta name="categories" content="Files"><meta name="week-posted" content="Jun 19, 2000 - Jun 23, 2000"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10001200" title="Finding your application's directory"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalqas/index.html">Technical Q&As</a> &gt; <a href="../../technicalqas/Carbon/index.html">Carbon</a> &gt; <a href="../../technicalqas/Carbon/idxFileManagement-date.html">File Management</a> &gt; </p><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Q&amp;A FL14</div>
<div id="pageheadsub">Finding your application's directory</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><!-- begin_content --> <CENTER><TABLE BORDER=0 CELLPADDING=0 WIDTH=600><TR> <td align="left"><hr width=500 align=center><p id=p2>Q: How can I find out the directory&nbsp;ID and volume reference number for thefolder containing my application?</p><p id=p4>A: You can ask the Process Manager for this information by calling the<CODE>GetProcessInformation</CODE> routine from inside of your application.  Thedirectory&nbsp;ID and volume reference number can be extracted from the<CODE>FSSpec</CODE> record filled out by the <CODE>GetProcessInformation</CODE> call.The <CODE>GetApplicationDirectory</CODE> routine shown in Listing&nbsp;1illustrates how you would do this.</p><TABLE BORDER=0 CELLPADDING=3 WIDTH="550"> <TR> <td bgcolor="#e6e6e6" align=left><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    #include &lt;Types.h&gt;    #include &lt;Files.h&gt;    #include &lt;Processes.h&gt;        /* GetApplicationDirectory returns the volume reference number        and directory ID for the current application's directory. */    OSStatus GetApplicationDirectory(short *vRefNum, long *dirID) {        <a href="http://developer.apple.com/documentation/mac/Processes/Processes-34.html">ProcessSerialNumber</a> PSN;        <a href="http://developer.apple.com/documentation/mac/Processes/Processes-35.html">ProcessInfoRec</a> pinfo;        <a href="http://developer.apple.com/documentation/mac/Files/Files-115.html">FSSpec</a> pspec;        OSStatus err;            /* valid parameters */        if (vRefNum == NULL || dirID == NULL) return paramErr;            /* set up process serial number */        PSN.highLongOfPSN = 0;        PSN.lowLongOfPSN = <a href="http://developer.apple.com/documentation/mac/Processes/Processes-24.html">kCurrentProcess</a>;            /* set up info block */        pinfo.processInfoLength = sizeof(pinfo);        pinfo.processName = NULL;        pinfo.processAppSpec = &amp;pspec;            /* grab the vrefnum and directory */        err = <a href="http://developer.apple.com/documentation/mac/Processes/Processes-42.html">GetProcessInformation</a>(&amp;PSN, &amp;pinfo);        if (err == noErr) {            *vRefNum = pspec.vRefNum;            *dirID = pspec.parID;        }        return err;    }</pre>	</TD></TR></TABLE></CENTER></TD> </TR> </TABLE><BR><B>Listing 1</B>.  Extracting an application's location in the file systemfrom results returned by <CODE>GetProcessInformation</CODE>.<BR><p id=p2>Q: Okay, now that I know how to find the directory containing the application, howcan I make sure this is the default directory? <br> <br></p><p id=p4>A: Here, all you need to do is pass the volume reference number anddirectory&nbsp;ID extracted from the results returned from<CODE>GetProcessInformation</CODE> to the <CODE>PBHSetVol</CODE> routine.  Anexample of how to do this is shown in Listing&nbsp;2.</p><TABLE BORDER=0 CELLPADDING=3 WIDTH="550"> <TR> <td bgcolor="#e6e6e6" align=left>                  <CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    #include &lt;Types.h&gt;    #include &lt;Files.h&gt;    #include &lt;Processes.h&gt;        /* SetApplicationDirAsDefault sets the default directory        to the directory containing the current application. */    OSStatus SetApplicationDirAsDefault(void) {        <a href="http://developer.apple.com/documentation/carbon/Files/FileManager/File_Manager/DataTypes/WDPBRec.html">WDPBRec</a> wpb;        OSStatus err;        err = GetApplicationDirectory(&amp;wpb.ioVRefNum, &amp;wpb.ioWDDirID);        if (err == noErr) {            wpb.ioNamePtr = NULL;            err = <a href="http://developer.apple.com/documentation/mac/Files/Files-185.html">PBHSetVolSync</a>(&amp;wpb);        }        return err;    }</pre>	</TD></TR></TABLE></CENTER></TD> </TR> </TABLE> <BR><B>Listing 2</B>.  Setting the default directory to the directory containingthe application.<BR><p id=p2>Q: Great!  But what versions of the system software allow me to do this?</p> <p id=p4>A: The techniques shown in Listing&nbsp;1 and Listing&nbsp;2 can be used in anyversion of the system software from System&nbsp;7 through Carbon.</p></td></tr></table></center><!-- end_content --><!-- begin_date --><H4 ALIGN=center>[Jun 19 2000]</H4><!-- end_date --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/qa/fl/fl14.html%3Fid%3DDTS10001200-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/qa/fl/fl14.html%3Fid%3DDTS10001200-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/qa/fl/fl14.html%3Fid%3DDTS10001200-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --> <hr width=500 align=center> </BODY> </HTML>