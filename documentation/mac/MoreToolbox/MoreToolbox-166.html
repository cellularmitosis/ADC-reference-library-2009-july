<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE> HMShowBalloon (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING166></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-165.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-167.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-138.html"><B>Chapter 3 - Help Manager</B></A> / <A HREF="MoreToolbox-157.html"><B>Help Manager Reference</B></A><BR><DL><DD><A HREF="MoreToolbox-161.html"><B>Help Manager Routines </B></A> / <A HREF="MoreToolbox-165.html"><B>Displaying and Removing Help Balloons</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING166-0></A>
<H3> <A NAME=MARKER-9-450></A>HMShowBalloon</H3>
 <A NAME=MARKER-9-451></A><A NAME=MARKER-21-452></A><A NAME=MARKER-2-453></A>To display a help balloon of the content area of any window of your application, you can use the <CODE>HMShowBalloon</CODE> function. If the user has enabled Balloon Help assistance, the <CODE>HMShowBalloon</CODE> function displays a help balloon containing the message specified by the <CODE>aHelpMsg</CODE> parameter.<P>
<PRE>
FUNCTION HMShowBalloon (aHelpMsg: HMMessageRecord; 
                        tip: Point; alternateRect: RectPtr;
                        tipProc: Ptr; theProc, variant: Integer; 
                        method: Integer): OSErr;
</PRE>
<DL>
<DT><CODE>aHelpMsg</CODE>
<DD> The message displayed in the help balloon.
<DT><CODE>tip</CODE>
<DD> The location, in global coordinates, of the help balloon's tip.
<DT><CODE>alternateRect</CODE>
<DD> A rectangle, in global coordinates, that the Help Manager uses if necessary to calculate a new tip location. If you specify a rectangle in this parameter, the Help Manager automatically calls the <CODE>HMRemoveBalloon</CODE> function to remove the help balloon when the user moves the cursor outside the area bounded by the rectangle. If you instead pass <CODE>NIL</CODE> in this parameter, your application must use the <CODE>HMRemoveBalloon</CODE> function to remove the help balloon when appropriate.
<DT><CODE>tipProc</CODE>
<DD> The tip function called by the Help Manager before displaying the balloon. Specify <CODE>NIL</CODE> to use the Help Manager's default tip function, or supply your own tip function and point to it in this parameter.
<DT><CODE>theProc</CODE>
<DD> The balloon definition function. To use the standard balloon <BR>definition function, specify 0 in this parameter. To use your own <BR>balloon definition function, specify the resource ID of the <CODE>'WDEF'</CODE> resource containing your balloon definition function.
<DT><CODE>variant</CODE>
<DD> The variation code for the balloon definition function. Specify 0 in the <CODE>variant</CODE> parameter to use the default help balloon position, specify a code from 1 to 7 to use one of the other positions provided by the standard balloon definition function, or specify another code to use one of the positions provided by your own balloon definition function. 
<DT><CODE>method</CODE>
<DD> A value that indicates whether the Help Manager should save the bits behind the balloon and whether to generate an update event. <BR>You can pass one of the following constants in this parameter: <CODE>kHMRegularWindow</CODE>, <CODE>kHMSaveBitsNoWindow</CODE>,<BR>or <CODE>kHMSaveBitsWindow</CODE>.
</DL>
<A NAME=HEADING166-10></A>
<H5>DESCRIPTION</H5>
 If help is enabled, the <CODE>HMShowBalloon</CODE> function displays a help balloon with the help message you specify in the <CODE>aHelpMsg</CODE> parameter. You use global coordinates to specify the tip and the rectangle pointed to by the <CODE>alternateRect</CODE> parameter. The Help Manager calculates the location and size of the help balloon. If it fits onscreen, the <BR>Help Manager displays the help balloon using the specified tip location.<P>
 If you use the <CODE>HMShowBalloon</CODE> function to display help balloons, you must identify hot rectangles, create your own data structures to store their locations, track the cursor yourself, and call <CODE>HMShowBalloon</CODE> when the cursor moves to your hot rectangles. The Help Manager does not know the locations of your hot rectangles, so it cannot use them for moving the tip if the help balloon is placed offscreen. Instead, the Help Manager uses the alternate rectangle that you point to with the <CODE>alternateRect</CODE> parameter. Often, you specify the same coordinates for the alternate rectangle that you specify for your hot rectangle. However, you may choose to make your alternate rectangle smaller or larger than your hot rectangle. If you make your alternate rectangle smaller than your hot rectangle, you have greater assurance that the Help Manager will be able to fit the help balloon onscreen; if you specify an alternate rectangle that is larger than your hot rectangle, you have greater assurance that the balloon will not obscure the object it explains. <P>
 If you specify a rectangle in the <CODE>alternateRect</CODE> parameter, the Help Manager automatically calls <CODE>HMRemoveBalloon</CODE> to remove the balloon when the cursor leaves the area bounded by the rectangle.<P>
 If the balloon's first position is partly offscreen or if it intersects the menu bar, the Help Manager tries a combination of different balloon variation codes and different tip positions along the sides of the alternate rectangle to make the balloon fit. <A HREF=MoreToolbox-140.html#MARKER-9-50>Figure 3-5 on page 3-9</A> shows what happens when the balloon's first two positions are located offscreen. If, after exhausting all possible positions, the Help Manager cannot fit the entire balloon onscreen, the Help Manager displays a balloon at the position that best fits onscreen and clips the help message to fit at this position. If the coordinates specified by both the original tip and the <CODE>alternateRect</CODE> parameter are offscreen, the Help Manager does not display the balloon at all.<P>
 If you specify <CODE>NIL</CODE> for the <CODE>alternateRect</CODE> parameter, your application is responsible for tracking the cursor and determining when to remove the balloon. The Help Manager also does not attempt to calculate a new tip location if the balloon is offscreen.<P>
 Once the Help Manager determines the location and size of the help balloon, the Help Manager calls the function pointed to by the <CODE>tipProc</CODE> parameter before displaying the balloon. Specify <CODE>NIL</CODE> in the <CODE>tipProc</CODE> parameter to use the Help Manager's default tip function.<P>
 You can supply your own tip function and point to it in the <CODE>tipProc</CODE> parameter. The Help Manager calls the tip function after calculating the location of the balloon and before displaying it. In the parameters of your tip function, the Help Manager returns the tip, the region boundary of the entire balloon, the region boundary for the content area within the balloon frame, and the variation code to be used for the balloon. This allows you to examine and possibly adjust the balloon before it is displayed.<P>
 The Help Manager reads the balloon definition function specified by the parameter <CODE>theProc</CODE> into memory if it isn't already in memory. If the balloon definition function can't be read into memory, the help balloon is not displayed and the <CODE>HMShowBalloon</CODE> function returns the <CODE>resNotFound</CODE> result code.<P>
 The <CODE>method</CODE> parameter specifies whether the Help Manager should save the bits behind the balloon and whether to generate an update event. You can supply one of these constants for the parameter.<P>
<PRE>
CONST kHMRegularWindow     = 0;  {don't save bits; just update}
      kHMSaveBitsNoWindow  = 1;  {save bits; don't do update}
      kHMSaveBitsWindow    = 2;  {save bits; do update event}
</PRE>
 If you specify <CODE>kHMRegularWindow</CODE>, the Help Manager draws and removes the help balloon as if it were a window. That is, when drawing the balloon, the Help Manager does not save bits behind the balloon, and, when removing the balloon, the Help Manager generates an update event. This is the standard behavior of help balloons; it is the behavior you should normally use.<A NAME=MARKER-2-454></A><P>
 If you specify <CODE>kHMSaveBitsNoWindow</CODE> in the <CODE>method</CODE> parameter, the Help Manager does not create a window for displaying the balloon. Instead, the Help Manager creates a help balloon that is more like a menu than a window. The Help Manager saves the bits behind the balloon when it creates the balloon. When it removes the balloon, the Help Manager restores the bits without generating an update event. You should use this method only in a modal environment where the bits behind the balloon cannot change from the time the balloon is drawn to the time it is removed. For example, you might specify the <CODE>kHMSaveBitsNoWindow</CODE> constant when providing help balloons for pop-up menus that overlay complex graphics, which might take a long time to redraw with an update event.<A NAME=MARKER-2-455></A><P>
 If you specify <CODE>kHMSaveBitsWindow</CODE>, the Help Manager treats the help balloon as a hybrid having properties of both a menu and a window. That is, the Help Manager saves the bits behind the balloon when it creates the balloon, and, when it removes the balloon, it both restores the bits and generates an update event. You'll rarely need this option. It is necessary only in a modal environment that might immediately change to a nonmodal environment--that is, where the bits behind the balloon are static when the balloon is drawn, but can possibly change before the balloon is removed.<A NAME=MARKER-2-456></A><P>
 <CODE>HMShowBalloon</CODE> returns the <CODE>noErr</CODE> result code if the help balloon was successfully displayed.<P>
<A NAME=HEADING166-25></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The trap macro and the routine selector for the <CODE>HMShowBalloon</CODE> function are
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Trap macro<TH>Selector<TR>
<TD>_Pack14<TD>$0B01</TABLE>
<P>
<A NAME=HEADING166-27></A>
<H5><A NAME=MARKER-11-282></A>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error; the help balloon was displayed<TR>
<TD>paramErr<TD>-50<TD>Error in parameter list<TR>
<TD>memFullErr<TD>-108<TD>Not enough room in heap zone<TR>
<TD>resNotFound<TD>-192<TD>Unable to read resource<TR>
<TD>hmHelpDisabled<TD>-850<TD>Help balloons are not enabled<TR>
<TD>hmBalloonAborted<TD>-853<TD>Because of constant cursor movement, the help balloon wasn't displayed<TR>
<TD>hmOperationUnsupported<TD>-861<TD>Invalid value passed in the <CODE>method</CODE> parameter</TABLE>
</H5>
<A NAME=HEADING166-28></A>
<H5>SEE ALSO</H5>
 You specify the help message in the <CODE>aHelpMsg</CODE> parameter. <A HREF=MoreToolbox-152.html#MARKER-9-323>"Providing Help Balloons for Dynamic Windows" beginning on page 3-69</A> shows how to specify this information.<P>
 You can supply your own tip function (as explained in the description of the <CODE>MyTip</CODE> function, which begins on <A HREF=MoreToolbox-193.html#MARKER-9-515>page 3-122</A>) and point to it in the <CODE>tipProc</CODE> parameter.<P>
 <A HREF=MoreToolbox-140.html#MARKER-9-48>Figure 3-4 on page 3-9</A> illustrates the variation codes you can specify in the <CODE>variant</CODE> parameter and their corresponding help balloon positions for the standard balloon definition function. <P>
 If your application uses its own menu definition procedure, you can use the <CODE>HMShowMenuBalloon</CODE> function to display help balloons for the menus that your menu definition procedure manages. The <CODE>HMShowMenuBalloon</CODE> function is next.<A NAME=MARKER-2-458></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-165.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-167.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
