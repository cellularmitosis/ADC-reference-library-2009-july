<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Certificate, Key, and Trust Services Reference: AppleX509TP Trust Policies</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="AppleX509TP Trust Policies"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30000157-CH204" title="AppleX509TP Trust Policies"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> &gt; <a href="../../../../../reference/Security/index.html#//apple_ref/doc/uid/TP30001281-TP30000434" target="_top">Security</a> &gt; <a href="../../../../../reference/Security/idxAuthentication-date.html#//apple_ref/doc/uid/TP30001281-TP30000434-TP30000487" target="_top">Authentication</a> &gt; <a href="../index.html" target="_top">Certificate, Key, and Trust Services Reference</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../DeprecationAppendix/AppendixADeprecatedAPI.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../certKeyTrustRef_revHist/revision_history.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP30000157-CH204-CIHIJIII" title="AppleX509TP Trust Policies"></a><h1>AppleX509TP Trust Policies</h1><p>The trust policies implemented by the AppleX509TP CDSA module are shown in <span class="content_text">Table B-1</span>. A pointer to a policy-specific option structure is placed in <code>CSSM_FIELD.FieldValue.Data</code>; this field is one of the fields in <code>CSSM_TP_CALLERAUTH_CONTEXT.Policy.PolicyIds</code> array.</p>
<a name="//apple_ref/doc/uid/TP30000157-CH204-86845" title="Table B-1AppleX509TP trust policies "></a><a name="//apple_ref/doc/uid/TP30000157-CH204-CIHFAIDA" title="Table B-1AppleX509TP trust policies "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">
<caption class="tablecaption"><strong>Table B-1&nbsp;&nbsp;</strong>AppleX509TP trust policies </caption>

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Policy</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>OID</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Options</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p>Apple Basic</p></td>
<td ><p><code>CSSMOID_APPLE_X509_BASIC</code></p></td>
<td ><p>None</p></td>
<td ><p>Basic X509-style certificate evaluation</p></td>
</tr>
<tr>
<td  scope="row"><p>SSL</p></td>
<td ><p><code>CSSMOID_APPLE_TP_SSL</code></p></td>
<td ><p><code>CSSM_APPLE_TP_SSL_OPTIONS</code></p></td>
<td ><p>Basic X509 plus host name verification per RFC 2818</p></td>
</tr>
<tr>
<td  scope="row"><p>SMIME</p></td>
<td ><p><code>CSSMOID_APPLE_TP_SMIME</code></p></td>
<td ><p><code>CSSM_APPLE_TP_SMIME_OPTIONS</code></p></td>
<td ><p>Basic X509 plus email address verification and KeyUsage enforcement per RFC 2632</p></td>
</tr>
<tr>
<td  scope="row"><p>Extensible Authentication Protocol (EAP)</p></td>
<td ><p><code>CSSMOID_APPLE_TP_EAP</code></p></td>
<td ><p><code>CSSM_APPLE_TP_SSL_OPTIONS</code></p></td>
<td ><p>Functionally identical to SSL policy. A separate OID is provided to facilitate per-policy, per-certificate trust settings using the SecTrust mechanism</p></td>
</tr>
<tr>
<td  scope="row"><p>CRL Revocation</p></td>
<td ><p><code>CSSMOID_APPLE_TP_REVOCATION_CRL</code></p></td>
<td ><p><code>CSSM_APPLE_TP_CRL_OPTIONS</code> (see option flags below)</p></td>
<td ><p>Revocation using certificate revocation lists</p></td>
</tr>

</table></div>

<a name="//apple_ref/doc/uid/TP30000157-CH204-87516" title="CRL Policy Options"></a><h2>CRL Policy Options</h2>
<p>Certificate revocation list policy options are defined in the following structure:</p>
<div class="codesample"><table><tr><td scope="row"><pre>typedef uint32 CSSM_APPLE_TP_CRL_OPT_FLAGS;<span></span></pre></td></tr><tr><td scope="row"><pre>enum {<span></span></pre></td></tr><tr><td scope="row"><pre>    // require CRL verification for each cert; default is "try"<span></span></pre></td></tr><tr><td scope="row"><pre>    CSSM_TP_ACTION_REQUIRE_CRL_PER_CERT = 0x00000001,<span></span></pre></td></tr><tr><td scope="row"><pre>    // enable fetch from network<span></span></pre></td></tr><tr><td scope="row"><pre>    CSSM_TP_ACTION_FETCH_CRL_FROM_NET  = 0x00000002<span></span></pre></td></tr><tr><td scope="row"><pre>};<span></span></pre></td></tr><tr><td scope="row"><pre>typedef struct {<span></span></pre></td></tr><tr><td scope="row"><pre>    // CSSM_APPLE_TP_CRL_OPTS_VERSION<span></span></pre></td></tr><tr><td scope="row"><pre>    uint32                              Version<span></span></pre></td></tr><tr><td scope="row"><pre>    CSSM_APPLE_TP_CRL_OPT_FLAGS         CrlFlags;<span></span></pre></td></tr><tr><td scope="row"><pre>    /*<span></span></pre></td></tr><tr><td scope="row"><pre>    * When non-NULL, store CRLs fetched from net here.<span></span></pre></td></tr><tr><td scope="row"><pre>    * This is most likely a pointer to one of the<span></span></pre></td></tr><tr><td scope="row"><pre>    * CSSM_TP_CALLERAUTH_CONTEXT.DBList entries but that<span></span></pre></td></tr><tr><td scope="row"><pre>    * is not a strict requirement.<span></span></pre></td></tr><tr><td scope="row"><pre>    */<span></span></pre></td></tr><tr><td scope="row"><pre>    CSSM_DL_DB_HANDLE_PTR               crlStore;<span></span></pre></td></tr><tr><td scope="row"><pre>} CSSM_APPLE_TP_CRL_OPTIONS;<span></span></pre></td></tr></table></div>
<p>When the <code>CSSM_TP_ACTION_REQUIRE_CRL_PER_CERT</code> flag is set, a certificate is not valid unless every certificate in the certificate chain has been successfully verified using a certificate revocation list. This check is in addition to any other certificate-specific or policy-specific checks required for validation. When this flag is not set, CRLs are evaluated if they are available, but it is not an error if the trust policy module cannot find a CRL. In either case, the certificate is not considered valid if a CRL is found that indicates that any certificate in the certificate chain has been revoked. </p>
<a name="//apple_ref/doc/uid/TP30000157-CH204-87663" title="Evaluating Multiple Policies"></a><h2>Evaluating Multiple Policies</h2>
<p>If multiple policies are specified, they are evaluated sequentially. In this case, the <code>VerificationAbortOn</code> field of the <code>CSSM_TP_CALLERAUTH_CONTEXT</code> structure specifies when to abort the verification process (see the “Trust Policy Services API” chapter in <em>Common Security: CDSA and CSSM, version 2 (with corrigenda)</em> from The Open Group (<span class="content_text"><a href="http://www.opengroup.org/security/cdsa.htm" target="_blank">http://www.opengroup.org/security/cdsa.htm</a></span>)). The AppleX509TP CDSA module supports the following values for the <code>VerificationAbortOn</code> field:</p>
<ul class="ul"><li class="li"><p><code>CSSM_TP_STOP_ON_NONE</code>; continue to subsequent policies if one policy evaluation fails</p></li>
<li class="li"><p><code>CSSM_TP_STOP_ON_FIRST_FAIL</code>; stop immediately if a policy evaluation fails</p></li>
<li class="li"><p><code>CSSM_TP_STOP_ON_POLICY</code>; treated as the same as <code>CSSM_TP_STOP_ON_FIRST_FAIL</code></p></li></ul>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../DeprecationAppendix/AppendixADeprecatedAPI.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../certKeyTrustRef_revHist/revision_history.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2003, 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-11-19<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Security/Reference/certifkeytrustservices/certKeyTrustPolicies/certKeyTrustPolicies.html%3Fid%3DTP30000157-4.1&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Security/Reference/certifkeytrustservices/certKeyTrustPolicies/certKeyTrustPolicies.html%3Fid%3DTP30000157-4.1&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Security/Reference/certifkeytrustservices/certKeyTrustPolicies/certKeyTrustPolicies.html%3Fid%3DTP30000157-4.1&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>