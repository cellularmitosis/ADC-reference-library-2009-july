<html><head><title>Mac OS X Developer Tools
 Manual Page For auditon(2)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/2/auditon" title="Mac OS X Developer Tools
 Manual Page for auditon(2)"><!-- headerDoc=man; indexgroup=Section 2; uid="//apple_ref/doc/man/2/auditon"; name=auditon(2) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac&nbsp;OS&nbsp;X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>

<p style='text-align:justify;'>This manual page is associated with the Mac&nbsp;OS&nbsp;X
developer tools.  The software or headers described may not be present on your
Mac&nbsp;OS&nbsp;X installation until you install the developer tools
package.  This package is available on your Mac&nbsp;OS&nbsp;X installation DVD,
and the latest versions can be downloaded from
<a href="http://developer.apple.com/tools/download/">developer.apple.com</a>.</p>

<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
AUDITON(2)                  BSD System Calls Manual                 AUDITON(2)

<b>NAME</b>
     <b>auditon</b> -- configure the current audit parameters on the system

<b>SYNOPSIS</b>
     <b>#include</b> <b>&lt;bsm/audit.h&gt;</b>

     <u>int</u>
     <b>auditon</b>(<u>int</u> <u>cmd</u>, <u>void</u> <u>*</u> <u>data</u>, <u>int</u> <u>length</u>);

<b>DESCRIPTION</b>
     The <b>auditon</b>() function manipulates various audit parameters. The <u>data</u> argument points to the appropri-<font color="#ffffff" class="whiteout">ate&nbsp;appropriate</font>
     ate structure from the header file.  <u>Length</u> is the size of the <u>data</u> parameter in bytes. It will typi-<font color="#ffffff" class="whiteout">cally&nbsp;typically</font>
     cally be the sizeof the the structure.

<b>PARAMETERS</b>
     A_GETPOLICY        Get the current audit policy.  <u>Data</u> should point to a long. The policy is the bit-<font color="#ffffff" class="whiteout">wise&nbsp;bitwise</font>
                        wise OR'ing of the appropriate flags from <u>bsm/audit.h</u>.  If AUDIT_AHLT is set, the
                        system will kernel panic if it cannot write to the global audit trail.  If AUDIT_CNT
                        is not set and the system becomes low on space, audited events will block until the
                        low space condition is remedied.  Unaudited events are unaffected. The other policy
                        flags are not implemented.

     A_SETPOLICY        Set the current audit policy.  <u>Data</u> should point to a long specifying the desired
                        audit policy, as described in A_GETPOLICY.

     A_GETKMASK         Get the current value of the audit preselection mask for non-attributable events.
                        <u>Data</u> should point to an <u>au</u><b>_</b><u>mask</u><b>_</b><u>t</u>.  The field <u>am</u><b>_</b><u>success</u> specifies which classes of
                        successful audit events are to be logged to the audit trail. The field <u>am</u><b>_</b><u>failure</u>
                        specifies which classes of failed audit events are to be logged. The value of both
                        fields is the bitwise OR'ing of the event classes specified in <u>bsm/audit.h</u>.  The
                        various audit classes are described more fully in <!-- a -->audit_class(5)<!-- /a -->.

     A_SETKMASK         Set the current value of the audit preselection mask for non-attributable events.
                        <u>Data</u> should point to an <u>au</u><b>_</b><u>mask</u><b>_</b><u>t</u>.  The masks are defined as described in A_GETK-<font color="#ffffff" class="whiteout">MASK.&nbsp;A_GETKMASK.</font>
                        MASK.

     A_GETQCTRL         Get the current settings for the audit queue (specifying in kernel buffer size, per-<font color="#ffffff" class="whiteout">centage&nbsp;percentage</font>
                        centage of free filesystem blocks, and limits to the number of audit records
                        allowed).  <u>Data</u> should point to an <u>au</u><b>_</b><u>qctrl</u><b>_</b><u>t</u>.

     A_SETQCTRL         Set the current settings for the audit queue.  <u>Data</u> should point to an <u>au</u><b>_</b><u>qctrl</u><b>_</b><u>t</u>.

     A_GETCOND          Gets the current condition of the auditing subsystem. If the value is AUC_AUDITING,
                        then the audit implementation is currently running. If the value is AUC_NOAUDIT then
                        the audit implementation is currently turned off.  <u>Data</u> should point to a long.

     A_SETCOND          Sets the condition of the auditing subsystem. If AUC_NOAUDIT is set, then auditing
                        is temporarily suspended. If AUC_AUDITING is set, auditing is resumed.  If AUC_DIS-<font color="#ffffff" class="whiteout">ABLED&nbsp;AUC_DISABLED</font>
                        ABLED is set, the auditing system will shutdown, draining all audit records and
                        closing out the audit trail file.  To re-enable auditing, a call to <u>auditctl</u> is
                        required in addition to setting the condition to AUC_AUDITING.  <u>Data</u> should point to
                        a long.

     A_GETCLASS         Returns the audit class for the specified audit event.  <u>Data</u> should point to a
                        <u>au</u><b>_</b><u>evclassmap</u><b>_</b><u>t</u>.

     A_SETCLASS         Sets the audit class for the specified audit event.  <u>Data</u> should point to a
                        <u>au</u><b>_</b><u>evclassmap</u><b>_</b><u>t</u>.

     A_GETPINFO         Returns the audit information stored in the credential for the current process.
                        <u>Data</u> should point to a <u>auditpinfo</u><b>_</b><u>t</u>.

     A_SETPMASK         Sets the audit settings for a process. The audit user ID, preselection masks for
                        both success and failure, and terminal IDs must be set.  <u>Data</u> should point to a
                        <u>auditpinfo</u><b>_</b><u>t</u> struct.

     A_SETFSIZE         Set the limit on audit trail file size. File size is in bytes. The file size speci-<font color="#ffffff" class="whiteout">fied&nbsp;specified</font>
                        fied is treated as an advisory limit. The system will make a best effort attempt to
                        rotate log files before they exceed the requested maximum size, but makes no guaran-<font color="#ffffff" class="whiteout">tees&nbsp;guarantees</font>
                        tees on log file size <u>Data</u> should point to a <u>au</u><b>_</b><u>fstat</u><b>_</b><u>t</u> struct. The <u>af</u><b>_</b><u>filesz</u> field
                        is used to specify the new file size, which must be greater than
                        MIN_AUDIT_FILE_SIZE. A value of 0 indicates no limit on the audit trail's size. The
                        <u>af</u><b>_</b><u>currsz</u> field is ignored. A errno value of EINVAL indicates a maximum file size
                        that is too small.

     A_GETFSIZE         Return the maximum allowable size of the audit trail, and the current size of the
                        audit trail.  <u>Data</u> should point to a <u>au</u><b>_</b><u>fstat</u><b>_</b><u>t</u> struct.

     A_GETPINFO_ADDR    Not implemented, returns ENOSYS.

     A_GETKAUDIT        Not implemented, returns ENOSYS.

     A_SETKAUDIT        Not implemented, returns ENOSYS.

<b>RETURN</b> <b>VALUES</b>
     Upon successful completion a value of 0 is returned.  Otherwise, a value of -1 is returned and <u>errno</u> is
     set to indicate the error.

<b>ERRORS</b>
     Errors are specific to the operation requested. In addition, rhe <b>auditon</b>() system call will fail if:

     [EINVAL]           <u>Length</u> is less than or equal to zero, or if it is greater than any of the expected
                        structures.

<b>SEE</b> <b>ALSO</b>
     <a href="audit.2.html#//apple_ref/doc/man/2/audit">audit(2)</a>, <a href="auditctl.2.html#//apple_ref/doc/man/2/auditctl">auditctl(2)</a>, <a href="getauid.2.html#//apple_ref/doc/man/2/getauid">getauid(2)</a>, <a href="setauid.2.html#//apple_ref/doc/man/2/setauid">setauid(2)</a>, <a href="getaudit.2.html#//apple_ref/doc/man/2/getaudit">getaudit(2)</a>, <a href="setaudit.2.html#//apple_ref/doc/man/2/setaudit">setaudit(2)</a>, <!-- a -->getaudit_addr(2)<!-- /a -->,
     <!-- a -->setaudit_addr(2)<!-- /a -->, <!-- a -->audit_class(5)<!-- /a -->

<b>HISTORY</b>
     The <b>auditon</b>() function call first appeared in Mac OS X 10.3 (Panther).

Darwin                           July 30, 2007                          Darwin
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man2/auditon.2.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man2/auditon.2.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man2/auditon.2.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
