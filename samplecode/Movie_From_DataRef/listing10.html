<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>

	<!-- BEGIN META TAG INFO -->
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<link rel="home" href="http://developer.apple.com/">
	<link rel="find" href="http://developer.apple.com/search/">
	<link rel="stylesheet" type="text/css" href="../../documentation/css/adcstyle.css" title="fonts">
	<script language="JavaScript" src="../../documentation/js/adc.js" type="text/javascript"></script>
	<!-- END META TAG INFO -->
	
	<!-- BEGIN TITLE -->
	<title>Movie From DataRef - /Common Files/ComFramework.h</title>
	<!-- END TITLE -->
<script language="JavaScript">
function JumpToNewPage() {
	window.location=document.scpopupmenu.gotop.value;
	return true;
}
</script>

</head>

<!-- BEGIN BODY OPEN -->
<body>
<!--END BODY OPEN -->

<!-- START CENTER OPEN -->
<center>
<!-- END CENTER OPEN -->

	<!-- BEGIN LOGO AND SEARCH -->
	<!--#include virtual="/includes/adcnavbar"-->
	<!-- END LOGO AND SEARCH -->
		
		
	<!-- START BREADCRUMB -->
	<div id="breadcrumb">
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td scope="row"><img width="340" height="10" src="images/1dot.gif" alt=""></td>
			<td><img width="340" height="10" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr valign="middle">
			<td align="left" colspan="2">
			<a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../samplecode/index.html">Sample Code</a> &gt; <a href="../../samplecode/QuickTime/index.html">QuickTime</a> &gt; <a href="../../samplecode/QuickTime/idxMovieBasics-date.html">Movie Basics</a> &gt; <A HREF="javascript:location.replace('index.html');">Movie From DataRef</A> &gt; 
			</td>
		</tr>
		<tr>
			<td colspan="2" scope="row"><img width="680" height="35" src="images/1dot.gif" alt=""></td>
		</tr>
	</table>
	</div>
	<!-- END BREADCRUMB -->

	

	<!-- START MAIN CONTENT -->
	
	<!-- START TITLE GRAPHIC AND INTRO-->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td><h1><div id="pagehead">Movie From DataRef</div></h1></td>
		</tr>
	</table>
	<!-- END TITLE GRAPHIC AND INTRO -->
	<!-- START WIDE COLUMN -->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td id="scdetails">
				<h2>/Common Files/ComFramework.h</h2>
				<form name="scpopupmenu" onSubmit="return false;" method=post>
				<p><strong>View Source Code:</strong> 
					<select name="gotop" onChange="JumpToNewPage();" style="width:340px"><option selected value="ingnore">Select File</option>
<option value="listing1.html">/Application Files/ComApplication.c</option>
<option value="listing2.html">/Application Files/ComApplication.h</option>
<option value="listing3.html">/Application Files/ComResource.h</option>
<option value="listing4.html">/Application Files/MacApplication.r</option>
<option value="listing5.html">/Clippings/CreateMovie.c/AsyncMovieLoading.txt</option>
<option value="listing6.html">/Clippings/CreateMovie.c/CreateDataRef.txt</option>
<option value="listing7.html">/Clippings/CreateMovie.c/CreateDataRefVars.txt</option>
<option value="listing8.html">/Clippings/CreateMovie.c/CreateMovieFromDataRef.txt</option>
<option value="listing9.html">/Common Files/ComFramework.c</option>
<option value="listing10.html">/Common Files/ComFramework.h</option>
<option value="listing11.html">/Common Files/MacFramework.c</option>
<option value="listing12.html">/Common Files/MacFramework.h</option>
<option value="listing13.html">/Common Files/MacPrefix.h</option>
<option value="listing14.html">/Common Files/plist:carb.r</option>
<option value="listing15.html">/Common Files/QTUtilities.c</option>
<option value="listing16.html">/Common Files/QTUtilities.h</option>
<option value="listing17.html">/Common Files/WinFramework.c</option>
<option value="listing18.html">/Common Files/WinFramework.h</option>
<option value="listing19.html">/Common Files/WinPrefix.h</option>
<option value="listing20.html">/Completed Lab/CreateMovie.c</option>
<option value="listing21.html">/Completed Lab/CreateMovie.h</option>
<option value="listing22.html">/Start Code/CreateMovie.c</option>
<option value="listing23.html">/Start Code/CreateMovie.h</option></select>
				</p>
				</form>
				<p><strong><a href="Movie_From_DataRef.zip">Download Sample</a></strong> (&#147;Movie_From_DataRef.zip&#148;, 593.0K)<BR>
<strong><a href="Movie_From_DataRef.dmg">Download Sample</a></strong> (&#147;Movie_From_DataRef.dmg&#148;, 964.3K)</p>
				<!--
				<p><strong><a href="#">Download Sample</a></strong> (&#147;filename.sit&#148;, 500K)</p>
				-->
			</td>
		</tr>
		<tr>
			<td scope="row"><img width="680" height="10" src="images/1dot.gif" alt=""><br>
			<img height="1" width="680" src="images/1dot_919699.gif" alt=""><br>
			<img width="680" height="20" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr>
			<td scope="row">
	<!--googleon: index -->
<pre class="sourcecodebox">//////////////  File:    ComFramework.h////  Contains:  Code for the QuickTime sample code framework that is common to both Macintosh and Windows. ////  Written by:  Tim Monroe//        Based on the QTShell code written by Tim Monroe, which in turn was based on the MovieShell//        code written by Kent Sandvik (Apple DTS). This current version is now very far removed from//        MovieShell.////  Copyright:  &copy; 1999 by Apple Computer, Inc., all rights reserved.////  Change History (most recent first)://     //     &lt;2&gt;     01/14/00  rtm    added fGraphicsImporter field to window object record//     &lt;1&gt;     11/05/99  rtm    first file////////////#pragma once////////////     // header files//     //////////#ifndef __Prefix_File__#include &lt;WinPrefix.h&gt;#endif#ifndef __CONTROLDEFINITIONS__#include &lt;ControlDefinitions.h&gt;#endif#ifndef __MENUS__#include &lt;Menus.h&gt;#endif#ifndef __MOVIES__#include &lt;Movies.h&gt;#endif#ifndef __NAVIGATION__#include &lt;Navigation.h&gt;#endif#ifndef __QUICKTIMEVR__#include &lt;QuickTimeVR.h&gt;#endif#ifndef __RESOURCES__#include &lt;Resources.h&gt;#endif#ifndef __SOUND__#include &lt;Sound.h&gt;#endif#ifndef _STRING_H#include &lt;string.h&gt;#endif#ifndef __TEXTUTILS__#include &lt;TextUtils.h&gt;#endif#ifndef __QTUtilities__#include &quot;QTUtilities.h&quot;#endif#include &quot;ComResource.h&quot;#if TARGET_OS_WIN32#ifndef __QTML__#include &lt;QTML.h&gt;#endif#include &lt;shlobj.h&gt;                      // for SHAddToRecentDocs#endif// revert to older names, to keep the linker happy#if TARGET_CPU_68K#define EnableMenuItem            EnableItem#define DisableMenuItem            DisableItem#endif////////////// constants////////////#define kInvalidFileRefNum          -1        // an invalid file reference number#define kDefaultFileTypeCount        100        // a generous guess at the number of file types we can open// constants for selecting InitApplication phaseenum {  kInitAppPhase_BeforeCreateFrameWindow   = 1L &lt;&lt; 0,    // MDI frame window is not yet created  kInitAppPhase_AfterCreateFrameWindow  = 1L &lt;&lt; 1,    // MDI frame window is already created  kInitAppPhase_BothPhases        = kInitAppPhase_BeforeCreateFrameWindow | kInitAppPhase_AfterCreateFrameWindow};// constants for selecting StopApplication phaseenum {  kStopAppPhase_BeforeDestroyWindows     = 1L &lt;&lt; 0,    // movie windows are not yet torn down  kStopAppPhase_AfterDestroyWindows    = 1L &lt;&lt; 1,    // movie windows are already torn down  kStopAppPhase_BothPhases        = kStopAppPhase_BeforeDestroyWindows | kStopAppPhase_AfterDestroyWindows};enum {  kApplicationSignature            = FOUR_CHAR_CODE('QTsh')};// parameters to the SetMenuItemState function#if TARGET_OS_MAC#define kEnableMenuItem            0x00000000L#define kDisableMenuItem          0x00000001L#endif#if TARGET_OS_WIN32#define kEnableMenuItem            MF_ENABLED#define kDisableMenuItem          MF_GRAYED#endif// constants for standard modal dialog filter proc#define kMyButtonDelay            8#define kReturnKey              (char)0x0D  #define kEnterKey              (char)0x03  #define kEscapeKey              (char)0x1B  #define kPeriod                '.'// items in Save Changes dialog box#if TARGET_OS_MAC#define kSaveChanges            1            // save the changes before closing window#define kCancelClose            2            // no, don't close the window or save changes#define kDontSaveChanges          3            // discard any unsaved changes#define kOKButtonUserItem          4#endif#if TARGET_OS_WIN32#define kSaveChanges            IDYES          // save the changes before closing window#define kCancelClose            IDCANCEL        // no, don't close the window or save changes#define kDontSaveChanges          IDNO          // discard any unsaved changes#endif// default name of a movie created by &quot;New&quot; menu command#if TARGET_OS_MAC#define kNewMovieName            &quot;untitled.mov&quot;#endif#if TARGET_OS_WIN32#define kNewMovieName            &quot;C:\\untitled.mov&quot;#endif// default window positions#ifndef kDefaultWindowX#define kDefaultWindowX            100#endif#ifndef kDefaultWindowY#define kDefaultWindowY            100#endif// accelerators for Windows Edit menu items#define kWinUndoAccelerator          &quot;\tCtrl+Z&quot;#define kWinPasteAccelerator        &quot;\tCtrl+V&quot;#define kWinClearAccelerator        &quot;\tDel&quot;#define kAmpersandText            &quot;&amp;&quot;///////////// macros////////////// macros for converting Mac menu ID/menu item pairs into a single &quot;menu item identifier&quot;#define MENU_IDENTIFIER(menuID,menuItem)  ((menuID&lt;&lt;8)+(menuItem))#define MENU_ID(menuIdentifier)        ((menuIdentifier&amp;0xff00)&gt;&gt;8)#define MENU_ITEM(menuIdentifier)      ((menuIdentifier&amp;0x00ff))////////////// data types////////////typedef const OSType *    QTFrameTypeListPtr;#if TARGET_OS_MACtypedef MenuHandle      MenuReference;typedef WindowPtr      WindowReference;typedef NavObjectFilterUPP  QTFrameFileFilterUPP;#endif#if TARGET_OS_WIN32typedef HMENU        MenuReference;typedef HWND        WindowReference;typedef FileFilterUPP    QTFrameFileFilterUPP;#endif////////////// structures////////////// WindowObjectRecord is a data structure attached to a movie window.// We use this structure to associate data with any window presented.// If you have application-specific data that you want associated with// a movie or movie window, use the fAppData field to hold a handle to// that data.typedef struct {  WindowReference      fWindow;      // the window  Movie          fMovie;        // the movie  MovieController     fController;    // the movie controller  GraphicsImportComponent fGraphicsImporter;  // the graphics import component (if an image file)  FSSpec          fFileFSSpec;    // location of the movie file  short          fFileResID;      // the resource ID that the movie was loaded from  short          fFileRefNum;    // the file reference number for the movie file  Boolean          fCanResizeWindow;  // can the window be resized?  Boolean          fIsDirty;      // has the movie data changed since the last save?  Boolean          fIsQTVRMovie;    // is this a QuickTime VR movie?  QTVRInstance      fInstance;      // the QTVRInstance, if it's a QuickTime VR movie  OSType          fObjectType;    // a tag indicating that the window object belongs to our application  Handle          fAppData;      // a handle to application-specific window data} WindowObjectRecord, *WindowObjectPtr, **WindowObject;////////////// function prototypes//     //////////// the following functions are defined in MacFramework.c and/or WinFramework.cvoid            QTFrame_QuitFramework (void);WindowReference        QTFrame_CreateMovieWindow (void);void             QTFrame_DestroyMovieWindow (WindowReference theWindow);void             QTFrame_ShowAboutBox (void);void            QTFrame_GetDisplayName (char *thePathName, char *theDispName);// the following functions are defined in ComFramework.cvoid            QTFrame_HandleFileMenuItem (WindowReference theWindow, UInt16 theMenuItem);void            QTFrame_HandleEditMenuItem (WindowReference theWindow, UInt16 theMenuItem);int              QTFrame_AdjustMenus (WindowReference theWindow, MenuReference theMenu, long theModifiers);Boolean           QTFrame_CreateNewMovie (void);Boolean           QTFrame_OpenMovieInWindow (Movie theMovie, FSSpec *theFSSpec);MovieController        QTFrame_SetupController (Movie theMovie, WindowReference theWindow, Boolean theMoveWindow);OSErr            QTFrame_SaveAsMovieFile (WindowReference theWindow);Boolean           QTFrame_UpdateMovieFile (WindowReference theWindow);void            QTFrame_IdleMovieWindows (void);void            QTFrame_CloseMovieWindows (void);void            QTFrame_CreateWindowObject (WindowReference theWindow);void            QTFrame_CloseWindowObject (WindowObject theWindowObject);WindowReference        QTFrame_GetFrontAppWindow (void);WindowReference        QTFrame_GetNextAppWindow (WindowReference theWindow);WindowReference        QTFrame_GetFrontMovieWindow (void);WindowReference        QTFrame_GetNextMovieWindow (WindowReference theWindow);WindowObject        QTFrame_GetWindowObjectFromFrontWindow (void);WindowObject        QTFrame_GetWindowObjectFromWindow (WindowReference theWnd);MovieController        QTFrame_GetMCFromFrontWindow (void);MovieController        QTFrame_GetMCFromWindow (WindowReference theWindow);QTVRInstance        QTFrame_GetQTVRInstanceFromFrontWindow (void);QTVRInstance        QTFrame_GetQTVRInstanceFromWindow (WindowReference theWindow);Handle            QTFrame_GetAppDataFromFrontWindow (void);Handle            QTFrame_GetAppDataFromWindow (WindowReference theWnd);Handle            QTFrame_GetAppDataFromWindowObject (WindowObject theWindowObject);Boolean           QTFrame_IsWindowObjectOurs (WindowObject theWindowObject);Boolean            QTFrame_IsAppWindow (WindowReference theWindow);Boolean            QTFrame_IsMovieWindow (WindowReference theWindow);Boolean            QTFrame_IsImageWindow (WindowReference theWindow);void             QTFrame_ActivateController (WindowReference theWindow, Boolean IsActive);void            QTFrame_Beep (void);void            QTFrame_SetMenuState (MenuReference theMenu, UInt16 theMenuRank, short theState);void            QTFrame_SetMenuItemState (MenuReference theMenu, UInt16 theMenuItem, short theState);void            QTFrame_SetMenuItemLabel (MenuReference theMenu, UInt16 theMenuItem, char *theText);void            QTFrame_SetMenuItemCheck (MenuReference theMenu, UInt16 theMenuItem, Boolean theState);GrafPtr            QTFrame_GetPortFromWindowReference (WindowReference theWindow);WindowReference        QTFrame_GetWindowReferenceFromPort (GrafPtr thePort);WindowPtr          QTFrame_GetWindowFromWindowReference (WindowReference theWindow);WindowReference        QTFrame_GetWindowReferenceFromWindow (WindowPtr theWindow);short            QTFrame_GetWindowWidth (WindowReference theWindow);void            QTFrame_SetWindowTitleFromFSSpec (WindowReference theWindow, FSSpecPtr theFSSpecPtr, Boolean theAddToRecentDocs);void            QTFrame_SizeWindowToMovie (WindowObject theWindowObject);OSErr            QTFrame_PutFile (ConstStr255Param thePrompt, ConstStr255Param theFileName, FSSpecPtr theFSSpecPtr, Boolean *theIsSelected, Boolean *theIsReplacing);OSErr            QTFrame_GetOneFileWithPreview (short theNumTypes, QTFrameTypeListPtr theTypeList, FSSpecPtr theFSSpecPtr, void *theFilterProc);PASCAL_RTN void        QTFrame_HandleNavEvent (NavEventCallbackMessage theCallBackSelector, NavCBRecPtr theCallBackParms, void *theCallBackUD);Handle            QTFrame_CreateOpenHandle (OSType theApplicationSignature, short theNumTypes, QTFrameTypeListPtr theTypeList);QTFrameFileFilterUPP    QTFrame_GetFileFilterUPP (ProcPtr theFileFilterProc);OSErr            QTFrame_BuildFileTypeList (void);static void          QTFrame_AddComponentFileTypes (OSType theComponentType, long *theNextIndex);#if TARGET_OS_MACPASCAL_RTN Boolean      QTFrame_FilterFiles (AEDesc *theItem, void *theInfo, void *theCallBackUD, NavFilterModes theFilterMode);#endif#if TARGET_OS_WIN32PASCAL_RTN Boolean      QTFrame_FilterFiles (CInfoPBPtr thePBPtr);void            QTFrame_ConvertMacToWinRect (Rect *theMacRect, RECT *theWinRect);void            QTFrame_ConvertWinToMacRect (RECT *theWinRect, Rect *theMacRect);void            QTFrame_ConvertMacToWinMenuItemLabel (MovieController theMC, MenuReference theWinMenu, long theModifiers, UInt16 theMenuItem);#endif////////////// application-specific function prototypes//// These are defined in the file ComApplication.c; both MacFramework.c and WinFramework.c// call these functions at specific times; you can use them to customize a specific application.//     //////////void            QTApp_Init (UInt32 theStartPhase);void            QTApp_Stop (UInt32 theStopPhase);void            QTApp_Idle (WindowReference theWindow);void            QTApp_Draw (WindowReference theWindow);void             QTApp_HandleContentClick (WindowReference theWindow, EventRecord *theEvent);Boolean            QTApp_HandleKeyPress (char theCharCode);Boolean           QTApp_HandleMenu (UInt16 theMenuItem);void            QTApp_AdjustMenus (WindowReference theWindow, MenuReference theMenu);Boolean            QTApp_HandleEvent (EventRecord *theEvent);void            QTApp_SetupController (MovieController theMC);void            QTApp_SetupWindowObject (WindowObject theWindowObject);void            QTApp_RemoveWindowObject (WindowObject theWindowObject);PASCAL_RTN Boolean      QTApp_MCActionFilterProc (MovieController theMC, short theAction, void *theParams, long theRefCon);</pre>
	<!--googleoff: index -->
			</td>
		</tr>
	</table>
	<!-- END WIDE COLUMN -->

	<!-- END MAIN CONTENT -->
		<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/samplecode/Movie_From_DataRef/listing10.html%3Fid%3DDTS10001039-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/samplecode/Movie_From_DataRef/listing10.html%3Fid%3DDTS10001039-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/samplecode/Movie_From_DataRef/listing10.html%3Fid%3DDTS10001039-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

	<!-- START BOTTOM APPLE NAVIGATION -->
	<!--#include virtual="/includes/footer"-->
	<!-- END BOTTOM APPLE NAVIGATION -->

<!-- START CENTER CLOSE -->
</center>
<!-- END CENTER CLOSE -->

</body>
</html>