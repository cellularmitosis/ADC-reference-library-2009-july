<html><head><title>Mac OS X
 Manual Page For certtool(1)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/1/certtool" title="Mac OS X
 Manual Page for certtool(1)"><!-- headerDoc=man; indexgroup=Section 1; uid="//apple_ref/doc/man/1/certtool"; name=certtool(1) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
CERTTOOL(1)                                                                                      CERTTOOL(1)



<b>NAME</b>
       certtool - create key pairs, certificates and certificate signing requests for use with Keychains

<b>SYNOPSIS</b>
       <b>certtool</b> command [command-args] [options] <b>certtool</b> c [options] <b>certtool</b> r outFileName [options] <b>cert</b>-<font color="#ffffff" class="whiteout">tool&nbsp;certtool</font>
       <b>tool</b> v infileName [options] <b>certtool</b> C domainName [options] <b>certtool</b> i inFileName [options]  <b>certtool</b>
       d  inFileName  [options]  <b>certtool</b>  I inFileName [options] <b>certtool</b> D inFileName [options] <b>certtool</b> y
       [options]

<b>CERTTOOL</b> <b>COMMAND</b> <b>SUMMARY</b>
       <b>c</b> Create keypair and Certificate <b>r</b> Create CSR <b>v</b> Verify CSR <b>C</b> Create a System Identity <b>i</b>  Import  Cer-<font color="#ffffff" class="whiteout">tificate&nbsp;Certificate</font>
       tificate <b>d</b> Display Certificate <b>I</b> Import CRL <b>D</b> Display CRL <b>I</b> Import a CRL <b>y</b> Display all certs and CRLs
       in keychain

<b>CERTTOOL</b> <b>OPTION</b> <b>SUMMARY</b>
       <b>c</b>      Create the keychain, if one is needed.

       <b>d</b>      Create a CSR in DER format; default is PEM

       <b>k=keychainName</b>
              Specify the Keychain to use for the operation. If keychainName starts with a '/', an  absolute
              path is assumed; otherwise, the specified filename is relative to the user's Library/Keychains
              directory.

       <b>p=passphrase</b>
              Specify the keychain passphrase when creating

       <b>r=privateKeyFileName</b>
              Optional private key, for Import Certificate only

       <b>f=[18f]</b>
              Private Key Format = PKCS1/PKCS8/FIPS186; default is PKCS1 (openssl)

       <b>x=[aSsm]</b>
              Extended Key Usage: a=Any; s=SSL Client; S=SSL Server; m=SMIME

       <b>a</b>      Generate private key with default ACL

       <b>u</b>      Generate private key with ACL limiting access to current user

       <b>P</b>      Don't create System Identity if one already exists for specified domain

       <b>h</b>      Print usage message

       <b>v</b>      Execute in verbose mode.

<b>DESCRIPTION</b>
       <b>Certtool</b> is a UNIX command-line program which is used to create key pairs, certificates, and certifi-<font color="#ffffff" class="whiteout">cate&nbsp;certificate</font>
       cate  signing  requests; to import externally generated certificates and Certificate Revocation Lists
       (CRLs) into a Keychain, and to display the contents of certificates and CRLs.

<b>EXAMPLES</b>
       <b>Generating</b> <b>a</b> <b>Self-Signed</b> <b>Certificate</b> This command generates a key pair and a self-signed (root)  cer-<font color="#ffffff" class="whiteout">tificate&nbsp;certificate</font>
       tificate  and  places them in a keychain. The root cert is signed by the private key generated during
       this command. The cert generated by this command is totally untrustworthy and cannot be used  in  the
       "real world"; the primary use of this command is to facilitate early development of SSL server appli-<font color="#ffffff" class="whiteout">cations&nbsp;applications</font>
       cations based on SecureTransport. In particular, "real world" SSL clients (e.g., web  browsers)  will
       complain to varying degrees when they attempt to connect to an SSL server which presents a cert which
       is generated by this command. Some broswers, after a fair amount of handholding, will  allow  you  to
       conditionally "trust" this cert.

              # CertTool c [options]
       The available options are:

              k=keyChainName
       Where  "keyChainName"  is  the  name  of the keychain into which keys and the cert will be added. The
       specified keychain must exist. If it doesn't exist and you want the keychain created for you, specify
       the 'c' option. If no keychain is specified, keys and certs are added to the default keychain.

              c
       Specifies that the designated keychain is to be created.

              x=[aSsm]
       Specifies an optional Extended Key Usage extension. Values are 'a' for ExtendedKeyUseAny; 's' for SSL
       client (ClientAuth); 'S' for SSL server (ServerAuth); and 'm' for S/MIME (EmailProtection).

              a
       Results the the private key being created with a default ACL. If not specified, the  private  key  is
       created with no ACL.

              u
       Create  the private key with an ACL limiting access to the current user.  This is an interactive com-<font color="#ffffff" class="whiteout">mand;&nbsp;command;</font>
       mand; you will be prompted for a number of different items which are used to generate the keypair and
       the cert. A sample session follows.

              # CertTool k=certkc
              Enter key and certificate label: testCert

              Please specify parameters for the key pair you will generate.

                   r RSA
                   d DSA
                   f FEE

              Select key algorithm by letter: r

              Valid key sizes for RSA are 512..2048; default is 512
              Enter key size in bits or CR for default: 512

              You have selected algorithm RSA, key size 512 bits.
              OK (y/anything)? y
              Enter cert/key usage (s=signing, b=signing AND encrypting): b
               ...Generating key pair...

       Note:  you will be prompted for the Keychain's passphrase by the Keychain system at this point if the
       specified keychain is not open and you have not specified the passphrase via the 'p' option.

              Please specify the algorithm with which your certificate will be signed.

                   5 RSA with MD5
                   s RSA with SHA1

              Select signature algorithm by letter: s

              You have selected algorithm RSA with SHA1.
              OK (y/anything)? y
       You will now specify the various components of the certificate's Relative Distinguished  Name  (RDN).
       An  RDN  has  a  number  of  components, all of which are optional, but at least one of which must be
       present.  Note that if you are creating a certificate for use in an SSL/TLS server, the  Common  Name
       component  of the RDN must match exactly the host name of the server. This must not be an IP address,
       but the actual domain name, e.g. www.apple.com.  Entering a CR for a given RDN component  results  in
       no value for that component.

              Common Name       (e.g. www.apple.com) : 10.0.61.5
              Country           (e.g. US) :
              Organization      (e.g. Apple Computer, Inc.) : Apple
              Organization Unit (e.g. Apple Data Security) :
              State/Province    (e.g. California) : California
              Email Address     (e.g. johngalt@rand.com) :
              You have specified:
               Common Name   : 10.0.61.5
               Organization  : Apple
               State/Province : California
              Is this OK (y/anything)? y
              #
       The  "Common  Name" portion of the RDN - in the above case, "10.0.61.5" - MUST match the host name of
       the machine you'll be running an SSL/TLS server on. (In this case the test machine  doesn't  have  an
       actual  hostname;  it's  DHCP'd  behind  a firewall which is why "10.0.61.5" was specified for Common
       Name.) This is part of SSL's certificate verification; it prevents an attack using DNS  spoofing.   A
       brief  note about cert/key usage: the normal configuration of SecureTransport is that the server cert
       specified in SSLSetCertificate() is capable of both signing and encryption.  If  this  cert  is  only
       capable  of  signing, you must create a second keychain containing a cert which is capable of encryp-<font color="#ffffff" class="whiteout">tion,&nbsp;encryption,</font>
       tion, and pass that to SSLSetEncryptionCertificate().  <b>Generating</b> <b>a</b> <b>Certificate</b> <b>Signing</b> <b>Request</b> <b>(CSR)</b>
       A  CSR is the standard means by which an administrator of a web server provides information to a Cer-<font color="#ffffff" class="whiteout">tificate&nbsp;Certificate</font>
       tificate Authority (CA) in order to obtain a valid certificate which is signed by the CA.  This  type
       of  cert  is used in the real world; certs signed by CAs such as Verisign or Thawte are recognized by
       most web browsers when performing SSL transactions.  The general procedure  for  obtaining  a  "real"
       cert is:

             Generate a key pair

             Generate a CSR

             Provide the CSR and some other information and/or documentation to the CA

             CA sends you a certificate which is signed by the CA.

             You import that certificate, obtained from the CA, into your keychain.  The items in that key-<font color="#ffffff" class="whiteout">chain&nbsp;keychain</font>
              chain can now be used in SecureTransport's SSLSetCertificate() call.   This  command  performs
              the  first  two steps in the above procedure. See the section below entitled "Importing a Cer-<font color="#ffffff" class="whiteout">tificate"&nbsp;Certificate"</font>
              tificate" for information on importing the resulting certificate into your keychain. The  for-<font color="#ffffff" class="whiteout">mat&nbsp;format</font>
              mat of this command is

              # CertTool r outFileName [options]
       The resulting CSR will be written to "outFileName".  The available options are:

              k=keyChainName
       Where  "KeyChainName"  is  the name of the keychain into which keys and the cert will be added. If no
       keychain is specified, keys and certs are added to the default keychain. The specified keychain  must
       exist unless you specify the 'c' option.

               d
       The  'd'  option  tells CertTool to create the CSR in DER-encoded format. The default is PEM-encoded,
       which is what most CAs expect. PEM encoded data consists of printable ASCII text which can, for exam-<font color="#ffffff" class="whiteout">ple,&nbsp;example,</font>
       ple, be pasted into an email message.  DER-encoded data is nonprintable binary data.

               c
       Specifies that the designated keychain is to be created.

              a
       Results  the  the  private key being created with a default ACL. If not specified, the private key is
       created with no ACL.

              u
       Create the private key with an ACL limiting access to the current user.  This is an interactive  com-<font color="#ffffff" class="whiteout">mand;&nbsp;command;</font>
       mand; you will be prompted for a number of different items which are used to generate the keypair and
       the CSR. The prompts given, and the format of the data you must supply, are  identical  to  the  data
       shown  in  the  sample session in Section 2.  <b>Verifying</b> <b>a</b> <b>CSR</b> A CSR contains, among other things, the
       public key which was generated in as described above. The CSR is signed with the  associated  private
       key.  Thus the integrity of a CSR can be verified by extracting its public key and verifying the sig-<font color="#ffffff" class="whiteout">nature&nbsp;signature</font>
       nature of the CSR. This command performs this integrity check. The format of this command is

              # CertTool v inFileName [options]
       The only available option is the 'd' flag, which as described above in the section entitled "Generat-<font color="#ffffff" class="whiteout">ing&nbsp;"Generating</font>
       ing  a Certificate Signing Request", indiciates that the CSR is in DER format rather than the default
       PEM format.  A typical (successful) run of this command is like so:

              # CertTool v myCsr.pem
               ...CSR verified successfully.
       A large number of things can go wrong if the verification fails; suffice it to say that  if  you  see
       anything  other  than  the above success message, you have a bad or corrupted CSR.  <b>Creating</b> <b>a</b> <b>System</b>
       <b>Identity</b> This creates a key pair and a self-signed (root) certificate in  the  System  keychain,  and
       registers the result in the System Identity database as being the IDentity associated with the speci-<font color="#ffffff" class="whiteout">fied&nbsp;specified</font>
       fied domain name. The domain name is typically a string of the  form  "com.apple.somedomain...".  You
       must be running as root to execute this command.  The format of this command is

              # CertTool C domainName [options]
       The available options are:

              u
       Create the private key with an ACL limiting access to the current user. If not specified, the private
       key wil be created with a default ACL.

              P
       Don't create system identity if one already exists for specified  domain.   <b>Importing</b>  <b>a</b>  <b>Certificate</b>
       <b>from</b>  <b>a</b>  <b>Certificate</b>  <b>Authority</b> Once you have negotiated with your CA, and provided them with the CSR
       generated as described above as well as  any  other  information,  documentation,  and  payment  they
       require,  the CA will provide you with a certificate. Use this command to add that certificate to the
       keychain containing the keypair you generated previously.  The format of this command is

              # CertTool i inFileName [options]
       The cert to import is obtained from "inFileName". The available options are:

              k=keyChainName
       Where "keyChainName" is the name of the keychain to which the cert will be added. If no  keychain  is
       specified,  the cert is added to the default keychain.  The specified keychain typically contains the
       keypair you generated previously.  (Note you can import a certificate into a keychain which does  not
       contain  keys  you generated but there will be no linkage between the imported certificate and a pri-<font color="#ffffff" class="whiteout">vate&nbsp;private</font>
       vate key if you do this.) If the keychain is not open when this command  is  executed,  you  will  be
       prompted by the Keychain system for its passphrase.

              r=privateKeyFileName
       Where  "privateKeyFileName"  is  the name of the optional private key file to imported along with the
       certificate. This option is used to import cert/key pairs which are generated by other means, such as
       OpenSSL.

              f=privateKeyFormat
       Where  "privateKeyFormat" is the format of the private key specified with the 'r' option. The formats
       are: '1' for PKCS1 (OpenSSL format), '8' (PKCS8), and 'f' (FIPS186, BSAFE  format).  The  default  is
       OpenSSL format for both RSA and DSA keys.

               d
       Specifies DER format as described above. The default is PEM format.

               c
       Specifies  that the designated keychain is to be created.  <b>Displaying</b> <b>a</b> <b>Certificate</b> This displays the
       contents of an existing certificate, obtained from a file.  The format of this command is

              # CertTool d inFileName [options]
       The cert to display is obtained from "inFileName".  The only available option is the 'd' flag, speci-<font color="#ffffff" class="whiteout">fying&nbsp;specifying</font>
       fying  DER  format  as  described  above. The default is PEM format. Actually, in the absence of this
       option, certtool will correctly determine the format of the certificate (PEM or  DER).   <b>Importing</b>  <b>a</b>
       <b>CRL</b>  This  command  is  used to add a Certificate Revocation List (CRL) to a keychain.  The format of
       this command is

              # CertTool I inFileName [options]
       The CRL to import is obtained from "inFileName".  The available options are:

              k=keyChainName
       Where "KeyChainName" is the name of the keychain to which the CRL will be added.  If no  keychain  is
       specified,  the cert is added to the default keychain.  If the keychain is not open when this command
       is executed, you will be prompted by the Keychain system for its passphrase.

               d
       Specifies DER format as described above. The default is PEM format.

               c
       Specifies that the designated keychain is to be created.  <b>Displaying</b> <b>a</b> <b>CRL</b> This displays the contents
       of an existing Certificate Revocation List (CRL), obtained from a file. The format of this command is

              # CertTool D inFileName [options]
       The cert to display is obtained from "inFileName".  The only available option is the 'd' flag, speci-<font color="#ffffff" class="whiteout">fying&nbsp;specifying</font>
       fying  DER format as described above. The default is PEM format.  <b>Displaying</b> <b>Certificates</b> <b>and</b> <b>CRLs</b> <b>in</b>
       <b>a</b> <b>keychain</b> This displays the contents of all certificates and CRLs in a keychain. The format of  this
       command is

              # CertTool y [options]
       The available options are:

              k=keyChainName
       Where "KeyChainName" is the name of the keychain to display.

              v
       Specifies  verbose  mode.  <b>Certificate</b> <b>Authorities</b> <b>and</b> <b>CSRs</b> As mentioned above, the general procedure
       for obtaining a "real" cert is:

             Generate a key pair

             Generate a CSR

             Provide the CSR and some other information and/or documentation to the CA

             CA sends you a certificate which is signed by the CA.

             You import that certificate, obtained from the CA, into your keychain.  The items in that key-<font color="#ffffff" class="whiteout">chain&nbsp;keychain</font>
              chain  can  now be used in SecureTranspoert's SSLSetCertificate() call.  One CA with an excel-<font color="#ffffff" class="whiteout">lent&nbsp;excellent</font>
              lent web-based interface for  obtaining  a  cert  is  Verisign  (<a href="http://www.verisign.com/products/site/index.html)">http://www.verisign.com/prod-</a>
              <a href="http://www.verisign.com/products/site/index.html)">ucts/site/index.html)</a> You can get a free 14-day trial certificate using nothing but CertTool,
              Verisign's web site, and email.  You need to provide some personal information. Paste the  CSR
              generated as described in the section entitled "Generating a Certificate Signing Request" into
              a form on the web site. A few minutes later Verisign  emails  you  a  certificate,  which  you
              import into your keychain.  The whole process takes less than 10 minutes. The free certificate
              obtained in this manner is signed by a temporary root cert which  is  not  recognized  by  any
              browsers,  but Verisign also provides a means of installing this temporary root cert into your
              browser, directly from their web site. Typically one would use the  free,  temporary  cert  to
              perform initial configuration of a server and to ring out the general SSL infrastructure. Once
              you feel comfortable with the operation of the server, then it's time to buy a "real" certifi-
              cate  which  will  allow  your web server to be trusted by any browser.  Thawte has a similar,
              very friendly service at <a href="http://www.thawte.com/">http://www.thawte.com/</a>  Note that, for early web server  development
              and/or  testing,  you can skip the entire procedure described above and just generate your own
              self-signed root cert as described above. No CA is involved; no  CSR  is  generated;  no  cert
              needs  to be imported - CertTool generates a cert for you and immediately adds it to your key-
              chain. Bear in mind that this option will require support from various SSL clients  you'll  be
              testing with, none of which recognize your root cert.

<b>FILES</b>
       <b>/System/Library/Keychains/X509Anchors</b> System root certificate database <b>/Library/Keychains/System.key</b>-
       <b>chain</b> System Keychain

<b>SEE</b> <b>ALSO</b>
       <a href="openssl.1ssl.html#//apple_ref/doc/man/1/openssl"><b>openssl</b>(<b>1</b>)</a>



Apple Computer, Inc.                           March 19, 2003                                    CERTTOOL(1)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man1/certtool.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man1/certtool.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man1/certtool.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
