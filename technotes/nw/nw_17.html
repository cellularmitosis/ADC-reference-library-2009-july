<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note NW17: Data Access Extensions</title><meta name="keywords" content=""><meta name="Description" content="Technical Note NW17: ">    <meta name="categories" content="Networking"><meta name="week-posted" content="Apr 27, 1992 - May 1, 1992"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF" TEXT="#000000"><a name="//apple_ref/doc/uid/DTS10002559" title="Data Access Extensions"></a><a name="top"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxNetworking-date.html">Networking</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/Networking/index.html" target="_blank">Reference Library > Networking</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note NW17</div>
<div id="pageheadsub">Data Access Extensions</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->					<p id="menutext"><a href="#Introduction">Introduction</a><BR><BR><a href="#Section1">Contents of a Data Access Extension</a><BR><BR><a href="#Section2">Data Access Extension Parameters</a><BR><BR><a href="#Section2">Data Access Extension Messages</a><BR><BR><a href="#References">References</a><BR><BR><a href="#Downloads">Downloadables</a></p>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">This Technical Note discusses coding data access extensions that provide aninterface between the Data Access Manager and remote data sources. Each of thefunctions that a data access extension must implement is described.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[May 01 1992]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR><!-- begin_content --><h2>Introduction</h2><a name="Introduction"></a><P>A data access extension is a program that provides an interface between theData Access Manager and the remote data source. The data access extensionimplements all of the low-level functions and handles network communication forthe Data Access Manager. Because the data access extension implements thelow-level Data Access Manager functions, it must return appropriate resultcodes and handle asynchronous execution of functions as appropriate.</p><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>Note:</B><BR>Each data access extension contains a flag that indicates to theData Access Manager whether the data access extension supports asynchronousexecution of routines. If an application attempts to make an asynchronous callto a data access extension that has the first bit (bit 0) of the flags fieldcleared to 0, the Data Access Manager returns a result code of<code>rcDBAsyncNotSupp</code> and terminates execution of the routine. To ensurecompatibility     of your data access extension with all applications, your dataaccess extension should support  asynchronous execution of functions. The dataaccess extension flags field is described in the next section, "Contents of aData Access Extension."</P></TD></TR></TABLE></CENTER><BR><P>As soon as the data access extension begins execution of an asynchronousroutine, it should return a <code>noErr</code> result code for the function resultand set the result field of the asynchronous parameter block to 1. It shouldreturn control to the calling routine as quickly as possible. When itterminates execution of the routine, the data access extension must place thereturn code in the result field. Result codes for each of the data accessextension routines are listed in the next section. The asynchronous parameterblock is described in "Asynchronous Execution of Routines" in the Data AccessManager chapter of<i> Inside Macintosh</i> Volume VI, page 8-50.</p><p>When the data access extension has completed execution of an asynchronousroutine, it must call the application's completion routine pointed to by the<code>completionProc</code> field of the asynchronous parameter block. The completionroutine is described in "Asynchronous Execution of Routines" in the Data AccessManager chapter of<i> Inside Macintosh</i> Volume VI, page 8-50.</p><p>The data access extension can use the <code>ddevRef</code> field in theasynchronous parameter block for its own purposes.</p><p>This Technote describes each of the functions that a data access extensionmust implement.</p><P><A HREF="#top">Back to top</A></P><a name="Section1"></a><h2>Contents of a Data Access Extension</h2><p>A data access extension consists of a file of type <code>'ddev'</code>, located in theExtensions Folder. The data access extension file must contain these resources:</p><P><code>'ddev'</code> (function; resource ID is 128)</p><P><code>'STR&nbsp;'</code> (name of data access extension; resource ID is 128)</p><P><code>'dflg'</code> (version number and flags; resource ID is 128)</p><p>The <code>'ddev'</code> resource contains a function that implements all of the low-levelData Access Manager functions. The Data Access Manager calls the <code>ddev</code> functionwhenever the manager needs to execute a low-level function.</p><p>Here is a function declaration for a ddev function.</p><P>The params parameter is a parameter block that includes a routine selector. Thedata access extension parameter block is described in the next section, "DataAccess Extension Parameters." </p><p>You must set bit 6 of the resource attribute byte to 1 for the <code>'ddev'</code> resourceso that the resource is read into the system heap. Resource attributes arediscussed in the Resource Manager chapter of <i>Inside Macintosh <b></b></i>Volume I.</p><p>The <code>'STR&nbsp;'</code> resource must contain a character string of not more than 63characters that specifies the name of the data access extension. Under system7.0 or later, the data access extension is assumed  to reside in the"Extensions" folder within the System folder. The data access extension name isa parameter to the <code>DBInit</code> function.</p><p>The 'dflg' resource contains two 4-byte fields, as follows:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>TYPE DDEVFlags =RECORD    version:    LongInt;    {data access extension format}    flags:        LongInt    {data access extension flags}</pre>	</TD></TR></TABLE></CENTER><p>The version field indicates the version of the data access extension formatused for this data access extension. It must be set to 0 for the version 7.0Data Access Manager.</p><p>The flags field specifies flags that the data access extension must set. Atpresent, only the least significant bit is defined; all other bits must becleared to 0. Set the flags field to the constant <code>kAsyncSupported</code>(that is, set the least significant bit to 1) if this data access extensionsupports asynchronous calls, or to 0 if it does not. If an application attemptsto make an asynchronous call to a data access extension that has the flagsfield cleared to 0, the Data Access Manager returns a result code of<code>rcDBAsyncNotSupp</code>.</p><P><A HREF="#top">Back to top</A></P><a name="Section2"></a><h2>Data Access Extension Parameters</h2><p>This section describes the parameter block that the Data Access Manager passesto a data access extension. The section "Data Access Extension Messages"specifies which parameters are significant for each type of routine and whethereach value is passed to the data access extension or returned by the dataaccess extension.</p><p>The Data Access Manager passes a parameter block to a data access extension.The parameter block is defined as a <code>DDEVParams</code> record.</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>TYPE DDEVParams =RECORD    message:    Integer;    {routine selector}    ddevStorage:    LongInt;    {storage for use by }            { data access extension}    asyncPB:    DBAsyncParmBlkPtr;            {pointer to asynch }            { parameter block}    sessID:    LongInt;    {session ID}    returnedID:    LongInt;    {session ID returned}    version:    LongInt;    {version number}    start:    LongInt;    {session start time}    host:    StringPtr;    {name of remote system}    user:    StringPtr;    {user name}    password:    StringPtr;    {user password}    connStr:    StringPtr;    {connection string}    network:    StringPtr;    {name of the network}    buffer:    Ptr;    {data buffer}    err1:    LongInt;    {primary error code returned}    err2:    LongInt;    {secondary error code }            { returned}    item1:    StringPtr;    {pointer to object of error }            { message}    item2:    StringPtr;    {pointer to object of }            { error message}    errorMsg:    StringPtr;    {pointer to error message}    timeout:    LongInt;    {timeout value for DBGetItem}    dataType:    DBType;    {data type}    sessNum:    Integer;    {session number}    state:    Integer;    {status of the data source}    len:    Integer;    {length of data item}    places:    Integer;    {decimal places in data item}    flags:    Integer;    {flags}    abort:    Boolean    {flag for DBBreak}</pre>	</TD></TR></TABLE></CENTER><h3>Field Descriptions</h3><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>message             The routine selector that tells the data access extension which                    function to execute. For the values for this field and                    descriptions of the routines, see the next section, &quot;Data                    Access Extension Messages.&quot;ddevStorage         Reserved for use by the data access extension. The Data Access                    Manager sets this field to 0 when it calls the data access                    extension with the DBOpen message. The data access extension                    can store any value in this field at that time, and the Data                    Access Manager retains that value on all subsequent calls to                    the data access extension. The value of this field does not                    depend on the session ID; it is the same for all sessions that                    are using the same data access extension.asyncPB             Pointer to the asynchronous parameter block. If the application                    is making a synchronous call, this field is NIL. The                    asynchronous parameter block is described in &quot;Asynchronous                    Execution of Routines&quot; in the Data Access Manager chapter of                    Inside Macintosh Volume VI.sessID              The session ID. The data access extension returns the session                    ID to the DBInit function; all other Data Access Manager                    functions pass the session ID to the data access extension.                    The purpose of the session ID is to provide applications with a                    unique identifier for each active session. The Data Access                    Manager reads the session ID returned by the data access                    extension, and then assigns a unique session ID to each                    session. The Data Access Manager performs the mapping between                    the session IDs that it provides to applications and the ones                    used by each data access extension.returnedID          The session ID returned by the DBGetConnInfo function.version             The version number of the data access extension assigned by the                    developer of the data access extension. It is not the same as                    the version number in the 'dflg' resource of the data access                    extension, which indicates the format of the data access                    extension.start               The time at which the session was opened, in ticks.host                The name of the remote system on which the data source is                    located.user                The name of the user who is establishing a session.password            The password associated with the user name.connStr             A connection string needed to establish a session.network             A string specifying the network in use for this session.buffer              A pointer to a buffer containing the item to be sent by the                    DBSend or DBSendItem functions or received by the DBGetItem                    function.err1                The primary error code returned by the data source.err2                The secondary error code returned by the data source.item1               A pointer to a NULL-terminated string that identifies the first                    object of the error message returned by the data source. The                    use of this parameter depends on the specific data source you                    are using.item2               A pointer to a NULL-terminated string that identifies the                    second object of the error message returned by the data source.                    The use of this parameter depends on the specific data source                    you are using.errorMsg            A pointer to the error message returned by the data source.timeout             The timeout period for the DBGetItem function, in sixtieths of                    seconds. When the data access extension executes the DBGetItem                    function, it requests a data item from the remote data source.                    If the remote data source does not return the requested data                    item in the amount of time specified by the timeout parameter,                    the data access extension should cancel execution of the                    DBGetItem function. The timeout value cannot be used if the                    DBGetItem function is called asynchronously.dataType            The data type of a requested or returned data item. Data types                    are described in &quot;Getting Query Results&quot; in the Data Access                    Manager chapter of Inside Macintosh Volume VI.sessNum             The session number. This number is assigned by the data access                    extension and is unique for all current sessions for a single                    data access extension only. The same session number can be                    assigned to concurrent sessions that use different data access                    extensions.state               The status of the data source. Value Status noErr   Execution                    of a query successful; ready for another rcDBValue Output data                    is available rcDBError Execution of a query ended in an error                    rcDBExec Currently executing a querylen                 The length of the data item requested or returned.places              The number of decimal places in the data item.flags               Flags returned by the DBGetItem function or sent to the                    DBSendItem function. For the DBGetItem function, if the flags                    field is set to kDBLastColFlag (that is, the least significant                    bit is set to 1), the data item is in the last column of the                    row.  There are no flags currently defined for the DBSendItem                    function.abort               A parameter used by the DBBreak function. The meaning of this                    parameter depends on the specific implementation of the data                    source communications system you are using.</pre>	</TD></TR></TABLE></CENTER><a name="Section3"></a><P><A HREF="#top">Back to top</A></P><h2>Data Access Extension Messages</h2><p>There are sixteen values that the Data Access Manager can pass to the dataaccess extension in the messages field of the data access extension parameterblock. Thirteen of them correspond exactly to the thirteen low-level functions.The other three are used by the Data Access Manager to initialize and close thedata access extension and to allow the data access extension to perform routineperiodic tasks. The messages that correspond to low-level routines are notdescribed in this section. Instead, only the parameters they use and the resultcodes they must be able to return are listed. For descriptions of theseroutines, see the section "Data Access Manager Routines" in the Data AccessManager chapter of<i> Inside Macintosh </i>Volume VI. The <code>DBOpen</code>,<code>DBClose</code>, and <code>DBIdle</code> messages are described in detail in thissection.</p><p>Each parameter in the list is preceded by an arrow that indicates how theparameter is used, as follows:</p><P>-&gt;    The Data Access Manager passes the value of the parameter as input to thedata access extension.</p><P>&lt;-    The data access extension returns the value of the parameter after theroutine has completed execution.</p><P>&lt;-&gt;    The Data Access Manager provides a value for the parameter, and thedata access extension returns another value.</P><h3>DBOpen</h3><P>Parameter block</p><P>-&gt;    00    <code>message</code>    word    routine selector; <code>kDBOpen</code></p><P>&lt;-    02    <code>ddevStorage</code>    long     storage for data access                         extension</P><p>When an application calls the <code>DBInit</code> function or the<code>DBStartQuery</code> function (which calls the <code>DBInit</code> function), itspecifies a data access extension. If that data access extension is not alreadyin memory, the <code>DBInit</code> function loads it into memory and sends it the<code>kDBOpen</code> message. The data access extension should allocate any memoryit needs at this time. Because the data access extension can be called by morethan one application, it should allocate memory in the system heap rather thanthe application heap. The data access extension can also return a value in theddevStorage field of the data access extension parameter block.</p><p>When the Data Access Manager calls the data access extension, the currentresource file is the data access extension file and the default directory isthe Extensions Folder on the current startup disk. The data access extensionmust ensure that both of these values are unchanged when it returns control tothe Data Access Manager.</p><P>Result codes</p><p><code>noErr         </code>0    Data Access Extension initialized successfully</p><p><code>rcDBError    </code>-    -802    Error initializing data access extension</p><p><b>DBClose</b></p><P>Parameter block</p><P>-&gt;    00    <code>message</code>    word    routine selector; kDBClose</p><P> -&gt;    02    <code>ddevStorage</code>    long     storage for data access extension</p><P>When an application calls the <code>DBEnd</code> function, closing the last opensession for a data access extension, the Data Access Manager follows the<code>kDBEnd</code> message with a <code>kDBClose</code> message before removing thedata access extension from memory. The data access extension should free anymemory that it allocated before returning control to the Data Access Manager.Result code</p><p><code>noErr</code>    0    No error</p><p><b>DBIdle</b></p><P>Parameter block</p><P>-&gt;    00    <code>message</code>    word    routine selector; <code>kDBIdle</code></p><P>&lt;-&gt;    02    <code>ddevStorage</code>    long     storage for data access extension</p><p>The Data Access Manager periodically sends the <code>kDBIdle</code> message to eachdata access extension. The data access extension can ignore this message ortake the opportunity to perform periodic tasks. Because the timing of the<code>kDBIdle</code> messages might not be regular, the data access extension mustnot depend on receiving these messages at particular times or with a particularfrequency. Result code</p><p><code>noErr</code>    0    No error</p><p><b>DBInit</b></p><P>Parameter block</p><P>-&gt;    00    <code>message</code>    word    routine selector; kDBInit</p><P>&lt;-&gt;    02    <code>ddevStorage</code>    long     storage for data access extension</p><P>-&gt;    06    <code>asyncPB</code>    long    pointer to asynch parameter                     block</p><P>&lt;-    10    <code>sessID</code>    long    session ID</p><P>-&gt;    26    <code>host</code>    long    pointer to name of remote                     system</p><P>-&gt;    30    <code>user</code>    long    pointer to user name</p><P>-&gt;    34    <code>password</code>    long    pointer to user password</p><P> -&gt;    38    <code>connStr</code>    long    pointer to connection string</p><p>The <code>DBInit</code> function initiates a session with a remote data source. See"Controlling the Session" in the Data Access Manager chapter of<i> InsideMacintosh </i>Volume VI for a complete description of this function.Result codes</p><p><code>noErr </code>0    No error</p><p><code>rcDBError   -</code>802    Error initiating session</p><p><b>DBEnd</b></p><P>Parameter block</p><P>-&gt;    00    <code>message</code>    word    routine selector; <code>kDBEnd</code></p><P>&lt;-&gt;    02    <code>ddevStorage</code>    long    storage for data access extension</p><P>-&gt;    06    <code>asyncPB</code>    long    pointer to asynch parameter                     block</p><P>-&gt;    10    <code>sessID</code>    long    session ID</p><p>The <code>DBEnd</code> function terminates a session with a remote data source andterminates the network connection between the application and the remotecomputer. See "Controlling the Session" in the Data Access Manager chapterof<i> Inside Macintosh</i> Volume VI for a complete description of thisfunction.Result codes</p><p><code>noErr</code>0    No error</p><p><code>rcDBError</code>        -802    Error ending session</p><p><b>DBGetConnInfo</b></p><P>Parameter block</p><P>-&gt;    00    <code>message</code>    word    routine selector;<code>kDBGetConnInfo</code></p><P>&lt;-&gt;    02    <code>ddevStorage</code>    long    pointer to storage for ddev</p><P>-&gt;    06    <code>asyncPB</code>    long    pointer to asynch parameter                     block</p><P>-&gt;    10    <code>sessID</code>    long    session ID</p><P>&lt;-    14    <code>returned ID</code>    long    session ID returned</p><P>&lt;-    18    <code>version</code>    long    version number</p><P>&lt;-    22    <code>start</code>    long    session start time in ticks</p><P>&lt;-    26    <code>host</code>    long    pointer to name of remote                     system</p><P>&lt;-    30    <code>user</code>    long    pointer to user name</p><P>&lt;-    38    <code>connStr</code>    long    pointer to connection string</p><P>&lt;-    42    <code>network</code>    long    pointer to name of network</p><P>-&gt;    78    <code>sessNum</code>    word    session number</p><P>&lt;-    80    <code>state</code>    word    status of data source</p><p>The <code>DBGetConnInfo</code> function returns information about the specifiedsession. See "Controlling the Session" in the Data Access Manager chapter of<i>Inside Macintosh</i> Volume VI for a complete description of this function.Result codes</p><p><code>noErr</code>   0        No error</p><p><code>rcDBBadSessNum   </code>    -808    Invalid session number</p><p><b>DBGetSessionNum</b></p><P>Parameter block</p><P>-&gt;    00    <code>message</code>    word    routine selector;                     <code>kDBGetSessionNum</code></p><P>&lt;-&gt;    02    <code>ddevStorage</code>    long     storage for data access extension</p><P>-&gt;    06    <code>asyncPB</code>    long    pointer to asynch parameter                     block</p><P> -&gt;    10    <code>sessID</code>    long    session ID</p><P>&lt;-    78    <code>sessNum</code>    word    session number</p><p>The <code>DBGetSessionNum</code> function returns a session number. See"Controlling the Session" in the Data Access Manager chapter of<i> InsideMacintosh</i> Volume VI for a complete description of this function.Result codes</p><p><code>noErr</code>    0    No error</p><p><code>rcDBError   </code>    - 802    Error getting session number</p><p><b>DBKill</b></p><P>Parameters used</p><P>&gt;    00    <code>message</code>    word    routine selector; <code>kDBKill</code></p><P>&lt;-&gt;    02    <code>ddevStorage</code>    long     storage for data access extension</p><P>-&gt;    06    <code>asyncPB</code>    long    pointer to asynch parameter                     block</p><p>The <code>DBKill</code> function cancels the execution of an asynchronous call. See"Controlling the Session" in the Data Access Manager chapter of<i> InsideMacintosh</i> Volume VI for a complete description of this function.Result codes</p><p><code>noErr</code>0    Asynchronous routine canceled successfully</p><p><code>rcDBError  </code>    -802    Error canceling routine</P><P><b>DBSend</b></P><P>Parameter block</p><P>-&gt;    00    <code>message</code>    word    routine selector; <code>kDBSend</code></p><P>&lt;-&gt;    02    <code>ddevStorage</code>    long     storage for data access extension</p><P>-&gt;    06    <code>asyncPB</code>    long    pointer to asynch parameter                     block</p><P>-&gt;    10    <code>sessID</code>    long    session ID</p><P>-&gt;    46    <code>buffer</code>    long    pointer to data buffer</p><P>-&gt;    82    <code>len</code>    word    length of data</P><p>The <code>DBSend</code> function sends a query or a portion of a query to theremote data source. See "Sending and Executing Queries" in the Data AccessManager chapter of<i> Inside Macintosh</i> Volume VI for a complete descriptionof this function.Result codes</p><p><code>noErr</code>0    No error</p><p><code>rcDBError</code>       -802    Error trying to send text</P><p><b>DBSendItem</b></p><P>Parameter block</p><P>-&gt;    00    <code>message</code>    word    routine selector;                             <code>kDBSendItem</code></p><P>&lt;-&gt;    02    <code>ddevStorage</code>    long     storage for data access extension</p><P>-&gt;    06    <code>asyncPB</code>    long    pointer to asynch parameter                     block</p><P>-&gt;    10    <code>sessID</code>    long    session ID</p><P>-&gt;    46    <code>buffer</code>    long    pointer to data buffer</p><P>-&gt;    74    <code>dataType</code>    long    data type</p><P>-&gt;    82    <code>len</code>    word    length of data item</p><P>-&gt;    84    <code>places</code>    word    decimal places in data item</p><P>-&gt;    86    <code>flags</code>    word    flags</P><p>The <code>DBSendItem</code> function sends a single data item to the remote datasource. See "Sending and Executing Queries" in the Data Access Manager chapterof<i> Inside Macintosh</i> Volume VI for a complete description of thisfunction.</P><P>Result codes</p><p><code>noErr</code>0    No error</p><p><code>rcDBError</code>        -802    Error trying to send item</P><p><b>DBExec</b></p><P>Parameter block</p><P>-&gt;    00    <code>message</code>    word    routine selector; <code>kDBExec</code></p><P>&lt;-&gt;    02    <code>ddevStorage</code>    long     storage for data accessextension</p><P>-&gt;    06    <code>asyncPB</code>    long    pointer to asynch parameter                     block</p><P>-&gt;    10    <code>sessID</code>    long    session ID</P><p>The <code>DBExec</code> function initiates execution of a query. See "Sending andExecuting Queries" in the Data Access Manager chapter of<i> InsideMacintosh</i> Volume VI for a complete description of this function.Result codes</p><p><code>noErr         </code>0    Execution has begun</p><p><code>rcDBError   </code>-802    Error trying to begin execution</P><p><b>DBState</b></p><P>Parameter block</p><P>-&gt;    00    <code>message</code>    word    routine selector; <code>kDBState</code></p><P>&lt;-&gt;    02    <code>ddevStorage</code>    long     storage for data access extension</p><P>-&gt;    06    <code>asyncPB</code>    long    pointer to asynch parameter                     block</p><P>-&gt;    10    <code>sessID</code>    long    session ID</P><p>The result code returned by the <code>DBState</code> function indicates the statusof the remote data source. See "Sending and Executing Queries" in the DataAccess Manager chapter of<i> Inside Macintosh</i> Volume VI for a completedescription of this function.Result codes</p><p><code>noErr        </code>0    No error; ready for more text</p><p><code>rcDBValue</code>     -801    Output data available</p><p><code>rcDBError</code>    - 802    Execution ended in an error</p><p><code>rcDBExec</code>           -806    Currently executing query</p><p><b>DBGetErr</b></p><P>Parameter block</p><P>-&gt;    00    <code>message</code>    word    routine selector; <code>kDBGetErr</code></p><P>&lt;-&gt;    02    <code>ddevStorage</code>    long     storage for data access  extension</p><P>-&gt;    06    <code>asyncPB</code>    long    pointer to asynch parameter                     block</p><P>-&gt;    10    <code>sessID</code>    long    session ID</p><P>&lt;-    50    <code>err1</code>    long    primary error code</p><P>&lt;-    54    <code>err2</code>    long    secondary error code</p><P>&lt;-    58    <code>item1</code>    long    pointer to first object of                         error message</p><P>&lt;-    62    <code>item2</code>    long    pointer to second object of                     error message</p><P>&lt;-    66    <code>errorMsg</code>    long    pointer to error message</P><p>The <code>DBGetErr</code> function retrieves error codes and error messages from aremote data source. See "Sending and Executing Queries" in the Data AccessManager chapter of<i> Inside Macintosh</i>  Volume VI for a completedescription of this function.</p><P>Result codes</p><p><code>noErr        </code>0    No error</p><p><code>rcDBError  </code>    -802    Error retrieving error information</p><p><b>DBBreak</b></p><P>Parameter block</p><P>-&gt;    00    <code>message</code>    word    routine selector; <code>kDBBreak</code></p><P>&lt;-&gt;    02    <code>ddevStorage</code>    long     storage for data access extension</p><P>-&gt;    06    <code>asyncPB</code>    long    pointer to asynch parameter                     block</p><P>-&gt;    10    <code>sessID</code>    long    session ID</p><P>-&gt;    88    <code>abort</code>    byte    abort flag</P><p>The <code>DBBreak</code> function can halt execution of a query and reinitializethe remote data source, or it can unconditionally terminate a session with adata source. See "Sending and Executing Queries" in the Data Access Managerchapter of<i> Inside Macintosh</i> Volume VI for a complete description of thisfunction.</p><P>Result codes</p><p><code>noErr</code>0    Execution has begun</p><p><code>rcDBError</code>    -  -802    Break or abort attempt was unsuccessful</P><p><b>DBGetItem</b></p><p>Parameter block</p><p>-&gt;    00    <code>message</code>    word    routine selector; <code>kDBGetItem</code></p><P>&lt;-&gt;    02    <code>ddevStorage</code>    long     storage for data accessextension</p><P>-&gt;    06    <code>asyncPB</code>    long    pointer to asynch parameter                     block</p><P>-&gt;    10    <code>sessID</code>    long    session ID</p><P>-&gt;    46    <code>buffer</code>    long    pointer to data buffer</p><P>-&gt;    70    <code>timeout</code>    long    timeout value</p><P>&lt;-&gt;    74    <code>dataType</code>    long    data type</p><P>&lt;-&gt;    82    <code>len</code>    word    length of data item</p><P>&lt;-&gt;    84    <code>places</code>    word    decimal places in data item</p><P>&lt;-    86    <code>flags</code>    word    flags</P><p>The <code>DBGetItem</code> function retrieves the next data item from the datasource. See "Retrieving Results" in the Data Access Manager chapter of<i>Inside Macintosh</i> Volume VI for a complete description of this function.Result codes</p><p><code>noErr</code>    0    No error; no next data item</p><p><code>rcDBValue</code>    -801    A nonzero data item was successfully retrieved</p><p><code>rcDBNull</code>    -800    The data item was NULL</p><p><code>rcDBError</code>    -802    No next data item; execution ended in an error</p><p><code>rcDBBadType</code>    -803    Next data item not of requested data type</p><p><code>rcDBBreak</code>    -805    Timed out</p><p><b>DBUnGetItem</b></p><P>Parameter block</p><P>-&gt;    00    <code>message</code>    word    routine selector;<code>kDBUnGetItem</code></p><P>&lt;-&gt;    02    <code>ddevStorage</code>    long     storage for data access extension</p><P>-&gt;    06    <code>asyncPB</code>    long    pointer to asynch parameter                     block</p><P>-&gt;    10    <code>sessID</code>    long    session ID</P><p>The <code>DBUnGetItem</code> function reverses the effect of the last call to the<code>DBGetItem</code> function. See "Retrieving Results" in the Data AccessManager chapter of<i> Inside Macintosh</i> Volume VI for a complete descriptionof this function.Result codes</p><p><code>noErr         </code>0    No error</p><p><code>rcDBError  </code>  -802    Error executing function</p><a name="References"></a><P><A HREF="#top">Back to top</A></P><h2>References</h2><P><i>Inside Macintosh</i>, Volume VI, Data Access Manager chapter</p>                                      <P><A HREF="#top">Back to top</A></P><P><A NAME=Downloads></A></P>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (64K)</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/nw_17.pdf">Download</A></P>               </TD>            </TR>                     </TABLE>         <BR>         <P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/nw/nw_17.html%3Fid%3DDTS10002559-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/nw/nw_17.html%3Fid%3DDTS10002559-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/nw/nw_17.html%3Fid%3DDTS10002559-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>