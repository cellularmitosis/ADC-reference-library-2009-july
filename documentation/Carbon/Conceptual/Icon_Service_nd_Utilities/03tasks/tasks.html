<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Obtaining and Using Icons With Icon Services: Icon Services Tasks</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Icon Services Tasks"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40000916-3" title="Icon Services Tasks"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000420" target="_top">Carbon</a> &gt; <a href="../../../UserExperience-date.html#//apple_ref/doc/uid/TP30000440-TP30000420-TP30000465" target="_top">User Experience</a> &gt; <a href="../01introduction/introduction.html#//apple_ref/doc/uid/TP30000250-DontLinkElementID_1">Obtaining and Using Icons With Icon Services</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../02concepts/concepts.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../appendixa/appendixa.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40000916-3-DontLinkElementID_3" title="Icon Services Tasks"></a><h1><a name="//apple_ref/doc/uid/TP40000916-3-TP9" title="Icon Services Tasks"></a>Icon Services Tasks</h1><p>This chapter outlines basic and advanced tasks that you can perform using Icon Services.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="tasks.html#//apple_ref/doc/uid/TP40000916-3-TPXREF108">Basic Tasks With Icon Services</a>
				
			<br/>
			
        
			
			
				<a href="tasks.html#//apple_ref/doc/uid/TP40000916-3-TPXREF112">Advanced Tasks With Icon Services</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40000916-3-TPXREF108" title="Basic Tasks With Icon Services"></a><h2>Basic Tasks With Icon Services</h2><p>This section describes basic tasks you can perform with Icon Services.</p><a name="//apple_ref/doc/uid/TP40000916-3-BBCHEGAD" title="Obtaining and Releasing IconRefs"></a><h3>Obtaining and Releasing IconRefs</h3><p>In order to call Icon Services functions, your application must <a name="//apple_ref/doc/uid/TP40000916-3-DontLinkElementID_15"></a>obtain an <code>IconRef</code> for the icon data you want to use. There are three functions you can use to accomplish this task; the one you choose depends on how much information you have about the icon you wish to use. If you need an icon from the desktop database or a <a name="//apple_ref/doc/uid/TP40000916-3-DontLinkElementID_16"></a>registered icon (an icon that has been previously identified to Icon Services), the simplest and fastest way to obtain an <code>IconRef</code> is to use the function <code><a href="../../../Reference/IconServices/Reference/reference.html#//apple_ref/doc/c_ref/GetIconRef" target="_top">GetIconRef</a></code>. Icon Services defines a number of constants for non-fileFinder icons, which makes it simple to use the <a name="//apple_ref/doc/uid/TP40000916-3-DontLinkElementID_17"></a><code>GetIconRef</code> function to obtain an <code>IconRef</code> for one of these icons. <span class="content_text">Listing 3-1</span> shows an example of how to obtain an <code>IconRef</code> for the standard Help icon:</p><a name="//apple_ref/doc/uid/TP40000916-3-DontLinkElementID_4" title="Listing 2-1Obtaining an IconRef for the standard help icon"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP40000916-3-BBCEEADD" title="Listing 2-1Obtaining an IconRef for the standard help icon"></a><strong>Listing 2-1&nbsp;&nbsp;</strong>Obtaining an IconRef for the standard help icon</p><div class="codesample"><table><tr><td scope="row"><pre>err = GetIconRef(kOnSystemDisk, kSystemIconsCreator, kHelpIcon,                &amp;iconRef);<span></span></pre></td></tr></table></div><p>If you need an <a name="//apple_ref/doc/uid/TP40000916-3-DontLinkElementID_18"></a><code>IconRef</code> for a folder that you know has no custom icons associated with it, use the function <code><a href="../../../Reference/IconServices/Reference/reference.html#//apple_ref/doc/c_ref/GetIconRefFromFolder" target="_top">GetIconRefFromFolder</a></code>. If you need an <code>IconRef</code> for a file object for which you don’t have any information, use the function <code><a href="../../../Reference/IconServices/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/GetIconRefFromFile" target="_top">GetIconRefFromFile</a></code>.</p><a name="//apple_ref/doc/uid/TP40000916-3-TPXREF109" title="Using IconRefs"></a><h3>Using IconRefs</h3><p>Once you obtain a valid <code>IconRef</code>, you can use Icon Services functions to accomplish two major types of tasks. The first type of task is to draw an icon of the appropriate size and type in a specified area. The second task is checking to see whether the user has clicked on or selected an icon (also known as hit-testing). These functions are designed to be similar to familiar Icon Utilities functions.</p><a name="//apple_ref/doc/uid/TP40000916-3-TPXREF110" title="Drawing Icons"></a><h4>Drawing Icons</h4><a name="//apple_ref/doc/uid/TP40000916-3-DontLinkElementID_19"></a><p>Icon Services provides two basic drawing functions. For the task of drawing an icon directly to the screen, use the function <code><a href="../../../Reference/IconServices/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/PlotIconRef" target="_top">PlotIconRef</a></code>. If you need to convert icon data into a QuickDraw region, use the function <code><a href="../../../Reference/IconServices/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/IconRefToRgn" target="_top">IconRefToRgn</a></code>.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000916-3-DontLinkElementID_5" title="Note"></a><p><strong>Note:</strong>&nbsp;The introduction of <a name="//apple_ref/doc/uid/TP40000916-3-DontLinkElementID_20"></a>deep masks means that you cannot simply draw over an icon and assume the previous icon will be erased. Call the function <code><a href="../../../Reference/IconServices/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/IconRefToRgn" target="_top">IconRefToRgn</a></code> to determine the area occupied by the current icon, erase that area, then draw the new icon.</p></div><a name="//apple_ref/doc/uid/TP40000916-3-TPXREF111" title="Hit-Testing"></a><h4>Hit-Testing</h4><a name="//apple_ref/doc/uid/TP40000916-3-DontLinkElementID_21"></a><p>Icon Services provides several ways to determine whether a user has interacted with an icon. To determine whether a user has clicked on an icon, use the function <code><a href="../../../Reference/IconServices/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/PtInIconRef" target="_top">PtInIconRef</a></code>. If you need to determine whether an icon falls with a given rectangle (like a selection rectangle, for example), use the function <code><a href="../../../Reference/IconServices/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/RectInIconRef" target="_top">RectInIconRef</a></code><code><!--a--><!--/a--></code>. You can also use the function <code><a href="../../../Reference/IconServices/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/IconRefToRgn" target="_top">IconRefToRgn</a></code> to do hit-testing.</p><a name="//apple_ref/doc/uid/TP40000916-3-TPXREF112" title="Advanced Tasks With Icon Services"></a><h2>Advanced Tasks With Icon Services</h2><p>Icon Services gives you several ways to modify the icon data used by Icon Services. You can add icon data to the Icon Services cache by <a name="//apple_ref/doc/uid/TP40000916-3-DontLinkElementID_22"></a>registering icon data with the functions <code><a href="../../../Reference/IconServices/Reference/reference.html#//apple_ref/doc/c_ref/RegisterIconRefFromIconFamily" target="_top">RegisterIconRefFromIconFamily</a></code> or <code><a href="../../../Reference/IconServices/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/RegisterIconRefFromIconFile" target="_top">RegisterIconRefFromIconFile</a></code>. You can also release registered data by using the function <code><a href="../../../Reference/IconServices/Reference/reference.html#//apple_ref/doc/c_ref/UnregisterIconRef" target="_top">UnregisterIconRef</a></code>. You can <a name="//apple_ref/doc/uid/TP40000916-3-DontLinkElementID_23"></a>override existing data in an <code>IconRef</code> and replace it with custom data by using the functions <code><a href="../../../Reference/IconServices/Reference/reference.html#//apple_ref/doc/c_ref/OverrideIconRef" target="_top">OverrideIconRef</a></code> or <code><a href="../../../Reference/IconServices/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/OverrideIconRefFromResource" target="_top">OverrideIconRefFromResource</a></code>. You can also <a name="//apple_ref/doc/uid/TP40000916-3-DontLinkElementID_24"></a>restore the original data in an <code>IconRef</code> by using the function <code><!--a-->RemoveIconOverride<!--/a--></code>.</p><a name="//apple_ref/doc/uid/TP40000916-3-BBCIDHJI" title="Registering Icon Data"></a><h3>Registering Icon Data</h3><p>You can speed up access to frequently-used icon data by registering icons. The preferred way of registering icons is to use the function <code><a href="../../../Reference/IconServices/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/RegisterIconRefFromIconFile" target="_top">RegisterIconRefFromIconFile</a></code>. This will make the icon data purgeable if you need to free up memory later. If you can’t use the <code>RegisterIconRefFromResource</code> function, you can use the function <code><a href="../../../Reference/IconServices/Reference/reference.html#//apple_ref/doc/c_ref/RegisterIconRefFromIconFamily" target="_top">RegisterIconRefFromIconFamily</a></code>. To unregister icon data, use the function <code><a href="../../../Reference/IconServices/Reference/reference.html#//apple_ref/doc/c_ref/UnregisterIconRef" target="_top">UnregisterIconRef</a></code>.</p><a name="//apple_ref/doc/uid/TP40000916-3-TPXREF113" title="Updating IconRefs"></a><h3>Updating IconRefs</h3><p>If you need to refresh <a name="//apple_ref/doc/uid/TP40000916-3-DontLinkElementID_25"></a>icon data without releasing an <code>IconRef</code>, you can use the function <code><a href="../../../Reference/IconServices/Reference/reference.html#//apple_ref/doc/c_ref/UpdateIconRef" target="_top">UpdateIconRef</a></code> to obtain current icon data. This might be useful after you have changed a file’s custom icon, for example.</p><a name="//apple_ref/doc/uid/TP40000916-3-TPXREF114" title="Overriding and Restoring Icon Data"></a><h3>Overriding and Restoring Icon Data</h3><a name="//apple_ref/doc/uid/TP40000916-3-DontLinkElementID_26"></a><p>You may wish to redraw icons on a temporary basis without going to the trouble of obtaining a new <code>IconRef</code>. One example of this is when a user has started to download a file and you want to use partial file icons to represent the various stages of the download process. Icon Services provides two functions to temporarily override the data in an <code>IconRef</code>; the one you choose depends on the source of the data you will use for the override. If you obtain the source data from another <code>IconRef</code>, use the function <code><a href="../../../Reference/IconServices/Reference/reference.html#//apple_ref/doc/c_ref/OverrideIconRef" target="_top">OverrideIconRef</a></code>. If the source data is contained in a resource, use the function <code><a href="../../../Reference/IconServices/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/OverrideIconRefFromResource" target="_top">OverrideIconRefFromResource</a></code>. You can restore the original <a name="//apple_ref/doc/uid/TP40000916-3-DontLinkElementID_27"></a>icon data by using the function <code><!--a-->RemoveIconOverride<!--/a--></code>.</p><a name="//apple_ref/doc/uid/TP40000916-3-TPXREF115" title="Modifying Reference Counts"></a><h3>Modifying Reference Counts</h3><p>You may find it useful to modify the <a name="//apple_ref/doc/uid/TP40000916-3-DontLinkElementID_28"></a>reference count of an <code>IconRef</code> in preference to obtaining multiple <code>IconRefs</code> to the same data. This might be useful when your application maintains multiple instances of the same icon data, such as multiple file-copying operations. Use the function <code><a href="../../../Reference/IconServices/Reference/reference.html#//apple_ref/doc/c_ref/AcquireIconRef" target="_top">AcquireIconRef</a></code> to increment the reference count for an <code>IconRef</code>. This allows you to keep the icon data in the cache without going through the trouble of obtaining additional <code>IconRefs</code>. If you modify the reference count directly, be sure to decrement the reference count as needed by using the function <code><a href="../../../Reference/IconServices/Reference/reference.html#//apple_ref/doc/c_ref/ReleaseIconRef" target="_top">ReleaseIconRef</a></code>.</p><a name="//apple_ref/doc/uid/TP40000916-3-TPXREF116" title="Flushing IconRefs"></a><h3>Flushing IconRefs</h3><p>When you want to free up memory by releasing purgeable icon data from the cache, the preferred method is to use the function <code><a href="../../../Reference/IconServices/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/FlushIconRefs" target="_top">FlushIconRefs</a></code>. You may also use the function <code><a href="../../../Reference/IconServices/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/FlushIconRefsByVolume" target="_top">FlushIconRefsByVolume</a></code>, but this has two potential problems: </p><ol class="ol"><li class="li"><p>The additional scope of the <code>FlushIconRefsByVolume</code> function means it will take longer to complete.</p></li><li class="li"><p>Using the the <code>FlushIconRefsByVolume</code> function makes the icon data of all currently used <code>IconRefs</code> non-purgeable. This means any subsequent efforts to flush icon data will be much less effective.</p></li></ol><a name="//apple_ref/doc/uid/TP40000916-3-TPXREF117" title="Using Badges"></a><h3>Using Badges</h3><p>A badge is an overlay or replacement for an icon. You can use a badge to signify that a folder contains special files, for example. Badges are described by a<code> 'badg' </code>resource you store in a file’s resource fork or a folder’s invisible icon file. <span class="content_text">Figure 3-1</span> shows a folder alias icon displayed in standard form and with a badge.</p><br/><div><a name="//apple_ref/doc/uid/TP40000916-3-DontLinkElementID_6" title="Figure 2-1Folder icons displayed in standard form and with a badge"></a><p><a name="//apple_ref/doc/uid/TP40000916-3-BBCIABCA" title="Figure 2-1Folder icons displayed in standard form and with a badge"></a><strong>Figure 2-1&nbsp;&nbsp;</strong>Folder icons displayed in standard form and with a badge</p><img src = "../art/iss01.gif" alt = "Folder icons displayed in standard form and with a badge" width="165" height="51"></div><br/><p>There are two steps required to use a custom badge with a file object.</p><ul class="spaceabove"><li class="li"><p>Clear the <code>kExtendedFlagsAreInvalid</code> bit and set the <code>kExtendedFlagHasCustomBadge</code> bit in the <code>extendedFinderFlags</code> field of the <code>ExtendedFileInfo</code> structure (if the object is a file) or the <code>ExtendedFolderInfo</code> structure (if the object is a folder). </p></li><li class="li"><p>Add a resource of type <code>kCustomBadgeResourceType</code> (<code>'badg'</code>) and ID <code>kCustomBadgeResourceID</code> to a file’s resource fork or a folder’s icon file.</p></li></ul><p>There are three ways to use the data from a <code>'badg' </code>resource.</p><ol class="ol"><li class="li"><p>The <code>customBadgeType</code> and <code>customBadgeCreator</code> fields let you designate a custom badge to display on top of another icon, as shown in <span class="content_text"><a href="tasks.html#//apple_ref/doc/uid/TP40000916-3-BBCIABCA">Figure 3-1</a></span>.</p></li><li class="li"><p>The <code>windowBadgeType</code> and <code>windowBadgeCreator</code> fields let you designate which icon to display in Finder window header of the badged file or folder.</p></li><li class="li"><p>The <code>overrideType</code> and <code>overrideCreator</code> fields let you designate the badge as a replacement for the standard icon for this file or folder.</p></li></ol><p>The type and creator codes specified in a<code>'badg' </code>resource must be registered with Icon Services before you can use the badge. For more information, see <span class="content_text"><a href="tasks.html#//apple_ref/doc/uid/TP40000916-3-BBCIDHJI">“Registering Icon Data.”</a></span></p><p>If you supply a custom icon resource for a badge, Icon Services will use it in preference to other available data. For a complete description of the badge resource, see <code>'badg'</code>.</p><a name="//apple_ref/doc/uid/TP40000916-3-TPXREF118" title="Guidelines for Designing Icons"></a><h3>Guidelines for Designing Icons</h3><p>Here are some guidelines to follow if you choose to design custom icons for use with Icon Services.</p><ul class="spaceabove"><li class="li"><p>You must provide at least one of the following icon types: <code>'ICN#'</code>, <code>'ics#'</code>, or <code>'icl#'</code>.</p></li><li class="li"><p>If you provide a deep mask, all of the non-transparent pixels in the deep mask should correspond to a black pixel in the black-and-white mask. This is important for hit-testing and proper erasing and drawing of the icon.</p></li><li class="li"><p>If you provide 32-bit icon data, you should also provide an 8-bit version of the icon. This ensures that the icon can be displayed on an 8-bit display without unwanted dithering.</p></li><li class="li"><p>8-bit icon data is no longer limited to the 34 colors of the classic icon color palette. All 256 colors from the System palette are available.</p></li><li class="li"><p>4-bit icons are still supported. However, the 4-bit display configuration is rarely used and often unsupported, so we recommend that you do not provide 4-bit icon data. If you don’t provide 4-bit icon data, Icon Services will use black-and-white icon data instead.</p></li></ul>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../02concepts/concepts.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../appendixa/appendixa.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2003 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2003-02-01<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Carbon/Conceptual/Icon_Service_nd_Utilities/03tasks/tasks.html%3Fid%3DTP40000916-2.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Carbon/Conceptual/Icon_Service_nd_Utilities/03tasks/tasks.html%3Fid%3DTP40000916-2.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Carbon/Conceptual/Icon_Service_nd_Utilities/03tasks/tasks.html%3Fid%3DTP40000916-2.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>