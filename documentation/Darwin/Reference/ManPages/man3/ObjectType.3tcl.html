<html><head><title>Mac OS X
 Manual Page For ObjectType(3tcl)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/3tcl/ObjectType" title="Mac OS X
 Manual Page for ObjectType(3tcl)"><a name="//apple_ref/doc/man/3/ObjectType" title="Mac OS X
 Manual Page for ObjectType(3tcl)"><!-- headerDoc=man; indexgroup=Section 3tcl; uid="//apple_ref/doc/man/3tcl/ObjectType"; name=ObjectType(3tcl) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
Tcl_ObjType(3)                             Tcl Library Procedures                             <!-- a -->Tcl_ObjType(3)<!-- /a -->



____________________________________________________________________________________________________________

<b>NAME</b>
       Tcl_RegisterObjType,  Tcl_GetObjType,  Tcl_AppendAllObjTypes,  Tcl_ConvertToType   -  manipulate  Tcl
       object types

<b>SYNOPSIS</b>
       <b>#include</b> <b>&lt;tcl.h&gt;</b>

       <b>Tcl_RegisterObjType</b>(<u>typePtr</u>)

       Tcl_ObjType *
       <b>Tcl_GetObjType</b>(<u>typeName</u>)

       int
       <b>Tcl_AppendAllObjTypes</b>(<u>interp,</u> <u>objPtr</u>)

       int
       <b>Tcl_ConvertToType</b>(<u>interp,</u> <u>objPtr,</u> <u>typePtr</u>)

<b>ARGUMENTS</b>
       Tcl_ObjType   <u>*typePtr</u>    (in)      Points to the structure  containing  information  about  the  Tcl
                                           object  type.  This storage must live forever, typically by being
                                           statically allocated.

       CONST char    <u>*typeName</u>   (in)      The name of a Tcl object type that <b>Tcl_GetObjType</b> should look up.

       Tcl_Interp    <u>*interp</u>     (in)      Interpreter to use for error reporting.

       Tcl_Obj       <u>*objPtr</u>     (in)      For  <b>Tcl_AppendAllObjTypes</b>,  this points to the object onto which
                                           it appends the name of each object type as a list  element.   For
                                           <b>Tcl_ConvertToType</b>,  this  points to an object that must have been
                                           the result of a previous call to <b>Tcl_NewObj</b>.
____________________________________________________________________________________________________________


<b>DESCRIPTION</b>
       The procedures in this man page manage Tcl object types.  The are used to register new object  types,
       look up types, and force conversions from one type to another.

       <b>Tcl_RegisterObjType</b>  registers  a  new  Tcl object type in the table of all object types supported by
       Tcl.  The argument <u>typePtr</u> points to a Tcl_ObjType structure that describes the new  type  by  giving
       its  name  and  by  supplying pointers to four procedures that implement the type.  If the type table
       already contains a type with the same name as in <u>typePtr</u>, it is replaced  with  the  new  type.   The
       Tcl_ObjType structure is described in the section <b>THE</b> <b>TCL_OBJTYPE</b> <b>STRUCTURE</b> below.

       <b>Tcl_GetObjType</b>  returns  a pointer to the Tcl_ObjType with name <u>typeName</u>.  It returns NULL if no type
       with that name is registered.

       <b>Tcl_AppendAllObjTypes</b> appends the name of each object type as a list element onto the Tcl object ref-<font color="#ffffff" class="whiteout">erenced&nbsp;referenced</font>
       erenced  by <u>objPtr</u>.  The return value is <b>TCL_OK</b> unless there was an error converting <u>objPtr</u> to a list
       object; in that case <b>TCL_ERROR</b> is returned.

       <b>Tcl_ConvertToType</b> converts an object from one type to another if possible.  It creates a new internal
       representation for <u>objPtr</u> appropriate for the target type <u>typePtr</u> and sets its <u>typePtr</u> member to that
       type.  Any internal representation for <u>objPtr</u>'s old type is freed.  If an error occurs during conver-<font color="#ffffff" class="whiteout">sion,&nbsp;conversion,</font>
       sion,  it returns <b>TCL_ERROR</b> and leaves an error message in the result object for <u>interp</u> unless <u>interp</u>
       is NULL.  Otherwise, it returns <b>TCL_OK</b>.  Passing a NULL <u>interp</u> allows this procedure to be used as  a
       test whether the conversion can be done (and in fact was done).


<b>THE</b> <b>TCL_OBJTYPE</b> <b>STRUCTURE</b>
       Extension writers can define new object types by defining four procedures, initializing a Tcl_ObjType
       structure to describe the type,  and  calling  <b>Tcl_RegisterObjType</b>.   The  <b>Tcl_ObjType</b>  structure  is
       defined as follows:
              typedef struct Tcl_ObjType {
                char *<u>name</u>;
                Tcl_FreeInternalRepProc *<u>freeIntRepProc</u>;
                Tcl_DupInternalRepProc *<u>dupIntRepProc</u>;
                Tcl_UpdateStringProc *<u>updateStringProc</u>;
                Tcl_SetFromAnyProc *<u>setFromAnyProc</u>;
              } Tcl_ObjType;

       The  <u>name</u>  member  describes the name of the type, e.g. <b>int</b>.  Extension writers can look up an object
       type using its name with the <b>Tcl_GetObjType</b> procedure.  The remaining four members  are  pointers  to
       procedures called by the generic Tcl object code:

       The <u>setFromAnyProc</u> member contains the address of a function called to create a valid internal repre-<font color="#ffffff" class="whiteout">sentation&nbsp;representation</font>
       sentation from an object's string representation.
              typedef int (Tcl_SetFromAnyProc) (Tcl_Interp *<u>interp</u>, Tcl_Obj *<u>objPtr</u>);
       If an internal representation can't be created from the string, it returns <b>TCL_ERROR</b> and puts a  mes-<font color="#ffffff" class="whiteout">sage&nbsp;message</font>
       sage  describing  the error in the result object for <u>interp</u> unless <u>interp</u> is NULL.  If <u>setFromAnyProc</u>
       is successful, it stores the new internal representation, sets <u>objPtr</u>'s <u>typePtr</u> member  to  point  to
       <u>setFromAnyProc</u>'s  <b>Tcl_ObjType</b>,  and  returns <b>TCL_OK</b>.  Before setting the new internal representation,
       the <u>setFromAnyProc</u> must free any internal representation of <u>objPtr</u>'s old type; it does this by  call-<font color="#ffffff" class="whiteout">ing&nbsp;calling</font>
       ing  the  old  type's  <u>freeIntRepProc</u>  if  it is not NULL.  As an example, the <u>setFromAnyProc</u> for the
       builtin Tcl integer type gets an up-to-date string representation  for  <u>objPtr</u>  by  calling  <b>Tcl_Get</b>-<font color="#ffffff" class="whiteout">StringFromObj.&nbsp;Tcl_GetStringFromObj.</font>
       <b>StringFromObj</b>.   It  parses the string to obtain an integer and, if this succeeds, stores the integer
       in <u>objPtr</u>'s internal representation and sets <u>objPtr</u>'s <u>typePtr</u> member to point to the  integer  type's
       Tcl_ObjType  structure.   Do  not  release <u>objPtr</u>'s old internal representation unless you replace it
       with a new one or reset the <u>typePtr</u> member to NULL.

       The <u>updateStringProc</u> member contains the address of a function called to create a valid string repre-<font color="#ffffff" class="whiteout">sentation&nbsp;representation</font>
       sentation from an object's internal representation.
              typedef void (Tcl_UpdateStringProc) (Tcl_Obj *<u>objPtr</u>);
       <u>objPtr</u>'s  <u>bytes</u>  member  is  always NULL when it is called.  It must always set <u>bytes</u> non-NULL before
       returning.  We require the string representation's byte array to have a null after the last byte,  at
       offset  <u>length</u>;  this  allows  string representations that do not contain null bytes to be treated as
       conventional null character-terminated C strings.  Storage for the byte array must  be  allocated  in
       the  heap  by <b>Tcl_Alloc</b> or <b>ckalloc</b>.  Note that <u>updateStringProc</u>s must allocate enough storage for the
       string's bytes and the terminating null byte.  The <u>updateStringProc</u> for Tcl's builtin list type,  for
       example,  builds  an array of strings for each element object and then calls <b>Tcl_Merge</b> to construct a
       string with proper Tcl list structure.  It stores this string as the list object's string representa-<font color="#ffffff" class="whiteout">tion.&nbsp;representation.</font>
       tion.

       The <u>dupIntRepProc</u> member contains the address of a function called to copy an internal representation
       from one object to another.
              typedef void (Tcl_DupInternalRepProc) (Tcl_Obj *<u>srcPtr</u>, Tcl_Obj *<u>dupPtr</u>);
       <u>dupPtr</u>'s internal representation is made a copy of  <u>srcPtr</u>'s  internal  representation.   Before  the
       call, <u>srcPtr</u>'s internal representation is valid and <u>dupPtr</u>'s is not.  <u>srcPtr</u>'s object type determines
       what copying its internal representation means.  For example, the <u>dupIntRepProc</u> for the  Tcl  integer
       type  simply  copies  an  integer.   The builtin list type's <u>dupIntRepProc</u> allocates a new array that
       points at the original element objects; the elements are shared between the two lists (and their ref-<font color="#ffffff" class="whiteout">erence&nbsp;reference</font>
       erence counts are incremented to reflect the new references).

       The  <u>freeIntRepProc</u> member contains the address of a function that is called when an object is freed.
              typedef void (Tcl_FreeInternalRepProc) (Tcl_Obj *<u>objPtr</u>);
       The <u>freeIntRepProc</u> function can deallocate the storage for the object's internal  representation  and
       do  other  type-specific processing necessary when an object is freed.  For example, Tcl list objects
       have an <u>internalRep.otherValuePtr</u> that points to an array of pointers to each element  in  the  list.
       The list type's <u>freeIntRepProc</u> decrements the reference count for each element object (since the list
       will no longer refer to those objects), then deallocates the storage for the array of pointers.   The
       <u>freeIntRepProc</u>  member  can  be  set  to  NULL  to indicate that the internal representation does not
       require freeing.


<b>SEE</b> <b>ALSO</b>
       Tcl_NewObj, Tcl_DecrRefCount, Tcl_IncrRefCount


<b>KEYWORDS</b>
       internal representation, object, object type, string representation, type conversion



Tcl                                                  8.0                                      <!-- a -->Tcl_ObjType(3)<!-- /a -->
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man3/ObjectType.3tcl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man3/ObjectType.3tcl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man3/ObjectType.3tcl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
