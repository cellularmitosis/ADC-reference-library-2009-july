<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>About Recordable Applications(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING317></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-316.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-318.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-316.html"><B>Chapter 9 - Recording Apple Events</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING317-0></A>
<H1><A NAME=MARKER-9-4></A>About Recordable Applications</H1>
 <A NAME=MARKER-2-164></A>A <B>recordable application</B> is an application that uses Apple events to report user actions to the Apple Event Manager for recording purposes. One way to do this is to separate the code that implements your application's user interface from the code that actually performs work when the user manipulates the interface. This is called <B>factoring</B> your application. A factored application translates low-level events generated by the user into recordable Apple events that the application sends to itself to perform tasks.<P>
 A <B>recordable event</B> is any Apple event that any recordable application sends to itself while recording is turned on for the local computer, with the exception of events that are sent with the <CODE>kAEDontRecord</CODE> flag set in the <CODE>sendMode</CODE> parameter of <CODE>AESend</CODE>. A<B> recording process</B> is any process (for example, the Script Editor application) that can turn recording on and off and can receive and record recordable Apple events. <A NAME=MARKER-21-79></A><P>
 After Apple event recording has been turned on by a recording process, the Apple Event Manager sends that process copies of all recordable Apple events on the local computer. For example, when a user presses the Record button in the Script Editor application, it calls a scripting component routine to turn on recording for the AppleScript component (or any other scripting component). While recording is on, the Apple Event Manager sends Script Editor copies of all subsequent recordable Apple events, which Script Editor records (with the aid of the scripting component) in the form of a compiled script. After turning off recording from Script Editor, the user can edit or execute the recorded script.<P>
 Although factoring your application is the recommended method of making your application recordable, it is also possible to report user actions by means of Apple events only when Apple event recording is turned on, even though the application may respond to those actions by some means other than Apple events. In effect, the application uses Apple events to describe user actions without actually using the events to perform the action. To indicate that you want the Apple Event Manager to send a copy of a recordable event to the recording process without actually sending the event to your application, add the constant <CODE>kAEDontExecute</CODE> to the <CODE>sendMode</CODE> parameter of the <CODE>AESend</CODE> function.<P>
 Even in a factored application, it may not always be possible to send an Apple event that actually executes the task initiated by the user. For example, if the user types some text, it is more practical to use standard TextEdit or QuickDraw routines to draw the text than to send a separate Apple event each time the user presses a key. In this case, the application can draw the text as it is typed in the most convenient manner available; then, when the user finishes typing a sequence of characters--by clicking the mouse button while the cursor is somewhere else in the document or performing some other action--the application can create an Apple event that corresponds to the typing and add the constant <CODE>kAEDontExecute</CODE> to the <CODE>sendMode</CODE> parameter when it sends the Apple event. <P>
 <A NAME=MARKER-9-7></A>If your application needs to know when Apple event recording is turned on and off, it should install handlers for the Recording On and Recording Off events.
<TABLE BORDER="0" CELLPADDING=3><TH colspan=2>Recording On--perform actions associated with beginning of recording session <A NAME=MARKER-2-20></A><TR>
<TD>Event class<TD>kCoreEventClass<TR>
<TD>Event ID<TD>kAENotifyStartRecording<TR>
<TD>Parameters<TD>None<TR>
<TD>Description<TD>Sent by the Apple Event Manager to all running processes on the local computer to inform them that recording has been turned on</TABLE>

<TABLE BORDER="0" CELLPADDING=3><TH colspan=2>Recording Off--perform actions associated with end of recording session <A NAME=MARKER-9-286></A><TR>
<TD>Event class<TD>kCoreEventClass<TR>
<TD>Event ID<TD>kAENotifyStopRecording<TR>
<TD>Parameters<TD>None<TR>
<TD>Description<TD>Sent by the Apple Event Manager to all running processes on the local computer to inform them that recording has been turned off</TABLE>
<P>
 When a recording process turns on recording, the Apple Event Manager sends all running processes on the local computer a Recording On event. When a user turns off recording, the Apple Event Manager sends all running processes the Recording Off event with the <CODE>kAEWaitReply</CODE> flag set. If an application has stored some data (for instance, keystrokes) that needs to be recorded as an Apple event, this is the last chance to send an event for recording purposes. If your application needs to know which recording process has turned recording on or off, it can check the <CODE>keyOriginalAddressAttr</CODE> attribute of the Recording On or Recording Off event for the address of the recording process. <P>
 Factoring your application is the recommended method of making your application recordable because it guarantees that any action a user can perform via your application's user interface can also be accomplished via Apple events. Factoring also allows you to avoid duplicating code within your application. Instead of using one piece of code to respond to some user action within your application, and another piece of code to respond to the equivalent Apple event, you can use the same code to respond to the Apple event, whether it is sent by your application in response to a user action, by some other application, or by a scripting component in the course of executing a script. <P>
 The next section, <A HREF=IAC-318.html#MARKER-9-9>"Factoring Your Application for Recording,"</A> provides some examples of how to go about factoring your application. Regardless of how you factor your application, making it recordable requires you to make decisions about the most useful methods of recording user actions that can be described in several different ways in scripts. If a user moves a window, for example, the window can be described in the corresponding recorded script as <CODE>window 1</CODE>, or <CODE>the window named Fred</CODE>, or <CODE>the first window</CODE>. Although the OSA permits recording at a high level and thus avoids many of the problems users encounter with applications that record low-level events such as keystrokes and mouse clicks, scripting components cannot predict what information a user cares about in a given situation. Therefore, a recordable application should send Apple events that correspond to the simplest possible statements in a scripting language. <A HREF=IAC-321.html#MARKER-9-38>"What to Record,"</A> which begins on <A HREF=IAC-321.html#MARKER-9-38>page 9-14</A>, provides some general guidelines for making these kinds of decisions.<P>
 <A HREF=IAC-330.html#MARKER-9-46>"How Apple Event Recording Works,"</A> which begins on <A HREF=IAC-330.html#MARKER-9-46>page 9-35</A>, describes the Apple Event Manager's recording mechanism in more detail, including the role of the Recording On and Recording Off events. <A NAME=MARKER-21-170></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-316.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-318.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
