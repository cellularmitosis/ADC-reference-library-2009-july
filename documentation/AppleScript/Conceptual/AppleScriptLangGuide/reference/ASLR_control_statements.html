<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>AppleScript Language Guide: Control Statements Reference</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Control Statements Reference"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40000983-CH6g" title="Control Statements Reference"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../ScriptingAutomation/index.html#//apple_ref/doc/uid/TP30000440-TP40005948" target="_top">Scripting &amp; Automation</a> &gt; <a href="../../../../ScriptingAutomation/AppleScript-date.html#//apple_ref/doc/uid/TP30000440-TP40005948-TP30000481" target="_top">AppleScript</a> &gt; <a href="../index.html" target="_top">AppleScript Language Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="ASLR_operators.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="ASLR_handlers.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40000983-CH6g-157332" title="Control Statements Reference"></a><h1>Control Statements Reference</h1>
<p><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_820"></a>This chapter describes AppleScript control statements. A <strong>control statement</strong> is a statement that determines when and how other statements are executed or how expressions are evaluated. For example, a control statement may cause AppleScript to skip or repeat certain statements.</p><p><strong>Simple statements</strong> can be written on one line, while <strong>compound statements</strong> can contain other statements, including multiple clauses with nested and multi-line statements. A compound statement is known as a <strong>statement block</strong>.</p><p>Compound statements begin with one or more reserved words, such as <code>tell</code>, that identify the type of control statement. The last line of a compound statement always starts with <code>end</code>, and can optionally include the word that begins the control statement (such as <code>end tell</code>).</p>


<!-- This template is being used for both PDF and HTML. -->
<!-- TopicBook.pm currently relies on the element name bmini_toc. -->

    <h4>Contents:</h4>
    
    <p class="blockquote">

        
			
            
                <a href="ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-130224">considering and ignoring Statements</a>
                
            <br/>
            
        
			
            
                <a href="ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-129657">error Statements</a>
                
            <br/>
            
        
			
            
                <a href="ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-158244">if Statements</a>
                
            <br/>
            
        
			
            
                <a href="ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-127362">repeat Statements</a>
                
            <br/>
            
        
			
            
                <a href="ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-158637">tell Statements</a>
                
            <br/>
            
        
			
            
                <a href="ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-128973">try Statements</a>
                
            <br/>
            
        
			
            
                <a href="ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-SW3">using terms from Statements</a>
                
            <br/>
            
        
			
            
                <a href="ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-130992">with timeout Statements</a>
                
            <br/>
            
        
			
            
                <a href="ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-131273">with transaction Statements</a>
                
            <br/>
            
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40000983-CH6g-130224" title="considering and ignoring Statements"></a><h3>considering and ignoring Statements</h3>
<p><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_821"></a>The <code>considering</code> and <code>ignoring</code> statements cause AppleScript to consider or ignore specific characteristics as it executes groups of statements. There are two kinds of <code>considering</code> and <code>ignoring</code> statements:</p><ul class="ul"><li class="li"><p>Those that specify attributes to be considered or ignored in performing text comparisons.</p></li><li class="li"><p>Those that specify whether AppleScript should consider or ignore responses from an application.</p></li></ul>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-159879" title="considering / ignoring (text comparison)"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_822"></a><div class="content_ref_head_code">considering / ignoring (text comparison)</div>
<p><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_823"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_824"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_825"></a>Specify how AppleScript should treats attributes, such as case, in performing text comparisons.</p>
<h5>Syntax</h5><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%" scope="row"><pre>
<code>considering </code><i class="force_italic">attribute</em> [, <i class="force_italic">attribute</em> ... <code>and</code> <i class="force_italic">attribute</em> ] ¬<br/>
   [ <code>but ignoring</code> <i class="force_italic">attribute</em> [, <i class="force_italic">attribute</em> ... <code>and</code> <i class="force_italic">attribute</em> ] ]<br/>
      [ <i class="force_italic">statement</em> ]...<br/>
<code>end considering</code><br/><br/>
<code>ignoring</code> <i class="force_italic">attribute</em> [, <i class="force_italic">attribute</em> ... <code>and</code> <i class="force_italic">attribute</em> ] ¬<br/>
   [ <code>but considering</code> <i class="force_italic">attribute</em> [, <i class="force_italic">attribute</em> ... <code>and</code> <i class="force_italic">attribute</em> ] ]<br/>
      [ <i class="force_italic">statement</em> ]...<br/>
<code>end ignoring</code><br/></pre></td></tr></table>
<h5>Placeholders</h5><dl>
<dt><em>attribute</em></dt>
<dd class="content_text"><p>A characteristic of the text:</p>
<dl class="termdef">	
<dt><code>case</code></dt>
<dd><p>If this attribute is ignored, uppercase letters are not distinguished from lowercase letters. See Special Considerations below for related information. See also <code><a href="ASLR_operators.html#//apple_ref/doc/uid/TP40000983-CH5g-124619">greater than, less than</a></code> for a description of how AppleScript sorts letters, punctuation, and other symbols.<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_826"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_827"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_828"></a></p></dd>
<dt><code>diacriticals</code></dt>
<dd><p>If this attribute is ignored, <code>text</code> objects are compared as if no diacritical marks (such as ´, `, ˆ, ¨, and ˜) are present; for example, <code>"résumé"</code> is equal to <code>"resume"</code>.<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_829"></a></p></dd><dt><code>hyphens</code></dt><dd><p>If this attribute is ignored, <code>text</code> objects are compared as if no hyphens are present; for example <code>"anti-war"</code> is equal to <code>"antiwar"</code>. <a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_830"></a></p></dd>
<dt><code>numeric strings</code></dt>
<dd><p>By default, this attribute is ignored, and text strings are compared according to their character values. For example, if this attribute is considered, <code>"1.10.1" > "1.9.4"</code> evaluates as <code>true</code>; otherwise it evaluates as <code>false</code>. This can be useful in comparing version strings.<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_831"></a></p></dd>
<dt><code>punctuation</code></dt>
<dd><p>If this attribute is ignored,<code>text</code> objects are compared as if no punctuation marks (such as <code>. , ? : ; ! ' " `</code>) are present; for example <code>"What? he inquired."</code> is equal to <code>"what he inquired"</code>. <a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_832"></a></p></dd>
<dt><code>white space</code></dt>
<dd><p>If this attribute is ignored, the <code>text</code> objects are compared as if spaces, tab characters, and return characters were not present; for example <code>"Brick house"</code> would be considered equal to <code>"Brickhouse"</code>.<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_833"></a></p></dd></dl><dl><dt><em>Default Value:</em></dt><dd class="content_text">Case and numeric strings are ignored; all others are considered.</dd></dl></dd><dt><em>statement</em></dt>
<dd class="content_text"><p>Any AppleScript statement.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_178" title="Examples"></a><h5>Examples</h5><p>The following examples show how <code>considering</code> and <code>ignoring</code> statements for various attributes can change the value of text comparisons.</p>
<div class="codesample"><table><tr><td scope="row"><pre>"Hello Bob" = "HelloBob" --result: false<span></span></pre></td></tr><tr><td scope="row"><pre>ignoring white space<span></span></pre></td></tr><tr><td scope="row"><pre>    "Hello Bob" = "HelloBob" --result: true<span></span></pre></td></tr><tr><td scope="row"><pre>end ignoring<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>"BOB" = "bob" --result: true<span></span></pre></td></tr><tr><td scope="row"><pre>considering case<span></span></pre></td></tr><tr><td scope="row"><pre>    "BOB" = "bob" --result: false<span></span></pre></td></tr><tr><td scope="row"><pre>end considering<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>"a" = "á" --result: false<span></span></pre></td></tr><tr><td scope="row"><pre>ignoring diacriticals<span></span></pre></td></tr><tr><td scope="row"><pre>    "a" = "á" --result: true<span></span></pre></td></tr><tr><td scope="row"><pre>end considering<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>"Babs" = "bábs" --result: false<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>ignoring case<span></span></pre></td></tr><tr><td scope="row"><pre>    "Babs" = "bábs" --result: false<span></span></pre></td></tr><tr><td scope="row"><pre>end ignoring<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>ignoring case and diacriticals<span></span></pre></td></tr><tr><td scope="row"><pre>    "Babs" = "bábs" --result: true<span></span></pre></td></tr><tr><td scope="row"><pre>end ignoring<span></span></pre></td></tr></table></div>
<h5 class="tight">Discussion</h5>
<p>You can nest <code>considering</code> and <code>ignoring</code> statements. If the same attribute appears in both an outer and inner statement, the attribute specified in the inner statement takes precedence.<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_834"></a> When attributes in an inner <code>considering</code> or <code>ignoring</code> statement are different from those in outer statements, they are added to the attributes to be considered and ignored.</p><h5 class="tight">Special Considerations</h5><p>Because <code>text item delimiters</code> (described in <span class="content_text"><a href="../conceptual/ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW6">“version”</a></span>) respect <code>considering</code> and <code>ignoring</code> attributes in AppleScript 2.0, delimiters are case-insensitive by default. Formerly, they were always case-sensitive. To enforce the previous behavior, add an explicit <code>considering case</code> statement.</p><a name="//apple_ref/doc/uid/TP40000983-CH6g-SW2" title="considering / ignoring (application responses)"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_835"></a><div class="content_ref_head_code">considering / ignoring (application responses)</div><p><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_836"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_837"></a>Permits a script to continue without waiting for an application to respond to commands that target it.</p><h5>Syntax</h5><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%" scope="row"><pre><code>considering | ignoring</code>  <code>application responses</code><br/>   [ <i class="force_italic">statement</em> ]...<br/><code>end</code> [ <code>considering | ignoring</code> ]<br/></pre></td></tr></table><h5>Placeholders</h5><dl><dt><em>statement</em></dt><dd class="content_text"><p>Any AppleScript statement.</p></dd></dl><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_179" title="Examples"></a><h5>Examples</h5><p>The following example shows how to use an ignoring statement so that a script needn’t wait while Finder is performing a potentially lengthy task:</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "Finder"<span></span></pre></td></tr><tr><td scope="row"><pre>    ignoring application responses<span></span></pre></td></tr><tr><td scope="row"><pre>        empty the trash<span></span></pre></td></tr><tr><td scope="row"><pre>    end ignoring<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>Your script may want to ignore most responses from an application, but wait for a response to a particular statement. You can do so by nesting <code>considering</code> and <code>ignoring</code> statements:</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "Finder"<span></span></pre></td></tr><tr><td scope="row"><pre>    ignoring application responses<span></span></pre></td></tr><tr><td scope="row"><pre>        empty the trash<span></span></pre></td></tr><tr><td scope="row"><pre>        -- other statements that ignore application responses<span></span></pre></td></tr><tr><td scope="row"><pre>        considering application responses<span></span></pre></td></tr><tr><td scope="row"><pre>            set itemName to name of first item of startup disk<span></span></pre></td></tr><tr><td scope="row"><pre>        end considering<span></span></pre></td></tr><tr><td scope="row"><pre>        -- other statements that ignore application responses<span></span></pre></td></tr><tr><td scope="row"><pre>    end ignoring<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><h5 class="tight">Discussion</h5><p>A response to an application command indicates whether the command completed successfully, and also returns results and error messages, if there are any. When you use an <code>ignoring application responses</code> block, you forego this information.</p><p>Results and error messages from AppleScript commands, scripting additions, and expressions are not affected by the <code>application responses</code> attribute.</p>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-129657" title="error Statements"></a><h3>error Statements</h3>
<p><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_838"></a>During script execution, errors can occur in the operating system (for example, when a specified file isn’t found), in an application (for example, when the script specifies an object that doesn’t exist), and in the script itself. An <a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_839"></a><strong>error message</strong> is a message that is supplied by an application, AppleScript, or Mac OS X when an error occurs during the handling of a command. An error message can include an <a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_840"></a><strong>error number</strong>, which is an integer that identifies the error; an <a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_841"></a><strong>error expression</strong>, which is an expression, usually a <code>text</code> object, that describes the error; and other information.</p><p>A script can signal an error—which can then be handled by an error handler—with the <code>error</code> statement. This allows scripts to supply their own messages for errors that occur within the script. For example, a script can prepare to handle anticipated errors by using a <code><a href="ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-129232">try</a></code> statement. In the <code>on error</code> branch of a <code>try</code> statement, a script may be able to recover gracefully from the error. If not, it can use an <code>error</code> statement to resignal the error message it receives, modifying the message as needed to supply information specific to the script.</p>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-129678" title="error"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_842"></a><div class="content_ref_head_code">error</div>
<p>Signals an error in a script.</p>
<h5>Syntax</h5><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%" scope="row"><pre>
<code>error</code> [ <i class="force_italic">errorMessage</em> ] [ <code>number</code> <i class="force_italic">errorNumber</em> ] ¬<br/>   [ <code>partial result</code><i class="force_italic">resultList</em> ] ¬<br/>   [ <code>from</code> <i class="force_italic">offendingObject</em> ] [ <code>to</code> <i class="force_italic">expectedType</em> ]<br/></pre></td></tr></table>
<h5>Placeholders</h5><dl><dt><em>errorMessage</em></dt>
<dd class="content_text"><p>A <code>text</code> object describing the error. Although this parameter is optional, you should provide descriptions for errors wherever possible. If you do not include an error description, an empty <code>text</code> object ("") is passed to the error handler.</p></dd>
<dt><em>errorNumber</em></dt>
<dd class="content_text"><p>The error number for the error. This is an optional parameter. If you do not include a number parameter, the value -2700 (unknown error) is passed to the error handler.</p><p>If the error you are signaling is a close match for one that already has an AppleScript error constant, you can use that constant. If you need to create a new number for the error, avoid using one that conflicts with error numbers defined by AppleScript, Mac OS X, and the Apple Event Manager. In general, you should use positive numbers from 500 to 10,000. For more information, see <span class="content_text"><a href="ASLR_error_codes.html#//apple_ref/doc/uid/TP40000983-CH220-SW5">“Error Numbers and Error Messages.”</a></span></p></dd>
<dt><em>resultList</em></dt>
<dd class="content_text"><p>A list of objects. Applies only to commands that return results for multiple objects. If results for some, but not all, of the objects specified in the command are available, you can include them in the partial result parameter. This is rarely supported by applications.</p></dd>
<dt><em>offendingObject</em></dt>
<dd class="content_text"><p>A reference to the object, if any, that caused the error.</p></dd>
<dt><em>expectedType</em></dt>
<dd class="content_text"><p>A class. If a parameter specified in the command was not of the expected class, and AppleScript was unable to coerce it to the expected class, then you can include the expected class in the <code>to</code> parameter.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_180" title="Examples"></a><h5>Examples</h5>
<p>The following example uses a <code><a href="ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-129232">try</a></code> statement to handle a simple error, and demonstrates how you can use an <code>error</code> statement to catch an error, then resignal the error exactly as it was received, causing AppleScript to display an error dialog (and halt execution):</p>
<div class="codesample"><table><tr><td scope="row"><pre>try<span></span></pre></td></tr><tr><td scope="row"><pre>    word 5 of "one two three"<span></span></pre></td></tr><tr><td scope="row"><pre>on error eStr number eNum partial result rList from badObj to expectedType<span></span></pre></td></tr><tr><td scope="row"><pre>    -- statements that take action based on the error<span></span></pre></td></tr><tr><td scope="row"><pre>    display dialog "Doing some preliminary handling..."<span></span></pre></td></tr><tr><td scope="row"><pre>    -- then resignal the error<span></span></pre></td></tr><tr><td scope="row"><pre>    error eStr number eNum partial result rList from badObj to expectedType<span></span></pre></td></tr><tr><td scope="row"><pre>end try<span></span></pre></td></tr></table></div>
<p>In the next example, an <code>error</code> statement resignals an error, but omits any original error information and supplies its own message to appear in the error dialog:</p>
<div class="codesample"><table><tr><td scope="row"><pre>try<span></span></pre></td></tr><tr><td scope="row"><pre>    word 5 of "one two three"<span></span></pre></td></tr><tr><td scope="row"><pre>on error<span></span></pre></td></tr><tr><td scope="row"><pre>    -- statements to execute in case of error<span></span></pre></td></tr><tr><td scope="row"><pre>    error "There are not enough words."<span></span></pre></td></tr><tr><td scope="row"><pre>end try<span></span></pre></td></tr></table></div><p>For more comprehensive examples, see <span class="content_text"><a href="ASLR_error_xmpls.html#//apple_ref/doc/uid/TP40000983-CH221-SW1">“Working with Errors.”</a></span></p>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-158244" title="if Statements "></a><h3>if Statements </h3>
<p>An <code>if</code> statement allows you to define statements or groups of statements that are executed only in specific circumstances, based on the evaluation of one or more Boolean expressions.<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_843"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_844"></a></p>
<p>An <code>if</code> statement is also called a conditional statement. Boolean expressions in <code>if</code> statements are also called tests.<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_845"></a></p>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-126990" title="if (simple)"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_846"></a><div class="content_ref_head_code">if (simple)</div>
<p>Executes a statement if a Boolean expression evaluates to <code>true</code>.</p>
<h5>Syntax</h5><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%" scope="row"><pre>
<code>if</code> <i class="force_italic">boolean</em> <code>then</code> <i class="force_italic">statement</em> <br/></pre></td></tr></table>
<h5>Placeholders</h5><dl><dt><em>boolean</em></dt>
<dd class="content_text"><p>A Boolean expression.</p></dd>
<dt><em>statement</em></dt>
<dd class="content_text"><p>Any AppleScript statement.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_181" title="Examples"></a><h5>Examples</h5>
<p>This script displays a dialog if the value of the Boolean expression <code>ageOfCat > 1</code> is <code>true</code>. (The variable <code>ageOfCat</code> is set previously.)</p>
<div class="codesample"><table><tr><td scope="row"><pre>if ageOfCat > 1 then display dialog "This is not a kitten."<span></span></pre></td></tr></table></div>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-127122" title="if (compound)"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_847"></a><div class="content_ref_head_code">if (compound)</div>
<p>Executes a group (or groups) of statements if a Boolean expression (or expressions) evaluates to <code>true</code>.</p>
<h5>Syntax</h5><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%" scope="row"><pre>
<code>if</code> <i class="force_italic">boolean</em> [ <code>then</code> ]<br/>   [ <i class="force_italic">statement</em> ]...<br/>
[<code>else if </code><i class="force_italic">boolean</em> [ <code>then</code> ]<br/>   [ <i class="force_italic">statement</em> ]...]...<br/>
[<code>else</code><br/>   [ <i class="force_italic">statement</em> ]...]<br/>
<code>end</code> [ <code>if</code> ]<br/></pre></td></tr></table>
<h5>Placeholders</h5><dl><dt><em>boolean</em></dt>
<dd class="content_text"><p>A Boolean expression.</p></dd>
<dt><em>statement</em></dt>
<dd class="content_text"><p>Any AppleScript statement.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_182" title="Examples"></a><h5>Examples</h5>
<p><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_848"></a>The following example uses a compound <code>if</code> statement, with a final <code>else</code> clause, to display a statement based on the current temperature (obtained separately):</p><div class="codesample"><table><tr><td scope="row"><pre>if currentTemp &lt; 60 then<span></span></pre></td></tr><tr><td scope="row"><pre>    set response to "It's a little chilly today."<span></span></pre></td></tr><tr><td scope="row"><pre>else if currentTemp > 80 then<span></span></pre></td></tr><tr><td scope="row"><pre>    set response to "It's getting hotter today."<span></span></pre></td></tr><tr><td scope="row"><pre>else<span></span></pre></td></tr><tr><td scope="row"><pre>    set response to "It's a nice day today."<span></span></pre></td></tr><tr><td scope="row"><pre>end if<span></span></pre></td></tr><tr><td scope="row"><pre>display dialog response<span></span></pre></td></tr></table></div><h5 class="tight">Discussion</h5>
<p>An <code>if</code> statement can contain any number of <code>else if</code> clauses; AppleScript looks for the first Boolean expression contained in an <code>if</code> or <code>else if</code> clause that is <code>true</code>, executes the statements contained in its block (the statements between one <code>else if</code> and the following <code>else if</code> or <code>else</code> clause), and then exits the <code>if</code> statement.<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_849"></a></p>
<p>An <code>if</code> statement can also include a final <code>else</code><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_850"></a> clause. The statements in its block are executed if no other test in the <code>if</code> statement passes.</p>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-127362" title="repeat Statements"></a><h3>repeat Statements</h3>
<p><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_851"></a>You use a <code>repeat</code> statement to create loops or execute groups of repeated statements in scripts.</p><p>There are a number of types of <code>repeat</code> statement, each differing in the way it terminates the loop. Each of the options, from repeating a loop a specific number of times, to looping over the items in a list, to looping until a condition is met, and so on, lends itself to particular kinds of tasks.</p><p>For information on testing and debugging <code>repeat</code> statements, see <span class="content_text"><a href="../conceptual/ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW20">“Debugging AppleScript Scripts.”</a></span></p>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-128843" title="exit"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_852"></a><div class="content_ref_head_code">exit</div>
<p>Terminates a <code>repeat</code> loop and resumes execution with the statement that follows the <code>repeat</code> statement.<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_853"></a></p><p>You can only use an <code>exit</code> statement inside a <code>repeat</code> statement. Though most commonly used with the <code>repeat (forever)</code> form, you can also use an <code>exit</code> statement with other types of <code>repeat</code> statement.</p>
<h5>Syntax</h5><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%" scope="row"><pre>
<code>exit</code> [ <code>repeat</code> ]<br/></pre></td></tr></table>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_183" title="Examples"></a><h5>Examples</h5>
<p>See the example in <code><a href="ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-127499">repeat (forever)</a></code>.</p>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-127499" title="repeat (forever)"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_854"></a><div class="content_ref_head_code">repeat (forever)</div>
<p>Repeats a statement (or statements) until an <a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_855"></a><code>exit</code> statement is encountered.</p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_184" title="Important:"></a><p><strong>Important:</strong>&nbsp;A <code>repeat</code> (forever) statement will never complete unless you cause it to do so.</p><p></p></div><p>To terminate a <code>repeat</code> (forever) statement, you can:</p><ul class="ul"><li class="li"><p>Use an <code><a href="ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-128843">exit</a></code> statement and design the logic so that it eventually encounters the <code>exit</code> statement.</p></li><li class="li"><p>Use a <code><a href="ASLR_handlers.html#//apple_ref/doc/uid/TP40000983-CH7g-163937">“return”</a></code> statement, which exits the handler or script that contains the loop, and therefore the loop as well.</p></li><li class="li"><p>Use a <code><a href="ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-129232">try</a></code> statement and rely on an error condition to exit the loop.</p></li></ul>
<h5>Syntax</h5><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%" scope="row"><pre>
<code>repeat</code><br/>
   [ <i class="force_italic">statement</em> ]...<br/>
<code>end</code> [ <code>repeat</code> ]<br/></pre></td></tr></table>
<h5>Placeholders</h5><dl><dt><em>statement</em></dt>
<dd class="content_text">
<p> Any AppleScript statement. </p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_185" title="Examples"></a><h5>Examples</h5>
<p>This form of the <code>repeat</code> statement is similar to the <code><a href="ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-128014">repeat until</a></code> form, except that instead of putting a test in the <code>repeat</code> statement itself, you determine within the loop when it is time to exit. You might use this form, for example, to wait for a lengthy or indeterminate operation to complete:</p>
<div class="codesample"><table><tr><td scope="row"><pre>repeat<span></span></pre></td></tr><tr><td scope="row"><pre>    -- perform operations<span></span></pre></td></tr><tr><td scope="row"><pre>    if someBooleanTest then<span></span></pre></td></tr><tr><td scope="row"><pre>        exit repeat<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end repeat<span></span></pre></td></tr></table></div><p>In a script application that stays open, you can use an <code>idle</code> handler to perform periodic tasks, such as checking for an operation to complete. See <span class="content_text"><a href="../conceptual/ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW8">“idle Handlers”</a></span> for more information.</p>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-127676" title="repeat (number) times"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_856"></a><div class="content_ref_head_code">repeat (number) times</div>
<p>Repeats a statement (or statements) a specified number of times.</p>
<h5>Syntax</h5><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%" scope="row"><pre>
<code>repeat</code> <i class="force_italic">integer</em> [ <code>times</code> ]<br/>
   [ <i class="force_italic">statement</em> ]...<br/>
<code>end</code> [ <code>repeat</code> ]<br/></pre></td></tr></table>
<h5>Placeholders</h5><dl><dt><em>integer</em></dt>
<dd class="content_text">
<p>Specifies the number of times to repeat the statements in the body of the loop.</p><p>Instead of an integer, you can specify any value that can be coerced to an integer.</p><p>If the value is less than one, the body of the <code>repeat</code> statement is not executed.</p></dd>
<dt><em>statement</em></dt>
<dd class="content_text">
<p>Any AppleScript statement.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_186" title="Examples"></a><h5>Examples</h5>
<p><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_857"></a>The following handler uses the <code>repeat (number) times</code> form of the <code>repeat</code> statement to raise a passed number to the passed power:</p>
<div class="codesample"><table><tr><td scope="row"><pre>on raiseToTheNth(x, power)<span></span></pre></td></tr><tr><td scope="row"><pre>    set returnVal to x<span></span></pre></td></tr><tr><td scope="row"><pre>    repeat power - 1 times<span></span></pre></td></tr><tr><td scope="row"><pre>        set returnVal to returnVal * x<span></span></pre></td></tr><tr><td scope="row"><pre>    end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>    return returnVal<span></span></pre></td></tr><tr><td scope="row"><pre>end raiseToTheNth<span></span></pre></td></tr></table></div>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-128014" title="repeat until"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_858"></a><div class="content_ref_head_code">repeat until</div>
<p>Repeats a statement (or statements) until a condition is met. Tests the condition before executing any statements.</p>
<h5>Syntax</h5><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%" scope="row"><pre>
<code>repeat until</code> <i class="force_italic">boolean</em><br/>
   [ <i class="force_italic">statement</em> ]...<br/>
<code>end</code> [ <code>repeat</code> ]<br/></pre></td></tr></table>
<h5>Placeholders</h5><dl><dt><em>boolean</em></dt>
<dd class="content_text"><p>A Boolean expression. If it has the value <code>true</code> when entering the loop, the statements in the loop are not executed.</p></dd>
<dt><em>statement</em></dt>
<dd class="content_text"><p> Any AppleScript statement.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_187" title="Examples"></a><h5>Examples</h5><p>The following example uses the <code>repeat until</code> form of the <code>repeat</code> statement to allow a user to enter database records. The handler <code>enterDataRecord()</code>, which is not shown, returns <code>true</code> if the user is done entering records:</p>
<div class="codesample"><table><tr><td scope="row"><pre>set userDone to false<span></span></pre></td></tr><tr><td scope="row"><pre>repeat until userDone<span></span></pre></td></tr><tr><td scope="row"><pre>    set userDone to enterDataRecord()<span></span></pre></td></tr><tr><td scope="row"><pre>end repeat<span></span></pre></td></tr></table></div>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-127845" title="repeat while"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_859"></a><div class="content_ref_head_code">repeat while</div>
<p>Repeats a statement (or statements) as long as a condition is met. Tests the condition before executing any statements. Similar to the <code>repeat until</code> form, except that it continues <em>while</em> a condition is <code>true</code>, instead of <em>until</em> it is <code>true</code>.</p>
<h5>Syntax</h5><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%" scope="row"><pre>
<code>repeat while</code> <i class="force_italic">boolean</em><br/>
   [ <i class="force_italic">statement</em> ]...<br/>
<code>end</code> [ <code>repeat</code> ]<br/></pre></td></tr></table>
<h5>Placeholders</h5><dl><dt><em>boolean</em></dt>
<dd class="content_text"><p>A Boolean expression. If it has the value <code>false</code> when entering the loop, the statements in the loop are not executed.</p></dd>
<dt><em>statement</em></dt>
<dd class="content_text"><p> Any AppleScript statement.</p></dd></dl><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_188" title="Examples"></a><h5>Examples</h5><p><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_860"></a>The following example uses the <code>repeat while</code> form of the <code>repeat</code> statement to allow a user to enter database records. In this case, we’ve just reversed the logic shown in the <code><a href="ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-128014">repeat until</a></code> example. Here, the handler <code>enterDataRecord()</code>, which is not shown, returns <code>true</code> if the user is <em>not</em> done entering records:</p><div class="codesample"><table><tr><td scope="row"><pre>set userNotDone to true<span></span></pre></td></tr><tr><td scope="row"><pre>repeat while userNotDone<span></span></pre></td></tr><tr><td scope="row"><pre>    set userNotDone to enterDataRecord()<span></span></pre></td></tr><tr><td scope="row"><pre>end repeat<span></span></pre></td></tr></table></div>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-128207" title="repeat with loopVariable (from startValue to stopValue)"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_861"></a><div class="content_ref_head_code">repeat with loopVariable (from startValue to stopValue)</div>
<p><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_862"></a>Repeats a statement (or statements) until the value of the controlling loop variable exceeds the value of the predefined stop value.</p>
<h5>Syntax</h5><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%" scope="row"><pre>
<code>repeat with</code>  <i class="force_italic">loopVariable</em>  <code>from</code>  <i class="force_italic">startValue</em>  <code>to</code>  <i class="force_italic">stopValue</em> [ <code>by</code>  <i class="force_italic">stepValue</em> ]<br/>
   [ <i class="force_italic">statement</em> ]...<br/>
<code>end</code> [ <code>repeat</code> ]<br/></pre></td></tr></table>
<h5>Placeholders</h5><dl><dt><em>loopVariable</em></dt>
<dd class="content_text"><p>Controls the number of iterations. It can be a previously defined variable or a new variable you define in the <code>repeat</code> statement.</p></dd>
<dt><em>startValue</em></dt>
<dd class="content_text"><p>Specifies a value that is assigned to <em>loopVariable</em> when the loop is entered.</p><p>You can specify an integer or any value that can be coerced to an integer.</p></dd>
<dt><em>stopValue</em></dt>
<dd class="content_text"><p>Specifies an value. When that value is exceeded by the value of <em>loopVariable</em>, iteration ends. If <em>stopValue</em> is less than <em>startValue</em>, the body is not executed.</p><p>You can specify an integer or any value that can be coerced to an integer.</p></dd>
<dt><em>stepValue</em></dt>
<dd class="content_text"><p>Specifies a value that is added to <em>loopVariable</em> after each iteration of the loop. You can assign an <code>integer</code> or a <code>real</code> value; a <code>real</code> value is rounded to an <code>integer</code>.</p><dl><dt><em>Default Value:</em></dt><dd class="content_text">1</dd></dl></dd>
<dt><em>statement</em></dt>
<dd class="content_text"><p>Any AppleScript statement.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_189" title="Examples"></a><h5>Examples</h5>
<p>The following handler uses the <code>repeat with loopVariable (from startValue to stopValue)</code> form of the <code>repeat</code> statement to compute a factorial value (the factorial of a number is the product of all the positive integers from 1 to that number):</p><div class="codesample"><table><tr><td scope="row"><pre>on factorial(x)<span></span></pre></td></tr><tr><td scope="row"><pre>    set returnVal to 1<span></span></pre></td></tr><tr><td scope="row"><pre>    repeat with n from 2 to x<span></span></pre></td></tr><tr><td scope="row"><pre>        set returnVal to returnVal * n<span></span></pre></td></tr><tr><td scope="row"><pre>    end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>    return returnVal<span></span></pre></td></tr><tr><td scope="row"><pre>end factorial<span></span></pre></td></tr></table></div>
<h5 class="tight">Discussion</h5>
<p>You can use an existing variable as the loop variable in a <code>repeat with loopVariable (from startValue to stopValue)</code> statement or define a new one in the statement. In either case, the loop variable is defined outside the loop. You can change the value of the loop variable inside the loop body but it will get reset to the next loop value the next time through the loop. After the loop completes, the loop variable retains its last value.</p>
<p>AppleScript evaluates <em>startValue</em>, <em>stopValue</em>, and <em>stepValue</em> when it begins executing the loop and stores the values internally. As a result, if you change the values in the body of the loop, it doesn’t change the execution of the loop.</p>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-128481" title="repeat with loopVariable (in list)"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_863"></a><div class="content_ref_head_code">repeat with loopVariable (in list)</div>
<p><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_864"></a>Loops through the items in a specified list.</p><p>The number of iterations is equal to the number of items in the list. In the first iteration, the value of the variable is a reference to the first item in <em>list</em>, in the second iteration, it is a reference to the second item in <em>list</em>, and so on.</p>
<h5>Syntax</h5><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%" scope="row"><pre>
<code>repeat with</code> <i class="force_italic">loopVariable</em> <code>in</code> <i class="force_italic">list</em><br/>
   [ <i class="force_italic">statement</em> ]...<br/>
<code>end</code> [ <code>repeat</code> ]<br/></pre></td></tr></table>
<h5>Placeholders</h5><dl><dt><em>loopVariable</em></dt>
<dd class="content_text"><p>Any previously defined variable or a new variable you define in the <code>repeat</code> statement (see Discussion).</p></dd>
<dt><em>list</em></dt>
<dd class="content_text"><p>A list or a object specifier (such as <code>words 1 thru 5</code>) whose value is a list.</p>
<p><em>list</em> can also be a record; AppleScript coerces the record to a list (see Discussion).</p></dd>
<dt><em>statement</em></dt>
<dd class="content_text"><p>Any AppleScript statement.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_190" title="Examples"></a><h5>Examples</h5>
<p>The following script examines a list of words with the <code>repeat with loopVariable (in list)</code> form of the <code>repeat</code> statement, displaying a dialog if it finds the word “hammer” in the list. Note that within the loop, the loop variable (<code>currentWord</code>) is a reference to an item in a list, so in the test statement (<code>if contents of currentWord is equal to "hammer" then</code>) it must be cast to text (<code>as text</code>).</p>
<div class="codesample"><table><tr><td scope="row"><pre>set wordList to words in "Where is the hammer?"<span></span></pre></td></tr><tr><td scope="row"><pre>repeat with currentWord in wordList<span></span></pre></td></tr><tr><td scope="row"><pre>    log currentWord<span></span></pre></td></tr><tr><td scope="row"><pre>    if contents of currentWord is equal to "hammer" then<span></span></pre></td></tr><tr><td scope="row"><pre>        display dialog "I found the hammer!"<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end repeat<span></span></pre></td></tr></table></div>
<p>The statement <code>log currentWord</code> logs the current list item to Script Editor’s log window. For more information, see <span class="content_text"><a href="../conceptual/ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW20">“Debugging AppleScript Scripts.”</a></span></p>
<h5 class="tight">Discussion</h5>
<p>You can use an existing variable as the loop variable in a <code>repeat with loopVariable (in list)</code> statement or define a new one in the <code>repeat with…</code> statement. In either case, the loop variable is defined outside the loop. You can change the value of the loop variable inside the loop body but it will get reset to the next loop value the next time through the loop. After the loop completes, the loop variable retains its last value.</p>
<p>AppleScript evaluates <em>loopVariable</em> <code>in</code> <em>list</em> as an object specifier that takes on the value of <code>item 1 of list</code>, <code>item 2 of list</code>, <code>item 3 of list</code>, and so on until it reaches the last item in the list, as shown in the following example:</p>
<div class="codesample"><table><tr><td scope="row"><pre>repeat with i in {1, 2, 3, 4}<span></span></pre></td></tr><tr><td scope="row"><pre>    set listItem to i<span></span></pre></td></tr><tr><td scope="row"><pre>end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>--result: item 4 of {1, 2, 3, 4} --result: an object specifier<span></span></pre></td></tr></table></div>
<p>To set a variable to the value of an item in the list, rather than a reference to the item, use the <code>contents of</code> property:</p>
<div class="codesample"><table><tr><td scope="row"><pre>repeat with i in {1, 2, 3, 4}<span></span></pre></td></tr><tr><td scope="row"><pre>    set listItem to contents of i<span></span></pre></td></tr><tr><td scope="row"><pre>end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>--result: 4<span></span></pre></td></tr></table></div>
<p>You can also use the list items directly in expressions:</p>
<div class="codesample"><table><tr><td scope="row"><pre>set total to 0<span></span></pre></td></tr><tr><td scope="row"><pre>repeat with i in {1, 2, 3, 4}<span></span></pre></td></tr><tr><td scope="row"><pre>    set total to total + i<span></span></pre></td></tr><tr><td scope="row"><pre>end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>--result: 10<span></span></pre></td></tr></table></div>
<p>If the value of list is a record, AppleScript coerces the record to a list by stripping the property labels. For example, <code>{a:1, b:2, c:3}</code> becomes <code>{1, 2, 3}</code>.</p><a name="//apple_ref/doc/uid/TP40000983-CH6g-158637" title="tell Statements"></a><h3>tell Statements</h3>
<p><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_865"></a>A <code>tell</code> statement specifies the default target—that is, the object to which commands are sent if they do not include a direct parameter. Statements within a <code>tell</code> statement that use terminology from the targeted object are compiled against that object’s dictionary.</p><p>The object of a <code>tell</code> statement is typically a reference to an application object or a <code>script</code> object. For example, the following <code>tell</code> statement targets the Finder application:</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "Finder"<span></span></pre></td></tr><tr><td scope="row"><pre>    set frontWindowName to name of front window<span></span></pre></td></tr><tr><td scope="row"><pre>    -- any number of additional statements can appear here<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_866"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_867"></a>You can nest <code>tell</code> statements inside other <code>tell</code> statements, as long as you follow the syntax and rules described in <code><a href="ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-158020">tell (compound)</a></code>.</p><p>When you need to call a handler from within a <code>tell</code> statement, there are special terms you use to indicate that the handler is part of the script and not a command that should be sent to the object of the <code>tell</code> statement. These terms are described in <span class="content_text"><a href="../conceptual/ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW4">“The it and me Keywords”</a></span> and in <span class="content_text"><a href="../conceptual/ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW1">“Calling Handlers in a tell Statement.”</a></span></p><p>A <code>tell</code> statement that targets a local application doesn’t cause it to launch, if it is not already running. For example, a script can examine the <code>is running</code> property of the targeted <code><a href="ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW2">application</a></code> object to determine if the application is running before attempting to send it any commands. If it is not running it won’t be launched.</p><p>If a <code>tell</code> statement targets a local application and executes any statements that require a response from the application, then AppleScript will launch the application if it is not already running. The application is launched as hidden, but the script can send it an <code><a href="ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW60">activate</a></code> command to bring it to the front, if needed.</p><p>A <code>tell</code> statement that targets a remote application will not cause it to launch—in fact, it will not compile or run unless the application is already running. Nor is it possible to access the <code>is running</code> property of an application on a remote computer.</p>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-157872" title="tell (simple)"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_868"></a><div class="content_ref_head_code">tell (simple)</div>
<p>Specifies a target object and a command to send to it.</p>
<h5>Syntax</h5><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%" scope="row"><pre>
<code>tell</code> <i class="force_italic">referenceToObject</em> <code>to</code> <i class="force_italic">statement</em> <br/></pre></td></tr></table>
<h5>Placeholders</h5><dl><dt><em>referenceToObject</em></dt>
<dd class="content_text">
<p>Any object. Typically an object specifier or a <code>reference</code> object (which contains an object specifier).</p></dd>
<dt><em>statement</em></dt>
<dd class="content_text">
<p>Any AppleScript statement.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_191" title="Examples"></a><h5>Examples</h5><p>This simple <code>tell</code> statement closes the front Finder window:</p>
<div class="codesample"><table><tr><td scope="row"><pre>tell front window of application "Finder" to close<span></span></pre></td></tr></table></div><p>For more information on how to specify an application object, see the <code><a href="ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW2">application</a></code> class.</p>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-158020" title="tell (compound)"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_869"></a><div class="content_ref_head_code">tell (compound)</div>
<p>Specifies a target object and one or more commands to send to it. A compound <code>tell</code> statement is different from a simple <code>tell</code> statement in that it always includes an <code>end</code> statement.</p>
<h5>Syntax</h5><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%" scope="row"><pre>
<code>tell</code> <i class="force_italic">referenceToObject</em>  <br/>   [ <i class="force_italic">statement</em> ]... <br/><code>end</code> [ <code>tell</code> ]<br/></pre></td></tr></table>
<h5>Placeholders</h5><dl><dt><em>referenceToObject</em></dt>
<dd class="content_text"><p>Any object. Typically an object specifier or a <code>reference</code> object (which contains an object specifier).</p></dd>
<dt><em>statement</em></dt>
<dd class="content_text">
<p>Any AppleScript statement, including another <code>tell</code> statement.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_192" title="Examples"></a><h5>Examples</h5>
<p>The following statements show how to close a window using first a compound <code>tell</code> statement, then with two variations of a simple <code>tell</code> statement:</p>
<div class="codesample"><table><tr><td scope="row"><pre>tell application "Finder"<span></span></pre></td></tr><tr><td scope="row"><pre>    close front window<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>tell front window of application "Finder" to close<span></span></pre></td></tr><tr><td scope="row"><pre>tell application "Finder" to close front window<span></span></pre></td></tr></table></div><p><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_870"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_871"></a>The following example shows a nested <code>tell</code> statement:</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "Finder"<span></span></pre></td></tr><tr><td scope="row"><pre>    tell document 1 of application "TextEdit"<span></span></pre></td></tr><tr><td scope="row"><pre>        set newName to word 1 -- handled by TextEdit<span></span></pre></td></tr><tr><td scope="row"><pre>    end tell<span></span></pre></td></tr><tr><td scope="row"><pre>    set len to count characters in newName -- handled by AppleScript<span></span></pre></td></tr><tr><td scope="row"><pre>    if (len > 2) and (len &lt; 15) then -- comparisons handled by AppleScript<span></span></pre></td></tr><tr><td scope="row"><pre>        set name of first item of disk "HD" to newName -- handled by Finder<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>This example works because in each case the terminology understood by a particular application is used within a <code>tell</code> block targeting that application. However, it would not compile if you asked the Finder for <code>word 1</code> of a document, or told TextEdit to <code>set name</code> of the first item on a disk, because those applications do not support those terms.</p>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-128973" title="try Statements"></a><h3>try Statements</h3>
<p><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_872"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_873"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_874"></a>A <code>try</code> statement provides the means for scripts to handle potential errors. It attempts to execute one or more statements and, if an error occurs, executes a separate set of statements to deal with the error condition. If an error occurs and there is no <code>try</code> statement in the calling chain to handle it, AppleScript displays an error and script execution stops.</p>
<p>For related information, see <span class="content_text"><a href="ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-129657">“error Statements”</a></span> and <span class="content_text"><a href="../conceptual/ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW10">“AppleScript Error Handling.”</a></span></p>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-129232" title="try"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_875"></a><div class="content_ref_head_code">try</div>
<p>Attempts to execute a list of AppleScript statements, calling an error handler if any of the statements results in an error.</p><p>A <code>try</code> statement is a two-part compound statement that contains a series of AppleScript statements, followed by an error handler to be invoked if any of those statements causes an error. If the statement that caused the error is included in a <code>try</code> statement, then AppleScript passes control to the error handler. After the error handler completes, control passes to the statement immediately following the end of the <code>try</code> statement.</p>
<h5>Syntax</h5><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%" scope="row"><pre>
<code>try</code><br/>
   [ <i class="force_italic">statement</em> ]...<br/>
[ <code>on error</code> [ <i class="force_italic">errorMessage</em> ] [ <code>number</code> <i class="force_italic">errorNumber</em> ] [ <code>from</code> <i class="force_italic">offendingObject</em> ] ¬<br/>
   [ <code>partial result</code> <i class="force_italic">resultList</em> ] [ <code>to</code> <i class="force_italic">expectedType</em> ]<br/>
      [ <i class="force_italic">statement</em> ]... ]<br/>
<code>end</code> [<code> error | try </code>]<br/></pre></td></tr></table>
<h5>Placeholders</h5><dl><dt><em>statement</em></dt>
<dd class="content_text"><p>Any AppleScript statement.</p></dd>
<dt><em>errorMessage</em></dt>
<dd class="content_text"><p>A <code>text</code> object, that describes the error. </p></dd>
<dt><em>errorNumber</em></dt>
<dd class="content_text"><p>The error number, an integer. For possible values, see <span class="content_text"><a href="ASLR_error_codes.html#//apple_ref/doc/uid/TP40000983-CH220-SW5">“Error Numbers and Error Messages.”</a></span></p></dd>
<dt><em>offendingObject</em></dt>
<dd class="content_text"><p>A reference to the object, if any, that caused the error.</p></dd>
<dt><em>resultList</em></dt>
<dd class="content_text"><p>A list that provides partial results for objects that were handled before the error occurred. The list can contain values of any class. This parameter applies only to commands that return results for multiple objects. This is rarely supported by applications.</p></dd>
<dt><em>expectedType</em></dt>
<dd class="content_text"><p>The expected class. If the error was caused by a coercion failure, the value of this variable is the class of the coercion that failed. (The second example below shows how this works in a case where AppleScript is unable to coerce a <code>text</code> object into an <code>integer</code>.)</p></dd>
<dt><em>variable</em></dt>
<dd class="content_text"><p>Either a global variable or a local variable that can be used in the handler. A variable can contain any class of value. The scope of a local variable is the handler. The scope of a global variable extends to any other part of the script, including other handlers and <code>script</code> objects. For related information about local and global variables, see <span class="content_text"><a href="../conceptual/ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW6">“version.”</a></span></p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_193" title="Examples"></a><h5>Examples</h5><p>The following example shows how you can use a <code>try</code> statement to handle the “Cancel” button for a <code><a href="ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW11">display alert</a></code> command. Canceling returns an error number of -128, but is not really an error. This test handler just displays a dialog to indicate when the user cancels or when some other error occurs.</p><div class="codesample"><table><tr><td scope="row"><pre>try<span></span></pre></td></tr><tr><td scope="row"><pre>    display alert "Hello" buttons {"Cancel", "Yes", "No"} cancel button 1<span></span></pre></td></tr><tr><td scope="row"><pre>on error errText number errNum<span></span></pre></td></tr><tr><td scope="row"><pre>    if (errNum is equal to -128) then<span></span></pre></td></tr><tr><td scope="row"><pre>        -- User cancelled.<span></span></pre></td></tr><tr><td scope="row"><pre>        display dialog "User cancelled."<span></span></pre></td></tr><tr><td scope="row"><pre>    else<span></span></pre></td></tr><tr><td scope="row"><pre>        display dialog "Some other error: " &amp; errNum &amp; return &amp; errText<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end try<span></span></pre></td></tr></table></div>
<p>You can also use a simplified version of the <code>try</code> statement that checks for just a single error number. In the following example, only error -128 is handled. Any other error number is ignored by this <code>try</code> statement, but is automatically passed up the calling chain, where it may be handled by other <code>try</code> statements.</p><div class="codesample"><table><tr><td scope="row"><pre>try<span></span></pre></td></tr><tr><td scope="row"><pre>    display alert "Hello" buttons {"Cancel", "Yes", "No"} cancel button 1<span></span></pre></td></tr><tr><td scope="row"><pre>on error number -128<span></span></pre></td></tr><tr><td scope="row"><pre>    -- Either do something special to handle Cancel, or just ignore it.<span></span></pre></td></tr><tr><td scope="row"><pre>end try<span></span></pre></td></tr></table></div><p>The following example demonstrates the use of the <code>to</code> keyword to capture additional information about an error that occurs during a coercion failure:</p>
<div class="codesample"><table><tr><td scope="row"><pre>try<span></span></pre></td></tr><tr><td scope="row"><pre>    repeat with i from 1 to "Toronto"<span></span></pre></td></tr><tr><td scope="row"><pre>        -- do something that depends on variable "i"<span></span></pre></td></tr><tr><td scope="row"><pre>    end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>on error from obj to newClass<span></span></pre></td></tr><tr><td scope="row"><pre>    log {obj, newClass} -- Display from and to info in log window.<span></span></pre></td></tr><tr><td scope="row"><pre>end try<span></span></pre></td></tr></table></div>
<p>This <code>repeat</code> statement fails because the <code>text</code> object <code>"Toronto"</code> cannot be coerced to an <code><a href="ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCHBDCJ">integer</a></code>. The error handler simply writes the values of <code>obj</code> (the offending value, <code>"Toronto"</code>) and <code>newClass</code> (the class of the coercion that failed, <code>integer</code><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_876"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_877"></a>) to Script Editor’s Event Log History window (and to the script window’s Event Log pane). The result is “(*Toronto, integer*)”, indicating the error occurred while trying to coerce “Toronto” to an integer.</p><p>For additional examples, see <span class="content_text"><a href="ASLR_error_xmpls.html#//apple_ref/doc/uid/TP40000983-CH221-SW1">“Working with Errors.”</a></span></p><a name="//apple_ref/doc/uid/TP40000983-CH6g-SW3" title="using terms from Statements"></a><h3>using terms from Statements</h3><p>A <code>using terms from</code> statement lets you specify which terminology AppleScript should use in compiling the statements in a script. Whereas a <code>tell</code> statement specifies the default target (often an application) to which commands are sent <em>and</em> the terminology to use, a <code>using terms from</code> statement specifies only the terminology.</p><p>A <code>using terms from</code> statement can be useful in writing application event handler scripts, such as Mail rules.</p><p>Another use for this type of statement is with a script that targets an application on a remote computer that may not be available when you compile the script (or the application may not be running). Or, you might be developing locally and only want to test with the remote application at a later time. In either case, you can use a <code>using terms from</code> statement to specify a local application (presumably with a terminology that matches the one on the remote computer) to compile against.</p><p>Even if a statement contained within a <code>using terms from</code> statement compiles, the script may fail when run because the target application’s terminology may differ from that used in compiling.</p><p>You can nest <code>using terms from</code> statements. When you do so, each script statement is compiled against the terminology of the application named in the innermost enclosing <code>using terms from</code> statement.</p><a name="//apple_ref/doc/uid/TP40000983-CH6g-SW1" title="using terms from"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_878"></a><div class="content_ref_head_code">using terms from</div><p>Instructs AppleScript to use the terminology from the specified application in compiling the enclosed statements.</p><h5>Syntax</h5><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%" scope="row"><pre><code>using terms from</code> <i class="force_italic">application</em> <br/>   [ <i class="force_italic">statement</em> ]... <br/><code>end</code> [ <code>using terms from</code> ]<br/></pre></td></tr></table><h5>Placeholders</h5><dl><dt><em>application</em></dt><dd class="content_text"><p>A specifier for an application object.</p></dd><dt><em>statement</em></dt><dd class="content_text"><p>Any AppleScript statement.</p></dd></dl><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_194" title="Examples"></a><h5>Examples</h5><p>The following example shows how to use a  <code>using terms from</code> statement in writing a Mail rule action script. These scripts take the following form:</p><div class="codesample"><table><tr><td scope="row"><pre>using terms from application "Mail"<span></span></pre></td></tr><tr><td scope="row"><pre>  on perform mail action with messages theMessages for rule theRule<span></span></pre></td></tr><tr><td scope="row"><pre>    tell application "Mail"<span></span></pre></td></tr><tr><td scope="row"><pre>        -- statements to process each message in theMessages<span></span></pre></td></tr><tr><td scope="row"><pre>    end tell<span></span></pre></td></tr><tr><td scope="row"><pre>  end perform mail action with messages<span></span></pre></td></tr><tr><td scope="row"><pre>end using terms from<span></span></pre></td></tr></table></div><p>To use the script, you open Preferences for the Mail application, create or edit a rule, and assign the script as the action for the rule.</p><p>For an example that works with an application on a remote machine, see <span class="content_text"><a href="../conceptual/ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW35">“Targeting Remote Applications.”</a></span></p>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-130992" title="with timeout Statements "></a><h3>with timeout Statements </h3>
<p><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_879"></a>You can use a <code>with timeout</code> statement to control how long AppleScript waits for a command to execute before timing out. By default, <a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_880"></a>when an application fails to respond to a command, AppleScript waits for two minutes before reporting an error and halting execution.</p>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-131094" title="with timeout"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_881"></a><div class="content_ref_head_code">with timeout</div>
<p>Specifies how long AppleScript waits for a response to a command that is sent to another application.</p>
<h5>Syntax</h5><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%" scope="row"><pre>
<code>with timeout</code> [ <code>of</code> ] <i class="force_italic">integerExpression</em> <code>second</code>[<code>s</code>] <br/>   [ <i class="force_italic">statement</em> ]... <br/><code>end</code> [ <i class="force_italic">timeout</em> ] <br/></pre></td></tr></table>
<h5>Placeholders</h5><dl><dt><em>integerExpression</em></dt>
<dd class="content_text"><p>The amount of time, in seconds, AppleScript should wait before timing out (and interrupting the command).</p></dd><dt><em>statement</em></dt><dd class="content_text"><p>Any AppleScript statement.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_195" title="Examples"></a><h5>Examples</h5>
<p>The following script tells TextEdit to close its first document; if the document has been modified, it asks the user if the document should be saved. It includes the statement <code>with timeout of 20 seconds</code>, so that if the user doesn’t complete the <code>close</code> operation within 20 seconds, the operation times out. </p>
<div class="codesample"><table><tr><td scope="row"><pre>tell application "TextEdit"<span></span></pre></td></tr><tr><td scope="row"><pre>    with timeout of 20 seconds<span></span></pre></td></tr><tr><td scope="row"><pre>        close document 1 saving ask<span></span></pre></td></tr><tr><td scope="row"><pre>    end timeout<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><h5 class="tight">Discussion</h5><p>When a command fails to complete in the allotted time (whether the default of two minutes, or a time set by a <code>with timeout</code> statement), AppleScript stops running the script and returns the error <code>"event timed out"</code>.<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_882"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_883"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_884"></a> AppleScript does not cancel the operation—it merely stops execution of the script. If you want the script to continue, you can wrap the statements in a <code><a href="ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-129232">try</a></code> statement. However, whether your script can send a command to cancel an offending lengthy operation after a timeout is dependent on the application that is performing the command.</p><p>A <code>with timeout</code> statement applies only to commands sent to application objects, not to commands sent to the application that is running the script. </p><p>In some situations, you may want to use an <code>ignoring application responses</code> statement (instead of a <code>with timeout</code> statement) so that your script needn’t wait for application commands to complete. For more information, see <span class="content_text"><a href="ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-130224">“considering and ignoring Statements.”</a></span></p>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-131273" title="with transaction Statements "></a><h3>with transaction Statements </h3>
<p><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_885"></a>When you execute a script, AppleScript may send one or more Apple events to targeted applications. A transaction is a set of operations that are applied as a single unit—either all of the changes are applied or none are. This mechanism works only with applications that support it.</p>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-131303" title="with transaction"></a><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_886"></a><div class="content_ref_head_code">with transaction</div>
<p>Associates a single transaction ID with any events sent to a target application as a result of executing commands in the body of the statement.</p>
<h5>Syntax</h5><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%" scope="row"><pre>
<code>with transaction</code> [ <i class="force_italic">session</em> ] <br/>
   [ <i class="force_italic">statement</em> ]...<br/>
<code>end</code> [ <code>transaction</code> ]<br/></pre></td></tr></table>
<h5>Placeholders</h5><dl><dt><em>session</em></dt>
<dd class="content_text"><p>An object that identifies a specific session.</p></dd>
<dt><em>statement</em></dt>
<dd class="content_text"><p>Any AppleScript statement.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_196" title="Examples"></a><h5>Examples</h5>
<p><a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_887"></a>This example uses a <code>with transaction</code> statement to ensure that a record can be modified by one user without being modified by another user at the same time. (In the following examples, “Small DB” and “Super DB” are representative database applications.)</p>
<div class="codesample"><table><tr><td scope="row"><pre>tell application "Small DB"<span></span></pre></td></tr><tr><td scope="row"><pre>    with transaction<span></span></pre></td></tr><tr><td scope="row"><pre>        set oldName to Field "Name"<span></span></pre></td></tr><tr><td scope="row"><pre>        set oldAddress to Field "Address"<span></span></pre></td></tr><tr><td scope="row"><pre>        set newName to display dialog ¬<span></span></pre></td></tr><tr><td scope="row"><pre>            "Please type a new name" ¬<span></span></pre></td></tr><tr><td scope="row"><pre>            default answer oldName<span></span></pre></td></tr><tr><td scope="row"><pre>        set newAddress to display dialog ¬<span></span></pre></td></tr><tr><td scope="row"><pre>            "Please type the new address" ¬<span></span></pre></td></tr><tr><td scope="row"><pre>            default answer oldAddress<span></span></pre></td></tr><tr><td scope="row"><pre>        set Field "Name" to newName<span></span></pre></td></tr><tr><td scope="row"><pre>        set Field "Address" to newAddress<span></span></pre></td></tr><tr><td scope="row"><pre>    end transaction<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div>
<p>The <code>set</code> statements obtain the current values of the Name and Address fields and invite the user to change them. Enclosing these <code>set</code> statements in a single <code>with transaction</code> statement informs the application that other users should not be allowed to access the same record at the same time.</p>
<p>A <code>with transaction</code> statement works only with applications that explicitly support it. Some applications only support <code>with transaction</code> statements (like the one in the previous example) that do not take a session object as a parameter. Other applications support both <code>with transaction</code> statements that have no parameter and <code>with transaction</code> statements that take a session parameter.</p>
<p>The following example demonstrates how to specify a session for a <code>with transaction</code> statement:<a name="//apple_ref/doc/uid/TP40000983-CH6g-DontLinkElementID_888"></a></p>
<div class="codesample"><table><tr><td scope="row"><pre>tell application "Super DB"<span></span></pre></td></tr><tr><td scope="row"><pre>    set mySession to make session with data {user: "Bob", password: "Secret"}<span></span></pre></td></tr><tr><td scope="row"><pre>    with transaction mySession<span></span></pre></td></tr><tr><td scope="row"><pre>        ...<span></span></pre></td></tr><tr><td scope="row"><pre>    end transaction<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="ASLR_operators.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="ASLR_handlers.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-03-11<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_control_statements.html%3Fid%3DTP40000983-3.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_control_statements.html%3Fid%3DTP40000983-3.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_control_statements.html%3Fid%3DTP40000983-3.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>