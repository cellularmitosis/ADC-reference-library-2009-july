<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>The Division of Labor Between Your Code and MacApp (MacApp PG)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING20></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MacAppProgGuide-19.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-21.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MacAppProgGuide-2.html"><B>Programmer's Guide to MacApp</B></A> / <BR><DD><A HREF="MacAppProgGuide-14.html"><B>Chapter 1 - MacApp Overview</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING20-0></A>
<H1>The Division of Labor Between Your Code and MacApp</H1>
 A MacApp application contains code and resources from the MacApp class library, as well as code and resources supplied by the developer. An application also contains a mix of objects that are normally instantiated from unmodified MacApp classes, such as the Clipboard Manager object, and objects instantiated from subclasses you define based on MacApp classes. For some subclasses you define, you may need to add very little code to the MacApp parent class, while for others you may write a great deal of additional code.<P>
 MacApp supplies code to receive and dispatch events. It handles some events and passes others on to your code. Sometimes MacApp can do part of the job but depends on your code to do the rest.<P>
 As a rule, MacApp handles things that are predictable, or things that operate in the same way for most applications. MacApp often knows <I>when</I> something must be done, but not <I>how</I>. When that happens, MacApp calls a specific method, which your application must override to perform the required action.<P>
 For example, when the user chooses New from the File menu, MacApp calls the application object's <CODE>DoMakeDocument</CODE> method to create a new document. But it's up to you to define a subclass of <CODE>TApplication</CODE>, override the <CODE>DoMakeDocument</CODE> method, and provide code to create the specific kind of document your application needs.<P>
 The following sections describe the key functions in a MacApp application and provide examples of how responsibility is shared between your code and MacApp.<P>
<A NAME=HEADING20-6></A>
<H2><A NAME=MARKER-9-72></A>Managing Menus</H2>
 You create resource definitions to tell MacApp about your application's menus. The information you supply specifies which menus to show in the menu bar for your application, which items to list in the menus, which items have keyboard equivalents, and the initial state of the menu items (enabled, checked, and so forth). MacApp supplies several default <CODE>'CMNU'</CODE> resource definitions, including definitions for the Apple, File, Edit, Edit with Edition Manager support, and Mail menus. MacApp also supplies an <CODE>'MBAR'</CODE> resource definition that specifies the Apple, File, and Edit menus. You can use these definitions in their default form or modify them for your application.<P>
 MacApp automatically displays the menus you have defined and highlights choices when a user opens a menu.<P>
 For more information on using menu resources in your application, see <A HREF=MacAppProgGuide-86.html#MARKER-9-29>"Working With Menu Resources" on page 300</A>.<P>
<A NAME=HEADING20-10></A>
<H2><A NAME=MARKER-2-73></A><A NAME=MARKER-9-74></A>Processing Menu Commands</H2>
 When a user chooses a menu item, MacApp maps the choice into a <CODE>DoMenuCommand</CODE> method call to the current target object, passing the command number for the chosen menu command, as shown in <A HREF=#MARKER-9-75>Figure 1-6</A>.<P>
<B>Figure 1-6  <A NAME=MARKER-9-75></A>MacApp responds to a user menu choice</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/MacApp_PG-L-041.gif"><P>
 The <CODE>'CMNU'</CODE> resource for the File menu specifies the commands that appear in the menu and associates a command constant with each menu command. For the Close menu command, for example, the constant is <CODE>cClose</CODE>.<P>
 One of your application's command-handling objects responds to the menu choice by performing an action or creating a command object to perform an action. This process is described in more detail in <A HREF=MacAppProgGuide-40.html#MARKER-9-19>Chapter 5, "Events and Commands."</A><P>
 For certain menu commands, MacApp creates command objects to handle the command operation, but your classes may need to provide some code as well. For example, your document class may need to supply its own <CODE>Close</CODE> method and destructor routine, which will then be called when a document window is closed. <P>
 Since MacApp cannot anticipate the commands that are unique to your application, you define command classes to handle application-specific operations. MacApp knows when to call the <CODE>Do</CODE>, <CODE>Undo</CODE>, <CODE>Redo</CODE>, and other methods of your command objects.<A NAME=MARKER-2-76></A><P>
<A NAME=HEADING20-18></A>
<H2>Processing Mouse Clicks</H2>
 When the user clicks the mouse, the application object dispatches the event according to where it occurs. A mouse click in an application menu bar is converted to a menu command and processed accordingly. A mouse click in an application window is dispatched to the window in which it occurs. MacApp's window class does most of the work of handling a mouse click in the window's control area, while your view objects handle mouse clicks in the content area.<P>
 Processing of mouse clicks is described in greater detail in <A HREF=MacAppProgGuide-40.html#MARKER-9-19>Chapter 5, "Events and Commands."</A><P>
<A NAME=HEADING20-21></A>
<H2>Processing Keystrokes</H2>
 When the user presses a key, MacApp's application object dispatches the keystroke to the target chain. A keystroke can be handled by any target-chain object that is interested in it. Command-key combinations with menu equivalents are dispatched in the same manner as menu commands. Handling keystrokes in your application is described in <A HREF=MacAppProgGuide-109.html#MARKER-9-19>Chapter 20, "Working With the Keyboard."</A><P>
 MacApp provides several view classes that accept and validate text and numeric data entry. For more information on these views, see <A HREF=MacAppProgGuide-63.html#MARKER-9-19>Chapter 8, "Displaying, Manipulating, and Printing Data."</A><P>
<A NAME=HEADING20-24></A>
<H2>Managing Windows</H2>
 MacApp handles window activation and updating, but your views draw the window's content area. When the user manipulates the title bar, size box, close box, or zoom box in a standard window, MacApp responds--your code responds to actions in the content area. MacApp provides a default About box and manages application switching. For information on using windows in your application, see <A HREF=MacAppProgGuide-103.html#MARKER-9-19>Chapter 18, "Working With Windows."</A><P>
<A NAME=HEADING20-26></A>
<H2>Reading and Writing Documents</H2>
 MacApp provides a framework for saving file-based documents and making sure sufficient disk space is available. You define data structures for your document's data and implement read and write methods. MacApp calls your methods when the user opens or saves a document.<P>
 MacApp's <CODE>TFile</CODE> and <CODE>TFileHandler</CODE> classes work together with the <CODE><A NAME=MARKER-2-77></A>TFileBasedDocument</CODE> class to provide low-level<A NAME=MARKER-2-78></A> File Manager support for reading and writing data. Other document classes support publish and subscribe. For more information on documents, see <A HREF=MacAppProgGuide-57.html#MARKER-9-23>Chapter 7, "Document Handling."</A><P>
<A NAME=HEADING20-29></A>
<H2>Supporting PowerTalk Mailers</H2>
 MacApp's PowerTalk support enables a user to add a mailer to a document's view and to then treat the document as an electronic letter.<P>
 MacApp supplies a <CODE>'CMNU'</CODE> resource for the Mail menu, plus various classes to provide an interface to the <A NAME=MARKER-2-79></A>Standard Mail Package. MacApp responds to mail commands and displays a mailer view in your document. You read native content when a letter is opened and write it when the letter is closed.<P>
 MacApp provides much of its PowerTalk support through two mixin classes, <CODE><A NAME=MARKER-2-80></A>MMailing</CODE> and <CODE><A NAME=MARKER-2-81></A>MMailable</CODE>. The <CODE><A NAME=MARKER-2-82></A>TMailingApplication</CODE> class mixes in <CODE>MMailing</CODE>, and the <CODE><A NAME=MARKER-2-83></A>TMailDocument</CODE> class mixes in <CODE>MMailable</CODE>. Your application uses these classes, together with <CODE><A NAME=MARKER-2-84></A>TMailerView</CODE>, <CODE>TMailer</CODE>, and <CODE>TLetter</CODE>, to support mailable documents. For more information, see <A HREF=MacAppProgGuide-62.html#MARKER-9-201>"PowerTalk Mailers," beginning on page 192</A>.<P>
<A NAME=HEADING20-33></A>
<H2>Supporting Scripting</H2>
 MacApp receives and dispatches Apple events and knows how to handle the four required Apple events: Open Application, Open Documents, Print Documents, and Quit Application.<P>
 You add a <B><A NAME=MARKER-2-85></A>mixin class</B> (or multiple inheritance class) to an existing class definition to add scripting capabilities. MacApp provides the mixin classes <CODE><A NAME=MARKER-2-86></A>MScriptableObject</CODE> and <CODE><A NAME=MARKER-2-87></A>MDefaultScriptableObject</CODE> for this purpose. MacApp classes such as <CODE>TDocument</CODE> and <CODE>TWindow</CODE> already use <CODE>MScriptableObject</CODE> and are capable of responding to Apple event requests such as Move, Open, and Close. The <CODE>TApplication</CODE> class mixes in <CODE>MDefaultScriptableObject</CODE> and serves as the default target for Apple events that don't specify a target object.<P>
 MacApp provides other facilities to add a broad range of scripting capabilities to your application, but you decide just how much scripting support to add. For more information, see<B> </B><A HREF=MacAppProgGuide-48.html#MARKER-9-19>Chapter 6, "Scripting."</A><P>
<A NAME=HEADING20-37></A>
<H2>Printing</H2>
 To print the contents of a document's views, your document class collaborates with the <CODE>TStdPrintHandler</CODE> class. Anything you can display in a view can be printed. MacApp calls on your view to draw but redirects the output to the printer.<P>
 You enable MacApp's standard multipage printing capabilities by linking in the print module and writing some additional code. To add printing features such as drawing borders around the text or placing headings on every page, you extend MacApp's standard printing by overriding methods of the standard print handler class.<P>
 Simple printing of view contents is straightforward, but more complicated print requirements may require significant effort. For more information on printing, see <A HREF=MacAppProgGuide-63.html#MARKER-9-19>Chapter 8, "Displaying, Manipulating, and Printing Data."</A><P>
<A NAME=HEADING20-41></A>
<H2>Supporting Clipboard Operations</H2>
 MacApp's basic Clipboard support displays the Edit menu, shows a Clipboard view that can display <CODE>'TEXT'</CODE> and <CODE>'PICT'</CODE> data types, and calls methods of the application to interact with the Macintosh desk scrap when the application is switched in or out.<P>
 Your application builds on MacApp's hooks to support Clipboard operations on your own data types. Clipboard support is described in <A HREF=MacAppProgGuide-45.html#MARKER-9-224>"The Clipboard," beginning on page 129</A>, and in <A HREF=MacAppProgGuide-115.html#MARKER-9-19>Chapter 22, "Working With the Clipboard."</A><P>
<A NAME=HEADING20-44></A>
<H2>Supporting Drag and Drop</H2>
 During drag and drop operations, MacApp's global <CODE><A NAME=MARKER-2-88></A>gDragDropSession</CODE> object manages communication with the Drag Manager. A view that supports dragging or dropping registers with its window, and the window registers with the global drag session object. The drag session object calls your views and windows at various times during a drag. MacApp supplies a behavior class to simplify turning on drag and drop capabilities for your view classes.<P>
 Draggable views supply data to be dragged and an outline for the dragged data; they also create command objects to supply the dragged data. Droppable views supply visual feedback to show they can accept a drop and where the dropped data will be inserted; they also create commands to insert the dropped data. MacApp's drag and drop support is described in detail in <A HREF=MacAppProgGuide-72.html#MARKER-9-29>Chapter 9, "Drag and Drop."</A><P>
<A NAME=HEADING20-47></A>
<H2>Managing Idling</H2>
 MacApp provides a mechanism to parcel out idle time when the application isn't busy. The application distributes idle time to the Standard Mail Package <BR>(if the application uses it), to an attached script, to all command-handler objects and behaviors in the target chain, and to all command-handler objects and behaviors in a special chain called the <I><A NAME=MARKER-2-89></A>cohandler chain</I>.<P>
 MacApp's idle-time processing is described in <A HREF=MacAppProgGuide-40.html#MARKER-9-19>Chapter 5, "Events and Commands."</A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MacAppProgGuide-19.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-21.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MacAppProgGuide-3.html">&copy; Apple Computer, Inc.</A><br>25 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
