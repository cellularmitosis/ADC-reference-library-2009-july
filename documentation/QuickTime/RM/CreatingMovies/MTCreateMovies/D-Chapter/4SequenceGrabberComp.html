<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>QuickTime Movie Creation Guide: Sequence Grabber Component Functions</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Sequence Grabber Component Functions"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions" title="Sequence Grabber Component Functions"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000433" target="_top">QuickTime</a> &gt; <a href="../../../../MovieCreation-date.html#//apple_ref/doc/uid/TP30000440-TP30000433-TP30000501" target="_top">Movie Creation</a> &gt; <a href="../A-Intro/1Introduction.html#//apple_ref/doc/uid/TP40000906-IntroductiontoQuickTimeMovieCreationGuide-DontLinkElementID_142">QuickTime Movie Creation Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../C-Chapter/3SequenceGrabberComp.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../E-Chapter/5SequenceGrabberPane.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-SW1" title="Sequence Grabber Component Functions"></a>
<h1>Sequence Grabber Component Functions</h1>

<p>This chapter describes the functions that are provided by sequence grabber components. These functions are described from the perspective of an application developer. If you are developing a sequence grabber component, your component must behave as described here.</p>



<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_32">Configuring Sequence Grabber Components</a>
				
			<br/>
			
        
			
			
				<a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_33">Controlling Sequence Grabber Components</a>
				
			<br/>
			
        
			
			
				<a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_34">Working With Sequence Grabber Characteristics</a>
				
			<br/>
			
        
			
			
				<a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_35">Working With Channel Characteristics</a>
				
			<br/>
			
        
			
			
				<a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_36">Working With Channel Devices</a>
				
			<br/>
			
        
			
			
				<a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_42">Previewing and Recording Captured Data</a>
				
			<br/>
			
        
			
			
				<a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_45">Playing Captured Data and Saving It in a QuickTime Movie</a>
				
			<br/>
			
        
			
			
				<a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_52">Application-Defined Functions</a>
				
			<br/>
			
        
			
			
				<a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_64">Data Types</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_32" title="Configuring Sequence Grabber Components"></a>
<h2><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-ConfiguringSequenceGrabberComponents" title="Configuring Sequence Grabber Components"></a>Configuring Sequence Grabber Components</h2>
<p>Sequence grabber components provide a number of functions that allow you to establish the environment for grabbing or previewing digitized data. Before you can start a record or a preview operation, you must initialize the sequence grabber component, establish the channels that will be used, define the display environment for the operation, and determine the optimum screen position for the sequence grabber. In addition, if you are performing a record operation, you must define a destination movie file. The following sequence grabber component functions allow you to perform these tasks:</p>
<ul class="ul">
<li class="li"><p>You can use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGInitialize" target="_top">SGInitialize</a></code> function to initialize a sequence grabber component. Before you can call this function, you must establish a connection to the sequence grabber by calling the Component Manager’s <code><a href="../../../../../Carbon/Reference/Component_Manager/Reference/reference.html#//apple_ref/c/func/OpenDefaultComponent" target="_top">OpenDefaultComponent</a></code> or <code><a href="../../../../../Carbon/Reference/Component_Manager/Reference/reference.html#//apple_ref/c/func/OpenComponent" target="_top">OpenComponent</a></code> function.</p></li>
<li class="li"><p>The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGNewChannel" target="_top">SGNewChannel</a></code> function allows you to create channels for the sequence grabber for an operation. You can use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGNewChannelFromComponent" target="_top">SGNewChannelFromComponent</a></code> function to create a new channel using a specified channel component. Use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGDisposeChannel" target="_top">SGDisposeChannel</a></code> function to dispose of those channels that you are no longer using.</p></li>
<li class="li"><p>You can use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetIndChannel" target="_top">SGGetIndChannel</a></code> function to retrieve information about the channels that are currently in use by the sequence grabber.</p></li>
<li class="li"><p>You can use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetGWorld" target="_top">SGSetGWorld</a></code> and <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetGWorld" target="_top">SGGetGWorld</a></code> functions to establish the display environment for the sequence grabber. These functions affect only those channels that work with data that has visual information.</p></li>
<li class="li"><p>The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetDataOutput" target="_top">SGSetDataOutput</a></code> and <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetDataOutput" target="_top">SGGetDataOutput</a></code> functions allow you to identify the movie file that is currently assigned to the sequence grabber. You only use these functions when you are performing a record operation.</p></li>
<li class="li"><p>The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetDataProc" target="_top">SGSetDataProc</a></code> function allows you to assign a data function to a channel. The sequence grabber calls your data function whenever it writes movie data to the output file.</p></li>
<li class="li"><p>The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetAlignmentProc" target="_top">SGGetAlignmentProc</a></code> function allows you to determine a sequence grabber’s optimum screen position to ensure the best performance and appearance.</p></li>
</ul>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_33" title="Controlling Sequence Grabber Components"></a>
<h2><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-ControllingSequenceGrabberComponents" title="Controlling Sequence Grabber Components"></a>Controlling Sequence Grabber Components</h2>
<p>Sequence grabber components provide a full set of functions that allow your application to control the preview or record operation. You can use these functions to start and stop the operation, to pause data collection, and to retrieve a reference to the movie that is created during a record operation:</p>
<ul class="ul">
<li class="li"><p>Use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGStartPreview" target="_top">SGStartPreview</a></code> function to start a preview operation. The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGStartRecord" target="_top">SGStartRecord</a></code> function lets you start a record operation. The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGStop" target="_top">SGStop</a></code> function allows you to stop a sequence grabber component.</p></li>
<li class="li"><p>You can instruct the sequence grabber to pause by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPause" target="_top">SGPause</a></code> function. You can determine whether the sequence grabber is paused by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetPause" target="_top">SGGetPause</a></code> function.</p></li>
<li class="li"><p>You grant processing time to the sequence grabber by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGIdle" target="_top">SGIdle</a></code> function. Be sure to call this function often during record and preview operations. If your application receives an update event during a record or preview operation, you should call the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGUpdate" target="_top">SGUpdate</a></code> function.</p></li>
<li class="li"><p>You can prepare the sequence grabber for an upcoming preview or record operation by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPrepare" target="_top">SGPrepare</a></code> function. This function also allows the sequence grabber to verify that it can support the parameters you have specified. By verifying the parameters you want to use, you can improve the startup of preview and record operations. Use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGRelease" target="_top">SGRelease</a></code> function to release system resources after calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPrepare" target="_top">SGPrepare</a></code> function.</p></li>
<li class="li"><p>You can retrieve a reference to the movie created by a record operation by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetMovie" target="_top">SGGetMovie</a></code> function. You can determine the resource ID value assigned to the last movie resource created by the sequence grabber by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetLastMovieResID" target="_top">SGGetLastMovieResID</a></code> function.</p></li>
<li class="li"><p>You can extract a picture from the video source data by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGrabPict" target="_top">SGGrabPict</a></code> function.</p></li>
</ul>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_34" title="Working With Sequence Grabber Characteristics"></a>
<h2><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-WorkingWithSequenceGrabberCharacteristics" title="Working With Sequence Grabber Characteristics"></a>Working With Sequence Grabber Characteristics</h2>
<p>The characteristics that govern a sequence grabber operation fall into two main categories: those that apply to the sequence grabber component, and those that apply to an individual channel that has been created for the sequence grabber. Sequence grabber components provide a number of functions in each category. The following functions allow you to configure the characteristics of the sequence grabber component. See <span class="content_text"><a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-WorkingWithChannelCharacteristics">Working With Channel Characteristics</a></span> for information about functions that apply to a single channel.</p>
<ul class="ul">
<li class="li"><p>Use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetMaximumRecordTime" target="_top">SGSetMaximumRecordTime</a></code> function to limit the duration of a record operation. You can retrieve this time limit by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetMaximumRecordTime" target="_top">SGGetMaximumRecordTime</a></code> function.</p></li>
<li class="li"><p>The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetFlags" target="_top">SGSetFlags</a></code> function allows you to set control flags that govern an operation. Use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetFlags" target="_top">SGGetFlags</a></code> function to retrieve those flags.</p></li>
<li class="li"><p>You can obtain information about the progress of a record operation by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetStorageSpaceRemaining" target="_top">SGGetStorageSpaceRemaining</a></code> and <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetTimeRemaining" target="_top">SGGetTimeRemaining</a></code> functions.</p></li>
<li class="li"><p>You can retrieve a reference to the time base used by a sequence grabber component by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetTimeBase" target="_top">SGGetTimeBase</a></code> function.</p></li>
</ul>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_35" title="Working With Channel Characteristics"></a>
<h2><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-WorkingWithChannelCharacteristics" title="Working With Channel Characteristics"></a>Working With Channel Characteristics</h2>
<p>Sequence grabber components use channel components to obtain digitized data from external media. After you create a channel for a sequence grabber component (by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGNewChannel" target="_top">SGNewChannel</a></code> function), you must configure that channel before you start a preview or record operation. The sequence grabber component provides a number of functions that allow you to configure the characteristics of a channel component. Several of these functions work on any channel component. This section discusses these general channel configuration functions.</p>
<p>In addition, sequence grabber components provide functions that are specific to the channel type. Apple currently provides three types of channel components: video channel components, sound channel components, and text channel components. See <span class="content_text"><a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-WorkingWithVideoChannels">Working With Video Channels</a></span> for information about the sequence grabber configuration functions that work only with video channels. See <span class="content_text"><a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-WorkingWithSoundChannels">Working With Sound Channels</a></span> for information about the sequence grabber configuration functions that work only with sound channels. For information about text channels, see <span class="content_text"><a href="../H-Chapter/8TextChannelComponen.html#//apple_ref/doc/uid/TP40000906-TextChannelComponents-SW1">Text Channel Components</a></span>.</p>
<p>Here are the principal functions that help you work with sequence grabber channel charateristics:</p>
<ul class="ul">
<li class="li"><p>Use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetChannelUsage" target="_top">SGSetChannelUsage</a></code> function to specify how a channel is to be used. You can restrict a channel to use during record or preview operations. In addition, this function allows you to specify whether a channel plays during a record operation. The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetChannelUsage" target="_top">SGGetChannelUsage</a></code> function enables you to determine a channel’s usage.</p></li>
<li class="li"><p>The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetChannelInfo" target="_top">SGGetChannelInfo</a></code> function allows you to determine whether a channel has a visual or an audio representation.</p></li>
<li class="li"><p>The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetChannelPlayFlags" target="_top">SGSetChannelPlayFlags</a></code> function allows you to influence the speed and quality with which the sequence grabber displays captured data. The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetChannelPlayFlags" target="_top">SGGetChannelPlayFlags</a></code> function lets you determine these flag settings.</p></li>
<li class="li"><p>The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetChannelMaxFrames" target="_top">SGSetChannelMaxFrames</a></code> function establishes a limit on the number of frames that the sequence grabber will capture from a channel. The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetChannelMaxFrames" target="_top">SGGetChannelMaxFrames</a></code> function allows you to determine that limit.</p></li>
<li class="li"><p>The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetChannelBounds" target="_top">SGSetChannelBounds</a></code> function allows you to set the display boundary rectangle for a channel. Use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetChannelBounds" target="_top">SGGetChannelBounds</a></code> function to determine a channel’s boundary rectangle.</p></li>
<li class="li"><p>The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetChannelVolume" target="_top">SGSetChannelVolume</a></code> function allows you to control a channel’s sound volume. Use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetChannelVolume" target="_top">SGGetChannelVolume</a></code> function to determine a channel’s volume.</p></li>
<li class="li"><p>The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetChannelRefCon" target="_top">SGSetChannelRefCon</a></code> function allows you to set the value of a reference constant that is passed to your callback functions (see <span class="content_text"><a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-VideoChannelCallbackFunctions">Video Channel Callback Functions</a></span> for information about the callback functions that are supported by video channels).</p></li>
<li class="li"><p>Use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetChannelSampleDescription" target="_top">SGGetChannelSampleDescription</a></code> function to retrieve a channel’s sample description. The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetChannelTimeScale" target="_top">SGGetChannelTimeScale</a></code> function allows you to obtain the channel’s time scale.</p></li>
<li class="li"><p>You can modify or retrieve the channel’s clipping region by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetChannelClip" target="_top">SGSetChannelClip</a></code> or <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetChannelClip" target="_top">SGGetChannelClip</a></code> function. You can work with a channel’s transformation matrix by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetChannelMatrix" target="_top">SGSetChannelMatrix</a></code> and <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetChannelMatrix" target="_top">SGGetChannelMatrix</a></code> functions.</p></li>
</ul>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_36" title="Working With Channel Devices"></a>
<h2><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-WorkingWithChannelDevices" title="Working With Channel Devices"></a>Working With Channel Devices</h2>
<p>Sequence grabbers provide a number of functions that allow you to determine the device that is attached to a given sequence grabber channel. These devices allow the channel component to control the digitizing equipment. For example, video channels use video digitizer components, and sound channels use sound input drivers. Your application can use these routines to present a list of available devices to the user, allowing the user to select a specific device for each channel.</p>
<p>You may use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetChannelDeviceList" target="_top">SGGetChannelDeviceList</a></code> function to retrieve a list of devices that may be used with a specified channel. You dispose of this device list by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGDisposeDeviceList" target="_top">SGDisposeDeviceList</a></code> function. You can place one or more device names into a menu by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGAppendDeviceListToMenu" target="_top">SGAppendDeviceListToMenu</a></code> function. You can use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetChannelDevice" target="_top">SGSetChannelDevice</a></code> function to assign a device to a channel.</p>
<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_37" title="The Device List Structure"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-TheDeviceListStructure" title="The Device List Structure"></a>The Device List Structure</h3>
<p>Some of these functions use a device list structure to pass information about one or more channel devices. The <code><!--a target="_top" -->SGDeviceListRecord<!--/a--></code> data type defines the format of the device list structure.</p>

<div class="codesample"><table><tr><td scope="row"><pre>typedef struct SGDeviceListRecord {<span></span></pre></td></tr><tr><td scope="row"><pre>    short               count;                  /* count of devices */<span></span></pre></td></tr><tr><td scope="row"><pre>    short               selectedIndex;          /* current device */<span></span></pre></td></tr><tr><td scope="row"><pre>    long                reserved;               /* set to 0 */<span></span></pre></td></tr><tr><td scope="row"><pre>    SGDeviceName        entry[1];               /* device names */<span></span></pre></td></tr><tr><td scope="row"><pre>} SGDeviceListRecord, *SGDeviceListPtr, **SGDeviceList;<span></span></pre></td></tr></table></div>

<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Field</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>count</code></p></td>
<td ><p>Indicates the number of devices described by this structure. The value of this field corresponds to the number of entries in the device name array defined by the <code>entry</code> field.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>selectedIndex</code></p></td>
<td ><p>Identifies the currently active device. The value of this field corresponds to the appropriate entry in the device name array defined by the <code>entry</code> field. Note that this value is 0-relative; that is, the first entry has an index number of 0, the second's value is 1, and so on.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>reserved</code></p></td>
<td ><p>Reserved for Apple. Always set to 0.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>entry</code></p></td>
<td ><p>Contains an array of device name structures. Each structure corresponds to one valid device. The <code>count</code> field indicates the number of entries in this array. The <code>SGDeviceName</code> data type defines the format of a device name structure.</p></td>
</tr>

</table></div>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_38" title="The Device Name Structure"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-TheDeviceNameStructure" title="The Device Name Structure"></a>The Device Name Structure</h3>
<p>Device list structures contain an array of device name structures. Each device name structure identifies a single device that may be used by the channel. The <code><!--a target="_top" -->SGDeviceName<!--/a--></code> data type defines the format of a device name structure.</p>

<div class="codesample"><table><tr><td scope="row"><pre>typedef struct SGDeviceName {<span></span></pre></td></tr><tr><td scope="row"><pre>    Str63           name;                 /* device name */<span></span></pre></td></tr><tr><td scope="row"><pre>    Handle          icon;                 /* device icon */<span></span></pre></td></tr><tr><td scope="row"><pre>    long            flags;                /* flags */<span></span></pre></td></tr><tr><td scope="row"><pre>    long            refCon;               /* set to 0 */<span></span></pre></td></tr><tr><td scope="row"><pre>    long            reserved;             /* set to 0 */<span></span></pre></td></tr><tr><td scope="row"><pre>} SGDeviceName;<span></span></pre></td></tr></table></div>

<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Field</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>name</code></p></td>
<td ><p>Contains the name of the device. For video digitizer components, this field contains the component's name as specified in the component resource. For sound input drivers, this field contains the driver name.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>icon</code></p></td>
<td ><p>Contains a handle to the device's icon. Some devices may support an icon, which you may choose to present to the user. If the device does not support an icon, or if you choose not to retrieve this information (by setting the <code>sgDeviceListWithIcons</code> flag to 0 when you call the <code>SGGetChannelDeviceList</code> function), this field is set to <code>nil</code>.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>flags</code></p></td>
<td ><p>Reflects the current status of the device. The sequence grabber sets these flags when you retrieve a device list. The <code>sgDeviceNameFlagDeviceUnavailable</code> flag is defined. When set to 1, this flag indicates that this device is not currently available.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>refCon</code></p></td>
<td ><p>Reserved for Apple. Always set to 0.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>reserved</code></p></td>
<td ><p>Reserved for Apple. Always set to 0.</p></td>
</tr>

</table></div>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_39" title="Working With Video Channels"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-WorkingWithVideoChannels" title="Working With Video Channels"></a>Working With Video Channels</h3>
<p>Sequence grabber components provide a number of functions that allow you to configure the grabber’s video channels. This section describes these configuration functions, which you can use only with video channels. You can determine whether a channel has a visual representation by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetChannelInfo" target="_top">SGGetChannelInfo</a></code> function. If you want to configure a sound channel, use the functions described in <span class="content_text"><a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-WorkingWithSoundChannels">Working With Sound Channels</a></span>. If you want to configure general attributes of a channel, use the functions described in <span class="content_text"><a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-WorkingWithChannelCharacteristics">Working With Channel Characteristics</a></span>.</p>
<p>The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetSrcVideoBounds" target="_top">SGGetSrcVideoBounds</a></code> function allows you to determine the coordinates of the source video boundary rectangle. This rectangle defines the size of the source video image being captured by the video channel. You can use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetVideoRect" target="_top">SGSetVideoRect</a></code> function to specify a part of the source video boundary rectangle to be captured by the channel. The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetVideoRect" target="_top">SGGetVideoRect</a></code> function allows you to determine the active source video rectangle.</p>
<p>Typically, the sequence grabber component uses the Image Compression Manager to compress the video data it captures. You can control many aspects of this image- compression process. Use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetVideoCompressorType" target="_top">SGSetVideoCompressorType</a></code> function to specify the type of image compressor to use. You can determine the type of image compressor currently in use by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetVideoCompressorType" target="_top">SGGetVideoCompressorType</a></code> function. You can specify a particular image compressor and set many image-compression parameters by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetVideoCompressor" target="_top">SGSetVideoCompressor</a></code> function. You can determine which image compressor is being used and its parameter settings by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetVideoCompressor" target="_top">SGGetVideoCompressor</a></code> function.</p>
<p>The channel components that supply video data to a sequence grabber component typically work with a video digitizer component. (See <span class="content_text"><a href="../I-Chapter/9AboutVideoDigitizer.html#//apple_ref/doc/uid/TP40000906-AboutVideoDigitizerComponents-SW1">About Video Digitizer Components</a></span> for a description of video digitizer components.)</p>
<p>Sequence grabber components provide functions that allow you to work with a channel’s video digitizer component. You can use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetVideoDigitizerComponent" target="_top">SGGetVideoDigitizerComponent</a></code> function to determine which video digitizer component is supplying data to a specified channel component. You can set a channel’s video digitizer by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetVideoDigitizerComponent" target="_top">SGSetVideoDigitizerComponent</a></code> function. If you change any video digitizer settings by calling the video digitizer component directly, you should inform the sequence grabber component by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGVideoDigitizerChanged" target="_top">SGVideoDigitizerChanged</a></code> function.</p>
<p>Some video source data may contain unacceptable levels of visual noise or artifacts. One technique for removing this noise is to capture the image and then reduce it in size. During the size reduction process, the noise can be filtered out. Sequence grabber components provide functions that allow you to filter the input video data. The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetCompressBuffer" target="_top">SGSetCompressBuffer</a></code> function sets a filter buffer for a video channel. The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetCompressBuffer" target="_top">SGGetCompressBuffer</a></code> function returns information about your filter buffer.</p>
<p>You can work with a video channel’s frame rate by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetFrameRate" target="_top">SGSetFrameRate</a></code> and <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetFrameRate" target="_top">SGGetFrameRate</a></code> functions. You can control whether a channel uses an offscreen buffer by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetUseScreenBuffer" target="_top">SGSetUseScreenBuffer</a></code> and <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetUseScreenBuffer" target="_top">SGGetUseScreenBuffer</a></code> functions.</p>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_40" title="Working With Sound Channels"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-WorkingWithSoundChannels" title="Working With Sound Channels"></a>Working With Sound Channels</h3>
<p>Sequence grabber components provide a number of functions that allow you to configure the grabber’s sound channels. This section describes these configuration functions, which you can use only with sound channels. You can determine whether a channel has a sound representation by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetChannelInfo" target="_top">SGGetChannelInfo</a></code> function. If you want to configure a video channel, use the functions described in <span class="content_text"><a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-WorkingWithVideoChannels">Working With Video Channels</a></span>. If you want to configure general attributes of a channel, use the functions described in <span class="content_text"><a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-WorkingWithChannelCharacteristics">Working With Channel Characteristics</a></span>.</p>
<p>Use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetSoundInputDriver" target="_top">SGSetSoundInputDriver</a></code> function to specify a channel’s sound input device. You can determine a channel’s sound input device by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetSoundInputDriver" target="_top">SGGetSoundInputDriver</a></code> function. If you change any attributes of the sound input device, you should notify the sequence grabber component by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSoundInputDriverChanged" target="_top">SGSoundInputDriverChanged</a></code> function. By default, the sequence grabber component uses the sound driver’s best settings.</p>
<p>You can control the amount of sound data the sequence grabber works with at one time by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetSoundRecordChunkSize" target="_top">SGSetSoundRecordChunkSize</a></code> function. You can determine this value by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetSoundRecordChunkSize" target="_top">SGGetSoundRecordChunkSize</a></code> function.</p>
<p>You can control the rate at which the sound channel samples the input data by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetSoundInputRate" target="_top">SGSetSoundInputRate</a></code> function. You can determine the sample rate by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetSoundInputRate" target="_top">SGGetSoundInputRate</a></code> function.</p>
<p>You can control other sound input parameters by using the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetSoundInputParameters" target="_top">SGSetSoundInputParameters</a></code> and <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetSoundInputParameters" target="_top">SGGetSoundInputParameters</a></code> functions.</p>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_41" title="Video Channel Callback Functions"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-VideoChannelCallbackFunctions" title="Video Channel Callback Functions"></a>Video Channel Callback Functions</h3>
<p>Sequence grabber components allow you to define a number of callback functions in your application. The sequence grabber calls your functions at specific points in the process of collecting, compressing, and displaying the source video data. By defining callback functions, you can control the process more precisely or customize the operation of the sequence grabber component.</p>
<p>For example, you could use a callback function to draw a frame number on each video frame as it is collected. You could use either a compress callback function or a grab-complete callback function to accomplish this. The compress callback function is called after each frame is collected, in order to compress the frame. The grab-complete callback function is called just before the compress callback function, as soon as the frame has been captured.</p>
<p>The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetVideoBottlenecks" target="_top">SGSetVideoBottlenecks</a></code> function lets you assign callback functions to a video channel. You can use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetVideoBottlenecks" target="_top">SGGetVideoBottlenecks</a></code> function to determine the callback functions that have been assigned to a video channel.</p>
<p>The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetVideoBottlenecks" target="_top">SGSetVideoBottlenecks</a></code> function accepts a video bottlenecks structure that identifies the callback functions to be assigned to the channel. In addition, the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetVideoBottlenecks" target="_top">SGGetVideoBottlenecks</a></code> function contains a pointer to this structure.</p>
<p>The video bottlenecks structure is defined by the <code><!--a target="_top" -->VideoBottles<!--/a--></code> data type as follows:</p>

<div class="codesample"><table><tr><td scope="row"><pre>struct VideoBottles {<span></span></pre></td></tr><tr><td scope="row"><pre>    short                       procCount; <span></span></pre></td></tr><tr><td scope="row"><pre>    GrabProc                    grabProc; <span></span></pre></td></tr><tr><td scope="row"><pre>    GrabCompleteProc            grabCompleteProc;<span></span></pre></td></tr><tr><td scope="row"><pre>    DisplayProc                 displayProc; <span></span></pre></td></tr><tr><td scope="row"><pre>    CompressProc                compressProc; <span></span></pre></td></tr><tr><td scope="row"><pre>    CompressCompleteProc        compressCompleteProc;<span></span></pre></td></tr><tr><td scope="row"><pre>    AddFrameProc                addFrameProc;<span></span></pre></td></tr><tr><td scope="row"><pre>    TransferFrameProc           transferFrameProc;<span></span></pre></td></tr><tr><td scope="row"><pre>    GrabCompressCompleteProc    grabCompressCompleteProc;<span></span></pre></td></tr><tr><td scope="row"><pre>    DisplayCompressProc         displayCompressProc;<span></span></pre></td></tr><tr><td scope="row"><pre>};<span></span></pre></td></tr><tr><td scope="row"><pre>typedef struct VideoBottles VideoBottles;<span></span></pre></td></tr></table></div>

<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Field</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>procCount</code></p></td>
<td ><p>Specifies the number of callback functions that may be identified in the structure. Set this field to 9.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>grabProc</code></p></td>
<td ><p>Identifies the grab function. If you are setting a grab function, set this field so that it points to the function's entry point. If you are not setting a grab function, set this field to <code>nil</code>.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>grabCompleteProc</code></p></td>
<td ><p>Identifies the grab-complete function. If you are setting a grab-complete function, set this field so that it points to the function's entry point. If you are not setting a grab-complete function, set this field to <code>nil</code>.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>displayProc</code></p></td>
<td ><p>Identifies the display function. If you are setting a display function, set this field so that it points to the function's entry point. If you are not setting a display function, set this field to <code>nil</code>.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>compressProc</code></p></td>
<td ><p>Identifies the compress function. If you are setting a compress function, set this field so that it points to the function's entry point. If you are not setting a compress function, set this field to <code>nil</code>.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>compressCompleteProc</code></p></td>
<td ><p>Identifies the compress-complete function. If you are setting a compress-complete function, set this field so that it points to the function's entry point. If you are not setting a compress-complete function, set this field to <code>nil</code>.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>addFrameProc</code></p></td>
<td ><p>Identifies the add-frame function. If you are setting an add-frame function, set this field so that it points to the function's entry point. If you are not setting an add-frame function, set this field to <code>nil</code>.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>transferFrameProc</code></p></td>
<td ><p>Identifies the transfer-frame function. If you are setting a transfer-frame function, set this field so that it points to the function's entry point. If you are not setting a transfer-frame function, set this field to <code>nil.</code></p></td>
</tr>
<tr>
<td  scope="row"><p><code>grabCompressCompleteProc</code></p></td>
<td ><p>Identifies the grab-compress-complete function. If you are setting a grab-compress-complete function, set this field so that it points to the function's entry point. If you are not setting a grab-compress-complete function, set this field to <code>nil.</code></p></td>
</tr>
<tr>
<td  scope="row"><p><code>displayCompressProc</code></p></td>
<td ><p>Identifies the display-compress function. If you are setting a display-compress function, set this field so that it points to the function's entry point. If you are not setting a display-compress function, set this field to <code>nil</code>.</p></td>
</tr>

</table></div>
<p>The callback functions listed above are described in <span class="content_text"><a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-ApplicationDefinedFunctions">Application-Defined Functions</a></span>.</p>
<p>For information about utility functions that you can use with video channel callback functions, see <span class="content_text"><a href="../G-Chapter/7UsingSequenceGrabbe.html#//apple_ref/doc/uid/TP40000906-UsingSequenceGrabberChannelComponents-UtilityFunctionsforSequenceGrabberChannelComponents">Utility Functions for Sequence Grabber Channel Components</a></span>.</p>


<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_42" title="Previewing and Recording Captured Data"></a>
<h2><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-PreviewingandRecordingCapturedData" title="Previewing and Recording Captured Data"></a>Previewing and Recording Captured Data</h2>
<p>You can use sequence grabber components in two ways: to play digitized data for the user or to save captured data in a QuickTime movie. The process of displaying data that is to be captured is called <em>previewing;</em> saving captured data in a movie is called <em>recording.</em> You can use previewing to allow the user to prepare to make a recording. If you do so, your application can move directly from the preview operation to a record operation, without stopping the process.</p>
<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_43" title="Previewing"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-Previewing" title="Previewing"></a>Previewing</h3>
<p>Previewing captured data involves playing that data for the user as it is captured. For video data, this means displaying the video images on the computer screen. For audio data, this means playing the sound through the computer’s sound system.</p>
<p>Here are the steps you must follow to preview captured data:</p>
<ol class="ol">
<li class="li"><p>First, you must open a connection to the sequence grabber component. Use the Component Manager’s <code><a href="../../../../../Carbon/Reference/Component_Manager/Reference/reference.html#//apple_ref/c/func/OpenDefaultComponent" target="_top">OpenDefaultComponent</a></code> or <code><a href="../../../../../Carbon/Reference/Component_Manager/Reference/reference.html#//apple_ref/c/func/OpenComponent" target="_top">OpenComponent</a></code> function.</p></li>
<li class="li"><p>Once you have a connection to a sequence grabber component, you must configure the component for the preview operation. Use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetGWorld" target="_top">SGSetGWorld</a></code> function to set the graphics world in which the preview is to be displayed. Allocate the appropriate channels by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGNewChannel" target="_top">SGNewChannel</a></code> function. You must call this function once for each channel to be used by the sequence grabber component. Use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetChannelUsage" target="_top">SGSetChannelUsage</a></code> function to specify that each channel is to be used for previewing. You can then use the appropriate channel configuration functions to prepare the channel for the preview operation. For video channels, use the functions discussed in <span class="content_text"><a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-WorkingWithVideoChannels">Working With Video Channels</a></span>. For sound channels, use the functions discussed in <span class="content_text"><a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-WorkingWithSoundChannels">Working With Sound Channels</a></span>.</p></li>
<li class="li"><p>You start the preview operation by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGStartPreview" target="_top">SGStartPreview</a></code> function. The sequence grabber component then begins collecting data from the channels that you have created and plays that data appropriately. You can pause and restart the preview by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPause" target="_top">SGPause</a></code> function. Use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGStop" target="_top">SGStop</a></code> function to stop the preview. During the preview operation, be sure to call the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGIdle" target="_top">SGIdle</a></code> function frequently, so that the sequence grabber and its channels can perform the operation.</p></li>
<li class="li"><p>When you are done previewing, you can start recording or close your connection to the sequence grabber component. When you close the sequence grabber component, it automatically disposes of the channels you created.</p></li>
</ol>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_44" title="Recording"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-Recording" title="Recording"></a>Recording</h3>
<p>During a record operation, a sequence grabber component collects the data it captures and formats that data into a QuickTime movie. During a record operation, the sequence grabber can also play the captured data for the user. However, the sequence grabber tries to prevent the playback from interfering with the quality of the recording process.</p>
<p>Here are the steps you must follow to record captured data:</p>
<ol class="ol">
<li class="li"><p>As with a preview operation, your application must establish a connection to a sequence grabber component. Use the Component Manager’s <code><a href="../../../../../Carbon/Reference/Component_Manager/Reference/reference.html#//apple_ref/c/func/OpenDefaultComponent" target="_top">OpenDefaultComponent</a></code> or <code><a href="../../../../../Carbon/Reference/Component_Manager/Reference/reference.html#//apple_ref/c/func/OpenComponent" target="_top">OpenComponent</a></code> function.</p></li>
<li class="li"><p>Once you have a connection to a sequence grabber component, you must configure the component for the record operation. Use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetGWorld" target="_top">SGSetGWorld</a></code> function to set the graphics world in which the data is to be displayed. Allocate the appropriate channels by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGNewChannel" target="_top">SGNewChannel</a></code> function. You must call this function once for each channel to be used by the sequence grabber component. Use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetChannelUsage" target="_top">SGSetChannelUsage</a></code> function to specify that each channel is to be used for recording. At this time, you can specify whether the sequence grabber is to play that channel’s data while recording. You can then use the appropriate channel configuration functions to prepare the channel for the record operation. For video channels, use the functions discussed in <span class="content_text"><a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-WorkingWithVideoChannels">Working With Video Channels</a></span>. For sound channels, use the functions discussed in <span class="content_text"><a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-WorkingWithSoundChannels">Working With Sound Channels</a></span>.</p></li>
<li class="li"><p>You must specify a movie file for use by the sequence grabber during the record operation. Use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetDataOutput" target="_top">SGSetDataOutput</a></code> function to specify this movie file. This function also allows you to control whether the sequence grabber adds the movie resource to the movie file and whether it replaces existing data or appends the new movie to the file.</p></li>
<li class="li"><p>You can limit the amount of data that is captured during a record operation. The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetMaximumRecordTime" target="_top">SGSetMaximumRecordTime</a></code> function establishes a time limit for the record operation. The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetChannelMaxFrames" target="_top">SGSetChannelMaxFrames</a></code> function limits the number of frames of data that the sequence grabber collects from a specific channel.</p></li>
<li class="li"><p>You start the record operation by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGStartRecord" target="_top">SGStartRecord</a></code> function. The sequence grabber component then begins collecting data from the channels you have created, stores the data in a QuickTime movie, and, optionally, plays that data appropriately. You can pause and restart the record process by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPause" target="_top">SGPause</a></code> function. During the record operation, be sure to call the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGIdle" target="_top">SGIdle</a></code> function frequently, so that the sequence grabber and its channels can perform the operation. Use the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGStop" target="_top">SGStop</a></code> function to stop recording. At this time, the sequence grabber saves the movie in your movie file, if you have chosen to do so.</p></li>
<li class="li"><p>When you are done recording, you can go back to previewing or close your connection to the sequence grabber component. When you close the sequence grabber component, it automatically disposes of the channels you created as well as any movies it has created.</p></li>
</ol>


<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_45" title="Playing Captured Data and Saving It in a QuickTime Movie"></a>
<h2><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-PlayingCapturedDataandSavingItinaQuickTimeMovie" title="Playing Captured Data and Saving It in a QuickTime Movie"></a>Playing Captured Data and Saving It in a QuickTime Movie</h2>
<p>This section supplies a sample program that shows how to use a sequence grabber component to preview and record captured data. The program is divided into groups of functions that do the following tasks:</p>
<ul class="ul">
<li class="li"><p>initialization</p></li>
<li class="li"><p>video and sound channel creation</p></li>
<li class="li"><p>sequence preview</p></li>
<li class="li"><p>capture of sound and video sequences</p></li>
<li class="li"><p>drawing over video frames during a capture operation</p></li>
</ul>
<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_46" title="Initializing a Sequence Grabber Component"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-InitializingaSequenceGrabberComponent" title="Initializing a Sequence Grabber Component"></a>Initializing a Sequence Grabber Component</h3>
<p>Listing 3-1 provides a sample function that creates and initializes a default sequence grabber component for a specified window (using the <code><a href="../../../../../Carbon/Reference/Component_Manager/Reference/reference.html#//apple_ref/c/func/OpenDefaultComponent" target="_top">OpenDefaultComponent</a></code> and <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGInitialize" target="_top">SGInitialize</a></code> functions, respectively). It then sets the graphics world of the sequence grabber component to the specified window with the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetGWorld" target="_top">SGSetGWorld</a></code> function. Note that the <code><a href="../../../../../Carbon/Reference/Component_Manager/Reference/reference.html#//apple_ref/c/func/CloseComponent" target="_top">CloseComponent</a></code> function is called for housekeeping purposes in case the sequence grabber component fails.</p>
<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_159" title="Listing 3-1Initializing a sequence grabber component"></a>
<p class="codesample"><strong>Listing 3-1&nbsp;&nbsp;</strong>Initializing a sequence grabber component</p>
<div class="codesample"><table><tr><td scope="row"><pre>SeqGrabComponent MakeSequenceGrabber (WindowPtr aWindow)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    SeqGrabComponent anSG;<span></span></pre></td></tr><tr><td scope="row"><pre>    OSErr err = noErr;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    /* open up the default sequence grabber */<span></span></pre></td></tr><tr><td scope="row"><pre>    anSG = OpenDefaultComponent (SeqGrabComponentType, 0);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (anSG) {<span></span></pre></td></tr><tr><td scope="row"><pre>        /* initialize the default sequence grabber component */<span></span></pre></td></tr><tr><td scope="row"><pre>        err = SGInitialize (anSG);<span></span></pre></td></tr><tr><td scope="row"><pre>        if (!err) {<span></span></pre></td></tr><tr><td scope="row"><pre>        /* set the sequence grabber's graphics world to the<span></span></pre></td></tr><tr><td scope="row"><pre>            specified window */<span></span></pre></td></tr><tr><td scope="row"><pre>            err = SGSetGWorld (anSG, (CGrafPtr) aWindow, nil);<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    if (err &amp;&amp; anSG) {<span></span></pre></td></tr><tr><td scope="row"><pre>        /* clean up on failure */<span></span></pre></td></tr><tr><td scope="row"><pre>        CloseComponent (anSG);<span></span></pre></td></tr><tr><td scope="row"><pre>        anSG = nil;<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    return anSG;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div>


<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_47" title="Creating a Sound Channel and a Video Channel"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-CreatingaSoundChannelandaVideoChannel" title="Creating a Sound Channel and a Video Channel"></a>Creating a Sound Channel and a Video Channel</h3>
<p>Listing 3-2 supplies a sample function that attempts to create a video channel and a sound channel for the sequence grabber component that was created in Listing 3-1. The boundaries of the video channel are set to the specifications of the <code>bounds</code> parameter. The channel’s usage is always set to allow previewing. If the value of the <code>willRecord</code> parameter is <code>true</code>, then the usage of the channel is set to allow recording also.</p>
<p>The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGNewChannel" target="_top">SGNewChannel</a></code> function uses the <code>VideoMediaType</code> constant to create a video channel and the <code>SoundMediaType</code> constant to create a sound channel. The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetChannelBounds" target="_top">SGSetChannelBounds</a></code> function specifies the boundaries of the video channel. The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetChannelUsage" target="_top">SGSetChannelUsage</a></code> function specifies whether the video and the sound channels are used for preview or record operations. The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGDisposeChannel" target="_top">SGDisposeChannel</a></code> function cleans up upon failure for each of the channels.</p>
<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_160" title="Listing 3-2Creating a sound channel and a video channel"></a>
<p class="codesample"><strong>Listing 3-2&nbsp;&nbsp;</strong>Creating a sound channel and a video channel</p>
<div class="codesample"><table><tr><td scope="row"><pre>void MakeGrabChannels (SeqGrabComponent anSG,<span></span></pre></td></tr><tr><td scope="row"><pre>                                SGChannel *videoChannel,<span></span></pre></td></tr><tr><td scope="row"><pre>                                SGChannel *soundChannel,<span></span></pre></td></tr><tr><td scope="row"><pre>                                const Rect *bounds, Boolean willRecord)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    OSErr err;<span></span></pre></td></tr><tr><td scope="row"><pre>    long usage;<span></span></pre></td></tr><tr><td scope="row"><pre>    /* figure out the usage */<span></span></pre></td></tr><tr><td scope="row"><pre>    usage = seqGrabPreview;                 /* always previewing */<span></span></pre></td></tr><tr><td scope="row"><pre>    if (willRecord)<span></span></pre></td></tr><tr><td scope="row"><pre>        usage |= seqGrabRecord;             /* sometimes recording */<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    /* create a video channel */<span></span></pre></td></tr><tr><td scope="row"><pre>    err = SGNewChannel (anSG, VideoMediaType, videoChannel);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (!err) {<span></span></pre></td></tr><tr><td scope="row"><pre>    /* set boundaries for new video channel */<span></span></pre></td></tr><tr><td scope="row"><pre>        err = SGSetChannelBounds (*videoChannel, bounds);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    /* set usage for new video channel */<span></span></pre></td></tr><tr><td scope="row"><pre>        if (!err)<span></span></pre></td></tr><tr><td scope="row"><pre>            err = SGSetChannelUsage (*videoChannel,<span></span></pre></td></tr><tr><td scope="row"><pre>                                       usage | seqGrabPlayDuringRecord);<span></span></pre></td></tr><tr><td scope="row"><pre>        if (err) {<span></span></pre></td></tr><tr><td scope="row"><pre>            /* clean up on failure */<span></span></pre></td></tr><tr><td scope="row"><pre>            SGDisposeChannel (anSG, *videoChannel);<span></span></pre></td></tr><tr><td scope="row"><pre>            *videoChannel = nil;<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    /* create a sound channel */<span></span></pre></td></tr><tr><td scope="row"><pre>    err = SGNewChannel (anSG, SoundMediaType, soundChannel);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (!err) {<span></span></pre></td></tr><tr><td scope="row"><pre>        /* set usage of new sound channel */<span></span></pre></td></tr><tr><td scope="row"><pre>        err = SGSetChannelUsage (*soundChannel, usage);<span></span></pre></td></tr><tr><td scope="row"><pre>        if (err) {<span></span></pre></td></tr><tr><td scope="row"><pre>            /* clean up on failure */<span></span></pre></td></tr><tr><td scope="row"><pre>            SGDisposeChannel(anSG, *soundChannel);<span></span></pre></td></tr><tr><td scope="row"><pre>            *soundChannel = nil;<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div>


<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_48" title="Previewing Sound and Video Sequences in a Window"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-PreviewingSoundandVideoSequencesinaWindow" title="Previewing Sound and Video Sequences in a Window"></a>Previewing Sound and Video Sequences in a Window</h3>
<p>Listing 3-3 shows how to use the sequence grabber component to preview sound and video sequences in a window. Clicking the content area of the window causes the sequence grabber to pause until the mouse button is released.</p>
<p>The Image Compression Manager’s <code><a href="../../../../Reference/QTRef_CompDecomp/Reference/reference.html#//apple_ref/c/func/GetBestDeviceRect" target="_top">GetBestDeviceRect</a></code> function helps you determine the best monitor for the window. The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGStartPreview" target="_top">SGStartPreview</a></code> function  begins the preview of the sound and video sequences. The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGIdle" target="_top">SGIdle</a></code> function grants the sequence grabber component the time it needs to preview data. The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGUpdate" target="_top">SGUpdate</a></code> function informs the sequence grabber of the update event. The Window Manager’s <code>BeginUpdate</code> and <code>EndUpdate</code> functions respond to the event. The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGPause" target="_top">SGPause</a></code> function instructs the sequence grabber to suspend and resume its preview operation. In this example, it is used to suspend the preview operation while the mouse button is held down. Finally, the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGStop" target="_top">SGStop</a></code> function halts the action of the sequence grabber component. The Component Manager’s <code><a href="../../../../../Carbon/Reference/Component_Manager/Reference/reference.html#//apple_ref/c/func/CloseComponent" target="_top">CloseComponent</a></code> function closes the component connection. The Window Manager’s <code>DisposeWindow</code> function disposes of the window.</p>
<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_161" title="Listing 3-3Previewing sound and video sequences in a window"></a>
<p class="codesample"><strong>Listing 3-3&nbsp;&nbsp;</strong>Previewing sound and video sequences in a window</p>
<div class="codesample"><table><tr><td scope="row"><pre>void CheckError(OSErr error, Str255 displayString)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    if (error == noErr) return;<span></span></pre></td></tr><tr><td scope="row"><pre>    if (displayString[0] > 0)<span></span></pre></td></tr><tr><td scope="row"><pre>        DebugStr(displayString);<span></span></pre></td></tr><tr><td scope="row"><pre>    ExitToShell();<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre>Boolean IsQuickTimeInstalled (void)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    short       error;<span></span></pre></td></tr><tr><td scope="row"><pre>    long        result;<span></span></pre></td></tr><tr><td scope="row"><pre>    error = Gestalt (gestaltQuickTime, &amp;result);<span></span></pre></td></tr><tr><td scope="row"><pre>    return (error == noErr);<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre>void initialize (void)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    OSErr err;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    InitGraf (&amp;qd.thePort);<span></span></pre></td></tr><tr><td scope="row"><pre>    InitFonts ();<span></span></pre></td></tr><tr><td scope="row"><pre>    InitWindows ();<span></span></pre></td></tr><tr><td scope="row"><pre>    InitMenus ();<span></span></pre></td></tr><tr><td scope="row"><pre>    TEInit ();<span></span></pre></td></tr><tr><td scope="row"><pre>    InitDialogs (nil);<span></span></pre></td></tr><tr><td scope="row"><pre>    MaxApplZone();<span></span></pre></td></tr><tr><td scope="row"><pre>    if (!IsQuickTimeInstalled())<span></span></pre></td></tr><tr><td scope="row"><pre>        CheckError(-1,"\pPlease install QuickTime and try again");<span></span></pre></td></tr><tr><td scope="row"><pre>    err = EnterMovies ();<span></span></pre></td></tr><tr><td scope="row"><pre>    CheckError(err,"\pUnable to initialize Movie Toolbox");<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>WindowPtr makeWindow(void)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    WindowPtr aWindow;<span></span></pre></td></tr><tr><td scope="row"><pre>    Rect windowRect = {0, 0, 120, 160};<span></span></pre></td></tr><tr><td scope="row"><pre>    Rect bestRect;<span></span></pre></td></tr><tr><td scope="row"><pre>    /* figure out the best monitor for the window */<span></span></pre></td></tr><tr><td scope="row"><pre>    GetBestDeviceRect (nil, &amp;bestRect);<span></span></pre></td></tr><tr><td scope="row"><pre>    /* put the window in the top left corner of that monitor */<span></span></pre></td></tr><tr><td scope="row"><pre>    OffsetRect(&amp;windowRect, bestRect.left + 10, bestRect.top + 50);<span></span></pre></td></tr><tr><td scope="row"><pre>    /* create the window */<span></span></pre></td></tr><tr><td scope="row"><pre>    aWindow = NewCWindow (nil, &amp;windowRect, "\pGrabber",<span></span></pre></td></tr><tr><td scope="row"><pre>                                 true, noGrowDocProc, (WindowPtr)-1,<span></span></pre></td></tr><tr><td scope="row"><pre>                                 true, 0);<span></span></pre></td></tr><tr><td scope="row"><pre>    /* and set the port to the new window */<span></span></pre></td></tr><tr><td scope="row"><pre>    SetPort(aWindow);<span></span></pre></td></tr><tr><td scope="row"><pre>    return aWindow;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>main (void)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    WindowPtr theWindow;<span></span></pre></td></tr><tr><td scope="row"><pre>    SeqGrabComponent theSG;<span></span></pre></td></tr><tr><td scope="row"><pre>    SGChannel videoChannel, soundChannel;<span></span></pre></td></tr><tr><td scope="row"><pre>    Boolean done = false;<span></span></pre></td></tr><tr><td scope="row"><pre>    OSErr err;<span></span></pre></td></tr><tr><td scope="row"><pre>    initialize();<span></span></pre></td></tr><tr><td scope="row"><pre>    theWindow = makeWindow();<span></span></pre></td></tr><tr><td scope="row"><pre>    theSG = makeSequenceGrabber(theWindow);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (!theSG) return;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    makeGrabChannels(theSG, &amp;videoChannel, &amp;soundChannel,<span></span></pre></td></tr><tr><td scope="row"><pre>                         &amp;theWindow->portRect, false);<span></span></pre></td></tr><tr><td scope="row"><pre>    if ((videoChannel == nil) &amp;&amp; (soundChannel == nil))<span></span></pre></td></tr><tr><td scope="row"><pre>        CheckError(-1,"\pNo sound or video available");<span></span></pre></td></tr><tr><td scope="row"><pre>    err = SGStartPreview(theSG);<span></span></pre></td></tr><tr><td scope="row"><pre>    CheckError(err, "\pCan't start preview");<span></span></pre></td></tr><tr><td scope="row"><pre>    while (!done) {<span></span></pre></td></tr><tr><td scope="row"><pre>        AlignmentProcRecord alignProc;<span></span></pre></td></tr><tr><td scope="row"><pre>        short part;<span></span></pre></td></tr><tr><td scope="row"><pre>        WindowPtr whichWindow;<span></span></pre></td></tr><tr><td scope="row"><pre>        EventRecord theEvent;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        GetNextEvent(everyEvent, &amp;theEvent);<span></span></pre></td></tr><tr><td scope="row"><pre>        switch (theEvent.what) {<span></span></pre></td></tr><tr><td scope="row"><pre>            case nullEvent:         /* give the sequence grabber time */<span></span></pre></td></tr><tr><td scope="row"><pre>                    err = SGIdle (theSG);<span></span></pre></td></tr><tr><td scope="row"><pre>                    if (err) done = true;<span></span></pre></td></tr><tr><td scope="row"><pre>                    break;<span></span></pre></td></tr><tr><td scope="row"><pre>            case updateEvt:if (theEvent.message == (long)theWindow) {<span></span></pre></td></tr><tr><td scope="row"><pre>                                    /* inform the sequence grabber of the<span></span></pre></td></tr><tr><td scope="row"><pre>                                        update */<span></span></pre></td></tr><tr><td scope="row"><pre>                SGUpdate(theSG,((WindowPeek)<span></span></pre></td></tr><tr><td scope="row"><pre>                                     theWindow)->updateRgn);<span></span></pre></td></tr><tr><td scope="row"><pre>                /* and swallow the update event */<span></span></pre></td></tr><tr><td scope="row"><pre>                BeginUpdate(theWindow);<span></span></pre></td></tr><tr><td scope="row"><pre>                EndUpdate(theWindow);<span></span></pre></td></tr><tr><td scope="row"><pre>            }<span></span></pre></td></tr><tr><td scope="row"><pre>            break;<span></span></pre></td></tr><tr><td scope="row"><pre>            <span></span></pre></td></tr><tr><td scope="row"><pre>            case mouseDown:part = FindWindow (theEvent.where,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                 &amp;whichWindow);<span></span></pre></td></tr><tr><td scope="row"><pre>                    if (whichWindow != theWindow) break;<span></span></pre></td></tr><tr><td scope="row"><pre>                    switch (part) {<span></span></pre></td></tr><tr><td scope="row"><pre>                        case inContent:<span></span></pre></td></tr><tr><td scope="row"><pre>                            /* pause until mouse button is<span></span></pre></td></tr><tr><td scope="row"><pre>                                released */<span></span></pre></td></tr><tr><td scope="row"><pre>                            SGPause (theSG, true);<span></span></pre></td></tr><tr><td scope="row"><pre>                            while (StillDown())<span></span></pre></td></tr><tr><td scope="row"><pre>                            ;<span></span></pre></td></tr><tr><td scope="row"><pre>                            SGPause(theSG, false);<span></span></pre></td></tr><tr><td scope="row"><pre>                            break;<span></span></pre></td></tr><tr><td scope="row"><pre>                        case inGoAway:<span></span></pre></td></tr><tr><td scope="row"><pre>                            done = TrackGoAway (theWindow,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                  theEvent.where);<span></span></pre></td></tr><tr><td scope="row"><pre>                            break;<span></span></pre></td></tr><tr><td scope="row"><pre>                        case inDrag:<span></span></pre></td></tr><tr><td scope="row"><pre>                            /* pause when dragging window so video<span></span></pre></td></tr><tr><td scope="row"><pre>                                doesn't draw in the wrong place */<span></span></pre></td></tr><tr><td scope="row"><pre>                            SGPause (theSG, true);<span></span></pre></td></tr><tr><td scope="row"><pre>                            SGGetAlignmentProc (theSG, &amp;alignProc);<span></span></pre></td></tr><tr><td scope="row"><pre>                            DragAlignedWindow (theWindow,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                     theEvent.where,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                     &amp;screenBits.bounds,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                     nil, &amp;alignProc);<span></span></pre></td></tr><tr><td scope="row"><pre>                            SGPause (theSG, false);<span></span></pre></td></tr><tr><td scope="row"><pre>                            break;<span></span></pre></td></tr><tr><td scope="row"><pre>                        }<span></span></pre></td></tr><tr><td scope="row"><pre>                        break;<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    /* clean up */<span></span></pre></td></tr><tr><td scope="row"><pre>    SGStop (theSG);<span></span></pre></td></tr><tr><td scope="row"><pre>    CloseComponent (theSG);<span></span></pre></td></tr><tr><td scope="row"><pre>    DisposeWindow (theWindow);<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div>


<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_49" title="Capturing Sound and Video Data"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-CapturingSoundandVideoData" title="Capturing Sound and Video Data"></a>Capturing Sound and Video Data</h3>
<p>Listing 3-4 uses the sequence grabber component to capture ten seconds of sound and video data. It prompts the user for the name of the file to create. The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSettingsDialog" target="_top">SGSettingsDialog</a></code> function is issued to invoke the default sound and video capture settings dialog boxes. These default dialog boxes allow the user to configure the settings for the capture operations. The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetMaximumRecordTime" target="_top">SGSetMaximumRecordTime</a></code> function indicates how long the capture operations will last. The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGStartRecord" target="_top">SGStartRecord</a></code> function specifies the time at which the capture operations will begin. The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGIdle" target="_top">SGIdle</a></code> function grants the time needed to confirm the capture operations. Finally, the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGStop" target="_top">SGStop</a></code> function and the Window Manager’s <code>DisposeWindow</code> routine are called in order to complete the capture of the sequences.</p>
<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_162" title="Listing 3-4Capturing sound and video"></a>
<p class="codesample"><strong>Listing 3-4&nbsp;&nbsp;</strong>Capturing sound and video</p>
<div class="codesample"><table><tr><td scope="row"><pre>main (void)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    WindowPtr theWindow;<span></span></pre></td></tr><tr><td scope="row"><pre>    CGrafPort tempPort;<span></span></pre></td></tr><tr><td scope="row"><pre>    SeqGrabComponent theSG;<span></span></pre></td></tr><tr><td scope="row"><pre>    SGChannel videoChannel, soundChannel;<span></span></pre></td></tr><tr><td scope="row"><pre>    OSErr err;<span></span></pre></td></tr><tr><td scope="row"><pre>    initialize();<span></span></pre></td></tr><tr><td scope="row"><pre>    theWindow = makeWindow();<span></span></pre></td></tr><tr><td scope="row"><pre>    theSG = makeSequenceGrabber(theWindow);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (!theSG) return;<span></span></pre></td></tr><tr><td scope="row"><pre>    err = setGrabFile(theSG);<span></span></pre></td></tr><tr><td scope="row"><pre>    CheckError(err, "\pNo output file");<span></span></pre></td></tr><tr><td scope="row"><pre>    makeGrabChannels (theSG, &amp;videoChannel, &amp;soundChannel,<span></span></pre></td></tr><tr><td scope="row"><pre>                             &amp;theWindow->portRect, true);<span></span></pre></td></tr><tr><td scope="row"><pre>    if ((videoChannel == nil) &amp;&amp; (soundChannel == nil))<span></span></pre></td></tr><tr><td scope="row"><pre>        CheckError(-1,"\pNo sound or video available");<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    if (videoChannel)<span></span></pre></td></tr><tr><td scope="row"><pre>        SGSettingsDialog (theSG, videoChannel, 0, nil,<span></span></pre></td></tr><tr><td scope="row"><pre>                                 DoTheRightThing, nil, 0);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (soundChannel)<span></span></pre></td></tr><tr><td scope="row"><pre>        SGSettingsDialog(theSG, soundChannel, 0, nil,<span></span></pre></td></tr><tr><td scope="row"><pre>                             DoTheRightThing, nil, 0);<span></span></pre></td></tr><tr><td scope="row"><pre>    err = SGSetMaximumRecordTime(theSG, 10 * 60);<span></span></pre></td></tr><tr><td scope="row"><pre>    CheckError(err, "\pCan't set max record time");<span></span></pre></td></tr><tr><td scope="row"><pre>    err = SGStartRecord (theSG);<span></span></pre></td></tr><tr><td scope="row"><pre>    CheckError(err, "\pCan't start record");<span></span></pre></td></tr><tr><td scope="row"><pre>    while (!err)<span></span></pre></td></tr><tr><td scope="row"><pre>        err = SGIdle (theSG);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (err == grabTimeComplete)<span></span></pre></td></tr><tr><td scope="row"><pre>        err = noErr;<span></span></pre></td></tr><tr><td scope="row"><pre>    CheckError(err, "\pError while recording");<span></span></pre></td></tr><tr><td scope="row"><pre>    err = SGStop(theSG);<span></span></pre></td></tr><tr><td scope="row"><pre>    CheckError(err, "\pError creating movie");<span></span></pre></td></tr><tr><td scope="row"><pre>    CloseComponent(theSG);<span></span></pre></td></tr><tr><td scope="row"><pre>    DisposeWindow(theWindow);<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div>


<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_50" title="Setting Up the Video Bottleneck Functions"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-SettingUptheVideoBottleneckFunctions" title="Setting Up the Video Bottleneck Functions"></a>Setting Up the Video Bottleneck Functions</h3>
<p>Listing 3-5 shows how to set up the video bottleneck functions of the sequence grabber video channel component. Inside the main event loop in Listing 3-4, you should add the following lines after you call the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetMaximumRecordTime" target="_top">SGSetMaximumRecordTime</a></code> function.</p>
<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_163" title="Listing 3-5Setting up the video bottleneck functions"></a>
<p class="codesample"><strong>Listing 3-5&nbsp;&nbsp;</strong>Setting up the video bottleneck functions</p>
<div class="codesample"><table><tr><td scope="row"><pre>    if (videoChannel) {<span></span></pre></td></tr><tr><td scope="row"><pre>        err = SGSetVideoBottlenecks (videoChannel, &amp;tempPort);<span></span></pre></td></tr><tr><td scope="row"><pre>        CheckError(err, "\pCouldn't set video bottlenecks");<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr></table></div>


<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_51" title="Drawing Information Over Video Frames During Capture"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DrawingInformationOverVideoFramesDuringCapture" title="Drawing Information Over Video Frames During Capture"></a>Drawing Information Over Video Frames During Capture</h3>
<p>Listing 3-6 shows how to use the video bottleneck functions of the sequence grabber video channel component to draw the letters “QT” over each video frame as it is captured.</p>
<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_164" title="Listing 3-6Drawing information over video frames during capture"></a>
<p class="codesample"><strong>Listing 3-6&nbsp;&nbsp;</strong>Drawing information over video frames during capture</p>
<div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult myGrabFrameComplete (SGChannel c,<span></span></pre></td></tr><tr><td scope="row"><pre>                                             short bufferNum,<span></span></pre></td></tr><tr><td scope="row"><pre>                                             Boolean *done,<span></span></pre></td></tr><tr><td scope="row"><pre>                                             long refCon)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    ComponentResult err;<span></span></pre></td></tr><tr><td scope="row"><pre>    /* call the default grab-complete function */<span></span></pre></td></tr><tr><td scope="row"><pre>   err = SGGrabFrameComplete (c, bufferNum, done);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (*done) {<span></span></pre></td></tr><tr><td scope="row"><pre>        /* frame is done */<span></span></pre></td></tr><tr><td scope="row"><pre>        CGrafPtr savePort;<span></span></pre></td></tr><tr><td scope="row"><pre>        GDHandle saveGD;<span></span></pre></td></tr><tr><td scope="row"><pre>        PixMapHandle bufferPM, savePM;<span></span></pre></td></tr><tr><td scope="row"><pre>        Rect bufferRect;<span></span></pre></td></tr><tr><td scope="row"><pre>        CGrafPtr tempPort = (CGrafPtr)refCon;<span></span></pre></td></tr><tr><td scope="row"><pre>        /* set to our temporary port */<span></span></pre></td></tr><tr><td scope="row"><pre>        GetGWorld (&amp;savePort, &amp;saveGD);<span></span></pre></td></tr><tr><td scope="row"><pre>        SetGWorld (tempPort, nil);<span></span></pre></td></tr><tr><td scope="row"><pre>        /* find out about this buffer */<span></span></pre></td></tr><tr><td scope="row"><pre>        err = SGGetBufferInfo (c, bufferNum, &amp;bufferPM, &amp;bufferRect,<span></span></pre></td></tr><tr><td scope="row"><pre>                                        nil, nil);<span></span></pre></td></tr><tr><td scope="row"><pre>        if (!err) {<span></span></pre></td></tr><tr><td scope="row"><pre>            /* set up to draw into this buffer */<span></span></pre></td></tr><tr><td scope="row"><pre>            savePM = tempPort->portPixMap;<span></span></pre></td></tr><tr><td scope="row"><pre>            SetPortPix(bufferPM);<span></span></pre></td></tr><tr><td scope="row"><pre>            /* draw some text into the buffer */<span></span></pre></td></tr><tr><td scope="row"><pre>            TextMode (srcXor);<span></span></pre></td></tr><tr><td scope="row"><pre>            MoveTo (bufferRect.right - 20, bufferRect.bottom - 14);<span></span></pre></td></tr><tr><td scope="row"><pre>            DrawString ("\pQT");<span></span></pre></td></tr><tr><td scope="row"><pre>            TextMode(srcOr);<span></span></pre></td></tr><tr><td scope="row"><pre>            /* restore temporary port */<span></span></pre></td></tr><tr><td scope="row"><pre>            SetPortPix (savePM);<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>        SetGWorld (savePort, saveGD);<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    return err;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>OSErr setupVideoBottlenecks (SGChannel videoChannel, WindowPtr w,<span></span></pre></td></tr><tr><td scope="row"><pre>                                     CGrafPtr tempPort)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    OSErr err;<span></span></pre></td></tr><tr><td scope="row"><pre>    err = SGSetChannelRefCon (videoChannel, (long)tempPort);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (!err) {<span></span></pre></td></tr><tr><td scope="row"><pre>        VideoBottles vb;<span></span></pre></td></tr><tr><td scope="row"><pre>        /* get the current bottlenecks */<span></span></pre></td></tr><tr><td scope="row"><pre>        vb.procCount = 9;<span></span></pre></td></tr><tr><td scope="row"><pre>        err = SGGetVideoBottlenecks (videoChannel, &amp;vb);<span></span></pre></td></tr><tr><td scope="row"><pre>        if (!err) {<span></span></pre></td></tr><tr><td scope="row"><pre>            /* add our GrabFrameComplete function */<span></span></pre></td></tr><tr><td scope="row"><pre>            vb.grabCompleteProc = myGrabFrameComplete;<span></span></pre></td></tr><tr><td scope="row"><pre>            err = SGSetVideoBottlenecks (videoChannel, &amp;vb);<span></span></pre></td></tr><tr><td scope="row"><pre>            /* set up the temporary port */<span></span></pre></td></tr><tr><td scope="row"><pre>            OpenCPort (tempPort);           /* create a temporary port<span></span></pre></td></tr><tr><td scope="row"><pre>                                                for drawing */<span></span></pre></td></tr><tr><td scope="row"><pre>            SetRectRgn (tempPort->visRgn, -32000, -32000, 32000,<span></span></pre></td></tr><tr><td scope="row"><pre>                             32000);        /* with a wide open visible<span></span></pre></td></tr><tr><td scope="row"><pre>                                                and clip region . . . */<span></span></pre></td></tr><tr><td scope="row"><pre>            CopyRgn (tempPort->visRgn, tempPort->clipRgn);<span></span></pre></td></tr><tr><td scope="row"><pre>                                            /* so that you can use it in<span></span></pre></td></tr><tr><td scope="row"><pre>                                                any video buffer */<span></span></pre></td></tr><tr><td scope="row"><pre>            PortChanged ((GrafPtr)tempPort);<span></span></pre></td></tr><tr><td scope="row"><pre>                                            /* tell QuickDraw about the<span></span></pre></td></tr><tr><td scope="row"><pre>                                                changes */<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    return err;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div>



<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_52" title="Application-Defined Functions"></a>
<h2><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-ApplicationDefinedFunctions" title="Application-Defined Functions"></a>Application-Defined Functions</h2>
<p>This section describes the functions that your application may supply to sequence grabber components.</p>
<ul class="ul">
<li class="li"><p>Your grab function is used by the sequence grabber component to begin the capture of a frame of video data. Your grab-complete function allows the sequence grabber component to determine whether the current frame-capture operation is complete.</p></li>
<li class="li"><p>Your display function enables the sequence grabber component to move a captured video image in an offscreen buffer into the destination buffer for the video channel.</p></li>
<li class="li"><p>The sequence grabber component uses your compress function to commence the compression of a captured video image. Your compress-complete function helps the sequence grabber component to find out if the current frame-compression operation is finished.</p></li>
<li class="li"><p>Your add-frame function lets the sequence grabber component add a frame to a movie.</p></li>
<li class="li"><p>The sequence grabber component uses your transfer-frame function to move a video frame from the capture buffer into the channel’s filter buffer.</p></li>
<li class="li"><p>You may provide two functions for use with compressed-source devices. Your grab-compress-complete function determines when the current capture and compress operation is complete. Your display-compress function decompresses and displays a frame.</p></li>
<li class="li"><p>The sequence grabber calls your data function whenever any of the grabber’s channels write data to the movie file.</p></li>
<li class="li"><p>If you call the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSettingsDialog" target="_top">SGSettingsDialog</a></code> function, you must supply a modal-dialog filter function. The interface that your function must provide is discussed on <span class="content_text"><a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-MyModalFilter">MyModalFilter</a></span>.</p></li>
</ul>
<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_53" title="MyGrabFunction"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-MyGrabFunction" title="MyGrabFunction"></a>MyGrabFunction</h3>
<p>The sequence grabber component calls your grab function in order to start capturing a frame of video data.</p>
<p>Your grab function must present the following interface:</p>

<div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult MyGrabFunction (SGChannel c,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         short bufferNum,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         long refCon);<span></span></pre></td></tr></table></div>

<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Parameter</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>c</code></p></td>
<td ><p>Specifies the reference that identifies the channel for this operation.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>bufferNum</code></p></td>
<td ><p>Identifies the buffer for this operation. You can obtain information about this buffer by calling the <code>SGGetBufferInfo</code> function.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>refCon</code></p></td>
<td ><p>Contains a reference constant value. You can set this value by calling the <code>SGSetChannelRefCon</code> function.</p></td>
</tr>

</table></div>
<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Error constant</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Value</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>cantDoThatInCurrentMode</code></p></td>
<td ><p>-9402</p></td>
<td ><p>Request invalid in current mode</p></td>
</tr>

</table></div>
<p>Your grab function can use the sequence grabber component’s <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGrabFrame" target="_top">SGGrabFrame</a></code> function to support the default behavior.</p>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_54" title="MyGrabCompleteFunction"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-MyGrabCompleteFunction" title="MyGrabCompleteFunction"></a>MyGrabCompleteFunction</h3>
<p>The sequence grabber component calls your grab-complete function in order to determine whether the current frame-capture operation is complete. Once a frame has been completely captured, you can modify its contents to suit your needs. For example, you can overlay text onto the video image.</p>
<p>Your function must present the following interface:</p>

<div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult MyGrabCompleteFunction (SGChannel c,<span></span></pre></td></tr><tr><td scope="row"><pre>                                          short bufferNum,<span></span></pre></td></tr><tr><td scope="row"><pre>                                          Boolean *done,<span></span></pre></td></tr><tr><td scope="row"><pre>                                          long refCon);<span></span></pre></td></tr></table></div>

<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Parameter</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>c</code></p></td>
<td ><p>Specifies the reference that identifies the channel for this operation.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>bufferNum</code></p></td>
<td ><p>Identifies the buffer for this operation. You can obtain information about this buffer by calling the <code>SGGetBufferInfo</code> function.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>done</code></p></td>
<td ><p>Contains a pointer to a Boolean value. Your function sets this Boolean value to indicate whether the frame has been completely captured. Set the Boolean value to <code>true</code> if the capture is complete; set it to <code>false</code> if it is incomplete.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>refCon</code></p></td>
<td ><p>Contains a reference constant value. You can set this value by calling the <code>SGSetChannelRefCon</code> function.</p></td>
</tr>

</table></div>
<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Error constant</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Value</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>cantDoThatInCurrentMode</code></p></td>
<td ><p>-9402</p></td>
<td ><p>Request invalid in current mode</p></td>
</tr>

</table></div>
<p>Your grab-complete function can use the sequence grabber component’s <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGrabFrameComplete" target="_top">SGGrabFrameComplete</a></code> function to support the default behavior.</p>
<p>See Listing 3-6 for a sample grab-complete function. This function draws the letters “QT” over each video frame in the sequence.</p>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_55" title="MyDisplayFunction"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-MyDisplayFunction" title="MyDisplayFunction"></a>MyDisplayFunction</h3>
<p>The sequence grabber component calls your display function in order to transfer a captured video image in an offscreen buffer into the destination buffer for the video channel.</p>
<p>Your display function must support the following interface:</p>

<div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult MyDisplayFunction (SGChannel c,<span></span></pre></td></tr><tr><td scope="row"><pre>                                          short bufferNum,<span></span></pre></td></tr><tr><td scope="row"><pre>                                          MatrixRecord *mp,<span></span></pre></td></tr><tr><td scope="row"><pre>                                          RgnHandle clipRgn,<span></span></pre></td></tr><tr><td scope="row"><pre>                                          long refCon);<span></span></pre></td></tr></table></div>

<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Parameter</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>c</code></p></td>
<td ><p>Specifies the reference that identifies the channel for this operation.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>bufferNum</code></p></td>
<td ><p>Identifies the buffer for this operation. You can obtain information about this buffer by calling the <code>SGGetBufferInfo</code> function.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>mp</code></p></td>
<td ><p>Contains a pointer to a transformation matrix for the display operation. If there is no matrix for the operation, this parameter is set to <code>nil</code>.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>clipRgn</code></p></td>
<td ><p>Contains a handle to the clipping region for the destination image. This region is defined in the destination coordinate system. Apply the clipping region after applying the transformation matrix. If there is no clipping region, this parameter is set to <code>nil.</code></p></td>
</tr>
<tr>
<td  scope="row"><p><code>refCon</code></p></td>
<td ><p>Contains a reference constant value. You can set this value by calling the <code>SGSetChannelRefCon</code> function.</p></td>
</tr>

</table></div>
<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Error constant</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Value</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>cantDoThatInCurrentMode</code></p></td>
<td ><p>-9402</p></td>
<td ><p>Request invalid in current mode</p></td>
</tr>

</table></div>
<p>Your application sets the destination buffer by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetChannelBounds" target="_top">SGSetChannelBounds</a></code> function.</p>
<p>Your display function can use the sequence grabber component’s <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGDisplayFrame" target="_top">SGDisplayFrame</a></code> function to support the default behavior.</p>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_56" title="MyCompressFunction"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-MyCompressFunction" title="MyCompressFunction"></a>MyCompressFunction</h3>
<p>The sequence grabber component calls your compress function in order to start compressing the captured video image.</p>
<p>Your compress function must support the following interface:</p>

<div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult MyCompressFunction (SGChannel c,<span></span></pre></td></tr><tr><td scope="row"><pre>                                          short bufferNum,<span></span></pre></td></tr><tr><td scope="row"><pre>                                          long refCon);<span></span></pre></td></tr></table></div>

<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Parameter</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>c</code></p></td>
<td ><p>Specifies the reference that identifies the channel for this operation.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>bufferNum</code></p></td>
<td ><p>Identifies the buffer for this operation. You can obtain information about this buffer by calling the <code>SGGetBufferInfo</code> function.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>refCon</code></p></td>
<td ><p>Contains a reference constant value. You can set this value by calling the <code>SGSetChannelRefCon</code> function.</p></td>
</tr>

</table></div>
<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Error constant</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Value</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>cantDoThatInCurrentMode</code></p></td>
<td ><p>-9402</p></td>
<td ><p>Request invalid in current mode</p></td>
</tr>

</table></div>
<p>Your compress function can use the sequence grabber component’s <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGCompressFrame" target="_top">SGCompressFrame</a></code> function to support the default behavior. This function uses the Image Compression Manager to compress the video image.</p>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_57" title="MyCompressCompleteFunction"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-MyCompressCompleteFunction" title="MyCompressCompleteFunction"></a>MyCompressCompleteFunction</h3>
<p>The sequence grabber component calls your compress-complete function in order to determine whether the current frame-compression operation is complete.</p>
<p>Your compress-complete function must support the following interface:</p>

<div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult MyCompressCompleteFunction (SGChannel c,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         short bufferNum,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         Boolean *done,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         SGCompressInfo *ci,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         long refCon);<span></span></pre></td></tr></table></div>

<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Parameter</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>c</code></p></td>
<td ><p>Specifies the reference that identifies the channel for this operation.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>bufferNum</code></p></td>
<td ><p>Identifies the buffer for this operation. You can obtain information about this buffer by calling the <code>SGGetBufferInfo</code> function.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>done</code></p></td>
<td ><p>Contains a pointer to a Boolean value. Your function sets this Boolean value to indicate whether the frame has been completely compressed. Set the Boolean value to <code>true</code> if the compression is complete; set it to <code>false</code> if it is incomplete.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>ci</code></p></td>
<td ><p>Contains a pointer to a compression information structure (defined by the <code>SGCompressInfo</code> data type). If the compression is complete, your function must completely format this structure with information that is appropriate to the frame just compressed.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>refCon</code></p></td>
<td ><p>Contains a reference constant value. You can set this value by calling the <code>SGSetChannelRefCon</code> function.</p></td>
</tr>

</table></div>
<p>See <span class="content_text"><a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-TheCompressionInformationStructure">The Compression Information Structure</a></span>, for a description of the <code><!--a target="_top" -->SGCompressInfo<!--/a--></code> data type.</p>
<p>Once a frame has been completely compressed, you can add it to the movie. Your compress-complete function can use the sequence grabber component’s <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGCompressFrameComplete" target="_top">SGCompressFrameComplete</a></code> function to support the default behavior.</p>
<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Error constant</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Value</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>cantDoThatInCurrentMode</code></p></td>
<td ><p>-9402</p></td>
<td ><p>Request invalid in current mode</p></td>
</tr>

</table></div>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_58" title="MyAddFrameFunction"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-MyAddFrameFunction" title="MyAddFrameFunction"></a>MyAddFrameFunction</h3>
<p>The sequence grabber component calls your add-frame function in order to add a frame to a movie. Your add-frame function must support the following interface:</p>

<div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult MyAddFrameFunction (SGChannel c,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         short bufferNum,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         TimeValue atTime,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         TimeScale scale,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         SGCompressInfo *ci,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         long refCon);<span></span></pre></td></tr></table></div>

<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Parameter</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>c</code></p></td>
<td ><p>Specifies the reference that identifies the channel for this operation.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>bufferNum</code></p></td>
<td ><p>Identifies the buffer for this operation. You can obtain information about this buffer by calling the <code>SGGetBufferInfo</code> function.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>atTime</code></p></td>
<td ><p>Specifies the time at which the frame was captured, in the time scale specified by the <code>scale</code> parameter. Your add-frame function can change this value before adding the frame to the movie or before calling the <code>SGAddFrame</code> function. You can determine the duration of a frame by subtracting its capture time from the capture time of the next frame in the sequence.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>scale</code></p></td>
<td ><p>Specifies the time scale of the movie. You must not change this value.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>ci</code></p></td>
<td ><p>Contains a pointer to a compression information structure (defined by the <code>SGCompressInfo</code> data type). This structure contains information describing the compression characteristics of the image to be added to the movie.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>refCon</code></p></td>
<td ><p>Contains a reference constant value. You can set this value by calling the <code>SGSetChannelRefCon</code> function.</p></td>
</tr>

</table></div>
<p>See <span class="content_text"><a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-TheCompressionInformationStructure">The Compression Information Structure</a></span>, for a description of the <code><!--a target="_top" -->SGCompressInfo<!--/a--></code> data type.</p>
<p>You can use your add-frame function to modify the contents of the frame before it is added to the movie. This can be useful if you want to place frame numbers onto frames you are recording.</p>
<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Error constant</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Value</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>cantDoThatInCurrentMode</code></p></td>
<td ><p>-9402</p></td>
<td ><p>Request invalid in current mode</p></td>
</tr>

</table></div>
<p>Your add-frame function can use the sequence grabber component’s <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGAddFrame" target="_top">SGAddFrame</a></code> function to support the default behavior.</p>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_59" title="MyTransferFrameFunction"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-MyTransferFrameFunction" title="MyTransferFrameFunction"></a>MyTransferFrameFunction</h3>
<p>The sequence grabber component calls your transfer-frame function in order to move a video frame from the capture buffer into the channel’s filter buffer.</p>
<p>Your transfer-frame function must support the following interface:</p>

<div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult MyTransferFrameFunction (SGChannel c,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         short bufferNum,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         MatrixRecord *mp,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         RgnHandle clipRgn,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         long refCon);<span></span></pre></td></tr></table></div>

<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Parameter</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>c</code></p></td>
<td ><p>Specifies the reference that identifies the channel for this operation.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>bufferNum</code></p></td>
<td ><p>Identifies the buffer for this operation. You can obtain information about this buffer by calling the <code>SGGetBufferInfo</code> function.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>mp</code></p></td>
<td ><p>Contains a pointer to a transformation matrix for the transfer operation. If there is no matrix for the operation, this parameter is set to <code>nil</code>.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>clipRgn</code></p></td>
<td ><p>Contains a handle to the clipping region for the destination image. This region is defined in the destination coordinate system. Apply the clipping region after applying the transformation matrix. If there is no clipping region, this parameter is set to <code>nil</code>.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>refCon</code></p></td>
<td ><p>Contains a reference constant value. You can set this value by calling the <code>SGSetChannelRefCon</code> function.</p></td>
</tr>

</table></div>
<p>The sequence grabber component calls this function only when you are filtering the video data. By filtering the video data through a filter buffer, you can eliminate some visual artifacts that result from noisy input video sources. Your application sets a filter buffer by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetCompressBuffer" target="_top">SGSetCompressBuffer</a></code> function.</p>
<p>If you are using a grab-complete function to determine when frames have been grabbed, you should also implement a grab-compress-complete function (described in the next section). Otherwise, the channel will decompress the specified image before calling your grab-complete function, which will result in significantly lower performance. For details on grab-complete functions, see <span class="content_text"><a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-MyGrabCompleteFunction">MyGrabCompleteFunction</a></span>.</p>
<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Error constant</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Value</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>cantDoThatInCurrentMode</code></p></td>
<td ><p>-9402</p></td>
<td ><p>Request invalid in current mode</p></td>
</tr>

</table></div>
<p>Your transfer-frame function can use the sequence grabber component’s <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGTransferFrameForCompress" target="_top">SGTransferFrameForCompress</a></code> function to support the default behavior.</p>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_60" title="MyGrabCompressCompleteFunction"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-MyGrabCompressCompleteFunction" title="MyGrabCompressCompleteFunction"></a>MyGrabCompressCompleteFunction</h3>
<p>The sequence grabber calls your grab-compress-complete function when it is working with a video digitizer that supports compressed source data. Your grab-compress-complete function is responsible for determining whether the current compressed frame has been completely captured and compressed, essentially combining your grab-complete, compress, and compress-complete functions into one function.</p>
<p>Your function must support the following interface:</p>

<div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult MyGrabCompressCompleteFunction<span></span></pre></td></tr><tr><td scope="row"><pre>                                         (SGChannel c,<span></span></pre></td></tr><tr><td scope="row"><pre>                                          Boolean *done,<span></span></pre></td></tr><tr><td scope="row"><pre>                                          SGCompressInfo *ci,<span></span></pre></td></tr><tr><td scope="row"><pre>                                          TimeRecord *tr,<span></span></pre></td></tr><tr><td scope="row"><pre>                                          long refCon);<span></span></pre></td></tr></table></div>

<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Parameter</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>c</code></p></td>
<td ><p>Identifies the channel for this operation.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>done</code></p></td>
<td ><p>Contains a pointer to a Boolean value. Set this Boolean value to indicate whether you are finished. Set it to <code>true</code> when you are done; set it to <code>false</code> if the operation is incomplete.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>ci</code></p></td>
<td ><p>Contains a pointer to a compression information structure. When the operation is complete, fill in this structure with information about the compression operation.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>tr</code></p></td>
<td ><p>Contains a pointer to a time record. When the operation is complete, fill in this structure with information indicating when the frame was grabbed.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>refCon</code></p></td>
<td ><p>Contains a reference constant value. You can set this value by calling the <code>SGSetChannelRefCon</code> function.</p></td>
</tr>

</table></div>
<p>See <span class="content_text"><a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-TheCompressionInformationStructure">The Compression Information Structure</a></span>, for a description of the <code><!--a target="_top" -->SGCompressInfo<!--/a--></code> data type.</p>
<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Error constant</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Value</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>cantDoThatInCurrentMode</code></p></td>
<td ><p>-9402</p></td>
<td ><p>Request invalid in current mode</p></td>
</tr>

</table></div>
<p>Your grab-compress-complete function may use the sequence grabber’s <code><a href="../../../../QT6WhatsNew/Chap1/QT6WhatsNew.html#//apple_ref/c/func/SGGrabCompressComplete" target="_top">SGGrabCompressComplete</a></code> function to support the default behavior.</p>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_61" title="MyDisplayCompressFunction"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-MyDisplayCompressFunction" title="MyDisplayCompressFunction"></a>MyDisplayCompressFunction</h3>
<p>The sequence grabber calls your display-compress function when it is working with a video digitizer component that supports compressed source data. Your display-compress function is responsible for decompressing and displaying a compressed image.</p>

<div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult MyDisplayCompressFunction (SGChannel c,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         Ptr dataPtr,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         ImageDescriptionHandle desc,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         MatrixRecord *mp,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         RgnHandle clipRgn,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         long refCon);<span></span></pre></td></tr></table></div>

<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Parameter</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>c</code></p></td>
<td ><p>Identifies the channel for this operation. The sequence grabber provides this value to your display-compress function.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>dataPtr</code></p></td>
<td ><p>Contains a pointer to the compressed image data.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>desc</code></p></td>
<td ><p>Specifies a handle to the image description structure to use for the decompression operation.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>mp</code></p></td>
<td ><p>Contains a pointer to a matrix structure. This matrix structure contains the transformation matrix to use when displaying the image. If there is no matrix for the operation, this parameter is set to <code>nil</code>.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>clipRgn</code></p></td>
<td ><p>Contains a handle to the clipping region for the destination image. This region is defined in the destination coordinate system. Apply the clipping region after the transformation matrix. If there is no clipping region, this parameter is set to <code>nil</code>.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>refCon</code></p></td>
<td ><p>Contains a reference constant value. You can set this value by calling the <code>SGSetChannelRefCon</code> function.</p></td>
</tr>

</table></div>
<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Error constant</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Value</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>cantDoThatInCurrentMode</code></p></td>
<td ><p>-9402</p></td>
<td ><p>Request invalid in current mode</p></td>
</tr>

</table></div>
<p>Your display-compress function may use the sequence grabber’s <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGDisplayCompress" target="_top">SGDisplayCompress</a></code> function to support the default behavior.</p>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_62" title="MyDataFunction"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-MyDataFunction" title="MyDataFunction"></a>MyDataFunction</h3>
<p>The sequence grabber calls your data function whenever any of the grabber’s channels write digitized data to the destination movie file. You assign a data function to the sequence grabber by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetDataProc" target="_top">SGSetDataProc</a></code> function.</p>
<p>Your data function must support the following interface:</p>

<div class="codesample"><table><tr><td scope="row"><pre>pascal OSErr MyDataFunction (SGChannel c, Ptr p, long len,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         long *offset, long chRefCon,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         TimeValue time, short writeType,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         long refCon);<span></span></pre></td></tr></table></div>

<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Parameter</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>c</code></p></td>
<td ><p>Identifies the channel component that is writing the digitized data.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>p</code></p></td>
<td ><p>Contains a pointer to the digitized data.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>len</code></p></td>
<td ><p>Indicates the number of bytes of digitized data.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>offset</code></p></td>
<td ><p>Contains a pointer to a field that may specify where you are to write the digitized data, and that is to receive a value indicating where you wrote the data. You must update the field referred to by this parameter, supplying the value indicated by the <code>writeType</code> parameter.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>chRefCon</code></p></td>
<td ><p>Contains control information. The low-order 16 bits contain sample flags for use by the Movie Toolbox's <code>AddMediaSample</code> function. The sequence grabber sets these flags as appropriate. The high-order 16 bits are reserved for Apple and are always set to 0.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>time</code></p></td>
<td ><p>Identifies the starting time of the data, in the channel's time scale. You may use the <code>SGGetChannelTimeScale</code> function to retrieve the channel's time scale.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>writeType</code></p></td>
<td ><p>Indicates the type of write operation being performed.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>refCon</code></p></td>
<td ><p>Contains the reference constant you specified when you assigned your data function to the sequence grabber.</p></td>
</tr>

</table></div>
<p>The following values are defined for the <code>writeType</code> parameter:</p>
<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Constant</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>seqGrabWriteAppend</code></p></td>
<td ><p>Append the new data to the end of the file. Set the field referred to by the offset parameter to reflect the location at which you added the data.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>seqGrabWriteReserve</code></p></td>
<td ><p>Do not write any data to the output file. Instead, reserve space in the output file for the amount of data indicated by the <code>len</code> parameter. Set the field referred to by the <code>offset</code> parameter to the location of the reserved space.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>seqGrabWriteFill</code></p></td>
<td ><p>Write the data into the location specified by the field referred to by the <code>offset</code> parameter. Set that field to the location of the byte following the last byte you wrote. This option is used to fill the space reserved previously when the <code>writeType</code> parameter was set to <code>seqGrabWriteReserve.</code> Note that the sequence grabber may call your data function several times to fill a single reserved location.</p></td>
</tr>

</table></div>
<p>The sequence grabber calls your data function whenever any channel component writes data to the destination movie. You may use your data function to store the digitized data in some format other than a QuickTime movie.</p>
<p>You can instruct the sequence grabber not to write its data to a QuickTime movie by calling the <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSetDataOutput" target="_top">SGSetDataOutput</a></code> function and setting the <code>seqGrabDontMakeMovie</code> flag to 1. This can save processing time in cases where you do not want to create or update a movie.</p>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_63" title="MyModalFilter"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-MyModalFilter" title="MyModalFilter"></a>MyModalFilter</h3>
<p>The <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSettingsDialog" target="_top">SGSettingsDialog</a></code> function causes the sequence grabber to present its settings dialog box to the user. This is a movable modal dialog box, so you must provide a filter function to handle update events in your window. You specify your filter function with the <code>proc</code> parameter.</p>
<p>A modal-dialog filter function whose address is passed to <code><a href="../../../../Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGSettingsDialog" target="_top">SGSettingsDialog</a></code> should support the following interface:</p>

<div class="codesample"><table><tr><td scope="row"><pre>pascal Boolean MyModalFilter (DialogPtr theDialog,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         EventRecord *theEvent,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         short *itemHit, long refCon);<span></span></pre></td></tr></table></div>

<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Parameter</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>theDialog</code></p></td>
<td ><p>Points to the settings dialog box's dialog structure.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>theEvent</code></p></td>
<td ><p>Contains a pointer to an event structure. This event structure contains information identifying the nature of the event.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>itemHit</code></p></td>
<td ><p>Contains a pointer to a field that contains the item selected by the user. If you handle the event, you should update this field to reflect the item number of the selected item.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>refCon</code></p></td>
<td ><p>Contains a reference constant. You provide this reference constant to the sequence grabber in the <code>procRefNum</code> parameter of the <code>SGSettingsDialog</code> function.</p></td>
</tr>

</table></div>
<p>Your modal-dialog filter function returns a Boolean value that indicates whether you handled the event. Set this value to <code>true</code> if you handled the event; otherwise, set it to <code>false</code>. If you handle the event, be sure to update the value of the field referred to by the <code>itemHit</code> parameter.</p>


<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_64" title="Data Types"></a>
<h2><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DataTypes" title="Data Types"></a>Data Types</h2>
<p>This section describes the compression information structure and the sequence grabber frame information structure.</p>
<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_65" title="The Compression Information Structure"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-TheCompressionInformationStructure" title="The Compression Information Structure"></a>The Compression Information Structure</h3>
<p>The compression information structure defines the characteristics of a buffer that contains a captured image that has been compressed. Callback functions use compression information structures to exchange information about compressed images. For example, the compress-complete function must format a compression information record whenever a video frame is compressed (see <span class="content_text"><a href="4SequenceGrabberComp.html#//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-MyCompressCompleteFunction">MyCompressCompleteFunction</a></span> for more information about the compress-complete callback function). The <code><!--a target="_top" -->SGCompressInfo<!--/a--></code> data type defines a compression information structure.</p>

<a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_66" title="Frame Information Structure"></a>
<h3><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-FrameInformationStructure" title="Frame Information Structure"></a>Frame Information Structure</h3>
<p>The frame information structure defines a frame for a sequence grabber component and its sequence grabber channel components. The <code><!--a target="_top" -->SeqGrabExtendedFrameInfo<!--/a--></code> data type defines the format of a frame information structure. <code><!--a target="_top" -->SeqGrabExtendedFrameInfo<!--/a--></code> is an extension of <code><!--a target="_top" -->SeqGrabFrameInfo<!--/a--></code>, adding a new <code>frameOutput</code> field and extending the <code>frameOffset</code> field to 64 bits.</p>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40000906-SequenceGrabberComponentFunctions-DontLinkElementID_165" title="Note"></a>
<p><strong>Note:</strong>&nbsp;
You only need to know about the frame information structure if you are creating a sequence grabber component. If you are not creating a sequence grabber component, you may skip this section.  </p>
</div>





        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../C-Chapter/3SequenceGrabberComp.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../E-Chapter/5SequenceGrabberPane.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2005, 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-01-08<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/QuickTime/RM/CreatingMovies/MTCreateMovies/D-Chapter/4SequenceGrabberComp.html%3Fid%3DTP40000906-3.1&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/QuickTime/RM/CreatingMovies/MTCreateMovies/D-Chapter/4SequenceGrabberComp.html%3Fid%3DTP40000906-3.1&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/QuickTime/RM/CreatingMovies/MTCreateMovies/D-Chapter/4SequenceGrabberComp.html%3Fid%3DTP40000906-3.1&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>