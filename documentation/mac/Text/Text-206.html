<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Using Width Tables(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING206></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-205.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-207.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-181.html"><B>Chapter 4 - Font Manager</B></A> / <A HREF="Text-200.html"><B>Using the Font Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING206-0></A>
<H2><A NAME=MARKER-2-810></A><A NAME=MARKER-9-262></A>Using Width Tables</H2>
 When the Font Manager responds to a request to make a font available, the font resource is loaded into memory and the Font Manager allocates memory for various tables that are needed to use the font. To make font usage more efficient, the Font Manager maintains a cache of the tables for the most recently used fonts, so that it does not have to reread the resources and rebuild the tables more often than necessary. The Font Manager can cache the tables for up to 12 fonts. For outline fonts, the cached information includes the width tables and any bitmaps that have been created from the outlines.<A NAME=MARKER-9-178></A> <P>
 The global width table contains the widths of all the glyphs of one font. If you are measuring text to be displayed on the screen, you can use the QuickDraw procedure <CODE>MeasureText</CODE> to determine glyph widths; however, if you are printing text and need to determine glyph widths, you have to use widths from the global width table. The <CODE>OutlineMetrics</CODE> function returns the individual widths of glyphs for an outline font and the <CODE>FontMetrics</CODE> procedure returns the width of the largest glyph in a bitmapped font. You can also directly access the global width table, which is defined by the <CODE>WidthTable</CODE> data type. This data type is described in the section <A HREF=Text-213.html#MARKER-9-315>"The Global Width Table" beginning on page 4-39</A>.<P>
 To use the global width table, you can get a handle to it from the <CODE>FontMetrics</CODE> procedure, or you can use the handle stored in the global variable <CODE>WidthTabHandle</CODE>. The global variable <CODE>WidthPtr</CODE> contains a pointer to the global width table; however, this variable is reliable only immediately after a call to <CODE>FMSwapFont</CODE>. Like all pointers to data in handles, <CODE>WidthPtr</CODE> may become invalid after a call to the Memory Manager. In general, use the <CODE>WidthTabHandle</CODE> global variable instead of the <CODE>WidthPtr</CODE> global variable.<A NAME=MARKER-2-594></A><P>
 The global variable <CODE>WidthListHand</CODE> is a handle to a list of up to 12 handles to recently used width tables. You can scan this list and look for width tables that match the font family ID, size, and style of the font you wish to measure. If you reach a width-table handle that contains -1 in the <CODE>tabFont</CODE>, <CODE>fID</CODE>, and <CODE>aFID</CODE> fields, that width table is invalid. When you reach a handle that is equal to <CODE>NIL</CODE>, you have reached the end of the list.<P>
<DL>
<DT><B>IMPORTANT</B>
<DD>Do not use the values from the global width table if your application is running on a computer on which non-Roman script systems are installed. You can check to see if a non-Roman script system is present by calling the <CODE>GetScriptManagerVariable</CODE> function with a selector of <CODE>smEnabled</CODE>; if the function returns a value greater than 0, at least one non-Roman script system is present and you need to call <CODE>MeasureText</CODE> to measure text that is displayed on the screen. Measuring text from a non-Roman script system for printing is handled by the printer driver.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 If your application directly manipulates data in a font resource (for example, if your application edits fonts), you may need to flush the Font Manager's cache, so that the cached information reflects any changes that your application makes. The <CODE>FlushFonts</CODE> function, which is described on <A HREF=Text-249.html#MARKER-9-410>page 4-62</A>, erases all of the Font Manager's caches. The Font Manager then rebuilds the cache as new fonts are called into use again.<A NAME=MARKER-2-266></A><P>
 Normally, fonts are purgeable, which means that the space used for each font's resource information can be released from memory. You can temporarily prevent a font from being purged by locking it with a call to the <CODE>SetFontLock</CODE> procedure. A subsequent call to <CODE>SetFontLock</CODE> unlocks the font, allowing the Font Manager to purge it from memory. The <CODE>SetFontLock</CODE> procedure is described on <A HREF=Text-248.html#MARKER-9-407>page 4-61</A><A NAME=MARKER-2-30></A><A NAME=MARKER-9-210></A>.<P>
 If you are calculating the amount of extra width that is added to a glyph as a result of adding a font style, you can choose how you want the Font Manager to determine the extra pixels needed. It can find the information in the style property field of the font family resource or from the style extra field in the Font Manager's internal tables. If the value of the global variable <CODE>FDevDisable</CODE> is 0, the Font Manager uses the style extra value from its internal tables; if <CODE>FDevDisable</CODE> is any other value, the Font Manager uses the value from the style property field, which is described on <A HREF=Text-269.html#MARKER-9-539>page 4-88</A>.<A NAME=MARKER-2-134></A><A NAME=MARKER-21-569></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-205.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-207.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
