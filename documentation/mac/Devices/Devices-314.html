<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>About the Serial Driver(IM: D)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING314></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->




<!-- Main Body -->

<CENTER>
<P>
<A HREF="Devices-313.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Devices-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Devices-328.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Devices-315.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Devices-2.html"><B>Devices</B></A> / <BR><DD><A HREF="Devices-312.html"><B>Chapter 7 - Serial Driver</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING314-0></A>
<H1><A NAME=MARKER-9-21></A>About the Serial Driver</H1>
 The Serial Driver is a part of the Macintosh Operating System that provides low-level support for asynchronous, interrupt-driven serial data transfers through the modem and printer ports. <P>
 The Serial Driver provides routines that allow you to<P>
<UL>
<LI>initialize and terminate communication
<LI>transmit and receive data
<LI>examine and change communication settings<P>
</UL>
 You access the Serial Driver routines using standard Device Manager functions such as open, close, read, write, control, and status. The Serial Driver also includes some convenience routines that you can call from Pascal or C.<P>
 The Serial Driver supports the following communication settings<P>
<UL>
<LI>5, 6, 7, or 8 data bits per character 
<LI>odd, even, or no parity 
<LI>1, 1.5, or 2 stop bits 
<LI>300 to 57600 baud transmission rates (depending on hardware capability)
<LI>hardware or software flow control<P>
</UL>
 <A NAME=MARKER-9-18></A>The Serial Driver default settings are 9600 baud, 8 data bits per character, no parity, and 2 stop bits. Hardware handshaking is the default under System 7, although some earlier versions of the Serial Driver defaulted to software handshaking. <P>
 Additional control and status functions allow you to<P>
<UL>
<LI>determine the version number of the Serial Driver
<LI>change the input buffer from the default buffer to one that you specify 
<LI>obtain information about transmission errors such as overrun, framing, parity, and break signals. 
<LI>enable the automatic replacement of characters that have parity errors
<LI>use an external timing signal for synchronous clocking<P>
</UL>
<A NAME=HEADING314-20></A>
<H2>Macintosh Serial Architecture</H2>
 The Serial Driver consists of a set of four Macintosh device drivers and assorted convenience routines that interface to the Device Manager. Within the overall Macintosh software architecture, the location and boundaries of the Serial Driver are not sharply defined. This is because its role as mediator between applications and devices is supplemented by routines belonging to the Device Manager. <P>
 Although the hardware architecture of the serial ports varies, the Serial Driver provides a universal interface for applications. For example, some Macintosh computers use the <A NAME=MARKER-2-23></A>Zilog Z8530 Serial Communications Controller (SCC) microchip, while others use custom devices. By using the Serial Driver rather than relying on a particular hardware configuration, your application is compatible with all Macintosh computers.<P>
 <A HREF=#MARKER-9-24>Figure 7-2</A> shows the Serial Driver and its relation to the Macintosh serial architecture. Conceptually, there are three functional layers: the application layer, the system software layer, and the hardware layer. The Serial Driver, the Device Manager, and the four serial device drivers all exist within the system software layer. Although you normally access the Serial Driver through Device Manager routines, the Serial Driver interface includes a set of convenience routines such as <CODE>SerStatus</CODE> that provide a high-level interface to some functions. <P>
<B>Figure 7-2  <A NAME=MARKER-9-24></A>The role of the Serial Driver[Missing image]</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/SER-L-02.jpg"><p>
 The four device drivers that control the serial ports differ from other Macintosh device drivers in that they share common internal routines and data structures, as illustrated by the horizontal interconnecting arrows in <A HREF=#MARKER-9-24>Figure 7-2</A>. Each driver is associated with a communication channel, either Channel A or Channel B, and each channel is associated with a serial port. Channel A controls the modem port, and Channel B controls the printer port. Each channel has both an input driver and an output driver associated with it. The drivers for the modem port are named .<CODE>AIn</CODE> and .<CODE>AOut</CODE>, and those for the printer port are named .<CODE>BIn</CODE> and .<CODE>BOut</CODE>. <P>
 Each input driver receives data from a serial port and transfers it to the application. Each output driver takes data from the application and sends it out its serial port. Although the input and output drivers for a port are closely related and share some of the same routines, each driver has its own device control entry data structure. This means that read and write operations can be processed simultaneously, which allows the Serial Driver to support full-duplex communication. <P>
 Because the input and output drivers are not completely distinct entities, some functions (for example, the <CODE>SerReset</CODE> function) only need to be invoked on the output driver--the desired operation occurs on the input side as well. Note, however, that you must always explicitly open and close both the input and output drivers.<P>
<A NAME=HEADING314-29></A>
<H2>Serial Communication Errors</H2>
 Data received from the serial port passes through a hardware buffer and then into a software buffer managed by the input driver for the port. Characters are removed from the input driver's buffer each time an application calls the driver's read routine. Each input driver's buffer can initially hold up to 64 characters, but you can specify a larger buffer using the <CODE>SerSetBuf</CODE> function. You need to increase the input buffer size if the buffer fills up faster than your application can read from it, as indicated by overrun errors and lost data. <P>
 Because the serial hardware in some Macintosh computers relies on processor interrupts during I/O operations, overrun errors are possible if interrupts are disabled while data is being received at the serial port. To prevent such errors, the Disk Driver and other system software components are designed to store any data received by the modem port while they have interrupts disabled, and then pass this data to the port's input driver. Because the system software only monitors the modem port, the printer port is not recommended for two-way communication at data rates above 300 baud.<P>
<DL>
<DT><B>Note</B>
<DD>AppleTalk is not subject to the same limitations because it is not interrupt-driven and does not use the Serial Driver.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 You can use the <CODE>SerStatus</CODE> function to detect the most common serial communication errors:<P>
<UL>
<LI>Hardware overrun errors occur when the serial hardware input buffer overflows, usually because the input driver doesn't read it often enough.
<LI>Software overrun errors occur when an input driver's buffer overflows, usually because the application doesn't issue read calls to the driver often enough.
<LI>Parity errors occur when the serial hardware detects an incorrect parity bit.
<LI>Framing errors occur when the serial hardware detects an error in the stop bits.
<LI>Break errors occur when a break signal is received.<P>
</UL>
 Overrun, parity, and framing errors are usually handled by requesting that the sender retransmit the affected data. Break errors are typically initiated by the user and handled as appropriate for the particular application. When an input driver receives a break signal, it terminates any pending read requests. You can terminate pending write requests by sending a <CODE>KillIO</CODE> request to the output driver.<P>

</BLOCKQUOTE>
<HR>
<center>
<A HREF="Devices-313.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Devices-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Devices-328.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Devices-315.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Devices-3.html">&copy; Apple Computer, Inc.</A><br>3 JUL 1996</center></font><P>
<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->
</BODY>
</HTML>  
