<!-- legacy work start -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<!-- legacy work end -->


<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)

LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Creating, Using, and Disposing of a Speech Channel (IM: S)  (deprecated)</Title>

<!-- legacy work start -->
        <META NAME="Generator" CONTENT="manual">
        <META http-equiv="content-type" CONTENT="text/html;charset=utf-8">
        <META NAME = "Copyright" CONTENT="Copyright 2007 Apple Inc. All Rights Reserved.">
        <META NAME="IndexTitle" CONTENT="Inside Macintosh: Sound (Not Recommended)">
        <meta name="xcode-display" content="render">

        <LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css"> <!-- before submitting, globally replace ".." with "developer.apple.com" -->
        <script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
<!-- legacy work end -->

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<A NAME=HEADING195></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Sound-194.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Sound-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Sound-336.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Sound-196.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Sound-2.html"><B>Sound</B></A> / <BR><DD><A HREF="Sound-187.html"><B>Chapter 4 - Speech Manager</B></A> / <A HREF="Sound-193.html"><B>Using the Speech Manager</B></A></DL></FONT><P>
<HR>

<!-- legacy work start -->
<script type="text/javascript"> placeWatermark()</script>
<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
<i>Inside Macintosh: Sound</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="http://developer.apple.com/referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div>
<!-- legacy work end -->


<BLOCKQUOTE>
<A NAME=HEADING195-0></A>
<H2><A NAME=MARKER-9-135></A>Creating, Using, and Disposing of a Speech Channel</H2>
 <A NAME=MARKER-2-136></A><A NAME=MARKER-2-843></A>To take advantage of most of the Speech Manager's capabilities, you must pass a speech channel to Speech Manager functions. You use the <CODE>NewSpeechChannel</CODE> function to create a speech channel. After you are done using a speech channel, you must dispose of it by using the <CODE>DisposeSpeechChannel</CODE> function. <A HREF=#MARKER-9-139>Listing 4-2</A> shows how to create a speech channel, start speaking text with the <CODE>SpeakText</CODE> function, stop speaking text with the <CODE>StopSpeech</CODE> function, and then dispose of the speech channel when the speaking is finished.<P>
<B>Listing 4-2  <A NAME=MARKER-9-139></A>Speaking text with a speech channel<A NAME=MARKER-2-140></A></B><P>
<PRE>
FUNCTION MyUseSpeechChannel: OSErr;
VAR
   myErr:   OSErr;
   myErr2:  OSErr;
   myStr:   Str255;                                      {text to be spoken}
BEGIN
   myStr := 'Hold the mouse button down to stop speech.';
   myErr := NewSpeechChannel(NIL, gChannel);             {create the channel}
   IF (myErr = noErr) THEN
   BEGIN                                                 {speak the string}
      myErr := SpeakText(gChannel, @myStr[1], Length(myStr));
      WHILE (SpeechBusy &lt;&gt; 0) DO                {wait until speaking is done}
      BEGIN    
         IF (Button) THEN
         myErr := StopSpeech(gChannel);         {stop speech at mouse down}
      END;  
      IF (gChannel &lt;&gt; NIL) THEN
         myErr2 := DisposeSpeechChannel(gChannel);{get rid of channel}
   END;
   IF (myErr = noErr) THEN 
      MyUseSpeechChannel := myErr2
   ELSE
      MyUseSpeechChannel := myErr;
END;
</PRE>
 The <CODE>MyUseSpeechChannel</CODE> function defined in <A HREF=#MARKER-9-139>Listing 4-2</A> creates a default speech channel using the default system voice. You pass <CODE>NIL</CODE> in the first parameter to use the system default voice. You must also pass a global variable to <CODE>NewSpeechChannel</CODE> in which is returned a valid speech channel. Once the channel exists, then you can use the <CODE>SpeakText</CODE> function to generate speech. To generate synthesized speech, you pass in the channel allocated by <CODE>NewSpeechChannel</CODE> in the first parameter, and then you pass a pointer to the text that you want to speak as well as the length of the text that you want the Speech Manager to attempt to speak. That is, you can pass a pointer to a buffer of text that is 500 bytes long, but specify that only the first 10 bytes get spoken. Then <CODE>MyUseSpeechChannel</CODE> uses the <CODE>SpeechBusy</CODE> function in a <CODE>WHILE</CODE> loop to allow the text to be completely spoken before disposing of the channel.<A NAME=MARKER-2-141></A><A NAME=MARKER-2-142></A><P>
 When the designated action to stop the speaking occurs, which in this example is the user pressing the mouse button, <CODE>MyUseSpeechChannel</CODE> halts speech production. In this case, the <CODE>StopSpeech</CODE> function stops the speech immediately (as soon as the synthesizer can). You need to pass <CODE>StopSpeech</CODE> the variable that identifies the channel on which the speech is currently being synthesized. If you want to have more control over when the speech is stopped, you can use the <CODE>StopSpeechAt</CODE> function, which allows you to stop speech immediately, at the end of a word, or at the end of a sentence. See the description of the <CODE>StopSpeechAt</CODE> function on <A HREF=Sound-223.html#MARKER-9-462>page 4-60</A> for more information.<P>
 Once you are done using the speech channel that was created with <CODE>NewSpeechChannel</CODE>, you must dispose of it. The <CODE>MyUseSpeechChannel</CODE> function calls <CODE>DisposeSpeechChannel</CODE> with the global variable that identifies the channel currently in use.<A NAME=MARKER-2-143></A><A NAME=MARKER-2-144></A><A NAME=MARKER-2-145></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Sound-194.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Sound-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Sound-336.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Sound-196.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Sound-3.html">&copy; Apple Computer, Inc.</A><br>2 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
