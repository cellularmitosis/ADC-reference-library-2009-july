<!-- legacy work start --><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"        "http://www.w3.org/TR/html4/loose.dtd"><!-- legacy work end --><HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><TITLE> Scheduling Two Sounds with the Sound Clock (deprecated)</title><!-- legacy work start -->        <META NAME="Generator" CONTENT="manual">        <META http-equiv="content-type" CONTENT="text/html;charset=utf-8">        <META NAME = "Copyright" CONTENT="Copyright 2007 Apple Inc. All Rights Reserved.">        <META NAME="IndexTitle" CONTENT="Sound Input Manager (Not Recommended)">        <meta name="xcode-display" content="render">        <LINK REL="stylesheet" TYPE="text/css" HREF="../../../Resources/CSS/frameset_styles.css"> <!-- before submitting, globally replace ".." with "developer.apple.com" -->        <script type="text/javascript" language="JavaScript" src="../../../Resources/JavaScript/page.js"></script><!-- legacy work end --></HEAD><BODY BGCOLOR="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- path goes here --><!-- QTnavbar start --><P><I>Mac OS Sound</I><P>| <A target="doc" HREF="tp_snd33_snd33add.18.htm">Previous</A> | <A target="doc" HREF="tp_snd33_snd33add.1.htm">Chapter Contents</A> | <A target="doc" HREF="tp_snd33_snd33add.htm">Chapter Top</A> | <A target="doc" HREF="tp_snd33_snd33add.1a.htm">Next</a> | <!-- QTnavbar end --><!-- legacy work start --><script type="text/javascript"> placeWatermark()</script><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox" style="position: relative;"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b><i>Sound Input Manager</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="http://developer.apple.com/referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div><!-- legacy work end --><H1 CLASS="H2.Heading2"><A NAME="pgfId=17684"> </A>Scheduling Two Sounds with the Sound Clock</H1><P CLASS="T1.Text1"><A NAME="pgfId=17688"> </A>Listing 4 shows an example of scheduling two sounds with the sound clock. It assumes that the <TT CLASS="cv">SoundHeader</TT> of the <TT CLASS="cv">ScheduledSoundHeader</TT> structure has already been established. Note that although each channel has its own clock, both are synchronized with the Mixer. Therefore, obtaining the current time from one channel will result in the same time for the second. This allows both channels to use the same start time.</P><P CLASS="L.Listing"><A NAME="pgfId=17696"> </A>Listing&nbsp;9 <A NAME="_Toc398641467"> </A><A NAME="_Toc398641581"> </A><A NAME="_Toc398643545"> </A><A NAME="_Toc399063856"> </A><A NAME="_Toc399063880"> </A><A NAME="_Toc399063916"> </A><A NAME="_Toc399151788"> </A>An example of scheduling two sounds with the sound clock</P><CODE CLASS="Cv.Code"><A NAME="pgfId=83923"> </A>// turn on the sound clock for two channels<BR><BR>cmd.cmd = clockComponentCmd;<BR>cmd.param1 = true;<BR>err = SndDoImmediate(gChan1, &amp;cmd);<BR>if (err != noErr) return (err);<BR><BR>err = SndDoImmediate(gChan2, &amp;cmd);<BR>if (err != noErr) return (err);<BR><BR>// get the sound clock component from one channel<BR><BR>cmd.cmd = getClockComponentCmd;<BR>cmd.param2 = (long)&amp;clock;<BR>err = SndDoImmediate(gChan1, &amp;cmd);<BR>if (err != noErr) return (err);<BR>// get the current time from one channel<BR><BR>scheduledSound1.startTime.base = nil;<BR>err = ClockGetTime(clock, &amp;scheduledSound1.startTime);<BR>if (err != noErr) return (err);<BR><BR>// add 1/2 second to the current time<BR><BR>deltaTime.value.hi = 0;<BR>deltaTime.value.lo = 1;<BR>deltaTime.scale = 2;<BR>AddTime(&amp;scheduledSound1.startTime, &amp;deltaTime);<BR><BR>// schedule two sounds to play at the same starting time<BR><BR>scheduledSound1.flags = kScheduledSoundDoScheduled;<BR>scheduledSound2.flags = kScheduledSoundDoScheduled;<BR>scheduledSound2.startTime = scheduledSound1.startTime;<BR><BR>cmd.cmd = scheduledSoundCmd;<BR>cmd.param2 = (long)&amp;scheduledSound1;<BR>err = SndDoImmediate(gChan1, &amp;cmd);<BR>if (err != noErr) return (err);<BR><BR>cmd.param2 = (long)&amp;scheduledSound2;<BR>err = SndDoImmediate(gChan2, &amp;cmd);<BR>if (err != noErr) return (err);<BR></CODE><P CLASS="Note"><A NAME="pgfId=17698"> </A>A sound channel can only have one scheduled sound at any given time. The Mixer does not queue up additional scheduled sounds. You can stream a sound continuously by starting the first buffer with the <TT CLASS="cv">scheduledSoundCmd</TT>, then use the <TT CLASS="cv">bufferCmd</TT> and <TT CLASS="cv">callBackCmd</TT> sequence with the <TT CLASS="cv">SndDoCommand</TT> function to stream additional samples. This has been the techniqued used in the past. By replacing the first <TT CLASS="cv">bufferCmd</TT> with the new <TT CLASS="cv">scheduledSoundCmd</TT>, you can cause the samples to start playing at a specific point in time. </P><hr>&#169; 1999 Apple Computer, Inc.<!-- QTnavbar start --><P><I>Mac OS Sound</I><P>| <A target="doc" HREF="tp_snd33_snd33add.18.htm">Previous</A> | <A target="doc" HREF="tp_snd33_snd33add.1.htm">Chapter Contents</A> | <A target="doc" HREF="tp_snd33_snd33add.htm">Chapter Top</A> | <A target="doc" HREF="tp_snd33_snd33add.1a.htm">Next</a> | <!-- QTnavbar end --><!-- legacy work start --><script type="text/javascript"> placeWatermark()</script><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox" style="position: relative;"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b><i>Sound Input Manager</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="http://developer.apple.com/referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div><!-- legacy work end --></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY></HTML>