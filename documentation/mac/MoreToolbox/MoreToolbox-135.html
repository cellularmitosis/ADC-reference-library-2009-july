<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>UnloadScrap (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING135></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-134.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-136.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-109.html"><B>Chapter 2 - Scrap Manager</B></A> / <A HREF="MoreToolbox-122.html"><B>Scrap Manager Reference</B></A><BR><DL><DD><A HREF="MoreToolbox-126.html"><B>Routines</B></A> / <A HREF="MoreToolbox-134.html"><B>Transferring Data Between the Scrap in Memory and the Scrap on Disk</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING135-0></A>
<H3><A NAME=MARKER-11-180></A>UnloadScrap<A NAME=MARKER-2-26></A></H3>
 You can use the <CODE>UnloadScrap</CODE> function to write the scrap from memory to the scrap file.<P>
<PRE>
FUNCTION UnloadScrap: LongInt;
</PRE>
<A NAME=HEADING135-3></A>
<H5>DESCRIPTION</H5>
 The <CODE>UnloadScrap</CODE> function writes the scrap in memory to the scrap file and releases the memory occupied by the scrap in your application's heap. The scrap file is located in the System Folder of the startup volume and has the filename as indicated by the <CODE>scrapName</CODE> field of the scrap information record (usually "Clipboard"). If the scrap is already on the disk, the <CODE>UnloadScrap</CODE> function does nothing.<P>
 <CODE>UnloadScrap</CODE> returns as its function result a long integer corresponding to a result code.<P>
<A NAME=HEADING135-6></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 The <CODE>UnloadScrap</CODE> function may move or purge memory blocks in the application heap. Your application should not call this function at interrupt time.<P>
<A NAME=HEADING135-8></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>dskFulErr<TD>-34<TD>Disk full<TR>
<TD>ioErr<TD>-36<TD>I/O error<A NAME=MARKER-2-1></A></TABLE>
</H5>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-134.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-136.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
