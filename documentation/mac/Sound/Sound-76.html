<!-- legacy work start -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<!-- legacy work end -->


<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)

LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Compressed Sound Header Records (IM: S)  (deprecated)</Title>

<!-- legacy work start -->
        <META NAME="Generator" CONTENT="manual">
        <META http-equiv="content-type" CONTENT="text/html;charset=utf-8">
        <META NAME = "Copyright" CONTENT="Copyright 2007 Apple Inc. All Rights Reserved.">
        <META NAME="IndexTitle" CONTENT="Inside Macintosh: Sound (Not Recommended)">
        <meta name="xcode-display" content="render">

        <LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css"> <!-- before submitting, globally replace ".." with "developer.apple.com" -->
        <script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
<!-- legacy work end -->

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000"><A NAME="HEADING76"></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Sound-75.html"><IMG ALIGN="BOTTOM" SRC="prev.gif" BORDER="none" HSPACE="20" ALT="Previous"></A> <A HREF="Sound-2.html"><IMG ALIGN="BOTTOM" SRC="content.gif" BORDER="none" HSPACE="20" ALT="Book Contents"></A> <A HREF="Sound-336.html"><IMG ALIGN="BOTTOM" SRC="index.gif" BORDER="none" HSPACE="20" ALT="Book Index"></A> <A HREF="Sound-77.html"><IMG ALIGN="BOTTOM" SRC="next.gif" BORDER="none" HSPACE="20" ALT="Next"></A> </CENTER><P>
<FONT SIZE="-1"><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Sound-2.html"><B>Sound</B></A> / <BR><DD><A HREF="Sound-44.html"><B>Chapter 2 - Sound Manager</B></A> / <A HREF="Sound-62.html"><B>Sound Manager Reference</B></A><BR><DL><DD><A HREF="Sound-68.html"><B>Data Structures</B></A></DL></DL></FONT><P>
<HR>

<!-- legacy work start -->
<script type="text/javascript"> placeWatermark()</script>
<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
<i>Inside Macintosh: Sound</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="http://developer.apple.com/referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div>
<!-- legacy work end -->


<BLOCKQUOTE>
<A NAME="HEADING76-0"></A>
<H3><A NAME="MARKER-9-702"></A>Compressed Sound Header Records<A NAME="MARKER-2-19"></A></H3>
 <A NAME="MARKER-14-704"></A><A NAME="MARKER-2-705"></A><A NAME="MARKER-9-126"></A>To describe compressed sampled-sound data, the Sound Manager uses a compressed sound header record. Compressed sound headers include all of the essential fields of extended sound headers in addition to several fields that pertain to compression. The <CODE>CmpSoundHeader</CODE> data type defines the compressed sound header record.<P>
<PRE>
TYPE CmpSoundHeader =
PACKED RECORD
   samplePtr:        Ptr;           {if NIL, samples in sampleArea}
   numChannels:      LongInt;       {number of channels in sample}
   sampleRate:       Fixed;         {rate of original sample}
   loopStart:        LongInt;       {loop point beginning}
   loopEnd:          LongInt;       {loop point ending}
   encode:           Byte;          {sample's encoding option}
   baseFrequency:    Byte;          {base freq. of original sample}
   numFrames:        LongInt;       {length of sample in frames}
   AIFFSampleRate:   Extended80;    {rate of original sample}
   markerChunk:      Ptr;           {reserved}
   format:           OSType;        {data format type}
   futureUse2:       LongInt;       {reserved}
   stateVars:        StateBlockPtr; {pointer to StateBlock}
   leftOverSamples:  LeftOverBlockPtr;
                                    {pointer to LeftOverBlock}
   compressionID:    Integer;       {ID of compression algorithm}
   packetSize:       Integer;       {number of bits per packet}
   snthID:           Integer;       {unused}
   sampleSize:       Integer;       {bits in each sample point}
   sampleArea:       PACKED ARRAY[0..0] OF Byte;
END;
</PRE>
<DL>
<H5>Field Description</H5>
<DT><CODE>samplePtr</CODE>
<DD> The location of the compressed sound frames. If <CODE>samplePtr</CODE> is <CODE>NIL</CODE>, then the frames are located in the <CODE>sampleArea</CODE> field of the compressed sound header. Otherwise, <CODE>samplePtr</CODE> points to a buffer that contains the frames.<A NAME="MARKER-2-707"></A>
<DT><CODE>numChannels</CODE>
<DD> The number of channels in the sample.
<DT><CODE>sampleRate</CODE>
<DD> The sample rate at which the frames were sampled before compression. The approximate sample rates are shown in <A HREF="Sound-49.html#MARKER-9-1">Table 2-1 on page 2-16</A>. Note that the sample rate is declared as a <CODE>Fixed</CODE> data type, but the most significant bit is not treated as a sign bit; instead, that bit is interpreted as having the value 32,768.<A NAME="MARKER-2-586"></A>
<DT><CODE>loopStart</CODE>
<DD> The beginning of the loop points of the sound before compression. The loop starting and ending points are 0-based.<A NAME="MARKER-2-711"></A>
<DT><CODE>loopEnd</CODE>
<DD> The end of the loop points of the sound before compression.<A NAME="MARKER-2-712"></A>
<DT><CODE>encode</CODE>
<DD> The method of encoding (if any) used to generate the sampled-sound data. For a compressed sound header, you should specify the constant <CODE>cmpSH</CODE>. Encode option values in the ranges 0 through 63 and 128 to 255 are reserved for use by Apple. You are free to use numbers in the range 64 through 127 for your own encode options.<A NAME="MARKER-2-713"></A>
<DT><CODE>baseFrequency</CODE>
<DD> The pitch of the original sampled sound. It is not used by <CODE>bufferCmd</CODE>. If you wish to make use of <CODE>baseFrequency</CODE> with a compressed sound, you must first expand it and then play it with <CODE>soundCmd</CODE> and <CODE>freqDurationCmd</CODE>.<A NAME="MARKER-2-714"></A>
<DT><CODE>numFrames</CODE>
<DD> The number of frames contained in the compressed sound header. When you store multiple channels of noncompressed sound, store them as interleaved sample frames (as in AIFF). When you store multiple channels of compressed sounds, store them as interleaved packet frames.<A NAME="MARKER-2-715"></A>
<DT><CODE>AIFFSampleRate</CODE>
<DD> The sample rate at which the frames were sampled before compression, as expressed in the 80-bit extended data type representation.<A NAME="MARKER-2-716"></A>
<DT><CODE>markerChunk</CODE>
<DD> Synchronization information. The <CODE>markerChunk</CODE> field is not presently used and should be set to <CODE>NIL</CODE>.<A NAME="MARKER-2-717"></A>
<DT><CODE>format</CODE>
<DD> The data format type. This field contains a value of type <CODE>OSType</CODE> that defines the compression algorithm, if any, used to generate the audio data. For example, for data generated using MACE 3:1 compression, this field should contain the value <CODE>'MAC3'</CODE>. See <A HREF="Sound-82.html">page 2-86</A> for a list of the format types defined by Apple. This field is used only if the <CODE>compressionID</CODE> field contains the value <CODE>fixedCompression</CODE>.<A NAME="MARKER-2-718"></A>
<DT><CODE>futureUse2</CODE>
<DD> This field is reserved for use by Apple. To maintain compatibility with future releases of system software, you should always set this field to 0.<A NAME="MARKER-2-719"></A>
<DT><CODE>stateVars</CODE>
<DD> A pointer to a state block. This field is used to store the state variables for a given algorithm across consecutive calls. See <A HREF="Sound-87.html#MARKER-9-820">"State Blocks" on page 2-119</A> for a description of the state block.<A NAME="MARKER-2-720"></A>
<DT><CODE>leftOverSamples</CODE>
<DD> A pointer to a leftover block. You can use this block to store samples that will be truncated across algorithm invocations. See <A HREF="Sound-86.html#MARKER-9-816">"Leftover Blocks" on page 2-119</A> for a description of the leftover block.<A NAME="MARKER-2-721"></A>
<DT><A NAME="MARKER-2-722"></A><CODE>compressionID</CODE>
<DD> The compression algorithm used on the samples in the compressed sound header. You can use a constant to define the compression algorithm.<A NAME="MARKER-2-723"></A>
</DL>
<PRE>
               CONST
                  variableCompression  
                                    = -2; {variable-ratio compr.}
                  fixedCompression  = -1; {fixed-ratio compr.}
                  notCompressed     = 0;  {noncompressed samples}
                  threeToOne        = 3;  {3:1 compressed samples}
                  sixToOne          = 4;  {6:1 compressed samples}
</PRE>
<DL>
<DT>
<DD> The constant <CODE>fixedCompression</CODE> is available only with Sound Manager versions 3.0 and later. If the <CODE>compressionID</CODE> field contains the value <CODE>fixedCompression</CODE>, the Sound Manager reads the <CODE>format</CODE> field to determine the compression algorithm used to generate the compressed data. Otherwise, the Sound Manager reads the <CODE>compressionID</CODE> field. Apple reserves the right to use compression IDs in the range 0 through 511. Currently the constant variableCompression is not used by the Sound Manager.
<DT><CODE>packetSize</CODE>
<DD> The size, in bits, of the smallest element that a given expansion algorithm can work with. You can use a constant to define the packet size.<A NAME="MARKER-2-724"></A>
</DL>
<PRE>
               CONST
                  sixToOnePacketSize   = 8;  {size for 6:1}
                  threeToOnePacketSize = 16; {size for 3:1}
</PRE>
<DL>
<DT>
<DD> Beginning with Sound Manager version 3.0, you can specify the value 0 in this field to instruct the Sound Manager to determine the packet size itself.
<DT><A NAME="MARKER-2-725"></A><CODE>snthID</CODE>
<DD> This field is unused. You should set it to 0.
<DT><CODE>sampleSize</CODE>
<DD> The size of the sample before it was compressed. The samples passed in the compressed sound header should always be byte-aligned, and any padding done to achieve byte alignment should be done from the left with zeros.
<DT><CODE>sampleArea</CODE>
<DD> The sample frames, but only when the <CODE>samplePtr</CODE> field is <CODE>NIL</CODE>. Otherwise, the sample frames are in the location indicated by <CODE>samplePtr</CODE>.<A NAME="MARKER-2-27"></A><A NAME="MARKER-2-68"></A><A NAME="MARKER-2-730"></A>
</DL>
</BLOCKQUOTE>
<HR>
<CENTER>
<A HREF="Sound-75.html"><IMG ALIGN="BOTTOM" SRC="prev.gif" BORDER="none" HSPACE="20" ALT="Previous"></A> <A HREF="Sound-2.html"><IMG ALIGN="BOTTOM" SRC="content.gif" BORDER="none" HSPACE="20" ALT="Book Contents"></A> <A HREF="Sound-336.html"><IMG ALIGN="BOTTOM" SRC="index.gif" BORDER="none" HSPACE="20" ALT="Book Index"></A> <A HREF="Sound-77.html"><IMG ALIGN="BOTTOM" SRC="next.gif" BORDER="none" HSPACE="20" ALT="Next"></A> </CENTER><P>
<CENTER><FONT SIZE="-1"><A HREF="Sound-3.html">&copy; Apple Computer, Inc.</A><BR>2 JUL 1996</CENTER></FONT><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
