<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>MyEventFilter(IM:Tb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING434></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Toolbox-433.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-435.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Toolbox-2.html"><B>Macintosh Toolbox Essentials</B></A> / <BR><DD><A HREF="Toolbox-370.html"><B>Chapter 6 - Dialog Manager</B></A> / <A HREF="Toolbox-386.html"><B>Dialog Manager Reference</B></A><BR><DL><DD><A HREF="Toolbox-431.html"><B>Application-Defined Routines</B></A> / <A HREF="Toolbox-425.html"><B></B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING434-0></A>
<H3><A NAME=MARKER-9-578></A>MyEventFilter</H3>
 <A NAME=MARKER-2-579></A><A NAME=MARKER-2-580></A>To supplement the Dialog Manager's ability to handle events, your application should provide an event filter function that the Dialog Manager calls when it displays alert boxes and modal dialog boxes. Your event filter function should have three parameters and return a Boolean value. For example, this is how you would declare it if you were to name it <CODE>MyEventFilter</CODE>:<P>
<PRE>
FUNCTION MyEventFilter (theDialog: DialogPtr; 
                        VAR theEvent: EventRecord; 
                        VAR itemHit: Integer): Boolean;
</PRE>
<DL>
<DT><CODE>theDialog</CODE>
<DD> A pointer to a dialog record for an alert box or a modal dialog box.
<DT><CODE>theEvent</CODE>
<DD> An event record returned by an Event Manager function such as <CODE>WaitNextEvent</CODE>.
<DT><CODE>itemHit</CODE>
<DD> <DFN>A</DFN> number corresponding to the position of an item in the item list resource for the alert or modal dialog box.
</DL>
<A NAME=HEADING434-6></A>
<H5>DESCRIPTION</H5>
 After receiving an event that it does not handle, your function should return <CODE>FALSE</CODE>. When your function returns <CODE>FALSE</CODE>, <CODE>ModalDialog</CODE> handles the event, which you pass <BR>in the parameter <CODE>theEvent</CODE>. (Your function can also change the event to simulate a different event and return <CODE>FALSE</CODE>, which passes the event to the Dialog Manager for handling.) If your function <I>does</I> handle the event, your function should return <CODE>TRUE</CODE> <BR>as a function result, and in the <CODE>itemHit</CODE> parameter return the number of the item <BR>that it handled. The <CODE>ModalDialog</CODE> procedure and, in turn, the <CODE>Alert</CODE>, <CODE>NoteAlert</CODE>, <CODE>StopAlert</CODE>, and <CODE>CautionAlert</CODE> functions then return this item number in their own <CODE>itemHit</CODE> parameters.<P>
 Your event filter function should perform the following tasks:<P>
<UL>
<LI>return <CODE>TRUE</CODE> and the item number for the default button if the user presses Return <BR>or Enter 
<LI>return <CODE>TRUE</CODE> and the item number for the Cancel button if the user presses Esc or Command-period
<LI>update your windows in response to update events (this allows background applications to receive update events) and return <CODE>FALSE</CODE> 
<LI>return <CODE>FALSE</CODE> for all events that your event filter function doesn't handle<P>
</UL>
 You can also use the event filter function to test for and respond to keyboard equivalents and more complex events--for instance, the user dragging the cursor in an application- defined item. For example, if you provide an application-defined item that requires you to measure how long the user holds down the mouse button or how far the user drags the cursor, use the event filter function to handle events inside that item. <P>
 The <CODE>ModalDialog</CODE> procedure calls the Event Manager function <CODE>GetNextEvent</CODE> with a mask that excludes disk-inserted events; to receive disk-inserted events, your event filter function can call the Event Manager procedure <CODE>SetSystemEventMask</CODE>.<P>
 You can use the same event filter function in most or all of your alert and modal <BR>dialog boxes. <P>
 For alert and modal dialog boxes, the Dialog Manager provides a standard event filter function that checks whether the user has pressed the Enter or Return key and, if so, returns the item number of the default button. Your event filter function should always check whether the Return key or Enter key was pressed and, if so, return <DFN>the</DFN> <DFN>number of the default button </DFN>in the <CODE>itemHit</CODE> parameter and a function result of <CODE>TRUE</CODE>.<P>
 In all alert and dialog boxes, any buttons that are activated by key sequences should invert to indicate which item has been selected. Use the Control Manager procedure <CODE>HiliteControl</CODE> to invert a button for 8 ticks, long enough to be noticeable but not so long as to be annoying. The Control Manager performs this action whenever users click a button, and your application should do this whenever the user presses the keyboard equivalent of a button click.<P>
 For modal dialog boxes that contain editable text items, your application should handle menu bar access to allow use of your Edit menu and its Cut, Copy, Paste, Clear, and Undo commands. Your event filter function should then test for and handle clicks <BR>in your Edit menu and keyboard equivalents for the appropriate commands in your <BR>Edit menu. Your application should respond by using the procedures <CODE>DialogCut</CODE>, <CODE>DialogCopy</CODE>, <CODE>DialogPaste</CODE>, and <CODE>DialogDelete</CODE> to support the Cut, Copy, Paste, and Clear commands.<P>
 For an alert box, you specify a pointer to your event filter function in a parameter that you pass to the <CODE>Alert</CODE>, <CODE>StopAlert</CODE>, <CODE>CautionAlert</CODE>, and <CODE>NoteAlert</CODE> functions. For a modal dialog box, specify a pointer to your event filter function in a parameter that you pass to the <CODE>ModalDialog</CODE> procedure.<P>
<A NAME=HEADING434-20></A>
<H5>SEE ALSO</H5>
 <A HREF=Toolbox-385.html#MARKER-9-350>Listing 6-27 on page 6-88</A> illustrates an event filter function. The functions <CODE>GetNextEvent</CODE> and <CODE>SetSystemEventMask</CODE> are described in the chapter <BR>"Event Manager" in this book.<A NAME=MARKER-2-581></A><A NAME=MARKER-2-582></A><A NAME=MARKER-2-583></A><A NAME=MARKER-2-584></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Toolbox-433.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-435.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Toolbox-3.html">&copy; Apple Computer, Inc.</A><br>11 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
