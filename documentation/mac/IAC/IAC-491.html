<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>The Results Record(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING491></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-490.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-492.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-469.html"><B>Chapter 12 - Data Access Manager</B></A> / <A HREF="IAC-487.html"><B>Data Access Manager Reference</B></A><BR><DL><DD><A HREF="IAC-488.html"><B>Data Structures</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING491-0></A>
<H3><A NAME=MARKER-9-276></A>The Results Record</H3>
 The results record describes the data that was returned by a data source in response to a query. To get the results of a query, allocate a results record and pass this record to the <CODE>DBGetQueryResults</CODE> function. The Data Access Manager allocates the handles inside the results record. When your application is finished using the results record, you must deallocate both the results record and the handles inside the results record.<P>
 The results record is defined by the <CODE>ResultsRecord</CODE> data type.<P>
<PRE>
TYPE ResultsRecord = 
   RECORD
      numRows:    Integer;          {number of rows retrieved}
      numCols:    Integer;          {number of columns per row}
      colTypes:   ColTypesHandle;   {type of data in each column}
      colData:    Handle;           {array of data items}
      colInfo:    ColInfoHandle;    {info about each data item}
   END;
</PRE>
<DL>
<H5>Field Description</H5>
<DT><A NAME=MARKER-2-277></A><CODE>numRows</CODE>
<DD> The total number of rows retrieved. If the <CODE>DBGetQueryResults</CODE> function returns a result code other than <CODE>rcDBValue</CODE>, then not all of the data actually returned by the data source was retrieved. This could happen, for instance, if the user's computer does not have sufficient memory space to hold all the data. In this case, your application can make more space available (by writing the data in the data record to disk, for example) and then call the <CODE>DBGetQueryResults</CODE> function again to complete retrieval of the data.
<DT><B>Note</B>
<DD>The <CODE>DBGetQueryResults</CODE> function retrieves whole rows only; if it runs out of space in the middle of a row, it stores the partial row in a private buffer so that the data in the results record ends with the last complete row. Because the last partial row is no longer available from the data server, you cannot start to retrieve data with the <CODE>DBGetQueryResults</CODE> function and then switch to the <CODE>DBGetItem</CODE> function to complete the data retrieval.<EM></EM>   <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
<DT><A NAME=MARKER-2-278></A><CODE>numCols</CODE>
<DD> The number of columns in each row of data.
<DT><A NAME=MARKER-2-279></A><CODE>colTypes</CODE>
<DD> A handle to an array of data types, specifying the type of data in each column. The number of elements in the array is equal to the value in the <CODE>numCols</CODE> field. <A HREF=IAC-481.html#MARKER-9-1>Table 12-1</A> beginning on <A HREF=IAC-481.html#MARKER-9-1>page 12-39</A> shows the standard data types. 
<DT><A NAME=MARKER-2-280></A><CODE>colData</CODE>
<DD> A handle to the data retrieved by the <CODE>DBGetQueryResults</CODE> function.
<DT><A NAME=MARKER-2-281></A><CODE>colInfo</CODE> 
<DD> A handle to an array of records of type <CODE>DBColInfoRecord</CODE>, each of which specifies the length, places, and flags for a data item. There are as many records in the array as there are data items retrieved by the <CODE>DBGetQueryResults</CODE> function. Here is the <CODE>DBColInfoRecord</CODE> type definition:
</DL>
<PRE>
               TYPE DBColInfoRecord = 
                  RECORD
                     len:     Integer;    {length of data item}
                     places:  Integer;    {places for decimal }
                                          { and money data items}
                     flags:   Integer;    {flags for data item}
                  END;
</PRE>
<DL>
<DT>
<DD> <A NAME=MARKER-2-282></A>The <CODE>len</CODE> field indicates the length of the data item. The <CODE>DBGetQueryResults</CODE> function returns a value in this field only for those data types that do not have implied lengths; see <A HREF=IAC-481.html#MARKER-9-1>Table 12-1 on page 12-39</A> for a list of these data types. 
<DT>
<DD> <A NAME=MARKER-2-283></A>The <CODE>places</CODE> field indicates the number of decimal places in data items of types <CODE>typeMoney</CODE> and <CODE>typeDecimal</CODE>. For all other data types, the <CODE>places</CODE> field returns 0. 
<DT>
<DD> <A NAME=MARKER-2-284></A>The least significant bit of the <CODE>flags</CODE> field is set to 1 if the data item is in the last column of the row. The third bit of the <CODE>flags</CODE> field is 1 if the data item is <CODE>NULL</CODE>. You can use the constants <CODE>kDBLastColFlag</CODE> and <CODE>kDBNullFlag</CODE> to test for these <DFN>flag</DFN> bits. <A NAME=MARKER-2-285></A>
</DL>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-490.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-492.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
