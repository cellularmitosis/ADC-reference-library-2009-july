<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note NW12: AppleShare-able Applications and the Resource Manager</title> <meta name="keywords" content=""><meta name="Description" content="Technical Note NW12: ">      <meta name="categories" content="Networking"><meta name="week-posted" content="Feb 23, 1987 - Mar 6, 1987"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF" TEXT="#000000"><a name="//apple_ref/doc/uid/DTS10002554" title="AppleShare-able Applications and the Resource Manager"></a><a name="top"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxNetworking-date.html">Networking</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/Networking/index.html" target="_blank">Reference Library > Networking</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note NW12</div>
<div id="pageheadsub">AppleShare-able Applications and the Resource Manager</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->					<p id="menutext">					<a href="#Section1">The Resource Manager versus Shared Files</a><BR><BR><a href="#References">References</a><BR><BR><a href="#Downloads">Downloadables</a></p>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">Normally, applications on an AppleShare server volume cannot be executed bymore than one user at a time. This technical note explains why, and tells howyou can enable your application to be shared.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Mar 01 1987]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR><a name="Section1"></a><!-- begin_content --><h2>The Resource Manager versus Shared Files</h2><p>Part of the explanation of why applications are not automatically sharable isbased on the design of the Resource Manager.  The Resource Manager is a greatlittle database. It was originally conceived as a way to keep applicationslocalizable (a task it has performed admirably), and was found to be anexcellent foundation for the Segment Loader, Font Manager, and a large part ofthe rest of the Macintosh operating system.</p><p>However, it was never designed to be a multi-user database. When the ResourceManager opens a resource file (such as an application), it reads the file'sresource map into memory. This map remains in memory until the resource file isclosed by the Segment Loader, which regains control when the application exits.Sometimes it is necessary to write the map out to disk; normally, this is onlydone by <code>UpdateResFile</code> and <code>CloseResFile</code>.</p><p>If two users opened the same resource file at the same time, and one of themhad write access to the file and added a resource to it, the other user'sResource Manager wouldn't know about it; this would make the other user's copyof the file's original resource map invalid. This could cause (at least) acrash; if both users had write access, it's not unlikely that the resource fileinvolved would become corrupted. Also, although you can tell the ResourceManager to write out an updated resource map, there's no way for another userto tell it to refresh the copy of the map in memory if the file changes.</p><b>What does all this have to do with running my application twice?</b><p>Your application is stored as a resource file; code segments, alert and dialogtemplates, etc., are resources. If you write to your application's resourcefile (for instance, to add configuration information, like print records), yourapplication can't be shared.</p><p>In Apple's compatibility testing of existing applications (during developmentof AppleShare), we found quite a few applications, some of them quite popular,that wrote to their own resource files. So we decided, to improve the safety ofusing AppleShare, to always launch applications using a combination of accessprivileges such that only one user at a time could use a given application(these privileges will be discussed in a future Technical Note). In fact,AppleShare opens all resource files this way, unless the resource file isopened with <code>OpenRFPerm</code> and read-only permission is specified.</p><h3>But my application doesn't write to itself!</h3><p>We realize that many applications do not. However, there are otherconsiderations (covered in detail, with suggestions for fixes, in "ApplicationDevelopment in a Shared Environment", available from APDA ). In brief, here arethe big ones we know about:</p><ul type="disc">	<li>Does your application create temporary files with fixed names in a fixedplace (such as the  directory containing the application)? Without AppleShare's protection, two applications  to use the same temporary file could be disastrous.</li>	<li>Is your application at least "conscious" of the fact that it may be in a multi-user environment? For instance, does it work correctly if a volume containing an existing document is on a locked volume? Does it check all result codes returned from File Manager  calls, and <code>ResError</code> after relevant Resource Manager calls?</li></ul><h3>OK, I follow the rules. What do I do to make my application sharable?</h3><p>There is a flag in each file's Finder information (stored in the file'sdirectory entry) known as the "shared" bit. If you set this bit on yourapplication's resource file, the Finder will launch your application usingread-only permissions; if anyone else launches your application, they'll alsoget it read-only (their Finder will see the same "shared" bit set.).</p><p>Three important warnings accompany this information:</p><ul type="disc">	<li>The definition of the "shared" bit was incorrect in previous releases of information and software from Apple. This includes the June 16, 1986 version of M.TB.Finder Flags (fixed in the March 2, 1987 version), as well as all versions of ResEdit before and including 1.1b3 (included with MPW 2.0). For now, the most reliable way to set this bit is to get the 1.1b3 version of ResEdit, use it to Get Info on your application, and check the  box labeled "cached" (the incorrect documentation upon which ResEdit, et al.) was based  called the real shared bit "cached"; the bit labeled as "shared" is the real cached bit [a currently unused but reserved bit which should be left clear]).</li>	<li>By checking this bit, you're promising (to your users) that your application will work entirely correctly if launched by more than one user. This means that you follow the other rules, in addition to simply not writing to your application's own resource file. See  "Application Development for a Shared Environment," and test carefully!</li>	<li>Setting this bit has nothing to do with allowing your application's documents to be shared;  you must design this feature into your application (it's not something that Apple system  software can take care of behind your application's back). You should realize from reading  this note, however, that if you store your document's data in resource files, you won't be  able to allow multiple users to access them simultaneously.</li></ul><P><A HREF="#top">Back to top</A></P><a name="References"></a><h2>References</h2><P>The Resource Manager, "Application Development in a Shared Environment"</p><P><A HREF = "../tb/tb_09.html">M.TB.Finder Flags</a></p>                                    <P><A HREF="#top">Back to top</A></P>     <P><A NAME=Downloads></A></P>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (56K)</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/nw_12.pdf">Download</A></P>               </TD>            </TR>                     </TABLE>         <BR>         <P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/nw/nw_12.html%3Fid%3DDTS10002554-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/nw/nw_12.html%3Fid%3DDTS10002554-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/nw/nw_12.html%3Fid%3DDTS10002554-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>