<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Creating a Translation Extension (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING415></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-414.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-416.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-402.html"><B>Chapter 7 - Translation Manager</B></A> / <A HREF="MoreToolbox-414.html"><B>Writing a Translation Extension</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING415-0></A>
<H2><A NAME=MARKER-9-137></A>Creating a Translation Extension</H2>
 A translation extension is a component. It contains a number of resources, including icons, strings, pictures, and the standard component resource (a resource of type <CODE>'thng</CODE>') required of any Component Manager component. In addition, a translation extension must contain code to handle required request codes passed to it by the Component Manager as well as translation-specific request codes.<A NAME=MARKER-2-138></A><P>
 For complete details on components and their structure, see the chapter "Component Manager" in this book. This section provides specific information about translation extensions.<P>
 <A NAME=MARKER-2-139></A>The component resource binds together all the relevant resources contained in a component; its structure is defined by the <CODE>ComponentResource</CODE> data type.<P>
<PRE>
TYPE ComponentResource =
   RECORD
      cd:               ComponentDescription;
      component:        ResourceSpec;
      componentName:    ResourceSpec;
      componentInfo:    ResourceSpec;
      componentIcon:    ResourceSpec;
   END;
</PRE>
 The <CODE>component</CODE> field specifies the resource type and resource ID of the component's executable code. By convention, for translation extensions this resource should be of type <CODE>'xlat'</CODE>. (You can, however, specify some other resource type if you wish.) The resource ID can be any integer greater than or equal to 128. See the following section for further information about this code resource. The <CODE>ResourceSpec</CODE> data type has this structure:<P>
<PRE>
TYPE ResourceSpec =
   RECORD
      resourceType:     ResType;
      resourceID:       Integer;
   END;
</PRE>
 The <CODE>componentName</CODE> field specifies the resource type and resource ID of the resource that contains the component's name. Usually the name is contained in a resource of type <CODE>'STR '</CODE>. Macintosh Easy Open uses the component's name in several of the dialog boxes it displays. (For example, in <A HREF=MoreToolbox-404.html#MARKER-9-24>Figure 7-3 on page 7-6</A>, one of the translation extensions has the component name "Hang Ten.") This string should be as short as possible.<P>
 The <CODE>componentInfo</CODE> field specifies the resource type and resource ID of the resource that contains a description of the component. Usually the description is contained in a resource of type <CODE>'STR '</CODE>. This information is not currently used by Macintosh Easy Open, but some development tools may use it.<P>
 The <CODE>componentIcon</CODE> field specifies the resource type and resource ID of the resource that contains an icon for the component. Usually the icon is contained in a resource of type <CODE>'ICON'</CODE>. This icon is not currently used by Macintosh Easy Open, but some development tools may use it. <P>
<DL>
<DT><B>Note</B>
<DD>The icon displayed in <A HREF=MoreToolbox-404.html#MARKER-9-27>Figure 7-4 on page 7-7</A> is part of the translation extension's advertisement; it is not supplied by Macintosh Easy Open itself.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 The <CODE>cd</CODE> field of the <CODE>ComponentResource</CODE> structure is a component description record, which contains additional information about the component. A component description record is defined by the <CODE>ComponentDescription</CODE> data structure.<P>
<PRE>
TYPE ComponentDescription =
   RECORD
      componentType:          LongInt;
      componentSubType:       LongInt;
      componentManufacturer:  LongInt;
      componentFlags:         LongInt;
      componentFlagsMask:     LongInt;
   END;
</PRE>
 For translation extensions, the <CODE>componentType</CODE> field must be set to <CODE>'xlat'</CODE>. In addition, the <CODE>componentSubType</CODE> field must be set to 0 (because there are currently no subtypes of translation extensions). The <CODE>componentManufacturer</CODE> field identifies the supplier of the component. You should register your component with Apple's Component Registry Group to receive a unique manufacturer code; this code typically corresponds to the signature of your translation extension.<P>
 The <CODE>componentFlags</CODE> field of the component description for a translation extension contains bit flags that encode information about the extension. Currently, you can use this field to specify whether the extension supports file translation routines or scrap translation routines, or both. (See the chapter "Component Manager" in this book for information about the standard flags that you can also specify in the <CODE>componentFlags</CODE> field.) <P>
<PRE>
CONST
   kSupportsFileTranslation   = 1;  {file translation extension}
   kSupportsScrapTranslation  = 2;  {scrap translation extension}
</PRE>
 You should set the <CODE>componentFlagsMask</CODE> field to 0.<P>
<DL>
<DT><B>IMPORTANT</B>
<DD>For compatibility with early versions of the Component Manager, a <CODE>'thng'</CODE> resource should be locked. You can set the other resource attributes in any way you wish.<EM></EM><A NAME=MARKER-9-198></A><A NAME=MARKER-2-82></A>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 <A NAME=MARKER-2-142></A>In addition to the component resource, a translation extension must contain the string and icon resources specified in the component resource (for example, the resource that contains the extension's name). You might also want to include several other resources in the translation extension, including the standard <CODE>'BNDL'</CODE>, <CODE>'FREF'</CODE>, and <CODE>'ICN#'</CODE> resources used by the Finder and a <CODE>'PICT'</CODE> resource that contains an advertisement or banner to be displayed in the translation progress dialog box<A NAME=MARKER-2-143></A>. You should also include a <CODE>'kind'</CODE> resource listing kind strings for all the file types your extension can translate from or to; this allows the Finder to display correct kind strings once your extension is installed. <A HREF=#MARKER-9-144>Listing 7-4</A> shows, in Rez input format, the component resource and associated resources of a sample translation extension.<P>
<B>Listing 7-4  <A NAME=MARKER-9-144></A>Sample resources for a translation extension</B><P>
<PRE>
/*a component resource*/
resource 'thng' (128, locked) {
   'xlat',                    /*all translation extensions have this type*/
   0,                         /*subtype is unused*/
   'MYCO',                    /*creator signature of extension*/
   kSupportsFileTranslation,  /*only file routines are implemented*/
   0,                         /*mask is unused and should be 0*/
   'xlat',128,                /*resource type &amp; ID of translation extension*/
   'STR ',128,                /*resource type and ID of name string*/
   'STR ',129,                /*resource type and ID of information string*/
   'ICON',128                 /*resource type and ID of icon*/
};

/*strings*/
resource 'STR ' (128, purgeable) {
   &quot;Hang Ten&quot;
};

resource 'STR ' (129, purgeable) {
   &quot;Hang Ten Translation Extension&quot;
};

/*an icon*/
resource 'ICON' (128, purgeable) {
   $&quot;7FFF FFF0 8000 0008 8000 0008 8000 0008&quot;
   $&quot;8000 0008 8000 0008 8000 0008 8000 0008&quot;
   $&quot;A000 0008 D000 000A 9000 000D 1000 0009&quot;
   $&quot;1000 0001 1000 0001 1000 0001 1000 0001&quot;
   $&quot;1000 0001 1000 0001 1000 0001 1000 0001&quot;
   $&quot;1000 0009 9000 000D D000 000A A000 0008&quot;
   $&quot;8000 0008 8000 0008 8000 0008 8000 0008&quot;
   $&quot;8000 0008 8000 0008 8000 0008 7FFF FFF0&quot;,
};

/*kind strings for document types supported by this extension*/
resource 'kind' (128, purgeable) {
   'SURF',
   verUS,
   {
      ftApplicationName,      &quot;SurfWriter&quot;,
      'SURF',                 &quot;SurfWriter document&quot;,
   }
};

resource 'kind' (129, purgeable) {
   'SPNT',
   verUS,
   {
      ftApplicationName ,     &quot;SurfPaint&quot;,
      'SPNT',                 &quot;SurfPaint document&quot;,
   }
};

resource 'kind' (130, purgeable) {
   'ttxt',
   verUS,
   {
      ftApplicationName ,     &quot;TeachText&quot;,
      'ttro',                 &quot;TeachText document&quot;,
   }
};
</PRE>
 Your translation extension is contained in a resource file. The creator of the file can be any type you wish, but the type of the file must be <CODE>'thng'</CODE>. If the extension contains a <CODE>'BNDL'</CODE> resource, then the file's bundle bit must be set.<A NAME=MARKER-2-145></A><P>
<DL>
<DT><B>IMPORTANT</B>
<DD>The Finder looks for open and kind resources only in files that have their bundle bit set.<A NAME=MARKER-9-383></A><EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-414.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-416.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
