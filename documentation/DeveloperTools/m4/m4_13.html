<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html401/loose.dtd">
<html>
<!--
This manual is for GNU M4 (version 1.4.6, 24 August 2006),
a package containing an implementation of the m4 macro language.

Copyright C 1989, 1990, 1991, 1992, 1993, 1994, 2004, 2005,
2006 Free Software Foundation, Inc.


Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License,
Version 1.2 or any later version published by the Free Software
Foundation; with no Invariant Sections, no Front-Cover Texts, and no
Back-Cover Texts.  A copy of the license is included in the section
entitled "GNU Free Documentation License."

-->
<!-- Created on September, 23 2007 by texi2html 1.70 -->
<!--
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people <dev@texi2html.cvshome.org>
Send bugs and suggestions to <users@texi2html.cvshome.org>

-->
<head>
<title>GNU M4, version 1.4.6: 13. Miscellaneous builtin macros</title>

<meta name="description" content="GNU M4, version 1.4.6: 13. Miscellaneous builtin macros">
<meta name="keywords" content="GNU M4, version 1.4.6: 13. Miscellaneous builtin macros">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.70">
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
ul.toc {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">

<a name="NOD69"></a>
<a name="SEC68"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left" scope="row">[<a href="m4_12.html#SEC67" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC69" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="m4_12.html#SEC62" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="m4.html#SEC_Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="m4_14.html#SEC72" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="m4.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="m4_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="m4_18.html#SEC83" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="m4_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1 class="chapter"> 13. Miscellaneous builtin macros </h1>

<p>This chapter describes various builtins, that do not really belong in
any of the previous chapters.

</p><table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top" scope="row"><a href="#SEC69">13.1 Printing error messages</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
<tr><td align="left" valign="top" scope="row"><a href="#SEC70">13.2 Printing current location</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
<tr><td align="left" valign="top" scope="row"><a href="#SEC71">13.3 Exiting from <code>m4</code></a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                      Exiting from m4
</td></tr>
</table>

<hr size="6">
<a name="NOD70"></a>
<a name="SEC69"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left" scope="row">[<a href="#SEC68" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC70" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC68" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC68" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="m4_14.html#SEC72" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="m4.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="m4_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="m4_18.html#SEC83" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="m4_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 13.1 Printing error messages </h2>

<p>You can print error messages using <code>errprint</code>:

</p><dl>
<dt><u>Builtin:</u> <b>errprint</b><i> (<var>message</var>, &hellip;)</i>
<a name="IDX77"></a>
</dt>
<dd><p>Prints <var>message</var> and the rest of the arguments on the
standard error output, separated by spaces.

</p><p>The expansion of <code>errprint</code> is void.
The macro <code>errprint</code> is recognized only with parameters.
</p></dd></dl>

<table><tr><td scope="row">&nbsp;</td><td><pre class="example">errprint(`Invalid arguments to forloop
')
error--&gt;Invalid arguments to forloop
&rArr;
</pre></td></tr></table>
<p>A trailing newline is <em>not</em> printed automatically, so it must be
supplied as part of the argument, as in the example.  BSD
implementations of <code>m4</code> do append a trailing newline on each
<code>errprint</code> call, while some other implementations only print the
first argument.

</p><hr size="6">
<a name="NOD71"></a>
<a name="SEC70"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left" scope="row">[<a href="#SEC69" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC71" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC68" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC68" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="m4_14.html#SEC72" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="m4.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="m4_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="m4_18.html#SEC83" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="m4_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 13.2 Printing current location </h2>

<p>To make it possible to specify the location of an error, three
utility builtins exist:

</p><dl>
<dt><u>Builtin:</u> <b>__file__</b>
<a name="IDX78"></a>
</dt>
<dt><u>Builtin:</u> <b>__line__</b>
<a name="IDX79"></a>
</dt>
<dt><u>Builtin:</u> <b>__program__</b>
<a name="IDX80"></a>
</dt>
<dd><p>Expand to the quoted name of the current input file, the
current input line number in that file, and the quoted name of the
current invocation of <code>m4</code>.
</p></dd></dl>

<table><tr><td scope="row">&nbsp;</td><td><pre class="example">errprint(__program__:__file__:__line__: `input error
')
error--&gt;m4:stdin:1: input error
&rArr;
</pre></td></tr></table>
<p>Line numbers start at 1 for each file.  If the file was found due to the
`<samp>-I</samp>' option or <code>M4PATH</code> environment variable, that is
reflected in the file name.  The syncline option (`<samp>-s</samp>',
see section <a href="m4_1.html#SEC4">Invoking <code>m4</code></a>), and the
`<samp>f</samp>' and `<samp>l</samp>' flags of <code>debugmode</code> (see section <a href="m4_6.html#SEC35">Controlling debugging output</a>),
also use this notion of current file and line.  Redefining the three
location macros has no effect on syncline, debug, or warning message
output.  Assume this example is run in the
`<tt>checks</tt>' directory of the GNU M4 package, using
`<samp>--include=../examples</samp>' in the command line to find the file
`<tt>incl.m4</tt>' mentioned earlier:

</p><table><tr><td scope="row">&nbsp;</td><td><pre class="example">define(`foo', ``$0' called at __file__:__line__')
&rArr;
foo
&rArr;foo called at stdin:2
include(`incl.m4')
&rArr;Include file start
&rArr;foo called at ../examples/incl.m4:2
&rArr;Include file end
&rArr;
</pre></td></tr></table>
<p>Currently, all text wrapped with <code>m4wrap</code> (see section <a href="m4_7.html#SEC42">Saving input</a>) behaves
as though it came from line 0 of the file &quot;&quot;.  It is hoped that a
future release of <code>m4</code> can overcome this limitation and remember
which file invoked the call to <code>m4wrap</code>.

</p><p>The <code>__program__</code> macro behaves like `<samp>$0</samp>' in shell
terminology.  If you invoke <code>m4</code> through an absolute path or a link
with a different spelling, rather than by relying on a <code>PATH</code> search
for plain `<samp>m4</samp>', it will affect how <code>__program__</code> expands.  The
intent is that you can use it to produce error messages with the same
formatting that <code>m4</code> produces internally.  It can also be used
within <code>syscmd</code> (see section <a href="m4_12.html#SEC64">Executing simple commands</a>) to pick the same version of
<code>m4</code> that is currently running, rather than whatever version of
<code>m4</code> happens to be first in <code>PATH</code>.

</p><hr size="6">
<a name="NOD72"></a>
<a name="SEC71"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left" scope="row">[<a href="#SEC70" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="m4_14.html#SEC72" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC68" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC68" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="m4_14.html#SEC72" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="m4.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="m4_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="m4_18.html#SEC83" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="m4_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 13.3 Exiting from <code>m4</code> </h2>

<p>If you need to exit from <code>m4</code> before the entire input has been
read, you can use <code>m4exit</code>:

</p><dl>
<dt><u>Builtin:</u> <b>m4exit</b><i> ([<var>code</var> = `<samp></samp>'])</i>
<a name="IDX81"></a>
</dt>
<dd><p>Causes <code>m4</code> to exit, with exit status <var>code</var>.  If <var>code</var> is
left out, the exit status is zero.  If <var>code</var> cannot be parsed, or
is outside the range of 0 to 255, the exit status is one.  No further
input is read, and all wrapped and diverted text is discarded.
</p></dd></dl>

<p>A common use of this is to abort processing:

</p><dl>
<dt><u>Composite:</u> <b>fatal_error</b><i> (<var>message</var>)</i>
<a name="IDX82"></a>
</dt>
<dd><p>Abort processing with an error message and non-zero status.  Prefix
<var>message</var> with details about where the error occurred, and print the
resulting string to standard error.
</p></dd></dl>

<table><tr><td scope="row">&nbsp;</td><td><pre class="example">define(`fatal_error',
       `errprint(__program__:__file__:__line__`: fatal error: $*
')m4exit(`1')')
&rArr;
fatal_error(`this is a BAD one, buster')
error--&gt;m4:stdin:4: fatal error: this is a BAD one, buster
</pre></td></tr></table>
<p>After this macro call, <code>m4</code> will exit with exit status 1.  This macro
is only intended for error exits, since the normal exit procedures are
not followed, e.g., diverted text is not undiverted, and saved text
(see section <a href="m4_7.html#SEC42">Saving input</a>) is not reread.  (This macro has a subtle bug, when
invoked from wrapped text.  You should try to see if you can find it and
correct it.  see section <a href="m4_16.html#SEC79">Correct version of some examples</a>)

</p><table><tr><td scope="row">&nbsp;</td><td><pre class="example">m4wrap(`This text is lost to `m4exit'.')
&rArr;
divert(`1') And so is this.
divert
&rArr;
m4exit
</pre></td></tr></table>
<p>Note that it is still possible for the exit status to be different than
what was requested by <code>m4exit</code>.  If <code>m4</code> detects some other
error, such as a write error on standard out, the exit status will be
non-zero even if <code>m4exit</code> requested zero.

</p><hr size="6">
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left" scope="row">[<a href="#SEC68" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="m4_14.html#SEC72" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="m4.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="m4_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="m4_18.html#SEC83" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="m4_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<p>
 <font size="-1">
  This document was generated by <em>System Administrator</em> on <em>September, 23 2007</em> using <a href="http://texi2html.cvshome.org/"><em>texi2html 1.70</em></a>.
 </font>
 <br>

</p>
</body>
</html>
