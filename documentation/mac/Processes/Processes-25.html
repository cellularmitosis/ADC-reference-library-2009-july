<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Launching Other Applications (IM: Pr)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING25></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Processes-24.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Processes-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Processes-171.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Processes-26.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html"><B>Inside Macintosh:</B></A> <A HREF="Processes-2.html"><B>Processes</B></A><BR><DD><A HREF="Processes-21.html"><B>Chapter 2 - Process Manager</B></A> / <A HREF="Processes-23.html"><B>Using the Process Manager </B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING25-0></A>
<H2><A NAME=MARKER-21-43></A>Launching Other Applications</H2>
 <A NAME=MARKER-2-141></A><A NAME=MARKER-2-39></A>You can launch other applications by calling the high-level <CODE>LaunchApplication</CODE> function. This function lets your application control various options associated with launching an application. For example, you can<P>
<UL>
<LI>allow the application to be launched in a partition smaller than the preferred size but greater than the minimum size, or allow it to be launched only in a partition of the preferred size
<LI>launch an application without terminating your own application, bring the launched application to the front, and get information about the launched application
<LI>request that your application be notified if any application that it has launched terminates<P>
</UL>
 Earlier versions of system software used a shorter parameter block as a parameter to the <CODE>_Launch</CODE> trap macro. The <CODE>_Launch</CODE> trap macro still supports the use of this parameter block. Applications using the <CODE>LaunchApplication</CODE> function should use the new launch parameter block (of type <CODE>LaunchParamBlockRec</CODE>). Use the <CODE>Gestalt</CODE> function and specify the selector <CODE>gestaltOSAttr</CODE> to determine which launch features are available.<A NAME=MARKER-9-184></A><P>
 Most applications don't need to launch other applications. However, if your application includes a desk accessory or another application, you might use either the high-level <CODE>LaunchApplication</CODE> function to launch an application or the <CODE>LaunchDeskAccessory</CODE> function to launch a desk accessory. For example, if you have implemented a spelling checker as a separate application, you might use the <CODE>LaunchApplication</CODE> function to open the spelling checker when the user chooses Check Spelling from one of your application's menus.<A NAME=MARKER-2-53></A><P>
 You specify a launch parameter block as a parameter to the <CODE>LaunchApplication</CODE> function. In this launch parameter block, you can specify the filename of the application to launch, specify whether to allow launching only in a partition of the preferred size or to allow launching in a smaller partition, and set various other options--for example, whether your application should continue or terminate after it launches the specified application.<P>
 The <CODE>LaunchApplication</CODE> function launches the application from the specified file and returns the process serial number, preferred partition size, and minimum partition size if the application is successfully launched.<P>
 Note that if you launch another application without terminating your application, the launched application does not actually begin executing until you make a subsequent call to <CODE>WaitNextEvent</CODE> or <CODE>EventAvail</CODE>.<P>
 The launch parameter block is defined by the <CODE>LaunchParamBlockRec</CODE> data type.<A NAME=MARKER-2-92></A><A NAME=MARKER-2-93></A><P>
<PRE>
TYPE LaunchParamBlockRec = 
   RECORD
      reserved1:              LongInt;             {reserved}
      reserved2:              Integer;             {reserved}
      launchBlockID:          Integer;             {extended block}
      launchEPBLength:        LongInt;             {length of block}
      launchFileFlags:        Integer;             {app's Finder flags}
      launchControlFlags:     LaunchFlags;         {launch options}
      launchAppSpec:          FSSpecPtr;           {location of app's file}
      launchProcessSN:        ProcessSerialNumber; {returned psn}
      launchPreferredSize:    LongInt;             {returned pref size}
      launchMinimumSize:      LongInt;             {returned min size}
      launchAvailableSize:    LongInt;             {returned avail size}
      launchAppParameters:    AppParametersPtr;    {high-level event}
   END;
</PRE>
 In the <CODE>launchBlockID</CODE> field, specify the constant <CODE>extendedBlock</CODE> to identify the parameter block and to indicate that you are using the fields following it in the launch parameter block.<A NAME=MARKER-2-52></A><A NAME=MARKER-2-133></A><P>
<PRE>
CONST
   extendedBlock              = $4C43;    {extended block}
</PRE>
 In the <CODE>launchEPBLength</CODE> field, specify the constant <CODE>extendedBlockLen</CODE> to indicate the length of the remaining fields in the launch parameter block (that is, the length of the fields following the <CODE>launchEPBLength</CODE> field). For compatibility, you should always specify the length value in this field.<A NAME=MARKER-2-31></A><A NAME=MARKER-2-160></A><P>
<PRE>
CONST
   extendedBlockLen           = sizeof(LaunchParamBlockRec) - 12;
</PRE>
 The <CODE>launchFileFlags</CODE> field contains the Finder flags for the application file. (See the chapter "Finder Interface" in <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I> for a description of the Finder flags.) The <CODE>LaunchApplication</CODE> function sets this field for you if you set the bit defined by the <CODE>launchNoFileFlags</CODE> constant in the <CODE>launchControlFlags</CODE> field. Otherwise, you must get the Finder flags from the application file and set this field yourself (by using the File Manager routine <CODE>FSpGetFInfo</CODE>, for example).<A NAME=MARKER-2-6></A><A NAME=MARKER-2-122></A><P>
 In the <CODE>launchControlFlags</CODE> field, you specify various options that control how the specified application is launched. See the section <A HREF=Processes-32.html#MARKER-9-114>"Launch Options" on page 2-15</A> for information on the launch control flags.<A NAME=MARKER-2-58></A><P>
 You specify the application to launch in the <CODE>launchAppSpec</CODE> field of the launch parameter block. In this field, you specify a pointer to a file system specification record (<CODE>FSSpec</CODE>). See the chapter "File Manager" in <I><A HREF="../Files/Files-2.html">Inside Macintosh: Files</A></I> for a complete description of the file system specification record.<A NAME=MARKER-2-99></A><P>
 The <CODE>LaunchApplication</CODE> function sets the initial default directory of the application to the parent directory of the application file.<A NAME=MARKER-2-60></A><P>
 If it successfully launches the application, <CODE>LaunchApplication</CODE> returns, in the <CODE>launchProcessSN</CODE> field, a process serial number. You can use this number in Process Manager routines to refer to this application.<A NAME=MARKER-2-113></A><P>
 The <CODE>LaunchApplication</CODE> function returns the <CODE>launchPreferredSize</CODE> and <CODE>launchMinimumSize</CODE> fields of the launch parameter block. The values of these fields are based on their corresponding values in the <CODE>'SIZE'</CODE> resource. These values may be greater than those specified in the application's <CODE>'SIZE'</CODE> resource because the returned sizes include any adjustments to the size of the application's stack. See the chapter "Event Manager" in <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I> for information on how the size of the application stack is adjusted. Values are always returned in these fields whether or not the launch was successful. These values are 0 if an error occurred--for example, if the application file could not be found<A NAME=MARKER-2-44></A><A NAME=MARKER-2-43></A>.<P>
 The <CODE>LaunchApplication</CODE> function returns a value in the <CODE>launchAvailableSize</CODE> field only when the <CODE>memFullErr</CODE> result code is returned. This value indicates the largest partition size currently available for allocation.<A NAME=MARKER-2-119></A><P>
 The <CODE>launchAppParameters</CODE> field specifies the first high-level event sent to an application. If you set this field to <CODE>NIL</CODE>, the <CODE>LaunchApplication</CODE> function automatically creates and sends an Open Application event to the launched application. (See the chapter "Apple Event Manager" in <I><A HREF="../IAC/IAC-2.html">Inside Macintosh: Interapplication Communication</A></I> for a description of this event.) To send a particular high-level event to the launched application, you can specify a pointer to an application parameters record. The application parameters record is defined by the data type <CODE>AppParameters</CODE>.<P>
<PRE>
TYPE AppParameters = 
   RECORD
      theMsgEvent:      EventRecord;       {event (high-level)}
      eventRefCon:      LongInt;           {reference constant}
      messageLength:    LongInt;           {length of buffer}
      messageBuffer:    ARRAY [0..0] OF SignedByte;
   END;
</PRE>
 You specify the high-level event in the fields <CODE>theMsgEvent</CODE>, <CODE>eventRefCon</CODE>, <CODE>messageLength</CODE>, and <CODE>messageBuffer</CODE>.<P>
 <A HREF=#MARKER-9-66>Listing 2-2</A> demonstrates how you can use the <CODE>LaunchApplication</CODE> function.<A NAME=MARKER-21-65></A><P>
<B>Listing 2-2  <A NAME=MARKER-9-66></A>Launching an application</B><P>
<PRE>
PROCEDURE LaunchAnApplication (mySFReply: StandardFileReply);
VAR
   myLaunchParams:      LaunchParamBlockRec;
   launchedProcessSN:   ProcessSerialNumber;
   launchErr:           OSErr;
   prefSize:            LongInt;
   minSize:             LongInt;
   availSize:           LongInt;
BEGIN
   WITH myLaunchParams DO
   BEGIN
      launchBlockID := extendedBlock;
      launchEPBLength := extendedBlockLen;
      launchFileFlags := 0;
      launchControlFlags := launchContinue + launchNoFileFlags;
      launchAppSpec := @mySFReply.sfFile;
      launchAppParameters := NIL;
   END;
   launchErr := LaunchApplication(@myLaunchParams);

   prefsize := myLaunchParams.launchPreferredSize;
   minsize := myLaunchParams.launchMinimumSize;
   IF launchErr = noErr THEN
      launchedProcessSN := myLaunchParams.launchProcessSN
   ELSE IF launchErr = memFullErr THEN
      availSize := myLaunchParams.launchAvailableSize
   ELSE
      DoError(launchErr);
END;
</PRE>
 <A HREF=#MARKER-9-66>Listing 2-2</A> indicates which application file to launch by using a file system specification record (perhaps returned by the <CODE>StandardGetFile</CODE> routine) and specifying, in the <CODE>launchAppSpec</CODE> field, a pointer to this record. The <CODE>launchControlFlags</CODE> field indicates that <CODE>LaunchApplication</CODE> should extract the Finder flags from the application file, launch the application in a partition of the preferred size, bring the launched application to the front, and not terminate the current process.<P>
 By default, <CODE>LaunchApplication</CODE> brings the launched application to the front and sends the foreground application to the background. If you don't want to bring an application to the front when it is first launched, set the <CODE>launchDontSwitch</CODE> flag in the <CODE>launchControlFlags</CODE> field of the launch parameter block.<P>
 In addition, if you want your application to continue to run after it launches another application, you must set the <CODE>launchContinue</CODE> flag in the <CODE>launchControlFlags</CODE> field of the launch parameter block. For a complete description of the available launch control options, see <A HREF=Processes-32.html#MARKER-9-114>"Launch Options" on page 2-15</A>.<P>
 If you want your application to be notified about the termination of an application it has launched, set the <CODE>acceptAppDiedEvents</CODE> flag in your <CODE>'SIZE'</CODE> resource. If you set this flag and an application launched by your application terminates, your application receives an Application Died Apple event (<CODE>'aevt'</CODE> <CODE>'obit'</CODE>). See <A HREF=Processes-27.html#MARKER-9-79>"Terminating an Application" on page 2-11</A> for more information on the Application Died event.<A NAME=MARKER-2-3></A><A NAME=MARKER-2-123></A><A NAME=MARKER-2-69></A><A NAME=MARKER-9-60></A><A NAME=MARKER-9-82></A><A NAME=MARKER-2-47></A><P>
</BLOCKQUOTE><P>
<HR>
<center>
<A HREF="Processes-24.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Processes-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Processes-171.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Processes-26.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Processes-3.html">&copy; Apple Computer, Inc.</A><br>17 JUN 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
