<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>The Menu Resource(IM:Tb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING183></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Toolbox-182.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-184.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Toolbox-2.html"><B>Macintosh Toolbox Essentials</B></A> / <BR><DD><A HREF="Toolbox-89.html"><B>Chapter 3 - Menu Manager</B></A> / <A HREF="Toolbox-107.html"><B>Menu Manager Reference</B></A><BR><DL><DD><A HREF="Toolbox-182.html"><B>Resources</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING183-0></A>
<H3><A NAME=MARKER-9-629></A>The Menu Resource</H3>
 <A NAME=MARKER-2-698></A>You can provide descriptions of your menus in <CODE>'MENU'</CODE> resources and use the <CODE>GetMenu</CODE> function or <CODE>GetNewMBar</CODE> function (if you also provide an <CODE>'MBAR'</CODE> resource) to read in the descriptions of your menus. After reading in the resource description, the Menu Manager stores the information about specific menus in menu records<A NAME=MARKER-2-699></A>.<A NAME=MARKER-2-700></A><P>
<DL>
<DT><B>WARNING</B>
<DD>Menus in a resource must not be purgeable.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 <A NAME=MARKER-16-701></A><A HREF=#MARKER-9-703>Figure 3-37</A> shows the format of a compiled <CODE>'MENU'</CODE> resource. See <A HREF=Toolbox-98.html#MARKER-9-231>Listing 3-1 on page 3-43</A> for a description of a <CODE>'MENU'</CODE> resource in Rez input format. <A NAME=MARKER-2-660></A><P>
<B>Figure 3-37  <A NAME=MARKER-9-703></A>Structure of a compiled menu (<CODE>'MENU'</CODE>) resource</B><P>

<IMG ALIGN = BOTTOM SRC = "graphics/Figure_1-37_MM-34.jpg"><P>
 A compiled version of a <CODE>'MENU'</CODE> resource contains the following elements:<P>
<UL>
<LI>Menu ID. Each menu in your application should have a unique menu ID. Note that the menu ID does not have to match the resource ID, although by convention most applications assign the same number for a menu's resource ID and menu ID. A negative menu ID indicates a menu belonging to a desk accessory (except for submenus of a desk accessory). A menu ID from 1 through 235 indicates a menu (or submenu) of an application; a menu ID from 236 through 255 indicates a submenu of <BR>a desk accessory. Apple reserves the menu ID of 0. <A NAME=MARKER-2-704></A>
<LI>Placeholder (two integers containing 0) for the menu's width and height. After reading in the resource data, the Menu Manager requests the menu's menu definition procedure to calculate the width and height of the menu and to store these values in the <CODE>menuWidth</CODE> and <CODE>menuHeight</CODE> fields of the menu record.
<LI>Resource ID of the menu's menu definition procedure. If the integer 0 appears here (as specified by the <CODE>textMenuProc</CODE> constant in the Rez input file), the Menu Manager uses the standard menu definition procedure to manage the menu. If you provide your own menu definition procedure, its resource ID should appear in these bytes. After reading in the menu's resource data, the Menu Manager reads in the menu definition procedure, if necessary. The Menu Manager stores a handle to the menu's menu definition procedure in the <CODE>menuProc</CODE> field of the menu record. <A NAME=MARKER-2-705></A>
<LI>Placeholder (an integer containing 0).
<LI>The initial enabled state of the menu and first 31 menu items. This is a 32-bit value, where bits 1-31 indicate if the corresponding menu item is disabled or enabled, and bit 0 indicates whether the menu is enabled or disabled. The Menu Manager automatically enables menu items greater than 31 when a menu is created.
<LI>The length (in bytes) of the menu title.
<LI>The title of the menu. 
<LI>Variable-length data that describes the menu items. If you provide your own menu definition procedure, you can define and provide this variable-length data according to the needs of your procedure. The Menu Manager simply reads in the data for each menu item and stores it as variable data at the end of the menu record. The menu definition procedure is responsible for interpreting the contents of the data. For example, the standard menu definition procedure interprets this data according to the description given in the following paragraphs.
<LI>Placeholder (a byte containing 0) to indicate the end of the menu item definitions.<P>
</UL>
 If you use the standard menu definition procedure, your <CODE>'MENU'</CODE> resource should describe the menu items in this manner. For each menu item, you need to provide its text, the icon number, the keyboard equivalent or other value ($1B to indicate the menu item has a submenu, $1C to indicate a script code other than the system script for the item's text, $1D to indicate the item's icon should be reduced, or $1E to indicate that an<DFN> <CODE>'SICN'</CODE></DFN> icon should be used), the marking character of the menu item or menu ID of the menu item's submenu, and the font style of the menu item's text. If an item doesn't have a particular characteristic, specify 0 for that characteristic. <A HREF=#MARKER-9-706>Figure 3-38</A> shows the variable-length data portion of a compiled <CODE>'MENU'</CODE> resource that uses the standard menu definition procedure.<P>
<B>Figure 3-38  <A NAME=MARKER-9-706></A>The variable-length data that describes menu items as defined by the standard menu definition procedure</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/Figure_1-38_MM-35.jpg"><P>
 The variable-length data portion of a compiled version of a <CODE>'MENU'</CODE> resource that uses the standard menu definition procedure contains the following elements:<P>
<UL>
<LI>Length (in bytes) of the menu item's text.
<LI>Text of the menu item.
<LI>Icon number, script code, or 0 (as specified by the <CODE>noicon</CODE> constant in a Rez input file) if the menu item doesn't contain an icon and uses the system script. The icon number is a number from 1 through 255 (or from 1 through 254 for small or reduced icons). The Menu Manager adds 256 to the icon number to generate the resource ID of the menu item's icon. If a menu item has an icon, you should also provide a <CODE>'cicn'</CODE> or an <CODE>'ICON'</CODE> resource with the resource ID equal to the icon number plus 256. If you want the Menu Manager to reduce an <CODE>'ICON'</CODE> resource to the size of a small icon, also provide the value $1D in the keyboard equivalent field. If you provide an <CODE>'SICN'</CODE> resource, provide $1E in the keyboard equivalent field. Otherwise, the Menu Manager looks first for a <CODE>'cicn'</CODE> resource with the calculated resource ID and uses that icon. If you want the Menu Manager to draw the item's text in a script other than the system script, specify the script code here and also provide $1C in the keyboard equivalent field. If the script system for the specified script is installed, the Menu Manager draws the item's text using that script. An item that is drawn in a script other than the system script cannot also have an icon. <A NAME=MARKER-2-707></A><A NAME=MARKER-2-708></A><A NAME=MARKER-2-709></A><A NAME=MARKER-2-710></A><A NAME=MARKER-2-711></A>
<LI>Keyboard equivalent (specified as a 1-byte character), the value $1B (as specified by the constant <CODE>hierarchicalMenu</CODE> in a Rez input file) if the item has a submenu, the value $1C if the item uses a script other than the system script, or 0 (as specified by the <CODE>nokey</CODE> constant in a Rez input file) if the item has neither a keyboard equivalent nor a submenu and uses the system script. A menu item can have a keyboard equivalent, a submenu, a small icon, a reduced icon, or a script code, but not more than one of these characteristics. For items containing icons, you can provide $1D in this field if you want the Menu Manager to reduce an <CODE>'ICON'</CODE> resource to the size <BR>of a small icon. Provide $1E if you want the Menu Manager to use an <CODE>'SICN'</CODE> resource for the item's icon. The values $01 through $1A as well as $1F and $20 are reserved for use by Apple; your application should not use any of these reserved values in this field. <A NAME=MARKER-2-712></A> <A NAME=MARKER-2-713></A><A NAME=MARKER-2-714></A><A NAME=MARKER-2-715></A>
<LI>Marking character, the menu ID of the item's submenu, or 0 (as specified by the <CODE>nomark</CODE> constant in a Rez input file) if the item has neither a mark nor a submenu. A menu item can have a mark or a submenu, but not both. Submenus of an application should have menu IDs from 1 through 235; submenus of a desk accessory should have menu IDs from 236 through 255. <A NAME=MARKER-2-716></A>
<LI>Font style of the menu item. The constants <CODE>bold</CODE>, <CODE>italic</CODE>, <CODE>plain</CODE>, <CODE>outline</CODE>, and <CODE>shadow</CODE> can be used in a Rez input file to define their corresponding styles. <A NAME=MARKER-2-717></A><P>
</UL>
 If you provide your own menu definition procedure, you should use the same format <BR>for your resource descriptions of menus as shown in <A HREF=#MARKER-9-703>Figure 3-37</A>. You can use the same format or a format of your choosing to describe menu items. You can also use bits 1-31 <BR>of the <CODE>enableFlags</CODE> field of the menu record as you choose; however, bit 0 must still indicate whether the menu is enabled or disabled. <A NAME=MARKER-2-718></A><A NAME=MARKER-2-719></A><A NAME=MARKER-2-720></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Toolbox-182.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-184.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Toolbox-3.html">&copy; Apple Computer, Inc.</A><br>11 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
