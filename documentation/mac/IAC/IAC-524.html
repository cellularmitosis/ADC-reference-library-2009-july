<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>The Query Resource(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING524></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-523.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-525.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-469.html"><B>Chapter 12 - Data Access Manager</B></A> / <A HREF="IAC-487.html"><B>Data Access Manager Reference</B></A><BR><DL><DD><A HREF="IAC-523.html"><B>Resources</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING524-0></A>
<H3><A NAME=MARKER-9-407></A>The Query Resource</H3>
 <A NAME=MARKER-2-408></A><A NAME=MARKER-2-409></A><A NAME=MARKER-2-410></A><A NAME=MARKER-2-411></A>Each query document should contain a single <CODE>'qrsc'</CODE> resource. <A HREF=#MARKER-9-412>Figure 12-9</A> shows the format of the <CODE>'qrsc'</CODE> resource.<P>
<B>Figure 12-9  <A NAME=MARKER-9-412></A>Structure of a compiled query (<CODE>'qrsc'</CODE>) resource</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/DA-L-11.jpg"><P>
 A <CODE>'qrsc'</CODE> resource contains these elements:<P>
<UL>
<LI>The version number of the <CODE>'qrsc'</CODE> format. For the Data Access Manager released with System 7, the version number is 0.
<LI>The resource ID of the <CODE>'qdef'</CODE> resource containing the query definition function that the Data Access Manager is to call when it opens this <CODE>'qrsc'</CODE> resource. Use an ID of 0 if there is no query definition function for this resource--that is, if the Data Access Manager should send the query in this resource to the data server without modifications.<A NAME=MARKER-2-413></A>
<LI>The resource ID of an <CODE>'STR#'</CODE> resource that contains five Pascal strings corresponding to some of the parameters used by the <CODE>DBInit</CODE> function. If the query definition function is going to prompt the user for the values of these parameters before entering them in the query record, they should be zero-length strings in the <CODE>'STR#'</CODE> resource.
<LI><A NAME=MARKER-2-414></A>An index value indicating which element in the array of <CODE>'wstr'</CODE> IDs represents the current query. The current query is the one actually sent to the data server.
<LI>The number of <CODE>'wstr'</CODE> resources in the query document.
<LI>An array of resource IDs of the <CODE>'wstr'</CODE> resources in the query document. (The array elements are numbered starting with 1.) If the query document contains more than one <CODE>'wstr'</CODE> resource, the query definition function can prompt the user to select the query to use and modify the current query field in the query record appropriately.
<LI>The number of other resources in this query document.
<LI>An array listing the resource types and IDs of all the resources in the query document other than the standard resources included in all query documents. The resources listed in this final array are those used by the query definition function. This list should include resources embedded in other resources, such as a <CODE>'PICT'</CODE> resource that is included in a <CODE>'DITL'</CODE> resource. <A NAME=MARKER-2-415></A><A NAME=MARKER-2-416></A><A NAME=MARKER-2-417></A><A NAME=MARKER-2-418></A><P>
</UL>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-523.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-525.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
