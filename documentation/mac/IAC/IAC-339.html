<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Supplying a Resume Dispatch Function(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING339></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-338.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-340.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-331.html"><B>Chapter 10 - Scripting Components</B></A> / <A HREF="IAC-333.html"><B>Using Scripting Component Routines</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING339-0></A>
<H2><A NAME=MARKER-9-142></A>Supplying a Resume Dispatch Function</H2>
 Every scripting component calls a <B>resume dispatch function</B> during script execution if the script contains the equivalent of an AppleScript <CODE>continue</CODE> statement within an event handler. (See <A HREF=IAC-298.html#MARKER-9-77>Figure 7-7 on page 7-22</A> for an example.) The resume dispatch function dispatches the event specified by the script directly to the application's standard handler for that event. <P>
 Thus, if the script context passed to <CODE>OSADoEvent</CODE> in <A HREF=IAC-338.html#MARKER-9-139>Listing 10-7</A> specifies that the event passed in the <CODE>event</CODE> parameter should be continued--that is, handled by the application's standard Apple event handler for that event--the scripting component passes the event to the resume dispatch function currently set for that instance of the scripting component. The resume dispatch function attempts to redispatch the event to the handler installed in the application's Apple event dispatch table for that event. If the call to the resume dispatch function is successful, execution of the script proceeds from the point at which the resume dispatch function was called. If the call to the resume dispatch function is not successful, <CODE>OSADoEvent</CODE> returns <CODE>errAEEventNotHandled</CODE> in the <CODE>keyErrorNumber</CODE> parameter of the reply event. (Other routines that execute scripts, such as <CODE>OSAExecute</CODE> or <CODE>OSAExecuteEvent</CODE>, return <CODE>errOSAScriptError</CODE> in this situation, and a subsequent call to <CODE>OSAScriptError</CODE> with <CODE>kOSAErrorNumber</CODE> in the selector parameter returns <CODE>errAEEventNotHandled</CODE>.)<P>
 Some scripting components may provide routines that allow your application to set or get the pointer to the resume dispatch function used by a specified instance of a scripting component.<P>
<PRE>
TYPE AEHandlerProcPtr = EventHandlerProcPtr;
</PRE>
 A resume dispatch function takes the same parameters as an Apple event handler. <P>
<PRE>
FUNCTION MyResumeDispatch (theAppleEvent: AppleEvent; 
                           reply: AppleEvent; refCon: LongInt)
                           :OSErr;
</PRE>
 To set the resume dispatch function for a scripting component, call <CODE>OSASetResumeDispatchProc</CODE>; to get the current dispatch function for a scripting component, call <CODE>OSAGetResumeDispatchProc</CODE>. If you do not set a resume dispatch function for a scripting component, it uses standard Apple event dispatching to dispatch the event, starting with the special handler dispatch table.<P>
 You can install a resume dispatch function using the <CODE>OSASetResumeDispatchProc</CODE> function. However, if you are using a general handler similar to that in <A HREF=IAC-338.html#MARKER-9-139>Listing 10-7 on page 10-21</A> and you can rely on standard Apple event dispatching to dispatch the event correctly, you don't need to provide a resume dispatch function. Instead, you can specify <CODE>kOSAUseStandardDispatch</CODE> as the resume dispatch function and the constant <CODE>kOSADontUsePhac</CODE> as the reference constant when you call <CODE>OSASetResumeDispatchProc</CODE>.<P>
<PRE>
myErr := OSASetResumeDispatchProc(gScriptingComponent, 
               kOSAUseStandardDispatch, kOSADontUsePhac);
</PRE>
 This causes the Apple Event Manager to redispatch events that would otherwise be passed to a resume dispatch function using standard Apple event dispatching--except that the Apple Event Manager bypasses your application's special handler dispatch table and thus won't call your general Apple event handler recursively.<P>
 When a scripting component calls your resume dispatch function, the A5 register is set up for your application, and your application is the current process. <A NAME=MARKER-2-143></A> <A NAME=MARKER-2-144></A> <P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-338.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-340.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
