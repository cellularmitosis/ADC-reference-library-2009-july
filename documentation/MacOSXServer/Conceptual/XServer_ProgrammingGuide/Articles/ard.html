<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Mac OS X Server Administrator Topics: Creating Automator Actions for Apple Remote Desktop</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Creating Automator Actions for Apple Remote Desktop"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40003311" title="Creating Automator Actions for Apple Remote Desktop"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000426" target="_top">Mac OS X Server</a> &gt; <a href="../index.html" target="_top">Mac OS X Server Administrator Topics</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="UserImagesinOpenDirectory.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="abp_install.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/TP40003311-SW1" title="Creating Automator Actions for Apple Remote Desktop"></a><hr /><H1>Creating Automator Actions for Apple Remote Desktop</H1><p>Apple Remote Desktop (ARD) 3 is the latest release of Apple’s desktop management software, enabling administrators to distribute software, manage assets, and remotely administer Mac OS X systems via a network. ARD 3 takes advantage of innovative technologies in Mac OS X Tiger such as Automator.</p><p>Automator is built on the concept of actions - discrete tasks such as opening a file, cropping an image, or sending a message. With Automator users can string together a series of actions into a single Automator workflow document. Much like a script, a workflow document can be executed, triggering each action and passing any data generated by the action to the next action in the workflow.</p><p>Using the Automator actions installed with ARD and custom actions you create, you can develop workflows to automate repetitive system administration tasks. For example, workflows can distribute software, create detailed software and hardware reports, and remotely configure systems using ARD.</p><p>This article is intended for system administrators and developers looking to create their own Automator actions to supplement the actions bundled with ARD. A basic understanding of ARD, Automator, Xcode, AppleScript and the process for creating Automator actions is assumed. For background information about Automator and creating Automator actions see the <em><a href="../../../../AppleApplications/Conceptual/AutomatorConcepts/index.html#//apple_ref/doc/uid/TP40001450" target="_top">Automator Programming Guide</a></em>. For more information about AppleScript see <em><a href="../../../../../referencelibrary/GettingStarted/GS_AppleScript/index.html#//apple_ref/doc/uid/TP30001085" target="_top">Getting Started with AppleScript</a></em>.</p><p>This topic provides examples and sample code for three types of actions. The first is an action that performs a task provided by ARD. The second combines two actions into one workflow. The third example executes a UNIX or AppleScript command.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="ard.html#//apple_ref/doc/uid/TP40003311-SW2">Example 1: Locking Remote Computer Screens</a>
				
			<br/>
			
        
			
			
				<a href="ard.html#//apple_ref/doc/uid/TP40003311-SW3">Example 2: Combining ARD Tasks and UNIX Commands</a>
				
			<br/>
			
        
			
			
				<a href="ard.html#//apple_ref/doc/uid/TP40003311-SW4">Example 3: Combining AppleScript and UNIX Commands</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40003311-SW2" title="Example 1: Locking Remote Computer Screens"></a><h2>Example 1: Locking Remote Computer Screens</h2><p>Apple Remote Desktop can lock the screen of remote computers, blanking their screens and preventing user input. The following sample code, written in AppleScript, allows you to build an Automator action that uses ARD to lock remote screens. In order to reduce the length of some of the lines in the examples a line continuation character (¬) is used. The use of line continuation characters is optional. To create a line continuation character in the AppleScript Script Editor, press Option-Return on your keyboard.</p><div class="codesample"><table><tr><td scope="row"><pre>on run {these_computers, parameters}<span></span></pre></td></tr><tr><td scope="row"><pre>    if the class of these_computers is not list then set these_computers to¬<span></span></pre></td></tr><tr><td scope="row"><pre>    these_computers as list<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    set task_name to "Lock All Screens"<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    set screen_message to (|screenMessage| of parameters) as Unicode text<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    tell application "Remote Desktop"<span></span></pre></td></tr><tr><td scope="row"><pre>        set this_task to make new lock screen task with properties¬<span></span></pre></td></tr><tr><td scope="row"><pre>        {name:task_name, showing output:false, message:screen_message}<span></span></pre></td></tr><tr><td scope="row"><pre>        execute this_task on these_computers<span></span></pre></td></tr><tr><td scope="row"><pre>    end tell<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    return these_computers<span></span></pre></td></tr><tr><td scope="row"><pre>end run<span></span></pre></td></tr></table></div><p>This example contains the <code>on run</code> hander, which is part of the standard template for all Automator actions and contains the statements that are evaluated when the script runs. It expects two things: a list of computers and a parameter containing the selections made in the action's user interface. For more information about extracting the stored parameters see <span class="content_text"><a href="../../../../AppleApplications/Conceptual/AutomatorConcepts/Articles/ImplementScriptAction.html#//apple_ref/doc/uid/TP40001512" target="_top">Implementing an AppleScript Action</a></span>. </p><p>When the <code>on run</code> handler executes, it first checks to make sure the <code>these_computers</code> input parameter is indeed a list. If it is not then it is made into a list. </p><p>The third statement creates a variable called <code>screen_message</code> that contains the text that will be displayed on the remote screen when it is locked. This text is extracted from the Automator action's user interface using parameters and is formatted as Unicode text.</p><p>For instance, you might design a UI for this action in Interface Builder like this, with the text field bound to a parameter called <code>screenMessage</code>:</p><br/><div><img src = "../Art/ard_ss1.jpg" alt = "image: ../Art/ard_ss1.jpg" ></div><br/><p>Once the necessary variables are initialized, Apple Remote Desktop is used (by way of the tell application statement) to create a task called <code>this_task</code> as a lock screen task. The task is initialized with variables from the script and values from the script's input parameters and executed.</p><p>Finally the handler returns the list of computers it received in the on run handler. Though the script did not generate new data, it should return its original input so the list of computers it received can be passed to the next action in the workflow for additional processing.</p><a name="//apple_ref/doc/uid/TP40003311-SW3" title="Example 2: Combining ARD Tasks and UNIX Commands"></a><h2>Example 2: Combining ARD Tasks and UNIX Commands</h2><p>This example combines two Apple Remote Desktop tasks (Copy Items and Send UNIX) into a single Automator action. When activated, it will change a remote computer's desktop picture to be the same as the ARD administrator's desktop picture.</p><p>The AppleScript in the example makes use of double quotes, which must be escaped to be used in a UNIX shell script. When double quotes are used in your AppleScript, type a backslash (\) character immediately before the double quote.</p><div class="codesample"><table><tr><td scope="row"><pre>on run {these_computers, parameters}<span></span></pre></td></tr><tr><td scope="row"><pre>    if the class of these_computers is not list then set¬<span></span></pre></td></tr><tr><td scope="row"><pre>    these_computers to these_computers as list<span></span></pre></td></tr><tr><td scope="row"><pre>    set first_task_name to "Copy Desktop Image"<span></span></pre></td></tr><tr><td scope="row"><pre>    set second_task_name to "Replace Remote Desktop Image"<span></span></pre></td></tr><tr><td scope="row"><pre>    tell application "Finder"<span></span></pre></td></tr><tr><td scope="row"><pre>        set this_image to ((get the desktop picture) as alias)<span></span></pre></td></tr><tr><td scope="row"><pre>        set the image_name to the name of this_image<span></span></pre></td></tr><tr><td scope="row"><pre>    end tell<span></span></pre></td></tr><tr><td scope="row"><pre>    tell application "Remote Desktop"<span></span></pre></td></tr><tr><td scope="row"><pre>        set this_task to make new copy items task with properties¬<span></span></pre></td></tr><tr><td scope="row"><pre>        {name:first_task_name, showing output:false,¬<span></span></pre></td></tr><tr><td scope="row"><pre>        location:current users desktop folder, copy items:¬<span></span></pre></td></tr><tr><td scope="row"><pre>        {this_image}, bandwidth limit:0, conflict¬<span></span></pre></td></tr><tr><td scope="row"><pre>        resolution:replace, should open:false, ownership:current¬<span></span></pre></td></tr><tr><td scope="row"><pre>        console user}<span></span></pre></td></tr><tr><td scope="row"><pre>        execute this_task on these_computers<span></span></pre></td></tr><tr><td scope="row"><pre>    end tell<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    set the UNIX_script to "osascript -e 'tell application¬<span></span></pre></td></tr><tr><td scope="row"><pre>    \"Finder\"<span></span></pre></td></tr><tr><td scope="row"><pre>    set this_image to document file \"" &amp; image_name &amp; "\" ¬<span></span></pre></td></tr><tr><td scope="row"><pre>    of the desktop<span></span></pre></td></tr><tr><td scope="row"><pre>    set this_image to move this_image to (path to pictures folder)¬<span></span></pre></td></tr><tr><td scope="row"><pre>    with replacing<span></span></pre></td></tr><tr><td scope="row"><pre>    set the desktop picture to this_image<span></span></pre></td></tr><tr><td scope="row"><pre>end tell'"<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>tell application "Remote Desktop"<span></span></pre></td></tr><tr><td scope="row"><pre>    set this_task to make new send unix command task with¬<span></span></pre></td></tr><tr><td scope="row"><pre>    properties {name:second_task_name, showing output:false,¬<span></span></pre></td></tr><tr><td scope="row"><pre>    script:UNIX_script}<span></span></pre></td></tr><tr><td scope="row"><pre>    execute this_task on these_computers<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr><tr><td scope="row"><pre>    return these_computers<span></span></pre></td></tr><tr><td scope="row"><pre>end run<span></span></pre></td></tr></table></div><p>This example uses the same structure as the first example. In the script the Finder is asked to create an AppleScript alias to the current desktop picture, this alias is then used by the Remote Desktop copy items task. Finally, a UNIX script is used to set the image as the desktop picture. The UNIX command <code>osascript</code> executes an AppleScript as if it were a shell script.</p><a name="//apple_ref/doc/uid/TP40003311-SW4" title="Example 3: Combining AppleScript and UNIX Commands"></a><h2>Example 3: Combining AppleScript and UNIX Commands</h2><p>Apple Remote Desktop allows administrators to execute a UNIX command or shell script on remote systems. The <code>osascript</code> command allows developers to embed AppleScript commands in a UNIX shell script. These two technologies allow administrators to perform a wide range of tasks that are not provided as standard features of ARD. The following example code shows how to combine "Send UNIX Command" and AppleScript functionality. </p><div class="codesample"><table><tr><td scope="row"><pre>on run {these_computers, parameters}<span></span></pre></td></tr><tr><td scope="row"><pre>    if the class of these_computers is not list then set these_computers to¬<span></span></pre></td></tr><tr><td scope="row"><pre>    these_computers as list<span></span></pre></td></tr><tr><td scope="row"><pre>    set task_name to "Clean Desktop"<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    set the UNIX_script to "osascript -e 'tell application \"Finder\" to¬<span></span></pre></td></tr><tr><td scope="row"><pre>    delete every item of the desktop whose class is not disk'"<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    tell application "Remote Desktop"<span></span></pre></td></tr><tr><td scope="row"><pre>        set this_task to make new send unix command task with properties¬<span></span></pre></td></tr><tr><td scope="row"><pre>        {name:task_name, showing output:false, script:UNIX_script}<span></span></pre></td></tr><tr><td scope="row"><pre>        execute this_task on these_computers<span></span></pre></td></tr><tr><td scope="row"><pre>    end tell<span></span></pre></td></tr><tr><td scope="row"><pre>    return these_computers<span></span></pre></td></tr><tr><td scope="row"><pre>end run<span></span></pre></td></tr></table></div><p>This example is very similar to the first example, but uses a UNIX script in place of the lock screen task. In this case the AppleScript command will delete every item on the Desktop  of remote systems, excluding mounted volumes.</p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="UserImagesinOpenDirectory.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="abp_install.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-05-23<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/MacOSXServer/Conceptual/XServer_ProgrammingGuide/Articles/ard.html%3Fid%3DTP40002421-3.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/MacOSXServer/Conceptual/XServer_ProgrammingGuide/Articles/ard.html%3Fid%3DTP40002421-3.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/MacOSXServer/Conceptual/XServer_ProgrammingGuide/Articles/ard.html%3Fid%3DTP40002421-3.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
