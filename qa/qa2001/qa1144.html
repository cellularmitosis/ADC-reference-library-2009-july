<HTML><HEAD>   <title>Technical Q&amp;A QA1144: GraphicsImportSetBoundsRect resets your Matrix</title><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><meta name="keywords" content="Graphics Import, Rotation, Translation, Matrix"><meta name="Description" content="Technical Q&amp;A QA1144: This Q&amp;A discusses how calling GraphicsImportSetBoundsRectwill reset a Graphics Importers Matrix."><meta name="categories" content="QuickTime Image Compression Manager"><meta name="week-posted" content="May 27, 2002 - May 31, 2002"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10001689" title="GraphicsImportSetBoundsRect resets your Matrix"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalqas/index.html">Technical Q&As</a> &gt; <a href="../../technicalqas/QuickTime/index.html">QuickTime</a> &gt; <a href="../../technicalqas/QuickTime/idxImportExport-date.html">Import & Export</a> &gt; </p><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Q&amp;A QA1144</div>
<div id="pageheadsub">GraphicsImportSetBoundsRect resets your Matrix</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600>   <TR>      <td align="left">         <!-- begin_content -->                  <hr width=500 align=center>                                    <P id=p2>Q: I'm trying to use a Graphics Importer to rotate         images in my application. I call GraphicsImportSetMatrix         then GraphicsImportSetBoundsRect to set up the draw         rectangle, but when I call GraphicsImportDraw my image isn't         rotated. What am I doing wrong?</P>                          <P id=p4>A: GraphicsImportSetBoundsRect creates a transformation matrix           to map the image's natural bounds to the bounds specified in the call,           then sets the matrix. This results in the matrix set with your initial           call to GraphicsImportSetMatrix being reset. A single call to GraphicsImportSetMatrix           is all that is required.</P>        <P id=p4><BR>          Listing 1 demonstrates a 90 degrees clockwise rotation. </P>                  <CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550>            <TR>               <td bgcolor="#E6E6E6" align=left>                                  <pre>OSErr Rotate90(GraphicsImporterComponent inImporter){    Rect theNaturalBounds;    MatrixRecord theMatrix;    OSErr err;    err = GraphicsImportGetNaturalBounds(inImporter, &amp;theNaturalBounds);    if (err) goto bail;    // Blue says &quot;Rotating around the origin and then translating is much    // easier than working out where the appropriate centre of rotation is.&quot;    SetIdentityMatrix(&amp;theMatrix);    RotateMatrix(&amp;theMatrix, Long2Fix(90), 0, 0);    TranslateMatrix(&amp;theMatrix, Long2Fix(theNaturalBounds.bottom), 0);    err = GraphicsImportSetMatrix(inImporter, &amp;theMatrix);bail:    return err;}</pre>               </TD>            </TR>            <TR>               <td align="left">                  <P><B>Listing 1</B>. Rotate CW 90 degrees</P>               </TD>            </TR>         </TABLE></CENTER>        <BR>        <P id=p4><BR>          Listing 2 demonstrates adding scaling to the rotation.<BR>        </P>                           <CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550>            <TR>               <td bgcolor="#E6E6E6" align=left>                                  <pre>OSErr RotateAndScale(GraphicsImporterComponent inImporter){    Rect theNaturalBounds;    MatrixRecord theMatrix;    OSErr err;    err = GraphicsImportGetNaturalBounds(inImporter, &amp;theNaturalBounds);    if (err) goto bail;    SetIdentityMatrix(&amp;theMatrix);    RotateMatrix(&amp;theMatrix, Long2Fix(90), 0, 0);    TranslateMatrix(&amp;theMatrix, Long2Fix(theNaturalBounds.bottom), 0);    // scale down by 50 percent    ScaleMatrix(&amp;theMatrix, fixed1 / 2, fixed1 / 2, 0, 0);    err = GraphicsImportSetMatrix(inImporter, &amp;theMatrix);bail:    return err;}</pre>               </TD>            </TR>            <TR>               <td align="left">                  <P><B>Listing 2</B>. Rotate CW 90 degrees and scale                  down by 50%</P>               </TD>            </TR>         </TABLE>         </CENTER>        <BR>                          <P id=p4>&nbsp;</P>                                   <hr width=500 align=center>                                   <!-- begin_date --><H4><CENTER>[May 25 2002]</CENTER></H4><!-- end_date -->      </TD>   </TR></TABLE></CENTER><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/qa/qa2001/qa1144.html%3Fid%3DDTS10001689-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/qa/qa2001/qa1144.html%3Fid%3DDTS10001689-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/qa/qa2001/qa1144.html%3Fid%3DDTS10001689-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>