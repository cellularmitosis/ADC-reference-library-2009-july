<HTML>		<HEAD>        <title>UpdatingObjects in the Detail Display Group</title>		</HEAD>	<BODY bgcolor="#ffffff">		<!-- start of header -->		<!--#include virtual="/includes/framesetheader" -->		<!-- end of header --><!-- start of path --><table cellspacing=0 border=0 width=600 valign="left"><tr><td scope="row"><font face="Geneva,Helvetica,Arial" size="1"><b>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="../../../index.html">Documentation</a> <b>></b> <a href="../../webobjects.html" target="_top">WebObjects</a></font></td></tr></table><br><!-- end of path --><a href="Setting_Up__nfiguration.html" target="_right"><img src="../Images/previous.gif" border="0" alt="Previous"></a><a href="Adding_Beha_ise_Objects.html" target="_right"><img src="../Images/next.gif" border="0" alt="Next"></a>&nbsp;<br><!-- apple_doc: pageHeadingStart --><a name = "TPXREF147"></a><h2><font face="Helvetica,Arial,Lucida Grande">UpdatingObjects in the Detail Display Group</font></h2><!-- apple_doc: pageHeadingEnd --><p><font face="Times">In this section, you'll add the ability to insert, update,and delete movie roles. The MovieDetails page will then look somethinglike this:</font></p><P><img src = "../Art/detail.gif" alt = "[image: ../Art/detail.gif]"><p><font face="Times">Many of the features in this page are similar to featuresin the Main page, but in this section you perform by hand the tasksthe wizard performed for you to create Main. Already you've learnedhow to create a WODisplayGroup variable and how to bind it to dynamic elements.In this section you'll</font></p><ul><p><li>Write codeto update a display group's selected object.</li></p><p><li>Create and configure a browser.</li></p><p><li>Create a custom enterprise object class.</li></p><p><li>Use display group actions to configure image buttons to insert,update, and delete.</li></p></ul><a name = "TPXREF148"></a><h3><font face="Helvetica,Arial,Lucida Grande">Managinga WODisplayGroup's Selection</font></h3><p><font face="Times">Remember how clicking a movie title in the Main page selectsthe corresponding Movie object in <code>movieDisplayGroup</code>.MovieDetails has a similar behavior for selecting a MovieRole objectin <code>movieRoleDisplayGroup</code>.</font></p><p><font face="Times">First you need to add a hyperlink element around the repetition'srole name string so that users can select a particular MovieRole.When a user clicks one of the movie role hyperlinks, the applicationshould select the corresponding MovieRole object in the <code>movieRoleDisplayGroup</code>. </font></p><ol><p><li>Select therepetition's role name string element.</li></p><p><li>Click the Add WOHyperlink button in the toolbar to add a hyperlinkelement around the string.<p>Now you need to create an actionmethod to invoke when the hyperlink is clicked.</p></li></p><p><li>Use the Add Action command in the pull-down list to add anaction named <code>selectObject</code>,returning <code>null</code>.</li></p><p><li>Bind the <code>selectObject</code> methodto the hyperlink's <code>action</code> attribute.</li></p><p><li>Now write the code for <code>selectObject</code> in <code>MovieDetails.java</code>.Modify the <code>selectObject</code> actionto look like the following:<pre>    public WOComponent selectObject() {        movieRoleDisplayGroup.selectObject(movieRole);        return null;    }</pre></li></p></ol><a name = "TPXREF149"></a><h3><font face="Helvetica,Arial,Lucida Grande">Addinga Form</font></h3><p><font face="Times">Now lay out the user interface used to view and edit the selectedMovieRole. When you're done, it should look like the following:</font></p><P><img src = "../Art/browui.gif" alt = "[image: ../Art/browui.gif]"><ol><p><li>Add anotherhorizontal rule after the repetition.</li></p><p><li>Use the <img src = "../Art/woform.gif" alt = "[image: ../Art/woform.gif]"> buttonto add a WOForm element between the two horizontal rules.</li></p><p><li>While the Form text is highlighted, click the <img src = "../Art/wobrowser.gif" alt = "[image: ../Art/wobrowser.gif]"> button toreplace the text with a WOBrowser element.</li></p><p><li>Beneath the browser (within the bounds of the new form), typethe bolded text Role Name:.</li></p><p><li>Add a text field.</li></p><p><li>Bind the text field's <code>value</code> attributeto <code>movieRoleDisplayGroup.selectedObject.roleName</code>.</li></p></ol><a name = "TPXREF150"></a><h3><font face="Helvetica,Arial,Lucida Grande">Addinga Talent Display Group</font></h3><p><font face="Times">The browser you just created is going to display a list ofTalent objects. Like a repetition element, a browser has <code>list</code> and <code>item</code> attributes.As the browser moves through its <code>list</code>, thebrowser sets <code>item</code> tothe object at the current index. The Movies application uses a displaygroup to provide the browser with a list of Talent objects, so nowyou need to create the new display group and a variable to bindto the browser's <code>item</code> attribute. </font></p><ol><p><li>Use the AddKey command to create two new instance variables:<ul><p><li><code>talentDisplayGroup</code>,whose type is WODisplayGroup</li></p><p><li><code>talent</code>, whose typeis Talent <p>You don't need to add set and get methods forthe variables.</p></li></p></ul></li></p><p><li>Using the Display Group Options panel, assign the <code>talentDisplayGroup </code>object's<code> </code>entity toTalent.<p>Remember that to open the Display Group Options panel,simply double-click the <code>talentDisplayGroup</code> variablein the object browser. The <img src = "../Art/dash.gif" alt = "[image: ../Art/dash.gif]"> icon initiallydisplayed next to the variable indicates that initialization parametershave not yet been set.</p></li></p><p><li>Configure <code>talentDisplayGroup</code> tosort its objects alphabetically (ascending) by <code>lastName</code>.</li></p><p><li>Configure it to fetch on load and click OK.<p>After youconfigure <code>talentDisplayGroup</code>,the object browser shows a <img src = "../Art/check.gif" alt = "[image: ../Art/check.gif]"> iconnext to the variable.</p></li></p></ol><p><font face="Times">The Movies application uses a display group to provide Talentobjects, but you could fetch the Talent objects from the databasewithout one. Display groups provide a simple way to fetch, insert,update, and delete enterprise objects without writing much, if any,code. To get finer-grained control over these operations, you canwork directly with an EOEditingContext object. An editing contextcan do everything a display group does and much more, but you haveto write more code to use one. For more information, see the EOEditingContextclass specification in the <em>Enterprise Objects FrameworkReference</em>.</font></p><a name = "TPXREF151"></a><h3><font face="Helvetica,Arial,Lucida Grande">Configuringthe Browser</font></h3><p><font face="Times">Create your browser's bindings. The steps are similar tothose for creating bindings for a repetition.</font></p><ol><p><li>Bind <code>talentDisplayGroup.displayedObjects</code> tothe browser's <code>list</code> attribute.</li></p><p><li>Bind <code>talent</code> tothe browser's <code>item</code> attribute.</li></p><p><li>Bind <code>talent.lastName</code> tothe browser's <code>value</code> attribute.<p>The <code>value</code> attributetells the browser what string to display. For each <code>item</code> inits <code>list</code>, the browserevaluates the <code>item</code>'s <code>value</code>.</p><p>Thebrowser in the MovieDetails page should display the actors' fullnames, but there isn't an attribute for full name. In the nextsection, you'll create a custom Talent class that implements a <code>fullName</code> method,but for now just use <code>talent.lastName</code> asthe <code>value</code> attribute.</p><p>Abrowser also has a <code>selections</code> attributethat should be bound to an array of objects. A browser's selectioncan be zero, one, or many objects; but in the Talent browser, the selectionshould refer to a single object. Consequently, you need to add twomethods to manage the browser's selection: one to return an arraycontaining the selected Talent and one to set the selected Talentfrom an array object.</p></li></p><p><li>Add the method <code>talentSelection</code> tothe <code>MovieDetails.java</code> classas follows:<pre>    public NSArray talentSelection() {        EOEnterpriseObject aTalent;        EOEnterpriseObject aMovieRole =            (EOEnterpriseObject)movieRoleDisplayGroup.selectedObject();        if (aMovieRole == null){            return null;        }        aTalent = (EOEnterpriseObject)aMovieRole.valueForKey("talent");        if (aTalent == null){            return null;        } else {            return new NSArray(aTalent);        }    }</pre><p>Becausethe browser expects an array for its <code>selections</code> attribute,this method packages the selected MovieRole's <code>talent</code> objectin an array. If the selected MovieRole object is <code>null</code>, <code>talentSelection</code> simplyreturns <code>null</code> to indicatethat the browser shouldn't set a selection.</p></li></p><p><li>Add the method <code>setTalentSelection </code>asfollows:<pre>    public void setTalentSelection(NSArray talentArray){        if (talentArray.count() &gt; 0){            EOEnterpriseObject aMovieRole =                (EOEnterpriseObject)movieRoleDisplayGroup.selectedObject();            EOEnterpriseObject selectedTalent =                (EOEnterpriseObject)talentArray.objectAtIndex(0);            aMovieRole.addObjectToBothSidesOfRelationshipWithKey(                selectedTalent, "talent");        }    }</pre><p>Againbecause the browser uses an array for its <code>selections</code> attribute,the <code>setTalentSelection </code>methodmust take an array as its argument. If the size of <code>talentArray</code> isnonzero, then this method sets the selected MovieRole's <code>talent</code> tothe first object in the array. Note that by default, a user can'tselect more than one actor in a browser.</p><p>With the additionof these methods, WebObjects Builder now displays <code>talentSelection</code> inMovieDetail's object browser.</p></li></p><p><li>Save <code>MovieDetails.java</code>.</li></p><p><li>Bind <code>talentSelection</code> tothe browser's <code>selections</code> attribute.</li></p></ol><a name = "TPXREF152"></a><h3><font face="Helvetica,Arial,Lucida Grande">AddingInsert, Save, and Delete Buttons</font></h3><p><font face="Times">Now add the buttons that let users insert, save, and deleteMovieRoles. When you're done, it should look like the following:</font></p><P><img src = "../Art/ibuttons.gif" alt = "[image: ../Art/ibuttons.gif]"><ol><p><li>Inside theform, add three image buttons below the Role Name text field.</li></p><p><li>Inspect the first active image element.</li></p><p><li>Bind the <code>filename</code> attributeto the text (including the quotes) "DBWizardInsert.gif".</li></p><p><li>Follow the same procedure to set the second image's <code>filename</code> attributeto the text (including the quotes) "DBWizardUpdate.gif".</li></p><p><li>Set the last image's <code>filename</code> attributeto the text (including the quotes) "DBWizardDelete.gif".<p>TheWODisplayGroup class defines the actions <code>insert</code> and <code>delete</code>.You'll bind to the Insert/New and Delete buttons. It doesn't,however, provide a save method. You'll have to provide that yourself.</p></li></p><p><li>Copy the <code>saveChanges</code> methodfrom the <code>Main.java</code> classand paste it into the <code>MovieDetails.java</code> class:<pre>    public void saveChanges() throws Exception {        try {            this.session().defaultEditingContext().saveChanges();        }        catch (Exception exception) {            NSLog.err.appendln("Cannot save changes ");            throw exception;        }    }</pre></li></p><p><li>Save <code>MovieDetails.java</code>.</li></p><p><li>Bind <code>movieRoleDisplayGroup.insert</code> tothe Insert/New image's <code>action</code> attribute.</li></p><p><li>Bind the <code>saveChanges</code> methodto the "Save to database" image's <code>action</code> attribute.</li></p><p><li>Bind <code>movieRoleDisplayGroup.delete</code> tothe Delete image's <code>action</code> attribute.</li></p><p><li>Save <code>MovieDetails.wo</code>.</li></p></ol>    <br><a href="Setting_Up__nfiguration.html" target="_right"><img src="../Images/previous.gif" border="0" alt="Previous"></a><a href="Adding_Beha_ise_Objects.html" target="_right"><img src="../Images/next.gif" border="0" alt="Next"></a>&nbsp;<p><font face="Geneva,Helvetica,Arial" size="1">&#169; 2001 Apple Computer, Inc.</font></p><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></html>