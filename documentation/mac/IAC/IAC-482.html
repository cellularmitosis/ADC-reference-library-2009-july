<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Creating a Query Document(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING482></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-481.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-483.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-469.html"><B>Chapter 12 - Data Access Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING482-0></A>
<H1><A NAME=MARKER-9-209></A><A NAME=MARKER-2-210></A><A NAME=MARKER-21-211></A>Creating a Query Document</H1>
 <A NAME=MARKER-2-212></A>A query document is a file of type <CODE>'qery'</CODE> that contains a <CODE>'qrsc'</CODE> resource and one or more <CODE>'wstr'</CODE> resources, and may contain a <CODE>'qdef'</CODE> resource plus other resources. Query documents make it possible for you to write applications that can communicate with data servers without requiring familiarity with the command language used by the data server. Because a query document is most useful if it can be used by many different applications, no query document should depend on the presence of a particular application in order to function.<A NAME=MARKER-2-213></A><P>
 <A NAME=MARKER-2-214></A><EM><A NAME=MARKER-2-215></A></EM>An application can call the <CODE>DBGetNewQuery</CODE> function to convert a <CODE>'qrsc'</CODE> resource into a <A NAME=MARKER-6-216></A><B>query record</B> in memory. A query record specifies connection information and also contains a handle to an array of queries; each query can be either a complete query or a template for a query. If the <CODE>'wstr'</CODE> resource is a template, it contains the commands and data necessary to create a query, without any information that the user must add just before the query is sent. The <CODE>'qdef'</CODE> resource contains a query definition function, which can modify the query record and, if necessary, fill in the query template to create a complete query. The <CODE>DBStartQuery</CODE> function sends the query pointed to by a query record to a data server. The following sections describe the contents of a query document, describe query records, and define the <CODE>'qrsc'</CODE>, <CODE>'wstr'</CODE>, and <CODE>'qdef'</CODE> resources.<A NAME=MARKER-2-217></A><P>
<HR>
<B>Subtopics</B>
<B><!-- TOC --><DL>
<DL>
<DT><A HREF="IAC-483.html#HEADING483-0">User Interface Guidelines for Query Documents</A>
<DD>
<DT><A HREF="IAC-484.html#HEADING484-0">Contents of a Query Document</A>
<DD>
<DT><A HREF="IAC-485.html#HEADING485-0">Query Records and Query Resources</A>
<DD>
<DT><A HREF="IAC-486.html#HEADING486-0">Writing a Query Definition Function</A>
<DD>
</DL>
</DL>
</B>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-481.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-483.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
