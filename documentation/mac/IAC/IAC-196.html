<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Creating an Apple Event(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING196></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-195.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-197.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-195.html"><B>Chapter 5 - Creating and Sending Apple Events</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING196-0></A>
<H1><A NAME=MARKER-9-24></A><A NAME=MARKER-21-25></A>Creating an Apple Event</H1>
 <A NAME=MARKER-2-377></A><A NAME=MARKER-2-378></A>You create an Apple event by using the <CODE>AECreateAppleEvent</CODE> function. You supply parameters that specify the event class and event ID, the target address, the return ID, and the transaction ID, and a buffer for the returned Apple event. The <CODE>AECreateAppleEvent</CODE> function creates and returns, in the buffer you specify, an Apple event with the attributes set as your application requested. You should not directly manipulate the contents of the Apple event; rather, use Apple Event Manager functions to add additional attributes or parameters to it.<P>
 The example that follows creates an imaginary Multiply event using the <CODE>AECreateAppleEvent</CODE> function.<P>
<PRE>
myErr := AECreateAppleEvent(kArithmeticClass, kMultEventID,
                            targetAddress, kAutoGenerateReturnID,
                            kAnyTransactionID, theAppleEvent);  
</PRE>
 The event class, specified by the <CODE>kArithmeticClass</CODE> constant, identifies this event as belonging to a class of Apple events for arithmetic operations. The event ID specifies the particular Apple event within the class--in this case, an Apple event that performs multiplication.<P>
 You specify the target of the Apple event in the third parameter to <CODE>AECreateAppleEvent</CODE>. The target address can identify an application on the local computer or another computer on the network. You can specify the address using a target ID record or session reference number. For processes on the local computer, you can also use a process serial number or application signature to specify the address. See <A HREF=IAC-199.html#MARKER-9-51>"Specifying a Target Address" on page 5-10</A> for more information. <P>
 In the fourth parameter, you specify the return ID of the Apple event, which associates this Apple event with the server's reply. The <CODE>AECreateAppleEvent</CODE> function assigns the specified return ID value to the <CODE>keyReturnIDAttr</CODE> attribute of the Apple event. If a server returns a standard reply Apple event (that is, an event of event class <CODE>'aevt'</CODE> and event ID <CODE>'ansr'</CODE>) in response to this event, the Apple Event Manager assigns the reply event the same return ID. When you receive a reply Apple event, you can check the <CODE>keyReturnIDAttr</CODE> attribute to determine which outstanding Apple event the reply is responding to. You can use the <CODE>kAutoGenerateReturnID</CODE> constant to request that the Apple Event Manager generate a return ID that is unique to this session for the Apple event. Otherwise, you are responsible for making it unique. <A NAME=MARKER-2-95></A><P>
 The fifth parameter specifies the transaction ID attribute of the Apple event. A <B>transaction</B> is a sequence of Apple events that are sent back and forth between the client and server applications, beginning with the client's initial request for a service. All Apple events that are part of one transaction must have the same transaction ID.<P>
 You can use a transaction ID to indicate that an Apple event is one of a sequence of Apple events related to a single transaction. The <CODE>kAnyTransactionID</CODE> constant indicates that the Apple event is not part of a transaction.<A NAME=MARKER-21-99></A><P>
 The <CODE>AECreateAppleEvent</CODE> function creates an Apple event with only the specified attributes and no parameters. To add parameters or additional attributes, you can use other Apple Event Manager functions.<A NAME=MARKER-9-76></A><P>
<HR>
<B>Subtopics</B>
<B><!-- TOC --><DL>
<DL>
<DT><A HREF="IAC-197.html#HEADING197-0">Adding Parameters to an Apple Event</A>
<DD>
<DT><A HREF="IAC-198.html#HEADING198-0">Specifying Optional Parameters for an Apple Event</A>
<DD>
<DT><A HREF="IAC-199.html#HEADING199-0">Specifying a Target Address</A>
<DD>
</DL>
</DL>
</B>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-195.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-197.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
