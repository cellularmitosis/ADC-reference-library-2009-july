<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Control Panels (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING455></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-454.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-456.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-453.html"><B>Chapter 8 - Control Panels</B></A> / <A HREF="MoreToolbox-454.html"><B>About Control Panels </B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING455-0></A>
<H2>Control Panels</H2>
 A <B>control panel</B> manages the settings of a systemwide feature, such as the amount of memory allocated to a disk cache, the volume of the speaker, or the picture displayed by a screen saver. A control panel can also allow the user to set a global value, such as the highlight color. On the screen, a control panel appears as a modeless dialog box with controls that let users specify basic settings and preferences for the feature. A <B>control panel file</B> (a file of type <CODE>'cdev'</CODE>) contains the required resources that implement the feature and define the look of the control panel's user interface, including its icon. A control panel file also contains any optional resources needed to implement the feature.<A NAME=MARKER-2-18></A> <P>
 Among the required resources in a control panel file is a code resource that consists of a control device function. A <A NAME=MARKER-9-143></A><B>control device function,</B> also referred to as a <CODE>cdev</CODE> function, <A NAME=MARKER-2-29></A> implements the features of the control panel and performs any services offered by the control panel. Control device functions interact and communicate with the Finder. The Finder provides a number of services for control device functions, including interfacing with the Dialog Manager to create and manage each control panel's dialog box. <A NAME=MARKER-2-21></A><P>
 A control panel allows the user to modify whatever settings the particular control panel supports. A user opens a control panel from the Finder. Each control panel appears in its own dialog box. Because each control panel is an independent executable file, more than one control panel can remain open at a time, and the user can move among them or run another application while one or more control panels are open. <A HREF=#MARKER-9-22>Figure 8-1</A> shows two control panels open on the desktop. Like other windows, control panels can be dragged on the desktop. The frontmost control panel is the active one. <P>
<B>Figure 8-1  <A NAME=MARKER-9-22></A>Two control panels, each with its own window</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/CP-S-01.jpg">
 You cannot define your own menus for a control panel, but the user can use most of the Finder's Edit menu commands while working in the control panel. When your control panel is active and the user chooses a<A NAME=MARKER-2-337></A> command from the Edit menu, the Finder passes the Undo, Cut, Copy, Paste, or Clear commands to your control device function for processing. Your control device function can respond to these messages from the Finder when it is appropriate to do so; for example, if your control panel has an editable text item, your function should respond to editing commands. <P>
 Many standard control panels are provided with the system software. For example, the Sound control panel lets the user specify the volume and type of alert sound. The Mouse control panel lets the user define the speed of the onscreen cursor relative to movement of the mouse; the user can also set the double-click speed. The Startup Disk control panel lets the user specify the boot drive. <P>
 <A HREF=#MARKER-9-24>Figure 8-2</A> shows the General Controls control panel, which lets the user set the Finder's desktop color and pattern, the blinking rate of the insertion point, the number of times a menu item blinks once the user chooses it, and the time and date. <P>
<B>Figure 8-2  <A NAME=MARKER-9-24></A>The General Controls control panel</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/CP-S-02.jpg">
<A NAME=HEADING455-11></A>
<H3>A Control Panel's Resources</H3>
 A control panel file must contain certain <A NAME=MARKER-2-25></A>required resources. In addition to these, your control panel can include optional resources. You can also create any other types of resources that your control device function needs and include them in the control panel file. The resources you provide in your control panel file must adhere to conventions governing the resource ID numbers; see <A HREF=MoreToolbox-459.html#MARKER-9-105>"Resource IDs for Control Panels" on page 8-14</A> for information on these conventions. These are the required resources:<P>
<UL>
<LI>A<A NAME=MARKER-2-49></A> rectangle <A NAME=MARKER-2-342></A>positions (<CODE>'nrct'</CODE>) resource. This resource specifies the number of rectangles that <A NAME=MARKER-2-54></A>make up the display area of your control panel and a list of the coordinates defining the position for each rectangle. (Your control panel interface can have one or more rectangles containing the controls that let the user set and change values or otherwise manipulate the feature the control panel governs.)<A NAME=MARKER-2-49></A>
<LI>An <A NAME=MARKER-2-30></A>item list (<CODE>'DITL'</CODE>) resource. This resource specifies the items in your control panel. You can specify in this resource items such as static text, buttons, checkboxes, radio buttons, editable text, user items, icons, QuickDraw pictures, and other types of controls, such as pop-up menus. 
<LI>A<A NAME=MARKER-2-125></A> machine (<CODE>'mach'</CODE>) resource.<A NAME=MARKER-2-84></A> This resource specifies the<A NAME=MARKER-2-95></A> types of systems on which your control panel can run. 
<LI>A black-and-white icon list (<CODE>'ICN#'</CODE>) resource and other resources associated with an icon family. These resources define the icon for your control panel file. The icon family resources are <CODE>'ICN#'</CODE>, <CODE>'ics#'</CODE>, <CODE>'icl8'</CODE>, <CODE>'icl4'</CODE>, <CODE>'ics8'</CODE>, and <CODE>'ics4'</CODE>. See the chapter "Finder Interface" in <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I> for information on how to create an icon family. 
<LI>A <A NAME=MARKER-2-81></A>bundle (<CODE>'BNDL'</CODE>) resour<A NAME=MARKER-2-42></A>ce. This resource groups together the control panel's signature, icon, and file reference resources.  <A NAME=MARKER-2-46></A> 
<LI>A <A NAME=MARKER-9-83></A>file reference (<CODE>'FREF'</CODE>) resource. This resource associates icons with your control panel file; the Finder uses this information to display the icon for your control panel file. <A NAME=MARKER-2-38></A> 
<LI>A signature resource. This resource contains a unique four-character sequence that has the same value as your control panel's creator type.
<LI>A <A NAME=MARKER-2-70></A>control device (<CODE>'cdev'</CODE>) code <A NAME=MARKER-2-72></A>resource. This resource contains<A NAME=MARKER-2-69></A> the code that implements the control panel. <A NAME=MARKER-2-156></A><P>
</UL>
 <A NAME=MARKER-2-42></A>Although it is not required, you can also include a font information (<CODE>'finf'</CODE>) resource in your control panel file. This resource type lets you specify the font of your control panel's static text items. If you don't include a font information resource, the Finder uses the default application font, which is 9-point Geneva for Roman <A NAME=MARKER-2-83></A>scripts.<A NAME=MARKER-2-182></A> <A NAME=MARKER-2-170></A><P>
 The control device code resource contains a control device function, which must be the first section of code in the resource. The control device function handles messages from the Finder and implements the work your control panel is designed to do. The Finder handles such actions as displaying your control panel's dialog box and tracking controls in it.<P>
<A NAME=HEADING455-23></A>
<H3>The Finder's Interaction With Control Panels <A NAME=MARKER-2-48></A></H3>
 The Finder <A NAME=MARKER-2-72></A>performs the following services on behalf of your control panel: <P>
<UL>
<LI>queries your control device function initially, to determine whether it can run on the available software and hardware configuration
<LI>requests your control device function to perform any needed initialization when the user first opens your control panel
<LI>displays dialog items defined by your control panel file 
<LI>tracks user actions in controls defined by your control panel file 
<LI>manages the modeless dialog box in which your control panel is displayed (For instance, the Finder responds appropriately when the user drags the modeless dialog box or clicks its close box.)
<LI>sends your control device function the information it needs to respond to specific events or to handle Edit menu commands
<LI>displays messages to the user when the control panel cannot run on the current system and when your control device function returns an error code<P>
</UL>
 Your control panel should<P>
<UL>
<LI>provide both the required resources and any additional resources that the Finder needs to run your control panel <A NAME=MARKER-2-50></A>
<LI>initialize, open, and close your control panel appropriately as requested by the Finder
<LI>respond to activate events as requested by the Finder
<LI>draw user items in response to update events as requested by the Finder
<LI>respond to user actions in controls as requested by the Finder
<LI>respond to user keystrokes as requested by the Finder<P>
</UL>
<A NAME=HEADING455-39></A>
<H3>Control Panels and System Extensions </H3>
 Many control panels rely on <A NAME=MARKER-2-73></A>system extensions (files of type <CODE>'INIT'</CODE>) to implement their features. For example, you might implement a screen saver as a system extension and create a control panel that allows the user to set specific features of the screen saver, such as the color of the picture displayed. Although the extension creates and manages the screen saver, the user might control the look of the screen saver through settings in the control panel. In this scenario, which is used as an example throughout this chapter, <BR>the control device function and its system extension communicate and share values related to settings that the user changes. <A NAME=MARKER-2-52></A><P>
 If you use a system extension with your control panel, include it in the control panel file along with the required resources and any other optional resources you use. In System 7, <A NAME=MARKER-2-53></A>system extensions can be installed in the Control Panels folder or the Extensions folder (both of which are stored in the System Folder) or directly in the System Folder. However, if it contains a system extension, your control panel file must reside in the Control Panels folder within the System Folder. At startup time, the system software opens files of type <CODE>'cdev'</CODE> that reside in the Control Panels folder and executes any system extensions that it finds there. If the system extension portion of a control panel is not loaded at startup, the control panel won't function properly. <P>
<A NAME=HEADING455-42></A>
<H3>About User Documentation for Control Panels</H3>
 Because control panels are like independent files, you or the user can install and store them anywhere in the file system. Users might want to store frequently used control panels in the <A NAME=MARKER-2-54></A>Apple Menu Items folder or in a folder containing other utilities.<P>
 You should refer to a file of type <CODE>'cdev'</CODE> as a <I>control panel file</I> i<A NAME=MARKER-2-55></A>n any user documentation that you provide. Don't refer by name to the file type of this file or any other file. If your control panel file includes a system extension, you should direct the user to install it in the Control Panels folder or provide an installation script for this purpose. System software provides an alias (a file that points to another file) of the Control Panels folder for quick access from the Apple menu. <A HREF=#MARKER-9-56>Figure 8-3</A> shows many control panel icons in the Control Panels folder. <P>
<B>Figure 8-3  <A NAME=MARKER-9-56></A>Control panel icons in the Control Panels folder</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/CP-S-03.jpg">
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-454.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-456.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
