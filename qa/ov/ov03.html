<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!--Template 06-20-02--><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><TITLE>Technical Q&amp;A OV03: Detecting Classic and Carbon X Environments</TITLE><meta name="keywords" content="Mac OS X Classic Carbon Gestalt"><meta name="Description" content="Describes how you can find out if your application is running in the classic environment in Mac OS X."><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10001510" title="Detecting Classic and Carbon X Environments"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalqas/index.html">Technical Q&As</a> &gt; <a href="../../technicalqas/Carbon/index.html">Carbon</a> &gt; <a href="../../technicalqas/Carbon/idxRuntimeArchitecture-date.html">Runtime Architecture</a> &gt; </p><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Q&amp;A OV03</div>
<div id="pageheadsub">Detecting Classic and Carbon X Environments</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><!-- begin_content --> <CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600> <TR> <TD align="left">         <HR width="500" align=center><BR><BR>                  <P id=p2>Q: My application does things that just won't work in the         Classic environment. How do I detect the Classic environment         so that I can tell the user why certain functionality has         been disabled?</P>                  <P id=p4>A: You can detect the Classic environment using <CODE>Gestalt</CODE>,         as shown in Listing 1.</P>                  	<CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=525> <TR> <TD bgcolor="#e6e6e6" align="left"><PRE>// At the time of writing the latest version of Universal // Interfaces was 3.3.2.  These definitions are not in UI 3.3.2,// but will be in the next release version.&nbsp;enum {    gestaltMacOSCompatibilityBoxAttr = FOUR_CHAR_CODE('bbox'),                /* Classic presence and features */    gestaltMacOSCompatibilityBoxPresent = 0,                                    /* True if running under the Classic */    gestaltMacOSCompatibilityBoxHasSerial = 1,                                  /* True if Classic serial support is implemented. */    gestaltMacOSCompatibilityBoxless = 2                                        /* True if we're Boxless (screen shared with                    Carbon/Cocoa) */};&nbsp;static Boolean RunningOnClassic(void){    UInt32 response;        return (Gestalt(gestaltMacOSCompatibilityBoxAttr,                     (SInt32 *) &amp;response) == noErr)                &amp;&amp; ((response &amp;                     (1 &lt;&lt; gestaltMacOSCompatibilityBoxPresent))                    != 0);}</PRE>                                   </TD> </TR>                 <TR> <TD align="left">                  <p id=p4><B>Listing 1</B>. Detecting whether you're                  running in the Classic environment.</P>	</TD> </TR> </TABLE></CENTER>                                    <P id=p2>Q: My Carbon application does things on traditional Mac         OS that just won't work on Mac OS X. How do I detect that         I'm running on Mac OS X so that I can do things the right         way on that platform?</P>                  <P id=p4>A: DTS recommends that you test for specific         functionality rather than for an entire platform. For         example, if your application needs access to non-Carbon APIs         on traditional Mac OS, we recommend that you access those         APIs using <CODE>GetSharedLibrary</CODE> and         <CODE>FindSymbol</CODE>; if the         <CODE>GetSharedLibrary</CODE> call fails, you don't have         access to the functionality, regardless of the platform.         </P>                  <P id=p4>On the other hand, we recognize that in some cases there         is no convenient functional test, and only a platform test is         possible. In such cases, your Carbon application can detect         whether it is running on Mac OS X using <CODE>Gestalt</CODE>, as shown in         Listing 2.</P>                  	<CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=525> <TR> <TD bgcolor="#e6e6e6" align="left">                           <PRE>static Boolean RunningOnCarbonX(void){    UInt32 response;        return (Gestalt(gestaltSystemVersion,                     (SInt32 *) &amp;response) == noErr)                &amp;&amp; (response &gt;= 0x01000);}</PRE>                 </TD> </TR>                 <TR> <TD align="left">                  <p id=p4><B>Listing 2</B>. Detecting whether your                  Carbon application is running on Mac OS X.</P>	</TD> </TR> </TABLE></CENTER> </td></tr></table></CENTER><!-- end_content --><!-- begin_date --><H4 ALIGN=center>[Jan 16 2001]</H4><!-- end_date --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/qa/ov/ov03.html%3Fid%3DDTS10001510-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/qa/ov/ov03.html%3Fid%3DDTS10001510-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/qa/ov/ov03.html%3Fid%3DDTS10001510-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --> <HR width=550 align=center> </BODY> </HTML>