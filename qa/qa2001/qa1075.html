<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Q&amp;A QA1075: Making sense of IOKit error codes</title><meta name="keywords" content="I/O Kit error codes"><meta name="Description" content="Technical Q&amp;A QA1075: Explains how to interpret I/O Kit errorcodes."><meta name="categories" content="IOKit"><meta name="week-posted" content="Feb 4, 2002 - Feb 8, 2002"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10001627" title="Making sense of IOKit error codes"></a><!-- top_of_header_marker_comment --> <!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalqas/index.html">Technical Q&As</a> &gt; <a href="../../technicalqas/Darwin/index.html">Darwin</a> &gt; <a href="../../technicalqas/Darwin/idxHardwareDrivers-date.html">Hardware & Drivers</a> &gt; </p><!-- end_header_information --> <!-- bottom_of_header_marker_comment --> <!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Q&amp;A QA1075</div>
<div id="pageheadsub">Making sense of IOKit error codes</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --> <CENTER> <TABLE BORDER=0 CELLSPACING=1 WIDTH=600> <TR> <td align="left"> <!-- begin_content --> <hr width=500 align=center> <P id=p2>Q: When using I/O Kit, how can I figure out what these huge error codes mean?</p><P id=p4>A: I/O Kit uses the same error encoding scheme used by the Mach kernel. I/O Kit errors are 32 bits long and their layout is shown in Listing 1 (from <CODE>mach/error.h</CODE>).<BR> <BR> </p><CENTER> <TABLE BORDER=0 CELLPADDING=4> <TR> <td bgcolor="#E6E6E6" align=left> <pre>hi                                    lo| system(6) | subsystem(12) | code(14) |</pre></TD></TR> <TR> <td align="left"> <P><B>Listing 1</B>. error number layout</P></TD></TR> </TABLE><p align="left">The hi 6 bits are known as the system value, the next 12 bits are known as the subsystem value, and the low 14 bits make up the error code. </p></CENTER><P id=p4 align="left"> The first place to look for information about error codes is <CODE>IOKit/IOReturn.h</CODE>. Here you'll find a list of all the generic I/O Kit errors that aren't specific to a particular family. Now for an example...</p><P id=p4 align="left"> By using the information in <CODE>IOReturn.h</CODE>, we can determine that an I/O Kit error of -536870206, which in hex is 0xE00002C2, will map to... </p><table border="0" cellspacing="10" align="center"> <tr> <td align="left" scope="row"> <div align="right"><b>system</b></div></td><td align="left"> <div align="left">= 0x38</div></td><td nowrap align=left> which is equal to <CODE>sys_iokit</CODE> error.</td></tr> <tr> <td nowrap align=left scope="row"> <div align="right"><b>subSystem</b></div></td><td nowrap align=left> <div align="left">= 0x0</div></td><td nowrap align=left> so we know it's a <CODE>sub_iokit_common</CODE> error.</td></tr> <tr> <td nowrap align=left scope="row"> <div align="right"><b>code</b></div></td><td nowrap align=left> <div align="left">= 0x2C2</div></td><td nowrap align=left>which means this is a <CODE>kIOReturnBadArgument</CODE> error.</td></tr> </table><p><br> There are convenient macros for extracting these three values from an I/O Kit error code which are shown in Listing 2 (from <CODE>mach/error.h</CODE>).<br> </p><table border=0 cellpadding=4 align="center"> <tr> <td bgcolor="#E6E6E6" align=left scope="row"> <pre>#define  err_get_system(err)  (((err)&gt;&gt;26)&amp;0x3f)#define  err_get_sub(err)     (((err)&gt;&gt;14)&amp;0xfff)#define  err_get_code(err)    ((err)&amp;0x3fff)</pre></td></tr> <tr> <td align="left" scope="row"> <p><b>Listing 2</b>. macros to extract I/O Kit error information.</p></td></tr> </table><div align="center"></div><div align="center"></div><div align="center"></div><br> <p>It's also possible to get error codes back from I/O Kit with a system value of <CODE>sys_mach_ipc</CODE> (0x4, defined in <CODE>mach/error.h</CODE>).The most common of these is 268435459 or hex 0x10000003 which is the error <CODE>MACH_SEND_INVALID_DEST</CODE> defined in the Kernel.framework header <CODE>mach/message.h</CODE>. To understand why you can get a Mach error code, it helps to understand that I/O Kit uses Mach messages to communicate between user space and the kernel. The <CODE>io_service_t</CODE> type passed to calls such as <CODE>IOServiceCreatePlugInInterfaceForService</CODE> is defined as <CODE>mach_port_t</CODE> in the IOKit.framework header <CODE>IOTypes.h</CODE>. So, a <CODE>MACH_SEND_INVALID_DEST</CODE> error in this context means that a <CODE>io_service_t</CODE> is invalid. This can mean either that the <CODE>io_service_t</CODE> is uninitialized or that it was previously freed. </p><p>Remember also that each I/O Kit family defines its own family-specific error codes in a different header file. For example, USB error codes are located in <CODE>IOKit/usb/USB.h</CODE> inside Kernel.framework, while most FireWire error codes are located in <CODE>IOKit/firewire/IOFireWireFamilyCommon.h</CODE>, also inside Kernel.framework.</p><hr width=500 align=center><!-- begin_date --><H4 ALIGN=center>[Feb 06 2002]</H4><!-- end_date --></TD></TR> <TR> <td align="left">&nbsp;</TD></TR> </TABLE></CENTER><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/qa/qa2001/qa1075.html%3Fid%3DDTS10001627-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/qa/qa2001/qa1075.html%3Fid%3DDTS10001627-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/qa/qa2001/qa1075.html%3Fid%3DDTS10001627-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --> </BODY></HTML>