<!doctype html public "-//w3c//dtd html 4.0 transitional//en"><html><head>   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">   <meta name="GENERATOR" content="Mozilla/4.5 (Macintosh; I; PPC) [Netscape]">   <script language="JavaScript" src="frametest.js"></script><TITLE> The ATA Parameter Block</title></head><BODY BGCOLOR="#ffffff"><a name="top"></a><!-- start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!-- start of path --><table border="0" cellpadding="0" cellspacing="2" width="432">		<tr>	<td scope="row"><font face="Geneva,Helvetica,Arial" size="1">	<b>PATH<img src="../../../images/space.gif" width="6" height="12"></b>	<a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Documentation</a> &gt; <!-- a href="" target="_top" -->Hardware<!-- /a --> 	<b>&gt;</b> <a href="../../devicemgrs.html">Device Managers and Drivers</a>	<b>&gt;</b> <a href="../ata.html" target="_top">ATA Devices</a>	<b>&gt;</b> ATA Device Software Guide		</font></td>	</tr>	</table><br><!-- end of path --><p><A HREF="ATA.25.html"><img src="images/up.gif" border="0"></A> <A HREF="ATA.25.html"><img src="images/previous.gif" border="0"></A> <A HREF="ATA.27.html"><img src="images/next.gif" border="0"></A> <!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></a></div><!-- end top navigation --><hr><h1 CLASS="H1.Heading1"><a NAME="pgfId=325"></a><a NAME="24325"></a>The ATA Parameter Block</h1><P CLASS="T0.Text0"><a NAME="pgfId=326"></a>This section defines thefields that are common to all ATA Manager functions that use the ATA parameterblock. The fields used for specific functions are defined in the descriptionof the functions to which they apply. You use the ATA parameter block forall calls to the ATA Manager. The <tt>ataPBHdr</tt> data type defines theATA parameter block.&nbsp;<a NAME="marker=327"></a></P><P CLASS="T1.Text1"><a NAME="pgfId=328"></a>ATA Manager 3.0 defines ATAparameter block version 3, which is required for the specification of ANSIATA-2 compliant transfer timings, and DMA timing in particular. ATA Manager4.0 and later support ANSI ATA-2 and ATA-3 compliant data transfer timings.Parameter block versions 1 and 2 are still supported, but full use of version4.1.1 or later is recommended when the best data transfer performance ofthe device is required.</P><P CLASS="T1.Text1"><a NAME="pgfId=329"></a>The parameter block includesa field, ataPBFunctionCode, in which you specify the function selectorfor the particular function to be executed; you must specify a value forthis field. Each ATA function may use different fields of the ATA parameterblock for parameters specific to that function.</P><P CLASS="T1.Text1"><a NAME="pgfId=330"></a>An arrow preceding the commentindicates whether the parameter is an input parameter, an output parameter,or both.</P><br>&nbsp;<table BORDER CELLPADDING=3 ><tr><th><div CLASS="MH.ColsHd"><a NAME="pgfId=333"></a>Arrow</div></th><th><div CLASS="MH.ColsHd"><a NAME="pgfId=335"></a>Meaning</div></th></tr><tr><td VALIGN=TOP scope="row"><a NAME="pgfId=340"></a><tt>--></tt></td><td VALIGN=TOP><a NAME="pgfId=342"></a>Input</td></tr><tr><td VALIGN=TOP scope="row"><a NAME="pgfId=347"></a><tt>&lt;--</tt></td><td VALIGN=TOP><a NAME="pgfId=349"></a>Output</td></tr><tr><td VALIGN=TOP scope="row"><a NAME="pgfId=354"></a><tt>&lt;--></tt></td><td VALIGN=TOP><a NAME="pgfId=356"></a>Both&nbsp;</td></tr></table><p CLASS="T1.Text1"><a NAME="pgfId=357"></a>The following unique typedefidentifiers are used in the ATA Manager parameter block and function definitions:<dl COMPACT><BR><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13526"></a><tt>SInt8</tt></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=358"></a>&nbsp;&nbsp;&nbsp;A signed 8-bit field</dd><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13535"></a><tt>SInt16</tt></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=359"></a>&nbsp;&nbsp;&nbsp;A signed 16-bit field</dd><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13544"></a><tt>SInt32</tt></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=360"></a>&nbsp;&nbsp;&nbsp;A signed 32-bit field</dd><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13553"></a><tt>UInt8</tt></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=361"></a>&nbsp;&nbsp;&nbsp;An unsigned 8-bit field</dd><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13562"></a><tt>UInt16</tt></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=362"></a>&nbsp;&nbsp;&nbsp;An unsigned 16-bit field</dd><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13571"></a><tt>UInt32</tt></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=363"></a>&nbsp;&nbsp;&nbsp;An unsigned 32-bit field</dd></dl><BR><div CLASS="T1.Text1"><a NAME="pgfId=366"></a>The ATA parameter block headerstructure is defined as follows:<a NAME="marker=364"></a><a NAME="marker=365"></a></div><p><br><a NAME="pgfId=13582"></a><table><tr><td width=50 scope="row"><tt>typedef</tt></td><td width=100><tt>struct</tt></td><td width=100><tt>ataPBHdr</tt></td><td width=300><tt> /* ATA Manager parameter */</tt></td></tr><tr><td colspan=3 scope="row">&nbsp;</td><td><tt>/* block header structure */</tt></td></tr><tr><td colspan=4 scope="row"><tt>{</tt></td></tr><tr><td scope="row">&nbsp;</td><td><tt>Ptr </tt></td><td><tt>ataPBLink;</tt></td><td><tt>/* Reserved, initiaize to 0 */</tt></td></tr></tt><tr><td scope="row">&nbsp;</td><td><tt>SInt16</tt></td><td><tt>ataPBQType;</tt></td><td><tt>/* Type byte */</tt></td></tr></tt><tr><td scope="row">&nbsp;</td><td><tt>UInt8</tt></td><td><tt>ataPBVers;</tt></td><td><tt>/* --> Parameter block */</tt></td></tr></tt><tt><tr><td colspan=3 scope="row"></td><td><tt>/* version number */</tt></td></tr><tr><td scope="row">&nbsp;</td><td><tt>UInt8</tt></td><td><tt>ataPBReserved;</tt></td><td><tt>/* Reserved */</tt></td></tr><tr><td scope="row">&nbsp;</td><td><tt>Ptr </tt></td><td><tt>ataPBReserved2;</tt></td><td><tt>/* Reserved */</tt></td></tr><tr><td scope="row">&nbsp;</td><td><tt>ProcPtr</tt></td><td>ataPBCallbackPtr;</tt></td><td><tt>/* Universal completion*/</tt></td></tr><tr><td colspan=3 scope="row"></td><td><tt>/* routine pointer */</tt></td></tr><tr><td scope="row">&nbsp;</td><td><tt>OSErr</tt></td><td><tt>ataPBResult;/* &lt;</tt></td><td><tt>-- Returned result */</tt></td></tr><tr><td scope="row">&nbsp;</td><td><tt>UInt8</tt></td><td><tt>ataPBFunctionCode;</tt></td><td><tt>/* --> Manager function*/</tt></td></tr><tr><td colspan=3 scope="row"></td><td><tt>/* code */</tt></td></tr><tr><td scope="row">&nbsp;</td><td><tt>UInt8</tt></td><td><tt>ataPBIOSpeed;</tt></td><td><tt>/* --> I/O timing class */</tt></td></tr><tr><td scope="row">&nbsp;</td><td><tt>UInt16</tt></td><td><tt>ataPBFlags;</tt></td><td><tt>/* --> Control options */</tt></td></tr><tr><td scope="row">&nbsp;</td><td><tt>SInt16</tt></td><td><tt>ataPBReserved3;</tt></td><td><tt>/* Reserved */</tt></td></tr><tr><td scope="row">&nbsp;</td><td><tt>long</tt></td><td><tt>ataPBDeviceID;</tt></td><td><tt>/* --> Device ID */</tt></td></tr><tr><td scope="row">&nbsp;</td><td><tt>UInt32</tt></td><td><tt>ataPBTimeOut;</tt></td><td><tt>/* --> Transaction timeout*/</tt></td></tr><tr><td colspan=3 scope="row"></td><td><tt>/* value */</tt></td></tr><tr><td scope="row">&nbsp;</td><td><tt>Ptr</tt></td><td><tt>ataPBClientPtr1;</tt></td><td><tt>/* Client storage Ptr 1 */</tt></td></tr></tt><tr><td scope="row">&nbsp;</td><td><tt>Ptr</tt></td><td><tt>ataPBClientPtr2;</tt></td><td><tt>/* Client storage Ptr 2 */</tt></td></tr></tt><tr><td scope="row">&nbsp;</td><td><tt>UInt16</tt></td><td><tt>ataPBState;</tt></td><td><tt>/* Reserved, init to 0 */</tt></td></tr></tt><tr><td scope="row">&nbsp;</td><td><tt>SInt16</tt></td><td><tt>ataPBSemaphores;</tt></td><td><tt>/* Reserved */</tt></td></tr></tt><tr><td scope="row">&nbsp;</td><td><tt>SInt32</tt></td><td><tt>ataPBReserved4;</tt></td><td><tt>/* Reserved */</tt></td></tr><tr><td scope="row"><tt>} ataPBHdr;</tt></td><td colspan=3></td></tr></table><h4>Field descriptions</h4><dl COMPACT><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13586"></a><tt>ataPBLink</tt><a NAME="20961"></a></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=372"></a>This field is reserved for use by the ATA Manager.It is used internally for queuing I/O requests. It must be initializedto 0 before calling the ATA Manager and should be ignored upon return.This field should not be changed until the requested operation has completed.</dd><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13596"></a><tt>ataPBQType</tt></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=373"></a>This field is the queue type byte for safety check.It should be initialized to 0.</dd><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13605"></a><tt>ataPBVers</tt></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=374"></a>This field contains the parameter block structureversion number. Values 1 through 3 are currently supported. Any valuesgreater than 3 or a value of 0 result in a <tt>paramErr</tt> .</dd><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13614"></a><tt>ataPBReserved</tt></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=375"></a>This field is reserved for future use. To ensurefuture compatibility, all reserved fields should be set to 0.</dd><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13623"></a><tt>ataPBReserved2</tt></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=376"></a>This field is reserved for future use. To ensurefuture compatibility, all reserved fields should be set to 0.</dd><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13632"></a><tt>ataPBCallbackPtr</tt></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=377"></a>This field contains the completion routine pointerto be called on completion of the request. When this field is set to 0,it indicates a synchronous I/O request; a nonzero value indicates an asynchronousI/O request. The routine this field points to is called either when therequest has finished without error or when the request has terminated dueto an error. This field is valid for any manager request. The completionroutine is called as follows:</dd><dd CLASS="DD.DefinitionDefCont"><a NAME="pgfId=378"></a><br><tt>pascal void (*RoutinePtr) (ataPB *)</tt></dd><dd CLASS="DD.DefinitionDefCont"><a NAME="pgfId=379"></a><br>The completion routine is called with the associatedmanager parameter block in the stack.</dd><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13646"></a><tt>ataPBResult</tt></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=380"></a>Completion status. This field is returned by theATA Manager after the request is completed. The value in this field isinvalid until the operation is complete. Refer to <a href="ATA.3a.html#37212" CLASS="XRef">Table4-1</a> for a list of the possible error codes returned in this field.</dd><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13655"></a><tt>ataPBFunctionCode</tt></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=384"></a>This field is the function selector for the ATAManager. The functions are defined in <a href="ATA.2a.html#26148" CLASS="XRef">Table3-2</a> . An invalid code in this field results in an <tt>ATAFuncNotSupported</tt>error.</dd><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13665"></a><tt>ataPBPIOSpeed</tt></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=388"></a>This field specifies the I/O speed requirementfor the ATA device. It is ignored in version 3.0 of the ATA Manager. Themethod for determining the I/O speed for version 3 of the ATA Manager isprovided in the <tt>ATA_SetDevConfig</tt> function description. <br>For parameterblock versions 1 and 2, this field specifies the I/O cycle timing requirementof the specified device. This field should contain the equivalent of word51 of the identify drive data, as defined in the ATA-2 specification. Values0 through 3 are supported by version 2 of the ATA Manager. See the ATA-2specification for the definitions of the timing values. If a timing valuehigher than one supported is specified, the ATA Manager operates in thefastest timing mode supported. Until the timing value is determined byexamining the identify drive data returned by the <tt>ATA_Identify</tt>function, the client should request operations using the slowest mode (PIOmode 0). <br>In ATA Manager version 1, the value in this field is always valid.That is, this timing value is used to complete the requested operation.With version 2, the value in this field is only valid if the <tt>CurrentSpeed</tt>bit is set to 0 in the <tt>ataFlags</tt> field. If the <tt>CurrentSpeed</tt>bit is set to 1, the manager uses the timing mode set previously by the<tt>ATA_SetDevConfig</tt>command for the device, or the default value, which is mode 0.</dd><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13686"></a><tt>ataPBFlags</tt></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=389"></a>This 16-bit field contains control settings thatindicate special handling of the requested function. The control bits aredefined in <a href="ATA.26.html#20948" CLASS="XRef">Table 3-1</a> .</dd><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13695"></a><tt>ataPBReserved3</tt></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=393"></a>This field is reserved for future use. To ensurefuture compatibility, all reserved fields should be set to 0.</dd><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13704"></a><tt>ataPBDeviceID</tt></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=394"></a>A number that uniquely identifies an ATA device.This field consists of the following structure:</dd><dd CLASS="DD.DefinitionDefCont"><a NAME="pgfId=395"></a><table><tr><td width=75 scope="row"><tt>typedef</tt></td><td width=100><tt>struct</tt></td><td width=200><tt> /* Device ID structure */</tt></td></tr><tr><td colspan=3 scope="row"><tt>{</tt></td></tr><tr><td scope="row"><tr><td><tt>UInt16</tt></td><td><tt>Reserved;</tt></td><td><tt> /* The upper word is reserved */</tt></td></tr> <tr><td scope="row"><tt>UInt8</tt></td><td><tt>devNum;</tt></td><td><tt> /* Consists of device ID */</tt></td></tr><tr><td scope="row"><tt>UInt8</tt></td><td><tt>busNum</tt></td><td><tt> /* bus ID number */</tt></td></tr> <tr><td colspN=3 scope="row"><TT>} deviceIdentification;</tt></TD></tr></table></dd><BR><dd CLASS="DD.DefinitionDefCont"><a NAME="pgfId=396"></a>Version 3. 0 of the ATA Manager supports two ATAdevices per bus. The devices are physically numbered 0 and 1 respectively.Earlier versions of the ATA Manager used an unsigned 16-bit integer tospecify the device number. In version 3.0 of the ATA Manager the <tt>devNum</tt>is used to distinguish between two devices on the bus specified by <tt>busNum</tt>. In systems with only one ATA device this value is always 0.</dd><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13732"></a><tt>ataPBTimeOut</tt></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=397"></a>This field specifies the transaction timeout valuein milliseconds. A value of zero disables the transaction timeout detection.If a timeout value is not set, the system may halt indefinately if thedevice fails to respond properly.</dd><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13741"></a><tt>ataPBClientPtr1</tt></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=398"></a>This pointer field is available for applicationuse. It is not modified or used by the ATA Manager.</dd><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13750"></a><tt>ataPBClientPtr2</tt></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=399"></a>This pointer field is available for applicationuse. It is not modified or used by the ATA Manager.</dd><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13759"></a><tt>ataPBState</tt></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=400"></a>This field is used by the ATA Manager to keep trackof the current bus state. This field must contain zero when calling theATA Manager.</dd><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13768"></a><tt>ataPBSemaphores</tt></dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=401"></a>This field is reserved. To ensure future compatibility,all reserved fields should be set to 0.</dd><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13777"></a><tt>ataPBReserved</tt> 4</dt><dd CLASS="DD.DefinitionDef"><a NAME="pgfId=402"></a>This field is reserved for future use. To ensurefuture compatibility, all reserved fields should be set to 0.</dd><P><dt CLASS="DT.DefinitionTerm"><a NAME="pgfId=13786"></a>Table 3-1 describes the functions of the controlbits in the <tt>ataPBFlags</tt> field.</dt><div CLASS="Tb.Table"><a NAME="pgfId=1988"></a><BR><B>Table 3-1</B>&nbsp;&nbsp;<a NAME="20948"></a>Control bits in the <tt>ataPBFlags</tt> field&nbsp;</div><BR><table BORDER="1" CELLPADDING="3" ><tr><th ALIGN=LEFT><div CLASS="TbH.TblHd"><a NAME="pgfId=1994"></a>Name</div></th><th ALIGN=LEFT><div CLASS="TbH.TblHd"><a NAME="pgfId=1996"></a>Bit</div></th><th ALIGN=LEFT><div CLASS="TbH.TblHd"><a NAME="pgfId=1998"></a>Definition</div></th></tr><tr><td VALIGN=TOP scope="row"><a NAME="pgfId=2000"></a>--</td><td VALIGN=TOP><a NAME="pgfId=2002"></a>0-2</td><td VALIGN=TOP><a NAME="pgfId=2004"></a>Reserved.</td></tr><tr><td VALIGN=TOP scope="row"><a NAME="pgfId=2006"></a><tt>RegUpdate</tt></td><td VALIGN=TOP><a NAME="pgfId=2008"></a>3</td><td VALIGN=TOP><a NAME="pgfId=2010"></a>When set to 1 this bit indicatesthat a set of device registers should be reported back on completion ofthe request. This bit is valid for the <tt>ATA_ExecI/O</tt> function only.Refer to the description on <a href="ATA.2b.html#18909" CLASS="XRef">ATA_ExecIO</a>for details. The following device registers are reported back:<a NAME="pgfId=2014"></a><br><br>Sector count register<br>Sector number register<br>Cylinder register(s)<br>SDH register</td></tr><tr><td VALIGN=TOP scope="row"><a NAME="pgfId=2022"></a><tt>ProtocolType</tt></td><td VALIGN=TOP><a NAME="pgfId=2024"></a>5-4</td><td VALIGN=TOP><a NAME="pgfId=2026"></a>These bits specify the type ofcommand:<a NAME="pgfId=2027"></a><br><br>00 = Standard ATA<br>01 = Reserved<br>11 = ATAPI<a NAME="pgfId=2028"></a><br><br>These bits indicate how the protocolshould be handled for the command type. Setting the bits to ATAPI and providinga non-zero packet command pointer indicates that a packet command shouldbe sent prior to any data transfers. For ATA command values of A0 and A1hexadecimal, this field should contain the ATAPI setting. For all otherATA commands, the field must contain the ATA setting.&nbsp;</td></tr><tr><td VALIGN=TOP scope="row"><a NAME="pgfId=2030"></a>--</td><td VALIGN=TOP><a NAME="pgfId=2032"></a>6</td><td VALIGN=TOP><a NAME="pgfId=2034"></a>Reserved</td></tr><tr><td VALIGN=TOP scope="row"><a NAME="pgfId=2036"></a><tt>UseDMA</tt></td><td VALIGN=TOP><a NAME="pgfId=2038"></a>7</td><td VALIGN=TOP><a NAME="pgfId=2040"></a>When set to 1, this bit indicatesthe data transfer is to be via DMA. DMA transfers are only valid with version3.0 or greater of the ATA Manager and on system hardware that supportsDMA. DMA transfers to and from ATA devices use different command codesfrom the PIO transfers. The state of this bit must correspond to the commandcode.&nbsp;<a NAME="marker=2041"></a></td></tr><tr><td VALIGN=TOP scope="row"><a NAME="pgfId=2043"></a><tt>SGType</tt></td><td VALIGN=TOP><a NAME="pgfId=2045"></a>9-8</td><td VALIGN=TOP><a NAME="pgfId=2047"></a>This 2-bit field specifies thetype of scatter gather list passed in. This field is only valid for read/writeoperations.<p>The following types are defined:<a NAME="pgfId=2048"></a><br><br>00 = Scattergather disabled<br>01 = Scatter gather type I enabled<br>10 = Reserved<br>11 = Reserved<a NAME="pgfId=2052"></a><br><br>When set to 0, this field indicatesthat the <tt>ioBuffer</tt> field contains the host buffer address for thistransfer, and the <tt>ioReqCount</tt> field contains the byte transfercount.<a NAME="pgfId=2053"></a>When set to 1, this field indicates thatthe <tt>ioBuffer</tt> and the <tt>ioReqCount</tt> fields of the parameterblock for this request point to a host scatter gather list and the numberof scatter gather entries in the list, respectively.</td></tr><tr><td VALIGN=TOP scope="row"><a NAME="pgfId=2055"></a></td><td VALIGN=TOP><a NAME="pgfId=2057"></a></td><td VALIGN=TOP><a NAME="pgfId=2059"></a>The format of the scatter gatherlist is a series of the following structure definition:&nbsp;</td></tr><tr><td COLSPAN="3" scope="row"><a NAME="pgfId=2061"></a><table><tr><td colspan=2><tt>typedef</tt></td><td width=100><tt>struct</tt></td><td width=150><tt>/* SG entry structure */</tt></td><tr><tr><td colspan=4><tt>{</tt></td></tr><tr><td width=20 scope="row"></td><td width=75><tt>uchar*</tt></td><td><tt>ioBuffer;</tt></td><td><tt>/* --> Data buffer pointer */</tt></td></tr><tr><td scope="row">&nbsp;</td><td><tt>ulong</tt></td><td><tt>ioReqCount;</tt></td><td><tt>/* --> Byte count */</tt></td></tr><tr><td colspan=4 scope="row"><tt>} IOBlock;</tt></td></tr></table><tr><td VALIGN=TOP scope="row"><a NAME="pgfId=2073"></a><tt>QLockOnError</tt></td><td VALIGN=TOP><a NAME="pgfId=2075"></a>10</td><td VALIGN=TOP><a NAME="pgfId=2077"></a>When set to 0, this bit indicatesthat an error during the transaction should not freeze the I/O queue forthe device. When an error occurs on an I/O request with this bit set to0, the next queued request is processed following this request. When anerror occurs with this bit set to 1, any I/O request without the <tt>Immediate</tt>bit set is halted until an <tt>ATA_QRelease</tt> command is issued. A statuscode of hexadecimal $717 is returned for subsequent asynchronous I/O requestsuntil the <tt>I/O Queue Release</tt> command is issued. This permits theclient application to examine the state at the time of the error. However,use with caution. When this bit is set to 1 and an error condition is nothandled correctly, the system will hang.&nbsp;</td></tr><tr><td VALIGN=TOP scope="row"><a NAME="pgfId=2079"></a><tt>Immediate</tt></td><td VALIGN=TOP><a NAME="pgfId=2081"></a>11</td><td VALIGN=TOP><a NAME="pgfId=2083"></a>When this bit is set to 1, it indicatesthat the request must be executed as soon as possible and the status ofthe request must be returned. It forces the request to the head of theI/O queue for immediate execution. When this bit is set to 0, the requestis queued in the order received and is executed according to that order.</td></tr><tr><td VALIGN=TOP scope="row"><a NAME="pgfId=2085"></a><tt>ATAioDirection</tt></td><td VALIGN=TOP><a NAME="pgfId=2087"></a>13-12</td><td VALIGN=TOP><a NAME="pgfId=2089"></a>This bit field specifies the directionof data transfer. Bit values are binary and defined as follows:<a NAME="pgfId=2090"></a><br><br>00= No data transfer<a NAME="pgfId=2091"></a><br>10 = Data direction in (read)<a NAME="pgfId=2092"></a><br>01= Data direction out (write)<a NAME="pgfId=2093"></a><br>11 = Reserved<a NAME="pgfId=2094"></a><br><br>These bits do not need to specify the direction of the ATAPI command packet bytes.</td></tr><tr><td VALIGN=TOP scope="row"><a NAME="pgfId=2096"></a><tt>ByteSwap</tt></td><td VALIGN=TOP><a NAME="pgfId=2098"></a>14</td><td VALIGN=TOP><a NAME="pgfId=2100"></a>When set to 1, this bit indicatesthat every byte of data prior to transmission on write operations and uponreception on read operations is to be swapped. When this bit is set to0, it forces bytes to go out in the LSB-MSB format compatible with IBMclones. Typically, this bit should be set to 0. Setting this bit has performanceimplications because the byte swap is performed by the software. Use thisbit with caution. ATAPI command packet bytes are swapped when this bitis set to 1.&nbsp;</td></tr><tr><td VALIGN=TOP scope="row"><a NAME="pgfId=2102"></a><tt>UseConfigSpeed</tt></td><td VALIGN=TOP><a NAME="pgfId=2104"></a>15</td><td VALIGN=TOP><a NAME="pgfId=2106"></a>When set to 1, this bit indicatesthat the current I/O speed setting specified in the most recent call tothe <tt>ATA_SetDevConfig</tt> command should be used to transfer data acrossthe ATA interface. If a <tt>ATA_SetDevConfig</tt> command has not beenissued since power on, then the default setting of PIO mode 0 and singlewordDMA mode 0 are used.&nbsp;<a NAME="marker=2107"></a></td></tr></table></dl><hr>&copy; 1999 Apple Computer, Inc.<p><a href="ATA.25.html">Previous</a> | <a href="ATA.25.html">Back Up OneLevel</a> | <a href="ATA.27.html">Next</a> | <!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!-- document.write(frameLink);//--></script></a><!-- end Show/Hide frames --></P><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></html>