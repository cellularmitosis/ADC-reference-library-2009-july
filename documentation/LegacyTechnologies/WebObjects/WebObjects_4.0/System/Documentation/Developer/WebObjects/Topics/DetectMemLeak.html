<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML EXPERIMENTAL 970324//EN">
<HTML>
<HEAD>
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter">
<LINK REL="STYLESHEET" HREF="DetectMemLeak.css">
<TITLE> </TITLE></HEAD>
<BODY BGCOLOR="#ffffff">

<!--start of banner -->
<!--#include virtual="/includes/framesetheader" -->
<!-- end of banner -->
<!--start of path -->
<font face="Geneva,Helvetica,Arial" size="1">
<b>PATH<spacer type="horizontal" size="5">&nbsp;</b>
 <a href="../../../../../webobjects.html" target="_top">WebObjects 4.0 Documentation</a> <b>&gt;</b>
 <a href="TopicsTOC.html" target="_top">WebObjects Programming Topics</a>
</font>
<br><br>
<!--end of path -->


<H1 CLASS="TopictTitleTOC">
Detecting Memory Leaks
</H1>
<DIV>
<H2 CLASS="Synopsis">
<A NAME="pgfId=606101">
 </A>
Synopsis<DIV>
<IMG SRC="DetectMemLeak-1.gif">
</DIV>
</H2>
<P CLASS="Body">
<A NAME="pgfId=606102">
 </A>
Describes methods to detect and prevent memory leaks in an application.</P>
</DIV>
<DIV>
<H2 CLASS="Heading1">
<A NAME="pgfId=606103">
 </A>
Description<DIV>
<IMG SRC="DetectMemLeak-1.gif">
</DIV>
</H2>
<P CLASS="Body">
<A NAME="pgfId=606104">
 </A>
The best tool currently available to detect memory leaks is ObjectAlloc.  This application is available on all platforms.  ObjectAlloc uses the object allocation statistics built into the Foundation framework. When this facility is active, every object allocation, deallocation, copy, retain, release, and autorelease is recorded as it happens.</P>
<P CLASS="Body">
<A NAME="pgfId=606105">
 </A>
The ObjectAlloc application resides under $NEXT_ROOT/Developer/Applications on WebObjects4.0/Windows NT machines.  The ObjectAlloc application resides under /System/Developer/Applications on WebObjects 4.0/ Mac OS X Server machines.  General information about using ObjectAlloc is available by selecting the help menu.</P>
<P CLASS="Body">
<A NAME="pgfId=614146">
 </A>
You can use ObjectAlloc on a Mach/Windows machine to get the allocation information from a PDO process. To attach a PDO process to ObjectAlloc, make sure that the &quot;Executable&quot; field in the ObjectAlloc window is blank, and press the Start button (the green arrow) on the ObjectAlloc panel. A panel will appear and ask, &quot;Do you want ObjectAlloc to wait for a task to attach, and launch the task to be monitored yourself?&quot;  Press &quot;Yes&quot; to continue. The next panel appears with the environment variables that you'll need to set to monitor the task. Make sure <EM CLASS="Code">
NSKeepAllocationStatistics</EM>
 is set to YES.</P>
<P CLASS="Body">
<A NAME="pgfId=606107">
 </A>
Another memory leak detector, MallocDebug, is available on Mac OS X Server.  Since this application uses Mach-specific messaging calls, it is not available under Windows NT.  The on line help provides detailed documentation on how to prepare an application for use with MallocDebug.</P>
<P CLASS="Body">
<A NAME="pgfId=606108">
 </A>
For applications that use the Java-wrapped frameworks, WebObjects 4.0  provides methods to force garbage collection in the WOApplication class. The API is defined as follows:</P>
<DIV>
<H5 CLASS="Code-Listing">
<A NAME="pgfId=607008">
 </A>
Figure 1.  Java Code</H5>
<DIV>
<pre>public int garbageCollectionPeriod ();</pre></DIV>
<A NAME="pgfId=607010">
 </A>
<DIV>
<pre>public void setGarbageCollectionPeriod (int);</pre></DIV>
<A NAME="pgfId=607012">
 </A>
<P CLASS="Body">
<A NAME="pgfId=615053">
 </A>
&nbsp;</P>
<P CLASS="Body">
<A NAME="pgfId=606111">
 </A>
The WOGarbageCollectionPeriod defaults to 20, i.e., garbage collection will be forced every 20 requests.</P>
<P CLASS="Body">
<A NAME="pgfId=614155">
 </A>
&nbsp;</P>
</DIV>
</DIV>
<DIV>
<H2 CLASS="Heading1">
<A NAME="pgfId=614156">
 </A>
See Also<DIV>
<IMG SRC="DetectMemLeak-1.gif">
</DIV>
</H2>
<UL>
<P CLASS="Bulleted">
<A NAME="pgfId=606113">
 </A>
&#183;	Debugging</P>
<P CLASS="Bulleted">
<A NAME="pgfId=606114">
 </A>
&#183;	Detecting Freed Object Exceptions</P>
</UL>
</DIV>
<DIV>
<H2 CLASS="Heading1">
<A NAME="pgfId=606116">
 </A>
Questions<DIV>
<IMG SRC="DetectMemLeak-1.gif">
</DIV>
</H2>
<UL>
<P CLASS="Bulleted">
<A NAME="pgfId=606117">
 </A>
&#183;		What tools can I use to detect memory leaks?</P>
<P CLASS="Bulleted">
<A NAME="pgfId=615063">
 </A>
&#183;	How do I force my WebObjects application to garbage collect?</P>
</UL>
</DIV>
<DIV>
<H2 CLASS="Heading1">
<A NAME="pgfId=606118">
 </A>
Keywords<DIV>
<IMG SRC="DetectMemLeak-1.gif">
</DIV>
</H2>
<UL>
<P CLASS="Bulleted">
<A NAME="pgfId=606119">
 </A>
&#183;	Memory Leaks</P>
<P CLASS="Bulleted">
<A NAME="pgfId=606120">
 </A>
&#183;	ObjectAlloc</P>
<P CLASS="Bulleted">
<A NAME="pgfId=606121">
 </A>
&#183;	MallocDebug</P>
<P CLASS="Bulleted">
<A NAME="pgfId=606122">
 </A>
&#183;	Garbage Collection</P>
<P CLASS="Bulleted">
<A NAME="pgfId=606123">
 </A>
&#183;	Performance</P>
</UL>
</DIV>
<DIV>
<H2 CLASS="Heading1">
<A NAME="pgfId=606124">
 </A>
Revision History<DIV>
<IMG SRC="DetectMemLeak-1.gif">
</DIV>
</H2>
<P CLASS="Body">
<A NAME="pgfId=606125">
 </A>
21 July, 1998. Mai Nguyen. First Draft.</P>
<P CLASS="Body">
<A NAME="pgfId=614200">
 </A>
26 October, 1998. Clif Liu. Second Draft.</P>
<DIV>
<pre></pre></DIV>
<A NAME="pgfId=602450">
 </A>
</DIV>


<!--start of footer -->
<!--#include virtual="/includes/framesetfooter" -->
<!-- end of footer -->

</body>
</HTML>
