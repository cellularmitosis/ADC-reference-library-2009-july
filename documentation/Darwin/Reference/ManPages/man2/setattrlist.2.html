<html><head><title>Mac OS X Developer Tools
 Manual Page For setattrlist(2)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/2/setattrlist" title="Mac OS X Developer Tools
 Manual Page for setattrlist(2)"><!-- headerDoc=man; indexgroup=Section 2; uid="//apple_ref/doc/man/2/setattrlist"; name=setattrlist(2) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac&nbsp;OS&nbsp;X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>

<p style='text-align:justify;'>This manual page is associated with the Mac&nbsp;OS&nbsp;X
developer tools.  The software or headers described may not be present on your
Mac&nbsp;OS&nbsp;X installation until you install the developer tools
package.  This package is available on your Mac&nbsp;OS&nbsp;X installation DVD,
and the latest versions can be downloaded from
<a href="http://developer.apple.com/tools/download/">developer.apple.com</a>.</p>

<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
SETATTRLIST(2)              BSD System Calls Manual             SETATTRLIST(2)

<b>NAME</b>
     <b>setattrlist</b> -- set file system attributes

<b>SYNOPSIS</b>
     <b>#include</b> <b>&lt;sys/attr.h&gt;</b>
     <b>#include</b> <b>&lt;unistd.h&gt;</b>

     <u>int</u>
     <b>setattrlist</b>(<u>const</u> <u>char*</u> <u>path</u>, <u>struct</u> <u>attrlist</u> <u>*</u> <u>attrList</u>, <u>void</u> <u>*</u> <u>attrBuf</u>, <u>size</u><b>_</b><u>t</u> <u>attrBufSize</u>,
         <u>unsigned</u> <u>long</u> <u>options</u>);

<b>DESCRIPTION</b>
     The <b>setattrlist</b>() function sets attributes (that is, metadata) of file system objects.  It is the logi-<font color="#ffffff" class="whiteout">cal&nbsp;logical</font>
     cal opposite of <a href="getattrlist.2.html#//apple_ref/doc/man/2/getattrlist">getattrlist(2)</a>.  The function sets attributes about the file system object specified by
     <u>path</u> from the values in the buffer specified by <u>attrBuf</u> and <u>attrBufSize</u>.  The <u>attrList</u> parameter deter-<font color="#ffffff" class="whiteout">mines&nbsp;determines</font>
     mines what attributes are set.  The <u>options</u> parameter lets you control specific aspects of the func-<font color="#ffffff" class="whiteout">tion's&nbsp;function's</font>
     tion's behaviour.

     The <b>setattrlist</b>() function is only supported by certain volume format implementations.  For maximum
     compatibility, client programs should use high-level APIs (such as the Carbon File Manager) to access
     file system attributes.  These high-level APIs include logic to emulate file system attributes on vol-<font color="#ffffff" class="whiteout">umes&nbsp;volumes</font>
     umes that don't support <b>setattrlist</b>().

     The <u>path</u> parameter must reference a valid file system object.  All directories listed in the path name
     leading to the object must be searchable.  You must own the file system object in order to set any of
     the following attributes:

     ATTR_CMN_GRPID
     ATTR_CMN_ACCESSMASK
     ATTR_CMN_FLAGS
     ATTR_CMN_CRTIME
     ATTR_CMN_MODTIME
     ATTR_CMN_CHGTIME
     ATTR_CMN_ACCTIME

     You must be root (that is, your process's effective UID must be 0) in order to change the
     ATTR_CMN_OWNERID attribute.  Setting other attributes requires that you have write access to the
     object.

     The <u>attrList</u> parameter is a pointer to an <u>attrlist</u> structure.  You are responsible for filling out all
     fields of this structure before calling the function.  See the discussion of the <a href="getattrlist.2.html#//apple_ref/doc/man/2/getattrlist">getattrlist(2)</a> func-<font color="#ffffff" class="whiteout">tion&nbsp;function</font>
     tion for a detailed description of this structure.  To set an attribute you must set the corresponding
     bit in the appropriate <u>attrgroup</u><b>_</b><u>t</u> field of the <u>attrlist</u> structure.

     The <u>attrBuf</u> and <u>attrBufSize</u> parameters specify a buffer that contains the attribute values to set.
     Attributes are packed in exactly the same way as they are returned from <a href="getattrlist.2.html#//apple_ref/doc/man/2/getattrlist">getattrlist(2)</a> except that,
     when setting attributes, the buffer does not include the leading <u>unsigned</u> <u>long</u> length value.

     The <u>options</u> parameter is a bit set that controls the behaviour of <b>setattrlist</b>().  The following option
     bits are defined.

     FSOPT_NOFOLLOW  If this bit is set, <b>setattrlist</b>() will not follow a symlink if it occurs as the last
                     component of <u>path</u>.

<b>RETURN</b> <b>VALUES</b>
     Upon successful completion a value of 0 is returned.  Otherwise, a value of -1 is returned and <u>errno</u> is
     set to indicate the error.

<b>COMPATIBILITY</b>
     Not all volumes support <b>setattrlist</b>().  However, if a volume supports <a href="getattrlist.2.html#//apple_ref/doc/man/2/getattrlist">getattrlist(2)</a>, it must also sup-<font color="#ffffff" class="whiteout">port&nbsp;support</font>
     port <b>setattrlist</b>().  See the documentation for <a href="getattrlist.2.html#//apple_ref/doc/man/2/getattrlist">getattrlist(2)</a> for details on how to tell whether a vol-<font color="#ffffff" class="whiteout">ume&nbsp;volume</font>
     ume supports it.

     The <b>setattrlist</b>() function has been undocumented for more than two years.  In that time a number of
     volume format implementations have been created without a proper specification for the behaviour of
     this routine.  You may encounter volume format implementations with slightly different behaviour than
     what is described here.  Your program is expected to be tolerant of this variant behaviour.

     If you're implementing a volume format that supports <b>setattrlist</b>(), you should be careful to support
     the behaviour specified by this document.

<b>ERRORS</b>
     <b>setattrlist</b>() will fail if:

     [ENOTSUP]          The volume does not support <b>setattrlist</b>().

     [ENOTDIR]          A component of the path prefix is not a directory.

     [ENAMETOOLONG]     A component of a path name exceeded NAME_MAX characters, or an entire path name
                        exceeded PATH_MAX characters.

     [ENOENT]           The file system object does not exist.

     [EROFS]            The volume is read-only.

     [EACCES]           Search permission is denied for a component of the path prefix.

     [ELOOP]            Too many symbolic links were encountered in translating the pathname.

     [EFAULT]           <u>path</u>, <u>attrList</u> or <u>attrBuf</u> points to an invalid address.

     [EINVAL]           The <u>bitmapcount</u> field of <u>attrList</u> is not ATTR_BIT_MAP_COUNT.

     [EINVAL]           You try to set an invalid attribute.

     [EINVAL]           You try to set an attribute that is read-only.

     [EINVAL]           You try to set volume attributes and directory or file attributes at the same time.

     [EINVAL]           You try to set volume attributes but <u>path</u> does not reference the root of the volume.

     [EPERM]            You try to set an attribute that can only be set by the owner.

     [EACCES]           You try to set an attribute that's only settable if you have write permission, and
                        you do not have write permission.

     [EINVAL]           The buffer size you specified in <u>attrBufSize</u> is too small to hold all the attributes
                        that you are trying to set.

     [EIO]              An I/O error occurred while reading from or writing to the file system.

<b>CAVEATS</b>
     If you try to set any volume attributes, you must set ATTR_VOL_INFO in the <u>volattr</u> field, even though
     it consumes no data from the attribute buffer.

     For more caveats, see also the compatibility notes above.

<b>EXAMPLES</b>
     The following code shows how to set the file type and creator of a file by getting the
     ATTR_CMN_FNDRINFO attribute using <a href="getattrlist.2.html#//apple_ref/doc/man/2/getattrlist">getattrlist(2)</a>, modifying the appropriate fields of the 32-byte
     Finder information structure, and then setting the attribute back using <b>setattrlist</b>().  This assumes
     that the target volume supports the required attributes

     #include &lt;assert.h&gt;
     #include &lt;stdio.h&gt;
     #include &lt;stddef.h&gt;
     #include &lt;string.h&gt;
     #include &lt;sys/attr.h&gt;
     #include &lt;sys/errno.h&gt;
     #include &lt;unistd.h&gt;
     #include &lt;sys/vnode.h&gt;

     typedef struct attrlist attrlist_t;

     struct FInfoAttrBuf {
         unsigned long   length;
         fsobj_type_t    objType;
         char            finderInfo[32];
     };
     typedef struct FInfoAttrBuf FInfoAttrBuf;

     static int FInfoDemo(
         const char *path,
         const char *type,
         const char *creator
     )
     {
         int             err;
         attrlist_t      attrList;
         FInfoAttrBuf    attrBuf;

         assert( strlen(type)    == 4 );
         assert( strlen(creator) == 4 );

         memset(&amp;attrList, 0, sizeof(attrList));
         attrList.bitmapcount = ATTR_BIT_MAP_COUNT;
         attrList.commonattr  = ATTR_CMN_OBJTYPE | ATTR_CMN_FNDRINFO;

         err = getattrlist(path, &amp;attrList, &amp;attrBuf, sizeof(attrBuf), 0);
         if (err != 0) {
             err = errno;
         }

         if ( (err == 0) &amp;&amp; (attrBuf.objType != VREG) ) {
             fprintf(stderr, "Not a standard file.\n");
             err = EINVAL;
         } else {
             memcpy( &amp;attrBuf.finderInfo[0], type,    4 );
             memcpy( &amp;attrBuf.finderInfo[4], creator, 4 );

             attrList.commonattr = ATTR_CMN_FNDRINFO;
             err = setattrlist(
                 path,
                 &amp;attrList,
                 attrBuf.finderInfo,
                 sizeof(attrBuf.finderInfo),
                 0
             );
         }

         return err;
     }

<b>SEE</b> <b>ALSO</b>
     <a href="chflags.2.html#//apple_ref/doc/man/2/chflags">chflags(2)</a>, <a href="chmod.2.html#//apple_ref/doc/man/2/chmod">chmod(2)</a>, <a href="chown.2.html#//apple_ref/doc/man/2/chown">chown(2)</a>, <a href="getattrlist.2.html#//apple_ref/doc/man/2/getattrlist">getattrlist(2)</a>, <a href="getdirentriesattr.2.html#//apple_ref/doc/man/2/getdirentriesattr">getdirentriesattr(2)</a>, <a href="searchfs.2.html#//apple_ref/doc/man/2/searchfs">searchfs(2)</a>, <a href="utimes.2.html#//apple_ref/doc/man/2/utimes">utimes(2)</a>

<b>HISTORY</b>
     A <b>setattrlist</b>() function call appeared in Darwin 1.3.1 (Mac OS X version 10.0).

Darwin                         December 15, 2003                        Darwin
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man2/setattrlist.2.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man2/setattrlist.2.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man2/setattrlist.2.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
