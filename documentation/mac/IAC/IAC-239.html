<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Installing Entries in the Object Accessor Dispatch Tables(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING239></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-238.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-240.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-231.html"><B>Chapter 6 - Resolving and Creating Object Specifier Records</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING239-0></A>
<H1><A NAME=MARKER-9-132></A><A NAME=MARKER-21-133></A>Installing Entries in the Object Accessor Dispatch Tables</H1>
 <A NAME=MARKER-9-14></A><A NAME=MARKER-21-64></A><A NAME=MARKER-2-362></A>If the direct parameter for an Apple event consists of an object specifier record, your handler for the event should call the <CODE>AEResolve</CODE> function to resolve the object specifier record: that is, to find the Apple event objects or properties it describes. The <CODE>AEResolve</CODE> function resolves the object specifier record with the help of object accessor functions provided by your application. Your application installs entries for its object accessor functions in an object accessor dispatch table, which is used by the Apple Event Manager to map requests for Apple event objects or their properties to the appropriate object accessor functions. <P>
 After being called by <CODE>AEResolve</CODE>, an object accessor function should return a token that identifies (in whatever manner is appropriate for your application) the specified Apple event object or property. An object accessor function also returns a result code that indicates whether it found the Apple event object or property. The token, which is a descriptor record of data type <CODE>AEDesc</CODE>, can be of any descriptor type, including descriptor types you define yourself. For an overview of the way <CODE>AEResolve</CODE> works with your application's object accessor functions to locate Apple event objects, see <A HREF=IAC-232.html#MARKER-9-76>"Resolving Object Specifier Records,"</A> which begins on <A HREF=IAC-232.html#MARKER-9-76>page 6-4</A>.<P>
 Each object accessor function provided by your application should either find elements of a specified object class contained in an Apple event object identified by a token of a specified descriptor type, or find properties of an Apple event object identified by a token of a specified descriptor type. To determine which object accessor function to dispatch, the Apple Event Manager uses the object class ID specified in an object specifier record and the descriptor type of the token that identifies the requested object's container. For object accessor functions that find properties, you should specify the object class ID as the constant <CODE>cProperty</CODE>. <P>
 <A NAME=MARKER-2-76></A>To install entries in your application's object accessor dispatch table, use the <CODE>AEInstallObjectAccessor</CODE> function. For each object class and property your application supports, you should install entries that specify<P>
<UL>
<LI>the object class of the requested Apple event object or property
<LI>the descriptor type of the token used to identify the container for the requested Apple event object or property
<LI>the address of the object accessor function that finds objects or properties of the specified object class in containers described by tokens of the specified descriptor type
<LI>a reference constant<P>
</UL>
 You provide this information in the first four parameters to the <CODE>AEInstallObjectAccessor</CODE> function. The fifth parameter allows you to indicate whether the entry should be added to your application's object accessor dispatch table or the system object accessor dispatch table.<P>
 The <B>system object accessor dispatch table</B> is a table in the system heap that contains object accessor functions available to all processes running on the same computer. The object accessor functions in your application's object accessor dispatch table are available only to your application. If <CODE>AEResolve</CODE> cannot find an object accessor function for the Apple event object class in your application's object accessor dispatch table, it looks in the system object accessor dispatch table. If it doesn't find an object accessor function there either, it returns the result code <CODE>errAEAccessorNotFound</CODE>. <A NAME=MARKER-2-87></A><A NAME=MARKER-2-81></A> <P>
 If <CODE>AEResolve</CODE> successfully calls the appropriate object accessor function in either the application object accessor dispatch table or the system object accessor dispatch table, the object accessor function returns a token and result code. The <CODE>AEResolve</CODE> function uses the token and result code to continue resolving the object specifier record. If, however, the token identifies the final Apple event object or property in the container hierarchy, <CODE>AEResolve</CODE> returns the token for the final resolution in the <CODE>theToken</CODE> parameter.<P>
 If the <CODE>AEResolve</CODE> function calls an object accessor function in the system object accessor dispatch table, your Apple event handler may not recognize the descriptor type of the token returned by the function. If this happens, your handler should attempt to coerce the token to an appropriate descriptor type. If coercion fails, return the result code <CODE>errAEUnknownObjectType</CODE>. When your handler returns this result code, the Apple Event Manager attempts to locate a system Apple event handler that can recognize the token.<P>
 It is up to you to decide how many object accessor functions you need to write and install for your application. You can install one object accessor function that locates Apple event objects of several different object classes, or you can write separate object accessor functions for certain object classes. Similarly, you may want to use only one descriptor type for all the tokens returned by your object accessor functions, or you may want to use several descriptor types. The sections that follow provide examples of alternative approaches.<P>
 For more information about object accessor functions, see <A HREF=IAC-242.html#MARKER-9-157>"Writing Object Accessor Functions,"</A> which begins on <A HREF=IAC-242.html#MARKER-9-157>page 6-34</A>.<P>
<HR>
<B>Subtopics</B>
<B><!-- TOC --><DL>
<DL>
<DT><A HREF="IAC-240.html#HEADING240-0">Installing Object Accessor Functions That Find Apple Event Objects</A>
<DD>
<DT><A HREF="IAC-241.html#HEADING241-0">Installing Object Accessor Functions That Find Properties</A>
<DD>
</DL>
</DL>
</B>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-238.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-240.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
