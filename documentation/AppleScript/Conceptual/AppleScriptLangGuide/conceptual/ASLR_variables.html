<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>AppleScript Language Guide: Variables and Properties</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Variables and Properties"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40000983-CH223" title="Variables and Properties"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../ScriptingAutomation/index.html#//apple_ref/doc/uid/TP30000440-TP40005948" target="_top">Scripting &amp; Automation</a> &gt; <a href="../../../../ScriptingAutomation/AppleScript-date.html#//apple_ref/doc/uid/TP30000440-TP40005948-TP30000481" target="_top">AppleScript</a> &gt; <a href="../index.html" target="_top">AppleScript Language Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="ASLR_fundamentals.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="ASLR_script_objects.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40000983-CH223-SW10" title="Variables and Properties"></a><h1>Variables and Properties</h1><p><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_477"></a>Variables and properties are introduced in previous chapters in this document. You use them in <code>script</code> objects to store and manipulate values.</p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_13" title="Important:"></a><p><strong>Important:</strong>&nbsp;In reading this chapter, you should be familiar with the information on implicit and explicit <code>run</code> handlers in <span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW15">“run Handlers.”</a></span></p><p></p></div><p>The following sections cover common issues in working with variables and properties, including how to declare them and how AppleScript interprets their scope in a script:</p><ul class="ul"><li class="li"><p><span class="content_text"><a href="ASLR_variables.html#//apple_ref/doc/uid/TP40000983-CH223-SW2">“Defining Properties”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_variables.html#//apple_ref/doc/uid/TP40000983-CH223-SW11">“Declaring Variables”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_variables.html#//apple_ref/doc/uid/TP40000983-CH223-SW1">“Scope of Variables and Properties”</a></span></p></li></ul><a name="//apple_ref/doc/uid/TP40000983-CH223-SW2" title="Defining Properties"></a><h2>Defining Properties</h2><p><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_478"></a>Property labels follow the rules described in <span class="content_text"><a href="ASLR_lexical_conventions.html#//apple_ref/doc/uid/TP40000983-CH214-SW4">“Identifiers.”</a></span></p><p>Property definitions use the following syntax:</p><p><code>property </code><em>propertyLabel</em><code> : </code><em>expression</em></p><dl class="termdef">	<dt><em>propertyLabel</em></dt><dd><p>An identifier.</p></dd><dt><em>expression</em></dt><dd><p>An AppleScript expression that sets the initial value for the property. Property definitions are evaluated before variable assignments, so property definitions cannot contain variables.</p></dd></dl><p>The following are examples of valid property definitions:</p><div class="codesample"><table><tr><td scope="row"><pre>property windowCount : 0<span></span></pre></td></tr><tr><td scope="row"><pre>property defaultName : "Barry"<span></span></pre></td></tr><tr><td scope="row"><pre>property strangeValue : (pi * 7)^2<span></span></pre></td></tr></table></div><p>After you define a property, you can change its value with the <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW53">copy</a></code> or <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW52">set</a></code> command.</p><p>The value set by a property definition is not reset each time the script is run; instead, it persists until the script is recompiled.</p><p>You cannot declare a property in a handler but a handler can access a property defined in its containing <code>script</code> object.</p><a name="//apple_ref/doc/uid/TP40000983-CH223-SW11" title="Declaring Variables"></a><h2>Declaring Variables</h2><p><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_479"></a>Variable names follow the rules described in <span class="content_text"><a href="ASLR_lexical_conventions.html#//apple_ref/doc/uid/TP40000983-CH214-SW4">“Identifiers.”</a></span></p><p>To create a variable in AppleScript, you assign it a value using the <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW53">copy</a></code> or <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW52">set</a></code> command. For example, the following statements create and initialize two variables, one named <code>circumference</code> and one named <code>savedResult</code>:</p><div class="codesample"><table><tr><td scope="row"><pre>set circumference to pi * 3.5 --result: 10.995574287564<span></span></pre></td></tr><tr><td scope="row"><pre>copy circumference to savedResult --result: 10.995574287564 (copy of 1st variable)<span></span></pre></td></tr></table></div><p>As shown in this example, a variable assignment can make use of a previously defined variable. It can also make use of properties declared in the same <code>script</code> object.</p><p>There are some obvious, and some more subtle, differences in using <code>copy</code> and <code>set</code> to create a variable—see <span class="content_text"><a href="ASLR_variables.html#//apple_ref/doc/uid/TP40000983-CH223-SW7">“Using the copy and set Commands”</a></span> for more information.</p><p>If you assign a new value to a variable that is already in use, it replaces the old value. You can assign a simple value, an expression, or an object specifier—expressions are evaluated and object specifiers are resolved to obtain the value to assign. To create a variable whose value is an object specifier itself, rather than the value of the object specified, use the <code><a href="../reference/ASLR_operators.html#//apple_ref/doc/uid/TP40000983-CH5g-SW1">a reference to</a></code> operator.</p><p>The next two sections describe how you can explicitly define a <code>local</code> or a <code>global</code> variable. These variable types differ primarily in their scope. Scope, which refers to where a variable is accessible within a script, is described in detail in <span class="content_text"><a href="ASLR_variables.html#//apple_ref/doc/uid/TP40000983-CH223-SW1">“Scope of Variables and Properties.”</a></span></p><a name="//apple_ref/doc/uid/TP40000983-CH223-SW12" title="Local Variables"></a><h3>Local Variables</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_480"></a><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_481"></a>You can declare explicit <code>local</code> variables using the following syntax:</p><p><code>local </code><em>variableName</em> [<code>, </code><em>variableName</em> ]…</p><dl class="termdef">	<dt><em>variableName</em></dt><dd><p>An identifier.</p></dd></dl><p>The following are examples of valid <code>local</code> variable declarations:</p><div class="codesample"><table><tr><td scope="row"><pre>local windowCount -- defines one variable<span></span></pre></td></tr><tr><td scope="row"><pre>local agentName, agentNumber, agentHireDate -- defines three variables<span></span></pre></td></tr></table></div><p>You cannot assign an initial value to a <code>local</code> variable in its declaration, nor can you declare a class for the variable. Instead, you use the <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW53">copy</a></code> or <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW52">set</a></code> command to initialize a variable and set its class. For example:</p><div class="codesample"><table><tr><td scope="row"><pre>set windowCount to 0 -- initialize to zero; an integer<span></span></pre></td></tr><tr><td scope="row"><pre>set agentName to "James Smith" -- assign agent name; a text string<span></span></pre></td></tr><tr><td scope="row"><pre>set agentNumber to getAgentNumber(agentName) -- call handler; an integer<span></span></pre></td></tr><tr><td scope="row"><pre>copy current date to agentHireDate -- call current date command; a date<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000983-CH223-SW13" title="Global Variables"></a><h3>Global Variables</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_482"></a><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_483"></a>The syntax for <code>global</code> variables is nearly identical to that for <code>local</code> variables:</p><p><code>global </code><em>variableName</em> [<code>, </code><em>variableName</em> ]…</p><dl class="termdef">	<dt><em>variableName</em></dt><dd><p>An identifier.</p></dd></dl><p>The following are examples of valid <code>global</code> variable declarations:</p><div class="codesample"><table><tr><td scope="row"><pre>global gAgentCount<span></span></pre></td></tr><tr><td scope="row"><pre>global gStatementDate, gNextAgentNumber<span></span></pre></td></tr></table></div><p>As with <code>local</code> variables, you use the <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW53">copy</a></code> or <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW52">set</a></code> command to initialize <code>global</code> variables and set their class types. For example:</p><div class="codesample"><table><tr><td scope="row"><pre>set gAgentCount to getCurrentAgentCount() -- call handler to get count<span></span></pre></td></tr><tr><td scope="row"><pre>set gStatementDate to current date -- get date from current date command<span></span></pre></td></tr><tr><td scope="row"><pre>set gNextAgentNumber to getNextAvailNumber() -- call handler to get number<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000983-CH223-SW7" title="Using the copy and set Commands"></a><h3>Using the copy and set Commands</h3><p>As its name implies, when you use the <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW53">copy</a></code> command to create a variable, it always creates a separate copy (though note that a copy of an object specifier still specifies the same object). However, when you use the <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW52">set</a></code> command to create a variable, the new variable always refers to the original object or value. You have essentially created another name for the same object.</p><p>When more than one variable refers to a changeable (or mutable) object, a change to the object is observable through any of the variables. The types of AppleScript objects that are mutable are <a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_484"></a><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_485"></a><code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCGECID">date</a></code>, <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCDBHIE">list</a></code>, <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCDGEAH">record</a></code>, and <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW5">script</a></code> objects.</p><p>For objects that cannot be modified (immutable objects), variables created with the <code>set</code> command may seem like copies—there’s no way to change the object the variables point to, so they seem independent. This is demonstrated in the example in the next section that creates the variables <code>myName</code> and <code>yourName</code>.</p><a name="//apple_ref/doc/uid/TP40000983-CH223-SW9" title="Declaring Variables with the set Command"></a><h4>Declaring Variables with the set Command</h4><p><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_486"></a>You can use the <code>set</code> command to set a variable to any type of object. If the variable doesn’t exist, it is created; if it does exist, its current value is replaced:</p><div class="codesample"><table><tr><td scope="row"><pre>set numClowns to 5 --result: 5<span></span></pre></td></tr><tr><td scope="row"><pre>set myList to { 1, 2, "four" } --result: {1, 2, "four"}<span></span></pre></td></tr><tr><td scope="row"><pre>tell application "TextEdit"<span></span></pre></td></tr><tr><td scope="row"><pre>    set word1 to word 1 of front document --result: some word<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>The following example uses a mutable object. It creates two variables that refer to the same list, then modifies the list through one of the variables:</p><div class="codesample"><table><tr><td scope="row"><pre>set myList to { 1, 2, 3 }<span></span></pre></td></tr><tr><td scope="row"><pre>set yourList to myList<span></span></pre></td></tr><tr><td scope="row"><pre>set item 1 of myList to 4<span></span></pre></td></tr></table></div><p>After executing these statements, the statements <code>item 1 of myList</code> and <code>item 1 of yourList</code> both yield <code>4</code>, because both variables refer to the same list.</p><p>Now suppose you’re working with an immutable object, such as a <code>text</code> object:</p><div class="codesample"><table><tr><td scope="row"><pre>set myName to "Sheila"<span></span></pre></td></tr><tr><td scope="row"><pre>set yourName to myName<span></span></pre></td></tr></table></div><p>Both variables refer to the same <code>text</code> object, but <code>text</code> objects are not mutable, so there is no way to change the the value <code>myName</code> such that it affects the value of <code>yourName</code>. (If you assign new text to one of the variables, you are just creating a new, separate <code>text</code> object.)</p><p>The <code>set</code> command can assign several variables at once using a pattern, which may be a list or record: a list or record of variables on one side, and a list or record of values on the other. Values are matched to variables based on their position for a list, or based on their keys for a record. Not having enough values is an error; if there are too many values, the extra ones are ignored. The order in which the values are evaluated and the variables are assigned is unspecified, but all values are evaluated before any assignments are made.</p><p>The Examples section of the <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW52">set</a></code> command shows some simple pattern assignments. Here is an example with more complex patterns:</p><div class="codesample"><table><tr><td scope="row"><pre>set x to {8, 94133, {firstName:"John", lastName:"Chapman"}}<span></span></pre></td></tr><tr><td scope="row"><pre>set {p, q, r} to x<span></span></pre></td></tr><tr><td scope="row"><pre>(* now p, q, and r have these values:<span></span></pre></td></tr><tr><td scope="row"><pre>                p = 8<span></span></pre></td></tr><tr><td scope="row"><pre>                q = 94133<span></span></pre></td></tr><tr><td scope="row"><pre>                r = {firstName:"John", lastName:"Chapman"}  *)<span></span></pre></td></tr><tr><td scope="row"><pre>set {p, q, {lastName:r}} to x<span></span></pre></td></tr><tr><td scope="row"><pre>(* now p, q, and r have these values: p = 8<span></span></pre></td></tr><tr><td scope="row"><pre>                                      q = 94133<span></span></pre></td></tr><tr><td scope="row"><pre>                                      r = "Chapman" *)<span></span></pre></td></tr></table></div><p>In the final assignment statement above, <code>{lastName:r}</code> is a record that hasn’t been used before in the script, and contains an item with label <code>lastName</code> and value <code>r</code> (a previously defined variable). The variable <code>x</code> has previously been set to have a record that has an item with label <code>lastName</code> and value <code>"Chapman"</code>. During the assignment, the value of the item labeled <code>lastName</code> in the new record is set to the value of the item labeled <code>lastName</code> in <code>x</code>—hence it now has the value <code>"Chapman"</code>.</p><p>As this example demonstrates, the properties of a record need not be given in the same order and need not all be used when you set a pattern to a pattern, as long as the patterns match. For details, see the <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW52">set</a></code> command.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000983-CH223-SW14" title="Note"></a><p><strong>Note:</strong>&nbsp;Using patterns with the <code>set</code> command is similar to using patterned parameters with handlers, which is described in <span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW20">“Handlers with Patterned Positional Parameters.”</a></span></p></div><a name="//apple_ref/doc/uid/TP40000983-CH223-SW8" title="Declaring Variables with the copy Command"></a><h4>Declaring Variables with the copy Command</h4><p><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_487"></a>You can use the <code>copy</code> command to set a variable to any type of object. If the variable doesn’t exist, it is created; if it does exist, its current value is replaced. The <code>copy</code> command creates a new copy that is independent of the original—a subsequent change does not change the original value (though note that a copy of an object specifier still specifies the same object).</p><p>To copy within an application, you should use the application’s <code>duplicate</code> command, if it has one. To copy between applications, you can use the <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW56">get</a></code> command to obtain information from one application and the <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW52">set</a></code> command to set it in another.</p><p>The <code>copy</code> command creates a deep copy—that is, if you copy a nested data structure, such as a list that contains another list, the entire structure is copied, as shown in the following example. This example creates a record (<code>alpha</code>), then a list (<code>beta</code>), then a list that contains the first record and list (<code>gamma</code>), then finally a copy of <code>gamma</code> (<code>delta</code>). It then changes a property in the original record, <code>alpha</code>. The result shows that the property is changed wherever <code>alpha</code> appears, except in the copy, <code>delta</code>:</p><div class="codesample"><table><tr><td scope="row"><pre>set alpha to {property1:10, property2:20}<span></span></pre></td></tr><tr><td scope="row"><pre>set beta to {1, 2, "Hello"}<span></span></pre></td></tr><tr><td scope="row"><pre>set gamma to {alpha, beta, "Goodbye"}<span></span></pre></td></tr><tr><td scope="row"><pre>copy gamma to delta<span></span></pre></td></tr><tr><td scope="row"><pre>set property1 of alpha to 42<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>{alpha, beta, gamma, delta}  -- List variables to show contents<span></span></pre></td></tr><tr><td scope="row"><pre>(*result: {{property1:42, property2:20}, {1, 2, "Hello"}, {{property1:42, property2:20}, {1, 2, "Hello"}, "Goodbye"}, {{property1:10, property2:20}, {1, 2, "Hello"}, "Goodbye"}} *)<span></span></pre></td></tr></table></div><p>If you make a copy of a <code>reference</code> object, it refers to the same object as the original (because both contain the same object specifier):</p><div class="codesample"><table><tr><td scope="row"><pre>set windowRef to a reference to window 1 of application "Finder"<span></span></pre></td></tr><tr><td scope="row"><pre>name of windowRef --result: "Script testing folder"<span></span></pre></td></tr><tr><td scope="row"><pre>copy windowRef to currentWindowRef --result: a new object specifier<span></span></pre></td></tr><tr><td scope="row"><pre>name of currentWindowRef --result: "Script testing folder"<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000983-CH223-SW1" title="Scope of Variables and Properties"></a><h2>Scope of Variables and Properties</h2><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_488"></a><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_489"></a><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_490"></a><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_491"></a><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_492"></a><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_493"></a><p><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_494"></a><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_495"></a></p><p>The <strong>declaration</strong> of a variable or property identifier is the first valid occurrence of the identifier in a <code>script</code> object. The form and location of the declaration determine how AppleScript treats the identifier in that <code>script</code> object.</p><p>The <a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_496"></a><strong>scope</strong> is the range over which AppleScript recognizes a declared identifier within a <code>script</code> object. The scope of a variable depends on where you declare it and whether you declare it as <code>global</code> or <code>local</code>. The scope of a property extends to the entire <code>script</code> object in which it is declared. After declaring a property, you can reuse the same identifier as a separate variable only if you first declare it as a <code>local</code> variable.</p><p><strong>Lifetime</strong><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_497"></a><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_498"></a><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_499"></a> refers to the period of time over which a variable or property is in existence. Only the values of properties and <code>global</code> variables can persist after a script is run.</p><p>In the discussions that follow, declarations and statements in a <code>script</code> object that occur outside of any handlers or nested <code>script</code> objects are identified as <em>outside</em>.</p><p>The following examples show the four basic forms for declaring variables and properties in AppleScript:</p><ul class="ul"><li class="li"><p><code>property x: 3</code></p><p>The scope of a property definition is the <code>script</code> object in which it is declared, including any handlers or nested <code>script</code> objects. A property definition specifies an initial value. You cannot declare a property in a handler.</p><p>The value set by a property definition is not reset each time the script is run; instead, it persists until the script is recompiled.</p></li><li class="li"><p><code>global x</code></p><p><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_500"></a><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_501"></a>The scope of a <code>global</code> variable can be limited to specific handlers or contained <code>script</code> objects or it can extend throughout a top-level <code>script</code> object. A <code>global</code> declaration doesn’t set an initial value—it must be initialized by a <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW53">copy</a></code> or <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW52">set</a></code> command before a script can access its value.</p><p>The value of a <code>global</code> variable is not reset each time a script is run, unless its initialization statement is executed.</p></li><li class="li"><p><code>local x</code></p><p><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_502"></a><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_503"></a>The scope of a <code>local</code> variable can be limited to specific handlers or contained <code>script</code> objects or it can extend throughout a top-level <code>script</code> object. A <code>local</code> declaration doesn’t set an initial value—it must be initialized by a <code>copy</code> or <code>set</code> command before a script can access its value.</p><p>The value of a <code>local</code> variable is reset each time the handler is run (either the <code>run</code> handler for the script, or the specific handler in which the variable is declared).</p></li><li class="li"><p><code>set x to 3</code></p><p>In the absence of a <code>global</code> variable declaration, the scope of a variable declared with the <code>copy</code> or <code>set</code> command is normally restricted to the <code>run</code> handler for the script, making it implicitly local to that run handler. However, a handler or nested script object can declare the same variable with a <code>global</code> declaration to gain access to it.</p><p>The value of a variable declared with the <code>copy</code> or <code>set</code> command is reset each time a script is run.</p></li></ul><p>If you want to use the same identifier in several different places in a script, you should either declare it as a property or as a <code>global</code> variable.</p><p>It is often convenient to limit the scope of a particular identifier to a single handler or nested <code>script</code> object, which you can do by defining it as a <code>local</code> variable in the handler or <code>script</code> object. Outside, the identifier has no value associated with it and can be reused elsewhere in the script. When used this way, a <code>local</code> variable is said to <em>shadow</em><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_504"></a> (or block access to) a <code>global</code> variable or property with the same name, making the global version inaccessible in the scope of the handler or <code>script</code> object where the <code>local</code> variable is declared.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000983-CH223-SW15" title="Note"></a><p><strong>Note:</strong>&nbsp;If you save a script as a script application, then run the application on read-only media, the value of a modified property or <code>global</code> variable is not saved.</p></div><p>The following sections provide additional information about scope:</p><ul class="ul"><li class="li"><p><span class="content_text"><a href="ASLR_variables.html#//apple_ref/doc/uid/TP40000983-CH223-SW3">“Scope of Properties and Variables Declared in a Script Object”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_variables.html#//apple_ref/doc/uid/TP40000983-CH223-SW5">“Scope of Variables Declared in a Handler”</a></span></p></li></ul><a name="//apple_ref/doc/uid/TP40000983-CH223-SW3" title="Scope of Properties and Variables Declared in a Script Object"></a><h3>Scope of Properties and Variables Declared in a Script Object</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_505"></a><span class="content_text">Table 3-1</span> shows the scope and lifetime for variables and properties that are declared at the top level in a <code>script</code> object (outside any handlers or nested <code>script</code> objects).</p><a name="//apple_ref/doc/uid/TP40000983-CH223-SW4" title="Table 3-1Scope of property and variable declarations at the top level in a script object"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 3-1&nbsp;&nbsp;</strong>Scope of property and variable declarations at the top level in a script object</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Declaration type</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Scope (visibility)</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Lifetime</p></th></tr><tr><td  scope="row"><p><code>property x: 3</code></p></td><td ><p>Everywhere in script</p></td><td ><p>Reset when script is recompiled</p></td></tr><tr><td  scope="row"><p><code>global x</code></p></td><td ><p>Everywhere in script</p></td><td ><p>Reset when reinitialized in script or when script is recompiled</p></td></tr><tr><td  scope="row"><p><code>local x</code></p></td><td ><p>Within <code>run</code> handler only</p></td><td ><p>Reset when script is run</p></td></tr><tr><td  scope="row"><p><code>set x to 3</code></p></td><td ><p>Within <code>run</code> handler only</p></td><td ><p>Reset when script is run</p></td></tr></table></div><p>The scope of a property in a <code>script</code> object extends to any subsequent statements anywhere in the script. Consider the following example:</p><div class="codesample"><table><tr><td scope="row"><pre>property currentCount : 0<span></span></pre></td></tr><tr><td scope="row"><pre>increment()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>on increment()<span></span></pre></td></tr><tr><td scope="row"><pre>    set currentCount to currentCount + 1<span></span></pre></td></tr><tr><td scope="row"><pre>    display dialog "Count is now " &amp; currentCount  &amp; "."<span></span></pre></td></tr><tr><td scope="row"><pre>end increment<span></span></pre></td></tr></table></div><p>When it encounters the identifier <code>currentCount</code> anywhere in this script, AppleScript associates it with the <code>currentCount</code> property.</p><p>The value of a property persists after the script in which the property is defined has been run. Thus, the value of <code>currentCount</code> is 0 the first time this script is run, 1 the next time it is run, and so on. The property’s current value is saved with the <code>script</code> object and is not reset to 0 until the script is recompiled—that is, modified and then run again, saved, or checked for syntax. <a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_506"></a><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_507"></a></p><p>The value of a <code>global</code> variable also persists after the script in which it is defined has been run. However, depending on how it is initialized, a <code>global</code> variable may be reset each time the script is run again. The next example shows how to initialize a <code>global</code> variable so that it is initialized only the first time a script is run, and thus produces the same result as using a property in the previous example:</p><div class="codesample"><table><tr><td scope="row"><pre>global currentCount<span></span></pre></td></tr><tr><td scope="row"><pre>increment()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>on increment()<span></span></pre></td></tr><tr><td scope="row"><pre>    try<span></span></pre></td></tr><tr><td scope="row"><pre>        set currentCount to currentCount + 1<span></span></pre></td></tr><tr><td scope="row"><pre>    on error<span></span></pre></td></tr><tr><td scope="row"><pre>        set currentCount to 1<span></span></pre></td></tr><tr><td scope="row"><pre>    end try<span></span></pre></td></tr><tr><td scope="row"><pre>        display dialog "Count is now " &amp; currentCount  &amp; "."<span></span></pre></td></tr><tr><td scope="row"><pre>end increment<span></span></pre></td></tr></table></div><p>The first time the script is run, the statement <code>set currentCount to currentCount + 1</code> generates an error because the <code>global</code> variable <code>currentCount</code> has not been initialized. When the error occurs, the <code>on error</code> block initializes <code>currentCount</code>. When the script is run again, the variable has already been initialized, so the error branch is not executed, and the variable keeps its previous value. Persistence is accomplished, but not as simply as in the previous example.<a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_508"></a><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_509"></a></p><p>If you don’t want the value associated with an identifier to persist after a script is run but you want to use the same identifier throughout a script, declare a <code>global</code> variable and use the <code>set</code> command to set its value each time the script is run:</p><div class="codesample"><table><tr><td scope="row"><pre>global currentCount<span></span></pre></td></tr><tr><td scope="row"><pre>set currentCount to 0<span></span></pre></td></tr><tr><td scope="row"><pre>on increment()<span></span></pre></td></tr><tr><td scope="row"><pre>    set currentCount to currentCount + 1<span></span></pre></td></tr><tr><td scope="row"><pre>end increment<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>increment() --result: 1<span></span></pre></td></tr><tr><td scope="row"><pre>increment() --result: 2<span></span></pre></td></tr></table></div><p>Each time the <code>on increment</code> handler is called within the script, the <code>global</code> variable <code>currentCount</code> increases by 1. However, when you run the entire script again, <code>currentCount</code> is reset to 0.</p><p>In the absence of a <code>global</code> variable declaration, the scope of a variable declaration using the <code>set</code> command is normally restricted to the <code>run</code> handler for the script. For example, this script declares two separate <code>currentCount</code> variables:</p><div class="codesample"><table><tr><td scope="row"><pre>set currentCount to 10<span></span></pre></td></tr><tr><td scope="row"><pre>on increment()<span></span></pre></td></tr><tr><td scope="row"><pre>    set currentCount to 5<span></span></pre></td></tr><tr><td scope="row"><pre>end increment<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>increment() --result: 5<span></span></pre></td></tr><tr><td scope="row"><pre>currentCount --result: 10<span></span></pre></td></tr></table></div><p>The scope of the first <code>currentCount</code> variable’s declaration is limited to the <code>run</code> handler for the script. Because this script has no explicit <code>run</code> handler, outside statements are part of its implicit <code>run</code> handler, as described in <span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW15">“run Handlers.”</a></span> The scope of the second <code>currentCount</code> declaration, within the <code>on increment</code> handler, is limited to that handler. AppleScript keeps track of each variable independently.</p><p>To associate a variable in a handler with the same variable declared with the <code>set</code> command outside the handler, you can use a <code>global</code> declaration in the handler, as shown in the next example. (This approach also works to associate a variable in a nested <code>script</code> object.)</p><div class="codesample"><table><tr><td scope="row"><pre>set currentCount to 0<span></span></pre></td></tr><tr><td scope="row"><pre>on increment()<span></span></pre></td></tr><tr><td scope="row"><pre>    global currentCount<span></span></pre></td></tr><tr><td scope="row"><pre>    set currentCount to currentCount + 1<span></span></pre></td></tr><tr><td scope="row"><pre>end increment<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>increment() --result: 1<span></span></pre></td></tr><tr><td scope="row"><pre>currentCount --result: 1<span></span></pre></td></tr></table></div><p>To restrict the context of a variable to a script’s <code>run</code> handler regardless of subsequent <code>global</code> declarations, you must declare it explicitly as a <code>local</code> variable, as shown in this example:</p><div class="codesample"><table><tr><td scope="row"><pre>local currentCount<span></span></pre></td></tr><tr><td scope="row"><pre>set currentCount to 10<span></span></pre></td></tr><tr><td scope="row"><pre>on increment()<span></span></pre></td></tr><tr><td scope="row"><pre>    global currentCount<span></span></pre></td></tr><tr><td scope="row"><pre>    set currentCount to currentCount + 2<span></span></pre></td></tr><tr><td scope="row"><pre>end increment<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>increment() --error: "The variable currentCount is not defined"<span></span></pre></td></tr></table></div><p>Because the <code>currentCount</code> variable in this example is declared as local to the script, and hence to its implicit <code>run</code> handler, any subsequent attempt to declare the same variable as <code>global</code> results in an error.</p><p>If you declare an outside variable with the <code>set</code> command and then declare the same identifier as a property, the declaration with the <code>set</code> command overrides the property definition. For example, the following script returns 10, not 5. This occurs because AppleScript evaluates property definitions before it evaluates <code>set</code> command declarations:</p><div class="codesample"><table><tr><td scope="row"><pre>set numClowns to 10 -- evaluated after property definition<span></span></pre></td></tr><tr><td scope="row"><pre>property numClowns: 5 -- evaluated first<span></span></pre></td></tr><tr><td scope="row"><pre>numClowns --result: 10<span></span></pre></td></tr></table></div><p>The next example, shows how to use a <code>global</code> variable declaration in a <code>script</code> object to associate a <code>global</code> variable with an outside property:</p><div class="codesample"><table><tr><td scope="row"><pre>property currentCount : 0<span></span></pre></td></tr><tr><td scope="row"><pre>script Paula<span></span></pre></td></tr><tr><td scope="row"><pre>    property currentCount : 20<span></span></pre></td></tr><tr><td scope="row"><pre>    script Joe<span></span></pre></td></tr><tr><td scope="row"><pre>        global currentCount<span></span></pre></td></tr><tr><td scope="row"><pre>        on increment()<span></span></pre></td></tr><tr><td scope="row"><pre>            set currentCount to currentCount + 1<span></span></pre></td></tr><tr><td scope="row"><pre>            return currentCount<span></span></pre></td></tr><tr><td scope="row"><pre>        end increment<span></span></pre></td></tr><tr><td scope="row"><pre>    end script<span></span></pre></td></tr><tr><td scope="row"><pre>    tell Joe to increment()<span></span></pre></td></tr><tr><td scope="row"><pre>end script<span></span></pre></td></tr><tr><td scope="row"><pre>run Paula --result: 1<span></span></pre></td></tr><tr><td scope="row"><pre>run Paula --result: 2<span></span></pre></td></tr><tr><td scope="row"><pre>currentCount --result: 2<span></span></pre></td></tr><tr><td scope="row"><pre>currentCount of Paula --result: 20<span></span></pre></td></tr></table></div><p>This script declares two separate <code>currentCount</code> properties: one outside any handlers (and <code>script</code> objects) in the main script and one in the <code>script</code> object <code>Paula</code> but outside of any handlers or <code>script</code> objects within <code>Paula</code>. Because the script <code>Joe</code> declares the <code>global</code> variable <code>currentCount</code>, AppleScript looks for <code>currentCount</code> at the top level of the script, thus treating Joe’s <code>currentCount</code> and <code>currentCount</code> at the top level of the script as the same variable.</p><a name="//apple_ref/doc/uid/TP40000983-CH223-SW5" title="Scope of Variables Declared in a Handler"></a><h3>Scope of Variables Declared in a Handler</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_510"></a>A handler can’t declare a property, although it can refer to a property that is declared outside any handler in the <code>script</code> object. (A handler can contain script objects, but it can’t contain another handler, except in a contained script object.)</p><p><span class="content_text"><a href="ASLR_variables.html#//apple_ref/doc/uid/TP40000983-CH223-SW6">Table 3-2</a></span> summarizes the scope of variables declared in a handler. Examples of each form of declaration follow.</p><a name="//apple_ref/doc/uid/TP40000983-CH223-SW6" title="Table 3-2Scope of variable declarations within a handler"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 3-2&nbsp;&nbsp;</strong>Scope of variable declarations within a handler</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Declaration type</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Scope (visibility)</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Lifetime</p></th></tr><tr><td  scope="row"><p><code>global x</code></p></td><td ><p>Within handler only</p></td><td ><p>Reset when script is recompiled; if initialized in handler, then reset when handler is run</p></td></tr><tr><td  scope="row"><p><code>local x</code></p></td><td ><p>Within handler only</p></td><td ><p>Reset when handler is run</p></td></tr><tr><td  scope="row"><p><code>set x to 3</code></p></td><td ><p>Within handler only</p></td><td ><p>Reset when handler is run</p></td></tr></table></div><p>The scope of a <code>global</code> variable declared in a handler is limited to that handler, although AppleScript looks beyond the handler when it tries to locate an earlier occurrence of the same variable. Here’s an example:</p><div class="codesample"><table><tr><td scope="row"><pre>set currentCount to 10<span></span></pre></td></tr><tr><td scope="row"><pre>on increment()<span></span></pre></td></tr><tr><td scope="row"><pre>    global currentCount<span></span></pre></td></tr><tr><td scope="row"><pre>    set currentCount to currentCount + 2<span></span></pre></td></tr><tr><td scope="row"><pre>end increment<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>increment() --result: 12<span></span></pre></td></tr><tr><td scope="row"><pre>currentCount --result: 12<span></span></pre></td></tr></table></div><p>When AppleScript encounters the <code>currentCount</code> variable within the <code>on increment</code> handler, it doesn’t restrict its search for a previous occurrence to that handler but keeps looking until it finds the declaration outside any handler. However, the use of <code>currentCount</code> in any subsequent handler in the script is local to that handler unless the handler also explicitly declares <code>currentCount</code> as a <code>global</code> variable.</p><p>The scope of a <code>local</code> variable declaration in a handler is limited to that handler, even if the same identifier has been declared as a property outside the handler:</p><div class="codesample"><table><tr><td scope="row"><pre>property currentCount : 10<span></span></pre></td></tr><tr><td scope="row"><pre>on increment()<span></span></pre></td></tr><tr><td scope="row"><pre>    local currentCount<span></span></pre></td></tr><tr><td scope="row"><pre>    set currentCount to 5<span></span></pre></td></tr><tr><td scope="row"><pre>end increment<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>increment() --result: 5<span></span></pre></td></tr><tr><td scope="row"><pre>currentCount --result: 10<span></span></pre></td></tr></table></div><p>The scope of a variable declaration using the <code>set</code> command in a handler is limited to that handler:</p><div class="codesample"><table><tr><td scope="row"><pre>script Henry<span></span></pre></td></tr><tr><td scope="row"><pre>    set currentCount to 10 -- implicit local variable in script object<span></span></pre></td></tr><tr><td scope="row"><pre>    on increment()<span></span></pre></td></tr><tr><td scope="row"><pre>        set currentCount to 5-- implicit local variable in handler<span></span></pre></td></tr><tr><td scope="row"><pre>    end increment<span></span></pre></td></tr><tr><td scope="row"><pre>    return currentCount<span></span></pre></td></tr><tr><td scope="row"><pre>end script<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>tell Henry to increment() --result: 5<span></span></pre></td></tr><tr><td scope="row"><pre>run Henry --result: 10<span></span></pre></td></tr></table></div><p>The scope of the first declaration of the first <code>currentCount</code> variable in the <code>script</code> object <code>Henry</code> is limited to the <code>run</code> handler for the <code>script</code> object (in this case, an implicit <code>run</code> handler, consisting of the last two statements in the script). The scope of the second <code>currentCount</code> declaration, within the <code>on increment</code> handler, is limited to that handler. The two instances of <code>currentCount</code> are independent variables.<a name="//apple_ref/doc/uid/TP40000983-CH223-DontLinkElementID_511"></a></p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="ASLR_fundamentals.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="ASLR_script_objects.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-03-11<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_variables.html%3Fid%3DTP40000983-3.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_variables.html%3Fid%3DTP40000983-3.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_variables.html%3Fid%3DTP40000983-3.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>