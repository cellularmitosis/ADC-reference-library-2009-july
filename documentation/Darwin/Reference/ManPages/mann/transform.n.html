<html><head><title>Mac OS X
 Manual Page For transform(n)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/n/transform" title="Mac OS X
 Manual Page for transform(n)"><a name="//apple_ref/doc/man/n/transform" title="Mac OS X
 Manual Page for transform(n)"><!-- headerDoc=man; indexgroup=Section n; uid="//apple_ref/doc/man/n/transform"; name=transform(n) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
transform(n)                                                                                    transform(n)



<b>NAME</b>
       transform - Tcl level transformations

<b>SYNOPSIS</b>
       package require <b>Tcl</b>  <b>?8.2?</b>

       package require <b>Trf</b>  <b>?2.1p2?</b>

       <b>transform</b> ?<u>options...</u>? ?<u>data</u>?

       <b>callback</b> <u>operation</u> <u>data</u>


<b>DESCRIPTION</b>
       The  command  <b>transform</b>  reflects the API for a stack channel transformation into the tcl level, thus
       enabling the writing of transformations in tcl.


       <b>transform</b> ?<u>options...</u>? ?<u>data</u>?

              <b>-mode</b> <b>read</b>|<b>write</b>
                     This option is accepted by the command if and only if it is  used  in  <u>immediate</u>  mode.
                     See section <b>IMMEDIATE</b> <b>versus</b> <b>ATTACHED</b> for an explanation of the term.

                     The argument value specifies whether to run the read or the write part of the transfor-<font color="#ffffff" class="whiteout">mation&nbsp;transformation</font>
                     mation specified via option <b>-command</b> on the immediate data.

                     Beyond the argument values listed above all unique abbreviations are recognized too.

              <b>-command</b> <u>cmd</u>
                     This option has to be present and is always understood. Its argument is a command  pre-<font color="#ffffff" class="whiteout">fix.&nbsp;prefix.</font>
                     fix.  This  command  prefix will be called by internally whenever some operation of the
                     transformation has to be executed. An empty <u>cmd</u> is not allowed.

                     The exact nature of the various possible calls and their expected results is  described
                     later, in section <b>CALLBACK</b> <b>API</b>.

              <b>-attach</b> <u>channel</u>
                     The presence/absence of this option determines the main operation mode of the transfor-<font color="#ffffff" class="whiteout">mation.&nbsp;transformation.</font>
                     mation.

                     If present the transformation will be stacked onto the <u>channel</u> whose handle  was  given
                     to  the  option  and  run in <u>attached</u> mode. More about this in section <b>IMMEDIATE</b> <b>versus</b>
                     <b>ATTACHED</b>.

                     If the option is absent the transformation is used in <u>immediate</u> mode  and  the  options
                     listed below are recognized. More about this in section <b>IMMEDIATE</b> <b>versus</b> <b>ATTACHED</b>.

              <b>-in</b> <u>channel</u>
                     This  options  is legal if and only if the transformation is used in <u>immediate</u> mode. It
                     provides the handle of the channel the data to transform has to be read from.

                     If the transformation is in <u>immediate</u> mode and this option is absent the data to trans-<font color="#ffffff" class="whiteout">form&nbsp;transform</font>
                     form is expected as the last argument to the transformation.

              <b>-out</b> <u>channel</u>
                     This  options  is legal if and only if the transformation is used in <u>immediate</u> mode. It
                     provides the handle of the channel the generated transformation result is written to.

                     If the transformation is in <u>immediate</u> mode and this option is absent the generated data
                     is returned as the result of the command itself.

<b>IMMEDIATE</b> <b>versus</b> <b>ATTACHED</b>
       The  transformation  distinguishes  between  two  main  ways of using it. These are the <u>immediate</u> and
       <u>attached</u> operation modes.

       For the <u>attached</u> mode the option <b>-attach</b> is used to associate the  transformation  with  an  existing
       channel.  During  the execution of the command no transformation is performed, instead the channel is
       changed in such a way, that from then on all data written to or  read  from  it  passes  through  the
       transformation  and  is  modified  by  it  according to the definition above.  This attachment can be
       revoked by executing the command <b>unstack</b> for the chosen channel. This is the only way to do  this  at
       the Tcl level.

       In  the second mode, which can be detected by the absence of option <b>-attach</b>, the transformation imme-<font color="#ffffff" class="whiteout">diately&nbsp;immediately</font>
       diately takes data from either its commandline or a channel, transforms it, and  returns  the  result
       either  as result of the command, or writes it into a channel.  The mode is named after the immediate
       nature of its execution.

       Where the data is taken from, and delivered to, is governed  by  the  presence  and  absence  of  the
       options  <b>-in</b> and <b>-out</b>.  It should be noted that this ability to immediately read from and/or write to
       a channel is an historic artifact which was introduced at the beginning of Trf's life when  Tcl  ver-<font color="#ffffff" class="whiteout">sion&nbsp;version</font>
       sion  7.6  was  current as this and earlier versions have trouble to deal with \0 characters embedded
       into either input or output.

<b>CALLBACK</b> <b>API</b>
       Here we describe the API of the callback command implementing the actual transformation.


       <b>callback</b> <u>operation</u> <u>data</u>
              The callback is always called with two arguments, first an operation code  followed  by  data.
              The latter will be empty for some operations.

              The  known operations are listed below, together with an explanation of the arguments, what is
              expected of them, and how their results are handled.

              <b>create/write</b>
                     When called <u>data</u> is empty. The result of the call is ignored.

                     This is the first operation executed for the write side of the transformation.  It  has
                     to  initialize the internals of this part of the transformation and ready it for future
                     calls.

              <b>delete/write</b>
                     When called <u>data</u> is empty. The result of the call is ignored.

                     This is the last operation executed for the write side of the transformation. It has to
                     shutdown  the  internals  of  this part of the transformation and release any resources
                     which were acquired over the lifetime of the transformation.

              <b>write</b>  The operation is called whenever data is written to the channel.

                     At the time of the call the argument <u>data</u> will contain  the  bytes  to  transform.  The
                     result  of the call is taken as the result of the transformation and handed to the next
                     stage down in the stack of transformation associated with the channel.

                     This operation has to transform the contents of <u>data</u>, using whatever data was left over
                     from the last call of the operation. The transformation is allowed to buffer incomplete
                     data.

              <b>flush/write</b>
                     When called <u>data</u> is empty. The operation has to transform any incomplete  data  it  has
                     buffered internally on the write side. The result of the call is taken as the result of
                     the transformation and handed to the next stage down in  the  stack  of  transformation
                     associated with the channel.

              <b>clear/write</b>
                     When called <u>data</u> is empty. The result of the call is ignored.

                     The  write side of the transformation has to clear its internal buffers. This operation
                     is called when the user seeks on the channel, thus invalidating any  incomplete  trans-<font color="#ffffff" class="whiteout">formation.&nbsp;transformation.</font>
                     formation.

              <b>create/read</b>
                     When called <u>data</u> is empty. The result of the call is ignored.

                     This is the first operation executed for the read side of the transformation. It has to
                     initialize the internals of this part of the transformation and  ready  it  for  future
                     calls.

              <b>delete/read</b>
                     When called <u>data</u> is empty. The result of the call is ignored.

                     This is the last operation executed for the write side of the transformation. It has to
                     shutdown the internals of this part of the transformation  and  release  any  resources
                     which were acquired over the lifetime of the transformation.

              <b>read</b>   The operation is called whenever data is read from the channel.

                     At  the  time  of  the  call the argument <u>data</u> will contain the bytes to transform. The
                     result of the call is taken as the result of the transformation and posted to the  next
                     stage up in the stack of transformation associated with the channel.

                     This operation has to transform the contents of <u>data</u>, using whatever data was left over
                     from the last call of the operation. The transformation is allowed to buffer incomplete
                     data.

              <b>flush/read</b>
                     When  called  <u>data</u>  is empty. The operation has to transform any incomplete data it has
                     buffered internally on the read side. The result of the call is taken as the result  of
                     the transformation and posted to the next stage up in the stack of transformation asso-<font color="#ffffff" class="whiteout">ciated&nbsp;associated</font>
                     ciated with the channel.

              <b>clear/read</b>
                     When called <u>data</u> is empty. The result of the call is ignored.

                     The read side of the transformation has to clear its internal buffers.  This  operation
                     is  called  when the user seeks on the channel, thus invalidating any incomplete trans-<font color="#ffffff" class="whiteout">formation.&nbsp;transformation.</font>
                     formation.

              <b>query/maxRead</b>
                     When called <u>data</u> is empty. The result of the call is  interpreted  as  integer  number.
                     This  operation  is used by the generic layer to determine if the transformation estab-<font color="#ffffff" class="whiteout">lishes&nbsp;establishes</font>
                     lishes a limit on the number of bytes it (the generic layer) is allowed read  from  the
                     transformations lower in the stack. A negative result unsets any limit.

                     This  has  to  be  used if a transformation employs some kind of end-of-data marker. We
                     cannot allow the generic layer to overshoot this marker because any data read after  it
                     cannot  be  stuffed back into the core buffers, causing the I/O system to loose data if
                     the transformation is unstacked after it recognized the end of its data. This is a lim-<font color="#ffffff" class="whiteout">itation&nbsp;limitation</font>
                     itation of the I/O system in the tcl core.

                     Returning  a  positive  value  will cause the I/O system to slow down, but also ensures
                     that no data is lost.

                     Two examples for such transformations are the data decompressors for <b>zip</b> and <b>bz2</b>.  They
                     use the C-level equivalent of this operation to prevent the overshooting.

<b>SEE</b> <b>ALSO</b>
       trf-intro

<b>KEYWORDS</b>
       general transform

<b>COPYRIGHT</b>
       Copyright (c) 1996-2003, Andreas Kupries &lt;andreas_kupries@users.sourceforge.net&gt;




Trf transformer commands                            2.1p2                                       transform(n)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/mann/transform.n.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/mann/transform.n.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/mann/transform.n.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
