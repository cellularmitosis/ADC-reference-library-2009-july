<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>TESetStyle(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING109></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-108.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-110.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-40.html"><B>Chapter 2 - TextEdit</B></A> / <A HREF="Text-56.html"><B>TextEdit Reference</B></A><BR><DL><DD><A HREF="Text-67.html"><B>Routines</B></A> / <A HREF="Text-108.html"><B>Checking, Setting, and Replacing Styles</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING109-0></A>
<H3>TESetStyle</H3>
 The <CODE>TESetStyle</CODE> procedure sets <A NAME=MARKER-2-213></A>new character attributes for the current selection range in the specified edit record.<A NAME=MARKER-2-214></A><P>
<PRE>
PROCEDURE TESetStyle (mode: Integer; newStyle: TextStyle; 
                      redraw: Boolean; hTE: TEHandle);
</PRE>
<DL>
<DT><CODE>mode</CODE>
<DD> A selector that specifies which character attributes are to be changed. The value for <CODE>mode</CODE> can be any additive combination of the <CODE>mode</CODE> constants for font, style, type size, color, and so forth.
<DT><CODE>newStyle</CODE>
<DD> A record of type <CODE>TextStyle</CODE> that specifies the new attributes to be set. This record contains the character attributes to be applied to the current selection range based on the value of <CODE>mode</CODE>.
<DT><CODE>redraw</CODE>
<DD> A flag that specifies whether or not TextEdit should immediately redraw the affected text to reflect the new character attribute changes. A value of <CODE>TRUE</CODE> causes the text to be redrawn immediately. Line breaks, line heights, and line ascents are recalculated. A value of <CODE>FALSE</CODE> delays redrawing until another event forces the update.
<DT><CODE>hTE</CODE>
<DD> A handle to the multistyled edit record containing the selected text.
</DL>
<A NAME=HEADING109-7></A>
<H5>DESCRIPTION</H5>
 The <CODE>TESetStyle</CODE> procedure has no effect on a monostyled record. You can use any combination of the following constants to specify a value for the <CODE>mode</CODE> parameter. The value of <CODE>mode</CODE> specifies which existing character attributes are to be changed to the new character attributes specified by <CODE>newStyle</CODE>.
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Constant<TH>Value<TH>Description<TR>
<TD>doFont<TD>1 <TD>Sets the font family ID<TR>
<TD>doFace<TD>2<TD>Sets the character style<TR>
<TD>doSize<TD>4<TD>Sets the type size<TR>
<TD>doColor<TD>8<TD>Sets the color<TR>
<TD>doAll<TD>15<TD>Sets all attributes<TR>
<TD>addSize<TD>16<TD>Increases or decreases the current type size<TR>
<TD>doToggle<TD>32<TD>Modifies the mode</TABLE>
<P>
 If <CODE>doToggle</CODE> is specified along with <CODE>doFace</CODE> and if an attribute specified in the given <CODE>newStyle</CODE> parameter exists across the entire selected range of text, then <CODE>TESetStyle</CODE> removes that attribute. Otherwise, if the attribute doesn't exist across the entire selection range, all of the selected text is set to include that character attribute.<P>
 If the <CODE>redraw</CODE> parameter is set to <CODE>TRUE</CODE>, TextEdit redraws the current selection range using the new character attributes, recalculating line breaks, line heights, and line ascents. If the <CODE>redraw</CODE> parameter is set to <CODE>FALSE</CODE>, TextEdit does not redraw the text or recalculate line breaks, line heights, and line ascents. Consequently, when you call a routine that uses any of this information, such as <CODE>TEGetHeight</CODE> (which returns a total height between two specified lines), it does not reflect the new character attributes set with <CODE>TESetStyle</CODE>. Instead, the routine uses the information that was available before <CODE>TESetStyle</CODE> was called. To update this information, call the <CODE>TECalText</CODE> procedure. (See <A HREF=Text-90.html#MARKER-9-465>"TECalText" on page 2-84</A> for more information.) To be certain that the new information is always reflected, call the <CODE>TESetStyle</CODE> procedure with the <CODE>redraw</CODE> parameter set to <CODE>TRUE</CODE>.<P>
 If you call the <CODE>TESetStyle</CODE> routine when the value of the <CODE>selStart</CODE> field of an edit record equals the value of the <CODE>selEnd</CODE> field (specifying an insertion point), TextEdit stores the input character attributes in the null scrap record pointed to by the null <BR>style handle.<A NAME=MARKER-2-125></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-108.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-110.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
