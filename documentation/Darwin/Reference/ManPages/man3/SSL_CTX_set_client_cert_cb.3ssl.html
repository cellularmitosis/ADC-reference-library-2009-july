<html><head><title>Mac OS X Developer Tools
 Manual Page For SSL_CTX_set_client_cert_cb(3ssl)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/3ssl/SSL_CTX_set_client_cert_cb" title="Mac OS X Developer Tools
 Manual Page for SSL_CTX_set_client_cert_cb(3ssl)"><a name="//apple_ref/doc/man/3/SSL_CTX_set_client_cert_cb" title="Mac OS X Developer Tools
 Manual Page for SSL_CTX_set_client_cert_cb(3ssl)"><!-- headerDoc=man; indexgroup=Section 3ssl; uid="//apple_ref/doc/man/3ssl/SSL_CTX_set_client_cert_cb"; name=SSL_CTX_set_client_cert_cb(3ssl) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac&nbsp;OS&nbsp;X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>

<p style='text-align:justify;'>This manual page is associated with the Mac&nbsp;OS&nbsp;X
developer tools.  The software or headers described may not be present on your
Mac&nbsp;OS&nbsp;X installation until you install the developer tools
package.  This package is available on your Mac&nbsp;OS&nbsp;X installation DVD,
and the latest versions can be downloaded from
<a href="http://developer.apple.com/tools/download/">developer.apple.com</a>.</p>

<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
SSL_CTX_set_client_cert_cb(3)                      OpenSSL                     SSL_CTX_set_client_cert_cb(3)



<b>NAME</b>
       SSL_CTX_set_client_cert_cb, SSL_CTX_get_client_cert_cb - handle client certificate callback function

<b>SYNOPSIS</b>
        #include &lt;openssl/ssl.h&gt;

        void SSL_CTX_set_client_cert_cb(SSL_CTX *ctx, int (*client_cert_cb)(SSL *ssl, X509 **x509, EVP_PKEY **pkey));
        int (*SSL_CTX_get_client_cert_cb(SSL_CTX *ctx))(SSL *ssl, X509 **x509, EVP_PKEY **pkey);
        int (*client_cert_cb)(SSL *ssl, X509 **x509, EVP_PKEY **pkey);

<b>DESCRIPTION</b>
       <u>SSL</u><b>_</b><u>CTX</u><b>_</b><u>set</u><b>_</b><u>client</u><b>_</b><u>cert</u><b>_</b><u>cb()</u> sets the <u></u><b><u>c</u></b><u></u><b><u>i</u></b><u></u><b><u>n</u></b><b>_</b><u></u><b><u>c</u></b><u></u><b><u>r</u></b><b>_</b><u></u><b><u>c</u></b><u></u><b><u>(</u></b> callback, that is called when a client
       certificate is requested by a server and no certificate was yet set for the SSL object.

       When <u></u><b><u>c</u></b><u></u><b><u>i</u></b><u></u><b><u>n</u></b><b>_</b><u></u><b><u>c</u></b><u></u><b><u>r</u></b><b>_</b><u></u><b><u>c</u></b><u></u><b><u>(</u></b> is NULL, no callback function is used.

       <u>SSL</u><b>_</b><u>CTX</u><b>_</b><u>get</u><b>_</b><u>client</u><b>_</b><u>cert</u><b>_</b><u>cb()</u> returns a pointer to the currently set callback function.

       <u>client</u><b>_</b><u>cert</u><b>_</b><u>cb()</u> is the application defined callback. If it wants to set a certificate, a
       certificate/private key combination must be set using the <b>x509</b> and <b>pkey</b> arguments and "1" must be
       returned. The certificate will be installed into <b>ssl</b>, see the NOTES and BUGS sections.  If no
       certificate should be set, "0" has to be returned and no certificate will be sent. A negative return
       value will suspend the handshake and the handshake function will return immediatly. <a href="SSL_get_error.3ssl.html#//apple_ref/doc/man/3/SSL_get_error"><u>SSL</u><b>_</b><u>get</u><b>_</b><u>error</u>(3)</a>
       will return SSL_ERROR_WANT_X509_LOOKUP to indicate, that the handshake was suspended. The next call
       to the handshake function will again lead to the call of <u>client</u><b>_</b><u>cert</u><b>_</b><u>cb()</u>. It is the job of the
       <u>client</u><b>_</b><u>cert</u><b>_</b><u>cb()</u> to store information about the state of the last call, if required to continue.

<b>NOTES</b>
       During a handshake (or renegotiation) a server may request a certificate from the client. A client
       certificate must only be sent, when the server did send the request.

       When a certificate was set using the <a href="SSL_CTX_use_certificate.3ssl.html#//apple_ref/doc/man/3/SSL_CTX_use_certificate"><u>SSL</u><b>_</b><u>CTX</u><b>_</b><u>use</u><b>_</b><u>certificate</u>(3)</a> family of functions, it will be sent
       to the server. The TLS standard requires that only a certificate is sent, if it matches the list of
       acceptable CAs sent by the server. This constraint is violated by the default behavior of the OpenSSL
       library. Using the callback function it is possible to implement a proper selection routine or to
       allow a user interaction to choose the certificate to be sent.

       If a callback function is defined and no certificate was yet defined for the SSL object, the callback
       function will be called.  If the callback function returns a certificate, the OpenSSL library will
       try to load the private key and certificate data into the SSL object using the <u>SSL</u><b>_</b><u>use</u><b>_</b><u>certificate()</u>
       and <u>SSL</u><b>_</b><u>use</u><b>_</b><u>private</u><b>_</b><u>key()</u> functions.  Thus it will permanently install the certificate and key for
       this SSL object. It will not be reset by calling <a href="SSL_clear.3ssl.html#//apple_ref/doc/man/3/SSL_clear"><u>SSL</u><b>_</b><u>clear</u>(3)</a>.  If the callback returns no
       certificate, the OpenSSL library will not send a certificate.

<b>BUGS</b>
       The <u>client</u><b>_</b><u>cert</u><b>_</b><u>cb()</u> cannot return a complete certificate chain, it can only return one client
       certificate. If the chain only has a length of 2, the root CA certificate may be omitted according to
       the TLS standard and thus a standard conforming answer can be sent to the server. For a longer chain,
       the client must send the complete chain (with the option to leave out the root CA certificate). This
       can only be accomplished by either adding the intermediate CA certificates into the trusted
       certificate store for the SSL_CTX object (resulting in having to add CA certificates that otherwise
       maybe would not be trusted), or by adding the chain certificates using the
       <a href="SSL_CTX_add_extra_chain_cert.3ssl.html#//apple_ref/doc/man/3/SSL_CTX_add_extra_chain_cert"><u>SSL</u><b>_</b><u>CTX</u><b>_</b><u>add</u><b>_</b><u>extra</u><b>_</b><u>chain</u><b>_</b><u>cert</u>(3)</a> function, which is only available for the SSL_CTX object as a whole
       and that therefore probably can only apply for one client certificate, making the concept of the
       callback function (to allow the choice from several certificates) questionable.

       Once the SSL object has been used in conjunction with the callback function, the certificate will be
       set for the SSL object and will not be cleared even when <a href="SSL_clear.3ssl.html#//apple_ref/doc/man/3/SSL_clear"><u>SSL</u><b>_</b><u>clear</u>(3)</a> is being called. It is
       therefore mandatory to destroy the SSL object using <a href="SSL_free.3ssl.html#//apple_ref/doc/man/3/SSL_free"><u>SSL</u><b>_</b><u>free</u>(3)</a> and create a new one to return to the
       previous state.

<b>SEE</b> <b>ALSO</b>
       <a href="ssl.3ssl.html#//apple_ref/doc/man/3/ssl"><u>ssl</u>(3)</a>, <a href="SSL_CTX_use_certificate.3ssl.html#//apple_ref/doc/man/3/SSL_CTX_use_certificate"><u>SSL</u><b>_</b><u>CTX</u><b>_</b><u>use</u><b>_</b><u>certificate</u>(3)</a>, <a href="SSL_CTX_add_extra_chain_cert.3ssl.html#//apple_ref/doc/man/3/SSL_CTX_add_extra_chain_cert"><u>SSL</u><b>_</b><u>CTX</u><b>_</b><u>add</u><b>_</b><u>extra</u><b>_</b><u>chain</u><b>_</b><u>cert</u>(3)</a>, <a href="SSL_get_client_CA_list.3ssl.html#//apple_ref/doc/man/3/SSL_get_client_CA_list"><u>SSL</u><b>_</b><u>get</u><b>_</b><u>client</u><b>_</b><u>CA</u><b>_</b><u>list</u>(3)</a>,
       <a href="SSL_clear.3ssl.html#//apple_ref/doc/man/3/SSL_clear"><u>SSL</u><b>_</b><u>clear</u>(3)</a>, <a href="SSL_free.3ssl.html#//apple_ref/doc/man/3/SSL_free"><u>SSL</u><b>_</b><u>free</u>(3)</a>



0.9.7l                                           2002-06-12                    SSL_CTX_set_client_cert_cb(3)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man3/SSL_CTX_set_client_cert_cb.3ssl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man3/SSL_CTX_set_client_cert_cb.3ssl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man3/SSL_CTX_set_client_cert_cb.3ssl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
