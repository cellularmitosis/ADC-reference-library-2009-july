<HTML>		<HEAD>        <title>SettingUp a Master-Detail Configuration</title>		</HEAD>	<BODY bgcolor="#ffffff">		<!-- start of header -->		<!--#include virtual="/includes/framesetheader" -->		<!-- end of header --><!-- start of path --><table cellspacing=0 border=0 width=600 valign="left"><tr><td scope="row"><font face="Geneva,Helvetica,Arial" size="1"><b>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="../../../index.html">Documentation</a> <b>></b> <a href="../../webobjects.html" target="_top">WebObjects</a></font></td></tr></table><br><!-- end of path --><a href="Refining_Your_Model.html" target="_right"><img src="../Images/previous.gif" border="0" alt="Previous"></a><a href="Updating_Ob_splay_Group.html" target="_right"><img src="../Images/next.gif" border="0" alt="Next"></a>&nbsp;<br><!-- apple_doc: pageHeadingStart --><a name = "TPXREF142"></a><h2><font face="Helvetica,Arial,Lucida Grande">SettingUp a Master-Detail Configuration</font></h2><!-- apple_doc: pageHeadingEnd --><p><font face="Times">So far your Movies application fetches, inserts, updates,and deletes only Movie objects. Considered alone, a Movie objectisn't as interesting as it is when it's related to actors and roles.In this section, you'll add MovieRole and Talent objects to theMovies application.</font></p><p><font face="Times">The relationships defined in your model now come into play.Using Movie's <code>movieRoles</code> relationship,you can display the MovieRoles for the selected Movie. In this typeof configuration, called <em>master-detail</em>, a masterdisplay group holds enterprise objects for the source of a relationship,while a detail display group holds records for the destination.As individual records are selected in the master display group,the detail display group gets a new set of enterprise objects tocorrespond to the selection in the master.</font></p><p><font face="Times">In the Movies application, the master-detail configurationis built around Movie's <code>movieRoles</code> relationship.The configuration is split across two pages in the application.The master, <code>movieDisplayGroup</code>,is in the Main component, while the detail is in MovieDetails.</font></p><p><font face="Times">In this section, you'll</font></p><ul><p><li>Create andconfigure the detail display group.</li></p><p><li>Extend the MovieDetails user interface to hold MovieRole andTalent information.</li></p></ul><a name = "TPXREF143"></a><h3><font face="Helvetica,Arial,Lucida Grande">Creatinga Detail Display Group </font></h3><p><font face="Times">You can create a detail display group several different ways.You can write a declaration for it in Project Builder, or you canuse WebObjects Builder's Add Variable/Method command. But theeasiest way to create a detail display group is by dragging a relationship fromEOModeler into your component, as described below.</font></p><ol><p><li>In EOModeler'stree view, expand the Movie entity.<P><img src = "../Art/expatree.gif" alt = "[image: ../Art/expatree.gif]"></li></p><p><li>Drag the Movie's <code>toMovieRole</code> relationshipfrom the tree view into the MovieDetails component's object browser.<P><img src = "../Art/dragent.gif" alt = "[image: ../Art/dragent.gif]"><p>An Add Display Group panelopens.</p><P><img src = "../Art/adddg.gif" alt = "[image: ../Art/adddg.gif]"></li></p><p><li>In the Add Display Group panel, change the name tomovieRoleDisplayGroup.</li></p><p><li>Click Add and Configure.<p>The Display Group Options panelopens so you can immediately configure the newly created displaygroup.</p><P><img src = "../Art/dgoptions.gif" alt = "[image: ../Art/dgoptions.gif]"><p>Ensurethat the "Has detail data source" box is checked. This meansthat <code>movieRoleDisplayGroup</code> getsits objects from a EODetailDataSource object.</p><p>All displaygroups use some kind of <em>data source </em>to fetchtheir objects. A data source is an object that exists primarilyas a simple means for a WODisplayGroup to access a store of objects.It's through a data source that a display group fetches, inserts,updates, and deletes database records.</p><p>An EODetailDataSourceis a subclass of EODataSource that's intended for use in master-detailconfigurations. A detail data source keeps track of a <em>masterobject</em> and a <em>detail key</em>. The masterobject is typically the selected object in a master display group, buta master display group isn't strictly required. The detail keyis the name of the relationship on which the master-detail configurationis based. When a detail display group asks its data source to fetch,the EODetailDataSource simply gets the destination objects fromthe master object as follows:</p><pre>    detailObjects = masterObject.valueForKey(detailKey);</pre><p>Inyour master-detail configuration, the master object is the selectedMovie, and the detail key is <code>movieRoles</code>.When <code>movieRoleDisplayGroup</code> asksits data source for its MovieRole objects, the detail WODisplayGroupreturns the objects in the selected Movie's <code>movieRoles</code> arrayof MovieRoles. Similarly, when MovieRole objects are inserted ordeleted in <code>movieRoleDisplayGroup</code>,they are added and removed from the master object's <code>movieRoles</code> array.</p></li></p><p><li>Set the display group to sort alphabetically by <code>roleName</code>.</li></p><p><li>Check the "Fetches on load" box.<p>When "Fetcheson load" is selected, the display group fetches its objects assoon as the component is loaded into the application. You want thisfeature in the MovieDetails page so that users are immediately presentedwith the selected movie's roles. In contrast, the Main page doesnot fetch on load; it shouldn't present a list of movies until theuser has entered search criteria and clicked Match.</p></li></p><p><li>Click OK.</li></p><p><li>In Project Builder, modify MovieDetail's <code>setSelectedMovie</code> methodto look like the following:<pre>    public void setSelectedMovie(EOEnterpriseObject newSelectedMovie) {        selectedMovie = newSelectedMovie;        movieRoleDisplayGroup.setMasterObject(newSelectedMovie);    }</pre><p>Withthis addition, whenever a user navigates to the MovieDetails page, <code>setSelectedMovie</code> updatesthe master object of the <code>movieRoleDisplayGroup</code> soit displays the corresponding MovieRole objects.</p></li></p></ol><a name = "TPXREF144"></a><h3><font face="Helvetica,Arial,Lucida Grande">Addinga Repetition</font></h3><p><font face="Times">Now you'll extend the user interface of the MovieDetailscomponent to display the actors in the selected movie. Because differentmovies have different numbers of roles, you need the dynamism ofa repetition element. When you're done adding the repetition,your component should look like this:</font></p><P><img src = "../Art/movdetui.gif" alt = "[image: ../Art/movdetui.gif]"><ol><p><li>In the MovieDetailscomponent window, add the bolded text <code>Starring:</code> beneaththe Revenue line.</li></p><p><li>Below the Starring label, add a repetition.</li></p><p><li>Replace the "Repetition" text with three string elements.<p>Thestrings should all be on the same line, so don't type carriagereturns between them.</p></li></p><p><li>Type a space between the first two strings and the word "as " (with a space before and after) between the last two.</li></p><p><li>Add a carriage return after the last string.</li></p></ol><a name = "TPXREF145"></a><h3><font face="Helvetica,Arial,Lucida Grande">Configuringa Repetition</font></h3><p><font face="Times">Now configure MovieDetails' repetition in a way similarto the way Main's repetition is configured. First you need tocreate a new variable to bind to the repetition's <code>item</code> attribute.</font></p><ol><p><li>Use the AddKey command to add a new variable, <code>movieRole,</code> whosetype is set to the MovieRole entity.<p>Don't create set andget methods for <code>movieRole</code>.You won't need accessor methods because the variable is used onlywithin the MovieDetails component and shouldn't be visible toany other classes.</p></li></p><p><li>Bind <code>movieRoleDisplayGroup</code>.<code>displayedObjects</code> tothe repetition's <code>list</code> attribute.</li></p><p><li>Bind <code>movieRole</code> tothe repetition's <code>item</code> attribute.</li></p><p><li>Bind <code>movieRole</code>.<code>toTalent</code>.<code>firstName</code> tothe <code>value</code> attribute ofthe first string in the repetition.</li></p><p><li>Bind <code>movieRole</code>.<code>toTalent</code>.<code>lastName</code> tothe <code>value</code> attribute ofthe second string.</li></p><p><li>Bind <code>movieRole</code>.<code>roleName</code> tothe <code>value</code> attribute ofthe last string.</li></p></ol><p><font face="Times">When you're done, the repetition bindings should look likethe following:</font></p><P><img src = "../Art/boundrep.gif" alt = "[image: ../Art/boundrep.gif]"><a name = "TPXREF146"></a><h3><font face="Helvetica,Arial,Lucida Grande">RunningMovies</font></h3><p><font face="Times">Be sure that all your project's files are saved (includingthe components in WebObjects Builder and the model in EOModeler),and build and run your application. In the Main page, select a movieand click the Movie Details link. Now, in addition to displayingall the movie's information, the Movie Details page should alsodisplay the movie's roles and actors.</font></p>    <br><a href="Refining_Your_Model.html" target="_right"><img src="../Images/previous.gif" border="0" alt="Previous"></a><a href="Updating_Ob_splay_Group.html" target="_right"><img src="../Images/next.gif" border="0" alt="Next"></a>&nbsp;<p><font face="Geneva,Helvetica,Arial" size="1">&#169; 2001 Apple Computer, Inc.</font></p><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></html>