<html><head><title>Mac OS X
 Manual Page For postsuper(1)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/1/postsuper" title="Mac OS X
 Manual Page for postsuper(1)"><!-- headerDoc=man; indexgroup=Section 1; uid="//apple_ref/doc/man/1/postsuper"; name=postsuper(1) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
POSTSUPER(1)                                                                                    POSTSUPER(1)



<b>NAME</b>
       postsuper - Postfix superintendent

<b>SYNOPSIS</b>
       <b>postsuper</b> [<b>-psv</b>] [<b>-c</b> <u>config</u><b>_</b><u>dir</u>] [<b>-d</b> <u>queue</u><b>_</b><u>id</u>]
               [<b>-h</b> <u>queue</u><b>_</b><u>id</u>] [<b>-H</b> <u>queue</u><b>_</b><u>id</u>]
               [<b>-r</b> <u>queue</u><b>_</b><u>id</u>] [<u>directory</u> <u>...</u>]

<b>DESCRIPTION</b>
       The <b>postsuper</b>(1) command does maintenance jobs on the Postfix queue. Use of the command is restricted
       to the superuser.  See the <a href="postqueue.1.html#//apple_ref/doc/man/1/postqueue"><b>postqueue</b>(1)</a> command for unprivileged queue operations such as listing  or
       flushing the mail queue.

       By default, <b>postsuper</b>(1) performs the operations requested with the <b>-s</b> and <b>-p</b> command-line options on
       all Postfix queue directories - this includes the <b>incoming</b>, <b>active</b> and <b>deferred</b> directories with mail
       files and the <b>bounce</b>, <b>defer</b>, <b>trace</b> and <b>flush</b> directories with log files.

       Options:

       <b>-c</b> <u>config</u><b>_</b><u>dir</u>
              The  <b>main.cf</b> configuration file is in the named directory instead of the default configuration
              directory. See also the MAIL_CONFIG environment setting below.

       <b>-d</b> <u>queue</u><b>_</b><u>id</u>
              Delete one message with the named queue ID from the named mail <!-- a -->queue(s)<!-- /a --> (default: <b>hold</b>, <b>incom</b>-<font color="#ffffff" class="whiteout">ing,&nbsp;incoming,</font>
              <b>ing</b>, <b>active</b> and <b>deferred</b>).

              If a <u>queue</u><b>_</b><u>id</u> of <b>-</b> is specified, the program reads queue IDs from standard input. For example,
              to delete all mail with exactly one recipient <b>user@example.com</b>:

              mailq | tail +2 | grep -v '^ *(' | awk  'BEGIN { RS = "" }
                  # $7=sender, $8=recipient1, $9=recipient2
                  { if ($8 == "user@example.com" &amp;&amp; $9 == "")
                        print $1 }
              ' | tr -d '*!' | postsuper -d -<font color="#ffffff" class="whiteout">Specify&nbsp;-dSpecify</font>

              Specify "<b>-d</b> <b>ALL</b>" to remove all messages; for example, specify "<b>-d</b> <b>ALL</b> <b>deferred</b>" to delete  all
              mail  in  the  <b>deferred</b>  queue.   As a safety measure, the word <b>ALL</b> must be specified in upper
              case.

              Warning: Postfix queue IDs are reused.  There is  a  very  small  possibility  that  postsuper
              deletes the wrong message file when it is executed while the Postfix mail system is delivering
              mail.

              The scenario is as follows:

              1)     The Postfix queue manager deletes the message that <b>postsuper</b>(1)  is  asked  to  delete,
                     because Postfix is finished with the message (it is delivered, or it is returned to the
                     sender).

              2)     New mail arrives, and the new message is given the same queue ID as  the  message  that
                     <b>postsuper</b>(1)  is supposed to delete.  The probability for reusing a deleted queue ID is
                     about 1 in 2**15 (the number of different microsecond values that the system clock  can
                     distinguish within a second).

              3)     <b>postsuper</b>(1)  deletes  the  new message, instead of the old message that it should have
                     deleted.

       <b>-h</b> <u>queue</u><b>_</b><u>id</u>
              Put mail "on hold" so that no attempt is made to deliver it.  Move one message with the  named
              queue  ID  from  the  named mail <!-- a -->queue(s)<!-- /a --> (default: <b>incoming</b>, <b>active</b> and <b>deferred</b>) to the <b>hold</b>
              queue.

              If a <u>queue</u><b>_</b><u>id</u> of <b>-</b> is specified, the program reads queue IDs from standard input.

              Specify "<b>-h</b> <b>ALL</b>" to hold all messages; for example, specify "<b>-h</b> <b>ALL</b> <b>deferred</b>" to hold all mail
              in the <b>deferred</b> queue.  As a safety measure, the word <b>ALL</b> must be specified in upper case.

              Note:  while mail is "on hold" it will not expire when its time in the queue exceeds the <b>maxi</b>-<font color="#ffffff" class="whiteout">mal_queue_lifetime&nbsp;maximal_queue_lifetime</font>
              <b>mal_queue_lifetime</b> or <b>bounce_queue_lifetime</b> setting. It becomes subject to expiration after it
              is released from "hold".

       <b>-H</b> <u>queue</u><b>_</b><u>id</u>
              Release  mail that was put "on hold".  Move one message with the named queue ID from the named
              mail <!-- a -->queue(s)<!-- /a --> (default: <b>hold</b>) to the <b>deferred</b> queue.

              If a <u>queue</u><b>_</b><u>id</u> of <b>-</b> is specified, the program reads queue IDs from standard input.

              Note: specify "<b>postsuper</b> <b>-r</b>" to release mail that was kept on hold for a significant  fraction
              of <b>$maximal_queue_lifetime</b> or <b>$bounce_queue_lifetime</b>, or longer.

              Specify  "<b>-H</b>  <b>ALL</b>"  to  release all mail that is "on hold".  As a safety measure, the word <b>ALL</b>
              must be specified in upper case.

       <b>-p</b>     Purge old temporary files that are left over after system or software crashes.

       <b>-r</b> <u>queue</u><b>_</b><u>id</u>
              Requeue the message with the named queue ID from  the  named  mail  <!-- a -->queue(s)<!-- /a -->  (default:  <b>hold</b>,
              <b>incoming</b>,  <b>active</b>  and  <b>deferred</b>).  To requeue multiple messages, specify multiple <b>-r</b> command-<font color="#ffffff" class="whiteout">line&nbsp;commandline</font>
              line options.

              Alternatively, if a <u>queue</u><b>_</b><u>id</u> of <b>-</b> is specified, the program  reads  queue  IDs  from  standard
              input.

              Specify  "<b>-r</b> <b>ALL</b>" to requeue all messages. As a safety measure, the word <b>ALL</b> must be specified
              in upper case.

              A requeued message is moved to the <b>maildrop</b> queue, from where it is copied  by  the  <a href="../man8/pickup.8.html#//apple_ref/doc/man/8/pickup"><b>pickup</b>(8)</a>
              and <a href="../man8/cleanup.8.html#//apple_ref/doc/man/8/cleanup"><b>cleanup</b>(8)</a> daemons to a new queue file. In many respects its handling differs from that of
              a new local submission.

                    The message is not subjected to the smtpd_milters or non_smtpd_milters settings.   When
                     mail  has  passed  through  an  external  content  filter, this would produce incorrect
                     results with Milter applications that depend on original SMTP connection state informa-<font color="#ffffff" class="whiteout">tion.&nbsp;information.</font>
                     tion.

                    The  message  is  subjected  again to mail address rewriting and substitution.  This is
                     useful when rewriting rules or virtual mappings have changed.

                     The address rewriting context (local or remote) is the same as  when  the  message  was
                     received.

                    The  message  is subjected to the same content_filter settings (if any) as used for new
                     local mail submissions.  This is useful when content_filter settings have changed.

              Warning: Postfix queue IDs are reused.  There is a very small  possibility  that  <b>postsuper</b>(1)
              requeues  the wrong message file when it is executed while the Postfix mail system is running,
              but no harm should be done.

       <b>-s</b>     Structure check and structure repair.  This should be done once before Postfix startup.

                    Rename files whose name does not match the message file inode number. This operation is
                     necessary  after restoring a mail queue from a different machine, or from backup media.

                    Move queue files that are in the wrong place in the file system  hierarchy  and  remove
                     subdirectories  that  are no longer needed.  File position rearrangements are necessary
                     after a change in the <b>hash_queue_names</b> and/or  <b>hash_queue_depth</b>  configuration  parame-<font color="#ffffff" class="whiteout">ters.&nbsp;parameters.</font>
                     ters.

       <b>-v</b>     Enable  verbose logging for debugging purposes. Multiple <b>-v</b> options make the software increas-<font color="#ffffff" class="whiteout">ingly&nbsp;increasingly</font>
              ingly verbose.

<b>DIAGNOSTICS</b>
       Problems are reported to the standard error stream and to <a href="../man8/syslogd.8.html#//apple_ref/doc/man/8/syslogd"><b>syslogd</b>(8)</a>.

       <b>postsuper</b>(1) reports the number of messages deleted with <b>-d</b>, the number of messages requeued with <b>-r</b>,
       and  the  number  of  messages  whose queue file name was fixed with <b>-s</b>. The report is written to the
       standard error stream and to <a href="../man8/syslogd.8.html#//apple_ref/doc/man/8/syslogd"><b>syslogd</b>(8)</a>.

<b>ENVIRONMENT</b>
       MAIL_CONFIG
              Directory with the <b>main.cf</b> file.

<b>BUGS</b>
       Mail that is not sanitized by Postfix (i.e. mail in the <b>maildrop</b> queue) cannot be placed "on hold".

<b>CONFIGURATION</b> <b>PARAMETERS</b>
       The following <b>main.cf</b> parameters are especially relevant to this program.  The  text  below  provides
       only a parameter summary. See <a href="../man5/postconf.5.html#//apple_ref/doc/man/5/postconf"><b>postconf</b>(5)</a> for more details including examples.

       <b>config_directory</b> <b>(see</b> <b>'postconf</b> <b>-d'</b> <b>output)</b>
              The default location of the Postfix main.cf and master.cf configuration files.

       <b>hash_queue_depth</b> <b>(1)</b>
              The  number  of  subdirectory  levels  for  queue directories listed with the hash_queue_names
              parameter.

       <b>hash_queue_names</b> <b>(deferred,</b> <b>defer)</b>
              The names of queue directories that are split across multiple subdirectory levels.

       <b>queue_directory</b> <b>(see</b> <b>'postconf</b> <b>-d'</b> <b>output)</b>
              The location of the Postfix top-level queue directory.

       <b>syslog_facility</b> <b>(mail)</b>
              The syslog facility of Postfix logging.

       <b>syslog_name</b> <b>(postfix)</b>
              The mail system name that is prepended to the process name in syslog records, so that  "smtpd"
              becomes, for example, "postfix/smtpd".

<b>SEE</b> <b>ALSO</b>
       <a href="sendmail.1.html#//apple_ref/doc/man/1/sendmail">sendmail(1)</a>, Sendmail-compatible user interface
       <a href="postqueue.1.html#//apple_ref/doc/man/1/postqueue">postqueue(1)</a>, unprivileged queue operations

<b>LICENSE</b>
       The Secure Mailer license must be distributed with this software.

<b>AUTHOR(S)</b>
       Wietse Venema
       IBM T.J. Watson Research
       P.O. Box 704
       Yorktown Heights, NY 10598, USA



                                                                                                POSTSUPER(1)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man1/postsuper.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man1/postsuper.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man1/postsuper.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
