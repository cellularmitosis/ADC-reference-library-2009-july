<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>DoTranslateScrap (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING450></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-449.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-451.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-402.html"><B>Chapter 7 - Translation Manager</B></A> / <A HREF="MoreToolbox-432.html"><B>Translation Extension Reference</B></A><BR><DL><DD><A HREF="MoreToolbox-442.html"><B>Translation Extension-Defined Routines</B></A> / <A HREF="MoreToolbox-447.html"><B>Scrap Translation Extension Routines</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING450-0></A>
<H3>DoTranslateScrap</H3>
 A scrap translation extension must respond to the <CODE>kTranslateTranslateScrap</CODE> request code. The Translation Manager sends this request code to allow the extension to translate scraps from one format to another. You can handle this request by calling the <CODE>CallComponentFunctionWithStorage</CODE> function and passing it a pointer to a function with the syntax defined by the <CODE>DoTranslateScrap</CODE> function.<A NAME=MARKER-9-238></A><P>
<PRE>
FUNCTION DoTranslateScrap (self: ComponentInstance;
                           refNum: TranslationRefNum;
                           srcDataPtr: Ptr;
                           srcDataLength: Size;
                           srcType: ScrapType;
                           srcTypeHint: LongInt;
                           dstData: Handle;
                           dstType: ScrapType;
                           dstTypeHint: LongInt) 
                           : ComponentResult;
</PRE>
<DL>
<DT><CODE>self</CODE>
<DD> A component instance that identifies the component containing the translation extension.
<DT><CODE>refNum</CODE>
<DD> The translation reference number for this translation.
<DT><CODE>srcDataPtr</CODE>
<DD> A pointer to the scrap to be translated.
<DT><CODE>srcDataLength</CODE>
<DD> The size of the scrap to be translated.
<DT><CODE>srcType</CODE>
<DD> The format of the scrap to be translated.
<DT><CODE>srcTypeHint</CODE>
<DD> The value in the <CODE>hint</CODE> field of the source document's scrap type specification.
<DT><CODE>dstData</CODE>
<DD> A handle to the destination to be filled in.
<DT><CODE>dstType</CODE>
<DD> The format into which to translate the source scrap.
<DT><CODE>dstTypeHint</CODE>
<DD> The value in the <CODE>hint</CODE> field of the destination document's scrap type specification.
</DL>
<A NAME=HEADING450-12></A>
<H5>DESCRIPTION</H5>
 The <CODE>DoTranslateScrap</CODE> function translates a scrap from one format into another. The scrap to be translated is specified by the <CODE>srcDataPtr</CODE> and <CODE>srcDataLength</CODE> parameters, and your routine should put the translated data into the block specified by the <CODE>dstData</CODE> parameter. Your function should resize that block as necessary and fill it with the appropriate translated data.<P>
 The <CODE>refNum</CODE> parameter is a reference number that Macintosh Easy Open assigns to the translation. Each translation is assigned a unique number to distinguish the translation from any other translations that might be occurring. You need to pass this reference number to any Macintosh Easy Open routines you call from within the scrap translation extension; for instance, if you display the progress dialog box by calling the <CODE>SetTranslationAdvertisement</CODE> function, you'll pass that reference number in the <CODE>refNum</CODE> parameter.<P>
 The <CODE>DoTranslateScrap</CODE> function can translate the source file itself or rely upon external translators. If it cannot translate the source scrap, your function should return a result code different from <CODE>noErr</CODE>.<P>
 Your translation extension should call the <CODE>SetTranslationAdvertisement</CODE> function to display the progress dialog box and the <CODE>UpdateTranslationProgress</CODE> function to update the dialog box periodically.<P>
<A NAME=HEADING450-17></A>
<H5>RESULT CODES</H5>
 The <CODE>DoTranslateScrap</CODE> function should return <CODE>noErr</CODE> if successful, or an appropriate result code otherwise.<A NAME=MARKER-2-279></A><A NAME=MARKER-9-196></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-449.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-451.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
