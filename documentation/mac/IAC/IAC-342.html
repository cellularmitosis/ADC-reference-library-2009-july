<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Recording Scripts(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING342></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-341.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-343.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-331.html"><B>Chapter 10 - Scripting Components</B></A> / <A HREF="IAC-333.html"><B>Using Scripting Component Routines</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING342-0></A>
<H2><A NAME=MARKER-9-159></A>Recording Scripts</H2>
 If you want your application to record Apple events in the form of a compiled script, or if you are writing a script-editing application like Script Editor, you can use the <CODE>OSAStartRecording</CODE> and <CODE>OSAStopRecording</CODE> functions to start and stop recording into a specified script ID on a single computer. Both functions take a component instance and a script ID for a compiled script. When your application calls <CODE>OSAStartRecording</CODE>, the scripting component identified by the component instance sends a Start Recording event to your application and installs a Receive Recordable Event handler in your application's Apple event dispatch table. When your application calls <CODE>OSAStopRecording</CODE>, the scripting component removes the handler.<P>
 An application acting as a recording process in this manner should not provide a handler for the Start Recording event. Instead, the Apple Event Manager receives the event and responds by sending a Recording On event to all running processes on the local computer. Thereafter, the Apple Event Manager sends copies of subsequent recordable events to the recording process, whose previously installed Receive Recordable Event handler, much like a handler for event class <CODE>typeWildCard</CODE> and event ID <CODE>typeWildCard</CODE>, handles those recordable events by recording them in the compiled script specified in the call to <CODE>OSAStartRecording</CODE>.<P>
 Whenever the Receive Recordable Event handler receives a recordable event, the scripting component sends your application a Recorded Text event. The Recorded Text event contains the decompiled source data for the recorded event in the form of styled text. 
<TABLE BORDER="0" CELLPADDING=3><TH colspan=3>Recorded Text--append styled text to script editor window <A NAME=MARKER-2-194></A><TR>
<TD colspan=2>Event class<TD>kOSASuite<TR>
<TD colspan=2>Event ID<TD>kOSARecordedText<TR>
<TD colspan=2>Required parameter<TD>&nbsp;<TR>
<TD>&nbsp;<TD>Keyword:<TD><CODE>keyDirectObject</CODE><TR>
<TD>&nbsp;<TD>Descriptor type:<TD><CODE>typeStyledText</CODE> or any other text descriptor type<TR>
<TD>&nbsp;<TD>Data:<TD>Decompiled source data for recorded event<TR>
<TD colspan=2>Description<TD>Sent by a scripting component to a recording process for each event recorded after a call to <CODE>OSAStartRecording</CODE></TABLE>
 <A NAME=MARKER-2-199></A> <A NAME=MARKER-2-200></A><P>
 If your want your application to display the source data for recorded events as they are recorded, you must provide a handler for the Recorded Text event. <P>
 For more information about the Receive Recordable Event handler and Apple event recording, see <A HREF=IAC-330.html#MARKER-9-46>"How Apple Event Recording Works,"</A> which begins on <A HREF=IAC-330.html#MARKER-9-46>page 9-35</A>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-341.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-343.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
