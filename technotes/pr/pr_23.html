<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note PR23: Position-Independent PostScript</title>                                       <meta name="categories" content="Printing"><meta name="week-posted" content="Feb 29, 1988 - Mar 4, 1988"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002644" title="Position-Independent PostScript"></a><a name="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxPrinting-date.html">Printing</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/Printing/index.html" target="_blank">Reference Library > Printing</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note PR23</div>
<div id="pageheadsub">Position-Independent PostScript</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext">					 <A HREF="#Section1">Introduction</A><BR><BR> <A HREF="#References">References</A><BR><BR> <A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><p id="introtext">This technical note describes a method for inserting position-independentPostScript into QuickDraw pictures.</p> <!-- end_intro_text --><!-- begin_date --><h3 align=center>[Mar 01 1988]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><a name=Section1></A> <H2>Introduction</h2><p>There is a problem with pictures that contain PostScript code. Sometimes thePostScript code that is inserted into the picture is dependent on the positionof the picture on the page. The problem arises when these pictures are cut orcopied from their original position, and pasted into another position or eveninto another document. The PostScript code will not know the new location ofthe picture, and will not execute correctly.</p><p>The solution for this problem, is to provide some way for the PostScript codeto determine the current location of the picture relative to the page that itis being printed on. This is done by inserting QuickDraw calls to position theLaserWriter's pen before inserting the position dependent PostScript code. Whenthe PostScript in the picture is executed, the LaserWriter's pen location willbe in a location relative to the position of the picture on the page.</p><p>The following example illustrates a method for positioning the LaserWriter'spen before inserting any PostScript code into the picture. The method usesQuickDraw calls to position the LaserWriter's pen, and will work with anyapplication that supports QuickDraw pictures. Applications do not have to bechanged to be able to print pictures which use this technique; normal calls to<code>DrawPicture</code> will work.</p><p>The following code fragment will create a picture that contains PostScript todraw a rectangle around the picture's frame:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>FUNCTION CreatePicture(pictureRect: Rect): PicHandle;    CONST        PostScriptBegin = 190;        PostScriptEnd = 191;        PostScriptHandle = 192;    VAR        PSString     : Str255;        PSHandle     : Handle;        theError     : OSErr;    BEGIN        (* Create a new Picture. *)        CreatePicture := OpenPicture(pictureRect);        ClipRect(pictureRect);        (* Set the pen size to 0,0 so the following Line will not *)         (* be shown, it is only sent to position the pen.*)         PenSize(0,0);        (* Move the QuickDraw pen to the first pixel inside the *)        (* the picture's frame.  This by itself will not *)        (* change the LaserWriter's pen location! *)        MoveTo(pictureRect.left, pictureRect.top);        (* Force the LaserWriter's pen location to match the  *)        (* QuickDraw pen location.  Actually any drawing command, *)        (* such as LineTo or even DrawString will cause the *)         (* LaserWriter's pen location to change.  This call to *)         (* the Line procedure only causes the coordinates of *)         (* the above MoveTo to be flushed to the LaserWriter. *)         (* Because of the PenSize call above, no Line is drawn. *)         Line(0,0);        (* Reset the pen to its default size. *)        PenSize(1,1);        (* The LaserWriter's pen location has now been changed.  The *)        (* PostScript currentpoint operator will now return the *)         (* location of the center pixel of the Picture. *)        (* Get the PostScript ready to be sent. *)        (* currentpoint        - push the current Point onto the stack. *)        (* newpath            - Begin a new Line segment. *)         (* MoveTo            - Move to the currentpoint we saved above. *)         (* nn nn rlineto        - frame the Picture with lines. *)         (* stroke             - Draw the frame. *)         PSString :=        '100 0 rlineto 0 100 rlineto -100 0 rlineto 0 -100 rlineto stroke '                ;         PSString[length(PSString)] := CHR(13); (* Don't forget CR. *)         theError:=PtrToHand(Ptr(ORD4(@PSString)+1),        PSHandle,length(PSString));         IF theError &lt;&gt; noErr THEN HandleError;        (* Send the PostScript code to the LaserWriter. *)        PicComment(PostScriptBegin,0,nil);            (* QuickDraw calls made between the PostScriptBegin *)            (* and PostScriptEnd PicComments will be ignored by *)            (* devices that support PostScript. *)            PicComment(PostScriptHandle,GetHandleSize(PSHandle),PSHandle);        PicComment(PostScriptEnd,0,nil);        (* Kill off the Handle we created and close the picture. *)         DisposHandle(PSHandle);        ClosePicture;</pre>	</TD></TR></TABLE></CENTER><p>See the LaserWriter Reference Manual for more information about <code>PicComments</code>.See the <i>PostScript Language Reference Manual</i> for more information aboutthe <code>currentpoint</code> operator.</p><p>There are some important guidelines to follow when sending PostScript directlyto the LaserWriter. See the PostScript Commands section of <A HREF = "../qd/qd_10.html">Technical Note #91</a>,for a complete description of these guidelines.</p><P><A HREF="#top">Back to top</A></P><a name="References"></a><h2>References</h2><P>The Print Manager</p><P>QuickDraw</p><P><i>LaserWriter Reference Manual</i></p><P>Technical Note M.IM.gifComments -- <A HREF = "../qd/qd_10.html">Optimizing for the LaserWriter--PicComments</a></p><P><i>PostScript Language Reference Manual</i>, Adobe Systems</p><P><i>PostScript Language Cookbook and Tutorial</i>, Adobe Systems</p>         <P><A HREF="#top">Back to top</A></P>         <a name=Downloads></A>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (44K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/pr_23.pdf">Download</A></P>               </TD>            </TR>                    </TABLE>         <BR></TD></TR></table></center><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/pr/pr_23.html%3Fid%3DDTS10002644-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/pr/pr_23.html%3Fid%3DDTS10002644-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/pr/pr_23.html%3Fid%3DDTS10002644-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>