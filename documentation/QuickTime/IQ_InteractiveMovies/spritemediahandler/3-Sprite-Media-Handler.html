<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Interactive Movies: Sprite Media Handler</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Sprite Media Handler"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40000883-CH207" title="Sprite Media Handler"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../index.html#//apple_ref/doc/uid/TP30000440-TP30000433" target="_top">QuickTime</a> &gt; <a href="../../WiredMoviesandSprites-date.html#//apple_ref/doc/uid/TP30000440-TP30000433-TP30000594" target="_top">Wired Movies and Sprites</a> &gt; <a href="../preface/QT_Interactive_preface.html#//apple_ref/doc/uid/TP40000883-CH204-DontLinkElementID_69">Interactive Movies</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../introwiredsprites/2-Intro-Wired-Sprites.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../authoringwiredmovies/4-Authoring-Wired-Movies.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40000883-CH207-DontLinkElementID_109" title="Sprite Media Handler"></a><h1><a name="//apple_ref/doc/uid/TP40000883-CH207-CJBEEIFB" title="Sprite Media Handler"></a>Sprite Media Handler</h1><p>This chapter discusses the sprite media handler, which you can use to add a sprite animation track to a QuickTime movie. It makes use of the functionality provided by the sprite toolbox discussed in <span class="content_text"><a href="../introwiredsprites/2-Intro-Wired-Sprites.html#//apple_ref/doc/uid/TP40000883-CH206-BAJFCHFE">“Chapter 2, QuickTime Sprites, Sprite Animation and Wired Movies,”</a></span> and provides routines for manipulating the sprites and images in a sprite track. If you are using the sprite media handler, you don’t need to use the toolbox API. </p><p>The chapter is divided into the following major sections:</p><ul class="ul"><li class="li"><p><span class="content_text"><a href="3-Sprite-Media-Handler.html#//apple_ref/doc/uid/TP40000883-CH207-CJBIAGHJ">“Defining the Sprite Media Handler”</a></span> discusses the sprite media handler, which provides routines for manipulating the sprites and images in a sprite track. </p></li><li class="li"><p><span class="content_text"><a href="3-Sprite-Media-Handler.html#//apple_ref/doc/uid/TP40000883-CH207-CJBGJEDJ">“Using Sprites in a Sprite Track”</a></span> describes some of the ways your application can use sprites in QuickTime sprite tracks, including sprite button behaviors and variable string support. </p></li><li class="li"><p><span class="content_text"><a href="3-Sprite-Media-Handler.html#//apple_ref/doc/uid/TP40000883-CH207-CJBGGFGJ">“Creating a QuickTime Sprite Movie”</a></span> discusses sample code that you can use to create a sprite movie containing one sprite track. </p></li><li class="li"><p><span class="content_text"><a href="3-Sprite-Media-Handler.html#//apple_ref/doc/uid/TP40000883-CH207-CJBGBAHC">“Useful Sprite Media Handler Functions”</a></span> describes the sprite media handler functions available to your application. For example, you use the <code>SpriteMediaSetSpriteProperty</code> function to set the specified property of a sprite.</p></li><li class="li"><p><span class="content_text"><a href="3-Sprite-Media-Handler.html#//apple_ref/doc/uid/TP40000883-CH207-CJBCIFAG">“Wired Actions in QuickTime”</a></span> describes the new wired actions and operands introduced in QuickTime 5.01. </p></li></ul><a name="//apple_ref/doc/uid/TP40000883-CH207-CJBIAGHJ" title="Defining the Sprite Media Handler"></a><h2>Defining the Sprite Media Handler</h2><p>The sprite media handler is a media handler that makes it possible to add a track containing a sprite animation to a QuickTime movie. The sprite media handler provides routines for manipulating the sprites and images in a sprite track. </p><p>The sprite media handler makes use of routines provided by the sprite toolbox. As with sprites created in a sprite world, sprites in a sprite track have properties that define their locations, images, and appearance. However, you create the sprite track and its sprites differently than you create the sprites in a sprite world.</p><p>A sprite track is defined by one or more key frame samples, each followed by any number of override samples. A key frame sample and its subsequent override samples define a scene in the sprite track. A key frame sample is a QT atom container that contains atoms defining the sprites in the scene and their initial properties. The override samples are other QT atom containers that contain atoms that modify sprite properties, thereby animating the sprites in the scene. A sprite track sample is a QT atom container structure. In addition to defining properties for individual sprites, you can also define properties that apply to an entire sprite track. <span class="content_text"><a href="../quicktimeatoms/8-QuickTime-Atoms.html#//apple_ref/doc/uid/TP40000883-CH212-BCICJDEI">“Chapter 8, QuickTime Atoms and Atom Containers,”</a></span> provides an overview QT atoms and atom containers. For complete information, refer to the book <em>QuickTime File Format</em>, which is available at </p><div class="codesample"><table><tr><td scope="row"><pre>http://developer.apple.com/documentation/Quicktime/QuickTime.html<span></span></pre></td></tr></table></div><p>A key frame sample also contains all of the images used by the sprites. This allows the sprites in a sprite track to share image data. The images consist of two parts, an image description handle (<code>ImageDescriptionHandle</code>) concatenated with compressed image data. The image description handle describes the compressed image. You can compress the image using any QuickTime codec.</p><p>Images are stored in a key frame sample by index; each sprite has an image index property (<code>kSpritePropertyImageIndex</code>) that specifies the sprite’s current image. All images assigned to a sprite must be created using the same image description, unless you use group IDs.</p><p>The matrix, layer, visible, and graphics mode sprite properties have the same meaning for a sprite in a sprite track as for a sprite created in a sprite world. </p><p>As with sprite worlds, you can create a sprite track that has a solid background color, a background image composed of the images of one or more background sprites, or both a background color and a background image.</p><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF101" title="Key Frame Samples and Override Samples"></a><h3>Key Frame Samples and Override Samples</h3><p>As discussed, a sprite track is defined by one or more key frame samples, each followed by any number of override samples. A key frame sample for a sprite track defines the following aspects of a sprite track:</p><ul class="spaceabove"><li class="li"><p>The number of sprites in the scene and their initial properties.</p></li><li class="li"><p>All of the shared image data to be used by the sprites in the scene, including image data to be used in the subsequent override samples. Because a key frame sample contains the image data for the scene, the key frame sample tends to be larger than its subsequent override samples.</p></li></ul><p>An override sample overrides some aspect of the key frame sample. For example, an override sample might modify the location of sprites defined in the key frame sample. Override samples do not contain any image data, so they can be very small. An override sample can show or hide a sprite defined in the key frame sample, but it cannot define new sprites or remove sprites defined in its key frame sample. An override sample can override any number of properties for any number of sprites. For example, a single override sample might change the layer and location of sprite ID 3, and hide sprite ID 10.</p><p>There are two sprite track formats that define how a key frame sample and its subsequent override samples are interpreted. If the current sample is a key frame sample, the key frame sample alone fully describes the current state of the track. If the current sample is an override sample, the current state may differ depending on the sprite track format:</p><ul class="spaceabove"><li class="li"><p>If the sprite track format is <code>kKeyFrameAndSingleOverride</code>, the current state is defined by the most recent key frame sample and the current override sample. This is the default format. The advantage of this format is that it allows for excellent performance during random access. A sprite track that uses this format can play backwards and drop frames smoothly. The disadvantage of this format is that the file size of the track may be larger than a track that uses the other format.</p></li><li class="li"><p>If the sprite track format is <code>kKeyFrameAndAllOverrides</code>, the current state is defined by the most recent key sample and all subsequent override samples, including the current override sample. This format results in a smaller file size. However, you should not use this format if you want your sprite track to play backwards or drop frames smoothly. When you play a movie that contains a sprite track whose format is <code>kKeyFrameAndAllOverrides</code>, you should configure the movie to play all frames.</p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40000883-CH207-DontLinkElementID_110" title="Important:"></a><p><strong>Important:</strong>&nbsp;A sprite track must be authored exclusively with a single format, that is, either all with <code>kKeyFrameAndSingleOverride</code> or all with <code>kKeyFrameAndAllOverrides</code>. </p><p></p></div></li></ul><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF102" title="Sprite Track Media Format"></a><h3>Sprite Track Media Format</h3><p>The sprite track media format is hierarchical and based on QT atoms and atom containers. A <a name="//apple_ref/doc/uid/TP40000883-CH207-DontLinkElementID_273"></a>sprite track is defined by one or more <a name="//apple_ref/doc/uid/TP40000883-CH207-DontLinkElementID_274"></a>key frame samples, each followed by any number of override samples. A key frame sample and its subsequent override samples define a scene in the sprite track. </p><p>A key frame sample is a QT atom container that contains atoms defining the sprites in the scene and their initial properties. The override samples are other QT atom containers that contain atoms that modify sprite properties, thereby animating the sprites in the scene. In addition to defining properties for individual sprites, you can also define properties that apply to an entire sprite track. For more information about QT atoms and atom containers, see <span class="content_text"><a href="../quicktimeatoms/8-QuickTime-Atoms.html#//apple_ref/doc/uid/TP40000883-CH212-BCICJDEI">“Chapter 8, QuickTime Atoms and Atom Containers,”</a></span> and the book <em>QuickTime File Format</em> (see bibliography).</p><p><span class="content_text"><a href="3-Sprite-Media-Handler.html#//apple_ref/doc/uid/TP40000883-CH207-CJBCIEGF">Figure 3-1</a></span> shows the high-level structure of a sprite track <a name="//apple_ref/doc/uid/TP40000883-CH207-DontLinkElementID_275"></a>key frame sample. Each atom in the atom container is represented by its atom type, atom ID, and, if it is a leaf atom, the type of its data. </p><br/><div><a name="//apple_ref/doc/uid/TP40000883-CH207-DontLinkElementID_111" title="Figure 3-1A key frame sample atom container"></a><p><a name="//apple_ref/doc/uid/TP40000883-CH207-CJBCIEGF" title="Figure 3-1A key frame sample atom container"></a><strong>Figure 3-1&nbsp;&nbsp;</strong>A key frame sample atom container</p><img src = "../art/qts10.gif" alt = "A key frame sample atom container" width="389" height="347"></div><br/><p>The QT atom container contains one child atom for each sprite in the key frame sample. Each sprite atom has a type of <code>kSpriteAtomType</code>. The sprite IDs are numbered from 1 to the number of sprites defined by the key frame sample (<code>numSprites</code>). </p><p>Each sprite atom contains leaf atoms that define the properties of the sprite, as shown in <span class="content_text"><a href="3-Sprite-Media-Handler.html#//apple_ref/doc/uid/TP40000883-CH207-CJBHCCBH">Figure 3-2</a></span>. For example, the <code>kSpritePropertyLayer</code> property defines a sprite’s layer. Each sprite property atom has an atom type that corresponds to the property and an ID of 1.</p><br/><div><a name="//apple_ref/doc/uid/TP40000883-CH207-DontLinkElementID_112" title="Figure 3-2Atoms that describe a sprite and its properties"></a><p><a name="//apple_ref/doc/uid/TP40000883-CH207-CJBHCCBH" title="Figure 3-2Atoms that describe a sprite and its properties"></a><strong>Figure 3-2&nbsp;&nbsp;</strong>Atoms that describe a sprite and its properties</p><img src = "../art/qtm_l_11.gif" alt = "Atoms that describe a sprite and its properties" width="516" height="226"></div><br/><p>In addition to the sprite atoms, the QT atom container contains one atom of type <code>kSpriteSharedDataAtomType</code> with an ID of 1. The atoms contained by the shared data atom describe data that is shared by all sprites. The shared data atom contains one atom of type <code>kSpriteImagesContainerAtomType</code> with an ID of 1 (<span class="content_text"><a href="3-Sprite-Media-Handler.html#//apple_ref/doc/uid/TP40000883-CH207-CJBDIAEF">Figure 3-3</a></span>). </p><p>The image container atom contains one atom of type <code>kImageAtomType</code> for each image in the key frame sample. The image atom IDs are numbered from 1 to the number of images (<code>numImages</code>). Each image atom contains a leaf atom that holds the image data (type <code>kSpriteImageDataAtomType</code>) and an optional leaf atom (type <code>kSpriteNameAtomType</code>) that holds the name of the image.</p><br/><div><a name="//apple_ref/doc/uid/TP40000883-CH207-DontLinkElementID_113" title="Figure 3-3Atoms that describe sprite images"></a><p><a name="//apple_ref/doc/uid/TP40000883-CH207-CJBDIAEF" title="Figure 3-3Atoms that describe sprite images"></a><strong>Figure 3-3&nbsp;&nbsp;</strong>Atoms that describe sprite images</p><img src = "../art/qtm_l_17.gif" alt = "Atoms that describe sprite images" width="499" height="271"></div><br/><a name="//apple_ref/doc/uid/TP40000883-CH207-CJBFGCFD" title="Assigning Group IDs"></a><h4>Assigning Group IDs</h4><p>In earlier versions of QuickTime, sprites could only display images with the same image description. This restriction has been relaxed, but you must assign group IDs to sets of equivalent images in your key frame sample. For example, if the sample contains 10 images where the first 2 images are equivalent, and the last 8 images are equivalent, you could assign a group ID of 1000 to the first 2 images, and a group ID of 1001 to the last 8 images. This divides the images in the sample into two sets. The actual ID does not matter; it just needs to be a unique positive integer.</p><p>Each image in a sprite media key frame sample is assigned to a group. You add an atom of type <code>kSpriteImageGroupIDAtomType</code> as a child of the <code>kSpriteImageAtomType</code> atom and set its leaf data to a <code>long</code> containing the group ID. </p><p>You must assign group IDs to your sprite sample if you want a sprite to display images with non-equivalent image descriptions (i.e., images with different dimensions). </p><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF103" title="Sprite Image Registration"></a><h4>Sprite Image Registration</h4><p>Sprite images have a default registration point of 0, 0. To specify a different point, you add an atom of type <code>kSpriteImageRegistrationAtomType</code> as a child atom of the <code>kSpriteImageAtomType</code> and set its leaf data to a <code>FixedPoint</code> value with the desired registration point.</p><p>The format of an override sample is identical to that of a key frame sample with the following exceptions:</p><ul class="spaceabove"><li class="li"><p>An override sample does not contain images, which means it does not contain an atom of type <code>kSpriteImagesContainerAtomType</code> or any of its children.</p></li><li class="li"><p>In an override sample, all of the sprite atoms and sprite property atoms are optional.</p></li></ul><p>For example, to define an override sample that modifies the location of the third sprite defined by the previous key frame sample, you would create a QT atom container and add the following atoms to it (assuming that the sprite track format is of type <code>kKeyFrameAndSingleOverride</code>):</p><br/><div><a name="//apple_ref/doc/uid/TP40000883-CH207-DontLinkElementID_114" title="Figure 3-4An example of an override sample atom container"></a><p><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF131" title="Figure 3-4An example of an override sample atom container"></a><strong>Figure 3-4&nbsp;&nbsp;</strong>An example of an override sample atom container</p><img src = "../art/qtm_l_04.gif" alt = "An example of an override sample atom container" width="143" height="204"></div><br/><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF104" title="Sprite Track Properties"></a><h3>Sprite Track Properties</h3><p>In addition to defining properties for individual sprites, you can also define properties that apply to an entire sprite track. These properties may override default behavior or provide hints to the sprite media handler. The following sprite track properties are supported:</p><ul class="spaceabove"><li class="li"><p>The <code>kSpriteTrackPropertyBackgroundColor</code> property specifies a background color for the sprite track. The background color is used for any area that is not covered by regular sprites or background sprites. If you do not specify a background color, the sprite track uses black as the default background color.</p></li><li class="li"><p>The <code>kSpriteTrackPropertyOffscreenBitDepth</code> property specifies a preferred bit depth for the sprite track’s offscreen buffer. The allowable values are 8 and 16. To save memory, you should set the value of this property to the minimum depth needed. If you do not specify a bit depth, the sprite track allocates an offscreen buffer with the depth of the deepest intersecting monitor. </p></li><li class="li"><p>The <code>kSpriteTrackPropertySampleFormat</code> property specifies the sample format for the sprite track. If you do not specify a sample format, the sprite track uses the default format, <code>kKeyFrameAndSingleOverride</code>. </p></li></ul><p>To specify sprite track properties, you create a single QT atom container and add a leaf atom for each property you want to specify. To add the properties to a sprite track, you call the media handler function <code>SetMediaPropertyAtom</code>. To retrieve a sprite track’s properties, you call the media handler function <code>GetMediaPropertyAtom</code>.</p><p>The sprite track properties and their corresponding data types are listed in  <span class="content_text"><a href="3-Sprite-Media-Handler.html#//apple_ref/doc/uid/TP40000883-CH207-CJBDBGEA">Table 3-1</a></span>.</p><a name="//apple_ref/doc/uid/TP40000883-CH207-DontLinkElementID_115" title="Table 3-1Sprite track properties "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/TP40000883-CH207-CJBDBGEA" title="Table 3-1Sprite track properties "></a><strong>Table 3-1&nbsp;&nbsp;</strong>Sprite track properties </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Atom type</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Atom ID</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Leaf data type</p></th></tr><tr><td  scope="row"><p><code><!--a  -->kSpriteTrackPropertyBackgroundColor<!--/a--></code></p></td><td ><p>1</p></td><td ><p>RGBColor</p></td></tr><tr><td  scope="row"><p><code><!--a  -->kSpriteTrackPropertyOffscreenBitDepth<!--/a--></code></p></td><td ><p>1</p></td><td ><p>unsigned short</p></td></tr><tr><td  scope="row"><p><code><!--a  -->kSpriteTrackPropertySampleFormat<!--/a--></code></p></td><td ><p>1</p></td><td ><p>long</p></td></tr><tr><td  scope="row"><p><code>kSpriteTrackPropertyHasActions</code></p></td><td ><p>1</p></td><td ><p>Boolean</p></td></tr><tr><td  scope="row"><p><code>kSpriteTrackPropertyQTIdleEventsFrequency</code></p></td><td ><p>1</p></td><td ><p>UInt32</p></td></tr><tr><td  scope="row"><p><code>kSpriteTrackPropertyVisible</code></p></td><td ><p>1</p></td><td ><p>Boolean</p></td></tr><tr><td  scope="row"><p><code>kSpriteTrackPropertyScaleSpritesToScaleWorld</code></p></td><td ><p>1</p></td><td ><p>Boolean</p></td></tr></table></div><div class="notebox"><a name="//apple_ref/doc/uid/TP40000883-CH207-DontLinkElementID_116" title="Note"></a><p><strong>Note:</strong>&nbsp;When pasting portions of two different tracks together, the Movie Toolbox checks to see that all sprite track properties match. If, in fact, they do match, the paste results in a single sprite track instead of two. </p></div><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF105" title="Alternate Sources for Sprite Image Data"></a><h3>Alternate Sources for Sprite Image Data</h3><p>A sprite in a sprite track can obtain its image data from sources other than the images in the sprite track’s key frame sample. The alternate image data overrides a particular image index in the sprite track so that all sprites with that image index will use the image data provided by the alternate source. </p><p>A sprite track can receive image data from another track within the same movie, called a modifier track. This is useful for compositing traditional video tracks with sprites. For example, you might create a sprite track in which sprite characters are watching television. The sprite track can receive video from another track, called a modifier track, to use as the image data for the television screen sprite. Other sprites can move in front of and behind the television. A sprite track can have more than one modifier track feeding it image data and more than one sprite can use the image data from a modifier track at one time. </p><p>In order for a sprite to receive image data from a modifier track, you must call the <code>AddTrackReference</code> function to link the modifier track to the sprite track that it modifies. In addition, you must update the sprite media’s input map with an atom that specifies the input type (<code>kTrackModifierTypeImage</code>) and an atom that specifies the index of the image to replace (<code>kSpritePropertyImageIndex</code>).</p><p>A sprite track can also receive sprite image data from an application. For example, an application might provide live, digitized video data to a sprite track by calling <code>MediaSetNonPrimarySourceData</code>. </p><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF106" title="Supported Modifier Inputs "></a><h4>Supported Modifier Inputs </h4><p>In addition to receiving image data, a sprite track can receive modifier track data to control its sprites. The following modifier inputs are supported:</p><ul class="spaceabove"><li class="li"><p>images from a video track (<code>kTrackModifierTypeImage</code>)</p></li><li class="li"><p>a matrix from a base track (<code>kTrackModifierObjectMatrix</code>)</p></li><li class="li"><p>a graphics mode from a base track (<code>kTrackModifierObjectGraphicsMode</code>)</p></li><li class="li"><p>an image index from a base track (<code>kTrackModifierObjectImageIndex</code>)</p></li><li class="li"><p>an object layer from a base track (<code>kTrackModifierObjectLayer</code>)</p></li><li class="li"><p>an object visible from a base track (<code>kTrackModifierObjectVisible</code>)</p></li></ul><p>For example, a modifier track can send matrices to individual sprites to control their locations. To do this, you set up a modifier track, such as a tween track, to send matrix data to the sprite track. You must update the sprite media’s input map with an atom that specifies the input type (<code>kTrackModifierObjectMatrix</code>) and an atom that specifies the ID of the sprite to replace (<code>kTrackModifierObjectID</code>). If the sprite track also contains matrices to move the sprites, the results are undefined.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000883-CH207-DontLinkElementID_117" title="Note"></a><p><strong>Note:</strong>&nbsp;With the exception of image data, the source for all modifier tracks can be tween or base tracks. </p></div><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF107" title="Hit-Testing Flags"></a><h4>Hit-Testing Flags</h4><p>The following hit-testing flags are for use with <code>SpriteMediaHitTestAllSprites</code> and <code>SpriteMediaHitTestOneSprite</code>: </p><ul class="spaceabove"><li class="li"><p><code>spriteHitTestInvisibleSprites</code>, which you set if you want invisible sprites to be hit-tested along with visible ones.</p></li><li class="li"><p><code>spriteHitTestLocInDisplayCoordinates</code>, which you set if the hit-testing point is in display coordinates instead of local sprite track coordinates.</p></li><li class="li"><p><code>spriteHitTestIsClick</code>, which you set if you want the hit-testing operation to pass a click on to the codec currently rendering the sprites image. For example, this can be used to make the Ripple codec ripple.</p></li></ul><a name="//apple_ref/doc/uid/TP40000883-CH207-CJBGJEDJ" title="Using Sprites in a Sprite Track"></a><h2>Using Sprites in a Sprite Track</h2><p>This section describes some of the ways in which your application can use sprites in a sprite track in QuickTime. </p><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF108" title="Referenced Sprite Images"></a><h3>Referenced Sprite Images</h3><p>In QuickTime, the sprite track can use images which are external to its movie’s media. The images may be located somewhere on the Internet, in a local file, or anywhere else that a QuickTime Data Handler can read them from.</p><p>Since images located on a network server may take some time to load (or possibly never show up), referenced images are loaded asynchronously. Sprites not using referenced images will be created and will be active while the referenced images are loading. You may optionally supply a proxy image that will be displayed until the referenced image has been loaded. If you don’t supply a proxy image, sprites using the referenced image will be disabled (invisible and not responsive to mouse events) until it is loaded.</p><p>Otherwise, referenced images are the same as traditional ones. They are defined in a sprite key frame sample, available until the next key frame sample is loaded, used by a sprite setting its imageIndex property to the images index, and may be shared by multiple sprites.</p><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF109" title="Specifying Sprite Button Behaviors"></a><h3>Specifying Sprite Button Behaviors</h3><p>In QuickTime, sprites in a sprite track may specify some simple button behaviors. These behaviors may control the sprite’s image, the system cursor, and the status message displayed in a Web browser. These behaviors are a compact shortcut for a very common set of actions which result in more efficient movies.</p><p>Button behaviors may also be added to a sprite. These behaviors are intended to make the common task of creating buttons in a sprite track easy—you basically just fill in a template. Three types of behaviors are available; you choose one or more of them. The behaviors each change a type of property associated with a button and are triggered by the mouse states <code>notOverNotPressed</code>, <code>overNotPressed</code>, <code>overPressed</code>, and <code>notOverPressed</code>. The three properties changed are </p><ul class="spaceabove"><li class="li"><p>the sprites’ <code>imageIndex</code></p></li><li class="li"><p>the ID of a cursor to be displayed</p></li><li class="li"><p>the ID of a status string variable displayed in the URL status area of a Web browser. </p></li></ul><p>Setting a property’s value to -1 means don’t change it. </p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000883-CH207-DontLinkElementID_118" title="Note"></a><p><strong>Note:</strong>&nbsp;The cursor is automatically set back to the default system cursor when leaving a sprite. </p></div><p>The sprite track handles letting one sprite act as an active button at a time. The behaviors are prepended to the sprite’s list of actions, so they may be overriden by actions if desired. To use the behaviors, you fill in the new atoms as follows, using the description key:</p><div class="codesample"><table><tr><td scope="row"><pre>kSpriteAtomType<span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;kSpriteBehaviorsAtomType>, 1<span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;kSpriteImageBehaviorAtomType><span></span></pre></td></tr><tr><td scope="row"><pre>            [QTSpriteButtonBehaviorStruct]<span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;kSpriteCursorBehaviorAtomType><span></span></pre></td></tr><tr><td scope="row"><pre>            [QTSpriteButtonBehaviorStruct]<span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;kSpriteStatusStringsBehaviorAtomType><span></span></pre></td></tr><tr><td scope="row"><pre>            [QTSpriteButtonBehaviorStruct]<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF110" title="Using the Action Handler Sprite Property"></a><h3>Using the Action Handler Sprite Property</h3><p>QuickTime includes an action handler property: <code>kSpritePropertyActionHandlingSpriteID</code> whose data type is <code>QTAtomID</code>. You set this sprite property to the ID of another sprite in the sprite track that you wish to delegate QT event handling to. </p><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF111" title="String Variable Support "></a><h3>String Variable Support </h3><p>In QuickTime, sprite track variables may contain either strings or floating point numbers. These variables may be used for all action and operand parameters that accept strings, such as <code>GotoURL</code>. Additionally, they may be concatenated together to create new string variables.</p><p>The <code>kActionSpriteTrackSetVariableToString</code> action has been introduced to allow you to set a variable to a string value. You still use the <code>kActionSpriteTrackSetVariable</code> action to set a variable to a floating-point number.</p><p>When a sprite track variable is retrieved and used via the <code>kOperandSpriteTrackVariable</code> operand, it will be coerced to the required type. If it is used as part of an expression and it is a string, it will be converted to a floating-point number. If used as a string parameter, it will be converted to a C or Pascal string as needed from a floating-point number or string variable. </p><p>When a floating point number which does not contain an integer value is coerced to a string, a format of up to five digits before the decimal point and three digits afterwards is used.</p><a name="//apple_ref/doc/uid/TP40000883-CH207-CJBGGFGJ" title="Creating a QuickTime Sprite Movie "></a><h2>Creating a QuickTime Sprite Movie </h2><p>The sample code in this section illustrates how you can create a sprite movie containing one sprite track. The sprite track contains a static background picture sprite (or just a colored background, depending on the value of the global variable <code>gUseBackgroundPicture</code>) and three other sprites that change their properties over time.</p><p>The track’s media contains only one key frame sample followed by many override samples. The key frame contains all of the images used by the sprites; the override frames only contain the overrides of the locations, image indices, and layers needed for the other sprites.</p><p>This sample code also shows how to test for mouse clicks (“hits”) on a sprite. It uses the function <code>SpriteMediaHitTestAllSprites</code> to find mouse clicks on the sprites in the first sprite track in a movie. If the user clicks on a sprite, we toggle the visibility state of the sprite. </p><a name="//apple_ref/doc/uid/TP40000883-CH207-DontLinkElementID_119" title="Listing 3-1QTSprites sample code that lets you create a sprite movie with a single sprite track"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF132" title="Listing 3-1QTSprites sample code that lets you create a sprite movie with a single sprite track"></a><strong>Listing 3-1&nbsp;&nbsp;</strong>QTSprites sample code that lets you create a sprite movie with a single sprite track</p><div class="codesample"><table><tr><td scope="row"><pre>// header files<span></span></pre></td></tr><tr><td scope="row"><pre>#include "QTSprites.h"<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// global variables<span></span></pre></td></tr><tr><td scope="row"><pre>Boolean         gUseBackgroundPicture = true;<span></span></pre></td></tr><tr><td scope="row"><pre>                                // do we display a background picture?<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>ApplicationDataHdl QTSprites_InitWindowData (WindowObject theWindowObject)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    ApplicationDataHdl      myAppData = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre>    Track                   myTrack = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre>    MediaHandler            myHandler = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myAppData = (ApplicationDataHdl)NewHandleClear(sizeof(ApplicationDataRecord));<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myAppData != NULL) {<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        myTrack = GetMovieIndTrackType((**theWindowObject).fMovie, 1,  SpriteMediaType, movieTrackMediaType | movieTrackEnabledOnly);<span></span></pre></td></tr><tr><td scope="row"><pre>        if (myTrack != NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>            myHandler = GetMediaHandler(GetTrackMedia(myTrack));<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        // remember the sprite media handler<span></span></pre></td></tr><tr><td scope="row"><pre>        (**myAppData).fMovieHasSprites = (myTrack != NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>        (**myAppData).fSpriteHandler = myHandler;<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    return(myAppData);<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>You call <code>QTSprites_DumpWindowData</code> to get rid of any window-specific data for the sprite media handler.</p><div class="codesample"><table><tr><td scope="row"><pre>void QTSprites_DumpWindowData (WindowObject theWindowObject)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    ApplicationDataHdl      myAppData = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myAppData = (ApplicationDataHdl)GetAppDataFromWindowObject(theWindowObject);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myAppData != NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>        DisposeHandle((Handle)myAppData);<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>To create a QuickTime movie containing a sprite track, you call <code>QTSprites_CreateSpritesMovie</code>.</p><div class="codesample"><table><tr><td scope="row"><pre>OSErr QTSprites_CreateSpritesMovie (void)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    short                   myResRefNum = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>    short                   myResID = movieInDataForkResID;<span></span></pre></td></tr><tr><td scope="row"><pre>    Movie                   myMovie = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre>    Track                   myTrack;<span></span></pre></td></tr><tr><td scope="row"><pre>    Media                   myMedia;<span></span></pre></td></tr><tr><td scope="row"><pre>    StandardFileReply       myReply;<span></span></pre></td></tr><tr><td scope="row"><pre>    QTAtomContainer         mySample = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre>    QTAtomContainer         mySpriteData = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre>    RGBColor                myKeyColor;<span></span></pre></td></tr><tr><td scope="row"><pre>    Point                   myLocation, myIconLocation;<span></span></pre></td></tr><tr><td scope="row"><pre>    short                   isVisible, myLayer, myIndex, i, myDelta,<span></span></pre></td></tr><tr><td scope="row"><pre>                            myIconMinH, myIconMaxH;<span></span></pre></td></tr><tr><td scope="row"><pre>    long                    myFlags = createMovieFileDeleteCurFile |<span></span></pre></td></tr><tr><td scope="row"><pre>                            createMovieFileDontCreateResFile;<span></span></pre></td></tr><tr><td scope="row"><pre>    OSErr                   myErr = noErr;<span></span></pre></td></tr></table></div><p>You create a new movie file and ask the user for the name of the new movie file. </p><div class="codesample"><table><tr><td scope="row"><pre>    StandardPutFile(“\pSprite movie file name:”, “\pSprite.mov”,<span></span></pre></td></tr><tr><td scope="row"><pre>                    &amp;myReply);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (!myReply.sfGood)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr></table></div><p>You create a movie file for the destination movie. </p><div class="codesample"><table><tr><td scope="row"><pre>    myErr = CreateMovieFile(&amp;myReply.sfFile, FOUR_CHAR_CODE(‘TVOD’),<span></span></pre></td></tr><tr><td scope="row"><pre>                            smSystemScript, myFlags, &amp;myResRefNum,<span></span></pre></td></tr><tr><td scope="row"><pre>                            &amp;myMovie);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr></table></div><p>You create the sprite track and media. </p><div class="codesample"><table><tr><td scope="row"><pre>        myTrack = NewMovieTrack(myMovie, ((long)kSpriteTrackWidth &lt;&lt; 16), ((long)kSpriteTrackHeight &lt;&lt; 16), kNoVolume);<span></span></pre></td></tr><tr><td scope="row"><pre>    myMedia = NewTrackMedia(myTrack, SpriteMediaType, kSpriteMediaTimeScale, NULL, 0);<span></span></pre></td></tr></table></div><p>Now you create a key frame sample containing the sprites and all of their shared images and create a new, empty key frame sample. </p><div class="codesample"><table><tr><td scope="row"><pre>    myErr = QTNewAtomContainer(&amp;mySample);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre>    myKeyColor.red = myKeyColor.green = myKeyColor.blue = 0xffff;// white<span></span></pre></td></tr></table></div><p>Now you add images to the key frame sample. </p><div class="codesample"><table><tr><td scope="row"><pre>    AddPICTImageToKeyFrameSample(mySample, kIconPictID, &amp;myKeyColor,<span></span></pre></td></tr><tr><td scope="row"><pre>                                kIconImageIndex, NULL, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>    AddPICTImageToKeyFrameSample(mySample, kWorldPictID, &amp;myKeyColor,<span></span></pre></td></tr><tr><td scope="row"><pre>                                kWorldImageIndex, NULL, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>    AddPICTImageToKeyFrameSample(mySample, kBackgroundPictID,<span></span></pre></td></tr><tr><td scope="row"><pre>                                &amp;myKeyColor, kBackgroundImageIndex, NULL,<span></span></pre></td></tr><tr><td scope="row"><pre>                                NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>    for (myIndex = 1; myIndex &lt;= kNumSpaceShipImages; myIndex++)<span></span></pre></td></tr><tr><td scope="row"><pre>        AddPICTImageToKeyFrameSample(mySample, kFirstSpaceShipPictID +<span></span></pre></td></tr><tr><td scope="row"><pre>        myIndex - 1, &amp;myKeyColor, myIndex + 3, NULL, NULL);<span></span></pre></td></tr></table></div><p>You add samples to the sprite track’s media. </p><div class="codesample"><table><tr><td scope="row"><pre>    BeginMediaEdits(myMedia);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = QTNewAtomContainer(&amp;mySpriteData);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // the background image<span></span></pre></td></tr><tr><td scope="row"><pre>    if (gUseBackgroundPicture) {<span></span></pre></td></tr><tr><td scope="row"><pre>        myLocation.h    = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>        myLocation.v    = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>        isVisible       = true;<span></span></pre></td></tr><tr><td scope="row"><pre>        myLayer         = kBackgroundSpriteLayerNum;    // this makes the<span></span></pre></td></tr><tr><td scope="row"><pre>                                            // sprite a background sprite<span></span></pre></td></tr><tr><td scope="row"><pre>        myIndex         = kBackgroundImageIndex;<span></span></pre></td></tr><tr><td scope="row"><pre>        myErr = SetSpriteData(mySpriteData, &amp;myLocation, &amp;isVisible,<span></span></pre></td></tr><tr><td scope="row"><pre>                                &amp;myLayer, &amp;myIndex, NULL, NULL, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>        if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>            goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre>        AddSpriteToSample(mySample, mySpriteData,<span></span></pre></td></tr><tr><td scope="row"><pre>                            kBackgroundSpriteAtomID);<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // the space ship sprite<span></span></pre></td></tr><tr><td scope="row"><pre>    myLocation.h    = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>    myLocation.v    = 60;<span></span></pre></td></tr><tr><td scope="row"><pre>    isVisible       = true;<span></span></pre></td></tr><tr><td scope="row"><pre>    myLayer         = -1;<span></span></pre></td></tr><tr><td scope="row"><pre>    myIndex         = kFirstSpaceShipImageIndex;<span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = SetSpriteData(mySpriteData, &amp;myLocation, &amp;isVisible,<span></span></pre></td></tr><tr><td scope="row"><pre>                            &amp;myLayer, &amp;myIndex, NULL, NULL, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre>    AddSpriteToSample(mySample, mySpriteData, kSpaceShipSpriteAtomID);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // the world sprite<span></span></pre></td></tr><tr><td scope="row"><pre>    myLocation.h    = (kSpriteTrackWidth / 2) - 24;<span></span></pre></td></tr><tr><td scope="row"><pre>    myLocation.v    = (kSpriteTrackHeight / 2) - 24;<span></span></pre></td></tr><tr><td scope="row"><pre>    isVisible       = true;<span></span></pre></td></tr><tr><td scope="row"><pre>    myLayer         = 1;<span></span></pre></td></tr><tr><td scope="row"><pre>    myIndex         = kWorldImageIndex;<span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = SetSpriteData(mySpriteData, &amp;myLocation, &amp;isVisible,<span></span></pre></td></tr><tr><td scope="row"><pre>                            &amp;myLayer, &amp;myIndex, NULL, NULL, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre>    AddSpriteToSample(mySample, mySpriteData, kWorldSpriteAtomID);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // the icon sprite<span></span></pre></td></tr><tr><td scope="row"><pre>    myIconMinH          = (kSpriteTrackWidth / 2) - 116;<span></span></pre></td></tr><tr><td scope="row"><pre>    myIconMaxH          = myIconMinH + 200;<span></span></pre></td></tr><tr><td scope="row"><pre>    myDelta             = 2;<span></span></pre></td></tr><tr><td scope="row"><pre>    myIconLocation.h    = myIconMinH;<span></span></pre></td></tr><tr><td scope="row"><pre>    myIconLocation.v    = (kSpriteTrackHeight / 2) - (24 + 12);<span></span></pre></td></tr><tr><td scope="row"><pre>    isVisible           = true;<span></span></pre></td></tr><tr><td scope="row"><pre>    myLayer             = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>    myIndex             = kIconImageIndex;<span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = SetSpriteData(mySpriteData, &amp;myIconLocation, &amp;isVisible,<span></span></pre></td></tr><tr><td scope="row"><pre>                            &amp;myLayer, &amp;myIndex, NULL, NULL, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre>    AddSpriteToSample(mySample, mySpriteData, kIconSpriteAtomID);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // add the key frame sample to the sprite track media<span></span></pre></td></tr></table></div><p>To add the sample data in a compressed form, you would use a QuickTime data codec to perform the compression. You replace the call to the utility <code>AddSpriteSampleToMedia</code> with a call to the utility <code>AddCompressedSpriteSampleToMedia</code> to accomplish this. </p><div class="codesample"><table><tr><td scope="row"><pre>    AddSpriteSampleToMedia(myMedia, mySample, kSpriteMediaFrameDuration,<span></span></pre></td></tr><tr><td scope="row"><pre>                            true, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>    //AddCompressedSpriteSampleToMedia(myMedia, mySample,<span></span></pre></td></tr><tr><td scope="row"><pre>                                        kSpriteMediaFrameDuration, true,<span></span></pre></td></tr><tr><td scope="row"><pre>                                        zlibDataCompressorSubType, NULL);<span></span></pre></td></tr></table></div><p>Now you add a few override samples to move the space ship and icon, and to change the icon’s layer. </p><div class="codesample"><table><tr><td scope="row"><pre>    // original space ship location<span></span></pre></td></tr><tr><td scope="row"><pre>    myIndex         = kFirstSpaceShipImageIndex;<span></span></pre></td></tr><tr><td scope="row"><pre>    myLocation.h    = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>    myLocation.v    = 80;<span></span></pre></td></tr><tr><td scope="row"><pre>    isVisible       = true;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    for (i = 1; i &lt;= kNumOverrideSamples; i++) {<span></span></pre></td></tr><tr><td scope="row"><pre>        QTRemoveChildren(mySample, kParentAtomIsContainer);<span></span></pre></td></tr><tr><td scope="row"><pre>        QTRemoveChildren(mySpriteData, kParentAtomIsContainer);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        // every third frame, bump the space ship’s image index (so that<span></span></pre></td></tr><tr><td scope="row"><pre>        // it spins as it moves)<span></span></pre></td></tr><tr><td scope="row"><pre>        if ((i % 3) == 0) {<span></span></pre></td></tr><tr><td scope="row"><pre>            myIndex++;<span></span></pre></td></tr><tr><td scope="row"><pre>            if (myIndex > kLastSpaceShipImageIndex)<span></span></pre></td></tr><tr><td scope="row"><pre>                myIndex = kFirstSpaceShipImageIndex;<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        // every frame, bump the space ship’s location (so that it moves<span></span></pre></td></tr><tr><td scope="row"><pre>        // as it spins)<span></span></pre></td></tr><tr><td scope="row"><pre>        myLocation.h += 2;<span></span></pre></td></tr><tr><td scope="row"><pre>        myLocation.v += 1;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        if (isVisible)<span></span></pre></td></tr><tr><td scope="row"><pre>            SetSpriteData(mySpriteData, &amp;myLocation, NULL, NULL,<span></span></pre></td></tr><tr><td scope="row"><pre>            &amp;myIndex, NULL, NULL, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>        else {<span></span></pre></td></tr><tr><td scope="row"><pre>            isVisible = true;<span></span></pre></td></tr><tr><td scope="row"><pre>            SetSpriteData(mySpriteData, &amp;myLocation, &amp;isVisible, NULL,<span></span></pre></td></tr><tr><td scope="row"><pre>            &amp;myIndex, NULL, NULL, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        AddSpriteToSample(mySample, mySpriteData, 2);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        // make the icon move and change layer<span></span></pre></td></tr><tr><td scope="row"><pre>        QTRemoveChildren(mySpriteData, kParentAtomIsContainer);<span></span></pre></td></tr><tr><td scope="row"><pre>        myIconLocation.h += myDelta;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        if (myIconLocation.h >= myIconMaxH ) {<span></span></pre></td></tr><tr><td scope="row"><pre>            myIconLocation.h = myIconMaxH;<span></span></pre></td></tr><tr><td scope="row"><pre>            myDelta = -myDelta;<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        if (myIconLocation.h &lt;= myIconMinH ) {<span></span></pre></td></tr><tr><td scope="row"><pre>            myIconLocation.h = myIconMinH;<span></span></pre></td></tr><tr><td scope="row"><pre>            myDelta = -myDelta;<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        if (myDelta > 0)<span></span></pre></td></tr><tr><td scope="row"><pre>            myLayer = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>        else<span></span></pre></td></tr><tr><td scope="row"><pre>            myLayer = 3;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        SetSpriteData(mySpriteData, &amp;myIconLocation, NULL, &amp;myLayer,<span></span></pre></td></tr><tr><td scope="row"><pre>                        NULL, NULL, NULL, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>        AddSpriteToSample(mySample, mySpriteData, 4);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        AddSpriteSampleToMedia(myMedia, mySample,<span></span></pre></td></tr><tr><td scope="row"><pre>                                kSpriteMediaFrameDuration, false, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    EndMediaEdits(myMedia);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // add the media to the track<span></span></pre></td></tr><tr><td scope="row"><pre>    InsertMediaIntoTrack(myTrack, 0, 0, GetMediaDuration(myMedia),<span></span></pre></td></tr><tr><td scope="row"><pre>                            fixed1);<span></span></pre></td></tr></table></div><p>Now you set the sprite track properties. </p><div class="codesample"><table><tr><td scope="row"><pre>    if (!gUseBackgroundPicture) {<span></span></pre></td></tr><tr><td scope="row"><pre>        QTAtomContainer     myTrackProperties;<span></span></pre></td></tr><tr><td scope="row"><pre>        RGBColor            myBackgroundColor;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        // add a background color to the sprite track<span></span></pre></td></tr><tr><td scope="row"><pre>        myBackgroundColor.red = EndianU16_NtoB(0x8000);<span></span></pre></td></tr><tr><td scope="row"><pre>        myBackgroundColor.green = EndianU16_NtoB(0);<span></span></pre></td></tr><tr><td scope="row"><pre>        myBackgroundColor.blue = EndianU16_NtoB(0xffff);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        QTNewAtomContainer(&amp;myTrackProperties);<span></span></pre></td></tr><tr><td scope="row"><pre>        QTInsertChild(myTrackProperties, 0,<span></span></pre></td></tr><tr><td scope="row"><pre>                        kSpriteTrackPropertyBackgroundColor, 1, 1,<span></span></pre></td></tr><tr><td scope="row"><pre>                        sizeof(RGBColor), &amp;myBackgroundColor, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        myErr = SetMediaPropertyAtom(myMedia, myTrackProperties);<span></span></pre></td></tr><tr><td scope="row"><pre>        if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>            goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        QTDisposeAtomContainer(myTrackProperties);<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr></table></div><p>Finally, you finish up and add the movie resource to the movie file. </p><div class="codesample"><table><tr><td scope="row"><pre>    myErr = AddMovieResource(myMovie, myResRefNum, &amp;myResID,<span></span></pre></td></tr><tr><td scope="row"><pre>                            myReply.sfFile.name);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>bail:<span></span></pre></td></tr><tr><td scope="row"><pre>    if (mySample != NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>        QTDisposeAtomContainer(mySample);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    if (mySpriteData != NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>        QTDisposeAtomContainer(mySpriteData);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    if (myResRefNum != 0)<span></span></pre></td></tr><tr><td scope="row"><pre>        CloseMovieFile(myResRefNum);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    if (myMovie != NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>        DisposeMovie(myMovie);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    return(myErr);<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>You call <code>QTSprites_HitTestSprites</code> to determine whether a mouse click is on a sprite; return <code>true</code> if it is, <code>false</code> otherwise. This routine is intended to be called from your movie controller action filter function, in response to <code>mcActionMouseDown</code> actions.</p><div class="codesample"><table><tr><td scope="row"><pre>Boolean QTSprites_HitTestSprites (WindowObject theWindowObject,<span></span></pre></td></tr><tr><td scope="row"><pre>                                    EventRecord *theEvent)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    ApplicationDataHdl      myAppData = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre>    MediaHandler            myHandler = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre>    Boolean                 isHandled = false;<span></span></pre></td></tr><tr><td scope="row"><pre>    long                    myFlags = 0L;<span></span></pre></td></tr><tr><td scope="row"><pre>    QTAtomID                myAtomID = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>    Point                   myPoint;<span></span></pre></td></tr><tr><td scope="row"><pre>    ComponentResult         myErr = noErr;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myAppData = (ApplicationDataHdl)GetAppDataFromWindowObject(theWindowObject);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myAppData == NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    if (theEvent == NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myHandler = (**myAppData).fSpriteHandler;<span></span></pre></td></tr><tr><td scope="row"><pre>    myFlags = spriteHitTestImage | spriteHitTestLocInDisplayCoordinates | spriteHitTestInvisibleSprites;<span></span></pre></td></tr><tr><td scope="row"><pre>    myPoint = theEvent->where;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = SpriteMediaHitTestAllSprites(myHandler, myFlags, myPoint,<span></span></pre></td></tr><tr><td scope="row"><pre>                                            &amp;myAtomID);<span></span></pre></td></tr><tr><td scope="row"><pre>    if ((myErr == noErr) &amp;&amp; (myAtomID != 0)) {<span></span></pre></td></tr><tr><td scope="row"><pre>        Boolean             isVisible;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        // the user has clicked on a sprite;<span></span></pre></td></tr><tr><td scope="row"><pre>        // for now, we’ll just toggle the visibility state of the sprite<span></span></pre></td></tr><tr><td scope="row"><pre>        SpriteMediaGetSpriteProperty(myHandler, myAtomID, kSpritePropertyVisible, (void *)&amp;isVisible);<span></span></pre></td></tr><tr><td scope="row"><pre>        SpriteMediaSetSpriteProperty(myHandler, myAtomID, kSpritePropertyVisible, (void *)!isVisible);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        isHandled = true;<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>bail:<span></span></pre></td></tr><tr><td scope="row"><pre>    return(isHandled);<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000883-CH207-CJBGBAHC" title="Useful Sprite Media Handler Functions"></a><h2>Useful Sprite Media Handler Functions</h2><p>This section describes some of the sprite media handler functions that are useful and available to your application. For a complete listing of all functions related to sprites and the sprite media handler, refer to the <em>QuickTime API Reference</em>, which is available at </p><div class="codesample"><table><tr><td scope="row"><pre>http://developer.apple.com/documentation/Quicktime/QuickTime.html<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF112" title="SpriteMediaSetSpriteProperty"></a><h3>SpriteMediaSetSpriteProperty</h3><p>You use the <code>SpriteMediaSetSpriteProperty</code> function to set the specified property of a sprite.</p><div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult SpriteMediaSetSpriteProperty (MediaHandler mh,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                    QTAtomID spriteID,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                    long propertyType,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                    void* propertyValue);<span></span></pre></td></tr></table></div><p>You call this function to modify a property of a sprite. You set the <code>propertyType</code> parameter to the property you want to modify. Set the <code>spriteID</code> parameter to the ID of the sprite whose property you want to set. </p><p>The type of data you pass for the <code>propertyValue</code> parameter depends on the property type. <span class="content_text"><a href="3-Sprite-Media-Handler.html#//apple_ref/doc/uid/TP40000883-CH207-CJBJJGHE">Table 3-2</a></span> lists the sprite properties and the data types of the corresponding property values.</p><a name="//apple_ref/doc/uid/TP40000883-CH207-DontLinkElementID_120" title="Table 3-2Sprite properties and data types"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/TP40000883-CH207-CJBJJGHE" title="Table 3-2Sprite properties and data types"></a><strong>Table 3-2&nbsp;&nbsp;</strong>Sprite properties and data types</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Sprite Property</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data Type</p></th></tr><tr><td  scope="row"><p><code><!--a  -->kSpritePropertyMatrix<!--/a--></code></p></td><td ><p>MatrixRecord *</p></td></tr><tr><td  scope="row"><p><code><!--a  -->kSpritePropertyVisible<!--/a--></code></p></td><td ><p>short</p></td></tr><tr><td  scope="row"><p><code><!--a  -->kSpritePropertyLayer<!--/a--></code></p></td><td ><p>short</p></td></tr><tr><td  scope="row"><p><code><!--a  -->kSpritePropertyGraphicsMode<!--/a--></code></p></td><td ><p>ModifierTrackGraphicsModeRecord *</p></td></tr><tr><td  scope="row"><p><code><!--a  -->kSpritePropertyImageIndex<!--/a--></code></p></td><td ><p>short</p></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF113" title="SpriteMediaGetSpriteProperty"></a><h3>SpriteMediaGetSpriteProperty</h3><p>You use the <code>SpriteMediaGetSpriteProperty</code> function to retrieve the value of the specified sprite property.</p><div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult SpriteMediaGetSpriteProperty (MediaHandler mh,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                    QTAtomID spriteID,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                    long propertyType,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                    void* propertyValue);<span></span></pre></td></tr></table></div><p>You call this function to retrieve a value of a sprite property. You set the <code>propertyType</code> parameter to the property you want to retrieve. You set the <code>spriteID</code> parameter to the ID of the sprite whose property you want to retrieve. </p><p>On return, the <code>propertyValue</code> parameter contains a pointer to the specified property’s value; the data type of that value depends on the property. The following table lists the sprite properties and the data types of the corresponding property values.</p><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Sprite Property</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data Type</p></th></tr><tr><td  scope="row"><p><code><!--a  -->kSpritePropertyMatrix<!--/a--></code></p></td><td ><p>MatrixRecord *</p></td></tr><tr><td  scope="row"><p><code><!--a  -->kSpritePropertyVisible<!--/a--></code></p></td><td ><p>short *</p></td></tr><tr><td  scope="row"><p><code><!--a  -->kSpritePropertyLayer<!--/a--></code></p></td><td ><p>short *</p></td></tr><tr><td  scope="row"><p><code><!--a  -->kSpritePropertyGraphicsMode<!--/a--></code></p></td><td ><p>ModifierTrackGraphicsModeRecord *</p></td></tr><tr><td  scope="row"><p><code><!--a  -->kSpritePropertyImageIndex<!--/a--></code></p></td><td ><p>short *</p></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF114" title="SpriteMediaHitTestAllSprites"></a><h3>SpriteMediaHitTestAllSprites</h3><p>You use the <code>SpriteMediaHitTestAllSprites</code> function to determine whether any sprites are at a specified location.</p><div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult SpriteMediaHitTestAllSprites (MediaHandler mh,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                    long flags,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                    Point loc,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                QTAtomID *spriteHitID);<span></span></pre></td></tr></table></div><p>You call this function to determine whether any sprites exist at a specified location in the coordinate system of a sprite track’s movie. You can pass flags to this function to control the hit testing operation more precisely. For example, you may want the hit test operation to detect a sprite whose bounding box contains the specified location. </p><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF115" title="SpriteMediaCountSprites"></a><h3>SpriteMediaCountSprites</h3><p>You use the <code>SpriteMediaCountSprites</code> function to retrieve the number of sprites that currently exist in a sprite track.</p><div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult SpriteMediaCountSprites (MediaHandler mh,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                short* numSprites);<span></span></pre></td></tr></table></div><p>This function determines the number of sprites that currently exist based on the key frame that is in effect.</p><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF116" title="SpriteMediaCountImages"></a><h3>SpriteMediaCountImages</h3><p>You use the <code>SpriteMediaCountImages</code> function retrieves the number of images that currently exist in a sprite track.</p><div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult SpriteMediaCountImages (MediaHandler mh,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                short* numImages);<span></span></pre></td></tr></table></div><p>This function determines the number of images that currently exist based on the key frame that is in effect.</p><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF117" title="SpriteMediaGetIndImageDescription"></a><h3>SpriteMediaGetIndImageDescription</h3><p>You use the <code>SpriteMediaGetIndImageDescription</code> function retrieves an image description for the specified image in a sprite track.</p><div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult SpriteMediaGetIndImageDescription (MediaHandler mh,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                        short imageIndex,<span></span></pre></td></tr><tr><td scope="row"><pre>                                ImageDescriptionHandle imageDescription);<span></span></pre></td></tr></table></div><p>You set the <code>imageIndex</code> parameter to the index of the image whose image description you want to retrieve. The index must be between one and the number of available images. You can determine how many images are available by calling <code>SpriteMediaCountImages</code>.</p><p>The handle specified by the <code>imageDescription</code> parameter must be unlocked; this function resizes the handle if necessary.</p><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF118" title="SpriteMediaGetDisplayedSampleNumber"></a><h3>SpriteMediaGetDisplayedSampleNumber</h3><p>You use the <code>SpriteMediaGetDisplayedSampleNumber</code> function to retrieve the number of the sample that is currently being displayed.</p><div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult SpriteMediaGetDisplayedSampleNumber (MediaHandler mh,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                        long* sampleNum);<span></span></pre></td></tr></table></div><p>You call this function when you need to retrieve the sample number of the sample that is being displayed.</p><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF119" title="SpriteMediaGetSpriteName"></a><h3>SpriteMediaGetSpriteName</h3><p>You use the <code><a href="../../Reference/QTRef_MovieManager/Reference/reference.html#//apple_ref/doc/c_ref/SpriteMediaGetSpriteName" target="_top">SpriteMediaGetSpriteName</a></code> function to return the name of the sprite with the specified ID from the currently displayed sample.</p><div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult SpriteMediaGetSpriteName(MediaHandler mh,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                QTAtomID spriteID,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                Str255  spriteName);<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF120" title="SpriteMediaGetImageName"></a><h3>SpriteMediaGetImageName</h3><p>You use the <code><a href="../../Reference/QTRef_MovieManager/Reference/reference.html#//apple_ref/doc/c_ref/SpriteMediaGetImageName" target="_top">SpriteMediaGetImageName</a></code> function to return the name of the image with the specified index from the current key frame sample.</p><div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult SpriteMediaGetImageName(MediaHandler mh,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                short imageIndex,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                Str255 imageName);<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF121" title="SpriteMediaHitTestOneSprite"></a><h3>SpriteMediaHitTestOneSprite</h3><p>You use the <code><a href="../../Reference/QTRef_MovieManager/Reference/reference.html#//apple_ref/doc/c_ref/SpriteMediaHitTestOneSprite" target="_top">SpriteMediaHitTestOneSprite</a></code> function to perform a hit testing operation on the sprite specified by the spriteID. </p><div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult SpriteMediaHitTestOneSprite(MediaHandler mh,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                    QTAtomID spriteID,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                    long flags,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                    Point loc,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                    Boolean * wasHit);<span></span></pre></td></tr></table></div><div class="notebox"><a name="//apple_ref/doc/uid/TP40000883-CH207-DontLinkElementID_121" title="Note"></a><p><strong>Note:</strong>&nbsp;Sprite indexes range from 1 to the number of sprites in the key sample. </p></div><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF122" title="SpriteMediaSpriteIndexToID"></a><h3>SpriteMediaSpriteIndexToID</h3><p>You use the <code><a href="../../Reference/QTRef_MovieManager/Reference/reference.html#//apple_ref/doc/c_ref/SpriteMediaSpriteIndexToID" target="_top">SpriteMediaSpriteIndexToID</a></code> function to return the ID of the sprite specified by spriteIndex in spriteID.</p><div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult SpriteMediaSpriteIndexToID( MediaHandler mh,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                short spriteIndex,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                QTAtomID *  spriteID);<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF123" title="SpriteMediaSpriteIDToIndex"></a><h3>SpriteMediaSpriteIDToIndex</h3><p>You use the <code><a href="../../Reference/QTRef_MovieManager/Reference/reference.html#//apple_ref/doc/c_ref/SpriteMediaSpriteIDToIndex" target="_top">SpriteMediaSpriteIDToIndex</a></code> function to return the sprite index of the sprite specified by the spriteID.</p><div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult SpriteMediaSpriteIDToIndex(MediaHandler mh,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                QTAtomID spriteID,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                short *  spriteIndex);<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF124" title="SpriteMediaGetIndImageProperty"></a><h3>SpriteMediaGetIndImageProperty</h3><p>You use the <code><a href="../../Reference/QTRef_MovieManager/Reference/reference.html#//apple_ref/doc/c_ref/SpriteMediaGetIndImageProperty" target="_top">SpriteMediaGetIndImageProperty</a></code> function to return a property value for the image specified by <code>imageIndex</code>.</p><div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult SpriteMediaGetIndImageProperty(MediaHandler mh,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                    short imageIndex,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                 long imagePropertyType,<span></span></pre></td></tr><tr><td scope="row"><pre>                                             void * imagePropertyValue);<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF125" title="Sprites Functions Specific to Wired Sprites"></a><h3>Sprites Functions Specific to Wired Sprites</h3><p>The following routines are specific to sprite tracks using wired sprites. </p><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF126" title="SpriteMediaSetActionVariable"></a><h4>SpriteMediaSetActionVariable</h4><p>You use the <code><a href="../../Reference/QTRef_MovieManager/Reference/reference.html#//apple_ref/doc/c_ref/SpriteMediaSetActionVariable" target="_top">SpriteMediaSetActionVariable</a></code> function to set the value of the sprite track variable with the ID of the variable to the supplied value. </p><div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult SpriteMediaSetActionVariable (MediaHandler  mh,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                    QTAtomID variableID,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                    const float * value);<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF127" title="SpriteMediaGetActionVariable"></a><h4>SpriteMediaGetActionVariable</h4><p>You use the <code><a href="../../Reference/QTRef_MovieManager/Reference/reference.html#//apple_ref/doc/c_ref/SpriteMediaGetActionVariable" target="_top">SpriteMediaGetActionVariable</a></code> to return the value of the sprite track variable with the specified ID. </p><div class="codesample"><table><tr><td scope="row"><pre>pascal ComponentResult SpriteMediaGetActionVariable(MediaHandler mh,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                    QTAtomID variableID,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                    float * value);<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF128" title="SpriteDescription Structure"></a><h3>SpriteDescription Structure</h3><p>Sprite samples may be compressed using a data compression codec.</p><div class="codesample"><table><tr><td scope="row"><pre>struct SpriteDescription {<span></span></pre></td></tr><tr><td scope="row"><pre>    long        descSize;       /* total size of<span></span></pre></td></tr><tr><td scope="row"><pre>                            SpriteDescription including extra data */<span></span></pre></td></tr><tr><td scope="row"><pre>    long        dataFormat;     /*  */<span></span></pre></td></tr><tr><td scope="row"><pre>    long        resvd1;         /* reserved for apple use */<span></span></pre></td></tr><tr><td scope="row"><pre>    short       resvd2;<span></span></pre></td></tr><tr><td scope="row"><pre>    short       dataRefIndex;<span></span></pre></td></tr><tr><td scope="row"><pre>    long        version;            /* which version is this data */<span></span></pre></td></tr><tr><td scope="row"><pre>    OSType      decompressorType;   /* which decompressor to use, 0 for<span></span></pre></td></tr><tr><td scope="row"><pre>                                    no decompression */<span></span></pre></td></tr><tr><td scope="row"><pre>    long        sampleFlags;        /* how to interpret samples */<span></span></pre></td></tr><tr><td scope="row"><pre>};<span></span></pre></td></tr><tr><td scope="row"><pre>typedef struct SpriteDescription        SpriteDescription;<span></span></pre></td></tr><tr><td scope="row"><pre>typedef SpriteDescription *             SpriteDescriptionPtr;<span></span></pre></td></tr><tr><td scope="row"><pre>typedef SpriteDescriptionPtr *          SpriteDescriptionHandle;<span></span></pre></td></tr></table></div><dl class="termdef">	<dt><code>decompressorType </code></dt><dd><p>This field in the SpriteDescription sample description structure allows a data decompressor component type to be specified. If this field is nonzero, a component of the specified type is used to decompress the sprite sample when it is loaded.</p></dd></dl><a name="//apple_ref/doc/uid/TP40000883-CH207-CJBCIFAG" title="Wired Actions in QuickTime"></a><h2>Wired Actions in QuickTime</h2><p>QuickTime 5.01 introduces a number of new wired actions and operands, which are described in this section. </p><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF129" title="New Wired Actions"></a><h3>New Wired Actions</h3><p>The following new wired actions have been added in QuickTime 5: </p><div class="codesample"><table><tr><td scope="row"><pre>kActionListSetFromURL = 13317   /* (C string url, C string<span></span></pre></td></tr><tr><td scope="row"><pre>                                targetParentPath ) */<span></span></pre></td></tr></table></div><p>This allows the scripter to use an XML file to initialize a list.</p><div class="codesample"><table><tr><td scope="row"><pre>kActionSendAppMessage = 6160    /* (long appMessageID) */<span></span></pre></td></tr></table></div><p>This allows you to send a wired movie message to a host application like QuickTime Player. </p><p>The application message can be one of the following defines:</p><div class="codesample"><table><tr><td scope="row"><pre>kQTAppMessageSoftwareChanged = 1        /* notification to app that<span></span></pre></td></tr><tr><td scope="row"><pre>                                        installed QuickTime<span></span></pre></td></tr><tr><td scope="row"><pre>                                        software has been updated*/<span></span></pre></td></tr><tr><td scope="row"><pre>kQTAppMessageWindowCloseRequested = 3   /* request for app to close<span></span></pre></td></tr><tr><td scope="row"><pre>                                        window containing<span></span></pre></td></tr><tr><td scope="row"><pre>                                        movie controller*/<span></span></pre></td></tr><tr><td scope="row"><pre>kQTAppMessageExitFullScreenRequested = 4/* request for app to turn off<span></span></pre></td></tr><tr><td scope="row"><pre>                                        full screen mode if active*/<span></span></pre></td></tr><tr><td scope="row"><pre>kActionFlashTrackSetFlashVariable = 10245 /* (C string path, C string<span></span></pre></td></tr><tr><td scope="row"><pre>                        name, C string value, Boolean updateFocus) */<span></span></pre></td></tr></table></div><p>Sets a Flash variable to the value.</p><div class="codesample"><table><tr><td scope="row"><pre>kActionFlashTrackDoButtonActions = 10246 /* (C string path, long<span></span></pre></td></tr><tr><td scope="row"><pre>                                        buttonID, long transition) */<span></span></pre></td></tr></table></div><p>Sends a message to a Flash button to perform a transition. This causes whatever Flash or QuickTime action associated with the button to perform.</p><div class="codesample"><table><tr><td scope="row"><pre>kActionTextTrackPasteText = 12288/* (C string theText, long startSelection, long<span></span></pre></td></tr><tr><td scope="row"><pre>                                        endSelection ) */<span></span></pre></td></tr></table></div><p>Replaces a selection in the text track with <code>theText</code>. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionTextTrackSetTextBox= 12291 /* (short left, short top, short right,<span></span></pre></td></tr><tr><td scope="row"><pre>                                    short bottom) */<span></span></pre></td></tr></table></div><p>Changes the <code>textBox</code> of text track to the passed in size. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionTextTrackSetTextStyle = 12292 /* (Handle textStyle) */<span></span></pre></td></tr></table></div><p>Changes text track style - a TextStyle record</p><div class="codesample"><table><tr><td scope="row"><pre>kActionTextTrackSetSelection = 12293 /* (long startSelection, long endSelection ) */<span></span></pre></td></tr></table></div><p>Sets the text track selection. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionTextTrackSetBackgroundColor = 12294/* (ModifierTrackGraphicsModeRecord<span></span></pre></td></tr><tr><td scope="row"><pre>                                                backgroundColor ) */<span></span></pre></td></tr></table></div><p>Sets the text track background color. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionTextTrackSetForegroundColor = 12295/* (ModifierTrackGraphicsModeRecord<span></span></pre></td></tr><tr><td scope="row"><pre>                                            foregroundColor ) */<span></span></pre></td></tr></table></div><p>Sets the text color. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionTextTrackSetFace = 12296 /* (long fontFace ) */<span></span></pre></td></tr></table></div><p>Sets the text face (style) of all text. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionTextTrackSetFont = 12297 /* (long fontID ) */<span></span></pre></td></tr></table></div><p>Sets the text font of all text. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionTextTrackSetSize = 12298 /* (long fontSize ) */<span></span></pre></td></tr></table></div><p>Sets the text size of all text. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionTextTrackSetAlignment = 12299/* (short alignment ) */<span></span></pre></td></tr></table></div><p>Sets the text alignment as in:</p><div class="codesample"><table><tr><td scope="row"><pre>    teJustLeft                  = 0<span></span></pre></td></tr><tr><td scope="row"><pre>    teJustCenter                = 1<span></span></pre></td></tr><tr><td scope="row"><pre>    teJustRight                 = -1<span></span></pre></td></tr><tr><td scope="row"><pre>    teForceLeft                 = -2 /* new names for the<span></span></pre></td></tr><tr><td scope="row"><pre>                                 Justification (word alignment) styles */<span></span></pre></td></tr><tr><td scope="row"><pre>    teFlushDefault              = 0  /*flush according to the line<span></span></pre></td></tr><tr><td scope="row"><pre>                                 direction */<span></span></pre></td></tr><tr><td scope="row"><pre>    teCenter                    = 1 /*center justify (word alignment) */<span></span></pre></td></tr><tr><td scope="row"><pre>    teFlushRight                = -1 /*flush right for all scripts */<span></span></pre></td></tr><tr><td scope="row"><pre>kActionTextTrackSetHilite = 12300 /* (long startHighlight, long<span></span></pre></td></tr><tr><td scope="row"><pre>endHighlight,<span></span></pre></td></tr><tr><td scope="row"><pre>ModifierTrackGraphicsModeRecord highlightColor ) */<span></span></pre></td></tr></table></div><p>Highlights from the <code>startHighlight</code> offset to the <code>endHighlight</code> offset. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionTextTrackSetDropShadow = 12301 /* (Point dropShadow, short<span></span></pre></td></tr><tr><td scope="row"><pre>transparency ) */<span></span></pre></td></tr></table></div><p>Sets the drop shadow parameters. This only works if <code>displayFlags</code> has been set with <code>dfDropShadow</code>. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionTextTrackSetDisplayFlags = 12302 /* (long flags ) */<span></span></pre></td></tr></table></div><p>Sets the text display flags as in:</p><div class="codesample"><table><tr><td scope="row"><pre>    dfDontDisplay               = 1 &lt;&lt; 0    /* Don't display the text*/<span></span></pre></td></tr><tr><td scope="row"><pre>    dfDontAutoScale             = 1 &lt;&lt; 1    /* Don't scale text as track                                             bounds grows or shrinks*/<span></span></pre></td></tr><tr><td scope="row"><pre>    dfClipToTextBox             = 1 &lt;&lt; 2    /* Clip update to the textbox*/<span></span></pre></td></tr><tr><td scope="row"><pre>    dfUseMovieBGColor           = 1 &lt;&lt; 3    /* Set text background to                                             movie's background color*/<span></span></pre></td></tr><tr><td scope="row"><pre>    dfShrinkTextBoxToFit        = 1 &lt;&lt; 4    /* Compute minimum box to fit<span></span></pre></td></tr><tr><td scope="row"><pre>                                            the sample*/<span></span></pre></td></tr><tr><td scope="row"><pre>    dfScrollIn                  = 1 &lt;&lt; 5    /* Scroll text in until<span></span></pre></td></tr><tr><td scope="row"><pre>                                            last of text is in view */<span></span></pre></td></tr><tr><td scope="row"><pre>    dfScrollOut                 = 1 &lt;&lt; 6    /* Scroll text out until last<span></span></pre></td></tr><tr><td scope="row"><pre>                                            of text is gone (if both set,<span></span></pre></td></tr><tr><td scope="row"><pre>                                            scroll in then out)*/<span></span></pre></td></tr><tr><td scope="row"><pre>    dfHorizScroll               = 1 &lt;&lt; 7    /* Scroll text horizontally<span></span></pre></td></tr><tr><td scope="row"><pre>                                             (otherwise it's vertical)*/<span></span></pre></td></tr><tr><td scope="row"><pre>    dfReverseScroll             = 1 &lt;&lt; 8    /* vert: scroll down rather<span></span></pre></td></tr><tr><td scope="row"><pre>                                            than up; horiz: scroll<span></span></pre></td></tr><tr><td scope="row"><pre>                                            backwards<span></span></pre></td></tr><tr><td scope="row"><pre>                                            (justfication  dependent)*/<span></span></pre></td></tr><tr><td scope="row"><pre>    dfContinuousScroll          = 1 &lt;&lt; 9    * new samples cause previous<span></span></pre></td></tr><tr><td scope="row"><pre>                                            samples to scroll out */<span></span></pre></td></tr><tr><td scope="row"><pre>    dfFlowHoriz                 = 1 &lt;&lt; 10   /* horiz scroll text flows in<span></span></pre></td></tr><tr><td scope="row"><pre>                                            textbox rather than extend to<span></span></pre></td></tr><tr><td scope="row"><pre>                                            right */<span></span></pre></td></tr><tr><td scope="row"><pre>    dfContinuousKaraoke         = 1 &lt;&lt; 11   /* ignore begin offset, hilite<span></span></pre></td></tr><tr><td scope="row"><pre>                                            everything up to the end<span></span></pre></td></tr><tr><td scope="row"><pre>                                            offset(karaoke)*/<span></span></pre></td></tr><tr><td scope="row"><pre>    dfDropShadow                = 1 &lt;&lt; 12   /* display text with a drop<span></span></pre></td></tr><tr><td scope="row"><pre>                                            shadow */<span></span></pre></td></tr><tr><td scope="row"><pre>    dfAntiAlias                 = 1 &lt;&lt; 13   /* attempt to display text<span></span></pre></td></tr><tr><td scope="row"><pre>                                            anti aliased*/<span></span></pre></td></tr><tr><td scope="row"><pre>    dfKeyedText                 = 1 &lt;&lt; 14   /* key the text over<span></span></pre></td></tr><tr><td scope="row"><pre>                                            background*/<span></span></pre></td></tr><tr><td scope="row"><pre>    dfInverseHilite             = 1 &lt;&lt; 15   /* Use inverse hiliting rather<span></span></pre></td></tr><tr><td scope="row"><pre>                                            than using<span></span></pre></td></tr><tr><td scope="row"><pre>    dfTextColorHilite           = 1 &lt;&lt; 16   /* changes text color in place<span></span></pre></td></tr><tr><td scope="row"><pre>                                            of hiliting. */<span></span></pre></td></tr><tr><td scope="row"><pre>kActionTextTrackSetScroll= 12303,/* (long delay ) */<span></span></pre></td></tr></table></div><p>Sets the time delay for start of the scroll. This only works when scroll flags are set in <code>displayFlags</code>. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionTextTrackRelativeScroll = 12304 /* (short deltaX, short deltaY ) */<span></span></pre></td></tr></table></div><p>Scrolls the text in the text box by the delta amounts. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionTextTrackFindText = 12305 /* (long flags, Str255 theText,<span></span></pre></td></tr><tr><td scope="row"><pre>                                    ModifierTrackGraphicsModeRecord<span></span></pre></td></tr><tr><td scope="row"><pre>                                    highlightColor ) */<span></span></pre></td></tr></table></div><p>Finds text in the track. Similar in operation to <code>TextMediaFindNextText</code> since this is what it uses. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionTextTrackSetHyperTextFace = 12306/* (short index, long fontFace ) */<span></span></pre></td></tr></table></div><p>Sets the text face (style) of the indexed hypertext. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionTextTrackSetHyperTextColor = 12307 /* (short index,<span></span></pre></td></tr><tr><td scope="row"><pre>                                    ModifierTrackGraphicsModeRecord<span></span></pre></td></tr><tr><td scope="row"><pre>                                    highlightColor ) */<span></span></pre></td></tr></table></div><p>Sets the text color of the indexed hypertext. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionTextTrackKeyEntry = 12308 /* (short character ) */<span></span></pre></td></tr></table></div><p>Replaces the selection with the character. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionTextTrackMouseDown = 12309 /* no params */<span></span></pre></td></tr></table></div><p>Passes the mouse click to the text track, which allows for selecting text or an insertion point when <code>kKeyEntryScript</code> is turned on. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionTextTrackSetEditable = 12310 /* (short editState) */<span></span></pre></td></tr></table></div><p>Controls the key entry state of the text track: </p><div class="codesample"><table><tr><td scope="row"><pre>    #define kKeyEntryDisabled       0<span></span></pre></td></tr><tr><td scope="row"><pre>    #define kKeyEntryDirect         1<span></span></pre></td></tr><tr><td scope="row"><pre>    #define kKeyEntryScript         2<span></span></pre></td></tr></table></div><p><code>kKeyEntryDisabled</code> is default. </p><p>If <code>kKeyEntryDirect</code> is on, then key events are passed directly to the text track. </p><p>If <code>kKeyEntryScript</code> is on, then scripted mouse and key events are allowed. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionListAddElement = 13312 /* (C string parentPath, short atIndex, C<span></span></pre></td></tr><tr><td scope="row"><pre>                            string newElementName) */<span></span></pre></td></tr></table></div><p>Adds the element to the target list. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionListRemoveElements = 13313 /* (C string parentPath, short startIndex,  short endIndex) */<span></span></pre></td></tr></table></div><p>Removes the element from the target list. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionListSetElementValue = 13314 /* (C string elementPath, C string<span></span></pre></td></tr><tr><td scope="row"><pre>                                    valueString) */<span></span></pre></td></tr></table></div><p>Sets the list element value. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionListPasteFromXML = 13315 /* (C string xml, C string targetParentPath,<span></span></pre></td></tr><tr><td scope="row"><pre>                                    short startIndex) */<span></span></pre></td></tr></table></div><p>Pastes an XML-formatted list into the target list at <code>startIndex</code>. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionListSetMatchingFromXML = 13316 /* (C string xml, C string<span></span></pre></td></tr><tr><td scope="row"><pre> targetParentPath) */<span></span></pre></td></tr></table></div><p>Replaces the matching element values in the target list.</p><div class="codesample"><table><tr><td scope="row"><pre>kActionListSetMatchingFromXML = 13316 /* (C string xml, C string<span></span></pre></td></tr><tr><td scope="row"><pre>                                        targetParentPath) */<span></span></pre></td></tr></table></div><p>Replaces the matching element values in the target list.</p><div class="codesample"><table><tr><td scope="row"><pre>kActionTrackSetIdleFrequency = 2056 /* (long frequency) */<span></span></pre></td></tr></table></div><p>Allows changing the idle frequency, i.e., the time between successive calls to idle handlers, of sprite and text tracks. The range is from -1 to max unsigned long. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionQTVREnableHotSpot = 4101 /* long ID, Boolean enable */<span></span></pre></td></tr></table></div><p>Enables or disables a QuickTime VR hot spot by id. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionQTVRShowHotSpots = 4102 /* Boolean show */<span></span></pre></td></tr></table></div><p>Tells the QuickTime VR controller to show/hide all hots spots, same as clicking on the button in the controller. </p><div class="codesample"><table><tr><td scope="row"><pre>kActionQTVRTranslateObject  = 4103 /* float xMove, float yMove *<span></span></pre></td></tr></table></div><p>Moves a QuickTime VR object in the direction specified by the parameters. </p><a name="//apple_ref/doc/uid/TP40000883-CH207-TPXREF130" title="New Wired Operands"></a><h3>New Wired Operands</h3><div class="codesample"><table><tr><td scope="row"><pre>kOperandEventParameter = 26         /* short index */<span></span></pre></td></tr></table></div><p>Allows key and mouse event handlers to get parameters of the triggered event. </p><p>For the mouse: </p><div class="codesample"><table><tr><td scope="row"><pre>        1 : where.h<span></span></pre></td></tr><tr><td scope="row"><pre>        2 : where.v<span></span></pre></td></tr><tr><td scope="row"><pre>        3 : modifiers<span></span></pre></td></tr></table></div><p>For the key: </p><div class="codesample"><table><tr><td scope="row"><pre>        1 : where.h<span></span></pre></td></tr><tr><td scope="row"><pre>        2 : where.v<span></span></pre></td></tr><tr><td scope="row"><pre>        3 : modifiers<span></span></pre></td></tr><tr><td scope="row"><pre>        4 : key<span></span></pre></td></tr><tr><td scope="row"><pre>        5 : scancode<span></span></pre></td></tr><tr><td scope="row"><pre>kOperandFreeMemory = 27<span></span></pre></td></tr></table></div><p>Returns the amount of memory free in the application heap. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandNetworkStatus = 28<span></span></pre></td></tr></table></div><p>Returns the status code of the network connection:</p><div class="codesample"><table><tr><td scope="row"><pre>    kQTNetworkStatusNoNetwork   = -2<span></span></pre></td></tr><tr><td scope="row"><pre>    kQTNetworkStatusUncertain   = -1<span></span></pre></td></tr><tr><td scope="row"><pre>    kQTNetworkStatusNotConnected = 0<span></span></pre></td></tr><tr><td scope="row"><pre>    kQTNetworkStatusConnected   = 1<span></span></pre></td></tr><tr><td scope="row"><pre>    kOperandMovieDuration  = 1029<span></span></pre></td></tr></table></div><p>Returns the duration of the target movie. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandMovieTimeScale = 1030<span></span></pre></td></tr></table></div><p>Returns the timescale of the target movie. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandMovieWidth = 1031<span></span></pre></td></tr></table></div><p>Returns the current width of the target movie. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandMovieHeight = 1032<span></span></pre></td></tr></table></div><p>Returns the current height of the target movie. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandMovieLoadState = 1033<span></span></pre></td></tr></table></div><p>Returns the load state of the target movie. &lt;0 indicates an error. </p><div class="codesample"><table><tr><td scope="row"><pre>    kMovieLoadStateLoading      = 1000<span></span></pre></td></tr><tr><td scope="row"><pre>    kMovieLoadStatePlayable     = 10000<span></span></pre></td></tr><tr><td scope="row"><pre>    kMovieLoadStatePlaythroughOK = 20000<span></span></pre></td></tr><tr><td scope="row"><pre>    kMovieLoadStateComplete     = 100000L<span></span></pre></td></tr><tr><td scope="row"><pre>    kOperandMovieTrackCount   = 1034<span></span></pre></td></tr></table></div><p>Returns the track count of the target movie. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandTrackWidth = 2052<span></span></pre></td></tr></table></div><p>Returns the current width of the target track. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandTrackHeight = 2053<span></span></pre></td></tr></table></div><p>Returns the current height of the target track. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandTrackDuration = 2054<span></span></pre></td></tr></table></div><p>Returns the duration of the target track. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandSpriteTrackSpriteIDAtPoint = 3094,/* short x, short y */<span></span></pre></td></tr></table></div><p>Returns the ID of the sprite that would be hit at the point where a mouse click occurred in the target sprite. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandTextTrackEditable = 6144<span></span></pre></td></tr></table></div><p>Returns the current key entry state of the target text track. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandTextTrackCopyText = 6145/* long startSelection, long endSelection                                     */<span></span></pre></td></tr></table></div><p>Returns the selection range as a string of the target text track. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandTextTrackStartSelection = 6146<span></span></pre></td></tr></table></div><p>Returns the current starting selection point of the target text track. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandTextTrackEndSelection = 6147<span></span></pre></td></tr></table></div><p>Returns the current ending selection point of the target text track. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandTextTrackTextBoxLeft = 6148<span></span></pre></td></tr></table></div><p>Returns the left edge of the text box of target text track in text track coordinates. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandTextTrackTextBoxTop = 6149<span></span></pre></td></tr></table></div><p>Returns the top edge of the text box of target text track in text track coordinates. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandTextTrackTextBoxRight = 6150<span></span></pre></td></tr></table></div><p>Returns the right edge of the text box of target text track in text track coordinates. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandTextTrackTextBoxBottom = 6151<span></span></pre></td></tr></table></div><p>Returns the bottom edge of the text box of the target text track in text track coordinates. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandListCountElements = 7168/* (C string parentPath) */<span></span></pre></td></tr></table></div><p>Returns the number of elements in the target list. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandListGetElementPathByIndex = 7169/* (C string parentPath, short index) */<span></span></pre></td></tr></table></div><p>Returns the name string of the element found a <code>parentPath</code> and the index of the target list. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandListGetElementValue = 7170 /* (C string elementPath) */<span></span></pre></td></tr></table></div><p>Returns the value of the element at <code>elementPath</code> of the target list. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandListCopyToXML= 7171     /* (C string parentPath, short                                     startIndex, short endIndex) */<span></span></pre></td></tr></table></div><p>Returns the selection of the target list as a XML-formatted string. </p><p>Note that the following math functions map directly to the math functions in the Macintosh interface, with the exception of <code><!--a  -->kOperandDegreesToRadians<!--/a--></code> and <code><!--a  -->kOperandRadiansToDegrees<!--/a--></code>, which are specific to QuickTime VR. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandSin                 = 8192          /* float x  */<span></span></pre></td></tr><tr><td scope="row"><pre>kOperandCos                 = 8193          /* float x  */<span></span></pre></td></tr><tr><td scope="row"><pre>kOperandTan                 = 8194          /* float x  */<span></span></pre></td></tr><tr><td scope="row"><pre>kOperandATan                = 8195          /* float x  */<span></span></pre></td></tr><tr><td scope="row"><pre>kOperandATan2               = 8196      /* float y, float x */<span></span></pre></td></tr><tr><td scope="row"><pre>kOperandDegreesToRadians    = 8197          /* float x */<span></span></pre></td></tr><tr><td scope="row"><pre>kOperandRadiansToDegrees    = 8198          /* float x */<span></span></pre></td></tr><tr><td scope="row"><pre>kOperandSquareRoot          = 8199          /* float x */<span></span></pre></td></tr><tr><td scope="row"><pre>kOperandExponent            = 8200          /* float x */<span></span></pre></td></tr><tr><td scope="row"><pre>kOperandLog                 = 8201          /* float x */<span></span></pre></td></tr><tr><td scope="row"><pre>kOperandFlashTrackVariable  = 9216      /* [CString path, CString name] */<span></span></pre></td></tr></table></div><p>Returns the value of the Flash variable in the target Flash track. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandSystemVersion = 30<span></span></pre></td></tr></table></div><p>This returns the Mac version. On Windows, it currently returns 0.</p><div class="codesample"><table><tr><td scope="row"><pre>kOperandMovieIsActive = 1035<span></span></pre></td></tr><tr><td scope="row"><pre>kOperandStringLength = 10240 /* (C string text) */<span></span></pre></td></tr><tr><td scope="row"><pre>kOperandStringCompare = 10241 /* (C string aText, C string bText, Boolean<span></span></pre></td></tr><tr><td scope="row"><pre>                                    caseSensitive, Boolan diacSensitive) */<span></span></pre></td></tr></table></div><p>Returns 0 for false, non-zero for true, indicating if the text is equivalent.</p><div class="codesample"><table><tr><td scope="row"><pre>kOperandStringSubString = 10242 /* (C string text, long offset, long                                     length) */<span></span></pre></td></tr></table></div><p>Returns substring of text starting at 0-based offset 'offset' for length 'length'.</p><div class="codesample"><table><tr><td scope="row"><pre>kOperandStringConcat = 10243     /* (C string aText, C string bText) */<span></span></pre></td></tr></table></div><p>Returns string produced by concatenating aText with bText. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandQuickTimeVersionRegistered<span></span></pre></td></tr></table></div><p>This allows the scripter to verify that specific versions of QuickTime have been registered. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandMovieName = 1036<span></span></pre></td></tr></table></div><p>Gets the target movie name, if any, stored in the user data as type 'plug' with data "moviename=theActualMovieName"</p><div class="codesample"><table><tr><td scope="row"><pre>kOperandMovieID             = 1037<span></span></pre></td></tr></table></div><p>Gets the target movie name, if any, stored in the user data as type 'plug' with data "pmovieid=##". </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandTrackName           = 2055<span></span></pre></td></tr></table></div><p>Gets the target track name stored in track user data as type 'name'. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandTrackID             = 2056<span></span></pre></td></tr></table></div><p>Gets the target track ID. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandTrackIdleFrequency  = 2057<span></span></pre></td></tr></table></div><p>Gets the target track’s current idle frequency––only sprite and text currently. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandSpriteName = 3095<span></span></pre></td></tr></table></div><p>Gets the target sprite name. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandQTVRHotSpotsVisible = 4100<span></span></pre></td></tr></table></div><p>Returns whether the QuickTime VR controller is displaying the hot spots. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandQTVRViewCenterH = 4101<span></span></pre></td></tr></table></div><p>Returns the view centerH of an QuickTime VR object controller. </p><div class="codesample"><table><tr><td scope="row"><pre>kOperandQTVRViewCenterV = 4102<span></span></pre></td></tr></table></div><p>Returns the view centerH of an QuickTime VR object controller. </p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../introwiredsprites/2-Intro-Wired-Sprites.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../authoringwiredmovies/4-Authoring-Wired-Movies.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2003, 2002 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2002-10-01<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/QuickTime/IQ_InteractiveMovies/spritemediahandler/3-Sprite-Media-Handler.html%3Fid%3DTP40000883-2.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/QuickTime/IQ_InteractiveMovies/spritemediahandler/3-Sprite-Media-Handler.html%3Fid%3DTP40000883-2.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/QuickTime/IQ_InteractiveMovies/spritemediahandler/3-Sprite-Media-Handler.html%3Fid%3DTP40000883-2.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>