<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Handling the Get AETE Event(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING307></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-306.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-308.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-299.html"><B>Chapter 8 - Apple Event Terminology Resources</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING307-0></A>
<H1><A NAME=MARKER-9-50></A>Handling the Get AETE Event</H1>
 <A NAME=MARKER-2-200></A><A NAME=MARKER-9-209></A>A scripting component sends the Get AETE event to an application when it needs information about the user terminology specified by the application. For example, the AppleScript component sends the Get AETE event when it first attempts to compile a <CODE>tell</CODE> statement that specifies a particular application. If your application does not handle the Get AETE event, the scripting component reads the terminology information it needs directly from your application's <CODE>'aete'</CODE> resource. Applications that support additional plug-in modules, each with its own <CODE>'aete'</CODE> resource, must provide an <CODE>'scsz'</CODE> resource and a handler for the Get AETE event that collects the <CODE>'aete'</CODE> resources from the modules that are currently running.<P>
 If your application does provide separate plug-in modules, the Get AETE event allows it to gather information from the <CODE>'aete'</CODE> resources for the modules that are currently running and return the terminology information along with your application's built-in terminology information to the scripting component in the reply event.<P>
 Here is a summary of the structure of a Get AETE event:
<TABLE BORDER="0" CELLPADDING=3><TH colspan=3>Get AETE--Get an application's <CODE>'aete'</CODE> resource<TR>
<TD colspan=2>Event class<TD>kASAppleScriptClass<TR>
<TD colspan=2>Event ID<TD>kGetAETE<TR>
<TD colspan=2>Required parameter<TD>&nbsp;<TR>
<TD>&nbsp;<TD>Keyword:<TD><CODE>keyDirectObject</CODE><TR>
<TD>&nbsp;<TD>Descriptor type:<TD><CODE>typeInteger</CODE><TR>
<TD>&nbsp;<TD>Data:<TD>Language code<TR>
<TD colspan=2>Required reply parameter<TD>&nbsp;<TR>
<TD>&nbsp;<TD>Keyword:<TD><CODE>keyDirectObject</CODE><TR>
<TD>&nbsp;<TD>Descriptor type:<TD><CODE>typeAEList</CODE> or <CODE>typeAETE</CODE><TR>
<TD>&nbsp;<TD>Data:<TD>The application's terminologies<TR>
<TD colspan=2>Description<TD>Sent by a scripting component to an application when the scripting component needs information about the application's user terminology</TABLE>
 <P>
 Your application can't handle the Get AETE event unless it is running. If your application doesn't provide a handler for the Get AETE event, the scripting component can obtain terminology information directly from your application's <CODE>'aete'</CODE> resource even if your application is not running.<P>
 If your application handles the Get AETE event, it must also provide a scripting size resource. A scripting size resource is a resource of type <CODE>'scsz'</CODE> that provides information about an application's capabilities for use by scripting components. It allows your application to declare whether it needs the Get AETE event and to specify preferences for the sizes of the portion of your application's heap used by a scripting component. For information about the <CODE>'scsz'</CODE> resource, see <A HREF=IAC-315.html#MARKER-9-90>"The Scripting Size Resource" on page 8-45</A>. <P>
 A handler for the Get AETE event should perform the following tasks:<P>
<UL>
<LI>Obtain the language code specified by the event.
<LI>Create a descriptor list to hold the <CODE>'aete'</CODE> resources.
<LI>Collect the <CODE>'aete'</CODE> resources from all the application's plug-in modules that are currently running, including the application itself, and add them to the list. 
<LI>Add the list to the reply Apple event.<P>
</UL>
 <A HREF=#MARKER-9-53>Listing 8-4</A> provides an example of a handler for the Get AETE event. <P>
<B>Listing 8-4  <A NAME=MARKER-9-53></A>A handler for the Get AETE event <A NAME=MARKER-9-91></A></B><P>
<PRE>
FUNCTION MyGetAETE (theAE: AppleEvent; theReply: AppleEvent; 
                     refCon: LongInt): OSErr;
VAR
   theList:       AEDescList;
   returnedType:  DescType;
   actualSize:    Size;
   languageCode:  Integer;
   myErr:         OSErr;
BEGIN
   MyGetAETE := errAEEventNotHandled;
   languageCode := 0;
   {if a reply was not requested, then don't handle}
   IF theReply.dataHandle = NIL THEN
      Exit(MyGetAETE);
   {get the language code that AppleScript is requesting so that }
   { this function can return the aete of a specified language}
   myErr := AEGetParamPtr(theAE, keyDirectObject, 
                           typeLongInteger, returnedType, 
                           @languageCode, sizeOf(LongInt), 
                           actualSize);
   IF myErr &lt;&gt; noErr THEN
      Exit(MyGetAETE);
   {create a list}
   myErr := AECreateList(NIL, 0, FALSE, theList);
   IF myErr &lt;&gt; noErr THEN
      Exit(MyGetAETE);
   {get the requested 'aete' resources and put in the list--the }
   { MyGrabAETE application-defined function does this}
   {your code should iterate all of your installed code }
   { extensions and add the aete for each that matches the }
   { language code requested}
   myErr := MyGrabAETE(languageCode, theList);
   IF myErr &lt;&gt; noErr THEN
   BEGIN
      myErr := AEDisposeDesc(theList);
      Exit(MyGetAETE);
   END;
   {add list to reply Apple event}
   myErr := AEPutParamDesc(theReply, keyDirectObject, theList);
   myErr := AEDisposeDesc(theList);
   myGetAETE := myErr;
END;
</PRE>
 The <CODE>MyGetAETE</CODE> handler in <A HREF=#MARKER-9-53>Listing 8-4</A> begins by setting the function result to <CODE>errAEEventNotHandled</CODE>. The function is set to this result if for any reason the handler doesn't successfully handle the event, so that a system handler provided by the scripting component can at least read the terminology information directly from the application's own <CODE>'aete'</CODE> resource. The handler in <A HREF=#MARKER-9-53>Listing 8-4</A> then checks the language code specified by the event. After checking to make sure the reply exists, the handler creates a list and uses the application-defined function <CODE>MyGrabAETE</CODE> to collect all the appropriate terminology information and append it to the list. The <CODE>MyGetAETE</CODE> handler then adds the list to the reply event. <A NAME=MARKER-9-59></A> <A NAME=MARKER-2-56></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-306.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-308.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
