<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/1998/REC-html40-19980424/loose.dtd">
<html>
<head>
<title>IOBufferMemoryDescriptor</title>
<meta http-equiv="Content-Type" content="text/html; charset=ascii">
<meta name="generator" content="HeaderDoc">
<style><!--
#tocMenu {
		display: block;
		position:fixed;
		top:0px;
		left:0px;
		width:210px;
		height:100%;
		background:transparent;
}
#bodyText {
		margin-left: 210px;
}
--></style>
<meta id="toc-file" name="toc-file" content="toc.html">
<script language="JavaScript" src="../../../../../../Resources/JavaScript/page.js" type="text/javascript"></script><link rel="stylesheet" type="text/css" href="../../../../../../Resources/CSS/frameset_styles.css">
<style type="text/css"><!--.keyword {background:#ffffff; color:#761550;}.template {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.function {background:#ffffff; color:#000000;}.string {background: #ffffff; color:#891315;}.preprocessor {background:#ffffff; color:#236e25}.comment {background:#ffffff; color:#236e25}.char {background: #ffffff; color:#0000ff;}.var {background:#ffffff; color:#000000;}.type {background:#ffffff; color:#761550;}.param {background:#ffffff; color:#000000;}.graybox {         border-top: 1px solid #919699;         border-left: 1px solid #919699;         margin-bottom: 10px;         }  .graybox th {         padding: 4px 8px 4px 8px;         background: #E2E2E2;         font-size: 12px;         font-weight: bold;         border-bottom: 1px solid #919699;         border-right: 1px solid #919699;         }  .graybox td {         padding: 8px;         font-size: 12px;         text-align: left;         vertical-align: top;         border-bottom: 1px solid #919699;         border-right: 1px solid #919699;         }  --></style>
</head>
<body bgcolor="#ffffff" onload="initialize_page();">
<noscript>
<div id="tocMenu">
<iframe id="toc_content" name="toc_content" src="toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
</div>
</noscript>
<div id="bodyText">
<!-- start of header -->

<!-- start of header -->
<!--#include virtual="/includes/framesetheader"-->
<!-- end of header -->

<table width="600"><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <a href="../../../../../../../reference/Darwin/index.html#//apple_ref/doc/uid/TP30001281-TP30000422" target="_top">Darwin</a> <b>&gt;</b> <a href="../../../index.html#//apple_ref/doc/framework/kernel_fw_leo" target="_top">Kernel Framework Reference</a></font>
<!-- end breadcrumb insert request -->
<p>&#160;</p>
</td></tr></table>
<!-- end of header --><a name="top"></a>
<a name="//apple_ref/doc/class/IOBufferMemoryDescriptor" title="IOBufferMemoryDescriptor"></a>
<hr>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h1><a name="IOBufferMemoryDescriptor">IOBufferMemoryDescriptor</a></h1>
</td></tr></table>
<div class="spec_sheet_info_box"><table cellspacing="0" class="specbox">
<tr>
<td scope="row"><b>Inherits from:</b></td>
<td><div style="margin-bottom:1px"><div class="content_text">
<!-- a -->IOGeneralMemoryDescriptor<!-- /a -->
</div></div></td>
</tr>
<tr>
<td scope="row"><b>Declared In:</b></td>
<td><div style="margin-bottom:1px"><div class="content_text"><a href="../../index.html" target="_top">IOBufferMemoryDescriptor.h</a></div></div></td>
</tr>
</table></div>
<h2>Overview</h2>
<p><!-- begin abstract --></p>
<p>Provides a simple memory descriptor that allocates its own buffer memory.
<!-- end abstract --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Beginning in Mac OS X v10.2, <code>IOBufferMemoryDescriptor</code> allows a buffer to be allocated in any task for I/O or sharing through mapping. In particular, it is recommended that you use the <code>IOBufferMemoryDescriptor</code> functions to allocate buffers for use with I/O requested by non-kernel clients. In this way, the kernel controls the allocation method, which ensures that the buffer is allocated in accordance with internal guidelines dictated by the virtual memory system. 
</p>
<p>For software running in Mac OS X v10.2 and later, Apple recommends that
</p>
<ul>
<li>User tasks do not use <code>malloc</code> or other user-level library functions to allocate I/O buffers in their own address space.
</li>
<li>User clients use <code>IOBufferMemoryDescriptor</code> objects to represent kernel-allocated buffer instead of the <code>IOMemoryDescriptor</code> objects that represented user task-allocated buffers.</li>
</ul>
<!-- end discussion --><hr>
<br><h2>Functions</h2>
<a name="HeaderDoc_functions"></a>
<dl>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBufferMemoryDescriptor/appendBytes/bool/(constvoid*,vm_size_t)" target="_top">appendBytes</a></tt></dt>
<dd><p>Copies the specified data to the end of the buffer.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBufferMemoryDescriptor/getBytesNoCopy/void*/()" target="_top">getBytesNoCopy()</a></tt></dt>
<dd><p>Gets the virtual address of the beginning of the buffer.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBufferMemoryDescriptor/getBytesNoCopy/void*/(vm_size_t,vm_size_t)" target="_top">getBytesNoCopy(vm_size_t, vm_size_t)</a></tt></dt>
<dd><p>Gets the virtual address of an offset from the beginning of the buffer and with the specified length.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBufferMemoryDescriptor/getCapacity/vm_size_t/()" target="_top">getCapacity</a></tt></dt>
<dd><p>Gets the memory descriptor's capacity.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBufferMemoryDescriptor/initWithBytes/bool/(constvoid*,vm_size_t,IODirection,bool)" target="_top">initWithBytes</a></tt></dt>
<dd><p>Initializes a memory descriptor with the provided bytes.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBufferMemoryDescriptor/initWithOptions/bool/(IOOptionBits,vm_size_t,vm_offset_t)" target="_top">initWithOptions</a></tt></dt>
<dd><p>Initializes a memory descriptor with the specified options.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/clm/IOBufferMemoryDescriptor/inTaskWithOptions/IOBufferMemoryDescriptor*/(task_t,IOOptionBits,vm_size_t,vm_offset_t)" target="_top">inTaskWithOptions</a></tt></dt>
<dd><p>Creates a memory buffer with memory descriptor for that buffer.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/clm/IOBufferMemoryDescriptor/inTaskWithPhysicalMask/IOBufferMemoryDescriptor*/(task_t,IOOptionBits,mach_vm_size_t,mach_vm_address_t)" target="_top">inTaskWithPhysicalMask</a></tt></dt>
<dd><p>Creates a memory buffer with memory descriptor for that buffer. 
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBufferMemoryDescriptor/setDirection/void/(IODirection)" target="_top">setDirection</a></tt></dt>
<dd><p>Changes the transfer direction of the memory descriptor.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOBufferMemoryDescriptor/setLength/void/(vm_size_t)" target="_top">setLength</a></tt></dt>
<dd><p>Changes the buffer length of the memory descriptor.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/clm/IOBufferMemoryDescriptor/withBytes/IOBufferMemoryDescriptor*/(constvoid*,vm_size_t,IODirection,bool)" target="_top">withBytes</a></tt></dt>
<dd><p>Creates a memory descriptor preloaded (copied) with the provided bytes.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/clm/IOBufferMemoryDescriptor/withCapacity/IOBufferMemoryDescriptor*/(vm_size_t,IODirection,bool)" target="_top">withCapacity</a></tt></dt>
<dd><p>Creates a memory descriptor with a buffer of the specified size.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/clm/IOBufferMemoryDescriptor/withOptions/IOBufferMemoryDescriptor*/(IOOptionBits,vm_size_t,vm_offset_t)" target="_top">withOptions</a></tt></dt>
<dd><p>Creates a memory descriptor with the specified options and with a buffer of the specified size.
</p></dd>
</dl>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBufferMemoryDescriptor/appendBytes/bool/(constvoid*,vm_size_t);   name=IOBufferMemoryDescriptor::appendBytes --><a name="//apple_ref/cpp/instm/IOBufferMemoryDescriptor/appendBytes/bool/(constvoid*,vm_size_t)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="appendBytes">appendBytes</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Copies the specified data to the end of the buffer.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="function">appendBytes</span><!-- /a -->(
    <span class="keyword">const</span> <!-- a --><span class="var">void</span><!-- /a --> <span class="var">*</span><!-- a --><span class="var">bytes</span><!-- /a -->,
    <!-- a --><span class="var">vm_size_t</span><!-- /a --> <!-- a --><span class="var">withLength</span><!-- /a -->); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>bytes</code></dt>
<dd><p>The data to copy.</p></dd>
<dt><code>withLength</code></dt>
<dd><p>The size of the data to copy, in bytes.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value --><code>true</code> if the copy was successful; <code>false</code> if the buffer's current length is not valid.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This function automatically maintains the memory descriptor buffer length.  Note that <code>appendBytes</code> will not copy past the end of the memory descriptor's current capacity.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBufferMemoryDescriptor/getBytesNoCopy/void*/();   name=IOBufferMemoryDescriptor::getBytesNoCopy --><a name="//apple_ref/cpp/instm/IOBufferMemoryDescriptor/getBytesNoCopy/void*/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="getBytesNoCopy()">getBytesNoCopy()</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Gets the virtual address of the beginning of the buffer.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><!-- a --><span class="function">getBytesNoCopy</span><!-- /a -->(); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->The virtual address of the beginning of the buffer.

<!-- end return value --></p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBufferMemoryDescriptor/getBytesNoCopy/void*/(vm_size_t,vm_size_t);   name=IOBufferMemoryDescriptor::getBytesNoCopy --><a name="//apple_ref/cpp/instm/IOBufferMemoryDescriptor/getBytesNoCopy/void*/(vm_size_t,vm_size_t)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="getBytesNoCopy(vm_size_t,vm_size_t)">getBytesNoCopy(vm_size_t, vm_size_t)</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Gets the virtual address of an offset from the beginning of the buffer and with the specified length.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><!-- a --><span class="function">getBytesNoCopy</span><!-- /a -->(
    <!-- a --><span class="type">vm_size_t</span><!-- /a --> <span class="param">start</span>,
    <!-- a --><span class="type">vm_size_t</span><!-- /a --> <span class="param">withLength</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>start</code></dt>
<dd><p>The offset into the buffer.</p></dd>
<dt><code>withLength</code></dt>
<dd><p>The length of the data.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->The virtual address of the specified offset from the beginning of the buffer or <code>0</code> if the offset or length are not valid.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This function will fail if the offset is equal to or greater than the current length of the buffer or if the range represented by the offset plus the specified length is greater than the current length of the buffer.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBufferMemoryDescriptor/getCapacity/vm_size_t/();   name=IOBufferMemoryDescriptor::getCapacity --><a name="//apple_ref/cpp/instm/IOBufferMemoryDescriptor/getCapacity/vm_size_t/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="getCapacity">getCapacity</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Gets the memory descriptor's capacity.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">vm_size_t</span><!-- /a --> <!-- a --><span class="function">getCapacity</span><!-- /a -->() <span class="keyword">const</span>; </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->The size of the memory descriptor's capacity, in bytes.

<!-- end return value --></p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBufferMemoryDescriptor/initWithBytes/bool/(constvoid*,vm_size_t,IODirection,bool);   name=IOBufferMemoryDescriptor::initWithBytes --><a name="//apple_ref/cpp/instm/IOBufferMemoryDescriptor/initWithBytes/bool/(constvoid*,vm_size_t,IODirection,bool)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="initWithBytes">initWithBytes</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Initializes a memory descriptor with the provided bytes.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="function">initWithBytes</span><!-- /a -->(
    <span class="keyword">const</span> <!-- a --><span class="var">void</span><!-- /a --> <span class="var">*</span> <!-- a --><span class="var">bytes</span><!-- /a -->, 
    <!-- a --><span class="var">vm_size_t</span><!-- /a --> <!-- a --><span class="var">withLength</span><!-- /a -->, 
    <!-- a --><span class="var">IODirection</span><!-- /a --> <!-- a --><span class="var">withDirection</span><!-- /a -->, 
    <!-- a --><span class="var">bool</span><!-- /a --> <!-- a --><span class="var">withContiguousMemory</span><!-- /a --> = <!-- a --><span class="var">false</span><!-- /a -->); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>bytes</code></dt>
<dd><p>The data to copy into the buffer.</p></dd>
<dt><code>withLength</code></dt>
<dd><p>The size of the data to copy into the buffer, in bytes.</p></dd>
<dt><code>withDirection</code></dt>
<dd><p>An I/O direction to be associated with the descriptor, which may affect the operation of the <!-- a -->IOMemoryDescriptor::prepare<!-- /a --> and <!-- a -->IOMemoryDescriptor::complete<!-- /a --> methods on some architectures.</p></dd>
<dt><code>withContiguousMemory</code></dt>
<dd><p>If <code>true</code>, the buffer is initialized with a minimum required alignment of the buffer taken from the value of the <code>capacity</code> parameter; if <code>false</code>, the buffer is initialized with no required alignment.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value --><code>true</code> if the initialization was successful; <code>false</code> otherwise.

<!-- end return value --></p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBufferMemoryDescriptor/initWithOptions/bool/(IOOptionBits,vm_size_t,vm_offset_t);   name=IOBufferMemoryDescriptor::initWithOptions --><a name="//apple_ref/cpp/instm/IOBufferMemoryDescriptor/initWithOptions/bool/(IOOptionBits,vm_size_t,vm_offset_t)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="initWithOptions">initWithOptions</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Initializes a memory descriptor with the specified options.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="function">initWithOptions</span><!-- /a -->(
    <a href="../../../USB_h/index.html#//apple_ref/c/tag/IOOptionBits" target="_top" class="type"><span class="type">IOOptionBits</span></a> <span class="param">options</span>, 
    <!-- a --><span class="type">vm_size_t</span><!-- /a --> <span class="param">capacity</span>, 
    <!-- a --><span class="type">vm_offset_t</span><!-- /a --> <span class="param">alignment</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>options</code></dt>
<dd><p>See <a href="index.html#//apple_ref/cpp/clm/IOBufferMemoryDescriptor/inTaskWithOptions/IOBufferMemoryDescriptor*/(task_t,IOOptionBits,vm_size_t,vm_offset_t)" target="_top">inTaskWithOptions</a> for possible values.</p></dd>
<dt><code>capacity</code></dt>
<dd><p>The number of bytes to allocate.</p></dd>
<dt><code>alignment</code></dt>
<dd><p>The minimum required alignment of the buffer in bytes (1 is the default for no required alignment). For example, pass 256 to get memory allocated at an address with bits 0-7 zero.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value --><code>true</code> if the initialization was successful; <code>false</code> otherwise.

<!-- end return value --></p>
<p></p>
<hr>
<!-- headerDoc=clm;  uid=//apple_ref/cpp/clm/IOBufferMemoryDescriptor/inTaskWithOptions/IOBufferMemoryDescriptor*/(task_t,IOOptionBits,vm_size_t,vm_offset_t);   name=IOBufferMemoryDescriptor::inTaskWithOptions --><a name="//apple_ref/cpp/clm/IOBufferMemoryDescriptor/inTaskWithOptions/IOBufferMemoryDescriptor*/(task_t,IOOptionBits,vm_size_t,vm_offset_t)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="inTaskWithOptions">inTaskWithOptions</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Creates a memory buffer with memory descriptor for that buffer.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">static</span> <a href="index.html#//apple_ref/cpp/cl/IOBufferMemoryDescriptor" target="_top" class="type"><span class="type">IOBufferMemoryDescriptor</span></a> <span class="type">*</span> <!-- a --><span class="function">inTaskWithOptions</span><!-- /a -->( 
    <!-- a --><span class="type">task_t</span><!-- /a --> <span class="param">inTask</span>, 
    <a href="../../../USB_h/index.html#//apple_ref/c/tag/IOOptionBits" target="_top" class="type"><span class="type">IOOptionBits</span></a> <span class="param">options</span>, 
    <!-- a --><span class="type">vm_size_t</span><!-- /a --> <span class="param">capacity</span>, 
    <!-- a --><span class="type">vm_offset_t</span><!-- /a --> <!-- a --><span class="type">alignment</span><!-- /a --> = <span class="number">1</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>inTask</code></dt>
<dd><p>The task the buffer will be allocated in.</p></dd>
<dt><code>options</code></dt>
<dd>
<p>Options for the allocation:<br></p>
<ul>
<li>
<code>kIODirectionOut</code>, <code>kIODirectionIn</code> - set the direction of the I/O transfer.
</li>
<li>
<code>kIOMemoryPhysicallyContiguous</code> - pass to request memory be physically contiguous. This option is heavily discouraged. The request may fail if memory is fragmented, may cause large amounts of paging activity, and may take a very long time to execute.
</li>
<li>
<code>kIOMemoryPageable</code> - pass to request memory be non-wired (the default for kernel allocated memory is wired).
</li>
<li>
<code>kIOMemoryPurgeable</code> - pass to request memory that may later have its purgeable state set with <!-- a -->IOMemoryDescriptor::setPurgeable<!-- /a -->. Only supported for <code>kIOMemoryPageable</code> allocations.
</li>
<li>
<code>kIOMemoryKernelUserShared</code> - pass to request memory that will be mapped into both the kernel and client applications.</li>
</ul>
</dd>
<dt><code>capacity</code></dt>
<dd><p>The number of bytes to allocate.</p></dd>
<dt><code>alignment</code></dt>
<dd><p>The minimum required alignment of the buffer in bytes (1 is the default for no required alignment). For example, pass 256 to get memory allocated at an address with bits 0-7 zero.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->An instance of class <code>IOBufferMemoryDescriptor</code> to be released by the caller, which will free the memory descriptor and associated buffer. 
<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This function allocates a memory buffer with a given size and alignment in the task's specified address space, and returns a memory descriptor instance representing the memory. It is recommended that memory allocated for I/O or sharing via mapping be created using <code>IOBufferMemoryDescriptor</code>. Options passed with the request specify the kind of memory to be allocated. For example, pageability and sharing are specified with option bits. This function may block and so should not be called from interrupt level or while a simple lock is held.
<!-- end discussion -->
</p>
<p></p>
<dl>
<dt><i>Availability</i></dt>
<dd>Mac OS X v10.2 and above 
</dd>
</dl>
<hr>
<!-- headerDoc=clm;  uid=//apple_ref/cpp/clm/IOBufferMemoryDescriptor/inTaskWithPhysicalMask/IOBufferMemoryDescriptor*/(task_t,IOOptionBits,mach_vm_size_t,mach_vm_address_t);   name=IOBufferMemoryDescriptor::inTaskWithPhysicalMask --><a name="//apple_ref/cpp/clm/IOBufferMemoryDescriptor/inTaskWithPhysicalMask/IOBufferMemoryDescriptor*/(task_t,IOOptionBits,mach_vm_size_t,mach_vm_address_t)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="inTaskWithPhysicalMask">inTaskWithPhysicalMask</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Creates a memory buffer with memory descriptor for that buffer. 
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">static</span> <a href="index.html#//apple_ref/cpp/cl/IOBufferMemoryDescriptor" target="_top" class="type"><span class="type">IOBufferMemoryDescriptor</span></a> <span class="type">*</span> <!-- a --><span class="function">inTaskWithPhysicalMask</span><!-- /a -->( 
    <!-- a --><span class="type">task_t</span><!-- /a --> <span class="param">inTask</span>, 
    <a href="../../../USB_h/index.html#//apple_ref/c/tag/IOOptionBits" target="_top" class="type"><span class="type">IOOptionBits</span></a> <span class="param">options</span>, 
    <!-- a --><span class="type">mach_vm_size_t</span><!-- /a --> <span class="param">capacity</span>, 
    <!-- a --><span class="type">mach_vm_address_t</span><!-- /a --> <span class="param">physicalMask</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>inTask</code></dt>
<dd><p>The task the buffer will be mapped in. Pass NULL to create memory unmapped in any task (for example, for use as a DMA buffer).</p></dd>
<dt><code>options</code></dt>
<dd>
<p>Options for the allocation:<br></p>
<ul>
<li>
<code>kIODirectionOut</code>, <code>kIODirectionIn</code> - set the direction of the I/O transfer.
</li>
<li>
<code>kIOMemoryPhysicallyContiguous</code> - pass to request memory be physically contiguous. This option is heavily discouraged. The request may fail if memory is fragmented, may cause large amounts of paging activity, and may take a very long time to execute.
</li>
<li>
<code>kIOMemoryKernelUserShared</code> - pass to request memory that will be mapped into both the kernel and client applications.</li>
</ul>
</dd>
<dt><code>capacity</code></dt>
<dd><p>The number of bytes to allocate.</p></dd>
<dt><code>physicalMask</code></dt>
<dd><p>The buffer will be allocated with pages such that physical addresses will only have bits set present in <code>physicalMask</code>. For example, pass <code>0x00000000FFFFFFFFULL</code> for a buffer to be accessed by hardware that has 32 address bits.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->An instance of class <code>IOBufferMemoryDescriptor</code> to be released by the caller, which will free the memory desriptor and associated buffer. 
<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This method allocates a memory buffer with a given size and alignment in the task's specified address space, and returns a memory descriptor instance representing the memory. It is recommended that memory allocated for I/O or sharing via mapping be created via <code>IOBufferMemoryDescriptor</code>. Options passed with the request specify the kind of memory to be allocated. For example, pageablity and sharing are specified with option bits. This function may block and so should not be called from interrupt level or while a simple lock is held.
<!-- end discussion -->
</p>
<p></p>
<dl>
<dt><i>Availability</i></dt>
<dd>Available on PowerPC-based Macs running Mac OS X Server <i>only</i> and on all Intel-based Macs running Mac OS X 10.4.8 and above.
</dd>
</dl>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBufferMemoryDescriptor/setDirection/void/(IODirection);   name=IOBufferMemoryDescriptor::setDirection --><a name="//apple_ref/cpp/instm/IOBufferMemoryDescriptor/setDirection/void/(IODirection)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="setDirection">setDirection</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Changes the transfer direction of the memory descriptor.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">setDirection</span><!-- /a -->(
    <!-- a --><span class="type">IODirection</span><!-- /a --> <span class="param">direction</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>direction</code></dt>
<dd><p>The new I/O direction to set the descriptor's transfer direction to.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This function allows you to redirect the descriptor's transfer direction.  This eliminates the need to destroy and create new buffers when different transfer directions are needed.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOBufferMemoryDescriptor/setLength/void/(vm_size_t);   name=IOBufferMemoryDescriptor::setLength --><a name="//apple_ref/cpp/instm/IOBufferMemoryDescriptor/setLength/void/(vm_size_t)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="setLength">setLength</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Changes the buffer length of the memory descriptor.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">setLength</span><!-- /a -->(
    <!-- a --><span class="type">vm_size_t</span><!-- /a --> <span class="param">length</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>length</code></dt>
<dd><p>The new length to set the buffer length to.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>When a new buffer is created, the initial length of the buffer is set to be the same as the capacity. The length can be adjusted with this function for a shorter transfer (there is no need to create more buffer descriptors when you can reuse an existing one, even for different transfer sizes). Note that the specified length must not exceed the capacity of the buffer.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=clm;  uid=//apple_ref/cpp/clm/IOBufferMemoryDescriptor/withBytes/IOBufferMemoryDescriptor*/(constvoid*,vm_size_t,IODirection,bool);   name=IOBufferMemoryDescriptor::withBytes --><a name="//apple_ref/cpp/clm/IOBufferMemoryDescriptor/withBytes/IOBufferMemoryDescriptor*/(constvoid*,vm_size_t,IODirection,bool)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="withBytes">withBytes</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Creates a memory descriptor preloaded (copied) with the provided bytes.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">static</span> <a href="index.html#//apple_ref/cpp/cl/IOBufferMemoryDescriptor" target="_top" class="type"><span class="type">IOBufferMemoryDescriptor</span></a> <span class="type">*</span> <!-- a --><span class="function">withBytes</span><!-- /a -->( 
    <span class="keyword">const</span> <!-- a --><span class="var">void</span><!-- /a --> <span class="var">*</span> <!-- a --><span class="var">bytes</span><!-- /a -->, 
    <!-- a --><span class="var">vm_size_t</span><!-- /a --> <!-- a --><span class="var">withLength</span><!-- /a -->, 
    <!-- a --><span class="var">IODirection</span><!-- /a --> <!-- a --><span class="var">withDirection</span><!-- /a -->, 
    <!-- a --><span class="var">bool</span><!-- /a --> <!-- a --><span class="var">withContiguousMemory</span><!-- /a --> = <!-- a --><span class="var">false</span><!-- /a -->); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>bytes</code></dt>
<dd><p>The data to copy into the buffer.</p></dd>
<dt><code>withLength</code></dt>
<dd><p>The size of the data to copy into the buffer, in bytes.</p></dd>
<dt><code>withDirection</code></dt>
<dd><p>An I/O direction to be associated with the descriptor, which may affect the operation of the <!-- a -->IOMemoryDescriptor::prepare<!-- /a --> and <!-- a -->IOMemoryDescriptor::complete<!-- /a --> methods on some architectures.</p></dd>
<dt><code>withContiguousMemory</code></dt>
<dd><p>If <code>true</code>, the buffer is initialized with a minimum required alignment of the buffer taken from the value of the <code>capacity</code> parameter; if <code>false</code>, the buffer is initialized with no required alignment.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->An instance of class <code>IOBufferMemoryDescriptor</code> to be released by the caller, which will free the memory descriptor and associated buffer.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The descriptor's length and capacity are set to the input buffer's size.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=clm;  uid=//apple_ref/cpp/clm/IOBufferMemoryDescriptor/withCapacity/IOBufferMemoryDescriptor*/(vm_size_t,IODirection,bool);   name=IOBufferMemoryDescriptor::withCapacity --><a name="//apple_ref/cpp/clm/IOBufferMemoryDescriptor/withCapacity/IOBufferMemoryDescriptor*/(vm_size_t,IODirection,bool)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="withCapacity">withCapacity</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Creates a memory descriptor with a buffer of the specified size.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">static</span> <a href="index.html#//apple_ref/cpp/cl/IOBufferMemoryDescriptor" target="_top" class="type"><span class="type">IOBufferMemoryDescriptor</span></a> <span class="type">*</span> <!-- a --><span class="function">withCapacity</span><!-- /a -->( 
    <!-- a --><span class="type">vm_size_t</span><!-- /a --> <span class="param">capacity</span>, 
    <!-- a --><span class="type">IODirection</span><!-- /a --> <span class="param">withDirection</span>, 
    <!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="type">withContiguousMemory</span><!-- /a --> = <span class="keyword">false</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>capacity</code></dt>
<dd><p>The number of bytes to allocate.</p></dd>
<dt><code>withDirection</code></dt>
<dd><p>An I/O direction to be associated with the descriptor, which may affect the operation of the <!-- a -->IOMemoryDescriptor::prepare<!-- /a --> and <!-- a -->IOMemoryDescriptor::complete<!-- /a --> methods on some architectures.</p></dd>
<dt><code>withContiguousMemory</code></dt>
<dd><p>If <code>true</code>, the buffer is created with a minimum required alignment of the buffer taken from the value of the <code>capacity</code> parameter; if <code>false</code>, the buffer is created with no required alignment.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->An instance of class <code>IOBufferMemoryDescriptor</code> to be released by the caller, which will free the memory descriptor and associated buffer.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The descriptor's length is initially set to the size specified in <code>capacity</code>.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=clm;  uid=//apple_ref/cpp/clm/IOBufferMemoryDescriptor/withOptions/IOBufferMemoryDescriptor*/(IOOptionBits,vm_size_t,vm_offset_t);   name=IOBufferMemoryDescriptor::withOptions --><a name="//apple_ref/cpp/clm/IOBufferMemoryDescriptor/withOptions/IOBufferMemoryDescriptor*/(IOOptionBits,vm_size_t,vm_offset_t)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="withOptions">withOptions</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Creates a memory descriptor with the specified options and with a buffer of the specified size.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">static</span> <a href="index.html#//apple_ref/cpp/cl/IOBufferMemoryDescriptor" target="_top" class="type"><span class="type">IOBufferMemoryDescriptor</span></a> <span class="type">*</span> <!-- a --><span class="function">withOptions</span><!-- /a -->(
    <a href="../../../USB_h/index.html#//apple_ref/c/tag/IOOptionBits" target="_top" class="type"><span class="type">IOOptionBits</span></a> <span class="param">options</span>, 
    <!-- a --><span class="type">vm_size_t</span><!-- /a --> <span class="param">capacity</span>, 
    <!-- a --><span class="type">vm_offset_t</span><!-- /a --> <!-- a --><span class="type">alignment</span><!-- /a --> = <span class="number">1</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>options</code></dt>
<dd><p>See <a href="index.html#//apple_ref/cpp/clm/IOBufferMemoryDescriptor/inTaskWithOptions/IOBufferMemoryDescriptor*/(task_t,IOOptionBits,vm_size_t,vm_offset_t)" target="_top">inTaskWithOptions</a> for possible values.</p></dd>
<dt><code>capacity</code></dt>
<dd><p>The number of bytes to allocate.</p></dd>
<dt><code>alignment</code></dt>
<dd><p>The minimum required alignment of the buffer in bytes (1 is the default for no required alignment). For example, pass 256 to get memory allocated at an address with bits 0-7 zero.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->An instance of class <code>IOBufferMemoryDescriptor</code> to be released by the caller, which will free the memory descriptor and associated buffer.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The descriptor's length is initially set to the size specified in <code>capacity</code>.
<!-- end discussion -->
</p>
<p></p>
<h2>Structs and Unions</h2>
<hr>
<!-- headerDoc=tag;  uid=//apple_ref/cpp/tag/IOBufferMemoryDescriptor/ExpansionData;   name=IOBufferMemoryDescriptor::ExpansionData --><a name="//apple_ref/cpp/tag/IOBufferMemoryDescriptor/ExpansionData"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="ExpansionData">ExpansionData</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>private</tt>
<br><span class="keyword">struct</span> <a href="../../../IOFWAddressSpace_h/index.html#//apple_ref/c/tag/ExpansionData" target="_top" class="type"><span class="type">ExpansionData</span></a> { 
    <a href="../../../IOMemoryDescriptor_h/Classes/IOMemoryMap/index.html#//apple_ref/cpp/cl/IOMemoryMap" target="_top" class="type"><span class="type">IOMemoryMap</span></a> <span class="type">*</span><!-- a --><span class="var">map</span><!-- /a -->; 
}; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This structure will be used to expand the capabilities of this class in the future.
<!-- end discussion -->
</p>
<p></p>
<h2>Member Data</h2>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOBufferMemoryDescriptor/reserved;   name=IOBufferMemoryDescriptor::reserved --><a name="//apple_ref/cpp/data/IOBufferMemoryDescriptor/reserved"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="reserved">reserved</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>private</tt>
<br><a href="../../../IOFWAddressSpace_h/index.html#//apple_ref/c/tag/ExpansionData" target="_top" class="type"><span class="type">ExpansionData</span></a> <span class="type">*</span> <a href="../../../IOFWAddressSpace_h/index.html#//apple_ref/c/data/reserved" target="_top" class="var"><span class="var">reserved</span></a>; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Reserved for future use.  (Internal use only)<!-- end discussion -->
</p>
<p></p>
<p><!-- start of footer -->

<!-- start of footer --> 
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/KernelIOKitFramework/IOBufferMemoryDescriptor_h/Classes/IOBufferMemoryDescriptor/index.html%3Fid%3DTP30000816-3.4&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/KernelIOKitFramework/IOBufferMemoryDescriptor_h/Classes/IOBufferMemoryDescriptor/index.html%3Fid%3DTP30000816-3.4&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/KernelIOKitFramework/IOBufferMemoryDescriptor_h/Classes/IOBufferMemoryDescriptor/index.html%3Fid%3DTP30000816-3.4&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</p>
<p>&#160;</p>
<!--#include virtual="/footer"-->
<!-- end of footer -->


<!-- end of footer -->
Last Updated: 2008-12-19
</div>
<!-- headerDoc=cl; uid=//apple_ref/cpp/cl/IOBufferMemoryDescriptor;  name=IOBufferMemoryDescriptor--><a name="//apple_ref/cpp/cl/IOBufferMemoryDescriptor"></a>
</body>
</html>
