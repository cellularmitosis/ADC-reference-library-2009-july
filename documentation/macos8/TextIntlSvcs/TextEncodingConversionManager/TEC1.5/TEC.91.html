<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML EXPERIMENTAL 970324//EN">
<HTML>
<HEAD>
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter">
<script language="JavaScript" src="frametest.js"></script>
<TITLE> TruncateForUnicodeToText</TITLE><LINK REL="stylesheet" TYPE="text/css" HREF="../../../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../../../Resources/JavaScript/page.js"></script>
</head>
<body bgcolor="#ffffff">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>

<DIV>
<a name="top"></a>
<!-- start of header -->
<!--#include virtual="/includes/framesetheader" -->
<!-- end of header --><A HREF="TEC.8f.html"><img src="images/up.gif" border="0" alt="Up"></A><nobr>&nbsp;</nobr><A HREF="TEC.90.html"><img src="images/previous.gif" border="0" alt="Previous"></A><nobr>&nbsp;</nobr><A HREF="TEC.92.html"><img src="images/next.gif" border="0" alt="Next"></A><nobr>&nbsp;</nobr>
<!-- insert Show/Hide frames -->
<a href="javascript:testFrame()">
<script>
<!--
document.write(frameLink);
//	-->
</script><!-- end Show/Hide frames --></A><br>
<font face="Geneva,Helvetica,Arial" size="1"><b><br>
		PATH<spacer type="horizontal" size="5">&nbsp;</b></font><a href="../../../mac8.html"><font face="Geneva,Helvetica,Arial" size="1">Mac OS 8 and 9 Developer Documentation</a>  <b>&gt;</b> Text Encoding Conversion Manager<br>
		<img src="images/im_smblue.gif" width="116" height="8"><img src="images/space.gif" width="6" height="11">Programming With the Text Encoding Conversion Manager</font><br>
		<br>
		<hr>

</DIV>
<H1>
<A NAME="pgfId=3849">
 </A>
<A NAME="29282">
 </A>
TruncateForUnicodeToText</H1>
<P>
<A NAME="pgfId=3850">
 </A>
Identifies where your application can safely break a Unicode string to be converted to any encoding so that the string is broken in a way that preserves the text element integrity. </P>
<TT>
<A NAME="pgfId=26890">
 </A>
pascal OSStatus TruncateForUnicodeToText (<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConstUnicodeToTextInfo iUnicodeToTextInfo,<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteCount iSourceLen, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConstUniCharArrayPtr iSourceStr, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OptionBits iControlFlags, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteCount iMaxLen, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteCount *oTruncatedLen);</TT>
<DL COMPACT>
<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=26894">
 </A>
<TT>iUnicodeToTextInfo</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=3853">
 </A>
 A Unicode converter object <A HREF="TEC.74.html" CLASS="XRef">
<TT>UnicodeToTextInfo</TT></A>
 for the Unicode string to be divided up. The <TT>TruncateForUnicodeToText </TT>function does not modify the contents of this private structure. </DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=26905">
 </A>
<TT>iSourceLen</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=3854">
 </A>
The length in bytes of the Unicode string to be divided up. </DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=26914">
 </A>
<TT>iSourceStr</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=3855">
 </A>
A pointer to the Unicode string to be divided up. </DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=26923">
 </A>
<TT>iControlFlags</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=3856">
 </A>
Truncation control flags. Specify the flag <TT>kUnicodeStringUnterminatedMask</TT> if truncating a buffer of text that belongs to a longer stream containing a subsequent buffer of text that could have characters belonging to a text element that begins at the end of the current buffer.   If you set this flag, typically you would set the <TT>iMaxLen</TT> parameter equal to <TT>iSourceLen</TT>. For information on the flag <TT>kUnicodeStringUInterminatedMask</TT>, see <A HREF="TEC.6d.html" CLASS="XRef">
Conversion Control Flags</A>
. </DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=26932">
 </A>
<TT>iMaxLen</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=14822">
 </A>
The maximum allowable length of the string to be truncated. This must be less than or equal to <TT>iSourceLen</TT>.</DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=26941">
 </A>
<TT>oTruncatedLen</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=3860">
 </A>
A pointer to a value of type <TT>ByteCount</TT>. On output, this value contains the 	length of the longest portion of the Unicode source string, pointed to by the <TT>iSourceStr</TT> parameter, that is less than or equal to the value of the <TT>iMaxLen</TT> parameter. This returned parameter identifies the byte after which you can truncate the string. </DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=26950">
 </A>
<I CLASS="italics">
function result</I>
</DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=14428">
 </A>
A result code. See <A HREF="TEC.20.html" CLASS="XRef">
Text Encoding Conversion Manager Result Codes</A>
 in the chapter <A HREF="TEC.18.html" CLASS="XRef">
Basic Text Types Reference</A>
</DD><P>

</DL COMPACT>
<DIV>
<H5 CLASS="RSb.RoutineSbhd">
<A NAME="pgfId=3862">
 </A>
DISCUSSION</H5>
<P>
<A NAME="pgfId=3863">
 </A>
Your application can use this function to divide up a Unicode string properly truncating each portion before you call <TT>ConvertFromUnicodeToText</TT> or <TT>ConvertFromUnicodeToScriptCodeRun</TT> to convert the string. You can call this function repeatedly to properly truncate a text segment, each time identifying the new beginning of the string, until the last portion of the text is less than or equal to the maximum allowable length. Each time you use the function, you get a properly terminated string within the allowable length range. You use the function as many times as necessary to be able to convert the entire text segment. <P>


<A NAME="pgfId=3869">
 </A>
Because this function does not modify the contents of the Unicode converter object, you can call this function between conversion calls. <P>


<A NAME="pgfId=12978">
 </A>
In addition to resource errors, the functions may return any of the following result codes: <TT>paramErr</TT>, <TT>kTECGlobalsUnavailableErr</TT>, <TT>kTECTableFormatErr</TT>, <TT>kTECPartialCharErr</TT> (if truncating UTF-8), <TT>kTECIncompleteElementErr</TT>, or <TT>kTextUndefinedElementErr</TT>. If the result code is not <TT>noErr</TT>, then the value returned by the <TT>oTruncatedLen</TT> parameter is invalid.</P>
</DIV>
<HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 13 Dec 99)<P><A HREF="TEC.8f.html"><img src="images/up.gif" border="0" alt="Up"></A><nobr>&nbsp;</nobr><A HREF="TEC.90.html"><img src="images/previous.gif" border="0" alt="Previous"></A><nobr>&nbsp;</nobr><A HREF="TEC.92.html"><img src="images/next.gif" border="0" alt="Next"></A><nobr>&nbsp;</nobr>
<!-- insert Show/Hide frames -->
<a href="javascript:testFrame()">
<script>
<!--
document.write(frameLink);
//	-->
</script><!-- end Show/Hide frames --></A>

<!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY>
</HTML>
