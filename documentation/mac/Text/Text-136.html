<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Specifying Text Characteristics(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING136></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-135.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-137.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-126.html"><B>Chapter 3 - QuickDraw Text</B></A> / <A HREF="Text-133.html"><B>Using QuickDraw Text</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING136-0></A>
<H2><A NAME=MARKER-9-66></A>Specifying Text Characteristics</H2>
 Each time you measure or draw text that begins a new style run and whose characteristics differ from those of the current graphics port, first you need to set the graphics port text-related fields to match those of the text. Here is how the text-related graphic port fields are initialized:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Field<TH>Value<TH>Explanation<TR>
<TD><A NAME=MARKER-2-33></A>txFont<TD>0<TD>System font<TR>
<TD><A NAME=MARKER-2-914></A>txFace<TD>[]<TD>Plain style of the current font<TR>
<TD>txSize<TD>0<TD>Size of the system font used to draw text<TR>
<TD><A NAME=MARKER-9-46></A>spExtra<TD>0<TD>Standard width of the space character for the font<TR>
<TD><A NAME=MARKER-2-299></A>chExtra<TD>0<TD>Standard width of nonspace characters for the font<TR>
<TD><A NAME=MARKER-2-586></A>txMode<TD>srcOr <TD>Combines the destination with the source </TABLE>
<P>
 Do not modify any of these fields directly. Instead, always use the QuickDraw routines to change their values: <CODE><A NAME=MARKER-2-15></A>TextFace</CODE>, <A NAME=MARKER-9-102></A><CODE>TextFont</CODE>, <A NAME=MARKER-2-232></A><CODE>TextMode</CODE>, <A NAME=MARKER-9-42></A><CODE>TextSize</CODE>, <A NAME=MARKER-2-234></A><CODE>SpaceExtra</CODE>, and <A NAME=MARKER-2-113></A><CODE>CharExtra</CODE>. Using these routines ensures that your application will benefit from any future improvements to QuickDraw.<P>
 <A HREF=#MARKER-9-73>Listing 3-1</A> shows a simple sequence of QuickDraw calls. These routines set the current port, set the graphics port text fields, then draw a text string. The calls render the text in 12-point Geneva font using the styles bold and italic, and widen the spaces between words by 3 pixels to format the text. QuickDraw text-handling procedures that set these fields are discussed later in this section.<P>
<B>Listing 3-1  <A NAME=MARKER-9-73></A>Using QuickDraw to set the graphics port text-related fields</B><P>
<PRE>
SetPort(thePort);
TextFont(geneva);
TextFace([bold, italic]);
TextSize(12);
SpaceExtra(3);
</PRE>
 If you must directly change the values of any of the graphics port fields, call the QuickDraw <A NAME=MARKER-2-275></A><CODE>PortChanged</CODE> procedure to notify QuickDraw of the change after you modify the field. For more information about <CODE>PortChanged</CODE>, see the QuickDraw chapters in <I><A HREF="../QuickDraw/QuickDraw-2.html">Inside Macintosh: Imaging</A></I>.<P>
<A NAME=HEADING136-7></A>
<H3><A NAME=MARKER-9-75></A>Setting the Font</H3>
 You use the <CODE>TextFont</CODE> procedure to set the font for the text. The value that you specify for this field is either the font family ID or a predefined constant.<P>
 If you know the font name, you can get the font family ID by calling the <A NAME=MARKER-9-282></A><CODE>GetFNum</CODE> procedure, passing it the font name. You can get a font's name if it has a font family ID by calling the Font Manager <CODE>GetFontName</CODE> procedure. For more information about these procedures and the predefined font constants, see the chapter "Font Manager" in this book.<P>
 If you do not know either the font family ID or the name of the font, you can use the Resource Manager's <CODE>GetIndResource</CODE> function followed by the <CODE>GetResInfo</CODE> procedure to determine the fonts that are available and what their names and IDs <BR>are. See the chapter "Resource Manager" in <I><A HREF="../MoreToolbox/MoreToolbox-2.html">Inside Macintosh: More Macintosh Toolbox</A></I> <BR>for more information.<P>
 The values 0 and 1 have special significance. When a graphics port is created, the <A NAME=MARKER-2-406></A><CODE>txFont</CODE> field is initialized to 0, which specifies the system font. This is the font that the system uses to draw text in system menus and system dialog boxes. You can use a font that is defined by the system--to do so, it sets this field to 1; 1 always specifies the application font.<P>
<DL>
<DT><B>Note</B>
<DD>Do not use the font family ID 0 or the constant <CODE>'chicago'</CODE> to specify the Chicago font because the ID can vary on localized systems. To specify the Chicago font, use the following calls.  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
<PRE>
GetFNum('Chicago', theNum);
TextFont(theNum);
</PRE>
<DL>
<DD>The variable <CODE>theNum</CODE> is an integer.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
<DT><B>Storing a font name in a document</B>
<DD>Always store a font name, rather than its font family ID, in a document to avoid problems that can arise because IDs are not unique--many font families share the same font family ID--or because one font family may have different IDs on different computer systems.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 You use <CODE>TextFont</CODE> to set the <CODE>txFont</CODE> field of the current graphics port for a new style run that uses a font different from the current one, and in response to a user's actions, for example, when a user selects a new font from a menu.<P>
<DL>
<DT><B>Note</B>
<DD>Whenever a user changes the keyboard script, you are responsible for setting the <CODE>txFont</CODE> field to the new font, so that the keyboard script and the font script are synchronized.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
<A NAME=HEADING136-19></A>
<H3><A NAME=MARKER-9-78></A>Modifying the Text Style</H3>
 When you create a graphics port, the <A NAME=MARKER-2-19></A><CODE>txFace</CODE> field value is initially an empty set (<CODE>[]</CODE>), which specifies the plain style of the current font.<P>
 To change the text style, you call <CODE><A NAME=MARKER-2-86></A>TextFace</CODE>, using any combination of the following constants to specify the text style: <CODE>bold</CODE>, <CODE>italic</CODE>, <CODE>underline</CODE>, <CODE>outline</CODE>, <CODE>shadow</CODE>, <CODE>condense</CODE>, and <CODE>extend</CODE>. In Pascal, you specify the value or values within square brackets. For example:<P>
<PRE>
TextFace([bold]);          {bold}
TextFace([bold,italic]);   {bold and italic}
</PRE>
 You can also add another style to the current text style, or remove a style. For example:<P>
<PRE>
TextFace(thePort^.txFace+[bold]); {existing style plus bold}
TextFace(thePort^.txFace-[bold]); {existing style minus bold}
</PRE>
 To reset the style to plain, you specify an empty set. For example:<P>
<PRE>
TextFace([]);  {plain text}
</PRE>
 If you want to restore the existing value after you draw the text in another style, save it before you call <CODE>TextFace</CODE>. For a description of how QuickDraw renders text in each of these styles, see <A HREF=Text-128.html#MARKER-9-28>"Font, Font Style, and Font Size" on page 3-5</A>.<P>
<A NAME=HEADING136-28></A>
<H3><A NAME=MARKER-9-81></A>Changing the Font Size</H3>
 When you create a graphics port, the value of the <CODE>txSize</CODE> field is 0, which specifies the size of the font to be used to draw system text, such as menus. The size of the system font is usually 12 points. You use the <A NAME=MARKER-2-408></A><CODE>TextSize</CODE> procedure to set the <A NAME=MARKER-9-90></A><CODE>txSize</CODE> field of the current graphics port to the font's point size. Text drawn on the QuickDraw coordinate plane can range from 1 point to 32,767 points.<A NAME=MARKER-2-84></A><P>
<A NAME=HEADING136-30></A>
<H3>Changing the Width of Characters<A NAME=MARKER-9-85></A></H3>
 When you create a graphics port, the <CODE>spExtra</CODE> and <CODE>chExtra</CODE> fields are set to 0, which specifies the standard width for space and nonspace characters in the font. You change the width of space characters and nonspace characters using the <CODE>SpaceExtra</CODE> and <CODE>CharExtra</CODE> procedures, respectively.<P>
 Widening or narrowing space and nonspace characters lets you meet special <A NAME=MARKER-2-13></A>formatting requirements that are not satisfied by simply justifying the text. If you want to change only the width of the space characters in a line of text for onscreen typographical formatting, you can set the <CODE>spExtra</CODE> field value before you draw each style run, narrowing spaces in some style runs and widening those in others. To change the width of nonspace characters, either extending them or narrowing them, you set the <CODE>chExtra</CODE> field value before you draw a style run.<P>
 You use the <CODE>SpaceExtra</CODE> procedure to set the <CODE>spExtra</CODE> field of the current graphics port to the number of pixels to be added to or subtracted from the standard width of the space character in the style run. (A value specified in the <CODE>spExtra</CODE> field is ignored by script systems that do not use space characters, so don't to set it for 2-byte script systems that use only intercharacter spacing.) The text measuring and drawing routines apply the <CODE>spExtra</CODE> field pixel value to every space in the text string, regardless of whether the space occurs at the beginning or the end of a style run or between words within a style run. You can use the <CODE>SpaceExtra</CODE> procedure, for both a color graphics port (<CODE>CGrafPort</CODE>) and an original graphics port (<CODE>GrafPort</CODE>).<P>
 You use the <CODE>CharExtra</CODE> procedure to set the <CODE><A NAME=MARKER-9-236></A>chExtra</CODE> field of the current graphics port to the number of extra pixels to be added to or subtracted from the width of all nonspace characters in a style run. Because only the color graphics port record has a <CODE>chExtra</CODE> field, use of <CODE>CharExtra</CODE> is limited to color graphics ports. The measuring and drawing routines apply the pixel value that you set in the <CODE>chExtra</CODE> field to the right side of the glyph of each nonspace character.<P>
 You can use <CODE>SpaceExtra</CODE> and<A NAME=MARKER-2-112></A> <CODE>CharExtra</CODE> together, for example, to format text consisting of multiple style runs with different fonts in order to create a smooth visual effect by causing the fonts to measure the same or proportionally.<A NAME=MARKER-2-50></A><P>
<DL>
<DT><B>Note</B>
<DD>Although printing on a LaserWriter preserves the line's endpoints, it alters the line layout in between. Any formatting internal to the line that you set through <CODE>SpaceExtra</CODE> and <CODE>CharExtra</CODE> is lost when you print.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 If you do not want to use the justification routines to draw justified text, you can justify a line of text using <CODE>SpaceExtra</CODE> and <CODE>CharExtra</CODE> to widen each glyph (space and nonspace characters) by the same amount of pixels for onscreen display. Here is how <BR>you do this:<P>
<OL>
<LI>Determine the slop value to be applied to the text to justify it.<P>
<UL>
<LI>Measure the width in pixels of each style run in the line of text using <CODE>TextWidth</CODE>.
<LI>Sum the values.
<LI>Subtract the total from the display line length.<P>
</UL>
<LI>Count the total number of characters (both space characters and nonspace characters) that the text contains.
<LI>Divide the slop value by the number of characters minus 1. Round the slop value to a whole number.
<LI>Call the SpaceExtra procedure, passing it the result of step 3.
<LI>Call the CharExtra procedure, passing it the result of step 3.
<LI>Call <CODE>DrawText</CODE> or <CODE>DrawString</CODE> to draw each style run on the line.<P>
</OL>
 Use of <CODE>CharExtra</CODE> entails some restrictions. You cannot use intercharacter spacing for 1-byte complex script systems or 1-byte simple script systems that include zero-width characters, such as diacritical marks, because of the way extra width is applied to a glyph. For example, for 1-byte simple script systems with diacritical marks, intercharacter space is added to all glyphs separating the diacritical mark from the glyph of the character.<P>
<A NAME=HEADING136-48></A>
<H3>Using Fractional Glyph Widths</H3>
 <I>Fractional glyph widths</I> are measurements of a glyph's width that can include fractions of a pixel. Using fractional glyph widths allows QuickDraw to place glyphs on the screen <BR>in a manner that will closely match the eventual placement of glyphs on a page printed by a LaserWriter. Fractional glyph widths make it possible for the LaserWriter printer to print with better spacing. You can use the <A NAME=MARKER-2-209></A>Font Manager's <CODE>SetFractEnable</CODE> procedure to turn the use of fractional glyph widths on or off.<P>
 Because screen glyphs are made up of whole pixels, QuickDraw cannot draw a fractional glyph. To compensate, QuickDraw rounds off the fractional parts resulting in uneven spacing between glyphs and words. Although the text is somewhat distorted on the screen, it is correctly proportioned and shows no distortion when printed on a page using a LaserWriter.<P>
 However, to avoid screen distortion, your application can disable the use of fractional widths. A consequence of this it that placement of text on the printed page is less than optimal. For more information about fractional glyph widths, see the chapter "Font Manager" in this book.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-135.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-137.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
