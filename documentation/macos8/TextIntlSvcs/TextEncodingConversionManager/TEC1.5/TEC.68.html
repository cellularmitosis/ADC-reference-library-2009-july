<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML EXPERIMENTAL 970324//EN">
<HTML>
<HEAD>
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter">
<script language="JavaScript" src="frametest.js"></script>
<TITLE> TECConvertTextToMultipleEncodings </TITLE><LINK REL="stylesheet" TYPE="text/css" HREF="../../../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../../../Resources/JavaScript/page.js"></script>
</head>
<body bgcolor="#ffffff">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>

<DIV>
<a name="top"></a>
<!-- start of header -->
<!--#include virtual="/includes/framesetheader" -->
<!-- end of header --><A HREF="TEC.64.html"><img src="images/up.gif" border="0" alt="Up"></A><nobr>&nbsp;</nobr><A HREF="TEC.67.html"><img src="images/previous.gif" border="0" alt="Previous"></A><nobr>&nbsp;</nobr><A HREF="TEC.69.html"><img src="images/next.gif" border="0" alt="Next"></A><nobr>&nbsp;</nobr>
<!-- insert Show/Hide frames -->
<a href="javascript:testFrame()">
<script>
<!--
document.write(frameLink);
//	-->
</script><!-- end Show/Hide frames --></A><br>
<font face="Geneva,Helvetica,Arial" size="1"><b><br>
		PATH<spacer type="horizontal" size="5">&nbsp;</b></font><a href="../../../mac8.html"><font face="Geneva,Helvetica,Arial" size="1">Mac OS 8 and 9 Developer Documentation</a>  <b>&gt;</b> Text Encoding Conversion Manager<br>
		<img src="images/im_smblue.gif" width="116" height="8"><img src="images/space.gif" width="6" height="11">Programming With the Text Encoding Conversion Manager</font><br>
		<br>
		<hr>

</DIV>
<H1>
<A NAME="pgfId=14323">
 </A>
<A NAME="25282">
 </A>
TECConvertTextToMultipleEncodings </H1>
<P>
<A NAME="pgfId=20969">
 </A>
Converts text in the source encoding to runs of text in multiple destination encodings. </P>
<TT>
<A NAME="pgfId=32122">
 </A>
pascal OSStatus TECConvertTextToMultipleEncodings(<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TECObjectRef encodingConverter, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConstTextPtr inputBuffer, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteCount inputBufferLength, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteCount *actualInputLength, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TextPtr outputBuffer, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteCount outputBufferLength, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteCount *actualOutputLength, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TextEncodingRun outEncodingsBuffer[], <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ItemCount maxOutEncodingRuns, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ItemCount *actualOutEncodingRuns);</TT>
<DL COMPACT>
<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=32126">
 </A>
<TT>encodingConverter</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=14005">
 </A>
 The reference to the text encoding converter object to be used for the conversion. This is the reference returned by the function <A HREF="TEC.65.html" CLASS="XRef"><TT>TECCreateOneToManyConverter</TT></A>. </DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=32137">
 </A>
<TT>inputBuffer</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=14017">
 </A>
The stream of text to be converted.</DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=32146">
 </A>
<TT>inputBufferLength</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=14018">
 </A>
 The length in bytes of the stream of text specified in the <TT>inputBuffer</TT> parameter. </DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=32156">
 </A>
<TT>actualInputLength</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=14019">
 </A>
 A pointer to a value of type <TT>ByteCount</TT>. On output, this value is the number of source text bytes that <TT>TECConvertTextToMultipleEncodings</TT> converted. </DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=32166">
 </A>
<TT>outputBuffer</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=14020">
 </A>
A pointer to a buffer for a byte stream. On output, this buffer holds the converted text. </DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=32175">
 </A>
<TT>outputBufferLength</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=14021">
 </A>
 The length in bytes of the buffer provided by the <TT>outputBuffer</TT> parameter. </DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=32185">
 </A>
<TT>actualOutputLength</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=14354">
 </A>
 A pointer to a value of type <TT>ByteCount</TT>. On output, this value is the number of bytes of the converted text returned in the buffer specified by the <TT>outputBuffer</TT> parameter.</DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=32195">
 </A>
<TT>outEncodingsBuffer[]</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=14356">
 </A>
 An array of text encoding runs for output. Note that the actual byte size of this buffer should be <TT>actualOutEncodingRuns * sizeof(TextEncodingRun)</TT>. See <A HREF="TEC.23.html" CLASS="XRef"><TT>TextEncodingRun</TT></A>
 for more information about the <TT>TextEncodingRun</TT> structure. </DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=32205">
 </A>
<TT>maxOutEncodingRuns</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=14358">
 </A>
 The maximum number of runs that will fit in the outEncodingsBuffer array.</DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=32215">
 </A>
<TT>actualOutEncodingRuns</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=14360">
 </A>
 A pointer to a value of type <TT>ItemCount</TT>. On output <TT>actualOutEncodingRuns</TT> contains the number of runs put in outEncodingsBuffer array.</DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=32225">
 </A>
<I CLASS="italics">
function result</I>
</DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=20115">
 </A>
 A result code. See <A HREF="TEC.20.html" CLASS="XRef">
Text Encoding Conversion Manager Result Codes</A>
 for a list of possible values. If the <TT>outEncodings</TT> buffer is filled while converting text, then function returns <TT>kTECOutputBufferFullStatus</TT>. If there is not enough memory available for <TT>TECConvertTextToMultipleEncodings</TT> to convert the text when allocating internal buffers, the function returns the appropriate Memory Manager result code.</DD><P>

</DL COMPACT>
<DIV>
<H5 CLASS="RSb.RoutineSbhd">
<A NAME="pgfId=20116">
 </A>
DISCUSSION</H5>
<P>
<A NAME="pgfId=14025">
 </A>
The <TT>TECConvertTextToMultipleEncodings</TT> function converts the stream of text you pass it to runs of destination encodings specified in the converter object. The function relies on the specified converter object for the source encoding in which the text is expressed, the destination encodings, and the train of encodings forming the intermediate conversion path (if one is explicitly specified). The function returns the text in the output buffer that you provide. <P>


<A NAME="pgfId=20990">
 </A>
In allocating an output buffer, a good rule of thumb is larger is better, basing your estimate on the byte requirements of the destination encoding. You should always allocate a buffer at least 32 bytes long. For the function to return successfully, the output buffer you allocate must be large enough to accommodate at least part of the converted text. Then, if the function cannot convert all of the text, it executes successfully, returns the portion of the text it converted, and returns the number of source bytes it removed from input in the <TT>actualInputLength</TT> parameter. You can use this number to identify the next byte to be taken and to determine how many bytes remain. To convert the remaining text, you simply call the function again with the remaining text and a new output buffer. <P>


<A NAME="pgfId=20991">
 </A>
If the output buffer you allocate is too small to accommodate <I CLASS="italics">
any</I>
 of the converted text, the function fails. For example, if the destination encoding requires bytes in addition to the actual text (for instance, an escape sequence preceding the converted text), your buffer must be large enough to accommodate both.</P>
</DIV>
<DIV>
<H4>
<A NAME="pgfId=32237">
 </A>
<BLOCKQUOTE>IMPORTANT</H4>
<P>
<A NAME="pgfId=20992">
 </A>
If the destination encoding is a character encoding scheme--such as ISO-2022-JP, which begins in ASCII and switches to other coded character sets through limited combinations of escape sequences--then you need to allocate enough space to accommodate escape sequences that signal switches. ISO-2022-JP requires 3 to 5 bytes for an escape sequence preceding the 1-byte or 2-byte character it introduces. If you allocate a buffer that is less than 5 bytes, the <TT>TECConvertText</TT> function could fail, depending on the text being converted. <P></BLOCKQUOTE>


<A NAME="pgfId=20984">
 </A>
The Text Encoding Converter creates internal buffers for all multistaged (that is, indirect) conversions that hold intermediate results. </P>
<DIV>
<H5 CLASS="RSb.RoutineSbhd">
<A NAME="pgfId=20985">
 </A>
SEE ALSO</H5>
<P>
<A NAME="pgfId=20126">
 </A>
The function <A HREF="TEC.62.html" CLASS="XRef"><TT>TECConvertText</TT></A></P>
</DIV>
</DIV>
<HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 13 Dec 99)<P><A HREF="TEC.64.html"><img src="images/up.gif" border="0" alt="Up"></A><nobr>&nbsp;</nobr><A HREF="TEC.67.html"><img src="images/previous.gif" border="0" alt="Previous"></A><nobr>&nbsp;</nobr><A HREF="TEC.69.html"><img src="images/next.gif" border="0" alt="Next"></A><nobr>&nbsp;</nobr>
<!-- insert Show/Hide frames -->
<a href="javascript:testFrame()">
<script>
<!--
document.write(frameLink);
//	-->
</script><!-- end Show/Hide frames --></A>

<!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY>
</HTML>
