<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Porting CodeWarrior Projects to Xcode: After Importing a Project</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="After Importing a Project"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20001712" title="After Importing a Project"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000436" target="_top">Tools</a> &gt; <a href="../../../Xcode-date.html#//apple_ref/doc/uid/TP30000440-TP30000436-TP30000557" target="_top">Xcode</a> &gt; <a href="../migration_overview/migration_overview.html#//apple_ref/doc/uid/TP40001286-TPXREF101">Porting CodeWarrior Projects to Xcode</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../mig_importing/migration_importing.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../UsingPPlantInUniversalBinaries/UsingPPlantInUniversalBinaries.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/20001712-TPXREF101" title="After Importing a Project"></a><h1>After Importing a Project</h1><p>Importing into Xcode is a good starting point for converting your project, but you’ll typically have some work to do before it successfully builds and runs. For example, the Xcode importer does a good job of duplicating the structure of a CodeWarrior project, but you’ll need to make sure the build settings it chooses are correct for your project. It’s likely that you are the best judge of settings such as compiler optimization, and you should check other build settings as well.</p><p>Of course if you prepared your code carefully before importing your project, and if your code is already fantastically clean and standard, you will have fewer changes to make after importing. But you are still likely to face some of the simple problems or some of the more subtle issues described in this chapter.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="mig_after_importing.html#//apple_ref/doc/uid/20001712-TPXREF182">Build Your Project</a>
				
			<br/>
			
        
			
			
				<a href="mig_after_importing.html#//apple_ref/doc/uid/20001712-TPXREF167">Check for Common Conversion Issues</a>
				
			<br/>
			
        
			
			
				<a href="mig_after_importing.html#//apple_ref/doc/uid/20001712-TPXREF168">Resolve Undefined Symbols</a>
				
			<br/>
			
        
			
			
				<a href="mig_after_importing.html#//apple_ref/doc/uid/20001712-CHDBIGGB">Make Code Changes for GCC Compatibility</a>
				
			<br/>
			
        
			
			
				<a href="mig_after_importing.html#//apple_ref/doc/uid/20001712-TPXREF165">Move Settings From the .plc File to an Info.plist File</a>
				
			<br/>
			
        
			
			
				<a href="mig_after_importing.html#//apple_ref/doc/uid/20001712-TPXREF166">Make Changes to PowerPlant</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/20001712-TPXREF182" title="Build Your Project"></a><h2>Build Your Project</h2><p>Once you’ve imported your project into Xcode, use one of the commands from the Build menu, such as Command-B, to build it. To view the full build report, choose Build > Build Results (or type Command-Shift-B). In the resulting Build Results window, you can open the build log to show the most detailed results; to do so, click the button to the left of the arrow, below the top pane of the window. This group of buttons allow you to control the amount of information displayed.</p><p>You can also view any errors or warnings generated during the build in the Errors and Warnings group in the project window. See the section <span class="content_text"><a href="../migration_differences/migration_differences.html#//apple_ref/doc/uid/20001709-BAJEGBEG">“The GCC Compiler”</a></span> for information on how to control the actual level of warnings generated by GCC.</p><a name="//apple_ref/doc/uid/20001712-TPXREF167" title="Check for Common Conversion Issues"></a><h2>Check for Common Conversion Issues</h2><p>The following are some common steps you may need to take to get your project to build:</p><ul class="ul"><li class="li"><p>Specify a prefix file. For an overview, see <span class="content_text"><a href="../migration_differences/migration_differences.html#//apple_ref/doc/uid/20001709-BABIIEII">“Precompiled Headers and Prefix Files.”</a></span> For the actual steps, see <span class="content_text"><a href="../migration_differences/migration_differences.html#//apple_ref/doc/uid/20001709-TPXREF146">“Using Precompiled Headers and Prefix Files.”</a></span></p></li><li class="li"><p>Your application may require compiler settings for GCC that the importer does not pick up. See <span class="content_text"><a href="../migration_differences/migration_differences.html#//apple_ref/doc/uid/20001709-BAJEGBEG">“The GCC Compiler”</a></span> for information about working with compiler settings.</p></li><li class="li"><p>You may need to add a Mac OS library to the project. You typically only need to explicitly include a library if you are statically linking your software.</p><p>You will also need to rename any static libraries so that they match the format <code>lib*.a</code>. Otherwise, Xcode will not link them.</p></li><li class="li"><p>For additional issues, see these sections:</p><ul class="nested"><li class="nested li"><p><span class="content_text"><a href="../migration_differences/migration_differences.html#//apple_ref/doc/uid/20001709-BABFDBGA">“C and C++ Libraries”</a></span></p></li><li class="nested li"><p><span class="content_text"><a href="../migration_differences/migration_differences.html#//apple_ref/doc/uid/20001709-BABDGDBH">“Runtime and Library Issues”</a></span></p></li><li class="nested li"><p><span class="content_text"><a href="../mig_bef_converting/migration_before_convert.html#//apple_ref/doc/uid/20001710-TPXREF135">“Migrate from MSL to System C and C++ Libraries”</a></span></p></li></ul></li></ul><a name="//apple_ref/doc/uid/20001712-TPXREF168" title="Resolve Undefined Symbols"></a><h2>Resolve Undefined Symbols</h2><p>You may get undefined symbol errors when you build an Xcode project imported from CodeWarrior. This is most likely because the import process did not pick up a needed source file or framework. To add these items:</p><ul class="ul"><li class="li"><p>You can drag any missing source files into the project group in the Groups &amp; Files list of the project window or add them with Project > Add to Project.</p><p>In either case, Xcode adds a reference to the file to your project. You also get a chance to specify whether to copy the file into the project directory, and to specify which targets to add the file to.</p></li><li class="li"><p>Add any needed frameworks to the project, by dragging them to the External Frameworks and Libraries group or using Project > Add to Project, which displays an Open dialog. Again, you will also specify which target to add the framework to.</p></li></ul><a name="//apple_ref/doc/uid/20001712-CHDBIGGB" title="Make Code Changes for GCC Compatibility"></a><h2>Make Code Changes for GCC Compatibility</h2><p>This section describes a number of code changes you may need to make to ensure compatibility with GCC version 4.0. It also includes some changes related to switching from MSL libraries to the standard Mac OS X C and C++ libraries. See also <span class="content_text"><a href="../migration_differences/migration_differences.html#//apple_ref/doc/uid/20001709-TPXREF148">“Code Differences”</a></span> for a brief list of code differences.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001712-DontLinkElementID_1" title="Note"></a><p><strong>Note:</strong>&nbsp;Some of the issues listed here are due to current GCC compiler bugs, which may be fixed in future releases.</p></div><a name="//apple_ref/doc/uid/20001712-BEHEAEFB" title="Conform to the C99 Standard"></a><h3>Conform to the C99 Standard</h3><p>Applications that change from using Universal Interfaces to using framework-style include statements (in either CodeWarrior or Xcode), must conform to the C99 standard. This is required because the header <code>MacTypes.h</code> defines the <code>bool</code> type as defined in the C99 standard. This header is included into frameworks such as the Carbon and Cocoa frameworks, and thus a large percentage of Mac OS software projects. Projects that pick up the header <code>MacTypes.h</code> through framework headers (for example, with <code>#include &lt;Carbon/Carbon.h></code>) don't have a choice to not include individual header files.</p><p>Because C99 is largely a superset of the C89 standard, most code that conforms to the C89 standard should compile with the C99 setting. To avoid compilation errors, however, observe the following restrictions:</p><ul class="spaceabove"><li class="li"><p>The <code>main()</code> function must be type <code>int</code> and have an argument list of either <code>(void)</code> or <code>(int argc, char * argv)</code>.</p></li><li class="li"><p>Some implicit conversions that are valid in C89/C90 are illegal in C99.</p></li><li class="li"><p>Keywords (such as <code>bool</code>, <code>true</code>, and <code>false</code>) that are free for use by developer code in C89/C90 are defined by the compiler or standard headers in C99 and may cause redefined-symbol errors.</p></li></ul><a name="//apple_ref/doc/uid/20001712-TPXREF171" title="Inlining Thresholds"></a><h3><a name="//apple_ref/doc/uid/20001712-SW1" title="Inlining Thresholds"></a>Inlining Thresholds</h3><p>Inlining is an optimization the compiler performs to trade off code size for speed. On the theory that function call overhead can be high for small functions called within loops, inlining places the body of the function “in line” with the caller, so no function call overhead is needed.</p><p>The trade-off of code size for speed can backfire, however, if it generates too much inlined code; the bloat in code size can itself become a performance problem. Both CodeWarrior and GCC allow control of how much inlining is enough, but the two mechanisms differ substantially, and there's no direct correlation between them. When moving a project from CodeWarrior to GCC you may need to experiment with the inlining settings to get the results you want.</p><p>CodeWarrior allows control of inlining depth: if an inlined function calls another inlined function, both are expanded in line. CodeWarrior lets you set the depth at which inlining stops.</p><p>The GCC compiler has no specific control over inlining depth, but does let you control the total expanded size of inlined functions. By default, inlined functions over 600 “pseudo-instructions” will not be inlined, regardless of whether the size is a result of deep inlining or not. The custom compiler flag <code>-finline-limit=n</code> lets you control the maximum size of inlined functions. You can set this compiler flag in the Other C Flags build setting in the Build pane in the target inspector window. </p><div class="notebox"><a name="//apple_ref/doc/uid/20001712-DontLinkElementID_2" title="Note"></a><p><strong>Note:</strong>&nbsp;Between GCC 3.3 and GCC 4.0, significant improvements have been made to the algorithms for inlining functions. As a result, using the <code>-finline-limit=n</code> compiler flag produces different results when compiling with GCC 3.3 than when compiling with GCC 4.0, even for the same value of the <code>-flnline-limit</code> compiler flag. You should profile your code and test your inlining settings with the appropriate compiler version. For more information on differences in optimization between GCC 3.3 and GCC 4.0, see <em><a href="../../../../../releasenotes/DeveloperTools/GCC40PortingReleaseNotes/index.html#//apple_ref/doc/uid/TP40002069" target="_top">GCC Porting Guide</a></em>.</p></div><a name="//apple_ref/doc/uid/20001712-TPXREF169" title="Dealing With Pragmas"></a><h3>Dealing With Pragmas</h3><p>Before reading this section, you should be familiar with the information in <span class="content_text"><a href="../migration_differences/migration_differences.html#//apple_ref/doc/uid/20001709-TPXREF154">“Pragma Statements,”</a></span> which describes some of the differences in how pragmas are used by the CodeWarrior and GCC compilers.</p><p>In general, GCC supports only a small number of pragmas, including those for structure alignment, and instead uses compiler settings to accomplish similar tasks. Unsupported pragma statements are generally ignored, depending on the current warning settings. Compiler settings can be set on a per-project or a per-file basis.</p><p>GCC does not support <code>#pragma export on</code> and <code>#pragma export off</code>. See <span class="content_text"><a href="../migration_differences/migration_differences.html#//apple_ref/doc/uid/20001709-BABFBHHF">“Exporting Symbols”</a></span> for information on how to work with exported symbols.</p><p>If you have header files that use the statement <code>#pragma options(!pack_enums), enum=int, enumsalwaysint on</code>, you can instead add the flag <code>-fshort-enums</code> for those files by enabling the Short Enumeration Constants build setting.</p><p>If you need to isolate GCC-specific or CodeWarrior-specific code, use the conditional statements described in <span class="content_text"><a href="../migration_differences/migration_differences.html#//apple_ref/doc/uid/20001709-TPXREF148">“Code Differences.”</a></span></p><a name="//apple_ref/doc/uid/20001712-TPXREF174" title="Packing and Alignment Differences"></a><h4>Packing and Alignment Differences</h4><p>This section lists some packing and alignment differences between the CodeWarrior compiler and GCC.</p><a name="//apple_ref/doc/uid/20001712-TPXREF176" title="Different size and alignment of enums"></a><h5>Different size and alignment of enums</h5><p>GCC gives all enums <code>int</code> (4-byte) size and alignment. By default, CodeWarrior bases the size and alignment of enums on the smallest integer type able to contain the declared range of values. However, you can use the CodeWarrior C/C++ Language setting “Enums Always Ints” to specify the use of int-sized enums.</p><a name="//apple_ref/doc/uid/20001712-TPXREF177" title="Different alignment of doubles"></a><h5>Different alignment of doubles</h5><p>GCC gives doubles 8-byte alignment only when they are the first member of a struct. CodeWarrior gives all doubles appearing at the “top level” in a struct 8-byte alignment if the first member of the struct is a double. In some unusual cases, such as the example shown in <span class="content_text">Listing 4-1</span>, this can lead to different alignment.</p><a name="//apple_ref/doc/uid/20001712-CEGDJCAE" title="Listing 4-1A structure definition that is interpreted differently"></a><p class="codesample"><strong>Listing 4-1&nbsp;&nbsp;</strong>A structure definition that is interpreted differently</p><div class="codesample"><table><tr><td scope="row"><pre>struct s { double f1; char f2; double f3; };<span></span></pre></td></tr></table></div><p>With this code, GCC will give the variable <code>f3</code> 4-byte alignment, while CodeWarrior will give it 8-byte alignment.</p><a name="//apple_ref/doc/uid/20001712-TPXREF179" title="Code size incompatibility with power alignment"></a><h5>Code size incompatibility with power alignment</h5><p>When compiling the code in <span class="content_text">Listing 4-2</span>, GCC and CodeWarrior disagree on the proper size of the following struct when compiled with <code>power</code> alignment. For CodeWarrior, <code>sizeof(ValueRangeCriteriaData) = 68</code>, while for GCC, <code>sizeof(ValueRangeCriteriaData) = 72</code>.</p><a name="//apple_ref/doc/uid/20001712-CEGCJIEI" title="Listing 4-2Code that generates a size incompatibility"></a><p class="codesample"><strong>Listing 4-2&nbsp;&nbsp;</strong>Code that generates a size incompatibility</p><div class="codesample"><table><tr><td scope="row"><pre>#pragma options align=power<span></span></pre></td></tr><tr><td scope="row"><pre>struct ValueRangeCriteriaValue<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    SInt64 value;<span></span></pre></td></tr><tr><td scope="row"><pre>    SInt64 valueOffset;<span></span></pre></td></tr><tr><td scope="row"><pre>    SInt64 valueOffsetMultiplier;<span></span></pre></td></tr><tr><td scope="row"><pre>};<span></span></pre></td></tr><tr><td scope="row"><pre>typedef struct ValueRangeCriteriaValue ValueRangeCriteriaValue;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>struct ValueRangeCriteriaData<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    ValueRangeCriteriaValue startValue;<span></span></pre></td></tr><tr><td scope="row"><pre>    ValueRangeCriteriaValue endValue;<span></span></pre></td></tr><tr><td scope="row"><pre>    UInt32              reserved[5];<span></span></pre></td></tr><tr><td scope="row"><pre>};<span></span></pre></td></tr><tr><td scope="row"><pre>typedef struct ValueRangeCriteriaData ValueRangeCriteriaData;<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/20001712-TPXREF181" title="Data packed differently in a register"></a><h5>Data packed differently in a register</h5><p>When compiling the code in <span class="content_text">Listing 4-3</span>, Codewarrior packs the data for the variable <code>i</code> into the high two bytes of the register, but GCC packs the data into the low two bytes of the register. This causes an incompatibility wherever a type like this is used.</p><a name="//apple_ref/doc/uid/20001712-TPXREF175" title="Listing 4-3Code that generates a register difference"></a><p class="codesample"><strong>Listing 4-3&nbsp;&nbsp;</strong>Code that generates a register difference</p><div class="codesample"><table><tr><td scope="row"><pre>union Opaque16 {<span></span></pre></td></tr><tr><td scope="row"><pre>    char   b[2];<span></span></pre></td></tr><tr><td scope="row"><pre>    short  notanInt<span></span></pre></td></tr><tr><td scope="row"><pre>};<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void bar (Opaque16 i)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>printf("i = %d\n");<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void main (void)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>  Opaque16 i;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>  i = 5;<span></span></pre></td></tr><tr><td scope="row"><pre>  bar(i);<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/20001712-TPXREF173" title="The Mach-O bool Type is Four Bytes, Not One"></a><h3>The Mach-O bool Type is Four Bytes, Not One</h3><p>In GCC 4.0, the default size of a <code>bool</code> variable is four bytes. In CodeWarrior, the size is one byte. You should avoid using code that counts on the size of a <code>bool</code>. You should also use care in working with <code>bool</code> pointers.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001712-DontLinkElementID_3" title="Note"></a><p><strong>Note:</strong>&nbsp;GCC does provide the flag <code>-mone-byte-bool</code> to force GCC to use one byte for <code>bool</code> types. However, code generated with this flag set may not be binary compatible with code generated without it or with Mac OS X frameworks. The Xcode build setting for setting this flag is Use One Byte 'bool' (GCC_ONE_BYTE_BOOL).</p></div><div class="notebox"><a name="//apple_ref/doc/uid/20001712-DontLinkElementID_4" title="Note"></a><p><strong>Note:</strong>&nbsp;The size and alignment of the bool data type is different for 32-bit and 64-bit architectures. This document assumes that you are building for a 32-bit architecture. For more information on building for a 64-bit architecture, see <em><a href="../../../../Darwin/Conceptual/64bitPorting/index.html#//apple_ref/doc/uid/TP40001064" target="_top">64-Bit Transition Guide</a></em>.</p></div><a name="//apple_ref/doc/uid/20001712-TPXREF145" title="Guarding Header Includes for C++"></a><h3>Guarding Header Includes for C++</h3><p>There are cases where if you explicitly include individual Mac OS X system headers from C++ code, you’ll get link failures with the system libraries. To prevent this, you should isolate your header includes by adding this at the beginning of your file, after the include guard:</p><div class="codesample"><table><tr><td scope="row"><pre>#ifdef __cplusplus<span></span></pre></td></tr><tr><td scope="row"><pre>extern "C" {<span></span></pre></td></tr><tr><td scope="row"><pre>#endif<span></span></pre></td></tr></table></div><p>and this at the end, before the include guard:</p><div class="codesample"><table><tr><td scope="row"><pre>#ifdef __cplusplus<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre>#endif<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/20001712-TPXREF155" title="Friend of Template Specialization Can&acirc;&#128;&#153;t Access Private Members"></a><h3>Friend of Template Specialization Can’t Access Private Members</h3><p>With GCC, a class declared as a friend of a template specialization does not have access to private members.</p><a name="//apple_ref/doc/uid/20001712-TPXREF156" title="Float to Integer Conversions Give Incorrect Output"></a><h3>Float to Integer Conversions Give Incorrect Output</h3><p>The ANSI C standard states that the result of converting an unrepresentable floating point value to integer is undefined, but most implementations produce a result that can be usefully detected. However, for some such conversions, GCC 3.3 produces a meaningless result. For example, consider the results of the following casts:</p><div class="codesample"><table><tr><td scope="row"><pre>d = -1.79769e+308;<span></span></pre></td></tr><tr><td scope="row"><pre>(long)d                  // result: -2147483648 (should be -2147483648)<span></span></pre></td></tr><tr><td scope="row"><pre>(int64_t)d               // result: 1 (should be -9223372036854775808)<span></span></pre></td></tr><tr><td scope="row"><pre>(long long)d             // result: 1 (should be -9223372036854775808)<span></span></pre></td></tr><tr><td scope="row"><pre>(unsigned char)d         // result: 0 (should be 0)<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/20001712-TPXREF157" title="Some Casts Don&acirc;&#128;&#153;t Work in Function Lists"></a><h3>Some Casts Don’t Work in Function Lists</h3><p>In some cases in GCC, C style casts or functional style casts do not work correctly in an argument list because argument conversions are applied before the cast conversion is applied.</p><a name="//apple_ref/doc/uid/20001712-TPXREF158" title="Standard C Library Functions Are in Global Namespace"></a><h3>Standard C Library Functions Are in Global Namespace</h3><p>With GCC, standard C library functions are in the global namespace, not in <code>std::</code>.</p><a name="//apple_ref/doc/uid/20001712-TPXREF159" title="Vector Load Indexed Intrinsic Is Not Const Correct "></a><h3>Vector Load Indexed Intrinsic Is Not Const Correct </h3><p> The <code>vec_ld</code> (vector load indexed) intrinsic is not const correct, and generates an unclear diagnostic message. For example, the code in <span class="content_text">Listing 4-4</span> generates the error message</p><div class="codesample"><table><tr><td scope="row"><pre>invalid conversion from `vector &lt;anonymous>*' to `vector &lt;anonymous>*'<span></span></pre></td></tr></table></div><p>As shown in the listing, you can use a cast to eliminate the warning.</p><a name="//apple_ref/doc/uid/20001712-CEGEFDGI" title="Listing 4-4Code that generates error"></a><p class="codesample"><strong>Listing 4-4&nbsp;&nbsp;</strong>Code that generates error</p><div class="codesample"><table><tr><td scope="row"><pre>const vector unsigned char* srcPtr;<span></span></pre></td></tr><tr><td scope="row"><pre>    ...<span></span></pre></td></tr><tr><td scope="row"><pre>    // This line gives an INCORRECT warning<span></span></pre></td></tr><tr><td scope="row"><pre>    vector unsigned charv1 = vec_ld(0, srcPtr);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // casting away the constness gets rid of the warning,<span></span></pre></td></tr><tr><td scope="row"><pre>    //  but shouldn’t be necessary and complicates the code<span></span></pre></td></tr><tr><td scope="row"><pre>    vector unsigned charv2 = vec_ld(0, const_cast&lt;vector unsigned char*>(srcPtr));<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/20001712-TPXREF160" title="CodeWarrior Allows Anonymous Unused C Function Arguments"></a><h3>CodeWarrior Allows Anonymous Unused C Function Arguments</h3><p>CodeWarrior allows unused arguments to C functions to have their names omitted.</p><div class="codesample"><table><tr><td scope="row"><pre>int foo(float)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>  return 0;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p> This is allowed by the C99 standard, but generates a warning in GCC.</p><a name="//apple_ref/doc/uid/20001712-TPXREF161" title="GCC Interprets Some #define Values Differently Than CodeWarrior"></a><h3>GCC Interprets Some #define Values Differently Than CodeWarrior</h3><p>The CodeWarrior compiler treats “true” the same as “1” in <code>#define</code> statements, but GCC treats them differently. For example, in <span class="content_text"><a href="mig_after_importing.html#//apple_ref/doc/uid/20001712-CEGICBDH">Listing 4-5</a></span>, both code snippets generate the same result in CodeWarrior. With GCC, however, &lt;some code> doesn’t get executed in the first snippet.</p><a name="//apple_ref/doc/uid/20001712-CEGICBDH" title="Listing 4-5#define test code"></a><p class="codesample"><strong>Listing 4-5&nbsp;&nbsp;</strong><code>#define</code> test code</p><div class="codesample"><table><tr><td scope="row"><pre>// Snippet 1: &lt;some code> executed only in CodeWarrior<span></span></pre></td></tr><tr><td scope="row"><pre>#define MY_FEATURE true<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>#if MY_FEATURE<span></span></pre></td></tr><tr><td scope="row"><pre>&lt;some code><span></span></pre></td></tr><tr><td scope="row"><pre>#endif<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// Snippet 2: &lt;some code> executed in CodeWarrior or GCC<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>#define MY_FEATURE 1<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>#if MY_FEATURE<span></span></pre></td></tr><tr><td scope="row"><pre>&lt;some code><span></span></pre></td></tr><tr><td scope="row"><pre>#endif<span></span></pre></td></tr></table></div><p>GCC also does not currently provide a warning when an undefined identifier is evaluated in a <code>#if</code> directive (Snippet 1).</p><a name="//apple_ref/doc/uid/20001712-TPXREF162" title="GCC asm Intrinsics are Preprocessor Macros"></a><h3>GCC asm Intrinsics are Preprocessor Macros</h3><p>Compilers support intrinsics as an alternative to using asm statements within functions. However, in some cases GCC uses macros, not true functions, so they can’t substitute arguments. As a result, code that compiles on CodeWarrior generates an error with GCC.</p><p>For example, compiling the following line with GCC generates an error that the number of parameters does not match (expected 5, got 3):</p><div class="codesample"><table><tr><td scope="row"><pre>sFlags = __rlwimi(sFlags, inValue, INSERT_HALT);<span></span></pre></td></tr></table></div><p>However, <code>INSERT_HALT</code> is a <code>#define</code>:</p><div class="codesample"><table><tr><td scope="row"><pre>#define INSERT_HALT 8,23,23<span></span></pre></td></tr></table></div><p>To work around this, you can replace the define with the actual value:</p><div class="codesample"><table><tr><td scope="row"><pre>sFlags = __rlwimi(sFlags, inValue, 8,23,23);<span></span></pre></td></tr></table></div><div class="notebox"><a name="//apple_ref/doc/uid/20001712-DontLinkElementID_5" title="Note"></a><p><strong>Note:</strong>&nbsp;If you use intrinsics in CodeWarrior, you can continue to do so in Xcode by including the file <code>ppcintrinsics.h</code>. </p></div><p>Para</p><a name="//apple_ref/doc/uid/20001712-TPXREF163" title="Xcode&acirc;&#128;&#153;s Rez tool Doesn&acirc;&#128;&#153;t Support Certain Operators"></a><h3>Xcode’s Rez tool Doesn’t Support Certain Operators</h3><p>In CodeWarrior, you can use &lt;&lt; and >> as shift operators in a resource file, but Xcode’s version of Rez doesn’t currently support using these symbols as operators.</p><a name="//apple_ref/doc/uid/20001712-TPXREF165" title="Move Settings From the .plc File to an Info.plist File"></a><h2>Move Settings From the .plc File to an Info.plist File</h2><p>Any packaged Mac OS X software requires an information property list file named <code>Info.plist</code>. CodeWarrior projects that create similar types of software use a <code>.plc</code> file to supply this information. You can read about differences between these approaches in <span class="content_text"><a href="../migration_differences/migration_differences.html#//apple_ref/doc/uid/20001709-BCIBCHCJ">“The Information Property List and .plc Files.”</a></span></p><p>When you import a project into Xcode, the importer does extract property list setting information from the CodeWarrior project, but you should check the information and make any necessary additions or modifications. If your CodeWarrior project doesn’t have a <code>.plc</code> file, you’ll have to supply all the necessary information.</p><p>In Xcode, you supply or modify this information by opening a target editor and making changes in the Properties pane. <span class="content_text">Figure 4-1</span> shows the Properties pane after importing a project based on CodeWarrior project stationery.</p><p>You can also move property list entries from your CodeWarrior project to your Xcode project by the following steps:</p><ol class="ol"><li class="li"><p>In CodeWarrior, verify that the Property List Compiler Output pop-up on the Property List pane of the target settings window is set to “Output as file.”</p></li><li class="li"><p>Build your CodeWarrior project, so that it creates an <code>Info.plist</code> file from the <code>.plc</code> file. The property list file is part of the application bundle, so it is not typically visible in the Finder.</p></li><li class="li"><p>Open the <code>Info.plist</code> file as text. You can do this by Control-clicking the application file and choosing Show Package Contents, navigating to the file within the <code>Contents</code> folder, and double-clicking it (which should open the file in a CodeWarrior editor window).</p></li><li class="li"><p>In the project window of your Xcode project, open the Resources group within the project group in the Groups &amp; Files list. You should see an <code>Info.plist</code> file.</p></li><li class="li"><p>Double-click the <code>Info.plist</code> file to open it in an Xcode editor window.</p></li><li class="li"><p>You can cut and paste key-value entries from the CodeWarrior property list to the Xcode property list. Of course, you’ll have to observe the XML format.</p></li></ol><br/><div><a name="//apple_ref/doc/uid/20001712-CHDCCGHJ" title="Figure 4-1The Properties pane in a target editor"></a><p><strong>Figure 4-1&nbsp;&nbsp;</strong>The Properties pane in a target editor</p><img src = "../art/mig_properties_pane.gif" alt = "The Properties pane in an inspector window" width="345" height="463"></div><br/><a name="//apple_ref/doc/uid/20001712-TPXREF166" title="Make Changes to PowerPlant"></a><h2>Make Changes to PowerPlant</h2><p>If your project uses PowerPlant, importing the project should include all the PowerPlant source files. To build successfully with GCC 4.0, however, you’ll have to make a few changes to the code. </p><p>To build PowerPlant in your Xcode project, you perform these steps, described in the following sections:</p><ol class="ol"><li class="li"><p>Add PowerPlant’s headers to the project and target.</p></li><li class="li"><p>Create a prefix file in Xcode that includes the PowerPlant headers and the necessary definitions.</p></li><li class="li"><p>Make minor changes to the PowerPlant code to build with the GCC 4.0 compiler.</p></li></ol><p>For related information in other sections, see <span class="content_text"><a href="../migration_differences/migration_differences.html#//apple_ref/doc/uid/20001709-BAJEGBEG">“The GCC Compiler,”</a></span> <span class="content_text"><a href="../migration_differences/migration_differences.html#//apple_ref/doc/uid/20001709-BAJDIJDB">“Framework-Style Headers,”</a></span> and <span class="content_text"><a href="../migration_differences/migration_differences.html#//apple_ref/doc/uid/20001709-BABIIEII">“Precompiled Headers and Prefix Files.”</a></span></p><a name="//apple_ref/doc/uid/20001712-TPXREF170" title="Add PowerPlant Headers to the Project and Target"></a><h3>Add PowerPlant Headers to the Project and Target</h3><p>This requirement should be taken care of automatically when you use the Xcode project importer to import a project that uses PowerPlant. If you find that any files are missing when you attempt to build the project, you can drag them into the project from the Finder, or use Project > Add to Project in Xcode.</p><a name="//apple_ref/doc/uid/20001712-SW2" title="Create a Prefix File for PowerPlant"></a><h3>Create a Prefix File for PowerPlant</h3><p>After adding the PowerPlant header files, you need to disentangle the header files from the CodeWarrior precompiled header mechanism. To do this, you need to create a prefix header for PowerPlant in Xcode that includes information from the following PowerPlant files: <code>CommonMach-OPrefix.h</code>, <code>DebugMach-OPrefix.pch++</code>, <code>PP_ClassHeaders.cp</code>, <code>PP_DebugHeaders.cp</code>, and <code>PP_MacHeadersMach-O.c</code>.</p><p><span class="content_text">Listing 4-6</span> shows a header file that contains the needed definitions and include statements from these CodeWarrior header files. You can use this header file for a debug or a final target. See <span class="content_text"><a href="../migration_differences/migration_differences.html#//apple_ref/doc/uid/20001709-TPXREF129">“Creating Debug and Non-Debug Products”</a></span> for more information.</p><a name="//apple_ref/doc/uid/20001712-CHDDFIBG" title="Listing 4-6An Xcode prefix header file for PowerPlant"></a><p class="codesample"><strong>Listing 4-6&nbsp;&nbsp;</strong>An Xcode prefix header file for PowerPlant</p><div class="codesample"><table><tr><td scope="row"><pre>/*<span></span></pre></td></tr><tr><td scope="row"><pre> *  PP_Xcode.h<span></span></pre></td></tr><tr><td scope="row"><pre> *<span></span></pre></td></tr><tr><td scope="row"><pre> *  Created on Wed Jan 29 2003.<span></span></pre></td></tr><tr><td scope="row"><pre> *  Copyright (c) 2003 __MyCompanyName__. All rights reserved.<span></span></pre></td></tr><tr><td scope="row"><pre> *<span></span></pre></td></tr><tr><td scope="row"><pre> */<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>#define _STD std<span></span></pre></td></tr><tr><td scope="row"><pre>#define _CSTD std<span></span></pre></td></tr><tr><td scope="row"><pre>#define __dest_os __mac_os_x<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>#define PP_Target_Carbon 1<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>#define PP_Target_Classic (!PP_Target_Carbon)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// ------------------------------------------------------------------<span></span></pre></td></tr><tr><td scope="row"><pre>//  Options<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>#define PP_Uses_PowerPlant_Namespace 0<span></span></pre></td></tr><tr><td scope="row"><pre>#define PP_Supports_Pascal_Strings 1<span></span></pre></td></tr><tr><td scope="row"><pre>#define PP_StdDialogs_Option PP_StdDialogs_NavServicesOnly<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>#define PP_Uses_Old_Integer_Types 0<span></span></pre></td></tr><tr><td scope="row"><pre>#define PP_Obsolete_AllowTargetSwitch 0<span></span></pre></td></tr><tr><td scope="row"><pre>#define PP_Obsolete_ThrowExceptionCode 0<span></span></pre></td></tr><tr><td scope="row"><pre>#define PP_Warn_Obsolete_Classes 1<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>#define PP_Suppress_Notes_2 211<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>//<span></span></pre></td></tr><tr><td scope="row"><pre>// Carbon headers<span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;Carbon/Carbon.h><span></span></pre></td></tr><tr><td scope="row"><pre>//<span></span></pre></td></tr><tr><td scope="row"><pre>// PowerPlantheaders<span></span></pre></td></tr><tr><td scope="row"><pre>    // Action Classes<span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LAction.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LUndoer.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UTETextAction.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UTEViewTextAction.h><span></span></pre></td></tr><tr><td scope="row"><pre>    // AppleEvent Classes<span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LModelDirector.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LModelObject.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LModelProperty.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UAppleEventsMgr.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UExtractFromAEDesc.h><span></span></pre></td></tr><tr><td scope="row"><pre>    // Array Classes<span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LArray.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LArrayIterator.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LComparator.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LRunArray.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LVariableArray.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;TArray.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;TArrayIterator.h><span></span></pre></td></tr><tr><td scope="row"><pre>    // Commander Classes<span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LApplication.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LCommander.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LDocApplication.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LDocument.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LSingleDoc.h><span></span></pre></td></tr><tr><td scope="row"><pre>    // Feature Classes<span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LAttachable.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LAttachment.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LBroadcaster.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LDragAndDrop.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LDragTask.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LEventDispatcher.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LListener.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LPeriodical.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LSharable.h><span></span></pre></td></tr><tr><td scope="row"><pre>    // File &amp; Stream Classes<span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LDataStream.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LFile.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LFileStream.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LHandleStream.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LStream.h><span></span></pre></td></tr><tr><td scope="row"><pre>    // Pane Classes<span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LButton.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LCaption.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LCicnButton.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LControl.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LDialogBox.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LEditField.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LFocusBox.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LGrafPortView.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LListBox.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LOffscreenView.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LPane.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LPicture.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LPlaceHolder.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LPrintout.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LRadioGroupView.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LScroller.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LStdControl.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LTabGroupView.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LTableView.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LTextEditView.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LView.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LWindow.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UGWorld.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UQuickTime.h><span></span></pre></td></tr><tr><td scope="row"><pre>    // PowerPlant Headers<span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;PP_Constants.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;PP_KeyCodes.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;PP_Macros.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;PP_Messages.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;PP_Prefix.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;PP_Resources.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;PP_Types.h><span></span></pre></td></tr><tr><td scope="row"><pre>                                    // Support Classes<span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LClipboard.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LFileTypeList.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LGrowZone.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LMenu.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LMenuBar.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LRadioGroup.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LString.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;LTabGroup.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UDesktop.h><span></span></pre></td></tr><tr><td scope="row"><pre>                                    // Utility Classes<span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UAttachments.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UCursor.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UDebugging.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UDrawingState.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UDrawingUtils.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UEnvironment.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UException.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UKeyFilters.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UMemoryMgr.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UModalDialogs.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UPrinting.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UReanimator.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;URegions.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;URegistrar.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UScrap.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UScreenPort.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UTextEdit.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UTextTraits.h><span></span></pre></td></tr><tr><td scope="row"><pre>#include &lt;UWindows.h><span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/20001712-TPXREF152" title="Make Minor Changes to the PowerPlant Code"></a><h3>Make Minor Changes to the PowerPlant Code</h3><p>To build PowerPlant in Xcode with GCC 4.0, you need to make a relatively small number of changes to the source code. These changes are described here, with accompanying code listings. The line numbers are based on source files from CodeWarrior Pro version 8.3.</p><p>To avoid a GCC error, in the file <code>LGATabsControlImp.cp</code>, starting at line 964, move the declaration of <code>tabButton</code> outside the <code>kControlTabEnabledFlagTab</code> case, as shown in <span class="content_text">Listing 4-7</span>.</p><a name="//apple_ref/doc/uid/20001712-CHDDBCIE" title="Listing 4-7Modified switch statement in LGATabsControlImp.cp"></a><p class="codesample"><strong>Listing 4-7&nbsp;&nbsp;</strong>Modified switch statement in <code>LGATabsControlImp.cp</code></p><div class="codesample"><table><tr><td scope="row"><pre>    switch (inTag) {<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>//      case kControlTabContentRectTag: {<span></span></pre></td></tr><tr><td scope="row"><pre>//          Rect contentRect = *(Rect *)inDataPtr;<span></span></pre></td></tr><tr><td scope="row"><pre>                    // ••• Now what do we do with this? Do we resize the<span></span></pre></td></tr><tr><td scope="row"><pre>                    // control to fit the content rect?<span></span></pre></td></tr><tr><td scope="row"><pre>//          break;<span></span></pre></td></tr><tr><td scope="row"><pre>//      }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        LGATabsButton*tabButton;<span></span></pre></td></tr><tr><td scope="row"><pre>        case kControlTabEnabledFlagTag: {<span></span></pre></td></tr><tr><td scope="row"><pre>            Boolean enableIt = *(Boolean *)inDataPtr;<span></span></pre></td></tr><tr><td scope="row"><pre>            tabButton = GetTabButtonByIndex(inPartCode);<span></span></pre></td></tr><tr><td scope="row"><pre>            if (tabButton != nil) {<span></span></pre></td></tr><tr><td scope="row"><pre>                if (enableIt) {<span></span></pre></td></tr><tr><td scope="row"><pre>                    tabButton->Enable();<span></span></pre></td></tr><tr><td scope="row"><pre>                } else {<span></span></pre></td></tr><tr><td scope="row"><pre>                    tabButton->Disable();<span></span></pre></td></tr><tr><td scope="row"><pre>                }<span></span></pre></td></tr><tr><td scope="row"><pre>            }<span></span></pre></td></tr><tr><td scope="row"><pre>            break;<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        case kControlTabInfoTag: {<span></span></pre></td></tr><tr><td scope="row"><pre>            tabButton = GetTabButtonByIndex(inPartCode);<span></span></pre></td></tr><tr><td scope="row"><pre>            if (tabButton != nil) {<span></span></pre></td></tr><tr><td scope="row"><pre>                ControlTabInfoRec*info = (ControlTabInfoRec*) inDataPtr;<span></span></pre></td></tr><tr><td scope="row"><pre>                tabButton->SetDescriptor(info->name);<span></span></pre></td></tr><tr><td scope="row"><pre>                tabButton->SetIconResourceID(info->iconSuiteID);<span></span></pre></td></tr><tr><td scope="row"><pre>            }<span></span></pre></td></tr><tr><td scope="row"><pre>            break;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        default:<span></span></pre></td></tr><tr><td scope="row"><pre>            LGAControlImp::SetDataTag(inPartCode,<span></span></pre></td></tr><tr><td scope="row"><pre>                                inTag, inDataSize, inDataPtr);<span></span></pre></td></tr><tr><td scope="row"><pre>            break;<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr></table></div><p>In <code>LStream.h</code>, you’ll need to enclose several method definitions in conditional directives to avoid redefinition with GCC. <span class="content_text">Listing 4-8</span> shows the first change, at line 152.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001712-DontLinkElementID_6" title="Note"></a><p><strong>Note:</strong>&nbsp;Commenting out these methods makes them unavailable to client code. Usage of these methods is rare, but if they are used in your application, you may need to make additional source changes.</p></div><a name="//apple_ref/doc/uid/20001712-CHDGFHHG" title="Listing 4-8LStream.h modifications at line 152"></a><p class="codesample"><strong>Listing 4-8&nbsp;&nbsp;</strong><code>LStream.h</code> modifications at line 152</p><div class="codesample"><table><tr><td scope="row"><pre>#ifndef __GNUC__<span></span></pre></td></tr><tr><td scope="row"><pre>    LStream&amp;operator &lt;&lt; (long double inNum)<span></span></pre></td></tr><tr><td scope="row"><pre>                        {<span></span></pre></td></tr><tr><td scope="row"><pre>                            (*this) &lt;&lt; (double) inNum;<span></span></pre></td></tr><tr><td scope="row"><pre>                            return (*this);<span></span></pre></td></tr><tr><td scope="row"><pre>                        }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    LStream&amp;operator &lt;&lt; (short double inNum)<span></span></pre></td></tr><tr><td scope="row"><pre>                        {<span></span></pre></td></tr><tr><td scope="row"><pre>                            (*this) &lt;&lt; (double) inNum;<span></span></pre></td></tr><tr><td scope="row"><pre>                            return (*this);<span></span></pre></td></tr><tr><td scope="row"><pre>                        }<span></span></pre></td></tr><tr><td scope="row"><pre>#endif<span></span></pre></td></tr></table></div><p><span class="content_text">Listing 4-9</span> shows the second change to <code>LStream.h</code>, at line 172.</p><a name="//apple_ref/doc/uid/20001712-CHDCCJFE" title="Listing 4-9LStream.h modifications at line 172"></a><p class="codesample"><strong>Listing 4-9&nbsp;&nbsp;</strong><code>LStream.h</code> modifications at line 172</p><div class="codesample"><table><tr><td scope="row"><pre>#ifndef __GNUC__<span></span></pre></td></tr><tr><td scope="row"><pre>    LStream&amp;operator >> (long double &amp;outNum)<span></span></pre></td></tr><tr><td scope="row"><pre>                        {<span></span></pre></td></tr><tr><td scope="row"><pre>                            doublenum;<span></span></pre></td></tr><tr><td scope="row"><pre>                            (*this) >> num;<span></span></pre></td></tr><tr><td scope="row"><pre>                            outNum = num;<span></span></pre></td></tr><tr><td scope="row"><pre>                            return (*this);<span></span></pre></td></tr><tr><td scope="row"><pre>                        }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    LStream&amp;operator >> (short double &amp;outNum)<span></span></pre></td></tr><tr><td scope="row"><pre>                        {<span></span></pre></td></tr><tr><td scope="row"><pre>                            double num;<span></span></pre></td></tr><tr><td scope="row"><pre>                            (*this) >> num;<span></span></pre></td></tr><tr><td scope="row"><pre>                            outNum = (short double) num;<span></span></pre></td></tr><tr><td scope="row"><pre>                            return (*this);<span></span></pre></td></tr><tr><td scope="row"><pre>                        }<span></span></pre></td></tr><tr><td scope="row"><pre>#endif<span></span></pre></td></tr></table></div><p>You’ll also have to make a change to <code>LException.h</code> for GCC. Change the definition of the class destructor to agree with the standard C++ library exception definition, as shown in <span class="content_text">Listing 4-10</span>. The class listing begins at line 23, while the changes begin at line 33.</p><a name="//apple_ref/doc/uid/20001712-CHDGJFCE" title="Listing 4-10LException.h modifications at line 33"></a><p class="codesample"><strong>Listing 4-10&nbsp;&nbsp;</strong><code>LException.h</code> modifications at line 33</p><div class="codesample"><table><tr><td scope="row"><pre>class LException : public PP_STD::exception {<span></span></pre></td></tr><tr><td scope="row"><pre>public:<span></span></pre></td></tr><tr><td scope="row"><pre>                        LException(<span></span></pre></td></tr><tr><td scope="row"><pre>                                SInt32      inErrorCode,<span></span></pre></td></tr><tr><td scope="row"><pre>                                ConstStringPtrinErrorString = nil);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                        LException( const LException&amp; inException );<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    LException&amp; operator = ( const LException&amp; inException );<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>#ifndef __GNUC__<span></span></pre></td></tr><tr><td scope="row"><pre>    virtual         ~LException();<span></span></pre></td></tr><tr><td scope="row"><pre>#else<span></span></pre></td></tr><tr><td scope="row"><pre>    virtual         ~LException() throw();<span></span></pre></td></tr><tr><td scope="row"><pre>#endif<span></span></pre></td></tr><tr><td scope="row"><pre>    virtual const char*what() const throw();<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr></table></div><p>You’ll also have to change the implementation of the class destructor to agree with standard C++ library exception definition, as shown in <span class="content_text">Listing 4-11</span>. The class listing begins at line 90, while the changes begin at line 94.</p><a name="//apple_ref/doc/uid/20001712-CHDGCBCB" title="Listing 4-11LException.cp modifications at line 94"></a><p class="codesample"><strong>Listing 4-11&nbsp;&nbsp;</strong><code>LException.cp</code> modifications at line 94</p><div class="codesample"><table><tr><td scope="row"><pre>// ------------------------------------------------------------------<span></span></pre></td></tr><tr><td scope="row"><pre>//  • ~LException               Destructor        [public]<span></span></pre></td></tr><tr><td scope="row"><pre>// ------------------------------------------------------------------<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>#ifdef __GNUC__<span></span></pre></td></tr><tr><td scope="row"><pre>LException::~LException() throw()<span></span></pre></td></tr><tr><td scope="row"><pre>#else<span></span></pre></td></tr><tr><td scope="row"><pre>LException::~LException()<span></span></pre></td></tr><tr><td scope="row"><pre>#endif<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/20001712-TPXREF183" title="Changes for a Debug Build"></a><h4>Changes for a Debug Build</h4><p>The following changes are required after importing a CodeWarrior PowerPlant project with a Debug target.</p><p>In <code>LDebugStream.cp</code>, you’ll have to modify the following (occurring at line 1150):</p><div class="codesample"><table><tr><td scope="row"><pre>UInt8* theFirstByte = static_cast&lt;UInt8*>(const_cast&lt;UInt8*>(inPtr));<span></span></pre></td></tr></table></div><p>You can instead use the line shown in <span class="content_text">Listing 4-12</span>:</p><a name="//apple_ref/doc/uid/20001712-CHDDFFFJ" title="Listing 4-12LDebugStream.cp modification at line 1150"></a><p class="codesample"><strong>Listing 4-12&nbsp;&nbsp;</strong><code>LDebugStream.cp</code> modification at line 1150</p><div class="codesample"><table><tr><td scope="row"><pre>const UInt8* theFirstByte = ((const UInt8*) inPtr);<span></span></pre></td></tr></table></div><p>In <code>LCommanderTree.cp</code> (at line 87) and in <code>LPaneTree.cp</code> (at line 81), you’ll have to modify the following lines (which have a slightly different error message in <code>LPaneTree.cp</code>):</p><div class="codesample"><table><tr><td scope="row"><pre>#if __option(RTTI)<span></span></pre></td></tr><tr><td scope="row"><pre>    #include &lt;typeinfo><span></span></pre></td></tr><tr><td scope="row"><pre>#else<span></span></pre></td></tr><tr><td scope="row"><pre>    #error "RTTI option disabled -- Must be enabled for LCommanderTree to function"<span></span></pre></td></tr><tr><td scope="row"><pre>#endif<span></span></pre></td></tr></table></div>	<p>You can instead use the lines shown in <span class="content_text">Listing 4-13</span>:</p><a name="//apple_ref/doc/uid/20001712-CHDBJFII" title="Listing 4-13Modification to LCommanderTree.cp at line 87 (and to LPaneTree.cp at line 81)"></a><p class="codesample"><strong>Listing 4-13&nbsp;&nbsp;</strong>Modification to <code>LCommanderTree.cp</code> at line 87 (and to <code>LPaneTree.cp</code> at line 81)</p><div class="codesample"><table><tr><td scope="row"><pre>#ifdef __GNUC__<span></span></pre></td></tr><tr><td scope="row"><pre>    #include &lt;typeinfo><span></span></pre></td></tr><tr><td scope="row"><pre>#else<span></span></pre></td></tr><tr><td scope="row"><pre>    #if __option(RTTI)<span></span></pre></td></tr><tr><td scope="row"><pre>        #include &lt;typeinfo><span></span></pre></td></tr><tr><td scope="row"><pre>    #else<span></span></pre></td></tr><tr><td scope="row"><pre>        #error "RTTI option disabled -- Must be enabled for LCommanderTree<span></span></pre></td></tr><tr><td scope="row"><pre>to function"<span></span></pre></td></tr><tr><td scope="row"><pre>    #endif<span></span></pre></td></tr><tr><td scope="row"><pre>#endif<span></span></pre></td></tr></table></div>	

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../mig_importing/migration_importing.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../UsingPPlantInUniversalBinaries/UsingPPlantInUniversalBinaries.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2003, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-10-26<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/DeveloperTools/Conceptual/MovingProjectsToXcode/mig_after_importing/mig_after_importing.html%3Fid%3D20001708-5.6&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/DeveloperTools/Conceptual/MovingProjectsToXcode/mig_after_importing/mig_after_importing.html%3Fid%3D20001708-5.6&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/DeveloperTools/Conceptual/MovingProjectsToXcode/mig_after_importing/mig_after_importing.html%3Fid%3D20001708-5.6&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>