<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Summary of the LAP Manager(IM:N)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING256></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Networking-255.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Networking-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Networking-304.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt= "Book Index"></A> <A HREF="Networking-257.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Networking-2.html"><B>Networking</B></A> / <BR><DD><A HREF="Networking-235.html"><B>Chapter 10 - Link-Access Protocol (LAP) Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING256-0></A>
<H1>Summary of the LAP Manager</H1>
<A NAME=HEADING256-1></A>
<H2>Pascal Summary</H2>
<A NAME=HEADING256-2></A>
<H3>Constants</H3>
<PRE>
CONST
   {Transition Queue transition types}
   ATTransOpen          =        0;       {AppleTalk has been opened}
   ATTransClose         =        2;       {AppleTalk is about to close}
   ATTransClosePrep     =        3;       {permission to close AppleTalk}
   ATTransCancelClose   =        4;       {cancel the ClosePrep transition}

{To use the following six constants, you must first declare them in your }
{ application. They are not included in the MPW interface files.}
   ATTransNetworkTransition   =  5;       {change in network connection for }
                                          { Apple Remote Access (ARA)}
   ATTransNameChangeTellTask  =  6;       {flagship name change}
   ATTransNameChangeAskTask   =  7;       {permission to change flagship }
                                          { name}
   ATTransCancelNameChange    =  8;       {cancel flagship name change}
   ATTransCableChange         =  'rnge';  {change in cable range}
   ATTransSpeedChange         =  'sped';  {change in CPU speed}
</PRE>
<A NAME=HEADING256-4></A>
<H3>Data Types</H3>
<A NAME=HEADING256-5></A>
<H4>AppleTalk Transition Queue Entry</H4>
<PRE>
TYPE ATQEntry = 
RECORD
   qLink:      ATQEntryPtr;      {next queue entry}
   qType:      Integer;          {reserved}
   CallAddr:   ProcPtr;          {pointer to your routine}
END;

ATQEntryPtr = ^ATQEntry;
</PRE>
<A NAME=HEADING256-7></A>
<H3>Routines</H3>
<A NAME=HEADING256-8></A>
<H4>Adding and Removing AppleTalk Transition Queue Entries</H4>
<PRE>
FUNCTION LAPAddATQ(theATQEntry: ATQEntryPtr): OSErr;
FUNCTION LAPRmvATQ(theATQEntry: ATQEntryPtr): OSErr;
</PRE>
<A NAME=HEADING256-11></A>
<H4>Notifying Routines When Your Application-Defined Transition Occurs</H4>
<PRE>
PROCEDURE ATEvent(event: LongInt; infoPtr: Ptr);
FUNCTION ATPreFlightEvent(event: LongInt; cancel: LongInt; infoPtr: Ptr):
OSErr;
</PRE>
<A NAME=HEADING256-14></A>
<H2>C Summary</H2>
<A NAME=HEADING256-15></A>
<H3>Constants</H3>
<PRE>
/*LAP Manager parameter constants*/
#define LAPprotType LAP.protType
#define LAPwdsPointer LAP.LAPptrs.wdsPointer
#define LAPhandler LAP.LAPptrs.handler

enum {                                    /*AppleTalk Transition Queue */
                                          /* transition types*/
ATTransOpen                =     0,       /*AppleTalk has opened*/
ATTransClose               =     2,       /*AppleTalk is about to close*/
ATTransClosePrep           =     3,       /*permission to close AppleTalk*/
ATTransCancelClose         =     4,       /*cancel ClosePrep transition*/

/*To use the following six constants, you must first define them in */
/* your application. They are not defined in the MPW interface files.*/
ATTransNetworkTransition   =     5,       /*change in network connection */
                                          /* for ARA*/
ATTransNameChangeTellTask  =     6,       /*flagship name change*/
ATTransNameChangeAskTask   =     7,       /*permission to change */
                                          /* flagship name*/
ATTransCancelNameChange    =     8,       /*cancel flagship name change*/
ATTransCableChange         =     'rnge',  /*change in cable range*/ 
ATTransSpeedChange         =     'sped',  /*change in CPU speed*/
};
</PRE>
<A NAME=HEADING256-17></A>
<H3>Data Types</H3>
<A NAME=HEADING256-18></A>
<H4>AppleTalk Transition Queue Entry</H4>
<PRE>
struct ATQEntry {
   struct ATQEntry   *qLink;        /*reserved*/
   short             qType;         /*reserved*/
   ProcPtr           CallAddr;      /*pointer to your routine*/
};

typedef struct ATQEntry ATQEntry;
typedef ATQEntry *ATQEntryPtr;
</PRE>
<A NAME=HEADING256-20></A>
<H3>Routines</H3>
<A NAME=HEADING256-21></A>
<H4>Adding and Removing AppleTalk Transition Queue Entries</H4>
<PRE>
pascal OSErr LAPAddATQ(ATQEntryPtr theATQEntry); 
pascal OSErr LAPRmvATQ(ATQEntryPtr theATQEntry);
</PRE>
<A NAME=HEADING256-24></A>
<H4>Notifying Routines When Your Application-Defined Transition Occurs</H4>
<PRE>
pascal void ATEvent(long event, Ptr infoPtr);
pascal OSErr ATPreFlightEvent(long event, long cancel, Ptr 
infoPtr); 
</PRE>
<A NAME=HEADING256-27></A>
<H2>Assembly-Language Summary</H2>
<A NAME=HEADING256-28></A>
<H3>Constants</H3>
<PRE>
;routine selectors to attach and detach an 802.2 protocol handler
L802Attach           EQU    21         ;attach an 802.2 protocol handler
L802Detach           EQU    22         ;detach an 802.2 protocol handler

;miscellaneous LAP Manager values
LAPMgrPtr            EQU   $B18        ;entry point for LAP Manager
LAPMgrCall           EQU   2           ;offset to LAP routines
LAddAEQ              EQU   23          ;LAPAddATQ routine selector
LRmvAEQ              EQU   24          ;LAPRmvATQ routine selector
</PRE>
<A NAME=HEADING256-30></A>
<H3>Data Structures</H3>
<A NAME=HEADING256-31></A>
<H4>AppleTalk Transition Queue Entry Data Structure
<TABLE BORDER="0" CELLPADDING=3><TD>0<TD>AeQQLink<TD>long<TD>next queue entry<TR>
<TD>4<TD>AeQQType<TD>word<TD>reserved<TR>
<TD>6<TD>AeQCallAddr<TD>long<TD>pointer to your transition event handler routine</TABLE>
</H4>
<A NAME=HEADING256-32></A>
<H2>Result Codes
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error, or unrecognized event code<TR>
<TD>qErr<TD>-1<TD>Queue element not found</TABLE>
</H2>
 <P>
</BLOCKQUOTE><P>

</BLOCKQUOTE>
<HR>
<center>
<A HREF="Networking-255.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Networking-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Networking-304.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt= "Book Index"></A> <A HREF="Networking-257.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Networking-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
