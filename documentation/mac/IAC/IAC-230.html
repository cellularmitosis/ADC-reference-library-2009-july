<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Summary of Creating and Sending Apple Events(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING230></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-229.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-231.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-195.html"><B>Chapter 5 - Creating and Sending Apple Events</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING230-0></A>
<H1><A NAME=MARKER-9-199></A>Summary of Creating and Sending Apple Events</H1>
<A NAME=HEADING230-1></A>
<H2>Pascal Summary</H2>
<A NAME=HEADING230-2></A>
<H3>Constants</H3>
<PRE>
CONST 
   gestaltAppleEventsAttr     = 'evnt';   {selector for Apple events}
   gestaltAppleEventsPresent  = 0;        {if this bit is set, then Apple }
                                          { Event Manager is available}

   {Apple event descriptor types}
   typeBoolean             = 'bool';      {1-byte Boolean value}
   typeChar                = 'TEXT';      {unterminated string}
   typeSMInt               = 'shor';      {16-bit integer}
   typeInteger             = 'long';      {32-bit integer}
   typeSMFloat             = 'sing';      {SANE single}
   typeFloat               = 'doub';      {SANE double}
   typeLongInteger         = 'long';      {32-bit integer}
   typeShortInteger        = 'shor';      {16-bit integer}
   typeLongFloat           = 'doub';      {SANE double}
   typeShortFloat          = 'sing';      {SANE single}
   typeExtended            = 'exte';      {SANE extended}
   typeComp                = 'comp';      {SANE comp}
   typeMagnitude           = 'magn';      {unsigned 32-bit integer}
   typeAEList              = 'list';      {list of descriptor records}
   typeAERecord            = 'reco';      {list of keyword-specified }
                                          { descriptor records}
   typeAppleEvent          = 'aevt';      {Apple event record}
   typeTrue                = 'true';      {TRUE Boolean value}
   typeFalse               = 'fals';      {FALSE Boolean value}
   typeAlias               = 'alis';      {alias record}
   typeEnumerated          = 'enum';      {enumerated data}
   typeType                = 'type';      {four-character code for }
                                          { event class or event ID}
   typeAppParameters       = 'appa';      {Process Manager launch parameters}
   typeProperty            = 'prop';      {Apple event property}
   typeFSS                 = 'fss ';      {file system specification}
   typeKeyword             = 'keyw';      {Apple event keyword}
   typeSectionH            = 'sect';      {handle to a section record}
   typeWildCard            = '****';      {matches any type}
   typeApplSignature       = 'sign';      {application signature}
   typeSessionID           = 'ssid';      {session reference number}
   typeTargetID            = 'targ';      {target ID record}
   typeProcessSerialNumber = 'psn ';      {process serial number}
   typeNull                = 'null';      {NULL or nonexistent data}
   
   {keywords for Apple event parameters}
   keyDirectObject         = '----';      {direct parameter}
   keyErrorNumber          = 'errn';      {error number parameter}
   keyErrorString          = 'errs';      {error string parameter}
   keyProcessSerialNumber  = 'psn ';      {process serial number param}

   {keywords for Apple event attributes}
   keyTransactionIDAttr    = 'tran';      {transaction ID}
   keyReturnIDAttr         = 'rtid';      {return ID}
   keyEventClassAttr       = 'evcl';      {event class}
   keyEventIDAttr          = 'evid';      {event ID}
   keyAddressAttr          = 'addr';      {address of target or }
                                          { client application}
   keyOptionalKeywordAttr  = 'optk';      {list of optional parameters }
                                          { for the Apple event}
   keyTimeoutAttr          = 'timo';      {number of ticks the client }
                                          { will wait}
   keyInteractLevelAttr    = 'inte';      {settings to allow Apple Event }
                                          { Manager to bring server }
                                          { to foreground}
   keyEventSourceAttr      = 'esrc';      {nature of source }
                                          { application}
   keyMissedKeywordAttr    = 'miss';      {first required parameter }
                                          { remaining in an Apple event}
   keyOriginalAddressAttr  = 'from';      {address of original source; }
                                          { available only in version } 
                                          { 1.01 and later versions of }
                                          { the Apple Event Manager}

   {keywords for special handlers}
   keyPreDispatch          = 'phac';      {identifies a handler routine }
                                          { called immediately before the }
                                          { Apple Event Manager dispatches }
                                          { an Apple event}


   keySelectProc           = 'selh';      {selector used with }
                                          { AERemoveSpecialHandler to }
                                          { disable the OSL}

   {keywords for use with AEManagerInfo; available only in version }
   { 1.0.1 and later versions of the Apple Event Manager}
   keyAERecorderCount      = 'recr';      {keyword for recording info}
   keyAEVersion            = 'vers';      {keyword for version info}

   {event class}
   kCoreEventClass         = 'aevt';      {event class for required Apple }
                                          { events}

   {event IDs for required Apple events}
   kAEOpenApplication      = 'oapp';      {event ID for Open }
                                          { Application event}
   kAEOpenDocuments        = 'odoc';      {event ID for Open Documents event}
   kAEPrintDocuments       = 'pdoc';      {event ID for Print Documents }
                                          { event}
   kAEQuitApplication      = 'quit';      {event ID for Quit Application }
                                          { event}
   kAEAnswer               = 'ansr';      {event ID for Apple event replies}
   kAEApplicationDied      = 'obit';      {event ID for Application Died }
                                          { event}

   {constants for setting the sendMode parameter of AESend}
   kAENoReply              = $00000001;   {client doesn't want reply}
   kAEQueueReply           = $00000002;   {client wants server to }
                                          { reply in event queue}
   kAEWaitReply            = $00000003;   {client wants a reply and }
                                          { will give up processor}
   kAENeverInteract        = $00000010;   {server application should }
                                          { not interact with user }
                                          { for this Apple event}
   kAECanInteract          = $00000020;   {server may interact with }
                                          { user for this Apple event }
                                          { to supply information}

   kAEAlwaysInteract       = $00000030;   {server may interact with user }
                                          { for this Apple event even if }
                                          { no information is required}
   kAECanSwitchLayer       = $00000040;   {server should come directly }
                                          { to foreground when appropriate}
   kAEDontReconnect        = $00000080;   {don't reconnect if there }
                                          { is a PPC session closed error}
   kAEWantReceipt          = nReturnReceipt; {client wants return }
                                          { receipt}
   kAEDontRecord           = $00001000;   {don't record this event}
   kAEDontExecute          = $00002000;   {don't excecute this event}

   {constants for setting the sendPriority parameter of AESend}
   kAENormalPriority       = $00000000;   {put event at back of }
                                          { event queue}
   kAEHighPriority         = nAttnMsg;    {put event at front of }
                                          { the event queue}

   {event IDs for recording events; available only in version 1.01 and }
   { later versions of the Apple Event Manager}
   kAEStartRecording       = 'reca';      {event ID for Start Recording }
                                          { event}
   kAEStopRecording        = 'recc';      {event ID for Stop Recording }
                                          { event}
   kAENotifyStartRecording = 'rec1';      {event ID for Recording On event}
   kAENotifyStopRecording  = 'rec0';      {event ID for Recording Off event}
   kAENotifyRecording      = 'recr';      {event ID for Receive Recordable }
                                          { Event event}

   {constant for the returnID parameter of AECreateAppleEvent}
   kAutoGenerateReturnID   = -1;          {tells Apple Event Manager to }
                                          { generate a unique return ID}

   {constant for transaction IDs}
   kAnyTransactionID       = 0;           {the Apple event is not }
                                          { part of a transaction}

   {constants for timeout durations}
   kAEDefaultTimeout       = -1;          {use default timeout value}
   kNoTimeOut              = -2;          {never time out}

   {constants for the dispatcher parameter of AEResumeTheCurrentEvent}
   kAENoDispatch           = 0;           {don't redispatch the Apple event}
   kAEUseStandardDispatch  = -1;          {redispatch the Apple event }
                                          { by using its entry in the }
                                          { Apple event dispatch table}
</PRE>
<A NAME=HEADING230-4></A>
<H3>Data Types</H3>
<PRE>
TYPE
   AEEventClass = 
      PACKED ARRAY[1..4] OF Char;            {event class for a high-level }
                                             { event}
   AEEventID = 
      PACKED ARRAY[1..4] OF Char;            {event ID for a high-level }
                                             { event}

   AEKeyword = 
      PACKED ARRAY[1..4] OF Char;            {keyword for a descriptor }
                                             { record}

   DescType                   = ResType;     {descriptor type}

   AEDesc =                                  {descriptor record}
   RECORD
      descriptorType:         DescType;      {type of data being passed}
      dataHandle:             Handle;        {handle to data being passed}
   END;

   AEKeyDesc =                               {keyword-specified }
   RECORD                                    { descriptor record}
      descKey:                AEKeyword;     {keyword}
      descContent:            AEDesc;        {descriptor record}
   END;

   AEAddressDesc              = AEDesc;      {address descriptor record}

   AEDescList                 = AEDesc;      {list of descriptor records}

   AERecord                   = AEDescList;  {list of keyword-specified }
                                             { descriptor records}

   AppleEvent                 = AERecord;    {list of attributes and }
                                             { parameters necessary for }
                                             { an Apple event}
   AESendMode                 = LongInt;     {flags that determine how }
                                             { an Apple event is sent}

   AESendPriority             = Integer;     {send priority of an Apple }
                                             { event}
   AEInteractAllowed = (kAEInteractWithSelf, kAEInteractWithLocal,
                        kAEInteractWithAll); {what processes may }
                                             { interact with the user}

   AEEventSource = (kAEUnknownSource, kAEDirectCall, kAESameProcess,
                    kAELocalProcess, kAERemoteProcess);
                                             {the source of an Apple }
                                             { event}

   AEArrayType = (kAEDataArray, kAEPackedArray, kAEHandleArray, 
                  kAEDescArray, kAEKeyDescArray);
                                             {type of an Apple event array}
   AEArrayData = 
   RECORD                                    {data for an Apple event array}
      CASE AEArrayType OF
      kAEDataArray:
         (AEDataArray: ARRAY[0..0] OF Integer);
      kAEPackedArray:
         (AEPackedArray: Packed Array[0..0] OF Char);
      kAEHandleArray:
         (AEHandleArray: Array[0..0] OF Handle);
      kAEDescArray:
         (AEDescArray: Array[0..0] OF AEDesc);
      kAEKeyDescArray:
         (AEKeyDescArray: Array[0..0] OF AEKeyDesc);
   END;
   
   AEArrayDataPointer = ^AEArrayData;

   EventHandlerProcPtr = ProcPtr;            {pointer to an Apple event }
                                             { handler}
   IdleProcPtr = ProcPtr;                    {pointer to an application's }
                                             { idle function}
   EventFilterProcPtr = ProcPtr;             {pointer to an application's }
                                             { filter function}
</PRE>
<A NAME=HEADING230-7></A>
<H3>Routines for Creating and Sending Apple Events</H3>
<A NAME=HEADING230-8></A>
<H4>Creating Apple Events</H4>
<PRE>
FUNCTION AECreateAppleEvent(theAEEventClass: AEEventClass; 
theAEEventID: AEEventID; 
target: AEAddressDesc; returnID: Integer; 
transactionID: LongInt; 
VAR result: AppleEvent): OSErr;
</PRE>
<A NAME=HEADING230-10></A>
<H4>Creating and Duplicating Descriptor Records</H4>
<PRE>
FUNCTION AECreateDesc(typeCode: DescType; dataPtr: Ptr; 
dataSize: Size; VAR result: AEDesc): OSErr;
FUNCTION AEDuplicateDesc(theAEDesc: AEDesc; VAR result: AEDesc): OSErr;
</PRE>
<A NAME=HEADING230-13></A>
<H4>Creating Descriptor Lists and AE Records</H4>
<PRE>
FUNCTION AECreateList(factoringPtr: Ptr; factoredSize: Size; 
isRecord: Boolean; 
VAR resultList: AEDescList): OSErr;
</PRE>
<A NAME=HEADING230-15></A>
<H4>Adding Items to Descriptor Lists</H4>
<PRE>
FUNCTION AEPutPtr(theAEDescList: AEDescList; index: LongInt; 
typeCode: DescType; dataPtr: Ptr; 
dataSize: Size): OSErr;
FUNCTION AEPutDesc(theAEDescList: AEDescList; index: LongInt; 
theAEDesc: AEDesc): OSErr;
FUNCTION AEPutArray(theAEDescList: AEDescList; 
arrayType: AEArrayType; 
arrayPtr: AEArrayDataPointer; 
itemType: DescType; itemSize: Size; 
itemCount: LongInt): OSErr;
</PRE>
<A NAME=HEADING230-19></A>
<H4>Adding Data and Descriptor Records to AE Records</H4>
<PRE>
FUNCTION AEPutKeyPtr(theAERecord: AERecord; 
theAEKeyword: AEKeyword; typeCode: DescType; 
dataPtr: Ptr; dataSize: Size): OSErr;
FUNCTION AEPutKeyDesc(theAERecord: AERecord; 
theAEKeyword: AEKeyword; 
theAEDesc: AEDesc): OSErr;
</PRE>
<A NAME=HEADING230-22></A>
<H4>Adding Parameters and Attributes to Apple Events</H4>
<PRE>
FUNCTION AEPutParamPtr(theAppleEvent: AppleEvent; 
theAEKeyword: AEKeyword; typeCode: DescType; 
dataPtr: Ptr; dataSize: Size): OSErr;
FUNCTION AEPutParamDesc(theAppleEvent: AppleEvent; 
theAEKeyword: AEKeyword; 
theAEDesc: AEDesc): OSErr;
FUNCTION AEPutAttributePtr(theAppleEvent: AppleEvent; 
theAEKeyword: AEKeyword; typeCode: DescType; 
dataPtr: Ptr; dataSize: Size): OSErr;
FUNCTION AEPutAttributeDesc(theAppleEvent: AppleEvent; 
theAEKeyword: AEKeyword; 
theAEDesc: AEDesc): OSErr;
</PRE>
<A NAME=HEADING230-27></A>
<H4>Sending Apple Events</H4>
<PRE>
FUNCTION AESend(theAppleEvent: AppleEvent; 
VAR reply: AppleEvent; sendMode: AESendMode; 
sendPriority: AESendPriority; 
timeOutInTicks: LongInt; 
idleProc: IdleProcPtr; 
filterProc: EventFilterProcPtr): OSErr;
</PRE>
<A NAME=HEADING230-29></A>
<H3>Application-Defined Routines</H3>
<PRE>
FUNCTION MyIdleFunction(VAR event: EventRecord;
VAR sleepTime: LongInt; 
VAR mouseRgn: RgnHandle): Boolean;
FUNCTION MyReplyFilter(VAR event: EventRecord; 
returnID: LongInt; transactionID: LongInt; 
sender: AEAddressDesc): Boolean;
</PRE>
<A NAME=HEADING230-32></A>
<H2>C Summary</H2>
<A NAME=HEADING230-33></A>
<H3>Constants</H3>
<PRE>
enum {
      #define gestaltAppleEventsAttr     'evnt' /*selector for Apple events*/
      gestaltAppleEventsPresent        = 0   /*if this bit is set, then */
                                             /* Apple Event Manager is */
};                                           /* available*/

      /*Apple event descriptor types*/
enum  {
      typeBoolean             = 'bool',      /*1-byte Boolean value*/
      typeChar                = 'TEXT',      /*unterminated string*/
      typeSMInt               = 'shor',      /*16-bit integer*/
      typeInteger             = 'long',      /*32-bit integer*/
      typeSMFloat             = 'sing',      /*SANE single*/
      typeFloat               = 'doub',      /*SANE double*/
      typeLongInteger         = 'long',      /*32-bit integer*/
      typeShortInteger        = 'shor',      /*16-bit integer*/
      typeLongFloat           = 'doub',      /*SANE double*/
      typeShortFloat          = 'sing',      /*SANE single*/
      typeExtended            = 'exte',      /*SANE extended*/
      typeComp                = 'comp',      /*SANE comp*/
      typeMagnitude           = 'magn',      /*unsigned 32-bit integer*/
      typeAEList              = 'list',      /*list of descriptor records*/
      typeAERecord            = 'reco',      /*list of keyword-specified */
                                             /* descriptor records*/
      typeAppleEvent          = 'aevt',      /*Apple event record*/
      typeTrue                = 'true',      /*TRUE Boolean value*/
      typeFalse               = 'fals',      /*FALSE Boolean value*/
      typeAlias               = 'alis',      /*alias record*/
      typeEnumerated          = 'enum'       /*enumerated data*/
};

enum {
      typeType                = 'type',      /*four-character code for */
                                             /* event class or event ID*/
      typeAppParameters       = 'appa',      /*Process Manager launch */
                                             /* parameters*/
      typeProperty            = 'prop',      /*Apple event property*/
      typeFSS                 = 'fss ',      /*file system specification*/
      typeKeyword             = 'keyw',      /*Apple event keyword*/

      typeSectionH            = 'sect',      /*handle to a section record*/
      typeWildCard            = '****',      /*matches any type*/
      typeApplSignature       = 'sign',      /*application signature*/
      typeSessionID           = 'ssid',      /*session ID*/
      typeTargetID            = 'targ',      /*target ID record*/
      typeProcessSerialNumber = 'psn ',      /*process serial number*/
      typeNull                = 'null'       /*NULL or nonexistent data*/
};

      /*keywords for Apple event parameters*/
enum {
      keyDirectObject         = '----',      /*direct parameter*/
      keyErrorNumber          = 'errn',      /*error number parameter*/
      keyErrorString          = 'errs',      /*error string parameter*/
      keyProcessSerialNumber  = 'psn '       /*process serial number param*/
};
      /*keywords for Apple event attributes*/
enum {
      keyTransactionIDAttr    = 'tran',      /*transaction ID*/
      keyReturnIDAttr         = 'rtid',      /*return ID*/
      keyEventClassAttr       = 'evcl',      /*event class*/
      keyEventIDAttr          = 'evid',      /*event ID*/
      keyAddressAttr          = 'addr',      /*address of target or */
                                             /* client application*/
      keyOptionalKeywordAttr  = 'optk',      /*list of optional parameters */
                                             /* for the Apple event*/
      keyTimeoutAttr          = 'timo',      /*number of ticks the client */
                                             /* will wait*/
      keyInteractLevelAttr    = 'inte',      /*settings to allow Apple */
                                             /* Event Mgr to bring */
                                             /* server to foreground*/
      keyEventSourceAttr      = 'esrc',      /*nature of source */
                                             /* application*/
      keyMissedKeywordAttr    = 'miss',      /*first required parameter */
                                             /* remaining in an Apple */
                                             /* event*/
      keyOriginalAddressAttr  = 'from'       /*address of original source; */
                                             /* available only in version */ 
                                             /* 1.01 and later versions of */
                                             /* the Apple Event Manager*/
};
      
      /*keywords for special handlers*/
enum {
      keyPreDispatch          = 'phac',      /*identifies a handler */
                                             /* routine that is called */
                                             /* immediately before the */
                                             /* Apple Event Manager */
                                             /* dispatches an Apple event*/
      keySelectProc           = 'selh',      /*selector used with */
                                             /* AERemoveSpecialHandler to */
                                             /* disable the OSL*/
      /*keywords for use with AEManagerInfo, available only in version */
      /* 1.0.1 and later versions of the Apple Event Manager*/
      keyAERecorderCount      = 'recr',      /*keyword for recording info*/
      keyAEVersion            = 'vers',      /*keyword for version info*/

      /*event class*/
      kCoreEventClass         = 'aevt'       /*event class for required */
                                             /* Apple events*/
};

      /*event IDs for required Apple events*/
enum {
      kAEOpenApplication      = 'oapp',      /*event ID for Open */
                                             /* Application event*/
      kAEOpenDocuments        = 'odoc',      /*event ID for Open */
                                             /* Documents event*/

      kAEPrintDocuments       = 'pdoc',      /*event ID for Print */
                                             /* Documents event*/
      kAEQuitApplication      = 'quit',      /*event ID for Quit */
                                             /* Application event*/
      kAEAnswer               = 'ansr',      /*event ID for Apple event */
                                             /* replies*/
      kAEApplicationDied      = 'obit'       /*event ID for Application */
                                             /* Died event*/
};
      /*constants for setting the sendMode parameter of AESend*/
enum {
      kAENoReply              = 0x00000001,  /*client doesn't want reply*/
      kAEQueueReply           = 0x00000002,  /*client wants server to */
                                             /* reply in event queue*/
      kAEWaitReply            = 0x00000003,  /*client wants a reply and */
                                             /* will give up processor*/
      kAENeverInteract        = 0x00000010,  /*server application should */
                                             /* not interact with user */
                                             /* for this Apple event*/
      kAECanInteract          = 0x00000020,  /*server may interact with */
                                             /* user for this Apple event */
                                             /* to supply information*/
      kAEAlwaysInteract       = 0x00000030,  /*server may interact with */
                                             /* user for this Apple event */
                                             /* even if no information */
                                             /* is required*/
      kAECanSwitchLayer       = 0x00000040,  /*server should come */
                                             /* directly to foreground */
                                             /* when appropriate*/
      kAEDontReconnect        = 0x00000080,  /*don't reconnect if there */
                                             /* is a PPC session closed */
                                             /* error*/
      kAEWantReceipt          = nReturnReceipt, /*client wants return */
                                             /* receipt*/
      kAEDontRecord           = 0x00001000,  /*don't record this event*/
      kAEDontExecute          = 0x00002000,  /*don't excecute this event*/

      /*constants for setting the sendPriority parameter of AESend*/
      kAENormalPriority       = 0x00000000,  /*post message at end of */
                                             /* event queue*/
      kAEHighPriority         = nAttnMsg     /*post message at front of */
                                             /* event queue*/
};
      /*event IDs for recording events; available only in version 1.01 and */
      /* later versions of the Apple Event Manager*/
enum {
      kAEStartRecording       = 'reca',      /*event ID for Start */
                                             /* Recording event*/
      kAEStopRecording        = 'recc',      /*event ID for Stop */
                                             /* Recording event*/
      kAENotifyStartRecording = 'rec1',      /*event ID for Recording On */
                                             /* event*/
      kAENotifyStopRecording  = 'rec0',      /*event ID for Recording Off */
                                             /* event*/
      kAENotifyRecording      = 'recr'       /*event ID for Receive */
                                             /* Recordable Event event*/
};
enum {
      /*constant for the returnID parameter of AECreateAppleEvent*/
      kAutoGenerateReturnID   = -1,          /*tells Apple Event Manager */
                                             /* to generate a unique */
                                             /* return ID*/
      /*constant for transaction IDs*/
      kAnyTransactionID       = 0,           /*the Apple event is not */
                                             /* part of a transaction*/

      /*constants for timeout durations*/
      kAEDefaultTimeout       = -1,          /*use default timeout value*/
      kNoTimeOut              = -2,          /*never time out*/
      /*constants for the dispatcher parameter of AEResumeTheCurrentEvent*/
      kAENoDispatch           = 0,           /*don't redispatch the */
                                             /* Apple event*/
      kAEUseStandardDispatch  = -1        /*redispatch the Apple event */
                                             /* by using its entry in the */
                                             /* Apple event dispatch table*/
};
</PRE>
<A NAME=HEADING230-35></A>
<H3>Data Types</H3>
<PRE>
typedef unsigned long AEEventClass;          /*event class for a */
                                             /* high-level event*/
typedef unsigned long AEEventID;             /*event ID for a high-level */
                                             /* event*/
typedef unsigned long AEKeyword;             /*keyword for a descriptor */
                                             /* record*/
typedef ResType DescType;                    /*descriptor type*/

struct AEDesc {                              /*descriptor record*/
   DescType descriptorType;                  /*type of data being passed*/
   Handle dataHandle;                        /*handle to data being passed*/
};
typedef struct AEDesc AEDesc;

struct AEKeyDesc {                           /*keyword-specified */
                                             /* descriptor record*/
   AEKeyword descKey;                        /*keyword*/
   AEDesc descContent;                       /*descriptor record*/
};
typedef struct AEKeyDesc AEKeyDesc;

typedef AEDesc AEAddressDesc;                /*address descriptor record*/
typedef AEDesc AEDescList;                   /*list of descriptor records*/
typedef AEDescList AERecord;                 /*list of keyword-specified */
                                             /* descriptor records*/
typedef AERecord AppleEvent;                 /*list of attributes and */
                                             /* parameters necessary for */
                                             /* an Apple event*/
typedef long AESendMode;                     /*flags that determine how */
                                             /* an Apple event is sent*/



typedef short AESendPriority;                /*send priority of an Apple */
                                             /* event*/

enum { kAEInteractWithSelf, kAEInteractWithLocal,
       kAEInteractWithAll };                 /*what processes may */
typedef unsigned char AEInteractAllowed;     /* interact with the user*/

enum { kAEUnknownSource, kAEDirectCall, kAESameProcess, kAELocalProcess, 
       kAERemoteProcess };                   /*the source of an Apple */
typedef unsigned char AEEventSource;         /* event*/
enum { kAEDataArray, kAEPackedArray, kAEHandleArray, 
       kAEDescArray, kAEKeyDescArray };      /*type of an Apple event */
typedef unsigned char AEArrayType;           /* array*/

union AEArrayData {                          /*data for an Apple event */
   short kAEDataArray[1];                    /* array*/
   char kAEPackedArray[1];
   Handle kAEHandleArray[1];
   AEDesc kAEDescArray[1];
   AEKeyDesc kAEKeyDescArray[1];
};
typedef union AEArrayData AEArrayData;

typedef AEArrayData *AEArrayDataPointer;

typedef ProcPtr EventHandlerProcPtr;         /*pointer to an Apple event */
                                             /* handler*/
typedef ProcPtr IdleProcPtr;                 /*pointer to an application's */
                                             /* idle function*/
typedef ProcPtr EventFilterProcPtr;          /*pointer to an application's */
                                             /* filter function*/
</PRE>
<A NAME=HEADING230-37></A>
<H3>Routines for Creating and Sending Apple Events</H3>
<A NAME=HEADING230-38></A>
<H4>Creating Apple Events</H4>
<PRE>
pascal OSErr AECreateAppleEvent
(AEEventClass theAEEventClass, 
AEEventID theAEEventID, 
const AEAddressDesc *target, short returnID, long transactionID, AppleEvent *result);
</PRE>
<A NAME=HEADING230-41></A>
<H4>Creating and Duplicating Descriptor Records</H4>
<PRE>
pascal OSErr AECreateDesc(DescType typeCode, const void* dataPtr, 
Size dataSize, AEDesc *result);
pascal OSErr AEDuplicateDesc
(const AEDesc *theAEDesc, AEDesc *result);
</PRE>
<A NAME=HEADING230-45></A>
<H4>Creating Descriptor Lists and AE Records</H4>
<PRE>
pascal OSErr AECreateList(const void* factoringPtr, Size factoredSize, 
Boolean isRecord, AEDescList *resultList);
</PRE>
<A NAME=HEADING230-47></A>
<H4>Adding Items to Descriptor Lists</H4>
<PRE>
pascal OSErr AEPutPtr(const AEDescList *theAEDescList, long index, 
DescType typeCode, const void* dataPtr, 
Size dataSize);
pascal OSErr AEPutDesc(const AEDescList *theAEDescList, long index, 
const AEDesc *theAEDesc);
pascal OSErr AEPutArray(const AEDescList *theAEDescList, 
AEArrayType arrayType, 
const AEArrayDataPointer *arrayPtr, 
DescType itemType, Size itemSize, 
long itemCount);
</PRE>
<A NAME=HEADING230-51></A>
<H4>Adding Data and Descriptor Records to AE Records</H4>
<PRE>
pascal OSErr AEPutKeyPtr(const AERecord *theAERecord, 
AEKeyword theAEKeyword, DescType typeCode, 
const void* dataPtr, Size dataSize);
pascal OSErr AEPutKeyDesc(const AERecord *theAERecord, 
AEKeyword theAEKeyword, 
const AEDesc *theAEDesc);
</PRE>
<A NAME=HEADING230-54></A>
<H4>Adding Parameters and Attributes to Apple Events</H4>
<PRE>
pascal OSErr AEPutParamPtr(const AppleEvent *theAppleEvent, 
AEKeyword theAEKeyword, DescType typeCode, 
const void* dataPtr, Size dataSize);
pascal OSErr AEPutParamDesc(const AppleEvent *theAppleEvent, 
AEKeyword theAEKeyword, 
const AEDesc *theAEDesc);
pascal OSErr AEPutAttributePtr
(const AppleEvent *theAppleEvent, 
AEKeyword theAEKeyword, DescType typeCode, const void* dataPtr, Size dataSize);
pascal OSErr AEPutAttributeDesc
(const AppleEvent *theAppleEvent, 
AEKeyword theAEKeyword, 
const AEDesc *theAEDesc);
</PRE>
<A NAME=HEADING230-61></A>
<H4>Sending Apple Events</H4>
<PRE>
pascal OSErr AESend(const AppleEvent *theAppleEvent, 
AppleEvent *reply, AESendMode sendMode, 
AESendPriority sendPriority, 
long timeOutInTicks, IdleProcPtr idleProc, 
EventFilterProcPtr filterProc);
</PRE>
<A NAME=HEADING230-63></A>
<H3>Application-Defined Routines</H3>
<PRE>
pascal Boolean MyIdleFunction
(const EventRecord *event,
long *sleepTime, RgnHandle *mouseRgn);
pascal Boolean MyReplyFilter
(const EventRecord *event, 
long returnID, long transactionID,
AEAddressDesc sender);
</PRE>
<A NAME=HEADING230-68></A>
<H2><A NAME=MARKER-21-456></A>Assembly-Language Summary</H2>
<A NAME=HEADING230-69></A>
<H3>Trap Macros</H3>
<A NAME=HEADING230-70></A>
<H4><A NAME=MARKER-21-458></A>Trap Macros Requiring Routine Selectors</H4>
<PRE>
_<CODE>Pack8</CODE>
</PRE>
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Selector<TH>Routine<TR>
<TD>$0405<TD>AEDuplicateDesc<TR>
<TD>$0609<TD>AEPutDesc<TR>
<TD>$0610<TD>AEPutKeyDesc<TR>
<TD>$0610<TD>AEPutParamDesc<TR>
<TD>$0627<TD>AEPutAttributeDesc<TR>
<TD>$0706<TD>AECreateList<TR>
<TD>$0825<TD>AECreateDesc<TR>
<TD>$0A08<TD>AEPutPtr<TR>
<TD>$0A0F<TD>AEPutKeyPtr<TR>
<TD>$0A0F<TD>AEPutParamPtr<TR>
<TD>$0A16<TD>AEPutAttributePtr<TR>
<TD>$0B0D<TD>AEPutArray<TR>
<TD>$0B14<TD>AECreateAppleEvent<TR>
<TD>$0D17<TD>AESend</TABLE>


<A NAME=HEADING230-72></A>
<H2>Result Codes
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>paramErr<TD>-50<TD>Parameter error (for example, value of handler pointer is <CODE>NIL</CODE> or odd)<TR>
<TD>eLenErr<TD>-92<TD>Buffer too big to send<TR>
<TD>memFullErr<TD>-108<TD>Not enough room in heap zone<TR>
<TD>userCanceledErr<TD>-128<TD>User canceled an operation<TR>
<TD>procNotFound<TD>-600<TD>No eligible process with specified process serial number<TR>
<TD>bufferIsSmall<TD>-607<TD>Buffer is too small<TR>
<TD>noOutstandingHLE<TD>-608<TD>No outstanding high-level event<TR>
<TD>connectionInvalid<TD>-609<TD>Nonexistent signature or session ID<TR>
<TD>noUserInteractionAllowed<TD>-610<TD>Background application sends event requiring authentication<TR>
<TD><CODE>noPortErr</CODE><TD>-903<TD>Client hasn't set <CODE>'SIZE'</CODE> resource to indicate awareness of high-level events<TR>
<TD>destPortErr<TD>-906<TD>Server hasn't set <CODE>'SIZE'</CODE> resource to indicate awareness of high-level events, or else is not present<TR>
<TD>sessClosedErr<TD>-917<TD>The <CODE>kAEDontReconnect</CODE> flag in the <CODE>sendMode</CODE> parameter was set, and the server quit and then restarted<TR>
<TD>errAECoercionFail<TD>-1700<TD>Data could not be coerced to the requested descriptor type<TR>
<TD>errAEDescNotFound<TD>-1701<TD>Descriptor record was not found<TR>
<TD>errAECorruptData<TD>-1702<TD>Data in an Apple event could not be read<TR>
<TD>errAEWrongDataType<TD>-1703<TD>Wrong descriptor type<TR>
<TD>errAENotAEDesc<TD>-1704<TD>Not a valid descriptor record<TR>
<TD>errAEBadListItem<TD>-1705<TD>Operation involving a list item failed<TR>
<TD>errAENewerVersion<TD>-1706<TD>Need a newer version of the Apple Event Manager<TR>
<TD>errAENotAppleEvent<TD>-1707<TD>Event is not an Apple event<TR>
<TD>errAEEventNotHandled<TD>-1708<TD>Event wasn't handled by an Apple event handler<TR>
<TD>errAEReplyNotValid<TD>-1709<TD><CODE>AEResetTimer</CODE> was passed an invalid reply<TR>
<TD>errAEUnknownSendMode<TD>-1710<TD>Invalid sending mode was passed<TR>
<TD>errAEWaitCanceled<TD>-1711<TD>User canceled out of wait loop for reply or receipt<TR>
<TD>errAETimeout<TD>-1712<TD>Apple event timed out<TR>
<TD>errAENoUserInteraction<TD>-1713<TD>No user interaction allowed<TR>
<TD>errAENotASpecialFunction<TD>-1714<TD>The keyword is not valid for a special function<TR>
<TD>errAEParamMissed<TD>-1715<TD>Handler cannot understand a parameter the client considers required<TR>
<TD>errAEUnknownAddressType<TD>-1716<TD>Unknown Apple event address type<TR>
<TD>errAEHandlerNotFound<TD>-1717<TD>No handler found for an Apple event or a coercion, or no object callback function found<TR>
<TD>errAEReplyNotArrived<TD>-1718<TD>Reply has not yet arrived<TR>
<TD>errAEIllegalIndex<TD>-1719<TD>Not a valid list index<TR>
<TD>errAEImpossibleRange<TD>-1720<TD>The range is not valid because it is impossible for a range to include the first and last objects that were specified; an example is a range in which the offset of the first object is greater than the offset of the last object<TR>
<TD>errAEWrongNumberArgs<TD>-1721<TD>The number of operands provided for the <CODE>kAENot</CODE> logical operator is not 1<TR>
<TD>errAEAccessorNotFound<TD>-1723<TD>There is no object accessor function for the specified object class and token descriptor type<TR>
<TD>errAENoSuchLogical<TD>-1725<TD>The logical operator in a logical descriptor record is not <CODE>kAEAnd</CODE>, <CODE>kAEOr</CODE>, or <CODE>kAENot</CODE><TR>
<TD>errAEBadTestKey<TD>-1726<TD>The descriptor record in a test key is neither a comparison descriptor record nor a logical descriptor record<TR>
<TD>errAENotAnObjectSpec<TD>-1727<TD>The <CODE>objSpecifier</CODE> parameter of <CODE>AEResolve</CODE> is not an object specifier record<TR>
<TD>errAENoSuchObject<TD>-1728 <TD>A run-time resolution error, for example: object specifier record asked for the third element, but there are only two<TR>
<TD>errAENegativeCount<TD>-1729 <TD>Object-counting function returned negative value<TR>
<TD>errAEEmptyListContainer<TD>-1730<TD>The container for an Apple event object is specified by an empty list<TR>
<TD>errAEUnknownObjectType<TD>-1731<TD>Descriptor type of token returned by <CODE>AEResolve</CODE> is not known to server application <TR>
<TD>errAERecordingIsAlreadyOn<TD>-1732<TD>Attempt to turn recording on when it is already on</TABLE>
</H2>
 <P>
</BLOCKQUOTE><P>

</DL>
</B>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-229.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-231.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
