<html>	<head>		<meta name="generator" content="GoLive CyberStudio 3">		<script language="JavaScript" src="frametest.js"></script><TITLE>ATA_FindRefNum</title>	</head>	<body bgcolor="#ffffff">		<a name="top"></a><!-- start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!-- start of path --><table border="0" cellpadding="0" cellspacing="2" width="432">		<tr>	<td scope="row"><font face="Geneva,Helvetica,Arial" size="1">	<b>PATH<img src="../../../images/space.gif" width="6" height="12"></b>	<a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Documentation</a> &gt; <!-- a href="" target="_top" -->Hardware<!-- /a --> 	<b>&gt;</b> <a href="../../devicemgrs.html">Device Managers and Drivers</a>	<b>&gt;</b> <a href="../ata.html" target="_top">ATA Devices</a>	<b>&gt;</b> ATA Device Software Guide		</font></td>	</tr>	</table><br><!-- end of path --><p><A HREF="ATA.2a.html"><img src="images/up.gif" border="0"></A> <A HREF="ATA.35.html"><img src="images/previous.gif" border="0"></A> <A HREF="ATA.37.html"><img src="images/next.gif" border="0"></A> <!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></a></div><!-- end top navigation --><hr>		<h3 class="RoH.RoutineHeading"><a name="pgfId=1302"></a>ATA_FindRefNum</h3>		<p class="T0.Text0"><a name="pgfId=1303"></a>The <tt class="cv">ATA_FindRefNum</tt> function allows an application to determine whether a driver has been installed for a given device. You pass in a device ID and the function returns the current driver reference number registered for the given device. A value of 0 indicates that no driver has been registered. The <tt class="cv">deviceNextID</tt> field contains a device ID of the next device in the list. The end of the list is indicated with a value of <tt class="cv">0xFF</tt> .<a name="marker=1304"></a><a name="marker=1305"></a></p>		<p class="T1.Text1"><a name="pgfId=1306"></a>To create a list of all drivers for the attached devices, pass in <tt class="cv">0xFF</tt> for <tt class="cv">deviceID</tt> . This causes <tt class="cv">deviceNextID</tt> to be filled with the first device in the list. Each successive driver can be found by moving the value returned in <tt class="cv">deviceNextID</tt> into <tt class="cv">deviceID</tt> until the function returns <tt class="cv">0xFF</tt> in <tt class="cv">deviceNextID</tt> , which indicates the end of the list.</p>		<p class="T1.Text1"><a name="pgfId=1307"></a>The manager function code for the <tt class="cv">ATA_FindRefNum </tt>function is $86. </p>		<p class="T1.Text1"><a name="pgfId=1308"></a>The parameter block associated with this function for <tt class="cv">ataPBVers</tt> version 1 is defined as follows:</p>		<p><a name="pgfId=14983"></a><table>			<tr>				<td valign="top" colspan="2" scope="row"><tt>typedef</tt></td>				<td valign="top" width="100"><tt>struct</tt></td>				<td valign="top" width="200"><tt>Driver registration for */<br>					/* ataPBVers version 1 */<br>					</tt></td>			</tr>			<tr>				<td colspan="4" scope="row">{</td>			</tr>			<tr>				<td width="20" valign="top" scope="row"></td>				<td width="75" valign="top"><tt>ataPBHdr</tt></td>				<td width="100" valign="top"></td>				<td width="200"><tt>/* ataPBHdr parameter block */</tt></td>			</tr>			<tr>				<td width="20" valign="top" scope="row"></td>				<td width="75"></td>				<td width="100"></td>				<td width="200"></td>			</tr>			<tr>				<td width="20" valign="top" scope="row"></td>				<td width="75" valign="top"><tt>SInt16</tt></td>				<td width="100" valign="top"><tt>drvrRefNum;</tt></td>				<td width="200" valign="top"><tt>/* &lt;-- Contains the */<br>					/* driver refNum */<br>					</tt></td>			</tr>			<tr>				<td width="20" valign="top" scope="row"></td>				<td width="75" valign="top"><tt>UInt16</tt></td>				<td width="100" valign="top"><tt>FlagReserved;</tt></td>				<td width="200" valign="top"><tt>/* Reserved */</tt></td>			</tr>			<tr>				<td width="20" valign="top" scope="row"></td>				<td width="75" valign="top"><tt>UInt16</tt></td>				<td width="100" valign="top"><tt>deviceNextID;</tt></td>				<td width="200" valign="top"><tt>/* &lt;-- Contains the next */<br>					/* drive ID */<br>					</tt></td>			</tr>			<tr>				<td width="20" valign="top" scope="row"></td>				<td width="75" valign="top"><tt>SInt16</tt></td>				<td width="100" valign="top"><tt>Reserved[21];</tt></td>				<td width="200" valign="top"><tt>/* Reserved */</tt></td>			</tr>			<tr>				<td colspan="4" scope="row"><tt>} ataDrvrRegister;</tt></td>			</tr>		</table>		<p class="T1.Text1"><a name="pgfId=1319"></a>The parameter block associated with this function for <tt class="cv">ataPBVer</tt> version 2 is defined as follows:</p>		<p><code class="RD.RoutineDeclare"><a name="pgfId=14987"></a><table>			<tr>				<td valign="top" colspan="2" scope="row"><tt>typedef</tt></td>				<td valign="top" width="100"><tt>struct</tt></td>				<td valign="top" width="200"><tt>/* Driver registration for */<br>					/* ataPBVers version 2 */<br>					/* or greater */<br>					</tt></td>			</tr>			<tr>				<td colspan="4" scope="row">{</td>			</tr>			<tr>				<td width="20" valign="top" scope="row"></td>				<td width="75" valign="top"><tt>ataPBHdr</tt></td>				<td width="100" valign="top"></td>				<td width="200" valign="top"><tt>/* ataPBHdr parameter block */</tt></td>			</tr>			<tr>				<td width="20" valign="top" scope="row"></td>				<td width="75" valign="top"><tt>SInt16</tt></td>				<td width="100" valign="top"><tt>drvrRefNum;</tt></td>				<td width="200" valign="top"><tt>/* &lt;-- Driver reference number */</tt></td>			</tr>			<tr>				<td width="20" valign="top" scope="row"></td>				<td width="75" valign="top"><tt>UInt16</tt></td>				<td width="100" valign="top"><tt>drvrFlags;</tt></td>				<td width="200" valign="top"><tt>/* --&gt; Reserved, set to 0 */</tt></td>			</tr>			<tr>				<td width="20" valign="top" scope="row"></td>				<td width="75" valign="top"><tt>UInt16</tt></td>				<td width="100" valign="top"><tt>deviceNextID;</tt></td>				<td width="200" valign="top"><tt>/* Used to specify the next */<br>					/* drive ID */<br>					</tt></td>			</tr>			<tr>				<td width="20" valign="top" scope="row"></td>				<td width="75" valign="top"><tt>SInt16</tt></td>				<td width="100" valign="top"><tt>Reserved;</tt></td>				<td width="200" valign="top"><tt>/* Reserved (should be 0) */</tt></td>			</tr>			<tr>				<td width="20" valign="top" scope="row"></td>				<td width="75" valign="top"><tt>ProcPtr</tt></td>				<td width="100" valign="top"><tt>ataEHandlerPtr;</tt></td>				<td width="200" valign="top"><tt>/* &lt;-- Event handler routine */<br>					/* pointer */<br>					</tt></td>			</tr>			<tr>				<td width="20" valign="top" scope="row"></td>				<td width="75" valign="top"><tt>SInt32</tt></td>				<td width="100" valign="top"><tt>drvrContext;</tt></td>				<td width="200" valign="top"><tt>/* &lt;-- Value to pass in with */<br>					/* event handler */ <br>					</tt></td>			</tr>			<tr>				<td width="20" valign="top" scope="row"></td>				<td width="75" valign="top"><tt>UInt32</tt></td>				<td width="100" valign="top"><tt>ataEventMask;</tt></td>				<td width="200" valign="top"><tt>/* &lt;-- Current setting of the */<br>					/* mask of various events */<br>					/* for event handler */<br>					</tt></td>			</tr>			<tr>				<td width="20" valign="top" scope="row"></td>				<td width="75" valign="top"><tt>SInt16</tt></td>				<td width="100" valign="top"><tt>Reserved[14];</tt></td>				<td width="200" valign="top"><tt>/* Reserved */</tt></td>			</tr>			<tr>				<td colspan="4" scope="row"><tt>} ataDrvrRegister;</tt></td>			</tr></code>		</table>		<h4>Field descriptions</h4>		<dl compact>			<dt class="DT.DefinitionTerm"><a name="pgfId=14989"></a><tt class="cv">ataPBHdr</tt> </DT>			<dd class="DD.DefinitionDef"><a name="pgfId=1342"></a>See the definition of the<tt class="cv"> <a href="ATA.26.html" class="XRef">ataPBHdr</tt> parameter block</a>.</DD>			<dt class="DT.DefinitionTerm"><a name="pgfId=14998"></a><tt class="cv">drvrRefNum</tt> </DT>			<dd class="DD.DefinitionDef"><a name="pgfId=1343"></a>On return, this field contains the reference number for the device specified in the <tt class="cv">deviceID</tt> field of the <tt class="cv">ataPBHdr</tt> data. </DD>			<dt class="DT.DefinitionTerm"><a name="pgfId=15011"></a><tt class="cv">FlagReserved</tt> </DT>			<dd class="DD.DefinitionDef"><a name="pgfId=1344"></a>This field is reserved. To ensure future compatibility, all reserved fields should be set to 0.</DD>			<dt class="DT.DefinitionTerm"><a name="pgfId=15020"></a><tt class="cv">deviceNextID</tt> </DT>			<dd class="DD.DefinitionDef"><a name="pgfId=1345"></a>On return, this field contains the <tt class="cv">deviceID</tt> of the next device on the list.</DD>			<dt class="DT.DefinitionTerm"><a name="pgfId=15029"></a><tt class="cv">ataEHandlerPtr</tt> </DT>			<dd class="DD.DefinitionDef"><a name="pgfId=1346"></a>Currently registered event handler routine pointer for the selected device. This field is only valid for <tt class="cv">ataPBVers</tt> of 2 or greater.</DD>			<dt class="DT.DefinitionTerm"><a name="pgfId=15038"></a><tt class="cv">drvrContext</tt> </DT>			<dd class="DD.DefinitionDef"><a name="pgfId=1347"></a>Currently registered value to be passed along when the event handler is called. This field is only valid for <tt class="cv">ataPBVers</tt> of 2 or greater.</DD>			<dt class="DT.DefinitionTerm"><a name="pgfId=15047"></a><tt class="cv">ataEventMask</tt> </DT>			<dd class="DD.DefinitionDef"><a name="pgfId=1348"></a>Current event mask value for the selected device. This field is only valid for <tt class="cv">ataPBVers</tt> of 2 or greater.</DD>			<dt class="DT.DefinitionTerm"><a name="pgfId=15056"></a><tt class="cv">Reserved[</tt> <B>nn</B> <tt class="cv">]</tt></DT>			<dd class="DD.DefinitionDef"><a name="pgfId=1349"></a>Reserved. To ensure future compatibility, all reserved fields should be set to 0.</DD>		</dl>		<div>			<h5 class="RSb.RoutineSbhd"><a name="pgfId=1350"></a>RESULT CODES</H5>			<p class="T0.Text0"><a name="pgfId=1354"></a>See <a href="ATA.3a.html#37212" class="XRef">Table&nbsp;A-1</a> for possible result codes returned by the ATA Manager.</p>		</div>		<p>		<hr>		&copy; 1999 Apple Computer, Inc. </p>		<p><A HREF="ATA.2a.html"><img src="images/up.gif" border="0"></A> <A HREF="ATA.35.html"><img src="images/previous.gif" border="0"></A> <A HREF="ATA.37.html"><img src="images/next.gif" border="0"></A>  <!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!-- document.write(frameLink);//--></script></a><!-- end Show/Hide frames --></P><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer -->	</body></html>