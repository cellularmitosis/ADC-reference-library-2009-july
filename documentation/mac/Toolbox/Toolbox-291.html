<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>MyWindow(IM:Tb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING291></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Toolbox-290.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-292.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Toolbox-2.html"><B>Macintosh Toolbox Essentials</B></A> / <BR><DD><A HREF="Toolbox-188.html"><B>Chapter 4 - Window Manager</B></A> / <A HREF="Toolbox-213.html"><B>Window Manager Reference</B></A><BR><DL><DD><A HREF="Toolbox-289.html"><B>Application-Defined Routine</B></A> / <A HREF="Toolbox-290.html"><B>The Window Definition Function</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING291-0></A>
<H3>MyWindow</H3>
 The window definition function is responsible for drawing the window frame, reporting the region where mouse-down events occur, calculating the window's structure region and content region, drawing the size box, resizing the window frame when the user drags the size box, and performing any customized initialization or disposal tasks.<P>
 You can give your window definition function any name you wish. It takes four parameters and returns a result code:<P>
<PRE>
FUNCTION MyWindow (varCode: Integer; theWindow: WindowPtr; 
                     message: Integer; param: LongInt): LongInt;
</PRE>
<DL>
<DT><CODE>varCode</CODE>
<DD> The window's variation code.
<DT><CODE>theWindow</CODE>
<DD> A pointer to the window's window record.
<DT><CODE>message</CODE>
<DD> A code for the task to be performed. The <CODE>message</CODE> parameter has one of these values:
</DL>
<PRE>
            CONST
               wDraw       = 0;  {draw window frame}
               wHit        = 1;  {report where mouse-down event }
                                 { occurred}
               wCalcRgns   = 2;  {calculate strucRgn and contRgn}
               wNew        = 3;  {perform additional }
                                 { initialization}
               wDispose    = 4;  {perform additional disposal }
                                 { tasks}
               wGrow       = 5;  {draw grow image during resizing}
               wDrawGIcon  = 6;  {draw size box and scroll bar }
                                 { outline}
</PRE>
<DL>
<DT>
<DD>  The subsections that follow explain each of these tasks in detail.
<DT><CODE>param</CODE>
<DD> Data associated with the task specified by the <CODE>message</CODE> parameter. If the task requires no data, this parameter is ignored.
</DL>
 Your window definition function performs whatever task is specified by the <CODE>message</CODE> parameter and returns a function result if appropriate. If the task performed requires no result code, return 0.<P>
 The function's entry point must be at the beginning of the function.<P>
 You can set up the various tasks as subroutines inside the window definition function, but you're not required to do so.<P>
<A NAME=HEADING291-13></A>
<H4><A NAME=MARKER-2-610></A>Drawing the Window Frame</H4>
 <A NAME=MARKER-13-611></A>When you receive a <A NAME=MARKER-2-612></A><CODE>wDraw</CODE> message, draw the window frame in the current graphics port, which is the Window Manager port.<P>
 You must make certain checks to determine exactly how to draw the frame. If the value of the <CODE>visible</CODE> field in the window record is <CODE>FALSE</CODE>, you should do nothing; otherwise, you should examine the <CODE>param</CODE> parameter and the status flags in the window record:<P>
<UL>
<LI>If the value of <CODE>param</CODE> is 0, draw the entire window frame.
<LI>If the value of <CODE>param</CODE> is 0 and the <CODE>hilited</CODE> field in the window record is <CODE>TRUE</CODE>, highlight the frame to show that the window is active.<P>
<UL>
<LI>If the value of the <CODE>goAwayFlag</CODE> field in the window record is also <CODE>TRUE</CODE>, draw a close box in the window frame.
<LI>If the value of the <CODE>spareFlag</CODE> field in the window record is also <CODE>TRUE</CODE>, draw a zoom box in the window frame.<P>
</UL>
<LI>If the value of the <CODE>param</CODE> parameter is <CODE>wInGoAway</CODE>, add highlighting to, or remove <BR>it from, the window's close box. <A HREF=Toolbox-207.html#MARKER-9-201>Figure 4-19</A> on <A HREF=Toolbox-207.html#MARKER-9-201>page 4-46</A> illustrates the close box <BR>with and without highlighting as drawn by the Window Manager's window definition function.
<LI>If  the value of the <CODE>param</CODE> parameter is <CODE>wInZoom</CODE>, add highlighting to, or remove it from, the window's zoom box. <A HREF=Toolbox-207.html#MARKER-9-202>Figure 4-20</A> on <A HREF=Toolbox-207.html#MARKER-9-202>page 4-47</A> illustrates the zoom box <BR>with and without highlighting as drawn by the Window Manager's window definition function.<P>
</UL>
<DL>
<DT><B>Note</B>
<DD>When the Window Manager calls a window definition function <BR>with a message of <CODE>wDraw</CODE>, it stores a value of type <CODE>Integer</CODE> in the <CODE>param</CODE> parameter without clearing the high-order word. When processing the <CODE>wDraw</CODE> message, use only the low-order word of the <CODE>param</CODE> parameter. <EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 The window frame typically but not necessarily includes the window's title, which should be displayed in the system font and system font size. The Window Manager <BR>port is already set to use the system font and system font size.<P>
 When designing a title bar that includes the window title, allow at least 16 pixels vertically to support localization for script systems in which the system font can be no smaller than 12 points.<P>
<DL>
<DT><B>Note</B>
<DD>Nothing drawn outside the window's structure region is visible.<A NAME=MARKER-2-608></A><EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
<A NAME=HEADING291-26></A>
<H4>Returning the Region of a Mouse-Down Event</H4>
 <A NAME=MARKER-13-614></A>When you receive a <A NAME=MARKER-2-615></A><CODE>wHit</CODE> message, you must determine where the cursor was when the mouse button was pressed. The <CODE>wHit</CODE> message is accompanied by the mouse location, in global coordinates, in the <CODE>param</CODE> parameter. The vertical coordinate is in the high-order word of the parameter, and the horizontal coordinate is in the low-order word. You return one of these constants:<P>
<PRE>
CONST
   wNoHit      = 0;  {none of the following}
   wInContent  = 1;  {in content region (except grow, if active)}
   wInDrag     = 2;  {in drag region}
   wInGrow     = 3;  {in grow region (active window only)}
   wInGoAway   = 4;  {in go-away region (active window only)}
   wInZoomIn   = 5;  {in zoom box for zooming in (active window }
                     { only)}
   wInZoomOut  = 6;  {in zoom box for zooming out (active window }
                     { only)}
</PRE>
 The return value <CODE>wNoHit</CODE> might mean (but not necessarily) that the point isn't in the window. The standard window definition functions, for example, return <CODE>wNoHit</CODE> if the point is in the window frame but not in the title bar.<P>
 Return the constants <CODE>wInGrow</CODE>, <CODE>wInGoAway</CODE>, <CODE>wInZoomIn</CODE>, and <CODE>wInZoomOut</CODE> only if the window is active--by convention, the size box, close box, and zoom box aren't drawn if the window is inactive. In an inactive document window, for example, a mouse-down event in the part of the title bar that would contain the close box if the window were active is reported as <CODE>wInDrag</CODE>.<P>
<A NAME=HEADING291-31></A>
<H4>Calculating Regions</H4>
 <A NAME=MARKER-13-616></A>When you receive the <A NAME=MARKER-2-617></A><CODE>wCalcRgns</CODE> message, you calculate the window's structure and content regions based on the current graphics port's port rectangle. These regions, whose handles are in the <CODE>strucRgn</CODE> and <CODE>contRgn</CODE> fields of the window record, are in global coordinates. The Window Manager requests this operation only if the window is visible.<P>
<DL>
<DT><B>WARNING</B>
<DD>When you calculate regions for your own type of window, do not alter the clip region or the visible region of the window's graphics port. The Window Manager and QuickDraw take care of this for you. Altering the clip region or visible region may damage other windows.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
<A NAME=HEADING291-34></A>
<H4>Initializing a New Window</H4>
 <A NAME=MARKER-13-618></A>When you receive the <A NAME=MARKER-2-619></A><CODE>wNew</CODE> message, you can perform any type-specific initialization that may be required. If the content region has an unusual shape, for example, you might allocate memory for the region and store the region handle in the <CODE>dataHandle</CODE> field of the window record. The initialization routine for a standard document window creates the <CODE>wStateData</CODE> record for storing zooming data.<P>
<A NAME=HEADING291-36></A>
<H4>Disposing of a Window</H4>
 <A NAME=MARKER-13-620></A>When you receive the <A NAME=MARKER-2-621></A><CODE>wDispose</CODE> message, you can perform any additional tasks necessary for disposing of a window. You might, for example, release memory that was allocated by the initialization routine. The dispose routine for a standard document window disposes of the <CODE>wStateData</CODE> record.<P>
<A NAME=HEADING291-38></A>
<H4>Resizing a Window</H4>
 <A NAME=MARKER-13-622></A>When you receive the <A NAME=MARKER-2-623></A><CODE>wGrow</CODE> message, draw a grow image of the window. With the <CODE>wGrow</CODE> message you receive a pointer to a rectangle, in global coordinates, whose upper-left corner is aligned with the port rectangle of the window's graphics port. Your grow image should fit inside the rectangle. As the user drags the mouse, the Window Manager sends repeated <CODE>wGrow</CODE> messages, so that you can change your grow image to match the changing mouse location.<P>
 Draw the grow image in the current graphics port, which is the Window Manager port, in the current pen pattern and pen mode. These are set up (as <CODE>gray</CODE> and <CODE>notPatXor</CODE>) to conform to the Macintosh user interface guidelines.<P>
 The grow routine for a standard document window draws a dotted (gray) outline of the window and also the lines delimiting the title bar, size box, and scroll bar areas.<P>
<A NAME=HEADING291-42></A>
<H4>Drawing the Size Box</H4>
 <A NAME=MARKER-13-624></A>When you receive the <A NAME=MARKER-2-475></A><CODE>wDrawGIcon</CODE> message, you draw the size box in the content region if the window is active--if the window is inactive, draw whatever is appropriate to show that the window cannot currently be sized.<P>
<DL>
<DT><B>Note</B>
<DD>If the size box is located in the window frame instead of the content region, do nothing in response to the <CODE>wDrawGIcon</CODE> message, instead drawing the size box in response to the <CODE>wDraw</CODE> message.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 The routine that draws a size box for an active document window draws the size box in the lower-right corner of the port rectangle of the window's graphics port. It also draws lines delimiting the size box and scroll bar areas. For an inactive document window, it erases the size box and draws the delimiting<A NAME=MARKER-14-514></A> lines.<A NAME=MARKER-2-627></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Toolbox-290.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-292.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Toolbox-3.html">&copy; Apple Computer, Inc.</A><br>11 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
