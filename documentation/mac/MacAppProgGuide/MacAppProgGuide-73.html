<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Overview (MacApp PG)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING73></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MacAppProgGuide-72.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-74.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MacAppProgGuide-2.html"><B>Programmer's Guide to MacApp</B></A> / <A HREF="MacAppProgGuide-21.html"><B>Part 1 - MacApp Theory and Architecture</B></A><BR><DD><A HREF="MacAppProgGuide-72.html"><B>Chapter 9 - Drag and Drop</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING73-0></A>
<H1><A NAME=MARKER-2-90></A>Overview</H1>
 A MacApp application can move or copy data through direct cursor manipulation, a facility known as <B>drag and drop.</B> Your application can drag and drop data within a view, between views, and between itself and other applications (including the Finder) that support drag and drop of similar data types. MacApp's drag-and-drop support relies on the Macintosh <B>Drag Manager.</B> The Drag Manager is integrated into System 7.5 and later versions of the Macintosh Operating System. Releases of System 7 before version 7.5 require the addition of the Macintosh Drag and Drop extension.<P>
 MacApp users who are familiar with the OpenDoc Application Platform Interface (API) will notice similarities between MacApp's implementation of drag and drop and OpenDoc's. This similarity is intentional and should give users of either API a head start when switching between the two models.<P>
 Several MacApp view classes have built-in support for drag-and-drop operations--your application turns on this support by setting drag-related fields. See <A HREF=MacAppProgGuide-136.html#MARKER-9-19>Chapter 28, "Working With Drag and Drop,"</A> for information on how to build your application to include MacApp's drag-and-drop support.<P>
 A global <B>drag session object</B> (based on the <CODE><A NAME=MARKER-2-43></A>TDragDropSession</CODE> class) manages communication with the Drag Manager during drag-and-drop operations. A view that supports dragging or dropping registers with its window, and the window registers with the global drag session object.<P>
 <A HREF=#MARKER-9-32>Figure 9-1</A> shows the communication between window, view, and drag session objects during a drag operation. A view initiates dragging by calling a method of the drag session object, which in turn calls on the Macintosh Drag Manager to start a drag session. During the session, the Drag Manager makes callbacks to the drag session object. The drag session object passes these calls on to either the window or the view.<P>
<B>Figure 9-1  <A NAME=MARKER-9-32></A>Communication during a drag session</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/MacApp_PG-L-052.gif"><P>
 When a user drags data over a MacApp window, the drag session object asks the window to supply a target view to receive the dragged data. If the user drops the data into the view, the drag session asks the view to create a command object to transfer the data. The type of command created depends on whether the dragged data is copied or moved, and whether the source is inside or outside the application.<P>
 MacApp uses linked commands to perform or undo a drag move operation within the application, which may involve changing data in two contexts. One command deletes the data from the source and the other adds it to the destination. For more information on linked commands, see <A HREF=MacAppProgGuide-76.html#MARKER-9-96>page 265</A>.<P>
 Most drag-and-drop functions are performed by a view object, working together with the global drag session object. A view specifies whether it will supply or accept drag data. The view also supplies visual feedback by <P>
<UL>
<LI>setting the cursor image appropriately for dragging; for example, a <CODE>TPicture</CODE> view sets the cursor to an open "grabber hand" when a click would initiate a drag, and sets it to a closed hand when a drag is actually initiated (this is the default behavior supplied by <CODE>TView</CODE>)
<LI>supplying an outline region to represent the data dragged out of it
<LI>highlighting itself and possibly showing an insertion point when it is tracking a drop<P>
</UL>
 <A HREF=#MARKER-9-1>Table 9-1</A> describe the components of MacApp's drag-and-drop support.
<TABLE BORDER="0" CELLPADDING=3>
<CAPTION><A NAME=MARKER-9-1></A><B>Table 9-1 Components of MacApp's drag-and-drop support</B> </CAPTION>
<TH>Component<TH>Description<TR>
<TD><CODE><A NAME=MARKER-2-2></A>TDragDropSession</CODE><TD>MacApp creates a single global instance, accessed through TDragDropSession::<A NAME=MARKER-2-41></A>fgDragDropSession.<P>Initialization sets up universal procedure pointer fields for use as Drag Manager callback routines.<P>Mediates between the Macintosh Drag Manager and the window and view objects involved in a drag or drop operation.<TR>
<TD><CODE><A NAME=MARKER-2-4></A>TWindow</CODE><TD>Stores a list of droppable subviews.<P>Registers itself with the drag session object to install callback routines.<P>During a drag, determines the drop target view for the drag session object, based on the current mouse position.<TR>
<TD><CODE><A NAME=MARKER-2-5></A>TView</CODE><TD>Has fields that specify whether the view initiates drags, whether it accepts drops, and whether it should move or copy data in a drop operation. Fields can be set programmatically or set using <CODE>TDragDropBehavior</CODE>.<P>Has methods to register the view with its window: <CODE>DoPostCreate</CODE> automatically registers a view that has a <CODE>TDragDropBehavior</CODE> attached; <CODE><A NAME=MARKER-2-6></A>SetDraggable</CODE> registers a view programmatically.<P>As the source of a drag, supplies a draggable region and sets the cursor image to a drag cursor when a click would cause a drag. Supplies--or promises for later delivery--data for the drag and an outline of the dragged data. Calls on drag session object to initiate a drag.<P>As the target of a drop, supplies visual feedback: highlights the view to show it will accept the drop and indicates the insertion point for dropped data. Creates command to insert dropped data.<TR>
<TD><CODE><A NAME=MARKER-2-7></A>TDragDropBehavior</CODE><TD>Attached to a view with a resource editor to specify the initial values for the view's drag-and-drop fields.<TR>
<TD><CODE><A NAME=MARKER-2-8></A>TDragItem</CODE><TD>Used by view objects to supply drag data.<P>Can supply multiple representations (or flavors) of data. For example, a spreadsheet application might create a drag item that supplies data in its internal cell format or as tab-delimited text.<TR>
<TD><CODE><A NAME=MARKER-2-25></A>CDragItemIterator</CODE><TD>Iterates over the drag items in a drag operation.<P>Used by a view object to determine if the view can accept all the items in the drag.<P>Used by a view to access data in a drag when creating a command object to insert dragged data.<TR>
<TD><CODE><A NAME=MARKER-2-60></A>CFlavorFlags</CODE><TD>Used by a view when supplying or promising data. Data structure provides simplified access to the Drag Manager <CODE>FlavorFlags</CODE> data type. </TABLE>
<P>
 For more information on using drag and drop in your application, see <A HREF=MacAppProgGuide-136.html#MARKER-9-19>Chapter 28, "Working With Drag and Drop."</A><A NAME=MARKER-2-89></A><P>



</BLOCKQUOTE>
<HR>
<center>
<A HREF="MacAppProgGuide-72.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-74.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MacAppProgGuide-3.html">&copy; Apple Computer, Inc.</A><br>25 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
