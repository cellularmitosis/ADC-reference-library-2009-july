<html><head><title>Mac OS X
 Manual Page For smbpasswd(8)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/8/smbpasswd" title="Mac OS X
 Manual Page for smbpasswd(8)"><!-- headerDoc=man; indexgroup=Section 8; uid="//apple_ref/doc/man/8/smbpasswd"; name=smbpasswd(8) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
SMBPASSWD(8)                                                                                    SMBPASSWD(8)



<b>NAME</b>
       smbpasswd - change a user's SMB password

<b>SYNOPSIS</b>
       smbpasswd   [-a]   [-c &lt;config file&gt;]  [-x]  [-d]  [-e]  [-D debuglevel]  [-n]  [-r &lt;remote machine&gt;]
        [-R &lt;name resolve order&gt;] [-m] [-U username[%password]] [-h] [-s] [-w pass] [-W]  [-i]  [-L]  [user-<font color="#ffffff" class="whiteout">name]&nbsp;[username]</font>
        name]

<b>DESCRIPTION</b>
       This tool is part of the <a href="../man7/samba.7.html#//apple_ref/doc/man/7/samba"><b>samba</b>(7)</a> suite.

       The  smbpasswd  program  has  several different functions, depending on whether it is run by the <b>root</b>
       user or not. When run as a normal user it allows the user to change the password used for  their  SMB
       sessions on any machines that store SMB passwords.

       By  default (when run with no arguments) it will attempt to change the current user's SMB password on
       the local machine. This is similar to the way the <a href="../man1/passwd.1ssl.html#//apple_ref/doc/man/1/passwd">passwd(1)</a> program works.   smbpasswd  differs  from
       how  the passwd program works however in that it is not <b>setuid</b> <b>root</b> but works in a client-server mode
       and communicates with a locally running <a href="smbd.8.html#//apple_ref/doc/man/8/smbd"><b>smbd</b>(8)</a>. As a consequence in order for this  to  succeed  the
       smbd  daemon  must be running on the local machine. On a UNIX machine the encrypted SMB passwords are
       usually stored in the <a href="../man5/smbpasswd.5.html#//apple_ref/doc/man/5/smbpasswd"><b>smbpasswd</b>(5)</a> file.

       When run by an ordinary user with no options, smbpasswd will prompt them for their old  SMB  password
       and  then ask them for their new password twice, to ensure that the new password was typed correctly.
       No passwords will be echoed on the screen whilst being typed. If you have a blank SMB password (spec-<font color="#ffffff" class="whiteout">ified&nbsp;(specified</font>
       ified  by  the string "NO PASSWORD" in the smbpasswd file) then just press the &lt;Enter&gt; key when asked
       for your old password.

       smbpasswd can also be used by a normal user to change their SMB password on remote machines, such  as
       Windows NT Primary Domain Controllers. See the (<u>-r</u>) and <u>-U</u> options below.

       When  run  by root, smbpasswd allows new users to be added and deleted in the smbpasswd file, as well
       as allows changes to the attributes of the user in this file to be made. When run by root,  smbpasswd
       accesses the local smbpasswd file directly, thus enabling changes to be made even if smbd is not run-<font color="#ffffff" class="whiteout">ning.&nbsp;running.</font>
       ning.

<b>OPTIONS</b>
       -a
          This option specifies that the username following should be added to  the  local  smbpasswd  file,
          with  the  new  password  typed (type &lt;Enter&gt; for the old password). This option is ignored if the
          username following already exists in the smbpasswd file and it is treated like  a  regular  change
          password  command.  Note that the default passdb backends require the user to already exist in the
          system password file (usually <u>/etc/passwd</u>), else the request to add the user will fail.

          This option is only available when running smbpasswd as root.

       -c
          This option can be used to specify the path and file name of the <u>smb.conf</u> configuration file  when
          it is important to use other than the default file and / or location.

       -x
          This option specifies that the username following should be deleted from the local smbpasswd file.

          This option is only available when running smbpasswd as root.

       -d
          This option specifies that the username following should be <b>disabled</b> in the local smbpasswd  file.
          This is done by writing a <b>'D'</b> flag into the account control space in the smbpasswd file. Once this
          is done all attempts to authenticate via SMB using this username will fail.

          If the smbpasswd file is in the 'old' format (pre-Samba 2.0 format)  there  is  no  space  in  the
          user's  password  entry  to write this information and the command will FAIL. See <a href="../man5/smbpasswd.5.html#//apple_ref/doc/man/5/smbpasswd"><b>smbpasswd</b>(5)</a> for
          details on the 'old' and new password file formats.

          This option is only available when running smbpasswd as root.

       -e
          This option specifies that the username following should be <b>enabled</b> in the local  smbpasswd  file,
          if the account was previously disabled. If the account was not disabled this option has no effect.
          Once the account is enabled then the user will be able to authenticate via SMB once again.

          If the smbpasswd file is in the 'old' format, then smbpasswd will FAIL to enable the account.  See
          <a href="../man5/smbpasswd.5.html#//apple_ref/doc/man/5/smbpasswd"><b>smbpasswd</b>(5)</a> for details on the 'old' and new password file formats.

          This option is only available when running smbpasswd as root.

       -D debuglevel
          <u>debuglevel</u>  is  an  integer  from 0 to 10. The default value if this parameter is not specified is
          zero.

          The higher this value, the more detail will be logged to the log files  about  the  activities  of
          smbpasswd. At level 0, only critical errors and serious warnings will be logged.

          Levels above 1 will generate considerable amounts of log data, and should only be used when inves-<font color="#ffffff" class="whiteout">tigating&nbsp;investigating</font>
          tigating a problem. Levels above 3 are designed for use  only  by  developers  and  generate  HUGE
          amounts of log data, most of which is extremely cryptic.

       -n
          This  option  specifies that the username following should have their password set to null (i.e. a
          blank password) in the local smbpasswd file. This is done by writing the string "NO  PASSWORD"  as
          the first part of the first password stored in the smbpasswd file.

          Note  that  to  allow users to logon to a Samba server once the password has been set to "NO PASS-<font color="#ffffff" class="whiteout">WORD"&nbsp;PASSWORD"</font>
          WORD" in the smbpasswd file the administrator must set the following  parameter  in  the  [global]
          section of the <u>smb.conf</u> file :

          null passwords = yes

          This option is only available when running smbpasswd as root.

       -r remote machine name
          This  option  allows a user to specify what machine they wish to change their password on. Without
          this parameter smbpasswd defaults to the local host. The <u>remote</u> <u>machine</u> <u>name</u> is the  NetBIOS  name
          of the SMB/CIFS server to contact to attempt the password change. This name is resolved into an IP
          address using the standard name resolution mechanism in all programs of the Samba suite.  See  the
          <u>-R</u> <u>name</u> <u>resolve</u> <u>order</u> parameter for details on changing this resolving mechanism.

          The  username  whose  password  is  changed is that of the current UNIX logged on user. See the <u>-U</u>
          <u>username</u> parameter for details on changing the password for a different username.

          Note that if changing a Windows NT Domain password the remote machine specified must be  the  Pri-<font color="#ffffff" class="whiteout">mary&nbsp;Primary</font>
          mary Domain Controller for the domain (Backup Domain Controllers only have a read-only copy of the
          user account database and will not allow the password change).

          <b>Note</b> that Windows 95/98 do not have a real password database so it is not possible to change pass-<font color="#ffffff" class="whiteout">words&nbsp;passwords</font>
          words specifying a Win95/98 machine as remote machine target.

       -R name resolve order
          This  option  allows  the user of smbpasswd to determine what name resolution services to use when
          looking up the NetBIOS name of the host being connected to.

          The options are :"lmhosts", "host", "wins" and "bcast". They cause names to be  resolved  as  fol-<font color="#ffffff" class="whiteout">lows:&nbsp;follows:</font>
          lows:

               <b>lmhosts</b>:  Lookup an IP address in the Samba lmhosts file. If the line in lmhosts has no name
                type attached to the NetBIOS name (see the  <a href="../man5/lmhosts.5.html#//apple_ref/doc/man/5/lmhosts"><b>lmhosts</b>(5)</a>  for  details)  then  any  name  type
                matches for lookup.

               <b>host</b>:  Do  a standard host name to IP address resolution, using the system <u>/etc/hosts</u> , NIS,
                or DNS lookups. This method of name resolution is operating system depended for instance  on
                IRIX  or  Solaris  this  may  be  controlled by the <u>/etc/nsswitch.conf</u> file). Note that this
                method is only used if the NetBIOS name type being queried is the 0x20 (server)  name  type,
                otherwise it is ignored.

               <b>wins</b>:  Query  a  name  with  the  IP address listed in the <u>wins</u> <u>server</u> parameter. If no WINS
                server has been specified this method will be ignored.

               <b>bcast</b>: Do a broadcast on each of the known local interfaces listed in the <u>interfaces</u> parame-<font color="#ffffff" class="whiteout">ter.&nbsp;parameter.</font>
                ter.  This  is the least reliable of the name resolution methods as it depends on the target
                host being on a locally connected subnet.

             The default order is lmhosts, host, wins, bcast and without this parameter or any entry in  the
             <a href="../man5/smb.conf.5.html#//apple_ref/doc/man/5/smb.conf"><b>smb.conf</b>(5)</a> file the name resolution methods will be attempted in this order.

       -m
          This option tells smbpasswd that the account being changed is a MACHINE account. Currently this is
          used when Samba is being used as an NT Primary Domain Controller.

          This option is only available when running smbpasswd as root.

       -U username
          This option may only be used in conjunction with the <u>-r</u> option. When  changing  a  password  on  a
          remote  machine it allows the user to specify the user name on that machine whose password will be
          changed. It is present to allow users who have different user names on different systems to change
          these passwords.

       -h
          This option prints the help string for smbpasswd, selecting the correct one for running as root or
          as an ordinary user.

       -s
          This option causes smbpasswd to be silent (i.e. not issue prompts) and to read  its  old  and  new
          passwords  from  standard input, rather than from <u>/dev/tty</u> (like the <a href="../man1/passwd.1ssl.html#//apple_ref/doc/man/1/passwd">passwd(1)</a> program does). This
          option is to aid people writing scripts to drive smbpasswd

       -w password
          This parameter is only available if Samba has been compiled with LDAP support. The  <u>-w</u>  switch  is
          used  to  specify the password to be used with the ldap admin dn. Note that the password is stored
          in the <u>secrets.tdb</u> and is keyed off of the admin's DN. This means that if the value of <u>ldap</u>  <u>admin</u>
          <u>dn</u> ever changes, the password will need to be manually updated as well.

       -W
          NOTE: This option is same as "-w" except that the password should be entered using stdin.

          This  parameter  is  only available if Samba has been compiled with LDAP support. The <u>-W</u> switch is
          used to specify the password to be used with the ldap admin dn. Note that the password  is  stored
          in  the <u>secrets.tdb</u> and is keyed off of the admin's DN. This means that if the value of <u>ldap</u> <u>admin</u>
          <u>dn</u> ever changes, the password will need to be manually updated as well.

       -i
          This option tells smbpasswd that the account being changed is an interdomain trust  account.  Cur-<font color="#ffffff" class="whiteout">rently&nbsp;Currently</font>
          rently  this is used when Samba is being used as an NT Primary Domain Controller. The account con-<font color="#ffffff" class="whiteout">tains&nbsp;contains</font>
          tains the info about another trusted domain.

          This option is only available when running smbpasswd as root.

       -L
          Run in local mode.

       username
          This specifies the username for all of the <b>root</b> <b>only</b> options to operate on. Only root can  specify
          this  parameter  as only root has the permission needed to modify attributes directly in the local
          smbpasswd file.

<b>NOTES</b>
       Since smbpasswd works in client-server mode communicating with a local smbd for a non-root user  then
       the  smbd  daemon  must  be running for this to work. A common problem is to add a restriction to the
       hosts that may access the smbd running on the local machine by specifying either <u>allow</u> <u>hosts</u> or  <u>deny</u>
       <u>hosts</u> entry in the <a href="../man5/smb.conf.5.html#//apple_ref/doc/man/5/smb.conf"><b>smb.conf</b>(5)</a> file and neglecting to allow "localhost" access to the smbd.

       In  addition,  the  smbpasswd  command is only useful if Samba has been set up to use encrypted pass-<font color="#ffffff" class="whiteout">words.&nbsp;passwords.</font>
       words.

<b>VERSION</b>
       This man page is correct for version 3.0 of the Samba suite.

<b>SEE</b> <b>ALSO</b>
       <a href="../man5/smbpasswd.5.html#//apple_ref/doc/man/5/smbpasswd"><b>smbpasswd</b>(5)</a>, <!-- a --><b>Samba</b>(7)<!-- /a -->.

<b>AUTHOR</b>
       The original Samba software and related utilities were created  by  Andrew  Tridgell.  Samba  is  now
       developed  by  the Samba Team as an Open Source project similar to the way the Linux kernel is devel-<font color="#ffffff" class="whiteout">oped.&nbsp;developed.</font>
       oped.

       The original Samba man pages were written by Karl Auer. The man page sources were converted  to  YODL
       format     (another     excellent     piece     of     Open    Source    software,    available    at
       <a href="ftp://ftp.icce.rug.nl/pub/unix/)">ftp://ftp.icce.rug.nl/pub/unix/)</a> and updated for the Samba 2.0 release by Jeremy Allison. The conver-
       sion  to DocBook for Samba 2.2 was done by Gerald Carter. The conversion to DocBook XML 4.2 for Samba
       3.0 was done by Alexander Bokovoy.




                                                                                                SMBPASSWD(8)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man8/smbpasswd.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man8/smbpasswd.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man8/smbpasswd.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
