<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!--Template 06-20-02--><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><TITLE>Technical Q&amp;A QD07: Kanji &amp; PostScript Printing</TITLE>	<meta name="keywords" content="Mac OS 8 QuickDraw rotating text single byte double font"><meta name="Description" content="Q&amp;A explains how to use PicComments to rotate single byte characters that will be printed, on a post script printer, using a Double Byte Font."><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10001766" title="Kanji & PostScript Printing"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalqas/index.html">Technical Q&As</a> &gt; <a href="../../technicalqas/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalqas/LegacyTechnologies/idxPrinting-date.html">Printing</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/Printing/index.html" target="_blank">Reference Library > Printing</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Q&amp;A QD07</div>
<div id="pageheadsub">Kanji &amp; PostScript Printing</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment -->						<!-- begin_content --> <CENTER><TABLE BORDER=0 CELLPADDING=0 WIDTH=600><TR> <TD align="left"><HR ALIGN="center" WIDTH="550"><p id = p2>Q:  We are close to releasing the Kanji Macintosh version of ourapplication, but we are experiencing some unexpected behavior when attemptingto print Single Byte Characters (SBC) using a Double Byte Font (DB) on aPostScript printer.</P><p id=p2>We are trying to print vertically rotated text, which looks more or less likethe following example (on the display), except that each letter is rotated 90degrees (lying on its side):</p><p id=p2>- -</p><p id=p2> |       T        |</p> <p id=p2> |       E        |</p><p id=p2> |       X        |</p><p id=p2> |       T        |</p><p id=p2>- - -</p><p id=p2>We are doing this by using the following pseudo code:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<TD BGCOLOR="#E6E6E6" align="left"><PRE>1. 	tTxtPicRec = [tJus=1; tFlip=0; tAngle=90; tAngleFixed=Integer2Fixed( 90 )]2.	tCenterRec = [Integer2Fixed( ofX(offset), of Y(offset) ) ]3.	PictComment( TextBegin, sizeof(TTxtPicRec), (Handle) tTxtPicRecH );4.	PictComment( TextCenter, sizeof(TCenterRec), (Handle) tCenterRecH );5.	DrawJustified (buffer, count, 0, smOnlyStyleRun, 1, 1 );6.	PictComment( TextEnd, NIL, NIL );</PRE>	</TD></TR></TABLE></CENTER><p id=p2>When printing rotated single or double- byte characters to a postscript printer using a double- byte font, such as Osaka, we get the results that look something like this (exceptthat each letter is also lying on its side):</p><p id=p2>--------------------</p><p id=p2>||</p><p id=p2>| TEXT |</p><p id=p2>||</p><p id=p2>---------------------</p><p id=p2>In all cases, the rotated text displays properly on screen. The problem occurswhile printing SB or DBC using a DB font. Printing rotated SBC using an SB fontworks properly. It appears that each character is rotated around its owncenter, rather than around the center given by the offset (for the boxcontaining just the text).</p><p id=p2>Is this the proper approach?</p><p id=p4>A:  The approach in your pseudo code looks correct, but there are other things youneed to know about.</p><p id=p4>Two-byte characters don't print correctly when using the <code>TextBegin</code>, <code>TextCenter</code>,and <code>TextEnd PicComments</code>, due to the structure of the data that is in thecomments. The LaserWriter driver uses the <code>PicComments</code> to rotate text, and it isnot expecting the data in two-byte format. In some instances, the two-byteformat looks like bitmap data to the driver, so this data is ignored, andnothing is printed. The driver is expecting the comments to contain only"normal" text.</p><p id=p4>There are some techniques you can use to avoid this limitation in the driver.These approaches reflect the methods that many developers are using to resolvethis problem:</p><p id=p4><u>Rotating with <code>RotateBegin</code> and <code>RotateEnd PicComments</code></u></p><p id=p4>Since the data is in bitmap format, you can use the <code>RotateBegin</code> and <code>RotateEndPicComments</code> to perform the rotation, as shown below:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<TD BGCOLOR="#E6E6E6" align="left"><PRE>RotateBegin      DrawString (...);  &lt;&lt; To rotate your 2 byte Japanese charactersRotateEnd</PRE>	</TD></TR></TABLE></CENTER><p id=p4>Bear in mind that you only need to use this approach when you are printingtwo-byte Japanese bitmap fonts. Therefore, you have to check the type of datathat is to be printed, and send the appropriate <code>PicComments</code>.</p><p id=p4>Use the following <code>PicComments</code> to hide the QuickDraw representation of therotated text:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<TD BGCOLOR="#E6E6E6" align="left"><PRE>PostScriptBegin	CopyBits (...);   &lt;&lt; For the QuickDraw printersPostScriptEnd</PRE>	</TD></TR></TABLE></CENTER><p id=p4>The <code>PostScriptBegin</code> and <code>PostScriptEnd PicComments</code> are used to hide the <code>CopyBits</code>calls from the LaserWriter driver in a device-independent manner. These callstell the LaserWriter driver to turn off all QuickDraw calls. The driver doesnot interpret any QuickDraw calls until it finds the <code>PostScriptEnd PicComment</code>.Since QuickDraw printer drivers do <i>not</i> understand the <code>PostScriptBegin</code>and <code>PostScriptEnd PicComments</code>, they ignore the <code>PicComments</code>, and the <code>CopyBits</code>call performs the text rotation.</p><p id=p4>The technique described above has one problem -- if you record the previous<code>PicComments</code> in a picture and print it, everything prints exactly as expected,but if you display the picture in an on-screen window, you see the<i>unrotated</i> version of the text. This is a known bug which, unfortunately,won't be fixed in the very near future.</p><p id=p4>For more information on using picture comments, see <i>Inside Macintosh:Imaging with QuickDraw,</i> and the Macintosh Technote:<A HREF = "../../technotes/qd/qd_10.html" target="_blank">QD 10 - Picture Comments The Real Deal.</A></p><p id=p4><u>Rotating Characters Individually</u></p><p id=p4>When you rotate a string of Japanese characters 90 degrees, the orientation ofthe <i>characters</i> stays the same. In other words, the entire <i>string</i>rotates, but the characters <i>within</i> the string retain the orientationthey had before rotation. Therefore, each character in the string must berotated back 90 degrees for it to be typographically correct.</p><p id=p4>Most developers need to do their own line layout for rotated DBC. That is, moveto a position, draw a character, move to the next position, draw the nextcharacter, and so on until the string is complete.</p></td></tr></table></CENTER><!-- end_content --><!-- begin_date --><H4 ALIGN=center>[May 01 1995]</H4><!-- end_date --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/qa/qd/qd07.html%3Fid%3DDTS10001766-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/qa/qd/qd07.html%3Fid%3DDTS10001766-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/qa/qd/qd07.html%3Fid%3DDTS10001766-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --> <HR width=550 align=center> </BODY> </HTML>