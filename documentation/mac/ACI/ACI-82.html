<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Creating a Component Resource for a CMM</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING82></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->




<!-- Main Body -->

<CENTER>
<P>
<A HREF="ACI-81.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="ACI-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="ACI-122.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="ACI-83.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="ACI-2.html"><B>Advanced Color Imaging on the Mac OS</B></A> / <BR><DD><A HREF="ACI-79.html"><B>Chapter 5 - Developing Color Management Modules </B></A> / <A HREF="ACI-81.html"><B>Creating a Color Management Module </B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING82-0></A>
<H2>Creating a Component Resource for a CMM</H2>
 A CMM is stored as a component resource. It contains a number of resources, including the standard component resource (a resource of type <CODE>'thng'</CODE>) required of any Component Manager component. In addition, a CMM must contain code to handle required request codes passed to it by the Component Manager. This includes support for Component Manager required request codes as well as ColorSync Manager required request codes.<P>
 To allow the ColorSync Manager to use your CMM when a profile specifies it as its preferred CMM, your CMM should be located in the Extensions folder, where it will automatically be registered at startup. The file type for component files must be set to <CODE><A NAME=MARKER-2-27></A>'thng'</CODE>.<P>
 The component resource contains all the information needed to register a code resource as a component. Information in the component resource tells the Component Manager where to find the code for the component. As part of the component resource, you must provide a component description record that specifies the component type, subtype, manufacturer, and flags. Here is the component description data structure:<P>
<PRE>
struct ComponentDescription {
   OSType         componentType;
   OSType         componentSubType;
   OSType         componentManufacturer;
   unsigned long  componentFlags;
   unsigned long  componentFlagsMask;
};
</PRE>
 The component description data structure of type <CODE>ComponentDescription</CODE> contains the following fields for which you must set values:<P>
<UL>
<LI>The <CODE>componentType</CODE> field contains a unique 4-byte code specifying the resource type and resource ID of the component's executable code. For your CMM, set this field to <CODE>'cmm '</CODE>.
<LI>The <CODE>componentSubType</CODE> field indicates the type of services your CMM provides. You should set this field to your CMM name. This value must match exactly the value specified in the profile header's <CODE>CMMType</CODE> field. You must register this value with the ICC. 
<LI>The <CODE>componentManufacturer</CODE> field indicates the creator of the CMM. You may set this field to any value you wish. 
<LI>The <CODE>componentFlags</CODE> field is a 32-bit field that provides additional information about your CMM component. The high-order 8 bits are reserved for definition by the Component Manager. The low-order 24 bits are specific to each component type. You can use these flags to indicate any special capabilities or features of your component. For more information, see the chapter "Component Manager" in <I><A HREF="../MoreToolbox/MoreToolbox-2.html">Inside Macintosh: More Macintosh Toolbox</A></I>.
<LI>The <CODE>componentFlagsMask</CODE> field is reserved.<P>
</UL>
<DL>
<DT><B>Note</B>
<DD>Values you specify for all fields except the <CODE>componentType</CODE> field must include at least one uppercase character. Apple Computer reserves values containing all lowercase characters for its own use.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 <A HREF=#MARKER-9-28>Listing 5-1</A> shows a Rez listing of a component resource that describes a CMM. <P>
<B>Listing 5-1  <A NAME=MARKER-9-28></A>CMM component Rez listing</B><P>
<PRE>
/#define UseExtendedThingResource1
#include &quot;Types.r&quot;
resource 'STR ' (128, purgeable) {
   &quot;CMM Component&quot;
};

resource 'STR ' (129, purgeable) {
   &quot;Copyright &#169; 1995 Apple Computer, Inc.&quot;
};
resource 'ICN#' (128, purgeable) {
   {  /* array: 2 elements */
      /* [1] */
      $&quot;FFE0 07FF 8040 0201 8080 0101 807F FE01&quot;
      $&quot;8000 0001 8000 0001 8003 F001 800F FC01&quot;
      $&quot;803F FF01 807F FF01 807E 9E01 80F8 4401&quot;
      $&quot;80F4 8A01 81F2 5201 81E0 8101 81F5 5501&quot;
      $&quot;81EA AB01 81E0 4101 81F2 9201 80F4 4A01&quot;
      $&quot;80F8 8401 807E 5E01 807F FF01 803F FF01&quot;
      $&quot;800F FC01 8003 F001 8000 0001 8000 0001&quot;
      $&quot;FFF0 0FFF 0020 0400 0040 0200 003F FC&quot;,
      /* [2] */
      $&quot;FFE0 07FF FFC0 03FF FF80 01FF FFFF FFFF&quot;
      $&quot;FFFF FFFF FFFF FFFF FFFF FFFF FFFF FFFF&quot;
      $&quot;FFFF FFFF FFFF FFFF FFFF FFFF FFFF FFFF&quot;
      $&quot;FFFF FFFF FFFF FFFF FFFF FFFF FFFF FFFF&quot;
      $&quot;FFFF FFFF FFFF FFFF FFFF FFFF FFFF FFFF&quot;
      $&quot;FFFF FFFF FFFF FFFF FFFF FFFF FFFF FFFF&quot;
      $&quot;FFFF FFFF FFFF FFFF FFFF FFFF FFFF FFFF&quot;
      $&quot;FFFF FFFF 003F FC00 007F FE00 003F FC&quot;
   }
};
resource 'thng' (128, purgeable) {
   'cmm ',
   'fake',
   'fake',
   0X80000000,
   kAnyComponentFlagsMask,
   'cmm ',
   128,
   'STR ',
   128,
   'STR ',
   129,
   'ICN#',
   128,
   0x0,
   9,
   128,
   {  /* array ComponentPlatformInfo: 2 elements */
      /* [1] */
      0X80000000, 'cmm ', 128, platform68k,
      /* [2] */
      0X80000000, 'cmm ', 129, platformPowerPC
   }
};
</PRE>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="ACI-81.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="ACI-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="ACI-122.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="ACI-83.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="ACI-3.html">&copy; Apple Computer, Inc.</A><br>13 NOV 1996<P>
<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->
</BODY>
</HTML> 
