<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>C++ Runtime Environment Programming Guide: Overview of the C++ Runtime Environment</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Overview of the C++ Runtime Environment"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001667" title="Overview of the C++ Runtime Environment"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000436" target="_top">Tools</a> &gt; <a href="../../../CompilersDebuggers-date.html#//apple_ref/doc/uid/TP30000440-TP30000436-TP30001025" target="_top">Compiling &amp; Debugging</a> &gt; <a href="../index.html" target="_top">C++ Runtime Environment Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../CPPRuntimeEnv.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="LibCPPDeployment.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/TP40001667-BCIFHCHA" title="Overview of the C++ Runtime Environment"></a><hr /><H1>Overview of the C++ Runtime Environment</H1>

<p>The C++ runtime environment has evolved over the course of Mac OS X development. Early versions of the library were shipped as a static archive file while the latest version is delivered as a dynamic shared library. The following is a summary of the history of the runtime: </p><ul class="ul"><li class="li"><p><strong>Mac OS X v10.3.8 and earlier</strong> - the C++ standard library is available only as a static archive file. It can be compiled using GCC 3.3. </p></li><li class="li"><p><strong>Mac OS X v10.3.9 and later</strong> - the runtime is delivered as a dynamic shared library. System frameworks are modified to use the dynamic library but the static library is also available. </p></li></ul><p>The following sections provide more detailed information about the dynamic and static C++ runtimes. </p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="CPPROverview.html#//apple_ref/doc/uid/TP40001667-DontLinkElementID_1">Targeting Mac OS X v10.3.8 and Earlier</a>
				
			<br/>
			
        
			
			
				<a href="CPPROverview.html#//apple_ref/doc/uid/TP40001667-DontLinkElementID_2">Targeting Mac OS X v10.3.9 and Later</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001667-DontLinkElementID_1" title="Targeting Mac OS X v10.3.8 and Earlier"></a><h2>Targeting Mac OS X v10.3.8 and Earlier</h2><p>In Mac OS X v10.3.8 and earlier, the standard C++ library is packaged as the static archive file <a name="//apple_ref/doc/uid/TP40001667-DontLinkElementID_17"></a><code>libstdc++.a</code>. This library is designed with multiple clients in mind and provides syncing of I/O streams as well as hidden symbols to alleviate namespace conflicts. Symbols in the library are marked <code>__private_extern__</code> to prevent them from being exported to other code modules. Versions of this library are available in all versions of Mac OS X but programs must be built using the GCC 3.3 compiler.</p><a name="//apple_ref/doc/uid/TP40001667-DontLinkElementID_2" title="Targeting Mac OS X v10.3.9 and Later"></a><h2>Targeting Mac OS X v10.3.9 and Later</h2><p>In Mac OS X v10.3.9 and later, you have the option of linking against a static or dynamic version of the C++ runtime. </p><a name="//apple_ref/doc/uid/TP40001667-DontLinkElementID_3" title="The Static C++ Runtime"></a><h3>The Static C++ Runtime</h3><p>With the introduction of Xcode Tools 2.3, a new version of the standard C++ library is made available in the static archive file <a name="//apple_ref/doc/uid/TP40001667-DontLinkElementID_18"></a><code>libstdc++-static.a</code>. This new static library is closer in nature to the dynamic shared library introduced in Mac OS X v10.3.9 than to the previous static library. It conforms to the Itanium C++ ABI and requires the use of GCC 4.0 for compilation. Programs linking to the library must run in Mac OS X v10.3.9 or later.  For more information, see <span class="content_text"><a href="LibCPPDeployment.html#//apple_ref/doc/uid/TP40001668-SW1">“Deploying With the New Static Runtime.”</a></span></p><a name="//apple_ref/doc/uid/TP40001667-DontLinkElementID_4" title="The Dynamic C++ Runtime"></a><h3>The Dynamic C++ Runtime</h3><p>In Mac OS X v10.3.9 and later, the C++ runtime is available as a dynamic shared library <a name="//apple_ref/doc/uid/TP40001667-DontLinkElementID_19"></a><code>libstdc++.dylib</code>. This change in packaging brings the C++ runtime in line with the C runtime, which has always been packaged as part of the dynamic shared library <code>libSystem.dylib</code>. The dynamic library conforms to the Itanium C++ ABI, which is a standard for compiled C++ code that provides better link-compatibility between C++ binaries. Because it is shared, the namespace limitations present with static versions of the library are gone and symbols are no longer marked <code>__private_extern__</code>. For information about designing and using C++–based dynamic libraries, see <em><a href="../../DynamicLibraries/index.html#//apple_ref/doc/uid/TP40001869" target="_top">Dynamic Library Programming Topics</a></em>.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001667-DontLinkElementID_9" title="Note"></a><p><strong>Note:</strong>&nbsp;To build programs that link to <code>libstdc++.dylib</code>, you must have GCC 4.0, which is provided with Xcode Tools in Mac OS X v10.4. You use this compiler along with the SDKs provided by Apple to build your binary for 10.3.9. For more information, see <span class="content_text"><a href="LibCPPDeployment.html#//apple_ref/doc/uid/TP40001668-BCIFHCHA">“Deploying Applications With the C++ Runtime.”</a></span> </p></div><a name="//apple_ref/doc/uid/TP40001667-97487" title="Advantages of a Shared C++ Runtime "></a><h4>Advantages of a Shared C++ Runtime </h4><p><a name="//apple_ref/doc/uid/TP40001667-DontLinkElementID_20"></a><a name="//apple_ref/doc/uid/TP40001667-DontLinkElementID_21"></a>Packaging the standard C++ library as a dynamic shared library is important for ensuring performance and correctness of your program. If your executable links to <code>libstdc++.a</code> and to several dynamic shared libraries, and one or more of those shared libraries also links to <code>libstdc++.a</code>, then multiple copies of the library are loaded into memory at runtime. </p><p>For correctness, all components of a program should use the exact same copy of the standard C++ library. The reason is that some data in the C++ runtime must be shared by all components or unexpected results may occur. For example, if two components both use the C++ I/O mechanism to write to standard output, the results can become garbled if they use different buffers.</p><p>For performance, having multiple copies of the same library leads to increased disk activity as each copy is read into memory. The extra copies can also lead to increased paging and cache misses due to the increased memory footprint of the application. Eliminating the duplicated libraries can reduce the footprint of your application dramatically. For example, consider the following “hello world” program compiled with <code>libstdc++.a</code> and GCC 3.3:</p><div class="codesample"><table><tr><td scope="row"><pre>int main ()<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    std::cout &lt;&lt; "Hello, World!\n" &lt;&lt; std::endl;<span></span></pre></td></tr><tr><td scope="row"><pre>    return 0;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>The size of the resulting binary on a Mac OS X v10.4 system is 650 KB. The same program compiled on the same system using GCC 4.0 and <code>libstdc++.dylib</code> is 17 KB. </p><a name="//apple_ref/doc/uid/TP40001667-96960" title="Binary Compatibility"></a><h4>Binary Compatibility</h4><p><a name="//apple_ref/doc/uid/TP40001667-DontLinkElementID_22"></a>GCC 4.0 conforms to the Itanium C++ ABI<a name="//apple_ref/doc/uid/TP40001667-DontLinkElementID_23"></a>, which is a standard for compiled C++ code. The specifications for this standard are maintained by a multi-vendor consortium and cover issues such as name mangling, class member layout, virtual method invocation protocols, exception handling, and runtime type information (RTTI) formats. You can find the latest version of this specification at <span class="content_text"><a href="http://www.codesourcery.com/cxx-abi/abi.html" target="_blank">http://www.codesourcery.com/cxx-abi/abi.html</a></span>. </p><p>Because GCC 4.0 conforms to the Itanium C++ ABI, C++ objects are link-compatible with objects built by other Mac OS X compilers that conform to this specification. Apple guarantees that future releases of GCC for Mac OS X will also conform to the Itanium C++ ABI. This means that developers may safely ship dynamic shared libraries whose interfaces involve C++ classes, albeit with some caveats:</p><ul class="spaceabove"><li class="li"><p>Apple guarantees ABI stability only for core language features. It does not guarantee stability for library classes, including <code>std::string</code>, <code>std::map&lt;T></code>, and <code>std::ostream</code> among others.</p></li><li class="li"><p>Apple does not guarantee binary compatibility between different major versions of <code>libstdc++</code>. GCC 4.0 ships with version 6.0.3 of the library. If a new major version (version 7.0.0) is released in the future, that library is not guaranteed to be compatible with 6.x versions. </p></li><li class="li"><p>Binary compatibility between different versions of a third-party dynamic shared library also depends on the design of the library, not just on the compiler support for a standard ABI. You must ensure that you do not introduce compatibility issues.</p></li></ul><p>If you are designing a dynamic shared library for distribution, it is still your responsibility to ensure that you do not create binary compatibility problems. For example, you should not introduce member variables or virtual methods to a base class. Doing so causes a fragile base class problem and requires clients of the library to be recompiled. </p><p>For more information on binary compatibility, see <span class="content_text"><a href="CompatibleLibs.html#//apple_ref/doc/uid/TP40001669-BBCEJBEG">“Creating Compatible Libraries.”</a></span> </p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../CPPRuntimeEnv.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="LibCPPDeployment.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2005, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-06-28<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/DeveloperTools/Conceptual/CppRuntimeEnv/Articles/CPPROverview.html%3Fid%3DTP40001666-1.4&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/DeveloperTools/Conceptual/CppRuntimeEnv/Articles/CPPROverview.html%3Fid%3DTP40001666-1.4&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/DeveloperTools/Conceptual/CppRuntimeEnv/Articles/CPPROverview.html%3Fid%3DTP40001666-1.4&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
