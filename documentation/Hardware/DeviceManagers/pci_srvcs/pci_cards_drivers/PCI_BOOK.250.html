<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE> Little-Endian Processing Mode</TITLE></HEAD><BODY BGCOLOR="#ffffff"><DIV><a name="top"></a><!-- start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!-- start of path --><font face="Geneva,Helvetica,Arial" size="1"><b><br>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Documentation</a> &gt; <!-- a href="" target="_top" -->Hardware<!-- /a -->  <b>&gt; </b><a href="../../devicemgrs.html" target="_top">Device Managers and Drivers</a> <b>&gt; </b><a href="../pci_srvcs.html" target="_top">PCI Card Services</a> <b>&gt; </b>Designing PCI Cards and Drivers for Power Macintosh Computers</font><br><br><!-- end of path --><A HREF="PCI_BOOK.24e.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.24f.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.251.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><HR></DIV><H1 CLASS="H2.Heading2"><A NAME="pgfId=1264"> </A><A NAME="36419"> </A>Little-Endian Processing Mode</H1><P CLASS="T1.Text1"><A NAME="pgfId=1265"> </A>The PowerPC microprocessor supports a little-endian processing mode, in which addresses are swizzled when they are used to access memory. The swizzle applies an XOR operation to the low-order 3 bits of an address with a constant that depends upon the size of the data being loaded or stored. Word load and store actions use a value of 0b100, halves use 0b110, and bytes use 0b111. The resulting addresses are used to make memory references to a big-endian memory system.</P><DIV><blockquote><p CLASS="NoteHead"><b><A NAME="pgfId=11508"> </A>Note</b></p><P CLASS="Note"><A NAME="pgfId=1266"> </A>The PowerPC's effective address is not modified, only the interpretation used to access memory. For example, the update forms of load and store instructions alter the base register with the same value, regardless of the current endian mode. Thus, the address swizzle is completely transparent to software. </P></blockquote><P CLASS="T1.Text1"><A NAME="pgfId=1270"> </A>Notice that the address swizzle in little-endian processing mode changes only the lower 3 bits. The number of address bits swizzled depends upon the maximum scalar data type that can be accessed by the system; it does not depend upon the width of the processor's data path. In the case of PowerPC processor, the longest scalar is a double word--hence, swizzling 3 bits suffices to transform any address.</P><P CLASS="T1.Text1"><A NAME="pgfId=1273"> </A>By swizzling the offsets in the big-endian DMA descriptor value shown in <A HREF="PCI_BOOK.24d.html#29122" CLASS="XRef">Figure&nbsp;A-10</A>, little-endian processing mode produces a new set of offsets. For example, the processor applies the calculation 0b000 <TT CLASS="cv">XOR</TT> 0b100 to the 0 offset for the word field <TT CLASS="cv">aDescr.A</TT>, producing the offset 0b100, or 4. Software can read the correct value of 0x44454647 at that offset. The result is that the whole descriptor appears to have the structure shown in <A HREF="PCI_BOOK.250.html#40449" CLASS="XRef">Figure&nbsp;A-11</A>.</P><P CLASS="Fg.Figure"><B><A NAME="pgfId=1282"> </A>Figure&nbsp;A-11	<A NAME="40449"> </A>Descriptor swizzled by little-endian processing mode</B></P><DIV><IMG SRC="PCI_BOOK-49.gif"></DIV></DIV><DIV><blockquote><p CLASS="NoteHead"><b><A NAME="pgfId=11510"> </A>Note</b></p><P CLASS="Note"><A NAME="pgfId=1283"> </A>PowerPC little-endian mode does not support misaligned data accesses. Access to misaligned data must be done by code sequences or subroutines. As is the case with byte-reversed load and store instructions, there is currently no compiler support for handling misaligned data. </P></blockquote></DIV><HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 26 March 99)<P><A HREF="PCI_BOOK.24e.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.24f.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.251.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></HTML>