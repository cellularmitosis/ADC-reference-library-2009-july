<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Creating Object Specifier Records(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING251></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-250.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-252.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-231.html"><B>Chapter 6 - Resolving and Creating Object Specifier Records</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING251-0></A>
<H1><A NAME=MARKER-9-227></A>Creating Object Specifier Records</H1>
 <A NAME=MARKER-2-28></A>If your application creates and sends Apple events that require the target application to locate Apple event objects, your application must create object specifier records for those events. This section describes how to use the four keyword-specified descriptor records described in <A HREF=IAC-233.html#MARKER-9-91>"Descriptor Records Used in Object Specifier Records,"</A> which begins on <A HREF=IAC-233.html#MARKER-9-91>page 6-7</A>, to specify the object class ID, container, key form, and key data for an object specifier record. <A NAME=MARKER-2-229></A><P>
 Because the internal structure of an object specifier record is nearly identical to the internal structure of an AE record, it is possible to use <CODE>AECreateList</CODE>, <CODE>AEPutPtr</CODE>, and <CODE>AEPutKeyDesc</CODE> to add the four keyword-specified descriptor records to an AE record, then use <CODE>AECoerceDesc</CODE> to coerce the AE record to a descriptor record of type <CODE>typeObjectSpecifier</CODE>. However, it is usually preferable to use the <CODE>CreateObjSpecifier</CODE> function to accomplish the same goal. The <CODE>CreateObjSpecifier</CODE> function adds the keyword-specified descriptor records directly to an object specifier record, thus eliminating several steps that are required if you create an AE record first. The instructions that follow make use of <CODE>CreateObjSpecifier</CODE>. <P>
 To specify the class ID for an object specifier record, your application can specify the appropriate class ID value as the desiredClass parameter for the <CODE>CreateObjSpecifier</CODE> function, which uses it to create a keyword-specified descriptor record with the keyword <CODE>keyAEDesiredClass</CODE> as part of an object specifier record. <A NAME=MARKER-2-231></A><P>
 To specify the container for an object specifier record, your application must create a keyword-specified descriptor record with the keyword <CODE>keyAEContainer</CODE> that fully describes the container of the Apple event object. Because this container is usually another Apple event object, the container is usually specified by another object specifier record. <A NAME=MARKER-9-16></A><P>
 To specify the complete container hierarchy of an Apple event object, your application must create a series of nested object specifier records, starting with the object specifier record for the Apple event object whose container is outermost. With the exception of this first object specifier record, each object specifier record specifies another object specifier record in the chain as a container. <P>
 For example, <A HREF=IAC-235.html#MARKER-9-99>Figure 6-2 on page 6-9</A> shows a series of nested object specifier records that specify the first row of a table named "Summary of Sales" in a document named "Sales Report." The logical organization of the same object specifier records is summarized in <A HREF=#MARKER-9-50>Table 6-7</A>.
<TABLE BORDER="0" CELLPADDING=3>
<CAPTION><A NAME=MARKER-9-50></A><B>Table 6-7 Nested object specifier records that describe a container hierarchy</B></CAPTION>
<TH>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyAEDesiredClass<TD>typeType<TD>cRow<TR>
<TD>keyAEContainer<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cTable<TR>
<TD>  keyAEContainer<TD>  typeObjectSpecifier<TD><CODE>  </CODE>(see indented record)<TR>
<TD>    keyAEDesiredClass<TD>    typeType<TD>    cDocument<TR>
<TD>    keyAEContainer<TD>    typeNull<TD>    Data handle is <CODE>NIL</CODE><TR>
<TD>    keyAEKeyForm<TD>    typeEnumerated<TD>    formName<TR>
<TD>    keyAEKeyData<TD>    typeChar<TD>    "Sales Report"<TR>
<TD>  keyAEKeyForm<TD>  typeEnumerated<TD>  formName<TR>
<TD>  keyAEKeyData<TD>  typeChar<TD>  "Summary of Sales"<TR>
<TD>keyAEKeyForm<TD>typeEnumerated<TD>formAbsolutePosition<TR>
<TD>keyAEKeyData<TD>typeLongInteger<TD>1</TABLE>
<P>
<DL>
<DT><B>Note</B>
<DD>The format used in <A HREF=#MARKER-9-50>Table 6-7</A> and similar tables throughout this chapter does not show the structure of nested object specifier records as they exist within an Apple event. Instead, this format shows what you would obtain after calling <CODE>AEGetKeyDesc</CODE> repeatedly to extract the object specifier records from an Apple event record.  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
<DD>When you call <CODE>AEGetKeyDesc</CODE> to extract a null descriptor record, <CODE>AEGetKeyDesc</CODE> returns a descriptor record of type <CODE>AEDesc</CODE> with a descriptor type of <CODE>typeNull</CODE> and a data handle whose value is 0.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 To specify the default container for an object specifier record (such as the container for the document in <A HREF=#MARKER-9-50>Table 6-7</A>), you can use <CODE>AECreateDesc</CODE> to create a null descriptor record, which you can then pass in the theContainer parameter of the <CODE>CreateObjSpecifier</CODE> function. The <CODE>CreateObjSpecifier</CODE> function uses the null descriptor record to create a keyword-specified descriptor record with the keyword <CODE>keyAEContainer</CODE> as part of an object specifier record. <P>
 The object specifier record that specifies the default container is always the first record you create in a series of nested object specifier records that specifies the complete container hierarchy for an Apple event object. Each one in the series uses the previously created object specifier record to specify its container. As with the null descriptor record, you can pass an object specifier record as the second parameter to the <CODE>CreateObjSpecifier</CODE> function, which uses it to create a keyword-specified descriptor record with the keyword <CODE>keyAEContainer</CODE>.<P>
 <A NAME=MARKER-2-233></A>To specify the key form for an object specifier record, your application can specify a key form constant as the third parameter to the <CODE>CreateObjSpecifier</CODE> function, which uses it to create a keyword-specified descriptor record with the keyword <CODE>keyAEKeyForm</CODE> as part of an object specifier record. The standard key forms for object specifier records are summarized in <A HREF=IAC-237.html#MARKER-9-14>Table 6-1 on page 6-13</A>.<P>
 For example, the key form for the object specifier records in <A HREF=#MARKER-9-50>Table 6-7</A> that specify the document and the table is <CODE>formName</CODE>. In other words, the key data identifies the document and the table by their names. Similarly, the key form for the object specifier record in <A HREF=#MARKER-9-50>Table 6-7</A> that specifies the first row in the table is <CODE>formAbsolutePosition</CODE>. In other words, the key data identifies the position of the row compared to other rows in the same container.<P>
 <A NAME=MARKER-21-449></A>To specify the key data for an object specifier record, your application must create a keyword-specified descriptor record with the keyword <CODE>keyAEKeyData</CODE> whose data handle refers to the appropriate data for the specified key form. You can use <CODE>AECreateDesc</CODE>, CreateCompDescriptor, CreateLogicalDescriptor, and related functions to create the descriptor record, which you can then pass in the fourth parameter of the <CODE>CreateObjSpecifier</CODE> function. The <CODE>CreateObjSpecifier</CODE> function uses this descriptor record to create a keyword-specified descriptor record with the keyword <CODE>keyAEKeyData</CODE> as part of an object specifier record.<P>
<HR>
<B>Subtopics</B>
<B><!-- TOC --><DL>
<DL>
<DT><A HREF="IAC-252.html#HEADING252-0">Creating a Simple Object Specifier Record</A>
<DD>
<DT><A HREF="IAC-253.html#HEADING253-0">Creating a Complex Object Specifier Record</A>
<DD>
</DL>
</DL>
</B>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-250.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-252.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
