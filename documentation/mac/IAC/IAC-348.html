<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>OSAStore(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING348></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-347.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-349.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-331.html"><B>Chapter 10 - Scripting Components</B></A> / <A HREF="IAC-344.html"><B>Scripting Components Reference</B></A><BR><DL><DD><A HREF="IAC-346.html"><B>Required Scripting Component Routines</B></A> / <A HREF="IAC-347.html"><B>Saving and Loading Script Data</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING348-0></A>
<H3>OSAStore</H3>
 You can use the <CODE>OSAStore</CODE> function to get a handle to script data in the form of a storage descriptor record. <A NAME=MARKER-21-172></A> <A NAME=MARKER-2-3></A> <A NAME=MARKER-2-172></A><P>
<PRE>
FUNCTION OSAStore(scriptingComponent: ComponentInstance; 
                  scriptID: OSAID; 
                  desiredType: DescType;
                  modeFlags: LongInt;
                  VAR resultingScriptData: AEDesc): OSAError;
</PRE>
<DL>
<DT><CODE>scriptingComponent</CODE>
<DD> A component instance created by a prior call to the Component Manager function <CODE>OpenDefaultComponent</CODE> or <CODE>OpenComponent</CODE> (see <A HREF=IAC-332.html#MARKER-9-76>page 10-4</A>).
<DT><CODE>scriptID</CODE>
<DD> The script ID for the script data for which to obtain a data handle. 
<DT><CODE>desiredType</CODE>
<DD> The desired type of the descriptor record to be returned. If you want to store the script data in the form used by a generic storage descriptor record, specify <CODE>typeOSAGenericStorage</CODE>.
<DT><CODE>modeFlags</CODE>
<DD> Information used by individual scripting components. To avoid setting any mode flags, specify <CODE>kOSAModeNull</CODE>. To indicate that only the minimum script data required to run the script should be returned, pass <CODE>kOSAModePreventGetSource</CODE> in this parameter. (In this case the script data returned is not identical to the compiled script data and can't be used to generate source data.) If the <CODE>scriptID</CODE> parameter identifies a script context, you can pass <CODE>kOSAModeDontStoreParent</CODE> in this parameter to store the script context without storing its parent context.
<DT><CODE>resultingScriptData</CODE>
<DD> The resulting descriptor record.
</DL>
<A NAME=HEADING348-8></A>
<H5>DESCRIPTION</H5>
 The <CODE>OSAStore</CODE> function writes script data to a descriptor record so that the data can later be saved in a resource or written to the data fork of a document. You can then reload the data for the descriptor record as a compiled script (although possibly with a different script ID) by passing the descriptor record to <CODE>OSALoad</CODE>. <P>
 If you want the returned script data to be as small as possible and you are sure that you won't need to display the source data to the user, specify the <CODE>kOSAModePreventGetSource</CODE> flag in the <CODE>modeFlags</CODE> parameter. If the <CODE>scriptID</CODE> parameter identifies a script context and you don't want the returned script data to include the associated parent context, specify the <CODE>kOSAModeDontStoreParent</CODE> flag in the <CODE>modeFlags</CODE> parameter.<P>
 The desired type is either <CODE>typeOSAGenericStorage</CODE> (for a generic storage descriptor record) or a specific scripting component subtype value (for a component-specific storage descriptor record).<P>
 To store either a generic storage descriptor record or a component-specific storage descriptor record with your application's resources, use <CODE>'scpt'</CODE> as the resource type. The generic scripting component subtype, the generic storage descriptor type, and the resource type for stored script data all have the same value, though they serve different purposes.<P>
<PRE>
CONST 
   kOSAGenericScriptingComponentSubtype = 'scpt';
   kOSAScriptResourceType = kOSAGenericScriptingComponentSubtype;
   typeOSAGenericStorage = kOSAScriptResourceType;
</PRE>
<A NAME=HEADING348-14></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>errOSASystemError<TD>-1750<TD>General scripting system error<TR>
<TD>errOSAInvalidID<TD>-1751<TD>Invalid script ID<TR>
<TD>errOSABadStorageType<TD>-1752<TD>Desired type not supported by this scripting component <A NAME=MARKER-21-103></A> <A NAME=MARKER-2-132></A> <TR>
<TD>badComponentInstance<TD>$80008001<TD>Invalid component instance</TABLE>
</H5>
<A NAME=HEADING348-15></A>
<H5>SEE ALSO</H5>
 For more information about storage formats for script data, see <A HREF=IAC-335.html#MARKER-9-98>"Saving Script Data" on page 10-12</A>.<P>
 For an example of the use of <CODE>OSAStore</CODE>, see <A HREF=IAC-413.html#MARKER-9-291>Listing 10-6 on page 10-19</A>. <A NAME=MARKER-2-173></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-347.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-349.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
