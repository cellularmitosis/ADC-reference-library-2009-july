<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>DVD Playback Services Programming Guide: Programming Concepts</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Programming Concepts"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40002949" title="Programming Concepts"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000424" target="_top">Graphics &amp; Imaging</a> &gt; <a href="../../../Video-date.html#//apple_ref/doc/uid/TP30000440-TP30000424-TP40001677" target="_top">Video</a> &gt; <a href="../dvdguide_intro/dvdguide_intro.html#//apple_ref/doc/uid/TP40002948-TPXREF101">DVD Playback Services Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../dvdguide_intro/dvdguide_intro.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../dvdguide_tasks_1/dvdguide_tasks_1.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40002949-TPXREF101" title="Programming Concepts"></a><h1>Programming Concepts</h1><p>Introduced in the late 1990's, DVD-Video is a standard for storing and reproducing audio and video on DVD-ROM discs. DVD-Video is an exciting multimedia technology, and DVD Playback Services makes this technology accessible and easy to use for developers writing Mac OS X applications. DVD Playback Services makes it possible to control all aspects of DVD-Video playback without concern for the complicated details of getting the media content stream from the disc to the user. You can use DVD Playback Services to write your own DVD player, or use it to incorporate playback features into an existing application. This chapter describes the concepts you'll need to understand before you begin using DVD Playback Services. </p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="dvdguide_concepts.html#//apple_ref/doc/uid/TP40002949-DontLinkElementID_1">DVD Playback Architecture</a>
				
			<br/>
			
        
			
			
				<a href="dvdguide_concepts.html#//apple_ref/doc/uid/TP40002949-DontLinkElementID_2">The Playback Session</a>
				
			<br/>
			
        
			
			
				<a href="dvdguide_concepts.html#//apple_ref/doc/uid/TP40002949-SW2">DVD Events</a>
				
			<br/>
			
        
			
			
				<a href="dvdguide_concepts.html#//apple_ref/doc/uid/TP40002949-DontLinkElementID_3">Media Folders</a>
				
			<br/>
			
        
			
			
				<a href="dvdguide_concepts.html#//apple_ref/doc/uid/TP40002949-DontLinkElementID_4">Exceptions and Error Handling</a>
				
			<br/>
			
        
			
			
				<a href="dvdguide_concepts.html#//apple_ref/doc/uid/TP40002949-DontLinkElementID_5">Video Windows</a>
				
			<br/>
			
        
			
			
				<a href="dvdguide_concepts.html#//apple_ref/doc/uid/TP40002949-DontLinkElementID_6">Menus and Menu Navigation</a>
				
			<br/>
			
        
			
			
				<a href="dvdguide_concepts.html#//apple_ref/doc/uid/TP40002949-DontLinkElementID_7">Audio Output</a>
				
			<br/>
			
        
			
			
				<a href="dvdguide_concepts.html#//apple_ref/doc/uid/TP40002949-DontLinkElementID_8">Bookmarks</a>
				
			<br/>
			
        
			
			
				<a href="dvdguide_concepts.html#//apple_ref/doc/uid/TP40002949-DontLinkElementID_9">Languages</a>
				
			<br/>
			
        
			
			
				<a href="dvdguide_concepts.html#//apple_ref/doc/uid/TP40002949-DontLinkElementID_10">Camera Angles</a>
				
			<br/>
			
        
			
			
				<a href="dvdguide_concepts.html#//apple_ref/doc/uid/TP40002949-DontLinkElementID_11">An Example DVD Player</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40002949-DontLinkElementID_1" title="DVD Playback Architecture"></a><h2>DVD Playback Architecture</h2><p>DVD Playback Services provides an abstraction layer for the programmer that hides the complexity of playback processing. The API includes a basic set of functions that are closely aligned to the controls on a typical DVD player, and other functions to implement advanced features such as bookmarks and region code updates. The diagram in <span class="content_text">Figure 1-1</span> shows a simplified, high-level view of how DVD Playback Services works. </p><br/><div><a name="//apple_ref/doc/uid/TP40002949-SW1" title="Figure 1-1DVD playback high-level architecture"></a><p><strong>Figure 1-1&nbsp;&nbsp;</strong>DVD playback high-level architecture</p><img src = "../Art/dvd_playback_sessions.gif" alt = "DVD playback high-level architecture" width="598" height="330"></div><br/><p>The data interface reads the media and creates data streams for video, audio, subpictures, navigation, and so on. (Subpictures are bitmap overlays used for subtitles, captions, and other static visual content.) The DVD navigator manages the DVD user interface and controls playback. Menus are used for content selection, and in some cases for feature control. The content consists of up to 99 titles, and each title is divided into one or more sequential parts (chapters). Media decoders handle the decryption and decoding of compressed video and audio data streams. DVD Playback supports the MPEG-1 and MPEG-2 video codecs, and the PCM, AC-3, and MPEG audio codecs. The video channels are composited for display in a Carbon or Cocoa window. Audio data is converted into stereo analog output. </p><a name="//apple_ref/doc/uid/TP40002949-DontLinkElementID_2" title="The Playback Session"></a><h2>The Playback Session</h2><p>DVD Playback Services uses the concept of a playback session. A playback session is a connection between a process and the DVD Playback framework. Only one session is possible at a time on a given computer system. (This is necessary because on certain computer systems the graphics I/O drivers are not re-entrant.) A new session begins when you call the <code><a href="../../../Reference/DVDPlaybackRef/Reference/reference.html#//apple_ref/c/func/DVDInitialize" target="_top">DVDInitialize</a></code> function and ends when you call the <code><a href="../../../Reference/DVDPlaybackRef/Reference/reference.html#//apple_ref/c/func/DVDDispose" target="_top">DVDDispose</a></code> function.</p><p>Sessions are multithreaded. All drawing is handled in the main thread. If you implement a callback function and register the function with DVD Playback Services, the function is always called in a thread other than the main thread. </p><p>During a playback session, DVD Playback Services maintains state information on your behalf. You can use accessor functions such as <code><a href="../../../Reference/DVDPlaybackRef/Reference/reference.html#//apple_ref/c/func/DVDGetTitle" target="_top">DVDGetTitle</a></code> to ask for specific state information, or you can receive notifications of state change events by registering a callback function. Notifications are discussed in more detail in the next section <span class="content_text">“DVD Events.”</span> </p><a name="//apple_ref/doc/uid/TP40002949-SW2" title="DVD Events"></a><h2>DVD Events</h2><p>DVD Playback Services provides accessor functions to get the current values of various state parameters during playback. For example, you can use the <code><a href="../../../Reference/DVDPlaybackRef/Reference/reference.html#//apple_ref/c/func/DVDGetTime" target="_top">DVDGetTime</a></code> function to find out if the elapsed playback time has changed. It's possible to detect state changes by calling an accessor function repeatedly; this practice is often referred to as polling. Polling can consume alot of cycles, and its use is generally discouraged in Mac OS X applications. </p><p>To eliminate the need for polling, DVD Playback Services defines a set of notification events called DVD events. DVD events are used to notify your application of important state changes. Most DVD events include one or two integer values that indicate something about the current playback state. To receive DVD events of interest, you register one or more callback functions. You can register a single callback function to handle multiple events, or use several different callbacks. </p><p>For example, you may want to implement a clock to show the user how long the current title has been playing. The best way to keep track of the current playback time is to register a callback to receive the <code><!--a target="_top" -->kDVDEventTitleTime<!--/a--></code> event. This event passes the elapsed time and duration of the current title to your application at a regular interval that you can control. </p><p>To learn about the various types of DVD events, see "Event Codes" in the constants section of  <em><a href="../../../Reference/DVDPlaybackRef/index.html#//apple_ref/doc/uid/TP40001864" target="_top">DVD Playback Framework Reference</a></em>. </p><a name="//apple_ref/doc/uid/TP40002949-DontLinkElementID_3" title="Media Folders"></a><h2>Media Folders</h2><p>DVD-Video media is enclosed in a folder with a standard name. In standard-definition media, the folder is named VIDEO_TS. On a DVD disc, the media folder is located at the root level of the disc's Universal Disc Format (UDF) file system. Media folders can also be stored anywhere on a hard drive; this might occur if you're authoring the media yourself. A media folder generally contains many different files and folders in a standard configuration. </p><p>When you use DVD Playback Services to open DVD-Video media for playback, you must specify the full path to the media folder on the mounted disc volume or hard drive. For example, the path to the media on a DVD disc might be <code>/Volumes/MY_MOVIE/VIDEO_TS</code>. Before attempting to open media, DVD Playback Services checks the media folder to make sure its structure is valid. In addition, the media's region codes are checked against the region code currently assigned to the DVD drive, to make sure the media is authorized for playback in the drive. </p><p>After you open DVD-Video media, you can ask DVD Playback Services for the media's unique 64-bit identifier or media ID. You can use this media ID as a key to save information about the media in a file for later use. </p><a name="//apple_ref/doc/uid/TP40002949-DontLinkElementID_4" title="Exceptions and Error Handling"></a><h2>Exceptions and Error Handling</h2><p>Almost all the functions in DVD Playback Services return a result code, either zero (<code>noErr</code>) to indicate success or a negative integer to indicate why the function failed. DVD Playback Services defines several dozen result codes. Generally, a non-zero result code indicates one of two things: </p><ul class="ul"><li class="li"><p>The operation is not permitted because of the current playback state. For example, if no media folder is open and you call the <code><a href="../../../Reference/DVDPlaybackRef/Reference/reference.html#//apple_ref/c/func/DVDPlay" target="_top">DVDPlay</a></code> function, nothing happens and the function passes back the result code <code><a href="../../../Reference/DVDPlaybackRef/Reference/reference.html#//apple_ref/c/econst/kDVDErrorNoValidMedia" target="_top">kDVDErrorNoValidMedia</a></code>. </p></li><li class="li"><p>The operation is not permitted by the media itself. Authors of DVD media can place constraints on various operations. When DVD Playback Services enforces one of these constraints, it returns the result code <code><a href="../../../Reference/DVDPlaybackRef/Reference/reference.html#//apple_ref/c/econst/kDVDErrorUserActionNoOp" target="_top">kDVDErrorUserActionNoOp</a></code>. </p></li></ul><p>More serious exceptions or errors can also occur. These errors are signaled to your application by calling one of the custom callback functions that you register. There are two types of serious errors: errors signaled with a DVD error event (<code><!--a target="_top" -->kDVDEventError<!--/a--></code>), and I/O errors signaled by calling a fatal error callback function that you implement and register. When you receive a serious error, you should end the playback session immediately. </p><a name="//apple_ref/doc/uid/TP40002949-DontLinkElementID_5" title="Video Windows"></a><h2>Video Windows</h2><p>A video window is simply a Carbon or Cocoa window that you create and use for DVD-Video playback. DVD Playback Services supports the use of a single window for playback. You need to specify the window's graphics port (Carbon) or window ID (Cocoa), and the bounds of the area inside the window in which you want the video to be displayed. This video area is a rectangular area somewhere inside the content area of the window; often the content area and the video area are the same rectangle. </p><p>DVD Playback Services always scales the video to fit inside the video area, so it's important to specify a video area with the correct aspect ratio. Every title on a DVD is authored for one of two video aspect ratios: standard (4:3 or 1.33) or wide (16:9 or 1.78). Whenever the title changes, you are responsible for changing the aspect ratio of the video area to conform to the new aspect ratio. Some scaling is unavoidable, because the dimensions of the actual DVD-Video raster do not conform to either of these two aspect ratios. (Another way of thinking about this is that DVD pixels are rectangular, not square.) For example, the NTSC raster for standard video is actually 720 x 480 pixels.  To display NTSC standard video output as it's intended to be seen, you need to rescale the video area horizontally (640 x 480), vertically (720 x 540), or both. </p><p>You also need to tell DVD Playback Services which display device it should use for the video output. For optimal performance, the window should always be positioned on a single screen. On systems with more than one screen, the user may attempt to move the video window so that it straddles two screens at once. If this occurs, your application should move the entire window onto the screen that contains the largest window area. </p><a name="//apple_ref/doc/uid/TP40002949-DontLinkElementID_6" title="Menus and Menu Navigation"></a><h2>Menus and Menu Navigation</h2><p>DVD-Video media generally contains one or more menus, including a disc or top menu. A DVD menu is an on-screen menu that presents one or more buttons and other visual information to help the user make a choice. The buttons specify titles to play, settings, or other menus. The visual information can include button highlights and animated backgrounds. The information needed to display these menus is contained in the media itself; no Carbon or Cocoa UI elements are needed. (It's important not to confuse DVD menus with application menus such as the Controls menu in DVD Player.)</p><br/><div><a name="//apple_ref/doc/uid/TP40002949-SW3" title="Figure 1-2A DVD menu"></a><p><strong>Figure 1-2&nbsp;&nbsp;</strong>A DVD menu</p><img src = "../Art/dvd_trailer_menu.gif" alt = "A DVD menu" width="352" height="292"></div><br/><p>DVD Plackback Services provides an abstraction layer that eliminates the complexity of displaying and operating DVD menus. You simply need to notify DVD Playback Services whenever the user moves or clicks the mouse inside the video window, presses an arrow key to navigate between buttons, or presses the return or enter key to activate a button. DVD Playback Services provides a set of functions you can call whenever one of these events occurs. These functions are documented in the "Menu Navigation" section of <em><a href="../../../Reference/DVDPlaybackRef/index.html#//apple_ref/doc/uid/TP40001864" target="_top">DVD Playback Framework Reference</a></em>. </p><p>To summarize, DVD Playback Services is responsible for displaying the DVD Menu and performing its actions. You are responsible for notifying DVD Playback Services when a user operates an input device (mouse or keyboard) to use the menu. Visual feedback and button selection in the menu is handled for you automatically. When the user selects and activates a button, DVD Playback Services performs the associated action. The action might be to play a title or scene, or branch to another menu. </p><a name="//apple_ref/doc/uid/TP40002949-DontLinkElementID_7" title="Audio Output"></a><h2>Audio Output</h2><p>When DVD media is playing, DVD Playback Services directs the audio output to the system's internal speakers or to an external device connected to the audio output port. </p><p>The audio output volume experienced by the user is controlled by two settings: the system volume setting and the playback volume setting. The playback volume is a subset of the system volume. DVD Playback Services allows you to set the playback volume using an integer that ranges from 0 to 255, where 255 is the current system volume. Both stereo channels use the same volume setting. DVD Playback Services also allows you to toggle the audio output on and off; you could use this feature to implement an audio mute control. </p><p>DVD Playback Services provides functions to get information about the audio stream being used in the current title, to find other audio streams, and to switch to a different audio stream. For example, you could use these functions to switch between different formats such as AC-3 and MPEG audio. These functions are documented in the "Accessing Audio Streams" section of <em><a href="../../../Reference/DVDPlaybackRef/index.html#//apple_ref/doc/uid/TP40001864" target="_top">DVD Playback Framework Reference</a></em>. </p><a name="//apple_ref/doc/uid/TP40002949-DontLinkElementID_8" title="Bookmarks"></a><h2>Bookmarks</h2><p>DVD Playback Services provides a way to create bookmarks that specify the media position during playback. A bookmark can represent a menu, a still picture, the elapsed time in a title, or any other location in the media. A bookmark is a block of data that can be stored in memory or written out to a file. At some later time, you can retrieve the bookmark and call the <code><a href="../../../Reference/DVDPlaybackRef/Reference/reference.html#//apple_ref/c/func/DVDGotoBookmark" target="_top">DVDGotoBookmark</a></code> function to go to the specified position in the media and begin playing. </p><p>You can use bookmarks to implement a number of interesting features. For example, you could:</p><ul class="ul"><li class="li"><p>Allow the user to create bookmarks to favorite scenes for later re-play. </p></li><li class="li"><p>Save a bookmark to the last play position in a file, and use this bookmark to resume playback at the specified frame when the media is re-opened. </p></li></ul><a name="//apple_ref/doc/uid/TP40002949-DontLinkElementID_9" title="Languages"></a><h2>Languages</h2><p>On DVDs that support multiple languages, generally the user can select a different language for the audio channel, subtitles, and menus using a language selection menu created by the DVD author. You do not need to do any special programming to take advantage of this feature. </p><p>When you open media for playback, DVD Playback Services selects a default language based on the language setting in the International Preferences panel and the languages available in the media. You can use DVD Playback Services to determine the language used in the current title or menu, and to set the default to a different language. For more information, see the section "Accessing Language Codes" in <em><a href="../../../Reference/DVDPlaybackRef/index.html#//apple_ref/doc/uid/TP40001864" target="_top">DVD Playback Framework Reference</a></em>. </p><a name="//apple_ref/doc/uid/TP40002949-DontLinkElementID_10" title="Camera Angles"></a><h2>Camera Angles</h2><p>The author of a DVD can create as many as nine video streams that represent the same scene viewed from different camera angles. The primary angle is designated as angle 1. You can use DVD Playback Services to find the number of different angles in a title, and to get or set the current angle. For more information, see the section "Accessing Camera Angles" in <em><a href="../../../Reference/DVDPlaybackRef/index.html#//apple_ref/doc/uid/TP40001864" target="_top">DVD Playback Framework Reference</a></em>.  </p><a name="//apple_ref/doc/uid/TP40002949-DontLinkElementID_11" title="An Example DVD Player"></a><h2>An Example DVD Player</h2><p><em><a href="../../../../../samplecode/CocoaDVDPlayer/index.html#//apple_ref/doc/uid/DTS10003792" target="_top">CocoaDVDPlayer</a></em> is a project in the ADC Reference Library that shows how to use DVD Playback Services to write a working DVD-Video player. The CocoaDVDPlayer user interface, shown in <span class="content_text">Figure 1-3</span>, features a video window and a controller window that serves as the "remote control" for the player. (It's also possible to operate the player from the keyboard.)  </p><br/><div><a name="//apple_ref/doc/uid/TP40002949-SW4" title="Figure 1-3User interface for a DVD-Video player created using DVD Playback Services"></a><p><strong>Figure 1-3&nbsp;&nbsp;</strong>User interface for a DVD-Video player created using DVD Playback Services</p><img src = "../Art/dvd_player_on_desktop.gif" alt = "CocoaDVDPlayer user interface" width="535" height="585"></div><br/><p>Most of the code examples in this guide are based on source code used in CocoaDVDPlayer. You may find it useful to download this project now and follow along as your read about the programming tasks in the next two chapters. </p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../dvdguide_intro/dvdguide_intro.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../dvdguide_tasks_1/dvdguide_tasks_1.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2005, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-03-08<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/GraphicsImaging/Conceptual/DVDPlaybackGuide/dvdguide_concepts/dvdguide_concepts.html%3Fid%3DTP40002163-1.1&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/GraphicsImaging/Conceptual/DVDPlaybackGuide/dvdguide_concepts/dvdguide_concepts.html%3Fid%3DTP40002163-1.1&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/GraphicsImaging/Conceptual/DVDPlaybackGuide/dvdguide_concepts/dvdguide_concepts.html%3Fid%3DTP40002163-1.1&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>