<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>ERead(IM:N)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING275></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Networking-274.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Networking-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Networking-304.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt= "Book Index"></A> <A HREF="Networking-276.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Networking-2.html"><B>Networking</B></A> / <BR><DD><A HREF="Networking-257.html"><B>Chapter 11 - Ethernet, Token Ring, and Fiber Distributed Data Interface</B></A> / <A HREF="Networking-265.html"><B>Ethernet, Token Ring, and FDDI Reference</B></A><BR><DL><DD><A HREF="Networking-269.html"><B>Routines</B></A> / <A HREF="Networking-273.html"><B>Writing and Reading Ethernet Packets</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING275-0></A>
<H3>ERead</H3>
 When you use the default protocol handler for Ethernet that Apple provides, you must use the <CODE>ERead</CODE> function to read a data packet and place it in a data buffer.<P>
<PRE>
FUNCTION ERead (thePBptr: EParamBlkPtr; async: Boolean): OSErr;
</PRE>
<DL>
<DT><CODE>thePBptr</CODE>
<DD> A pointer to a parameter block of type <CODE>EParamBlock</CODE>.
<DT><CODE>async</CODE>
<DD> A Boolean value that specifies whether the function should be <BR>executed asynchronously or synchronously. Specify <CODE>TRUE</CODE> for asynchronous execution.  <A NAME=MARKER-2-22></A>
</DL>
<B>
<TABLE BORDER="0" CELLPADDING=3><TD>--><TD>ioCompletion<TD>ProcPtr<TD>A pointer to completion routine.<TR>
<TD><--<TD>ioResult<TD>OSErr<TD>The result code. <TR>
<TD>--><TD>ioRefNum<TD>Integer<TD>The driver reference number.<TR>
<TD>--><TD>csCode<TD>Integer<TD>Always <CODE>ENetRead</CODE> for this function.<TR>
<TD>--><TD>eProtType<TD>Integer<TD>The Ethernet protocol type.<TR>
<TD>--><TD>ePointer<TD>Ptr<TD>A pointer to a data buffer.<TR>
<TD>--><TD>eBuffSize<TD>Integer<TD>The size of the data buffer.<TR>
<TD><--<TD>eDataSize<TD>Integer<TD>The number of bytes read.</TABLE>
</B><P>
<DL>
<H5>Field Description</H5>
<DT><CODE><A NAME=MARKER-2-145></A>eProtType</CODE>
<DD> The protocol type of the packet you want to read.
<DT><CODE><A NAME=MARKER-2-77></A>ePointer</CODE>
<DD> A pointer to the data buffer into which you want to read data. <A NAME=MARKER-2-172></A><A NAME=MARKER-2-58></A><A NAME=MARKER-2-19></A>
<DT><CODE><A NAME=MARKER-2-40></A>eBuffSize</CODE>
<DD> The size of the data buffer. If you are expecting Ethernet data packets, the buffer should be at least 621 bytes in size; if you are expecting general Ethernet data packets, the buffer should be at least 1514 bytes in size.
<DT><CODE><A NAME=MARKER-2-32></A>eDataSize</CODE>
<DD> The number of bytes of data actually read. 
</DL>
<A NAME=HEADING275-10></A>
<H5>DESCRIPTION</H5>
 You can use the <CODE>ERead</CODE> function to read packets of a particular protocol type only after you have used the <CODE>EAttachPH</CODE> function to specify a <CODE>NIL</CODE> pointer to the protocol handler to indicate that you want to use the default protocol handler. In practice, you should <A NAME=MARKER-2-177></A>call the <CODE>EAttachPH</CODE> function very early, during your program initialization sequence, if possible. As soon as the connection is established and you are expecting data, you should call the <CODE>ERead</CODE> function asynchronously. <P>
 The <CODE>ERead</CODE> function places the entire packet, including the packet header, into your buffer. The function returns in the <CODE>eDataSize</CODE> parameter the number of bytes actually read. If the packet is larger than the data buffer, the <CODE>ERead</CODE> function places as much of the packet as will fit into the buffer and returns the <CODE>buf2SmallErr</CODE> result code.<P>
 Call the <CODE>ERead</CODE> function asynchronously to await the next data packet. When the .ENET driver receives the data packet, it completes execution of the <CODE>ERead</CODE> function and calls your completion routine. If the .ENET driver receives a data packet with a protocol type for which you specified the default protocol handler while no <CODE>ERead</CODE> command is pending, the driver discards the data packet.<P>
 You can have several asynchronous calls to the <CODE>ERead</CODE> function pending execution simultaneously as long as you use a different parameter block for each call.<P>
<A NAME=HEADING275-15></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 You must not use the <CODE>ERead</CODE> function to read packets if you supply and attach your own protocol handler. In this case, you use the driver's <CODE>ReadPacket</CODE> and <CODE>ReadRest</CODE> routines from within your protocol handler.<P>
<A NAME=HEADING275-17></A>
<H5>TOKEN RING AND FDDI CONSIDERATIONS</H5>
 This function does not apply to token ring and FDDI. <P>
<A NAME=HEADING275-19></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 To execute the <CODE>ERead</CODE> function from assembly language, call the <CODE>_Control</CODE> trap macro with a value of <CODE>ENetRead</CODE> in the <CODE>csCode</CODE> field of the parameter block. To execute the <CODE>_Control</CODE> trap asynchronously, include the value <CODE>,ASYNC</CODE> in the operand field.<P>
<A NAME=HEADING275-21></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>LAPProtErr<TD>-94<TD>No protocol is attached or protocol handler pointer <BR>was not 0<TR>
<TD>reqAborted<TD>-1105<TD><CODE>ERdCancel</CODE> or <CODE>EDetachPH</CODE> function called<TR>
<TD>buf2SmallErr<TD>-3101<TD>Packet too large for buffer; partial data returned</TABLE>
</H5>
<A NAME=HEADING275-22></A>
<H5>SEE ALSO</H5>
 See <A HREF=Networking-262.html#MARKER-9-65>"Using the Default Ethernet Protocol Handler to Read Data" beginning on page 11-13</A> for more information on using the <CODE>ERead</CODE> function.<A NAME=MARKER-2-178></A> <P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Networking-274.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Networking-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Networking-304.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt= "Book Index"></A> <A HREF="Networking-276.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Networking-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
