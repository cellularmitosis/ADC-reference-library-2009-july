<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note OV01: Chooser Enhancements</title><meta name="keywords" content="Mac OS 8 Chooser enhancement controls PACK controlHandle"><meta name="Description" content="Technical Note OV01: This Technical Note describes an enhancementto the Chooser (Version 3.2). This enhancement allows controlsto be added to the chooser. This Technical Note also documentshow this enhancement is accomplished and how this enhancementmay be utilized.">                                       <meta name="categories" content="Overview"><meta name="week-posted" content="Aug 1, 1988 - Aug 5, 1988"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002599" title="Chooser Enhancements"></a><A NAME="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxMacOS9Earlier-date.html">Mac OS 9 & Earlier</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/index.html" target="_blank">Reference Library</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note OV01</div>
<div id="pageheadsub">Chooser Enhancements</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext">					<A HREF="#References">References</A><BR><BR> <A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><p id="introtext">Beginning with version 3.2, the Chooser has been enhanced to provide support for additional controls.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Aug 01 1998]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content -->          <P><A NAME=Section1></A></P><p>As stated in <i>Inside Macintosh</i> IV-217, the Chooser communicates withdevice packages as if they were the following function:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    FUNCTION Device (message, caller: INTEGER;        objName, zoneName: StringPtr;        p1, p2: LONGINT): OSErr;</pre>	</TD></TR></TABLE></CENTER><p>This function is contained in the device package's <code>'PACK'</code> -4096 resource. If bit 17 in the <code>flags</code> field of this <code>'PACK'</code> is set, the <code>Device</code> function will receive an initialization message when the user selects that device resource file from the Chooser's window -  <code>Device</code> will be called with <code>message = initMsg</code>. This is the first message that device packages receive and may be used to set up default configurations. The MPW assembler interface for this new message is:</p><p>When the <code>Device</code> function receives <code>initMsg</code>, the<code>objName</code> parameter contains a pointer to an array of <code>ControlHandle</code>s. For this message (and for the <code>buttonMsg</code> described below) the <code>objName</code> parameter is a pointer to a structure as follows:  it begins with a size word and is followed by at least 4<code>ControlHandle</code>s. The size is at least 18 bytes (2 bytes for the size word and 4 bytes each forthe handles). More handles may be added in the future. The four <code>ControlHandle</code>s thathave been defined thus far are the left and right buttons and the "ON" and "OFF" radio buttons. Their handles appear in this order:</p><p>size word</p><p>left <code>ControlHandle</code></p><p>right <code>ControlHandle</code></p><p>on <code>ControlHandle</code></p><p>off <code>ControlHandle</code></p><p>...?</p><p>The <code>Flags</code> bits of the 'PACK' control which buttons are used. Bits 26and 27 are used to indicate whether you use the left and right buttons and are described in the Device Manager chapters in <i>Inside Macintosh</i> volumes IV and V.</p><p>Bit 20 tells the Chooser that you are employing the on and off radio buttons.Their titles can be something other than "ON" and "OFF", of course, but we'll continue to use those names since that is what the LaserWriter driver (5.0 or later) calls them. In addition to the controls and their titles, a static label ("Background Printing:" for the LaserWriter) will be displayed.</p><p>The title strings for these radio buttons are contained in the <code>'STR&nbsp;'</code> resources with IDs -4089 and -4088 in the device resource file. The string for the label is contained in <code>'STR&nbsp;'</code> resource -4087.</p><p>The rectangles for these items are defined in the <code>'nrct'</code> -4096 resource in thedevice resource file.  The Device Manager chapter of <i>Inside Macintosh</i> V-430 describes the <code>'nrct'</code> resources. The third and fourth rectangles position the radio buttons while the fifth rectangle positions the label.</p><p>For example,  the Chooser interface pictured below corresponds to the following Rez input.</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    /* label for radio buttons */    resource 'STR ' (-4087) {        &quot;Turn me:&quot;    };    /* &quot;off&quot; radio button */    resource 'STR ' (-4088) {        &quot;Off&quot;    };    /* &quot;on&quot; radio button */    resource 'STR ' (-4089) {        &quot;On&quot;    };    resource 'nrct' (-4096) {        {        /* [1] Left Button */        {0, 0, 0, 0},        /* [2] Right Button */        {0, 0, 0, 0},        /* [3] on Radio Button */        {114, 260, 130, 320},        /* [4] off Radio Button */        {114, 330, 130, 390},        /* [5] Label for Radio Buttons */        {114, 177, 130, 250}        }    };</pre>	</TD></TR></TABLE></CENTER><p><img src="images/ov_01_001.gif" alt="ov_012.gif" width=384 height=263></p><p>If the rectangles for these items are not specified in the <code>'nrct'</code> resource,then the Chooser uses default positions for these items from the Chooser's private <code>'nrct'</code> resource. These default positions are:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>        /* [3] on Radio Button */        {114, 272, 130, 332},        /* [4] off Radio Button */        {114, 335, 130, 395},        /* [5] Label for Radio Buttons */        {114, 170, 130, 267},</pre>	</TD></TR></TABLE></CENTER><p>In order for the radio buttons to be displayed, the <code>'PACK'</code> must call<code>ShowControl</code> for each of them, and pass in the corresponding <code>ControlHandle</code>. Toturn one of the radio buttons "ON" and the other "off," the <code>'PACK'</code> must call<code>SetCtlValue</code>. The best time to call these routines to set up the radio buttonsis when the <code>'PACK'</code> receives the <code>initMsg</code>. By showing the buttons <u>after</u>you have set their values, you can avoid unnecessary redrawing.</p><p>When the user clicks either of the radio buttons, the <code>'PACK'</code> receives <code>buttonMsg</code>and <code>objName</code> contains a pointer to an array of <code>ControlHandles</code>, as explainedabove. The <code>'PACK'</code> knows which of the radio buttons was clicked through thelow-order byte of the p2 parameter. This byte contains 3 if the "ON" radiobutton was clicked, or 4 if the "OFF" radio button was clicked. It is thedevice package's responsibility to set or clear the radio buttons in response to the user's action.</p> <P><A HREF="#top">Back to top</A></P><a name="References"></a><h2>References</h2><p>The Device Manager (Volumes II, IV, and V)</p><p>The Control Panel (Volume V)</p> <P><A HREF="#top">Back to top</A></P>         <P><A NAME=Downloads></A></P>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (120K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/ov_01.pdf">Download</A></P>               </TD>            </TR>                    </TABLE>         <BR></TD></TR></table></center><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/ov/ov_01.html%3Fid%3DDTS10002599-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/ov/ov_01.html%3Fid%3DDTS10002599-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/ov/ov_01.html%3Fid%3DDTS10002599-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>