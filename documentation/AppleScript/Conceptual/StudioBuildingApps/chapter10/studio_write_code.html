<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>AppleScript Studio Programming Guide: Mail Search Tutorial: Write the Code</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Mail Search Tutorial: Write the Code"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20001257" title="Mail Search Tutorial: Write the Code"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../ScriptingAutomation/index.html#//apple_ref/doc/uid/TP30000440-TP40005948" target="_top">Scripting &amp; Automation</a> &gt; <a href="../../../../ScriptingAutomation/AppleScript-date.html#//apple_ref/doc/uid/TP30000440-TP40005948-TP30000481" target="_top">AppleScript</a> &gt; <a href="../chapter01/studio_intro_book.html#//apple_ref/doc/uid/20001248-TPXREF101">AppleScript Studio Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../chapter09/studio_ms_connect_intf.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../chapter11/studio_ms_build_debug.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/20001257-TPXREF101" title="Mail Search Tutorial: Write the Code"></a><h1>Mail Search Tutorial: Write the Code</h1><p>In this chapter you’ll write the scripts and handlers for Mail Search, an AppleScript Studio application that searches for specified text in messages in the Mac OS X Mail application. You’ll also build and test the completed application. To do this, you’ll perform the steps described in the following sections:</p><ol class="ol"><li class="li"><p><span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-BCIFFIBJ">“Define Global Variables and Properties.”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-TPXREF156">“Write Event Handlers for the Interface.”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-TPXREF157">“Write Scripts and Additional Handlers.”</a></span></p></li></ol><p>This chapter assumes you have completed previous Mail Search tutorial chapters.</p><a name="//apple_ref/doc/uid/20001257-TPXREF218" title="Obtaining the Code for the Mail Search Tutorial"></a><h2>Obtaining the Code for the Mail Search Tutorial</h2><p>The Mail Search tutorial chapters in this document contain listings for most of the handlers and script objects the application uses, and you can find a complete listing in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-TPXREF101">Chapter 10</a></span>. However, both for convenience and completeness, it is recommended that you obtain script statements by copying them from the Mail Search sample application distributed with AppleScript Studio. </p><div class="notebox"><a name="//apple_ref/doc/uid/20001257-DontLinkElementID_56" title="Note"></a><p><strong>Note:</strong>&nbsp;The scripting terminology for the Mail application changed with Mac OS X version 10.2. The scripts and examples created prior to that version differ from their counterparts today. The listings shown in this document reflect all revisions through Mac OS X version 10.3.</p></div><p>Look for the file <code>Mail Search.applescript</code> in the Mail Search project folder. See <span class="content_text"><a href="../chapter02/studio_about_book.html#//apple_ref/doc/uid/20001249-CJBJBFAA">“AppleScript Studio Sample Applications”</a></span> for information on where to find the sample applications.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001257-DontLinkElementID_57" title="Note"></a><p><strong>Note:</strong>&nbsp;If you double-click <code>Mail Search.applescript</code> in the Finder, the Finder will try to open it with the Script Editor application. You can open the file from the Files list in the Groups &amp; Files list in the Mail Search sample application. Or, from your tutorial Mail Search project, you can choose Open from the File menu and navigate to <code>Mail Search.applescript</code> in the Mail Search sample application folder.</p>When you open this file for the first time in the Mail Search application, it may launch the Mail application, if it isn’t already running.</p></div><p>You should also read the section <span class="content_text"><a href="../chapter04/studio_detail.html#//apple_ref/doc/uid/20001251-BAJGFJIH">“Switching Between AppleScript Studio and Script Editor”</a></span> before beginning this tutorial.</p><a name="//apple_ref/doc/uid/20001257-BCIFFIBJ" title="Define Global Variables and Properties"></a><h2>Define Global Variables and Properties</h2><p>In <span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-BCIGJAJC">“Plan the Code,”</a></span> you identified a handful of global variables and properties Mail Search makes available to all its scripts and handlers. The one global variable is a global list to keep track of instances of the controller script. Each controller script handles search operations for one search window. You define this global variable as shown in <span class="content_text">Listing 9-1</span> and place it at the top of the script file <code>Mail Search.applescript</code>.</p><a name="//apple_ref/doc/uid/20001257-BCIIBJCC" title="Listing 9-1Global list variable to store instances of controller script"></a><p class="codesample"><strong>Listing 9-1&nbsp;&nbsp;</strong>Global list variable to store instances of controller script</p><div class="codesample"><table><tr><td scope="row"><pre>(*==== Globals ====*)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>global controllers<span></span></pre></td></tr></table></div><p>Mail Search uses two global properties, a counter to keep track of the number of open windows and a boolean to keep track of whether the status panel nib file has been opened. You define these properties as shown in <span class="content_text">Listing 9-2</span> and place them at the top of the script file <code>Mail Search.applescript</code>, below the global variable you just defined.</p><a name="//apple_ref/doc/uid/20001257-TPXREF185" title="Listing 9-2Properties used in Mail Search"></a><p class="codesample"><strong>Listing 9-2&nbsp;&nbsp;</strong>Properties used in Mail Search</p><div class="codesample"><table><tr><td scope="row"><pre>(*==== Properties ====*)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>property windowCount: 0<span></span></pre></td></tr><tr><td scope="row"><pre>property statusPanelNibLoaded: false<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/20001257-TPXREF156" title="Write Event Handlers for the Interface"></a><h2>Write Event Handlers for the Interface</h2><p>In <span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-BCIGJAJC">“Plan the Code,”</a></span> you identified event handlers for objects in Mail Search’s interface that must respond to user actions or changes in application state (pending or completed). For example, the search window has three handlers: <code>became main</code>, called when the window becomes active; <code>will open</code>, called as the window is about to open, and <code>will close</code>, called when the window is about to close. The find button has one handler, <code>clicked</code>, called when a user clicks the button.</p><p>In <span class="content_text"><a href="../chapter09/studio_ms_connect_intf.html#//apple_ref/doc/uid/20001256-TPXREF155">“Connect the Interface,”</a></span> you hooked up objects in the interface to the required handlers. As part of that step, Interface Builder inserted event handler declarations in the file <code>Mail Search.applescript</code>. In this section, you’ll write script statements for those handlers.</p><p>When planning the code, you also specified additional scripts and handlers to carry out operations such as searching, displaying results, and displaying status. You’ll write those scripts and handlers in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-TPXREF157">“Write Scripts and Additional Handlers.”</a></span> The handlers you’ll write in this section don’t do much except call other handlers, so you won’t be able to build and run the application until you’ve completed both sections (though you can compile <code>Mail Search.applescript</code> to check syntax).</p><p>While this approach may be suitable for simple applications—or for a tutorial, where the end result is already known—it’s not recommended for complex, real-world applications. For those applications, you will most likely work incrementally, adding parts of the interface, connecting them to event handlers, and testing individual scripts and handlers as you create them.</p><p>As a workaround to allow you to continue to build the application, you can add empty versions of the handlers you haven’t implemented yet to the script file. And as always, you can put <code>display dialog</code> statements in the stubbed out handlers to show when they are called.</p><p>Position each of the event handlers described here at the beginning of the script file <code>Mail Search.applescript</code>, just after the global variables and properties defined earlier.</p><p>Before working on this section, be sure you’ve read the section <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-TPXREF218">“Obtaining the Code for the Mail Search Tutorial.”</a></span></p><a name="//apple_ref/doc/uid/20001257-TPXREF195" title="Application Object Handler"></a><h3>Application Object Handler</h3><p>You previously connected a <code>will finish launching</code> handler for the application object. That handler is called after the application’s user interface has been unarchived from its nib files and just before the application enters its main event loop. In that handler, Mail Search can do any additional initialization it requires before a user performs any actions.</p><p>The only initialization Mail Search requires is to set the global <code>controllers</code> variable to an empty list, as shown in <span class="content_text">Listing 9-3</span>.</p><a name="//apple_ref/doc/uid/20001257-BCIDGHGB" title="Listing 9-3The will finish launching handler for the application object"></a><p class="codesample"><strong>Listing 9-3&nbsp;&nbsp;</strong>The <code>will finish launching</code> handler for the application object</p><div class="codesample"><table><tr><td scope="row"><pre>on will finish launching theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    set controllers to {}<span></span></pre></td></tr><tr><td scope="row"><pre>end will finish launching<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/20001257-TPXREF196" title="Search Window Handlers"></a><h3>Search Window Handlers</h3><p>You previously connected three handlers for the application.search window: <code>will open</code>, <code>became main</code>, and <code>will close</code>.</p><p>The <code>will open</code> handler is called after a window has been created from a nib file and before the window opens. At this point, Mail Search can do any additional initialization for the window. The handler is shown in <span class="content_text">Listing 9-4</span>. </p><a name="//apple_ref/doc/uid/20001257-BCICGGHG" title="Listing 9-4will open handler for search window"></a><p class="codesample"><strong>Listing 9-4&nbsp;&nbsp;</strong><code>will open</code> handler for search window</p><div class="codesample"><table><tr><td scope="row"><pre>on will open theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    set theController to makeController(theObject)<span></span></pre></td></tr><tr><td scope="row"><pre>    if theController is not equal to null then<span></span></pre></td></tr><tr><td scope="row"><pre>        addController(theController)<span></span></pre></td></tr><tr><td scope="row"><pre>        tell theController to initialize()<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end will open<span></span></pre></td></tr></table></div><p>The <code>will open</code> handler performs these operations:</p><ol class="ol"><li class="li"><p>It calls <code>makeController</code> to create a controller for the window. The controller is a script that responds to user actions in the window.</p></li><li class="li"><p>If <code>makeController</code> successfully returns a controller, the <code>will open</code> handler adds the controller to the global list of controllers, then tells the controller to initialize itself.</p></li></ol><p>The <code>became main</code> handler is called when a window becomes the current window. It’s similar to what you might be familiar with as an activate event—an event a window receives when it needs to present itself as the active window. The handler is shown in <span class="content_text">Listing 9-5</span>.</p><a name="//apple_ref/doc/uid/20001257-BCIIEDBB" title="Listing 9-5The became main handler for the search window"></a><p class="codesample"><strong>Listing 9-5&nbsp;&nbsp;</strong>The <code>became main</code> handler for the search window</p><div class="codesample"><table><tr><td scope="row"><pre>on became main theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    set theController to controllerForWindow(theObject)<span></span></pre></td></tr><tr><td scope="row"><pre>    if theController is not equal to null then<span></span></pre></td></tr><tr><td scope="row"><pre>        tell theController to loadMailboxes()<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end became main<span></span></pre></td></tr></table></div><p>The <code>became main</code> handler performs these operations:</p><ol class="ol"><li class="li"><p>It calls <code>controllerForWindow</code> to get the controller for the window. The controller should have been created during a previous call to <code>will open</code>.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001257-DontLinkElementID_58" title="Note"></a><p><strong>Note:</strong>&nbsp;The <code>became main</code> handler passes <code>theObject</code> when it calls <code>controllerForWindow</code>. It does not have to pass <code>(window of theObject)</code>, as <code>action</code>, <code>clicked</code>, and <code>double clicked</code> handlers do, because <code>became main</code> is a handler for the window object and <code>theObject</code> is already a reference to the window object.</p></div></li><li class="li"><p>If <code>controllerForWindow</code> successfully returns a controller, the <code>became main</code> handler calls the controller’s <code>loadMailboxes</code> handler (shown in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-BCIHAHGE">Listing 9-12</a></span>) to search the Mail application for all available mailboxes and display them in the Mailboxes outline view.</p></li></ol><p>The <code>will close</code> handler is called before a window closes. At this point, Mail Search can do any cleanup for the window. The only cleanup Mail Search requires is to remove window’s controller from the global list of controllers, as shown in <span class="content_text">Listing 9-6</span>.</p><a name="//apple_ref/doc/uid/20001257-BCIFHICG" title="Listing 9-6The will close handler for the search window"></a><p class="codesample"><strong>Listing 9-6&nbsp;&nbsp;</strong>The <code>will close</code> handler for the search window</p><div class="codesample"><table><tr><td scope="row"><pre>on will close theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    removeController(theObject)<span></span></pre></td></tr><tr><td scope="row"><pre>end will close<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/20001257-BCIEFGFA" title="Text Field Handler"></a><h3>Text Field Handler</h3><p>You previously connected an <code>action</code> handler for the search text field object. That handler is called when a user presses the Return key. The handler is shown in <span class="content_text">Listing 9-7</span>.</p><a name="//apple_ref/doc/uid/20001257-BCIDGGID" title="Listing 9-7The action handler for the search text field"></a><p class="codesample"><strong>Listing 9-7&nbsp;&nbsp;</strong>The <code>action</code> handler for the search text field</p><div class="codesample"><table><tr><td scope="row"><pre>on action theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    set theController to controllerForWindow(window of theObject)<span></span></pre></td></tr><tr><td scope="row"><pre>    if theController is not equal to null then<span></span></pre></td></tr><tr><td scope="row"><pre>        tell theController to find()<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end action<span></span></pre></td></tr></table></div><p>The <code>action</code> handler performs these operations:</p><ol class="ol"><li class="li"><p>It calls <code>controllerForWindow</code> to get the controller for the window.</p></li><li class="li"><p>If <code>controllerForWindow</code> successfully returns a controller, the <code>action</code> handler calls the controller’s <code>find</code> handler (shown in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-BCIEJFIB">Listing 9-16</a></span>) to search for the specified text in messages in the selected mailboxes (and display any matching messages in the Messages table view).</p></li></ol><a name="//apple_ref/doc/uid/20001257-TPXREF197" title="Find Button Handler"></a><h3>Find Button Handler</h3><p>You previously connected a <code>clicked</code> handler for the find button object. That handler is called when a user clicks the find button. The handler is shown in <span class="content_text">Listing 9-8</span>. </p><a name="//apple_ref/doc/uid/20001257-BCIEGDBG" title="Listing 9-8The clicked handler for the find button"></a><p class="codesample"><strong>Listing 9-8&nbsp;&nbsp;</strong>The <code>clicked</code> handler for the find button</p><div class="codesample"><table><tr><td scope="row"><pre>on clicked theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    set theController to controllerForWindow(window of theObject)<span></span></pre></td></tr><tr><td scope="row"><pre>    if theController is not equal to null then<span></span></pre></td></tr><tr><td scope="row"><pre>        tell theController to find()<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end clicked<span></span></pre></td></tr></table></div><p>The <code>clicked</code> handler is virtually identical to the <code>action</code> handler described in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-BCIEFGFA">“Text Field Handler”</a></span>:</p><ol class="ol"><li class="li"><p>It calls <code>controllerForWindow</code> to get the controller for the window.</p></li><li class="li"><p>If <code>controllerForWindow</code> successfully returns a controller, the <code>clicked</code> handler calls the controller’s <code>find</code> handler (shown in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-BCIEJFIB">Listing 9-16</a></span>) to search for the specified text in messages in the selected mailboxes (and display any matching messages in the Messages table view).</p></li></ol><a name="//apple_ref/doc/uid/20001257-TPXREF198" title="Search Results Table View Handler"></a><h3>Search Results Table View Handler</h3><p>You previously connected a <code>double clicked</code> handler for the Messages table view object. That handler is called when a user double-clicks a selected message in the table. The handler is shown in <span class="content_text">Listing 9-9</span>. </p><a name="//apple_ref/doc/uid/20001257-BCIFJBBA" title="Listing 9-9The double clicked handler for the search results table view"></a><p class="codesample"><strong>Listing 9-9&nbsp;&nbsp;</strong>The <code>double clicked</code> handler for the search results table view</p><div class="codesample"><table><tr><td scope="row"><pre>on double clicked theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    set theController to controllerForWindow(window of theObject)<span></span></pre></td></tr><tr><td scope="row"><pre>    if theController is not equal to null then<span></span></pre></td></tr><tr><td scope="row"><pre>        tell theController to openMessages()<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end double clicked<span></span></pre></td></tr></table></div><p>The <code>double clicked</code> handler performs these operations:</p><ol class="ol"><li class="li"><p>It calls <code>controllerForWindow</code> to get the controller for the window.</p></li><li class="li"><p>If <code>controllerForWindow</code> successfully returns a controller, the <code>double clicked</code> handler calls the controller’s <code>openMessages</code> handler (shown in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-BCIIGDIC">Listing 9-18</a></span>) to open the selected message (or messages) in a separate window.</p></li></ol><a name="//apple_ref/doc/uid/20001257-TPXREF157" title="Write Scripts and Additional Handlers"></a><h2>Write Scripts and Additional Handlers</h2><p>In <span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-BCIGJAJC">“Plan the Code,”</a></span> you identified handlers for objects in Mail Search’s interface that must respond to user actions or changes in application state (pending or completed). In <span class="content_text"><a href="../chapter09/studio_ms_connect_intf.html#//apple_ref/doc/uid/20001256-TPXREF155">“Connect the Interface,”</a></span> you hooked up objects in the interface to the required handlers. Then you wrote the event handlers, in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-TPXREF156">“Write Event Handlers for the Interface.”</a></span></p><p>When planning the code, you also specified additional scripts and handlers to carry out operations such as searching, displaying results, and displaying status. In this section, you’ll write those scripts and handlers. As mentioned previously, you won’t be able to build and run the application until you’ve completed this section, though you can compile <code>Mail Search.applescript</code> to check syntax.</p><p>Before working on this section, be sure you’ve read the section <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-TPXREF218">“Obtaining the Code for the Mail Search Tutorial.”</a></span></p><a name="//apple_ref/doc/uid/20001257-TPXREF207" title="Write the Controller Script"></a><h3>Write the Controller Script</h3><p>Mail Search defines a controller script to perform tasks associated with the search window, including finding and displaying mailboxes, and finding and displaying messages that match the current search criteria. You specified the properties and handlers for this script in <span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-TPXREF203">“The Controller Script.”</a></span> In this section, you’ll look at the actual script and the handlers it contains. The controller script is defined in the <code>makeController</code> handler. All of the controller’s properties and handlers shown here are defined in that handler, which is listed in full in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-TPXREF101">Chapter 10</a></span>.</p><a name="//apple_ref/doc/uid/20001257-TPXREF208" title="Controller Script Properties and Initialization"></a><h4>Controller Script Properties and Initialization</h4><p>The controller script is defined in the <code>makeController</code> handler, which is described in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-BCIBFHDJ">“Write Handlers for Working With Controllers.”</a></span> The script defines and initializes properties for several things it needs to keep track of:</p><ul class="spaceabove"><li class="li"><p><code>theWindow:</code> a reference to its window</p></li><li class="li"><p><code>theStatusPanel:</code> a reference to a status panel</p></li><li class="li"><p><code>foundMessages:</code> a list of found messages</p></li><li class="li"><p><code>mailboxesLoaded:</code> a boolean for whether it has created a list of available mailboxes</p></li></ul><p><span class="content_text">Listing 9-10</span> shows the definitions for these properties.</p><a name="//apple_ref/doc/uid/20001257-BCIHBGJF" title="Listing 9-10Properties of the controller script"></a><p class="codesample"><strong>Listing 9-10&nbsp;&nbsp;</strong>Properties of the controller script</p><div class="codesample"><table><tr><td scope="row"><pre>        property theWindow : forWindow<span></span></pre></td></tr><tr><td scope="row"><pre>        property theStatusPanel : null<span></span></pre></td></tr><tr><td scope="row"><pre>        property foundMessages : {}<span></span></pre></td></tr><tr><td scope="row"><pre>        property mailboxesLoaded : false<span></span></pre></td></tr></table></div><p>The value for the <code>theWindow</code> property, <code>forWindow</code>, is passed to the <code>makeController</code> handler.</p><p>The controller script initialization handler sets up columns in the data handlers that provide data for the mailboxes and messages views in the search window. This handler is shown in <span class="content_text">Listing 9-11</span>.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001257-DontLinkElementID_59" title="Note"></a><p><strong>Note:</strong>&nbsp;You’ll see the character ¬ (created by typing Option-l) in many of the listings in this chapter. That’s the AppleScript continuation character. When a line ends with a continuation character, the next line is considered to be part of that line. To accommodate long script statements, listings in this tutorial use continuation characters that do not appear in Mail Search’s script file, and in fact, you should not need to use them—see <span class="content_text"><a href="../chapter04/studio_detail.html#//apple_ref/doc/uid/20001251-CJBCHHAD">“How Xcode Formats Scripts.”</a></span></p></div><a name="//apple_ref/doc/uid/20001257-BCICABAE" title="Listing 9-11The controller script&acirc;&#128;&#153;s initialize handler"></a><p class="codesample"><strong>Listing 9-11&nbsp;&nbsp;</strong>The controller script’s <code>initialize</code> handler</p><div class="codesample"><table><tr><td scope="row"><pre>        on initialize()<span></span></pre></td></tr><tr><td scope="row"><pre>            -- Add a column to the mailboxes data source<span></span></pre></td></tr><tr><td scope="row"><pre>            tell scroll view "mailboxes" of split view 1 of theWindow<span></span></pre></td></tr><tr><td scope="row"><pre>                make new data column at the end of the data columns of data source ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                    of outline view "mailboxes" with properties {name:"mailboxes"}<span></span></pre></td></tr><tr><td scope="row"><pre>            end tell<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            -- Add the columns to the messages data source<span></span></pre></td></tr><tr><td scope="row"><pre>            tell scroll view "messages" of split view 1 of theWindow<span></span></pre></td></tr><tr><td scope="row"><pre>                make new data column at the end of the data columns of data source ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                    of table view "messages" with properties {name:"from"}<span></span></pre></td></tr><tr><td scope="row"><pre>                make new data column at the end of the data columns of data source ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                    of table view "messages" with properties {name:"subject"}<span></span></pre></td></tr><tr><td scope="row"><pre>                make new data column at the end of the data columns of data source ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                    of table view "messages" with properties {name:"mailbox"}<span></span></pre></td></tr><tr><td scope="row"><pre>            end tell<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            set windowCount to windowCount + 1<span></span></pre></td></tr><tr><td scope="row"><pre>        end initialize<span></span></pre></td></tr></table></div>	<p>The <code>initialize</code> handler performs the following steps:</p><ol class="ol"><li class="li"><p>It adds a mailboxes column with the name “mailboxes” to the data source of the Mailboxes outline view. The data source supplies the outline view with the data to display (account and mailbox names).</p></li><li class="li"><p>Similarly, it adds columns for “from”, “subject”, and “mailbox” to the data source of the Messages table view. The data source supplies the table view with the data to display (from names, subject lines, and mailbox names).</p></li></ol><a name="//apple_ref/doc/uid/20001257-TPXREF209" title="Finding and Displaying Accounts and Mailboxes"></a><h4>Finding and Displaying Accounts and Mailboxes</h4><p>This section describes the handlers in the controller script Mail Search uses to find and display mailboxes in the search window. The jumping off point for displaying mailboxes is the <code>loadMailboxes</code> handler, shown in <span class="content_text">Listing 9-12</span>. It is called from the <code>became main</code> handler, shown in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-BCIIEDBB">Listing 9-5</a></span>, to ensure that whenever a window is activated it displays the available mailboxes. The <code>loadMailboxes</code> handler is responsible for loading all available mailboxes from all available accounts, if they have not already been loaded, and for showing the status dialog while loading.</p><p>The logic for the process of loading mailboxes is as follows:</p><ol class="ol"><li class="li"><p><code>loadMailboxes</code> kicks off the process by calling <code>addMailBoxes</code>.</p></li><li class="li"><p>Mailboxes can reside in any account, so for each account, <code>addMailBoxes</code> calls <code>addAccount</code>.</p></li><li class="li"><p>For each mailbox the account contains, <code>addAccount</code> calls <code>addMailbox</code>.</p></li><li class="li"><p><code>addAccount</code> adds the mailbox to the outline view of mailboxes available to search.</p></li></ol><a name="//apple_ref/doc/uid/20001257-BCIHAHGE" title="Listing 9-12The controller script&acirc;&#128;&#153;s loadMailboxes handler"></a><p class="codesample"><strong>Listing 9-12&nbsp;&nbsp;</strong>The controller script’s <code>loadMailboxes</code> handler</p><div class="codesample"><table><tr><td scope="row"><pre>        on loadMailboxes()<span></span></pre></td></tr><tr><td scope="row"><pre>            if not mailboxesLoaded then<span></span></pre></td></tr><tr><td scope="row"><pre>                -- Open the status panel<span></span></pre></td></tr><tr><td scope="row"><pre>                set theStatusPanel to makeStatusPanel(theWindow)<span></span></pre></td></tr><tr><td scope="row"><pre>                tell theStatusPanel to openPanel("Looking for Mailboxes...")<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                -- Add the mailboxes<span></span></pre></td></tr><tr><td scope="row"><pre>                addMailboxes()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                -- Close the status panel<span></span></pre></td></tr><tr><td scope="row"><pre>                tell theStatusPanel to closePanel()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                set mailboxesLoaded to true<span></span></pre></td></tr><tr><td scope="row"><pre>            end if<span></span></pre></td></tr><tr><td scope="row"><pre>        end loadMailboxes<span></span></pre></td></tr></table></div>	<p>The <code>loadMailboxes</code> handler performs the following steps:</p><ol class="ol"><li class="li"><p>If the mailboxes have already been loaded, it does nothing. Otherwise it performs the following steps.</p></li><li class="li"><p>It calls the <code>makeStatusPanel</code> handler to create a status dialog script object, and stores a reference to it in the <code>theStatusPanel</code> property. The <code>makeStatusPanel</code> handler is described in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-TPXREF215">“Write Handlers for Working With the Status Dialog.”</a></span></p></li><li class="li"><p>It calls the <code>openPanel</code> handler of the status dialog script object to start displaying the dialog, with the message “Looking for Mailboxes...” The <code>openPanel</code> handler is described in <span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-TPXREF204">“The Status Dialog Script.”</a></span></p></li><li class="li"><p>It calls the controller handler <code>addMailboxes</code> to get all available mailboxes in all available accounts.</p></li><li class="li"><p>On completion of the previous step, it closes the status dialog.</p></li><li class="li"><p>It sets the controller property <code>mailboxesLoaded</code> to <code>true</code> (so it won’t load the mailboxes if they’ve already been loaded).</p></li></ol><p>The <code>addMailboxes</code> handler is shown in <span class="content_text">Listing 9-13</span>. It is called from the <code>loadMailboxes</code> handler, shown in <span class="content_text">Listing 9-12</span>. The <code>addMailboxes</code> handler is responsible for iterating over all available accounts to obtain their mailboxes.</p><a name="//apple_ref/doc/uid/20001257-BCIDDEGD" title="Listing 9-13The controller script&acirc;&#128;&#153;s addMailboxes handler"></a><p class="codesample"><strong>Listing 9-13&nbsp;&nbsp;</strong>The controller script’s <code>addMailboxes</code> handler</p><div class="codesample"><table><tr><td scope="row"><pre>        on addMailboxes()<span></span></pre></td></tr><tr><td scope="row"><pre>            tell application "Mail"<span></span></pre></td></tr><tr><td scope="row"><pre>                set accountIndex to 0<span></span></pre></td></tr><tr><td scope="row"><pre>                repeat with a in (get accounts)<span></span></pre></td></tr><tr><td scope="row"><pre>                    try<span></span></pre></td></tr><tr><td scope="row"><pre>                        set accountIndex to accountIndex + 1<span></span></pre></td></tr><tr><td scope="row"><pre>                        my addAccount(a, accountIndex, account name of a)<span></span></pre></td></tr><tr><td scope="row"><pre>                    end try<span></span></pre></td></tr><tr><td scope="row"><pre>                end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>            end tell<span></span></pre></td></tr><tr><td scope="row"><pre>        end addMailboxes<span></span></pre></td></tr></table></div><p>The <code>addMailboxes</code> handler performs the following steps:</p><ol class="ol"><li class="li"><p>It targets the Mail application.</p></li><li class="li"><p>It gets a list of all accounts from the application.</p></li><li class="li"><p>It uses a repeat statement to iterate over the accounts.</p></li><li class="li"><p>For each account, it calls the controller handler <code>addAccount</code> (shown in <span class="content_text">Listing 9-14</span>), passing among other things the name of the account.</p><p>Within the <code>tell application "Mail"</code> statement block, the <code>addMailboxes</code> handler uses the term <code>my addAccount</code> to specify that it is calling another handler in the controller script.</p></li></ol><p>The <code>addAccount</code> handler (shown in <span class="content_text">Listing 9-14</span>) is called from the <code>addMailboxes</code> handler (shown in <span class="content_text">Listing 9-13</span>). The <code>addAccount</code> handler is responsible for getting all available mailboxes in the passed account and adding them to the data source for the mailboxes view in the search window.</p><a name="//apple_ref/doc/uid/20001257-BCIFJGCB" title="Listing 9-14The controller script&acirc;&#128;&#153;s addAccounts handler"></a><p class="codesample"><strong>Listing 9-14&nbsp;&nbsp;</strong>The controller script’s <code>addAccounts</code> handler</p><div class="codesample"><table><tr><td scope="row"><pre>        on addAccount(a, accountIndex, accountName)<span></span></pre></td></tr><tr><td scope="row"><pre>            -- Add a new item<span></span></pre></td></tr><tr><td scope="row"><pre>            set accountItem to make new data item at the end of the data items ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                of data source of outline view "mailboxes" ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                of scroll view "mailboxes" of split view 1 of theWindow<span></span></pre></td></tr><tr><td scope="row"><pre>            set name of data cell 1 of accountItem to "mailboxes"<span></span></pre></td></tr><tr><td scope="row"><pre>            set contents of data cell 1 of accountItem to accountName<span></span></pre></td></tr><tr><td scope="row"><pre>            set associated object of accountItem to accountIndex<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            -- Add the mail boxes<span></span></pre></td></tr><tr><td scope="row"><pre>            tell application "Mail"<span></span></pre></td></tr><tr><td scope="row"><pre>                set mailboxIndex to 0<span></span></pre></td></tr><tr><td scope="row"><pre>                repeat with m in (get mailboxes of a)<span></span></pre></td></tr><tr><td scope="row"><pre>                    try<span></span></pre></td></tr><tr><td scope="row"><pre>                        set mailboxIndex to mailboxIndex + 1<span></span></pre></td></tr><tr><td scope="row"><pre>                        my addMailbox(accountItem, accountName, mailboxIndex, ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                            mailbox name of m)<span></span></pre></td></tr><tr><td scope="row"><pre>                    end try<span></span></pre></td></tr><tr><td scope="row"><pre>                end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>            end tell<span></span></pre></td></tr><tr><td scope="row"><pre>        end addAccount<span></span></pre></td></tr></table></div>	<p>The <code>addAccount</code> handler performs the following steps:</p><ol class="ol"><li class="li"><p>It adds an account item to the data source for the mailboxes view in the search window. It also sets various information for the item, including its name (the name of the account).</p></li><li class="li"><p>It targets the Mail application.</p></li><li class="li"><p>It gets a list of all mailboxes in the account from the application.</p></li><li class="li"><p>It uses a repeat statement to iterate over the mailboxes.</p></li><li class="li"><p>For each mailbox, it calls the controller handler <code>addMailbox</code> (shown in <span class="content_text">Listing 9-15</span>), passing among other things the name of the mailbox, to add the mailbox to the data source for the mailboxes view in the search window.</p></li></ol><p>The <code>addMailbox</code> handler is called from the <code>addAccount</code> handler, shown in <span class="content_text">Listing 9-14</span>, to add a single mailbox to the data source for the mailboxes view in the search window. The <code>addMailbox</code> handler is shown in <span class="content_text">Listing 9-15</span>.</p><a name="//apple_ref/doc/uid/20001257-BCIGDHIB" title="Listing 9-15The controller script&acirc;&#128;&#153;s addMailbox handler"></a><p class="codesample"><strong>Listing 9-15&nbsp;&nbsp;</strong>The controller script’s <code>addMailbox</code> handler</p><div class="codesample"><table><tr><td scope="row"><pre>        on addMailbox(accountItem, accountName, mailboxIndex, mailboxName)<span></span></pre></td></tr><tr><td scope="row"><pre>            -- Add a new item<span></span></pre></td></tr><tr><td scope="row"><pre>            set mailboxItem to make new data item at the end of the data items ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                of accountItem<span></span></pre></td></tr><tr><td scope="row"><pre>            set name of data cell 1 of mailboxItem to "mailboxes"<span></span></pre></td></tr><tr><td scope="row"><pre>            set contents of data cell 1 of mailboxItem to mailboxName<span></span></pre></td></tr><tr><td scope="row"><pre>            set associated object of mailboxItem to mailboxIndex<span></span></pre></td></tr><tr><td scope="row"><pre>        end addMailbox<span></span></pre></td></tr></table></div>	<p>The <code>addMailboxes</code> handler performs the following step:</p><ol class="ol"><li class="li"><p>It adds a mailbox item to the data source for the mailboxes view in the search window. It also sets various information for the item, including its name (the name of the mailbox).</p></li></ol><a name="//apple_ref/doc/uid/20001257-TPXREF210" title="Finding and Displaying Messages"></a><h4>Finding and Displaying Messages</h4><p>This section describes the handlers in the controller script Mail Search uses to find and display messages in the search window. Only messages in the specified mailboxes that contain the specified text in the specified part of the message are displayed.</p><p>The jumping off point for finding messages is the <code>find</code> handler. It is called from the <code>clicked</code> handler for the find button, shown in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-BCIEGDBG">Listing 9-8</a></span> and the <code>action</code> handler for the search text field, shown in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-BCIDGGID">Listing 9-7</a></span>. The <code>find</code> handler is responsible for gathering the search criteria, searching the selected mailboxes for matching messages, and displaying any such messages that are found. It also displays various status messages during the search. The <code>find</code> handler is shown in <span class="content_text">Listing 9-16</span></p><a name="//apple_ref/doc/uid/20001257-BCIEJFIB" title="Listing 9-16The controller script&acirc;&#128;&#153;s find handler"></a><p class="codesample"><strong>Listing 9-16&nbsp;&nbsp;</strong>The controller script’s <code>find</code> handler</p><div class="codesample"><table><tr><td scope="row"><pre>        on find()<span></span></pre></td></tr><tr><td scope="row"><pre>            -- Get what and where to find<span></span></pre></td></tr><tr><td scope="row"><pre>            set whatToFind to contents of text field "what" of theWindow<span></span></pre></td></tr><tr><td scope="row"><pre>            set whereToFind to title of current menu item of popup button "where" ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                of theWindow<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            -- Make sure that we have something to find<span></span></pre></td></tr><tr><td scope="row"><pre>            if (count of whatToFind) is greater than 0 then<span></span></pre></td></tr><tr><td scope="row"><pre>                -- Clear any previously found messages<span></span></pre></td></tr><tr><td scope="row"><pre>                clearMessages()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                -- Setup a status panel<span></span></pre></td></tr><tr><td scope="row"><pre>                set theStatusPanel to makeStatusPanel(theWindow)<span></span></pre></td></tr><tr><td scope="row"><pre>                tell theStatusPanel to ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                    openPanel("Determining the number of messages...")<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                try<span></span></pre></td></tr><tr><td scope="row"><pre>                    -- Determine the mailboxes to search<span></span></pre></td></tr><tr><td scope="row"><pre>                    set mailboxesToSearch to selectedMailboxes()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                    -- Determine the total number of messages to search<span></span></pre></td></tr><tr><td scope="row"><pre>                    set totalCount of theStatusPanel to ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                        countMessages(mailboxesToSearch)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                    -- Adjust the status panel<span></span></pre></td></tr><tr><td scope="row"><pre>                    tell theStatusPanel to adjustPanel()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                    -- Find the messages<span></span></pre></td></tr><tr><td scope="row"><pre>                    set foundMessages to findMessages(mailboxesToSearch, ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                        whereToFind, whatToFind)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                    -- Change the status panel<span></span></pre></td></tr><tr><td scope="row"><pre>                    tell theStatusPanel to changePanel("Adding found messages...")<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                    -- Add the found messages to the result table<span></span></pre></td></tr><tr><td scope="row"><pre>                    addMessages(foundMessages)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                    -- Close the status panel<span></span></pre></td></tr><tr><td scope="row"><pre>                    tell theStatusPanel to closePanel()<span></span></pre></td></tr><tr><td scope="row"><pre>                on error errorText<span></span></pre></td></tr><tr><td scope="row"><pre>                    tell theStatusPanel to closePanel()<span></span></pre></td></tr><tr><td scope="row"><pre>                    display alert "AppleScript Error" as critical ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                        attached to theWindow message errorText<span></span></pre></td></tr><tr><td scope="row"><pre>                end try<span></span></pre></td></tr><tr><td scope="row"><pre>            else<span></span></pre></td></tr><tr><td scope="row"><pre>                display alert "Missing Value" as critical attached to theWindow ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                    message "You need to enter a value to search for."<span></span></pre></td></tr><tr><td scope="row"><pre>            end if<span></span></pre></td></tr><tr><td scope="row"><pre>        end find<span></span></pre></td></tr></table></div>	<p>The <code>find</code> handler performs the following steps:</p><ol class="ol"><li class="li"><p>It gets the search criteria: the contents of the search text field (the “what” field) and the title of the location pop-up (the “where” menu).</p></li><li class="li"><p>If there is no search text, it displays an error message “Missing Value”. Otherwise it performs the following steps.</p></li><li class="li"><p>It calls the controller handler <code>clearMessages</code> to clear any previous found messages in the Messages table view.</p></li><li class="li"><p>It calls the <code>makeStatusPanel</code> handler to create a status dialog script object, and stores a reference to it in the <code>theStatusPanel</code> property. The <code>makeStatusPanel</code> handler is described in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-TPXREF215">“Write Handlers for Working With the Status Dialog.”</a></span></p></li><li class="li"><p>It calls the <code>openPanel</code> handler of the status dialog script object to start displaying the panel, with the message “Determining the number of messages...” The <code>openPanel</code> handler is described in <span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-TPXREF204">“The Status Dialog Script.”</a></span></p></li><li class="li"><p>It sets up an error handler (a <code>try…on error…end try</code> statement) around the statements that search for and display messages. If an error occurs, the <code>on error</code> clause closes the status dialog and displays an error message. Within the handler, it performs these steps:</p><ol class="ol"><li class="ol ol"><p>It calls the controller handler <code>selectedMailboxes</code> to get the selected mailboxes.</p></li><li class="ol ol"><p>It calls the controller handler <code>countMessages</code> to set the total count property of the status dialog to the total number of messages to search.</p></li><li class="ol ol"><p>It calls the <code>adjustPanel</code> handler of the status dialog script object to display the number of the messages to be searched. The <code>adjustPanel</code> handler is described in <span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-TPXREF204">“The Status Dialog Script.”</a></span></p></li><li class="ol ol"><p>It calls the controller handler <code>findMessages</code> (shown in <span class="content_text">Listing 9-17</span>), passing the mailboxes to search, the search location, and the text to find.</p></li><li class="ol ol"><p>It calls the <code>changePanel</code> handler of the status dialog script object to display the message “Adding found messages...” The <code>changePanel</code> handler is described in <span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-TPXREF204">“The Status Dialog Script.”</a></span></p></li><li class="ol ol"><p>It calls the controller handler <code>addMessages</code>, to display the found messages in the search window’s message view.</p></li><li class="ol ol"><p>It closes the status dialog.</p></li></ol></li></ol><p>The <code>findMessages</code> handler is shown in <span class="content_text">Listing 9-17</span>. It is called from the <code>find</code> handler, shown in <span class="content_text">Listing 9-16</span>. The <code>findMessages</code> handler is responsible for iterating over the specified mailboxes and finding any messages that contain the specified text in the specified location (From, To, or Contents of the message).</p><a name="//apple_ref/doc/uid/20001257-BCIBBJFG" title="Listing 9-17The controller script&acirc;&#128;&#153;s findMessages handler"></a><p class="codesample"><strong>Listing 9-17&nbsp;&nbsp;</strong>The controller script’s <code>findMessages</code> handler</p><div class="codesample"><table><tr><td scope="row"><pre>on findMessages(mailboxesToSearch, whereToFind, whatToFind)<span></span></pre></td></tr><tr><td scope="row"><pre>    -- Initialize the result<span></span></pre></td></tr><tr><td scope="row"><pre>    set messagesFound to {}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    tell application "Mail"<span></span></pre></td></tr><tr><td scope="row"><pre>        -- Search through each of the mail boxes<span></span></pre></td></tr><tr><td scope="row"><pre>        repeat with b in (get mailboxesToSearch)<span></span></pre></td></tr><tr><td scope="row"><pre>            try<span></span></pre></td></tr><tr><td scope="row"><pre>                -- Search through each of the messages of the mail box<span></span></pre></td></tr><tr><td scope="row"><pre>                repeat with m in (get messages of b)<span></span></pre></td></tr><tr><td scope="row"><pre>                    try<span></span></pre></td></tr><tr><td scope="row"><pre>                        if whereToFind is equal to "Subject" then<span></span></pre></td></tr><tr><td scope="row"><pre>                            if whatToFind is in the subject of m then<span></span></pre></td></tr><tr><td scope="row"><pre>                                copy m to end of messagesFound<span></span></pre></td></tr><tr><td scope="row"><pre>                            end if<span></span></pre></td></tr><tr><td scope="row"><pre>                        else if whereToFind is equal to "From" then<span></span></pre></td></tr><tr><td scope="row"><pre>                            if whatToFind is in sender of m then<span></span></pre></td></tr><tr><td scope="row"><pre>                                copy m to end of messagesFound<span></span></pre></td></tr><tr><td scope="row"><pre>                            end if<span></span></pre></td></tr><tr><td scope="row"><pre>                        else if whereToFind is equal to "To" then<span></span></pre></td></tr><tr><td scope="row"><pre>                            set foundRecipient to false<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                            -- Recipients<span></span></pre></td></tr><tr><td scope="row"><pre>                            repeat with r in (get recipients of m)<span></span></pre></td></tr><tr><td scope="row"><pre>                                if whatToFind is in address of r or whatToFind ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                                        is in display name of r then<span></span></pre></td></tr><tr><td scope="row"><pre>                                    set foundRecipient to true<span></span></pre></td></tr><tr><td scope="row"><pre>                                end if<span></span></pre></td></tr><tr><td scope="row"><pre>                            end repeat<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                            -- To Recipients<span></span></pre></td></tr><tr><td scope="row"><pre>                            if not foundRecipient then<span></span></pre></td></tr><tr><td scope="row"><pre>                                repeat with r in (get to recipients of m)<span></span></pre></td></tr><tr><td scope="row"><pre>                                    if whatToFind is in address of r or whatToFind ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                                            is in display name of r then<span></span></pre></td></tr><tr><td scope="row"><pre>                                        set foundRecipient to true<span></span></pre></td></tr><tr><td scope="row"><pre>                                    end if<span></span></pre></td></tr><tr><td scope="row"><pre>                                end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>                            end if<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                            -- cc Recipients<span></span></pre></td></tr><tr><td scope="row"><pre>                            if not foundRicipient then<span></span></pre></td></tr><tr><td scope="row"><pre>                                repeat with r in (get cc recipients of m)<span></span></pre></td></tr><tr><td scope="row"><pre>                                    if whatToFind is in address of r or whatToFind ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                                            is in display name of r then<span></span></pre></td></tr><tr><td scope="row"><pre>                                        set foundRecipient to true<span></span></pre></td></tr><tr><td scope="row"><pre>                                    end if<span></span></pre></td></tr><tr><td scope="row"><pre>                                end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>                            end if<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                            -- bcc Recipients<span></span></pre></td></tr><tr><td scope="row"><pre>                            if not foundRicipient then<span></span></pre></td></tr><tr><td scope="row"><pre>                                repeat with r in (get bcc recipients of m)<span></span></pre></td></tr><tr><td scope="row"><pre>                                    if whatToFind is in address of r or whatToFind ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                                            is in display name of r then<span></span></pre></td></tr><tr><td scope="row"><pre>                                        set foundRecipient to true<span></span></pre></td></tr><tr><td scope="row"><pre>                                    end if<span></span></pre></td></tr><tr><td scope="row"><pre>                                end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>                            end if<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                            if foundRecipient then<span></span></pre></td></tr><tr><td scope="row"><pre>                                copy m to end of messagesFound<span></span></pre></td></tr><tr><td scope="row"><pre>                            end if<span></span></pre></td></tr><tr><td scope="row"><pre>                        else if whereToFind is equal to "Contents" then<span></span></pre></td></tr><tr><td scope="row"><pre>                            if whatToFind is in the content of m then<span></span></pre></td></tr><tr><td scope="row"><pre>                                copy m to end of messagesFound<span></span></pre></td></tr><tr><td scope="row"><pre>                            end if<span></span></pre></td></tr><tr><td scope="row"><pre>                        end if<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                        -- Update the status panel<span></span></pre></td></tr><tr><td scope="row"><pre>                        tell theStatusPanel to incrementPanel()<span></span></pre></td></tr><tr><td scope="row"><pre>                    end try<span></span></pre></td></tr><tr><td scope="row"><pre>                end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>            end try<span></span></pre></td></tr><tr><td scope="row"><pre>        end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>    end tell<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    -- Return the result<span></span></pre></td></tr><tr><td scope="row"><pre>    return messagesFound<span></span></pre></td></tr><tr><td scope="row"><pre>end findMessages<span></span></pre></td></tr></table></div>	<p>The <code>findMessages</code> handler is similar in many ways to the <code>find</code> handler. It performs the following steps:</p><ol class="ol"><li class="li"><p>It gets the location criteria: the title of the current choice of the search location pop-up (the “where” menu).</p></li><li class="li"><p>It targets the Mail application.</p></li><li class="li"><p>It sets up a Repeat loop for each selected mailbox. The repeat loop contains a <code>try…end try</code> error handler so that if any error occurs, the script doesn’t halt. Any error is displayed by the error handler in the calling routine (<code>find</code>).</p></li><li class="li"><p>It sets up a Repeat loop for each message in the mailbox. This repeat loop also contains an error handler.</p></li><li class="li"><p>Within the inner repeat loop it does the following:</p><ol class="ol"><li class="ol ol"><p>It calls on the Mail application to search for the specified text in the specified location.</p></li><li class="ol ol"><p>If a message contains the specified text, it adds it to a list of found messages.</p></li><li class="ol ol"><p>At the end of the loop, it calls the <code>incrementPanel</code> handler of the status dialog script object to increment the count of the messages to be searched. The <code>incrementPanel</code> handler is described in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-BCICDECD">“Write Handlers for Working With Message Windows.”</a></span></p></li></ol></li><li class="li"><p>It returns the list of found messages. The list may be empty.</p></li></ol><p>The <code>find</code> handler (shown in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-BCIEJFIB">Listing 9-16</a></span>) also calls the following handlers. These handlers, which perform simple operations, aren’t shown in individual listings, but you can examine them in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-TPXREF101">Chapter 10</a></span> or in the Mail Search sample application.</p><ul class="spaceabove"><li class="li"><p><code>clearMessages</code>: Tells the data source of the Messages table view of the controller script object’s search window to delete every row, thus clearing the messages.</p></li><li class="li"><p><code>countMessages</code>: Communicates with the Mail application to count the messages in each mailbox in the passed list of mailboxes. Returns the total count.</p></li><li class="li"><p><code>addMessages</code>: Turns off updating in the Message table view. For each message in the passed list of messages, calls <code>addMessage</code>. Turns updating back on, so that the Messages table view displays the added messages.</p></li><li class="li"><p><code>addMessage</code>: (Not called directly by the <code>find</code> handler, but called by <code>addMessages</code>.) For the passed message, adds a row to the data source for the Messages table view, then adds a cell for each column in the row, so that the row displays the From, Subject, and Mailbox information for the message.</p></li><li class="li"><p><code>selectedMailboxes</code>: Gets the currently selected mailboxes from the Mailboxes outline view. If any accounts are selected, calls the <code>mailboxesForIndex</code> handler to get all corresponding mailboxes (both from accounts and from individual selected mailboxes) from the Mail application. If only mailboxes are selected, gets the mailboxes itself from the Mail Application. Returns the list of selected mailboxes (which may be empty).</p></li><li class="li"><p><code>mailboxesForIndex</code>: (Not called directly by the <code>find</code> handler, but called by <code>selectedMailboxes</code>.) Communicates with the Mail application to obtain the actual mailboxes corresponding to the currently selected mailboxes. Returns the list of selected mailboxes (which may be empty).</p></li></ul><a name="//apple_ref/doc/uid/20001257-TPXREF211" title="Opening Message Windows"></a><h4>Opening Message Windows</h4><p>Because the Mail application’s scripting support doesn’t currently allow you to open a message in a separate window, Mail Search gets the message text and displays it in its own window. This section describes the controller handlers Mail Search uses to do this.</p><p>The jumping off point for displaying messages is the <code>openMessages</code> handler. It is called from the <code>double clicked</code> handler for the Messages view in the Search window (the handler is shown in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-BCIFJBBA">Listing 9-9</a></span>). The Messages view currently supports only selection of single messages, so the <code>openMessages</code> handler merely calls the <code>openMessageWindow</code> handler to open the selected message. You could, however, modify the Messages table view in Interface Builder to allow multiple selection (see the Attributes pane in the Info window), then modify <code>openMessages</code> to iterate over the current selections, calling <code>openMessageWindow</code> for each selection.</p><p>The <code>openMessageWindow</code> handler is shown in <span class="content_text">Listing 9-18</span></p><a name="//apple_ref/doc/uid/20001257-BCIIGDIC" title="Listing 9-18The controller script&acirc;&#128;&#153;s openMessageWindow handler"></a><p class="codesample"><strong>Listing 9-18&nbsp;&nbsp;</strong>The controller script’s <code>openMessageWindow</code> handler</p><div class="codesample"><table><tr><td scope="row"><pre>on openMessageWindow()<span></span></pre></td></tr><tr><td scope="row"><pre>    set clickedRow to clicked row of table view "messages" ¬<span></span></pre></td></tr><tr><td scope="row"><pre>        of scroll view "messages" of split view 1 of theWindow<span></span></pre></td></tr><tr><td scope="row"><pre>    if clickedRow is greater than or equal to 0 then<span></span></pre></td></tr><tr><td scope="row"><pre>        set theAccount to ""<span></span></pre></td></tr><tr><td scope="row"><pre>        set theMailbox to ""<span></span></pre></td></tr><tr><td scope="row"><pre>        set theSubject to ""<span></span></pre></td></tr><tr><td scope="row"><pre>        set theDateReceived to ""<span></span></pre></td></tr><tr><td scope="row"><pre>        set theContents to ""<span></span></pre></td></tr><tr><td scope="row"><pre>        set theSender to ""<span></span></pre></td></tr><tr><td scope="row"><pre>        set theRecipients to ""<span></span></pre></td></tr><tr><td scope="row"><pre>        set theCCRecipients to ""<span></span></pre></td></tr><tr><td scope="row"><pre>        set theReplyTo to ""<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        tell application "Mail"<span></span></pre></td></tr><tr><td scope="row"><pre>            set theMessage to Abstract object clickedRow of foundMessages<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            set theAccount to account name of account of container of theMessage<span></span></pre></td></tr><tr><td scope="row"><pre>            set theMailbox to mailbox name of container of theMessage<span></span></pre></td></tr><tr><td scope="row"><pre>            set theSubject to subject of theMessage<span></span></pre></td></tr><tr><td scope="row"><pre>            -- set theDateReceived to date received of theMessage<span></span></pre></td></tr><tr><td scope="row"><pre>            set theContents to content of theMessage<span></span></pre></td></tr><tr><td scope="row"><pre>            set theSender to sender of theMessage<span></span></pre></td></tr><tr><td scope="row"><pre>            set theRecipients to address of every recipient of theMessage<span></span></pre></td></tr><tr><td scope="row"><pre>            set theCCRecipients to address of every cc recipient of theMessage<span></span></pre></td></tr><tr><td scope="row"><pre>            set theReplyTo to reply to of theMessage<span></span></pre></td></tr><tr><td scope="row"><pre>        end tell<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        set messageWindow to makeMessageWindow()<span></span></pre></td></tr><tr><td scope="row"><pre>        tell messageWindow<span></span></pre></td></tr><tr><td scope="row"><pre>            set messageContents to "Account: " &amp; theAccount &amp; return<span></span></pre></td></tr><tr><td scope="row"><pre>            set messageContents to messageContents &amp; "Mailbox: " &amp; theMailbox &amp; return<span></span></pre></td></tr><tr><td scope="row"><pre>            if length of theSender > 0 then<span></span></pre></td></tr><tr><td scope="row"><pre>                set messageContents to messageContents &amp; "From: " &amp; theSender &amp; return<span></span></pre></td></tr><tr><td scope="row"><pre>            end if<span></span></pre></td></tr><tr><td scope="row"><pre>            if length of theDateReceived as string > 0 then<span></span></pre></td></tr><tr><td scope="row"><pre>                set messageContents to messageContents &amp; "Date: " ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                    &amp; (theDateReceived as string) &amp; return<span></span></pre></td></tr><tr><td scope="row"><pre>            end if<span></span></pre></td></tr><tr><td scope="row"><pre>            if length of theRecipients > 0 then<span></span></pre></td></tr><tr><td scope="row"><pre>                set messageContents to messageContents &amp; "To: " ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                    &amp; theRecipients &amp; return<span></span></pre></td></tr><tr><td scope="row"><pre>            end if<span></span></pre></td></tr><tr><td scope="row"><pre>            if length of theCCRecipients > 0 then<span></span></pre></td></tr><tr><td scope="row"><pre>                set messageContents to messageContents &amp; "Cc: " ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                    &amp; theCCRecipients &amp; return<span></span></pre></td></tr><tr><td scope="row"><pre>            end if<span></span></pre></td></tr><tr><td scope="row"><pre>            if length of theSubject > 0 then<span></span></pre></td></tr><tr><td scope="row"><pre>                set messageContents to messageContents &amp; "Subject: " ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                    &amp; theSubject &amp; return<span></span></pre></td></tr><tr><td scope="row"><pre>            end if<span></span></pre></td></tr><tr><td scope="row"><pre>            if length of theReplyTo > 0 then<span></span></pre></td></tr><tr><td scope="row"><pre>                set messageContents to messageContents &amp; "Reply-To: " ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                    &amp; theReplyTo &amp; return &amp; return<span></span></pre></td></tr><tr><td scope="row"><pre>            end if<span></span></pre></td></tr><tr><td scope="row"><pre>            set messageContents to messageContents &amp; theContents<span></span></pre></td></tr><tr><td scope="row"><pre>            set contents of text view "message" of scroll view "message" ¬<span></span></pre></td></tr><tr><td scope="row"><pre>                to messageContents<span></span></pre></td></tr><tr><td scope="row"><pre>            set title to theSubject<span></span></pre></td></tr><tr><td scope="row"><pre>            set visible to true<span></span></pre></td></tr><tr><td scope="row"><pre>        end tell<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end openMessageWindow<span></span></pre></td></tr></table></div>	<p>The <code>openMessageWindow</code> handler performs the following steps:</p><ol class="ol"><li class="li"><p>It gets the row number for the currently selected message from the Messages table view.</p></li><li class="li"><p>If there is no currently selected row (the row number is less than zero), it does nothing. Otherwise it performs the following steps.</p></li><li class="li"><p>It initializes some local variables to store message information, such as the account, mailbox, subject, and so on.</p></li><li class="li"><p>It calls on the Mail application to obtain an object representing the message at the selected row. The term <code>Abstract object</code> is a Cocoa scripting term specifying an object that is the parent for all script objects that have no other parent class.</p></li><li class="li"><p>Continuing to use the Mail application, it sets local variables to message information from the message object returned in the previous step.</p></li><li class="li"><p>It calls the <code>makeMessageWindow</code> handler to create a new message window for displaying the message. The <code>makeMessageWindow</code> handler is described in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-BCICDECD">“Write Handlers for Working With Message Windows.”</a></span></p></li><li class="li"><p>It sets another local variable to the message contents of the found message by concatenating the message information previously stored in local variables, then sets the text contents of the new message window.</p></li><li class="li"><p>It sets the title of the new window to the subject of the found message.</p></li><li class="li"><p>It sets the visible property of the new window to display it to the user.</p></li></ol><a name="//apple_ref/doc/uid/20001257-BCIBFHDJ" title="Write Handlers for Working With Controllers"></a><h3>Write Handlers for Working With Controllers</h3><p>Mail Search needs several handlers for working with controllers. These handlers are not part of the controller script itself. They aren’t shown in individual listings, but you can examine them in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-TPXREF101">Chapter 10</a></span> or in the Mail Search sample application.</p><ul class="spaceabove"><li class="li"><p><code>makeController</code>: This handler contains the entire controller script. You’ve examined most of the handlers in this script in previous sections. The <code>makeController</code> handler is called by the <code>will open</code> handler, shown in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-BCICGGHG">Listing 9-4</a></span>, to create a controller script object for a search window. Since the script is the only content of the <code>makeController</code> handler, calling the handler effectively returns the script object as a return result.</p></li><li class="li"><p><code>addController</code>: This handler is also called by the <code>will open</code> handler, shown in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-BCICGGHG">Listing 9-4</a></span>. It simply adds a controller to the global list of controllers.</p></li><li class="li"><p><code>removeController</code>: This handler is also called by the <code>will close</code> handler, shown in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-BCIFHICG">Listing 9-6</a></span>. It simply removes a controller from the global list of controllers by calling the utility handler <code>deleteItemInList</code>.</p></li><li class="li"><p><code>controllerForWindow</code>: This handler is called whenever a handler needs to obtain the controller for the current window. It returns the controller for the passed window from the global list of controllers.</p></li></ul><a name="//apple_ref/doc/uid/20001257-TPXREF215" title="Write Handlers for Working With the Status Dialog"></a><h3>Write Handlers for Working With the Status Dialog</h3><p>Mail Search only needs one handler to work with the status dialog script, the <code>makeStatusPanel</code> handler, which creates the status dialog script object. This handler is shown in full in <span class="content_text"><a href="studio_write_code.html#//apple_ref/doc/uid/20001257-TPXREF101">Chapter 10</a></span>. The handlers and properties it contains are described in <span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-TPXREF204">“The Status Dialog Script.”</a></span> Since the script is the only content of the <code>makeStatusPanel</code> handler, calling the handler effectively returns the script object as a return result.</p><a name="//apple_ref/doc/uid/20001257-BCICDECD" title="Write Handlers for Working With Message Windows"></a><h3>Write Handlers for Working With Message Windows</h3><p>Mail Search only needs one handler to work with the message window, the <code>makeMessageWindow</code> handler. This handler, shown in <span class="content_text">Listing 9-19</span>, is called from the <code>openMessageWindow</code> handler (shown in <span class="content_text">Listing 9-18</span>.</p><a name="//apple_ref/doc/uid/20001257-BCIFABEI" title="Listing 9-19The makeMessageWindow handler"></a><p class="codesample"><strong>Listing 9-19&nbsp;&nbsp;</strong>The <code>makeMessageWindow</code> handler</p><div class="codesample"><table><tr><td scope="row"><pre>on makeMessageWindow()<span></span></pre></td></tr><tr><td scope="row"><pre>    load nib "Message"<span></span></pre></td></tr><tr><td scope="row"><pre>    set windowCount to windowCount + 1<span></span></pre></td></tr><tr><td scope="row"><pre>    set windowName to "message " &amp; windowCount<span></span></pre></td></tr><tr><td scope="row"><pre>    set name of window "message" to windowName<span></span></pre></td></tr><tr><td scope="row"><pre>    return window windowName<span></span></pre></td></tr><tr><td scope="row"><pre>end makeMessageWindow<span></span></pre></td></tr></table></div><p>The <code>makeMessageWindow</code> performs the following steps:</p><ol class="ol"><li class="li"><p>It loads an instance of the Message window from the Message nib.</p></li><li class="li"><p>It increments Mail Search’s global window count property.</p></li><li class="li"><p>It constructs a name for the window.</p></li><li class="li"><p>It returns the window name.</p></li></ol><a name="//apple_ref/doc/uid/20001257-TPXREF219" title="Write Utility Handlers"></a><h3>Write Utility Handlers</h3><p>Mail Search needs one utility handler, <code>deleteItemInList</code>, to remove an item from a list. This handler is called by <code>removeController</code>, which in turn is called by the window’s <code>will close</code> handler to remove a controller before the window closes. AppleScript doesn’t currently support deleting items from lists directly, so scripters rely on a utility handler such as <code>deleteItemInList</code>, shown in <span class="content_text">Listing 9-20</span>.</p><a name="//apple_ref/doc/uid/20001257-BCIEEJID" title="Listing 9-20Utility function to delete an item from a list"></a><p class="codesample"><strong>Listing 9-20&nbsp;&nbsp;</strong>Utility function to delete an item from a list</p><div class="codesample"><table><tr><td scope="row"><pre>on deleteItemInList(x, theList)<span></span></pre></td></tr><tr><td scope="row"><pre>    (* To Be Provided *)<span></span></pre></td></tr><tr><td scope="row"><pre>end deleteItemInList<span></span></pre></td></tr></table></div>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../chapter09/studio_ms_connect_intf.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../chapter11/studio_ms_build_debug.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2001, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-04-04<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/chapter10/studio_write_code.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/chapter10/studio_write_code.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/chapter10/studio_write_code.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>