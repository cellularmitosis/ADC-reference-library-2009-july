<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Authorization Services C Reference</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Authorization Services C Reference"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30000826-DontLinkChapterID_1" title="Authorization Services C Reference"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> &gt; <a href="../../../../../reference/Security/index.html#//apple_ref/doc/uid/TP30001281-TP30000434" target="_top">Security</a> &gt; <a href="../../../../../reference/Security/idxAuthorization-date.html#//apple_ref/doc/uid/TP30001281-TP30000434-TP30001024" target="_top">Authorization</a> &gt; <a href="../index.html" target="_top">Authorization Services C Reference</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <!-- Previous button --><span style="margin-left: 8px"><a href="../appendixa/appendixa.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP30000826-DontLinkChapterID_1-DontLinkElementID_4" title="Authorization Services C Reference"></a><h1>Authorization Services C Reference</h1><div class="spec_sheet_info_box"><table cellspacing="0" class="specbox"><tr><td scope="row"><strong><span style="white-space: nowrap;">Framework</span></strong></td><td><div style="margin-bottom:1px"> <a href="../../SecurityFrameworkReference/index.html#//apple_ref/doc/uid/TP40004330" target="_top">Security</a></div></td></tr><tr><td scope="row"><strong><span style="white-space: nowrap;">Declared in</span></strong></td><td><div style="margin-bottom:1px"><span class="content_text">Authorization.h</span><br/><span class="content_text">AuthorizationDB.h</span><br/><span class="content_text">AuthorizationTags.h</span><br/></div></td></tr></table></div><br/><a name="//apple_ref/doc/uid/TP30000826-CH202-DontLinkElementID_2" title="Overview"></a><h2>Overview</h2>
<p>Authorization Services is an API that facilitates access control to restricted areas of the operating system and allows you to restrict a user’s access to particular features in your Mac OS X application. Authorization Services is used in</p><div class="notebox"><a name="//apple_ref/doc/uid/TP30000826-CH202-DontLinkElementID_5" title="Note"></a><p><strong>Note:</strong>&nbsp;This document was previously titled <em>Authorization Services Reference</em>.</p></div>
<ul class="ul"><li class="li"><p>software that restricts access to its own tools</p></li>
<li class="li"><p>applications that call system tools</p></li>
<li class="li"><p>software installers that install privileged tools or require access to restricted areas of the operating system</p></li></ul>
<p>A companion volume to <em>Authorization Services C Reference</em> is <span class="content_text"><a href="../../../Conceptual/authorization_concepts/index.html#//apple_ref/doc/uid/TP30000995" target="_top">Performing Privileged Operations With Authorization Services</a></span>, which explains the concepts behind authorization and provides examples of how to use Authorization Services. Objective-C methods that are equivalent to several of the functions in this document are described in <span class="content_text"><a href="../../AuthServicesObjCRef/index.html#//apple_ref/doc/uid/TP40001854" target="_top">Authorization Services Objective-C Reference</a></span>.</p>
<p>Authorization Services is available in Mac OS X v10.0 and later as part of the Security framework.</p>

<a name="//apple_ref/doc/uid/TP30000826-DontLinkChapterID_1-DontLinkElementID_3" title="Functions by Task"></a><h2>Functions by Task</h2>
<a name="//apple_ref/doc/uid/TP30000826-CH1g-138491" title="Creating and Releasing Authorization References"></a><a name="//apple_ref/doc/uid/TP30000826-CH1g-TPXREF101" title="Creating and Releasing Authorization References"></a>
    
    <h3 class="tasks"><a name="//apple_ref/doc/uid/TP30000826-CH1g-TPXREF114" title="Creating and Releasing Authorization References"></a>Creating and Releasing Authorization References</h3>
        
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/AuthorizationCreate">AuthorizationCreate</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Creates a new authorization reference and provides an option to authorize or preauthorize rights.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/AuthorizationFree">AuthorizationFree</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Frees the memory associated with an authorization reference.'/>
            </span></li>
    </ul>


<a name="//apple_ref/doc/uid/TP30000826-CH1g-138963" title="Requesting Rights and Credentials"></a><a name="//apple_ref/doc/uid/TP30000826-CH1g-TPXREF102" title="Requesting Rights and Credentials"></a>
    
    <h3 class="tasks"><a name="//apple_ref/doc/uid/TP30000826-CH1g-TPXREF115" title="Requesting Rights and Credentials"></a>Requesting Rights and Credentials</h3>
        
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/AuthorizationCopyRights">AuthorizationCopyRights</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Authorizes and preauthorizes rights.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/AuthorizationCopyInfo">AuthorizationCopyInfo</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Retrieves side-band data such as the user name and other information gathered during evaluation of authorization. '/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/AuthorizationFreeItemSet">AuthorizationFreeItemSet</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Frees the memory associated with an authorization set.'/>
            </span></li>
    </ul>


<a name="//apple_ref/doc/uid/TP30000826-CH1g-139564" title="Externalizing and Internalizing Authorization References"></a><a name="//apple_ref/doc/uid/TP30000826-CH1g-TPXREF103" title="Externalizing and Internalizing Authorization References"></a>
    
    <h3 class="tasks"><a name="//apple_ref/doc/uid/TP30000826-CH1g-TPXREF116" title="Externalizing and Internalizing Authorization References"></a>Externalizing and Internalizing Authorization References</h3>
        
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/AuthorizationMakeExternalForm">AuthorizationMakeExternalForm</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Creates an external representation of an authorization reference.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/AuthorizationCreateFromExternalForm">AuthorizationCreateFromExternalForm</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Internalizes the external representation of an authorization reference.'/>
            </span></li>
    </ul>


<a name="//apple_ref/doc/uid/TP30000826-CH1g-251766" title="Modifying the Policy Database"></a>
    
    <h3 class="tasks">Modifying the Policy Database</h3>
        
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/AuthorizationRightGet">AuthorizationRightGet</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Retrieves a right definition as a dictionary.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/AuthorizationRightSet">AuthorizationRightSet</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Creates or updates a right entry in the policy database.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/AuthorizationRightRemove">AuthorizationRightRemove</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Removes a right from the policy database.'/>
            </span></li>
    </ul>


<a name="//apple_ref/doc/uid/TP30000826-CH1g-254100" title="Executing With Root Privileges"></a><a name="//apple_ref/doc/uid/TP30000826-CH1g-TPXREF104" title="Executing With Root Privileges"></a>
    
    <h3 class="tasks"><a name="//apple_ref/doc/uid/TP30000826-CH1g-TPXREF117" title="Executing With Root Privileges"></a>Executing With Root Privileges</h3>
        
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/AuthorizationExecuteWithPrivileges">AuthorizationExecuteWithPrivileges</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Runs an executable tool with root privileges.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/AuthorizationCopyPrivilegedReference">AuthorizationCopyPrivilegedReference</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Retrieves the authorization reference passed by the <code>AuthorizationExecuteWithPrivileges</code> function.'/>
            </span></li>
    </ul>

<a name="//apple_ref/doc/uid/TP30000826-CH1g-279356" title="Functions"></a><a name="//apple_ref/doc/uid/TP30000826-CH1g-CJBHFEJI" title="Functions"></a><h2>Functions</h2>
















<a name="//apple_ref/c/func/AuthorizationCopyInfo" title="AuthorizationCopyInfo"></a><a name="//apple_ref/doc/c_ref/AuthorizationCopyInfo" title="AuthorizationCopyInfo"></a><a name="//apple_ref/doc/uid/TP30000826-CH1g-F17550" title="AuthorizationCopyInfo"></a>
<a name="//apple_ref/doc/uid/TP30000826-CH1g-DontLinkElementID_7"></a><h3 class="tight">AuthorizationCopyInfo</h3>
<p class="spaceabove">Retrieves side-band data such as the user name and other information gathered during evaluation of authorization. </p>
<p class="spaceabove"><pre>
OSStatus AuthorizationCopyInfo (
   <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationRef">AuthorizationRef</a> authorization,
   <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationString">AuthorizationString</a> tag,
   <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationItemSet">AuthorizationItemSet</a> **info
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>authorization</em></dt>
<dd><p>An authorization reference referring to the authorization session.</p></dd>
<dt><em>tag</em></dt>
<dd><p>An authorization string specifying the type of data the Security Server should return. Pass <code>NULL</code> to retrieve all available information.</p></dd>
<dt><em>info</em></dt>
<dd><p>A pointer to an authorization set the Security Server creates. On return, this set contains side-band authorization data. When this set is no longer needed, free the memory associated with it by calling the function <code><a href="reference.html#//apple_ref/c/func/AuthorizationFreeItemSet">AuthorizationFreeItemSet</a></code>.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p> A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP30000826-CH4g-CJBEABHG">“Authorization Services Result Codes.”</a></span></p>
<h5 class="tight">Discussion</h5>
<p>An authorization plug-in can store the results of an authentication operation by calling the <code><a href="../../AuthorizationPluginRef/Reference/reference.html#//apple_ref/c/func/SetContextValue" target="_top">SetContextValue</a></code> function. You can use the <code>AuthorizationCopyInfo</code> function to retrieve this information.</p>
<h5 class="tight">Availability</h5><ul class="availability">
<li class="availability">Available in Mac OS X v10.0 and later.</li></ul><h5 class="tight">Declared In</h5><code>Authorization.h</code><a name="//apple_ref/c/func/AuthorizationCopyPrivilegedReference" title="AuthorizationCopyPrivilegedReference"></a><a name="//apple_ref/doc/c_ref/AuthorizationCopyPrivilegedReference" title="AuthorizationCopyPrivilegedReference"></a><a name="//apple_ref/doc/uid/TP30000826-CH1g-F17555" title="AuthorizationCopyPrivilegedReference"></a>
<a name="//apple_ref/doc/uid/TP30000826-CH1g-DontLinkElementID_8"></a><h3 class="tight">AuthorizationCopyPrivilegedReference</h3>
<p class="spaceabove">Retrieves the authorization reference passed by the <code>AuthorizationExecuteWithPrivileges</code> function.</p>
<p class="spaceabove"><pre>
OSStatus AuthorizationCopyPrivilegedReference (
   <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationRef">AuthorizationRef</a> *authorization,
   <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationFlags">AuthorizationFlags</a> flags
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>authorization</em></dt>
<dd><p>A pointer to an authorization reference. The Security Server allocates the authorization reference for you, so you do not need to call the function <code><a href="reference.html#//apple_ref/c/func/AuthorizationCreate">AuthorizationCreate</a></code>. On return, it points to a copy of the authorization reference used in the call to the <code><a href="reference.html#//apple_ref/c/func/AuthorizationExecuteWithPrivileges">AuthorizationExecuteWithPrivileges</a></code> function.</p></dd>
<dt><em>flags</em></dt>
<dd><p>Reserved options. Pass the <code>kAuthorizationFlagDefaults</code> constant.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p> A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP30000826-CH4g-CJBEABHG">“Authorization Services Result Codes.”</a></span></p>
<h5 class="tight">Discussion</h5>
<p>This function retrieves the authorization reference you pass in the function <code><a href="reference.html#//apple_ref/c/func/AuthorizationExecuteWithPrivileges">AuthorizationExecuteWithPrivileges</a></code>. The new process can use the authorization reference to verify authorizations obtained by the calling process.</p>
<h5 class="tight">Availability</h5><ul class="availability">
<li class="availability">Available in Mac OS X v10.0 and later.</li></ul><h5 class="tight">Related Sample Code</h5><ul class="availability"><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/BSDLLCTest/index.html#//apple_ref/doc/uid/DTS10000692" target="_top">BSDLLCTest</a></span></li><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/MoreIsBetter/index.html#//apple_ref/doc/uid/DTS10000732" target="_top">MoreIsBetter</a></span></li><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/QISA/index.html#//apple_ref/doc/uid/DTS10000714" target="_top">QISA</a></span></li></ul><h5 class="tight">Declared In</h5><code>Authorization.h</code><a name="//apple_ref/c/func/AuthorizationCopyRights" title="AuthorizationCopyRights"></a><a name="//apple_ref/doc/c_ref/AuthorizationCopyRights" title="AuthorizationCopyRights"></a><a name="//apple_ref/doc/uid/TP30000826-CH1g-F17549" title="AuthorizationCopyRights"></a>
<a name="//apple_ref/doc/uid/TP30000826-CH1g-DontLinkElementID_9"></a><h3 class="tight">AuthorizationCopyRights</h3>
<p class="spaceabove">Authorizes and preauthorizes rights.</p>
<p class="spaceabove"><pre>
OSStatus AuthorizationCopyRights (
   <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationRef">AuthorizationRef</a> authorization,
   const <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationRights">AuthorizationRights</a> *rights,
   const <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationEnvironment">AuthorizationEnvironment</a> *environment,
   <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationFlags">AuthorizationFlags</a> flags,
   <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationRights">AuthorizationRights</a> **authorizedRights
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>authorization</em></dt>
<dd><p>An authorization reference referring to the authorization session. </p></dd>
<dt><em>rights</em></dt>
<dd><p>A pointer to a set of authorization rights you create. Pass <code>NULL</code> if the application requires no rights at this time. </p></dd>
<dt><em>environment</em></dt>
<dd><p>Data used when authorizing or preauthorizing rights. Not used in Mac OS X v10.2 and earlier. In Mac OS X v10.3 and later, you can pass icon or prompt data to be used in the authentication dialog box. In Mac OS X v10.4 and later, you can also pass a user name and password in order to authorize a user without displaying the authentication dialog box. Possible values for this parameter are listed in <code>Security.framework/Headers/AuthorizationTags.h</code>. The data passed in this parameter is not stored in the authorization reference; it is used only during authorization. If you are not passing any data in this parameter, pass the constant <code>kAuthorizationEmptyEnvironment</code>.</p></dd>
<dt><em>flags</em></dt>
<dd><p>A bit mask for specifying authorization options. Use the following option sets.</p><ul class="termdef"><li class="termdef"><p>Pass the constant <code>kAuthorizationFlagDefaults</code> if no options are necessary.</p></li>
<li class="termdef"><p>Specify the <code>kAuthorizationFlagExtendRights</code> mask to request rights. You can also specify the <code>kAuthorizationFlagInteractionAllowed</code> mask to allow user interaction.</p></li>
<li class="termdef"><p>Specify the <code>kAuthorizationFlagPartialRights</code> and <code>kAuthorizationFlagExtendRights</code> masks to request partial rights. You can also specify the <code>kAuthorizationFlagInteractionAllowed</code> mask to allow user interaction.</p></li>
<li class="termdef"><p>Specify the <code>kAuthorizationFlagPreAuthorize</code> and <code>kAuthorizationFlagExtendRights</code> masks to preauthorize rights.</p></li>
<li class="termdef"><p>Specify the <code>kAuthorizationFlagDestroyRights</code> mask to prevent the Security Server from preserving the rights obtained during this call.</p></li></ul></dd>
<dt><em>authorizedRights</em></dt>
<dd><p>A pointer to a newly allocated <code>AuthorizationRights</code> structure. On return, this structure contains the rights granted by the Security framework. If you do not require this information, pass <code>NULL</code>. If you specify the <code>kAuthorizationFlagPreAuthorize</code> mask in the <code>flags</code> parameter, the method returns all the requested rights, including those not granted, but the flags of the rights that could not be preauthorized include the <code><a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationFlagCanNotPreAuthorize">kAuthorizationFlagCanNotPreAuthorize</a></code> bit.</p><p>Free the memory associated with this set by calling the function <code><a href="reference.html#//apple_ref/c/func/AuthorizationFreeItemSet">AuthorizationFreeItemSet</a></code>.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p> A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP30000826-CH4g-CJBEABHG">“Authorization Services Result Codes.”</a></span></p>
<h5 class="tight">Discussion</h5>
<p>There are three main reasons to use this function. The first reason is to preauthorize rights by specifying the <code>kAuthorizationFlagPreAuthorize</code>, <code>kAuthorizationFlagInteractionAllowed</code>, and <code>kAuthorizationFlagExtendRights</code> masks as authorization options. Preauthorization is most useful when a right has a zero timeout. For example, you can preauthorize in the application and if it succeeds, call the helper tool and request authorization. This eliminates calling the helper tool if the Security Server cannot later authorize the specified rights.</p>
<p>The second reason to use this function is to authorize rights before performing a privileged operation by specifying the <code>kAuthorizationFlagInteractionAllowed</code>, and <code>kAuthorizationFlagExtendRights</code> masks as authorization options.</p>
<p>The third reason to use this function is to authorize partial rights. By specifying the <code>kAuthorizationFlagPartialRights</code>, <code>kAuthorizationFlagInteractionAllowed</code>, and <code>kAuthorizationFlagExtendRights</code> masks as authorization options, the Security Server grants all rights it can authorize. On return, the authorized set contains all the rights.</p>
<p>If you do not specify the <code>kAuthorizationFlagPartialRights</code> mask and the Security Server denies at least one right, then the status of this function on return is <code>errAuthorizationDenied</code>.</p>
<p>If you do not specify the <code>kAuthorizationFlagInteractionAllowed</code> mask and the Security Server requires user interaction, then the status of this function on return is <code>errAuthorizationInteractionNotAllowed</code>.</p>
<p>If you specify the <code>kAuthorizationFlagInteractionAllowed</code> mask and the user cancels the authentication process, then the status of this function on return is <code>errAuthorizationCanceled</code>.</p>
<h5 class="tight">Availability</h5><ul class="availability">
<li class="availability">Available in Mac OS X v10.0 and later.</li></ul><h5 class="tight">Related Sample Code</h5><ul class="availability"><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/AuthForAll/index.html#//apple_ref/doc/uid/DTS10001084" target="_top">AuthForAll</a></span></li><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/BSDLLCTest/index.html#//apple_ref/doc/uid/DTS10000692" target="_top">BSDLLCTest</a></span></li><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/MoreIsBetter/index.html#//apple_ref/doc/uid/DTS10000732" target="_top">MoreIsBetter</a></span></li></ul><h5 class="tight">Declared In</h5><code>Authorization.h</code><a name="//apple_ref/c/func/AuthorizationCreate" title="AuthorizationCreate"></a><a name="//apple_ref/doc/c_ref/AuthorizationCreate" title="AuthorizationCreate"></a><a name="//apple_ref/doc/uid/TP30000826-CH1g-F17525" title="AuthorizationCreate"></a>
<a name="//apple_ref/doc/uid/TP30000826-CH1g-DontLinkElementID_10"></a><h3 class="tight">AuthorizationCreate</h3>
<p class="spaceabove">Creates a new authorization reference and provides an option to authorize or preauthorize rights.</p>
<p class="spaceabove"><pre>
OSStatus AuthorizationCreate (
   const <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationRights">AuthorizationRights</a> *rights,
   const <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationEnvironment">AuthorizationEnvironment</a> *environment,
   <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationFlags">AuthorizationFlags</a> flags,
   <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationRef">AuthorizationRef</a> *authorization
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>rights</em></dt>
<dd><p>A pointer to a set of authorization rights you create. Pass <code>NULL</code> if the application requires no rights at this time. </p></dd>
<dt><em>environment</em></dt>
<dd><p>Data used when authorizing or preauthorizing rights. Not used in Mac OS X v10.2 and earlier. In Mac OS X v10.3 and later, you can pass icon or prompt data to be used in the authentication dialog box. In Mac OS X v10.4 and later, you can also pass a user name and password in order to authorize a user without user interaction. Possible values for this parameter are listed in <code>Security.framework/Headers/AuthorizationTags.h</code>. The data passed in this parameter is not stored in the authorization reference; it is used only during authorization. If you are not passing any data in this parameter, pass the constant <code>kAuthorizationEmptyEnvironment</code>. </p></dd>
<dt><em>flags</em></dt>
<dd><p>A bit mask for specifying authorization options. Use the following option sets.</p><ul class="termdef"><li class="termdef"><p>Pass the constant <code>kAuthorizationFlagDefaults</code> if no options are necessary.</p></li>
<li class="termdef"><p>Specify the <code>kAuthorizationFlagExtendRights</code> mask to request rights. You can also specify the <code>kAuthorizationFlagInteractionAllowed</code> mask to allow user interaction.</p></li>
<li class="termdef"><p>Specify the <code>kAuthorizationFlagPartialRights</code> and <code>kAuthorizationFlagExtendRights</code> masks to request partial rights. You can also specify the <code>kAuthorizationFlagInteractionAllowed</code> mask to allow user interaction.</p></li>
<li class="termdef"><p>Specify the <code>kAuthorizationFlagPreAuthorize</code> and <code>kAuthorizationFlagExtendRights</code> masks to preauthorize rights.</p></li>
<li class="termdef"><p>Specify the <code>kAuthorizationFlagDestroyRights</code> mask to prevent the Security Server from preserving the rights obtained during this call.</p></li></ul></dd>
<dt><em>authorization</em></dt>
<dd><p>A pointer to an authorization reference. On return, this parameter refers to the authorization session the Security Server creates. Pass <code>NULL</code> if you require a function result but no authorization reference.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p> A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP30000826-CH4g-CJBEABHG">“Authorization Services Result Codes.”</a></span></p>
<h5 class="tight">Discussion</h5>
<p>The primary purpose of this function is to create the opaque authorization reference structure associated with the authorization reference. You use the authorization reference in other authorization functions.</p>
<p>You can use this function to authorize all or partial rights. Authorizing rights with this function is most useful for applications that require a one-time authorization. By passing <code>NULL</code> to the <code>authorization</code> parameter, the Security Server attempts to authorize the requested rights and returns the appropriate result code without actually granting the rights. If you are not going to call any other authorization functions, use this method to determine if a user has authorization without granting any rights.</p>
<p>You can also use this function to preauthorize rights by specifying the <code>kAuthorizationFlagPreAuthorize</code> mask. Preauthorization is most useful when a right has a zero timeout. For example, you can preauthorize in the application and if it succeeds, call the helper tool and request authorization. This eliminates calling the helper tool if the user cannot later authorize the specified rights.</p>
<p>If you do not specify the <code>kAuthorizationFlagPartialRights</code> mask and the Security Server denies at least one right, then the status of this function on return is <code>errAuthorizationDenied</code>.</p>
<p>If you do not specify the <code>kAuthorizationFlagInteractionAllowed</code> mask and the Security Server requires user interaction, then the status of this function on return is <code>errAuthorizationInteractionNotAllowed</code>.</p>
<p>If you specify the <code>kAuthorizationFlagInteractionAllowed</code> mask and the user cancels the authentication process, then the status of this function on return is <code>errAuthorizationCanceled</code>.</p>
<p>When your application no longer needs the authorization reference, use the function <code><a href="reference.html#//apple_ref/c/func/AuthorizationFree">AuthorizationFree</a></code> to free the memory associated with it.</p>
<h5 class="tight">Availability</h5><ul class="availability">
<li class="availability">Available in Mac OS X v10.0 and later.</li></ul><h5 class="tight">Related Sample Code</h5><ul class="availability"><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/AuthForAll/index.html#//apple_ref/doc/uid/DTS10001084" target="_top">AuthForAll</a></span></li><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/BSDLLCTest/index.html#//apple_ref/doc/uid/DTS10000692" target="_top">BSDLLCTest</a></span></li><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/MoreIsBetter/index.html#//apple_ref/doc/uid/DTS10000732" target="_top">MoreIsBetter</a></span></li><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/QISA/index.html#//apple_ref/doc/uid/DTS10000714" target="_top">QISA</a></span></li></ul><h5 class="tight">Declared In</h5><code>Authorization.h</code><a name="//apple_ref/c/func/AuthorizationCreateFromExternalForm" title="AuthorizationCreateFromExternalForm"></a><a name="//apple_ref/doc/c_ref/AuthorizationCreateFromExternalForm" title="AuthorizationCreateFromExternalForm"></a><a name="//apple_ref/doc/uid/TP30000826-CH1g-F17552" title="AuthorizationCreateFromExternalForm"></a>
<a name="//apple_ref/doc/uid/TP30000826-CH1g-DontLinkElementID_11"></a><h3 class="tight">AuthorizationCreateFromExternalForm</h3>
<p class="spaceabove">Internalizes the external representation of an authorization reference.</p>
<p class="spaceabove"><pre>
OSStatus AuthorizationCreateFromExternalForm (
   const <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationExternalForm">AuthorizationExternalForm</a> *extForm,
   <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationRef">AuthorizationRef</a> *authorization
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>extForm</em></dt>
<dd><p>A pointer to the external representation of the authorization reference you retrieve from the calling process.</p></dd>
<dt><em>authorization</em></dt>
<dd><p>A pointer to an authorization reference. On return, this points to the local copy of the authorization reference. The Security Server allocates the authorization reference for you, so you do not need to call the function <code><a href="reference.html#//apple_ref/c/func/AuthorizationCreate">AuthorizationCreate</a></code>.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p> A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP30000826-CH4g-CJBEABHG">“Authorization Services Result Codes.”</a></span></p>
<h5 class="tight">Discussion</h5>
<p>When passing an authorization reference between processes, use this function to internalize the external representation of the authorization reference you created using the function <code><a href="reference.html#//apple_ref/c/func/AuthorizationMakeExternalForm">AuthorizationMakeExternalForm</a></code>.</p>
<h5 class="tight">Availability</h5><ul class="availability">
<li class="availability">Available in Mac OS X v10.0 and later.</li></ul><h5 class="tight">Related Sample Code</h5><ul class="availability"><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/BSDLLCTest/index.html#//apple_ref/doc/uid/DTS10000692" target="_top">BSDLLCTest</a></span></li><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/MoreIsBetter/index.html#//apple_ref/doc/uid/DTS10000732" target="_top">MoreIsBetter</a></span></li><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/QISA/index.html#//apple_ref/doc/uid/DTS10000714" target="_top">QISA</a></span></li></ul><h5 class="tight">Declared In</h5><code>Authorization.h</code><a name="//apple_ref/c/func/AuthorizationExecuteWithPrivileges" title="AuthorizationExecuteWithPrivileges"></a><a name="//apple_ref/doc/c_ref/AuthorizationExecuteWithPrivileges" title="AuthorizationExecuteWithPrivileges"></a><a name="//apple_ref/doc/uid/TP30000826-CH1g-F17554" title="AuthorizationExecuteWithPrivileges"></a>
<a name="//apple_ref/doc/uid/TP30000826-CH1g-DontLinkElementID_12"></a><h3 class="tight">AuthorizationExecuteWithPrivileges</h3>
<p class="spaceabove">Runs an executable tool with root privileges.</p>
<p class="spaceabove"><pre>
OSStatus AuthorizationExecuteWithPrivileges (
   <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationRef">AuthorizationRef</a> authorization,
   const char *pathToTool,
   <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationFlags">AuthorizationFlags</a> options,
   char *const *arguments,
   <!--a-->FILE<!--/a--> **communicationsPipe
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>authorization</em></dt>
<dd><p>An authorization reference referring to the authorization session.</p></dd>
<dt><em>pathToTool</em></dt>
<dd><p>The full POSIX pathname of the tool to execute.</p></dd>
<dt><em>options</em></dt>
<dd><p>Reserved options. Pass the <code>kAuthorizationFlagDefaults</code> constant.</p></dd>
<dt><em>arguments</em></dt>
<dd><p>An argv-style vector of strings to send to the tool.</p></dd>
<dt><em>communicationsPipe</em></dt>
<dd><p>A pointer to a file structure. The Security Server creates the file, opens it for reading and writing, and connects it to the tool’s standard input and output. On return, you must close and dispose of this file using <code>fclose</code> when your communication is complete. Pass <code>NULL</code> if you do not need a communications channel.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p> A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP30000826-CH4g-CJBEABHG">“Authorization Services Result Codes.”</a></span></p>
<h5 class="tight">Discussion</h5>
<p>This function enables you to execute the tool you specify in the <code>pathToTool</code> parameter as a separate, privileged process. The new process will run with root privileges regardless of the privileges of the invoking process. The new process can retrieve the authorization reference by calling the function <code><a href="reference.html#//apple_ref/c/func/AuthorizationCopyPrivilegedReference">AuthorizationCopyPrivilegedReference</a></code>. The arguments you pass in the <code>arguments</code> parameter are relayed to the new process’s <code>argv</code> parameter. A set of file descriptors is linked to the new process’s standard input and output so that your process may communicate with the new process.</p>
<p>To check if the user is authorized to perform this operation, you should preauthorize the <code>kAuthorizationRightExecute</code> right. See <code><a href="reference.html#//apple_ref/c/tdef/AuthorizationItem">AuthorizationItem</a></code> for a description of what information is included in the authorization item for this right.</p>
<h5 class="tight">Special Considerations</h5>
<p>You should use this function only to allow installers to run as root and to allow a <code>setuid</code> tool to repair its <code>setuid</code> bit if lost. This function works only if the Security Server establishes proper authorization.</p>
<p>This function poses a security concern because it will indiscriminately run any tool or application, severely increasing the security risk. You should avoid the use of this function if possible. One alternative is to split your code into two parts—the application and a setuid tool. The application invokes the setuid tool using standard methods. The setuid tool can then perform the privileged operations. If the tool loses its setuid bit, use the <code>AuthorizationExecuteWithPrivileges</code> function to repair it. Factoring your program minimizes the use of this function and reduces the risk of harm. Read <em>Inside Mac OS X: Performing Privileged Operations With Authorization Services</em>.</p>
<p>Note that this function respects the setuid bit, if it is set. That is, if the tool you are executing has its setuid bit set and its owner set to foo, the tool will be executed with the user foo’s privileges, not root privileges. To ensure that your call to the <code>AuthorizationExecuteWithPrivileges</code> function works as intended, make sure the setuid bit of the tool you wish to execute is cleared before calling <code>AuthorizationExecuteWithPrivileges</code> to execute the tool.</p>
<h5 class="tight">Availability</h5><ul class="availability">
<li class="availability">Available in Mac OS X v10.0 and later.</li></ul><h5 class="tight">Related Sample Code</h5><ul class="availability"><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/BSDLLCTest/index.html#//apple_ref/doc/uid/DTS10000692" target="_top">BSDLLCTest</a></span></li><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/MoreIsBetter/index.html#//apple_ref/doc/uid/DTS10000732" target="_top">MoreIsBetter</a></span></li><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/QISA/index.html#//apple_ref/doc/uid/DTS10000714" target="_top">QISA</a></span></li></ul><h5 class="tight">Declared In</h5><code>Authorization.h</code><a name="//apple_ref/c/func/AuthorizationFree" title="AuthorizationFree"></a><a name="//apple_ref/doc/c_ref/AuthorizationFree" title="AuthorizationFree"></a><a name="//apple_ref/doc/uid/TP30000826-CH1g-F17548" title="AuthorizationFree"></a>
<a name="//apple_ref/doc/uid/TP30000826-CH1g-DontLinkElementID_13"></a><h3 class="tight">AuthorizationFree</h3>
<p class="spaceabove">Frees the memory associated with an authorization reference.</p>
<p class="spaceabove"><pre>
OSStatus AuthorizationFree (
   <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationRef">AuthorizationRef</a> authorization,
   <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationFlags">AuthorizationFlags</a> flags
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>authorization</em></dt>
<dd><p>The authorization reference to free.</p></dd>
<dt><em>flags</em></dt>
<dd><p>A bit mask. In most cases, pass the constant <code>kAuthorizationFlagDefaults</code>. To remove all shared and nonshared authorizations, pass the constant <code>kAuthorizationFlagDestroyRights</code>.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p> A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP30000826-CH4g-CJBEABHG">“Authorization Services Result Codes.”</a></span> </p>
<h5 class="tight">Discussion</h5>
<p>Call this function when your application no longer needs the authorization reference you created using the function <code><a href="reference.html#//apple_ref/c/func/AuthorizationCreate">AuthorizationCreate</a></code>.</p>
<h5 class="tight">Availability</h5><ul class="availability">
<li class="availability">Available in Mac OS X v10.0 and later.</li></ul><h5 class="tight">Related Sample Code</h5><ul class="availability"><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/BSDLLCTest/index.html#//apple_ref/doc/uid/DTS10000692" target="_top">BSDLLCTest</a></span></li><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/MoreIsBetter/index.html#//apple_ref/doc/uid/DTS10000732" target="_top">MoreIsBetter</a></span></li><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/QISA/index.html#//apple_ref/doc/uid/DTS10000714" target="_top">QISA</a></span></li></ul><h5 class="tight">Declared In</h5><code>Authorization.h</code><a name="//apple_ref/c/func/AuthorizationFreeItemSet" title="AuthorizationFreeItemSet"></a><a name="//apple_ref/doc/c_ref/AuthorizationFreeItemSet" title="AuthorizationFreeItemSet"></a><a name="//apple_ref/doc/uid/TP30000826-CH1g-F17553" title="AuthorizationFreeItemSet"></a>
<a name="//apple_ref/doc/uid/TP30000826-CH1g-DontLinkElementID_14"></a><h3 class="tight">AuthorizationFreeItemSet</h3>
<p class="spaceabove">Frees the memory associated with an authorization set.</p>
<p class="spaceabove"><pre>
OSStatus AuthorizationFreeItemSet (
   <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationItemSet">AuthorizationItemSet</a> *set
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>set</em></dt>
<dd><p>A pointer to the authorization set to free.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p> A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP30000826-CH4g-CJBEABHG">“Authorization Services Result Codes.”</a></span></p>
<h5 class="tight">Discussion</h5>
<p>When your application no longer needs the authorization item sets created by the Security Server in the AuthorizationCopyRights and AuthorizationCopyInfo functions, you should call this function to free it.</p>
<h5 class="tight">Availability</h5><ul class="availability">
<li class="availability">Available in Mac OS X v10.0 and later.</li></ul><h5 class="tight">Declared In</h5><code>Authorization.h</code><a name="//apple_ref/c/func/AuthorizationMakeExternalForm" title="AuthorizationMakeExternalForm"></a><a name="//apple_ref/doc/c_ref/AuthorizationMakeExternalForm" title="AuthorizationMakeExternalForm"></a><a name="//apple_ref/doc/uid/TP30000826-CH1g-F17551" title="AuthorizationMakeExternalForm"></a>
<a name="//apple_ref/doc/uid/TP30000826-CH1g-DontLinkElementID_15"></a><h3 class="tight">AuthorizationMakeExternalForm</h3>
<p class="spaceabove">Creates an external representation of an authorization reference.</p>
<p class="spaceabove"><pre>
OSStatus AuthorizationMakeExternalForm (
   <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationRef">AuthorizationRef</a> authorization,
   <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationExternalForm">AuthorizationExternalForm</a> *extForm
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>authorization</em></dt>
<dd><p>An authorization reference referring to the authorization session.</p></dd>
<dt><em>extForm</em></dt>
<dd><p>A pointer to an external authorization reference. On return, this points to the external representation of the authorization reference.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p> A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP30000826-CH4g-CJBEABHG">“Authorization Services Result Codes.”</a></span></p>
<h5 class="tight">Discussion</h5>
<p>This function creates an external representation of an authorization reference so that you can transmit it between processes. Authorizations are bound by session, process, and time limits, so you cannot store the authorization reference for another process to use. Instead, you must create an external representation of the authorization reference and pass it securely to the other process. Use the function <code><a href="reference.html#//apple_ref/c/func/AuthorizationCreateFromExternalForm">AuthorizationCreateFromExternalForm</a></code> to internalize the external representation of the authorization reference.</p>
<p>If it is necessary for your application to perform some privileged operations, it is good programming practice to isolate all of the privileged operations in a separate process, referred to as a <em>helper tool</em> (see <em><a href="../../../Conceptual/authorization_concepts/index.html#//apple_ref/doc/uid/TP30000995" target="_top">Authorization Services Programming Guide</a></em> for details). In this case, you must pass your authorization reference to the helper tool so that Authorization Services can tell that the helper tool is operating on behalf of your application. Doing so allows the authorization dialog to show your application’s path rather than the path to the helper tool and it allows the system to determine whether the authorization dialog should have keyboard focus.</p>
<h5 class="tight">Availability</h5><ul class="availability">
<li class="availability">Available in Mac OS X v10.0 and later.</li></ul><h5 class="tight">Related Sample Code</h5><ul class="availability"><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/BSDLLCTest/index.html#//apple_ref/doc/uid/DTS10000692" target="_top">BSDLLCTest</a></span></li><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/MoreIsBetter/index.html#//apple_ref/doc/uid/DTS10000732" target="_top">MoreIsBetter</a></span></li><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/QISA/index.html#//apple_ref/doc/uid/DTS10000714" target="_top">QISA</a></span></li></ul><h5 class="tight">Declared In</h5><code>Authorization.h</code><a name="//apple_ref/c/func/AuthorizationRightGet" title="AuthorizationRightGet"></a><a name="//apple_ref/doc/c_ref/AuthorizationRightGet" title="AuthorizationRightGet"></a><a name="//apple_ref/doc/uid/TP30000826-CH1g-DontLinkElementID_1" title="AuthorizationRightGet"></a><a name="//apple_ref/doc/uid/TP30000826-CH1g-DontLinkElementID_16"></a><h3 class="tight">AuthorizationRightGet</h3>
<p class="spaceabove">Retrieves a right definition as a dictionary.</p>
<p class="spaceabove"><pre>
OSStatus AuthorizationRightGet (
   const char *rightName,
   <a href="../../../../CoreFoundation/Reference/CFDictionaryRef/Reference/reference.html#//apple_ref/doc/c_ref/CFDictionaryRef" target="_top">CFDictionaryRef</a> *rightDefinition
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>rightName</em></dt>
<dd><p>An ASCII character string representing the rightname. Wildcard right names are valid.</p></dd>
<dt><em>rightDefinition</em></dt>
<dd><p>A reference to a dictionary. On return, this points to a dictionary of keys that define the right. Passing <code>NULL</code> checks if the right is defined. You should release the memory used by the returned dictionary.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p> A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP30000826-CH4g-CJBEABHG">“Authorization Services Result Codes.”</a></span></p>
<h5 class="tight">Discussion</h5>
<p>You do not need an authorization reference to use this function because the policy database is world readable.</p>
<h5 class="tight">Availability</h5><ul class="availability">
<li class="availability">Available in Mac OS X v10.3 and later.</li></ul><h5 class="tight">Related Sample Code</h5><ul class="availability"><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/AuthForAll/index.html#//apple_ref/doc/uid/DTS10001084" target="_top">AuthForAll</a></span></li></ul><h5 class="tight">Declared In</h5><code>AuthorizationDB.h</code><a name="//apple_ref/c/func/AuthorizationRightRemove" title="AuthorizationRightRemove"></a><a name="//apple_ref/doc/c_ref/AuthorizationRightRemove" title="AuthorizationRightRemove"></a><a name="//apple_ref/doc/uid/TP30000826-CH1g-BCIGHHHH" title="AuthorizationRightRemove"></a>
<a name="//apple_ref/doc/uid/TP30000826-CH1g-DontLinkElementID_17"></a><h3 class="tight">AuthorizationRightRemove</h3>
<p class="spaceabove">Removes a right from the policy database.</p>
<p class="spaceabove"><pre>
OSStatus AuthorizationRightRemove (
   <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationRef">AuthorizationRef</a> authRef,
   const char *rightName
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>authRef</em></dt>
<dd><p>A valid authorization reference used to authorize modifications.</p></dd>
<dt><em>rightName</em></dt>
<dd><p>An ASCII character string representing the right name.  This function does not accept wildcard right names.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP30000826-CH4g-CJBEABHG">“Authorization Services Result Codes.”</a></span></p>
<h5 class="tight">Discussion</h5>
<p>The right you remove must be an explicit right with no wildcards. Wildcard rights are for use by system administrators for site configuration.</p>
<h5 class="tight">Availability</h5><ul class="availability">
<li class="availability">Available in Mac OS X v10.3 and later.</li></ul><h5 class="tight">Declared In</h5><code>AuthorizationDB.h</code><a name="//apple_ref/c/func/AuthorizationRightSet" title="AuthorizationRightSet"></a><a name="//apple_ref/doc/c_ref/AuthorizationRightSet" title="AuthorizationRightSet"></a><a name="//apple_ref/doc/uid/TP30000826-CH1g-BCIBGBIC" title="AuthorizationRightSet"></a>
<a name="//apple_ref/doc/uid/TP30000826-CH1g-DontLinkElementID_18"></a><h3 class="tight">AuthorizationRightSet</h3>
<p class="spaceabove">Creates or updates a right entry in the policy database.</p>
<p class="spaceabove"><pre>
OSStatus AuthorizationRightSet (
   <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationRef">AuthorizationRef</a> authRef,
   const char *rightName,
   <a href="../../../../CoreFoundation/Reference/CFTypeRef/Reference/reference.html#//apple_ref/doc/c_ref/CFTypeRef" target="_top">CFTypeRef</a> rightDefinition,
   <a href="../../../../CoreFoundation/Reference/CFStringRef/Reference/reference.html#//apple_ref/doc/c_ref/CFStringRef" target="_top">CFStringRef</a> descriptionKey,
   <a href="../../../../CoreFoundation/Reference/CFBundleRef/Reference/reference.html#//apple_ref/doc/c_ref/CFBundleRef" target="_top">CFBundleRef</a> bundle,
   <a href="../../../../CoreFoundation/Reference/CFStringRef/Reference/reference.html#//apple_ref/doc/c_ref/CFStringRef" target="_top">CFStringRef</a> localeTableName
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>authRef</em></dt>
<dd><p>A valid authorization reference used to authorize modifications.</p></dd>
<dt><em>rightName</em></dt>
<dd><p>An ASCII character string representing the right name.  The policy database does not accept wildcard right names.</p></dd>
<dt><em>rightDefinition</em></dt>
<dd><p>Either a CFDictionary containing keys defining the rules or a CFString representing the name of another right whose rules you wish to duplicate. See <code><a href="reference.html#//apple_ref/doc/constant_group/Policy_Database_Constants">Policy Database Constants</a></code> for some possible values.</p></dd>
<dt><em>descriptionKey</em></dt>
<dd><p>A CFString reference used as a key for looking up localized descriptions.  If no localization is found, this is the description itself. This parameter is optional; pass <code>NULL</code> if you do not require it.</p></dd>
<dt><em>bundle</em></dt>
<dd><p>A bundle to get localizations from if not the main bundle. This parameter is optional; pass <code>NULL</code> if you do not require it.</p></dd>
<dt><em>localeTableName</em></dt>
<dd><p>A CFString representing a table name from which to get localizations. This parameter is optional; pass <code>NULL</code> if you have no localizations or you wish to use the localizations available in Localizable.strings.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP30000826-CH4g-CJBEABHG">“Authorization Services Result Codes.”</a></span></p>
<h5 class="tight">Discussion</h5>
<p>The right you create must be an explicit right with no wildcards. Wildcard rights are for use by system administrators for site configuration.</p>
<p>You can use this function to create a new right or modify an existing right. For example,</p>
<div class="codesample"><table><tr><td scope="row"><pre>AuthorizationRightSet(NULL, "com.ifoo.ifax.send",<span></span></pre></td></tr><tr><td scope="row"><pre>CFSTR(kAuthorizationRuleIsAdmin), CFSTR("Authorize sending  of a fax"), NULL, NULL);<span></span></pre></td></tr></table></div>
<p>adds a rule for letting administrators send faxes. This example creates a right named <code>"com.ifoo.ifax.send"</code> and sets the rules to require the user to be an administrator by using the <code><a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationRuleIsAdmin">kAuthorizationRuleIsAdmin</a></code> constant. This example also sets a comment to let the system administrator know that the right authorizes administrators to send a fax.</p>
<p>To specify additional attributes for the right, you can pass an <code>CFDictionary</code> type in the <em>rightDefinition</em> parameter as shown in the following example.</p>
<div class="codesample"><table><tr><td scope="row"><pre>CFStringRef keys[2] = {CFSTR(kRightRule), CFSTR(kRightComment)};<span></span></pre></td></tr><tr><td scope="row"><pre>CFStringRef values[2] = {CFSTR(kAuthorizationRuleIsAdmin), CFSTR("authorizes  sending of 1 fax message")};<span></span></pre></td></tr><tr><td scope="row"><pre>CFDictionaryRef aDict;<span></span></pre></td></tr><tr><td scope="row"><pre>aDict = CFDictionaryCreate(NULL, (void *)keys, (void *)values, 2,  &amp;kCFCopyStringDictionaryKeyCallBacks, &amp;kCFTypeDictionaryValueCallBacks);<span></span></pre></td></tr><tr><td scope="row"><pre>AuthorizationRightSet(NULL, "com.ifoo.ifax.send", aDict,  CFSTR("Authorize sending  of a fax"), NULL, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>CFRelease(aDict);<span></span></pre></td></tr></table></div>
<p>This call creates the same right as before, but adds a specific right comment to the rules definition.</p>
<p>When you specify comments, you should be specific about what you need to authorize. For example, the means of proof required for <code><a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationRuleAuthenticateAsAdmin">kAuthorizationRuleAuthenticateAsAdmin</a></code> (a username and password) should not be included here since that rule might be configured differently.</p>
<h5 class="tight">Availability</h5><ul class="availability">
<li class="availability">Available in Mac OS X v10.3 and later.</li></ul><h5 class="tight">Related Sample Code</h5><ul class="availability"><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/AuthForAll/index.html#//apple_ref/doc/uid/DTS10001084" target="_top">AuthForAll</a></span></li></ul><h5 class="tight">Declared In</h5><code>AuthorizationDB.h</code><a name="//apple_ref/doc/uid/TP30000826-CH2g-140227" title="Data Types"></a><a name="//apple_ref/doc/uid/TP30000826-CH2g-TPXREF118" title="Data Types"></a><h2>Data Types</h2>
<a name="//apple_ref/c/tdef/AuthorizationEnvironment" title="AuthorizationEnvironment"></a><a name="//apple_ref/doc/c_ref/AuthorizationEnvironment" title="AuthorizationEnvironment"></a><a name="//apple_ref/doc/uid/TP30000826-CH2g-C017026" title="AuthorizationEnvironment"></a><a name="//apple_ref/doc/uid/TP30000826-CH2g-DontLinkElementID_19"></a><h3 class="tight">AuthorizationEnvironment</h3>
<p class="spaceabove">Represents a set of data about the environment, such as
user name and other information gathered during evaluation of authorization.</p>
<p class="spaceabove"><pre>
typedef <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationItemSet">AuthorizationItemSet</a> AuthorizationEnvironment;
</pre></p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li></ul><h5 class="tight">Declared In</h5><code>Authorization.h</code>
<a name="//apple_ref/c/tag/AuthorizationExternalForm" title="AuthorizationExternalForm"></a><a name="//apple_ref/doc/c_ref/AuthorizationExternalForm" title="AuthorizationExternalForm"></a><a name="//apple_ref/doc/uid/TP30000826-CH2g-C017024" title="AuthorizationExternalForm"></a>
<a name="//apple_ref/doc/uid/TP30000826-CH2g-DontLinkElementID_20"></a><h3 class="tight">AuthorizationExternalForm</h3>
<p class="spaceabove">The external representation of an authorization reference.</p>
<p class="spaceabove"><pre>
struct AuthorizationExternalForm {
   char bytes[kAuthorizationExternalFormLength];
};
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>bytes</code></dt>
<dd><p>An array of characters representing the external
form of an authorization reference.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>Authorization references are bound by session, process, and
time limits, so you cannot store the authorization references for
another process to use. Use the functions <code><a href="reference.html#//apple_ref/c/func/AuthorizationMakeExternalForm">AuthorizationMakeExternalForm</a></code> and <code><a href="reference.html#//apple_ref/c/func/AuthorizationCreateFromExternalForm">AuthorizationCreateFromExternalForm</a></code> to
externalize and internalize the authorization reference. Applications
should take care not to disclose the external authorization reference
to potential attackers since any process can use this external authorization
reference to access the authorization reference.</p>
<a name="//apple_ref/c/tdef/AuthorizationFlags" title="AuthorizationFlags"></a><a name="//apple_ref/doc/c_ref/AuthorizationFlags" title="AuthorizationFlags"></a><a name="//apple_ref/doc/uid/TP30000826-CH2g-BAJEBGDG" title="AuthorizationFlags"></a><a name="//apple_ref/doc/uid/TP30000826-CH2g-DontLinkElementID_21"></a><h3 class="tight">AuthorizationFlags</h3>
<p class="spaceabove">Represents a bit mask of authorization options.</p>
<p class="spaceabove"><pre>
typedef UInt32 AuthorizationFlags;
</pre></p>
<h5 class="tight">Discussion</h5>
<p>See <span class="content_text"><a href="reference.html#//apple_ref/doc/constant_group/Authorization_Options">“Authorization Options”</a></span> for a description of masks that you can use.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li></ul><h5 class="tight">Declared In</h5><code>Authorization.h</code>
<a name="//apple_ref/c/tdef/AuthorizationItem" title="AuthorizationItem"></a><a name="//apple_ref/doc/c_ref/AuthorizationItem" title="AuthorizationItem"></a><a name="//apple_ref/doc/uid/TP30000826-CH2g-C017021" title="AuthorizationItem"></a>
<a name="//apple_ref/doc/uid/TP30000826-CH2g-DontLinkElementID_22"></a><h3 class="tight">AuthorizationItem</h3>
<p class="spaceabove">Contains information about an authorization right or the
authorization environment.</p>
<p class="spaceabove"><pre>
typedef struct {
<a href="reference.html#//apple_ref/doc/c_ref/AuthorizationString">AuthorizationString</a> name;
UInt32 valueLength;
void *value;
UInt32 flags;
}AuthorizationItem;
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>name</code></dt>
<dd><p>The required name of the authorization right or
environment data. The name of a right is something that you create.
You should name rights in a style similar to Java package names.
For example, <code>&quot;com.myOrganization.myProduct.myRight&quot;</code>.
Set this field to <code>kAuthorizationRightExecute</code> when
requesting a right for use in the function <code><a href="reference.html#//apple_ref/c/func/AuthorizationExecuteWithPrivileges">AuthorizationExecuteWithPrivileges</a></code>.</p><p>See
the <code>Security.framework/Headers/AuthorizationTags.h</code> header
file for possible values for environment data.</p></dd>
<dt><code>valueLength</code></dt>
<dd><p>An unsigned 32-bit integer that represents the
number of bytes in the <code>value</code> field.
Set the <code>valueLength</code> field
to <code>0</code> if you set the <code>value</code> field
to <code>NULL</code>.</p></dd>
<dt><code>value</code></dt>
<dd><p>A pointer to information pertaining to the <code>name</code> field.
For example, if the <code>name</code> field
is set to the value represented by the constant <code>kAuthorizationRightExecute</code>,
then set the <code>value</code> field
to the full POSIX pathname of the tool you want to execute. In most
other cases, set this field to <code>NULL</code>.</p></dd>
<dt><code>flags</code></dt>
<dd><p>Reserved option bits. Set to <code>0</code>. </p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>When using an authorization item to contain a right, set the <code>name</code> field
to the name of the right&#8212;for example, <code>&quot;com.myOrganization.myProduct.myRight&quot;</code>,
the <code>valueLength</code> and <code>flags</code> fields
to <code>0</code>, and the <code>value</code> field
to <code>NULL</code>. For more information
on naming rights, read <em><a href="../../../Conceptual/authorization_concepts/index.html#//apple_ref/doc/uid/TP30000995" target="_top">Authorization Services Programming Guide</a></em></p>
<p>When using an authorization item for the <code>AuthorizationExecuteWithPrivileges</code> function, set
the <code>name</code> field to <code>kAuthorizationRightExecute</code>,
and the <code>flags</code> field to <code>0</code>.
Set the <code>value</code> field to
the full POSIX pathname of the tool to execute and the <code>valueLength</code> field
to the byte length of the value in the <code>value</code> field.</p>
<p>When using an authorization item to contain environment data,
set the <code>name</code> field to
the name of the environment data&#8212;for example, <code>kAuthorizationEnvironmentUsername</code>&#8212;and the <code>flags</code> field
to <code>0</code>. Set the <code>value</code> field,
in this case, to the actual user name and the <code>valueLength</code> field
to the byte length of the value in the <code>value</code> field.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li></ul><h5 class="tight">Declared In</h5><code>Authorization.h</code>
<a name="//apple_ref/c/tdef/AuthorizationItemSet" title="AuthorizationItemSet"></a><a name="//apple_ref/doc/c_ref/AuthorizationItemSet" title="AuthorizationItemSet"></a><a name="//apple_ref/doc/uid/TP30000826-CH2g-C017022" title="AuthorizationItemSet"></a>
<a name="//apple_ref/doc/uid/TP30000826-CH2g-DontLinkElementID_23"></a><h3 class="tight">AuthorizationItemSet</h3>
<p class="spaceabove">Represents a set of authorization items.</p>
<p class="spaceabove"><pre>
typedef struct {
UInt32 count;
<a href="reference.html#//apple_ref/doc/c_ref/AuthorizationItem">AuthorizationItem</a> *items;
}AuthorizationItemSet;
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>count</code></dt>
<dd><p>The number of elements in the <code>items</code> array.</p></dd>
<dt><code>items</code></dt>
<dd><p>A pointer to an array of authorization items.
If <code>count</code> is greater than <code>1</code>, <code>items</code> points
to the first item in an array of such items. You should set this parameter
to <code>NULL</code> if there are
no items.</p></dd></dl><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li></ul><h5 class="tight">Declared In</h5><code>Authorization.h</code>
<a name="//apple_ref/c/tdef/AuthorizationRef" title="AuthorizationRef"></a><a name="//apple_ref/doc/c_ref/AuthorizationRef" title="AuthorizationRef"></a><a name="//apple_ref/doc/uid/TP30000826-CH2g-C017018" title="AuthorizationRef"></a><a name="//apple_ref/doc/uid/TP30000826-CH2g-DontLinkElementID_24"></a><h3 class="tight">AuthorizationRef</h3>
<p class="spaceabove">Represents a pointer to an opaque authorization reference
structure.</p>
<p class="spaceabove"><pre>
typedef const struct <!--a-->AuthorizationOpaqueRef<!--/a-->* AuthorizationRef;
</pre></p>
<h5 class="tight">Discussion</h5>
<p>This data type points to a structure the Security Server uses
to store information about the authorization session. Use the functions
described in <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP30000826-CH1g-279356">“Authorization Services Functions”</a></span> to create, access, and free the
authorization reference.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li></ul><h5 class="tight">Declared In</h5><code>Authorization.h</code>
<a name="//apple_ref/c/tdef/AuthorizationRights" title="AuthorizationRights"></a><a name="//apple_ref/doc/c_ref/AuthorizationRights" title="AuthorizationRights"></a><a name="//apple_ref/doc/uid/TP30000826-CH2g-C017025" title="AuthorizationRights"></a><a name="//apple_ref/doc/uid/TP30000826-CH2g-DontLinkElementID_25"></a><h3 class="tight">AuthorizationRights</h3>
<p class="spaceabove">Represents a set of authorization rights.</p>
<p class="spaceabove"><pre>
typedef <a href="reference.html#//apple_ref/doc/c_ref/AuthorizationItemSet">AuthorizationItemSet</a> AuthorizationRights;
</pre></p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li></ul><h5 class="tight">Declared In</h5><code>Authorization.h</code>
<a name="//apple_ref/c/tdef/AuthorizationString" title="AuthorizationString"></a><a name="//apple_ref/doc/c_ref/AuthorizationString" title="AuthorizationString"></a><a name="//apple_ref/doc/uid/TP30000826-CH2g-C017020" title="AuthorizationString"></a><a name="//apple_ref/doc/uid/TP30000826-CH2g-DontLinkElementID_26"></a><h3 class="tight">AuthorizationString</h3>
<p class="spaceabove">Represents a zero-terminated string in UTF-8 encoding.</p>
<p class="spaceabove"><pre>
typedef const char* AuthorizationString;
</pre></p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li></ul><h5 class="tight">Declared In</h5><code>Authorization.h</code><a name="//apple_ref/doc/uid/TP30000826-CH3g-248836" title="Constants"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-TPXREF119" title="Constants"></a><h2>Constants</h2>
<a name="//apple_ref/doc/constant_group/Authorization_Options" title="Authorization Options" role="Enum"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-C017016" title="Authorization Options" role="Enum"></a>
<a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_27"></a><h3 class="tight">Authorization Options</h3>
<p class="spaceabove">Define valid authorization options.</p>
<p class="spaceabove"><pre>
   
enum {
   <a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationFlagDefaults">kAuthorizationFlagDefaults</a> = 0,
   <a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationFlagInteractionAllowed">kAuthorizationFlagInteractionAllowed</a> = (1 &lt;&lt; 0),
   <a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationFlagExtendRights">kAuthorizationFlagExtendRights</a> = (1 &lt;&lt; 1),
   <a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationFlagPartialRights">kAuthorizationFlagPartialRights</a> = (1 &lt;&lt; 2),
   <a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationFlagDestroyRights">kAuthorizationFlagDestroyRights</a> = (1 &lt;&lt; 3),
   <a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationFlagPreAuthorize">kAuthorizationFlagPreAuthorize</a> = (1 &lt;&lt; 4),
   <a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationFlagNoData">kAuthorizationFlagNoData</a> = (1 &lt;&lt; 20)
};
</pre></p>
<h5 class="tight">Constants</h5><dl class="termdef">
<a name="//apple_ref/c/econst/kAuthorizationFlagDefaults" title="kAuthorizationFlagDefaults"></a><a name="//apple_ref/doc/c_ref/kAuthorizationFlagDefaults" title="kAuthorizationFlagDefaults"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_28"></a><dt><code>kAuthorizationFlagDefaults</code></dt>
<dd><p>If no bits are set, none of the following features
are available.</p><p>Available in Mac OS X v10.0 and later.</p><p>Declared in <code>Authorization.h</code>.</p></dd>
<a name="//apple_ref/c/econst/kAuthorizationFlagInteractionAllowed" title="kAuthorizationFlagInteractionAllowed"></a><a name="//apple_ref/doc/c_ref/kAuthorizationFlagInteractionAllowed" title="kAuthorizationFlagInteractionAllowed"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_29"></a><dt><code>kAuthorizationFlagInteractionAllowed</code></dt>
<dd><p>If the bit specified by this mask is set, you
permit the Security Server to interact with the user when necessary.</p><p>Available in Mac OS X v10.0 and later.</p><p>Declared in <code>Authorization.h</code>.</p></dd>
<a name="//apple_ref/c/econst/kAuthorizationFlagExtendRights" title="kAuthorizationFlagExtendRights"></a><a name="//apple_ref/doc/c_ref/kAuthorizationFlagExtendRights" title="kAuthorizationFlagExtendRights"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_30"></a><dt><code>kAuthorizationFlagExtendRights</code></dt>
<dd><p>If the bit specified by this mask is set, the
Security Server attempts to grant the rights requested. Once the
Security Server denies one right, it ignores the remaining requested
rights.				</p><p>Available in Mac OS X v10.0 and later.</p><p>Declared in <code>Authorization.h</code>.</p></dd>
<a name="//apple_ref/c/econst/kAuthorizationFlagPartialRights" title="kAuthorizationFlagPartialRights"></a><a name="//apple_ref/doc/c_ref/kAuthorizationFlagPartialRights" title="kAuthorizationFlagPartialRights"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_31"></a><dt><code>kAuthorizationFlagPartialRights</code></dt>
<dd><p>If the bit specified by this mask and the <code>kAuthorizationFlagExtendRights</code> mask
are set, the Security Server grants or denies rights on an individual basis
and all rights are checked.</p><p>Available in Mac OS X v10.0 and later.</p><p>Declared in <code>Authorization.h</code>.</p></dd>
<a name="//apple_ref/c/econst/kAuthorizationFlagDestroyRights" title="kAuthorizationFlagDestroyRights"></a><a name="//apple_ref/doc/c_ref/kAuthorizationFlagDestroyRights" title="kAuthorizationFlagDestroyRights"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_32"></a><dt><code>kAuthorizationFlagDestroyRights</code></dt>
<dd><p>If the bit specified by this mask is set, the
Security Server revokes authorization from the process as well as
from any other process that is sharing the authorization. If the
bit specified by this mask is not set, the Security Server revokes
authorization from the process but not from other processes that
share the authorization.</p><p>Available in Mac OS X v10.0 and later.</p><p>Declared in <code>Authorization.h</code>.</p></dd>
<a name="//apple_ref/c/econst/kAuthorizationFlagPreAuthorize" title="kAuthorizationFlagPreAuthorize"></a><a name="//apple_ref/doc/c_ref/kAuthorizationFlagPreAuthorize" title="kAuthorizationFlagPreAuthorize"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_33"></a><dt><code>kAuthorizationFlagPreAuthorize</code></dt>
<dd><p>If the bit specified by this mask is set, the
Security Server preauthorizes the rights requested.</p><p>Available in Mac OS X v10.0 and later.</p><p>Declared in <code>Authorization.h</code>.</p></dd>
<a name="//apple_ref/c/econst/kAuthorizationFlagNoData" title="kAuthorizationFlagNoData"></a><a name="//apple_ref/doc/c_ref/kAuthorizationFlagNoData" title="kAuthorizationFlagNoData"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_34"></a><dt><code>kAuthorizationFlagNoData</code></dt>
<dd><p>Private bits. Do not use.</p><p>Available in Mac OS X v10.0 and later.</p><p>Declared in <code>Authorization.h</code>.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The bits represented by these masks instruct the Security
Server how to proceed with the function in which you pass them.
Set all unused bits to <code>0</code> to
allow for future expansion.</p>
<a name="//apple_ref/doc/constant_group/Authorization_Rights_Mask" title="Authorization Rights Mask" role="Enum"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-C017017" title="Authorization Rights Mask" role="Enum"></a>
<a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_35"></a><h3 class="tight">Authorization Rights Mask</h3>
<p class="spaceabove">Defines values the Security Server sets in an authorization
item&#8217;s <code>flag</code> field.</p>
<p class="spaceabove"><pre>
enum {
   <a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationFlagCanNotPreAuthorize">kAuthorizationFlagCanNotPreAuthorize</a> = (1 &lt;&lt; 0)
};
</pre></p>
<h5 class="tight">Constants</h5><dl class="termdef">
<a name="//apple_ref/c/econst/kAuthorizationFlagCanNotPreAuthorize" title="kAuthorizationFlagCanNotPreAuthorize"></a><a name="//apple_ref/doc/c_ref/kAuthorizationFlagCanNotPreAuthorize" title="kAuthorizationFlagCanNotPreAuthorize"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_36"></a><dt><code>kAuthorizationFlagCanNotPreAuthorize</code></dt>
<dd><p>Indicates the Security Server could not preauthorize
the right.</p><p>Available in Mac OS X v10.0 and later.</p><p>Declared in <code>Authorization.h</code>.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<a name="//apple_ref/doc/constant_group/Empty_Environment" title="Empty Environment" role="PoundDefineGroup"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-EmptyEnvironment" title="Empty Environment" role="PoundDefineGroup"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_37"></a><h3 class="tight">Empty Environment</h3>
<p class="spaceabove">Defines an empty environment.</p>
<p class="spaceabove"><pre>
#define <a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationEmptyEnvironment">kAuthorizationEmptyEnvironment</a> <!--a-->NULL<!--/a-->
</pre></p>
<h5 class="tight">Constants</h5><dl class="termdef">
<a name="//apple_ref/c/macro/kAuthorizationEmptyEnvironment" title="kAuthorizationEmptyEnvironment"></a><a name="//apple_ref/doc/c_ref/kAuthorizationEmptyEnvironment" title="kAuthorizationEmptyEnvironment"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_38"></a><dt><code>kAuthorizationEmptyEnvironment</code></dt>
<dd><p>Indicates an empty environment. You should
pass this constant in functions with an environment parameter if
you have no environment data to provide.</p><p>Available in Mac OS X v10.0 and later.</p><p>Declared in <code>Authorization.h</code>.</p></dd></dl>
<a name="//apple_ref/doc/constant_group/External_Authorization_Reference_Length" title="External Authorization Reference Length" role="Enum"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-C017023" title="External Authorization Reference Length" role="Enum"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_39"></a><h3 class="tight">External Authorization Reference Length</h3>
<p class="spaceabove">Defines the byte length of the external authorization
reference.</p>
<p class="spaceabove"><pre>
enum {
   <a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationExternalFormLength">kAuthorizationExternalFormLength</a> = 32
};
</pre></p>
<h5 class="tight">Constants</h5><dl class="termdef">
<a name="//apple_ref/c/econst/kAuthorizationExternalFormLength" title="kAuthorizationExternalFormLength"></a><a name="//apple_ref/doc/c_ref/kAuthorizationExternalFormLength" title="kAuthorizationExternalFormLength"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_40"></a><dt><code>kAuthorizationExternalFormLength</code></dt>
<dd><p>Indicates, in number of bytes, the length of
the array in the <code><a href="reference.html#//apple_ref/c/tag/AuthorizationExternalForm">AuthorizationExternalForm</a></code> structure.</p><p>Available in Mac OS X v10.0 and later.</p><p>Declared in <code>Authorization.h</code>.</p></dd></dl>
<a name="//apple_ref/doc/constant_group/Name_Tags" title="Name Tags" role="PoundDefineGroup"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-NameTags" title="Name Tags" role="PoundDefineGroup"></a>
<a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_41"></a><h3 class="tight">Name Tags</h3>
<p class="spaceabove">Specify the type of environment data or right.</p>
<p class="spaceabove"><pre>
   #define <a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationEnvironmentUsername">kAuthorizationEnvironmentUsername</a> <!--a-->&quot<!--/a-->;username&quot;
#define <a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationEnvironmentPassword">kAuthorizationEnvironmentPassword</a> <!--a-->&quot<!--/a-->;password&quot;
#define <a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationEnvironmentShared">kAuthorizationEnvironmentShared</a> <!--a-->&quot<!--/a-->;shared&quot;
#define <a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationRightExecute">kAuthorizationRightExecute</a> <!--a-->&quot<!--/a-->;system.privilege.admin&quot;
#define <a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationEnvironmentPrompt">kAuthorizationEnvironmentPrompt</a> <!--a-->&quot<!--/a-->;prompt&quot;
#define <a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationEnvironmentIcon">kAuthorizationEnvironmentIcon</a> <!--a-->&quot<!--/a-->;icon&quot;
</pre></p>
<h5 class="tight">Constants</h5><dl class="termdef">
<a name="//apple_ref/c/macro/kAuthorizationEnvironmentUsername" title="kAuthorizationEnvironmentUsername"></a><a name="//apple_ref/doc/c_ref/kAuthorizationEnvironmentUsername" title="kAuthorizationEnvironmentUsername"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_42"></a><dt><code>kAuthorizationEnvironmentUsername</code></dt>
<dd><p>Specifies a user name.</p><p>Available in Mac OS X v10.0 and later.</p><p>Declared in <code>AuthorizationTags.h</code>.</p></dd>
<a name="//apple_ref/c/macro/kAuthorizationEnvironmentPassword" title="kAuthorizationEnvironmentPassword"></a><a name="//apple_ref/doc/c_ref/kAuthorizationEnvironmentPassword" title="kAuthorizationEnvironmentPassword"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_43"></a><dt><code>kAuthorizationEnvironmentPassword</code></dt>
<dd><p>Specifies a password.</p><p>Available in Mac OS X v10.0 and later.</p><p>Declared in <code>AuthorizationTags.h</code>.</p></dd>
<a name="//apple_ref/c/macro/kAuthorizationEnvironmentShared" title="kAuthorizationEnvironmentShared"></a><a name="//apple_ref/doc/c_ref/kAuthorizationEnvironmentShared" title="kAuthorizationEnvironmentShared"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_44"></a><dt><code>kAuthorizationEnvironmentShared</code></dt>
<dd><p>Specifies a shared right.</p><p>Available in Mac OS X v10.0 and later.</p><p>Declared in <code>AuthorizationTags.h</code>.</p></dd>
<a name="//apple_ref/c/macro/kAuthorizationRightExecute" title="kAuthorizationRightExecute"></a><a name="//apple_ref/doc/c_ref/kAuthorizationRightExecute" title="kAuthorizationRightExecute"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_45"></a><dt><code>kAuthorizationRightExecute</code></dt>
<dd><p>Specifies the name of the right associated
with the function <code><a href="reference.html#//apple_ref/c/func/AuthorizationExecuteWithPrivileges">AuthorizationExecuteWithPrivileges</a></code>.</p><p>Available in Mac OS X v10.0 and later.</p><p>Declared in <code>AuthorizationTags.h</code>.</p></dd>
<a name="//apple_ref/c/macro/kAuthorizationEnvironmentPrompt" title="kAuthorizationEnvironmentPrompt"></a><a name="//apple_ref/doc/c_ref/kAuthorizationEnvironmentPrompt" title="kAuthorizationEnvironmentPrompt"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_46"></a><dt><code>kAuthorizationEnvironmentPrompt</code></dt>
<dd><p>Specifies the name of the authorization
item that should be passed into the environment when specifying
invocation-specific additional text. The value should be a localized
UTF8 string.</p><p>Available in Mac OS X v10.3 and later.</p><p>Declared in <code>AuthorizationTags.h</code>.</p></dd>
<a name="//apple_ref/c/macro/kAuthorizationEnvironmentIcon" title="kAuthorizationEnvironmentIcon"></a><a name="//apple_ref/doc/c_ref/kAuthorizationEnvironmentIcon" title="kAuthorizationEnvironmentIcon"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_47"></a><dt><code>kAuthorizationEnvironmentIcon</code></dt>
<dd><p>Specifies the name of the authorization
item that should be passed into the environment when specifying
an alternate icon.  The value should be a full path to an image
compatible with the <code>NSImage</code> class.</p><p>Available in Mac OS X v10.3 and later.</p><p>Declared in <code>AuthorizationTags.h</code>.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>These tags are possible values for the <code>name</code> field
of an authorization item. This is not an all-inclusive set. You
determine the name of the right to request. These environment tags are
for future use.</p>
<a name="//apple_ref/doc/constant_group/Policy_Database_Constants" title="Policy Database Constants" role="PoundDefineGroup"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-BCIBFGAJ" title="Policy Database Constants" role="PoundDefineGroup"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_48"></a><h3 class="tight">Policy Database Constants</h3>
<p class="spaceabove">Defines constants for use in settting rights and rules
in the policy database.</p>
<p class="spaceabove"><pre>
#define <a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationRightRule">kAuthorizationRightRule</a> <!--a-->&quot<!--/a-->;rule&quot;
#define <a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationRuleIsAdmin">kAuthorizationRuleIsAdmin</a> <!--a-->&quot<!--/a-->;is-admin&quot;
#define <a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationRuleAuthenticateAsAdmin">kAuthorizationRuleAuthenticateAsAdmin</a> <!--a-->&quot<!--/a-->;authenticate-admin&quot;
#define <a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationRuleAuthenticateAsSessionUser">kAuthorizationRuleAuthenticateAsSessionUser</a> <!--a-->&quot<!--/a-->;authenticate-session-user&quot;
#define kAuthorizationRuleClassAllow "allow"
#define kAuthorizationRuleClassDeny "deny"
#define <a href="reference.html#//apple_ref/doc/c_ref/kAuthorizationComment">kAuthorizationComment</a> <!--a-->&quot<!--/a-->;comment"
</pre></p>
<h5 class="tight">Constants</h5><dl class="termdef">
<a name="//apple_ref/c/macro/kAuthorizationRightRule" title="kAuthorizationRightRule"></a><a name="//apple_ref/doc/c_ref/kAuthorizationRightRule" title="kAuthorizationRightRule"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_49"></a><dt><code>kAuthorizationRightRule</code></dt>
<dd><p>Indicates a rule delegation key.  Instead
of specifying exact behavior, some rules are shipped with the system
and may be used as delegate rules. Use this with any of the delegate
rule definition constants.</p><p>Available in Mac OS X v10.3 and later.</p><p>Declared in <code>AuthorizationDB.h</code>.</p></dd>
<a name="//apple_ref/c/macro/kAuthorizationRuleIsAdmin" title="kAuthorizationRuleIsAdmin"></a><a name="//apple_ref/doc/c_ref/kAuthorizationRuleIsAdmin" title="kAuthorizationRuleIsAdmin"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_50"></a><dt><code>kAuthorizationRuleIsAdmin</code></dt>
<dd><p>Indicates a delegate rule definition constant
specifying that the user must be an administrator.</p><p>Available in Mac OS X v10.3 and later.</p><p>Declared in <code>AuthorizationDB.h</code>.</p></dd>
<a name="//apple_ref/c/macro/kAuthorizationRuleAuthenticateAsAdmin" title="kAuthorizationRuleAuthenticateAsAdmin"></a><a name="//apple_ref/doc/c_ref/kAuthorizationRuleAuthenticateAsAdmin" title="kAuthorizationRuleAuthenticateAsAdmin"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_51"></a><dt><code>kAuthorizationRuleAuthenticateAsAdmin</code></dt>
<dd><p>Indicates a delegate rule definition constant
specifying that the user must authenticate as an administrator.</p><p>Available in Mac OS X v10.3 and later.</p><p>Declared in <code>AuthorizationDB.h</code>.</p></dd>
<a name="//apple_ref/c/macro/kAuthorizationRuleAuthenticateAsSessionUser" title="kAuthorizationRuleAuthenticateAsSessionUser"></a><a name="//apple_ref/doc/c_ref/kAuthorizationRuleAuthenticateAsSessionUser" title="kAuthorizationRuleAuthenticateAsSessionUser"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_52"></a><dt><code>kAuthorizationRuleAuthenticateAsSessionUser</code></dt>
<dd><p>Indicates a delegate rule definition constant
specifying that the user must authenticate as the session owner
(logged-in user).</p><p>Available in Mac OS X v10.3 and later.</p><p>Declared in <code>AuthorizationDB.h</code>.</p></dd>
<a name="//apple_ref/c/macro/kAuthorizationRuleClassAllow" title="kAuthorizationRuleClassAllow"></a><a name="//apple_ref/doc/c_ref/kAuthorizationRuleClassAllow" title="kAuthorizationRuleClassAllow"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_53"></a><dt><code>kAuthorizationRuleClassAllow</code></dt>
<dd><p>Indicates a delegate rule definition constant
that always allows the specified right.</p><p>Available in Mac OS X v10.3 and later.</p><p>Declared in <code>AuthorizationDB.h</code>.</p></dd>
<a name="//apple_ref/c/macro/kAuthorizationRuleClassDeny" title="kAuthorizationRuleClassDeny"></a><a name="//apple_ref/doc/c_ref/kAuthorizationRuleClassDeny" title="kAuthorizationRuleClassDeny"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_54"></a><dt><code>kAuthorizationRuleClassDeny</code></dt>
<dd><p>Indicates a deleage rule definition constant
that always denies the specified right.</p><p>Available in Mac OS X v10.3 and later.</p><p>Declared in <code>AuthorizationDB.h</code>.</p></dd>
<a name="//apple_ref/c/macro/kAuthorizationComment" title="kAuthorizationComment"></a><a name="//apple_ref/doc/c_ref/kAuthorizationComment" title="kAuthorizationComment"></a><a name="//apple_ref/doc/uid/TP30000826-CH3g-DontLinkElementID_55"></a><dt><code>kAuthorizationComment</code></dt>
<dd><p>Indicates comments for a rule. The comments
appear in the policy database for the administrator to understand
what the rule is for. Rule comments are not the same as localized
descriptions which are presented to the user.</p><p>Available in Mac OS X v10.3 and later.</p><p>Declared in <code>AuthorizationDB.h</code>.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>You can use these constants when creating or modifying a rule
in the policy database using the <code><a href="reference.html#//apple_ref/c/func/AuthorizationRightSet">AuthorizationRightSet</a></code> function.</p><a name="//apple_ref/doc/uid/TP30000826-CH4g-CJBEABHG" title="Result Codes"></a><h2><a name="//apple_ref/doc/uid/TP30000826-CH4g-249375" title="Result Codes"></a><a name="//apple_ref/doc/uid/TP30000826-CH4g-TPXREF120" title="Result Codes"></a>Result Codes</h2>
<p>The most common result codes returned by the Security Server
are listed in the table below.</p>



<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><tr><th scope="col" align="left"><strong>Result Code</strong></th><th scope="col" align="left"><strong>Value</strong></th><th scope="col" align="left"><strong>Description</strong></th></tr>
<tr>
<a name="//apple_ref/doc/uid/TP30000826-CH4g-DontLinkElementID_56"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errAuthorizationSuccess" title="errAuthorizationSuccess"></a><a name="//apple_ref/doc/c_ref/errAuthorizationSuccess" title="errAuthorizationSuccess"></a><code>errAuthorizationSuccess</code></td>
<td align="right" valign="top" class="content_text noWrap">0</td>

<td valign="top" class="content_text"><p>The operation completed successfully.</p><p>Available in Mac OS X v10.0 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP30000826-CH4g-DontLinkElementID_57"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errAuthorizationInvalidSet" title="errAuthorizationInvalidSet"></a><a name="//apple_ref/doc/c_ref/errAuthorizationInvalidSet" title="errAuthorizationInvalidSet"></a><code>errAuthorizationInvalidSet</code></td>
<td align="right" valign="top" class="content_text noWrap">-60001</td>

<td valign="top" class="content_text"><p>The <code>set</code> parameter
is invalid.</p><p>Available in Mac OS X v10.0 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP30000826-CH4g-DontLinkElementID_58"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errAuthorizationInvalidRef" title="errAuthorizationInvalidRef"></a><a name="//apple_ref/doc/c_ref/errAuthorizationInvalidRef" title="errAuthorizationInvalidRef"></a><code>errAuthorizationInvalidRef</code></td>
<td align="right" valign="top" class="content_text noWrap">-60002</td>

<td valign="top" class="content_text"><p>The <code>authorization</code> parameter is
invalid.</p><p>Available in Mac OS X v10.0 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP30000826-CH4g-DontLinkElementID_59"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errAuthorizationInvalidTag" title="errAuthorizationInvalidTag"></a><a name="//apple_ref/doc/c_ref/errAuthorizationInvalidTag" title="errAuthorizationInvalidTag"></a><code>errAuthorizationInvalidTag</code></td>
<td align="right" valign="top" class="content_text noWrap">-60003</td>

<td valign="top" class="content_text"><p>The <code>tag</code> parameter
is invalid.</p><p>Available in Mac OS X v10.0 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP30000826-CH4g-DontLinkElementID_60"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errAuthorizationInvalidPointer" title="errAuthorizationInvalidPointer"></a><a name="//apple_ref/doc/c_ref/errAuthorizationInvalidPointer" title="errAuthorizationInvalidPointer"></a><code>errAuthorizationInvalidPointer</code></td>
<td align="right" valign="top" class="content_text noWrap">-60004</td>

<td valign="top" class="content_text"><p>The <code>authorizedRights</code> parameter
is invalid.</p><p>Available in Mac OS X v10.0 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP30000826-CH4g-DontLinkElementID_61"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errAuthorizationDenied" title="errAuthorizationDenied"></a><a name="//apple_ref/doc/c_ref/errAuthorizationDenied" title="errAuthorizationDenied"></a><code>errAuthorizationDenied</code></td>
<td align="right" valign="top" class="content_text noWrap">-60005</td>

<td valign="top" class="content_text"><p>The Security Server denied authorization
for one or more requested rights. This error is also returned if
there was no definition found in the policy database, or a definition
could not be created. </p><p>Available in Mac OS X v10.0 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP30000826-CH4g-DontLinkElementID_62"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errAuthorizationCanceled" title="errAuthorizationCanceled"></a><a name="//apple_ref/doc/c_ref/errAuthorizationCanceled" title="errAuthorizationCanceled"></a><code>errAuthorizationCanceled</code></td>
<td align="right" valign="top" class="content_text noWrap">-60006</td>

<td valign="top" class="content_text"><p>The user canceled the operation.</p><p>Available in Mac OS X v10.0 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP30000826-CH4g-DontLinkElementID_63"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errAuthorizationInteractionNotAllowed" title="errAuthorizationInteractionNotAllowed"></a><a name="//apple_ref/doc/c_ref/errAuthorizationInteractionNotAllowed" title="errAuthorizationInteractionNotAllowed"></a><code>errAuthorizationInteractionNotAllowed</code></td>
<td align="right" valign="top" class="content_text noWrap">-60007</td>

<td valign="top" class="content_text"><p>The Security Server denied authorization
because no user interaction is allowed.</p><p>Available in Mac OS X v10.0 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP30000826-CH4g-DontLinkElementID_64"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errAuthorizationInternal" title="errAuthorizationInternal"></a><a name="//apple_ref/doc/c_ref/errAuthorizationInternal" title="errAuthorizationInternal"></a><code>errAuthorizationInternal</code></td>
<td align="right" valign="top" class="content_text noWrap">-60008</td>

<td valign="top" class="content_text"><p>An unrecognized internal error occurred.</p><p>Available in Mac OS X v10.0 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP30000826-CH4g-DontLinkElementID_65"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errAuthorizationExternalizeNotAllowed" title="errAuthorizationExternalizeNotAllowed"></a><a name="//apple_ref/doc/c_ref/errAuthorizationExternalizeNotAllowed" title="errAuthorizationExternalizeNotAllowed"></a><code>errAuthorizationExternalizeNotAllowed</code></td>
<td align="right" valign="top" class="content_text noWrap">-60009</td>

<td valign="top" class="content_text"><p>The Security Server denied externalization
of the authorization reference.</p><p>Available in Mac OS X v10.0 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP30000826-CH4g-DontLinkElementID_66"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errAuthorizationInternalizeNotAllowed" title="errAuthorizationInternalizeNotAllowed"></a><a name="//apple_ref/doc/c_ref/errAuthorizationInternalizeNotAllowed" title="errAuthorizationInternalizeNotAllowed"></a><code>errAuthorizationInternalizeNotAllowed</code></td>
<td align="right" valign="top" class="content_text noWrap">-60010</td>

<td valign="top" class="content_text"><p>The Security Server denied internalization
of the authorization reference.</p><p>Available in Mac OS X v10.0 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP30000826-CH4g-DontLinkElementID_67"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errAuthorizationInvalidFlags" title="errAuthorizationInvalidFlags"></a><a name="//apple_ref/doc/c_ref/errAuthorizationInvalidFlags" title="errAuthorizationInvalidFlags"></a><code>errAuthorizationInvalidFlags</code></td>
<td align="right" valign="top" class="content_text noWrap">-60011</td>

<td valign="top" class="content_text"><p>The <code>flags</code> parameter
is invalid.</p><p>Available in Mac OS X v10.0 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP30000826-CH4g-DontLinkElementID_68"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errAuthorizationToolExecuteFailure" title="errAuthorizationToolExecuteFailure"></a><a name="//apple_ref/doc/c_ref/errAuthorizationToolExecuteFailure" title="errAuthorizationToolExecuteFailure"></a><code>errAuthorizationToolExecuteFailure</code></td>
<td align="right" valign="top" class="content_text noWrap">-60031</td>

<td valign="top" class="content_text"><p>The tool failed to execute.</p><p>Available in Mac OS X v10.0 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP30000826-CH4g-DontLinkElementID_69"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errAuthorizationToolEnvironmentError" title="errAuthorizationToolEnvironmentError"></a><a name="//apple_ref/doc/c_ref/errAuthorizationToolEnvironmentError" title="errAuthorizationToolEnvironmentError"></a><code>errAuthorizationToolEnvironmentError</code></td>
<td align="right" valign="top" class="content_text noWrap">-60032</td>

<td valign="top" class="content_text"><p>The attempt to execute the tool failed to
return a success or an error code.</p><p>Available in Mac OS X v10.0 and later.</p></td></tr>
</table></div>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <!-- Previous button --><span style="margin-left: 8px"><a href="../appendixa/appendixa.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2002, 2005 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2005-11-08<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Security/Reference/authorization_ref/Reference/reference.html%3Fid%3DTP30000826-3.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Security/Reference/authorization_ref/Reference/reference.html%3Fid%3DTP30000826-3.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Security/Reference/authorization_ref/Reference/reference.html%3Fid%3DTP30000826-3.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>