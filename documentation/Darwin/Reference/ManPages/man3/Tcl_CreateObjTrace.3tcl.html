<html><head><title>Mac OS X Developer Tools
 Manual Page For Tcl_CreateObjTrace(3tcl)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/3tcl/Tcl_CreateObjTrace" title="Mac OS X Developer Tools
 Manual Page for Tcl_CreateObjTrace(3tcl)"><a name="//apple_ref/doc/man/3/Tcl_CreateObjTrace" title="Mac OS X Developer Tools
 Manual Page for Tcl_CreateObjTrace(3tcl)"><!-- headerDoc=man; indexgroup=Section 3tcl; uid="//apple_ref/doc/man/3tcl/Tcl_CreateObjTrace"; name=Tcl_CreateObjTrace(3tcl) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac&nbsp;OS&nbsp;X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>

<p style='text-align:justify;'>This manual page is associated with the Mac&nbsp;OS&nbsp;X
developer tools.  The software or headers described may not be present on your
Mac&nbsp;OS&nbsp;X installation until you install the developer tools
package.  This package is available on your Mac&nbsp;OS&nbsp;X installation DVD,
and the latest versions can be downloaded from
<a href="http://developer.apple.com/tools/download/">developer.apple.com</a>.</p>

<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
Tcl_CreateTrace(3)                         Tcl Library Procedures                         <a href="Tcl_CreateTrace.3tcl.html#//apple_ref/doc/man/3/Tcl_CreateTrace">Tcl_CreateTrace(3)</a>



____________________________________________________________________________________________________________

<b>NAME</b>
       Tcl_CreateTrace, Tcl_CreateObjTrace, Tcl_DeleteTrace - arrange for command execution to be traced

<b>SYNOPSIS</b>
       <b>#include</b> <b>&lt;tcl.h&gt;</b>

       Tcl_Trace
       <b>Tcl_CreateTrace</b>(<u>interp,</u> <u>level,</u> <u>proc,</u> <u>clientData</u>)

       Tcl_Trace
       <b>Tcl_CreateObjTrace</b>(<u>interp,</u> <u>level,</u> <u>flags,</u> <u>objProc,</u> <u>clientData,</u> <u>deleteProc</u>)

       <b>Tcl_DeleteTrace</b>(<u>interp,</u> <u>trace</u>)

<b>ARGUMENTS</b>
       Tcl_Interp                  <u>*interp</u>          (in)      Interpreter containing command to be traced or
                                                              untraced.

       int                         <u>level</u>            (in)      Only commands at or below this  nesting  level
                                                              will be traced unless 0 is specified.  1 means
                                                              top-level commands  only,  2  means  top-level
                                                              commands  or those that are invoked as immedi-<font color="#ffffff" class="whiteout">ate&nbsp;immediate</font>
                                                              ate consequences of executing  top-level  com-<font color="#ffffff" class="whiteout">mands&nbsp;commands</font>
                                                              mands  (procedure  bodies, bracketed commands,
                                                              etc.) and so on.  A value of 0 means that com-<font color="#ffffff" class="whiteout">mands&nbsp;commands</font>
                                                              mands at any level are traced.

       int                         <u>flags</u>            (in)      Flags  governing  the  trace  execution.   See
                                                              below for details.

       Tcl_CmdObjTraceProc         <u>*objProc</u>         (in)      Procedure to call for each command that's exe-<font color="#ffffff" class="whiteout">cuted.&nbsp;executed.</font>
                                                              cuted.   See  below for details of the calling
                                                              sequence.

       Tcl_CmdTraceProc            <u>*proc</u>            (in)      Procedure to call for each command that's exe-<font color="#ffffff" class="whiteout">cuted.&nbsp;executed.</font>
                                                              cuted.   See  below for details on the calling
                                                              sequence.

       ClientData                  <u>clientData</u>       (in)      Arbitrary one-word value to pass to <u>objProc</u> or
                                                              <u>proc</u>.

       Tcl_CmdObjTraceDeleteProc   <u>*deleteProc</u>                Procedure  to  call when the trace is deleted.
                                                              See below for details of the calling sequence.
                                                              A  NULL  pointer is permissible and results in
                                                              no callback when the trace is deleted.

       Tcl_Trace                   <u>trace</u>            (in)      Token for trace to be  removed  (return  value
                                                              from previous call to <b>Tcl_CreateTrace</b>).
____________________________________________________________________________________________________________

<b>DESCRIPTION</b>
       <b>Tcl_CreateObjTrace</b>  arranges for command tracing.  After it is called, <u>objProc</u> will be invoked before
       the Tcl interpreter calls any command procedure when evaluating commands in <u>interp</u>.  The return value
       from  <b>Tcl_CreateObjTrace</b>  is  a token for the trace, which may be passed to <b>Tcl_DeleteTrace</b> to remove
       the trace.  There may be many traces in effect simultaneously for the same interpreter.

       <u>objProc</u> should have arguments and result that match the type, <b>Tcl_CmdObjTraceProc</b>:
              typedef int <b>Tcl_CmdObjTraceProc</b>(
                  <b>ClientData</b> <u>clientData</u>,
                  <b>Tcl_Interp</b>* <u>interp</u>,
                  int <u>level</u>,
                  CONST char* <u>command</u>,
                  <b>Tcl_Command</b> <u>commandToken</u>,
                  int <u>objc</u>,
                  <b>Tcl_Obj</b> *CONST <u>objv</u>[] );
       The <u>clientData</u> and <u>interp</u> parameters are copies of the corresponding arguments given  to  <b>Tcl_Create</b>-<font color="#ffffff" class="whiteout">Trace.&nbsp;Tcl_CreateTrace.</font>
       <b>Trace</b>.   <u>ClientData</u> typically points to an application-specific data structure that describes what to
       do when <u>objProc</u> is invoked.  The <u>level</u> parameter gives the nesting level of the command (1  for  top-<font color="#ffffff" class="whiteout">level&nbsp;toplevel</font>
       level  commands  passed  to  <b>Tcl_Eval</b>  by  the  application,  2 for the next-level commands passed to
       <b>Tcl_Eval</b> as part of parsing or interpreting level-1 commands,  and  so  on).  The  <u>command</u>  parameter
       points  to  a  string containing the text of the command, before any argument substitution.  The <u>com</u>-<font color="#ffffff" class="whiteout">mandToken&nbsp;commandToken</font>
       <u>mandToken</u> parameter is a Tcl command token that identifies the command to be invoked.  The token  may
       be  passed  to  <b>Tcl_GetCommandName</b>, <b>Tcl_GetCommandTokenInfo</b>, or <b>Tcl_SetCommandTokenInfo</b> to manipulate
       the definition of the command. The <u>objc</u> and <u>objv</u> parameters designate the final parameter  count  and
       parameter vector that will be passed to the command, and have had all substitutions performed.

       The <u>objProc</u> callback is expected to return a standard Tcl status return code.  If this code is <b>TCL_OK</b>
       (the normal case), then the Tcl interpreter will invoke  the  command.   Any  other  return  code  is
       treated as if the command returned that status, and the command is <u>not</u> invoked.

       The <u>objProc</u> callback must not modify <u>objv</u> in any way.  It is, however, permissible to change the com-<font color="#ffffff" class="whiteout">mand&nbsp;command</font>
       mand by calling <b>Tcl_SetCommandTokenInfo</b> prior to returning.  Any such  change  takes  effect  immedi-<font color="#ffffff" class="whiteout">ately,&nbsp;immediately,</font>
       ately, and the command is invoked with the new information.

       Tracing will only occur for commands at nesting level less than or equal to the <u>level</u> parameter (i.e.
       the <u>level</u> parameter to <u>objProc</u> will always be less than or equal to the <u>level</u> parameter  to  <b>Tcl_Cre</b>-<font color="#ffffff" class="whiteout">ateTrace).&nbsp;Tcl_CreateTrace).</font>
       <b>ateTrace</b>).

       Tracing  has  a  significant effect on runtime performance because it causes the bytecode compiler to
       refrain from generating in-line code for Tcl commands such as <b>if</b> and <b>while</b> in order that they may  be
       traced.   If traces for the built-in commands are not required, the <u>flags</u> parameter may be set to the
       constant value <b>TCL_ALLOW_INLINE_COMPILATION</b>.  In this case, traces on built-in commands  may  or  may
       not  result  in  trace callbacks, depending on the state of the interpreter, but run-time performance
       will be improved significantly.  (This functionality is desirable, for example, when  using  <b>Tcl_Cre</b>-<font color="#ffffff" class="whiteout">ateObjTrace&nbsp;Tcl_CreateObjTrace</font>
       <b>ateObjTrace</b> to implement an execution time profiler.)

       Calls to <u>objProc</u> will be made by the Tcl parser immediately before it calls the command procedure for
       the command (<u>cmdProc</u>).  This occurs after argument parsing and substitution, so tracing  for  substi-<font color="#ffffff" class="whiteout">tuted&nbsp;substituted</font>
       tuted  commands  occurs  before  tracing of the commands containing the substitutions.  If there is a
       syntax error in a command, or if there is no command procedure associated with a command  name,  then
       no  tracing  will  occur for that command.  If a string passed to Tcl_Eval contains multiple commands
       (bracketed, or on different lines) then multiple calls to <u>objProc</u> will occur, one for each command.

       <b>Tcl_DeleteTrace</b> removes a trace, so that no future calls will be made  to  the  procedure  associated
       with the trace.  After <b>Tcl_DeleteTrace</b> returns, the caller should never again use the <u>trace</u> token.

       When <b>Tcl_DeleteTrace</b> is called, the interpreter invokes the <u>deleteProc</u> that was passed as a parameter
       to <b>Tcl_CreateObjTrace</b>.  The <u>deleteProc</u> must match the type, <b>Tcl_CmdObjTraceDeleteProc</b>:
              typedef void <b>Tcl_CmdObjTraceDeleteProc</b>(
                  <b>ClientData</b> <u>clientData</u>
              );
       The <u>clientData</u> parameter will be the same as the <u>clientData</u> parameter that was originally  passed  to
       <b>Tcl_CreateObjTrace</b>.

       <b>Tcl_CreateTrace</b>  is  an  alternative  interface for command tracing, <u>not</u> <u>recommended</u> <u>for</u> <u>new</u> <u>applica</u>-<font color="#ffffff" class="whiteout">tions.&nbsp;applications.</font>
       <u>tions</u>.  It is provided for backward compatibility with code that was developed for older versions  of
       the Tcl interpreter.  It is similar to <b>Tcl_CreateObjTrace</b>, except that its <u>proc</u> parameter should have
       arguments and result that match the type <b>Tcl_CmdTraceProc</b>:
              typedef void Tcl_CmdTraceProc(
                ClientData <u>clientData</u>,
                Tcl_Interp *<u>interp</u>,
                int <u>level</u>,
                char *<u>command</u>,
                Tcl_CmdProc *<u>cmdProc</u>,
                ClientData <u>cmdClientData</u>,
                int <u>argc</u>,
                CONST char *<u>argv</u>[]);
       The parameters to the <u>proc</u> callback are similar to those of the <u>objProc</u> callback above. The  <u>command</u>-<font color="#ffffff" class="whiteout">Token&nbsp;commandToken</font>
       <u>Token</u>  is  replaced  with  <u>cmdProc</u>,  a  pointer  to the (string-based) command procedure that will be
       invoked; and <u>cmdClientData</u>, the client data that will be passed to the procedure.  The <u>objc</u> parameter
       is  replaced  with  an  <u>argv</u> parameter, that gives the arguments to the command as character strings.
       <u>Proc</u> must not modify the <u>command</u> or <u>argv</u> strings.

       If a trace created with <b>Tcl_CreateTrace</b> is in effect, inline compilation of Tcl commands such  as  <b>if</b>
       and  <b>while</b> is always disabled.  There is no notification when a trace created with <b>Tcl_CreateTrace</b> is
       deleted.  There is no way to be notified when the trace created by <b>Tcl_CreateTrace</b> is deleted.  There
       is no way for the <u>proc</u> associated with a call to <b>Tcl_CreateTrace</b> to abort execution of <u>command</u>.

<b>KEYWORDS</b>
       command, create, delete, interpreter, trace



Tcl                                                                                       <a href="Tcl_CreateTrace.3tcl.html#//apple_ref/doc/man/3/Tcl_CreateTrace">Tcl_CreateTrace(3)</a>
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man3/Tcl_CreateObjTrace.3tcl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man3/Tcl_CreateObjTrace.3tcl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man3/Tcl_CreateObjTrace.3tcl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
