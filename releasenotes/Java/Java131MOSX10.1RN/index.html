<HTML><HEAD>   <TITLE>Java Release Notes</TITLE>   <META NAME=GENERATOR CONTENT="Claris Home Page 3.0">   <X-CLARIS-WINDOW TOP=44 BOTTOM=757 LEFT=4 RIGHT=534>   <X-CLARIS-TAGVIEW MODE=minimal></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/TP40001019"></a><!-- start of path --><font face="Geneva,Helvetica,Arial" size="1"><b>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="../../../documentation/index.html#//apple_ref/doc/uid/TP30000440" target="_top">Documentation</a> &gt; <a href="../../index.html#//apple_ref/doc/uid/TP30000872" target="_top">Release Notes</a></font></td><br><br><!-- end of path --><H1>Mac OS X 10.1.1 Release Notes:<BR>Java</H1><P>Mac OS X bundles Sun&#146;s Java 2 Standard Edition (J2SE). Thisversion is based on the Solaris Java Development Kit (JDK) version1.3.1, including the client version of HotSpot 1.3.1.</P><P>This version may be discussed in public forums like Apple&#146;s<A HREF="http://lists.apple.com/mailman/listinfo/java-dev">java-devmailing list</A> (preferred) or the <A HREF="news:comp.lang.java">comp.lang.java</A>newsgroups.</P><P>For more technical information about Java on Mac OS X, see<A HREF="../../../documentation/Java/index.html">JavaDeveloper Documentation.</A></P><H2><HR>Topics</H2><UL>	<LI><A HREF="#WhatsNew">What's New in Mac OS X 10.1.1</A></LI>   <LI><A HREF="#KnownIssues">Known issues with upgrade   installation</A></LI>      <LI><A HREF="#JavaVirtualMachine">Java Virtual Machine</A>      <UL>      <LI><A HREF="#Debugging">Debugging</A></LI>            <LI><A HREF="#Heap">Tuning the Heap Size</A></LI>            <LI><A HREF="#Profiling">Profiling tools</A></LI>            <LI><A HREF="#BuildingJNI">Building JNI libraries</A></LI>            <LI><A HREF="#BuildingNative">Building native applications that      launch Java</A></LI>   </UL>   </LI>      <LI><A HREF="#ClassLibs">AWT and other class libraries</A>      <UL>      <LI><A HREF="#WindowsAndDialogs">Windows and Dialogs</A></LI>            <LI><A HREF="#GraphicsAndJava2D">Graphics and Java2D</A></LI>            <LI><A HREF="#Swing">Swing</A></LI>            <LI><A HREF="#GUICustomization">GUI properties</A></LI>            <LI><A HREF="#PropertyPermissions">Permissions for property      access</A></LI>            <LI><A HREF="#FileDialogChanges">Changes to      java.awt.FileDialog</A></LI>            <LI><A HREF="#Sound">Sound</A></LI>   </UL>   </LI>      <LI><A HREF="#OtherAPI">Other APIs</A>      <UL>      <LI><A HREF="#JDirect">JDirect</A></LI>            <LI><A HREF="#JavaEmbedding">Java Embedding API</A></LI>            <LI><A HREF="#MRJToolkit">MRJToolkit</A></LI>   </UL>   </LI>      <LI><A HREF="#LaunchingAndPackaging">Developing, packaging, and   launching Java</A>      <UL>      <LI><A HREF="#JarLauncher">Jar files can now be launched      directly</A></LI>            <LI><A HREF="#JavaExtensions">Java extension locations</A></LI>            <LI><A HREF="#ProjectBuilder">Project Builder for Java</A></LI>            <LI><A HREF="#MRJAppBuilder">MRJAppBuilder</A></LI>            <LI><A HREF="#ConfiguringPackagedJava">Configuring packaged      Java applications</A></LI>            <LI><A HREF="#LocalizingJavaApps">Localizing packaged Java      applications on Mac OS X</A></LI>            <LI><A HREF="#DockNameAndIcon">Specifying Dock name &amp; icon      for command line Java applications</A></LI>            <LI><A HREF="#JavaWebStart">Java Web Start</A></LI>            <LI><A HREF="#AppletLauncher">Applet Launcher</A></LI>            <LI><A HREF="#LaunchingCommandLine">Launching java from the      command line</A></LI>   </UL>   </LI></UL><H2><HR><A NAME=WhatsNew></A>What's New in Mac OS X 10.1.1</H2><P>The Mac OS X 10.1.1 update addresses an Apple-specific issue in HotSpot with implicit or explicit use of java.lang.String.intern() and System.identityHashCode().</P><P>You can verify that this update has been applied by looking at the os.version system property (see <A HREF="#SystemProperties">System Properties</A>).</P><H2><HR><A NAME=KnownIssues></A>Known issues with upgrade installation</H2><P>If you install Mac OS X 10.1 over any version of Mac OS X 10.0,you should be aware of two limitations of the installer, and thesteps you can take to work around them.</P><H3>Java extensions not preserved</H3><P><I>Preferred locations for installing Java extensions havechanged. See </I><A HREF="#JavaExtensions"><I>Java extensionlocations</I></A><I> for more details. </I></P><P>Doing an update install with the User CD will not preserve anyfiles which you may have installed in <TT>$JAVA_HOME/lib/ext(/System/Library/Frameworks/JavaVM.framework/Versions/1.3/Home/lib/ext</TT>).Before you install, you should move these extensions to a safe place,and later reinstall them in the Local domain. If you did not saveyour extensions prior to installing, you will have to reinstall themfrom your original source disks or downloads. Be careful whenreinstalling extensions that you do not inadvertently reinstall olderversions of extensions which Apple has provided as part of Java onMac OS X 10.1.</P><H3>MRJAppBuilder is not upgraded</H3><P>The Developer CD update installer does not update MRJAppBuilder.To assure that MRJAppBuilder is properly installed, you should removeMRJAppBuilder from <TT>/Developer/Applications</TT> before runningthe installer on the Developer CD. If you have already run theinstaller, you can check the version of MRJAppBuilder to determinewhether the correct version has been installed. The correctMRJAppBuilder version is 1.1. The older version of MRJAppBuilder was10.0. If you still have the older version of MRJAppBuilder, remove itand then rerun the Installer on the Developer CD, selecting only theDeveloper Tools Software package.</P><H2><HR><A NAME=JavaVirtualMachine></A>Java Virtual Machine</H2><P>Mac OS X ships with the client version of the HotSpot virtualmachine from the JDK 1.3.1 technology train.</P><P>Some options available in prior VMs (e.g. JITC settings) are notapplicable to the HotSpot VM. In addition, HotSpot VM options are inthe "non-standard" group that are of the form<CODE>-X</CODE><I><CODE>optionname</CODE></I>. For a list of theseoptions, type <CODE>java -X</CODE> in a Terminal window.</P><P>The HotSpot VM&#146;s memory performance is excellent and itscompilation performance is very good in real-world applications, butthe engine has not been tuned for micro-benchmarks such asCaffeineMark.</P><P>Java threads are mapped directly to native Mach threads and aretherefore fully preemptive, even (unlike MRJ on Mac OS 9) with regardto the host application and other applications. Java threadpriorities are mapped to native thread priorities such that higherpriority threads will get preferentially scheduled. You should not,however, rely on any particular scheduling behavior other thanthat.</P><H3><A NAME=SystemProperties></A>System Properties</H3><P>Some notable Java system properties include:<FONT SIZE="-1"><TABLE BORDER=1 WIDTH="100%">   <TR>      <TD WIDTH="20%">         <P><FONT SIZE="-1"><B>Name</B></FONT></P>      </TD>      <TD WIDTH="15%">         <P><FONT SIZE="-1"><B>Value</B></FONT></P>      </TD>      <TD>         <P><FONT SIZE="-1"><B>Comments</B></FONT></P>      </TD>   </TR>   <TR>      <TD WIDTH="20%">         <P><FONT SIZE="-1"><CODE>os.name</CODE></FONT></P>      </TD>      <TD WIDTH="15%">         <P><FONT SIZE="-1"><CODE>Mac OS X</CODE></FONT></P>      </TD>      <TD>         <P><FONT SIZE="-1">This value was "Darwin" in early         pre-releases of Mac OS X, and "Mac OS" in MRJ on Mac OS 9.         It is suggested that you use         <CODE>System.getProperty("os.name").startsWith("Mac         OS")</CODE> if you need to test whether your code is running         on any version of Mac OS.</FONT></P>      </TD>   </TR>   <TR>      <TD WIDTH="20%">         <P><FONT SIZE="-1"><CODE>os.version</CODE></FONT></P>      </TD>      <TD WIDTH="15%">         <P><FONT SIZE="-1"><CODE>10.1.1</CODE></FONT></P>      </TD>      <TD>         <P><FONT SIZE="-1">This was "1.1" (the version number of the         Darwin kernel) in early pre-releases of Mac OS X.</FONT></P>      </TD>   </TR>   <TR>      <TD WIDTH="20%">         <P><FONT SIZE="-1"><CODE>mrj.version</CODE></FONT></P>      </TD>      <TD WIDTH="15%">         <P><FONT SIZE="-1"><CODE>3.1</CODE></FONT></P>      </TD>      <TD>         <P><FONT SIZE="-1">Testing for the existence of this         property is the general way to detect whether you are using         an Apple-developed JVM, although to detect specific features         like JDirect or MRJToolkit it is better to use reflection to         check for the existence of the specific classes they         use.</FONT></P>      </TD>   </TR>   <TR>      <TD WIDTH="20%">         <P><FONT SIZE="-1"><CODE>line.separator</CODE></FONT></P>      </TD>      <TD WIDTH="15%">         <P><FONT SIZE="-1"><CODE>'\n'</CODE></FONT></P>      </TD>      <TD>         <P><FONT SIZE="-1">This differs from MRJ on Mac OS 9, which         used '\r', but is consistent with Unix-based Java         implementations and with the BSD and Cocoa         frameworks.</FONT></P>      </TD>   </TR></TABLE> </FONT></P><H3>Locales and default locale</H3><P>Java on Mac OS X sets a default locale based on the choice inSystem Preferences -&gt; International: French maps to fr_FR, Englishto en_US, Japanese to ja_JP, French Canadian to fr_CA, etc.</P><P>In order to get a locale and language combination not supported bySystem Preferences, such as French language in the U.S. (fr_US), thedefault locale can be overridden by the following settings before theJava VM starts up. The options listed first override the laterones.</P><OL>   <LI>The Java properties <CODE>user.language</CODE> and   <CODE>user.region</CODE>, defined on the <CODE>java</CODE> command   line, or in MRJAppBuilder property settings</LI>      <LI>The value of the <CODE>LC_ALL</CODE> environment variable, set   to one of the ISO standard language (optionally plus region)   codes. <CODE>LC_ALL</CODE> is mapped to locale using a set of   default rules derived from the language codes outlined in ISO 639   and the country codes outlined in ISO 3166, such as en -&gt;   en_US, fr -&gt; fr_FR, ja -&gt; ja_JP, etc. See <A HREF="http://www.unicode.org">www.unicode.org</A>   for more details on these ISO specifications.</LI>      <LI>The International settings in System Preferences (as mentioned   above)</LI>      <LI>The value of the <CODE>LANG</CODE> environment variable</LI></OL><P>Specifying a locale within Java code using<CODE>Locale.setDefault(</CODE><I><CODE>newLocale</CODE></I><CODE>)</CODE>can be done after the VM is running, and overrides all otheroptions.</P><H2><HR><A NAME=Debugging></A>Debugging</H2><H3>Project Builder</H3><P>Java debugging is now fully operational in Project Builder, and isthe recommended way to debug your Java applications.</P><H3>jdb</H3><P>jdb, the command-line Java debugger, works with the HotSpot JavaVirtual Machine. To debug your code with jdb, do:</P><PRE><FONT SIZE="-1"><CODE>	</CODE><B><CODE>$</CODE></B><CODE> jdb </CODE><I><CODE>nameofjavaclass</CODE></I><CODE> </CODE><I><CODE>arguments</CODE></I></FONT></PRE><P>See the <CODE>jdb</CODE> man page for more details.</P><H3>gdb</H3><P>Currently, "<TT>/usr/bin/java</TT>" is a script. Because gdbwon&#146;t recognize the script as an executable format, youcan&#146;t simply type "<TT>gdb java</TT>" to debug your native code.To debug using gdb, you must type the full path to the <TT>java</TT>executable, like this:</P><BLOCKQUOTE><FONT SIZE="-1"><B><CODE>$</CODE></B><CODE> gdb   /System/Library/Frameworks/JavaVM.framework/Versions/1.3.1/Commands/java</CODE></FONT></BLOCKQUOTE><P>Once gdb starts, you may establish a different CLASSPATH forloading java code from within gdb:</P><BLOCKQUOTE><FONT SIZE="-1"><B><CODE>(gdb)</CODE></B><CODE> set   environment CLASSPATH   </CODE><I><CODE>foo</CODE></I><CODE>:</CODE><I><CODE>bar<BR>   </CODE></I><B><CODE>(gdb)</CODE></B><CODE> run   </CODE><I><CODE>nameofjavaclass</CODE></I><CODE>   </CODE><I><CODE>arguments</CODE></I></FONT></BLOCKQUOTE><P>The <TT>ps()</TT> and <TT>pss()</TT> gdb utility functions thatwere described in previous releases are no longer recommended fordisplaying stack trace information.</P><P>To display Java stack traces, use one of these methods:</P><UL>   <LI>If the Java program was launched from the commandline, you can   press CTRL-\ to generate a SIGQUIT, which ends up printing the   current stack frames to the output.</LI>      <LI>If the Java program was launched from the Finder, find its PID   using the <CODE>ps</CODE> command line tool, then deliver a   SIGQUIT to that process. Here is the command sequence:      <PRE><FONT SIZE="-1"><B><CODE>$ </CODE></B><CODE>ps -auxwww | grep "Applet Launcher"<BR>user 557 0.2 6.2 211952 16236 ?? S 0:06.47 /Applications/.../Applet Launcher -psn_0_1703937<BR>user 559 0.0 0.1 5724 188 std UV+ 0:00.00 grep AppletLauncher<BR></CODE><B><CODE>$ </CODE></B><CODE>kill -QUIT 557</CODE></FONT></PRE></LI></UL><P>Note that if you deliver a signal to a process that is running ingdb, gdb will break on the signal. You can just continue on (with thecommand "<CODE>c</CODE>") as you are actually not interested in thesignal itself, but in the output the signal handler gives you.</P><P>You can have monitor status included in the the stack traceinformation. There are several ways to enable this option (thisapplies also to all other <CODE>-XX:</CODE> based VM options):</P><UL>   <LI>Pass <CODE>-XX:+JavaMonitorsInStackTrace</CODE> on the java   command line.</LI>      <LI>Create a <CODE>.hotspotrc</CODE> file in your home directory.   This file gets parsed <I>every</I> time a Java VM starts up, so   this gives you a way to set options even for double-clickable   binaries or when embedding within another application. Include a   line containing: <CODE>+JavaMonitorsInStackTrace </CODE>in your   <CODE>.hotspotrc</CODE> file.</LI></UL><P>If you are reporting a bug that results in a crash or a deadlock,please include the Java stack trace information as described above.In the case of a crash, please include the native stack trace aswell. To get a native stack trace, reproduce the bug while running ingdb, and run the <TT><CODE>bt</CODE></TT> command after the crash. Toget all native backtraces, use the gdb command "<CODE>thread applyall bt</CODE>".</P><P>See the <CODE>gdb</CODE> man page for more details.</P><H2><HR><A NAME=Heap></A>Tuning the Heap Size</H2><P>The default heap size on Mac OS X is 64MB. Since the Mac OS X Java HotSpot VM uses generational garbage collection, more memory is actually reserved to accommodate the various generations.</P><P>For applications which allocate large numbers of objects/data, you may want to increase the heap size. This may have an effect on overall performance, either positively or negatively, so if you decide to do this, you should test your application under various different scenarios with  different heap sizes. Generally speaking, a larger heap will result in fewer garbage collections, but those will take longer. You can study this effect by invoking the java command line program with the <CODE>-verbose:gc</CODE> flag. This will give you a measure of how long each garbage collection is taking.</P><P>There is a limitation in the Java VM as shipped in 10.0 and 10.1 that the heap maximum cannot be made larger than 590MB. If the heap is larger, the java command line program will crash. This will be fixed  in an upcoming release. If you do need a larger heap, you can turn off the  shared classes support in our Java VM passing the <CODE>-XX:-UseSharedGen</CODE> flag   to HotSpot. This will allow a maximum heap size of up to about 986MB.</P><H2><HR><A NAME=Profiling></A>Profiling tools</H2><P>Java on Mac OS X provides hprof as a basic profiling tool. Thereliability of data provided by hprof is better than in previousreleases, though some features are still not thoroughly tested.</P><P>The HotSpot Java VM includes the <CODE>-Xprof</CODE> option whichprovides basic flat CPU usage on a per-thread basis, which we havefound useful.</P><P>See <A HREF="http://developer.apple.com/java/javaintro/tools.html">JavaDevelopment Tools</A> for more information about other tools.</P><H2><HR><A NAME=BuildingJNI></A>Building Java Native Interface (JNI)libraries</H2><P>In Mac OS X, native methods that are implemented using the JavaNative Interface are built into JNI libraries. Only the applicationthat dynamically loads a JNI library has access to it. JNI librariesmust be mach-o. CFM libraries are not supported. See <A HREF="http://developer.apple.com/technotes/tn/tn2003.html">TechNote2003: Moving Your Code to Mac OS X</A>, and the <a href="../../../documentation/MacOSX/Conceptual/OSX_Technology_Overview/index.html#//apple_ref/doc/uid/TP40001067" target="_top">Mac OS X Technology Overview</a> book for more details on mach-o and CFM.</P><P>JNI libraries are always named<CODE>lib</CODE><I><CODE>name</CODE></I><CODE>.jnilib</CODE>, where<I><CODE>name</CODE></I> is the value of the string used in the callto <CODE>System.loadLibrary()</CODE>. For example, to load thelibrary named <CODE>libhello.jnilib</CODE>, you would make thefollowing call in your Java code:</P><BLOCKQUOTE><FONT SIZE="-1"><CODE>System.loadLibrary("hello");</CODE></FONT></BLOCKQUOTE><P>To build a JNI library, execute the following command:</P><BLOCKQUOTE><FONT SIZE="-1"><B><CODE>$</CODE></B><CODE> cc -bundle   -I/System/Library/Frameworks/JavaVM.framework/Headers -o   lib</CODE><I><CODE>name</CODE></I><CODE>.jnilib -framework JavaVM   </CODE><I><CODE>sourceFiles</CODE></I></FONT></BLOCKQUOTE><P>For example, if the files <CODE>hello.c</CODE> and<CODE>goodbye.c</CODE> contain the implementations of the nativemethods to be built into <CODE>libhello.jnilib</CODE>, you wouldbuild <CODE>libhello.jnilib</CODE> with the following command:</P><BLOCKQUOTE><FONT SIZE="-1"><B><CODE>$</CODE></B><CODE> cc -bundle   -I/System/Library/Frameworks/JavaVM.framework/Headers -o   libhello.jnilib -framework JavaVM hello.c goodbye.c</CODE></FONT></BLOCKQUOTE><P>A common problem for JNI developers is that JNI dynamic librarieshave interdependencies. For example: <TT>libA.jnilib</TT> contains afunction <TT>foo()</TT>. <TT>libB.jnilib</TT> needs to link against<TT>libA.jnilib</TT> to make use of <TT>foo()</TT>. This will notwork on Mac OS X because JNI libraries are bundles (all symbols areprivate to a bundle). One solution to this dependency problem is toput the common functions into a separate dynamic library(<TT>libC.dylib</TT> in this example) and link both<TT>libA.jnilib</TT> and <TT>libB.jnilib</TT> to<TT>libC.dylib</TT>.</P><H2><HR><A NAME=BuildingNative></A>Building native applications that launchthe Java VM</H2><P>To build a C application that starts a Java VM session, you mustlink with the JavaVM framework; e.g.</P><BLOCKQUOTE><FONT SIZE="-1"><B><CODE>$</CODE></B><CODE> cc myapp.c   -I/System/Library/Frameworks/JavaVM.framework/Headers -framework   JavaVM -o myapp</CODE></FONT></BLOCKQUOTE><H2><HR><A NAME=ClassLibs></A><B>AWT and other class libraries</B></H2><H3><A NAME=WindowsAndDialogs></A>Windows and Dialogs</H3><P>Window titles, controls, menu titles and menu items can use anyUnicode characters supported by Mac OS X. (In MRJ on Mac OS 9,characters of different non-Roman writing systems, e.g. Kanji andArabic, couldn&#146;t be mixed in a single title.)</P><P>Window coordinates and insets are compatible with the JDK. In anutshell: Window bounds refer to the <I>outside</I> of thewindow&#146;s frame, and the coordinates of the window put (0,0) atthe top left of the title bar (not at the top left of the contentregion as in MRJ on Mac OS 9). The <CODE>getInsets</CODE> methodreturns the amount by which content needs to be inset in the Windowto avoid the window border. This should only affect applications thatare doing precision positioning of windows (especially full-screenwindows), or those that bypass LayoutManagers to do their ownhardcoded component positioning.</P><P>Windows in Mac OS X are double-buffered. Java on Mac OS X attemptsto flush the buffer to the screen often enough to have good drawingbehavior without compromising performance. If for some reason youneed to force window buffers to be flushed <I>immediately</I>, justcall <TT>Toolkit.sync()</TT>.</P><P>Java processes that are launched from a shell will not show up inthe Dock or the floating Application List until/unless they show awindow. In the Dock, these processes will then show up as items witha default Java icon. This allows server-type processes to run behindthe scenes with no user visible manifestation. In contrast, any appbuilt with MRJAppBuilder will always be user visible, and have theicon you have selected for it.</P><P>Live window resizing is off by default. To enable live windowresize, see the section on <A HREF="#GUICustomization">GUIcustomization</A>.</P><H3><A NAME=GraphicsAndJava2D></A>Graphics and Java2D</H3><P>Our Graphics/Java2D implementation is based on Apple&#146;s<I>Quartz</I> graphics engine. Java2D and Quartz have very similarfeature sets, inherited largely from PostScript. Java on Mac OS Xuses Quartz for all graphics&emdash;as opposed to the JDK, whichdrops down to GDI or X-Windows for simple 1.1-styledrawing&emdash;and while Quartz is very fast at complex rendering, ithas not yet been optimized for some basic shapes like diagonallines.</P><P>Anti-aliasing is on by default for text and graphics, but can beturned off using the properties described in the section on <A HREF="#GUICustomization">GUIcustomization</A>, or by calling <CODE>setRenderingHint()</CODE>within your Java application.</P><P>To enable experimental code that uses hardware acceleration forgraphics where possible, see the section on <A HREF="#GUICustomization">GUIcustomization</A>.</P><P><I>Compatibility issues to note:</I></P><UL>   <LI>Drawing shapes over each other when anti-aliasing is on may   cause different results than in Java 1.1. For instance, drawing a   white line on top of a black line will <I>not</I> completely erase   the line; the compositing rules leave some gray pixels around the   edges. (The JDK "Clock" applet exhibits this glitch.) Also,   drawing text multiple times in the same place will cause the   partially-covered pixels along the edges to get darker and darker,   making the text look smudged.</LI>      <LI>Java on Mac OS X will never have pixel for pixel match with   the Sun Java2D implementation, especially when anti-aliasing is on   (see the <A HREF="#GUICustomization">GUI Customization</A> section   below for information on how to disable anti-aliasing).   Quartz&#146;s anti-aliasing algorithms for both line art and text   are different than Sun&#146;s default implementations, so the   rendered pixels will not match exactly. Apple is using the Quartz   graphics system because it improves drawing quality over other   platforms&#146; Java2D implementations.</LI></UL><H3><A NAME=Swing></A>Swing</H3><H4>Mac OS look-and-feel</H4><P>There is a new Mac OS look-and-feel which uses the AppearanceManager to do its rendering, giving it full support for the Mac OS XAqua interface. This is the default look-and-feel, and is set as suchin the <CODE>swing.properties</CODE> file. Most Swing-basedapplications have preference settings that allow you to switch thelook-and-feel.</P><P><I>Things to note about the Mac OS look-and-feel:</I></P><UL>   <LI>The default for the Mac OS look-and-feel is to leave all Swing   menus in the window. If you wish to move the main Swing menu bar   (the JMenuBar blessed by <TT>JFrame.setJMenuBar</TT>) into the Mac   menu bar, see the <A HREF="#GUICustomization">GUI   customization</A> section.</LI></UL><P><I>Known bugs:</I></P><UL>   <LI>JMenuBars in JDialogs are not moved to the Mac menu bar.</LI></UL><H4>Bundle traversal in JFileChooser</H4><P>To allow developers more flexibility in dealing with MacappBundles and packages, we&#146;ve added properties to the MacFileChooser:</P><UL>   <LI>"<TT>JFileChooser.packageIsTraversable</TT>"</LI>      <LI>"<TT>JFileChooser.appBundleIsTraversable</TT>"</LI></UL><P>Possible values for these properties are "<TT>always</TT>","<TT>never</TT>". They can be applied globally by setting them with<TT>UIManager.put</TT> and per-instance with<TT>fileChooser.putClientProperty</TT>. They&#146;re set to"<TT>always</TT>" by default.</P><P>The Aqua JFileChooser also supports alias traversal, but this onlyworks with the default FileView, so if you replace it (asFileChooserDemo does), aliases will not be traversable, because Unixsees aliases as files.</P><H3>Event handling</H3><P><I>Known problems with event handling:</I></P><UL>   <LI>Mouse-down events from the additional buttons on multi-button   USB mice will be delivered correctly, but mouse-up and mouse-drag   events involving the additional buttons may not be delivered with   the correct modifiers. This is in part because of ambiguity   between BUTTON2_MASK and ALT_MASK, between BUTTON3_MASK and   META_MASK, and&emdash;on Mac OS X Java&emdash;between BUTTON2 and   CTRL - BUTTON1. In JDK 1.4, the event modifier structure is   changing to remove this ambiguity. To work around this problem, in   a way that should continue to work correctly in JDK 1.4, you   should use the utility functions (e.g. <TT>isMetaDown()</TT>)   instead of accessing the modifiers directly (e.g.   <TT>getModifiers() &amp; META_MASK</TT>).</LI></UL><H3><A NAME=GUICustomization></A>GUI customization</H3><P>There are many system properties that can be set (via a<CODE>.properties</CODE> file in your home directory, viaMRJAppBuilder, via Project Builder, or on the <CODE>java</CODE>command line) to customize various aspects of the GUI:</P><P><FONT SIZE="-1"><TABLE BORDER=1>   <TR>      <TH WIDTH="47%">         <P ALIGN=left><FONT SIZE="-1">Property</FONT></P>      </TH>      <TH WIDTH="8%">         <P ALIGN=left><FONT SIZE="-1">Default</FONT></P>      </TH>      <TH>         <P ALIGN=left><FONT SIZE="-1">Function</FONT></P>      </TH>   </TR>   <TR>      <TD WIDTH="47%">         <P><FONT SIZE="-1"><TT>com.apple.macosx.AntiAliasedTextOn</TT></FONT></P>      </TD>      <TD WIDTH="8%">         <P><FONT SIZE="-1"><TT>true</TT></FONT></P>      </TD>      <TD>         <P><FONT SIZE="-1">Use anti-aliasing when rendering         text.</FONT></P>      </TD>   </TR>   <TR>      <TD WIDTH="47%">         <P><FONT SIZE="-1"><TT>com.apple.macosx.AntiAliasedGraphicsOn</TT></FONT></P>      </TD>      <TD WIDTH="8%">         <P><FONT SIZE="-1"><TT>true</TT></FONT></P>      </TD>      <TD>         <P><FONT SIZE="-1">Use anti-aliasing when rendering         graphics.</FONT></P>      </TD>   </TR>   <TR>      <TD VALIGN=top WIDTH="47%">         <P><FONT SIZE="-1"><TT>com.apple.macos.useScreenMenuBar</TT></FONT></P>      </TD>      <TD VALIGN=top WIDTH="8%">         <P><FONT SIZE="-1"><TT>false</TT></FONT></P>      </TD>      <TD VALIGN=top>         <P><FONT SIZE="-1">Puts Swing menus in the Mac OS menu bar,         if using the Aqua look and feel.</FONT></P>      </TD>   </TR>   <TR>      <TD WIDTH="47%">         <P><FONT SIZE="-1"><TT>com.apple.hwaccel</TT></FONT></P>      </TD>      <TD WIDTH="8%">         <P><FONT SIZE="-1"><TT>false</TT></FONT></P>      </TD>      <TD>         <P><FONT SIZE="-1">Uses hardware acceleration for graphics         if possible. This improves drawing speed dramatically in         many cases, but is a pre-release implementation.</FONT></P>      </TD>   </TR>   <TR>      <TD VALIGN=top WIDTH="47%">         <P><FONT SIZE="-1"><TT>com.apple.mrj.application.growbox.intrudes</TT></FONT></P>      </TD>      <TD VALIGN=top WIDTH="8%">         <P><FONT SIZE="-1"><TT>true</TT></FONT></P>      </TD>      <TD VALIGN=top>         <P><FONT SIZE="-1">Resizable window&#146;s grow-box intrudes         into AWT content (if turned off, bottom of window is pushed         down 15 pixels.)</FONT></P>      </TD>   </TR>   <TR>      <TD VALIGN=top WIDTH="47%">         <P><FONT SIZE="-1"><TT>com.apple.mrj.application.live-resize</TT></FONT></P>      </TD>      <TD VALIGN=top WIDTH="8%">         <P><FONT SIZE="-1"><TT>false</TT></FONT></P>      </TD>      <TD VALIGN=top>         <P><FONT SIZE="-1">Enables live resizing of         windows.</FONT></P>      </TD>   </TR>   <TR>      <TD VALIGN=top WIDTH="47%">         <P><FONT SIZE="-1"><TT>com.apple.mrj.application.apple.menu.about.name</TT></FONT></P>      </TD>      <TD VALIGN=top WIDTH="8%">         <P><FONT SIZE="-1"><I>none</I></FONT></P>      </TD>      <TD VALIGN=top>         <P><FONT SIZE="-1">If defined, an "About" command will be         added to the top of the application menu, and can be         detected by registering a         <TT>com.apple.mrj.AboutHandler</TT>.</FONT></P>      </TD>   </TR>   <TR>      <TD WIDTH="47%">         <P><FONT SIZE="-1"><TT>com.apple.macos.use-file-dialog-packages</TT></FONT></P>      </TD>      <TD WIDTH="8%">         <P><FONT SIZE="-1"><I>none</I></FONT></P>      </TD>      <TD>         <P><FONT SIZE="-1">If defined, and set to true, causes         java.awt.FileDialog to select application packages as if         they were files, and will not allow navigation into         them.</FONT></P>      </TD>   </TR></TABLE> </FONT></P><P>The properties that apply to windows can be changed at runtime,but the changes apply only to windows that do not yet have peers(those that have not yet been <TT>show</TT>n or <TT>pack</TT>ed).</P><H3><A NAME=PropertyPermissions></A>Giving applets permission toaccess internal properties</H3><P>Unsigned applets can&#146;t access the above properties. The onecurrent exception is <TT>com.apple.macos.useScreenMenuBar</TT>. Ifyou need to use other internal properties from an applet, you cangrant permission to access them by adding a line like the followingto your system-wide policy file, which is located at<CODE>${JAVA_HOME}/lib/security/java.policy</CODE>:</P><BLOCKQUOTE><FONT SIZE="-1"><CODE>java.util.PropertyPermission   "</CODE><I><CODE>internal.property.goes.here</CODE></I><CODE>",   "read,write";</CODE></FONT></BLOCKQUOTE><H3>RMI and paths that contain spaces</H3><P>If there are spaces in the path containing a Java class, RMI maynot work correctly. This problem occurs with Java on other platforms,but paths containing spaces are more common on Mac OS.</P><H3><A NAME=FileDialogChanges></A>Changes to java.awt.FileDialog</H3><P>Any AWT <TT>FileDialog</TT> can now be resized by the user.</P><P>Non-Roman file and directory names are now properly handled.</P><P>Calling <TT>setDirectory()</TT> on a <TT>FileDialog</TT> before itis shown will now set the initial location. Using <TT>setFile()</TT>still has no effect because the underlying Navigation Servicesimplementation does not support initial file selection.</P><P>Application packages are no longer grayed out in a<TT>FileDialog</TT>. If the System property"<TT>com.apple.macos.use-file-dialog-packages</TT>" is"<TT>true</TT>", then they can be selected and returned; otherwiseyou can navigate inside the application package directory, but notreturn the directory itself. Note: Since application packages aredirectories, the java application that sets this property must beable to handle a directory being returned by <TT>FileDialog</TT>.</P><P>When using directory picker mode of <TT>FileDialog</TT>(<TT>setMode(3)</TT>), the way the selected directory is returned haschanged. In Mac OS X 10.0, <TT>getDirectory()</TT> returned the fullpath, and <TT>getFile()</TT> always returned <TT>null</TT>. In Mac OSX 10.1, <TT>getDirectory()</TT> returns the full path to the parentof the selected directory, and <TT>getFile()</TT> returns theselected directory name, or <TT>null</TT> if the user cancelled thedialog. Therefore, your directory picker code can be the same as forfiles: check <TT>getFile()</TT> for <TT>null</TT> to see if usercancelled; then use <TT>newFile(fd.getDirectory(),fd.getFile())</TT>.</P><H3><A NAME=Sound></A>Sound</H3><P>Java on Mac OS X supports sound output. However, audio input isnot currently supported.</P><H2><HR><A NAME="OtherAPI"><A/><B>Other APIs</B></H2><H3><A NAME=JDirect></A>JDirect</H3><P>Mac OS X implements JDirect3, which allows access to pre-existingnative code libraries from Java. JDirect2 code will require minormodifications to run under JDirect3. JDirect1, which has beendeprecated since 1997, is no longer supported.</P><P>The JDirect sample code supplied in source form in the MRJ 2.2 SDKwill <I>not</I> work on OS X. That code is not Carbonizedand it does not use JDirect3.</P><P>Read <A HREF="http://developer.apple.com/technotes/tn/tn2002.html">Compatibilitybetween JDirect 2 and JDirect 3</A> for more information on how toconvert JDirect2 code to use JDirect3 on Mac OS X.</P><H4>Toolbox synchronization</H4><P>It is imperative that you synchronize all Toolbox calls. Javathreads are native Mach threads and can preempt Toolbox calls made bythe host app or by other Java threads. Carbon is not yet reentrant orthread-safe, and reentrant calls can corrupt memory or crash the app,so it&#146;s imperative that only one thread be inside Carbon at anytime.</P><P>The correct method for Toolbox synchronization has changed sincePublic Beta. Java on Mac OS X no longer supports the synchronizationmethod (<CODE>Toolbox.LOCK</CODE>) described in the 10.0 Public BetaJava release notes. The correct way to call the Toolbox (aka Carbon)from Java on Mac OS X is:</P><BLOCKQUOTE><PRE><FONT SIZE="-1">import com.apple.mrj.macos.carbon.CarbonLock;   try {    CarbonLock.acquire();       &lt;Carbon call here&gt;   } finally {    CarbonLock.release();}</FONT></PRE></BLOCKQUOTE><P>This way the CarbonLock handling can easily be reversed forJDirect callbacks.</P><P>Be sure to use CarbonLock around all Carbon calls. Since threadsare preemptive on Mac OS X, one should hold the CarbonLock for thevery least amount of time possible. Deadlocks occur more often whenthe CarbonLock is held too long.</P><P>Also, don&#146;t do anything which may throw exceptions in the<CODE>finally</CODE> block that calls<CODE>CarbonLock.release()</CODE>. Structure your code so that theCarbonLocking is separate from other <CODE>finally</CODE> blocks.</P><H4>Debugging features for JDirect</H4><P>To help debug JDirect on Mac OS X, if you define a shell variablenamed <CODE>JDIRECT_VERBOSE</CODE>, JDirect will write verboseloading info to stderr. Note that this only works when launching javacode from the command line&emdash;not when double-clicking thebundled application in the Finder. But you can launch anydouble-clickable application from the command line by specifying thepath to the application&#146;s executable.</P><P>For example, to set the shell variable, and then launch anapplication called <CODE>Foo.app</CODE>, you would do the followingin csh:</P><BLOCKQUOTE><PRE><FONT SIZE="-1">% setenv JDIRECT_VERBOSE% /<I>path</I>/Foo.app/Contents/MacOS/Foo</FONT></PRE></BLOCKQUOTE><H4>MethodClosureUPP not supported</H4><P>The class MethodClosureUPP was created for use on Mac OS 9 and isnot supported on Mac OS X (the design of that class assumes theexistence of MixedMode). If you are using Toolbox callbacks and wantcode that will run on Mac OS 9 or Mac OS X, you will need to have ahelper class that creates a new MethodClosureUPP when on Mac OS 9 ora new MethodClosure when on Mac OS X.</P><H4>JDirect implies user interface</H4><P>For this release of Mac OS X, any use of JDirect will cause Carbonto be initialized, a Dock entry added, and a menu bar installed. Thiswas necessary because Carbon is not thread safe and must beinitialized from the correct thread. A future release of JDirect willprovide a way to specify which JDirect native calls do not loadCarbon, and thus are safe to run without initializing Carbon.</P><H4>JDirect access to bundles</H4><P>Normally, your <CODE>JDirect_MacOSX String</CODE> is a full pathto a dylib which is the standard packaging for shared mach-o code onMac OS X. But you can also specify a full path to a CFBundle. TheCFBundle path name must end in "<CODE>.bundle</CODE>" and be aproperly constructed directory. The CFBundle supports both mach-ocode and CFM code. See the <a href="../../../documentation/CoreFoundation/Reference/CFBundleRef/index.html#//apple_ref/doc/uid/20001191" target="_top">BundleServices Documentation</a> for more details.</P><H3><HR><A NAME=JavaEmbedding></A>Java Embedding API (formerly JManager)</H3><P>New functionality in Mac OS X has enabled us to replace JManager(the embedding technology for MRJ on Mac OS 9) with a Carbon-basedJava Embedding API. JManager is not supported in Mac OS X.</P><P>The Java Embedding API is contained in the JavaEmbedding framework(<TT>/System/Library/Frameworks/JavaEmbedding.framework</TT>). Thereare three header files: <TT>JavaApplet.h</TT>,<TT>JavaControl.h</TT>, and <TT>JavaEmbedding.h</TT>.</P><P>The new Java Embedding API is smaller and simpler than JManager.The functionality previously supplied by JManager is availablethrough the JNI Invocation API, the CoreFoundation API, or isunnecessary and has been removed. The functions that remain in thenew Java Embedding API are primarily applet embedding and utilityfunctions.</P><P>Native applications that want to invoke Java should launch a JavaVM using the standard JNI Invocation API, and be sure to make thefirst call into the JavaEmbedding framework on the main thread.</P><P>Only native applications that want to embed a Java applet intotheir own windows need to use the new Java Embedding control creationAPIs in <TT>&lt;JavaVM/JavaControl.h&gt;</TT>. These create a "JavaControl"&emdash;a standard Control Manager control that contains aJava applet. The control creation APIs take a native Carbon WindowRefthat references the window into which the Java Control is to beembedded. Most of the interaction with the control is through thecalls in <TT>JavaControl.h</TT>.</P><H3><HR><A NAME=MRJToolkit></A>MRJToolkit</H3><P>The MRJToolkit utility routines from MRJ on Mac OS 9 are presentin this release, but there are differences.</P><H4>Some routines not implemented</H4><P>Several of the MRJToolkit routines do not work:<CODE>openURL()</CODE>, <CODE>setDefaultFileCreator()</CODE>, and<CODE>setDefaultFileType()</CODE>. In a future release,<CODE>openURL()</CODE> may be implemented, but the other two will beremoved entirely.</P><H4>Handlers in command line applications</H4><P>The <CODE>MRJ</CODE><I><CODE>Thing</CODE></I><CODE>Handler</CODE>interfaces (<CODE>MRJAboutHandler</CODE>,<CODE>MRJCoercionHandler</CODE>, <CODE>MRJOpenDocumentHandler</CODE>,<CODE>MRJPrintDocumentHandler</CODE>, <CODE>MRJQuitHandler</CODE>)will not work until the AWT is initialized. For packageddouble-clickable applications, the AWT is initialized before yourapplication&#146;s <CODE>main()</CODE> is called. If you launch yourjava application from the command line, you must either register yourhandlers after your code has initialized the AWT, or force the AWT tobe initialized via a simple snippet such as:</P><BLOCKQUOTE><FONT SIZE="-1"><CODE>new Frame().pack();</CODE></FONT></BLOCKQUOTE><H4>MRJQuitHandler and default Quit menu item behavior</H4><P>Every Java application with UI automatically gets an Apple menuand an application menu. The application menu follows the standardAqua guidelines and contains a Quit menu item. By default, that Quitmenu item will call <CODE>System.exit()</CODE>. If you have your ownQuit (or Exit) item in your own menu, then when running on Mac OS X,you should change your menu to remove the Quit item. You can installan MRJQuitHandler, which will be called when the user chooses theQuit menu item in the application menu.</P><P><I>Known problems with MRJQuitHandler:</I></P><UL>   <LI>Your <CODE>MRJQuitHandler</CODE> cannot directly field events.   For instance, you cannot run a modal dialog which asks the user to   confirm the Quit. The workaround is to create a new thread and run   the modal dialog on it.</LI></UL><H2><HR><A NAME=LaunchingAndPackaging></A>Developing, packaging, andlaunching Java</H2><H3><A NAME=JarLauncher></A>Jar files can now be launched directlyfrom the Finder</H3><P>If a jar file has a manifest that specifies the main class, it canbe launched directly from the Finder by double-clicking it.</P><H3><A NAME=JavaExtensions></A>Java extension locations</H3><P>Java can be extended by adding custom jar, zip, and class files,as well as native JNI libraries, in the location specified by the<TT>java.ext.dir</TT> property. In Mac OS X 10.0, this propertypointed to<TT>/System/Library/Frameworks/JavaVM.framework/Versions/1.3/Home/lib/ext</TT>,and many third party applications placed their extensions there.There are two problems with this scheme: installing files in theSystem domain requires administrative privileges; and the extensionsare tied to a specific version of the JDK.</P><P>In Mac OS X 10.1, <TT>java.ext.dir</TT> has been changed tocontain a list of directories, and several additional locations forsaving extensions have been added. This new scheme makes it possibleto override extensions, and provides distinct locations for thirdparty extensions, Apple extensions, and Sun JDK extensions. Bydefault, Java searches for extensions, in order, in the followingdirectories:</P><OL>   <LI>User&#146;s home directory   (<TT>~/Library/Java/Extensions/</TT>)</LI>      <LI>Local domain (<TT>/Library/Java/Extensions/</TT>)</LI>      <LI>Network domain   (<TT>/Network/Library/Java/Extensions/</TT>)</LI>      <LI>System domain (<TT>/System/Library/Java/Extensions/</TT>)</LI>      <LI><TT>$JAVA_HOME</TT>   (<TT>/System/Library/Frameworks/JavaVM.framework/Versions/Current/Home/lib/ext/</TT>)</LI></OL><P>In general, third party developers should install extensions inthe Local domain. Apple extensions, such as <TT>QTJava.zip</TT>, areinstalled in the System domain, and Sun JDK extensions are installedin $JAVA_HOME.</P><H3><A NAME=ProjectBuilder></A>Project Builder for integrated Javadevelopment</H3><P>Project Builder is a complete development environment thatsupports editing, compiling, packaging, running, and debugging Javaapplications, using the Java runtime on Mac OS X. See the <A HREF="../../DeveloperTools/Xcode/Xcode.html">Project Builder Documentation</a> for more information.</P><H3><A NAME=MRJAppBuilder></A>MRJAppBuilder</H3><P>MRJAppBuilder is a utility for packaging already-compiled Javaapplications to run on Mac OS X. MRJAppBuilder constructsapplications in the new <a href="../../../documentation/CoreFoundation/Reference/CFBundleRef/index.html#//apple_ref/doc/uid/20001191" target="_top">Carbonapplication bundle format</a>. In order to package your application,you must specify (at a minimum) the main class name and the locationof the output file. If you are not merging your Java class or jarfiles into the output, you will need to add them to the classpath.Each of these values can be set from within the <B>Application</B>panel.</P><P>The main class field is where you must enter the name of the classthat contains <CODE>main()</CODE>. This field represents the value ofthe property <CODE>com.apple.mrj.application.main</CODE>. Remember toinclude any package information, such as<CODE>com.foo.myclass</CODE>. You can also press the "Choose..."button to choose a jar file that contains the main class.</P><P>The classpath field allows you to modify the classpath. Usually,this will be automatically set to point to the jar file thatyou&#146;re bundling into your application. In the case where youwish to use a jar file that remains outside the application bundle,you need to add a classpath entry of the form:</P><DL>   <DD><FONT SIZE="-1"><TT>$APP_PACKAGE/../</TT><I><TT>MyJarFile.</TT></I><TT>jar</TT></FONT></DD></DL><P><FONT SIZE="-1"><TT>$APP_PACKAGE</TT></FONT> is a special pathstring that represents the application bundle directory.</P><P>The last required field is the output file field. You must specifythe name and location of the output file. You may either enter thepath in the text field provided, or you may press the "Set..." buttonto set the location of the output file using the file chooserdialog.</P><P>You can add a custom icon to your application. Click on the iconin the Output file section to bring up a file chooser dialog forselecting an <CODE>icns</CODE> file.</P><P>Using the other tabbed panels is optional. The <B>Mac OS X</B>panel allows you to set values specific to the Mac OS X applicationbundle format. If you do not specify the CFBundleExecutable orCFBundleName, they will be set based on the name of the output fileyou choose.</P><P>The <B>Java Properties</B> panel allows you to set Java runtimeproperties. The main and classpath fields are noteditable&emdash;they can only be set in the Application panel. Theremaining properties are the standard properties supported by Java onMac OS along with their default values. To set additional propertiesnot listed in the table, simply add them to the end of the list. Inprevious versions of MRJAppBuilder, you were required to create aconfiguration file defining the Java runtime properties. This panelis a replacement for the configuration file.</P><P>The <B>Merge Files</B> panel provides a means for adding files tothe application, such as zips or jars. Choose the "Add..." button toadd files to the list. Each item added to the merge list will becopied into the application&#146;s<CODE>Contents/Resources/Java/</CODE> directory. Each item you add tothe merge list gets automatically added to the classpath.</P><H4>Console output from applications</H4><P>Console output from packaged Java applications built byMRJAppBuilder, or from applets running inside Applet Launcher,appears in the system console, which can be viewed by launching<TT>/Applications/Utilities/Console</TT>.</P><P>If you want application output to appear in a Terminal window,you&#146;ll have to launch the application from that Terminal. Youcan either use a "<CODE>java</CODE>" command directly with your jaror class files, as described in <A HREF="#LaunchingCommandLine">Launchingjava from the command line</A> below, or launch the packagedapplication from the Terminal by specifying the path to theexecutable. Assuming the current directory is the parent directory ofthe application, you launch a packaged application like this:</P><BLOCKQUOTE><PRE><FONT SIZE="-1">MyJavaApp.app/Contents/MacOS/MyJavaApp</FONT></PRE></BLOCKQUOTE><P>There are magic strings for IO redirection: <CODE>$CONSOLE</CODE>causes output to be displayed in a Java console window.<CODE>$SYSTEM</CODE> leaves stderr and stdout as is (directed toConsole for double-clickable applications, or directed to the parentshell for applications launched from the command line).</P><H4>Setting the Java working directory</H4><P>When you build your application with MRJAppBuilder or ProjectBuilder, the current Java working directory defaults to the parentdirectory of the application bundle directory. For example, ifyou&#146;ve built an application named <CODE>myApp.app</CODE> insidethe folder <CODE>/Volumes/HD/myJavaApplications/</CODE>, then thecurrent directory would be<CODE>/Volumes/HD/myJavaApplications/</CODE>. Note that this is achange in behavior from pre-release versions of Mac OS X 10.0.</P><P>You can override the current Java working directory by setting theproperty <CODE>com.apple.mrj.application.workingdirectory</CODE>.This property must be an absolute path, or must start with<CODE>$APP_PACKAGE</CODE>, which is a special path string thatrepresents the application bundle directory. Therefore, in thisexample, these are equivalent current working directoryspecifications:</P><P><CODE>com.apple.mrj.application.workingdirectory</CODE> =<CODE>$APP_PACKAGE/Contents/Resources/Java</CODE></P><P><CODE>com.apple.mrj.application.workingdirectory</CODE> =<CODE>/Volumes/HD/myJavaApplications/myApp.app/Contents/Resources/Java</CODE></P><H4>Example of creating an application</H4><P>Let&#146;s assume you have a simple Java program, such asHelloWorld. Use <CODE>javac</CODE> and <CODE>jar</CODE> in theTerminal (in <CODE>/Applications/Utilities/</CODE>) to compile thesource and create a jar file named <CODE>HelloWorld.jar</CODE>.Launch MRJAppBuilder from <CODE>/Developer/Applications/</CODE>. Theactive panel will be the Application panel.</P><BLOCKQUOTE><H5>Step 1: Set the Main classname</H5>      <P>Click on the "Choose..." button and navigate to and select the   <CODE>HelloWorld.jar</CODE> file. Click on "Select". In the   "Choose Main Class" dialog, you should see only the name   <CODE>HelloWorld</CODE>, since there is only one class containing   a <CODE>main()</CODE> method. Click "OK". The main classname field   should be automatically filled out and the classpath updated with   the item <CODE>Contents/Resources/Java/HelloWorld.jar</CODE>.</P>      <H5>Step 2: Set the Output file</H5>      <P>Click on the "Set..." button and navigate to the desired output   directory. In the "Select" dialog, type the name of the output   file in the "Name" field. If you don&#146;t enter one, the default   will be the name of the folder you last clicked on. Click on   "Select". The Output file field should be filled out with the full   path to the output file. If you don&#146;t append a   "<CODE>.app</CODE>" extension to the name of your application,   MRJAppBuilder will add the extension when it builds the   application.</P>      <H5>Step 3: Build the application</H5>      <P>Click on "Build Application". That&#146;s it! Your application   can now be launched from the Finder. The   <CODE>HelloWorld.jar</CODE> file was copied into the application,   so you can move the application to any location and it will   run.</P>      <H5>Notes on the example:</H5>      <UL>      <LI>All of the text fields in the Application panel are      editable, so instead of using the dialogs, you could type the      values for each field directly.</LI>            <LI>For more complex applications that have more than one jar      file, use the Merge Files panel to add those files to your      application.</LI>            <LI>We recommend that you add jar files to your application as      opposed to individual class files.</LI>   </UL></BLOCKQUOTE><P><I>Known problems with MRJAppBuilder:</I></P><UL>   <LI>Drag and Drop is currently only supported in the merge files   panel of MRJAppBuilder.</LI>      <LI>Adding individual class files doesn&#146;t work well, since   the classpath entry that is automatically generated is incorrect.   Add jar files instead, or you can try to fix the classpath entries   by hand.</LI>      <LI>Watch the output in the Console application for errors and   information when diagnosing problems with MRJAppBuilder.</LI></UL><H3><A NAME=ConfiguringPackagedJava></A>Configuring packaged Javaapplications</H3><P>A java application can be packaged as a double-clickable Mac OS Xapplication via two methods:</P><UL>   <LI>In ProjectBuilder by starting with the "Java Application"   template</LI>      <LI>Using MRJAppBuilder to package jar files into a .app   package</LI></UL><P>There are two ways to specify Java configuration information in apackaged Java application.</P><UL>   <LI>In the application&#146;s <TT>Info.plist</TT> file under the   <CODE>Java</CODE> key</LI>      <LI>In <CODE>MRJApp.properties</CODE> file in the   application&#146;s <CODE>Resources</CODE> directory</LI></UL><P>Either way will launch properly on Mac OS X 10.0 and 10.1, but the<TT>MRJApp.properties</TT> way is deprecated. In the 10.1 Developerrelease, the ProjectBuilder templates have been updated to use the<TT>Info.plist</TT> while MRJAppBuilder still generates<TT>MRJApp.properties</TT> based files. A future release ofMRJAppBuilder will create <TT>Info.plist</TT> based applications.</P><P>The <TT>Info.plist</TT> system will allow your application to runon both Mac OS X 10.0 and 10.1 as long as you build your applicationwith the tools on Mac OS X 10.1. The stub of executable code insertedin a packaged application by MRJAppBuilder and by ProjectBuilder onMac OS X 10.1 will first check for a key named "<TT>Java</TT>" in the<TT>Info.plist</TT> and if it exists, launch using the<TT>Info.plist</TT> mechanism. Otherwise, it uses the<TT>MRJApp.properties</TT> file. The executable stub inserted in apackaged application by MRJAppBuilder and by ProjectBuilder on Mac OSX 10.0 will only use <TT>MRJApp.properties</TT>.</P><H4>Java key/values in Info.plist</H4><P>An application <TT>Info.plist</TT> is an XML document containingstatic application information such as icons and version (see<a href="../../../documentation/MacOSX/Conceptual/OSX_Technology_Overview/index.html#//apple_ref/doc/uid/TP40001067" target="_top">Mac OS X Technology Overview</a> for more details).</P><P>All Java configuration information is stored in a sub-dictionaryof the main <TT>Info.plist</TT> dictionary. The sub-dictionary hasthe key <CODE>Java</CODE>. For example:</P><PRE>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;plist version="0.9"&gt;    &lt;dict&gt;        &lt;key&gt;CFBundleExecutable&lt;/key&gt;             &lt;string&gt;JavaApplicationStub&lt;/string&gt;        ...        &lt;key&gt;Java&lt;/key&gt;             &lt;dict&gt;                &lt;key&gt;ClassPath&lt;/key&gt;                     &lt;string&gt;$JAVAROOT/SurfWriter.jar&lt;/string&gt;                &lt;key&gt;MainClass&lt;/key&gt;                     &lt;string&gt;com.apple.SurfWriter&lt;/string&gt;            &lt;/dict&gt;    &lt;/dict&gt;&lt;/plist&gt;</PRE><P>The following is a table of valid key/values that can be used inthe <TT>Java</TT> dictionary:</P><P><FONT SIZE="-1"><TABLE BORDER=1>   <TR>      <TD WIDTH=100>         <P><FONT SIZE="-1"><B>Key</B></FONT></P>      </TD>      <TD WIDTH=67>         <P><FONT SIZE="-1"><B>Value Type</B></FONT></P>      </TD>      <TD WIDTH=81>         <P><FONT SIZE="-1"><B>Value</B></FONT></P>      </TD>      <TD>         <P><FONT SIZE="-1"><B>Comments</B></FONT></P>      </TD>   </TR>   <TR>      <TD WIDTH=100>         <P><FONT SIZE="-1"><CODE>Jar</CODE></FONT></P>      </TD>      <TD WIDTH=67>         <P><FONT SIZE="-1">string</FONT></P>      </TD>      <TD WIDTH=81>         <P><FONT SIZE="-1">jar file path</FONT></P>      </TD>      <TD>         <P><FONT SIZE="-1">Same as the <CODE>-jar</CODE> option to         the <TT>java</TT> command line tool. It assumes the jar         manifest contains the main class. The VM is started with the         jar file as the only classpath entry. This option is used         instead of the <CODE>ClassPath</CODE> and         <CODE>MainClass</CODE> keys.</FONT></P>      </TD>   </TR>   <TR>      <TD WIDTH=100>         <P><FONT SIZE="-1"><CODE>MainClass</CODE></FONT></P>      </TD>      <TD WIDTH=67>         <P><FONT SIZE="-1">string</FONT></P>      </TD>      <TD WIDTH=81>         <P><FONT SIZE="-1">fully qualified class name</FONT></P>      </TD>      <TD>         <P><FONT SIZE="-1">Name of class whose <CODE>public static         void main(String&#91;&#93;)</CODE> should be run. If the         class is in a package, it you must specify the dot-separated         full class name (e.g.         <CODE>com.apple.SurfWriter</CODE>).</FONT></P>      </TD>   </TR>   <TR>      <TD ROWSPAN=2 WIDTH=100>         <P><FONT SIZE="-1"><CODE>ClassPath</CODE></FONT></P>      </TD>      <TD WIDTH=67>         <P><FONT SIZE="-1">array of strings</FONT></P>      </TD>      <TD WIDTH=81>         <P><FONT SIZE="-1">classpath entries</FONT></P>      </TD>      <TD ROWSPAN=2>         <P><FONT SIZE="-1">Same as the <CODE>-classpath</CODE>         option to the <TT>java</TT> command line tool.</FONT></P>      </TD>   </TR>   <TR><TD WIDTH=67>         <P><FONT SIZE="-1">string</FONT></P>      </TD>      <TD WIDTH=81>         <P><FONT SIZE="-1">colon separated classpath</FONT></P>      </TD>   </TR>   <TR>      <TD ROWSPAN=2 WIDTH=100>         <P><FONT SIZE="-1"><CODE>Arguments</CODE></FONT></P>      </TD>      <TD WIDTH=67>         <P><FONT SIZE="-1">array of strings</FONT></P>      </TD>      <TD WIDTH=81>         <P><FONT SIZE="-1">arguments to main</FONT></P>      </TD>      <TD ROWSPAN=2>         <P><FONT SIZE="-1"><CODE>String&#91;&#93;</CODE> passed to         <CODE>main</CODE>.</FONT></P>      </TD>   </TR>   <TR><TD WIDTH=67>         <P><FONT SIZE="-1">string</FONT></P>      </TD>      <TD WIDTH=81>         <P><FONT SIZE="-1">space separated arguments to         main</FONT></P>      </TD>   </TR>   <TR>      <TD WIDTH=100>         <P><FONT SIZE="-1"><CODE>Properties</CODE></FONT></P>      </TD>      <TD WIDTH=67>         <P><FONT SIZE="-1">dictionary</FONT></P>      </TD>      <TD WIDTH=81>         <P><FONT SIZE="-1">key/value pairs</FONT></P>      </TD>      <TD>         <P><FONT SIZE="-1">All key/value pairs in the dictionary are         added as initial properties to the Java VM (same as <TT>-D         key=value</TT>) on the <TT>java</TT> command line. Both the         key and value in the dictionary must be of type         <TT>string</TT>.</FONT></P>      </TD>   </TR>   <TR>      <TD ROWSPAN=2 WIDTH=100>         <P><FONT SIZE="-1"><CODE>VMOptions</CODE></FONT></P>      </TD>      <TD WIDTH=67>         <P><FONT SIZE="-1">array of strings</FONT></P>      </TD>      <TD WIDTH=81>         <P><FONT SIZE="-1">vm option</FONT></P>      </TD>      <TD ROWSPAN=2>         <P><FONT SIZE="-1">Miscellaneous VM options (e.g         <TT>-Xms2m</TT>)</FONT></P>      </TD>   </TR>   <TR><TD WIDTH=67>         <P><FONT SIZE="-1">string</FONT></P>      </TD>      <TD WIDTH=81>         <P><FONT SIZE="-1">space separated vm options</FONT></P>      </TD>   </TR>   <TR>      <TD WIDTH=100>         <P><FONT SIZE="-1"><CODE>WorkingDirectory</CODE></FONT></P>      </TD>      <TD WIDTH=67>         <P><FONT SIZE="-1">string</FONT></P>      </TD>      <TD WIDTH=81>         <P><FONT SIZE="-1">path</FONT></P>      </TD>      <TD>         <P><FONT SIZE="-1">Some Java code expects various data files         to be found relative to the current working directory. By         default, the cwd is set to be the parent directory of the         .app package. In order to make such a Java program work when         the data files are stored inside the .app directory, use         this option to change the cwd (e.g.         <CODE>$APP_PACKAGE/Contents/Resources</CODE>).</FONT></P>      </TD>   </TR>   <TR>      <TD WIDTH=100>         <P><FONT SIZE="-1"><CODE>$JAVAROOT</CODE></FONT></P>      </TD>      <TD WIDTH=67>         <P><FONT SIZE="-1">string</FONT></P>      </TD>      <TD WIDTH=81>         <P><FONT SIZE="-1">path</FONT></P>      </TD>      <TD>         <P><FONT SIZE="-1">If this key is not specified,         <TT>$JAVAROOT</TT> defaults to         <CODE>$APP_PACKAGE/Contents/Resources/Java</CODE>.         <TT>$JAVAROOT</TT> is purely a convenience to reduce the         length of strings in the <TT>Info.plist</TT> file. Note:         <TT>$JAVAROOT</TT> and <TT>$APP_PACKAGE</TT> are only         expanded by the java launcher code. They are not usable from         Java code. They will expand when used in the string values         for the keys: <TT>Jar</TT>, <TT>ClassPath</TT>,         <TT>Arguments</TT>, <TT>Properties</TT>,         <TT>WorkingDirectory</TT>, and         <TT>VMOptions</TT>.</FONT></P>      </TD>   </TR></TABLE> </FONT></P><H4>Java properties in MRJApp.properties</H4><P>The <TT>MRJApp.properties</TT> file is stored inside a .apppackage in the <CODE>Contents/Resources/</CODE> directory. Its formatis that of a standard java .properties file. Any property name thatbegins with <CODE>com.apple.mrj.application</CODE> is used toconfigure Java. All other properties are passed onto the VM asinitial properties (i.e. <TT>-D</TT><I><TT>prop</TT></I><TT>=</TT><I><TT>value</TT></I>).</P><P>The following is a table of properties which affect thelaunch:</P><P><FONT SIZE="-1"><TABLE BORDER=1>   <TR>      <TD WIDTH=255>         <P><FONT SIZE="-1"><B>Property</B></FONT></P>      </TD>      <TD WIDTH=49>         <P><FONT SIZE="-1"><B>Value</B></FONT></P>      </TD>      <TD>         <P><FONT SIZE="-1"><B>Comments</B></FONT></P>      </TD>   </TR>   <TR>      <TD WIDTH=255>         <P><FONT SIZE="-1"><CODE>com.apple.mrj.application.classpath</CODE></FONT></P>      </TD>      <TD WIDTH=49>         <P><FONT SIZE="-1">classpath</FONT></P>      </TD>      <TD>         <P><FONT SIZE="-1">Colon-separated list of classpath         entries.</FONT></P>      </TD>   </TR>   <TR>      <TD WIDTH=255>         <P><FONT SIZE="-1"><CODE>com.apple.mrj.application.main</CODE></FONT></P>      </TD>      <TD WIDTH=49>         <P><FONT SIZE="-1">class name</FONT></P>      </TD>      <TD>         <P><FONT SIZE="-1">Name of class whose <CODE>public static         void main(String&#91;&#93;)</CODE> should be run. If the         class is in a package, it you must specify the dot-separated         full class name (e.g.         <CODE>com.apple.SurfWriter</CODE>)</FONT></P>      </TD>   </TR>   <TR>      <TD WIDTH=255>         <P><FONT SIZE="-1"><CODE>com.apple.mrj.application.parameters</CODE></FONT></P>      </TD>      <TD WIDTH=49>         <P><FONT SIZE="-1">arguments</FONT></P>      </TD>      <TD>         <P><FONT SIZE="-1">Space-separated list of arguments which         are parsed to build the <CODE>String&#91;&#93;</CODE> passed         to <TT><CODE>main</CODE></TT>.</FONT></P>      </TD>   </TR>   <TR>      <TD WIDTH=255>         <P><FONT SIZE="-1"><CODE>com.apple.mrj.application.workingdirectory</CODE></FONT></P>      </TD>      <TD WIDTH=49>         <P><FONT SIZE="-1">path</FONT></P>      </TD>      <TD>         <P><FONT SIZE="-1">Sets the current working directory for         the application.</FONT></P>      </TD>   </TR>   <TR>      <TD WIDTH=255>         <P><FONT SIZE="-1"><CODE>com.apple.mrj.application.vm.options</CODE></FONT></P>      </TD>      <TD WIDTH=49>         <P><FONT SIZE="-1">option(s)</FONT></P>      </TD>      <TD>         <P><FONT SIZE="-1">Space-separated list of options to VM         (e.g <TT>-Xms2m</TT>)</FONT></P>      </TD>   </TR></TABLE> </FONT></P><P><I>Known bugs:</I></P><UL>   <LI>When using <TT>MRJApp.properties</TT>, there is no way to   create arguments to <TT>main</TT> that contain embedded spaces.   Workaround: use <TT>Info.plist</TT> based launching.</LI>      <LI>If a <TT>MRJApp.properties</TT> based java application package   is launched from the command line, additional command line   arguments are ignored. Workaround: use <TT>Info.plist</TT> based   launching.</LI>      <LI>When using <TT>MRJApp.properties</TT>, <TT>$APP_PACKAGE</TT>   is not expanded in when used in   <TT>com.apple.mrj.application.parameters</TT>. Workaround: use   <TT>Info.plist</TT> based launching.</LI></UL><H3><A NAME=LocalizingJavaApps></A>Localizing packaged Javaapplications on Mac OS X</H3><P>In order to run correctly on Mac OS X in non-English locales,packaged Java applications need to have the appropriate<TT>.lproj</TT> folders inside the application package. This is trueeven if the Java application handles its localization through JavaResourceBundles.</P><P>Specifically, you need to have a<I><TT>localename</TT></I><TT>.lproj</TT> folder present in theapplication&#146;s <TT>Resources</TT> folder for any locale that youwish to use. For example, you need a <TT>Japanese.lproj</TT> folderinside <I><TT>Appname.pkg</TT></I><TT>/Contents/Resources/</TT> inorder for Japanese localization to work correctly.</P><P>These <TT>.lproj</TT> folders can be empty, but a foldercorresponding to the current locale must be present in order for MacOS X to set the locale correctly when the application launches. Ifyou do not have a <TT>.lproj</TT> folder that corresponds to thecurrent system locale, your application will be launched with theEnglish US locale.</P><P>See the <a href="../../../documentation/CoreFoundation/Reference/CFBundleRef/index.html#//apple_ref/doc/uid/20001191" target="_top">BundleServices Documentation</a>  for more details about <TT>.lproj</TT>folders and the application bundle format.</P><H3><A NAME=DockNameAndIcon></A>Specifying a Dock name and icon forcommand line Java applications</H3><P>If you are running an application from the command line that has auser interface, we now use the name of your application&#146;s mainclass as the application name that appears in the Dock.Alternatively, you can specify the name and/or icon that will used byusing the following command-line option:</P><BLOCKQUOTE><TT>-Xdock:name=&lt;</TT><I><TT>application   name</TT></I><TT>&gt;&#91;:icon=&lt;</TT><I><TT>path to icon   file</TT></I><TT>&gt;&#93;</TT></BLOCKQUOTE><P>The icon file must be an icns file, identical to what you woulduse for any other Mac OS X application. If either the applicationname or path to the icon file has spaces in it you can wrap eachoption in double quotes and specify multiple <TT>-X:dock</TT>options. Only the first of each kind ('<TT>name</TT>' and/or'<TT>icon</TT>') will be recognized.</P><H3><A NAME=JavaWebStart></A>Java Web Start</H3><P>This release of Java for Mac OS X contains Java Web Start. It is aproduct-quality reference implementation (RI) of the Java NetworkLaunching Protocol &amp; API (JNLP) Specification, v1.0.1. To findout more about Java Web Start, see <A HREF="http://developer.apple.com/java/javawebstart">JavaWeb Start on Mac OS X</A>, or try the sample applications availablewhen you launch the application.</P><P>Apple&#146;s implementation of Java Web Start differs from theWindows and Solaris versions in the following ways:</P><UL>   <LI>We do not support downloading of additional JREs. Attempting   to launch an application that requires JRE 1.2 or 1.4 will not   work. Applications specified as needing platform version '1.2+' or   '1.3+' will work, however. Our platform version is 1.3 and our   product version is 1.3.1.</LI>      <LI>It is not necessary to set up proxy information explicitly in   the Web Start application. Java for Mac OS X automatically picks   up your proxy settings from the Network preference panel, and   those settings are used in Java Web Start.</LI></UL><P>Java Web Start caches its data in your login directory in thehidden directory <TT>.javaws</TT>. Removing this directory orclearing the cache can free up hard disk space.</P><H4>Java Web Start with JBuilder</H4><P>The version of JBuilder for Mac OS X that was distributed at WWDC2001 has a bug in its Web Start Launcher wizard that causes anincorrect <FONT SIZE="-1"><TT>.jnlp</TT></FONT> file to be generated.It inserts a tag for the version like this:</P><BLOCKQUOTE><FONT SIZE="-1"><TT>&lt;j2se   version="1.3.1+"&gt;</TT></FONT></BLOCKQUOTE><P>A version tag in this format is a 'platform version' tag, not a'product version' tag. As a result, Web Start apps generated byJBuilder won&#146;t run unmodified because they are requesting thenon-existent 1.3.1 Java platform. Instead this version tag should be"<FONT SIZE="-1"><TT>1.3+</TT></FONT>" to get the Java2 platformv1.3. You will need to modify the generated<FONT SIZE="-1"><TT>.jnlp</TT></FONT> file to work on Mac OS X.</P><H4>Apache config and Web Start</H4><P>Apache does not ship configured to serve Web Start files. To fixthis, add this entry to Apache&#146;s<FONT SIZE="-1"><TT>mime.types</TT></FONT> file:</P><BLOCKQUOTE><FONT SIZE="-1"><TT>application/x-java-jnlp-file   jnlp</TT></FONT></BLOCKQUOTE><P>and restart the web server.</P><H4>Java Web Start and Internet Explorer</H4><P>If your download location is located on an NFS-mounted server,Internet Explorer will not automatically open JNLP files after theyare downloaded (this applies to all downloads, not just JNLP files).To work around this problem, change your download location to someplace other than the NFS-mounted server.</P><H3><A NAME=AppletLauncher></A>Applet Launcher</H3><P>Applet Launcher allows you to run Java applets without theoverhead of launching a web browser. Applet Launcher provides agraphical user interface to the <CODE>sun.applet.AppletViewer</CODE>class, with more features than the <TT>appletviewer</TT> command-linetool from Sun, which is based on the same class. You can enter thepath to an applet using its fully-qualified URL, and then press theLaunch button. For example, entering the following URL will launchthe Sun Tumbling Duke example applet:</P><BLOCKQUOTE><FONT SIZE="-1"><CODE>http://java.sun.com/applets/other/TumblingDuke/index.html</CODE></FONT></BLOCKQUOTE><P>Applet Launcher has an Applets menu that displays all appletslisted in the <CODE>/Developer/Examples/Java/Applets</CODE>directory. These applets are provided by Sun Microsystems asexamples.</P><H3><A NAME=LaunchingCommandLine></A>Launching java from the commandline</H3><P>JDK-style command-line launching from the Terminal app is fullysupported (as are all your favorite JDK tools like <TT>javac</TT> and<TT>rmic</TT>). You can still use "<TT>java</TT>" to launch apps and"<TT>appletviewer</TT>" to launch applets. (Invoking these with noarguments will print a brief help message.) The Terminal windowserves as the Java console. You can kill a Java process by activatingthe Terminal window that launched it and pressing Ctrl-C.</P><H6><HR><FONT SIZE="-2">10.1.web.7 t 20011003</FONT></H6><P><FONT SIZE="-2" FACE="Geneva,Helvetica,Arial">Copyright &copy;2001 Apple Computer, Inc.</FONT></P></BODY></HTML>

