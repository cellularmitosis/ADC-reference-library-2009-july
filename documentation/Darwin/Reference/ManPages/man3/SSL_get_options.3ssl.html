<html><head><title>Mac OS X Developer Tools
 Manual Page For SSL_get_options(3ssl)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/3ssl/SSL_get_options" title="Mac OS X Developer Tools
 Manual Page for SSL_get_options(3ssl)"><a name="//apple_ref/doc/man/3/SSL_get_options" title="Mac OS X Developer Tools
 Manual Page for SSL_get_options(3ssl)"><!-- headerDoc=man; indexgroup=Section 3ssl; uid="//apple_ref/doc/man/3ssl/SSL_get_options"; name=SSL_get_options(3ssl) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac&nbsp;OS&nbsp;X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>

<p style='text-align:justify;'>This manual page is associated with the Mac&nbsp;OS&nbsp;X
developer tools.  The software or headers described may not be present on your
Mac&nbsp;OS&nbsp;X installation until you install the developer tools
package.  This package is available on your Mac&nbsp;OS&nbsp;X installation DVD,
and the latest versions can be downloaded from
<a href="http://developer.apple.com/tools/download/">developer.apple.com</a>.</p>

<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
SSL_CTX_set_options(3)                             OpenSSL                            <a href="SSL_CTX_set_options.3ssl.html#//apple_ref/doc/man/3/SSL_CTX_set_options">SSL_CTX_set_options(3)</a>



<b>NAME</b>
       SSL_CTX_set_options, SSL_set_options, SSL_CTX_get_options, SSL_get_options - manipulate SSL engine
       options

<b>SYNOPSIS</b>
        #include &lt;openssl/ssl.h&gt;

        long SSL_CTX_set_options(SSL_CTX *ctx, long options);
        long SSL_set_options(SSL *ssl, long options);

        long SSL_CTX_get_options(SSL_CTX *ctx);
        long SSL_get_options(SSL *ssl);

<b>DESCRIPTION</b>
       <u>SSL</u><b>_</b><u>CTX</u><b>_</b><u>set</u><b>_</b><u>options()</u> adds the options set via bitmask in <b>options</b> to <b>ctx</b>.  Options already set before
       are not cleared!

       <u>SSL</u><b>_</b><u>set</u><b>_</b><u>options()</u> adds the options set via bitmask in <b>options</b> to <b>ssl</b>.  Options already set before are
       not cleared!

       <u>SSL</u><b>_</b><u>CTX</u><b>_</b><u>get</u><b>_</b><u>options()</u> returns the options set for <b>ctx</b>.

       <u>SSL</u><b>_</b><u>get</u><b>_</b><u>options()</u> returns the options set for <b>ssl</b>.

<b>NOTES</b>
       The behaviour of the SSL library can be changed by setting several options.  The options are coded as
       bitmasks and can be combined by a logical <b>or</b> operation (|). Options can only be added but can never
       be reset.

       <u>SSL</u><b>_</b><u>CTX</u><b>_</b><u>set</u><b>_</b><u>options()</u> and <u>SSL</u><b>_</b><u>set</u><b>_</b><u>options()</u> affect the (external) protocol behaviour of the SSL
       library. The (internal) behaviour of the API can be changed by using the similar <a href="SSL_CTX_set_mode.3ssl.html#//apple_ref/doc/man/3/SSL_CTX_set_mode"><u>SSL</u><b>_</b><u>CTX</u><b>_</b><u>set</u><b>_</b><u>mode</u>(3)</a>
       and <u>SSL</u><b>_</b><u>set</u><b>_</b><u>mode()</u> functions.

       During a handshake, the option settings of the SSL object are used. When a new SSL object is created
       from a context using <u>SSL</u><b>_</b><u>new()</u>, the current option setting is copied. Changes to <b>ctx</b> do not affect
       already created SSL objects. <u>SSL</u><b>_</b><u>clear()</u> does not affect the settings.

       The following <b>bug</b> <b>workaround</b> options are available:

       SSL_OP_MICROSOFT_SESS_ID_BUG
           www.microsoft.com - when talking SSLv2, if session-id reuse is performed, the session-id passed
           back in the server-finished message is different from the one decided upon.

       SSL_OP_NETSCAPE_CHALLENGE_BUG
           Netscape-Commerce/1.12, when talking SSLv2, accepts a 32 byte challenge but then appears to only
           use 16 bytes when generating the encryption keys.  Using 16 bytes is ok but it should be ok to
           use 32.  According to the SSLv3 spec, one should use 32 bytes for the challenge when operating in
           SSLv2/v3 compatibility mode, but as mentioned above, this breaks this server so 16 bytes is the
           way to go.

       SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG
           ssl3.netscape.com:443, first a connection is established with RC4-MD5.  If it is then resumed, we
           end up using DES-CBC3-SHA.  It should be RC4-MD5 according to 7.6.1.3, 'cipher_suite'.

           Netscape-Enterprise/2.01 (https://merchant.netscape.com) has this bug.  It only really shows up
           when connecting via SSLv2/v3 then reconnecting via SSLv3. The cipher list changes....

           NEW INFORMATION.  Try connecting with a cipher list of just DES-CBC-SHA:RC4-MD5.  For some weird
           reason, each new connection uses RC4-MD5, but a re-connect tries to use DES-CBC-SHA.  So
           netscape, when doing a re-connect, always takes the first cipher in the cipher list.

       SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG
           ...

       SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER
           ...

       SSL_OP_MSIE_SSLV2_RSA_PADDING
           As of OpenSSL 0.9.7h and 0.9.8a, this option has no effect.

       SSL_OP_SSLEAY_080_CLIENT_DH_BUG
           ...

       SSL_OP_TLS_D5_BUG
           ...

       SSL_OP_TLS_BLOCK_PADDING_BUG
           ...

       SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS
           Disables a countermeasure against a SSL 3.0/TLS 1.0 protocol vulnerability affecting CBC ciphers,
           which cannot be handled by some broken SSL implementations.  This option has no effect for
           connections using other ciphers.

       SSL_OP_ALL
           All of the above bug workarounds.

       It is usually safe to use <b>SSL_OP_ALL</b> to enable the bug workaround options if compatibility with
       somewhat broken implementations is desired.

       The following <b>modifying</b> options are available:

       SSL_OP_TLS_ROLLBACK_BUG
           Disable version rollback attack detection.

           During the client key exchange, the client must send the same information about acceptable
           SSL/TLS protocol levels as during the first hello. Some clients violate this rule by adapting to
           the server's answer. (Example: the client sends a SSLv2 hello and accepts up to SSLv3.1=TLSv1,
           the server only understands up to SSLv3. In this case the client must still use the same
           SSLv3.1=TLSv1 announcement. Some clients step down to SSLv3 with respect to the server's answer
           and violate the version rollback protection.)

       SSL_OP_SINGLE_DH_USE
           Always create a new key when using temporary/ephemeral DH parameters (see
           <a href="SSL_CTX_set_tmp_dh_callback.3ssl.html#//apple_ref/doc/man/3/SSL_CTX_set_tmp_dh_callback"><u>SSL</u><b>_</b><u>CTX</u><b>_</b><u>set</u><b>_</b><u>tmp</u><b>_</b><u>dh</u><b>_</b><u>callback</u>(3)</a>).  This option must be used to prevent small subgroup attacks,
           when the DH parameters were not generated using "strong" primes (e.g. when using DSA-parameters,
           see <a href="../man1/dhparam.1ssl.html#//apple_ref/doc/man/1/dhparam"><u>dhparam</u>(1)</a>).  If "strong" primes were used, it is not strictly necessary to generate a new DH
           key during each handshake but it is also recommended.  <b>SSL_OP_SINGLE_DH_USE</b> should therefore be
           enabled whenever temporary/ephemeral DH parameters are used.

       SSL_OP_EPHEMERAL_RSA
           Always use ephemeral (temporary) RSA key when doing RSA operations (see
           <a href="SSL_CTX_set_tmp_rsa_callback.3ssl.html#//apple_ref/doc/man/3/SSL_CTX_set_tmp_rsa_callback"><u>SSL</u><b>_</b><u>CTX</u><b>_</b><u>set</u><b>_</b><u>tmp</u><b>_</b><u>rsa</u><b>_</b><u>callback</u>(3)</a>).  According to the specifications this is only done, when a RSA
           key can only be used for signature operations (namely under export ciphers with restricted RSA
           keylength). By setting this option, ephemeral RSA keys are always used. This option breaks
           compatibility with the SSL/TLS specifications and may lead to interoperability problems with
           clients and should therefore never be used. Ciphers with EDH (ephemeral Diffie-Hellman) key
           exchange should be used instead.

       SSL_OP_CIPHER_SERVER_PREFERENCE
           When choosing a cipher, use the server's preferences instead of the client preferences. When not
           set, the SSL server will always follow the clients preferences. When set, the SSLv3/TLSv1 server
           will choose following its own preferences. Because of the different protocol, for SSLv2 the
           server will send its list of preferences to the client and the client chooses.

       SSL_OP_PKCS1_CHECK_1
           ...

       SSL_OP_PKCS1_CHECK_2
           ...

       SSL_OP_NETSCAPE_CA_DN_BUG
           If we accept a netscape connection, demand a client cert, have a non-self-signed CA which does
           not have its CA in netscape, and the browser has a cert, it will crash/hang.  Works for 3.x and
           4.xbeta

       SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG
           ...

       SSL_OP_NO_SSLv2
           Do not use the SSLv2 protocol.

       SSL_OP_NO_SSLv3
           Do not use the SSLv3 protocol.

       SSL_OP_NO_TLSv1
           Do not use the TLSv1 protocol.

       SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION
           When performing renegotiation as a server, always start a new session (i.e., session resumption
           requests are only accepted in the initial handshake).  This option is not needed for clients.

<b>RETURN</b> <b>VALUES</b>
       <u>SSL</u><b>_</b><u>CTX</u><b>_</b><u>set</u><b>_</b><u>options()</u> and <u>SSL</u><b>_</b><u>set</u><b>_</b><u>options()</u> return the new options bitmask after adding <b>options</b>.

       <u>SSL</u><b>_</b><u>CTX</u><b>_</b><u>get</u><b>_</b><u>options()</u> and <u>SSL</u><b>_</b><u>get</u><b>_</b><u>options()</u> return the current bitmask.

<b>SEE</b> <b>ALSO</b>
       <a href="ssl.3ssl.html#//apple_ref/doc/man/3/ssl"><u>ssl</u>(3)</a>, <a href="SSL_new.3ssl.html#//apple_ref/doc/man/3/SSL_new"><u>SSL</u><b>_</b><u>new</u>(3)</a>, <a href="SSL_clear.3ssl.html#//apple_ref/doc/man/3/SSL_clear"><u>SSL</u><b>_</b><u>clear</u>(3)</a>, <a href="SSL_CTX_set_tmp_dh_callback.3ssl.html#//apple_ref/doc/man/3/SSL_CTX_set_tmp_dh_callback"><u>SSL</u><b>_</b><u>CTX</u><b>_</b><u>set</u><b>_</b><u>tmp</u><b>_</b><u>dh</u><b>_</b><u>callback</u>(3)</a>, <a href="SSL_CTX_set_tmp_rsa_callback.3ssl.html#//apple_ref/doc/man/3/SSL_CTX_set_tmp_rsa_callback"><u>SSL</u><b>_</b><u>CTX</u><b>_</b><u>set</u><b>_</b><u>tmp</u><b>_</b><u>rsa</u><b>_</b><u>callback</u>(3)</a>,
       <a href="../man1/dhparam.1ssl.html#//apple_ref/doc/man/1/dhparam"><u>dhparam</u>(1)</a>

<b>HISTORY</b>
       <b>SSL_OP_CIPHER_SERVER_PREFERENCE</b> and <b>SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION</b> have been added in
       OpenSSL 0.9.7.

       <b>SSL_OP_TLS_ROLLBACK_BUG</b> has been added in OpenSSL 0.9.6 and was automatically enabled with
       <b>SSL_OP_ALL</b>. As of 0.9.7, it is no longer included in <b>SSL_OP_ALL</b> and must be explicitly set.

       <b>SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS</b> has been added in OpenSSL 0.9.6e.  Versions up to OpenSSL 0.9.6c
       do not include the countermeasure that can be disabled with this option (in OpenSSL 0.9.6d, it was
       always enabled).



0.9.7l                                           2005-10-11                           <a href="SSL_CTX_set_options.3ssl.html#//apple_ref/doc/man/3/SSL_CTX_set_options">SSL_CTX_set_options(3)</a>
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man3/SSL_get_options.3ssl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man3/SSL_get_options.3ssl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man3/SSL_get_options.3ssl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
