<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>MenuSelect(IM:Tb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING133></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Toolbox-132.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-134.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Toolbox-2.html"><B>Macintosh Toolbox Essentials</B></A> / <BR><DD><A HREF="Toolbox-89.html"><B>Chapter 3 - Menu Manager</B></A> / <A HREF="Toolbox-107.html"><B>Menu Manager Reference</B></A><BR><DL><DD><A HREF="Toolbox-112.html"><B>Menu Manager Routines</B></A> / <A HREF="Toolbox-132.html"><B>Responding to the User's Choice of a Menu Command</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING133-0></A>
<H3>MenuSelect</H3>
 <A NAME=MARKER-11-545></A><A NAME=MARKER-2-546></A>Use the <CODE>MenuSelect</CODE> function to allow the user to choose a menu item from the menus in your application's menu bar. <P>
<PRE>
FUNCTION MenuSelect (startPt: Point): LongInt;
</PRE>
<DL>
<DT><CODE>startPt</CODE>
<DD> The point (in global coordinates) representing the location of the cursor at the time the mouse button was pressed.
</DL>
<A NAME=HEADING133-4></A>
<H5>DESCRIPTION</H5>
 When the user presses the mouse button while the cursor is in the menu bar, your application receives a mouse-down event. To handle mouse-down events in the menu bar, pass the location of the cursor at the time of the mouse-down event as the <CODE>startPt</CODE> parameter to <CODE>MenuSelect</CODE>. The <CODE>MenuSelect</CODE> function displays and removes menus as the user moves the cursor over menu titles in the menu bar, and it handles all user interaction until the user releases the mouse button.<P>
 As the user drags the cursor through the menu bar, the <CODE>MenuSelect</CODE> function highlights the title of the menu the cursor is currently over and displays all items in that menu. If the user moves the cursor so that it is over a different menu, the <CODE>MenuSelect</CODE> function removes the previous menu and unhighlights its menu title.<P>
 The <CODE>MenuSelect</CODE> function highlights and unhighlights menu items as the user drags the cursor over the items in a menu. The <CODE>MenuSelect</CODE> function highlights a menu item if the item is enabled and the cursor is currently over it; it removes such highlighting when the user moves the cursor to another menu item. The <CODE>MenuSelect</CODE> function does not highlight disabled menu items.<P>
 If the user chooses an enabled menu item (including any item from a submenu), the <CODE>MenuSelect</CODE> function returns a value as its function result that indicates which menu and menu item the user chose. The high-order word of the function result contains the menu ID of the menu, and the low-order word contains the item number of the menu item chosen by the user. The <CODE>MenuSelect</CODE> function leaves the menu title highlighted; after performing the chosen task your application should unhighlight the menu title using the <CODE>HiliteMenu</CODE> procedure.<P>
 If the user chooses an item from a submenu, <CODE>MenuSelect</CODE> returns the menu ID of the submenu in the high-order word and the item chosen by the user in the low-order word of its function result. The <CODE>MenuSelect</CODE> function also highlights the title of the menu in the menu bar that the user originally displayed in order to begin traversing to the submenu. After performing the chosen task, your application should unhighlight the menu title.<P>
 If the user releases the mouse button while the cursor is over a disabled item, in the menu bar, or outside of any menu, the <CODE>MenuSelect</CODE> function returns 0 in the high-order word of its function result and the low-order word is undefined. If it is necessary for your application to find the item number of the disabled item, your application can call <CODE>MenuChoice</CODE> to return the menu ID and menu item.<P>
 If the user chooses an enabled item in a menu that a desk accessory has inserted into your application's menu list, <CODE>MenuSelect</CODE> uses the <CODE>SystemMenu</CODE> procedure to process this occurrence and returns 0 to your application in the high-order word.<P>
<A NAME=HEADING133-12></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 When the <CODE>MenuSelect</CODE> function pulls down a menu, it stores the bits behind the menu as a relocatable object in the application heap of your application. <P>
<A NAME=HEADING133-14></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The <CODE>InitMenus</CODE> and <CODE>InitProcMenu</CODE> procedures initialize the <CODE>MenuHook</CODE> and <CODE>MBarHook</CODE> global variables to 0. If you choose, you can store the addresses of routines that <CODE>MenuSelect</CODE> calls in these global variables. The <CODE>MenuHook</CODE> global variable contains the address (if any) of a routine that <CODE>MenuSelect</CODE> calls repeatedly while the mouse button is down. <CODE>MenuSelect</CODE> does not pass any parameters to this routine.<P>
 The <CODE>MBarHook</CODE> global variable contains the address (if any) of a routine that <CODE>MenuSelect</CODE> calls after a menu title is highlighted and the menu rectangle is calculated but before the menu is drawn. The menu rectangle is the rectangle (in global coordinates) in which the menu will be drawn. <CODE>MenuSelect</CODE> passes a pointer to the menu rectangle on the stack. If you provide the address of a routine in the <CODE>MBarHook</CODE> global variable, it should normally return 0 in the D0 register, indicating that <CODE>MenuSelect</CODE> should continue; returning 1 causes <CODE>MenuSelect</CODE> to cancel its operation and return immediately to the application.<P>
 The <CODE>MenuSelect</CODE> function uses the global variable <CODE>MBarEnable</CODE> to determine if all menus in the current menu bar belong to a desk accessory or an application. If the <CODE>MBarEnable</CODE> global variable is nonzero, then all menus in the current menu bar belong to a desk accessory. If the <CODE>MBarEnable</CODE> global variable is 0, then all menus in the current menu bar belong to an application. If you're writing a desk accessory, you may need to set the <CODE>MBarEnable</CODE> global variable to a nonzero value; if you're writing an application, you should not change the value of the <CODE>MBarEnable</CODE> global variable.<P>
 The global variable <CODE>TheMenu</CODE> contains the ID of the currently highlighted menu in the menu bar. If the user chooses an item from a submenu, <CODE>TheMenu</CODE> contains the menu ID of the submenu, not the menu to which the submenu is attached. <P>
<A NAME=HEADING133-19></A>
<H5>SEE ALSO</H5>
 For information on adjusting your application's menus before calling <CODE>MenuSelect</CODE>, see <A HREF=Toolbox-103.html#MARKER-9-397>"Adjusting the Menus of an Application" beginning on page 3-73</A>.<P>
 See the description of the <CODE>HiliteMenu</CODE> procedure on <A HREF=Toolbox-136.html#MARKER-9-556>page 3-121</A> for  details on how to unhighlight a menu. For information on how to determine if the user chose a disabled item, see the description of the <CODE>MenuChoice</CODE> function on <A HREF=Toolbox-135.html#MARKER-9-552>page 3-120</A>. <A NAME=MARKER-9-627></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Toolbox-132.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-134.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Toolbox-3.html">&copy; Apple Computer, Inc.</A><br>11 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
