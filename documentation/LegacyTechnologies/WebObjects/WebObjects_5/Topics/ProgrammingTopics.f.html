<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML EXPERIMENTAL 970324//EN"><HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><TITLE> Generating a Static Site</TITLE></HEAD><BODY bgcolor="#ffffff">		<!-- start of header -->		<!--#include virtual="/includes/framesetheader" -->		<!-- end of header --><!-- start of path --><table cellspacing=0 border=0 width=600 valign="left"><tr><td scope="row"><font face="Geneva,Helvetica,Arial" size="1"><b>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="../../index.html" target="_top">Documentation</a> <b>></b> <a href="../webobjects.html" target="_top">WebObjects</a></font></td></tr></table><br><!-- end of path --><DIV><a name="top"></a><A HREF="TopicsTOC.html"><img src="up.gif" border="0" alt="Up"></A><nobr>&nbsp;</nobr><A HREF="ProgrammingTopics.e.html"><img src="previous.gif" border="0" alt="Previous"></A><nobr>&nbsp;</nobr><A HREF="ProgrammingTopics.10.html"><img src="next.gif" border="0" alt="Next"></A></DIV><H1 CLASS="TopictTitle"><A NAME="pgfId=606100"> </A><A NAME="30670"> </A>Generating a Static Site</H1><DIV><H2 CLASS="Synopsis"><A NAME="pgfId=606101"> </A>Synopsis</H2><P CLASS="Body"><A NAME="pgfId=606102"> </A>Describes how to use WebObjects to generate a static Web site.</P></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606103"> </A>Discussion</H2><P CLASS="Body"><A NAME="pgfId=606104"> </A>WebObjects eases the development of dynamic Web-based applications that build HTML pages at run-time. However, there are times you need to generate static Web sites from dynamic WebObjects applications. For example, a publishing company may want to distribute its Web site that features magazines on CDs to its readers. In this case, the company will be looking for a solution that not only allows Internet users to surf the site dynamically, but also put the site onto a CD so that other users can surf it statically. </P><P CLASS="Body"><A NAME="pgfId=606105"> </A>This example called &quot;Dynamic Publishing&quot; illustrates how to generate a static site from a WebObjects application.</P><DIV><H3 CLASS="Heading2"><A NAME="pgfId=606106"> </A>Implementing the Dynamic Elements</H3><P CLASS="Body"><A NAME="pgfId=606107"> </A>When writing a WebObjects application that supports static page generation, you must pay attention to those dynamic elements that link to another page (for example, WOHyperlink, WOActiveImage). These elements should refer to the URL of a HTML file in the static site. </P><P CLASS="Body"><A NAME="pgfId=606108"> </A>In its simplest form, you can use the <TT CLASS="Code">href</TT> attributes in WOHyperlink and WOActiveImage to define the location of the HTML file. However, this means that these elements will only behave correctly when surfed statically. To use the same element, the same component, and, hence, the same WebObjects application to work in both dynamically and statically, you must build a dynamic element that changes its identity according to whether the application is static or dynamic. One way to achieve this is to use WOSwitchComponent.</P><DIV><H4 CLASS="Code-Listing"><A NAME="pgfId=609240"> </A>VSLINK.WOD</H4><PRE CLASS="Code"><A NAME="pgfId=609242"> </A>SwitchLink: WOSwitchComponent {<A NAME="pgfId=609244"> </A>	      _componentName = linkComponent;<A NAME="pgfId=609246"> </A>	      labelValue = theLabelValue;<A NAME="pgfId=609248"> </A>	      currentDoc = theCurrentDocument;<A NAME="pgfId=609250"> </A>       }</PRE></DIV><DIV><H4 CLASS="Code-Listing"><A NAME="pgfId=609264"> </A>VSLINK.WOS</H4><PRE CLASS="Code"><A NAME="pgfId=609266"> </A>id theLabelValue, theCurrentDocument;<A NAME="pgfId=609268"> </A>- linkComponent {<A NAME="pgfId=609270"> </A>    if ([[self application] isStaticSite])<A NAME="pgfId=609272"> </A>        return @&quot;StaticLink&quot;;<A NAME="pgfId=609274"> </A>    else<A NAME="pgfId=609276"> </A>        return @&quot;DynamicLink&quot;;<A NAME="pgfId=609278"> </A>}</PRE><P CLASS="Body"><A NAME="pgfId=614020"> </A></P><P CLASS="Body"><A NAME="pgfId=606129"> </A>Both <TT CLASS="Code">StaticLink</TT> and <TT CLASS="Code">DynamicLink</TT> are WOHyperlinks. <TT CLASS="Code">StaticLink</TT> has a <TT CLASS="Code">href</TT> attribute that specifies a static URL and <TT CLASS="Code">DynamicLink</TT> has an action that returns a WebObjects response. </P></DIV><DIV><H4 CLASS="Code-Listing"><A NAME="pgfId=614032"> </A>STATICLINK.WOD</H4><PRE CLASS="Code"><A NAME="pgfId=614034"> </A>AStaticLink: WOHyperlink {<A NAME="pgfId=614036"> </A>	string = labelValue;<A NAME="pgfId=614038"> </A>	href = documentStaticPage;<A NAME="pgfId=614040"> </A>	disabled = isDisable;<A NAME="pgfId=614042"> </A>};</PRE></DIV><DIV><H4 CLASS="Code-Listing"><A NAME="pgfId=609302"> </A>DYNAMICLINK.WOD</H4><PRE CLASS="Code"><A NAME="pgfId=609304"> </A>ADynamicLink: WOHyperlink {<A NAME="pgfId=609306"> </A>	string = labelValue;<A NAME="pgfId=609308"> </A>	action = gotoDocument;<A NAME="pgfId=609310"> </A>	disabled = isDisable;<A NAME="pgfId=609312"> </A>};</PRE><P CLASS="Body"><A NAME="pgfId=614048"> </A></P><P CLASS="Body"><A NAME="pgfId=606147"> </A>The template that uses this component has the following declaration:</P></DIV><DIV><H4 CLASS="Code-Listing"><A NAME="pgfId=609319"> </A>WebScript Code</H4><PRE CLASS="Code"><A NAME="pgfId=609321"> </A>RelatedDocumentLink: VSLink<A NAME="pgfId=609323"> </A>{<A NAME="pgfId=609325"> </A>	theLabelValue = aRelatedDocument.name;<A NAME="pgfId=609327"> </A>	theCurrentDocument = aRelatedDocument;<A NAME="pgfId=609329"> </A>};</PRE><P CLASS="Body"><A NAME="pgfId=614049"> </A></P></DIV></DIV><DIV><H3 CLASS="Heading2"><A NAME="pgfId=606154"> </A>Directory Structure and Filenames for the Static Site</H3><P CLASS="Body"><A NAME="pgfId=606155"> </A>When generating a static site, it is important to determine</P><UL><LI CLASS="Bulleted"><A NAME="pgfId=614052"> </A>a strategy for creating unique names for the HTML files that are generated</LI><LI CLASS="Bulleted"><A NAME="pgfId=614053"> </A>the directory structure of your static Web site</LI></UL><P CLASS="Body"><A NAME="pgfId=614057"> </A>in order to specify the correct URL for your images and links. The following are some suggestions of how to handle these two issues:</P><UL><LI CLASS="Bulleted"><A NAME="pgfId=609337"> </A>	Unique file name -- 	Each HTML file in the static site must be unique. In general, the primary key for the corresponding Enterprise Object is used to ensure uniqueness. In the Dynamic Publishing example, a document-type HTML file generated is named with the primary key of the document (for example, <TT CLASS="Code">23.HTML</TT>). If you want to make the name more meaningful, you can prepend the document name (for example, <TT CLASS="Code">iMac-23.HTML</TT>).</LI><LI CLASS="Bulleted"><A NAME="pgfId=606159"> </A>	Directory Structure -- A static site normally resides somewhere in the document root of your HTTP server. For example, with Microsoft IIS server, the static site should reside in<BR><TT CLASS="Code">/InetPub/wwwroot</TT>. In the Dynamic Publishing example, the static site has the following directory structure:</LI></UL><PRE CLASS="Code"><A NAME="pgfId=606161"> </A>/InetPub/wwwroot/StaticSite/doc0+/...HTML<A NAME="pgfId=606162"> </A>/InetPub/wwwroot/StaticSite/doc10+/...HTML<A NAME="pgfId=606163"> </A>/InetPub/wwwroot/StaticSite/3.HTML<A NAME="pgfId=606164"> </A>/InetPub/wwwroot/StaticSite/5.HTML<A NAME="pgfId=606165"> </A>/InetPub/wwwroot/StaticSite/index.HTML</PRE><P CLASS="Body"><A NAME="pgfId=606167"> </A><TT CLASS="Code">StaticSite</TT> is a subdirectory under the document root containing the static site that is generated. Inside the <TT CLASS="Code">StaticSite</TT> directory resides <TT CLASS="Code">index.html</TT>, which is the home page for the site. Any other HTML files at that level are section home pages. A document is placed in a subdirectory according to its primary key. For example, documents with primary keys from 11 to 20 will be in the subdirectory <TT CLASS="Code">doc10+</TT>. This approach is simple, effective, and requires minimum maintenance. </P></DIV><DIV><H3 CLASS="Heading2"><A NAME="pgfId=606168"> </A>How to Send a HTTP Request Programmatically</H3><P CLASS="Body"><A NAME="pgfId=606169"> </A>Typically, two processes are involved in generating a static site:</P><UL><LI CLASS="Bulleted"><A NAME="pgfId=606170"> </A>	A process that knows which HTML pages are required to be generated for the static site and fires the appropriate HTTP request to a WebObjects dynamic application.</LI><LI CLASS="Bulleted"><A NAME="pgfId=606171"> </A>A WebObjects dynamic application that acts as a page broker, taking in a HTTP request and building the response accordingly.</LI></UL><P CLASS="Body"><A NAME="pgfId=606173"> </A>The parameters that are passed to the WebObjects dynamic application are appended as form values at the end of the HTTP request. In the Dynamic Publishing example, the <TT CLASS="Code">documentId</TT> is appended as a form value of the HTTP request so that the Dynamic Page Generator receiving the request knows which document to generate. </P><P CLASS="Body"><A NAME="pgfId=606174"> </A>To fire a HTTP request from a process, you must open a socket programmatically. The simplest way to implement this is to use the Java socket class.</P><PRE CLASS="Code"><A NAME="pgfId=608287"> </A>Class javaSocketClass = NSClassFromString(@&quot;MyJavaSocket&quot;);<A NAME="pgfId=608289"> </A>Id    javaSocketObj = [javaSocketClass new];<A NAME="pgfId=608291"> </A><A NAME="pgfId=608293"> </A>[content setString: [javaSocketObj getContent: URLString]];<A NAME="pgfId=608295"> </A></PRE><P CLASS="Body"><A NAME="pgfId=606183"> </A>where URLString is probably something such as: </P><PRE CLASS="Code"><A NAME="pgfId=606184"> </A>http://python/scripts/WebObjects.exe/DynamicPageGenerator.woa?type=Document&amp;documentId=123</PRE><P CLASS="Body"><A NAME="pgfId=606185"> </A>getContent in MyJavaSocket uses the Java URL class to fire the HTTP request:</P><PRE CLASS="Code"><A NAME="pgfId=608310"> </A>public String getContent(String URLPath) {<A NAME="pgfId=608312"> </A>   String contentString = null;<A NAME="pgfId=608314"> </A>   try {<A NAME="pgfId=608316"> </A>        URL aURL = new URL(URLPath);<A NAME="pgfId=608318"> </A>        URLConnection aURLConnection;<A NAME="pgfId=608320"> </A>        try {<A NAME="pgfId=608322"> </A>            byte buffer[] = new byte[20000];					<A NAME="pgfId=608324"> </A>            StringBuffer responseBuff = new StringBuffer();<A NAME="pgfId=608326"> </A>            int totalBytesRead = 0;<A NAME="pgfId=608328"> </A>            int bytesRead = -1;<A NAME="pgfId=608330"> </A>            int i;<A NAME="pgfId=608332"> </A>            aURLConnection = aURL.openConnection();<A NAME="pgfId=608334"> </A>            InputStream aInputStream=aURLConnection.getInputStream();<A NAME="pgfId=608336"> </A>            bytesRead = aInputStream.read(buffer);<A NAME="pgfId=608338"> </A>            while (bytesRead &gt; 0) {<A NAME="pgfId=608340"> </A>                totalBytesRead += bytesRead;<A NAME="pgfId=608342"> </A>                for (i=0; i&lt;bytesRead; i++) {<A NAME="pgfId=608344"> </A>                    responseBuff.append((char)buffer[i]);<A NAME="pgfId=608346"> </A>                }<A NAME="pgfId=608348"> </A>                bytesRead = aInputStream.read(buffer);<A NAME="pgfId=608350"> </A>            }<A NAME="pgfId=608352"> </A>            contentString = responseBuff.toString();<A NAME="pgfId=608354"> </A>        }<A NAME="pgfId=618493"> </A>    }<A NAME="pgfId=608358"> </A>    return contentString;<A NAME="pgfId=608360"> </A>}</PRE><P CLASS="Body"><A NAME="pgfId=618458"> </A></P></DIV><DIV><H3 CLASS="Heading2"><A NAME="pgfId=606218"> </A>Handling Changes After the Static Site is Generated</H3><P CLASS="Body"><A NAME="pgfId=613144"> </A>Once the site is generated, you must think about how to handle the subsequent changes. How often do you want the changes to propagate to the static site? How do you determine which documents to regenerate when changes are made? The answers depend on the application. Consider a magazine web site, whose contents are updated once a month when a new issue is published. A simple approach, generating a new static site each month, suffices. However, for a Web site that provides 24-hour news to Internet users, the application logic that chooses the documents to regenerate becomes more complex.</P></DIV><DIV><H3 CLASS="Heading2"><A NAME="pgfId=613145"> </A>Limitations of Static Sites</H3><P CLASS="Body"><A NAME="pgfId=606221"> </A>Since the site generated is effectively a static site, the limitations of a manually developed static site applies to a dynamically generated static site as well. For example, there will be no support for direct interaction with the users and, hence, no support for Form elements.</P></DIV></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606224"> </A>See Also</H2><UL><LI CLASS="Bulleted"><A NAME="pgfId=614063"> </A>WOSwitchComponent specification in the <EM CLASS="Emphasis">WebObjects Dynamic Element Specifications</EM></LI></UL></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=614062"> </A>Questions</H2><UL><LI CLASS="Bulleted"><A NAME="pgfId=606225"> </A>	How do I generate a static site dynamically?</LI><LI CLASS="Bulleted"><A NAME="pgfId=606226"> </A>	How do I programmatically fire a HTTP request to a WebObjects application?</LI></UL></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606227"> </A>Keywords</H2><UL><LI CLASS="Bulleted"><A NAME="pgfId=606228"> </A>Static</LI><LI CLASS="Bulleted"><A NAME="pgfId=618588"> </A>Site</LI></UL></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606230"> </A>Revision History</H2><P CLASS="Body"><A NAME="pgfId=606231"> </A>20 July, 1998. Winnie Pun. First Draft.<BR>19 November, 1998. Clif Liu. Second Draft.</P><PRE CLASS="Code"><A NAME="pgfId=602450"> </A></PRE></DIV><hr alt="">&#169 1999 Apple Computer, Inc.<P><A HREF="TopicsTOC.html"><img src="up.gif" border="0" alt="Up"></A><nobr>&nbsp;</nobr><A HREF="ProgrammingTopics.e.html"><img src="previous.gif" border="0" alt="Previous"></A><nobr>&nbsp;</nobr><A HREF="ProgrammingTopics.10.html"><img src="next.gif" border="0" alt="Next"></A><!-- start of footer --><!--#include file="footer" --><!-- end of footer --><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></HTML>