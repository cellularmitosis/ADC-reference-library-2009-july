<html><head><title>Mac OS X
 Manual Page For unvis(3)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/3/unvis" title="Mac OS X
 Manual Page for unvis(3)"><!-- headerDoc=man; indexgroup=Section 3; uid="//apple_ref/doc/man/3/unvis"; name=unvis(3) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
UNVIS(3)                 BSD Library Functions Manual                 UNVIS(3)

<b>NAME</b>
     <b>unvis</b>, <b>strunvis</b> -- decode a visual representation of characters

<b>LIBRARY</b>
     Standard C Library (libc, -lc)

<b>SYNOPSIS</b>
     <b>#include</b> <b>&lt;vis.h&gt;</b>

     <u>int</u>
     <b>unvis</b>(<u>char</u> <u>*cp</u>, <u>int</u> <u>c</u>, <u>int</u> <u>*astate</u>, <u>int</u> <u>flag</u>);

     <u>int</u>
     <b>strunvis</b>(<u>char</u> <u>*dst</u>, <u>const</u> <u>char</u> <u>*src</u>);

     <u>int</u>
     <b>strunvisx</b>(<u>char</u> <u>*dst</u>, <u>const</u> <u>char</u> <u>*src</u>, <u>int</u> <u>flag</u>);

<b>DESCRIPTION</b>
     The <b>unvis</b>(), <b>strunvis</b>() and <b>strunvisx</b>() functions are used to decode a visual representation of charac-<font color="#ffffff" class="whiteout">ters,&nbsp;characters,</font>
     ters, as produced by the <a href="vis.3.html#//apple_ref/doc/man/3/vis">vis(3)</a> function, back into the original form.  Unvis is called with successive
     characters in <u>c</u> until a valid sequence is recognized, at which time the decoded character is available
     at the character pointed to by <u>cp</u>.  Strunvis decodes the characters pointed to by <u>src</u> into the buffer
     pointed to by <u>dst</u>.

     The <b>strunvis</b>() function simply copies <u>src</u> to <u>dst</u>, decoding any escape sequences along the way, and
     returns the number of characters placed into <u>dst</u>, or -1 if an invalid escape sequence was detected.
     The size of <u>dst</u> should be equal to the size of <u>src</u> (that is, no expansion takes place during decoding).

     The <b>strunvisx</b>() function does the same as the <b>strunvis</b>() function, but it allows you to add a flag that
     specifies the style the string <u>src</u> is encoded with.  Currently, the only supported flag is
     VIS_HTTPSTYLE.

     The <b>unvis</b>() function implements a state machine that can be used to decode an arbitrary stream of
     bytes.  All state associated with the bytes being decoded is stored outside the <b>unvis</b>() function (that
     is, a pointer to the state is passed in), so calls decoding different streams can be freely intermixed.
     To start decoding a stream of bytes, first initialize an integer to zero.  Call <b>unvis</b>() with each suc-<font color="#ffffff" class="whiteout">cessive&nbsp;successive</font>
     cessive byte, along with a pointer to this integer, and a pointer to a destination character.  The
     <b>unvis</b>() function has several return codes that must be handled properly.  They are:

     0 (zero)         Another character is necessary; nothing has been recognized yet.

     UNVIS_VALID      A valid character has been recognized and is available at the location pointed to by
                      cp.

     UNVIS_VALIDPUSH  A valid character has been recognized and is available at the location pointed to by
                      cp; however, the character currently passed in should be passed in again.

     UNVIS_NOCHAR     A valid sequence was detected, but no character was produced.  This return code is
                      necessary to indicate a logical break between characters.

     UNVIS_SYNBAD     An invalid escape sequence was detected, or the decoder is in an unknown state.  The
                      decoder is placed into the starting state.

     When all bytes in the stream have been processed, call <b>unvis</b>() one more time with <u>flag</u> set to UNVIS_END
     to extract any remaining character (the character passed in is ignored).

     The <u>flag</u> argument is also used to specify the encoding style of the source.  If set to VIS_HTTPSTYLE,
     <b>unvis</b>() will decode URI strings as specified in RFC 1808.

     The following code fragment illustrates a proper use of <b>unvis</b>().

           int state = 0;
           char out;

           while ((ch = getchar()) != EOF) {
           again:
                   switch(unvis(&amp;out, ch, &amp;state, 0)) {
                   case 0:
                   case UNVIS_NOCHAR:
                           break;
                   case UNVIS_VALID:
                           (void) putchar(out);
                           break;
                   case UNVIS_VALIDPUSH:
                           (void) putchar(out);
                           goto again;
                   case UNVIS_SYNBAD:
                           (void)fprintf(stderr, "bad sequence!\n");
                   <a href="../man1/exit.1.html#//apple_ref/doc/man/1/exit">exit(1)</a>;
                   }
           }
           if (unvis(&amp;out, (char)0, &amp;state, UNVIS_END) == UNVIS_VALID)
                   (void) putchar(out);

<b>SEE</b> <b>ALSO</b>
     <a href="../man1/vis.1.html#//apple_ref/doc/man/1/vis">vis(1)</a>, <a href="vis.3.html#//apple_ref/doc/man/3/vis">vis(3)</a>

     R. Fielding, <u>Relative</u> <u>Uniform</u> <u>Resource</u> <u>Locators</u>, RFC1808.

<b>HISTORY</b>
     The <b>unvis</b>() function first appeared in 4.4BSD.

BSD                            December 11, 1993                           BSD
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man3/unvis.3.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man3/unvis.3.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man3/unvis.3.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
