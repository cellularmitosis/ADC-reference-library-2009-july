<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>JavaScript Scripting Guide for QuickTime: QuickTime and JavaScript</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="QuickTime and JavaScript"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001526-CH001" title="QuickTime and JavaScript"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000433" target="_top">QuickTime</a> &gt; <a href="../../../Scripting-date.html#//apple_ref/doc/uid/TP30000440-TP30000433-TP30000569" target="_top">Scripting &amp; Automation</a> &gt; <a href="../aQTScripting_Javascro_AIntro/Introduction%20to%20JavaScript%20QT.html#//apple_ref/doc/uid/TP40001526-IntroCH001-DontLinkElementID_20">JavaScript Scripting Guide for QuickTime</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../aQTScripting_Javascro_AIntro/Introduction to JavaScript QT.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../cQTScripting_JavaScri_RevHistory/revisionhistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40001526-CH001-QuickTimeandJavaScript" title="QuickTime and JavaScript"></a><h1>QuickTime and JavaScript</h1><p>Recent versions of the QuickTime plug-in are fully scriptable using JavaScript in most browsers for the Mac OS and Windows.</p><p>There are a few different ways to use JavaScript with QuickTime: you can use JavaScript to detect whether QuickTime is installed; you can use JavaScript to write the OBJECT and EMBED tags used to display QuickTime content; and you can control the QuickTime plug-in directly using JavaScript.</p><p>The QuickTime browser plug-in comes in multiple flavors. There are traditional Netscape-style plug-ins for the Mac OS and Windows, COM objects and ActiveX controls for Internet Explorer on Windows, and a Cocoa plug-in for Safari. All of these plug-ins present the exact same interfaces to JavaScript, as described in this document.</p><p>In addition to the QuickTime browser plug-in, QuickTime 7 and later include an ActiveX control that is scriptable using the COM interface from Visual Basic, JavaScript, or C#. That ActiveX control is not the same as the ActiveX version of the QuickTime browser plug-in. This document describes the JavaScript interface to QuickTime browser plug-ins, for client-side scripts running in a browser. If you want to develop Windows desktop applications or server-side scripts on the Windows OS using JavaScript and QuickTime, see <em><a href="../../QT7Win_Update_Guide/index.html#//apple_ref/doc/uid/TP40002476" target="_top">QuickTime 7 for Windows Update Guide</a></em>.</p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_22" title="Important:"></a><p><strong>Important:</strong>&nbsp;Starting with QuickTime 7.1.5, you can no longer issue javascript:// URLs or call JavaScript functions directly from within a QuickTime movie. This feature was removed from QuickTime for security reasons. There are workarounds, however. See <span class="content_text"><a href="QuickTimeandJavaScri.html#//apple_ref/doc/uid/TP40001526-CH001-SW4">“Executing JavaScript Functions From QuickTime”</a></span> for examples.</p><p></p></div>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="QuickTimeandJavaScri.html#//apple_ref/doc/uid/TP40001526-CH001-SW1">Using JavaScript to Detect QuickTime</a>
				
			<br/>
			
        
			
			
				<a href="QuickTimeandJavaScri.html#//apple_ref/doc/uid/TP40001526-CH001-SW3">Using JavaScript to Embed QuickTime Content</a>
				
			<br/>
			
        
			
			
				<a href="QuickTimeandJavaScri.html#//apple_ref/doc/uid/TP40001526-CH001-SW4">Executing JavaScript Functions From QuickTime</a>
				
			<br/>
			
        
			
			
				<a href="QuickTimeandJavaScri.html#//apple_ref/doc/uid/TP40001526-CH001-SW5">Controlling QuickTime Using JavaScript</a>
				
			<br/>
			
        
			
			
				<a href="QuickTimeandJavaScri.html#//apple_ref/doc/uid/TP40001526-CH001-SW6">QuickTime DOM Events</a>
				
			<br/>
			
        
			
			
				<a href="QuickTimeandJavaScri.html#//apple_ref/doc/uid/TP40001526-CH001-SW7">QuickTime JavaScript Reference</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001526-CH001-SW1" title="Using JavaScript to Detect QuickTime"></a><h2><a name="//apple_ref/doc/uid/TP40001526-CH001-UsingJavaScripttoDetectQuickTime" title="Using JavaScript to Detect QuickTime"></a>Using JavaScript to Detect QuickTime</h2><p>JavaScript can be used to detect the QuickTime plug-in in most versions of most browsers on Windows and the Mac OS. The details vary slightly by browser, but a single script can be written that works with all supported browsers.</p><p>Most browsers other than Internet Explorer for Windows (including Netscape, Mozilla-based browsers, Safari, and Internet Explorer for Macintosh version 5) support the JavaScript <code>navigator.plugins.name</code> array. You can detect whether the user has the QuickTime plug-in installed by testing this array for “QuickTime.”</p><p>Internet Explorer for Windows does not support the <code>navigator.plugins</code> array, but does allow you to use VBScript to detect whether the QuickTime plug-in is installed (by testing for the presence of the QuickTime ActiveX control).</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_23" title="Note"></a><p><strong>Note:</strong>&nbsp;The QuickTime ActiveX control was introduced as part of QuickTime 4.1 </p></div><p>The following listing contains an example script that detects the user’s operating system, browser type, and browser version, uses JavaScript to test for the QuickTime plug-in, uses VBScript to test for the QuickTime COM object, and detects users running older versions of Internet Explorer for Macintosh (making the assumption that these users also have QuickTime installed). This listing sets the variable <code>haveqt</code> either <code>true</code> or <code>false.</code></p><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_24" title="Listing 1-1Detecting QuickTime with JavaScript"></a><p class="codesample"><strong>Listing 1-1&nbsp;&nbsp;</strong>Detecting QuickTime with JavaScript</p><div class="codesample"><table><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>&lt;HEAD><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;TITLE>Test for QuickTime&lt;/TITLE><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>&lt;SCRIPT LANGUAGE="Javascript" type="text/javascript"><span></span></pre></td></tr><tr><td scope="row"><pre>var haveqt = false;<span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/SCRIPT><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>&lt;SCRIPT LANGUAGE="VBScript"><span></span></pre></td></tr><tr><td scope="row"><pre>On Error Resume Next<span></span></pre></td></tr><tr><td scope="row"><pre>Set theObject =<span></span></pre></td></tr><tr><td scope="row"><pre>CreateObject("QuickTimeCheckObject.QuickTimeCheck.1")<span></span></pre></td></tr><tr><td scope="row"><pre>On Error goto 0<span></span></pre></td></tr><tr><td scope="row"><pre>If IsObject(theObject) Then<span></span></pre></td></tr><tr><td scope="row"><pre>If theObject.IsQuickTimeAvailable(0) Then<span></span></pre></td></tr><tr><td scope="row"><pre>haveqt = true<span></span></pre></td></tr><tr><td scope="row"><pre>End If<span></span></pre></td></tr><tr><td scope="row"><pre>End If<span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/SCRIPT><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>&lt;SCRIPT LANGUAGE="Javascript" type="text/javascript"><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>if (navigator.plugins) {<span></span></pre></td></tr><tr><td scope="row"><pre>for (i=0; i &lt; navigator.plugins.length; i++ ) {<span></span></pre></td></tr><tr><td scope="row"><pre>if (navigator.plugins[i].name.indexOf<span></span></pre></td></tr><tr><td scope="row"><pre>("QuickTime") >= 0)<span></span></pre></td></tr><tr><td scope="row"><pre>{ haveqt = true; }<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>if ((navigator.appVersion.indexOf("Mac") > 0)<span></span></pre></td></tr><tr><td scope="row"><pre>&amp;&amp; (navigator.appName.substring(0,9) == "Microsoft")<span></span></pre></td></tr><tr><td scope="row"><pre>&amp;&amp; (parseInt(navigator.appVersion) &lt; 5) )<span></span></pre></td></tr><tr><td scope="row"><pre>{ haveqt = true; }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/SCRIPT><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/HEAD><span></span></pre></td></tr></table></div><p>If you insert this JavaScript into the <code>&lt;HEAD></code> element of your HTML, you can test the variable <code>haveqt</code> for the presence of QuickTime. You might, for example, want to write the <code>&lt;EMBED></code> and <code>&lt;OBJECT></code> tags for a movie using JavaScript, writing the tags only if QuickTime is installed. Or you might want to redirect users without QuickTime to an alternate page.</p><a name="//apple_ref/doc/uid/TP40001526-CH001-SW3" title="Using JavaScript to Embed QuickTime Content"></a><h2>Using JavaScript to Embed QuickTime Content</h2><p>Apple provides a JavaScript utility to generate the required tags to embed QuickTime content in a web page. Using this utility greatly simplifies the necessary code to embed a movie, as it automatically supplies such information as the QuickTime Class ID, code base, and plugins page. This has two main advantages over typing the tags manually: it requires much less code; and it works seamlessly with Internet Explorer for Windows, versions 6 and later, avoiding the “Click OK to enable ActiveX control” dialog box.</p><p>To use the utility, first download the JavaScript file, <code>AC_QuickTime.js</code>, from <span class="content_text"><a href="http://developer.apple.com/internet/licensejs.html " target="_top">http://developer.apple.com/internet/licensejs.html</a></span>. </p><p>Include it in your web page by inserting the following line of code into your HTML head: </p><div class="codesample"><table><tr><td scope="row"><pre>&lt;script src="AC_QuickTime.js" language="javascript" type="text/javascript"> &lt;/script><span></span></pre></td></tr></table></div><p>Wherever you want QuickTime content to appear in your web page, place a line of JavaScript that calls the function <code>QT_WriteOBJECT( )</code>, passing the URL of the QuickTime content, the width and height of the display area, the preferred ActiveX version (typically left blank) and any optional QuickTime attributes. </p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_25" title="Important:"></a><p><strong>Important:</strong>&nbsp;The fourth parameter, the preferred ActiveX version, is typically left blank, but it can <em>not</em> be omitted. It is a mandatory entry.</p><p></p></div><p>A simple example follows.</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;script language="javascript" type="text/javascript"><span></span></pre></td></tr><tr><td scope="row"><pre>    QT_WriteOBJECT('MyMovie.mov' , '320', '240', '');<span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/script><span></span></pre></td></tr></table></div><p>At run time, this will generate the correct <code>&lt;OBJECT></code> and <code>&lt;EMBED></code> tags and insert them into your web page. This example passes the URL <code>MyMovie.mov</code>, the filename of a QuickTime movie in the same directory as the web page. The allocated width is 320 pixels, and the allocated height is 240 pixels. The ActiveX version is left blank, so it defaults to the most recent version.</p><p>Optional QuickTime parameters are passed as name/value pairs, that is, the name of the attribute is passed, followed by the value. An example follows.</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;script language="javascript" type="text/javascript"><span></span></pre></td></tr><tr><td scope="row"><pre>    QT_WriteOBJECT('../Movies/MyMovie.mov', '100%', '95%', '', 'AUTOPLAY', 'True', 'SCALE', 'Aspect') ;<span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/script><span></span></pre></td></tr></table></div><p>In this example, the URL is <code>../Movies/MyMovie.mov</code>, the allocated width is 100% of the browser window, the allocated height is 95% of the browser window, the ActiveX version is left blank, the <code>AUTOPLAY</code> attribute is set to <code>True</code>, and the <code>SCALE</code> attribute is set to <code>Aspect</code>. The movie will autoplay, scaled to fill almost the entire browser window, while preserving the movie’s aspect ratio.</p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_26" title="Important:"></a><p><strong>Important:</strong>&nbsp;Sometimes you need to pass a parameter only to the <code>&lt;OBJECT></code> tag, or only to the <code>&lt;EMBED></code> tag. For example, if you are using DOM events, you need to address objects by <code>ID</code> and the <code>&lt;EMBED></code> object and the <code>&lt;OBJECT></code> object must have unique <code>ID</code> values. To set a parameter for only the <code>&lt;OBJECT></code> tag, use the prefix <code>obj#</code>. To set a parameter for only the <code>&lt;EMBED></code> tag, use the <code>emb#</code> prefix.</p><p></p></div><p>The following example passes different IDs to the <code>&lt;OBJECT></code> and <code>&lt;EMBED></code> tags, and sets a name parameter for the <code>&lt;EMBED></code> tag that matches the <code>&lt;OBJECT></code> id. This allows you to monitor DOM events using the ID, regardless of whether the browser uses the <code>&lt;OBJECT></code> or <code>&lt;EMBED></code> tag, and also allows you to address the movie by name using the QuickTime JavaScript commands.</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;script language="javascript" type="text/javascript"><span></span></pre></td></tr><tr><td scope="row"><pre> QT_WriteOBJECT('MyMovie.mov' , '100%', '95%', '', 'SCALE', 'aspect', 'obj#ID', 'movieOBJ', 'emb#ID', 'movieEMBED') ;<span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/script><span></span></pre></td></tr></table></div><p>The <code>AC_QuickTime.js</code> script provides three additional functions which use the same input syntax as <code>QT_WriteOBJECT</code>:</p><ul class="ul"><li class="li"><p><code>QT_GenerateOBJECTText</code>—generates the same output as <code>QT_WriteOBJECT</code>, but instead of inserting it into your HTML, it returns the output as a text string, allowing you to inspect it or modify it.</p></li><li class="li"><p><code>QT_WriteOBJECT_XHTML</code>—generates and inserts the <code>OBJECT</code> and <code>EMBED</code> tags in your file using strict XHTML syntax, and should be used if you are embedding QuickTime in XHTML rather than HTML.</p></li><li class="li"><p><code>QT_GenerateOBJECTText_XHTML</code>—generates the same output as <code>QT_WriteOBJECT_XHTML</code>, but instead of inserting it into your XHTML, it returns it as a text strting.</p></li></ul><p>For more information on embedding QuickTime content in HTML, see <em><a href="../../QTScripting_HTML/index.html#//apple_ref/doc/uid/TP40001525" target="_top">HTML Scripting Guide for QuickTime</a></em>.</p><a name="//apple_ref/doc/uid/TP40001526-CH001-SW4" title="Executing JavaScript Functions From QuickTime"></a><h2><a name="//apple_ref/doc/uid/TP40001526-CH001-ExecutingJavaScriptFunctionsFromQuickTime" title="Executing JavaScript Functions From QuickTime"></a>Executing JavaScript Functions From QuickTime</h2><div class="importantbox"><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_27" title="Important:"></a><p><strong>Important:</strong>&nbsp;Starting with QuickTime 7.1.5, you can no longer issue javascript:// URLs or call JavaScript functions directly from within a QuickTime movie. This feature was removed from QuickTime for security reasons. If you need to call a JavaScript function from a movie, the recommended practice is to load an HTML page into an Iframe, and call the JavaScript function in the <code>ONLOAD</code> parameter of the Iframe page.</p><p></p></div><p>Several things can cause QuickTime to send a URL to the browser, such as the user clicking a hotspot in a QuickTimeVR panorama, clicking a movie that has an associated HREF, loading a sample in an HREF track (a type of text track containing URLs), or as the result of a wired action. Wired actions can be triggered by user interaction, as a result of a frame in the movie being displayed, or as the result of arbitrary wired calculations.</p><p>Sending URLs to a browser is supported in QuickTime 3 and later for movie HREFs, visual track HREFs, HREF track HREFs, and VR hotspots. Wired sprite actions in general are supported in QuickTime 4 and later (new wired actions have been introduced with various releases of QuickTime, so a particular wired action may require a later QuickTime version).</p><p>Sending javascript: URLs directly to the browser as part of a QuickTime URL is no longer supported.</p><p>In order to execute a JavaScript function from a movie in QuickTime 7.1.5 or later, you must load an HTML page that calls the desired JavaScript function. One way to make the user experience as seamless as possible is to load an HTML page into a hidden Iframe, with a single JavaScript function defined in the <code>&lt;head></code> element, set to execute <code>onload</code>. This way, loading the page is essentially the same as executing the JavaScript function.</p><p>If you need to call a JavaScript function defined on page that loads the movie, call it from the Iframe page using <code>parent.FunctionName()</code> addressing syntax.</p><p>For example, suppose you have a JavaScript function called <code>MyFunction()</code> that you wish to call from QuickTime. In the past you could call it directly. Now, you must call it indirectly. Here's how:</p><ol class="ol"><li class="li"><p>In the page that contains <code>MyFunction()</code>, create an invisible Iframe, like this:</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;iframe id="Iframe1" name="Iframe1"<span></span></pre></td></tr><tr><td scope="row"><pre>frameborder="0" vspace="0" hspace="0"<span></span></pre></td></tr><tr><td scope="row"><pre>marginwidth="0" marginheight="0" width="0" height="0"<span></span></pre></td></tr><tr><td scope="row"><pre>src="blank.html"><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/iframe><span></span></pre></td></tr></table></div><p>Note that the Iframe needs an initial source URL. This example uses "<code>blank.html</code>", an html page that has no content:</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;HTML><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;HEAD> &lt;TITLE>blank.html&lt;/TITLE> &lt;/HEAD><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;BODY> &lt;/BODY><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/HTML><span></span></pre></td></tr></table></div></li><li class="li"><p>Create a page intended to load into the Iframe. This page contains a single JavaScript function that calls <code>MyFunction()</code>. This new function, named <code>CallMyFunction()</code>, is called when the page loads, using the <code>onload</code> attribute of the <code>&lt;BODY></code> tag:</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;HTML><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;HEAD><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;TITLE>callmyfunction.html&lt;/TITLE><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;Script language="javascript" type="text/javascript"><span></span></pre></td></tr><tr><td scope="row"><pre>function CallMyFunction()<span></span></pre></td></tr><tr><td scope="row"><pre>{  parent.MyFunction();  }<span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/Script><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/HEAD><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;BODY onload="CallMyFunction()">  &lt;/BODY><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/HTML><span></span></pre></td></tr></table></div></li><li class="li"><p>Modify the URL called by the movie, from "<code>javascript:MyFunction();</code>" to "<code>&lt;http://CallMyFunction.html> T&lt;Iframe1></code>"</p><p>This changes the URL from <code>javascript:</code> to <code>http://</code> protocol, and loads the new page into the Iframe named "<code>Iframe1</code>". The new page calls <code>MyFunction()</code> in the parent page when it loads. For the user, the experience is the same as if the movie had called <code>MyFunction()</code> directly.

</p></li></ol><p>The following code example shows two HTML pages. The first page creates an Iframe, defines a function, <code>test()</code>, to be called from QuickTime, and embeds a movie. The second page, which will be loaded into the Iframe, defines a JavaScript function, <code>CallParentTest()</code>, that calls the <code>test()</code> function in the parent page. The <code>onload</code> attribute of the <code>BODY</code> tag is set to execute the <code>CallParentTest()</code> function when the second page loads.</p><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_28" title="Listing 1-2Executing a JavaScript function from QuickTime using an invisible Iframe"></a><p class="codesample"><strong>Listing 1-2&nbsp;&nbsp;</strong>Executing a JavaScript function from QuickTime using an invisible Iframe</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;html><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;head><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;Title>calltest.html (Page That Executes JavaScript test() Function Indirectly)&lt;/Title><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;script language="javascript" type="text/javascript"><span></span></pre></td></tr><tr><td scope="row"><pre>    function CallParentTest()<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>     parent.test();<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/script><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;body onload="CallParentTest()"><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/body><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/html><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>&lt;html><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;head><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;Title>&lt;Page that contains in invisible iFrame><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;script src="AC_QuickTime.js" language="javascript" type="text/javascript"> &lt;/script><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;script language="javascript" type="text/javascript"><span></span></pre></td></tr><tr><td scope="row"><pre>    function test()<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>     alert("JavaScript function called from QuickTime!");<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/script><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/head><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;body><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;h2>This Movie Calls JavaScript idirectly using an Iframe&lt;/h2><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;iframe  id="Iframe1"  name="Iframe1" frameborder="0"  vspace="0"  hspace="0"  marginwidth="0"  marginheight="0" width="2"  height="2"  src="blank.html"><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/iframe><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;script language="javascript" type="text/javascript"><span></span></pre></td></tr><tr><td scope="row"><pre>    QT_WriteOBJECT('MyMovie.mov' , '320', '240', '', 'HREF', '&lt;Calltest.html> T&lt;Iframe1>');<span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/script><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;p>Click on the display portion of the movie to execute the JavaScript alert() function.<span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/p><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/body><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/html><span></span></pre></td></tr></table></div><p>You can use this technique to execute any number of JavaScript functions from a movie. Just call each JavaScript function from its own HTML page with the page set to execute the function using the <code>onload</code> attribute of the <code>&lt;body></code> element. The JavaScript function can be defined entirely within the Iframe page, or it can call other JavaScript functions defined on the parent page using the <code>parent.functionName()</code> syntax.</p><p>Call the URL of the page with the target set to the name of the Iframe. Note that the syntax for specifying the URL includes the target Iframe: <code>‘&lt;url> T&lt;frameID>’</code>. This is true whether the URL is invoked from an <code>HREF</code>, <code>QTNEXTn</code>, or <code>HOTSPOT</code> parameter, for example.</p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_29" title="Important:"></a><p><strong>Important:</strong>&nbsp;A URL called from QuickTime cannot cross local/remote zone boundaries. If the movie is loaded using a remote protocol, such as <code>http://</code>, any URL called from the movie must also use a remote protocol (<code>http://</code> or <code>https:/</code> or <code>rtsp://</code>). A movie loaded via <code>http://</code> cannot call a <code>file:///</code> URL. Similarly, if the movie is loaded using a local <code>file:///</code> URL, it cannot call a remote URL (<code>http://</code>, for example).</p><p></p></div><a name="//apple_ref/doc/uid/TP40001526-CH001-SW5" title="Controlling QuickTime Using JavaScript"></a><h2><a name="//apple_ref/doc/uid/TP40001526-CH001-ControllingQuickTimeUsingJavaScript" title="Controlling QuickTime Using JavaScript"></a>Controlling QuickTime Using JavaScript</h2><p>QuickTime exposes a powerful set of objects, properties, and methods to JavaScript.  The objects include QuickTime itself, the browser plug-in, any embedded movies, and all the tracks within those movies.</p><p>The methods allow you to control a movie—start it, stop it, step it forward or back, or replace it with another movie. Setting properties allows you to control how a movie behaves—enable and disable tracks, select a language, change a video track’s size, position, and rotation, modify a sound track’s volume, set the movie’s rate of play and direction, set or unset looping, and so on.</p><p>Getting properties allows you to obtain information—the installed version of the QuickTime plug-in, the duration of a movie, what percentage of it has been downloaded, whether it is playing or has finished, how many tracks it has, and more.</p><p>Recent versions of the QuickTime plug-in are fully scriptable using JavaScript in most browsers for the Mac OS and Windows. There are exceptions, however, depending on the QuickTime version, browser type, browser version, and operating system.</p><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_4" title="Supported Interfaces"></a><h3><a name="//apple_ref/doc/uid/TP40001526-CH001-SupportedInterfaces" title="Supported Interfaces"></a>Supported Interfaces</h3><p>Not all browsers support communication between JavaScript and plug-ins. Those that support such communication do so using a variety of interfaces, including LiveConnect, COM (ActiveX), XPCOM, npruntime, and Cocoa. QuickTime currently supports all of these interfaces.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_30" title="Note"></a><p><strong>Note:</strong>&nbsp;Netscape first introduced JavaScript support using the LiveConnect interface. Netscape 6, FireFox, and Mozilla 1.0 support JavaScript using the newer XPCOM interface. Safari 1.3 and later for Macintosh also support a Cocoa interface. Internet Explorer for Windows allows JavaScript to interact with plug-ins using the COM interface. Current versions of Mozilla, Opera, and Safari for Windows and Macintosh support npruntime. </p></div><p>Support for LiveConnect was added to QuickTime in version 4.1. Support for COM, XPCOM, and Cocoa were added in QuickTime 6. Support for npruntime was added in QuickTime 7.1.6.</p><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_5" title="Supported Browsers and Operating Systems"></a><h3><a name="//apple_ref/doc/uid/TP40001526-CH001-SupportedBrowsersandOperatingSystems" title="Supported Browsers and Operating Systems"></a>Supported Browsers and Operating Systems</h3><p>The QuickTime plug-in is scriptable from all browsers that support the LiveConnect, XPCOM, Cocoa, npruntime, or COM interface. This includes all versions of Netscape and Mozilla for Windows and Macintosh, AOL 5 and later for Windows, Firefox, Opera, MSN 6 and later, and all versions of Internet Explorer for Windows.</p><p>In QuickTime 7 and later, the QuickTime plug-in is scriptable from the Safari browser; Safari 2.0 or later is required (Safari 1.3 or later is supported on Panther). Safari for Windows is also supported.</p><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_6" title="Before You Start"></a><h3><a name="//apple_ref/doc/uid/TP40001526-CH001-BeforeYouStart" title="Before You Start"></a>Before You Start</h3><p>The browser must load a copy of the QuickTime plug-in before you can query or control QuickTime using JavaScript. In addition, the interface between the browser and the plug-in must be initialized. In most cases, you also want to give an embedded movie a name so it can be addressed by name in your script.</p><p>This is accomplished by the following steps:</p><ul class="spaceabove"><li class="li"><p>Use the HTML <code>&lt;EMBED></code> tag and <code>&lt;OBJECT></code> tag to cause the browser to load a copy of the QuickTime plug-in.</p></li><li class="li"><p>Set the attribute  EnableJavaScript=”true” in the <code>&lt;EMBED></code> tag.</p></li><li class="li"><p>Set the <code>&lt;OBJECT></code> <code>id</code> attribute and the <code>&lt;EMBED></code><code>NAME</code> attribute to a name for the movie. Use the same name for both attributes.</p></li><li class="li"><p>If you are using QuickTime DOM events, set an <code>id</code> attribute for the <code>&lt;EMBED></code> tag as well, using a unique value.</p></li></ul><p>The easiest way to perform these steps is to include the <code>AC_QuickTime.js</code> script and pass the <code>name</code> and <code>id</code> attributes, set to the same value, along with the movie url and other parameters.</p><p>An example that loads the QuickTime plug-in, enables JavaScript, and gives a name to a movie is shown in listing 1-3.</p><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_31" title="Listing 1-3Load QuickTime, enable JavaScript, assign a name"></a><p class="codesample"><strong>Listing 1-3&nbsp;&nbsp;</strong>Load QuickTime, enable JavaScript, assign a name</p><div class="codesample"><table><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>&lt;OBJECT<span></span></pre></td></tr><tr><td scope="row"><pre>classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B"<span></span></pre></td></tr><tr><td scope="row"><pre>codebase="http://www.apple.com/qtactivex/qtplugin.cab"<span></span></pre></td></tr><tr><td scope="row"><pre>width="320" height="256"<span></span></pre></td></tr><tr><td scope="row"><pre>id="movie1"><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>&lt;PARAM name="src" value="MyMovie.mov"><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>&lt;EMBED HEIGHT=256 WIDTH=320<span></span></pre></td></tr><tr><td scope="row"><pre>SRC="MyMovie.mov"<span></span></pre></td></tr><tr><td scope="row"><pre>TYPE="video/quicktime"<span></span></pre></td></tr><tr><td scope="row"><pre>PLUGINSPAGE="www.apple.com/quicktime/download"<span></span></pre></td></tr><tr><td scope="row"><pre>EnableJavaScript="true"<span></span></pre></td></tr><tr><td scope="row"><pre>NAME="movie1"<span></span></pre></td></tr><tr><td scope="row"><pre>/><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/OBJECT><span></span></pre></td></tr></table></div><p>You can dramatically shorten the previous code example by taking advantage of the <code>AC_QuickTime.js</code> file, as described in <span class="content_text"><a href="QuickTimeandJavaScri.html#//apple_ref/doc/uid/TP40001526-CH001-SW1">“Using JavaScript to Detect QuickTime.”</a></span> The shortened code is shown in <span class="content_text">Listing 1-4</span>.</p><a name="//apple_ref/doc/uid/TP40001526-CH001-SW2" title="Listing 1-4Enabling JavaScript Using AC_QuickTime.js"></a><p class="codesample"><strong>Listing 1-4&nbsp;&nbsp;</strong>Enabling JavaScript Using AC_QuickTime.js</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;script language="javascript" type="text/javascript"><span></span></pre></td></tr><tr><td scope="row"><pre>    QT_WriteOBJECT('MyMovie.mov' , '320', '256', '', 'EnableJavaScript', 'True', 'emb#NAME' , 'movie1' , 'obj#id' , 'movie1') ;<span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/script><span></span></pre></td></tr></table></div><p>See <em><a href="../../QTScripting_HTML/index.html#//apple_ref/doc/uid/TP40001525" target="_top">HTML Scripting Guide for QuickTime</a></em>for more information about the <code>&lt;EMBED></code> and <code>&lt;OBJECT></code> tags and the attributes or parameters that can be passed to QuickTime.</p><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_7" title="Addressing QuickTime Movies"></a><h3><a name="//apple_ref/doc/uid/TP40001526-CH001-AddressingQuickTimeMovies" title="Addressing QuickTime Movies"></a>Addressing QuickTime Movies</h3><p>JavaScript treats each embedded QuickTime movie in a web page as a separately addressable object.</p><p>All methods are addressed to a movie. Methods that act on a movie are addressed to the target movie. Methods that operate on a track are addressed to the track’s parent movie (the track is specified in a parameter). Methods that operate on QuickTime or the QuickTime plug-in can be addressed to any movie embedded in the document.</p><p>Movies can be identified by name if there is a <code>NAME</code> attribute in the movie’s <code>EMBED</code> tag and an <code>id</code> attribute in the movie’s <code>OBJECT</code> tag. Internet Explorer for Windows uses the <code>id</code> attribute. All other browsers use the <code>NAME</code> parameter. Both <code>NAME</code> and <code>id</code> should be set to the same value.</p><p>Because Internet Explorer and some other browsers do not always support the <code>embeds[]</code> array, it is recommended that you assign a name to each movie and address the movie by name in your script, instead of addressing movies by their place in the <code>document.embeds[]</code> array.</p><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_8" title="JavaScript Usage Example"></a><h3><a name="//apple_ref/doc/uid/TP40001526-CH001-JavaScriptUsageExample" title="JavaScript Usage Example"></a>JavaScript Usage Example</h3><p>Listing 1-5 gives an example of JavaScript usage with QuickTime.</p><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_32" title="Listing 1-5Using JavaScript to play, stop, and replace a QuickTime movie"></a><p class="codesample"><strong>Listing 1-5&nbsp;&nbsp;</strong>Using JavaScript to play, stop, and replace a QuickTime movie</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;html><span></span></pre></td></tr><tr><td scope="row"><pre> &lt;head><span></span></pre></td></tr><tr><td scope="row"><pre>         &lt;title>Simple QuickTime Movie Controls&lt;/title><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>&lt;script src="AC_QuickTime.js" language="JavaScript" type="text/javascript"><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/script><span></span></pre></td></tr><tr><td scope="row"><pre> &lt;/head><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre> &lt;body ><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;P><span></span></pre></td></tr><tr><td scope="row"><pre>        This page uses JavaScript to control a QuickTime movie...<span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;/P><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;div align=center><span></span></pre></td></tr><tr><td scope="row"><pre>      &lt;table><span></span></pre></td></tr><tr><td scope="row"><pre>           &lt;tr><span></span></pre></td></tr><tr><td scope="row"><pre>           &lt;td width=200><span></span></pre></td></tr><tr><td scope="row"><pre>           &lt;script language="javascript" type="text/javascript"><span></span></pre></td></tr><tr><td scope="row"><pre>           QT_WriteOBJECT('MyMovie.mov', '180','160', '',<span></span></pre></td></tr><tr><td scope="row"><pre>           'obj#id', 'movie1', 'emb#name', 'movie1', 'enablejavascript', 'true');<span></span></pre></td></tr><tr><td scope="row"><pre>           &lt;/script><span></span></pre></td></tr><tr><td scope="row"><pre>           &lt;P> Movie1 &lt;/P><span></span></pre></td></tr><tr><td scope="row"><pre>           &lt;/td><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>           &lt;td width=200><span></span></pre></td></tr><tr><td scope="row"><pre>           &lt;script language="javascript" type="text/javascript"><span></span></pre></td></tr><tr><td scope="row"><pre>           QT_WriteOBJECT('MyOtherMovie.mov', '180','160', '',<span></span></pre></td></tr><tr><td scope="row"><pre>           'obj#id', 'movie2', 'emb#name', 'movie2', 'enablejavascript', 'true');<span></span></pre></td></tr><tr><td scope="row"><pre>           &lt;/script><span></span></pre></td></tr><tr><td scope="row"><pre>           &lt;P> Movie2 &lt;/P><span></span></pre></td></tr><tr><td scope="row"><pre>           &lt;/td><span></span></pre></td></tr><tr><td scope="row"><pre>           &lt;/tr><span></span></pre></td></tr><tr><td scope="row"><pre>      &lt;/table><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/div><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre> &lt;P>Play and Stop Movies: &lt;br><span></span></pre></td></tr><tr><td scope="row"><pre> &lt;a href="javascript:document.movie1.Play();">Play Movie1&lt;/a>&lt;br><span></span></pre></td></tr><tr><td scope="row"><pre> &lt;a href="javascript:document.movie1.Stop();">Stop Movie1&lt;/a>&lt;br><span></span></pre></td></tr><tr><td scope="row"><pre> &lt;a href="javascript:document.movie2.Play();">Play Movie2&lt;/a>&lt;br><span></span></pre></td></tr><tr><td scope="row"><pre> &lt;a href="javascript:document.movie2.Stop();">Stop Movie2&lt;/a>&lt;br><span></span></pre></td></tr><tr><td scope="row"><pre> &lt;/P><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre> &lt;P>Replace One Movie with Another: &lt;br><span></span></pre></td></tr><tr><td scope="row"><pre> &lt;a href="javascript:document.movie1.SetURL('MyOtherMovie.mov');">movie1.SetURL(MyOtherMovie.mov)&lt;/a><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;br><span></span></pre></td></tr><tr><td scope="row"><pre> &lt;a href="javascript:document.movie1.SetURL('MyMovie.mov');">movie1.SetURL(MyMovie.mov)&lt;/a><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;br><span></span></pre></td></tr><tr><td scope="row"><pre> &lt;a href="javascript:document.movie2.SetURL('MyOtherMovie.mov');">movie2.SetURL(MyOtherMovie.mov)&lt;/a><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;br><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;a href="javascript:document.movie2.SetURL('MyMovie.mov');">movie2.SetURL(MyMovie.mov)&lt;/a>&lt;br><span></span></pre></td></tr><tr><td scope="row"><pre> &lt;/P><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre> &lt;/body><span></span></pre></td></tr><tr><td scope="row"><pre> &lt;/html><span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001526-CH001-SW6" title="QuickTime DOM Events"></a><h2>QuickTime DOM Events</h2><p>The browser plug-ins for QuickTime 7.2.1 and later include the ability to emit Document Object Model (DOM) events. DOM events can be emitted when the plug-in is instantiated and ready to interact with JavaScript, at various points during a movie’s loading process, when playback has begun, paused, or ended, or in the event of an error. JavaScript functions can be set to "listen" for particular DOM events. Whenever the DOM event occurs, the listener function is called.</p><p>This allows you to create web pages that detect events such as movie loading, playing, pausing, or ending, without having to create JavaScript timing loops or constantly poll the plug-in for status. It also allows you to execute JavaScript functions in response to various movie events without sending <code>javascript://</code> URLs from a movie.</p><p>The plug-in posts standard DOM events, so in browsers that support the W3C's DOM Level 2 Event Specification (<span class="content_text"><a href="http://www.w3.org/TR/DOM-Level-2-Events/" target="_blank">http://www.w3.org/TR/DOM-Level-2-Events/</a></span>) you use the <code>addEventListener()</code> method to monitor for the events.</p><p>Safari 3.0 and FireFox 2.0 are examples of browsers that support the W3C standards sufficiently to work with the methods described in this document.</p><p>Internet Explorer version 5 and later supports a slightly different method that is essentially equivalent: <code>attachEvent()</code>.</p><p>For a page to work correctly whether visitors are using browsers that support the W3C standards or using Internet Explorer, you must include JavaScript code for both the <code>addEventListener()</code> function and the <code>attachEvent()</code> function. </p><p>All the examples in this document use both methods and should work with all W3C-compliant browsers, and well as with Internet Explorer.</p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_33" title="Important:"></a><p><strong>Important:</strong>&nbsp;The user must have QuickTime 7.2.1 or later installed in order to receive DOM events.</p><p></p></div><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_9" title="Summary of DOM Events"></a><h3>Summary of DOM Events</h3><p>QuickTime can emit DOM events when the plug-in is instantiated and ready to interact with JavaScript, at various points during a movie’s loading process, when playback has begun, paused, or ended, or in the event of an error. The following list shows the DOM events that can be listened for. Note that all QuickTime DOM events begin with the prefix “qt_” to prevent name space collisions.</p><ul class="spaceabove"><li class="li"><p><code>qt_begin</code> — The plug in has been instantiated and can interact with JavaScript.</p></li><li class="li"><p><code>qt_loadedmetadata</code> — The movie header information has been loaded or created. The duration, dimensions, looping state, and so on are now known.</p></li><li class="li"><p><code>qt_loadedfirstframe</code> — The first frame of the movie has been loaded and can be displayed. (The frame is displayed automatically at this point.)</p></li><li class="li"><p><code>qt_canplay</code> — Enough media data has been loaded to begin playback (but not necessarily enough to play the entire file without pausing).</p></li><li class="li"><p> <code>qt_canplaythrough</code> — Enough media data has been loaded to play through to the end of the file without having to pause to buffer, assuming data continues to come in at the current rate or faster. (If the movie is set to autoplay, it will begin playing now.)</p></li><li class="li"><p><code>qt_durationchange</code> — The media file’s duration is available or has changed. (A streaming movie, a <code>SMIL</code> movie, or a movie with a <code>QTNEXT</code> attribute may load multiple media segments or additional movies, causing a duration change.)</p></li><li class="li"><p><code>qt_load</code> — All media data has been loaded.</p></li><li class="li"><p><code>qt_ended</code> — Playback has stopped because end of the file was reached. (If the movie is set to loop, this event will not occur.)</p></li><li class="li"><p><code>qt_error</code> — An error occurred while loading the file. No more data will be loaded.</p></li><li class="li"><p><code>qt_pause</code> — Playback has paused. (This happens when the user presses the pause button before the movie ends.)</p></li><li class="li"><p><code>qt_play</code> — Playback has begun. </p></li><li class="li"><p><code>qt_progress</code> — More media data has been loaded. This event is fired no more than three times per second. </p><p>This event occurs repeatedly until the <code>qt_load</code> event or <code>qt_error</code> event. The last progress event may or may not coincide with the loading of the last media data. Use the progress function to monitor progress, but do not rely on it to determine whether the movie is completely loaded. Use the <code>qt_load</code> function in conjunction with the <code>qt_progress</code> function to monitor load progress and determine when loading is complete.</p></li><li class="li"><p><code>qt_waiting</code> — Playback has stopped because no more media data is available, but more data is expected. (This usually occurs if the user presses the play button prior to the <code>qt_canplaythrough</code> event. It can also occur if the data throughput slows during movie playback, and the buffer runs dry.)</p></li><li class="li"><p><code>qt_stalled</code> — No media has been received for approximately three seconds.</p></li><li class="li"><p><code>qt_timechanged</code> — The current time has been changed (current time is indicated by the position of the playhead). </p></li><li class="li"><p><code>qt_volumechange</code> — The audio volume or mute attribute has changed.</p></li></ul><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_10" title="Enabling DOM Events"></a><h3>Enabling DOM Events</h3><p>The QuickTime plug-in will emit DOM events only if this feature is explicitly enabled by setting <code>postdomevents</code> <code>true</code> in the <code>&lt;OBJECT></code> or <code>&lt;EMBED></code> tag.</p><p>In Internet Explorer you must also ensure that the <code>&lt;HEAD></code> element contains an <code>&lt;OBJECT></code> element for the “binary behavior” object (<code>clsid CB927D12-4FF7-4a9e-A169-56E4B8A75598</code>) that emits DOM events. The <code>&lt;OBJECT></code> tag that invokes the plug-in must include a <code>style</code> attribute that references the “binary behavior” object's ID, using the following syntax: <code>style="behavior:url(#BinaryBehaviorID)"</code>. </p><p>For example, if the binary behavior object has the ID “<code>qt_event_source</code>”, the object tag that embeds the movie must include the attribute <code>style='behavior:url(#qt_event_source)'</code>. The necessary tags to perform these actions are automatically inserted by the <code>AC_QuickTime.js</code> script when the <code>postdomevents</code> parameter is set <code>true</code>. </p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_34" title="Note"></a><p><strong>Note:</strong>&nbsp;The ID for the <code>&lt;EMBED></code> and <code>&lt;OBJECT></code> tags must have unique values, but the <code>&lt;EMBED></code> <code>NAME</code> parameter can have the same value as the <code>&lt;OBJECT> ID</code> to simplify movie addressing from JavaScript.</p></div><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_35" title="Listing 1-6Enabling DOM Events Using AC_QuickTime.js"></a><p class="codesample"><strong>Listing 1-6&nbsp;&nbsp;</strong>Enabling DOM Events Using <code>AC_QuickTime.js</code></p><div class="codesample"><table><tr><td scope="row"><pre>&lt;script language="javascript" type="text/javascript"><span></span></pre></td></tr><tr><td scope="row"><pre>    QT_WriteOBJECT('MyMovie.mov' , '320', '256', '', 'EnableJavaScript', 'True', 'postdomevents', 'True', 'emb#NAME' , 'movie1' , 'obj#id' , 'movie1', 'emb#id', 'movie_embed1') ;<span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/script><span></span></pre></td></tr></table></div><p>If you prefer not to use the <code>AC_QuickTime.js</code> script to create the <code>&lt;OBJECT></code> and <code>&lt;EMBED></code> tags, the following listing shows the syntax for creating the necessary tags manually.</p><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_36" title="Listing 1-7Enabling DOM Events Manually"></a><p class="codesample"><strong>Listing 1-7&nbsp;&nbsp;</strong>Enabling DOM Events Manually</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;object id="qt_event_source" classid="clsid:CB927D12-4FF7-4a9e-A169-56E4B8A75598"         codebase="http://www.apple.com/qtactivex/qtplugin.cab#version=7,2,1,0" >&lt;/object><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;object classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B" 
         codebase="http://www.apple.com/qtactivex/qtplugin.cab#version=7,2,1,0" 
         width="320" height="256" type="video/quicktime" id="movie1" 
         style="behavior:url(#qt_event_source);">
      <span></span></pre></td></tr><tr><td scope="row"><pre>  &lt;param name="src" value="MyMovie.mov" />         &lt;param name="postdomevents" value="true" /><span></span></pre></td></tr><tr><td scope="row"><pre>       &lt;embed<span></span></pre></td></tr><tr><td scope="row"><pre>            src="MyMovie.mov"<span></span></pre></td></tr><tr><td scope="row"><pre>            width="320" height="256"<span></span></pre></td></tr><tr><td scope="row"><pre>            id="movie_embed1"<span></span></pre></td></tr><tr><td scope="row"><pre>            name="movie1"<span></span></pre></td></tr><tr><td scope="row"><pre>            postdomevents="true"><span></span></pre></td></tr><tr><td scope="row"><pre>       &lt;/embed><span></span></pre></td></tr><tr><td scope="row"><pre>   &lt;/object><span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_11" title="Listening For DOM Events"></a><h3>Listening For DOM Events</h3><p>In order to respond to DOM events, you need to create and register a “listener” function for each DOM event you are interested in.</p><p>For browsers that work with the W3C DOM Level 2 Event Specification, use the <code>addEventListener()</code> function; for Internet Explorer, use the <code>attachEvent()</code> function and add the prefix “<code>on</code>” to the event. The following listing gives an example.</p><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_37" title="Listing 1-8Cross-platform event listener registration"></a><p class="codesample"><strong>Listing 1-8&nbsp;&nbsp;</strong>Cross-platform event listener registration</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;script language="javascript" type="text/javascript"><span></span></pre></td></tr><tr><td scope="row"><pre>function myAddListener(obj, evt, handler, captures)<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>        if ( document.addEventListener )<span></span></pre></td></tr><tr><td scope="row"><pre>            obj.addEventListener(evt, handler, captures);<span></span></pre></td></tr><tr><td scope="row"><pre>        else<span></span></pre></td></tr><tr><td scope="row"><pre>            // IE<span></span></pre></td></tr><tr><td scope="row"><pre>            obj.attachEvent('on' + evt, handler);<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/script><span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_12" title="Using DOM Events to Monitor Movie Loading"></a><h3>Using DOM Events to Monitor Movie Loading</h3><p>Here’s an example of a web page that listens for the DOM event emitted periodically when a movie is loading, and displays the percent of the movie loaded so far. It also monitors for the movie loaded event, and overwrites the progress message with a “movie loaded” message when the movie is fully loaded.</p><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_38" title="Listing 1-9Monitoring movie loading using DOM events"></a><p class="codesample"><strong>Listing 1-9&nbsp;&nbsp;</strong>Monitoring movie loading using DOM events</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html140/DTD/loose.dtd"><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;head><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;script src="AC_QuickTime.js" language="JavaScript" type="text/javascript"><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/script><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;script language ="JavaScript" type="text/javascript"><span></span></pre></td></tr><tr><td scope="row"><pre> &lt;!--<span></span></pre></td></tr><tr><td scope="row"><pre>     /* define function that shows percentage of movie loaded */<span></span></pre></td></tr><tr><td scope="row"><pre>        function showProgress()<span></span></pre></td></tr><tr><td scope="row"><pre>        {<span></span></pre></td></tr><tr><td scope="row"><pre>        var percentLoaded = 0 ;<span></span></pre></td></tr><tr><td scope="row"><pre>        percentLoaded = parseInt((document.movie1.GetMaxTimeLoaded() / document.movie1.GetDuration()) * 100);<span></span></pre></td></tr><tr><td scope="row"><pre>        document.getElementById("loadStatus").innerHTML = 'Movie loading: ' + percentLoaded + '% complete...';<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>    /* define function that executes when movie loading is complete */<span></span></pre></td></tr><tr><td scope="row"><pre>       function movieLoaded()<span></span></pre></td></tr><tr><td scope="row"><pre>        {<span></span></pre></td></tr><tr><td scope="row"><pre>        document.getElementById("loadStatus").innerHTML = "Movie Loaded" ;<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    /* define function that adds another function as a DOM event listener */<span></span></pre></td></tr><tr><td scope="row"><pre>         function myAddListener(obj, evt, handler, captures)<span></span></pre></td></tr><tr><td scope="row"><pre>        {<span></span></pre></td></tr><tr><td scope="row"><pre>        if ( document.addEventListener )<span></span></pre></td></tr><tr><td scope="row"><pre>            obj.addEventListener(evt, handler, captures);<span></span></pre></td></tr><tr><td scope="row"><pre>        else<span></span></pre></td></tr><tr><td scope="row"><pre>            // IE<span></span></pre></td></tr><tr><td scope="row"><pre>            obj.attachEvent('on' + evt, handler);<span></span></pre></td></tr><tr><td scope="row"><pre>       }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>   /* define functions that register each listener */<span></span></pre></td></tr><tr><td scope="row"><pre>    function RegisterListener(eventName, objID, embedID, listenerFcn)<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>        var obj = document.getElementById(objID);<span></span></pre></td></tr><tr><td scope="row"><pre>        if ( !obj )<span></span></pre></td></tr><tr><td scope="row"><pre>            obj = document.getElementById(embedID);<span></span></pre></td></tr><tr><td scope="row"><pre>        if ( obj )<span></span></pre></td></tr><tr><td scope="row"><pre>            myAddListener(obj, eventName, listenerFcn, false);<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    /* define a single function that registers all listeners to call onload */<span></span></pre></td></tr><tr><td scope="row"><pre>    function RegisterListeners()<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>       RegisterListener('qt_progress', 'movie1', 'qtmovie_embed', showProgress);<span></span></pre></td></tr><tr><td scope="row"><pre>       RegisterListener('qt_load', 'movie1', 'qtmovie_embed', movieLoaded);<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre> //--><span></span></pre></td></tr><tr><td scope="row"><pre> &lt;/script><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;title>JavaScript Movie Monitor&lt;/title><span></span></pre></td></tr><tr><td scope="row"><pre> &lt;/head><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>&lt;body  onload="RegisterListeners()"><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;div align=center><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;h2>Movie with JavaScript Progress/Load Monitors&lt;/h2><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>&lt;script language="javascript" type="text/javascript"><span></span></pre></td></tr><tr><td scope="row"><pre> QT_WriteOBJECT('MyMovie.mov' , '320', '256', '', 'EnableJavaScript', 'True',<span></span></pre></td></tr><tr><td scope="row"><pre>'postdomevents', 'True', 'emb#NAME' , 'movie1' , 'obj#id' , 'movie1', 'emb#id',<span></span></pre></td></tr><tr><td scope="row"><pre> 'qtmovie_embed') ;<span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/script><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;p ID="loadStatus"><span></span></pre></td></tr><tr><td scope="row"><pre>          MOVIE LOADING...<span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;/p><span></span></pre></td></tr><tr><td scope="row"><pre>   &lt;p> &lt;a href="javascript:document.movie1.Play();">Play&lt;/a> &lt;/p><span></span></pre></td></tr><tr><td scope="row"><pre>   &lt;p> &lt;a href="javascript:document.movie1.Stop();">Stop&lt;/a> &lt;/p><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/div><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/body><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/html><span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_13" title="Monitoring and Controlling Multiple Movies"></a><h3>Monitoring and Controlling Multiple Movies</h3><p>You can control and monitor multiple movies on a single web page using JavaScript controls and DOM events. You need to give each movie a unique name in the <code>&lt;EMBED></code> tag, a matching <code>ID</code> in the <code>&lt;object></code> tag, as well as a unique <code>ID</code> in the <code>&lt;EMBED></code> tag. </p><p>Create and register DOM event listeners for each movie, using the <code>&lt;EMBED></code> and <code>&lt;OBJECT></code> IDs.</p><p>Create JavaScript controls for each movie, using the <code>&lt;EMBED> NAME</code>, which is the same as the <code>&lt;OBJECT> ID</code>.</p><p>For example, you might have two movies, the first with an <code>&lt;OBJECT> ID</code> and <code>&lt;EMBED> NAME</code> of <code>movie1</code>, and an <code>&lt;EMBED> ID</code> of <code>movie_embed1</code>, and a second movie with an <code>&lt;OBJECT> ID</code> and <code>&lt;EMBED> NAME</code> of <code>movie2</code>, and an <code>&lt;EMBED> ID</code> of <code>movie_embed2</code>. Register DOM event listeners for <code>movie1/movie_embed1</code> and <code>movie2/movie_embed2</code>, and create JavaScript controls for <code>movie1</code> and <code>movie2</code>.</p><p>The following listing is an example of a web page that monitors the load progress and load completion of two movies, and provides play and stop controls for each movie in JavaScript.</p><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_39" title="Listing 1-10Web page that monitors and controls two movies using JavaScript and DOM events"></a><p class="codesample"><strong>Listing 1-10&nbsp;&nbsp;</strong>Web page that monitors and controls two movies using JavaScript and DOM events</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html140/DTD/loose.dtd"><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;head><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;script src="AC_QuickTime.js" language="JavaScript" type="text/javascript"><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/script><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;script language ="JavaScript" type="text/javascript"><span></span></pre></td></tr><tr><td scope="row"><pre> &lt;!--<span></span></pre></td></tr><tr><td scope="row"><pre>    /* define function that shows percentage of movie 1 loaded */<span></span></pre></td></tr><tr><td scope="row"><pre>        function showProgress()<span></span></pre></td></tr><tr><td scope="row"><pre>        {<span></span></pre></td></tr><tr><td scope="row"><pre>        var percentLoaded = 0 ;<span></span></pre></td></tr><tr><td scope="row"><pre>        percentLoaded = parseInt((document.movie1.GetMaxTimeLoaded() / document.movie1.GetDuration()) * 100);<span></span></pre></td></tr><tr><td scope="row"><pre>        document.getElementById("loadStatus1").innerHTML = 'Movie loading: ' + percentLoaded + '% complete...';<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>   /* define function that executes when movie1 loading is complete */<span></span></pre></td></tr><tr><td scope="row"><pre>        function movieLoaded()<span></span></pre></td></tr><tr><td scope="row"><pre>        {<span></span></pre></td></tr><tr><td scope="row"><pre>        document.getElementById("loadStatus1").innerHTML = "Movie Loaded" ;<span></span></pre></td></tr><tr><td scope="row"><pre>           }<span></span></pre></td></tr><tr><td scope="row"><pre>    /* define function that shows percentage of movie 2 loaded */<span></span></pre></td></tr><tr><td scope="row"><pre>        function showProgress2()<span></span></pre></td></tr><tr><td scope="row"><pre>        {<span></span></pre></td></tr><tr><td scope="row"><pre>        var percentLoaded = 0 ;<span></span></pre></td></tr><tr><td scope="row"><pre>        percentLoaded = parseInt((document.movie2.GetMaxTimeLoaded() / document.movie2.GetDuration()) * 100);<span></span></pre></td></tr><tr><td scope="row"><pre>        document.getElementById("loadStatus2").innerHTML = 'Movie loading: ' + percentLoaded + '% complete...';<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>    /* define function that executes when movie2 loading is complete */<span></span></pre></td></tr><tr><td scope="row"><pre>        function movieLoaded2()<span></span></pre></td></tr><tr><td scope="row"><pre>        {<span></span></pre></td></tr><tr><td scope="row"><pre>        document.getElementById("loadStatus2").innerHTML = "Movie Loaded" ;<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>   /* define function that adds another function as a listener for a DOM event */<span></span></pre></td></tr><tr><td scope="row"><pre>        function myAddListener(obj, evt, handler, captures)<span></span></pre></td></tr><tr><td scope="row"><pre>        {<span></span></pre></td></tr><tr><td scope="row"><pre>        if ( document.addEventListener )<span></span></pre></td></tr><tr><td scope="row"><pre>            obj.addEventListener(evt, handler, captures);<span></span></pre></td></tr><tr><td scope="row"><pre>        else<span></span></pre></td></tr><tr><td scope="row"><pre>            // IE<span></span></pre></td></tr><tr><td scope="row"><pre>            obj.attachEvent('on' + evt, handler);<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>   /* define functions that register each listener */<span></span></pre></td></tr><tr><td scope="row"><pre>    function RegisterListener(eventName, objID, embedID, listenerFcn)<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>        var obj = document.getElementById(objID);<span></span></pre></td></tr><tr><td scope="row"><pre>        if ( !obj )<span></span></pre></td></tr><tr><td scope="row"><pre>            obj = document.getElementById(embedID);<span></span></pre></td></tr><tr><td scope="row"><pre>        if ( obj )<span></span></pre></td></tr><tr><td scope="row"><pre>            myAddListener(obj, eventName, listenerFcn, false);<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    /* define a single function that registers all listeners to call onload */<span></span></pre></td></tr><tr><td scope="row"><pre>    function RegisterListeners()<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>     RegisterListener('qt_progress', 'movie1', 'qtmovie_embed', showProgress);<span></span></pre></td></tr><tr><td scope="row"><pre>     RegisterListener('qt_load', 'movie1', 'qtmovie_embed', movieLoaded);<span></span></pre></td></tr><tr><td scope="row"><pre>     RegisterListener('qt_progress', 'movie2', 'qtmovie_embed2', showProgress2);<span></span></pre></td></tr><tr><td scope="row"><pre>     RegisterListener('qt_load', 'movie2', 'qtmovie_embed2', movieLoaded2);<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> //--><span></span></pre></td></tr><tr><td scope="row"><pre>   &lt;/script><span></span></pre></td></tr><tr><td scope="row"><pre>      &lt;title>JavaScript Movie Controls and Monitors&lt;/title><span></span></pre></td></tr><tr><td scope="row"><pre> &lt;/head><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;body  onload="RegisterListeners()"><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>&lt;div align=center><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;h2>Two Movies with JavaScript Play/Stop Controls&lt;br>and Progress/Load Monitors&lt;/h2><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;script language="javascript" type="text/javascript"><span></span></pre></td></tr><tr><td scope="row"><pre>QT_WriteOBJECT('MyMovie.mov', '360','256', '', 'obj#id', 'movie1', 'emb#id', 'qtmovie_embed', 'emb#name', 'movie1', 'postdomevents', 'true', 'enablejavascript', 'true');<span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/script><span></span></pre></td></tr><tr><td scope="row"><pre>&amp;nbsp;&amp;nbsp;<span></span></pre></td></tr><tr><td scope="row"><pre>&lt;script language="javascript" type="text/javascript"><span></span></pre></td></tr><tr><td scope="row"><pre>QT_WriteOBJECT('MyOtherMovie.mov', '360','256', '', 'obj#id', 'movie2', 'emb#id', 'qtmovie_embed2', 'emb#name', 'movie2', 'postdomevents', 'true', 'enablejavascript', 'true');<span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/script><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>&lt;table width="100%"><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;tr><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;td align=center><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;P ID="loadStatus1"><span></span></pre></td></tr><tr><td scope="row"><pre>MOVIE LOADING...<span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/p><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/td><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;td align=center><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;P ID="loadStatus2"><span></span></pre></td></tr><tr><td scope="row"><pre>MOVIE LOADING...<span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/p><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/td><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/tr><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>&lt;tr><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;td align=center><span></span></pre></td></tr><tr><td scope="row"><pre>   &lt;P> &lt;a href="javascript:document.movie1.Play();">Play 1&lt;/a> &lt;/P><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/td><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;td align=center><span></span></pre></td></tr><tr><td scope="row"><pre>   &lt;P> &lt;a href="javascript:document.movie2.Play();">Play 2&lt;/a> &lt;/P><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/td><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/tr><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;tr><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;td align=center><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;P> &lt;a href="javascript:document.movie1.Stop();">Stop 1&lt;/a> &lt;/P><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/td><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;td align=center><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;P> &lt;a href="javascript:document.movie2.Stop();">Stop 2 &lt;/a> &lt;/P><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/td><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/tr><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/table><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/div><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/body><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/html><span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001526-CH001-SW7" title="QuickTime JavaScript Reference"></a><h2><a name="//apple_ref/doc/uid/TP40001526-CH001-QuickTimeJavaScriptReference" title="QuickTime JavaScript Reference"></a>QuickTime JavaScript Reference</h2><p>QuickTime exposes a number of methods to JavaScript. Some take the form of commands that operate on movies, such as <code>Play(),</code><code>Stop(),</code><code>Rewind(),</code> and so on. The rest operate on properties of QuickTime as a whole, the QuickTime plug-in, movies, or tracks. Most of these properties can be read or written using complementary Get and Set methods. Other properties, such as the QuickTime version, are read-only.</p><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_14" title="Movie Commands"></a><h3><a name="//apple_ref/doc/uid/TP40001526-CH001-MovieCommands" title="Movie Commands"></a>Movie Commands</h3><p>Movie commands are addressed to a specific movie. For example, the following line of code plays a movie whose <code>NAME</code> and <code>id</code> are set to “Movie1.”</p><div class="codesample"><table><tr><td scope="row"><pre>document.movie1.Play();<span></span></pre></td></tr></table></div><p><strong>Play</strong></p><div class="codesample"><table><tr><td scope="row"><pre>void Play()<span></span></pre></td></tr></table></div><p>Plays the movie at the default rate, starting from the movie’s current time.</p><p><strong>Stop</strong></p><div class="codesample"><table><tr><td scope="row"><pre>void Stop() Example:<span></span></pre></td></tr><tr><td scope="row"><pre>document.movie1.Stop();<span></span></pre></td></tr></table></div><p>Stops the movie without changing the movie’s current time.</p><p><strong>Rewind</strong></p><div class="codesample"><table><tr><td scope="row"><pre>void Rewind()<span></span></pre></td></tr></table></div><p>Sets the current time to the movie’s start time and pauses the movie.</p><p><strong>Step</strong></p><div class="codesample"><table><tr><td scope="row"><pre>void Step(int count)<span></span></pre></td></tr></table></div><p>Steps the movie forward or backward the specified number of frames from the point at which the command is received. If the movie’s rate is non-zero, it is paused.</p><p><strong>ShowDefaultView</strong></p><div class="codesample"><table><tr><td scope="row"><pre>void ShowDefaultView()<span></span></pre></td></tr></table></div><p>Displays a QuickTime VR movie’s default node, using the default pan angle, tilt angle, and field of view as set by the movie’s author.</p><p><strong>GoPreviousNode</strong></p><div class="codesample"><table><tr><td scope="row"><pre>void GoPreviousNode()<span></span></pre></td></tr></table></div><p>Returns to the previous node in a QuickTime VR movie (equivalent to clicking the Back button on the VR movie controller).</p><p><strong>GoToChapter</strong></p><div class="codesample"><table><tr><td scope="row"><pre>void GoToChapter(string chapterName)<span></span></pre></td></tr></table></div><p>Takes a chapter name and sets the movie's current time to the beginning of that chapter. See also: <code>GetChapterName</code> and <code>GetChapterCount</code> in movie properties.</p><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_15" title="QuickTime Properties"></a><h3><a name="//apple_ref/doc/uid/TP40001526-CH001-QuickTimeProperties" title="QuickTime Properties"></a>QuickTime Properties</h3><p>Methods that get or set a QuickTime property can be addressed to any movie embedded in the document. For example, both lines in the following code snippet return the same information from a page with two embedded movies, named MovieOne and MovieTwo.</p><div class="codesample"><table><tr><td scope="row"><pre>myVar1=document.MovieOne.GetQuickTimeVersion();<span></span></pre></td></tr><tr><td scope="row"><pre>myVar2=document.MovieTwo.GetQuickTimeVersion();<span></span></pre></td></tr></table></div><p><strong>GetQuickTimeVersion</strong></p><div class="codesample"><table><tr><td scope="row"><pre>string GetQuickTimeVersion()<span></span></pre></td></tr></table></div><p>Returns the version of QuickTime.</p><p><strong>GetQuickTimeLanguage</strong></p><div class="codesample"><table><tr><td scope="row"><pre>string GetQuickTimeLanguage()<span></span></pre></td></tr></table></div><p>Returns the user’s QuickTime language (set through the plug-in’s Set Language dialog).</p><p><strong>GetQuickTimeConnectionSpeed</strong></p><div class="codesample"><table><tr><td scope="row"><pre>int GetQuickTimeConnectionSpeed()<span></span></pre></td></tr></table></div><p>Returns the connection speed setting from the users QuickTime preferences.</p><p><strong>GetIsQuickTimeRegistered</strong></p><div class="codesample"><table><tr><td scope="row"><pre>boolean GetIsQuickTimeRegistered()<span></span></pre></td></tr></table></div><p>Returns <code>true</code> if the user is registered for the Pro version of QuickTime; otherwise returns <code>false.</code></p><p><strong>GetComponentVersion</strong></p><div class="codesample"><table><tr><td scope="row"><pre>string GetComponentVersion(string type, string subType, string manufacturer)<span></span></pre></td></tr></table></div><p>Returns the version of a specific QuickTime component. The component is specified using a four character string for the type, subtype, and manufacturer. For example, to check the version of Apple’s JPEG graphics importer call <code><a href="../../../../Carbon/Reference/Component_Manager/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/c/func/GetComponentVersion" target="_top">GetComponentVersion</a></code>> <code>'grip',</code><code>'JPEG',</code><code>'appl').</code><code>'0'</code> is a wildcard for any field. If the component is not available, <code>0.0</code> is returned.</p><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_16" title="Plug-in Properties"></a><h4><a name="//apple_ref/doc/uid/TP40001526-CH001-PluginProperties" title="Plug-in Properties"></a>Plug-in Properties</h4><p><strong>GetPluginVersion</strong></p><div class="codesample"><table><tr><td scope="row"><pre>string GetPluginVersion()<span></span></pre></td></tr></table></div><p>Returns the version of the QuickTime plug-in.</p><p><strong>ResetPropertiesOnReload</strong></p><div class="codesample"><table><tr><td scope="row"><pre>boolean GetResetPropertiesOnReload()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetResetPropertiesOnReload(boolean reset)<span></span></pre></td></tr></table></div><p>By default, most movie and plug-in properies are reset when a new movie is loaded. For example, when a new movie loads, the default controller setting is <code>true</code> for a linear movie and <code>false</code> for a VR movie, regardless of the prior setting. If this property is set to <code>false,</code> the new movie inherits the settings in use with the current movie.</p><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_17" title="Movie Properties"></a><h3><a name="//apple_ref/doc/uid/TP40001526-CH001-MovieProperties" title="Movie Properties"></a>Movie Properties</h3><p>Like movie commands, methods that get or set movie properties are addressed to a specific movie. For example, the following code snippet set the movie named MovieOne to autoplay.</p><div class="codesample"><table><tr><td scope="row"><pre>document.MovieOne.SetAutoPlay(true);<span></span></pre></td></tr></table></div><p><strong>GetPluginStatus</strong></p><div class="codesample"><table><tr><td scope="row"><pre>string GetPluginStatus()<span></span></pre></td></tr></table></div><p><code>GetPluginStatus</code> returns a string with the status of the current movie. Possible states are:</p><ul class="simple"><li><p>”Waiting”—waiting for the movie data stream to begin</p></li><li><p>”Loading”—data stream has begun, not able to play/display the movie yet</p></li><li><p>”Playable”—movie is playable, although not all data has been downloaded </p></li><li><p>”Complete”—all data has been downloaded </p></li><li><p>”Error: &lt;error number>”—the movie failed with the specified error number </p></li></ul><div class="notebox"><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_40" title="Note"></a><p><strong>Note:</strong>&nbsp;Even though the method is named <code>GetPluginStatus</code> it gets the status of a specific movie, not the status of the plug-in as a whole. If more than one movie is embedded in a document, there can be a different status for each movie. For example, one movie could be playable while another is still loading.</p></div><p><strong>AutoPlay</strong></p><div class="codesample"><table><tr><td scope="row"><pre>boolean GetAutoPlay()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetAutoPlay(boolean autoPlay)<span></span></pre></td></tr></table></div><p>Get and set whether a movie automatically starts playing as soon as it can. The Set method is roughly equivalent to setting the <code>AUTOPLAY</code> parameter in the <code>&lt;EMBED></code> tag, but the @HH:MM:SS:FF feature is not yet supported in JavaScript.</p><p><strong>ControllerVisible</strong></p><div class="codesample"><table><tr><td scope="row"><pre>boolean GetControllerVisible()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetControllerVisible(boolean visible)<span></span></pre></td></tr></table></div><p>Get and set whether a movie has a visible controller. The Set method is equivalent to setting the <code>CONTROLLER</code> parameter in the <code>&lt;EMBED></code> tag.</p><p><strong>Rate</strong></p><div class="codesample"><table><tr><td scope="row"><pre>float GetRate()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetRate(float rate)<span></span></pre></td></tr></table></div><p>Get and set the playback rate of the movie. A rate of 1 is the normal playback rate. A paused movie has a rate of 0. Fractional values are slow motion, and values greater than one are fast-forward. Negative values indicate that the movie is playing backward. Setting the rate of a paused movie to a nonzero value starts the movie playing.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_41" title="Note"></a><p><strong>Note:</strong>&nbsp;Rate goes to zero when the movie finishes playing or is stopped (by the user, for example). You can use the <code>GetTime</code> and <code>GetDuration</code> functions to determine whether the movie is stopped at the end, the beginning (time zero), or at some point in between. You may also want the call <code>GetIsLooping</code> to determine whether the movie will end spontaneously. </p></div><p><strong>Time</strong></p><div class="codesample"><table><tr><td scope="row"><pre>int GetTime()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetTime(int time)<span></span></pre></td></tr></table></div><p>Get and set the current time of a movie. Setting this property causes a movie to go to that time in the movie and stop.</p><p><strong>Volume</strong></p><div class="codesample"><table><tr><td scope="row"><pre>int GetVolume()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetVolume(int volume)<span></span></pre></td></tr></table></div><p>Get and set the audio volume of the movie. A negative value mutes the movie. The Set method is equivalent to setting the <code>VOLUME</code> parameter in the <code>&lt;EMBED></code> tag.</p><p><strong>Mute</strong></p><div class="codesample"><table><tr><td scope="row"><pre>boolean GetMute()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetMute(boolean mute)<span></span></pre></td></tr></table></div><p>Get and set the audio mute of a movie while maintaining the magnitude of the volume, so turning mute off restores the volume.</p><p><strong>MovieName</strong></p><div class="codesample"><table><tr><td scope="row"><pre>string GetMovieName()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetMovieName(string movieName)<span></span></pre></td></tr></table></div><p>Get and set a name that can be used by a wired sprite when targeting an external movie. The Set method is equivalent to setting the <code>MOVIENAME</code> parameter in the <code>&lt;EMBED></code> tag.</p><p><strong>MovieID</strong></p><div class="codesample"><table><tr><td scope="row"><pre>int GetMovieID()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetMovieID(int movieID)<span></span></pre></td></tr></table></div><p>Get and set an ID that can be used by a wired sprite when targeting an external movie. The Set method is equivalent to setting the <code>MOVIEID</code> parameter in the <code>&lt;EMBED></code> tag.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_42" title="Note"></a><p><strong>Note:</strong>&nbsp;<code>MovieID</code> is not the same as the <code>NAME</code> parameter in the <code>&lt;EMBED></code> tag or the <code>id</code> parameter in the <code>&lt;OBJECT></code> tag. <code>MovieID</code> is used for wired sprite addressing, not JavaScript addressing. </p></div><p><strong>GetChapterCount</strong></p><div class="codesample"><table><tr><td scope="row"><pre>int GetChapterCount()<span></span></pre></td></tr></table></div><p>Returns the number of chapters in the movie.</p><p><strong>GetChapterName</strong></p><div class="codesample"><table><tr><td scope="row"><pre>string GetChapterName(int)<span></span></pre></td></tr></table></div><p>Takes a chapter number and returns the chapter name.</p><p><strong>StartTime</strong></p><div class="codesample"><table><tr><td scope="row"><pre>void SetStartTime(int time)<span></span></pre></td></tr></table></div><p>Get and set the time at which a movie begins to play and the time at which it stops or loops when playing in reverse. Initially, the start time of a movie is set to <code>0</code> unless specified in the <code>STARTTIME</code> parameter in the <code>&lt;EMBED></code> tag. The start time cannot be set to a time greater than the end time. The Set method is equivalent to setting the <code>STARTTIME</code> parameter in the <code>&lt;EMBED></code> tag.</p><p><strong>EndTime</strong></p><div class="codesample"><table><tr><td scope="row"><pre>int GetEndTime()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetEndTime(int time)<span></span></pre></td></tr></table></div><p>Get and set the time at which a movie stops playing or loops. The end time of a movie is initially set to its duration, unless specified in the <code>ENDTIME</code> parameter in the <code>&lt;EMBED></code> tag. The end time cannot be set to a time greater than the movie’s duration. The Set method is equivalent to setting the <code>ENDTIME</code> parameter in the <code>&lt;EMBED></code> tag.</p><p><strong>BgColor</strong></p><div class="codesample"><table><tr><td scope="row"><pre>string GetBgColor()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetBgColor(string color)<span></span></pre></td></tr></table></div><p>Get and set the color used to fill any space allotted to the plug-in by the <code>&lt;EMBED></code> tag and not covered by the movie. The Set method is equivalent to setting the <code>BGCOLOR</code> parameter in the <code>&lt;EMBED></code> tag and takes the same values. Regardless of the syntax used to specify the color, <code>GetBgColor()</code> always returns the color as a number—for example, if the background color is set to <code>Navy,</code><code>GetBgColor()</code> returns <code>#000080.</code></p><p><strong>IsLooping</strong></p><div class="codesample"><table><tr><td scope="row"><pre>boolean GetIsLooping()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetIsLooping(boolean loop)<span></span></pre></td></tr></table></div><p>Get and set whether a movie loops when it reaches its end. A movie can loop either by restarting when it reaches the end or by playing backward when it reaches the end, then restarting when it reaches the beginning, depending on the <code>LoopIsPalindrome</code> value. Using the <code>SetIsLooping</code> method is equivalent to setting the <code>LOOP</code> parameter to <code>true</code> or <code>false</code> in the <code>&lt;EMBED></code> tag.</p><p><strong>LoopIsPalindrome</strong></p><div class="codesample"><table><tr><td scope="row"><pre>boolean GetLoopIsPalindrome()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetLoopIsPalindrome(boolean loop)<span></span></pre></td></tr></table></div><p>Get and set whether a looping movie reverses direction when it loops, alternately playing backward and forward. The loop property must be <code>true</code> for this to have any effect. Setting both <code>IsLooping</code> and <code>LoopIsPalindrome</code> to <code>true</code> is equivalent to setting the <code>LOOP</code> parameter to <code>Palindrome</code> in the <code>&lt;EMBED></code> tag.</p><p><strong>PlayEveryFrame</strong></p><div class="codesample"><table><tr><td scope="row"><pre>boolean GetPlayEveryFrame()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetPlayEveryFrame(boolean playAll)<span></span></pre></td></tr></table></div><p>Get and set whether QuickTime should play every frame in a movie even if it gets behind (playing in slow motion rather than dropping frames). The sound is muted when <code>playAll</code> is set <code>true.</code> The Set method is equivalent to setting the <code>PLAYEVERYFRAME</code> parameter in the <code>&lt;EMBED></code> tag.</p><p><strong>HREF</strong></p><div class="codesample"><table><tr><td scope="row"><pre>string GetHREF()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetHREF(string url)<span></span></pre></td></tr></table></div><p>Get and set the URL that is invoked by a mouse click in a movie’s display area. The URL can specify a web page, a QuickTime movie, a live streaming session, or be a JavaScript function name. The Set method is equivalent to setting the <code>HREF</code> parameter in the <code>&lt;EMBED></code> tag.</p><p><strong>Target</strong></p><div class="codesample"><table><tr><td scope="row"><pre>string GetTarget()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetTarget(string target)<span></span></pre></td></tr></table></div><p>Get and set the target for a movie’s <code>HREF</code> parameter. The target can be an existing frame or browser window, a new browser window, <code>myself</code> (the QuickTime plug-in), or <code>quicktimeplayer.</code> The Set method is equivalent to setting the <code>TARGET</code> parameter in the <code>&lt;EMBED></code> tag.</p><p><strong>QTNEXTUrl</strong></p><div class="codesample"><table><tr><td scope="row"><pre>string GetQTNEXTUrl(int index)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetQTNEXTUrl(int index, string url)<span></span></pre></td></tr></table></div><p>Get and set the URL and target for a specified item in a sequence. The URL of the first item in the sequence is invoked when the currently selected movie finishes. If the URL specifies a QuickTime movie and the special target <code>myself,</code> the next specified URL in the sequence is invoked when that movie finishes, and so on. The Set method is equivalent to setting the <code>QTNEXT</code><em>n</em> parameter in the <code>&lt;EMBED></code> tag.</p><p><strong>URL</strong></p><div class="codesample"><table><tr><td scope="row"><pre>string GetURL()<span></span></pre></td></tr></table></div><p>Returns a movie’s full URL.</p><div class="codesample"><table><tr><td scope="row"><pre>void SetURL(string url)<span></span></pre></td></tr></table></div><p>Replaces a movie with another movie specified by the URL.</p><p><strong>KioskMode</strong></p><div class="codesample"><table><tr><td scope="row"><pre>boolean GetKioskMode()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetKioskMode(boolean kioskMode)<span></span></pre></td></tr></table></div><p>Set and get whether kiosk mode is currently set. In kiosk mode, the QuickTime plug-in does not allow the viewer to save a movie to disk. Setting <code>kioskMode</code> to <code>true</code> is equivalent to setting the <code>KIOSKMODE</code> parameter in the <code>&lt;EMBED></code> tag.</p><p><strong>GetDuration</strong></p><div class="codesample"><table><tr><td scope="row"><pre>int GetDuration()<span></span></pre></td></tr></table></div><p>Returns the length of the movie (in the movie’s time scale units).</p><p><strong>GetMaxTimeLoaded</strong></p><div class="codesample"><table><tr><td scope="row"><pre>int GetMaxTimeLoaded()<span></span></pre></td></tr></table></div><p>Returns the amount of the movie that has been downloaded (in the movie’s time scale units).</p><p><strong>GetTimeScale</strong></p><div class="codesample"><table><tr><td scope="row"><pre>int GetTimeScale()<span></span></pre></td></tr></table></div><p>Returns the time scale of the movie in units per second. For example, if <code>GetTimeScale()</code> returns <code>30,</code> each movie time scale unit represents 1/30 of a second.</p><p><strong>GetMovieSize</strong></p><div class="codesample"><table><tr><td scope="row"><pre>int GetMovieSize()<span></span></pre></td></tr></table></div><p>Returns the size of the movie in bytes.</p><p><strong>GetMaxBytesLoaded</strong></p><div class="codesample"><table><tr><td scope="row"><pre>int GetMaxBytesLoaded()<span></span></pre></td></tr></table></div><p>Returns the number of bytes of the movie that have been downloaded.</p><p><strong>GetTrackCount</strong></p><div class="codesample"><table><tr><td scope="row"><pre>int GetTrackCount()<span></span></pre></td></tr></table></div><p>Returns the total number of tracks in the movie.</p><p><strong>Matrix</strong></p><div class="codesample"><table><tr><td scope="row"><pre>string GetMatrix()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetMatrix(string matrix)<span></span></pre></td></tr></table></div><p>Get and set a movie’s transformation matrix. QuickTime uses a 3 x 3 transformation matrix, represented in JavaScript by three lines of three numbers separated by commas:</p><div class="codesample"><table><tr><td scope="row"><pre>a, b, u<span></span></pre></td></tr><tr><td scope="row"><pre>c, d, v<span></span></pre></td></tr><tr><td scope="row"><pre>h, k, w<span></span></pre></td></tr></table></div><p>You can use a movie’s transformation matrix to scale, translate, and rotate the movie image. For details on the transformation matrix, see <span class="content_text"><a href="../../../MovieInternals-date.html#//apple_ref/doc/uid/TP30000433-TP30000546" target="_top">Movie Internals</a></span>.</p><p><strong>Rectangle</strong></p><div class="codesample"><table><tr><td scope="row"><pre>string GetRectangle()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetRectangle(string rect)<span></span></pre></td></tr></table></div><p>Get and set the location and dimensions of the movie within the embed area.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_43" title="Note"></a><p><strong>Note:</strong>&nbsp;Normally, the QuickTime plug-in keeps the movie centered within the embed area, even if the embed area changes. Once a movie’s location is changed with <code>SetRect</code> or <code>SetMatrix,</code> the movie’s absolute location within the embed area is maintained rather than centering it.  </p></div><p><strong>Language</strong></p><div class="codesample"><table><tr><td scope="row"><pre>string GetLanguage()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetLanguage(string language)<span></span></pre></td></tr></table></div><p>Get and set the movie’s current language.  Setting the language causes any tracks associated with that language to be enabled and tracks associated with other languages to be disabled. If no tracks are associated with the specified language, the movie’s language is not changed.</p><p>Supported language names:</p><span class="content_text">Albanian</span><br/><span class="content_text">Arabic</span><br/><span class="content_text">Belorussian</span><br/><span class="content_text">Bulgarian</span><br/><span class="content_text">Croatian</span><br/><span class="content_text">Czech</span><br/><span class="content_text">Danish</span><br/><span class="content_text">Dutch</span><br/><span class="content_text">English</span><br/><span class="content_text">Estonian</span><br/><span class="content_text">Faeroese</span><br/><span class="content_text">Farsi</span><br/><span class="content_text">Finnish</span><br/><span class="content_text">Flemish</span><br/><span class="content_text">French</span><br/><span class="content_text">German</span><br/><span class="content_text">Greek</span><br/><span class="content_text">Hebrew</span><br/><span class="content_text">Hindi</span><br/><span class="content_text">Hungarian</span><br/><span class="content_text">Icelandic</span><br/><span class="content_text">Irish</span><br/><span class="content_text">Italian</span><br/><span class="content_text">Japanese</span><br/><span class="content_text">Korean</span><br/><span class="content_text">Latvian</span><br/><span class="content_text">Lithuanian</span><br/><span class="content_text">Maltese</span><br/><span class="content_text">Norwegian</span><br/><span class="content_text">Polish</span><br/><span class="content_text">Portuguese</span><br/><span class="content_text">Romanian</span><br/><span class="content_text">Russian</span><br/><span class="content_text">Saamisk</span><br/><span class="content_text">Serbian</span><br/><span class="content_text">Simplified Chinese</span><br/><span class="content_text">Slovak</span><br/><span class="content_text">Slovenian</span><br/><span class="content_text">Spanish</span><br/><span class="content_text">Swedish</span><br/><span class="content_text">Thai</span><br/><span class="content_text">Traditional Chinese</span><br/><span class="content_text">Turkish</span><br/><span class="content_text">Ukrainian</span><br/><span class="content_text">Urdu</span><br/><span class="content_text">Yiddish</span><br/><p><strong>GetMIMEType</strong></p><div class="codesample"><table><tr><td scope="row"><pre>string GetMIMEType()<span></span></pre></td></tr></table></div><p>Returns the movie’s MIME type.</p><p><strong>GetUserData</strong></p><div class="codesample"><table><tr><td scope="row"><pre>string GetUserData(string type)<span></span></pre></td></tr></table></div><p>Returns the movie user data text with the specified tag. The tag is specified with a four-character string; for example, <code>'©cpy'</code> returns a movie’s copyright string. The following table contains a list of user data tags.</p><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_44" title="Table 1-1User data strings"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 1-1&nbsp;&nbsp;</strong>User data strings</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>String</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data</p></th></tr><tr><td  scope="row"><p><code>'©nam'</code></p></td><td ><p> Movie’s name</p></td></tr><tr><td  scope="row"><p><code>'©cpy'</code></p></td><td ><p> Copyright statement</p></td></tr><tr><td  scope="row"><p><code>'©day'</code></p></td><td ><p> Date the movie content was created</p></td></tr><tr><td  scope="row"><p><code>'©dir'</code></p></td><td ><p> Name of movie’s director</p></td></tr><tr><td  scope="row"><p><code>'©ed1'</code> to <code> '© ed9'</code></p></td><td ><p>Edit dates and descriptions</p></td></tr><tr><td  scope="row"><p><code>'©fmt'</code></p></td><td ><p> Indication of movie format (computer-generated, digitized, and so on)</p></td></tr><tr><td  scope="row"><p><code>'©inf'</code></p></td><td ><p> Information about the movie</p></td></tr><tr><td  scope="row"><p><code>'©prd'</code></p></td><td ><p> Name of movie’s producer</p></td></tr><tr><td  scope="row"><p><code>'©prf'</code></p></td><td ><p> Names of performers</p></td></tr><tr><td  scope="row"><p><code>'©req'</code></p></td><td ><p> Special hardware and software requirements</p></td></tr><tr><td  scope="row"><p><code>'©src'</code></p></td><td ><p> Credits for those who provided movie source content</p></td></tr><tr><td  scope="row"><p><code>'©wrt'</code></p></td><td ><p> Name of movie’s writer </p></td></tr></table></div><p><strong>GetIsVRMovie</strong></p><div class="codesample"><table><tr><td scope="row"><pre>boolean GetIsVRMovie()<span></span></pre></td></tr></table></div><p>Returns <code>true</code> if the movie is a QuickTime VR movie, <code>false</code> otherwise.</p><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_18" title="VR Movie Properties"></a><h4><a name="//apple_ref/doc/uid/TP40001526-CH001-VRMovieProperties" title="VR Movie Properties"></a>VR Movie Properties</h4><p>VR movie properties are movie properties that are present only for movies that contain VR panoramas or VR objects. To test for these properties, use the method <code>GetIsVRMovie().</code></p><p><strong>HotspotURL</strong></p><div class="codesample"><table><tr><td scope="row"><pre>string GetHotspotUrl(int hotspotID)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetHotspotUrl(int hotspotID, string url)<span></span></pre></td></tr></table></div><p>Get and set the URL associated with a specified VR movie hot spot. The Set method is equivalent to setting the <code>HOTSPOT</code><em>n</em> parameter in the <code>&lt;EMBED></code> tag.</p><p><strong>HotspotTarget</strong></p><div class="codesample"><table><tr><td scope="row"><pre>string GetHotspotTarget(int hotspotID)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetHotspotTarget(int hotspotID, string target)<span></span></pre></td></tr></table></div><p>Get and set the target for a specified VR movie hot spot. The Set method is equivalent to setting the <code>TARGET</code><em>n</em> parameter in the <code>&lt;EMBED></code> tag.</p><p><strong>PanAngle</strong></p><div class="codesample"><table><tr><td scope="row"><pre>float GetPanAngle()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetPanAngle(float angle)<span></span></pre></td></tr></table></div><p>Get and set the QuickTime VR movie’s pan angle (in degrees). The Set method is equivalent to setting the <code>PAN</code> parameter in the <code>&lt;EMBED></code> tag.</p><p><strong>TiltAngle</strong></p><div class="codesample"><table><tr><td scope="row"><pre>float GetTiltAngle()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetTiltAngle(float angle)<span></span></pre></td></tr></table></div><p>Get and set the QuickTime VR movie’s tilt angle (in degrees).The Set method is equivalent to setting the <code>TILT</code> parameter in the <code>&lt;EMBED></code> tag.</p><p><strong>FieldOfView</strong></p><div class="codesample"><table><tr><td scope="row"><pre>float GetFieldOfView()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetFieldOfView(float fov)<span></span></pre></td></tr></table></div><p>Get and set the QuickTime VR movie’s field of view (in degrees). Setting a narrower field of view causes the VR to “zoom in.” Setting a wider field of view causes the VR to “zoom out.” The Set method is equivalent to setting the <code>FOV</code> parameter in the <code>&lt;EMBED></code> tag.</p><p><strong>GetNodeCount</strong></p><div class="codesample"><table><tr><td scope="row"><pre>int GetNodeCount()<span></span></pre></td></tr></table></div><p>Returns the number of nodes in a QuickTime VR movie.</p><p><strong>GetNodeID</strong></p><div class="codesample"><table><tr><td scope="row"><pre>int GetNodeID()<span></span></pre></td></tr></table></div><p>Returns the ID of the current node in a QuickTime VR movie.</p><p><strong>SetNodeID</strong></p><div class="codesample"><table><tr><td scope="row"><pre>void SetNodeID(int id)<span></span></pre></td></tr></table></div><p>Sets the current node (by ID) in a QuickTime VR movie (the movie goes to the node with the specified ID).</p><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_19" title="Track Properties"></a><h3><a name="//apple_ref/doc/uid/TP40001526-CH001-TrackProperties" title="Track Properties"></a>Track Properties</h3><p><code>Track</code> properties belong to a specific track within a movie. To get or set a track property, you must know the track’s parent movie and the ordinal number of the track within the movie. When you get a movie’s properties in QuickTime Player, the tracks are listed in numerical order: the first track listed is track 1, the second is track 2, and so on. For example, the following code snippet disables the third track in a movie named MovieOne.</p><div class="codesample"><table><tr><td scope="row"><pre>document.MovieOne.SetTrackEnabled(3,false);<span></span></pre></td></tr></table></div><p><strong>GetTrackName</strong></p><div class="codesample"><table><tr><td scope="row"><pre>string GetTrackName(int index)<span></span></pre></td></tr></table></div><p>Returns the name of the specified track.</p><p><strong>GetTrackType</strong></p><div class="codesample"><table><tr><td scope="row"><pre>string GetTrackType(int index)<span></span></pre></td></tr></table></div><p>Returns the type of the specified track, such as video, sound, text, music, sprite, 3D, VR, streaming, movie, Flash, or tween.</p><p><strong>TrackEnabled</strong></p><div class="codesample"><table><tr><td scope="row"><pre>boolean GetTrackEnabled(int index)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetTrackEnabled(int index, boolean enabled)<span></span></pre></td></tr></table></div><p>Get and set the enabled state of a track.</p><p><strong>SpriteTrackVariable</strong></p><div class="codesample"><table><tr><td scope="row"><pre>string GetSpriteTrackVariable(int trackIndex,    int variableIndex)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void SetSpriteTrackVariable(int trackIndex,    int variableIndex, string value)<span></span></pre></td></tr></table></div><p>Get and set the specified sprite track variable value in the specified track.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001526-CH001-DontLinkElementID_45" title="Note"></a><p><strong>Note:</strong>&nbsp;You can get and set sprite variable values only in sprite tracks that already have defined variables. You cannot use JavaScript to create a new variable or add it to a track. </p></div>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../aQTScripting_Javascro_AIntro/Introduction to JavaScript QT.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../cQTScripting_JavaScri_RevHistory/revisionhistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2004, 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-02-08<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/QuickTime/Conceptual/QTScripting_JavaScript/bQTScripting_JavaScri_Document/QuickTimeandJavaScri.html%3Fid%3DTP40001526-3.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/QuickTime/Conceptual/QTScripting_JavaScript/bQTScripting_JavaScri_Document/QuickTimeandJavaScri.html%3Fid%3DTP40001526-3.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/QuickTime/Conceptual/QTScripting_JavaScript/bQTScripting_JavaScri_Document/QuickTimeandJavaScri.html%3Fid%3DTP40001526-3.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>