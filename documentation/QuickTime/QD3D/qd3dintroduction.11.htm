<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE> Rendering a Model</TITLE></HEAD><BODY BGCOLOR="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- path goes here --><H1 CLASS="H2.Heading2"><A NAME="pgfId=3952"> </A><A NAME="marker=11105"> </A><A NAME="11412"> </A>Rendering a Model</H1><P CLASS="T1.Text1"><A NAME="pgfId=3958"> </A><A NAME="marker=3953"> </A><A NAME="marker=3954"> </A>To render a model using a view, you call QuickDraw&nbsp;3D functions that submit the various shape objects (for instance, geometric objects, groups of geometric objects, and styles) that you want to appear in the view. Because a model might be too complex to process in a single pass (and for other reasons as well), you should call the rendering routines in a <B CLASS="bold">rendering loop.</B> A rendering loop begins with a call to the <TT CLASS="cv">Q3View_StartRendering</TT> function and should end when a call to the <TT CLASS="cv">Q3View_EndRendering</TT> function returns some value other than <TT CLASS="cv">kQ3ViewStatusRetraverse</TT>. Within the body of the rendering loop, you should submit the shapes you want rendered. <A HREF="qd3dintroduction.11.htm#19428" CLASS="XRef">Listing&nbsp;10</A> shows the general structure of a rendering loop.</P><P CLASS="L.Listing"><A NAME="pgfId=3963"> </A>Listing&nbsp;10<A NAME="19428"> </A>A basic rendering loop</P><CODE CLASS="Cv.Code"><A NAME="pgfId=11109"> </A>Q3View_StartRendering(myView);<BR>do {<BR>&nbsp;&nbsp;&nbsp;&nbsp;/*Submit your shape objects here.*/<BR>&nbsp;&nbsp;&nbsp;&nbsp;Q3DisplayGroup_Submit(myGroup, myView);<BR>} while (Q3View_EndRendering(myView) == kQ3ViewStatusRetraverse);<BR></CODE><P CLASS="T1.Text1"><A NAME="pgfId=3965"> </A>The <TT CLASS="cv">Q3View_EndRendering</TT> function returns a <B CLASS="bold">view status value</B> that indicates whether the renderer has finished processing the model. The available view status values are defined by these constants:<A NAME="marker=3966"> </A></P><CODE CLASS="Cv.Code"><A NAME="pgfId=11113"> </A>typedef enum {<BR>&nbsp;&nbsp;&nbsp;&nbsp;kQ3ViewStatusDone,<BR>&nbsp;&nbsp;&nbsp;&nbsp;kQ3ViewStatusRetraverse,<BR>&nbsp;&nbsp;&nbsp;&nbsp;kQ3ViewStatusError,<BR>&nbsp;&nbsp;&nbsp;&nbsp;kQ3ViewStatusCancelled<BR>} TQ3ViewStatus;<BR></CODE><P CLASS="T1.Text1"><A NAME="pgfId=7058"> </A><A HREF="qd3dintroduction.11.htm#28963" CLASS="XRef">Listing&nbsp;11</A> illustrates how to render the model defined in <A HREF="qd3dintroduction.b.htm#33279" CLASS="XRef">Listing&nbsp;4</A>, using the view created and configured in <A HREF="qd3dintroduction.10.htm#33785" CLASS="XRef">Listing&nbsp;9</A>. The <TT CLASS="cv">MyDraw</TT> function defined in <A HREF="qd3dintroduction.11.htm#28963" CLASS="XRef">Listing&nbsp;11</A> retrieves the window information structure attached to a window and uses the information in it to render the model.</P><P CLASS="L.Listing"><A NAME="pgfId=3988"> </A>Listing&nbsp;11<A NAME="28963"> </A>Rendering a model</P><CODE CLASS="CvF.CodeFull"><A NAME="pgfId=11117"> </A>void MyDraw (WindowPtr theWindow)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;WindowInfoHandle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myWinfo;<BR>&nbsp;&nbsp;&nbsp;&nbsp;TQ3Status&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myStat;<BR>&nbsp;&nbsp;&nbsp;&nbsp;TQ3DrawContextObject&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myDrawContext;<BR>&nbsp;&nbsp;&nbsp;&nbsp;TQ3ViewStatus&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myViewStatus;<BR>&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;if (theWindow == NULL)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;myWinfo = (WindowInfoHandle) GetWRefCon(theWindow);<BR>&nbsp;&nbsp;&nbsp;&nbsp;HLock((Handle) myWinfo);<BR>&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;/*Start rendering.*/<BR>&nbsp;&nbsp;&nbsp;&nbsp;myStat = Q3View_StartRendering((**myWinfo).view);<BR>&nbsp;&nbsp;&nbsp;&nbsp;if (myStat == kQ3Failure)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto bail;<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;do {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myStat = Q3Shader_Submit((**myWinfo).illumination, (**myWinfo).view);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (myStat == kQ3Failure)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto bail;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myStat = Q3Style_Submit((**myWinfo).interpolation, (**myWinfo).view);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (myStat == kQ3Failure)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto bail;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myStat = Q3Style_Submit((**myWinfo).backfacing, (**myWinfo).view);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (myStat == kQ3Failure)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto bail;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myStat = Q3Style_Submit((**myWinfo).fillstyle, (**myWinfo).view);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (myStat == kQ3Failure)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto bail;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myStat = Q3DisplayGroup_Submit((**myWinfo).model, (**myWinfo).view);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (myStat == kQ3Failure)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto bail;<BR></CODE><CODE CLASS="CvF.CodeFull"><A NAME="pgfId=11123"> </A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myViewStatus = Q3View_EndRendering((**myWinfo).view);<BR>&nbsp;&nbsp;&nbsp;&nbsp;} while (myViewStatus == kQ3ViewStatusRetraverse);<BR></CODE><CODE CLASS="CvF.CodeFull"><A NAME="pgfId=11129"> </A>&nbsp;&nbsp;&nbsp;&nbsp;HUnlock((Handle) myWinfo);<BR>&nbsp;&nbsp;&nbsp;&nbsp;return;<BR><BR>bail:<BR>&nbsp;&nbsp;&nbsp;&nbsp;HUnlock((Handle) myWinfo);<BR>&nbsp;&nbsp;&nbsp;&nbsp;SysBeep(50);<BR>}<BR></CODE><P CLASS="T1.Text1"><A NAME="pgfId=5804"> </A><A NAME="marker=11131"> </A>The rendering loop allows your application to work with any current and future renderers that require multiple passes through a model's data in order to provide features such as transparency and constructive solid geometry.</P><P CLASS="T1.Text1"><A NAME="pgfId=5820"> </A>For complete information about rendering loops and other kinds of submitting loops, see the chapter <A HREF="qd3dviews.htm#42288" CLASS="XRef">&quot;View Objects&quot;</A> in this book.<A NAME="marker=5813"> </A></P><hr>&#169; 1997 Apple Computer, Inc.</DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY></HTML>