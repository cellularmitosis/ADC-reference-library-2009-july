<html><head><title>Mac OS X
 Manual Page For zpool(8)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/8/zpool" title="Mac OS X
 Manual Page for zpool(8)"><!-- headerDoc=man; indexgroup=Section 8; uid="//apple_ref/doc/man/8/zpool"; name=zpool(8) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
zpool(8)                                 BSD System Manager's Manual                                zpool(8)



<b>NAME</b>
       zpool - configures ZFS storage pools

<b>SYNOPSIS</b>
       <b>zpool</b> [<b>-?</b>]


       <b>zpool</b> <b>create</b> [<b>-fn</b>] [<b>-R</b> <u>root</u>] [<b>-m</b> <u>mountpoint</u>] <u>pool</u> <u>vdev</u> <u>...</u>


       <b>zpool</b> <b>destroy</b> [<b>-f</b>] <u>pool</u>


       <b>zpool</b> <b>add</b> [<b>-fn</b>] <u>pool</u> <u>vdev</u>


       <b>zpool</b> <b>remove</b> <u>pool</u> <u>vdev</u>


       <b>zpool</b>  <b>list</b> [<b>-H</b>] [<b>-o</b> <u>field</u>[,<u>field</u>]*] [<u>pool</u>] ...


       <b>zpool</b> <b>iostat</b> [<b>-v</b>] [<u>pool</u>] ... [<u>interval</u> [<u>count</u>]]


       <b>zpool</b> <b>status</b> [<b>-xv</b>] [<u>pool</u>] ...


       <b>zpool</b> <b>offline</b> [<b>-t</b>] <u>pool</u> <u>device</u> ...


       <b>zpool</b> <b>online</b> <u>pool</u> <u>device</u> ...


       <b>zpool</b> <b>clear</b> <u>pool</u> [<u>device</u>] ...


       <b>zpool</b> <b>attach</b> [<b>-f</b>] <u>pool</u> <u>device</u> <u>new</u><b>_</b><u>device</u>


       <b>zpool</b> <b>detach</b> <u>pool</u> <u>device</u>


       <b>zpool</b> <b>replace</b> [<b>-f</b>] <u>pool</u> <u>device</u> [<u>new</u><b>_</b><u>device</u>]


       <b>zpool</b> <b>scrub</b> [<b>-s</b>] <u>pool</u> ...


       <b>zpool</b> <b>export</b> [<b>-f</b>] <u>pool</u>


       <b>zpool</b> <b>import</b> [<b>-d</b> <u>dir</u>] [<b>-D</b>]


       <b>zpool</b> <b>import</b> [<b>-d</b> <u>dir</u>] [<b>-D</b>] [<b>-f</b>] [<b>-o</b> <u>opts</u>] [<b>-R</b> <u>root</u>] <u>pool</u> | <u>id</u>
           [<u>newpool</u>]


       <b>zpool</b> <b>import</b> [<b>-d</b> <u>dir</u>] [<b>-D</b>] [<b>-f</b>] [<b>-a</b>]


       <b>zpool</b> <b>upgrade</b>


       <b>zpool</b> <b>upgrade</b> <b>-v</b>


       <b>zpool</b> <b>upgrade</b> [<b>-a</b> | <u>pool</u>]


       <b>zpool</b> <b>history</b> [<u>pool</u>] ...


<b>DESCRIPTION</b>
       The  <b>zpool</b>  command configures ZFS storage pools. A storage pool is a collection of devices that pro-<font color="#ffffff" class="whiteout">vides&nbsp;provides</font>
       vides physical storage and data replication for ZFS datasets.

       All datasets within a storage pool share the same space.  See  <a href="zfs.8.html#//apple_ref/doc/man/8/zfs"><b>zfs</b>(8)</a>  for  information  on  managing
       datasets.

   <b>ZFS</b> <b>Read-only</b> <b>Implementation</b>
       ZFS  on OSX is implemented as a readonly filesystem by default.  This means that only the ZFS subcom-<font color="#ffffff" class="whiteout">mands&nbsp;subcommands</font>
       mands that do non write operations are permitted. Permitted subcommands  are  <b>list</b>,  <b>iostat</b>,  <b>status</b>,
       <b>online</b>, <b>offline</b>, <b>scrub</b>, <b>import</b>, and <b>history</b>.

       A  full ZFS implementation that allows all subcommands and is read/write is available for download at
       <a href="http://connect.apple.com/">http://connect.apple.com/</a>

       To determine which version of ZFS is loaded(readonly or writable):

         <b>#</b> <b>kextstat</b> <b>|</b> <b>grep</b> <b>zfs</b>

       com.apple.filesystems.zfs.readonly is the readonly kext version.   com.apple.filesystems.zfs  is  the
       writable kext version.


   <b>Virtual</b> <b>Devices</b> <b>(vdevs)</b>
       A  "virtual  device" describes a single device or a collection of devices organized according to cer-
       tain performance and fault characteristics. The following virtual devices are supported:

       <b>disk</b>      A block device, typically located under "/dev". ZFS can use  individual  slices  or  parti-
                 tions, though the recommended mode of operation is to use whole disks. A disk can be speci-
                 fied by a full path, or it can be a shorthand name (the relative portion of the path  under
                 "/dev").  A whole disk can be specified by omitting the slice or partition designation. For
                 example, "disk1s2" is equivalent to "/dev/disk1s2". When given a whole disk, ZFS  automati-
                 cally labels the disk, if necessary.


       <b>file</b>      A regular file. The use of files as a backing store is strongly discouraged. It is designed
                 primarily for experimental purposes, as the fault tolerance of a file is only  as  good  as
                 the file system of which it is a part. A file must be specified by a full path.


       <b>mirror</b>    A mirror of two or more devices. Data is replicated in an identical fashion across all com-
                 ponents of a mirror. A mirror with <u>N</u> disks of size <u>X</u> can hold <u>X</u>  bytes  and  can  withstand
                 (<u>N-1</u>) devices failing before data integrity is compromised.


       <b>raidz</b>     A  variation  on  <b>RAID-5</b>  that  allows for better distribution of parity and eliminates the
       <b>raidz1</b>    "<b>RAID-5</b> write hole" (in which data and parity become inconsistent after a power loss). Data
       <b>raidz2</b>    and parity is striped across all disks within a <b>raidz</b> group.

                 A  <b>raidz</b>  group  can have either single- or double-parity, meaning that the <b>raidz</b> group can
                 sustain one or two failures respectively without losing any  data.  The  <b>raidz1</b>  <b>vdev</b>  type
                 specifies  a  single-parity  <b>raidz</b> group and the <b>raidz2</b> <b>vdev</b> type specifies a double-parity
                 <b>raidz</b> group. The <b>raidz</b> <b>vdev</b> type is an alias for <b>raidz1</b>.

                 A <b>raidz</b> group with <u>N</u> disks of size <u>X</u> with <u>P</u> parity disks  can  hold  approximately  (<u>N-P</u>)*<u>X</u>
                 bytes  and can withstand one device failing before data integrity is compromised. The mini-
                 mum number of devices in a <b>raidz</b> group is one more than the number  of  parity  disks.  The
                 recommended number is between 3 and 9.


       <b>spare</b>     A special pseudo-<b>vdev</b> which keeps track of available hot spares for a pool. For more infor-
                 mation, see the "Hot Spares" section.


       Virtual devices cannot be nested, so a mirror or <b>raidz</b> virtual  device  can  only  contain  files  or
       disks. Mirrors of mirrors (or other combinations) are not allowed.

       A  pool  can  have  any  number  of  virtual  devices at the top of the configuration (known as "root
       vdevs"). Data is dynamically distributed across all top-level devices to balance data among  devices.
       As new virtual devices are added, ZFS automatically places data on the newly available devices.

       Virtual  devices  are  specified one at a time on the command line, separated by whitespace. The key-
       words "mirror" and "raidz" are used to distinguish where a group ends and another begins.  For  exam-
       ple, the following creates two root vdevs, each a mirror of two disks:

         <b>#</b> <b>zpool</b> <b>create</b> <b>mypool</b> <b>mirror</b> <b>disk1s1</b> <b>disk0s1</b> <b>mirror</b> <b>disk1s2</b> <b>disk0s2</b>



   <b>Device</b> <b>Failure</b> <b>and</b> <b>Recovery</b>
       ZFS  supports  a rich set of mechanisms for handling device failure and data corruption. All metadata
       and data is checksummed, and ZFS automatically repairs bad data from a good copy when  corruption  is
       detected.

       In  order to take advantage of these features, a pool must make use of some form of redundancy, using
       either mirrored or <b>raidz</b> groups. While ZFS supports running in a non-redundant  configuration,  where
       each  root  vdev is simply a disk or file, this is strongly discouraged. A single case of bit corrup-
       tion can render some or all of your data unavailable.

       A pool's health status is described by one of three states: online, degraded, or faulted.  An  online
       pool  has  all  devices  operating normally. A degraded pool is one in which one or more devices have
       failed, but the data is still available due to a redundant configuration. A faulted pool has  one  or
       more failed devices, and there is insufficient redundancy to replicate the missing data.

   <b>Hot</b> <b>Spares</b>
       ZFS  allows  devices to be associated with pools as "hot spares". These devices are not actively used
       in the pool, but when an active device fails, it is automatically replaced by a hot spare. To  create
       a pool with hot spares, specify a "spare" vdev with any number of devices. For example,

         <b>#</b> <b>zpool</b> <b>create</b> <b>pool</b> <b>mirror</b> <b>disk0</b> <b>disk1</b> <b>spare</b> <b>disk2</b> <b>disk3</b>



       Spares can be shared across multiple pools, and can be added with the "zpool add" command and removed
       with the "zpool remove" command. Once a spare replacement is initiated, a new "spare" vdev is created
       within the configuration that will remain there until the original device is replaced. At this point,
       the hot spare becomes available again if another device fails.

       An in-progress spare replacement can be cancelled by detaching the hot spare. If the original faulted
       device  is  detached,  then the hot spare assumes its place in the configuration, and is removed from
       the spare list of all active pools.

   <b>Alternate</b> <b>Root</b> <b>Pools</b>
       The "zpool create -R" and "zpool import -R" commands allow users to create and import a pool  with  a
       different  root  path.  By  default, whenever a pool is created or imported on a system, it is perma-
       nently added so that it is available whenever the system boots.  For  removable  media,  or  when  in
       recovery situations, this may not always be desirable. An alternate root pool does not persist on the
       system. Instead, it exists only until exported or the system is rebooted, at which point it will have
       to be imported again.

       In  addition,  all  mount  points in the pool are prefixed with the given root, so a pool can be con-
       strained to a particular area of the file system. This is most useful when  importing  unknown  pools
       from removable media, as the mount points of any file systems cannot be trusted.

       When  creating an alternate root pool, the default mount point is "/", rather than the normal default
       "/<u>Volumes/pool</u>".

   <b>Subcommands</b>
       All subcommands that modify state are logged persistently to the pool in their original form.

       The <b>zpool</b> command provides subcommands to create and destroy storage pools, add capacity  to  storage
       pools, and provide information about the storage pools. The following subcommands are supported:

       <b>zpool</b> <b>-?</b>

           Displays a help message.


       <b>zpool</b> <b>create</b> [<b>-fn</b>] [<b>-R</b> <u>root</u>] [<b>-m</b> <u>mountpoint</u>] <u>pool</u> <u>vdev</u> <u>...</u>

           Creates a new storage pool containing the virtual devices specified on the command line. The pool
           name must begin with a letter, and can only contain alphanumeric characters as well as underscore
           ("_"),  dash ("-"), and period ("."). The pool names "mirror", "raidz", and "spare" are reserved,
           as are names beginning with the pattern "c[0-9]". The <b>vdev</b>  specification  is  described  in  the
           "Virtual Devices" section.

           The command verifies that each device specified is accessible and not currently in use by another
           subsystem. There are some uses, such as being currently mounted, or specified  as  the  dedicated
           dump  device,  that  prevents  a device from ever being used by ZFS. Other uses, such as having a
           preexisting <b>HFS</b> file system, can be overridden with the <b>-f</b> option.

           The command also checks that the replication strategy for the pool is consistent. An  attempt  to
           combine  redundant and non-redundant storage in a single pool, or to mix disks and files, results
           in an error unless <b>-f</b> is specified. The use of differently sized devices within a single <b>raidz</b> or
           mirror group is also flagged as an error unless <b>-f</b> is specified.

           Unless  the  <b>-R</b>  option is specified, the default mount point is "/<u>Volumes/pool</u>". The mount point
           must not exist or must be empty, or else the root dataset cannot be mounted. This can be overrid-
           den with the <b>-m</b> option.

           <b>-f</b>               Forces  use of <b>vdevs</b>, even if they appear in use or specify a conflicting repli-
                            cation level. Not all devices can be overridden in this manner.


           <b>-n</b>               Displays the configuration that would be  used  without  actually  creating  the
                            pool.  The actual pool creation can still fail due to insufficient privileges or
                            device sharing.


           <b>-R</b> <u>root</u>          Creates the pool with an alternate <u>root</u>. See the "Alternate Root Pools" section.
                            The root dataset has its mount point set to "/" as part of this operation.


           <b>-m</b> <u>mountpoint</u>    Sets  the  mount  point  for the root dataset. The default mount point is "/<u>Vol</u>-
                            <u>umes/pool</u>". The mount point must be an absolute path, "<b>legacy</b>", or  "<b>none</b>".  For
                            more information on dataset mount points, see <a href="zfs.8.html#//apple_ref/doc/man/8/zfs"><b>zfs</b>(8)</a>.



       <b>zpool</b> <b>destroy</b> [<b>-f</b>] <u>pool</u>

           Destroys  the given pool, freeing up any devices for other use. This command tries to unmount any
           active datasets before destroying the pool.

           <b>-f</b>    Forces any active datasets contained within the pool to be unmounted.



       <b>zpool</b> <b>add</b> [<b>-fn</b>] <u>pool</u> <u>vdev</u> <u>...</u>

           Adds the specified virtual devices to the given pool. The <u>vdev</u> specification is described in  the
           "Virtual  Devices"  section.  The  behavior of the <b>-f</b> option, and the device checks performed are
           described in the "zpool create" subcommand.

           <b>-f</b>    Forces use of <b>vdevs</b>, even if they appear in use or specify a conflicting replication level.
                 Not all devices can be overridden in this manner.


           <b>-n</b>    Displays the configuration that would be used without actually adding the <b>vdevs</b>. The actual
                 pool creation can still fail due to insufficient privileges or device sharing.

           Do not add a disk that is currently configured as a quorum device to a zpool. Once a disk is in a
           zpool, that disk can then be configured as a quorum device.


       <b>zpool</b> <b>remove</b> <u>pool</u> <u>vdev</u>

           Removes  the  given <b>vdev</b> from the pool. This command currently only supports removing hot spares.
           Devices which are part of a mirror can be removed using the "zpool  detach"  command.  <b>Raidz</b>  and
           top-level <b>vdevs</b> cannot be removed from a pool.


       <b>zpool</b> <b>list</b> [<b>-H</b>] [<b>-o</b> <u>field</u>[,<u>field*</u>]] [<u>pool</u>] ...

           Lists  the  given  pools along with a health status and space usage. When given no arguments, all
           pools in the system are listed.

           <b>-H</b>          Scripted mode. Do not display headers, and separate fields by a single tab instead of
                       arbitrary space.


           <b>-o</b> <u>field</u>    Comma-separated list of fields to display. Each field must be one of:

                         name            Pool name
                         size            Total size
                         used            Amount of space used
                         available       Amount of space available
                         capacity        Percentage of pool space used
                         health          Health status


                       The default is all fields.

           This  command reports actual physical space available to the storage pool. The physical space can
           be different from the total amount of space that any contained datasets  can  actually  use.  The
           amount  of  space  used in a <b>raidz</b> configuration depends on the characteristics of the data being
           written. In addition, ZFS reserves some space for internal accounting  that  the  <a href="zfs.8.html#//apple_ref/doc/man/8/zfs"><b>zfs</b>(8)</a>  command
           takes  into  account,  but  the  <b>zpool</b> command does not. For non-full pools of a reasonable size,
           these effects should be invisible. For small pools, or pools that are close to  being  completely
           full, these discrepancies may become more noticeable.


       <b>zpool</b> <b>iostat</b> [<b>-v</b>] [<u>pool</u>] ... [<u>interval</u> [<u>count</u>]]

           Displays  <b>I/O</b>  statistics for the given pools. When given an interval, the statistics are printed
           every <u>interval</u> seconds until <b>Ctrl-C</b> is pressed. If no <u>pools</u> are specified, statistics  for  every
           pool  in  the  system  is shown. If <u>count</u> is specified, the command exits after <u>count</u> reports are
           printed.

           <b>-v</b>    Verbose statistics. Reports usage statistics for individual <u>vdevs</u> within the pool, in addi-
                 tion to the pool-wide statistics.



       <b>zpool</b> <b>status</b> [<b>-xv</b>] [<u>pool</u>] ...

           Displays the detailed health status for the given pools. If no <u>pool</u> is specified, then the status
           of each pool in the system is displayed.

           If a scrub or resilver is in progress, this command reports the percentage done and the estimated
           time  to  completion.  Both of these are only approximate, because the amount of data in the pool
           and the other workloads on the system can change.

           <b>-x</b>    Only display status for pools that are exhibiting errors or are otherwise unavailable.


           <b>-v</b>    Displays verbose data error information, printing out a complete list of  all  data  errors
                 since the last complete pool scrub.



       <b>zpool</b> <b>offline</b> [<b>-t</b>] <u>pool</u> <u>device</u> ...

           Takes  the  specified physical device offline. While the <u>device</u> is offline, no attempt is made to
           read or write to the device.

           This command is not applicable to spares.

           <b>-t</b>    Temporary. Upon reboot, the specified physical device reverts to its previous state.



       <b>zpool</b> <b>online</b> <u>pool</u> <u>device</u> ...

           Brings the specified physical device online.

           This command is not applicable to spares.


       <b>zpool</b> <b>clear</b> <u>pool</u> [<u>device</u>] ...

           Clears device errors in a pool. If no arguments are specified, all device errors within the  pool
           are cleared. If one or more devices is specified, only those errors associated with the specified
           device or devices are cleared.


       <b>zpool</b> <b>attach</b> [<b>-f</b>] <u>pool</u> <u>device</u> <u>new</u><b>_</b><u>device</u>

           Attaches <u>new</u><b>_</b><u>device</u> to an existing <b>zpool</b> device. The existing device cannot be part  of  a  <b>raidz</b>
           configuration.  If <u>device</u> is not currently part of a mirrored configuration, <u>device</u> automatically
           transforms into a two-way mirror of <u>device</u> and <u>new</u><b>_</b><u>device</u>. If <u>device</u> is part of a two-way mirror,
           attaching  <u>new</u><b>_</b><u>device</u> creates a three-way mirror, and so on. In either case, <u>new</u><b>_</b><u>device</u> begins to
           resilver immediately.

           <b>-f</b>    Forces use of <u>new</u><b>_</b><u>device</u>, even if its appears to be in use. Not all devices can be overrid-
                 den in this manner.



       <b>zpool</b> <b>detach</b> <u>pool</u> <u>device</u>

           Detaches  <u>device</u>  from a mirror. The operation is refused if there are no other valid replicas of
           the data.


       <b>zpool</b> <b>replace</b> [<b>-f</b>] <u>pool</u> <u>old</u><b>_</b><u>device</u> [<u>new</u><b>_</b><u>device</u>]

           Replaces <u>old</u><b>_</b><u>device</u> with <u>new</u><b>_</b><u>device</u>. This is equivalent to attaching <u>new</u><b>_</b><u>device</u>, waiting  for  it
           to resilver, and then detaching <u>old</u><b>_</b><u>device</u>.

           The  size of <u>new</u><b>_</b><u>device</u> must be greater than or equal to the minimum size of all the devices in a
           mirror or <b>raidz</b> configuration.

           If <u>new</u><b>_</b><u>device</u> is not specified, it defaults to <u>old</u><b>_</b><u>device</u>. This form  of  replacement  is  useful
           after  an  existing  disk has failed and has been physically replaced. In this case, the new disk
           may have the same <b>/dev</b> path as the old device, even though it is actually a different  disk.  ZFS
           recognizes this.

           <b>-f</b>    Forces use of <u>new</u><b>_</b><u>device</u>, even if its appears to be in use. Not all devices can be overrid-
                 den in this manner.



       <b>zpool</b> <b>scrub</b> [<b>-s</b>] <u>pool</u> ...

           Begins a scrub. The scrub examines all data in the specified pools to verify  that  it  checksums
           correctly. For replicated (mirror or <b>raidz</b>) devices, ZFS automatically repairs any damage discov-
           ered during the scrub. The "<b>zpool</b> <b>status</b>" command reports the progress of the  scrub  and  summa-
           rizes the results of the scrub upon completion.

           Scrubbing  and  resilvering  are very similar operations. The difference is that resilvering only
           examines data that ZFS knows to be out of date (for example, when attaching a  new  device  to  a
           mirror  or  replacing an existing device), whereas scrubbing examines all data to discover silent
           errors due to hardware faults or disk failure.

           Because scrubbing and resilvering are <b>I/O</b>-intensive operations, ZFS only allows one at a time. If
           a  scrub  is already in progress, the "<b>zpool</b> <b>scrub</b>" command terminates it and starts a new scrub.
           If a resilver is in progress, ZFS does not allow a scrub to be started until  the  resilver  com-
           pletes.

           <b>-s</b>    Stop scrubbing.



       <b>zpool</b> <b>export</b> [<b>-f</b>] <u>pool</u> ...

           Exports  the  given pools from the system. All devices are marked as exported, but are still con-
           sidered in use by other subsystems. The devices can be moved between systems (even those of  dif-
           ferent endianness) and imported as long as a sufficient number of devices are present.

           Before exporting the pool, all datasets within the pool are unmounted.

           For  pools  to be portable, you must give the <b>zpool</b> command whole disks, not just slices, so that
           ZFS can label the disks with portable <b>EFI</b> labels. Otherwise, disk drivers on platforms of differ-
           ent endianness will not recognize the disks.

           <b>-f</b>    Forcefully unmount all datasets, using the "<b>unmount</b> <b>-f</b>" command.



       <b>zpool</b> <b>import</b> [<b>-d</b> <u>dir</u>] [<b>-D</b>]

           Lists  pools  available  to  import. If the <b>-d</b> option is not specified, this command searches for
           devices in "/dev" with the prefix "disk". The <b>-d</b> option can be specified multiple times, and  all
           directories are searched. If the device appears to be part of an exported pool, this command dis-
           plays a summary of the pool with the name of the pool, a numeric identifier, as well as the  <u>vdev</u>
           layout and current health of the device for each device or file. Destroyed pools, pools that were
           previously destroyed with the "<b>-zpool</b> <b>destroy</b>" command, are not listed unless the  <b>-D</b>  option  is
           specified.

           The numeric identifier is unique, and can be used instead of the pool name when multiple exported
           pools of the same name are available.

           <b>-d</b> <u>dir</u>    Searches for devices or files in <u>dir</u>. The <b>-d</b> option can be specified multiple times.


           <b>-D</b>        Lists destroyed pools only.



       <b>zpool</b> <b>import</b> [<b>-d</b> <u>dir</u>] [<b>-D</b>] [<b>-f</b>] [<b>-o</b> <u>opts</u>] [<b>-R</b> <u>root</u>] <u>pool</u> | <u>id</u> [<u>newpool</u>]

           Imports a specific pool. A pool can be identified by its name or the numeric identifier. If  <u>new</u>-
           <u>pool</u>  is  specified,  the pool is imported using the name <u>newpool</u>. Otherwise, it is imported with
           the same name as its exported name.

           If a device is removed from a system without running "<b>zpool</b> <b>export</b>" first, the device appears  as
           potentially active. It cannot be determined if this was a failed export, or whether the device is
           really in use from another host. To import a pool in this state, the <b>-f</b> option is required.

           <b>-d</b> <u>dir</u>     Searches for devices or files in <u>dir</u>. The <b>-d</b> option can be specified multiple times.


           <b>-D</b>         Imports destroyed pool. The <b>-f</b> option is also required.


           <b>-f</b>         Forces import, even if the pool appears to be potentially active.


           <b>-o</b> <u>opts</u>    Comma-separated list of mount options to use when mounting datasets within  the  pool.
                      See <a href="zfs.8.html#//apple_ref/doc/man/8/zfs"><b>zfs</b>(8)</a> for a description of dataset properties and mount options.


           <b>-R</b> <u>root</u>    Imports <!-- a -->pool(s)<!-- /a --> with an alternate <u>root</u>. See the "Alternate Root Pools" section.



       <b>zpool</b> <b>import</b> [<b>-d</b> <u>dir</u>] [<b>-D</b>] [<b>-f</b>] [<b>-a</b>]

           Imports all pools found in the search directories. Identical to the previous command, except that
           all pools with a sufficient number of devices available are imported. Destroyed pools, pools that
           were  previously  destroyed with the "<b>-zpool</b> <b>destroy</b>" command, will not be imported unless the <b>-D</b>
           option is specified.

           <b>-d</b> <u>dir</u>    Searches for devices or files in <u>dir</u>. The <b>-d</b> option can be specified multiple times.


           <b>-D</b>        Imports destroyed pools only. The <b>-f</b> option is also required.


           <b>-f</b>        Forces import, even if the pool appears to be potentially active.



       <b>zpool</b> <b>upgrade</b>

           Displays all pools formatted using a different ZFS on-disk version. Older versions  can  continue
           to  be  used,  but  some  features may not be available. These pools can be upgraded using "<b>zpool</b>
           <b>upgrade</b> <b>-a</b>". Pools that are formatted with a more recent version  are  also  displayed,  although
           these pools will be inaccessible on the system.


       <b>zpool</b> <b>upgrade</b> <b>-v</b>

           Displays  ZFS versions supported by the current software. The current ZFS versions and all previ-
           ous supportedversions are displayed, along with an explanation of the features provided with each
           version.


       <b>zpool</b> <b>upgrade</b> [<b>-a</b> | <u>pool</u>]

           Upgrades the given pool to the latest on-disk version. Once this is done, the pool will no longer
           be accessible on systems running older versions of the software.

           <b>-a</b>    Upgrades all pools.



       <b>zpool</b> <b>history</b> [<u>pool</u>] ...

           Displays the command history of the specified pools (or all pools if no pool is specified).


<b>EXAMPLES</b>
       <b>Example</b> <b>1</b> Creating a RAID-Z Storage Pool

       The following command creates a pool with a single <b>raidz</b> root <u>vdev</u> that consists of six disks.


         <b>#</b> <b>zpool</b> <b>create</b> <b>tank</b> <b>raidz</b> <b>disk0</b> <b>disk1</b> <b>disk2</b> <b>disk3</b> <b>disk4</b> <b>disk5</b>



       <b>Example</b> <b>2</b> Creating a Mirrored Storage Pool

       The following command creates a pool with two mirrors, where each mirror contains two disks.


         <b>#</b> <b>zpool</b> <b>create</b> <b>tank</b> <b>mirror</b> <b>disk0</b> <b>disk1</b> <b>mirror</b> <b>disk2</b> <b>disk3</b>



       <b>Example</b> <b>3</b> Creating a ZFS Storage Pool by Using Slices

       The following command creates an unmirrored pool using two disk slices.


         <b>#</b> <b>zpool</b> <b>create</b> <b>tank</b> <b>disk0s1</b> <b>disk0s4</b>



       <b>Example</b> <b>4</b> Creating a ZFS Storage Pool by Using Files

       The following command creates an unmirrored pool using files. While not recommended, a pool based  on
       files can be useful for experimental purposes.


         <b>#</b> <b>zpool</b> <b>create</b> <b>tank</b> <b>/path/to/file/a</b> <b>/path/to/file/b</b>



       <b>Example</b> <b>5</b> Adding a Mirror to a ZFS Storage Pool

       The  following  command adds two mirrored disks to the pool "<u>tank</u>", assuming the pool is already made
       up of two-way mirrors. The additional space is immediately available to any datasets within the pool.


         <b>#</b> <b>zpool</b> <b>add</b> <b>tank</b> <b>mirror</b> <b>disk1</b> <b>disk2</b>



       <b>Example</b> <b>6</b> Listing Available ZFS Storage Pools

       The following command lists all available pools on the system. In this case, the pool <u>zion</u> is faulted
       due to a missing device.


       The results from this command are similar to the following:


         <b>#</b> <b>zpool</b> <b>list</b>
             NAME              SIZE    USED   AVAIL    CAP  HEALTH     ALTROOT
             pool             67.5G   2.92M   67.5G     0%  ONLINE     -
             tank             67.5G   2.92M   67.5G     0%  ONLINE     -
             zion                 -       -       -     0%  FAULTED    -



       <b>Example</b> <b>7</b> Destroying a ZFS Storage Pool

       The following command destroys the pool "<u>tank</u>" and any datasets contained within.


         <b>#</b> <b>zpool</b> <b>destroy</b> <b>-f</b> <b>tank</b>



       <b>Example</b> <b>8</b> Exporting a ZFS Storage Pool

       The following command exports the devices in pool <u>tank</u>  so  that  they  can  be  relocated  or  later
       imported.


         <b>#</b> <b>zpool</b> <b>export</b> <b>tank</b>



       <b>Example</b> <b>9</b> Importing a ZFS Storage Pool

       The  following command displays available pools, and then imports the pool "tank" for use on the sys-
       tem.


       The results from this command are similar to the following:


         <b>#</b> <b>zpool</b> <b>import</b>
          pool: tank
            id: 15451357997522795478
         state: ONLINE
         action: The pool can be imported using its name or numeric identifier.
         config:

                tank        ONLINE
                  mirror    ONLINE
                    disk1s2  ONLINE
                    disk2s3  ONLINE

         <b>#</b> <b>zpool</b> <b>import</b> <b>tank</b>



       <b>Example</b> <b>10</b> Upgrading All ZFS Storage Pools to the Current Version

       The following command upgrades all ZFS Storage pools to the current version of the software.


         <b>#</b> <b>zpool</b> <b>upgrade</b> <b>-a</b>
         This system is currently running ZFS version 2.



       <b>Example</b> <b>11</b> Managing Hot Spares

       The following command creates a new pool with an available hot spare:


         <b>#</b> <b>zpool</b> <b>create</b> <b>tank</b> <b>mirror</b> <b>disk0</b> <b>disk1</b> <b>spare</b> <b>disk2</b>



       If one of the disks were to fail, the pool would be reduced to the degraded state. The failed  device
       can be replaced using the following command:


         <b>#</b> <b>zpool</b> <b>replace</b> <b>tank</b> <b>disk0</b> <b>disk3</b>



       Once  the  data  has been resilvered, the spare is automatically removed and is made available should
       another device fails.  The hot spare can be permanently removed from the  pool  using  the  following
       command:


         <b>#</b> <b>zpool</b> <b>remove</b> <b>tank</b> <b>disk2</b>



<b>EXIT</b> <b>STATUS</b>
       The following exit values are returned:

       <b>0</b>    Successful completion.


       <b>1</b>    An error occurred.


       <b>2</b>    Invalid command line options were specified.


<b>SEE</b> <b>ALSO</b>
       <a href="zfs.8.html#//apple_ref/doc/man/8/zfs"><b>zfs</b>(8)</a>, <a href="zfs.util.8.html#//apple_ref/doc/man/8/zfs.util">zfs.util(8)</a>


<b>HISTORY</b>
       The <b>zpool</b> command first appeared in Mac OS X 10.5 (Leopard).



Mac OS X                                         14 Nov 2006                                        zpool(8)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man8/zpool.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man8/zpool.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man8/zpool.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
