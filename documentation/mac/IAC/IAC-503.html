<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>DBInit(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING503></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-502.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-504.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-469.html"><B>Chapter 12 - Data Access Manager</B></A> / <A HREF="IAC-487.html"><B>Data Access Manager Reference</B></A><BR><DL><DD><A HREF="IAC-492.html"><B>Data Access Manager Routines</B></A> / <A HREF="IAC-502.html"><B>Low-Level Interface: Controlling the Session</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING503-0></A>
<H3><A NAME=MARKER-9-323></A><A NAME=MARKER-21-324></A>DBInit</H3>
 <A NAME=MARKER-2-325></A><A NAME=MARKER-2-326></A>Use the <CODE>DBInit</CODE> function to initiate a session with a data server. <P>
<PRE>
FUNCTION DBInit (VAR sessID: LongInt; ddevName: Str63; 
                 host: Str255; user: Str255; password: Str255;
                 connStr: Str255; 
                 asyncPB: DBAsyncParmBlkPtr): OSErr;
</PRE>
<DL>
<DT><CODE>sessID</CODE>
<DD> The <CODE>DBInit</CODE> function returns the session ID in this parameter. This session ID is unique; no other current session, for any database extension, has the same session ID. You must specify the session ID any time you want to send data to or retrieve data from this session. Depending on the database extension you are using, the <CODE>DBInit</CODE> function might return a session ID of 0 if it fails to initiate a session, or it might return a nonzero session ID and a result code other than <CODE>noErr</CODE>. In the latter case, you can pass the session ID to the <CODE>DBGetErr</CODE> function to determine the cause of the error.
<DT><CODE>ddevName</CODE>
<DD> A string of no more than 63 characters that specifies the name of the database extension. The name of the database extension is contained in the database extension file in a resource of type <CODE>'STR '</CODE> with a resource ID of 128. For the Data Access Language database extension provided by Apple, for example, this string is "<CODE>DAL</CODE>".
<DT><CODE>host</CODE>
<DD> The name of the host system on which the data server is located. This name depends on the manner in which the database extension initiates communication with the data server and how the system administrator has set up the computer system.
<DT><CODE>user</CODE>
<DD> The name of the user.
<DT><CODE>password</CODE>
<DD> The password associated with the user name.
<DT><CODE>connStr</CODE>
<DD> A string that is passed to the data server, which might pass it on to the database management software on the host computer. This string is necessary in some systems to complete log-on procedures.
<DT><CODE>asyncPB</CODE>
<DD> A pointer to an asynchronous parameter block. If you do not want to call the function asynchronously, set this parameter to <CODE>NIL</CODE>.
</DL>
<A NAME=HEADING503-10></A>
<H5>DESCRIPTION</H5>
 You must initiate a session before you call any Data Access Manager function that requires a session ID as an input parameter. If the <CODE>DBInit</CODE> function returns a nonzero session ID, you must call the <CODE>DBEnd</CODE> function to terminate the session, even if the <CODE>DBInit</CODE> function also returns a result code other than <CODE>noErr</CODE>.<P>
 Because the high-level function <CODE>DBStartQuery</CODE> can call the <CODE>DBInit</CODE> function, you do not have to call the <CODE>DBInit</CODE> function if you have called the <CODE>DBStartQuery</CODE> function.<P>
<A NAME=HEADING503-13></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 The <CODE>DBInit</CODE> function may move or purge memory. You should not call this routine from within an interrupt, such as in a completion routine or a VBL task.<P>
<A NAME=HEADING503-15></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The trap macro and routine selector for the <CODE>DBInit</CODE> function are
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Trap macro<TH>Selector<TR>
<TD>_DBInit<TD>$0E02</TABLE>
<P>
<A NAME=HEADING503-17></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>rcDBError<TD>-802<TD>Error initiating session<TR>
<TD>rcDBBadDDev<TD>-808<TD>Couldn't find the specified database extension, or error occurred in opening database extension<TR>
<TD>rcDBAsyncNotSupp<TD>-809<TD>The database extension does not support asynchronous calls<TR>
<TD>rcDBPackNotInited<TD>-813<TD>The <CODE>InitDBPack</CODE> function has not yet been called</TABLE>
</H5>
<A NAME=HEADING503-18></A>
<H5>SEE ALSO</H5>
 For a description of the asynchronous parameter block, see <A HREF=IAC-489.html#MARKER-9-246>page 12-56</A>. See <A HREF=IAC-479.html#MARKER-9-157>Listing 12-5</A> beginning on <A HREF=IAC-479.html#MARKER-9-157>page 12-34</A> for an example of the use of the <CODE>DBInit</CODE> function. See <A HREF=IAC-498.html#MARKER-9-305>page 12-64</A> for a description of the <CODE>DBStartQuery</CODE> function. The <CODE>DBEnd</CODE> function is described next.<A NAME=MARKER-2-327></A><A NAME=MARKER-2-328></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-502.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-504.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
