<html><head><title>Mac OS X
 Manual Page For tnftpd(8)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/8/tnftpd" title="Mac OS X
 Manual Page for tnftpd(8)"><!-- headerDoc=man; indexgroup=Section 8; uid="//apple_ref/doc/man/8/tnftpd"; name=tnftpd(8) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
TNFTPD(8)                 BSD System Manager's Manual                TNFTPD(8)

<b>NAME</b>
     <b>tnftpd</b> -- Internet File Transfer Protocol server

<b>SYNOPSIS</b>
     <b>tnftpd</b> [<b>-46DdHlQqrsUuWwX</b>] [<b>-a</b> <u>anondir</u>] [<b>-C</b> <u>user</u>] [<b>-c</b> <u>confdir</u>] [<b>-e</b> <u>emailaddr</u>] [<b>-h</b> <u>hostname</u>]
            [<b>-L</b> <u>xferlogfile</u>] [<b>-P</b> <u>dataport</u>] [<b>-V</b> <u>version</u>]

<b>DESCRIPTION</b>
     <b>tnftpd</b> is the Internet File Transfer Protocol server process.  The server uses the TCP protocol and
     listens at the port specified in the ``ftp'' service specification; see <a href="../man5/services.5.html#//apple_ref/doc/man/5/services">services(5)</a>.

     Available options:

     <b>-4</b>      When <b>-D</b> is specified, bind to IPv4 addresses only.

     <b>-6</b>      When <b>-D</b> is specified, bind to IPv6 addresses only.

     <b>-a</b> <u>anondir</u>
             Define <u>anondir</u> as the directory to <a href="../man2/chroot.2.html#//apple_ref/doc/man/2/chroot">chroot(2)</a> into for anonymous logins.  Default is the home
             directory for the ftp user.  This can also be specified with the <a href="../man5/ftpd.conf.5.html#//apple_ref/doc/man/5/ftpd.conf">ftpd.conf(5)</a> <b>chroot</b> directive.

     <b>-C</b> <u>user</u>
             Check whether <u>user</u> would be granted access under the restrictions given in <a href="../man5/ftpusers.5.html#//apple_ref/doc/man/5/ftpusers">ftpusers(5)</a> and exit
             without attempting a connection.  <b>tnftpd</b> exits with an exit code of 0 if access would be
             granted, or 1 otherwise.  This can be useful for testing configurations.

     <b>-c</b> <u>confdir</u>
             Change the root directory of the configuration files from ``<u>/etc</u>'' to <u>confdir</u>.  This changes
             the directory for the following files: <u>/etc/ftpchroot</u>, <u>/etc/ftpusers</u>, <u>/etc/ftpwelcome</u>,
             <u>/etc/motd</u>, and the file specified by the <a href="../man5/ftpd.conf.5.html#//apple_ref/doc/man/5/ftpd.conf">ftpd.conf(5)</a> <b>limit</b> directive.

     <b>-D</b>      Run as daemon.  <b>tnftpd</b> will listen on the default FTP port for incoming connections and fork a
             child for each connection.  This is lower overhead than starting <b>tnftpd</b> from <!-- a -->inetd(8)<!-- /a --> and thus
             might be useful on busy servers to reduce load.

     <b>-d</b>      Debugging information is written to the syslog using a facility of LOG_FTP.

     <b>-e</b> <u>emailaddr</u>
             Use <u>emailaddr</u> for the ``%E'' escape sequence (see <u>Display</u> <u>file</u> <u>escape</u> <u>sequences</u>)

     <b>-H</b>      Equivalent to ``-h `hostname`''.

     <b>-h</b> <u>hostname</u>
             Explicitly set the hostname to advertise as to <u>hostname</u>.  The default is the hostname associ-<font color="#ffffff" class="whiteout">ated&nbsp;associated</font>
             ated with the IP address that <b>tnftpd</b> is listening on.  This ability (with or without <b>-h</b>), in
             conjunction with <b>-c</b> <u>confdir</u>, is useful when configuring `virtual' FTP servers, each listening
             on separate addresses as separate names.  Refer to <!-- a -->inetd.conf(5)<!-- /a --> for more information on start-<font color="#ffffff" class="whiteout">ing&nbsp;starting</font>
             ing services to listen on specific IP addresses.

     <b>-L</b> <u>xferlogfile</u>
             Log wu-ftpd style `xferlog' entries to <u>xferlogfile</u>.

     <b>-l</b>      Each successful and failed FTP session is logged using syslog with a facility of LOG_FTP.  If
             this option is specified more than once, the retrieve (get), store (put), append, delete, make
             directory, remove directory and rename operations and their file name arguments are also
             logged.

     <b>-P</b> <u>dataport</u>
             Use <u>dataport</u> as the data port, overriding the default of using the port one less that the port
             <b>tnftpd</b> is listening on.

     <b>-Q</b>      Disable the use of pid files for keeping track of the number of logged-in users per class.
             This may reduce the load on heavily loaded FTP servers.

     <b>-q</b>      Enable the use of pid files for keeping track of the number of logged-in users per class.  This
             is the default.

     <b>-r</b>      Permanently drop root privileges once the user is logged in.  The use of this option may result
             in the server using a port other than the (listening-port - 1) for <b>PORT</b> style commands, which
             is contrary to the <b>RFC</b> <b>959</b> specification, but in practice very few clients rely upon this be-<font color="#ffffff" class="whiteout">haviour.&nbsp;behaviour.</font>
             haviour.  See <u>SECURITY</u> <u>CONSIDERATIONS</u> below for more details.

     <b>-s</b>      Require a secure authentication mechanism like Kerberos or S/Key to be used.

     <b>-U</b>      Don't log each concurrent FTP session to <u>/var/run/utmp</u>.  This is the default.

     <b>-u</b>      Log each concurrent FTP session to <u>/var/run/utmp</u>, making them visible to commands such as
             <a href="../man1/who.1.html#//apple_ref/doc/man/1/who">who(1)</a>.

     <b>-V</b> <u>version</u>
             Use <u>version</u> as the version to advertise in the login banner and in the output of <b>STAT</b> and <b>SYST</b>
             instead of the default version information.  If <u>version</u> is empty or `-' then don't display any
             version information.

     <b>-W</b>      Don't log each FTP session to <u>/var/log/wtmp</u>.

     <b>-w</b>      Log each FTP session to <u>/var/log/wtmp</u>, making them visible to commands such as <a href="../man1/last.1.html#//apple_ref/doc/man/1/last">last(1)</a>.  This
             is the default.

     <b>-X</b>      Log wu-ftpd style `xferlog' entries to the syslog, prefixed with ``xferlog: '', using a facil-<font color="#ffffff" class="whiteout">ity&nbsp;facility</font>
             ity of LOG_FTP.  These syslog entries can be converted to a wu-ftpd style <u>xferlog</u> file suitable
             for input into a third-party log analysis tool with a command similar to:
                   grep 'xferlog: ' /var/log/xferlog | \
                      sed -e 's/^.*xferlog: //' &gt; wuxferlog

     The file <u>/etc/nologin</u> can be used to disable FTP access.  If the file exists, <b>tnftpd</b> displays it and
     exits.  If the file <u>/etc/ftpwelcome</u> exists, <b>tnftpd</b> prints it before issuing the ``ready'' message.  If
     the file <u>/etc/motd</u> exists (under the chroot directory if applicable), <b>tnftpd</b> prints it after a success-<font color="#ffffff" class="whiteout">ful&nbsp;successful</font>
     ful login.  This may be changed with the <a href="../man5/ftpd.conf.5.html#//apple_ref/doc/man/5/ftpd.conf">ftpd.conf(5)</a> directive <b>motd</b>.

     The <b>tnftpd</b> server currently supports the following FTP requests.  The case of the requests is ignored.

           <b>Request</b>    <b>Description</b>
           ABOR       abort previous command
           ACCT       specify account (ignored)
           ALLO       allocate storage (vacuously)
           APPE       append to a file
           CDUP       change to parent of current working directory
           CWD        change working directory
           DELE       delete a file
           EPSV       prepare for server-to-server transfer
           EPRT       specify data connection port
           FEAT       list extra features that are not defined in <b>RFC</b> <b>959</b>
           HELP       give help information
           LIST       give list files in a directory (``ls -lA'')
           LPSV       prepare for server-to-server transfer
           LPRT       specify data connection port
           MLSD       list contents of directory in a machine-processable form
           MLST       show a pathname in a machine-processable form
           MKD        make a directory
           MDTM       show last modification time of file
           MODE       specify data transfer <u>mode</u>
           NLST       give name list of files in directory
           NOOP       do nothing
           OPTS       define persistent options for a given command
           PASS       specify password
           PASV       prepare for server-to-server transfer
           PORT       specify data connection port
           PWD        print the current working directory
           QUIT       terminate session
           REST       restart incomplete transfer
           RETR       retrieve a file
           RMD        remove a directory
           RNFR       specify rename-from file name
           RNTO       specify rename-to file name
           SITE       non-standard commands (see next section)
           SIZE       return size of file
           STAT       return status of server
           STOR       store a file
           STOU       store a file with a unique name
           STRU       specify data transfer <u>structure</u>
           SYST       show operating system type of server system
           TYPE       specify data transfer <u>type</u>
           USER       specify user name
           XCUP       change to parent of current working directory (deprecated)
           XCWD       change working directory (deprecated)
           XMKD       make a directory (deprecated)
           XPWD       print the current working directory (deprecated)
           XRMD       remove a directory (deprecated)

     The following non-standard or UNIX specific commands are supported by the SITE request.

           <b>Request</b>    <b>Description</b>
           CHMOD      change mode of a file, e.g. ``SITE CHMOD 755 filename''
           HELP       give help information.
           IDLE       set idle-timer, e.g. ``SITE IDLE 60''
           RATEGET    set maximum get rate throttle in bytes/second, e.g. ``SITE RATEGET 5k''
           RATEPUT    set maximum put rate throttle in bytes/second, e.g. ``SITE RATEPUT 5k''
           UMASK      change umask, e.g. ``SITE UMASK 002''

     The following FTP requests (as specified in <b>RFC</b> <b>959</b>) are recognized, but are not implemented: <b>ACCT</b>,
     <b>SMNT</b>, and <b>REIN</b>.  <b>MDTM</b> and <b>SIZE</b> are not specified in <b>RFC</b> <b>959</b>, but will appear in the next updated FTP
     RFC.

     The <b>tnftpd</b> server will abort an active file transfer only when the <b>ABOR</b> command is preceded by a Telnet
     "Interrupt Process" (IP) signal and a Telnet "Synch" signal in the command Telnet stream, as described
     in Internet <b>RFC</b> <b>959</b>.  If a <b>STAT</b> command is received during a data transfer, preceded by a Telnet IP and
     Synch, transfer status will be returned.

     <b>tnftpd</b> interprets file names according to the ``globbing'' conventions used by <a href="../man1/csh.1.html#//apple_ref/doc/man/1/csh">csh(1)</a>.  This allows
     users to use the metacharacters ``*?[]{}~''.

   <b>User</b> <b>authentication</b>
     <b>tnftpd</b> authenticates users according to five rules.

           1.   The login name must be in the system password data base and not have a null password.  In
                this case a password must be provided by the client before any file operations may be per-<font color="#ffffff" class="whiteout">formed.&nbsp;performed.</font>
                formed.  If the user has an S/Key key, the response from a successful <b>USER</b> command will
                include an S/Key challenge.  The client may choose to respond with a <b>PASS</b> command giving
                either a standard password or an S/Key one-time password.  The server will automatically
                determine which type of password it has been given and attempt to authenticate accordingly.
                See <!-- a -->skey(1)<!-- /a --> for more information on S/Key authentication.  S/Key is a Trademark of Bellcore.

           2.   The login name must be allowed based on the information in <a href="../man5/ftpusers.5.html#//apple_ref/doc/man/5/ftpusers">ftpusers(5)</a>.

           3.   The user must have a standard shell returned by <a href="../man3/getusershell.3.html#//apple_ref/doc/man/3/getusershell">getusershell(3)</a>.  If the user's shell field
                in the password database is empty, the shell is assumed to be <u>/bin/sh</u>.  As per <a href="../man5/shells.5.html#//apple_ref/doc/man/5/shells">shells(5)</a>,
                the user's shell must be listed with full path in <u>/etc/shells</u>.

           4.   If directed by the file <a href="../man5/ftpchroot.5.html#//apple_ref/doc/man/5/ftpchroot">ftpchroot(5)</a> the session's root directory will be changed by
                <a href="../man2/chroot.2.html#//apple_ref/doc/man/2/chroot">chroot(2)</a> to the directory specified in the <a href="../man5/ftpd.conf.5.html#//apple_ref/doc/man/5/ftpd.conf">ftpd.conf(5)</a> <b>chroot</b> directive (if set), or to
                the home directory of the user.  However, the user must still supply a password.  This fea-<font color="#ffffff" class="whiteout">ture&nbsp;feature</font>
                ture is intended as a compromise between a fully anonymous account and a fully privileged
                account.  The account should also be set up as for an anonymous account.

           5.   If the user name is ``anonymous'' or ``ftp'', an anonymous FTP account must be present in
                the password file (user ``ftp'').  In this case the user is allowed to log in by specifying
                any password (by convention an email address for the user should be used as the password).

                The server performs a <a href="../man2/chroot.2.html#//apple_ref/doc/man/2/chroot">chroot(2)</a> to the directory specified in the <a href="../man5/ftpd.conf.5.html#//apple_ref/doc/man/5/ftpd.conf">ftpd.conf(5)</a> <b>chroot</b> direc-<font color="#ffffff" class="whiteout">tive&nbsp;directive</font>
                tive (if set), the <b>-a</b> <u>anondir</u> directory (if set), or to the home directory of the ``ftp''
                user.

                The server then performs a <a href="../man2/chdir.2.html#//apple_ref/doc/man/2/chdir">chdir(2)</a> to the directory specified in the <a href="../man5/ftpd.conf.5.html#//apple_ref/doc/man/5/ftpd.conf">ftpd.conf(5)</a> <b>homedir</b>
                directive (if set), otherwise to <u>/</u>.

                If other restrictions are required (such as disabling of certain commands and the setting of
                a specific umask), then appropriate entries in <a href="../man5/ftpd.conf.5.html#//apple_ref/doc/man/5/ftpd.conf">ftpd.conf(5)</a> are required.

                If the first character of the password supplied by an anonymous user is ``-'', then the ver-<font color="#ffffff" class="whiteout">bose&nbsp;verbose</font>
                bose messages displayed at login and upon a <b>CWD</b> command are suppressed.

   <b>Display</b> <b>file</b> <b>escape</b> <b>sequences</b>
     When <b>tnftpd</b> displays various files back to the client (such as <u>/etc/ftpwelcome</u> and <u>/etc/motd</u>), various
     escape strings are replaced with information pertinent to the current connection.

     The supported escape strings are:
           <b>Escape</b>  <b>Description</b>
           %c      Class name.
           %C      Current working directory.
           %E      Email address given with <b>-e</b>.
           %L      Local hostname.
           %M      Maximum number of users for this class.  Displays ``unlimited'' if there's no limit.
           %N      Current number of users for this class.
           %R      Remote hostname.
           %s      If the result of the most recent ``%M'' or ``%N'' was not ``1'', print an ``s''.
           %S      If the result of the most recent ``%M'' or ``%N'' was not ``1'', print an ``S''.
           %T      Current time.
           %U      User name.
           %%      A ``%'' character.

   <b>Setting</b> <b>up</b> <b>a</b> <b>restricted</b> <b>ftp</b> <b>subtree</b>
     In order that system security is not breached, it is recommended that the subtrees for the ``ftp'' and
     ``chroot'' accounts be constructed with care, following these rules (replace ``ftp'' in the following
     directory names with the appropriate account name for `chroot' users):

           <u>~ftp</u>           Make the home directory owned by ``root'' and unwritable by anyone.

           <u>~ftp/bin</u>       Make this directory owned by ``root'' and unwritable by anyone (mode 555).  Gener-<font color="#ffffff" class="whiteout">ally&nbsp;Generally</font>
                          ally any conversion commands should be installed here (mode 111).

           <u>~ftp/etc</u>       Make this directory owned by ``root'' and unwritable by anyone (mode 555).  The
                          files <u>pwd.db</u> (see <a href="../man5/passwd.5.html#//apple_ref/doc/man/5/passwd">passwd(5)</a>) and <u>group</u> (see <a href="../man5/group.5.html#//apple_ref/doc/man/5/group">group(5)</a>) must be present for the <b>LIST</b>
                          command to be able to display owner and group names instead of numbers.  The pass-<font color="#ffffff" class="whiteout">word&nbsp;password</font>
                          word field in <a href="../man5/passwd.5.html#//apple_ref/doc/man/5/passwd">passwd(5)</a> is not used, and should not contain real passwords.  The
                          file <u>motd</u>, if present, will be printed after a successful login.  These files
                          should be mode 444.

           <u>~ftp/pub</u>       This directory and the subdirectories beneath it should be owned by the users and
                          groups responsible for placing files in them, and be writable only by them (mode
                          755 or 775).  They should <u>not</u> be owned or writable by ftp or its group.

           <u>~ftp/incoming</u>  This directory is where anonymous users place files they upload.  The owners
                          should be the user ``ftp'' and an appropriate group.  Members of this group will
                          be the only users with access to these files after they have been uploaded; these
                          should be people who know how to deal with them appropriately.  If you wish anony-<font color="#ffffff" class="whiteout">mous&nbsp;anonymous</font>
                          mous FTP users to be able to see the names of the files in this directory the per-<font color="#ffffff" class="whiteout">missions&nbsp;permissions</font>
                          missions should be 770, otherwise they should be 370.

                          The following <a href="../man5/ftpd.conf.5.html#//apple_ref/doc/man/5/ftpd.conf">ftpd.conf(5)</a> directives should be used:
                                modify guest off
                                umask  guest 0707
                                upload guest on

                          This will result in anonymous users being able to upload files to this directory,
                          but they will not be able to download them, delete them, or overwrite them, due to
                          the umask and disabling of the commands mentioned above.

           <u>~ftp/tmp</u>       This directory is used to create temporary files which contain the error messages
                          generated by a conversion or <b>LIST</b> command.  The owner should be the user ``ftp''.
                          The permissions should be 300.

                          If you don't enable conversion commands, or don't want anonymous users uploading
                          files here (see <u>~ftp/incoming</u> above), then don't create this directory.  However,
                          error messages from conversion or <b>LIST</b> commands won't be returned to the user.
                          (This is the traditional behaviour.)  Note that the <a href="../man5/ftpd.conf.5.html#//apple_ref/doc/man/5/ftpd.conf">ftpd.conf(5)</a> directive <b>upload</b>
                          can be used to prevent users uploading here.

     To set up "ftp-only" accounts that provide only FTP, but no valid shell login, you can copy/link
     <u>/sbin/nologin</u> to <u>/sbin/ftplogin</u>, and enter <u>/sbin/ftplogin</u> to <u>/etc/shells</u> to allow logging-in via FTP
     into the accounts, which must have <u>/sbin/ftplogin</u> as login shell.

<b>FILES</b>
     /etc/ftpchroot   List of normal users whose root directory should be changed via <a href="../man2/chroot.2.html#//apple_ref/doc/man/2/chroot">chroot(2)</a>.
     /etc/ftpd.conf   Configure file conversions and other settings.
     /etc/ftpusers    List of unwelcome/restricted users.
     /etc/ftpwelcome  Welcome notice before login.
     /etc/motd        Welcome notice after login.
     /etc/nologin     If it exists, displayed and access is refused.
     /var/run/ftpd.pids-CLASS
                      State file of logged-in processes for the <b>tnftpd</b> class `CLASS'.
     /var/run/utmp    List of logged-in users on the system.
     /var/log/wtmp    Login history database.

<b>SEE</b> <b>ALSO</b>
     <a href="../man1/ftp.1.html#//apple_ref/doc/man/1/ftp">ftp(1)</a>, <!-- a -->skey(1)<!-- /a -->, <a href="../man1/who.1.html#//apple_ref/doc/man/1/who">who(1)</a>, <a href="../man3/getusershell.3.html#//apple_ref/doc/man/3/getusershell">getusershell(3)</a>, <a href="../man5/ftpchroot.5.html#//apple_ref/doc/man/5/ftpchroot">ftpchroot(5)</a>, <a href="../man5/ftpd.conf.5.html#//apple_ref/doc/man/5/ftpd.conf">ftpd.conf(5)</a>, <a href="../man5/ftpusers.5.html#//apple_ref/doc/man/5/ftpusers">ftpusers(5)</a>, <a href="syslogd.8.html#//apple_ref/doc/man/8/syslogd">syslogd(8)</a>

<b>STANDARDS</b>
     <b>tnftpd</b> recognizes all commands in <b>RFC</b> <b>959</b>, follows the guidelines in <b>RFC</b> <b>1123</b>, recognizes all commands
     in <b>RFC</b> <b>2228</b> (although they are not supported yet), and supports the extensions from <b>RFC</b> <b>2389</b>, <b>RFC</b> <b>2428</b>
     and <b>draft-ietf-ftpext-mlst-11</b>.

<b>HISTORY</b>
     The <b>tnftpd</b> command appeared in 4.2BSD.

     Various features such as the <a href="../man5/ftpd.conf.5.html#//apple_ref/doc/man/5/ftpd.conf">ftpd.conf(5)</a> functionality, <b>RFC</b> <b>2389</b>, and <b>draft-ietf-ftpext-mlst-11</b> sup-<font color="#ffffff" class="whiteout">port&nbsp;support</font>
     port was implemented in NetBSD 1.3 and later releases by Luke Mewburn.

<b>BUGS</b>
     The server must run as the super-user to create sockets with privileged port numbers (i.e, those less
     than IPPORT_RESERVED, which is 1024).  If <b>tnftpd</b> is listening on a privileged port it maintains an
     effective user id of the logged in user, reverting to the super-user only when binding addresses to
     privileged sockets.  The <b>-r</b> option can be used to override this behaviour and force privileges to be
     permanently revoked; see <u>SECURITY</u> <u>CONSIDERATIONS</u> below for more details.

     <b>tnftpd</b> may have trouble handling connections from scoped IPv6 addresses, or IPv4 mapped addresses (IPv4
     connection on AF_INET6 socket).  For the latter case, running two daemons, one for IPv4 and one for
     IPv6, will avoid the problem.

<b>SECURITY</b> <b>CONSIDERATIONS</b>
     <b>RFC</b> <b>959</b> provides no restrictions on the <b>PORT</b> command, and this can lead to security problems, as <b>tnftpd</b>
     can be fooled into connecting to any service on any host.  With the ``checkportcmd'' feature of the
     <a href="../man5/ftpd.conf.5.html#//apple_ref/doc/man/5/ftpd.conf">ftpd.conf(5)</a>, <b>PORT</b> commands with different host addresses, or TCP ports lower than IPPORT_RESERVED will
     be rejected.  This also prevents `third-party proxy ftp' from working.  Use of this option is <u>strongly</u>
     recommended, and enabled by default.

     By default <b>tnftpd</b> uses a port that is one less than the port it is listening on to communicate back to
     the client for the <b>EPRT</b>, <b>LPRT</b>, and <b>PORT</b> commands, unless overridden with <b>-P</b> <u>dataport</u>.  As the default
     port for <b>tnftpd</b> (21) is a privileged port below IPPORT_RESERVED, <b>tnftpd</b> retains the ability to switch
     back to root privileges to bind these ports.  In order to increase security by reducing the potential
     for a bug in <b>tnftpd</b> providing a remote root compromise, <b>tnftpd</b> will permanently drop root privileges if
     one of the following is true:

           1.   <b>tnftpd</b> is running on a port greater than IPPORT_RESERVED and the user has logged in as a
                `guest' or `chroot' user.

           2.   <b>tnftpd</b> was invoked with <b>-r</b>.

     Don't create <u>~ftp/tmp</u> if you don't want anonymous users to upload files there.  That directory is only
     necessary if you want to display the error messages of conversion commands to the user.  Note that if
     uploads are disabled with the <a href="../man5/ftpd.conf.5.html#//apple_ref/doc/man/5/ftpd.conf">ftpd.conf(5)</a> directive <b>upload</b>, then this directory cannot be abused by
     the user in this way, so it should be safe to create.

BSD                             August 4, 2005                             BSD
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man8/tnftpd.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man8/tnftpd.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man8/tnftpd.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
