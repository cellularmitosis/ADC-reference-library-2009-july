<html><head><title>Mac OS X
 Manual Page For setpwfile(3)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/3/setpwfile" title="Mac OS X
 Manual Page for setpwfile(3)"><!-- headerDoc=man; indexgroup=Section 3; uid="//apple_ref/doc/man/3/setpwfile"; name=setpwfile(3) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
GETPWENT(3)              BSD Library Functions Manual              <!-- a -->GETPWENT(3)<!-- /a -->

<b>NAME</b>
     <b>endpwent</b>, <b>getpwent</b>, <b>getpwnam</b>, <b>getpwnam_r</b>, <b>getpwuid</b>, <b>getpwuid_r</b>, <b>setpassent</b>, <b>setpwent</b> -- password data-<font color="#ffffff" class="whiteout">base&nbsp;database</font>
     base operations

<b>LIBRARY</b>
     Standard C Library (libc, -lc)

<b>SYNOPSIS</b>
     <b>#include</b> <b>&lt;pwd.h&gt;</b>

     <u>void</u>
     <b>endpwent</b>(<u>void</u>);

     <u>struct</u> <u>passwd</u> <u>*</u>
     <b>getpwent</b>(<u>void</u>);

     <u>struct</u> <u>passwd</u> <u>*</u>
     <b>getpwnam</b>(<u>const</u> <u>char</u> <u>*login</u>);

     <u>int</u>
     <b>getpwnam_r</b>(<u>const</u> <u>char</u> <u>*login</u>, <u>struct</u> <u>passwd</u> <u>*pwd</u>, <u>char</u> <u>*buffer</u>, <u>size</u><b>_</b><u>t</u> <u>bufsize</u>,
         <u>struct</u> <u>passwd</u> <u>**result</u>);

     <u>struct</u> <u>passwd</u> <u>*</u>
     <b>getpwuid</b>(<u>uid</u><b>_</b><u>t</u> <u>uid</u>);

     <u>int</u>
     <b>getuid_r</b>(<u>uid</u><b>_</b><u>t</u> <u>uid</u>, <u>struct</u> <u>passwd</u> <u>*pwd</u>, <u>char</u> <u>*buffer</u>, <u>size</u><b>_</b><u>t</u> <u>bufsize</u>, <u>struct</u> <u>passwd</u> <u>**result</u>);

     <u>int</u>
     <b>setpassent</b>(<u>int</u> <u>stayopen</u>);

     <u>void</u>
     <b>setpwent</b>(<u>void</u>);

<b>DESCRIPTION</b>
     These functions operate on the password database file, which is described in <a href="../man5/passwd.5.html#//apple_ref/doc/man/5/passwd">passwd(5)</a>.  Each entry in
     the database is defined by the structure <u>passwd</u>, found in the include file &lt;<u>pwd.h&gt;</u>:

           struct passwd {
                   char    *pw_name;       /* user name */
                   char    *pw_passwd;     /* encrypted password */
                   uid_t   pw_uid;         /* user uid */
                   gid_t   pw_gid;         /* user gid */
                   time_t  pw_change;      /* password change time */
                   char    *pw_class;      /* user access class */
                   char    *pw_gecos;      /* Honeywell login info */
                   char    *pw_dir;        /* home directory */
                   char    *pw_shell;      /* default shell */
                   time_t  pw_expire;      /* account expiration */
                   int     pw_fields;      /* internal: fields filled in */
           };

     The functions <b>getpwnam</b>() and <b>getpwuid</b>() search the password database for the given login name or user
     uid, respectively, always returning the first one encountered.

     All of these routines are thread-safe.  The <b>getpwent</b>(), <b>getpwnam</b>(), and <b>getpwuid</b>() routines return a
     pointer to a result managed by the system library in a thread-specific data structure.  Every thread
     has space for a pointer to a struct passwd and allocates its own storage for the result.  Neither pre-<font color="#ffffff" class="whiteout">viously&nbsp;previously</font>
     viously returned values in memory nor a previously returned pointer value should be used by a thread
     after calling any one of these three routines.  Memory allocated by a thread is automatically released
     on subsequent calls by the same thread to any of these three routines, and when the thread exits.

     The functions <b>getpwnam_r</b>() and <b>getpwuid_r</b>() take additional arguments which supply storage space for
     the returned result.  The <u>pwd</u> parameter is a pointer to a struct passwd, which must be allocated by the
     caller.  The <u>buffer</u> parameter is a pointer to a block of memory with a size specified by <u>bufsize</u>.  This
     buffer is used to hold the values which are pointed to by values filled in the <u>pwd</u> structure.  Zero is
     returned on success.  If insufficient memory is supplied, these routines return ERANGE.

     The <b>getpwent</b>() function sequentially reads the password database and is intended for programs that wish
     to process the complete list of users.

     The <b>setpassent</b>() function accomplishes two purposes.  First, it causes <b>getpwent</b>() to ``rewind'' to the
     beginning of the database.  Additionally, if <u>stayopen</u> is non-zero, file descriptors are left open, sig-<font color="#ffffff" class="whiteout">nificantly&nbsp;significantly</font>
     nificantly speeding up subsequent accesses for all of the routines.  (This latter functionality is
     unnecessary for <b>getpwent</b>(), as it doesn't close its file descriptors by default.)

     It is dangerous for long-running programs to keep the file descriptors open, as the database will
     become out of date if it is updated while the program is running.

     The <b>setpwent</b>() function is identical to <b>setpassent</b>() with an argument of zero, save that it does not
     return a status value.

     The <b>endpwent</b>() function closes any open files.

     As of Mac OS X 10.3, there are now different per-user behaviours of this function, based on the Authen-<font color="#ffffff" class="whiteout">ticationAuthority&nbsp;AuthenticationAuthority</font>
     ticationAuthority value stored for the queried user in DirectoryServices.

     If the queried user is still a legacy crypt password user or now has an AuthenticationAuthority value
     containing ``;basic;'', these routines will behave in their standard BSD fashion.  These functions will
     ``shadow'' the password file, e.g. allow only certain programs to have access to the encrypted pass-<font color="#ffffff" class="whiteout">word.&nbsp;password.</font>
     word.  If the process which calls them has an effective uid of 0, the encrypted password will be
     returned, otherwise, the password field of the returned structure will point to the string `*'.

     By default in Mac OS X 10.3 and later all users will have an AuthenticationAuthority with the value
     ``;ShadowHash;''.  These users will have a visible password value of ``********''.  These functions
     will have no access to the encrypted password whatsoever.  Setting or changing an user password must be
     done entirely through the DirectoryService APIs for this default user.

     There also exists an ``Apple Password Server'' user whose password value is also ``********'' and with
     an AuthenticationAuthority that contains the value ";ApplePasswordServer;" among other data.  There is
     no getpwnam access to the password for this user either and again set/change password can be done
     through the DirectoryService API.

     Finally in support of local user caching there is a local cached user whose password is also
     ``********'' and has an AuthenticationAuthority value containing ``;LocalCachedUser;'' among other
     data.  These functions also provide no access to the password for this user and set/change password
     functionality is through the DirectoryService API.

<b>RETURN</b> <b>VALUES</b>
     The functions <b>getpwent</b>(), <b>getpwnam</b>(), and <b>getpwuid</b>() return a valid pointer to a passwd structure on
     success and a null pointer if end-of-file is reached or an error occurs.  The <b>setpassent</b>() function
     returns 0 on failure and 1 on success.  The <b>endpwent</b>() and <b>setpwent</b>() functions have no return value.

<b>FILES</b>
     /etc/pwd.db         The insecure password database file
     /etc/spwd.db        The secure password database file
     /etc/master.passwd  The current password file
     /etc/passwd         A Version 7 format password file

<b>LEGACY</b> <b>SYNOPSIS</b>
     <b>#include</b> <b>&lt;sys/types.h&gt;</b>
     <b>#include</b> <b>&lt;pwd.h&gt;</b>

     The include file &lt;<u>sys/types.h&gt;</u> is necessary for the <u>getpwent</u>, <u>getpwnam</u>, and <u>getpwuid</u> functions.

     <u>int</u>
     <b>setpwent</b>(<u>void</u>);

     The <b>setpwent</b>() function returns 0 on failure and 1 on success.

<b>SEE</b> <b>ALSO</b>
     <a href="../man2/getlogin.2.html#//apple_ref/doc/man/2/getlogin">getlogin(2)</a>, <a href="getgrent.3.html#//apple_ref/doc/man/3/getgrent">getgrent(3)</a>, <a href="../man8/yp.8.html#//apple_ref/doc/man/8/yp">yp(8)</a>, <a href="../man5/passwd.5.html#//apple_ref/doc/man/5/passwd">passwd(5)</a>, <a href="../man8/pwd_mkdb.8.html#//apple_ref/doc/man/8/pwd_mkdb">pwd_mkdb(8)</a>, <a href="../man8/vipw.8.html#//apple_ref/doc/man/8/vipw">vipw(8)</a>

<b>HISTORY</b>
     The <b>getpwent</b>(), <b>getpwnam</b>(), <b>getpwuid</b>(), <b>setpwent</b>(), and <b>endpwent</b>() functions appeared in Version 7 AT&amp;T
     UNIX.  The <b>setpassent</b>() function appeared in 4.3BSD-Reno.

<b>COMPATIBILITY</b>
     The historic function setpwfile(3), which allowed the specification of alternate password databases,
     has been deprecated and is no longer available.

<b>BUGS</b>
     The functions <b>getpwent</b>(), <b>getpwnam</b>(), and <b>getpwuid</b>() leave their results in internal thread-specific
     memory and return a pointer to that object.  Subsequent calls to any of these three routines by the
     same thread will release the object and return a new pointer value.

BSD                           September 20, 1994                           BSD
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man3/setpwfile.3.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man3/setpwfile.3.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man3/setpwfile.3.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
