<HTML>		<HEAD>		<meta http-equiv="content-type" content="text/html;charset=iso-8859-1">		<meta name="Copyright" content="Copyright 2001 Apple Computer, Inc. All Rights Reserved.">        <title>SystemSoftware</title>		</HEAD><!-- start of header --><!--#include virtual="/includes/framesetheader"--><!-- end of header --><!-- start of path --><TABLE border="0" cellpadding="0" cellspacing="2" width="432">          <TR>        <TD><FONT face="Geneva,Helvetica,Arial" size="1">        <B>PATH<IMG src="../Images/space.gif" width="6" height="12"></B><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Documentation</a> &gt; <!-- a href="" target="_top" -->Hardware<!-- /a -->         <b>&gt;</b> Power Mac G4 Developer Note                </FONT></TD>        </TR></TABLE><!-- end of path --><a href="Features_of_the_Enclosure.html" target="_right"><img src="../Images/previous.gif" border="0"></a><a href="../2Architecture/index.html" target="_top"><img src="../Images/next.gif" border="0"></a>&nbsp;<br><!-- apple_doc: pageHeadingStart --><a name = "TPXREF105"></a><h2><font face="Lucida Grande,Helvetica,Arial">SystemSoftware</font></h2><!-- apple_doc: pageHeadingEnd --><p><font face="Geneva,Helvetica,Arial" size="2">The Power Mac G4 computer comes with Mac OS X and Mac OS 9.2installed. Mac OS 9.2 is the default operating system. </font></p><p><font face="Geneva,Helvetica,Arial" size="2">Here are a few items of interest about the system softwareon the Power Mac G4 computer. </font></p><br><a name = "TPXREF107"></a><h3><font face="Lucida Grande,Helvetica,Arial">OpenFirmware</font></h3><p><font face="Geneva,Helvetica,Arial" size="2">Since the introduction of the first iMac model, the Macintoshsystem software has used a design based on Open Firmware. With thisapproach, a small ROM contains the code needed to initialize thehardware and load an operating system. The rest of the system codethat formerly resided in the Mac OS ROM is loaded into RAM fromdisk or from the network. For more information, see the referenceslisted in  <a sector="mod" href="../aReferences/iROM_in_RAM_Architecture.html" target="_top">"ROM-in-RAM Architecture"</a> and  <a sector="mod" href="../aReferences/iOpen_Firmware.html" target="_top">"Open Firmware"</a>. </font></p><br><a name = "TPXREF108"></a><h3><font face="Lucida Grande,Helvetica,Arial">ComputerIdentification</font></h3><p><font face="Geneva,Helvetica,Arial" size="2">Rather than reading the box flag or the model string and thenmaking assumptions about the computer's features, applicationsthat need to find out the features of the machine should use theName Registry and Gestalt calls to test for the features they require. </font></p><p><font face="Geneva,Helvetica,Arial" size="2">Asset management software that reports the kind of machineit is run on can obtain the value of the property at <code>Devices:device-tree:compatible</code> inthe name registry. The model string is the first program-usablestring in the array of C strings in the <code>compatible</code> field.For the Power Mac G4, the value of the model property is <code>PowerMac3,5</code>. </font></p><p><font face="Geneva,Helvetica,Arial" size="2">The string obtained from the <code>compatible</code> propertycannot be displayed to the computer user. A better method, if itis available, is to use the result from calling <code>Gestalt('mnam', &result)</code> where <code>result</code> isa string pointer. This call returns a Pascal-style string that canbe displayed to the user. </font></p><br><a name = "TPXREF109"></a><h3><font face="Lucida Grande,Helvetica,Arial">DualProcessors and Mac OS 9</font></h3><p><font face="Geneva,Helvetica,Arial" size="2">To gain a performance advantage on dual-processor configurations,applications that run in Mac OS 9 must be modified to use MultiprocessingServices, an API that allows applications to create tasks that runindependently on one or more processors.</font></p><br><table border = "0" BGCOLOR="#E6E6E6"><tr><td scope="row"><b>Note: </b> InMac OS X, all applications are able to take advantage of multipleprocessors. </td></tr></table><br><p><font face="Geneva,Helvetica,Arial" size="2">Multiprocessing Services allows you to create preemptive taskswithin an application. The application still operates in a cooperativemultitasking environment with respect to other applications. </font></p><p><font face="Geneva,Helvetica,Arial" size="2">Multiple processor support is transparent in MultiprocessingServices. If multiple processors are available, MultiprocessingServices divides the tasks among the available processors. If onlyone processor is available, Multiprocessing Services schedules allthe tasks with that processor. </font></p><p><font face="Geneva,Helvetica,Arial" size="2">Multiprocessing Services allows you to determine the numberof processors available before creating any tasks. </font></p><p><font face="Geneva,Helvetica,Arial" size="2">To obtain more information, including interfaces and libraries,documentation, demonstration applications, and sample code, referto the references in  <a sector="mod" href="../aReferences/iMultiprocessing_Services.html" target="_top">"Multiprocessing Services"</a>. </font></p><br><a name = "TPXREF110"></a><h3><font face="Lucida Grande,Helvetica,Arial">PowerSaving Modes</font></h3><p><font face="Geneva,Helvetica,Arial" size="2">The Power Manager is designed to implement a common powermanagement strategy across all Macintosh models. </font></p><br><a name = "TPXREF111"></a><h4><font face="Lucida Grande,Helvetica,Arial">ProcessorStates</font></h4><p><font face="Geneva,Helvetica,Arial" size="2">The following processor states are defined:</font></p><ul><li><font face="Geneva,Helvetica,Arial" size="2">Run Multiple:The system is running at maximum processing capacity. In a single processorsystem the processor is running at full speed. In a multi-processorsystem all processors are running at full speed. </font></li><li><font face="Geneva,Helvetica,Arial" size="2">Run Single: One processor is running at maximum processingcapacity. In a single processor system, this is the same as RunMultiple. In a multi-processor system, only one processor is runningat full speed; all other processors are in sleep mode with their cachesflushed and their states saved.</font></li><li><font face="Geneva,Helvetica,Arial" size="2">Idle One: The system is idling. All clocks are running andthe system can return to running code within a few nanoseconds.In a single processor system, the main processor is stopped in Dozemode. Cache coherency is maintained in this level of idle. In amulti-processor system, all other processors will be sleeping asdescribed in Run Single. </font></li><li><font face="Geneva,Helvetica,Arial" size="2">Idle Two: The system is in power saving mode. This mode isentered only when a system has been in Idle One state for a substantialperiod of time (a half second or so) with no activity. In a singleprocessor system, the main processor cache is flushed, and the processoris put into sleep mode&#151;the external processor bus clock is stopped.The delay in coming out of this state is on the order of a millisecond.Cache coherency is maintained by the flush on entry. In a multi-processorsystem, the other processors will be sleeping as described in RunSingle. </font></li></ul><br><a name = "TPXREF112"></a><h4><font face="Lucida Grande,Helvetica,Arial">SystemModes</font></h4><p><font face="Geneva,Helvetica,Arial" size="2">The Macintosh system has two power saving modes.</font></p><ul><li><font face="Geneva,Helvetica,Arial" size="2">Doze: Thepower to the disk drive motors and the display is turned off, butthe power supply and fan are still on. The computer can still respondto network activity. </font></li><li><font face="Geneva,Helvetica,Arial" size="2">Sleep: The main power supply is shut down. A trickle supplyprovides auxiliary power to the PCI slots and keeps the DRAM statepreserved for a quick recovery. All processors are powered off withtheir state preserved in DRAM. All clocks in the system are suspendedexcept for the 32.768Khz timebase crystal on the PMU99 IC. This modeallows the computer to meet the 5W sleep requirement while providingthe ability to start up without rebooting. </font></li></ul><br><a name = "TPXREF113"></a><h3><font face="Lucida Grande,Helvetica,Arial">VelocityEngine Acceleration</font></h3><p><font face="Geneva,Helvetica,Arial" size="2">The Velocity Engine (also known as AltiVec) is the vectorprocessing unit in the G4 microprocessor. Some system software hasbeen modified to take advantage of the accelerated processing thatthe Velocity Engine makes possible. System software has also beenmodified to support low-level operations using the Velocity Engine. </font></p><p><font face="Geneva,Helvetica,Arial" size="2">The software areas that have been modified to take advantageof Velocity Engine acceleration are </font></p><ul><li><font face="Geneva,Helvetica,Arial" size="2">QuickTime:key codecs, including DV and photo JPEG</font></li></ul><p><font face="Geneva,Helvetica,Arial" size="2">The software areas that have been added or modified for low-levelVelocity Engine support are </font></p><ul><li><font face="Geneva,Helvetica,Arial" size="2">Nanokernel:the floating-point vector denormal handler</font></li><li><font face="Geneva,Helvetica,Arial" size="2">Process Manager: context switching</font></li><li><font face="Geneva,Helvetica,Arial" size="2">Block Move routines</font></li></ul><p><font face="Geneva,Helvetica,Arial" size="2">The following vector libraries are included: vBasicOps, vectorOps,vBigNum, and vMathLib. </font></p><p><font face="Geneva,Helvetica,Arial" size="2"></font></p><br><a href="Features_of_the_Enclosure.html" target="_right"><img src="../Images/previous.gif" border="0"></a><a href="../2Architecture/index.html" target="_top"><img src="../Images/next.gif" border="0"></a>&nbsp;<HR>Copyright &#169; 2001 Apple Computer, Inc.  (Last Updated July 18, 2001)<P><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY></HTML>