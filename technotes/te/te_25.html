<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note TE25: How to Construct Word-Break Tables</title>                                       <meta name="categories" content="Text"><meta name="week-posted" content="Oct 26, 1987 - Nov 6, 1987"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002833" title="How to Construct Word-Break Tables"></a><a name="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxTextFonts-date.html">Text & Fonts</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/TextFonts/index.html" target="_blank">Reference Library > Text & Fonts</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TE25</div>
<div id="pageheadsub">How to Construct Word-Break Tables</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext"><A HREF="#Section1">Constructing break tables</A><BR><BR><A HREF="#Section2">Extensions</A><BR><BR><A HREF="#References">References</A><BR><BR><A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">This technical note describes how to construct auxiliary break tables for usewith the <code>FindWord</code> routine in the Script Manager.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Nov 01 1987]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><a name=Section1></A><h2>Constructing break tables</h2><p>The <code>FindWord</code> algorithm finds word boundaries by determining wherewords should not be broken. For example, "re-do" is one word: it should not bebroken at the hyphen. In other words, a sequence of the form: (letter, hyphen,letter) should not be broken between the first and second or second and thirdcharacter. This is called a continuation sequence. The algorithm used by the<code>FindWord</code> routine allows for continuation sequences of lengths one, twoand three. Examples of a sequence of length two include (letter, letter), or(number, number). For a length of one, there is only one sequence, consistingof the characters of type <code>nonBreaking</code>: these characters are neverseparated from preceding or following characters.</p><p>For most scripts, this information about continuation sequences is packed intoa table for use by the <code>FindWord</code> algorithm. (For complex scripts likeJapanese, a different algorithm is used for portions of the script.) Thedefault break tables for a given script can be overridden by a user-specified<code>breakTable</code> parameter, but should only be used for known scripts. Thatis, before overriding the <code>breakTable</code> parameter, the programmer shouldfirst check the script of the current font.</p><p>A break table consists of two sections, a 256 byte character type tablefollowed by a character triple table.</p><p align="center"><img src="images/te_25_001.gif" alt="Character Type Table" width=320 height=186></p><p align="center"><img src="images/te_25_002.gif" alt="Character Triple Table" width=320 height=182></p><P>The character type table is indexed by the character's ASCII code and containsone type value for each character. The character types in the table are limitedto values between 1 and 31. There are two distinguishing values: the type<code>nonBreaking</code> (= 1) indicates that the character is non-breaking; italways continues a word. The type <code>wild</code> (=0) indicates that thecharacter may or may not break, depending on information in the charactertriple table, as described below.  Otherwise, the choice of numbers torepresent character types is completely arbitrary.</p><p>For example, the following in MPW Assembler defines character types for use ina word-selection break table, then sets up a character type table using anassembly macro (<code>setByte</code>) to store character type values in an array.(Note that the character types could  have been defined with equate definitions(<code>EQU</code>), rather than using the record structure.)   Writing the setBytemacro is left as an exercise to the reader. Note that the break value is thedefault. This value is not distinguished, but should have no continuationsequences.</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>;============================================================charWordRec        record        0wild            ds.b        1    ; constant! not in char table.nonbreak        ds.b        1    ; constant! non-breaking space.letter            ds.b        1    ; letters.number            ds.b        1    ; digits.break            ds.b        1    ; always breaks.midLetter        ds.b        1    ; a'a.midLetNum        ds.b        1    ; a'a 1'1.preNum            ds.b        1    ; $, etc.postNum        ds.b        1    ; %, etc.midNum            ds.b        1    ; 1,1.preMidNum        ds.b        1    ; .1234.blank            ds.b        1    ; spaces and tabs.cr            ds.b        1    ; add carriage return            endr;============================================================    with        charWordRecwordTable    dcb.b        256,break    setByte    wordTable,nonBreak,$ca    setByte    wordTable,letter,('A','Z'),('a','z')('&Auml;','&Uuml;')    setByte    wordTable,letter,'&AElig;','&Oslash;','&AElig;','&Oslash;',('&Agrave;','oe'),'&#159;'    setByte    wordTable,midLetter,'-'    setByte    wordTable,midLetNum,$27,'''    setByte    wordTable,number,('0','9')    setByte    wordTable,preNum,'$','cents','[[sterling]]','[[yen]]'    setByte    wordTable,postNum,'%'    setByte    wordTable,midNum,','    setByte    wordTable,preMidNum,'.'    setByte    wordTable,blank,$00,' ',$09    setByte    wordTable,cr,$0d    endWith</pre>	</TD></TR></TABLE></CENTER><p>The character triple table is a coded representation of a list of continuationsequences. It consists of a list of packed one word triples, preceded by alength word. This length word contains the number of triples minus one. Eachtriple contains three character types, either as derived from the<code>charType</code> table or the special type <code>wild</code> (= zero). The threetypes in a triple are packed into fields five bits apiece, with the mostsignificant bit in the word cleared.  The first type in the triple is theleftmost.</p><p>A continuation sequence of length three (xyz) is represented by entering threetriples into the triple list: xyz, *xy, and yz* (where '*' stands for the typewild, which is always zero).</p><p align="center"><img src="images/te_25_003.gif" alt="original and permutations with wild card" width=416 height=60></p><p>A continuation sequence of length two (xy) is represented by entering twotriples into this list: *xy, and xy*. A continuation sequence of length one hasno entry in the triple list: the character type is simply<code>nonBreaking</code>.</p><p align="center"><img src="images/te_25_004.gif" alt="original and wild card permutations" width=384 height=42></p><p>Note that the type <code>wild</code> cannot appear as the middle element of atriple. The words in the triple table must be sorted in ascending numericalorder for future compatibility.</p><p>The following is an example of how a character triple table could be coded. The<code>defSeq</code> macro takes a continuation sequence as a parameter, and entersa set of triples into an internal array. The <code>dumpSeq</code> macro sorts thetriples, and stores them in the proper order with <code>dc.w</code> commands.  Onceagain, writing the macros <code>defSeq</code> and <code>dumpSeq</code> is left as anexercise for the reader.</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>;============================================================    with        charWordRec    defSeq        letter,letter    defSeq        letter,preMidNum,letter    defSeq        letter,midLetter,letter    defSeq        letter,midLetNum,letter    defSeq        number,number    defSeq        number,letter    defSeq        number,midNum,number    defSeq        number,midLetNum,number    defSeq        number,preMidNum,number    defSeq        number,postNum    defSeq        preNum,number    defSeq        preMidNum,number    defSeq        blank,blank    defSeq        blank,cr    endWith;============================================================    dc.w    ((wordEnd-wordBegin)/2)-1    ; length word.wordBegin    dumpSeqwordEnd</pre>	</TD></TR></TABLE></CENTER><p>A series of blanks should generally select as a single word. Make certain,however, that a carriage return does not continue a word to the right (note howit has a separate character type from blank for this reason), otherwise wordselection and wrapping do not work properly across paragraphs.</p><P><A HREF="#top">Back to top</A></p><a name="Section2"></a><h2>Extensions</h2><p>The values 16-31 in the character type table entry for null ($00) (the firstbyte in the character type table) are reserved by Apple for future expansion.The use of one of these values indicates the presence of a supplementary tableafter the triple table.</p><P><A HREF="#top">Back to top</A></p><a name = "References"></a><h2>References</h2><P>The Script Manager </p>         <a name="Downloads"></a>       <P><A HREF="#top">Back to top</A></p><h2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (160K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/te_25.pdf">Download</A></P>               </TD>            </TR>                    </TABLE>         <BR></TD></TR></table></center><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/te/te_25.html%3Fid%3DDTS10002833-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/te/te_25.html%3Fid%3DDTS10002833-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/te/te_25.html%3Fid%3DDTS10002833-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>