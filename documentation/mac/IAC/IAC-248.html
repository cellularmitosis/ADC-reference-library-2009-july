<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Writing an Object-Counting Function(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING248></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-247.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-249.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-231.html"><B>Chapter 6 - Resolving and Creating Object Specifier Records</B></A> / <A HREF="IAC-247.html"><B>Writing Object Callback Functions</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING248-0></A>
<H2><A NAME=MARKER-9-208></A>Writing an Object-Counting Function</H2>
 <A NAME=MARKER-2-209></A>To handle object specifier records that specify tests, your application should provide an object-counting function (unless it specifies <CODE>kAEIDoWhose</CODE> as just described). Your object-counting function should be able to count the number of elements of a given object class in a given container. For example, if your application supports Apple event objects that belong to the object class <CODE>cText</CODE> in the Text suite, your application should provide an object-counting function that can count Apple event objects of each element class listed in the definition of <CODE>cText</CODE> in the <I>Apple Event Registry: Standard Suites.</I> In this case, your application should provide an object-counting function that can count the number of words, items, or characters in a text object.<P>
 You specify your object-counting function with the <CODE>AESetObjectCallbacks</CODE> function. Whenever it is resolving an object specifier record and it requires a count of the number of elements in a given container, the Apple Event Manager calls your object-counting function.<P>
 Here's the declaration for a sample object-counting function:<P>
<PRE>
FUNCTION MyCountObjects (desiredClass: DescType; 
                         containerClass: DescType;
                         containerToken: AEDesc; 
                         VAR result: LongInt): OSErr;
</PRE>
 The Apple Event Manager passes the following information to your object-counting function: the object class ID of the Apple event objects to count, the object class of their container, and a token identifying their container. (The container class can be useful if you want to use one token type for several object classes.) Your object-counting function uses this information to count the number of Apple event objects of the specified object class in the specified container. After counting the Apple event objects, your application should return the <CODE>noErr</CODE> result code and, in the <CODE>result</CODE> parameter, the number of Apple event objects counted. <P>
 <A HREF=#MARKER-9-210>Listing 6-10</A> shows an application-defined function, <CODE>MyCountObjects</CODE>, that counts the number of objects for any object class supported by the application. <P>
<B>Listing 6-10  <A NAME=MARKER-9-210></A>An object-counting function<A NAME=MARKER-9-213></A></B><P>
<PRE>
FUNCTION MyCountObjects (desiredClass: DescType; containerClass: DescType; 
                         containerToken: AEDesc; VAR result: LongInt): OSErr;
VAR
   window: WindowPtr;
BEGIN
   result := 0;
   IF desiredClass = cWindow THEN
   BEGIN
      IF containerClass = typeNull THEN
      BEGIN
         {count the number of windows}
         window := FrontWindow;
         WHILE window &lt;&gt; NIL DO 
            BEGIN
               result := result + 1;
               window := WindowPtr(WindowPeek(window)^.nextWindow);
            END; {of while}
      END; 
      MyCountObjects := noErr;
   END {of cWindow}
   ELSE
      IF desiredClass = cWord THEN
         {count the number of words in the container}
         MyCountObjects := MyCountWords(containerClass, containerToken, 
                                          result)
   ELSE
      IF desiredClass = cParagraph THEN
         {count the number of paragraphs in the container}
         MyCountObjects := MyCountParas(containerClass, containerToken, 
                                          result)
   ELSE
      {this app does not support any other object classes}
      MyCountObjects := kObjectClassNotFound;
END;  
</PRE>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-247.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-249.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
