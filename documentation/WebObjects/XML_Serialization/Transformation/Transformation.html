<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>WebObjects XML Serialization Guide: XML Transformation</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="XML Transformation"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30000181" title="XML Transformation"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../InternetWeb/index.html#//apple_ref/doc/uid/TP30000440-TP30000469" target="_top">Internet &amp; Web</a> &gt; <a href="../../../InternetWeb/WebObjects-date.html#//apple_ref/doc/uid/TP30000440-TP30000469-TP30000592" target="_top">WebObjects</a> &gt; <a href="../AboutThisBook/AboutThisBook.html#//apple_ref/doc/uid/TP30000177-DontLinkElementID_4">WebObjects XML Serialization Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../Serializing/Serializing.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../Transforming/Transforming.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP30000181-SW8" title="XML Transformation"></a><h1>XML Transformation</h1><p><a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_183"></a>Serializing objects and data into XML documents is a great way of sharing information between applications within an organization. However, communicating that data between companies can be difficult. For example, you can serialize an NSArray containing InventoryItem objects into an XML document and send that document to your business partners over the Internet. But, unless your business partners are also running WebObjects (in fact, they would have to be running the same version of WebObjects that you are running), they will find it difficult to make use of the document. Of course, they can create an XSLT stylesheet that transforms your XML document into a format that they can use, but you can make their job easier by doing the transformation yourself.</p><p>Because your application generates XML documents, you're in an excellent position for converting serialized-data documents into a standard format that the recipients of your documents can use. If you're comfortable with XSL Transformations (XSLT), you can create an XSLT file that WebObjects can use to transform the output of XML serialization into other formats.</p><p>While this document does not teach XSLT, this chapter gives you an overview of the transformation process. It contains the following sections:</p><ul class="ul"><li class="li"><p><span class="content_text"><a href="Transformation.html#//apple_ref/doc/uid/TP30000181-SW1">“Structure of Serialized Data in WebObjects”</a></span> shows you the structure of the XML documents generated by NSXMLOutputStream.</p></li><li class="li"><p><span class="content_text"><a href="Transformation.html#//apple_ref/doc/uid/TP30000181-SW4">“XSL Transformations”</a></span> gives an overview of the transformation process.</p></li><li class="li"><p><span class="content_text"><a href="Transformation.html#//apple_ref/doc/uid/TP30000181-SW6">“XML Parsers and XSLT Processors”</a></span> explains how WebObjects uses the Java API for XML Processing (JAXP) to communicate with XML parsers and transformers, which allows you to install and use your preferred implementations.</p></li><li class="li"><p><span class="content_text"><a href="Transformation.html#//apple_ref/doc/uid/TP30000181-SW7">“Serialization and Transformation Performance”</a></span> touches on performance issues with XML serialization and transformation.</p></li></ul><a name="//apple_ref/doc/uid/TP30000181-SW1" title="Structure of Serialized Data in WebObjects"></a><h2>Structure of Serialized Data in WebObjects</h2><p><a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_184"></a><a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_185"></a><a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_186"></a>The structure of the XML documents created by the WebObjects XML serialization process is described by the <code>woxml.xsd</code> and <code>woxml.dtd</code> files, which are listed in <span class="content_text"><!--a  -->“The woxml.dtd file.”<!--/a--></span> <span class="content_text">Figure 4-1</span> illustrates the structure that the files define, while <span class="content_text">Listing 4-1</span> shows an example of a target document.<a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_187"></a><a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_188"></a><a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_189"></a></p><br/><div><a name="//apple_ref/doc/uid/TP30000181-SW2" title="Figure 4-1Diagram of the schema for WebObjects XML serialization"></a><p><strong>Figure 4-1&nbsp;&nbsp;</strong>Diagram of the schema for WebObjects XML serialization</p><img src = "../art/schema_diagram.gif" alt = "Diagram of the schema for WebObjects XML serialization" width="454" height="321"></div><br/><a name="//apple_ref/doc/uid/TP30000181-SW3" title="Listing 4-1Example of a target document"></a><p class="codesample"><strong>Listing 4-1&nbsp;&nbsp;</strong>Example of a target document</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;?xml version="1.0" encoding="UTF-8"?><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;content xmlns="http://www.apple.com/webobjects/XMLSerialization" xmlns:xsi="http://www.w3.org/2001/<span></span></pre></td></tr><tr><td scope="row"><pre>XMLSchema-instance" xsi:schemaLocation="http://www.apple.com/webobjects/XMLSerialization<span></span></pre></td></tr><tr><td scope="row"><pre>http://www.apple.com/webobjects/5.2/schemas/woxml.xsd"><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;int>5&lt;/int><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;boolean>true&lt;/boolean><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;ch>u&lt;/ch><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;double>3.14&lt;/double><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/content><span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP30000181-SW4" title="XSL Transformations"></a><h2>XSL Transformations</h2><p><a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_190"></a><a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_191"></a>This document does not teach you XSL Transformations (XSLT). There are several books available on the subject that explain the specification and different implementations of it in detail. However, this section explains some segments of the <code>SimpleTransformation.xsl</code> script<a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_192"></a> used in this document's transformation-example project. You can find the entire listing of the transformation script in <span class="content_text"><a href="../Listings/Listings.html#//apple_ref/doc/uid/TP30000184-SW6">Listing B-3</a></span>.</p><p>XSLT is a declarative language. This means that the transformation of an XML document is expressed as a set of rules or templates that are applied to elements of the source document to create elements of the target document. For example, you can specify a rule that changes every <code>date</code> element in a document to an <code>invoice_date</code> element.</p><p><span class="content_text">Listing 4-2</span> shows the segment of <code>SimpleTransformation.xsl</code> that processes <code>woxml:object</code> elements.</p><a name="//apple_ref/doc/uid/TP30000181-SW5" title="Listing 4-2Section of SimpleTransformation.xsl that processes woxml:object elements"></a><p class="codesample"><strong>Listing 4-2&nbsp;&nbsp;</strong>Section of <code>SimpleTransformation.xsl</code> that processes <code>woxml:object</code> elements</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;!-- Processes woxml:object elements. --><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;xsl:template name="process_object" match="woxml:object"><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;!-- extract class name --><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;xsl:variable name="className"><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;xsl:value-of select="woxml:class/@name" /><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/xsl:variable><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;!-- get base class name --><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;xsl:variable name="class"><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;xsl:call-template name="basename"><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;xsl:with-param name="path" select="$className"/><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;/xsl:call-template><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/xsl:variable><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;!-- determine the element name --><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;xsl:variable name="tag"><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;xsl:choose><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;xsl:when test="$class='NSDictionary' or<span></span></pre></td></tr><tr><td scope="row"><pre>                     $class='NSMutableDictionary'"><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;xsl:value-of select="'dictionary'" /><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;/xsl:when><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;xsl:when test="$class='NSArray' or $class='NSMutableArray'"><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;xsl:value-of select="'array'" /><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;/xsl:when><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;xsl:otherwise><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;xsl:value-of select="$class" /><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;/xsl:otherwise><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;/xsl:choose><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/xsl:variable><span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;!-- create the element --><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;xsl:element name="{$tag}"><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;xsl:choose><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;xsl:when test="$class='NSDictionary' or<span></span></pre></td></tr><tr><td scope="row"><pre>                     $class='NSMutableDictionary'"><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;xsl:call-template name="process_dictionary" /><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;/xsl:when><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;xsl:otherwise><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;xsl:call-template name="process_object_content" /><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;/xsl:otherwise><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;/xsl:choose><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/xsl:element><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/xsl:template><span></span></pre></td></tr></table></div><p>Here's an explanation of the numbered lines:</p><ol class="ol"><li class="li"><p>Gets the class name that the object represents and stores it in a variable called <code>className</code>. The rule gets the class name from the <code>name</code> attribute of the <code>woxml:class</code> element of <code>woxml:object</code>.</p></li><li class="li"><p>Calls a utility template that extracts the base class name from the fully qualified class name. This base class name is stored in the <code>class</code> variable.</p></li><li class="li"><p>Determines the name of the element in the target document that corresponds to the <code>woxml:object</code> element of the source document. The element name is <code>dictionary</code> (when <code>class</code> is <code>'NSDictionary'</code> or <code>'NSMutableDictionary'</code>), <code>array</code> (when <code>class</code> is <code>'NSArray'</code> or <code>'NSMutableArray'</code>), or the name of the base class that the <code>woxml:object</code> element contains.</p></li><li class="li"><p>Creates the element and its contents by invoking one of two templates: <code>process_dictionary</code> or <code>process_object_content</code>. The <code>process_dictionary</code> template creates a <code>dictionary</code> element in the target document using either two arrays (one for the keys and another for the values) or a set of <code>item</code> elements, each containing a <code>key</code> and a <code>value</code> element.</p></li></ol><p>For more details on transforming XML documents using <code>SimpleTransformation.xsl</code>, see <span class="content_text"><a href="../Transforming/Transforming.html#//apple_ref/doc/uid/TP30000182-SW13">“Transforming XML Documents.”</a></span> To learn XSLT, check out <em>XSLT</em> (published by O'Reilly) or <em>XSLT Programmer's Reference</em> (published by Wrox Press).<a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_193"></a><a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_194"></a></p><a name="//apple_ref/doc/uid/TP30000181-SW6" title="XML Parsers and XSLT Processors"></a><h2>XML Parsers and XSLT Processors</h2><p>An XML parser is software that allows you to read and write XML documents. An XSLT processor (also known as transformer) converts an XML document into another document, whose format can be XML, HTML, PDF, or any other format supported by the transformer. There are some parsers that can also convert XML documents, such as Microsoft's MSXML3 parser.</p><p>One of a parser's duties is to validate<a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_195"></a><a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_196"></a> the input document, to make sure that it's well formed and that its contents conform to the document's XML Schema file or DTD file. The WebObjects XML Schema files are listed in <span class="content_text"><!--a  -->“The woxml.dtd file.”<!--/a--></span> In WebObjects the source document is not validated by default; however, you can turn validation on to debug an application.</p><p>WebObjects uses the Java API for XML Processing (JAXP<a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_197"></a>), implemented in the <code>javax.xml.parsers</code> and <code>javax.xml.tranform</code> packages (including <code>javax.xml.transform.sax</code>, <code>javax.xml.transform.dom</code>, and <code>javax.xml.transform.stream</code>) to instantiate and communicate with the XML parser and XSLT transformer. This allows you to install your preferred parser and transformer for use by your applications. See the API documentation of those packages for additional details. You can also consult Sun's JAXP tutorial, located at <span class="content_text"><a href="https://jaxp.dev.java.net/" target="_blank">https://jaxp.dev.java.net/</a></span>.</p><p>A standard WebObjects installation includes the Xerces<a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_198"></a><a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_199"></a> XML parser and the Xalan<a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_200"></a><a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_201"></a> XSLT processor. However, thanks to JAXP, you can use other parsers and processors if you wish. Just install the pertinent JAR files on your computer, make sure that they are in the Java classpath, and point <code>javax.xml.parsers.SAXParserFactory</code> to the class that implements the factory class. For example, if the JAR file for the Crimson parser is in the classpath, you would add the following line to the <code>Properties</code> file of the application project (which you can find under the Resources group) or to the command line to set the property's value:</p><div class="codesample"><table><tr><td scope="row"><pre>-D"javax.xml.parsers.SAXParserFactory=<span></span></pre></td></tr><tr><td scope="row"><pre>org.apache.crimson.jaxp.SAXParserFactoryImpl"<span></span></pre></td></tr></table></div><p>Keep in mind that if you have two parser-factory classes in your classpath, the parser that your application actually uses may not be the one you want. The parser that is loaded last is the one that the application uses. The same applies to the system properties <code>javax.xml.transform.TransformerFactory</code> and <code>javax.xml.parsers.DocumentBuilderFactory</code>: The application that is loaded last determines the system-wide values of these properties.</p><a name="//apple_ref/doc/uid/TP30000181-SW7" title="Serialization and Transformation Performance"></a><h2>Serialization and Transformation Performance</h2><p><a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_202"></a><a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_203"></a><a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_204"></a><a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_205"></a>XML serialization is slower than binary serialization because data is converted to XML code while objects are serialized. XML deserialization is slower than binary deserialization because XML documents need to be parsed before their contents can be deserialized. However, the actual speed at which data is serialized and deserialized is highly dependent on disk and network throughput.</p><p>To maximize the performance of XML serialization and deserialization in WebObjects, make sure that XML validation is not turned on (it's turned off by default). You turn XML validation on or off by setting the <code>NSXMLValidation</code> property<a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_206"></a><a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_207"></a> in the command line or the <code>Properties</code> file:</p><div class="codesample"><table><tr><td scope="row"><pre>-DNSXMLValidation=&lt;true|false><span></span></pre></td></tr></table></div><p>XML-parsing technology should improve over time. In addition, as mentioned in <span class="content_text"><a href="Transformation.html#//apple_ref/doc/uid/TP30000181-SW6">“XML Parsers and XSLT Processors,”</a></span> WebObjects uses JAXP<a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_208"></a> to ensure that a standard API is used to communicate with the parser. This allows you to install and use parsers as they become available.<a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_209"></a><a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_210"></a><a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_211"></a><a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_212"></a><a name="//apple_ref/doc/uid/TP30000181-DontLinkElementID_213"></a></p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../Serializing/Serializing.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../Transforming/Transforming.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2002, 2005 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2005-08-11<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/WebObjects/XML_Serialization/Transformation/Transformation.html%3Fid%3DTP40000976-2.2&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/WebObjects/XML_Serialization/Transformation/Transformation.html%3Fid%3DTP40000976-2.2&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/WebObjects/XML_Serialization/Transformation/Transformation.html%3Fid%3DTP40000976-2.2&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>