<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>WebObjects for Windows Developers (Legacy): Enhancing Your Application</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Enhancing Your Application"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../Resources" />
	<meta name="ROBOTS" content="NOINDEX"/>
	<link rel="stylesheet" type="text/css" href="../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30001016-CH204" title="Enhancing Your Application"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../LegacyTechnologies/index.html#//apple_ref/doc/uid/TP30000440-TP30000470" target="_top">Legacy Documents</a> &gt; <a href="../../../LegacyTechnologies/InternetWeb-date.html#//apple_ref/doc/uid/TP30000440-TP30000470-TP30000526" target="_top">Internet &amp; Web</a> &gt; <a href="../Preface/Preface.html#//apple_ref/doc/uid/TP30001016-CH202-DontLinkElementID_77">WebObjects for Windows Developers (Legacy)</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../GuestBook/GuestBook.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../Movies/Movies.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        <script type="text/javascript" language="JavaScript">placeWatermark()</script>
<div id="legacyOuterWrapper"><div align="center" id="watermark">
<div class="legacybox">
<h1>Legacy Document<span class="closebutton"><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>
        <a name="//apple_ref/doc/uid/TP30001016-CH204-DontLinkElementID_70" title="Enhancing Your Application"></a><h1><a name="//apple_ref/doc/uid/TP30001016-CH204-BCIBIIHJ" title="Enhancing Your Application"></a>Enhancing Your Application</h1><p>In the previous tutorial, you learned how to create a web component that has input and output elements and how to bind these elements to variables and methods in your code.</p><p>Now you’ll add some additional features to your project that move it a bit more in the direction of being a real-world web application. The application will</p><ul class="ul"><li class="li"><p>Use a custom Java class to represent the data for a guest, rather than using three separate variables.</p></li><li class="li"><p>Maintain a guest list, that keeps track of all guest data (whether entered by you or multiple users of your application), rather than just the current guest.</p></li><li class="li"><p>Have a second component, so that the guest list is displayed in a new page rather than the same page.</p></li><li class="li"><p>Make use of additional interface elements (such as HTML tables).</p></li></ul>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="GuestBookPlus.html#//apple_ref/doc/uid/TP30001016-CH204-TPXREF101">Duplicating Your Project</a>
				
			<br/>
			
        
			
			
				<a href="GuestBookPlus.html#//apple_ref/doc/uid/TP30001016-CH204-TPXREF102">Creating a Custom Guest Class</a>
				
			<br/>
			
        
			
			
				<a href="GuestBookPlus.html#//apple_ref/doc/uid/TP30001016-CH204-TPXREF108">Keeping Track of Multiple Guests</a>
				
			<br/>
			
        
			
			
				<a href="GuestBookPlus.html#//apple_ref/doc/uid/TP30001016-CH204-TPXREF111">Adding a Second Component</a>
				
			<br/>
			
        
			
			
				<a href="GuestBookPlus.html#//apple_ref/doc/uid/TP30001016-CH204-TPXREF112">Using a Repetition</a>
				
			<br/>
			
        
			
			
				<a href="GuestBookPlus.html#//apple_ref/doc/uid/TP30001016-CH204-TPXREF113">Adding the Finishing Touches</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP30001016-CH204-TPXREF101" title="Duplicating Your Project"></a><h2>Duplicating Your Project</h2><p>Before proceeding, you’ll create a new project by copying the old one and renaming it. This way, you can make changes and still retain your previous version.</p><ol class="ol"><li class="li"><p>In WebObjects Builder, close the component window.</p><p>If there are any unsaved files, you are prompted to save them.</p></li><li class="li"><p>In Project Builder, close GuestBook’s project window.</p><p>If there are any unsaved files, you are prompted to save them.</p></li><li class="li"><p>In your computer’s file system, navigate to the directory where your project is located.</p></li><li class="li"><p>Duplicate the GuestBook folder.</p><p>On Windows, select the folder, choose Edit > Copy, then Edit > Paste.</p></li><li class="li"><p>Rename the new folder (Copy of GuestBook) to GuestBookPlus. </p></li><li class="li"><p>Open the newly renamed folder and double-click the project file <code>PB.project</code>.</p><p>Project Builder opens a new browser window for this project. (Alternatively, you could have opened the project from within Project Builder by choosing Project > Open, then navigating to the project folder and selecting <code>PB.project</code>.)</p><p></p></li><li class="li"><img src = "../art/buildbutton.gif" alt = "image: ../art/buildbutton.gif" width="40" height="40"><p>Click  in the toolbar to bring up the Project Build panel.</p></li><li class="li"><img src = "../art/broom.gif" alt = "image: ../art/broom.gif" width="40" height="40"><p>Click  in the Project Build panel.</p><p>This command deletes all the files that were generated when you built the project previously.</p></li><li class="li"><img src = "../art/inspector.gif" alt = "image: ../art/inspector.gif" width="23" height="23"><p>Click  to open the Project Inspector.</p></li><li class="li"><p>Choose Project Attributes from the pop-up list at the top of the window.</p></li><li class="li"><p>In the Name field, enter GuestBookPlus and press Enter. </p></li><li class="li"><p>Respond No to the prompt that asks if you want to rename the folder.</p><p>You now have a new project called GuestBookPlus.</p></li></ol><a name="//apple_ref/doc/uid/TP30001016-CH204-TPXREF102" title="Creating a Custom Guest Class"></a><h2>Creating a Custom Guest Class</h2><p>In <span class="content_text"><a href="../GuestBook/GuestBook.html#//apple_ref/doc/uid/TP30001016-CH203-BCICEAHH">“Creating a WebObjects Application Project,”</a></span> you created individual variables to store a guest’s name, e-mail address, and comments. When keeping track of multiple guests, it’s more useful to encapsulate all the data for a guest as a single entity. You’ll do this by creating a Java class that contains the data for a single guest.</p><ol class="ol"><li class="li"><p>In Project Builder’s browser, select Classes in the first column. </p></li><li class="li"><p>Choose File > New in Project.</p><div class="item_figure"><img src = "../art/pbnewclass.gif" alt = "image: ../art/pbnewclass.gif" width="265" height="137"></div></li><li class="li"><p>Type Guest.java as the name of the file. </p></li><li class="li"><p>Click OK. </p><p>The newly created file contains a skeleton for a class called Guest.</p></li><li class="li"><p>Modify the code so it looks like this:</p><div class="codesample"><table><tr><td scope="row"><pre>// Guest.java created by ...<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>import com.webobjects.foundation.*;import com.webobjects.eocontrol.*;<span></span></pre></td></tr><tr><td scope="row"><pre>import com.webobjects.eoaccess.*import com.webobjects.appserver.*;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>public class Guest extends Object {    protected String guestName;    protected String email;    protected String comments;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    Guest() {        guestName = "";        email = "";        comments = "";    }<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>A class stores information in its <em>instance variables</em> (also referred to as <em>data members</em>). Here you’re declaring three instance variables for Guest: <code>guestName</code>, <code>email</code>, and <code>comments</code>. Note that these declarations are the same as those that appeared in the code for <code>Main.java</code> when you added the three variables using WebObjects Builder. In WebObjects, a component is also a class, specifically a subclass of the class WOComponent.</p><p>Java classes require a <em>constructor</em> to initialize an instance (or <em>object</em>) of a particular class whenever one is created. A constructor has the same name as the class and returns no value.</p><p>Whenever your application creates a new Guest object, its instance variables are initialized with empty strings. (If you prefer, you can use different strings for these initial values.)</p></li><li class="li"><p>Save <code>Guest.java</code> by choosing Save from the File menu. </p><p>Saving the file lets WebObjects Builder know about your newly created Guest class.</p></li></ol><a name="//apple_ref/doc/uid/TP30001016-CH204-TPXREF103" title="Binding the Class&acirc;&#128;&#153;s Instance Variables  to the Form Elements"></a><h3>Binding the Class’s Instance Variables  to the Form Elements</h3><p>In <span class="content_text"><a href="../GuestBook/GuestBook.html#//apple_ref/doc/uid/TP30001016-CH203-BCICEAHH">“Creating a WebObjects Application Project,”</a></span> you bound the input elements to variables in Main’s code. Now you’ll modify the bindings to use the class you just created.</p><ol class="ol"><li class="li"><p>Select Web Components in the first column of the browser.</p></li><li class="li"><p>Double-click <code>Main.wo</code> in the second column of the browser to open the component in WebObjects Builder.</p></li><li class="li"><p>Using the Add Key panel, add a variable called <code>currentGuest</code> to your component and specify its type as Guest. (Note that you can now choose Guest from the Type combo box.) </p><p>An entry for <code>currentGuest</code> appears in the object browser. Notice the “>” symbol to the right of its name. This means that there is additional data to be displayed in the second column. </p></li><li class="li"><p>Select <code>currentGuest</code> in the object browser.</p><p>The second column displays the three fields of <code>currentGuest</code>, as determined by the definition of its class, Guest.</p></li><li class="li"><p>Make a connection from <code>guestName</code> in the second column of the object browser (next to <code>currentGuest</code>) to the Name text field (press the mouse button down on the variable, drag to the element, and release the mouse button), and click <code>value</code> in the pop-up menu.</p><p>This time, when the pop-up menu appears, there is a dot next to the <code>value</code> attribute because you bound it in the first tutorial. </p></li><li class="li"><p>Bind the other two input elements to <code>currentGuest.email</code> and <code>currentGuest.comments</code> in the same way.</p></li></ol><a name="//apple_ref/doc/uid/TP30001016-CH204-TPXREF104" title="Creating a Table to Display the Output"></a><h3>Creating a Table to Display the Output</h3><p>In the first chapter, you created three WOString elements to display the information the guest entered. In this tutorial, you’ll create a different type of element, an HTML table, to display the information. In later tasks, you’ll display data for multiple users in the table.</p><ol class="ol"><li class="li"><p>Delete the WOString elements below the horizontal line in the Main component, because you’ll be replacing them with a table. Select the WOString elements and choose Cut from the Edit menu to delete them.</p></li><li class="li"><img src = "../art/table.gif" alt = "image: ../art/table.gif" width="23" height="23"><p>Click the  button.</p><p>The New Table panel appears. On the right is the Preview pane, which displays what your table will look like. </p><div class="item_figure"><img src = "../art/tablepanel.gif" alt = "image: ../art/tablepanel.gif" width="451" height="350"></div></li><li class="li"><p>Click OK. The table appears in your page.</p></li><li class="li"><p>Select the upper-left cell of the table by clicking it.</p></li><li class="li"><p>Change the text in the cell to Name.</p></li><li class="li"><p>Open the Inspector if it is not already open.</p><p>The Inspector presents a number of modifiable settings that apply to the table cell you’ve selected. </p><div class="item_figure"><img src = "../art/tableinspector.gif" alt = "image: ../art/tableinspector.gif" width="366" height="140"></div></li><li class="li"><p>Select pixels from the Width pop-up list. Enter 150 in the Width field and press Tab.</p><p>The width of the column is set to 150 pixels.</p></li><li class="li"><p>Click in the component window, then press Tab.</p><p>Pressing Tab when editing a table causes the contents of the next cell to the right to be selected (or the first cell of the next row if in the rightmost column). Pressing Shift-Tab moves in the opposite direction through the table.</p></li><li class="li"><p>Repeat steps 5 through 8 for the second and third cells of the top row. Label the middle column E-mail and set its width to 150 pixels. Label the third column Comments and leave its width unset. (The comments field takes up the remainder of the width of the table.)</p><div class="notebox"><a name="//apple_ref/doc/uid/TP30001016-CH204-DontLinkElementID_71" title="Note"></a><p><strong>Note:</strong>&nbsp; It isn’t necessary to adjust the height of the columns—if left unset, they’ll expand at runtime to accommodate the size of the text being displayed. </p></div></li></ol><a name="//apple_ref/doc/uid/TP30001016-CH204-TPXREF105" title="Adding Dynamic Elements to Table Cells"></a><h3>Adding Dynamic Elements to Table Cells</h3><p>Tables and cells are static HTML elements, so you can’t bind them to variables or methods. To display dynamic information in cells, you add dynamic elements, such as WOStrings, to the cells. </p><ol class="ol"><li class="li"><p>Select the first cell on the second row of the table and clear its contents.</p></li><li class="li"><img src = "../art/wostring.gif" alt = "image: ../art/wostring.gif" width="23" height="23"><p>Click  to add a WOString to the cell.</p></li><li class="li"><p>Press the Tab key.</p><p>The contents of the next cell to the right are selected. </p></li><li class="li"><p>Repeat steps 2 and 3 for the other two cells in the second row. </p></li></ol><a name="//apple_ref/doc/uid/TP30001016-CH204-TPXREF106" title="Binding the Dynamic Elements in the Table"></a><h3>Binding the Dynamic Elements in the Table</h3><ol class="ol"><li class="li"><p>Make a connection from <code>currentGuest.guestName</code> in the object browser to the center of the WOString in the first column to bind its <code>value</code> attribute. </p></li><li class="li"><p>Similarly, bind <code>currentGuest.email</code> and <code>currentGuest.comments</code> to the WOStrings in the second and third columns.</p><p>The table should now look like this: </p><div class="item_figure"><img src = "../art/tablestrings.gif" alt = "image: ../art/tablestrings.gif" width="318" height="35"></div></li><li class="li"><p>Save the Main component.</p></li></ol><a name="//apple_ref/doc/uid/TP30001016-CH204-TPXREF107" title="Creating the Guest Object"></a><h3>Creating the Guest Object</h3><p>Earlier in this chapter, you created a Java class of type Guest and wrote a constructor for it. You also added a variable of that class, <code>currentGuest</code>, to the Main component. However, adding a variable to the component doesn’t actually create a new Guest object; you need to create one explicitly at some point in your code. </p><p>You’ll create the Guest object in the constructor method for your component. This method is called when the component is first created; that is, the first time the user accesses the component. </p><ol class="ol"><li class="li"><p>Choose View Source File from the pull-down list at the bottom of the window.</p><p>Project Builder becomes active and displays the code for <code>Main.java</code>. Notice the following declaration that was added to your code when you added the <code>currentGuest</code> variable:</p><div class="codesample"><table><tr><td scope="row"><pre>    public Guest currentGuest;<span></span></pre></td></tr></table></div></li><li class="li"><p>Delete the declarations of <code>guestName</code>, <code>email</code>, and <code>comments</code> since you aren’t using them anymore.</p></li><li class="li"><p>Add the constructor method inside the Main class definition: </p><div class="codesample"><table><tr><td scope="row"><pre>    public Main(WOContext context) {        super(context);        currentGuest = new Guest();    }<span></span></pre></td></tr></table></div><p>The first statement calls the constructor of Main’s superclass (which is <code>com.webobjects.appserver.WOComponent</code>). The second statement allocates a new empty Guest object and calls Guest’s constructor to initialize its instance variables. </p></li><li class="li"><p>Save <code>Main.java</code>.</p></li><li class="li"><p>Save <code>main.wo</code> in WebObjects Builder.</p></li><li class="li"><p>Build and run your application.</p><p>The application should work similarly to that in the first chapter, except that the guest’s data is displayed in a table at the bottom of the page instead of as plain text.</p><div class="item_figure"><img src = "../art/plustable.gif" alt = "image: ../art/plustable.gif" width="515" height="507"></div></li></ol><p>At this point, your application still handles information from a single guest only; in <span class="content_text"><a href="../GuestBook/GuestBook.html#//apple_ref/doc/uid/TP30001016-CH203-TPXREF108">“Keeping Track of Multiple Guests,”</a></span> you’ll modify the application so that it can keep track of multiple guests. </p><a name="//apple_ref/doc/uid/TP30001016-CH204-TPXREF108" title="Keeping Track of Multiple Guests"></a><h2>Keeping Track of Multiple Guests</h2><p>You’ve been using the variable <code>currentGuest</code> in the Main component to hold the information entered by the user. You’ll need another variable (an array) to store the list of all the guests who have registered. </p><p>Before doing this, it is important to understand the scope and life span of variables in WebObjects:</p><ul class="ul"><li class="li"><p><em>Component variables</em>, such as <code>currentGuest</code>, exist for the lifetime of the component. These variables are defined in the component (in this case, <code>Main.java</code>) and are accessible only by its methods. Each user that uses a component gets a separate instance of the variable.</p></li><li class="li"><p><em>Session variables</em> exist for the lifetime of one user’s session and are accessible by all code in the session. They are defined in <code>Session.java</code>. An instance of each session variable is created for each user. </p></li><li class="li"><p><em>Application variables</em> live as long as the application does and are accessible by all code in the application. They are defined in <code>Application.java</code>. A single instance of an application variable is shared by all users of the application.</p></li></ul><a name="//apple_ref/doc/uid/TP30001016-CH204-TPXREF109" title="Creating a Guest List"></a><h3>Creating a Guest List</h3><p>To store the information from all guests that have accessed the application, you’ll create an application variable called <code>allGuests</code>, which exists for the life of the application.</p><ol class="ol"><li class="li"><p>In Project Builder, select Classes in the first column of the browser. Then select <code>Application.java</code> from the second column.</p><p>The application’s code appears in the window. The following listing shows the code generated by the Wizard, along with code you will add.</p><div class="codesample"><table><tr><td scope="row"><pre>    // Generated by the WebObjects Wizard ...<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    import com.webobjects.foundation.*;    import com.webobjects.appserver.*;<span></span></pre></td></tr><tr><td scope="row"><pre>    import com.webobjects.eocontrol.*;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    public class Application extends WOApplication {<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        protected NSMutableArray allGuests;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        public static void main(String argv[]) {<span></span></pre></td></tr><tr><td scope="row"><pre>            WOApplication.main(argv, Application.class);<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        public Application() {<span></span></pre></td></tr><tr><td scope="row"><pre>            super();<span></span></pre></td></tr><tr><td scope="row"><pre>            allGuests = new NSMutableArray();<span></span></pre></td></tr><tr><td scope="row"><pre>            System.out.println("Welcome to " + this.name() + " !");            /* ** put your initialization code in here ** */<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        public void addGuest(Guest aGuest) {<span></span></pre></td></tr><tr><td scope="row"><pre>            allGuests.addObject(aGuest);<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        public void clearGuests() {<span></span></pre></td></tr><tr><td scope="row"><pre>            allGuests.removeAllObjects();<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr></table></div><p>Note that there is one method already defined: <code>Application</code>, which is the constructor for the Application object. The first line calls the constructor for Application’s superclass (which is the class WOApplication). The second line prints a message that you see in the Launch panel when you launch your application.</p></li><li class="li"><p>After the call to <code>super</code>, enter this code:</p><div class="codesample"><table><tr><td scope="row"><pre>    allGuests = new NSMutableArray();<span></span></pre></td></tr></table></div><p>This statement initializes <code>allGuests</code> to be a new object of class NSMutableArray. This class provides methods to add, change, and delete objects from an array.</p></li><li class="li"><p>At the top of the Application class definition, enter this declaration:</p><div class="codesample"><table><tr><td scope="row"><pre>    protected NSMutableArray allGuests;<span></span></pre></td></tr></table></div><p>This declares <code>allGuests</code> to be of type NSMutableArray. Declaring it protected means that it is accessible only from this class or one of its subclasses. It is standard object-oriented practice for a class to prevent other classes from directly manipulating its instance variables. Instead, you provide <em>accessor methods</em> that other objects use to read or modify the instance variables.</p></li><li class="li"><p>Add the accessor methods <code>addGuest</code> and <code>clearGuests</code>, as shown in the listing.</p><p>The <code>addGuest</code> method adds an object of class Guest to the end of the <code>allGuests</code> array, using the NSMutableArray method <code>addObject</code>.</p><p>The <code>clearGuests</code> method removes all the objects from the array using the NSMutableArray method <code>removeAllObjects</code>.</p></li><li class="li"><p>Save <code>Application.java</code>.</p></li></ol><a name="//apple_ref/doc/uid/TP30001016-CH204-TPXREF110" title="Adding Guests to the Guest List"></a><h3>Adding Guests to the Guest List</h3><p>Now, when the user submits the form, you’ll add the information to the <code>allGuests</code> array rather than displaying it directly.</p><ol class="ol"><li class="li"><p>Switch to the code for <code>Main.java</code>.</p></li><li class="li"><p>In the <code>submit</code> method, add the following code before the return statement:</p><div class="codesample"><table><tr><td scope="row"><pre>    ((Application)application()).addGuest(currentGuest);<span></span></pre></td></tr><tr><td scope="row"><pre>    currentGuest = new Guest();<span></span></pre></td></tr></table></div><p>This code calls the application’s <code>addGuest</code> method, which adds an object (in this case, <code>currentGuest</code>) to the end of the array. Then it creates a new Guest object to hold the next guest’s data.</p><p><code>Note:</code> The <code>addGuest</code> method is defined in the class Application, which is a subclass of WOApplication. The component’s <code>application</code> method (called in the above statement) returns an object of type WOApplication, so you must cast it to Application in order to access its <code>addGuest</code> method.</p></li></ol><p>Your next step is to create a new component to display the list of guests that <code>allGuests</code> stores.</p><a name="//apple_ref/doc/uid/TP30001016-CH204-TPXREF111" title="Adding a Second Component"></a><h2>Adding a Second Component</h2><p>In this section, you’ll create a new component. </p><ol class="ol"><li class="li"><p>In Project Builder’s browser, click Web Components in the first column.</p></li><li class="li"><p>Choose File > New in Project.</p><p>Note that the Web Components suitcase is selected.</p></li><li class="li"><p>Type GuestList as the name of the new component, then click OK.</p><p>The WebObjects Component Wizard appears. </p></li><li class="li"><p>Choose None for Available Assistance. </p></li><li class="li"><p>Click Finish.</p></li><li class="li"><p>In the second column of the browser, double-click <code>GuestList.wo</code> to bring up the component window in WebObjects Builder.</p></li><li class="li"><p>Create a heading for this page, as you did for the Main component. Call it “Guest List” (or something else of your choosing), then press Shift-Enter twice.</p></li><li class="li"><p>Add a WOString below the heading. After the WOString, type the text “ guests have signed this guestbook.” Press Shift-Enter twice.</p><p>You’re going to bind this WOString so that it reflects the number of guests who have submitted this form.</p></li><li class="li"><p>In the object browser, click <code>application</code>. </p><p>There is an entry in the second column for the <code>allGuests</code> application variable you created. This entry appears in the Main component as well, since application variables are accessible from anywhere in the code.</p><p>If you click <code>allGuests</code>, you’ll see in the third column an entry for <code>count</code>. This is a standard method that returns the number of objects in the array. </p></li><li class="li"><p>Make a connection from <code>count</code> to the center rectangle to bind it to the WOString’s <code>value</code> attribute.</p></li><li class="li"><p>Save the GuestList component.</p><p>You need to do one more thing so that the GuestList page now displays when the user submits the form.</p></li><li class="li"><p>Go back to Project Builder and view the source code for <code>Main.java</code>. Replace the return statement in the <code>submit</code> method with the following code:</p><div class="codesample"><table><tr><td scope="row"><pre>    return pageWithName("GuestList");<span></span></pre></td></tr></table></div><p><code>pageWithName</code> is a standard WebObjects method (defined in the WOApplication class) that allows you to specify a new page to display. </p><p>At this point, the code for <code>Main.java</code> looks like this:</p><div class="codesample"><table><tr><td scope="row"><pre>    // Generated by the WebObjects Wizard ...<span></span></pre></td></tr><tr><td scope="row"><pre>    import com.webobjects.foundation.*;<span></span></pre></td></tr><tr><td scope="row"><pre>    import com.webobjects.appserver.*;<span></span></pre></td></tr><tr><td scope="row"><pre>    import com.webobjects.eocontrol.*;<span></span></pre></td></tr><tr><td scope="row"><pre>    import com.webobjects.eoaccess.*;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    public class Main extends WOComponent {<span></span></pre></td></tr><tr><td scope="row"><pre>        protected Guest currentGuest;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        public Main(WOContext context) {<span></span></pre></td></tr><tr><td scope="row"><pre>            super(context);<span></span></pre></td></tr><tr><td scope="row"><pre>            currentGuest = new Guest();<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        public WOComponent submit() {<span></span></pre></td></tr><tr><td scope="row"><pre>            ((Application)application()).addGuest(currentGuest);<span></span></pre></td></tr><tr><td scope="row"><pre>            currentGuest = new Guest();<span></span></pre></td></tr><tr><td scope="row"><pre>            return pageWithName("GuestList");<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr></table></div></li><li class="li"><p>Save <code>Main.java</code>.</p></li><li class="li"><p>Build and run your application.</p><p>Each time you submit the form, the number of guests displayed in the WOString should increase.</p><p>To return to the Main page, you’ll have to use your browser’s Back button. Later in the tutorial, you’ll add a hyperlink to return to the Main page.</p></li></ol><a name="//apple_ref/doc/uid/TP30001016-CH204-TPXREF112" title="Using a Repetition"></a><h2>Using a Repetition</h2><p>Now you’ll create a table to display the entire list of guests in the GuestList component. To do so, you’ll use a dynamic element called a <em>repetition</em> (an instance of the WORepetition class). Repetitions are one of the most important elements in WebObjects, since it is quite common for applications to display repeated data (often from databases) when the amount of data to be displayed isn’t known until runtime. Typically, a repetition is used to generate items in a list or a browser, multiple rows in a table, or multiple tables. </p><p>A repetition can contain any other elements—either static HTML or dynamic WebObjects elements. In the GuestList component, you’ll create a repetition that contains a table row.</p><p>You’ll bind the <code>allGuests</code> array to the WORepetition’s <code>list </code>attribute. This tells WebObjects to generate the elements in the repetition once for each item in the array. Each time WebObjects iterates through the array, it sets the repetition’s <code>item</code> attribute to the current array object. You bind <code>item</code> to the variable <code>currentGuest</code> and use <code>currentGuest</code>’s fields to bind the elements inside the repetition (such as WOStrings). At runtime, the table will consist of one row (displaying name, e-mail address, and comments) for each guest.</p><ol class="ol"><li class="li"><p>In WebObjects Builder, make the Main component window active (double-click<code> Main.wo</code>).</p></li><li class="li"><p>Select the table at the bottom of the page by pressing outside it and dragging across it.</p></li><li class="li"><p>Choose Edit > Copy.</p></li><li class="li"><p>Make the GuestList component active.</p></li><li class="li"><p>Place the cursor at the bottom of the page and choose Edit > Paste.</p><p>You have just copied the table from Main into GuestList. It has all the same properties, including the bindings. The WOStrings in the table are still bound to instance variables of <code>currentGuest</code>. Since <code>currentGuest </code>is a component variable defined in Main, it isn’t accessible from GuestList. Therefore, you need to declare it here. </p></li><li class="li"><p>From the pull-down list at the bottom of the window, choose Add Key. Enter currentGuest as the name of the variable and Guest as its type, and click Add.</p></li><li class="li"><p>Click in one of the cells in the second row. Click &lt;TR> in the path view to select the entire row.</p><div class="item_figure"><img src = "../art/selecttr.gif" alt = "image: ../art/selecttr.gif" width="400" height="116"></div></li><li class="li"><img src = "../art/worepetition.gif" alt = "image: ../art/worepetition.gif" width="23" height="23"><p>Click  in the toolbar.</p><p>When you wrap a repetition around a table row in this way, the WORepetition symbol <img src = "../art/worepetition.gif" alt = "image: ../art/worepetition.gif" width="23" height="23"> doesn’t appear in the table. Instead, the row appears outlined in blue. For additional examples of using repetitions, see <span class="content_text"><a href="../Movies/Movies.html#//apple_ref/doc/uid/TP30001016-CH205-BCIBIDDC">“Creating a WebObjects Database Application.”</a></span></p></li><li class="li"><p>In the object browser, select <code>application</code> in the first column.</p></li><li class="li"><p>In the second column, make a connection from <code>allGuests</code> to the &lt;WORepetition> tag in the path view.</p></li><li class="li"><p>In the attribute menu that appears, click <code>list</code>. This binds <code>application.allGuests</code> to the WORepetition’s <code>list</code> attribute.</p></li><li class="li"><p>Bind <code>currentGuest</code> to the repetition’s <code>item</code> attribute in a similar manner.</p><p>By using the name <code>currentGuest </code>for the <code>item</code> attribute, you are taking advantage of the fact that the strings in your table are already bound to the fields of <code>currentGuest</code>.</p><p>You now have finished implementing the repetition. When the table is generated, it will have one row for each item in the <code>allGuests</code> array. </p></li><li class="li"><p>Save the GuestList component.</p></li><li class="li"><p>Delete the table from the Main component, since you no longer need it.</p></li><li class="li"><p>Test your application.</p><p>Be sure to rebuild the application since <code>GuestList.java</code> was modified when adding the <code>currentGuest</code> variable in WebObjects Builder. Building is required only when you have made changes to Java code. If you modify a component’s user interface only, the changes take effect even if the application is already running.</p></li><li class="li"><p>Try entering data for multiple guests and verifying that each guest appears in the table.</p></li></ol><a name="//apple_ref/doc/uid/TP30001016-CH204-TPXREF113" title="Adding the Finishing Touches"></a><h2>Adding the Finishing Touches</h2><p>There are a few additional things left to do to make your application a bit more user friendly:</p><ul class="ul"><li class="li"><p>Add a button that, when clicked, clears the guest list.</p></li><li class="li"><p>Add a hyperlink to the GuestList page that allows users to return to the Main page. </p></li></ul><a name="//apple_ref/doc/uid/TP30001016-CH204-TPXREF114" title="Clearing the Guest List"></a><h3>Clearing the Guest List</h3><p>While developing your application, you may find it useful to be able to remove all guests from the list. (Typically, you wouldn’t allow users to remove all guests from the list.)</p><ol class="ol"><li class="li"><p>In WebObjects Builder, make the GuestList component window active.</p></li><li class="li"><p>Choose Add Action from the pull-down list at the bottom of the window. In the panel, enter clearGuestList as the name of the action and set the page returned to <code>null</code>. Click Add.</p></li><li class="li"><p>Choose View Source File from the pull-down list.</p><p>You’ll notice that there is a skeleton of the <code>clearGuestList</code> action method as well as the declaration for <code>currentGuest</code> that you created previously.</p></li><li class="li"><p>Enter the following code before the return statement in <code>clearGuestList</code>:</p><div class="codesample"><table><tr><td scope="row"><pre>    ((Application)application()).clearGuests();<span></span></pre></td></tr></table></div><p>This code calls the application’s <code>clearGuests</code> method, removing all the Guest objects from the array.</p></li><li class="li"><p>Save <code>GuestList.java </code>by choosing Save from the File menu.</p></li><li class="li"><p>Go back to WebObjects Builder.</p></li><li class="li"><p>Place the cursor below the table and press Shift-Enter.</p></li><li class="li"><img src = "../art/woform.gif" alt = "image: ../art/woform.gif" width="23" height="23"><p>Click  to add a WOForm element to contain the button you’ll create in the next step.</p></li><li class="li"><img src = "../art/wosubmitbutton.gif" alt = "image: ../art/wosubmitbutton.gif" width="23" height="23"><p>Click .</p><p>This creates a submit button that the user will click to clear the guest list.</p></li><li class="li"><p>Using the Inspector, double-click in the binding column next to the <code>value</code> attribute and type “Clear Guest List”.</p><p>This changes the title of the button. Note that the quotes are necessary to indicate that you’re binding a string, not a variable.</p></li><li class="li"><p>Bind the <code>action</code> attribute to <code>clearGuestList</code>.</p><p>When the user clicks the button, the <code>clearGuestList</code> action method is called, that causes the guest list to be cleared and the page to be redrawn.</p></li></ol><a name="//apple_ref/doc/uid/TP30001016-CH204-TPXREF115" title="Adding a Dynamic Hyperlink"></a><h3>Adding a Dynamic Hyperlink</h3><p>Now you’ll create a hyperlink that returns the user to the Main page.</p><ol class="ol"><li class="li"><p>Place the cursor below the submit button (outside the rectangle of its containing form).</p></li><li class="li"><img src = "../art/wohyperlink.gif" alt = "image: ../art/wohyperlink.gif" width="23" height="23"><p>Click .</p></li><li class="li"><p>Type Return to Sign-in Page, replacing the selected text.</p></li><li class="li"><p>Inspect the hyperlink.</p></li><li class="li"><p>Select the <code>pageName</code> attribute, then double-click in the Binding column and type "Main" (including the quotes). </p><div class="notebox"><a name="//apple_ref/doc/uid/TP30001016-CH204-DontLinkElementID_72" title="Note"></a><p><strong>Note:</strong>&nbsp;You must specifically type the quotation marks in “Main”, because you are specifying a string representing the name of the page to be returned. If you left off the quotes, you would be specifying a variable or method called <code>Main</code>.</p></div></li><li class="li"><p>Save the GuestList component.</p></li><li class="li"><p>Build and test your application.</p><p>The GuestList page should now look like this:</p><div class="item_figure"><img src = "../art/finaltable.gif" alt = "image: ../art/finaltable.gif" width="396" height="411"></div></li></ol>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../GuestBook/GuestBook.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../Movies/Movies.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2004 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2004-02-01<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/WebObjects/WOGettingStarted/GuestBookPlus/GuestBookPlus.html%3Fid%3DTP30001016-2.1&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/WebObjects/WOGettingStarted/GuestBookPlus/GuestBookPlus.html%3Fid%3DTP30001016-2.1&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/WebObjects/WOGettingStarted/GuestBookPlus/GuestBookPlus.html%3Fid%3DTP30001016-2.1&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>