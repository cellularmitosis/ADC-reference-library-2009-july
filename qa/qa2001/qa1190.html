<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Q&amp;A QA1190: Filtering the Effects List returned by QTGetEffectsList</title><meta name="keywords" content="QTGetEffectsList,QTCreateStandardParameterDialog, QTGetEffectsListExtended"><meta name="Description" content="Technical Q&amp;A QA1190: This Q&amp;A shows how to edit the listof effects returned by the QTGetEffectsList function."><meta name="categories" content="QuickTime Movie Toolbox and QuickTime Components"><meta name="week-posted" content="Sep 2, 2002 - Sep 6, 2002"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10001719" title="Filtering the Effects List returned by QTGetEffectsList"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalqas/index.html">Technical Q&As</a> &gt; <a href="../../technicalqas/QuickTime/index.html">QuickTime</a> &gt; <a href="../../technicalqas/QuickTime/idxVideoEffectsTransitions-date.html">Video Effects & Transitions</a> &gt; </p><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Q&amp;A QA1190</div>
<div id="pageheadsub">Filtering the Effects List returned by QTGetEffectsList</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER>  <TABLE BORDER=0 CELLSPACING=1 WIDTH=600>    <TR>       <td height=1510 align=left>         <!-- begin_content -->        <hr width=500 align=center>        <P id=p2>Q:      I'm getting a list of QuickTime effects via the QTGetEffectsList      function. I will then pass this list to the QTCreateStandardParameterDialog      function to create a dialog so the user can choose an effect      from the list. However, I would  like to be able to edit      the list beforehand so it only shows the effects I want.      Is this possible?</p>                          <P id=p4>A: With QuickTime 6 you can use the nifty new function QTGetEffectsListExtended           to filter the effects which are placed into the effects list. Full documentation           for this function can be found in the &quot;<a href="%3Chttp://developer.apple.com/documentation/quicktime/qtdevdocs/PDF/whats_new_qt6.pdf%3E">What's           New in QuickTime 6</a>&quot; document. We strongly urge developers to           use this technique as it will guarantee compatability with future versions           of QuickTime.<BR>        </p>        <P id=p4> For example, here's how you would use this call to display only           multi-source transition effects:</p>        <table border=0 cellpadding=4 width=550>          <tr>             <td bgcolor="#E6E6E6" align=left scope="row"> <pre>QTAtomContainer effectsList;OSErr err;err = QTGetEffectsListExtended(    &amp;effectsList,    2,  /* minimum number of sources */    -1, /* no maximum number of sources */    0,  /* getOptions - optional */    kTransitionMajorClass, /* filter multi-source morph effects */    kTransitionMinorClass, /* filter transitions */    0,  /* optional filter procedure */    0); /* optional refcon for the filter procedure */</pre>            </td>          </tr>          <tr>             <td height=21 align=left scope="row">               <p><b>Listing 1</b>. Filtering the effects list using QTGetEffectsListExtended</p>            </td>          </tr>        </table>        <P id=p4> For QuickTime 5 and earlier, you'll need to manually walk the list of           effects returned by QTGetEffectsList and delete those effects from the           list you don't want shown. The list returned by QTGetEffectsList contains           two atoms for each effect component. The first atom, of type kEffectNameAtom           ('name'), contains the name of the effect. The second atom, of type           kEffectTypeAtom ('type'), contains the type of the effect, which is           the sub-type of the effect component. Simply walk this list and remove           both the kEffectNameAtom and kEffectTypeAtom atom for those effects           you don't want shown. Here's a code snippet showing how it's done:</p>        <table border=0 cellpadding=4 width=550>          <tr>            <td bgcolor="#E6E6E6" align=left scope="row"> <pre>void BuildAndEditEffectsList() {    short             childCount, index;    OSErr             err;    QTAtomContainer   effectsList, effectSample;    QTParameterDialog effectsDialog;        /* these are the only effects we'd like to            show up in the list */    const OSType supportedEffects[] = {        kBlurImageFilterType,        kBrightnessContrastImageFilterType    };        /* get the current list of effects */        /* min == max == -1, no min or max */    err = QTGetEffectsList( &amp;effectsList, -1, -1, 0 );    if (err != noErr) goto bailError;        /* get a count of the number of effects in the list */    childCount = QTCountChildrenOfType(        effectsList, kParentAtomIsContainer, kEffectNameAtom );        /* iterate over each effect in the list, removing those        which don't match the ones in our pre-chosen list        from above */    for( index = childCount; index &gt; 0 ; index -- )    {        QTAtom     effectTypeAtom;        QTAtomID   id;        long       effectCodeSize;        Ptr        effectCodePtr;        OSType     effectCode;        short      j;        Boolean    effectIsSupported;        effectTypeAtom = QTFindChildByIndex( effectsList,            kParentAtomIsContainer,            kEffectTypeAtom, index, &amp;id );        err = QTLockContainer( effectsList );        if (err != noErr) goto bailError;        err = QTGetAtomDataPtr( effectsList,            effectTypeAtom,            &amp;effectCodeSize,            &amp;effectCodePtr);        if (err != noErr) goto bailError;            /* grab the actual effect code */        effectCode = *(OSType *)effectCodePtr;        err = QTUnlockContainer( effectsList );            /* check to see if the current            effect is in our list */        for( j=0, effectIsSupported=false ;            j&lt;sizeof(supportedEffects)/sizeof(OSType) ; j++ )        {            if ( effectCode == supportedEffects[j] )            {                effectIsSupported = true;                break;            }        }            /* delete the effect from the list if we didn't find a match            in our custom list */        if ( !effectIsSupported )        {            QTAtom effectNameAtom;            effectNameAtom = QTFindChildByIndex( effectsList,                kParentAtomIsContainer, kEffectNameAtom, index, &amp;id );            err = QTRemoveAtom( effectsList, effectTypeAtom );            err = QTRemoveAtom( effectsList, effectNameAtom );        }    }        /* now use our newly built effects list to        create a dialog for later use... */    err = QTNewAtomContainer( &amp;effectSample );    err = QTCreateStandardParameterDialog( effectsList,            effectSample, 0, &amp;effectsDialog );bailError:    return;}</pre>            </td>          </tr>          <tr>             <td height=21 align=left scope="row">               <p><b>Listing 2</b>. Editing the list of effects returned by QTGetEffectsList</p>            </td>          </tr>        </table>        <hr width=500 align=center>         <!-- begin_date --><H4 ALIGN=center>[Sep 04 2002]</H4><!-- end_date --></TD> </TR> </TABLE></CENTER><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/qa/qa2001/qa1190.html%3Fid%3DDTS10001719-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/qa/qa2001/qa1190.html%3Fid%3DDTS10001719-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/qa/qa2001/qa1190.html%3Fid%3DDTS10001719-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>