<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>dec2str(IM:PN)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING87></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="PPCNumerics-86.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="PPCNumerics-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="PPCNumerics-192.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="PPCNumerics-88.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="PPCNumerics-2.html"><B>PowerPC Numerics </B></A> / <A HREF="PPCNumerics-48.html"><B>Part 2 - The PowerPC Numerics C Implementation</B></A><BR><DD><A HREF="PPCNumerics-71.html"><B>Chapter 9 - Conversion Functions</B></A> / <A HREF="PPCNumerics-86.html"><B>Converting Between Decimal Formats</B></A><BR><DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING87-0></A>
<H3>dec2str</H3>
 <A NAME=MARKER-2-71></A>You can use the <CODE>dec2str</CODE> function to convert a number in a <CODE>decimal</CODE> structure to a decimal string.<P>
<PRE>
void dec2str (const decform *f, const decimal *d, char *s);
</PRE>
<DL>
<DT><CODE>f</CODE>
<DD> A <CODE>decform</CODE> structure that describes how the number should look in decimal. See page 9-14</A> for a description of the <CODE>decform</CODE> structure.
<DT><CODE>d</CODE>
<DD> The <CODE>decimal</CODE> structure to be converted. See page 9-13</A> for the definition of the <CODE>decimal</CODE> structure.
<DT><CODE>s</CODE>
<DD> On return, a string representing the number in decimal.
</DL>
<A NAME=HEADING87-6></A>
<H5>DESCRIPTION</H5>
 The <CODE>dec2str</CODE> function is the PowerPC Numerics formatter. It takes a number from a decimal structure and converts it to a string. You can use the <CODE>num2dec</CODE> function to convert a binary floating-point number to a <CODE>decimal</CODE> structure appropriate for input to the <CODE>dec2str</CODE> function.<P>
<DL>
<DT><B>IMPORTANT</B>
<DD>Use the same decimal format structure settings for <CODE>dec2str</CODE> as you used for <CODE>num2dec</CODE>; otherwise, results are unspecified.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 <A NAME=MARKER-2-29></A>The numeric formatter is controlled by a <CODE>decform</CODE> structure <CODE>f</CODE>. With floating style, numbers formatted using the same value for <CODE>f.digits</CODE> have aligning decimal points and <I>e</I>'s. To ensure that numbers have the same width also, pad the exponent-digits field with spaces to a width of 4. For example, if <CODE>f.digits</CODE> = 12, then pad 12 + 8 - length(<CODE>s</CODE>) spaces on the right of the result string <CODE>s</CODE>. The value 8 accounts for the sign, point, letter <I>e</I>, exponent sign, and four exponent digits. Note that this scheme gives the correct field width for NaNs and Infinities too.<P>
 With fixed style, numbers formatted using the same value for <CODE>f.digits</CODE> have aligning decimal points if enough leading spaces are added to the result string <CODE>s</CODE> to attain a fixed width, which must be no narrower than the widest <CODE>s</CODE>.<CODE><A NAME=MARKER-2-66></A></CODE><P>
<DL>
<DT><B>IMPORTANT</B>
<DD>When you create a <CODE>decimal</CODE> structure, you must set <CODE>sig.length</CODE> to the size of the string you place in <CODE>sig.text</CODE>. You cannot leave the <CODE>length</CODE> field undefined.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
<A NAME=HEADING87-12></A>
<H5>EXCEPTIONS</H5>
 The formatter is always exact and signals no exceptions.<P>
<A NAME=HEADING87-14></A>
<H5>SPECIAL CASES</H5>
 For fixed-point formatting, <CODE>dec2str</CODE> treats a negative value for <CODE>digits</CODE> as a specification for rounding to the left of the decimal point; for example, <CODE>digits</CODE> = -2 means to round to hundreds. For floating-point formatting, values for <CODE>digits</CODE> less than 1 are treated as 1.<CODE><A NAME=MARKER-2-16></A></CODE><P>
 <A NAME=MARKER-2-29></A>NaNs are formatted as <CODE>NAN</CODE>; Infinities are formatted as <CODE>INF</CODE>. A leading sign or space is included according to the style convention.<P>
 The formatter never returns fewer significant digits than are contained in <CODE>sig</CODE>. However, if the <CODE>decform</CODE> structure calls for more significant digits than are contained in <CODE>sig</CODE>, then the formatter pads with zeros as needed.<CODE><A NAME=MARKER-2-54></A></CODE><P>
 If more than 80 characters are required to honor <CODE>digits</CODE>, then the formatter returns the string "?".<A NAME=MARKER-2-70></A><P>
<A NAME=HEADING87-19></A>
<H5>EXAMPLES</H5>
 Suppose you have an accounting program that computes exact values using binary numbers of pennies and prints outputs in dollars and cents. If you simply divide <BR>the number of pennies by 100 to get dollars, you incur errors because hundredths are not exact in binary. One way to print out exact values in dollars and cents is to convert the number of pennies to a <CODE>decimal</CODE> structure, perform the division by adjusting the exponent, and print the result, as shown in <A HREF=#MARKER-9-71>Listing 9-1</A>.<P>
<B>Listing 9-1  <A NAME=MARKER-9-71></A>Accounting program</B><P>
<PRE>
#include &lt;fp.h&gt;

   decform     df;
   double      pennies;    /* This is the input value */
   decimal     dpennies;   /* decimal value for pennies */
   char *      dollars;    /* string to print as $$$. */

{
   df.style = FIXEDDECIMAL;
   df.digits = 0;    /* start with 0 digits after decimal point */

   num2dec(&amp;df, pennies, &amp;dpennies);         /* decimal pennies */
   dpennies.exp = dpennies.exp - 2;          /* divide by 100 */

   df.digits = 2;       /* request 2 digits after decimal point */
   dec2str(&amp;df, &amp;dpennies, dollars);
   /* dollar string to print */
}
</PRE>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="PPCNumerics-86.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="PPCNumerics-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="PPCNumerics-192.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="PPCNumerics-88.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="PPCNumerics-3.html">&copy; Apple Computer, Inc.</A><br>13 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
