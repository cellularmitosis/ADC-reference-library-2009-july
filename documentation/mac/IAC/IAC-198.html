<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Specifying Optional Parameters for an Apple Event(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING198></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-197.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-199.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-195.html"><B>Chapter 5 - Creating and Sending Apple Events</B></A> / <A HREF="IAC-196.html"><B>Creating an Apple Event</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING198-0></A>
<H2><A NAME=MARKER-9-35></A>Specifying Optional Parameters for an Apple Event</H2>
 <A NAME=MARKER-2-199></A><A NAME=MARKER-21-130></A><A NAME=MARKER-2-110></A><A NAME=MARKER-9-46></A>The parameters for a given Apple event are listed in the <I>Apple Event Registry: Standard Suites</I> as either required or optional. Your application does not usually have to include Apple event parameters that are listed as optional; the target application uses default values for parameters that are listed as optional if your application does not provide them. The <I>Apple Event Registry: Standard Suites</I> defines the default value a target application should use for each optional parameter of a specific Apple event. <A NAME=MARKER-2-352></A><P>
 The guidelines listed in the <I>Apple Event Registry: Standard Suites</I> for which parameters should be considered optional and which should be considered required are not enforced by the Apple Event Manager. Instead, the source application indicates which Apple event parameters it considers optional by listing the keywords for those parameters in the <CODE>keyOptionalKeywordAttr</CODE> attribute. <P>
 The <CODE>keyOptionalKeywordAttr</CODE> attribute does not contain the optional parameters; it simply lists the keywords of any parameters for the Apple event that the source application wants to identify as optional. Although the source application is responsible for providing this information in the <CODE>keyOptionalKeywordAttr</CODE> attribute of an Apple event, it is not required to provide this attribute.<P>
 If a keyword for an Apple event parameter is not included in the <CODE>keyOptionalKeywordAttr</CODE> attribute, the source application expects the target application to understand the Apple event parameter identified by that keyword. If a target application cannot understand the parameter, it should return the result code <CODE>errAEParamMissed</CODE> and should not attempt to handle the event.<P>
 If a keyword for an Apple event parameter is included in the <CODE>keyOptionalKeywordAttr</CODE> attribute, the source application does not require the target application to understand the Apple event parameter identified by that keyword. If the target application cannot understand a parameter whose keyword is included in the <CODE>keyOptionalKeywordAttr</CODE> attribute, it should ignore that parameter and attempt to handle the Apple event as it normally does.<P>
 A source application can choose not to list the keyword for an Apple event parameter in the <CODE>keyOptionalKeywordAttr</CODE> attribute even if that parameter is listed in the <I>Apple Event Registry: Standard Suites</I> as an optional parameter. This has the effect of forcing the target application to treat the parameter as required for a particular Apple event. If the target application supports the parameter, it should handle the Apple event as the client application expects. If the target application does not support the parameter and calls an application-defined routine such as <CODE>MyGotRequiredParams</CODE> to check whether it has received all the required parameters, it finds that there's another parameter that the client application considered required, and should return the result code <CODE>errAEParamMissed</CODE>. <P>
 If a source application wants a target application to attempt to handle an Apple event regardless of whether the target application supports a particular Apple event parameter included in that Apple event, the source application should list the keyword for that parameter in the <CODE>keyOptionalKeywordAttr</CODE> attribute. <P>
 It is up to the source application to decide whether to list a parameter that is described as optional in the <I>Apple Event Registry: Standard Suites</I> in the <CODE>keyOptionalKeywordAttr</CODE> attribute of an Apple event. For example, suppose a source application has extended the definition of the Print event to include an optional <CODE>keyColorOrGrayscale</CODE> parameter that specifies printing in color or gray scale rather than black and white. The source application might decide whether or not to list the keyword <CODE>keyColorOrGrayscale</CODE> in the <CODE>keyOptionalKeywordAttr</CODE> attribute according to the characteristics of the print request. If the source application requires the target application to print a document in color, the source application could choose not to add the keyword <CODE>keyColorOrGrayscale</CODE> to the <CODE>keyOptionalKeywordAttr</CODE> attribute; in this case, only target applications that supported the <CODE>keyColorOrGrayscale</CODE> parameter would attempt to handle the event. If the source application does not require the document printed in color, it could choose to add the keyword <CODE>keyColorOrGrayscale</CODE> to the <CODE>keyOptionalKeywordAttr</CODE> attribute; in this case, the target application will attempt to handle the event regardless of whether it supports the <CODE>keyColorOrGrayscale</CODE> parameter.<P>
 Your application can add optional parameters to an Apple event the same way it adds required parameters, using the <CODE>AECreateDesc</CODE>, <CODE>AEPutParamPtr</CODE>, and <CODE>AEPutParamDesc</CODE> functions as described in the previous section, <A HREF=IAC-197.html#MARKER-9-31>"Adding Parameters to an Apple Event."</A> If your application chooses to provide the <CODE>keyOptionalKeywordAttr</CODE> attribute for an Apple event, it should first create a descriptor list that specifies the keywords of the optional parameters, then add it to the Apple event as a <CODE>keyOptionalKeywordAttr</CODE> attribute. <P>
 <A HREF=#MARKER-9-41>Listing 5-1</A> shows an application-defined routine,<CODE> MyCreateOptionalKeyword</CODE>, that creates the <CODE>keyOptionalKeywordAttr</CODE> attribute for the Create Publisher event.<P>
<B>Listing 5-1  <A NAME=MARKER-9-41></A>Creating the optional keyword for the Create Publisher event<A NAME=MARKER-2-94></A></B><P>
<PRE>
FUNCTION MyCreateOptionalKeyword
                        (VAR createPubAppleEvent: AppleEvent)
                         : OSErr;
VAR
   optionalList:  AEDescList;
   myOptKeyword1: AEKeyword;
   myOptKeyword2: AEKeyword;
   myErr:         OSErr;
   ignoreErr:     OSErr;
BEGIN                   
   myOptKeyword1 := keyDirectObject;
   {create an empty descriptor list}
   myErr := AECreateList(NIL, 0, FALSE, optionalList);
   IF myErr = noErr THEN 
   BEGIN
      {add the keyword of the first optional parameter}
      myErr := AEPutPtr(optionalList, 1, typeKeyword, 
                        @myOptKeyword1, SizeOf(myOptKeyword1));
      IF myErr = noErr THEN 
      BEGIN
         {add the keyword of the next optional parameter}
         myOptKeyword2 := keyAEEditionFileLoc;
         myErr := AEPutPtr(optionalList, 2, typeKeyword, 
                           @myOptKeyword2, SizeOf(myOptKeyword2));
      END;
      IF myErr = noErr THEN 
         {create the keyOptionalKeywordAttr attribute and add it }
         { to the Create Publisher event}
         myErr := AEPutAttributeDesc(createPubAppleEvent,
                                     keyOptionalKeywordAttr, 
                                     optionalList);
   END;
   ignoreErr := AEDisposeDesc(optionalList);
   MyCreateOptionalKeyword := myErr;
END;
</PRE>
 The <CODE>MyCreateOptionalKeyword</CODE> function shown in <A HREF=#MARKER-9-41>Listing 5-1</A> adds to a descriptor list the keyword of each parameter that the source application considers optional. Each keyword is added as a descriptor record with the descriptor type typeKeyword. The function specifies that the target application can handle the Create Publisher event without supporting parameters identified by the keywords <CODE>keyDirectObject</CODE> and <CODE>keyAEEditionFileLoc</CODE>. (These are the parameters that specify the Apple event object to publish and the location of the edition container; if these parameters are missing, the target application creates a publisher for the current selection using the application's default edition container.) After adding these keywords to the descriptor list, the function creates the <CODE>keyOptionalKeywordAttr</CODE> attribute using the <CODE>AEPutAttributeDesc</CODE> function.<P>
 Typically a target application does not examine the <CODE>keyOptionalKeywordAttr</CODE> attribute directly. Instead, a target application that supports a parameter listed as optional in the <I>Apple Event Registry: Standard Suites</I> attempts to extract it from the Apple event (using <CODE>AEGetParamDesc</CODE>, for example). If it can't extract the parameter, the target application uses the default value, if any, listed in the <I>Apple Event Registry.</I> A target application can use the <CODE>keyMissedKeywordAttr</CODE> attribute to return the first required parameter (that is, considered required by the source application), if any, that it did not retrieve from the Apple event. The <CODE>keyMissedKeywordAttr</CODE> attribute does not return any parameters whose keywords are listed in the <CODE>keyOptionalKeywordAttr</CODE> attribute of the Apple event. <A NAME=MARKER-2-43></A> <A NAME=MARKER-2-44></A> <A NAME=MARKER-9-171></A> <A NAME=MARKER-2-46></A> <A NAME=MARKER-2-47></A> <A NAME=MARKER-2-48></A> <A NAME=MARKER-9-98></A> <A NAME=MARKER-2-301></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-197.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-199.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
