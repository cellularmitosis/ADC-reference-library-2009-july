<HTML><head><script language="JavaScript" src="../../RM/frametest.js"></script><TITLE> Preferred Codec APIs</TITLE><script language=javascript> window.parent.focus(); </script></HEAD><BODY BGCOLOR="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- path goes here --><!-- QTnavbar start --><P><I>What's New in QuickTime 5</I><P>| <A HREF="Max.74.htm">Previous</A> | <A HREF="Max.1.htm">Chapter Contents</A> | <A HREF="Max.htm">Chapter Top</A> | <A HREF="Max.76.htm">Next</A> |</P></DIV><!-- QTnavbar end --><H1 CLASS="H1.Heading1"><A NAME="pgfId=76642"> </A><A NAME="marker=88217"> </A>Preferred Codec APIs</H1><P CLASS="T1.Text1"><A NAME="pgfId=76644"> </A>QuickTime has added two new APIs that help applications specify the codec or effects components that they prefer to use when playing a movie. This supplements the normal behavior of relying on performance and compatibility as the criteria for choosing the codecs to be used.</P><P CLASS="T1.Text1"><A NAME="pgfId=76645"> </A>Applications can use these APIs to access components that all work together as a set (for example, decompressors and effects all working on the same hardware).</P><P CLASS="T1.Text1"><A NAME="pgfId=76646"> </A>Third-party codec providers no longer need to use decompression speed as the only way to have their codecs used in preference -- the application is now able to specify the ones it prefers. Note that applications that don't use these APIs will continue to rely on the normal behavior of the ICM.</P><DIV><H4 CLASS="RoH.RoutineHeading"><A NAME="pgfId=76648"> </A><A NAME="marker=88218"> </A>MediaSetUserPreferredCodecs</H4><P CLASS="T1.Text1"><A NAME="pgfId=76649"> </A>Requests that a media handler favor specified codec components when selecting components with which to play media.  </P><CODE CLASS="RD.RoutineDeclare"><A NAME="pgfId=97885"> </A>pascal ComponentResult MediaSetUserPreferredCodecs( MediaHandler mh, CodecComponentHandle <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;userPreferredCodecs );</code><br><DL COMPACT><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=97887"> </A><TT CLASS="cv">mh</TT></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=76652"> </A>Specifies your connection to the media handler component. You can call the Movie Toolbox routine <TT CLASS="cv">GetMediaHandler</TT> to obtain a connection to the media handler component for a track's media.</DD><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=97896"> </A><TT CLASS="cv">userPreferredCodecs</TT></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=76653"> </A> A handle containing component identifiers. The media handler component will make its own copy of this handle. Pass nil to invalidate the standing request without substituting another.</DD></DL COMPACT><DIV><H5 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=76724"> </A>DISCUSSION</H5><P CLASS="T1.Text1"><A NAME="pgfId=76747"> </A>This method does not guarantee that the specified components will be used; other factors may take precedence. Components that are preferred may not be used if they can't be part of the chain required to play the media (for example, don't handle the pixel format, or the video output, and so on).</P><P CLASS="T1.Text1"><A NAME="pgfId=76657"> </A>The components should be specified in order from most preferred to least preferred.  </P><P CLASS="T1.Text1"><A NAME="pgfId=76658"> </A>Errors:</P><UL><LI CLASS="B1.Bullet1"><A NAME="pgfId=76659"> </A><TT CLASS="cv">noErr</TT></LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=76660"> </A><TT CLASS="cv">memFullErr</TT></LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=76661"> </A><TT CLASS="cv">badComponentSelector</TT>				The media handler component does not support this call.</LI></UL><P CLASS="T1.Text1"><A NAME="pgfId=76663"> </A>Example:</P><CODE CLASS="Cv.Code"><A NAME="pgfId=97910"> </A>CodecComponentHandle userPreferredCodecs = nil;<BR>ComponentDescription cd = { decompressorComponentType,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myPreferredCodecType,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myPreferredCodecManufacturer,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0, 0 };<BR>CodecComponent &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c = FindNextComponent( 0, &amp;cd );<BR>MediaHandler&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myMedia;<BR>OSErr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err;<BR><BR>PtrToHand( &amp;c, (Handle*)&amp;userPreferredCodecs, sizeof(c) );<BR><BR>myMedia = GetMediaHandler( GetTrackMedia( track ) );<BR><BR>err = MediaSetUserPreferredCodecs( myMedia, userPreferredCodecs );<BR>DisposeHandle( (Handle)userPreferredCodecs );</code><br></DIV></DIV><DIV><H4 CLASS="RoH.RoutineHeading"><A NAME="pgfId=76682"> </A><A NAME="marker=88219"> </A>MediaGetUserPreferredCodecs</H4><P CLASS="T1.Text1"><A NAME="pgfId=76683"> </A>Retrieves the list of components last passed to the media handler with <TT CLASS="cv">MediaSetUserPreferredCodecs</TT>.</P><CODE CLASS="RD.RoutineDeclare"><A NAME="pgfId=97914"> </A>pascal ComponentResult MediaGetUserPreferredCodecs( MediaHandler mh, CodecComponentHandle <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*userPreferredCodecs );</code><br><DL COMPACT><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=97916"> </A><TT CLASS="cv">mh</TT></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=76686"> </A>Specifies your connection to the media handler component. You can call the Movie Toolbox routine <TT CLASS="cv">GetMediaHandler</TT> to obtain a connection to the media handler component for a track's media.</DD><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=97925"> </A><TT CLASS="cv">userPreferredCodecs</TT></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=76687"> </A> Points to a variable of type <TT CLASS="cv">CodecComponentHandle</TT>. If the media handler currently has a preferred component list, it will copy that list into a new handle and store the new handle in this variable. The caller must dispose this handle. If the media handler does not currently have a preferred component list, it will store nil in this variable.  </DD></DL COMPACT><DIV><H5 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=76732"> </A>DISCUSSION</H5><P CLASS="T1.Text1"><A NAME="pgfId=76690"> </A>Errors:</P><UL><LI CLASS="B1.Bullet1"><A NAME="pgfId=76691"> </A><TT CLASS="cv">noErr</TT></LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=76692"> </A><TT CLASS="cv">memFullErr</TT></LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=76693"> </A><TT CLASS="cv">paramErr</TT></LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=76694"> </A><TT CLASS="cv">badComponentSelector</TT>			The media handler component does not support this call.</LI></UL></DIV></DIV><hr>&#169; 2001 Apple Computer, Inc.<!-- QTnavbar start --><P><I>What's New in QuickTime 5</I><P>| <A HREF="Max.74.htm">Previous</A> | <A HREF="Max.1.htm">Chapter Contents</A> | <A HREF="Max.htm">Chapter Top</A> | <A HREF="Max.76.htm">Next</A> |</P></DIV><!-- QTnavbar end --></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY></HTML>