<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE> Toolbox Image File Contents </TITLE></HEAD><BODY BGCOLOR="#ffffff"><a name="top"></a><!-- start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!-- start of path --><table border="0" cellpadding="0" cellspacing="2" width="432">		<tr>	<td scope="row"><font face="Geneva,Helvetica,Arial" size="1">	<b>PATH<img src="../../../images/space.gif" width="6" height="12"></b><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Documentation</a> &gt; <!-- a href="" target="_top" -->Hardware<!-- /a --> 	<b>&gt;</b> Original iMac Developer Note		</font></td>	</tr>	</table><br><!-- end of path --><DIV><!-- top navigation --><P><A HREF="iMac.27.html"><img src="images/up.gif" border="0" alt="Up"></A> <A HREF="iMac.2b.html"><img src="images/previous.gif" border="0" alt="Previous"></A> <A HREF="iMac.2d.html"><img src="images/next.gif" border="0" alt="Next"></A> <!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></a></div><!-- end top navigation --><hr><H1 CLASS="H1.Heading1"><A NAME="pgfId=3377"> </A>Toolbox Image File Contents <A NAME="marker=3376"> </A></H1><P CLASS="T1.Text1"><A NAME="pgfId=3378"> </A>The Toolbox image file (also called the bootinfo file) contains three main components, each of which is made up of smaller components: the pieces that are part of the bootinfo specification, the Trampoline code, and the ToolBox ROM Image itself.</P><P CLASS="T1.Text1"><A NAME="pgfId=3379"> </A>Most changes needed for a new CPU occur in the Boot ROM, not in the bootinfo file. Changes to the ToolBox ROM Image should be limited to new manager software and support for hardware that is common to many Macintosh computers (ATA interface modules, user interface modules, and the like).</P><P CLASS="T1.Text1"><A NAME="pgfId=3380"> </A>The bootinfo file exists on the boot device and has a localizable name. Identification information that leads to the file's path is stored in NV-RAM and the search algorithm for a usable bootinfo file parallels the search mechanism across SCSI, ATA, etc., used in the former startup disk routine. By default, the file is located by using the directory ID of the &quot;blessed folder&quot; in the boot block of each HFS or HFS Plus partition, and then searching for a file with a file type of <TT CLASS="cv">'tbxi'</TT>. Searching by file type is done to allow localization of the file. Non-localized, the name of the bootinfo file is &quot;Mac OS ROM&quot;. </P><DIV><H2 CLASS="H2nb.Heading2"><A NAME="pgfId=3383"> </A>Open Firmware Script <A NAME="marker=3381"> </A><A NAME="marker=3382"> </A></H2><P CLASS="T1.Text1"><A NAME="pgfId=3384"> </A>The bootinfo components normally do not need to be changed for each new product. The Open Firmware script is automatically modified at build time to have the correct offsets within the bootinfo file to the other two main components.</P></DIV><DIV><H2 CLASS="H2nb.Heading2"><A NAME="pgfId=3387"> </A>Trampoline Code <A NAME="marker=3385"> </A><A NAME="marker=3386"> </A></H2><P CLASS="T1.Text1"><A NAME="pgfId=3388"> </A>The Trampoline code is the component of the NewWorld architecture that handles the transition between Open Firmware and the ToolBox ROM Image. It retrieves all necessary information about the system from Open Firmware, instantiates RTAS, decompresses the ToolBox ROM Image, locates the Mac OS NV-RAM partition, formats the system information into tables and data structures for Mac OS, terminates Open Firmware, moves information in memory to safe locations, and transfers control to the ToolBox ROM Image.</P></DIV><DIV><H2 CLASS="H2nb.Heading2"><A NAME="pgfId=3391"> </A>ToolBox ROM Image <A NAME="marker=3389"> </A><A NAME="marker=3390"> </A></H2><P CLASS="T1.Text1"><A NAME="pgfId=3392"> </A>The NewWorld version of the ToolBox ROM Image is similar to the old ToolBox ROM in that it has a similar layout and contains many of the same components as it did before.</P><P CLASS="T1.Text1"><A NAME="pgfId=3393"> </A>The ToolBox ROM Image includes code that contains hardware-specific support, including ADB, VIA, Cuda/Egret, MESH SCSI, Heathrow/CHRP/UltraDMA ATA AIMs. In the future, they can be moved out of the ToolBox ROM Image when there is a mechanism to load them from a boot volume at boot time.<A NAME="marker=3394"> </A></P></DIV><HR>\xA9 1998 Apple Computer, Inc. <P><A HREF="iMac.27.html"><img src="images/up.gif" border="0" alt="Up"></A> <A HREF="iMac.2b.html"><img src="images/previous.gif" border="0" alt="Previous"></A> <A HREF="iMac.2d.html"><img src="images/next.gif" border="0" alt="Next"></A>  <!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!-- document.write(frameLink);//--></script><!-- end Show/Hide frames --></a></P> <!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></HTML>