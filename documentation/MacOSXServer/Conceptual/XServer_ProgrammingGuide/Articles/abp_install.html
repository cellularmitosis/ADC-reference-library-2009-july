<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Mac OS X Server Administrator Topics: Installation and Best Practices</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Installation and Best Practices"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40003509" title="Installation and Best Practices"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000426" target="_top">Mac OS X Server</a> &gt; <a href="../index.html" target="_top">Mac OS X Server Administrator Topics</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="ard.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/TP40003509-SW1" title="Installation and Best Practices"></a><hr /><H1>Installation and Best Practices</H1><p>Because every setup of Mac OS X Server is different, you should understand as much as possible about the process before deciding on a plan for implementation. This article discusses and recommends accepted best practices that should apply to many, but certainly not all, situations.</p><p>This article is intended as an overview of the best practices for system administrators responsible for large-scale deployments of Mac OS X Server. This article is not a step-by-step manual. Where appropriate or available, references are provided for more information on a particular topic. Also, special attention is paid to large-scale enterprise and institutional needs, because smaller-scale needs are already well covered by existing <span class="content_text"><a href="../../../../../documentation/MacOSXServer/index-date.html" target="_top">documentation</a></span>.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="abp_install.html#//apple_ref/doc/uid/TP40003509-SW2">Initial Installation of Mac OS X Server</a>
				
			<br/>
			
        
			
			
				<a href="abp_install.html#//apple_ref/doc/uid/TP40003509-SW3">Configuration of Mac OS X Server</a>
				
			<br/>
			
        
			
			
				<a href="abp_install.html#//apple_ref/doc/uid/TP40003509-SW4">Drive Configuration</a>
				
			<br/>
			
        
			
			
				<a href="abp_install.html#//apple_ref/doc/uid/TP40003509-SW5">Cloning the Boot Volume</a>
				
			<br/>
			
        
			
			
				<a href="abp_install.html#//apple_ref/doc/uid/TP40003509-SW6">Performing Ongoing Maintenance</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40003509-SW2" title="Initial Installation of Mac OS X Server"></a><h2>Initial Installation of Mac OS X Server</h2><p>Even though Server Setup Assistant provides a very robust and useful interface for setting up a server, a better methodology is required when deploying tens or hundreds of servers at any one time.</p><p>Many sites are using deployment techniques for Mac OS X Server that are very similar to Mac OS X client systems. Typically a "golden master" server image is created. This golden master sever image includes all relevant site-specific modifications, such as software installs and configuration, but has a dynamic DHCP-based IP address and no directory services configured.</p><p>The image is installed on the machines by hand imaging them with tools such as Apple's Disk Utility, which can do disk image restores. This process can easily be run from either an external bootable device, such as a FireWire hard drive, or a bootable DVD. The golden master image can either be stored on the bootable media, or hosted on a remote web or NFS server. For more information about installing images on computers, see <em><a href="../../../../../server/macosx/docs/System_Imaging_and_SW_Update_Admin_v10.5.pdf" target="_top">Mac OS X Server System Image and Software Update Administration</a></em>.</p><p>If you need to image more than a few systems at any one time, the use of a NetBoot or NetRestore server is common practice. Once booted from the NetBoot server, the systems are imaged with the golden master. Many times the imaging is actually accomplished by automated scripts so that no human intervention is required after the machine has NetBooted.</p><p>The new multicast Apple Software Restore (ASR) server that is present in Mac OS X Server v10.4 and Mac OS X v10.4 is being used for large scale system imaging. This tool allows the golden master image to be multicasted to as many machines as your network hardware can support at any one time. For more information about the ASR server see the ASR man page in the <em><a href="../../../../Darwin/Reference/ManPages/index.html#//apple_ref/doc/uid/TP40000894" target="_top">Mac OS X Man Pages</a></em>.</p><p>Current deployments are imaging up to 2000 machines per day with a combination of NetBoot and multicast ASR with minimal administrative staff working on the task.</p><p>Regardless of whether you choose a full NetBoot or ASR setup or just use a firewire drive to restore an image onto the new server, you should not have to do full installs from the Mac OS X Server installation DVDs.</p><a name="//apple_ref/doc/uid/TP40003509-SW3" title="Configuration of Mac OS X Server"></a><h2>Configuration of Mac OS X Server</h2><p>After the system has been installed, even if coming from the Mac OS X Server installation DVDs, you need to configure the system.</p><p>To facilitate mass deployments Apple has created a configuration file framework that allows administrators to pre-create setup files that a newly installed server will use to configure itself.</p><p>The Server Setup Assistant allows you to do this on systems installed from the installation media and to create text configuration files that can either be stored in the LDAP directory or connected to the machine by external storage.</p><p>Often you will be interested in more customized configurations, so it is common to use a golden master where the initial admin user and other settings have already been configured.</p><p>Note that when performing single machine installs through the Server Setup Assistant you should always configure the machine to be a Stand Alone system in regards to directory services. Log in to the machine first, and ensure that your settings for DNS and networking in general are working properly, before you changing the Open Directory configuration.</p><p>Also, if you are going through the Server Setup Assistant, you will be given the option to enable specific services that will be immediately available after the machine reboots for the last time during the configuration. With the exception of Apple Remote Desktop, used when the target machine is configured in a "headless" configuration without a video card, you should not enable any of the services.</p><p>Since you can enable individual services at a later time with no loss of functionality, it is best to ensure that your server has been correctly set up and then to configure each of the services before enabling them.</p><a name="//apple_ref/doc/uid/TP40003509-SW4" title="Drive Configuration"></a><h2>Drive Configuration</h2><p>You should configure all servers with some form of RAID for the boot volume. If all of your data storage for the system is being handled by an external RAID device, considered best practice, then you can easily use the built-in software RAID of Mac OS X Server to mirror the boot drive.</p><p>If you need internal data storage, consider a hardware RAID card that will allow for RAID 5 and more configuration options than the software RAID alone will allow.</p><p>If you use an Xserve server computer with external storage, you want to fill the first two drive bays with smaller drive modules and then mirror the data for the boot volume. Then configure the third bay with a larger drive. Use it for admin storage, clones of the boot volume, and staging of backups.</p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40003509-DontLinkElementID_4" title="Important:"></a><p><strong>Important:</strong>&nbsp;A redundant boot volume is a best practice.</p><p></p></div><p>While it is possible to install OS X on a UFS-formatted volume, it’s highly recommend you use an HFS+ Journaled format.</p><p>It’s common in many Unix server configurations to map the temp folder, virtual memory space, and <code>/var</code> directory to other partitions. This is typically done to either speed up the system or to prevent the boot drive from being filled up with either errant log files or ballooning virtual memory swap files. With the large amount of performance tuning that has been done with OS X to maximize the caching of the RAM and the kernel itself in addition to the massive increase in hard disk capacity in recent years, there are rarely, if ever, any gains to be had by implementing the remappings. Additionally, it is more typically a machine’s processor or network connection that is the bottleneck and not system drive I/O. In fact, you may be putting yourself at a disadvantage by doing this since very few admin tools or third party solutions for OS X expect this kind of configuration.</p><a name="//apple_ref/doc/uid/TP40003509-SW5" title="Cloning the Boot Volume"></a><h2>Cloning the Boot Volume</h2><p>To account for system-update regressions and potential catastrophic damage to your boot volume, you should regularly clone the boot system onto other media.</p><p>In the case of the Xserve with external storage, the third drive bay is commonly configured with a large drive and then partitioned into three volumes. These volumes are used for a nightly backup, a known good backup, and a pre-update backup. Each of these is discussed in more detail below. The boot volume is then cloned to this drive using either <code>rsync</code>, <code>psync</code>, Apple System Restore, or a number of third-party utilities.</p><p>Every night the system clones the boot volume to the "Nightly" partition. This partition is used as a staging area for backups. It is also used as a primary restore volume in the case of a failure or corruption of the operating system. In these cases you can usually boot from the Nightly volume and have your server accessible to clients in a matter of minutes after the disaster. Then, when it is more convenient, you can either clone the Nightly volume back to the boot volume, or repair the boot volume so that it is useable again.</p><p>If you do clone your boot volume on a nightly basis, you can then run your backup software against the cloned system instead of your boot drive. Doing so lessens the performance impact of a backup on your server.</p><p>The boot volume is then cloned to a "Known Good" partition whenever the system has been running well for some time and has not had recent configuration changes.  This volume is used less for restoration purposes and more for an online archive of configuration files.</p><p>Finally, the system should be cloned to a "Pre-Update" partition immediately before you apply software updates to the system. This provides a high degree of protection in case the update procedure produces unexpected results. In the same way that you booted from the Nightly volume, you can use the Pre-Update volume to restore a machine to functionality within minutes of detecting an abnormality with your system.</p><p>It's important to note that the cloning methodology described here is not a solution to backing up client data. It is preferred to have all dynamic client data be stored on an external RAID system and backed up to tape using any of a variety of backup solutions. The use of the boot volume clones is entirely to ensure the highest availability possible for your system volume, not your client data.</p><a name="//apple_ref/doc/uid/TP40003509-SW6" title="Performing Ongoing Maintenance"></a><h2>Performing Ongoing Maintenance</h2><p>Software updates to production systems should be undertaken only after sufficient regression testing. Although the Nightly volume will help in this matter, with large installations it is common to use a network-based file management solution.</p><p>Apple's Apple Remote Desktop (ARD) allows an administrator to push software changes to hundreds of machines at the same time, helping you to ensure that they are all maintained in a similar fashion. With the introduction of ARD 3.0, machines that are offline during a software or configuration update are updated or configured when they come online..</p><p>If you desire a more automatic solution for this you can look into the open source Radmind, popular in a large number of  higher education installations, or commercial options such as FileWave, Casper, and Net Octopus. All of these solutions allow you to do checksums on every file on your server and automatically replace any file that has been modified without permission.</p><p>Although these solutions usually have a fairly steep learning curve and infrastructure requirements, using them virtually guarantees that all of your systems are identical in configuration and prevents configuration decay over time.</p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="ard.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-05-23<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/MacOSXServer/Conceptual/XServer_ProgrammingGuide/Articles/abp_install.html%3Fid%3DTP40002421-3.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/MacOSXServer/Conceptual/XServer_ProgrammingGuide/Articles/abp_install.html%3Fid%3DTP40002421-3.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/MacOSXServer/Conceptual/XServer_ProgrammingGuide/Articles/abp_install.html%3Fid%3DTP40002421-3.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
