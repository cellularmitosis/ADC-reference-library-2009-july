<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>The 'itl2' Tables(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING550></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-549.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-551.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-531.html"><B>Appendix B - International Resources</B></A> / <A HREF="Text-547.html"><B>String-Manipulation Resource (Type 'itl2')</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING550-0></A>
<H2><A NAME=MARKER-9-269></A>The 'itl2' Tables</H2>
 <A NAME=MARKER-2-270></A>The following tables in the string-manipulation resource define character and word features for processing strings.<P>
<UL>
<LI><A NAME=MARKER-2-289></A>Type list. Contains character-type information for each class of character (as specified by the class array) in the script system's character set. The Script Manager <CODE>CharacterType</CODE> function uses this table. The type list is used by 1-byte script systems only; character-type information for a 2-byte script system is in that script's encoding/rendering (<CODE>'itl5'</CODE>) resource.
<LI><A NAME=MARKER-2-272></A>Class array. Maps each character in the script system's character set to a <I>class,</I> which is used to index into the other character tables in the string-manipulation resource. The Script Manager <CODE>CharacterType</CODE> function uses this table. The class array is used by 1-byte script systems only; character-class information for a 2-byte script system is in that script's encoding/rendering (<CODE>'itl5'</CODE>) resource.
<LI><A NAME=MARKER-2-273></A>Uppercase list. Used to generate uppercase equivalents for all lowercase characters in the script system's character set. For each character class, contains a value to be added to the character code to convert all characters to uppercase. The Text Utilities <CODE>UppercaseText</CODE> procedure uses this table. The uppercase list is used by 1-byte script systems only.
<LI><A NAME=MARKER-2-274></A>Lowercase list. Used to generate lowercase equivalents for all uppercase characters in the script system's character set. For each character class, contains a value to be added to the character code to convert all characters to lowercase. The Text Utilities <CODE>LowercaseText</CODE> procedure uses this table. The lowercase list is used by 1-byte script systems only.
<LI><A NAME=MARKER-2-275></A>Uppercase strip list. Used to generate uppercase equivalents--without diacritical marks--for all characters in the script system's character set. For each character class, contains a value to be added to the character code to convert all characters to uppercase versions without diacritical marks. The Text Utilities <CODE>UppercaseStripDiacritics</CODE> procedure uses this table. The uppercase strip list is used by 1-byte script systems only.
<LI><A NAME=MARKER-2-276></A>Strip list. Used to generate equivalents--without diacritical marks--for all characters in the script system's character set. For each character class, contains a value to be added to the character code to strip diacritical marks. The Text Utilities <CODE>StripDiacritics</CODE> procedure uses this table. The strip list is used by 1-byte script systems only.
<LI>Word-selection table. A table of data type <CODE>NBreakTable</CODE> or <CODE>BreakTable</CODE>, used by the Text Utilities <CODE>FindWordBreaks</CODE> procedure to find word boundaries for the purposes of word selection. See <A HREF=Text-552.html#MARKER-9-290>"Supplying Custom Word-Break Tables" on page B-44</A> for a description of the break-table formats.
<LI><A NAME=MARKER-2-277></A>Line-break table. A table of data type <CODE>NBreakTable</CODE> or <CODE>BreakTable</CODE>, used by theText Utilities <CODE>FindWordBreaks</CODE> procedure to find word boundaries for breaking lines of text. The rules governing word boundaries for line breaking are generally somewhat different from those for word selection.
<LI><A NAME=MARKER-2-278></A>Script run table. A data structure used by the Text Utilities <CODE>FindScriptRun</CODE> function. It is used to find runs of a subscript, such as Roman, within text of a non-Roman script system. See the next section.<P>
</UL>
<A NAME=HEADING550-11></A>
<H3><A NAME=MARKER-9-279></A>Script Run Table Format</H3>
 <A NAME=MARKER-2-280></A>The script run table is used by the Text Utilities <CODE>FindScriptRun</CODE> function.<CODE> FindScriptRun</CODE> locates runs of text that belong to a subscript, such as Roman, within a single script run. The <CODE>FindScriptRun</CODE> function is described in the chapter "Text Utilities" in this book.<P>
 There are two formats of script run table. The original format, used in versions of system software earlier than 7.1, consists of a series of byte pairs with the format <I>character code, script code</I>. The character code is the final character code in a range of characters that belongs to the script specified by the script code. (The table contains only final character codes; the initial character code of a range is assumed to be one greater than the final character code in the previous range--or 0 for the first range.) The last pair must <BR>have character code $FF. For example, if the character set encoding for script <CODE>smSample</CODE> were defined such that $00-7F and $A0 were Roman characters and the remaining characters were native characters in <CODE>smSample</CODE>, the table would appear as follows:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Character <BR>code<TH>Script code<BR><TR>
<TD>$7F<TD>smRoman<TR>
<TD>$9F<TD>smSample<TR>
<TD>$A0<TD>smRoman<TR>
<TD>$FF<TD>smSample</TABLE>
<P>
 This simple format is appropriate for script systems whose text can be separated into Roman or native characters based purely upon character code, and for which other subscript information (returned in the <CODE>variant</CODE> field of the <CODE>ScriptRunStatus</CODE> record by <CODE>FindScriptRun</CODE>) is always 0. For 2-byte script systems, or when the same character could be designated as either Roman or native (depending on its context), this simple format is insufficient.<P>
 The newer format for the script run table is used in versions of system software starting with 7.1. It consists of a header, a state table, and a set of associated tables, similar in structure to the word-break table of type <CODE>NBreakTable</CODE> (described on <A HREF=Text-552.html#MARKER-9-292>page B-44</A>). It is more flexible than the old format: for example, it can consider punctuation marks such as the period (ASCII code $2E) to be either to Roman or non-Roman, depending upon whether they are associated with Roman or non-Roman characters in the text. The script run table format is shown in <A HREF=#MARKER-9-281>Figure B-5</A>.<P>
<B>Figure B-5  <A NAME=MARKER-9-281></A>Format of the script run table header (new format)</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/IR_L-25.jpg">
 The table header has these elements:<P>
<UL>
<LI>Flags 1 and flags 2. The flags are not defined and should be 0, except that the high-order bit of the second byte (flags 2) must be 1 to mark this as a new-format script run table.
<LI>Version. The version number of this script run table format.
<LI>Length. The length in bytes of this script run table.
<LI>Offset to class table. The offset in bytes from the beginning of the script run table to the beginning of the class table.
<LI>Offset to auxiliary class table. The offset in bytes from the beginning of the script run table to the beginning of the auxiliary class table.
<LI>Offset to state table. The offset in bytes from the beginning of the script run table to the beginning of the state table.
<LI>Offset to return table. The offset in bytes from the beginning of the script run table to the beginning of the return table.
<LI>(reserved). Reserved.<P>
</UL>
 The header is immediately followed by the data of the class table, auxiliary class table, state table, and return table. The tables have this format and content:<P>
<UL>
<LI>The class table is an array of 256 signed bytes. It assigns class values to 1-byte characters and works with the auxiliary class table to assign class values for 2-byte characters. It has the same format as the class table used by the word-break table described under <A HREF=Text-552.html#MARKER-9-292>"NBreakTable Format" beginning on page B-44</A>.
<LI>The auxiliary class table assigns character classes to 2-byte characters. It has the same format as the auxiliary class table used by the word-break table described under <A HREF=Text-552.html#MARKER-9-292>"NBreakTable Format" beginning on page B-44</A>.
<LI>The state table is used by <CODE>FindScriptRun</CODE> to determine the subscript assignment for a given character class, accounting for its context. Using the state table, <CODE>FindScriptRun</CODE> starts at a specified character, moving forward through the text until it encounters a subscript boundary.<P>
</UL>
 The state table is shown in <A HREF=#MARKER-9-282>Figure B-6</A>. The table begins with a list of words containing byte offsets from the beginning of the state table to the rows of the state table; this <BR>is followed by a <I>c</I>-by-<I>s</I> byte array, where <I>c</I> is the number of classes (columns) and <I>s</I> is <BR>the number of states (rows). The bytes in this array are stored with the column index varying most rapidly--that is, the bytes for the state 0 row precede the bytes for <BR>the state 1 row. There is a maximum of 128 classes and 64 states (including the start <BR>and exit states).<P>
<B>Figure B-6  <A NAME=MARKER-9-282></A>Script run table state table</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/IR_L-27.jpg">
 Each entry in this array is an action code, which specifies<P>
<UL>
<LI>whether to mark the current offset
<LI>whether to exit
<LI>the next state or (if exiting) the exit code<P>
</UL>
 The format of an action code is shown in <A HREF=#MARKER-9-283>Figure B-7</A>.<P>
<B>Figure B-7  <A NAME=MARKER-9-283></A>Format of a script run table action code</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/IR_L-28.jpg">
 The return table is a list of script code-variant pairs, as shown in <A HREF=#MARKER-9-284>Figure B-8</A>. The table lists possible return values for the <CODE>FindScriptRun</CODE> function. Each pair in the table is a <CODE>ScriptRunStatus</CODE> record, as described in the chapter "Text Utilities" in this book. The variant associated with each script code gives subscript information for 2-byte script systems. When <CODE>FindScriptRun</CODE> exits the state table, it has encountered a subscript boundary; it uses the exit code to index into the return table and determine the script code of the subscript run it has just exited from.<P>
<B>Figure B-8  <A NAME=MARKER-9-284></A>Format of the script run table return<A NAME=MARKER-2-285></A> table<A NAME=MARKER-2-286></A></B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/IR_L-26.jpg">
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-549.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-551.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
