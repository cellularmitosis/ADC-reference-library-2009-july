<HTML>		<HEAD>		<TITLE>			WOSessionStore		</TITLE>		</HEAD>	<body bgcolor="#ffffff"><!--start of banner --><!-- #include virtual="/techpubs/navbar" --><!-- end of banner --><!--start of path --><font face="Geneva,Helvetica,Arial" size="1"><b>PATH<spacer type="horizontal" size="5">&nbsp;</b> <a href="../../../../../../../index.html" target="_top">Documentation</a> <b>&gt;</b> <a href="../../../../../../webobjects.html" target="_top">WebObjects 4.5</a> <b>&gt;</b>WebObjects Reference</font><br><br><!--end of path --><a href="../WebObjectsTOC.html"><img src="../../../../../../images/up.gif" border="0" alt="Table of Contents"></a> <a name = "WOSessionStore"><BR><h1><FONT COLOR=\"#000066\"><a name="//apple_ref/occ/cl/WOSessionStore">WOSessionStore</a></FONT></h1><br></a><blockquote><b>Inheritsfrom: </b> NSObject</blockquote><blockquote><b>Declared in: </b> WebObjects/WOSessionStore.h<BR></blockquote><br><br><HR SIZE=4><br><h2>Class Description</h2><hr><p>WOSessionStore, an abstract superclass, offers an object abstractionfor storing client state per session. The application object ( <a frame= "conv" href="WOApplication.html#WOApplication">WOApplication</a>) uses an instance ofa concrete WOSessionStore subclass to implement a strategy for storingand retrieving session state. You typically set the WOSessionStore duringapplication initialization through WOApplication's  <a frame= "conv" href="WOApplication.html#//apple_ref/occ/instm/WOApplication/setSessionStore:">setSessionStore:</a> method.</p><p>An application first creates a session ( <a frame= "conv" href="WOSession.html#WOSession">WOSession</a>) when it receives a requestwithout a session ID. When this first request has been handled,the application stores the WOSession object under a randomly generatedsession ID by invoking its own  <a frame= "conv" href="#//apple_ref/occ/instm/WOSessionStore/saveSessionForContext:">saveSessionForContext:</a> method. Thismethod by default forwards the message to the chosen WOSessionStoreand that WOSessionStore takes care of the details of saving sessionstate. When the next request comes in for that session, the applicationrestores the session by sending itself  <a frame= "conv" href="#//apple_ref/occ/instm/WOSessionStore/restoreSessionWithID:request:">restoreSessionWithID:request:</a>, whichby default is forwarded to the application's WOSessionStore. TheWOSessionStore then asks the  <a frame= "conv" href="WOContext.html#WOContext">WOContext</a> of the transaction for the sessionID of the session. Based on the implementation of the WOSessionStore,the session object is located and returned.</p><p>There is one subclass of WOSessionStore implemented for thedeveloper's convenience. A <em>server</em> WOSessionStore(the default) stores session state in the server, in applicationmemory. The  <a frame= "conv" href="#//apple_ref/occ/clm/WOSessionStore/serverSessionStore">serverSessionStore</a> methodreturns this WOSessionStore.</p><p>See the chapter "Managing State" in the <em>WebObjectsDevelopers Guide</em> for the purposes, mechanisms, andlimitations of session store in the server, page, and cookies. </p><p>You can create a custom session store by making a subclassof WOSessionStore. The subclass should properly implement the  <a frame= "conv" href="#//apple_ref/occ/instm/WOSessionStore/saveSessionForContext:">saveSessionForContext:</a> and  <a frame= "conv" href="#//apple_ref/occ/instm/WOSessionStore/restoreSessionWithID:request:">restoreSessionWithID:request:</a> methods(using the session ID as the key for storage) and should have apublic method that the application object can use to obtain an instance.Some interesting session stores could be:</p><ul><li>A database session store that stores sessiondata in a database as blobs, with the session ID as the primarykey. This kind of WOSessionStore can be shared by many instancesof the same WebObjects application, thus distributing the load (requests)among the instances.</li><li>An adaptive session store that stores session state eitherin cookies or on the server, depending on what the client supports.</li></ul><p>If you create your own WOSessionStore class that generatespersistent objects, you should implement an algorithm that cleansup session state after the session is inactive for a long time.The server WOSessionStore provided by WebObjects performs this clean-upproperly, but the API is not yet public.</p><br><br><br><h2>Method Types</h2><hr><blockquote><dl><dt>Obtaining a session store</dt><dd> <a frame= "conv" href="#//apple_ref/occ/clm/WOSessionStore/serverSessionStore">+ serverSessionStore</a></dd></dl><dl><dt>Checking a session inand out</dt><dd> <a frame= "conv" href="#//apple_ref/occ/instm/WOSessionStore/checkInSessionForContext:">- checkInSessionForContext:</a></dd><dd> <a frame= "conv" href="#//apple_ref/occ/instm/WOSessionStore/checkOutSessionWithID:request:">- checkOutSessionWithID:request:</a></dd></dl><dl><dt>Saving and restoringa context</dt><dd> <a frame= "conv" href="#//apple_ref/occ/instm/WOSessionStore/restoreSessionWithID:request:">- restoreSessionWithID:request:</a></dd><dd> <a frame= "conv" href="#//apple_ref/occ/instm/WOSessionStore/saveSessionForContext:">- saveSessionForContext:</a></dd></dl></blockquote><br><br><h2>Class Methods</h2><hr><a name = "serverSessionStore"><BR><h3><a name="//apple_ref/occ/clm/WOSessionStore/serverSessionStore">serverSessionStore</a></h3></a><p><code>+ (WOSessionStore *)<b>serverSessionStore</b></code></p>Returns a WOSessionStore object that storessession state in application memory. Since this is the default storagestrategy, you do not need to explicitly set the session store duringapplication initialization if this is the strategy you want.<p>Statestorage in the server is the most secure and is the easiest to implement.You can also easily manage the amount of storage consumed by settingsession timeouts, limiting the size of the page-instance cache,and page uniquing. (See "Managing State" in the <em>WebObjectsDevelopers Guide</em> for details on these techniques.)</p><p>Youmay use WOSession's <b>initWithCoder:</b> method torestore session state from the archived data. </p><hr WIDTH=25% ALIGN=LEFT><BR><BR><h2>Instance Methods</h2><hr><a name = "checkinSessionForContext_"><BR><h3><a name="//apple_ref/occ/instm/WOSessionStore/checkInSessionForContext:">checkInSessionForContext:</a></h3></a><p><code>- (void)<b>checkInSessionForContext:</b>(WOContext*)<em>aContext</em></code></p>This method calls  <a frame= "conv" href="#//apple_ref/occ/instm/WOSessionStore/saveSessionForContext:">saveSessionForContext:</a> (implementedin the concrete subclass) to save the session referred to by <em>aContext</em> usingwhatever storage technique is supported by the receiver.  This method also"checks in" the session so that pending (and future) requestsfor the same session may procede.  This method is called by  <a frame= "conv" href="WOApplication.html#WOApplication">WOApplication</a> to save the sessioneven if the session was not previously checked out via  <a frame= "conv" href="#//apple_ref/occ/instm/WOSessionStore/checkOutSessionWithID:request:">checkOutSessionWithID:request:</a> (thatis, the session is a new session which was just created and, therefore,not restored).<hr WIDTH=25% ALIGN=LEFT><a name = "checkoutSessionWithID_request_"><BR><h3><a name="//apple_ref/occ/instm/WOSessionStore/checkOutSessionWithID:request:">checkOutSessionWithID:request:</a></h3></a><p><code>- (WOSession *)<b>checkOutSessionWithID:</b>(NSString*)<em>aSessionID</em><b>request:</b>(WORequest *)<em>aRequest</em></code></p>This method returns a session for <em>aSessionID</em> ifone is stored.  This method calls  <a frame= "conv" href="#//apple_ref/occ/instm/WOSessionStore/restoreSessionWithID:request:">restoreSessionWithID:request:</a> (implementedin the concrete subclass) to do the actual session restoration usingwhatever storage technique is supported by the receiver.  If thesession is located and restored, this method also "checks out" <em>aSessionID</em> sothat simultaneous access to the same session is precluded.  If thesession is not restored, the <em>aSessionID</em> isnot checked out.<hr WIDTH=25% ALIGN=LEFT><a name = "restoreSessionWithID_request_"><BR><h3><a name="//apple_ref/occ/instm/WOSessionStore/restoreSessionWithID:request:">restoreSessionWithID:request:</a></h3></a><p><code>- (WOSession *)<b>restoreSessionWithID:</b>(NSString*)<em>aSessionID</em><b>request:</b>(WORequest *)<em>aRequest</em></code></p>Implemented by a private concrete subclass torestore the current session object from a particular type of storage. <p>Thedefault implementation of this method does nothing</p><hr WIDTH=25% ALIGN=LEFT><a name = "saveSession_"><BR><h3><a name="//apple_ref/occ/instm/WOSessionStore/saveSessionForContext:">saveSessionForContext:</a></h3></a><p><code>- (void)<b>saveSessionForContext:</b>(WOContext*)<em>aContext</em></code></p>Implemented by a private concrete subclass tosave the current session object using a particular strategy forstate storage. The default implementation of this method does nothing.<p>Youmay use the method <b>encodeWithCoder:</b> tosave session state to archived data.</p><p></p><hr WIDTH=25% ALIGN=LEFT><BR><br><a href="../WebObjectsTOC.html"><img src="../../../../../../images/up.gif" border="0" alt="Table of Contents"></a> </BODY></HTML>