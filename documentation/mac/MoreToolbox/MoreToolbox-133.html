<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>GetScrap (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING133></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-132.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-134.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-109.html"><B>Chapter 2 - Scrap Manager</B></A> / <A HREF="MoreToolbox-122.html"><B>Scrap Manager Reference</B></A><BR><DL><DD><A HREF="MoreToolbox-126.html"><B>Routines</B></A> / <A HREF="MoreToolbox-132.html"><B>Reading Information From the Scrap</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING133-0></A>
<H3><A NAME=MARKER-2-76></A>GetScrap<A NAME=MARKER-2-25></A></H3>
 You can use the <CODE>GetScrap</CODE> function to read data of a specific format from the scrap.<P>
<PRE>
FUNCTION GetScrap (hDest: Handle; theType: ResType; 
                   VAR offset: LongInt): LongInt;
</PRE>
<DL>
<DT><CODE>hDest</CODE>
<DD> A handle to the memory location where the <CODE>GetScrap</CODE> function should place the data from the scrap. If you specify <CODE>NIL</CODE> in this parameter, the <CODE>GetScrap</CODE> function does not read in the data but does return the offset of the data in the scrap and the number of bytes of the requested scrap data type if the requested type exists in the scrap.
<DT><CODE>theType</CODE>
<DD> The scrap format type of the data to be read from the scrap.
<DT><CODE>offset</CODE>
<DD> The <CODE>GetScrap</CODE> function returns in this parameter the location of the data in the scrap. This value is expressed as an offset (in bytes) from the beginning of the scrap. If the Translation Manager is available, the value of the <CODE>offset</CODE> parameter is undefined.
</DL>
<A NAME=HEADING133-6></A>
<H5>DESCRIPTION</H5>
 The <CODE>GetScrap</CODE> function looks in the scrap for any data of the requested scrap format type and returns the first data of the requested type that it finds. The <CODE>GetScrap</CODE> function writes the data to the memory location specified by the <CODE>hDest</CODE> parameter.<P>
 The <CODE>GetScrap</CODE> function reads the data from the scrap, makes a copy of it in memory, and sets the handle specified by the <CODE>hDest</CODE> parameter to refer to this copy. The <CODE>GetScrap</CODE> function resizes the handle specified by the <CODE>hDest</CODE> parameter if necessary.<P>
 Your application can use the <CODE>GetScrap</CODE> function multiple times to read different formats of the same data from the scrap. If more than one format of the same scrap format type exists in the scrap, the <CODE>GetScrap</CODE> function returns the first occurrence of that format type that it finds. For example, if data of type <CODE>'TEXT'</CODE>, <CODE>'PICT'</CODE>, and <CODE>'TEXT'</CODE> exist on the scrap, and your application requests the data in the scrap with scrap format type <CODE>'TEXT'</CODE>, the <CODE>GetScrap</CODE> function returns the first data of type <CODE>'TEXT'</CODE> that it finds.<P>
 If your application supports more than one scrap format type, your application should attempt to read its preferred scrap format type first. If your application doesn't prefer one scrap format type over any other type, it should try reading each of the scrap format types that it supports and use the type that returns the lowest offset. The scrap <BR>format type with the lowest offset indicates that this format type was written before any of the others and therefore was preferred by the application that wrote it. <P>
<DL>
<DT><B>Note</B>
<DD>The returned value for the <CODE>offset</CODE> parameter is valid only if the Translation Manager isn't available; if the Translation Manager is available, then your application should not rely on the offset value.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 <A NAME=MARKER-2-48></A>If you request a scrap format type that isn't in the scrap and the Translation Manager is available, the Scrap Manager uses the Translation Manager to convert the data of a scrap format type that does exist in the scrap into the scrap format type requested by your application. For example, if the SurfWriter application requests data from the scrap in the <CODE>'SURF'</CODE> scrap format type, and the data in the scrap is available in the format types <CODE>'TEXT'</CODE>, <CODE>'PICT'</CODE>, and <CODE>'SDBS'</CODE>(SurfDB's private scrap format type ), the Scrap Manager uses the Translation Manager to convert any one of the scrap format types <CODE>'TEXT'</CODE>, <CODE>'PICT'</CODE>, or<CODE>'SDBS'</CODE> into the <CODE>'SURF'</CODE> scrap format type. The Translation Manager looks for a translator that can perform one of these translations. If such a translator is available (for example, a translator that can translate the <CODE>'SDBS'</CODE> scrap format type into the <CODE>'SURF'</CODE> scrap format type), the Translation Manager uses the translator to translate the data in the scrap into the requested scrap format type. If the translation is successful, the Scrap Manager returns to your application the data from the scrap in the requested scrap format type.<P>
 If your application uses TextEdit to handle text in its documents, use TextEdit routines to implement the paste operation and to copy data from the scrap to the TextEdit scrap. If your application uses the Dialog Manager to handle editable text items in your application's dialog boxes and a dialog box is the frontmost window, use the Dialog Manager procedure <CODE>DialogPaste</CODE> to copy data from the scrap to the current editable text item.<P>
 If the <CODE>GetScrap</CODE> function successfully reads the data of the requested scrap format type from the scrap, <CODE>GetScrap</CODE> returns as its function result the length (in bytes) of the data. Otherwise, <CODE>GetScrap</CODE> returns a negative function result that indicates the error. If <CODE>GetScrap</CODE> returns the constant <CODE>noTypeErr</CODE>, then the data in the scrap isn't available in the scrap format type requested by your application. If the Translation Manager is available and <CODE>GetScrap</CODE> returns the constant <CODE>noTypeErr</CODE>, this value also indicates that the Translation Manager could not find any translators to convert the data into the scrap format type requested by your application.<P>
<PRE>
CONST noTypeErr = -102;{no data of the requested scrap format type}
</PRE>
<A NAME=HEADING133-16></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 The <CODE>GetScrap</CODE> function may move or purge memory blocks in the application heap. Your application should not call this function at interrupt time.<P>
<A NAME=HEADING133-18></A>
<H5>SEE ALSO</H5>
 See <A HREF=MoreToolbox-118.html#MARKER-9-93>Listing 2-4 on page 2-21</A>, <A HREF=MoreToolbox-118.html#MARKER-9-97>Listing 2-5 on page 2-24</A>, and <A HREF=MoreToolbox-119.html#MARKER-9-116>Listing 2-7 on page 2-27</A> for examples that read data from the scrap. If your application uses a private scrap, see <A HREF=MoreToolbox-121.html#MARKER-9-134>"Handling Editing Operations in Dialog Boxes" on page 2-31</A> for information on maintaining consistency of the scrap when copying and pasting data between document windows and dialog boxes. See <I><A HREF="../Text/Text-2.html">Inside Macintosh: Text</A></I> for information on TextEdit. See <I><A HREF="../QuickDraw/QuickDraw-2.html">Inside Macintosh: Imaging with QuickDraw</A></I> for information on the QuickDraw <CODE>'PICT'</CODE> format.<A NAME=MARKER-2-34></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-132.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-134.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
