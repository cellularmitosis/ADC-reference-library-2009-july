<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>The VBL Task Record (IM: Pr)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING78></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Processes-77.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Processes-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Processes-171.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Processes-79.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html"><B>Inside Macintosh:</B></A> <A HREF="Processes-2.html"><B>Processes</B></A><BR><DD><A HREF="Processes-74.html"><B>Chapter 4 - Vertical Retrace Manager</B></A> / <A HREF="Processes-75.html"><B>About the Vertical Retrace Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING78-0></A>
<H2><A NAME=MARKER-9-51></A>The VBL Task Record</H2>
 <A NAME=MARKER-2-52></A>You install a VBL task by passing the Vertical Retrace Manager the address of a <B>VBL task record,</B> which holds information about your VBL task. This information includes the address of the procedure the Vertical Retrace Manager is to execute at interrupt time and the number of interrupts before it should next execute the task. The <CODE>VBLTask</CODE> data type defines a VBL task record.<A NAME=MARKER-2-238></A><P>
<PRE>
TYPE VBLTask = 
RECORD
   qLink:    QElemPtr;   {next entry in vertical retrace queue}
   qType:    Integer;    {queue type}
   vblAddr:  ProcPtr;    {pointer to task procedure}
   vblCount: Integer;    {interrupts until next execution}
   vblPhase: Integer;    {task phase}
END;
</PRE>
 Your application needs to fill in only the <CODE>qType<DFN>, vblAddr, vblCount, and vblPhase fields of the VBL task record. The qLink field, </DFN></CODE>which contains a pointer to the next entry in the VBL task's vertical retrace queue, is set by the Vertical Retrace Manager when you install the task by calling <CODE>VInstall</CODE> or <CODE>SlotVInstall<DFN>. Your application does not need to set up the qLink field.<A NAME=MARKER-2-192></A></DFN></CODE><P>
 The Vertical Retrace Manager installs your VBL task record into the appropriate VBL queue. A vertical retrace queue is a standard operating-system queue.<P>
<DL>
<DT><B>Note</B>
<DD>For more information about the structure of operating-system queues, see the chapter "Queue Utilities" in <I><A HREF="../OSUtilities/OSUtilities-2.html">Inside Macintosh: Operating System Utilities</A></I>.<B></B>  <B>&#183;</B>
</DL>
 You must set the <CODE>qType</CODE> field to <CODE>ORD(vType)</CODE> before you install the task. This specifies that the task's queue is a vertical retrace queue and not some other type of operating-system queue.<DFN><A NAME=MARKER-9-135></A><A NAME=MARKER-2-56></A></DFN><P>
 The <CODE>vblAddr</CODE> field holds a pointer to the procedure that the Vertical Retrace Manager is to execute.<DFN></DFN><P>
 When installing a VBL task, you specify, in the <CODE>vblCount</CODE> field, the number of interrupts before the routine first executes. The Vertical Retrace Manager lowers this number by 1 during each interrupt. If decrementing <CODE>vblCount</CODE> produces a value of 0, the Vertical Retrace Manager executes the procedure specified in the task record's <CODE>vblAddr</CODE> field. If you want the procedure to be executed again, that procedure is responsible for resetting the value of the <CODE>vblCount</CODE> field to the desired value.<P>
 If you do not want the Vertical Retrace Manager to execute the task again, your task should leave the value of <CODE>vblCount</CODE> at 0. Setting the <CODE>vblCount</CODE> field to 0 is one way of disabling a task. (A more common approach is to remove the task record from its queue by calling <CODE>VRemove</CODE> or <CODE>SlotVRemove</CODE>, but this should not be done by the VBL task itself.) Note that if you set <CODE>vblCount</CODE> to 0 when installing a VBL task, the task will never execute. If you want a task to execute immediately upon installation, set <CODE>vblCount</CODE> to 1.<DFN><A NAME=MARKER-2-67></A></DFN><A NAME=MARKER-2-60></A><P>
 The <CODE>vblPhase</CODE> field specifies the task's phase count, indicating which interrupts are to trigger the execution of the VBL task. You can set two VBL tasks installed at the same time and scheduled for execution after the same number of interrupts out of phase with one another--that is, executed during different interrupts--by specifying different phase counts for each task. Unless you add many tasks to a VBL queue at one time, you can usually set <CODE>vblPhase</CODE> to 0.<DFN><A NAME=MARKER-2-104></A></DFN><P>
</BLOCKQUOTE><P>
<HR>
<center>
<A HREF="Processes-77.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Processes-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Processes-171.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Processes-79.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Processes-3.html">&copy; Apple Computer, Inc.</A><br>17 JUN 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
