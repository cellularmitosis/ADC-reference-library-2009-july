<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Java 1.3.1 Development for Mac OS X (Legacy): Using Native Features of Mac OS X in Java Applications</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Using Native Features of Mac OS X in Java Applications"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	<meta name="ROBOTS" content="NOINDEX"/>
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30000709" title="Using Native Features of Mac OS X in Java Applications"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../LegacyTechnologies/index.html#//apple_ref/doc/uid/TP30000440-TP30000470" target="_top">Legacy Documents</a> &gt; <a href="../../../../LegacyTechnologies/Java-date.html#//apple_ref/doc/uid/TP30000440-TP30000470-TP30000528" target="_top">Java</a> &gt; <a href="../about/about.html#//apple_ref/doc/uid/TP30000704-DontLinkElementID_24">Java 1.3.1 Development for Mac OS X (Legacy)</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../x_platform/x_platform.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../PBTutotial/PBTutorial.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        <script type="text/javascript" language="JavaScript">placeWatermark()</script>
<div id="legacyOuterWrapper"><div align="center" id="watermark">
<div class="legacybox">
<h1>Legacy Document<span class="closebutton"><a href="javascript:closeWatermark()"><img src="../../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>
        <a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_83" title="Using Native Features of Mac OS X in Java Applications"></a><h1><a name="//apple_ref/doc/uid/TP30000709-TPXREF101" title="Using Native Features of Mac OS X in Java Applications"></a>Using Native Features of Mac OS X in Java Applications</h1><p>If you are targeting a Java application for Mac OS X deployment, this chapter offers a collection of things you might need to know to help your application perform the best it can in Mac OS X.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="value_add.html#//apple_ref/doc/uid/TP30000709-TPXREF120">Modifying the Default Settings for Hardware Graphics Acceleration</a>
				
			<br/>
			
        
			
			
				<a href="value_add.html#//apple_ref/doc/uid/TP30000709-TPXREF123">Specifying a Name and Icon for Command-Line Applications</a>
				
			<br/>
			
        
			
			
				<a href="value_add.html#//apple_ref/doc/uid/TP30000709-TPXREF108">Using the Macintosh Menu Bar</a>
				
			<br/>
			
        
			
			
				<a href="value_add.html#//apple_ref/doc/uid/TP30000709-TPXREF112">More MRJ Handlers</a>
				
			<br/>
			
        
			
			
				<a href="value_add.html#//apple_ref/doc/uid/TP30000709-TPXREF113">Localizing Packaged Java applications on Mac OS X</a>
				
			<br/>
			
        
			
			
				<a href="value_add.html#//apple_ref/doc/uid/TP30000709-TPXREF125">QuickTime for Java</a>
				
			<br/>
			
        
			
			
				<a href="value_add.html#//apple_ref/doc/uid/TP30000709-TPXREF126">Java Core Audio Packages</a>
				
			<br/>
			
        
			
			
				<a href="value_add.html#//apple_ref/doc/uid/TP30000709-TPXREF127">Java Spelling and Speech Frameworks</a>
				
			<br/>
			
        
			
			
				<a href="value_add.html#//apple_ref/doc/uid/TP30000709-TPXREF119">JDirect</a>
				
			<br/>
			
        
			
			
				<a href="value_add.html#//apple_ref/doc/uid/TP30000709-TPXREF133">Embedding Applets in Native Applications</a>
				
			<br/>
			
        
			
			
				<a href="value_add.html#//apple_ref/doc/uid/TP30000709-TPXREF128">Cocoa Java</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP30000709-TPXREF120" title="Modifying the Default Settings for Hardware Graphics Acceleration"></a><h2>Modifying the Default Settings for Hardware Graphics Acceleration</h2><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_246"></a><p>When your Swing applications start up, the Java implementation in Mac OS X determines which video card is installed in your system and compares this against a list of known unsupported video cards. If your card does not appear in, or is commented out of this list, then hardware graphics acceleration is invoked. If you do nothing at all, your Java applications take advantage of hardware acceleration if that computer has a compatible video card. You may find in testing your application in Mac OS X that you do not want hardware acceleration on or you might find certain video cards that you wish to turn off hardware acceleration for. If these cards are not ones that Apple automatically turns off hardware acceleration for, you need to explicitly turn them off with the <code>com.apple.hwaccelexclude</code> property using the naming conventions described in <span class="content_text"><a href="value_add.html#//apple_ref/doc/uid/TP30000709-TPXREF122">“Video Cards Designation Strings.”</a></span> For example, to turn off hardware acceleration on just the ATI Radeon 8500 but leave it on for all other cards, you could use the following command in Terminal:</p><div class="codesample"><table><tr><td scope="row"><pre>java -Dcom.apple.hwaccel=true -Dcom.apple.hwaccelexclude=ATIRadeon8500_67108864 -jar App.jar<span></span></pre></td></tr></table></div><p>By using the <code>com.apple.hwaccelexclude</code> property, you have complete control of which cards are ignored. If you choose to turn off hardware acceleration for any specific cards, make sure that you also turn it off for those that are uncommented by default in the <code>hwexcludelist.properties</code> file as well. Otherwise you will turn it off for the video card you are concerned with, but it will be on with cards that Apple initially had it turned off for.</p><p>Taking this into account, a better example of turning off hardware acceleration for the ATI Radeon 8500 would also turn it off for the 8 MB ATI Rage 128 card in the first generation iBooks and Titanium PowerBooks:</p><div class="codesample"><table><tr><td scope="row"><pre>java -Dcom.apple.hwaccel=true -Dcom.apple.hwaccelexclude=ATIRadeon8500_67108864,ATIRage128_8388608 -jar App.jar<span></span></pre></td></tr></table></div><p>The<code> com.apple.hwaccel=true</code> is not necessary in Mac OS X  version 10.2, but it is suggested that you use it along with the -Dcom.apple.hwaccelexclude flag. </p><p> To turn off hardware acceleration completely, pass in the command-line flag <code>com.apple.hwaccel=false</code>. For example:</p><div class="codesample"><table><tr><td scope="row"><pre>java -Dcom.apple.hwaccel=false -jar App.jar<span></span></pre></td></tr></table></div><p> To turn on hardware acceleration for all video cards, pass in the command-line flag <code>com.apple.hwaccelexclude</code> with no arguments as follows:</p><div class="codesample"><table><tr><td scope="row"><pre>java -Dcom.apple.hwaccel=true -Dcom.apple.hwaccelexclude= -jar App.jar<span></span></pre></td></tr></table></div><p>You may incorporate any of these command-line options into your Mac OS X applications bundles using MRJAppBuilder or Project Builder.</p><a name="//apple_ref/doc/uid/TP30000709-TPXREF121" title="Advanced Options"></a><h3>Advanced Options</h3><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_247"></a><p>While testing your Java applications, you may want to see what effect Mac OS X’s Java hardware graphics acceleration has on your code without having to restart your application each time you make a change. By passing in the system property <code>com.apple.usedebugkeys=true</code> and you can use function keys combinations to turn hardware acceleration on and off. There are two sets of key combinations you can use:</p><ul class="spaceabove"><li class="li"><p>Command-F7 to turn on hardware acceleration gracefully. This is equivalent to the default behavior except that you may toggle it on and off while the application is running. Option-F7 turns it off.</p></li><li class="li"><p>Command-F8 forces hardware acceleration on. This differs from Command-F7 in that it forces everything to be hardware acceleration without applying any of the logic that Command-F7 would use. This is for testing only, and you may see unpredictable results. Option-F8 turns it off.</p></li></ul><div class="notebox"><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_84" title="Note"></a><p><strong>Note:</strong>&nbsp;Once you have forced hardware acceleration on with Command-F8, you cannot use Command-F7 to turn it on without restarting your application.</p></div><p>The <code>com.apple.forcehwaccel</code> runtime property allows you to force hardware acceleration on or off without looking at the list of suggested video cards. This is similar to using Command-F8 with <code>com.apple.usedebugkeys</code> as noted above except that with <code>com.apple.forcehwaccel</code>, the state is explicitly determined at runtime. Available values are <code>true</code> and <code>false</code>.</p><p>Another runtime property, <code>com.apple.hwaccelnogrowbox</code>, is provided so that you can determine if hardware acceleration is on or off just by looking at a window. By setting this to <code>true</code>, the grow box (called a resize control in Aqua) normally found in the bottom right corner is not displayed if hardware acceleration is on. It will be visible if hardware acceleration is not on. Setting this to <code>false</code>, gives you the default behavior that shows the grow box regardless of whether hardware acceleration is on or off.<a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_248"></a></p><a name="//apple_ref/doc/uid/TP30000709-TPXREF122" title="Video Cards Designation Strings "></a><h3>Video Cards Designation Strings </h3><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_249"></a><p>Java hardware graphics acceleration is supported on most of the default video cards in Apple computers, provided they have 16 MB or more of on-card video memory. For the purpose of Java graphics hardware acceleration, each of these cards has been assigned a distinct identifying string. There are a few ways of determining these strings:</p><ul class="spaceabove"><li class="li"><p>If you are unsure of the type of video card in a computer, use the <code>hwaccel_info_tool</code> available online at <span class="content_text"><a href="http://connect.apple.com" target="_blank">http://connect.apple.com</a></span>. Instructions on using this command-line tool are provided in a man page installed with the tool.</p></li><li class="li"><p>If you know what type of video card is in your computer, you can determine the appropriate string by looking in the <code>hwaccelexclude.properties</code> file in <code>/System/Library/Frameworks/JavaVM.framework/Versions/1.3.1/Home/lib</code> or by using<span class="content_text"><a href="value_add.html#//apple_ref/doc/uid/TP30000709-TPXREF124">Table 6-1</a></span><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_250"></a>.</p></li></ul><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_85" title="Table 6-1Video-card designation strings "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/TP30000709-TPXREF124" title="Table 6-1Video-card designation strings "></a><strong>Table 6-1&nbsp;&nbsp;</strong>Video-card designation strings </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Video card model</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Memory</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>String</p></th></tr><tr><td  scope="row"><p>ATI Rage Mobility 128</p></td><td ><p>8 MB</p></td><td ><p><code>ATIRage128_8388608</code></p></td></tr><tr><td  scope="row"><p>ATI Rage 128</p></td><td ><p>16 MB</p></td><td ><p><code>ATIRage128_16777216</code></p></td></tr><tr><td  scope="row"><p>ATI Radeon</p></td><td ><p>16 MB</p></td><td ><p><code>ATIRadeon_16777216</code></p></td></tr><tr><td  scope="row"><p>ATI Rage 128</p></td><td ><p>32 MB</p></td><td ><p><code>ATIRage128_33554432</code></p></td></tr><tr><td  scope="row"><p>ATI Radeon 7500</p></td><td ><p>32 MB</p></td><td ><p><code>ATIRadeon_33554432</code></p></td></tr><tr><td  scope="row"><p>ATI Radeon 8500</p></td><td ><p>32 MB</p></td><td ><p><code>ATIRadeon8500_67108864</code></p></td></tr><tr><td  scope="row"><p>NVidia GeForce2</p></td><td ><p>32 MB</p></td><td ><p><code>NVidia11_33554432</code></p></td></tr><tr><td  scope="row"><p>NVidia GeForce3</p></td><td ><p>64 MB</p></td><td ><p><code>NVidia20_67108864</code></p></td></tr><tr><td  scope="row"><p>NVidia GeForce4MX</p></td><td ><p>64 MB</p></td><td ><p><code>NVidia11_67108864</code></p></td></tr><tr><td  scope="row"><p>NVidia GeForce4TNT</p></td><td ><p>64 MB</p></td><td ><p><code>NVidia20_134217728</code></p></td></tr></table></div><a name="//apple_ref/doc/uid/TP30000709-TPXREF123" title="Specifying a Name and Icon for Command-Line Applications"></a><h2>Specifying a Name and Icon for Command-Line Applications</h2><p>By default, Java processes that are launched from a shell do not show up in the Dock or the menu bar until they show a window. If they never show a window, they never appear in the Dock. This allows server-type processes to run behind the scenes with no user-visible manifestation.</p><p>If you are running an application from the command line that opens a window, the class name of the application’s main class appears as the application name in the Dock and application menu. You may specify a more appropriate name to display by using this command-line option:</p><p><code>-Xdock:name=</code><em>applicationName</em></p><p>You can also specify an icon to replace the generic Java icon with this option:</p><p><code>-Xdock:icon=</code><em>pathToIconFile</em><code></code></p><p>The icon file must be a Mac OS X icon file—the same type you would use for any other Mac OS X application. If either the application name or path to the icon file has spaces in it, wrap it in double quotes.</p><a name="//apple_ref/doc/uid/TP30000709-TPXREF108" title="Using the Macintosh Menu Bar"></a><h2>Using the Macintosh Menu Bar</h2><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_251"></a><p><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_252"></a>In Swing, an application’s menu bar is applied on a per-frame (window) basis. Similar to the Windows model, the menu bar appears directly under the frame’s title bar. This is different from the Macintosh model, where the application has a single menu bar that controls all of the application's windows. To solve the basic problem, a runtime property is provided:</p><div class="codesample"><table><tr><td scope="row"><pre>com.apple.macos.useScreenMenuBar<span></span></pre></td></tr></table></div><p>This property can have a value of <code>true</code> or <code>false</code>. If undefined, the standard Java behavior equivalent to a value of <code>false</code> is used. When read by the Java runtime at application startup, a given JFrame’s JMenuBar is placed at the top of the screen, where a Macintosh user would expect it to be. Since this is a simple runtime property that must be used by the host VM, setting it in your application has no effect on other platforms since they do not even check for it.</p><p>Note that a JMenuBar attached to a JDialog does not appear at the top of the screen as expected when setting this property, but rather inside the dialog as if the property were not set. If your JDialog does not have a menu bar, the default parent JFrame’s menu bar is displayed when the JDialog is brought into focus.</p><p>If you find the need to attach menus to a dialog window, you may want to consider making the window a JFrame instead of a JDialog. A dialog should be informational or present the user with a simple decision, not provide complex choices. A window with enough functionality to necessitate a menu bar may be better as a JFrame. </p><p>Unfortunately, this solves only part of the problem—the placement of the menu bar. The fundamental discrepancy between the idea of a single menu bar per application of the Macintosh and a menu bar per window of Java, still exists. In other words, setting this property causes the menu to appear at the top of the screen, but only when the specific window it was assigned to is in focus. If your application has multiple windows, and a window other than the one holding the menu bar is focused, the menu bar vanishes. The Aqua guidelines state that the menu bar should always be visible in an application; even an insignificant window such as an alert dialog should still show the menu bar (though you may want to disable the menus).</p><a name="//apple_ref/doc/uid/TP30000709-TPXREF109" title="The Window Menu"></a><h3>The Window Menu</h3><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_253"></a><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_254"></a><p>One of the suggestions in <em>Inside Mac OS X: Aqua Human Interface Guidelines</em> is that all Mac OS X applications should provide a Window menu to keep track of all currently open windows. A Window menu should contain a list of currently active (visible) windows, with the corresponding menu item checked if a given window is currently in the foreground. Likewise, selection of a given Window menu item should result in the corresponding window being brought to the front. New windows should be added to the menu, and closed windows should be removed. The ordering of the menu items is typically the order in which the windows appeared. <em>Inside Mac OS X: Aqua Human Interface Guidelines</em> has more specific guidance on the Window menu.<a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_255"></a><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_256"></a></p><a name="//apple_ref/doc/uid/TP30000709-TPXREF110" title="The Application Menu"></a><h3>The Application Menu</h3><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_257"></a><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_258"></a><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_259"></a><p>Any Java application that uses AWT/Swing, or is packaged in a double-clickable application bundle, is automatically launched with an application menu similar to native applications on Mac OS X. This application menu, by default, contains the full name of the main class as the title. This name can be changed using the <code>com.apple.mrj.application.apple.menu.about.name</code> application property or the<code> -Xdock:name</code> command-line property. According to the Aqua guidelines, the name you specify for the application menu should be no longer than 16 characters. <span class="content_text"><a href="value_add.html#//apple_ref/doc/uid/TP30000709-TPXREF115">Figure 6-1</a></span> shows an application menu.</p><br/><div><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_86" title="Figure 6-1Application menu for a Java application in Mac OS X"></a><p><a name="//apple_ref/doc/uid/TP30000709-TPXREF115" title="Figure 6-1Application menu for a Java application in Mac OS X"></a><strong>Figure 6-1&nbsp;&nbsp;</strong>Application menu for a Java application in Mac OS X</p><img src = "../art/application_menu.gif" alt = "Application menu for a Java application in Mac OS X" width="215" height="176"></div><br/><p>The next step to customizing your application menu is to have your own handling code called when an item in the application menu is chosen. Apple has provided a means for this through interfaces in the <code>com.apple.mrj</code> package. Each interface has a special callback method that is called when the appropriate application menu item is chosen. The following callback interfaces for the application menu are available: </p><ul class="spaceabove"><li class="li"><p>com.apple.MRJAboutHandler<a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_260"></a>, to handle the About menu item.</p></li><li class="li"><p>com.apple.MRJPrefsHandler<a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_261"></a>, to handle the Preferences menu item.</p></li><li class="li"><p>com.apple.MRJQuitHandler<a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_262"></a>, to trigger final clean-up logic when the Quit menu item is chosen. By default, that Quit menu item just calls <code>System.exit</code>. You might actually want to do more than just exit.</p></li></ul><p>To handle a given application menu item:</p><ol class="ol"><li class="li"><p>Implement the appropriate handler interface.</p></li><li class="li"><p>Define the appropriate <code>handler</code> method in your implementation: <code>handleAbout</code>, <code>handlePrefs</code>, or <code>handleQuit</code>.</p></li><li class="li"><p>Register your handler using the appropriate static methods in the <code>com.apple.mrj.MRJApplicationUtils</code> class: either <code>registerAboutHandler</code>, <code>registerPrefsHandler</code>, or <code>registerQuitHandler</code>.</p></li></ol><p>You can see examples of these implementations in a default Swing application project in Project Builder.</p><p>If your application is to be deployed on other platforms, where Preferences, Quit, and About are accessed elsewhere on the menu bar (in a File or Edit menu, for example), you may want to make this placement conditional based on the operating system of the host platform. This is preferable to just adding a second instance of each of these menu items for Mac OS X. This minor modification can go a long way to making your Java application feel more like a native application on Mac OS X.<a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_263"></a><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_264"></a><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_265"></a><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_266"></a></p><a name="//apple_ref/doc/uid/TP30000709-TPXREF112" title="More MRJ Handlers"></a><h2>More MRJ Handlers</h2><p>In addition to the interfaces provided for handling application menu items, Java on Mac OS X provides two other handlers: </p><ul class="ul"><li class="li"><p>com.apple.MRJOpenApplicationHandler<a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_267"></a>, which lets you respond to an Open Application Apple event. </p></li><li class="li"><p>com.apple.MRJOpenDocumentHandler<a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_268"></a>, that responds to double-clicking a supported document or the dragging of a document onto your application’s icon.</p></li></ul><p>These handler interfaces are intended to enhance a Java application’s behavior in the Mac OS X Finder and are used in the same manner as the application menu interfaces described above.<a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_269"></a></p><a name="//apple_ref/doc/uid/TP30000709-TPXREF113" title="Localizing Packaged Java applications on Mac OS X"></a><h2>Localizing Packaged Java applications on Mac OS X</h2><p>To run correctly in non-English locales, Java applications bundles need to have the appropriate localized folders inside the application package. This is true even if the Java application handles its localization through Java <code>ResourceBundles</code>. Specifically, you need to have a folder named with the locale name and the <code>.lproj</code> suffix present in the application’s <code>Resources</code> folder for any locale that you wish to use. For example, you need a <code>Japanese.lproj</code> folder inside <code>YourApplication.pkg/Contents/Resources/</code> in order for Japanese localization to work correctly. The folder itself can be empty, but it must be present for Mac OS X to set the locale correctly when the application launches. Otherwise Mac OS X launches your application with the English US locale.</p><p>The Bundle Services documentation and <em>Inside Mac OS X: System Overview</em>, both available from <span class="content_text"><a href="http://developer.apple.com/documentation" target="_top">http://developer.apple.com/documentation</a></span>, provide more details about the application bundle format.</p><a name="//apple_ref/doc/uid/TP30000709-TPXREF125" title="QuickTime for Java"></a><h2>QuickTime for Java</h2><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_270"></a><p>QuickTime for Java provides a cross-platform API that allows Java developers to build multimedia components, including streaming audio and video, into applications and applets for both Macintosh and Windows. More information on QuickTime for Java is available online at <span class="content_text"><a href="http://developer.apple.com/quicktime/qtjava/" target="_top">http://developer.apple.com/quicktime/qtjava/</a></span>. </p><a name="//apple_ref/doc/uid/TP30000709-TPXREF126" title="Java Core Audio Packages"></a><h2>Java Core Audio Packages</h2><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_271"></a><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_272"></a><p>Mac OS X includes a very robust sound subsystem. Hooks for using this system directly from Java are provided in the Java Core Audio packages. More information on the Mac OS X Core Audio framework can be found online at <span class="content_text"><a href="http://developer.apple.com/audio" target="_top">http://developer.apple.com/audio</a></span>.</p><a name="//apple_ref/doc/uid/TP30000709-TPXREF127" title="Java Spelling and Speech Frameworks "></a><h2>Java Spelling and Speech Frameworks </h2><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_273"></a><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_274"></a><p>Two very useful frameworks, Spelling and Speech, are also available for you to use in Mac OS X. These are implemented as Java Beans. The source code, examples, and documentation are available at <span class="content_text"><a href="http://developer.apple.com/java" target="_top">http://developer.apple.com/java</a></span>.</p><a name="//apple_ref/doc/uid/TP30000709-TPXREF119" title="JDirect"></a><h2>JDirect</h2><p><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_275"></a>In addition to the standard Java Native Interface, Mac OS X also includes JDirect3. JDirect3 allows access to preexisting native code libraries from Java without you needing to explicitly use JNI. It builds JNI stubs for you on the fly.</p><p>JDirect3 is not a standard part of J2SE, and it is important to keep in mind that it ties your code to Mac OS X. JDirect3 is not recommended for future new development since changes in future releases of Mac OS X will yield your code unusable. </p><p> JDirect1, which has been deprecated since 1997, is not supported in Mac OS X. If you have JDirect2 code, it requires minor modifications to run under JDirect3. If you are porting old JDirect2 code to JDirect3, there are a few important details to keep in mind as the following sections discuss.</p><a name="//apple_ref/doc/uid/TP30000709-TPXREF129" title="Human Interface Toolbox Synchronization"></a><h3>Human Interface Toolbox Synchronization</h3><p><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_276"></a>You must synchronize all Human Interface Toolbox calls. Since Java threads are native Mach threads and can preempt Toolbox calls made by the host application or by other Java threads otherwise. The Java implementation itself is based on the Carbon threading model in Mac OS X. This threading model is neither reentrant or thread-safe. Since reentrant calls can corrupt memory or crash your application, it is important that only one thread be inside Carbon at any time.</p><p> This is the correct way to call the Toolbox from Java on Mac OS X:</p><div class="codesample"><table><tr><td scope="row"><pre>import com.apple.mrj.macos.carbon.CarbonLock;<span></span></pre></td></tr><tr><td scope="row"><pre>try {<span></span></pre></td></tr><tr><td scope="row"><pre>    CarbonLock.acquire();<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>//Carbon call here<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>} finally {<span></span></pre></td></tr><tr><td scope="row"><pre>    CarbonLock.release();<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>This way the Carbon lock handling can easily be reversed for JDirect callbacks.</p><p>Be sure to use <code>CarbonLock</code> around all Carbon calls. Since threads are preemptive on Mac OS X, you should hold the Carbon lock for the shortest amount of time possible.</p><p>Make sure not to do anything that might throw an exception in the <code>finally</code> block that calls<code> CarbonLock.release</code>. Structure your code so that the Carbon locking is separate from other finally blocks.<a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_277"></a></p><a name="//apple_ref/doc/uid/TP30000709-TPXREF130" title="Debugging Features for JDirect "></a><h3>Debugging Features for JDirect </h3><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_278"></a><p>To help debug JDirect on Mac OS X, you can define a shell variable, <code>JDIRECT_VERBOSE</code> to write verbose JDirect loading info to <code>stderr</code>. This works only when launching Java code from the command line, not when double-clicking a bundled application in the Finder. You can launch any double-clickable application from the command line by specifying the path to the application’s executable.</p><p>For example, to set the shell variable, and then launch an application called Foo.app, you would do the following in <code>csh</code>:</p><p><code>setenv JDIRECT_VERBOSE</code></p><p><code>/path/Foo.app/Contents/MacOS/Foo</code></p><a name="//apple_ref/doc/uid/TP30000709-TPXREF131" title="MethodClosureUPP Not Supported"></a><h3>MethodClosureUPP Not Supported</h3><p>The class <code>MethodClosureUPP</code> was created for use in Mac OS 9 and is not supported in Mac OS X. If you are using Carbon callbacks and want code that can run in Mac OS 9 and Mac OS X, you need to have a helper class that creates a new <code>MethodClosureUPP</code> when in Mac OS 9 or a new <code>MethodClosure </code>when in Mac OS X.</p><a name="//apple_ref/doc/uid/TP30000709-TPXREF132" title="JDirect Access to Bundles"></a><h3>JDirect Access to Bundles</h3><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_279"></a><p>Normally, your <code>JDirect_MacOSX</code> string is a full path to a dylib, which is the standard packaging for shared Mach-O binaries in Mac OS X. You can also specify a full path to a bundle. The bundle path name must end in <code>.bundle</code> and be a properly constructed directory. A bundle can use both Mach-O binaries and CFM binaries. The Bundle Services documentation in <em>Inside Mac OS X: System Overview</em> has more details.<a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_280"></a></p><a name="//apple_ref/doc/uid/TP30000709-TPXREF133" title="Embedding Applets in Native Applications"></a><h2>Embedding Applets in Native Applications</h2><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_281"></a><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_282"></a><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_283"></a><p>If you are a Mac OS X developer that needs to embed Java applets inside of your native application, use the <a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_284"></a>Java Applet Plug-in (<code>Java Applet.plugin</code>) architecture of Mac OS X. In previous versions of Mac OS X, you might have used Java Embedding framework. Though this framework still works, it is not recommended for future development. It may change significantly in future versions of Java on Mac OS X.</p><p>As illustrated in <span class="content_text"><a href="value_add.html#//apple_ref/doc/uid/TP30000709-BAJEAGJG">Figure 6-2</a></span>, using the Java Applet Plug-in architecture will allow applets displayed in you application to take full advantage of Sun’s Java Plug-in; the Java Embedding framework provides only a subset of that functionality. The Java Applet Plug-in therefore provides both developmental benefits for developers as well as an enhanced user experience for applets displayed in your application. </p><br/><div><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_87" title="Figure 6-2Java Applet Plug-in versus Java Embedding Framework"></a><p><a name="//apple_ref/doc/uid/TP30000709-BAJEAGJG" title="Figure 6-2Java Applet Plug-in versus Java Embedding Framework"></a><strong>Figure 6-2&nbsp;&nbsp;</strong>Java Applet Plug-in versus Java Embedding Framework</p><img src = "../art/embeddingsuggestions_line.gif" alt = "Java Applet Plug-in versus Java Embedding Framework" width="386" height="239"></div><br/><p>The Java Applet Plug-in architecture allows your native code access to Sun’s Java Plug-in which in turn lets you access a virtual machine. Since it is a standard Netscape 4.0 style plug-in, you may also use it to provide Java support inside native applications. <code>Java Applet.plugin</code> is a native Mach-O library. It is a standard Mac OS X bundle. It exports the same symbols that the UNIX Netscape plug-in exports. Complete details on integrating a Netscape-style plug-in is beyond the scope of this document. <a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_285"></a><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_286"></a><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_287"></a><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_288"></a>. </p><a name="//apple_ref/doc/uid/TP30000709-TPXREF128" title="Cocoa Java"></a><h2>Cocoa Java</h2><a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_289"></a><p>In Mac OS X, Cocoa applications can be written in Java as well as their native Objective-C. Cocoa Java applications will behave just like a native applications but will not be portable to other platforms.</p><p>If you are using Cocoa Java for your user interface, it is important that you do not try to mix Cocoa Java with standard Java components. Since many of these components are Carbon-based, you will run into many problems. In particular, you should avoid trying to mix the following with Cocoa Java:<a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_290"></a></p><ul class="ul"><li class="li"><p>Swing/AWT components, including Java events</p></li><li class="li"><p>QuickTime for Java components</p></li><li class="li"><p>JDirect calls</p></li></ul><p>The main reason for this is that Carbon and Cocoa use different run loops, which conflict with one another if mixed in the same application.</p><p>More information on Cocoa Java is available at <span class="content_text"><a href="../../../../../documentation/cocoa" target="_top">http://developer.apple.com/documentation/cocoa</a></span>.<a name="//apple_ref/doc/uid/TP30000709-DontLinkElementID_291"></a></p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../x_platform/x_platform.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../PBTutotial/PBTutorial.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2002 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2002-09-01<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Java/Conceptual/Java131Development/value_add/value_add.html%3Fid%3DTP40000885-2.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Java/Conceptual/Java131Development/value_add/value_add.html%3Fid%3DTP40000885-2.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Java/Conceptual/Java131Development/value_add/value_add.html%3Fid%3DTP40000885-2.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>