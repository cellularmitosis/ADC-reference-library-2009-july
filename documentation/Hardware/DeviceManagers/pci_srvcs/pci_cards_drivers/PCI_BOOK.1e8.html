<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE> SetHardwareCursor (csCode = 22)13</TITLE></HEAD><BODY BGCOLOR="#ffffff"><DIV><a name="top"></a><!-- start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!-- start of path --><font face="Geneva,Helvetica,Arial" size="1"><b><br>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Documentation</a> &gt; <!-- a href="" target="_top" -->Hardware<!-- /a -->  <b>&gt; </b><a href="../../devicemgrs.html" target="_top">Device Managers and Drivers</a> <b>&gt; </b><a href="../pci_srvcs.html" target="_top">PCI Card Services</a> <b>&gt; </b>Designing PCI Cards and Drivers for Power Macintosh Computers</font><br><br><!-- end of path --><A HREF="PCI_BOOK.1dd.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.1e7.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.1e9.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><HR></DIV><H1 CLASS="RoH.RoutineHeading"><A NAME="pgfId=3555"> </A><A NAME="39570"> </A>SetHardwareCursor (csCode = 22)</H1><P CLASS="T1.Text1"><A NAME="pgfId=3556"> </A><TT CLASS="cv">SetHardwareCursor</TT> is a required routine for drivers that support hardware cursors. QuickDraw uses the <TT CLASS="cv">SetHardwareCursor</TT> control call to set up the hardware cursor and determine whether the hardware can support it. The driver must determine whether it can support the given cursor and, if so, program the hardware cursor frame buffer (or equivalent), set up the CLUT, and return <TT CLASS="cv">noErr</TT>. If the driver cannot support the cursor it must return <TT CLASS="cv">controlErr</TT>. The driver must remember whether this call was successful for subsequent <TT CLASS="cv">GetHardwareCursorDrawState</TT> or <TT CLASS="cv">DrawHardwareCursor</TT> calls, but should not change the cursor's x or y coordinates or its visible state.</P><CODE CLASS="RD.RoutineDeclare"><A NAME="pgfId=15808"> </A>OSErr = Control (theDeviceRefNum, cscSetHardwareCursor,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;theVDSetHardwareCursorRec);</CODE><DL COMPACT><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=15810"> </A><TT CLASS="cv">--&gt; csCursorRef</TT></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=3558"> </A><EM CLASS="BodyText"> Reference to cursor data</EM></DD></DL COMPACT><P CLASS="T1.Text1"><A NAME="pgfId=3559"> </A>The driver should call the VSL routine <A HREF="PCI_BOOK.216.html#42530" CLASS="XRef"><TT CLASS="cv">VSLPrepareCursorForHardwareCursor</TT></A> with <TT CLASS="cv">csCursorRef</TT> and the appropriate hardware cursor descriptor. This routine will do all the necessary conversion for the cursor passed in <TT CLASS="cv">csCursorRef</TT> to match the hardware described in the hardware cursor descriptor. If the cursor passed in <TT CLASS="cv">csCursorRef</TT> is compatible with the hardware cursor descriptor, the VSL call will return <TT CLASS="cv">true</TT>; otherwise, it will return <TT CLASS="cv">false</TT>. It will also pass back a cursor image at the appropriate bit depth and pixel format for the hardware and a <TT CLASS="cv">CTabPtr</TT> color table that specifies the colors for the cursor.</P><P CLASS="T1.Text1"><A NAME="pgfId=3563"> </A>The driver should be able to copy the cursor image passed back from <TT CLASS="cv">VSLPrepareCursorForHardwareCursor</TT> directly into its hardware cursor frame buffer (or equivalent) and program its CLUT, using the color table in a fashion similar to the <TT CLASS="cv">SetEntries</TT> control call. As in the <TT CLASS="cv">SetEntries</TT> control call, the driver must apply any gamma correction to the color table.</P><P CLASS="T1.Text1"><A NAME="pgfId=3564"> </A>If a driver's hardware can support multiple hardware cursor formats, the driver can make multiple calls to <TT CLASS="cv">VSLPrepareCursorForHardwareCursor</TT> with different hardware cursor descriptors until the call succeeds or all hardware cursor formats are exhausted.</P><P CLASS="T1.Text1"><A NAME="pgfId=3565"> </A>If the driver must access the cursor data structure passed in <TT CLASS="cv">csCursorRef</TT>, it can typecast it to a <TT CLASS="cv">CursorImageRec</TT> defined in <TT CLASS="cv">Quickdraw.h</TT>. However, the format of the cursor passed in with <TT CLASS="cv">csCursorRef</TT> is subject to change in future releases of Mac&nbsp;OS; it is recommended that <TT CLASS="cv">VSLPrepareCursorForHardwareCursor</TT> be used because it will be kept up to date with the format of <TT CLASS="cv">csCursorRef</TT>.</P><HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 26 March 99)<P><A HREF="PCI_BOOK.1dd.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.1e7.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.1e9.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></HTML>