<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Core Data Programming Guide: Troubleshooting Core Data</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Troubleshooting Core Data"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40002320" title="Troubleshooting Core Data"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../DesignGuidelines-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000556" target="_top">Design Guidelines</a> &gt; <a href="../index.html" target="_top">Core Data Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="cdPerformance.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="cdImporting.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/TP40002320-SW1" title="Troubleshooting Core Data"></a><hr /><H1>Troubleshooting Core Data</H1><p>This article outlines some of the common issues encountered in applications that use Core Data and provides clues as to correcting the problem.</p><p>When troubleshooting Core Data-based applications, it is important to consider that Core Data provides functionality that builds on top of functionality provided by other parts of Cocoa. When attempting to diagnose a problem with an application that uses Core Data, you should take care to distinguish between issues that are specific to Core Data and those that arise because of an error with another framework or to an implementation or architectural patten. Poor performance, for example, may not be due to Core Data per se, but instead are due to a failure to observe standard Cocoa techniques of memory management or resource conservation; or if a user interface does not update properly, this may be due to an error in how you have configured Cocoa bindings.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="cdTroubleshooting.html#//apple_ref/doc/uid/TP40002320-SW7">Object Life-Cycle Problems</a>
				
			<br/>
			
        
			
			
				<a href="cdTroubleshooting.html#//apple_ref/doc/uid/TP40002320-SW15">Problems with Fetching</a>
				
			<br/>
			
        
			
			
				<a href="cdTroubleshooting.html#//apple_ref/doc/uid/TP40002320-SW17">Problems with Saving</a>
				
			<br/>
			
        
			
			
				<a href="cdTroubleshooting.html#//apple_ref/doc/uid/TP40002320-SW21">Debugging Fetching</a>
				
			<br/>
			
        
			
			
				<a href="cdTroubleshooting.html#//apple_ref/doc/uid/TP40002320-SW22">Managed Object Models</a>
				
			<br/>
			
        
			
			
				<a href="cdTroubleshooting.html#//apple_ref/doc/uid/TP40002320-SW24">Bindings Integration</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40002320-SW7" title="Object Life-Cycle Problems"></a><h2>Object Life-Cycle Problems</h2><a name="//apple_ref/doc/uid/TP40002320-SW8" title="Merge errors"></a><h3>Merge errors</h3><p><em>Problem:</em> You see the error message, <code>"Could not merge changes"</code>.</p><p><em>Cause:</em> Two different managed object contexts tried to change the same data. This is also known as an optimistic locking failure.</p><p><em>Remedy:</em> Either set a merge policy on the context, or manually (programmatically) resolve the failure. You can retrieve the currently committed values for an object using <code><a href="../../../Reference/CoreDataFramework/Classes/NSManagedObject_Class/Reference/NSManagedObject.html#//apple_ref/occ/instm/NSManagedObject/committedValuesForKeys:" target="_top">committedValuesForKeys:</a></code>, and you can re-fault the object (so that when it is next accessed its data values are retrieved from its persistent store) using <code><a href="../../../Reference/CoreDataFramework/Classes/NSManagedObjectContext_Class/Reference/Reference.html#//apple_ref/occ/instm/NSManagedObjectContext/refreshObject:mergeChanges:" target="_top">refreshObject:mergeChanges:</a></code>.</p><a name="//apple_ref/doc/uid/TP40002320-SW9" title="Assigning a managed object to a different store"></a><h3>Assigning a managed object to a different store</h3><p><em>Problem:</em> You see an exception that looks similar to this example.</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;NSInvalidArgumentException> [&lt;MyMO 0x3036b0>_assignObject:toPersistentStore:]:<span></span></pre></td></tr><tr><td scope="row"><pre>Can’t reassign an object to a different store once it has been saved.<span></span></pre></td></tr></table></div><p><em>Cause:</em> The object you are trying to assign to a store has already been assigned and saved to a different store.</p><p><em>Remedy:</em> To move an object from one store to another, you must create a new instance, copy the information from the old object, save it to the appropriate store, and then delete the old instance.</p><a name="//apple_ref/doc/uid/TP40002320-SW10" title="Fault cannot be fulfilled"></a><h3>Fault cannot be fulfilled</h3><p><em>Problem:</em> You see the error message, <code>"Core Data could not fulfill a fault"</code>.</p><p><em>Cause:</em> The corresponding object's underlying data has been deleted from the persistent store.</p><p><em>Remedy:</em> You should discard this object.</p><p>This problem can occur in at least two situations:</p><p>First:</p><ul class="spaceabove"><li class="li"><p>Start with a retained reference to a managed object.</p></li><li class="li"><p>Delete the managed object via the managed object context.</p></li><li class="li"><p>Save changes on the object context. </p><p>At this point, the deleted object has been turned into a fault. It isn't destroyed because doing so would violate the rules of memory management.</p></li><li class="li"><p>Try to retrieve an attribute or relationship from the previously retained reference. </p></li></ul><p>Core Data will try to fault the faulted managed object but will fail to do so because the object has been deleted from the store. That is, there is no longer an object with the same global ID in the store. </p><p>Second:</p><ul class="spaceabove"><li class="li"><p>Delete an object from a managed object context.</p></li><li class="li"><p>Fail to break all relationships from other objects to that object.</p></li><li class="li"><p>Save changes.</p></li></ul><p>At this point, if you try to fire the relationship from some other object to that object, it may fail (this depends on the details of the configuration of the relationship as that affects how the relationship is stored). </p><p>The delete rules for relationships affect relationships only from the source object to other objects (including inverses). Without potentially fetching large numbers of objects, possibly without reason, there is no way for Core Data to efficiently clean up the relationships to the object.</p><p>Keep in mind that a Core Data object graph is directional. That is, a relationship has a source and a destination. Following a source to a destination does not necessarily mean that there is an inverse relationship. So, in that sense, you need to ensure that you are properly maintaining the object graph across deletes.</p><p>In practice, a well-designed object graph does not require much manual post-deletion clean up. If you consider that most object graphs have "entry points" that in effect act as a root node for navigating the graph and that most insertion and deletion events are rooted at those nodes just like fetches, then delete rules take care of most of the work for you. Similarly, since smart groups and other "casual" relationships are generally best implemented with fetched properties, various ancillary collections of entry points into the object graph generally do not need to be maintained across deletes because fetched relationships have no notion of permanence when it comes to objects found via the fetched relationship.</p><a name="//apple_ref/doc/uid/TP40002320-SW11" title="Managed object invalidated"></a><h3>Managed object invalidated</h3><p><em>Problem:</em> You see an exception that looks similar to this example:</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;NSObjectInaccessibleException> [&lt;MyMO 0x3036b0>_assignObject:toPersistentStore:]:<span></span></pre></td></tr><tr><td scope="row"><pre>The NSManagedObject with ID:#### has been invalidated.<span></span></pre></td></tr></table></div><p><em>Cause:</em> Either you have removed the store for the fault you are attempting to fire, or the managed object's context has been sent a <code><a href="../../../Reference/CoreDataFramework/Classes/NSManagedObjectContext_Class/Reference/Reference.html#//apple_ref/occ/instm/NSManagedObjectContext/reset" target="_top">reset</a></code> message.</p><p><em>Remedy:</em> You should discard this object. If you add the store again, you can try to fetch the object again.</p><a name="//apple_ref/doc/uid/TP40002320-SW12" title="Class is not key-value coding compliant"></a><h3>Class is not key-value coding compliant</h3><p><em>Problem:</em> You see an exception that looks similar to the following example.</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;NSUnknownKeyException> [&lt;MyMO 0x3036b0> valueForUndefinedKey:]:<span></span></pre></td></tr><tr><td scope="row"><pre>this class is not key value coding-compliant for the key randomKey.<span></span></pre></td></tr></table></div><p><em>Cause:</em> Either you used an incorrect key, or you initialized your managed object with <code>init</code> instead of <code>initWithEntity:inManagedObjectContext:</code>.</p><p><em>Remedy:</em> Use a valid key (check the spelling and case carefully—also review the rules for key-value coding compliance in <em><a href="../../KeyValueCoding/index.html#//apple_ref/doc/uid/10000107i" target="_top">Key-Value Coding Programming Guide</a></em>), or ensure that you use the designated initializer for <code>NSManagedObject</code> (see <code><a href="../../../Reference/CoreDataFramework/Classes/NSManagedObject_Class/Reference/NSManagedObject.html#//apple_ref/occ/instm/NSManagedObject/initWithEntity:insertIntoManagedObjectContext:" target="_top">initWithEntity:insertIntoManagedObjectContext:</a></code>).</p><a name="//apple_ref/doc/uid/TP40002320-SW13" title="Entity class does not respond to invocations of custom methods"></a><h3>Entity class does not respond to invocations of custom methods</h3><p><em>Problem:</em> You define an entity that uses a custom subclass of <code>NSManagedObject</code>, then in code you create an instance of the entity and invoke a custom method, as illustrated in this code fragment:</p><div class="codesample"><table><tr><td scope="row"><pre>NSManagedObject *entityInstance =<span></span></pre></td></tr><tr><td scope="row"><pre>    [NSEntityDescription insertNewObjectForEntityForName:@"MyEntity"<span></span></pre></td></tr><tr><td scope="row"><pre>            inManagedObjectContext:managedObjectContext];<span></span></pre></td></tr><tr><td scope="row"><pre>[entityInstance setAttribute: newValue];<span></span></pre></td></tr></table></div>	<p>You get a runtime error like this:</p><div class="codesample"><table><tr><td scope="row"><pre>"2005-05-05 15:44:51.233 MyApp[1234] ***<span></span></pre></td></tr><tr><td scope="row"><pre>    -[NSManagedObject setNameOfEntity:]: selector not recognized [self = 0x30e340]<span></span></pre></td></tr></table></div>	<p><em>Cause:</em> In the model, you may have misspelled the name of the custom class for the entity.</p><p><em>Remedy:</em> Ensure that the spelling of name of the custom class in the model matches the spelling of the custom class you implement.</p><a name="//apple_ref/doc/uid/TP40002320-SW14" title="Custom accessor methods are not invoked, key dependencies are not obeyed"></a><h3>Custom accessor methods are not invoked, key dependencies are not obeyed</h3><p><em>Problem:</em> You define a custom subclass of <code>NSManagedObject</code> for a particular entity and implement custom accessors methods (and perhaps dependent keys). At runtime, the accessor methods are not called and the dependent key is not updated.</p><p><em>Cause:</em> In the model, you did not specify the custom class for the entity.</p><p><em>Remedy:</em> Ensure that the model specifies of name of the custom class for the entity (that is, that it is not <code>NSManagedObject</code>).</p><a name="//apple_ref/doc/uid/TP40002320-SW15" title="Problems with Fetching"></a><h2>Problems with Fetching</h2><a name="//apple_ref/doc/uid/TP40002320-SW16" title="SQLite store does not work with sorting"></a><h3>SQLite store does not work with sorting</h3><p><em>Problem:</em> You create a sort descriptor that uses a comparison method defined by <code>NSString</code>, such as the following:</p><div class="codesample"><table><tr><td scope="row"><pre>NSSortDescriptor *mySortDescriptor = [[NSSortDescriptor alloc]<span></span></pre></td></tr><tr><td scope="row"><pre>        initWithKey:@"lastName" ascending:YES<span></span></pre></td></tr><tr><td scope="row"><pre>        selector:@selector(localizedCaseInsensitiveCompare:)];<span></span></pre></td></tr></table></div>	<p>You then either use this descriptor with a fetch request or as one of an array controller's sort descriptors. At runtime, you might see an error message that looks similar to the following:</p><div class="codesample"><table><tr><td scope="row"><pre>NSRunLoop ignoring exception 'unsupported NSSortDescriptor selector:<span></span></pre></td></tr><tr><td scope="row"><pre>        localizedCaseInsensitiveCompare:' that raised during posting of<span></span></pre></td></tr><tr><td scope="row"><pre>        delayed perform with target 3e2e42 and selector 'invokeWithTarget:'<span></span></pre></td></tr></table></div>	<p><em>Cause:</em> Exactly how a fetch request is executed depends on the store—see <span class="content_text"><a href="cdFetching.html#//apple_ref/doc/uid/TP40002484-SW3">“Fetching Managed Objects.”</a></span></p><p><em>Remedy:</em> If you are executing the fetch directly, you should not use Cocoa-based sort operators—instead you should sort the returned array in memory. If you are using an array controller, you may need to subclass <code>NSArrayController</code> so you can have it not pass the sort descriptors to the database and instead do the sorting after your data has been fetched.</p><a name="//apple_ref/doc/uid/TP40002320-SW17" title="Problems with Saving"></a><h2>Problems with Saving</h2><a name="//apple_ref/doc/uid/TP40002320-SW18" title="SQLite store takes a &quot;long time&quot; to save"></a><h3>SQLite store takes a "long time" to save</h3><p><em>Problem:</em> You are using an SQLite store and notice that it takes longer to save to the SQLite store than it does to save the same data to an XML store.</p><p><em>Cause:</em> This is probably expected behavior. The SQLite store ensures that all data is written correctly to disk—see <span class="content_text"><a href="cdPersistentStores.html#//apple_ref/doc/uid/TP40002875-SW2">“Configuring a SQLite Store’s Save Behavior.”</a></span></p><p><em>Remedy:</em> First determine whether the time taken to save will be noticeable to the user. This is typically likely to be the case only if you configure your application to frequently save automatically—for example, after every edit that the user makes. First, consider changing the store’s save behavior (switch off full sync). Then consider saving data only after a set period (for example, every 15 seconds) instead of after every edit. If necessary, consider choosing a different store—for example, the binary store.</p><a name="//apple_ref/doc/uid/TP40002320-SW19" title="Cannot save documents because entity is null"></a><h3>Cannot save documents because entity is null</h3><p><em>Problem:</em> You have Core Data document-based application that is unable to save. When you try to save the document you get an exception:</p><div class="codesample"><table><tr><td scope="row"><pre>Exception raised during posting of notification.  Ignored.  exception: Cannot perform operation since entity with name 'Wxyz' cannot be found<span></span></pre></td></tr></table></div><p><em>Cause:</em> This error is emitted by an instance of <code>NSObjectController</code> (or one of its subclasses) that is set in Entity mode but can’t access the entity description in the managed object model associated with the entity name specified in Interface Builder. In short, you have a controller in entity mode with an invalid entity name. </p><p><em>Remedy:</em> Select in turn each of your controllers in Interface Builder, and press Command-1 to show the inspector.  For each controller, ensure you have a valid entity name in the "Entity Name" field at the top.</p><a name="//apple_ref/doc/uid/TP40002320-SW20" title="Exception generated in retainedDataForObjectID:withContext."></a><h3>Exception generated in retainedDataForObjectID:withContext.</h3><p><em>Problem:</em> You add an object to a context. When you try to save the document you get an error that looks like this:</p><div class="codesample"><table><tr><td scope="row"><pre>[date] My App[2529:4b03] cannot find data for a temporary oid: 0x60797a0 &lt;&lt;x-coredata:///MyClass/t8BB18D3A-0495-4BBE-840F-AF0D92E549FA195>x-coredata:///MyClass/t8BB18D3A-0495-4BBE-840F-AF0D92E549FA195>
<span></span></pre></td></tr></table></div><p>an exception in <code>-[NSSQLCore retainedDataForObjectID:withContext:]</code>, and the backtrace looks like:</p><div class="codesample"><table><tr><td scope="row"><pre>#1    0x9599a6ac in -[NSSQLCore retainedDataForObjectID:withContext:]<span></span></pre></td></tr><tr><td scope="row"><pre>#2    0x95990238 in -[NSPersistentStoreCoordinator(_NSInternalMethods) _conflictsWithRowCacheForObject:andStore:]<span></span></pre></td></tr><tr><td scope="row"><pre>#3    0x95990548 in -[NSPersistentStoreCoordinator(_NSInternalMethods) _checkRequestForStore:originalRequest:andOptimisticLocking:]<span></span></pre></td></tr><tr><td scope="row"><pre>#4    0x9594e8f0 in -[NSPersistentStoreCoordinator(_NSInternalMethods) executeRequest:withContext:]<span></span></pre></td></tr><tr><td scope="row"><pre>#5    0x959617ec in -[NSManagedObjectContext save:]<span></span></pre></td></tr></table></div><p>The call to <code>_conflictsWithRowCacheForObject:</code> is comparing the object you're trying to save with its last cached version from the database. Basically, it's checking to see if any other code (thread, process, or just a different managed object context) changed this object out from underneath you.</p><p>Core Data does not do this check on newly inserted objects because they could not have existed in any other scope.   They haven't been written to the database yet.</p><p><em>Cause:</em> You may have forced a newly inserted object to "lose" its inserted status and then changed or deleted it. This could happen if you passed a temporary object ID to <code><a href="../../../Reference/CoreDataFramework/Classes/NSManagedObjectContext_Class/Reference/Reference.html#//apple_ref/occ/instm/NSManagedObjectContext/objectWithID:" target="_top">objectWithID:</a></code>. You may have passed an inserted object to another managed object context. </p><p><em>Remedy:</em> There are a number of possible remedies, depending on what was the root cause:</p><ul class="spaceabove"><li class="li"><p>Do not pass an inserted (not yet saved) object to another context. Only objects that have been saved can be passed between contexts.</p></li><li class="li"><p>Do not invoke <code>refreshObject:</code> on a newly-inserted object. </p></li><li class="li"><p>Do not make a relationship to an object that you never insert into the context.</p></li><li class="li"><p>Ensure that you use the designated initializer for instances of <code>NSManagedObject</code>.</p></li></ul><p>Before you save (frame #6 in the stack trace), the context’s <code><a href="../../../Reference/CoreDataFramework/Classes/NSManagedObjectContext_Class/Reference/Reference.html#//apple_ref/occ/instm/NSManagedObjectContext/updatedObjects" target="_top">updatedObjects</a></code> and <code><a href="../../../Reference/CoreDataFramework/Classes/NSManagedObjectContext_Class/Reference/Reference.html#//apple_ref/occ/instm/NSManagedObjectContext/deletedObjects" target="_top">deletedObjects</a></code> sets should only have members whose object ID returns <code>NO</code> from <code><a href="../../../Reference/CoreDataFramework/Classes/NSManagedObjectID_Class/Reference/NSManagedObjectID.html#//apple_ref/occ/instm/NSManagedObjectID/isTemporaryID" target="_top">isTemporaryID</a></code>. </p><a name="//apple_ref/doc/uid/TP40002320-SW21" title="Debugging Fetching"></a><h2>Debugging Fetching</h2><p>With Mac OS X version 10.4.3 and later, you can use the user default <code>com.apple.CoreData.SQLDebug</code> to log to <code>stderr</code> the actual SQL sent to SQLite. (Note that user default names are case sensitive.) For example, you can pass the following as an argument to the application:</p><div class="codesample"><table><tr><td scope="row"><pre>-com.apple.CoreData.SQLDebug 1<span></span></pre></td></tr></table></div><p>Higher levels of debug numbers produce more information, although using higher numbers is likely to be of diminishing utility.</p><p>The information the output provides can be useful when debugging performance problems—in particular it may tell you when Core Data is performing a large number of small fetches (such as when firing faults individually). Like file I/O, executing many small fetches is expensive compared to executing a single large fetch. For examples of how to correct this situation, see <span class="content_text"><a href="cdPerformance.html#//apple_ref/doc/uid/TP40003468-SW3">“Faulting Behavior.”</a></span></p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40002320-DontLinkElementID_12" title="Important:"></a><p><strong>Important:</strong>&nbsp;Using this information for reverse engineering to facilitate direct access to the SQLite file is <em>not</em> supported. It is exclusively a debugging tool.</p><p>As this is for debugging, the exact format of the logging is subject to change without notice. You should not, for example, pipe the output into an analysis tool with the expectation that it will work on all OS versions.</p><p></p></div><a name="//apple_ref/doc/uid/TP40002320-SW22" title="Managed Object Models"></a><h2>Managed Object Models</h2><a name="//apple_ref/doc/uid/TP40002320-SW23" title="My application generates the message &quot;+entityForName: could not locate an NSManagedObjectModel&quot;"></a><h3>My application generates the message "+entityForName: could not locate an NSManagedObjectModel"</h3><p><em>Problem:</em> The error states clearly the issue—the entity description cannot find a managed object model from which to access the entity information.</p><p><em>Cause:</em> The model may not be included in your application resources. You may be trying to access the model before it has been loaded.</p><p><em>Remedy:</em> Be sure that the model is included in your application resources and that the corresponding "project target" option in Xcode is selected. </p><p>The class method you invoked requires an entity name and context, and it is through the context that the entity gets the model. Basically, it looks like:</p><p>    context ---> coordinator ---> model</p><p>In general, when working with Core Data and you have problems like these, you should ensure:</p><ul class="spaceabove"><li class="li"><p>That the managed object context is not <code>nil</code></p></li><li class="li"><p>If you are managing your own Core Data stack, that the managed object context has an associated coordinator (<code><a href="../../../Reference/CoreDataFramework/Classes/NSManagedObjectContext_Class/Reference/Reference.html#//apple_ref/occ/instm/NSManagedObjectContext/setPersistentStoreCoordinator:" target="_top">setPersistentStoreCoordinator:</a></code> after allocating)</p></li><li class="li"><p>That the persistent store coordinator has a valid model</p></li></ul><p>If you are using <code>NSPersistentDocument</code>, then the "magic" for getting the managed object model is that it is instantiated using the <code><a href="../../../Reference/CoreDataFramework/Classes/NSManagedObjectModel_Class/Reference/Reference.html#//apple_ref/occ/clm/NSManagedObjectModel/mergedModelFromBundles:" target="_top">mergedModelFromBundles:</a></code> method when the document is initialized. </p><p>The documentation also gives you enough information on how to debug and hooks for debugging:  there are a handful of methods listed in the "Getting and setting the persistence objects" section of the API reference for <code><a href="../../../Reference/ApplicationKit/Classes/NSPersistentDocument_Class/Reference/Reference.html#//apple_ref/occ/cl/NSPersistentDocument" target="_top">NSPersistentDocument</a></code> for either modifying or inspecting the Core Data objects your document is working with.  Simply overriding the implementations, calling super, and inspecting the returned values would give you more information about what may (or may not) be occurring. </p><a name="//apple_ref/doc/uid/TP40002320-SW24" title="Bindings Integration"></a><h2>Bindings Integration</h2><p>Many problems relating to bindings are not specific to Core Data, and are discussed in <span class="content_text"><a href="../../CocoaBindings/Concepts/Troubleshooting.html#//apple_ref/doc/uid/TP40002148" target="_top">Troubleshooting Cocoa Bindings</a></span>. This section describes some additional problems that could be caused by the interaction of Core Data and bindings.</p><a name="//apple_ref/doc/uid/TP40002320-SW3" title="Custom relationship set mutator methods are not invoked by an array controller"></a><h3>Custom relationship set mutator methods are not invoked by an array controller</h3><p><em>Problem:</em> You have implemented set mutator methods for a relationship as described in <span class="content_text">“Custom To-Many Relationship Accessor Methods,”</span> and have bound the <code>contentSet</code> binding of an <code>NSArrayController</code> instance to a relationship (as illustrated by the Employees array controller in <em><a href="../../NSPersistentDocumentTutorial/index.html#//apple_ref/doc/uid/TP40001799" target="_top">NSPersistentDocument Core Data Tutorial</a></em>), but the set mutator methods are not invoked when you add objects to and remove objects from the array controller. </p><p><em>Cause:</em> This is a bug. </p><p><em>Remedy:</em> You can work around this by adding <code>self</code> to the <code>contentSet</code> binding's key path. For example, instead of binding to [Department Object Controller]<code>.selection.employees</code>, you would bind to [Department Object Controller]<code>.selection.self.employees</code>.</p><a name="//apple_ref/doc/uid/TP40002320-SW4" title="Cannot access contents of an object controller after a nib is loaded"></a><h3>Cannot access contents of an object controller after a nib is loaded</h3><p><em>Problem:</em> You want to perform an operation with the contents of an object controller (an instance of <code>NSObjectController</code>, <code>NSArrayController</code>, or <code>NSTreeController</code>) after a nib file has been loaded, but the controller's content is <code>nil</code>. </p><p><em>Cause:</em> The controller's fetch is executed as a delayed operation performed after its managed object context is set (by nib loading)—the fetch therefore happens after <code><a href="../../../Reference/ApplicationKit/Protocols/NSNibAwaking_Protocol/Reference/Reference.html#//apple_ref/occ/instm/NSObject/awakeFromNib" target="_top">awakeFromNib</a></code> and <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDocument/windowControllerDidLoadNib:" target="_top">windowControllerDidLoadNib:</a></code>. </p><p><em>Remedy:</em> You can execute the fetch “manually” with <code><a href="../../../Reference/ApplicationKit/Classes/NSObjectController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSObjectController/fetchWithRequest:merge:error:" target="_top">fetchWithRequest:merge:error:</a></code>—see <span class="content_text"><a href="cdBindings.html#//apple_ref/doc/uid/TP40004194-SW1">“Core Data and Cocoa Bindings.”</a></span></p><a name="//apple_ref/doc/uid/TP40002320-SW5" title="Cannot create new objects with array controller"></a><h3>Cannot create new objects with array controller</h3><p><em>Problem:</em> You cannot create new objects using an <code>NSArrayController</code>. For example, when you click the button assigned to the <code>add:</code> action, you get an error similar to the following: </p><div class="codesample"><table><tr><td scope="row"><pre>2005-05-05 12:00:)).000 MyApp[1234] *** NSRunLoop<span></span></pre></td></tr><tr><td scope="row"><pre>ignoring exception 'Failed to create new object' that raised<span></span></pre></td></tr><tr><td scope="row"><pre>during posting of delayed perform with target 123456<span></span></pre></td></tr><tr><td scope="row"><pre>and selector 'invokeWithTarget:'<span></span></pre></td></tr></table></div><p><em>Cause:</em> In your managed object model, you may have specified a custom class for the entity, but you have not implemented the class.</p><p><em>Remedy:</em> Implement the custom class, or specify that the entity is represented by <code>NSManagedObject</code>.</p><a name="//apple_ref/doc/uid/TP40002320-SW2" title="A table view bound to an array controller doesn&#39;t display the contents of a relationship"></a><h3>A table view bound to an array controller doesn't display the contents of a relationship</h3><p><em>Problem:</em> You have a table view bound to an array controller that you want to display the contents of a relationship, but nothing is displayed and you get an error similar to the following:</p><div class="codesample"><table><tr><td scope="row"><pre>2005-05-27 14:13:39.077 MyApp[1234] *** NSRunLoop ignoring exception<span></span></pre></td></tr><tr><td scope="row"><pre>'Cannot create NSArray from object &lt;_NSFaultingMutableSet: 0x3818f0> ()<span></span></pre></td></tr><tr><td scope="row"><pre>of class _NSFaultingMutableSet - consider using contentSet<span></span></pre></td></tr><tr><td scope="row"><pre>binding instead of contentArray binding' that raised during posting of<span></span></pre></td></tr><tr><td scope="row"><pre>delayed perform with target 385350 and selector 'invokeWithTarget:'<span></span></pre></td></tr></table></div>	<p><em>Cause:</em> You bound the controller's <code>contentArray</code> binding to a relationship. Relationships are represented by sets.</p><p><em>Remedy:</em> Bind the controller's <code>contentSet</code> binding to the relationship. </p><a name="//apple_ref/doc/uid/TP40002320-SW25" title="A new object is not added to the relationship of the object currently selected in a table view"></a><h3>A new object is not added to the relationship of the object currently selected in a table view</h3><p><em>Problem:</em> You have a table view that displays a collection of instances of an entity. The entity has a relationship to another entity, instances of which are displayed in a second table view. Each table view is managed by an array controller. When you add new instances of the second entity, they are not added to the relationship of the currently-selected instance of the first.</p><p><em>Cause:</em> The two array controllers are not related. There is nothing to tell the second array controller about the first.</p><p><em>Remedy:</em> Bind the second array controller's <code>contentSet</code> binding to the key path that specifies the relationship of the selection in the first array controller. For example, if the first array controller manages the Department entity, and the second the Employee entity, then the <code>contentSet</code> binding of the second array controller should be <code>[Department Controller].selection.employees</code>.</p><a name="//apple_ref/doc/uid/TP40002320-SW6" title="Table view or outline view contents not kept up-to-date when bound to an NSArrayController or NSTreeController object"></a><h3>Table view or outline view contents not kept up-to-date when bound to an NSArrayController or NSTreeController object</h3><p><em>Problem:</em> You have a table view or outline view that displays a collection of instances of an entity. As new instances of the entity are added and removed, the table view is not kept in sync.</p><p><em>Cause:</em> If the controller's content is an array that you manage yourself, then it is possible you are not modifying the array in a way that is key-value observing compliant.</p><p>If the controller's content is fetched automatically, then you have probably not set the controller to "Automatically prepare content."</p><p>Alternatively, the controller may not be properly configured.</p><p><em>Remedy:</em> If the controller's content is a collection that you manage yourself, then ensure you modify the collection in a way that is key-value observing compliant—see <span class="content_text"><a href="../../CocoaBindings/Concepts/Troubleshooting.html#//apple_ref/doc/uid/TP40002148" target="_top">Troubleshooting Cocoa Bindings</a></span>.</p><p>If the controller's content is fetched automatically, set the "Automatically prepares content" switch for the controller in the Attributes inspector in Interface Builder (see also <code><a href="../../../Reference/ApplicationKit/Classes/NSObjectController_Class/Reference/Reference.html#//apple_ref/occ/instm/NSObjectController/automaticallyPreparesContent" target="_top">automaticallyPreparesContent</a></code>). Doing so means that the controller tracks inserts into and deletions from its managed object context for its entity.</p><p>If neither of these is a factor, check to see that the controller is properly configured (for example, that you have set the entity correctly).</p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="cdPerformance.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="cdImporting.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2004, 2009 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2009-03-04<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Conceptual/CoreData/Articles/cdTroubleshooting.html%3Fid%3DTP40001075-5.6&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Conceptual/CoreData/Articles/cdTroubleshooting.html%3Fid%3DTP40001075-5.6&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Conceptual/CoreData/Articles/cdTroubleshooting.html%3Fid%3DTP40001075-5.6&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
