<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>

	<!-- BEGIN META TAG INFO -->
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<link rel="home" href="http://developer.apple.com/">
	<link rel="find" href="http://developer.apple.com/search/">
	<link rel="stylesheet" type="text/css" href="../../documentation/css/adcstyle.css" title="fonts">
	<script language="JavaScript" src="../../documentation/js/adc.js" type="text/javascript"></script>
	<!-- END META TAG INFO -->
	
	<!-- BEGIN TITLE -->
	<title>PackageTool - /Sample Package/HTMLSample Package Guide/tn1188/tn1188.html</title>
	<!-- END TITLE -->
<script language="JavaScript">
function JumpToNewPage() {
	window.location=document.scpopupmenu.gotop.value;
	return true;
}
</script>

</head>

<!-- BEGIN BODY OPEN -->
<body>
<!--END BODY OPEN -->

<!-- START CENTER OPEN -->
<center>
<!-- END CENTER OPEN -->

	<!-- BEGIN LOGO AND SEARCH -->
	<!--#include virtual="/includes/adcnavbar"-->
	<!-- END LOGO AND SEARCH -->
		
		
	<!-- START BREADCRUMB -->
	<div id="breadcrumb">
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td scope="row"><img width="340" height="10" src="images/1dot.gif" alt=""></td>
			<td><img width="340" height="10" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr valign="middle">
			<td align="left" colspan="2">
			<a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../samplecode/index.html">Sample Code</a> &gt; <a href="../../samplecode/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../samplecode/LegacyTechnologies/idxMacOS9Earlier-date.html">Mac OS 9 & Earlier</a> &gt; <A HREF="javascript:location.replace('index.html');">PackageTool</A> &gt; 
			</td>
		</tr>
		<tr>
			<td colspan="2" scope="row"><img width="680" height="35" src="images/1dot.gif" alt=""></td>
		</tr>
	</table>
	</div>
	<!-- END BREADCRUMB -->

	<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/index.html" target="_blank">Reference Library</a></li>
	</ul>
</div>




</div></div></div>

	<!-- START MAIN CONTENT -->
	
	<!-- START TITLE GRAPHIC AND INTRO-->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td><h1><div id="pagehead">PackageTool</div></h1></td>
		</tr>
	</table>
	<!-- END TITLE GRAPHIC AND INTRO -->
	<!-- START WIDE COLUMN -->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td id="scdetails">
				<h2>/Sample Package/HTMLSample Package Guide/tn1188/tn1188.html</h2>
				<form name="scpopupmenu" onSubmit="return false;" method=post>
				<p><strong>View Source Code:</strong> 
					<select name="gotop" onChange="JumpToNewPage();" style="width:340px"><option selected value="ingnore">Select File</option>
<option value="listing1.html">/PackageTool.c</option>
<option value="listing2.html">/PackageTool.h</option>
<option value="listing3.html">/PackageTool.r</option>
<option value="listing4.html">/PackageUtils.c</option>
<option value="listing5.html">/PackageUtils.h</option>
<option value="listing6.html">/PackageWindow.c</option>
<option value="listing7.html">/PackageWindow.h</option>
<option value="listing8.html">/Sample Package/HTMLSample/HTMLSample Help/buttons.html</option>
<option value="listing9.html">/Sample Package/HTMLSample/HTMLSample Help/index.html</option>
<option value="listing10.html">/Sample Package/HTMLSample/HTMLSample Pages/docs/display.html</option>
<option value="listing11.html">/Sample Package/HTMLSample/HTMLSample Pages/docs/drawing.html</option>
<option value="listing12.html">/Sample Package/HTMLSample/HTMLSample Pages/docs/generalroutines.html</option>
<option value="listing13.html">/Sample Package/HTMLSample/HTMLSample Pages/docs/index.html</option>
<option value="listing14.html">/Sample Package/HTMLSample/HTMLSample Pages/docs/intro.html</option>
<option value="listing15.html">/Sample Package/HTMLSample/HTMLSample Pages/docs/types.html</option>
<option value="listing16.html">/Sample Package/HTMLSample/HTMLSample Pages/docs/userdefined.html</option>
<option value="listing17.html">/Sample Package/HTMLSample/HTMLSample Pages/docs/utilities.html</option>
<option value="listing18.html">/Sample Package/HTMLSample/HTMLSample Pages/error.html</option>
<option value="listing19.html">/Sample Package/HTMLSample/HTMLSample Pages/index.html</option>
<option value="listing20.html">/Sample Package/HTMLSample Package Guide/index.html</option>
<option value="listing21.html">/Sample Package/HTMLSample Package Guide/tn1188/tn1188.html</option>
<option value="listing22.html">/Sample Package/HTMLSample sources/AboutBox.c</option>
<option value="listing23.html">/Sample Package/HTMLSample sources/AboutBox.h</option>
<option value="listing24.html">/Sample Package/HTMLSample sources/CIconButtons.c</option>
<option value="listing25.html">/Sample Package/HTMLSample sources/CIconButtons.h</option>
<option value="listing26.html">/Sample Package/HTMLSample sources/CWDefines.h</option>
<option value="listing27.html">/Sample Package/HTMLSample sources/debugf.c</option>
<option value="listing28.html">/Sample Package/HTMLSample sources/debugf.h</option>
<option value="listing29.html">/Sample Package/HTMLSample sources/History.c</option>
<option value="listing30.html">/Sample Package/HTMLSample sources/History.h</option>
<option value="listing31.html">/Sample Package/HTMLSample sources/HTMLSample Help/buttons.html</option>
<option value="listing32.html">/Sample Package/HTMLSample sources/HTMLSample Help/index.html</option>
<option value="listing33.html">/Sample Package/HTMLSample sources/HTMLSample Pages/docs/display.html</option>
<option value="listing34.html">/Sample Package/HTMLSample sources/HTMLSample Pages/docs/drawing.html</option>
<option value="listing35.html">/Sample Package/HTMLSample sources/HTMLSample Pages/docs/generalroutines.html</option>
<option value="listing36.html">/Sample Package/HTMLSample sources/HTMLSample Pages/docs/index.html</option>
<option value="listing37.html">/Sample Package/HTMLSample sources/HTMLSample Pages/docs/intro.html</option>
<option value="listing38.html">/Sample Package/HTMLSample sources/HTMLSample Pages/docs/types.html</option>
<option value="listing39.html">/Sample Package/HTMLSample sources/HTMLSample Pages/docs/userdefined.html</option>
<option value="listing40.html">/Sample Package/HTMLSample sources/HTMLSample Pages/docs/utilities.html</option>
<option value="listing41.html">/Sample Package/HTMLSample sources/HTMLSample Pages/error.html</option>
<option value="listing42.html">/Sample Package/HTMLSample sources/HTMLSample Pages/index.html</option>
<option value="listing43.html">/Sample Package/HTMLSample sources/HTMLSample.c</option>
<option value="listing44.html">/Sample Package/HTMLSample sources/HTMLSample.h</option>
<option value="listing45.html">/Sample Package/HTMLSample sources/HTMLSample.r</option>
<option value="listing46.html">/Sample Package/HTMLSample sources/RenderingWindow.c</option>
<option value="listing47.html">/Sample Package/HTMLSample sources/RenderingWindow.h</option>
<option value="listing48.html">/Sample Package/HTMLSample sources/SampleUtils.c</option>
<option value="listing49.html">/Sample Package/HTMLSample sources/SampleUtils.h</option>
<option value="listing50.html">/SimplePrefs.c</option>
<option value="listing51.html">/SimplePrefs.h</option>
<option value="listing52.html">/Utilities.c</option>
<option value="listing53.html">/Utilities.h</option></select>
				</p>
				</form>
				<p><strong><a href="PackageTool.zip">Download Sample</a></strong> (&#147;PackageTool.zip&#148;, 631.7K)<BR>
<strong><a href="PackageTool.dmg">Download Sample</a></strong> (&#147;PackageTool.dmg&#148;, 919.8K)</p>
				<!--
				<p><strong><a href="#">Download Sample</a></strong> (&#147;filename.sit&#148;, 500K)</p>
				-->
			</td>
		</tr>
		<tr>
			<td scope="row"><img width="680" height="10" src="images/1dot.gif" alt=""><br>
			<img height="1" width="680" src="images/1dot_919699.gif" alt=""><br>
			<img width="680" height="20" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr>
			<td scope="row">
	<!--googleon: index -->
<pre class="sourcecodebox">&lt;HTML&gt;&lt;HEAD&gt;   &lt;TITLE&gt;TN 1188: Packages in Mac OS 9&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY bgcolor=&quot;#ffffff&quot;&gt;&lt;A HREF=&quot;#top&quot;&gt;&lt;/a&gt;&lt;!--top banner--&gt;&lt;table width=&quot;550&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; border=&quot;0&quot;&gt;  &lt;tr&gt;    &lt;td&gt;            &lt;H1&gt;Technote 1188&lt;/H1&gt;                 &lt;H2&gt;Packages in Mac OS 9&lt;/H2&gt;                  &lt;B&gt;By John Montbriand&lt;/B&gt;&lt;BR&gt;                  &lt;B&gt;Apple Worldwide Developer Technical Support&lt;/B&gt;&lt;BR&gt;                        &lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;&lt;hr size=&quot;1&quot; noshade color=&quot;#000000&quot; width=&quot;550&quot; align=&quot;left&quot;&gt;&lt;TABLE BORDER=0 CELLPADDING=10 WIDTH=500&gt;   &lt;TR&gt;      &lt;TD VALIGN=top bgcolor=&quot;cccc99&quot; WIDTH=&quot;40%&quot;&gt;         &lt;H4&gt;CONTENTS&lt;/H4&gt;                  &lt;P id=p1&gt;         &lt;A HREF=&quot;#Section1&quot;&gt;Overview&lt;/A&gt;&lt;BR&gt;&lt;BR&gt;                  &lt;A HREF=&quot;#Section2&quot;&gt;The Package Flag&lt;/A&gt;&lt;BR&gt;&lt;BR&gt;                  &lt;A HREF=&quot;#Section3&quot;&gt;The Top Level Alias File&lt;/A&gt;&lt;BR&gt;&lt;BR&gt;                  &lt;A HREF=&quot;#Section4&quot;&gt;The Package's Main File&lt;/A&gt;&lt;BR&gt;&lt;BR&gt;                  &lt;A HREF=&quot;#Section5&quot;&gt;Other Support Files&lt;/A&gt;&lt;BR&gt;&lt;BR&gt;                 &lt;A HREF=&quot;#Section6&quot;&gt;The Optional Open Document Event Parameter&lt;/A&gt;&lt;BR&gt;&lt;BR&gt;                 &lt;A HREF=&quot;#Section7&quot;&gt;Package Compatibility Notes&lt;/A&gt;&lt;BR&gt;&lt;BR&gt;         &lt;/p&gt;      &lt;/TD&gt;      &lt;TD VALIGN=top&gt;          &lt;P&gt;&lt;FONT SIZE=&quot;+4&quot; COLOR=&quot;#0000AF&quot;&gt;T&lt;/FONT&gt;his Technote describes    how the Finder implements packages in Mac&amp;nbsp;OS&amp;nbsp;9. Developers    interested in creating packages for use in Mac&amp;nbsp;OS&amp;nbsp;9 can use    this document as a guide for creating packages. Mac&amp;nbsp;OS&amp;nbsp;9    packages offer a simple consolidated experience for the user when    interacting with a package in the Finder's windows, while at the    same time preventing accidental tampering with a package's required    support files.&lt;/P&gt;             &lt;P&gt;For Mac&amp;nbsp;OS&amp;nbsp;X package compatibility, an additional    package specification for Mac&amp;nbsp;OS&amp;nbsp;X will be released    as an adjunct to the Mac&amp;nbsp;OS&amp;nbsp;9 package specification    described in this document. Upon release of this additional    specification, developers will be able to create packages    to be used in either Mac&amp;nbsp;OS&amp;nbsp;9 or Mac&amp;nbsp;OS&amp;nbsp;X.&lt;/P&gt;  &lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;&lt;hr size=&quot;1&quot; noshade color=&quot;#000000&quot; width=&quot;550&quot; align=&quot;left&quot;&gt;&lt;BR&gt;&lt;TABLE BORDER=0 CELLPADDING=1 WIDTH=500&gt; &lt;TR&gt; &lt;TD&gt;&lt;A NAME=&quot;Section1&quot;&gt;&lt;/A&gt;&lt;H3&gt;Overview&lt;/H3&gt;  &lt;P&gt;Packages in Mac&amp;nbsp;OS&amp;nbsp;9 are not complex.  Simply said,  a Package in Mac&amp;nbsp;OS&amp;nbsp;9 is a folder with the 'package&amp;nbsp;bit' set that  contains exactly one alias file at the topmost level.  Normally,  a package will consist of an application and a number of support  files organized into sub-directories.  There is only one requirement  governing the internal organization of packages,  and there are no restrictions on how package sub-directories can  be named, how package sub-directories must be organized, or what package  sub-directories must contain. Figure&amp;nbsp;1 provides an illustration  of a hypothetical package named SimplePlot.&lt;/P&gt;  &lt;BR&gt;&lt;BR&gt;  &lt;P&gt;&lt;IMG SRC=&quot;images/packages.jpg&quot;&gt;&lt;BR&gt;&lt;BR&gt;  &lt;B&gt;Figure 1.&lt;/B&gt; Sample package directory layout. &lt;/P&gt;  &lt;BR&gt;&lt;BR&gt;  &lt;P&gt;Although requirements for packages in Mac&amp;nbsp;OS&amp;nbsp;9  are few, figure&amp;nbsp;1 illustrates the two main requirements for  packages:  the appropriate Finder flag must be set  for the package's folder and exactly one relative alias must be present  in the top level of the package's directory hierarchy.&lt;/P&gt;&lt;p id=p1&gt; &lt;a href=&quot;#top&quot;&gt;Back to top&lt;/a&gt; &lt;/p&gt;&lt;BR&gt;&lt;BR&gt;&lt;A NAME=&quot;Section2&quot;&gt;&lt;/A&gt;&lt;H3&gt;The Package Flag&lt;/H3&gt;  &lt;P&gt;The folder containing the package has bit 13 (for files, the &lt;CODE&gt;hasBundle&lt;/CODE&gt; bit)  set in its Finder flags.  For files, this bit is known as the  'bundle&amp;nbsp;bit' indicating that the file contains a  &lt;CODE&gt;'BNDL'&lt;/CODE&gt; resource that is used by the Finder to determine  how the file's icon is displayed.  For more information  about how the Finder &lt;CODE&gt;'BNDL'&lt;/CODE&gt; resources see the   &lt;A HREF=&quot;http://developer.apple.com/techpubs/mac/Toolbox/Toolbox-443.html&quot;&gt;Finder Interface&lt;/A&gt;  chapter of  &lt;A HREF=&quot;http://developer.apple.com/techpubs/mac/Toolbox/Toolbox-2.html&quot;&gt;Inside Macintosh: Macintosh Toolbox Essentials&lt;/A&gt;  .&lt;/P&gt;    &lt;P&gt;In Mac&amp;nbsp;OS&amp;nbsp;9, any folder having this bit set is recognized as  a package.  If this bit is set, and the folder contains exactly  one alias at it's top most level, then the Finder will treat  the folder as a package.&lt;/P&gt;    &lt;P&gt;In some circumstances, due to a software problem or a crash, a folder may  wind up having the package bit set when infact it is not a package.  In this  case, the Finder will treat such a folder as a 'damaged package' and its icon  will appear as a blank document with the kind string set to 'package'.  To correct  this problem, there is a utility called &quot;Package First Aid&quot; provided on the  Mac&amp;nbsp;OS&amp;nbsp;9 install CD.&lt;/P&gt;&lt;p id=p1&gt; &lt;a href=&quot;#top&quot;&gt;Back to top&lt;/a&gt; &lt;/p&gt;&lt;BR&gt;&lt;BR&gt;&lt;A NAME=&quot;Section3&quot;&gt;&lt;/A&gt;&lt;H3&gt;The Top Level Alias File&lt;/H3&gt;  &lt;P&gt;The package's folder contains exactly one alias file  at its topmost level.  This alias points to some other file  in the package's directory hierarchy; and, it should be a  relative alias so that it will remain valid if a package  is copied to another volume.  In this discussion,  the file pointed to by that alias is called the 'package's main file'.&lt;/P&gt;      &lt;TABLE BORDER=0 CELLPADDING=1 WIDTH=498&gt; &lt;TR&gt; &lt;TD bgcolor=&quot;eeeee0&quot;&gt;    &lt;B&gt;COMPATIBILITY NOTE&lt;/B&gt;&lt;BR&gt;    Although the top level alias file refers to an 'application' in the    example shown in Figure 1, there is no requirement that    the main file in a package must be an application.  It is possible to    create many types of packages including document packages, library    packages, et cetera.  However, the primary focus for Mac&amp;nbsp;OS&amp;nbsp;9    is application packages.    &lt;/TD&gt;&lt;/TR&gt; &lt;/TABLE&gt;  &lt;P&gt;The package's main file governs the behavior of the package  in the Finder's windows.  For all intents and purposes, the Finder treats the package  as if it were a file containing the 'BNDL', 'FREF', icon resources,  et cetera found in the package's main file.  &lt;/P&gt;    &lt;P&gt;For example, when a file is dragged over a package's icon, the Finder   will track the drag command exactly as if the file was being dragged over  the package's main file.  Referring to Figure 1, say the application SimplePlot's  &lt;CODE&gt;'BNDL'&lt;/CODE&gt; resource indicated it was capable of opening files of type  &lt;CODE&gt;'PLOT'&lt;/CODE&gt;, then:&lt;/P&gt;    &lt;OL&gt;    &lt;LI&gt;The Finder will allow the user to drop files of type &lt;CODE&gt;'PLOT'&lt;/CODE&gt; into the    SimplePlot package and the package's icon will be hilited appropriately    during drag operations,&lt;BR&gt;&lt;BR&gt;&lt;/LI&gt;         &lt;LI&gt;If a user drops a file of type &lt;CODE&gt;'PLOT'&lt;/CODE&gt; into the SimplePlot package,    the Finder will Launch the SimplePlot application, if it is not    already running, and send an 'open documents' Apple event to the application    asking it to open the file.&lt;BR&gt;&lt;BR&gt;&lt;/LI&gt;      &lt;/OL&gt;  &lt;P&gt;There are two ways to create the relative alias file required for a package.  The first is to manually create an alias file in the Finder using the &quot;Make Alias&quot;  command.  The second, is to make the appropriate calls to the resource manager  Alias&amp;nbsp;Manager in software as shown in Listing&amp;nbsp;1.&lt;/P&gt;  &lt;BR&gt;  &lt;TABLE BORDER=0 CELLPADDING=1 WIDTH=498&gt; &lt;TR&gt; &lt;TD bgcolor=&quot;eeeee0&quot;&gt;&lt;PRE&gt;/* MakeRelativeAliasFile creates a new alias file located at    aliasDest referring to the targetFile.  relative path    information is stored in the new file. */    OSErr MakeRelativeAliasFile(&lt;A HREF=&quot;http://developer.apple.com/techpubs/mac/Files/Files-115.html&quot;&gt;FSSpec&lt;/A&gt; *targetFile, &lt;A HREF=&quot;http://developer.apple.com/techpubs/mac/Files/Files-115.html&quot;&gt;FSSpec&lt;/A&gt; *aliasDest) {    &lt;A HREF=&quot;http://developer.apple.com/techpubs/mac/Toolbox/Toolbox-464.html&quot;&gt;FInfo&lt;/A&gt; fndrInfo;    &lt;A HREF=&quot;http://developer.apple.com/techpubs/mac/Files/Files-342.html&quot;&gt;AliasHandle&lt;/A&gt; theAlias;    Boolean fileCreated;    short rsrc;    OSErr err;        /* set up locals */    theAlias = NULL;    fileCreated = false;    rsrc = -1;        /* set up our the alias' file information */    err = &lt;A HREF=&quot;http://developer.apple.com/techpubs/mac/Files/Files-195.html&quot;&gt;FSpGetFInfo&lt;/A&gt;(targetFile, &amp;fndrInfo);    if (err != noErr) goto bail;    if (fndrInfo.fdType == 'APPL')        fndrInfo.fdType = kApplicationAliasType;    fndrInfo.fdFlags = kIsAlias; /* implicitly clear the inited bit */        /* create the new file */    &lt;A HREF=&quot;http://developer.apple.com/techpubs/mac/MoreToolbox/MoreToolbox-37.html&quot;&gt;FSpCreateResFile&lt;/A&gt;(aliasDest, 'TEMP', 'TEMP', smSystemScript);    if ((err = &lt;A HREF=&quot;http://developer.apple.com/techpubs/mac/MoreToolbox/MoreToolbox-35.html&quot;&gt;ResError&lt;/A&gt;()) != noErr) goto bail;    fileCreated = true;        /* set the file information or the new file */    err = &lt;A HREF=&quot;http://developer.apple.com/techpubs/mac/Files/Files-196.html&quot;&gt;FSpSetFInfo&lt;/A&gt;(aliasDest, &amp;fndrInfo);    if (err != noErr) goto bail;        /* create the alias record, relative to the new alias file */    err = &lt;A HREF=&quot;http://developer.apple.com/techpubs/mac/Files/Files-355.html&quot;&gt;NewAlias&lt;/A&gt;(aliasDest, targetFile, &amp;theAlias);    if (err != noErr) goto bail;        /* save the resource */    rsrc = &lt;A HREF=&quot;http://developer.apple.com/techpubs/mac/MoreToolbox/MoreToolbox-41.html&quot;&gt;FSpOpenResFile&lt;/A&gt;(aliasDest, fsRdWrPerm);    if (rsrc == -1) { err = &lt;A HREF=&quot;http://developer.apple.com/techpubs/mac/MoreToolbox/MoreToolbox-35.html&quot;&gt;ResError&lt;/A&gt;(); goto bail; }    &lt;A HREF=&quot;http://developer.apple.com/techpubs/mac/MoreToolbox/MoreToolbox-47.html&quot;&gt;UseResFile&lt;/A&gt;(rsrc);    &lt;A HREF=&quot;http://developer.apple.com/techpubs/mac/MoreToolbox/MoreToolbox-64.html&quot;&gt;AddResource&lt;/A&gt;((Handle) theAlias, rAliasType, 0, aliasDest-&amp;gt;name);    if ((err = &lt;A HREF=&quot;http://developer.apple.com/techpubs/mac/MoreToolbox/MoreToolbox-35.html&quot;&gt;ResError&lt;/A&gt;()) != noErr) goto bail;    theAlias = NULL;    &lt;A HREF=&quot;http://developer.apple.com/techpubs/mac/MoreToolbox/MoreToolbox-89.html&quot;&gt;CloseResFile&lt;/A&gt;(rsrc);    rsrc = -1;    if ((err = &lt;A HREF=&quot;http://developer.apple.com/techpubs/mac/MoreToolbox/MoreToolbox-35.html&quot;&gt;ResError&lt;/A&gt;()) != noErr) goto bail;        /* done */    return noErr;bail:    if (rsrc != -1) &lt;A HREF=&quot;http://developer.apple.com/techpubs/mac/MoreToolbox/MoreToolbox-89.html&quot;&gt;CloseResFile&lt;/A&gt;(rsrc);    if (fileCreated) &lt;A HREF=&quot;http://developer.apple.com/techpubs/mac/Files/Files-193.html&quot;&gt;FSpDelete&lt;/A&gt;(aliasDest);    if (theAlias != NULL) &lt;A HREF=&quot;http://developer.apple.com/techpubs/mac/Memory/Memory-73.html&quot;&gt;DisposeHandle&lt;/A&gt;((Handle) theAlias);    return err;}&lt;/PRE&gt;  &lt;/TD&gt;&lt;/TR&gt; &lt;/TABLE&gt;  &lt;BR&gt;  &lt;B&gt;Listing 1&lt;/B&gt;. Sample routine for creating a relative alias file.&lt;/P&gt;&lt;BR&gt;  &lt;P&gt;Developers interested in creating an application for automating the creation  of packages will want to employ some method similar to the routine shown  in Figure&amp;nbsp;1.  Other options include using the Finder's 'Make&amp;nbsp;Alias' command  or creating aliases using applescript.  The advantage of calling &lt;CODE&gt;NewAlias&lt;/CODE&gt;  directly is that you have more control over how the alias is created and are able  to specify which file is used for constructing relative aliases.&lt;/P&gt;&lt;BR&gt;  &lt;TABLE BORDER=0 CELLPADDING=1 WIDTH=498&gt; &lt;TR&gt; &lt;TD bgcolor=&quot;eeeee0&quot;&gt;    &lt;B&gt;COMPATIBILITY NOTE&lt;/B&gt;&lt;BR&gt;    When creating aliases using either the Finder's &quot;Make&amp;nbsp;Alias&quot; command,    or the method shown in Figure&amp;nbsp;1, be sure that File Sharing is turned    off.  If file sharing is turned on, then full path information such    as the server name, etc is stored in the alias making it unsuitable    for use in packages.  Be sure file sharing is turned off before    creating any aliases used in packages.  &lt;/TD&gt;&lt;/TR&gt; &lt;/TABLE&gt;&lt;p id=p1&gt; &lt;a href=&quot;#top&quot;&gt;Back to top&lt;/a&gt; &lt;/p&gt;&lt;BR&gt;&lt;BR&gt;&lt;A NAME=&quot;Section4&quot;&gt;&lt;/A&gt;&lt;H3&gt;The Package's Main File&lt;/H3&gt;  &lt;P&gt;In the context of the Finder's windows, a package will behave as if  it were a file or an application.  And, all of the properties of the package's icon are  determined by the package's main file.  As shown in figure&amp;nbsp;2, this is  the file referred to by the package's top level alias file.  &lt;/P&gt;      &lt;BR&gt;&lt;BR&gt;  &lt;P&gt;&lt;IMG SRC=&quot;images/mainf.jpg&quot;&gt;&lt;BR&gt;&lt;BR&gt;  &lt;B&gt;Figure 2.&lt;/B&gt; The package's main file. &lt;/P&gt;  &lt;BR&gt;&lt;BR&gt;          &lt;P&gt;For example, if the package's main file is an application, then the  package will look and feel like an application; and, if the package's  main file is a document, then the package will look and feel like  a document.  The package's main file is used by the Finder to determine  the majority of the external characteristics of the package.  These  characteristics include:&lt;/P&gt;    &lt;UL&gt;    &lt;LI&gt;The package's icon,&lt;BR&gt;&lt;BR&gt;&lt;/LI&gt;    &lt;LI&gt;The package's kind (application, document, et&amp;nbsp;cetera),&lt;BR&gt;&lt;BR&gt;&lt;/LI&gt;    &lt;LI&gt;The Get Info data (Excluding the package's size: a package's size    is the total of the sizes of all of the package's contents.  Also, the    package's size is displayed in the Get Info window without reference    to the number of items in the package's folder.),&lt;BR&gt;&lt;BR&gt;&lt;/LI&gt;    &lt;LI&gt;Drag and drop information,&lt;BR&gt;&lt;BR&gt;&lt;/LI&gt;    &lt;LI&gt;The kIsStationery and kHasCustomIcon Finder flags from package's main    file are used when displaying the package.  The other Finder flags, specifically    the invisible, name locked, inited, bundle, and color flags, are taken from    the package folder's flags instead of the main file's flags.&lt;BR&gt;&lt;BR&gt;&lt;/LI&gt;  &lt;/UL&gt;    &lt;P&gt;In general, a package will have all the same properties as the  package's main file.  Points where they differ include:&lt;/P&gt;    &lt;UL&gt;    &lt;LI&gt;The package's size is the total size of package folder contents,&lt;BR&gt;&lt;BR&gt;&lt;/LI&gt;    &lt;LI&gt;The main file's name and the package's name may differ.  This allows    the user to edit the name of the package without disturbing the name of the    package's main file.&lt;BR&gt;&lt;BR&gt;&lt;/LI&gt;  &lt;/UL&gt;    &lt;P&gt;Application packages (package's whose main file is an application) accept drag  and drop operations in Finder windows in the same way application files  accept drag and drop operations in Finder windows.  Here, the acceptance of a  drag and drop is governed by the properties of the package's main file, and if  a drop is allowed, then the Finder will send the appropriate Apple event to the  package's main file. &lt;/P&gt;&lt;p id=p1&gt; &lt;a href=&quot;#top&quot;&gt;Back to top&lt;/a&gt; &lt;/p&gt;&lt;BR&gt;&lt;BR&gt;&lt;A NAME=&quot;Section5&quot;&gt;&lt;/A&gt;&lt;H3&gt;Other Support Files&lt;/H3&gt;&lt;P&gt;One of the key features of packages is the developer's abilityto consolidate many support files together with the main application.  Bytaking advantage of this facility, developers can group the filesused in a product in a way that both simplifies the user's task of dealingwith the product in the Finder's windows and prevents tampering with thearrangement of the support files used in the product.&lt;/P&gt;  &lt;TABLE BORDER=0 CELLPADDING=1 WIDTH=498&gt; &lt;TR&gt; &lt;TD bgcolor=&quot;eeeee0&quot;&gt;    &lt;B&gt;COMPATIBILITY NOTE&lt;/B&gt;&lt;BR&gt;    Developers currently placing support files for their    applications in the system folder should consider consolidating    their applications and support files into packages for Mac&amp;nbsp;OS&amp;nbsp;9.  &lt;/TD&gt;&lt;/TR&gt; &lt;/TABLE&gt;&lt;P&gt;A package may contain a complex hierarchy of support files, sharedlibraries, and other types of files used by the application in it'soperation.  Also, it is not unreasonable to suppose that a packagemay contain one or more application files that in some way lendto the overall facility provided by the package.  In Figure 1,the package contains a number of support files including privateshared libraries presumably used by the main application, a numberof AppleScript scripts, and a suite of help files.&lt;/P&gt;&lt;p id=p1&gt; &lt;a href=&quot;#top&quot;&gt;Back to top&lt;/a&gt; &lt;/p&gt;&lt;BR&gt;&lt;BR&gt;&lt;A NAME=&quot;Section6&quot;&gt;&lt;/A&gt;&lt;H3&gt;The Optional Open Document Event Parameter&lt;/H3&gt;&lt;P&gt;Application packages may receive a open document &lt;CODE&gt;'odoc'&lt;/CODE&gt; Apple eventscontaining an optional parameter with the key &lt;CODE&gt;'fdpl'&lt;/CODE&gt; (Finderpackage document list).  This will be sent to the package when the Finderis asked to open any file inside of a package.  There are a few ways thiscan happen:&lt;/P&gt;  &lt;UL&gt;    &lt;LI&gt;While running under a previous version of Mac&amp;nbsp;OS, the user    created an alias referring to an item inside of the package's    folder and put the alias somewhere outside of the package's    folder.  Then, after switching to Mac&amp;nbsp;OS&amp;nbsp;9, they attempted to    open the item by double clicking on the alias.    &lt;BR&gt;&lt;BR&gt;&lt;/LI&gt;        &lt;LI&gt;An open document event targeting one or more items inside of the    package's folder was sent to the Finder by some other application.&lt;BR&gt;&lt;BR&gt;&lt;/LI&gt;        &lt;LI&gt;An alias to an item inside of a package is dropped onto another    application.  In this case, rather than launching the application that    the alias was dropped into, the Finder will launch the package's    application and send it an open document event containing a &lt;CODE&gt;'fdpl'&lt;/CODE&gt;    parameter referring to the file.&lt;BR&gt;&lt;BR&gt;&lt;/LI&gt;  &lt;/UL&gt;&lt;P&gt;In either case, the Finder will not open the items in the way that itusually does.  Instead, the Finder will package the items into an opendocument apple event in a &lt;CODE&gt;'fpdl'&lt;/CODE&gt; parameter and send the event to thepackage's application.  The structure of the &lt;CODE&gt;'fpdl'&lt;/CODE&gt; parameter is identicalto the structure of the &lt;CODE&gt;keyDirectObject&lt;/CODE&gt; open document event parameter -it is a list of file aliases.  The only difference is, the aliases will allrefer to files or folders inside of the application's directory.&lt;/P&gt; &lt;P&gt;Your open document event handler should be designed to handleeach of the three different combinations of event parameters itcan receive:&lt;/P&gt;    &lt;UL&gt;    &lt;LI&gt;Open document events without the optional &lt;CODE&gt;'fpdl'&lt;/CODE&gt; parameter.    &lt;BR&gt;&lt;BR&gt;&lt;/LI&gt;    &lt;LI&gt;Open document events where the &lt;CODE&gt;keyDirectObject&lt;/CODE&gt; is an    empty list referring to no documents, but the optional &lt;CODE&gt;'fpdl'&lt;/CODE&gt;    parameter contains a list referring to one or more documents.    &lt;BR&gt;&lt;BR&gt;&lt;/LI&gt;    &lt;LI&gt;Open document events where the &lt;CODE&gt;keyDirectObject&lt;/CODE&gt;     contains a list referring to one or more documents and the optional &lt;CODE&gt;'fpdl'&lt;/CODE&gt;    parameter contains a list referring to one or more documents.    &lt;BR&gt;&lt;BR&gt;&lt;/LI&gt;  &lt;/UL&gt;&lt;P&gt;In general, the main application's open document event handler shouldalways look for the optional &lt;CODE&gt;'fpdl'&lt;/CODE&gt; parameter and take appropriateactions when it is there.  At the very least, the application shouldprovide appropriate feedback to the user indicating that the requested fileis an internal part of the package and cannot be opened.  Other situationsmay call for different kinds of processing;  for example, say the &lt;CODE&gt;'fpdl'&lt;/CODE&gt;parameter contains a reference to a help file inside of the package, then itwould be appropriate for the application to open that help file and displayits contents.&lt;/P&gt;&lt;p id=p1&gt; &lt;a href=&quot;#top&quot;&gt;Back to top&lt;/a&gt; &lt;/p&gt;&lt;BR&gt;&lt;BR&gt;&lt;A NAME=&quot;Section7&quot;&gt;&lt;/A&gt;&lt;H3&gt;Package Compatibility Notes&lt;/H3&gt;&lt;P&gt;Packages cannot be shared in Mac&amp;nbsp;OS&amp;nbsp;9. &lt;/P&gt;&lt;P&gt;The StandardFile dialogs are not aware of packages.  As a result,it is possible for users to use these windows to navigate into packagefolders and either attempt to open documents inside of them or savedocuments inside of packages.  Navigation Services has been updatedto recognize packages and it does not allow users to navigate intothem (unless specifically directed to do so).&lt;/P&gt;&lt;p id=p1&gt; &lt;a href=&quot;#top&quot;&gt;Back to top&lt;/a&gt; &lt;/p&gt;&lt;/TD&gt; &lt;/TR&gt; &lt;/TABLE&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;H3&gt;Acknowledgments&lt;/H3&gt;&lt;P&gt;Special thanks to Pat&amp;nbsp;McClaughry and the Finder&amp;nbsp;Team.&lt;/P&gt;&lt;P&gt;And, thanks to Tim&amp;nbsp;Holmes, Ingrid&amp;nbsp;Kelly, Karl&amp;nbsp;Schlosser&amp;nbsp;(Editor),John&amp;nbsp;C.&amp;nbsp;Signa, and David&amp;nbsp;J.&amp;nbsp;Wright.&lt;/P&gt;</pre>
	<!--googleoff: index -->
			</td>
		</tr>
	</table>
	<!-- END WIDE COLUMN -->

	<!-- END MAIN CONTENT -->
		<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/samplecode/PackageTool/listing21.html%3Fid%3DDTS10000599-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/samplecode/PackageTool/listing21.html%3Fid%3DDTS10000599-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/samplecode/PackageTool/listing21.html%3Fid%3DDTS10000599-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

	<!-- START BOTTOM APPLE NAVIGATION -->
	<!--#include virtual="/includes/footer"-->
	<!-- END BOTTOM APPLE NAVIGATION -->

<!-- START CENTER CLOSE -->
</center>
<!-- END CENTER CLOSE -->

</body>
</html>