<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note TB10: Finders and Foreign Drives</title>                                       <meta name="categories" content="Human Interface Toolbox"><meta name="week-posted" content="Apr 30, 1984 - May 4, 1984"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002761" title="Finders and Foreign Drives"></a><a name="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxHardwareDrivers-date.html">Hardware & Drivers</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/HardwareDrivers/idxMassStorageDevices-date.html" target="_blank">Hardware & Drivers > Storage</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TB10</div>
<div id="pageheadsub">Finders and Foreign Drives</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext"><A HREF="#Section1">Identifying Foreign Drives</A><BR><BR><A HREF="#Section2">Formatting Foreign Drives</A><BR><BR><A HREF="#Section3">Other Nifty Things to Know About</A><BR><BR><A HREF="#References">References</A><BR><BR><A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">This technical note describes the differences in the way the 1.1g, 4.1, 5.0 andnewer Finders communicate with foreign (non-Sony) disk drives.</p><!-- end_intro_text --><!-- begin_date --><h3>[Mar 01 1988]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><a name=Section1></A><h2>Identifying Foreign Drives</h2><p>Non-Sony disk drives can send an icon and a descriptive string to the Finder;this icon is used on the desktop to represent the drive. The string isdisplayed in the "Get Info" box for any object belonging to that disk. When theFinder notices a non-Sony drive in the VCB queue, it will issue 1 or 2 controlcalls to the disk driver to get the icon and string.</p><p>Finder 1.1g issues one control call to the driver with <code>csCode</code> = 20 andthe driver returns the icon ID in <code>csParam</code>. This method has problemsbecause the icon ID is tied to a particular system file. So, if the Finderswitch-launches to a different floppy, the foreign disk's icon reverts to theSony's.</p><p>Finders 4.1 and newer issue a newer control call and, if that fails, they issuethe old Control call. The new call has <code>csCode</code> = 21, and the drivershould return a pointer in <code>csParam</code>. The pointer points to an <code>'ICN#'</code>followed by a 1- to 31-byte Pascal string containing the descriptor. Thisimplies that the icon and the string must be part of the disk driver's codebecause only the existence of the driver indicates that the disk is attached.</p><p>This has implications about the translation of the driver for overseas markets,but the descriptor will usually be a trademarked name which isn't translated.However, the driver install program could be made responsible for inserting thetranslated name into the driver.</p><p>Drivers should respond to both control calls if compatibility with both Findersis desired.</p><a name="Section2"></a><P><A HREF="#top">Back to top</A></p><h2>Formatting Foreign Drives</h2><p>When the user chooses the Erase Disk option in the Finder, a non-Sony driverneeds to know that this has happened so it can format the disk. Finder 4.1 andnewer notify the driver that the drive needs to be formatted and verified. Theyfirst issue a <code>Control</code> call to the driver with the <code>csCode</code> = 6to tell the disk driver to format the drive. Then they issue a <code>Control</code>call with a <code>csCode</code> = 5 to tell the driver to verify the drive.</p><a name="Section3"></a><P><A HREF="#top">Back to top</A></p><h2>Other Nifty Things to Know About</h2><p>Finders 4.1 and newer also permit the user to drag any online disk to the trashcan. The Finder will clean up the disk state, issue an <code>Eject</code> callfollowed by an <code>Unmount</code> call to the disk and then, an event loop later,reclaim all the memory. This means any program/accessory used to mount volumesshould reconcile its private data, menus, etc. to the current state of the VCBqueue. These Finders also notice if a volume disappears and will clean upsafely. But, because of a quirk in timing, a mount manager cannot unmount onevolume then mount another immediately; it must wait for the Finder to looparound and clean up the first disk before it notices the second. (It shouldhave cleaned up old ones before it notices new ones, but it doesn't.)</p><p>Finders 5.0 and newer allow you to drag the startup disk to the trash; Finder4.1 just ignored you. Finders 5.0 and newer take the volume offline as if youhad chosen Eject.</p>         <a name="Downloads"></a>       <P><A HREF="#top">Back to top</A></p><h2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (44K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/tb_10.pdf">Download</A></P>               </TD>            </TR>                    </TABLE>         <BR></TD></TR></table></center><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tb/tb_10.html%3Fid%3DDTS10002761-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tb/tb_10.html%3Fid%3DDTS10002761-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tb/tb_10.html%3Fid%3DDTS10002761-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>