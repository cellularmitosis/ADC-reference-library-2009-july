<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Procedure Information (IM: PS)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING23></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="PPCSoftware-22.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="PPCSoftware-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="PPCSoftware-86.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="PPCSoftware-24.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="PPCSoftware-2.html"><B>PowerPC System Software</B></A> / <BR><DD><A HREF="PPCSoftware-17.html"><B>Chapter 2 - Mixed Mode Manager</B></A> / <A HREF="PPCSoftware-20.html"><B>Mixed Mode Manager Reference</B></A><BR><DL><DD><A HREF="PPCSoftware-21.html"><B>Constants</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING23-0></A>
<H3><A NAME=MARKER-9-117></A>Procedure Information</H3>
 <A NAME=MARKER-2-81></A>The Mixed Mode Manager uses a long word of type <CODE>ProcInfoType</CODE> to encode a routine's procedure information, which contains essential information about the calling conventions and other features of a routine. These values specify<P>
<UL>
<LI>the routine's calling conventions
<LI>the sizes and locations of the routine's parameters, if any
<LI>the size and location of the routine's result, if any<P>
</UL>
 See <A HREF=PPCSoftware-19.html#MARKER-9-50>"Specifying Procedure Information" beginning on page 2-14</A> for a description of the general structure of a routine's procedure information. The Mixed Mode Manager provides a number of constants that you can use to specify the procedure information.<P>
 The following constants are used to specify the size (in bytes) of a value encoded in a routine's procedure information.<P>
<PRE>
enum {
   /*size codes*/
   kNoByteCode                   = 0,
   kOneByteCode                  = 1,
   kTwoByteCode                  = 2,
   kFourByteCode                 = 3
};
</PRE>
<B>Constant descriptions</B><P>
<DL>
<DT><A NAME=MARKER-2-120></A><A NAME=MARKER-2-89></A>kNoByteCode
<DD> The value occupies no bytes.
<DT><CODE><A NAME=MARKER-2-122></A><A NAME=MARKER-2-127></A>kOneByteCode</CODE>
<DD> The value occupies 1 byte.
<DT><CODE><A NAME=MARKER-2-124></A><A NAME=MARKER-2-124></A>kTwoByteCode</CODE>
<DD> The value occupies 2 bytes.
<DT><CODE><A NAME=MARKER-2-126></A><A NAME=MARKER-2-126></A>kFourByteCode</CODE>
<DD> The value occupies 4 bytes.
</DL>
 The offsets to fields and the widths of the fields within a value of type <CODE>ProcInfoType</CODE> are defined by constants:<P>
<PRE>
/*offsets to and widths of procedure information fields*/
#define kCallingConventionPhase                       0
#define kCallingConventionWidth                       4
#define kResultSizePhase                              kCallingConventionWidth
#define kResultSizeWidth                              2
#define kResultSizeMask                               0x30
#define kStackParameterPhase                          6
#define kStackParameterWidth                          2
#define kRegisterResultLocationPhase                  \
                           (kCallingConventionWidth + kResultSizeWidth)
#define kRegisterResultLocationWidth                  5
#define kRegisterParameterPhase                       \
                           (kCallingConventionWidth + kResultSizeWidth + \
                              kRegisterResultLocationWidth)
#define kRegisterParameterWidth                       5
#define kRegisterParameterWhichPhase                  2
#define kRegisterParameterSizePhase                   0
#define kDispatchedSelectorSizeWidth                  2
#define kDispatchedSelectorSizePhase                  \
                           (kCallingConventionWidth + kResultSizeWidth)
#define kDispatchedParameterPhase                     \
                           (kCallingConventionWidth + kResultSizeWidth + \
                              kDispatchedSelectorSizeWidth)
</PRE>
<B>Constant descriptions</B><P>
<DL>
<DT><CODE><A NAME=MARKER-2-128></A><A NAME=MARKER-2-91></A>kCallingConventionPhase</CODE>
<DD> The offset from the least significant bit in the procedure information to the calling convention information.
<DT><CODE><A NAME=MARKER-2-130></A><A NAME=MARKER-2-102></A>kCallingConventionWidth</CODE>
<DD> The number of bits in the procedure information that encode the calling convention information.
<DT><CODE><A NAME=MARKER-2-132></A><A NAME=MARKER-2-103></A>kResultSizePhase</CODE>
<DD> The offset from the least significant bit in the procedure information to the function result size information.
<DT><CODE><A NAME=MARKER-2-134></A><A NAME=MARKER-2-160></A>kResultSizeWidth</CODE>
<DD> The number of bits in the procedure information that encode the function result size information.
<DT><A NAME=MARKER-2-136></A><A NAME=MARKER-2-47></A>kResultSizeMask
<DD> A mask for the bits in the procedure information that encode the function result size information.
<DT><CODE><A NAME=MARKER-2-138></A><A NAME=MARKER-2-141></A>kStackParameterPhase</CODE>
<DD> The offset from the least significant bit in the procedure information to the stack parameter information.
<DT><CODE><A NAME=MARKER-2-140></A><A NAME=MARKER-2-116></A>kStackParameterWidth</CODE>
<DD> The number of bits in the procedure information that encode the size of a stack-based parameter.
<DT><CODE><A NAME=MARKER-2-142></A><A NAME=MARKER-2-121></A>kRegisterResultLocationPhase</CODE>
<DD> The offset from the least significant bit in the procedure information to the result register information.
<DT><CODE><A NAME=MARKER-2-144></A><A NAME=MARKER-2-122></A>kRegisterResultLocationWidth</CODE>
<DD> The number of bits in the procedure information that encode which register the result will be stored in.
<DT><CODE><A NAME=MARKER-2-146></A><A NAME=MARKER-2-129></A>kRegisterParameterPhase</CODE>
<DD> The offset from the least significant bit in the procedure information to the register parameter information.
<DT><CODE><A NAME=MARKER-2-148></A><A NAME=MARKER-2-92></A>kRegisterParameterWidth</CODE>
<DD> The number of bits in the procedure information that encode the information about a register-based parameter.
<DT><CODE><A NAME=MARKER-2-150></A><A NAME=MARKER-2-104></A>kRegisterParameterWhichPhase</CODE>
<DD> The offset from the beginning of a register parameter information field to the encoded register.
<DT><CODE><A NAME=MARKER-2-152></A><A NAME=MARKER-2-111></A>kRegisterParameterSizePhase</CODE>
<DD> The offset from the beginning of a register parameter information field to the encoded size of the parameter.
<DT><A NAME=MARKER-2-154></A><A NAME=MARKER-2-29></A>kDispatchedSelectorSizeWidth
<DD> The number of bits in the procedure information that encode the size of a routine-dispatching selector.
<DT><A NAME=MARKER-2-156></A><A NAME=MARKER-2-213></A>kDispatchedSelectorSizePhase
<DD> The offset from the least significant bit in the procedure information to the selector size information of a routine that is dispatched though a selector.
<DT><A NAME=MARKER-2-158></A><A NAME=MARKER-2-158></A>kDispatchedParameterPhase
<DD> The offset from the least significant bit in the procedure information to the parameter information of a routine that is dispatched though a selector.
</DL>
 <A NAME=MARKER-2-159></A>The following constants are used to specify a routine's calling conventions:<P>
<PRE>
enum {
   /*calling conventions*/
   kPascalStackBased                   = (CallingConventionType)0,
   kCStackBased                        = (CallingConventionType)1,
   kRegisterBased                      = (CallingConventionType)2,
   kThinkCStackBased                   = (CallingConventionType)5,
   kD0DispatchedPascalStackBased       = (CallingConventionType)8,
   kD0DispatchedCStackBased            = (CallingConventionType)9,
   kD1DispatchedPascalStackBased       = (CallingConventionType)12,
   kStackDispatchedPascalStackBased    = (CallingConventionType)14,
   kSpecialCase                        = (CallingConventionType)15
};
</PRE>
<B>Constant descriptions</B><P>
<DL>
<DT><CODE><A NAME=MARKER-2-161></A><A NAME=MARKER-2-96></A>kPascalStackBased</CODE>
<DD> The routine follows normal Pascal calling conventions.<A NAME=MARKER-2-162></A>
<DT><CODE><A NAME=MARKER-2-164></A><A NAME=MARKER-2-97></A>kCStackBased</CODE>
<DD> The routine follows the C calling conventions employed by the MPW development environment.<A NAME=MARKER-2-165></A><A NAME=MARKER-2-166></A>
<DT><CODE><A NAME=MARKER-2-168></A><A NAME=MARKER-2-168></A>kRegisterBased</CODE>
<DD> The parameters are passed in registers.<A NAME=MARKER-2-169></A>
<DT><CODE><A NAME=MARKER-2-171></A><A NAME=MARKER-2-171></A></CODE>kThinkCStackBased
<DD> The routine follows the C calling conventions employed by the THINK C software development environment. Arguments are passed on the stack from right to left, and a result is returned in register D0. All arguments occupy an even number of bytes on <BR>the stack. An argument having the size of a <CODE>char</CODE> is passed in the high-order byte. You should always provide function prototypes; failure to do so may cause THINK C to generate code that is incompatible with this parameter-passing convention.<A NAME=MARKER-9-17></A><A NAME=MARKER-2-19></A><A NAME=MARKER-2-21></A>
<DT><CODE><A NAME=MARKER-2-176></A><A NAME=MARKER-2-176></A>kD0DispatchedPascalStackBased</CODE>
<DD> The parameters are passed on the stack according to Pascal conventions, and the routine selector is passed in register D0.<A NAME=MARKER-9-25></A>
<DT><CODE><A NAME=MARKER-2-179></A><A NAME=MARKER-2-101></A>kD0DispatchedCStackBased</CODE>
<DD> The parameters are passed on the stack according to C conventions, and the routine selector is passed in register D0.<A NAME=MARKER-2-180></A>
<DT><CODE><A NAME=MARKER-2-182></A><A NAME=MARKER-2-105></A>kD1DispatchedPascalStackBased</CODE>
<DD> The parameters are passed on the stack according to Pascal conventions, and the routine selector is passed in register D1.<A NAME=MARKER-2-444></A>
<DT><CODE><A NAME=MARKER-2-185></A><A NAME=MARKER-2-106></A>kStackDispatchedPascalStackBased</CODE>
<DD> The routine selector and the parameters are passed on the stack.<A NAME=MARKER-2-186></A>
<DT><CODE><A NAME=MARKER-2-188></A><A NAME=MARKER-2-107></A>kSpecialCase</CODE>
<DD> The routine is a special case. You can use the following constants to specify a special case.<A NAME=MARKER-2-189></A><A NAME=MARKER-2-190></A>
</DL>
<PRE>
enum {
   /*special cases*/
   kSpecialCaseHighHook          = 0,
   kSpecialCaseCaretHook         = kSpecialCaseHighHook,
   kSpecialCaseEOLHook           = 1,
   kSpecialCaseWidthHook         = 2,
   kSpecialCaseNWidthHook        = 3,
   kSpecialCaseTextWidthHook     = kSpecialCaseWidthHook,
   kSpecialCaseDrawHook          = 4,
   kSpecialCaseHitTestHook       = 5,
   kSpecialCaseTEFindWord        = 6,
   kSpecialCaseProtocolHandler   = 7,
   kSpecialCaseSocketListener    = 8,
   kSpecialCaseTERecalc          = 9,
   kSpecialCaseTEDoText          = 10,
   kSpecialCaseGNEFilterProc     = 11,
   kSpecialCaseMBarHook          = 12
};
</PRE>
<B><A NAME=MARKER-9-191></A>Constant descriptions</B><P>
<DL>
<DT><CODE><A NAME=MARKER-2-193></A><A NAME=MARKER-2-108></A>kSpecialCaseHighHook</CODE>
<DD> The routine follows the calling conventions documented in <I><A HREF="../Text/Text-2.html">Inside Macintosh: Text</A>;</I> a rectangle is on the stack and a pointer is in register A3; no result is returned.
<DT><CODE><A NAME=MARKER-2-195></A><A NAME=MARKER-2-112></A>kSpecialCaseCaretHook</CODE>
<DD> The routine follows the calling conventions documented in <I><A HREF="../Text/Text-2.html">Inside Macintosh: Text</A>;</I> a rectangle is on the stack and a pointer is in register A3; no result is returned.
<DT><CODE><A NAME=MARKER-2-197></A><A NAME=MARKER-2-197></A>kSpecialCaseEOLHook</CODE>
<DD> Parameters are passed to the routine in registers A3, A4, and D0, and output is returned in the Z flag of the Status Register. An <CODE>EOLHook</CODE> routine has these calling conventions.
<DT><CODE><A NAME=MARKER-2-199></A><A NAME=MARKER-2-114></A>kSpecialCaseWidthHook</CODE>
<DD> Parameters are passed to the routine in registers A0, A3, A4, D0, and D1, and output is returned in register D1. A <CODE>WIDTHHook</CODE> routine has these calling conventions.<A NAME=MARKER-9-106></A>
<DT><CODE><A NAME=MARKER-2-202></A><A NAME=MARKER-2-202></A>kSpecialCaseNWidthHook</CODE>
<DD> Parameters are passed to the routine in registers A0, A2, A3, A4, D0, and D1, and output is returned in register D1. An <CODE>nWIDTHHook</CODE> routine has these calling conventions.<A NAME=MARKER-2-203></A>
<DT><CODE><A NAME=MARKER-2-205></A><A NAME=MARKER-2-119></A>kSpecialCaseTextWidthHook</CODE>
<DD> Parameters are passed to the routine in registers A0, A3, A4, D0, and D1, and output is returned in register D1. A <CODE>TextWidthHook</CODE> routine has these calling conventions.<A NAME=MARKER-2-206></A>
<DT><CODE><A NAME=MARKER-2-208></A><A NAME=MARKER-2-120></A>kSpecialCaseDrawHook</CODE>
<DD> Parameters are passed to the routine in registers A0, A3, A4, D0, and D1, and no result is returned. A <CODE>DRAWHook</CODE> routine has these calling conventions.<A NAME=MARKER-2-209></A>
<DT><CODE><A NAME=MARKER-2-211></A><A NAME=MARKER-2-124></A>kSpecialCaseHitTestHook</CODE>
<DD> Parameters are passed to the routine in registers A0, A3, A4, D0, D1, and D2, and output is returned in registers D0, D1, and D2. A <CODE>HITTESTHook</CODE> routine has these calling conventions.<A NAME=MARKER-2-212></A>
<DT><CODE><A NAME=MARKER-2-214></A><A NAME=MARKER-2-125></A>kSpecialCaseTEFindWord</CODE>
<DD> Parameters are passed to the routine in registers A3, A4, D0, and D2, and output is returned in registers D0 and D1. A <CODE>TEFindWord</CODE> hook has these calling conventions.
<DT><CODE><A NAME=MARKER-2-216></A><A NAME=MARKER-2-216></A>kSpecialCaseProtocolHandler</CODE>
<DD> Parameters are passed to the routine in registers A0, A1, A2, A3, A4, and in the low-order word of register D1; output is returned in the Z flag of the Status Register. A protocol handler has these calling conventions.<A NAME=MARKER-2-217></A>
<DT><CODE><A NAME=MARKER-2-219></A><A NAME=MARKER-2-219></A>kSpecialCaseSocketListener</CODE>
<DD> Parameters are passed to the routine in registers A0, A1, A2, A3, A4, in the low-order byte of register D0, and in the low-order word of register D1; output is returned in the Z flag of the Status Register. A socket listener has these calling conventions.<A NAME=MARKER-2-220></A>
<DT><CODE><A NAME=MARKER-2-222></A><A NAME=MARKER-2-96></A>kSpecialCaseTERecalc</CODE>
<DD> Parameters are passed to the routine in registers A3 and D7, and output is returned in registers D2, D3, and D4. A TextEdit line-start recalculation routine has these calling conventions.<A NAME=MARKER-2-223></A>
<DT><CODE><A NAME=MARKER-2-225></A><A NAME=MARKER-2-136></A>kSpecialCaseTEDoText</CODE>
<DD> Parameters are passed to the routine in registers A3, D3, D4, and D7, and output is returned in registers A0 and D0. A TextEdit text-display, hit-test, and caret-positioning routine has these calling conventions.<A NAME=MARKER-2-226></A>
<DT><CODE><A NAME=MARKER-2-228></A><A NAME=MARKER-2-228></A>kSpecialCaseGNEFilterProc</CODE>
<DD> Parameters are passed to the routine in registers A1 and D0 and on the stack, and output is returned on the stack. A <CODE>GetNextEvent</CODE> filter procedure has these calling conventions.<A NAME=MARKER-2-229></A>
<DT><CODE><A NAME=MARKER-2-231></A><A NAME=MARKER-2-231></A>kSpecialCaseMBarHook</CODE>
<DD> Parameters are passed to the routine on the stack, and output is returned in register D0. A menu bar hook routine has these calling conventions.<A NAME=MARKER-2-232></A><A NAME=MARKER-2-233></A><A NAME=MARKER-2-234></A>
</DL>
 For register-based routines, the registers are encoded in the routine's procedure information using these constants:<P>
<PRE>
enum {
   /*680x0 registers*/
   kRegisterD0                   = 0,
   kRegisterD1                   = 1,
   kRegisterD2                   = 2,
   kRegisterD3                   = 3,
   kRegisterD4                   = 8,
   kRegisterD5                   = 9,
   kRegisterD6                   = 10,
   kRegisterD7                   = 11,
   kRegisterA0                   = 4,
   kRegisterA1                   = 5,
   kRegisterA2                   = 6,
   kRegisterA3                   = 7,
   kRegisterA4                   = 12,
   kRegisterA5                   = 13,
   kRegisterA6                   = 14,
   kCCRegisterCBit               = 16,
   kCCRegisterVBit               = 17,
   kCCRegisterZBit               = 18,
   kCCRegisterNBit               = 19,
   kCCRegisterXBit               = 20
};
</PRE>
<B><A NAME=MARKER-9-235></A>Constant descriptions</B><P>
<DL>
<DT><CODE><A NAME=MARKER-2-237></A><A NAME=MARKER-2-65></A>kRegisterD0</CODE>
<DD> Register D0.
<DT><CODE><A NAME=MARKER-2-239></A><A NAME=MARKER-2-75></A>kRegisterD1</CODE>
<DD> Register D1.
<DT><CODE><A NAME=MARKER-2-241></A><A NAME=MARKER-2-241></A>kRegisterD2</CODE>
<DD> Register D2.
<DT><CODE><A NAME=MARKER-2-243></A><A NAME=MARKER-2-243></A>kRegisterD3</CODE>
<DD> Register D3.
<DT><CODE><A NAME=MARKER-2-245></A><A NAME=MARKER-2-145></A>kRegisterD4</CODE>
<DD> Register D4.
<DT><CODE><A NAME=MARKER-2-247></A><A NAME=MARKER-2-163></A>kRegisterD5</CODE>
<DD> Register D5.
<DT><CODE><A NAME=MARKER-2-249></A><A NAME=MARKER-2-199></A>kRegisterD6</CODE>
<DD> Register D6.
<DT><CODE><A NAME=MARKER-2-251></A><A NAME=MARKER-2-198></A>kRegisterD7</CODE>
<DD> Register D7.
<DT><CODE><A NAME=MARKER-2-253></A><A NAME=MARKER-2-197></A>kRegisterA0</CODE>
<DD> Register A0.
<DT><CODE><A NAME=MARKER-2-255></A><A NAME=MARKER-2-255></A>kRegisterA1</CODE>
<DD> Register A1.
<DT><CODE><A NAME=MARKER-2-257></A><A NAME=MARKER-2-38></A>kRegisterA2</CODE>
<DD> Register A2.
<DT><CODE><A NAME=MARKER-2-259></A><A NAME=MARKER-2-194></A>kRegisterA3</CODE>
<DD> Register A3.
<DT><CODE><A NAME=MARKER-2-261></A><A NAME=MARKER-2-261></A>kRegisterA4</CODE>
<DD> Register A4.
<DT><CODE><A NAME=MARKER-2-263></A><A NAME=MARKER-2-203></A>kRegisterA5</CODE>
<DD> Register A5.
<DT><CODE><A NAME=MARKER-2-265></A><A NAME=MARKER-2-265></A>kRegisterA6</CODE>
<DD> Register A6.
<DT><CODE><A NAME=MARKER-2-267></A><A NAME=MARKER-2-49></A>kCCRegisterCBit</CODE>
<DD> The C (carry) flag of the Status Register.
<DT><CODE><A NAME=MARKER-2-269></A><A NAME=MARKER-2-141></A>kCCRegisterVBit</CODE>
<DD> The V (overflow) flag of the Status Register.
<DT><CODE><A NAME=MARKER-2-271></A><A NAME=MARKER-2-149></A>kCCRegisterZBit</CODE>
<DD> The Z (zero) flag of the Status Register.
<DT><CODE><A NAME=MARKER-2-273></A><A NAME=MARKER-2-152></A>kCCRegisterNBit</CODE>
<DD> The N (negative) flag of the Status Register.
<DT><CODE><A NAME=MARKER-2-275></A><A NAME=MARKER-2-156></A>kCCRegisterXBit</CODE>
<DD> The X (extend) flag of the Status Register.<A NAME=MARKER-2-168></A>
</DL>

</BLOCKQUOTE>
<HR>
<center>
<A HREF="PPCSoftware-22.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="PPCSoftware-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="PPCSoftware-86.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="PPCSoftware-24.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="PPCSoftware-3.html">&copy; Apple Computer, Inc.</A><br>3 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
