<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Opening Connections to Components (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING337></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-336.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-338.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-333.html"><B>Chapter 6 - Component Manager</B></A> / <A HREF="MoreToolbox-336.html"><B>Using the Component Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING337-0></A>
<H2><A NAME=MARKER-9-30></A><A NAME=MARKER-21-31></A>Opening Connections to Components</H2>
 When your application requires the services of a component, you typically perform these steps:<P>
<UL>
<LI>open a connection to the desired component
<LI>use the services of the component
<LI>close the connection to the component<P>
</UL>
 The following sections describe each of these steps in more detail.<P>
<A NAME=HEADING337-6></A>
<H3><A NAME=MARKER-9-33></A>Opening a Connection to a Default Component</H3>
 Your application must use the Component Manager to gain access to a component. The first step is to locate an appropriate component. You can locate the component yourself, or you can allow the Component Manager to locate a suitable component for you. Your application then opens a connection to that component. Once you have opened a connection to a component, you can use the services provided by that component. When you have finished using the component, you should close the connection. <P>
 If you are interested only in using a component of a particular type-subtype and you do not need to specify any other characteristics of the component, use the <CODE>OpenDefaultComponent</CODE> function and specify only the component type and subtype--the Component Manager then selects a component for you and opens a connection to that component. This is the easiest technique for opening a component connection. The <CODE>OpenDefaultComponent</CODE> function searches its list of available components and attempts to open a connection to a component with the specified type and subtype. <BR>If more than one component of the specified type and subtype is available, <CODE>OpenDefaultComponent</CODE> selects the first one in the list. If successful, <BR>the <CODE>OpenDefaultComponent</CODE> function returns a component instance that identifies your connection to the component. You can then use that connection to employ the services of the selected component.<P>
 This code demonstrates the use of the <CODE>OpenDefaultComponent</CODE> function. The code opens a connection to a component of type <CODE>'draw'</CODE> and subtype <CODE>'oval'</CODE>--a drawing component that draws an oval.<P>
<PRE>
VAR
   aDrawOvalComp: ComponentInstance;

   aDrawOvalComp := OpenDefaultComponent('draw', 'oval');
</PRE>
 If it cannot find or open a component of the specified type-subtype, the <CODE>OpenDefaultComponent</CODE> function returns a function result of <CODE>NIL</CODE>. <A NAME=MARKER-2-27></A><P>
 To open a connection to a component with a specific type-subtype-manufacturer code or with other specified characteristics, first use the <CODE>FindNextComponent</CODE> function to find the desired component, then open the component using the <CODE>OpenComponent</CODE> function. These operations are described in the next two sections.<P>
<A NAME=HEADING337-13></A>
<H3>Finding a Specific Component</H3>
 <A NAME=MARKER-9-282></A>If you are interested in asserting greater control over the selection of a component, you can use the Component Manager to find a component that provides a specified service. For example, you can use the <CODE>FindNextComponent</CODE> function in a loop to retrieve information about all the components that are registered on a given computer. Each time you call this function, the Component Manager returns information about a single component. You can obtain a count of all the components on a given computer by calling the <CODE>CountComponents</CODE> function. Both of these functions allow you to specify search criteria, for example, by component type and subtype, or by manufacturer. By using these criteria to narrow your search, you can quickly and easily find a component that meets your needs.<A NAME=MARKER-2-37></A><P>
 You specify the search criteria for the component using a component description record. A component description record is defined by the <CODE>ComponentDescription</CODE> data type. For more information on the fields of this record, see <A HREF=MoreToolbox-347.html#MARKER-9-151>"The Component Description Record" beginning on page 6-36</A>.<P>
<PRE>
TYPE  
    ComponentDescription = 
      RECORD
         componentType:          OSType;     {type}
         componentSubType:       OSType;     {subtype}
         componentManufacturer:  OSType;     {manufacturer}
         componentFlags:         LongInt;    {control flags}
         componentFlagsMask:     LongInt;    {mask for flags}
      END;
</PRE>
 By default, the Component Manager considers all fields of the component description record when performing a search. Your application can override the default behavior of which fields the Component Manager considers for a search. Specify 0 in any field of the component description record to prevent the Component Manager from considering the information in that field when performing the search.<P>
 <A HREF=#MARKER-9-38>Listing 6-1</A> shows an application-defined procedure, <CODE>MyFindVideoComponent</CODE>, that fills out a component description record to specify the search criteria for the desired component. The <CODE>MyFindVideoComponent</CODE> procedure then uses the <CODE>FindNextComponent</CODE> function to return the first component with the specified characteristics--in this example, any component with the type <CODE>VideoDigitizerComponentType</CODE>. <P>
<B>Listing 6-1  <A NAME=MARKER-9-38></A>Finding a component</B><P>
<PRE>
PROCEDURE MyFindVideoComponent(VAR videoCompID: Component);
VAR 
   videoDesc: ComponentDescription;
BEGIN
   {find a video digitizer component}  
   videoDesc.componentType := VideoDigitizerComponentType;
   videoDesc.componentSubType := OSType(0);     {any subtype}
   videoDesc.componentManufacturer:= OSType(0);{any manufacturer}
   videoDesc.componentFlags := 0;         
   videoDesc.componentFlagsMask := 0;        
   videoCompID := FindNextComponent(Component(0), videoDesc);  
END;
</PRE>
 The <CODE>FindNextComponent</CODE> function requires two parameters: a value that indicates which component to begin the search with and a component description record. You can specify 0 in the first parameter to start the search at the beginning of the component list. Alternatively, you can specify a component identifier obtained from a previous call to <CODE>FindNextComponent</CODE>.<P>
 The <CODE>FindNextComponent</CODE> function returns a component identifier to your <BR>application. The returned component identifier identifies a given component to the Component Manager. You can use this identifier to retrieve more information about the component or to open a connection to the component. The next two sections describe these tasks.<A NAME=MARKER-9-123></A><A NAME=MARKER-9-52></A><P>
<A NAME=HEADING337-23></A>
<H3><A NAME=MARKER-9-41></A>Opening a Connection to a Specific Component</H3>
 You can open a connection to a specific component by calling the <CODE>OpenComponent</CODE> function (alternatively, you can use the <CODE>OpenDefaultComponent</CODE> function, as discussed in <A HREF=#MARKER-9-33>"Opening a Connection to a Default Component" on page 6-7</A>). Your application must provide a component identifier to the <CODE>OpenComponent</CODE> function. You get a component identifier from the <CODE>FindNextComponent</CODE> function, as described in the previous section. <P>
 The <CODE>OpenComponent</CODE> function returns a component instance that identifies your connection to the component. <A HREF=#MARKER-9-42>Listing 6-2</A> shows how to use the <CODE>OpenComponent</CODE> function to gain access to a specific component. The application-defined procedure <CODE>MyGetComponent</CODE> uses the <CODE>MyFindVideoComponent</CODE> procedure (defined in <BR><A HREF=#MARKER-9-38>Listing 6-1</A>) to find a video digitizer component and then opens the component.<P>
<B>Listing 6-2  <A NAME=MARKER-9-42></A>Opening a specific component</B><P>
<PRE>
PROCEDURE MyGetComponent
                     (VAR videoCompInstance: ComponentInstance);
VAR
   videoCompID:         Component;
BEGIN
   {first find a video digitizer component}  
   MyFindVideoComponent(videoCompID);
   {now open it}
   IF videoCompID &lt;&gt; NIL THEN
      videoCompInstance := OpenComponent(videoCompID);
END;
</PRE>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-336.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-338.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
