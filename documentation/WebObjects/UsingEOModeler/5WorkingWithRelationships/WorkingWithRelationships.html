<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>EOModeler User Guide (Legacy): Working With Relationships</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Working With Relationships"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../Resources" />
	<meta name="ROBOTS" content="NOINDEX"/>
	<link rel="stylesheet" type="text/css" href="../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30001018-CH205" title="Working With Relationships"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../LegacyTechnologies/index.html#//apple_ref/doc/uid/TP30000440-TP30000470" target="_top">Legacy Documents</a> &gt; <a href="../../../LegacyTechnologies/Tools-date.html#//apple_ref/doc/uid/TP30000440-TP30000470-TP30000463" target="_top">Tools</a> &gt; <a href="../Introduction/Introduction.html#//apple_ref/doc/uid/TP30001018-CH201-TP1">EOModeler User Guide (Legacy)</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../4WorkingWithAttributes/WorkingWithAttributes.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../6WorkingWithEntities/WorkingWithEntities.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        <script type="text/javascript" language="JavaScript">placeWatermark()</script>
<div id="legacyOuterWrapper"><div align="center" id="watermark">
<div class="legacybox">
<h1>Legacy Document<span class="closebutton"><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>
        <a name="//apple_ref/doc/uid/TP30001018-CH205-TP1" title="Working With Relationships"></a><h1>Working With Relationships</h1><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_223"></a><p>This chapter describes how to create and configure relationships in EOModeler. It also provides an introduction to relationships. It is organized in the following sections:</p><ul class="ul"><li class="li"><p><span class="content_text"><a href="WorkingWithRelationships.html#//apple_ref/doc/uid/TP30001018-CH205-BABBBIHC">“About Relationships”</a></span> introduces the concept of relationships as defined by the entity-relational paradigm. It also discusses basic principles of relationships such as cardinality, joins, and relationship keys.</p></li><li class="li"><p><span class="content_text"><a href="WorkingWithRelationships.html#//apple_ref/doc/uid/TP30001018-CH205-BABFFFIH">“Creating Relationships”</a></span> describes how to use EOModeler to create relationships.</p></li><li class="li"><p><span class="content_text"><a href="WorkingWithRelationships.html#//apple_ref/doc/uid/TP30001018-CH205-BABHGAAA">“Tips for Specifying Relationships”</a></span> provides some general design patterns when creating relationships.</p></li><li class="li"><p><span class="content_text"><a href="WorkingWithRelationships.html#//apple_ref/doc/uid/TP30001018-CH205-BABCCJCI">“Adding Referential Integrity Rules”</a></span> discusses the various referential integrity rules supported by Enterprise Objects, such as the delete rules and optionality.</p></li><li class="li"><p><span class="content_text"><a href="WorkingWithRelationships.html#//apple_ref/doc/uid/TP30001018-CH205-BABJGIGE">“Flattened Relationships”</a></span> describes what flattened relationships are and how to form them in EOModeler.</p></li><li class="li"><p><span class="content_text"><a href="WorkingWithRelationships.html#//apple_ref/doc/uid/TP30001018-CH205-BABGHHGG">“Modeling Many-to-Many Relationships”</a></span> discusses how to build many-to-many relationships using EOModeler.</p></li></ul><a name="//apple_ref/doc/uid/TP30001018-CH205-BABBBIHC" title="About Relationships"></a><h2>About Relationships</h2><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_224"></a><p>Relational databases derive much of their value from the relationships between the tables they store. Likewise, the Enterprise Object technology includes infrastructure that brings relationship data to life in data-driven applications.</p><p>A relationship expresses the affinity between tables in a data source. In the most simple case, a relationship expresses a meaningful connection between two tables in a data source. You can also think of relationships as cross-references much like entries in a book’s index. A single index entry can cross-reference one or more other index entries so that there is a relationship between index entries.</p><p>For example, a Person table could be related to a PersonPhoto table by a relationship called <code>toPhoto</code>. In relationship lingo, the Person table is referred to as the source table or source entity that contains source records. The PersonPhoto table is referred to as the destination table or destination entity that contains destination records.</p><a name="//apple_ref/doc/uid/TP30001018-CH205-TPXREF126" title="Directionality"></a><h3>Directionality</h3><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_225"></a><p>Relationships are unidirectional, which means that the path that leads from the source to the destination can’t be traveled in the opposite direction—you can’t use a relationship to go from the destination to the source. So, although you can use a <code>toPhoto</code> relationship to find the photo for a particular person, you can’t use this relationship in reverse to get a person’s name.</p><p>Unidirectionality is enforced by the way a relationship is resolved. Resolving a relationship means finding the correct destination record or records given a specific source record.</p><p>Bidirectional relationships—in which you can look up records in either direction—can be created by adding a separate return-trip, or inverse, relationship. But there is no concept of a single relationship that is bidirectional.</p><a name="//apple_ref/doc/uid/TP30001018-CH205-TPXREF129" title="Cardinality"></a><h3>Cardinality</h3><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_226"></a><p>Every relationship has a <strong>cardinality</strong>. The cardinality defines how many destination records can potentially resolve the relationship. In relational database systems, there are generally two cardinalities:</p><ul class="spaceabove"><li class="li"><p>to-one relationship—for each source record, there is exactly one corresponding destination record</p></li><li class="li"><p>to-many relationship—for each source record, there may be zero, one, or more corresponding destination records</p></li></ul><p>An <code>employeeDepartment</code> relationship is an example of a to-one relationship: An employee can be associated with only one department in a company. An Employee entity might also be associated with a Project entity. In this case, there would be a to-many relationship from Employee to Project called <code>projects</code> since an Employee can have many projects.</p><a name="//apple_ref/doc/uid/TP30001018-CH205-TPXREF127" title="Relationship Keys"></a><h3>Relationship Keys</h3><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_227"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_228"></a><p>The construction of a relationship requires that you designate at least one attribute in each entity as a <strong>relationship key</strong>. Relationship keys are necessary so a relationship can be resolved. For example, the <code>toPhoto</code> relationship which relates a Person entity to a PersonPhoto entity, uses two relationship keys: <code>personPhotoID</code>, the source key in the Person entity, and <code>personPhotoID</code>, the destination key in the PersonPhoto entity. </p><p><span class="content_text">Figure 4-1</span> shows the <code>PERSON</code> table’s columns.</p><br/><div><a name="//apple_ref/doc/uid/TP30001018-CH205-BABCIBGH" title="Figure 4-1Foreign key for PersonPhoto in Person table"></a><p><strong>Figure 4-1&nbsp;&nbsp;</strong>Foreign key for PersonPhoto in Person table</p><img src = "../Art/personphoto_id_inperson.gif" alt = "Foreign key for PersonPhoto in Person table" width="255" height="54"></div><br/><p>When Enterprise Objects resolves this relationship, it creates a join table by looking up the <code>PERSON_PHOTO_ID</code> key in the <code>PERSON_PHOTO</code> table. In <span class="content_text">Figure 4-1</span>, the row with <code>PERSON_ID</code> = <code>2</code> has a value of 1 in the <code>PERSON_PHOTO_ID</code> column. The relationship specifies that the <code>PERSON_PHOTO_ID</code> column in the <code>PERSON</code> table resolves to the <code>PERSON_PHOTO_ID</code> column in the <code>PERSON_PHOTO</code> table. As shown in <span class="content_text">Figure 4-2</span>, the row with <code>PERSON_PHOTO_ID</code> = <code>1</code> in the <code>PERSON_PHOTO</code> table holds binary data that represents a photo.</p><br/><div><a name="//apple_ref/doc/uid/TP30001018-CH205-BABJGJCJ" title="Figure 4-2PersonPhoto primary key in PersonPhoto table"></a><p><strong>Figure 4-2&nbsp;&nbsp;</strong>PersonPhoto primary key in PersonPhoto table</p><img src = "../Art/personphoto_id_in_id.gif" alt = "PersonPhoto primary key in PersonPhoto table" width="193" height="55"></div><br/><p>There are some general guidelines when choosing which attributes to use as relationship keys. In to-one relationships, the destination key must be a primary key in the destination entity. In to-many relationships, the destination key is usually a foreign key in the destination entity (which is most often a copy of the source entity’s primary key). The source key or foreign key should emulate the destination key in that the data types must be the same and the names should be similar.</p><p>So, in the previous example, <code>PERSON_PHOTO_ID</code> is the primary key for the <code>PERSON_PHOTO</code> table and it is a column of type <code>int</code>. In the <code>PERSON</code> table, <code>PERSON_PHOTO_ID</code> is a foreign key that is of the same type and name as the primary key it maps to in the <code>PERSON_PHOTO</code> table.</p><p>When you use relationship keys to express an affiliation between two entities, keep in mind these general rules:<a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_229"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_230"></a></p><ul class="spaceabove"><li class="li"><p>For to-one relationships, the source attribute is a foreign key in the source entity while the destination key is the primary key of the destination entity.</p></li><li class="li"><p>For to-many relationships, the source attribute is the primary key in the source entity (but it can also be a foreign key in the source entity) while the destination key is a foreign key of the destination entity.</p></li></ul><p>If you have consistency checking enabled in EOModeler, it warns you if any to-one relationships in your model have destination keys that are not primary keys.</p><a name="//apple_ref/doc/uid/TP30001018-CH205-TPXREF130" title="Reflexive Relationships"></a><h3>Reflexive Relationships</h3><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_231"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_232"></a><p>A unique kind of relationship is the <strong>reflexive relationship</strong>—a relationship that shares the same source and destination entity. Reflexive relationships are important when modeling data in which an instance of an entity points to another instance of the same entity.</p><p>For example, to show who a given person reports to, you could create a separate manager entity. It would be easier, however, to just create a reflexive relationship. The <code>managerID</code> attribute is the relationship’s source key whereas <code>employeeID</code> is the relationship’s destination key. Where a person’s <code>managerID</code> is the <code>employeeID</code> of another employee object, the first employee reports to the second. If an employee doesn’t have a manager, the value for the <code>managerID</code> attribute is <code>null</code> in that employee’s record.</p><p><span class="content_text">Figure 4-3</span> shows this relationship as it exists in the Employee table. The row with <code>NAME = Brent</code> references the row with <code>NAME = K. Boss</code> since the manager relationship is defined with <code>MANAGER_ID</code> as the source key and <code>EMPLOYEE_ID</code> as the destination key.</p><br/><div><a name="//apple_ref/doc/uid/TP30001018-CH205-BABFJIBH" title="Figure 4-3Reflexive relationship table"></a><p><strong>Figure 4-3&nbsp;&nbsp;</strong>Reflexive relationship table</p><img src = "../Art/reflexive_table.gif" alt = "Reflexive relationship table" width="362" height="57"></div><br/><p>Reflexive relationships can represent arbitrarily deep recursions. So, in the model above, a person can report to another person who reports to yet another person, and so on. This could go on until a person’s <code>managerID</code> attribute is <code>null</code>, which denotes that person reports to no one.</p><a name="//apple_ref/doc/uid/TP30001018-CH205-TPXREF135" title="Owns Destination and Propagate Primary Key"></a><h3>Owns Destination and Propagate Primary Key</h3><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_233"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_234"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_235"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_236"></a><p>The Owns Destination option lets you specify whether the relationship’s source owns its destination objects. When a source object owns its destination object, for example, as when an Agent object owns its Customer objects, when a destination object (Customer) is removed from the relationship, it is also removed from the data source. Ownership implies that an owned object cannot exist without its owner.</p><p>The Propagate Primary Key option lets you specify that the primary key of the source entity should be propagated to newly inserted objects in the destination of the relationship. That is, when inserting objects that are the destination of the relationship, this option suppresses primary key generation for the destination entity and instead uses the source object’s primary key as the primary key for the newly inserted destination object.</p><p>This option is used for an owning relationship where the owned object has the same primary key as the source. Propagating primary key confers a performance improvement as it doesn’t require the generation of a primary key for the destination entity. Primary key propagation is also commonly used to generate primary keys for join tables in many-to-many relationships.</p><a name="//apple_ref/doc/uid/TP30001018-CH205-BABFFFIH" title="Creating Relationships"></a><h2>Creating Relationships</h2><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_237"></a><p>If the data source on which your model is based includes foreign key definitions, these definitions are automatically expressed in your model when you create a model from an existing data source with the New Model Wizard. But if you are creating the schema within EOModeler, you need to define relationships in the model editor. </p><p>EOModeler provides two mechanisms for forming relationships. You can form them in the model editor’s diagram view or in the Relationship Inspector<a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_238"></a>. Using the diagram view is the quickest way to create new relationships, but using the Relationship Inspector gives you access to more relationship characteristics. Each mechanism is discussed in the following sections.</p><a name="//apple_ref/doc/uid/TP30001018-CH205-TPXREF131" title="Forming Relationships in the Diagram View"></a><h3>Forming Relationships in the Diagram View</h3><p>To create a relationship in diagram view, Control-drag from a source attribute to a destination attribute, as shown in <span class="content_text">Figure 5-4</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP30001018-CH205-TPXREF140" title="Figure 4-4Control-drag from source key to destination key to form a relationship"></a><p><strong>Figure 4-4&nbsp;&nbsp;</strong>Control-drag from source key to destination key to form a relationship</p><img src = "../Art/control_drag_rel.gif" alt = "Control-drag from source key to destination key to form a relationship" width="323" height="85"></div><br/><p>The cardinality of the relationship is determined by the primary key characteristic of the destination attribute. If the destination attribute is the entity’s primary key, the relationship is modeled as a to-one relationship. If the destination attribute is a foreign key, the relationship is modeled as a to-many relationship.</p><p>Control-dragging to form a relationship actually creates two relationships: one in the source attribute’s entity and an inverse relationship in the destination attribute’s entity. In <span class="content_text">Figure 4-5</span>, Control-dragging from <code>Person.personPhotoID</code> (a foreign key) to <code>PersonPhoto.personPhotoID</code> (a primary key) creates a to-one relationship from the Person entity to the PersonPhoto entity and a to-many relationship from the PersonPhoto entity to the Person entity. </p><br/><div><a name="//apple_ref/doc/uid/TP30001018-CH205-BABGEJBD" title="Figure 4-5Control-dragging also creates an inverse relationship"></a><p><strong>Figure 4-5&nbsp;&nbsp;</strong>Control-dragging also creates an inverse relationship</p><img src = "../Art/after_control_drag.gif" alt = "Control-dragging also creates an inverse relationship" width="420" height="148"></div><br/><p>In <span class="content_text">Figure 4-5</span>, the single line indicating the relationships between the Person and PersonPhoto entities should not be mistaken for a “bidirectional” relationship, which is not possible in the object-relational model. It is actually two relationships but when you create a relationship in diagram view, it appears as a single line.</p><p>For the <code>personPhoto</code> relationship, it doesn’t make sense for the inverse relationship (<code>persons</code> in PersonPhoto) to be a to-many relationship. You can make it a to-one relationship in the Relationship Inspector<a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_239"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_240"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_241"></a> as well as set other characteristics of the relationship. The Relationship Inspector is described in detail in <span class="content_text"><a href="WorkingWithRelationships.html#//apple_ref/doc/uid/TP30001018-CH205-TPXREF132">“Forming Relationships in the Inspector”</a></span> and <span class="content_text"><a href="WorkingWithRelationships.html#//apple_ref/doc/uid/TP30001018-CH205-TPXREF133">“Forming Relationships Across Models and Data Sources.”</a></span></p><a name="//apple_ref/doc/uid/TP30001018-CH205-TPXREF132" title="Forming Relationships in the Inspector"></a><h3>Forming Relationships in the Inspector</h3><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_242"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_243"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_244"></a><p>Creating relationships in the Relationship Inspector is a more manual process than creating one in the diagram view. The inspector provides only the ability to configure a relationship that already exists. So before you can edit a relationship in the Relationship Inspector, you must add a relationship to an entity. </p><p>Assuming that the entities in the previous example exist (Person and PersonPhoto), you can form a relationship between them by selecting an entity (Person) and then choosing Add Relationship from the Property menu. Then, select the new relationship in the tree view by clicking the plus sign next to an entity and open the Relationship Inspector by choosing Inspector from the Tools menu.</p><p>Now you can use the Relationship Inspector to configure the relationship. Follow these steps and refer to <span class="content_text">Figure 4-6</span> for clarity:</p><ol class="ol"><li class="li"><p>In the Relationship Inspector, select the destination entity (PersonPhoto) from the Entity list in the Destination box.</p></li><li class="li"><p>Select the source attribute (<code>personPhotoID</code>) in the Source Attributes list.</p></li><li class="li"><p>Select the destination attribute (<code>personPhotoID</code>) in the Destination Attributes list.</p></li><li class="li"><p>Make sure the relationship has the proper cardinality, To One in this case.</p></li><li class="li"><p>Click Connect.</p></li></ol><br/><div><a name="//apple_ref/doc/uid/TP30001018-CH205-BABGHDGI" title="Figure 4-6Using the Relationship Inspector to build a relationship"></a><p><strong>Figure 4-6&nbsp;&nbsp;</strong>Using the Relationship Inspector to build a relationship</p><img src = "../Art/personPhotoinInspector.gif" alt = "Using the Relationship Inspector to build a relationship" width="234" height="391"></div><br/><p>EOModeler assigns the relationship a default name based on the name of the destination entity and the cardinality of the relationship. You can edit this name using the Relationship Inspector or in table mode.</p><p>The source and destination attributes you chose are based on general rules for relationships, which are described in <span class="content_text"><a href="WorkingWithRelationships.html#//apple_ref/doc/uid/TP30001018-CH205-TPXREF127">“Relationship Keys.”</a></span></p><a name="//apple_ref/doc/uid/TP30001018-CH205-TPXREF133" title="Forming Relationships Across Models and Data Sources"></a><h3>Forming Relationships Across Models and Data Sources</h3><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_245"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_246"></a><p>The entities in one model can have relationships to the entities in another model. You can form such relationships even if the models map to different databases and different database servers.</p><p>When you add a model to a project, it becomes part of a model group. Every Enterprise Objects application includes a default model group, even if the project contains only one model. Each model you add to a project automatically becomes part of the project’s model group. The only regulation between multiple models in a model group is that entity names must be unique.</p><p>To form a relationship from one model to another, use the Relationship Inspector<a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_247"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_248"></a> as follows:</p><ol class="ol"><li class="li"><p>Add a relationship to the entity you want to use as the source of the relationship.</p></li><li class="li"><p>In the Relationship Inspector, use the Model pop-up menu to choose the model that contains the entity you want to use as the relationship’s destination. This menu displays all the models in the application’s model group. <span class="content_text">Figure 4-7</span> shows two models in an application’s model group, RealEstate and DEO.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001018-CH205-BABHGECF" title="Figure 4-7Multiple models to choose from"></a><p><strong>Figure 4-7&nbsp;&nbsp;</strong>Multiple models to choose from</p><img src = "../Art/multiplemodelsininspector.gif" alt = "Multiple models to choose from" width="349" height="150"></div></li><li class="li"><p>Specify the relationship as you normally would.</p></li></ol><div class="notebox"><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_5" title="Note"></a><p><strong>Note:</strong>&nbsp;You can’t flatten properties across databases, nor can you map inheritance hierarchies across databases (though you can do both of these things across models that map to the same database).<a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_249"></a></p></div><a name="//apple_ref/doc/uid/TP30001018-CH205-BABHGAAA" title="Tips for Specifying Relationships"></a><h2>Tips for Specifying Relationships</h2><p>The following tips are useful to keep in mind as you add relationships to your model:</p><ul class="ul"><li class="li"><p>The relationships you define in a model must reflect corresponding implementations in the data source, as well as the features supported by the adaptor your model uses. Enterprise Objects doesn’t know, for example, if your adaptor supports left outer joins, so you need to be careful with regard to the characteristics you set for relationships.</p></li><li class="li"><p>Use the diagram view to quickly create pairs of inverse relationships by Control-dragging between source and destination attributes.</p></li><li class="li"><p>Use the Relationship Inspector<a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_250"></a> to specify information about a relationship, such as whether it’s to-one or to-many, its semantics (join type), the destination model, and the destination entity in the destination model.</p></li><li class="li"><p>Relationships can be compound, meaning that they can consist of multiple pairs of connected attributes. You can specify additional pairs of attributes only in the Relationship Inspector<a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_251"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_252"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_253"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_254"></a>. Simply select a second source attribute and a second destination attribute and click Connect a second time.</p></li><li class="li"><p>A to-one relationship<a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_255"></a> from one foreign key to a primary key must always have exactly one row in the destination entity—if this isn’t guaranteed to be the case, use a to-many relationship. This rule doesn’t apply to a foreign key to primary key relationship where a <code>null</code> value for the foreign key in the source row indicates that no row exists in the destination.</p></li><li class="li"><p>To-one relationships must join on the complete primary key of the destination entity.</p></li></ul><a name="//apple_ref/doc/uid/TP30001018-CH205-BABCCJCI" title="Adding Referential Integrity Rules"></a><h2>Adding Referential Integrity Rules</h2><p>You can use the Advanced Relationship Inspector<a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_256"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_257"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_258"></a> to add referential integrity rules for relationships. These rules specify relationship characteristics such as optionality and delete rule. The referential integrity rules you specify are not written back to the data source: When Enterprise Objects creates objects for relationships, the objects include the referential integrity rules you specify in the model.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_6" title="Note"></a><p><strong>Note:</strong>&nbsp;The referential integrity rules you specify apply only to the object graph managed by Enterprise Objects. Therefore, if your data source also specifies referential integrity rules, you are responsible for avoiding or managing any conflicts between the two sets of rules.</p></div><a name="//apple_ref/doc/uid/TP30001018-CH205-TPXREF134" title="Optionality"></a><h3>Optionality</h3><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_259"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_260"></a><p>The Optionality section lets you specify whether a relationship is optional or mandatory. For example, you could require that all Document objects have a related Writer object but not require that all Document objects have a related Illustrator object. When you attempt to save an object that has a mandatory relationship that is not set (so the relationship is <code>null</code>), Enterprise Objects refuses the save and displays an error message stating that the object being saved has a mandatory relationship that must be set.</p><a name="//apple_ref/doc/uid/TP30001018-CH205-TPXREF137" title="Delete Rule"></a><h3>Delete Rule</h3><p>The options in the Delete Rule section specify what to do when the source object of a relationship is deleted. There are four options:</p><ul class="spaceabove"><li class="li"><p><strong>Nullify</strong><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_261"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_262"></a> disassociates all destination objects from the source object by removing references to them. So, when an Agent object is deleted, its related Customer objects are not deleted but the Customer objects’ references to Agent are nullified (the entry in the join table is set to <code>null</code>).</p></li><li class="li"><p><strong>Cascade</strong><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_263"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_264"></a> deletes all objects that are the destination of a relationship whose source is deleted. So, when an Agent object is deleted, all of its related Customer objects are also deleted.</p></li><li class="li"><p><strong>Deny</strong><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_265"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_266"></a> refuses the deletion if a source object has any destination objects. So, if an Agent object has any Customer objects, deleting the Agent object is denied. In order for the deletion of the Agent object to succeed, its destination objects (Customer objects) must either be deleted or changed to something other than destination objects of the Agent object.</p></li><li class="li"><p><strong>No Action</strong><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_267"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_268"></a> deletes the destination object but does not remove any back references to the source object. So, if a Customer object is deleted, its reference to its Agent object is not removed. Using this option may result in dangling references in the data source.</p></li></ul><a name="//apple_ref/doc/uid/TP30001018-CH205-BABJGIGE" title="Flattened Relationships"></a><h2>Flattened Relationships</h2><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_269"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_270"></a><p><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_271"></a>Just as you can flatten attributes (see <span class="content_text"><a href="../4WorkingWithAttributes/WorkingWithAttributes.html#//apple_ref/doc/uid/TP30001018-CH204-BABGGEFA">“Flattened Attributes”</a></span>), you can also flatten relationships. Flattening a relationship gives a source entity access to relationships that a destination has with other entities. It’s equivalent to performing a multitable join. Note that flattening either an attribute or a relationship can result in degraded performance when the destination objects are accessed, since traversing multiple tables makes fetches slower.</p><a name="//apple_ref/doc/uid/TP30001018-CH205-TPXREF138" title="When Should You Flatten Relationships?"></a><h3>When Should You Flatten Relationships?</h3><p>As discussed in <span class="content_text"><a href="../4WorkingWithAttributes/WorkingWithAttributes.html#//apple_ref/doc/uid/TP30001018-CH204-BABFBCHJ">“When Should You Flatten Attributes?,”</a></span> flattening is a technique you should use only under certain conditions. Instead of flattening an attribute or a relationship, you can instead directly traverse the object graph, either programmatically or by using key paths. This ensures that your application maintains an internally consistent view of its data.</p><p>There is one scenario in which you might want to use a flattened relationship: If you’re modeling a many-to-many relationship and you want to perform a multitable hop to access a table that lies on the other side of an intermediate table.</p><p>For example, in the Real Estate database, the Suggestion table acts as an intermediate table between Customer and Listing. It’s highly unlikely that you would ever need to fetch instances of Suggestion into your application. In this situation, it makes sense to specify a relationship between Customer and Suggestion and flatten that relationship to give Customer access to the Listing table.</p><a name="//apple_ref/doc/uid/TP30001018-CH205-TPXREF139" title="Flattening a Relationship"></a><h3>Flattening a Relationship</h3><p>Follow these steps to flatten a relationship:</p><ol class="ol"><li class="li"><p>Add a relationship from one entity (entity_1) to a second entity (entity_2). For example, add a to-many relationship called <code>suggestions</code> from Customer to Suggestion.</p></li><li class="li"><p>Add a relationship from entity_2 (Suggestion) to a third entity (entity_3, Listing). For example, add a to-many relationship called <code>listing</code> from Suggestion to Listing.</p></li><li class="li"><p>In browser mode, from entity_1 (Customer), select the relationship to entity_2 (<code>suggestions</code>) to display its attributes and relationships.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001018-CH205-TPXREF141" title="Figure 4-8Select the relationship that contains the relationship to flatten"></a><p><strong>Figure 4-8&nbsp;&nbsp;</strong>Select the relationship that contains the relationship to flatten</p><img src = "../Art/selectsuggestionsrel.gif" alt = "Select the relationship that contains the relationship to flatten" width="342" height="175"></div></li><li class="li"><p>In the list of attributes and relationships for entity_2 (Suggestion), select the relationship (<code>listing</code>) you want to flatten.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001018-CH205-TPXREF142" title="Figure 4-9Select the relationship to flatten"></a><p><strong>Figure 4-9&nbsp;&nbsp;</strong>Select the relationship to flatten</p><img src = "../Art/selectlistingsrelinsuggrel.gif" alt = "Select the relationship to flatten" width="488" height="188"></div></li><li class="li"><p>Choose Flatten Property from the Property menu. The flattened relationship should appear in bold typeface as shown in <span class="content_text">Figure 4-10</span>; the name is derived from the relationship key path.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001018-CH205-BABHACID" title="Figure 4-10A flattened relationship displayed in browser mode"></a><p><strong>Figure 4-10&nbsp;&nbsp;</strong>A flattened relationship displayed in browser mode</p><img src = "../Art/flattendrelresult.gif" alt = "A flattened relationship displayed in browser mode" width="454" height="153"></div></li></ol><p>The flattened relationship (in this example, <code>suggestions_listing</code>) appears in the list of properties for Customer<a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_272"></a>.</p><a name="//apple_ref/doc/uid/TP30001018-CH205-BABGHHGG" title="Modeling Many-to-Many Relationships "></a><h2>Modeling Many-to-Many Relationships </h2><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_273"></a><a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_274"></a><p>Modeling a many-to-many relationship between objects is simple: Each object manages a collection of the other kind. For example, consider the many-to-many relationship between employees and projects. To think of this relationship in objects, an Employee object has an array of Project objects representing all of the projects the employee works on; and a Project object has an array of Employee objects representing the people working on the project.</p><p>To model a many-to-many relationship in a database, you have to create an intermediate table (also known as a correlation or join table). For example, the database for employees and projects might have <code>EMPLOYEE</code>, <code>PROJECT</code>, and <code>EMPLOYEE_PROJECT</code> tables, where <code>EMPLOYEE_PROJECT</code> is the correlation table.</p><p>Given the relational database representation of a many-to-many relationship, how do you get the object model you want? You don’t want to see evidence of the correlation table in your object model, and you don’t want to write code to maintain database correlation rows. With Enterprise Objects, fortunately, you don’t have to. You can simply use flattened relationships to hide correlation tables.</p><p>A model with the following features has the effect of hiding the <code>EMPLOYEE_PROJECT</code> correlation table from its object model:</p><ul class="ul"><li class="li"><p>Employee and Project entities whose to-many relationships to the EmployeeProject entity are not class properties. These to-many relationships (named <code>projectEmployees</code> in this example) are never instantiated or used at the application level.</p></li><li class="li"><p>The flattened relationships <code>projects</code> and <code>employees</code> in Employee and Project, respectively, are class properties.</p></li></ul><p>Consequently, EmployeeProject enterprise objects are never created, Employee objects have an array of related Projects, and Project objects have an array of related Employees. Furthermore, Enterprise Objects automatically manages rows in the <code>EMPLOYEE_PROJECT</code> correlation table.</p><p>Still, creating a model with the parameters described in this section would take quite a bit of work and would be error prone. Fortunately, EOModeler does all the work for you. </p><p>Follow these steps to create a many-to-many relationship between two entities:</p><ol class="ol"><li class="li"><p>Switch to diagram view.</p></li><li class="li"><p>Select the entities you want to join in a many-to-many relationship.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001018-CH205-BABCIHBJ" title="Figure 4-11Two entities before joining in a many-to-many relationship"></a><p><strong>Figure 4-11&nbsp;&nbsp;</strong>Two entities before joining in a many-to-many relationship</p><img src = "../Art/manytomanybefore.gif" alt = "Two entities before joining in a many-to-many relationship" width="276" height="65"></div></li><li class="li"><p>Choose Join in Many-to-Many from the Property menu.</p></li></ol><p>This creates a join table between the two entities, adds flattened relationships in the two entities, and sets the class property characteristic for the new relationship as described in this section. The two entities in <span class="content_text">Figure 4-11</span> when joined in a many-to-many relationship appear in the diagram view as shown<a name="//apple_ref/doc/uid/TP30001018-CH205-DontLinkElementID_275"></a> in <span class="content_text">Figure 4-12</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP30001018-CH205-BABHJEDC" title="Figure 4-12Two entities after being joined in a many-to-many relationship"></a><p><strong>Figure 4-12&nbsp;&nbsp;</strong>Two entities after being joined in a many-to-many relationship</p><img src = "../Art/manytomanyafter.gif" alt = "Two entities after being joined in a many-to-many relationship" width="500" height="184"></div><br/>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../4WorkingWithAttributes/WorkingWithAttributes.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../6WorkingWithEntities/WorkingWithEntities.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2002, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-05-23<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/WebObjects/UsingEOModeler/5WorkingWithRelationships/WorkingWithRelationships.html%3Fid%3DTP30001018-2.2&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/WebObjects/UsingEOModeler/5WorkingWithRelationships/WorkingWithRelationships.html%3Fid%3DTP30001018-2.2&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/WebObjects/UsingEOModeler/5WorkingWithRelationships/WorkingWithRelationships.html%3Fid%3DTP30001018-2.2&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>