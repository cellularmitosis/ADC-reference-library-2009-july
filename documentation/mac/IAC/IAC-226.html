<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>AESend(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING226></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-225.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-227.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-195.html"><B>Chapter 5 - Creating and Sending Apple Events</B></A> / <A HREF="IAC-204.html"><B>Reference to Creating and Sending Apple Events</B></A><BR><DL><DD><A HREF="IAC-205.html"><B>Routines for Creating and Sending Apple Events</B></A> / <A HREF="IAC-225.html"><B>Sending Apple Events</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING226-0></A>
<H3>AESend</H3>
 You can use the <CODE>AESend</CODE> function to send an Apple event.<P>
<PRE>
FUNCTION AESend (theAppleEvent: AppleEvent; 
                 VAR reply: AppleEvent; sendMode: AESendMode; 
                 sendPriority: AESendPriority; 
                 timeOutInTicks: LongInt; idleProc: IdleProcPtr; 
                 filterProc: EventFilterProcPtr): OSErr;
</PRE>
<DL>
<DT><CODE>theAppleEvent</CODE>
<DD> <BR>The Apple event to be sent.
<DT><CODE>reply</CODE> 
<DD> The reply Apple event returned by the <CODE>AESend</CODE> function if you specify the <CODE>kAEWaitReply</CODE> flag in the <CODE>sendMode</CODE> parameter. (If you specify the <CODE>kAEQueueReply</CODE> flag in the <CODE>sendMode</CODE> parameter, you receive the reply Apple event in your event queue.) If you specify <CODE>kAENoReply</CODE> flag, the reply Apple event returned by this function is a null descriptor record. If you specify <CODE>kAEWaitReply</CODE> in the <CODE>sendMode</CODE> parameter, your application is responsible for using the <CODE>AEDisposeDesc</CODE> function to dispose of the descriptor record returned in the <CODE>reply</CODE> parameter.
<DT><CODE>sendMode</CODE>
<DD> Specifies the following: the reply mode for the Apple event (set with one of the constants <CODE>kAENoReply</CODE>, <CODE>kAEQueueReply</CODE>, or <CODE>kAEWaitReply</CODE>); the interaction level (set with one of the constants <CODE>kAENeverInteract</CODE>, <CODE>kAECanInteract</CODE>, or <CODE>kAEAlwaysInteract</CODE>, which represent flags in the <CODE>keyInteractLevelAttr</CODE> attribute); the application switch mode (set with the <CODE>kAECanSwitchLayer</CODE> constant); the reconnection mode (set with the <CODE>kAEDontReconnect</CODE> constant); and the return receipt mode (set with the <CODE>kAEWantReceipt</CODE> constant). You obtain the value for this parameter by adding the appropriate constants. (The description that follows provides more details about the <CODE>sendMode</CODE> flags.)
<DT><CODE>sendPriority</CODE>
<DD> <BR>An integer of data type <CODE>AESendPriority</CODE> that specifies whether the Apple event is put at the back of the event queue (indicated by the <CODE>kAENormalPriority</CODE> flag) or at the front of the queue (indicated by the <CODE>kAEHighPriority</CODE> flag). <A NAME=MARKER-2-190></A><A NAME=MARKER-2-38></A> <A NAME=MARKER-21-103></A>
<DT><CODE>timeOutInTicks</CODE>
<DD> <BR>If the reply mode specified in the <CODE>sendMode</CODE> parameter is <CODE>kAEWaitReply</CODE>, or if a return receipt is requested, this parameter specifies the length of time (in ticks) that the client application is willing to wait for the reply or return receipt from the server application before timing out. Most applications should use the <CODE>kAEDefaultTimeout</CODE> constant, which tells the Apple Event Manager to provide an appropriate timeout duration. If the value of this parameter is <CODE>kNoTimeOut</CODE>, the Apple event never times out.
<DT><CODE>idleProc</CODE> 
<DD> A pointer to a function that handles events (such as update, operating-system, activate, and null events) that your application receives while waiting for a reply. Your application can also perform other tasks (such as displaying a wristwatch or spinning beachball cursor) while waiting for a reply or a return receipt. Your application must provide an idle function if it specifies the <CODE>kAEWaitReply</CODE> flag in the <CODE>sendMode</CODE> parameter.
<DT><CODE>filterProc</CODE>
<DD> A pointer to a function that accepts certain incoming Apple events that are received while the handler waits for a reply or a return receipt and filters out the rest.
</DL>
<A NAME=HEADING226-10></A>
<H5>DESCRIPTION</H5>
 <A NAME=MARKER-2-193></A>You can use one of the following flags in the <CODE>sendMode</CODE> parameter to specify the reply mode for an Apple event. Only one of these flags may be set.<CODE>
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Flag<TH>Description<TR>
<TD>kAENoReply<TD>Your application does not want a reply Apple event; the server processes your Apple event as soon as it has the opportunity.<TR>
<TD>kAEQueueReply<TD>Your application wants a reply Apple event; the reply appears in your event queue as soon as the server has the opportunity to process and respond to your Apple event.<TR>
<TD>kAEWaitReply<TD>Your application wants a reply Apple event and is willing to give up the processor while waiting for the reply; for example, if the server application is on the same computer as your application, your application yields the processor to allow the server to respond to your Apple event. If you specify <CODE>kAEWaitReply</CODE>, you should provide an idle function. <CODE></CODE></TABLE>
</CODE><P>
 You can communicate your user interaction preferences to the server application by specifying one of the following flags in the <CODE>sendMode</CODE> parameter. Only one of these flags may be set.
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Flag<TH>Description<TR>
<TD>kAENeverInteract<TD>The server application should never interact with the user in response to the Apple event. If this flag is set, <CODE>AEInteractWithUser</CODE> returns the <CODE>errAENoUserInteraction</CODE> result code. This flag is the default when an Apple event is sent to a remote application.<TR>
<TD>kAECanInteract<TD>The server application can interact with the user in response to the Apple event--by convention, if the user needs to supply information to the server. If this flag is set and the server allows interaction, <CODE>AEInteractWithUser</CODE> either brings the server application to the foreground or posts a notification request. This flag is the default when an Apple event is sent to a local application.<TR>
<TD>kAEAlwaysInteract<TD>The server application can interact with the user in response to the Apple event--by convention, whenever the server application normally asks a user to confirm a decision or interact in any other way, even if no additional information is needed from the user. If this flag is set and the server allows interaction, <CODE>AEInteractWithUser</CODE> either brings the server application to the foreground or posts a notification request.<A NAME=MARKER-21-115></A></TABLE>
<P>
 The flags in the following list specify the application switch mode, the reconnection mode, and the return receipt mode. Any of these flags may be set.
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Flag<TH>Description<TR>
<TD>kAECanSwitchLayer<TD>If both the client and server allow interaction, and if the client application is the active application on the local computer and is waiting for a reply (that is, it has set the <CODE>kAEWaitReply</CODE> flag), <CODE>AEInteractWithUser</CODE> brings the server directly to the foreground. Otherwise, <CODE>AEInteractWithUser</CODE> uses the Notification Manager to request that the user bring the server application to the foreground.<TR>
<TD>kAEDontReconnect<TD>The Apple Event Manager must not automatically try to reconnect if it receives a <CODE>sessClosedErr</CODE> result code from the PPC Toolbox.<TR>
<TD>kAEWantReceipt<TD>The sender wants to receive a return receipt for this Apple event from the Event Manager. (A return receipt means only that the receiving application accepted the Apple event; the Apple event may or may not be handled successfully after it is accepted.) If the receiving application does not send a return receipt before the request times out, <CODE>AESend</CODE> returns <CODE>errAETimeout</CODE> as its function result.</TABLE>
<P>
 If the Apple Event Manager cannot find a handler for an Apple event in either the application or system Apple event dispatch table, it returns the result code <CODE>errAEEventNotHandled</CODE> to the server application (as the result of the <CODE>AEProcessAppleEvent</CODE> function). If the client application is waiting for a reply, the Apple Event Manager also returns this result code to the client.<P>
 The <CODE>AESend</CODE> function returns <CODE>noErr</CODE> as its function result if the Apple event was successfully sent by the Event Manager. A <CODE>noErr</CODE> result from <CODE>AESend</CODE> does not indicate that the Apple event was handled successfully; it indicates only that the Apple event was successfully sent by the Event Manager. If the handler returns a result code other than <CODE>noErr</CODE>, and if the client is waiting for a reply, it is returned in the <CODE>keyErrorNumber</CODE> parameter of the reply Apple event.<A NAME=MARKER-0-194></A><P>
 If your application is sending an event to itself, you can set one of these flags to prevent the event from being recorded or to ask the Apple Event Manager to record the event without your application actually receiving it. Only one of these flags may be set.
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Flag<TH>Description<TR>
<TD>kAEDontRecord<TD>Your application is sending an event to itself but does not want the event recorded. When Apple event recording is on, the Apple Event Manager records a copy of every event your application sends to itself except for those events for which this flag is set. <A NAME=MARKER-9-37></A><TR>
<TD>kAEDontExecute<TD>Your application is sending an Apple event to itself for recording purposes only--that is, you want the Apple Event Manager to send a copy of the event to the recording process but you do not want your application actually to receive the event. <A NAME=MARKER-2-22></A></TABLE>
<P>
<A NAME=HEADING226-17></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>eLenErr<TD>-92<TD>Buffer too big to send<TR>
<TD>memFullErr<TD>-108<TD>Not enough room in heap zone<TR>
<TD>userCanceledErr<TD>-128<TD>User canceled an operation<TR>
<TD>procNotFound<TD>-600<TD>No eligible process with specified process serial number<TR>
<TD>connectionInvalid<TD>-609<TD>Nonexistent signature or session ID<TR>
<TD>noUserInteractionAllowed<TD>-610<TD>Background application sends event requiring authentication<TR>
<TD>noPortErr<TD>-903<TD>Client hasn't set <CODE>'SIZE'</CODE> resource to indicate awareness of high-level events<TR>
<TD>destPortErr<TD>-906<TD>Server hasn't set <CODE>'SIZE'</CODE> resource to indicate awareness of high-level events, or else is not present<TR>
<TD>sessClosedErr<TD>-917<TD>The <CODE>kAEDontReconnect</CODE> flag in the <CODE>sendMode</CODE> parameter was set and the server quit, then restarted<TR>
<TD>errAEEventNotHandled<TD>-1708<TD>Event wasn't handled by an Apple event handler<TR>
<TD>errAEUnknownSendMode<TD>-1710<TD>Invalid sending mode was passed<TR>
<TD>errAEWaitCanceled<TD>-1711<TD>User canceled out of wait loop for reply or receipt<TR>
<TD>errAETimeout<TD>-1712<TD>Apple event timed out<TR>
<TD>errAEUnknownAddressType<TD>-1716<TD>Unknown Apple event address type<A NAME=MARKER-21-227></A></TABLE>
</H5>
<A NAME=HEADING226-18></A>
<H5>SEE ALSO</H5>
 For more information on sending Apple events, see <A HREF=IAC-200.html#MARKER-9-87>"Sending an Apple Event,"</A> which begins on <A HREF=IAC-200.html#MARKER-9-87>page 5-13</A>.<P>
 For information on writing an idle function, see <A HREF=IAC-202.html#MARKER-9-123>"Writing an Idle Function,"</A> which begins on <A HREF=IAC-202.html#MARKER-9-123>page 5-22</A>.<P>
 For information on writing a reply filter function, see <A HREF=IAC-203.html#MARKER-9-130>"Writing a Reply Filter Function,"</A> which begins on <A HREF=IAC-203.html#MARKER-9-130>page 5-24</A>. <A NAME=MARKER-2-147></A><P>
 For information on when to use the <CODE>kAEDontExecute</CODE> flag, see the chapter "Recording Apple Events" in this book.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-225.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-227.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
