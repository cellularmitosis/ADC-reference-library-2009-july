<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>EOModeler User Guide (Legacy): Working With Attributes</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Working With Attributes"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../Resources" />
	<meta name="ROBOTS" content="NOINDEX"/>
	<link rel="stylesheet" type="text/css" href="../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30001018-CH204" title="Working With Attributes"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../LegacyTechnologies/index.html#//apple_ref/doc/uid/TP30000440-TP30000470" target="_top">Legacy Documents</a> &gt; <a href="../../../LegacyTechnologies/Tools-date.html#//apple_ref/doc/uid/TP30000440-TP30000470-TP30000463" target="_top">Tools</a> &gt; <a href="../Introduction/Introduction.html#//apple_ref/doc/uid/TP30001018-CH201-TP1">EOModeler User Guide (Legacy)</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../3UsingModeler/UsingModeler.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../5WorkingWithRelationships/WorkingWithRelationships.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        <script type="text/javascript" language="JavaScript">placeWatermark()</script>
<div id="legacyOuterWrapper"><div align="center" id="watermark">
<div class="legacybox">
<h1>Legacy Document<span class="closebutton"><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>
        <a name="//apple_ref/doc/uid/TP30001018-CH204-TP1" title="Working With Attributes"></a><h1>Working With Attributes</h1><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_147"></a><p>This chapter is divided into the following sections:</p><ul class="ul"><li class="li"><p><span class="content_text"><a href="WorkingWithAttributes.html#//apple_ref/doc/uid/TP30001018-CH204-BABDIHEB">“Attribute Characteristics”</a></span> describes all the possible characteristics attributes can have, including value class, value type, and read and write formats. It also describes how to edit each characteristic.</p></li><li class="li"><p><span class="content_text"><a href="WorkingWithAttributes.html#//apple_ref/doc/uid/TP30001018-CH204-BABBEBAI">“More About Attribute Characteristics”</a></span> provides more detail on certain characteristics like class property, locking, definition (derived attributes), and primary key.</p></li><li class="li"><p><span class="content_text"><a href="WorkingWithAttributes.html#//apple_ref/doc/uid/TP30001018-CH204-BABJICFI">“Prototype Attributes”</a></span> discusses what prototype attributes are, how to create them, and how to assign them to attributes.</p></li><li class="li"><p><span class="content_text"><a href="WorkingWithAttributes.html#//apple_ref/doc/uid/TP30001018-CH204-BABGGEFA">“Flattened Attributes”</a></span> discusses when and how to flatten attributes.</p></li></ul><a name="//apple_ref/doc/uid/TP30001018-CH204-BABDIHEB" title="Attribute Characteristics"></a><h2>Attribute Characteristics</h2><p>EOModeler provides three mechanisms for viewing and modifying an entity’s attributes: the table mode of the model editor, the diagram view of the model editor, and the Attribute Inspector<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_148"></a>. You can use any of the mechanisms to examine the characteristics of your model’s attributes and to make refinements. Each has advantages over the other and is useful in different circumstances.</p><p>To display an entity’s attributes in table mode, select an entity in the tree view. <span class="content_text">Figure 3-1</span> shows the attributes of an entity called Rating.</p><br/><div><a name="//apple_ref/doc/uid/TP30001018-CH204-CIHFHECC" title="Figure 3-1An entity&acirc;&#128;&#153;s attributes"></a><p><strong>Figure 3-1&nbsp;&nbsp;</strong>An entity’s attributes</p><img src = "../Art/attribute_more_columns.gif" alt = "An entity’s attributes" width="517" height="170"></div><br/><p>Each table column corresponds to a single characteristic of the attribute, such as its name, external type, or precision. By default, the columns included in this view represent only a subset of possible characteristics you can set for a given attribute. To add columns for additional characteristics, you use the Add Column pop-up menu in the lower-left corner of the table, as shown in <span class="content_text">Figure 3-1</span>. You can also resize and rearrange columns in the table.<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_149"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_150"></a></p><p><span class="content_text">Table 4-1</span> describes the characteristics you can set for an attribute. Unless otherwise specified, the instructions are for editing the characteristic in the model editor’s table mode. Some of the characteristics are described in more detail in the cross-referenced sections.</p><a name="//apple_ref/doc/uid/TP30001018-CH204-TPXREF136" title="Table 3-1Attribute characteristic definitions"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 3-1&nbsp;&nbsp;</strong>Attribute characteristic definitions</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Characteristic</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>What it is</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>How you modify it</p></th></tr><tr><td  scope="row"><p>Allows Null<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_151"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_152"></a></p></td><td ><p>Indicates whether the attribute can have a <code>null</code> value. See <span class="content_text"><a href="WorkingWithAttributes.html#//apple_ref/doc/uid/TP30001018-CH204-TPXREF127">“Allows Null.”</a></span></p></td><td ><p>Click in the column with the checkmark to toggle the option on and off. You can also edit this characteristic in the Attribute Inspector.</p></td></tr><tr><td  scope="row"><p>Class Property<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_153"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_154"></a></p></td><td ><p>Indicates that you want to include the attribute in your Enterprise Object classes. See <span class="content_text"><a href="WorkingWithAttributes.html#//apple_ref/doc/uid/TP30001018-CH204-TPXREF128">“Class Property.”</a></span></p></td><td ><p>Click in the diamond column to toggle the option on and off. You can also edit this characteristic in diagram view.</p></td></tr><tr><td  scope="row"><p>Client-Side Class Property<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_155"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_156"></a></p></td><td ><p>Indicates that you want to include the attribute in your Enterprise Object classes that live on the client side of Java Client applications. See <span class="content_text"><a href="WorkingWithAttributes.html#//apple_ref/doc/uid/TP30001018-CH204-TPXREF129">“Client-Side Class Property.”</a></span></p></td><td ><p>Click in the column with the two opposing arrows to toggle the option on and off.</p></td></tr><tr><td  scope="row"><p>Column<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_157"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_158"></a></p></td><td ><p>The name of the column in the data source that corresponds to the attribute.</p></td><td ><p>Edit the table cell.</p></td></tr><tr><td  scope="row"><p>Definition<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_159"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_160"></a></p></td><td ><p>The SQL definition for a derived attribute. Note that Column and Definition are mutually exclusive; you can’t set both. Setting one clears the other. See <span class="content_text"><a href="WorkingWithAttributes.html#//apple_ref/doc/uid/TP30001018-CH204-TPXREF130">“Definition (Derived Attributes).”</a></span></p></td><td ><p>Edit the table cell.</p></td></tr><tr><td  scope="row"><p>External Type<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_161"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_162"></a></p></td><td ><p>The data type of the attribute as it’s understood by the data source.</p></td><td ><p>Choose a value from the pop-up menu.</p></td></tr><tr><td  scope="row"><p>Locking<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_163"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_164"></a></p></td><td ><p>Indicates whether an attribute participates in optimistic locking. See <span class="content_text"><a href="WorkingWithAttributes.html#//apple_ref/doc/uid/TP30001018-CH204-BABBDEIE">“Locking.”</a></span></p></td><td ><p>Click in the pad-lock column to toggle locking off and on for a particular attribute. You can also edit this characteristic in diagram view.</p></td></tr><tr><td  scope="row"><p>Name<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_165"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_166"></a></p></td><td ><p>The name of the attribute as it appears in your application and in your enterprise objects. EOModeler derives a default name based on the corresponding column in the data source which you can edit if necessary.</p></td><td ><p>Edit the table cell. You can also edit this characteristic in diagram view.</p></td></tr><tr><td  scope="row"><p>Precision<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_167"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_168"></a></p></td><td ><p>The number of significant digits. The number 12.34 has a precision of four and a scale of 2.</p></td><td ><p>Edit the table cell or use the Attribute Inspector.</p></td></tr><tr><td  scope="row"><p>Primary Key<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_169"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_170"></a></p></td><td ><p>Declares whether a property is or is part of the entity’s primary key. See <span class="content_text"><a href="../1DataModeling/DataModeling.html#//apple_ref/doc/uid/TP30001018-CH202-TPXREF131">“Primary Key.”</a></span></p></td><td ><p>Click in the key column to toggle the primary key off and on. You can also edit this characteristic in diagram view.</p></td></tr><tr><td  scope="row"><p>Prototype<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_171"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_172"></a></p></td><td ><p>A prototype attribute from which this attribute derives its characteristics. See <span class="content_text"><a href="WorkingWithAttributes.html#//apple_ref/doc/uid/TP30001018-CH204-BABJICFI">“Prototype Attributes.”</a></span></p></td><td ><p>Choose a value from the pop-up menu. See <span class="content_text"><a href="WorkingWithAttributes.html#//apple_ref/doc/uid/TP30001018-CH204-BABJICFI">“Prototype Attributes”</a></span> to learn where these values are defined.</p></td></tr><tr><td  scope="row"><p>Read Format<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_173"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_174"></a></p></td><td ><p>The format string that’s used to format the attribute’s value for SQL SELECT statements. In the string, %P is replaced by the attribute’s external name. This string is used whenever the attribute is referenced in a SQL select statement or qualifier. See <span class="content_text"><a href="WorkingWithAttributes.html#//apple_ref/doc/uid/TP30001018-CH204-BABCHIIF">“Read Format and Write Format.”</a></span></p></td><td ><p>Edit the table cell.</p></td></tr><tr><td  scope="row"><p>Read Only<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_175"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_176"></a></p></td><td ><p>Indicates whether the attribute is read only.</p></td><td ><p>Use the Advanced Attribute Inspector.</p></td></tr><tr><td  scope="row"><p>Scale<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_177"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_178"></a></p></td><td ><p>The number of digits to the right of the decimal point. Can be negative. Applies only to noninteger, numerical types. The number 12.34 has a scale of 2.</p></td><td ><p>Edit the table cell or use the Attribute Inspector.</p></td></tr><tr><td  scope="row"><p>Value Class</p></td><td ><p>Not applicable in WebObjects 5.</p></td><td ><p></p></td></tr><tr><td  scope="row"><p>Value Class (Java)<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_179"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_180"></a></p></td><td ><p>The Java type to which the attribute will be coerced in your enterprise objects.</p></td><td ><p>Edit the table cell or use the Attribute Inspector.</p></td></tr><tr><td  scope="row"><p>Value Class (Obj-C)</p></td><td ><p>Not applicable in WebObjects 5.</p></td><td ><p></p></td></tr><tr><td  scope="row"><p>Value Type<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_181"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_182"></a></p></td><td ><p>The conversion character (such as “i” or “d”) the JDBC adaptor uses to communicate with the data source. See <span class="content_text"><a href="WorkingWithAttributes.html#//apple_ref/doc/uid/TP30001018-CH204-BABFGECE">“Value Type.”</a></span></p></td><td ><p>Edit the table cell or use the Attribute Inspector.</p></td></tr><tr><td  scope="row"><p>Width<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_183"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_184"></a></p></td><td ><p>The maximum width in bytes or chars of the attribute (applies to string and raw data only).</p></td><td ><p>Edit the table cell or use the Attribute Inspector.</p></td></tr><tr><td  scope="row"><p>Write Format<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_185"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_186"></a></p></td><td ><p>The format string that’s used to format the attribute’s value for SQL INSERT or UPDATE expressions. In the string, %V is replaced by the attribute’s external name. </p><p>For LDAP data sources accessed via the JNDI adaptor, write format specifies the pattern used to generate the relative distinguished name. See <span class="content_text"><a href="WorkingWithAttributes.html#//apple_ref/doc/uid/TP30001018-CH204-BABCHIIF">“Read Format and Write Format.”</a></span></p></td><td ><p>Edit the table cell.</p></td></tr></table></div><a name="//apple_ref/doc/uid/TP30001018-CH204-BABBEBAI" title="More About Attribute Characteristics"></a><h2>More About Attribute Characteristics</h2><p>This section provides information about the more complex characteristics available to attributes.</p><a name="//apple_ref/doc/uid/TP30001018-CH204-TPXREF127" title="Allows Null"></a><h3>Allows Null</h3><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_187"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_188"></a><p>By default, attributes you add to entities allow <code>null</code> values, except in the case of primary keys. This means that Enterprise Objects allows attributes containing no values to be saved to the data source. In some cases, such as when using inheritance, allowing null values may be necessary.</p><a name="//apple_ref/doc/uid/TP30001018-CH204-TPXREF128" title="Class Property"></a><h3>Class Property</h3><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_189"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_190"></a><p>When an attribute is marked as a class property, Java classes generated by EOModeler contain accessor methods for that attribute. (However, these Java classes do not contain instance variables for those attributes since the instance data is accessed by the mechanism of key-value coding.) You should mark as class properties only those attributes that are useful in your business logic. This reduces the amount of code to maintain and makes your enterprise object classes more readable.</p><p>Primary keys and foreign keys should not be marked as class properties. This is for two reasons: Enterprise objects have no knowledge of the primary and foreign keys of the tables from which they are mapped, and these keys are of no use to your business logic. Also, to ensure that the automatic primary key generation feature of Enterprise Objects is properly invoked, primary keys must not be marked as class properties. </p><p>In the process of building enterprise objects, if you find that you need access to primary or foreign keys, there are utility classes and methods that allow you to access these keys even when they are not marked as class properties. See the API reference in the <code>com.webobjects.eoaccess</code> package for <code>EOEntity.primaryKeyAttributes</code> and <code>EOEntity.primaryKeyForGlobalID</code>, as well as the API reference for <code>com.webobjects.eocontrol.EOClassDescription</code>.</p><a name="//apple_ref/doc/uid/TP30001018-CH204-TPXREF129" title="Client-Side Class Property"></a><h3>Client-Side Class Property</h3><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_191"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_192"></a><p>This attribute characteristic applies only to three-tier Java Client or Cocoa client applications. It plays a vital role in the process of <strong>business logic partitioning</strong>. This is the process in which you choose the data that is made available to the client application.</p><p>For example, a Customer entity might include an attribute called <code>creditCardNumber</code>. While this attribute is probably important to the server-side application for processing orders, it is considered sensitive data and should not be made available to client applications. To ensure that client applications don’t have access to this attribute, it should not be marked as a client-side class property.</p><p>See <em>Inside WebObjects: Java Client Desktop Applications</em> for detailed information on the client-side class property characteristic, including a tutorial.</p><a name="//apple_ref/doc/uid/TP30001018-CH204-TPXREF130" title="Definition (Derived Attributes)"></a><h3>Definition (Derived Attributes)</h3><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_193"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_194"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_195"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_196"></a><p>This characteristic applies only to derived attributes. Derived attributes are usually calculated from other attributes, such as multiplying an employee’s monthly salary by twelve or deriving a person’s full name from first name and last name attributes. The syntax of a derived attribute definition is a SQL statement. To define an annual salary, for instance, you would multiple a <code>MONTHLY_SALARY</code> column by twelve. <span class="content_text">Figure 3-2</span> shows the Attribute Inspector<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_197"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_198"></a> for a derived attribute that does just this.</p><br/><div><a name="//apple_ref/doc/uid/TP30001018-CH204-BABFAFJJ" title="Figure 3-2Derived attribute syntax"></a><p><strong>Figure 3-2&nbsp;&nbsp;</strong>Derived attribute syntax</p><img src = "../Art/derivedattribute.gif" alt = "Derived attribute syntax" width="267" height="442"></div><br/><p>Derived attributes are effectively read-only since there is no place to write them back to. You could get the value of a derived attribute and write it back to another column but that requires another attribute. And if you need to store the value of a derived attribute, it’s usually much better to perform the derivation in business logic rather than at the attribute level. (Alternatively, you could use custom read and write formats to accomplish this. See <span class="content_text"><a href="WorkingWithAttributes.html#//apple_ref/doc/uid/TP30001018-CH204-BABCHIIF">“Read Format and Write Format”</a></span>). By deriving attributes at the business-logic level, you write the code in Java, you avoid writing database-specific SQL, and you get the full benefits of enterprise objects.</p><p>One of the most important benefits is the internal update notifications that enterprise objects send and receive. In the previous example, if you change an employee’s monthly salary, the derived attribute that calculates the annual salary is then incorrect. And since the attribute is derived, its value as it exists in the enterprise object is immutable. Unless the object is flushed from the access layer’s snapshot and refreshed, the derived attribute is stale and inaccurate.</p><p>Derived attributes can be useful but should probably be reserved for read-only applications and can usually be replaced by values derived in business logic. Also, because derived attributes don’t directly map to anything in the database, they cannot be used for locking or as primary keys.</p><a name="//apple_ref/doc/uid/TP30001018-CH204-BABBDEIE" title="Locking"></a><h3>Locking</h3><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_199"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_200"></a><p>As introduced in <span class="content_text"><a href="WorkingWithAttributes.html#//apple_ref/doc/uid/TP30001018-CH204-BABBDEIE">“Locking,”</a></span> the Enterprise Object technology supports different locking strategies to deal with the problem of update conflicts. In multi-user database applications in which many users have write access, there is a possibility that multiple users may view and edit the same record concurrently. A good locking strategy can help you avoid problems if this situation arises.</p><p>The default locking strategy used by Enterprise Objects is optimistic locking. With this strategy, update conflicts aren’t detected until users try to save an object’s changes to the data store. At that point, Enterprise Objects checks the database row to see if it’s changed since the object being edited was fetched. If the row has been changed, the save operation is rolled back and an optimistic locking exception is thrown.</p><p>Enterprise Objects determines that a database row has changed since its corresponding enterprise object was fetched using a technique called <strong>snapshotting</strong><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_201"></a>. When Enterprise Objects fetches an object from the data store, it records a snapshot of the state of the corresponding database row. When changes to an object are saved to the database, the snapshot is compared with the corresponding database row to ensure that the row data hasn’t changed since the object was last fetched.</p><p>Enterprise Objects creates snapshots based on the attributes that are selected for locking. The general rule is that only attributes that are guaranteed to contain a small amount of easily parseable data should be selected for locking. For example, an attribute with external type <code>object</code>, <code>blob</code>, or <code>clob</code> should never be selected for locking (except in very rare cases).</p><a name="//apple_ref/doc/uid/TP30001018-CH204-TPXREF131" title="Primary Key"></a><h3>Primary Key</h3><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_202"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_203"></a><p>Primary keys are used to identify uniquely database rows and also to provide attributes for forming relationships. Each entity in your data model needs a primary key. (If your data model represents an LDAP data source via the JNDI adaptor, each entity needs an attribute named <code>relativeDistinguishedName</code>, which is roughly analogous to a primary key.) Primary keys in entities map directly to primary keys in tables.</p><p>It is generally recommended that primary keys be kept simple. It’s quite common to use <code>int</code> data types as primary keys but other numerical formats also work well. Just as with locking attributes, you should avoid attributes that contain large amounts of data and you usually do not want to use binary-type attributes as primary keys. (There are some exceptions as Enterprise Objects provides facilities to compare columns that map to an Internal Data Type of NSData).</p><p>Depending on your application requirements, you may need to use a compound primary key—<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_204"></a>that is, a primary key composed of multiple attributes. If you must meet this requirement, Enterprise Objects provides facilities to help you with this task. You can designate a compound primary key in a model by marking multiple attributes as primary key attributes. Then, you can use the API provided in the access layer to generate custom primary keys based on these attributes. See the method description in the <code>com.webobjects.eoaccess</code> API reference for <code>EODatabaseContext.Delegate.databaseContextNewPrimaryKey</code> for more details.</p><p>You should be careful with the primary key characteristic. The primary key identified in an entity must correspond to a primary key constraint defined in the database table with which that entity is associated. So although EOModeler provides user interface to easily mark and unmark attributes as primary keys, you should not do so unless you also make a corresponding change in the database. And if you do this, you risk breaking existing relationships.</p><a name="//apple_ref/doc/uid/TP30001018-CH204-BABCHIIF" title="Read Format and Write Format "></a><h3>Read Format and Write Format </h3><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_205"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_206"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_207"></a><p>In addition to mapping database rows to instance variables or to an object’s data, EOAttribute objects can also alter how database values are selected, inserted, and updated. This is accomplished by defining special format strings for particular attributes. These format strings allow an application to extend its reach down to the database server for certain operations. These operations are then performed by the database server, which may or may not be advantageous to your application.</p><p>Using a custom read format (for SELECT operations), you can create a kind of derived attribute without defining the attribute as derived. For example, rather than defining a derived attribute to calculate an employee’s annual salary based on monthly salary multiplied by twelve, you can derive this value by setting the read format to the same SQL string you’d use were you to declare the definition for a derived attribute. The advantage of using custom read formats over derived attributes is that you can easily write the derived value back to the data source by including a complimentary write format.</p><p>The difference between attributes that are declared to be derived and attributes that are derived from custom read formats is that the latter performs an operation on itself whereas derived attributes operate on values in other attributes, often aggregating them or otherwise modifying them. So, whereas the definition of a derived attribute that calculates an annual salary based on a monthly salary would be <code>MONTHLY_SALARY * 12</code>, the read format for an attribute that does the same thing would be <code>%P * 12</code>. The former does not require a column in the database whereas the latter does.</p><p>Custom format strings can also be used for INSERT and UPDATE operations. For example, if you want to store an employee’s salary in monthly terms rather than in annual terms, you would set the write format to be <code>%V /12</code>. So, whenever the salary attribute is written back to the database, its value is divided by 12.</p><p>Read format strings use “%P” as the substitution character for the value that is being formatted whereas write format strings use “%V” as the substitution character. If, for example, you are deriving an annual salary from a column that stores salaries in monthly terms (<code>MONTHLY_SALARY</code>), the format string is <code>%P * 12</code>. So rather than sending the database server a message of <code>SELECT MONTHY_SALARY</code>, it is instead sent <code>SELECT MONTHY_SALARY * 12</code>.</p><p>You can use any legal SQL value expression in a format string and you can even use database-specific features such as functions. (A common case function is one that converts data from one type to another when it is read or written, such as converting a string to a date when writing and from a date to a string when reading). Using database-specific features affords the application more flexibility but limits its portability. You are responsible for ensuring that the SQL is well-formed and can be understood by the database server.</p><p>Using custom read and write formats is probably useful only when dealing with legacy data in which the stored data is out of sync with your current business logic. In the examples used above, the old business logic would be to store salaries based on monthly terms. The great database application you’re writing uses this legacy data store but displays salaries in annual terms. To maintain the integrity of the data in the database, it’s important to divide annual salary by twelve upon each commit. This transformation, however, should be transparent to the end user, so using custom read and write formats solves this problem.</p><a name="//apple_ref/doc/uid/TP30001018-CH204-BABFGECE" title="Value Type"></a><h3>Value Type</h3><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_208"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_209"></a><p>When you choose a value class for a particular attribute, you sometimes do not provide Enterprise Objects with all the information the JDBC adaptor needs to negotiate with the data source. </p><p>For example, when you specify Number as the value class for a particular attribute, you are telling Enterprise Objects to use <code>java.lang.Number</code>, which is an abstract class. This is where the value type characteristic steps in. It specifies the exact class an attribute should map to. </p><p>The possible value types for numeric attributes are as follows(note case):</p><ul class="spaceabove"><li class="li"><p><code>b</code>—<code>java.lang.Byte</code></p></li><li class="li"><p><code>s</code>—<code>java.lang.Short</code></p></li><li class="li"><p><code>i</code>—<code>java.lang.Integer</code></p></li><li class="li"><p><code>l</code>—<code>java.lang.Long</code></p></li><li class="li"><p><code>f</code>—<code>java.lang.Float</code></p></li><li class="li"><p><code>d</code>—<code>java.lang.Double</code></p></li><li class="li"><p><code>B</code>—<code>java.math.BigDecimal</code></p></li><li class="li"><p><code>c</code>—<code>java.lang.Boolean</code></p></li></ul><p>The value type also specifies which JDBC methods are used to send and retrieve the data to and from the database. These value types affect which method the <code>java.sql.PreparedStatement</code> object uses to transfer text data between the database and the JDBC adaptor. For attributes with a value class of String, the following value types are defined:</p><ul class="spaceabove"><li class="li"><p>&lt;none>—uses <code>setString</code> if the text is less than the database’s advertised maximum <code>varchar</code> length and <code>setCharacterStream</code> if it is too large. If the database fails to advertise a maximum length, the default is 256 characters.</p></li><li class="li"><p><code>S</code>—uses <code>setString</code> regardless of the text’s length.</p></li><li class="li"><p><code>C</code>—uses <code>setCharacterString</code> regardless of the text’s length.</p></li><li class="li"><p><code>E</code>—converts the text into raw UTF-8 bytes and then uses <code>setBinaryStream</code> to save them in a binary-typed column in the database.</p></li><li class="li"><p><code>c</code>—tells the adaptor to generate SQL using RTRIM to strip off all trailing spaces.</p></li></ul><p>Database columns of type <code>char</code> hold string values that are right-padded with spaces to the width of the column. String values in Enterprise Objects, however, normally do not have trailing spaces for performance and other efficiency reasons. An attribute that maps to an external type of <code>char</code> should have a value type of <code>c</code> to tell the JDBC adaptor to trim trailing spaces when fetching values that correspond to that attribute. If the value type is left blank for attributes that map to an external type of <code>char</code>, then no trimming occurs. Attributes that map to <code>varchar</code> columns are never trimmed, regardless of value type.</p><p><code>S</code> is the appropriate value type for most text columns. <code>C</code> is good for columns that usually contain large amounts of data. <code>c</code> should be used when trailing spaces are not significant in a <code>char</code> column. It is not recommended to use <code>E</code>, except when absolutely necessary. It is the database’s responsibility to handle text encoding issues and using <code>E</code> usually indicates that the database is not properly configured.</p><p>For attributes with a value class of NSTimestamp, the following value types are defined:</p><ul class="spaceabove"><li class="li"><p>&lt;none>—uses <code>getObject</code> on the <code>java.sql.ResultSet</code> object and <code>setObject</code> on the <code>java.sql.PreparedStatement</code> object. It assumes the database can provide a value compatible with a <code>java.sql.Timestamp</code> object.</p></li><li class="li"><p><code>D</code>—<code>java.util.Date</code> uses <code>setDate</code> and <code>getDate</code>.</p></li><li class="li"><p><code>t</code>—<code>java.sql.Time</code> uses <code>getTime</code> and <code>setTime</code>.</p></li><li class="li"><p><code>T</code>—<code>java.sql.Timestamp</code> uses <code>getTimestamp</code> and <code>setTimestamp</code>.</p></li><li class="li"><p><code>M</code>—use in place of <code>D</code> if using Microsoft SQL Server. Supports only <code>java.sql.Date</code>.</p></li></ul><a name="//apple_ref/doc/uid/TP30001018-CH204-BABJICFI" title="Prototype Attributes"></a><h2>Prototype Attributes</h2><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_210"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_211"></a><p><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_212"></a>To make creating models easier, EOModeler supports <strong>prototype attributes</strong>. These are special attributes from which other attributes derive their settings. A prototype can specify any of the characteristics you normally define for an attribute. When you create an attribute, you can associate it with one of these prototypes, and the attribute’s characteristics are then set from the prototype definition.</p><p>For example, you can create a prototype attribute called <code>lastModified</code> whose value class is Date, whose external type is <code>datetime</code>, and which corresponds to a column named LAST_MODIFIED. Then, when you create other entities, you can create an attribute and associate it with this prototype and the prototype’s values are copied in to the new attribute. You can then change any values in or add values to the new attribute. Any value that is inherited from the prototype that you don’t override uses the value defined in the prototype.</p><a name="//apple_ref/doc/uid/TP30001018-CH204-TPXREF133" title="Creating Prototype Attributes"></a><h3>Creating Prototype Attributes</h3><p>The prototypes you can assign to attributes can come from two places:</p><ol class="ol"><li class="li"><p>An entity named EO<em>AdaptorName</em>Prototypes, where <em>AdaptorName</em> is the name of the adaptor for your model. WebObjects 5.2 includes an adaptor for JDBC data sources and an adaptor for JNDI data sources. So you can create a prototype entity called either EOJDBCPrototypes or EOJNDIPrototypes, depending on the adaptor you use.</p></li><li class="li"><p>An entity named EOPrototypes.</p></li></ol><p>To create a prototype attribute, first create a prototype entity—an entity named either EO<em>AdaptorName</em>Prototypes or EOPrototypes—and add an attribute to it. <span class="content_text">Figure 3-3</span> shows an attribute in a prototype entity. It shows all the values that prototype attributes can define: column name, value class, external type, and value type.</p><br/><div><a name="//apple_ref/doc/uid/TP30001018-CH204-BABDCCBI" title="Figure 3-3A prototype entity"></a><p><strong>Figure 3-3&nbsp;&nbsp;</strong>A prototype entity</p><img src = "../Art/prototypeentity.gif" alt = "A prototype entity" width="492" height="46"></div><br/><a name="//apple_ref/doc/uid/TP30001018-CH204-TPXREF134" title="Assigning a Prototype to an Attribute"></a><h3>Assigning a Prototype to an Attribute</h3><p>To assign a prototype attribute to an attribute, reveal the Prototype column in table mode, and select a prototype attribute from the pop-up menu. The prototype attributes that appear in the pop-up list in the Prototype column include prototype attributes defined in any entity in any model in the application’s model group, which includes the current model.</p><p><span class="content_text">Figure 3-4</span> shows an attribute named <code>lastModified</code> which inherits characteristics from the prototype attribute called <code>lastModified</code>. As you can see in the figure, characteristics that attributes derive from their prototype are colored differently than are other characteristics.</p><br/><div><a name="//apple_ref/doc/uid/TP30001018-CH204-BABDAHGH" title="Figure 3-4An attribute using a prototype"></a><p><strong>Figure 3-4&nbsp;&nbsp;</strong>An attribute using a prototype</p><img src = "../Art/assignprototypeattribute.gif" alt = "An attribute using a prototype" width="481" height="49"></div><br/><p>When you use prototype attributes, in some cases you want to derive only some of the values from the prototype. To do this, just set the characteristic of the attribute to the value you want. The rest of the derived characteristics still resolve to the values set in the prototype. The prototype selected in the Prototypes column then appears with an asterisk. <span class="content_text">Figure 3-5</span> shows an attribute that uses only part of a prototype definition<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_213"></a>.</p><br/><div><a name="//apple_ref/doc/uid/TP30001018-CH204-TPXREF137" title="Figure 3-5An attribute using part of a prototype"></a><p><strong>Figure 3-5&nbsp;&nbsp;</strong>An attribute using part of a prototype</p><img src = "../Art/prototypewithchange.gif" alt = "An attribute using part of a prototype" width="519" height="52"></div><br/><a name="//apple_ref/doc/uid/TP30001018-CH204-BABGGEFA" title="Flattened Attributes"></a><h2>Flattened Attributes</h2><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_214"></a><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_215"></a><p><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_216"></a>A <a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_217"></a>flattened attribute is a special kind of attribute that you effectively add from one entity to another by traversing a relationship. When you form a to-one relationship between two entities (such as Person and PersonPhoto), you can add attributes from the destination table to the source table. For example, you can add a <code>personPhoto</code> attribute to the Person entity. This is called “flattening” an attribute and is equivalent to creating a joined column—it allows you to create objects that extend across tables.</p><a name="//apple_ref/doc/uid/TP30001018-CH204-BABFBCHJ" title="When Should You Flatten Attributes?"></a><h3>When Should You Flatten Attributes?</h3><p>Flattening attributes is just another way to conceptually “add” an attribute from one entity to another. A generally better approach is to traverse the object graph directly through relationships. Enterprise Objects makes this easy by supporting the notion of key paths.</p><p>The difference between flattening attributes and traversing the object graph (either programmatically or by using key paths) is that the values of flattened attributes are tied to the database rather than the object graph. If an enterprise object in the object graph changes, a flattened attribute can quickly get out of sync.</p><p>For example, suppose you flatten a <code>departmentName</code> attribute into an Employee object. If a user then changes an employee’s department reference to a different department or changes the name of the department itself, the flattened attribute won’t reflect the change until the changes in the object graph are committed to the database and the data is refetched (this is because flattened attributes are derived attributes—see <span class="content_text"><a href="WorkingWithAttributes.html#//apple_ref/doc/uid/TP30001018-CH204-TPXREF130">“Definition (Derived Attributes)”</a></span> for more details). However, if you’re using key paths in this scenario, users see changes to data as soon as they happen in the object graph. This ensures that your application’s view of the data remains internally consistent.</p><p>Therefore, you should use flattened attributes only in the following cases:</p><ul class="spaceabove"><li class="li"><p>If you want to combine multiple tables joined by a one-to-one relationship to form a logical unit. For example, you might have employee data that’s spread across multiple tables such as ADDRESS, BENEFITS, and so on. If you have no need to access these tables individually (that is, if you’d never need to create an Address object since the address data is always subsumed in the Employee object), then it makes sense to flatten attributes from those entities into the Employee entity.</p></li><li class="li"><p>If your application is read-only.</p></li><li class="li"><p>If you’re using vertical inheritance mapping. See <span class="content_text"><a href="../7ModelingInheritance/7ModelingInheritance.html#//apple_ref/doc/uid/TP30001018-CH207-CACEGJBA">“Vertical Mapping.”</a></span></p></li></ul><a name="//apple_ref/doc/uid/TP30001018-CH204-BABFBBFF" title="Flattening an Attribute"></a><h3>Flattening an Attribute</h3><p>To flatten an attribute:</p><ol class="ol"><li class="li"><p>In browser mode, select the entity in which you want the flattened attribute to appear and select the relationship whose destination entity holds the attribute you want to flatten.</p><p>For example, in the Real Estate model, to flatten the <code>photo</code> attribute from the PersonPhoto entity into the Person entity, select the Person entity and select the <code>personPhoto</code> relationship, as shown in <span class="content_text">Figure 3-6</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001018-CH204-BABFGGHI" title="Figure 3-6Selecting the relationship in which the attribute to flatten exists"></a><p><strong>Figure 3-6&nbsp;&nbsp;</strong>Selecting the relationship in which the attribute to flatten exists</p><img src = "../Art/flatten_select_relation.gif" alt = "Selecting the relationship in which the attribute to flatten exists" width="441" height="216"></div></li><li class="li"><p>Select the attribute in the destination entity (<code>photo</code> ) for which you want to create the flattened attribute and choose Flatten Property from the Property menu.</p><p>The flattened attribute appears in the list of properties for the Person entity as <code>personPhoto_photo</code>, as shown in <span class="content_text">Figure 3-7</span>. The format of the name reflects the traversal path: the attribute <code>photo</code> is added to the Person entity by traversing the <code>personPhoto</code> relationship<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_218"></a>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001018-CH204-BABFHJAE" title="Figure 3-7An attribute flattened"></a><p><strong>Figure 3-7&nbsp;&nbsp;</strong>An attribute flattened</p><img src = "../Art/flatten_after_flat.gif" alt = "An attribute flattened" width="388" height="211"></div></li></ol><p>If you select the flattened attribute and display the Attribute Inspector<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_219"></a>, you’ll see that the attribute is considered derived and its definition is a key path, as shown in <span class="content_text">Figure 3-8</span>. Just as with other types of attributes, you can edit the flattened attribute’s name in the<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_220"></a> inspector.<a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_221"></a></p><br/><div><a name="//apple_ref/doc/uid/TP30001018-CH204-BABIDFAE" title="Figure 3-8A flattened attribute in the Attribute Inspector"></a><p><strong>Figure 3-8&nbsp;&nbsp;</strong>A flattened attribute in the Attribute Inspector</p><a name="//apple_ref/doc/uid/TP30001018-CH204-DontLinkElementID_222"></a><img src = "../Art/flattened_inspector.gif" alt = "A flattened attribute in the Attribute Inspector" width="266" height="148"></div><br/>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../3UsingModeler/UsingModeler.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../5WorkingWithRelationships/WorkingWithRelationships.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2002, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-05-23<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/WebObjects/UsingEOModeler/4WorkingWithAttributes/WorkingWithAttributes.html%3Fid%3DTP30001018-2.2&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/WebObjects/UsingEOModeler/4WorkingWithAttributes/WorkingWithAttributes.html%3Fid%3DTP30001018-2.2&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/WebObjects/UsingEOModeler/4WorkingWithAttributes/WorkingWithAttributes.html%3Fid%3DTP30001018-2.2&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>