<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>FindRecordByIndexInDictionary(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING507></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-506.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-508.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-483.html"><B>Chapter 8 - Dictionary Manager</B></A> / <A HREF="Text-496.html"><B>Dictionary Manager Reference</B></A><BR><DL><DD><A HREF="Text-498.html"><B>Routines</B></A> / <A HREF="Text-505.html"><B>Locating Records in a Dictionary</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING507-0></A>
<H3>FindRecordByIndexInDictionary</H3>
 <A NAME=MARKER-2-116></A>The <CODE>FindRecordByIndexInDictionary</CODE> function locates a record in a dictionary by index, and returns entries with the specified attributes.<P>
<PRE>
FUNCTION FindRecordByIndexInDictionary
                           (dictionaryReference: LongInt;
                            recordIndex: LongInt;
                            requestedAttributeTablePointer: Ptr;
                            VAR recordKey: Str255;
                            recordDataHandle: Handle): OSErr;
</PRE>
<DL>
<DT><CODE>dictionaryReference</CODE>
<DD> A number that specifies a particular open dictionary.
<DT><CODE>recordIndex</CODE>
<DD> The index for the record to be searched; its position in the dictionary. The index range for <CODE>FindRecordByIndexInDictionary</CODE> is from 0 to one less than the maximum number of records in a dictionary. To obtain the maximum index range of a dictionary, you can use the <CODE>GetDictionaryInformation</CODE> function (see <A HREF=Text-504.html#MARKER-9-102>page 8-24</A>).
<DT><CODE>requestedAttributeTablePointer</CODE>
<DD> A pointer to a table with attributes that you can request. This parameter provides a way for you to narrow the search to specified types of entries in the record. For instance, you could use the requested attributes table to specify only the verbs in the record at that index.
<DT><CODE>recordKey</CODE>
<DD> Upon succcessful completion, contains the key of the indexed record.
<DT><CODE>recordDataHandle</CODE>
<DD> A handle that contains a collection of entries in the indexed record that match the requested attributes.
</DL>
<A NAME=HEADING507-8></A>
<H5>DESCRIPTION</H5>
 The <CODE>FindRecordByIndexInDictionary</CODE> function returns, in the <CODE>recordDataHandle</CODE> parameter, a handle to the record data: a collection of entries from the specified record matching the requested attributes. <CODE>FindRecordByIndexInDictionary</CODE> returns the data in standard Dictionary Manager data format--as shown in <A HREF=Text-486.html#MARKER-9-33>Figure 8-2 on page 8-6</A> and <A HREF=Text-486.html#MARKER-9-39>Figure 8-3 on page 8-7</A>.<P>
 The Dictionary Manager uses the Memory Manager procedure <CODE>SetHandleSize</CODE> to set the size of the <CODE>recordDataHandle</CODE> parameter correctly. If the Dictionary Manager cannot change the size of the handle to accommodate the returned matched data, it returns a Memory Manager error.<P>
 To limit the search to specific types of attributes, you construct a requested attributes table and pass a pointer to that table to <CODE>FindRecordByIndexInDictionary</CODE>. The requested attributes table and a list of defined attribute types are described with the <CODE>FindRecordInDictionary</CODE> function, on <A HREF=Text-506.html#MARKER-9-112>page 8-26</A>.<P>
<UL>
<LI>If the <CODE>requestedAttributeTablePointer</CODE> parameter is <CODE>Ptr(-1)</CODE>, <CODE>FindRecordByIndexInDictionary</CODE> returns everything in the matching record (that is, both raw data and attributes for all entries in the record).
<LI>If the <CODE>requestedAttributeTablePointer</CODE> parameter is <CODE>NIL</CODE>, <CODE>FindRecordByIndexInDictionary</CODE> returns the raw data of all the entries in the matching record, without any attached attributes.
<LI>If the <CODE>requestedAttributeTablePointer</CODE> parameter is a valid pointer, <CODE>FindRecordByIndexInDictionary</CODE> returns only those entries in the matching record whose attributes match those in the requested attributes table. In this case, if a record in the dictionary has a key that matches the search key but no entries in the record possess the requested attributes, the returned <CODE>recordDataHandle</CODE> parameter references a data buffer 1 byte in length that contains a value of 0.<P>
</UL>
<A NAME=HEADING507-15></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 <CODE>FindRecordByIndexInDictionary</CODE> may move memory; your application should not call this function at interrupt time.<P>
<A NAME=HEADING507-17></A>
<H5>RESULT CODES</H5>
 In addition to the standard File Manager, Memory Manager, and Resource Manager errors, <CODE>FindRecordByIndexInDictionary</CODE> may return any of the following <BR>result codes.
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>notBTree<TD>-410<TD>File is not a dictionary<TR>
<TD>btRecNotFnd<TD>-415<TD>Record cannot be found</TABLE>
<P>
<A NAME=HEADING507-19></A>
<H5>SEE ALSO</H5>
 File Manager error codes are described in <I><A HREF="../Files/Files-2.html">Inside Macintosh: Files</A></I>. Memory Manager error codes are described in <I><A HREF="../Memory/Memory-2.html">Inside Macintosh: Memory</A></I>. Resource Manager error codes are described in <I><A HREF="../MoreToolbox/MoreToolbox-2.html">Inside Macintosh: More Macintosh Toolbox</A></I>.<P>
 For sample code that uses the <CODE>FindRecordByIndexInDictionary</CODE> function, see <A HREF=Text-493.html#MARKER-9-76>Listing 8-4 on page 8-17</A>. <A NAME=MARKER-2-47></A>  <A NAME=MARKER-2-176></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-506.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-508.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
