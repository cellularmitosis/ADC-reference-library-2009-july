<HTML>		<HEAD>        <title>RefiningYour Model</title>		</HEAD>	<BODY bgcolor="#ffffff">		<!-- start of header -->		<!--#include virtual="/includes/framesetheader" -->		<!-- end of header --><!-- start of path --><table cellspacing=0 border=0 width=600 valign="left"><tr><td scope="row"><font face="Geneva,Helvetica,Arial" size="1"><b>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="../../../index.html">Documentation</a> <b>></b> <a href="../../webobjects.html" target="_top">WebObjects</a></font></td></tr></table><br><!-- end of path --><a href="Adding_the__etails_Page.html" target="_right"><img src="../Images/previous.gif" border="0" alt="Previous"></a><a href="Setting_Up__nfiguration.html" target="_right"><img src="../Images/next.gif" border="0" alt="Next"></a>&nbsp;<br><!-- apple_doc: pageHeadingStart --><a name = "TPXREF137"></a><h2><font face="Helvetica,Arial,Lucida Grande">RefiningYour Model</font></h2><!-- apple_doc: pageHeadingEnd --><p><font face="Times">The model created for you by the wizard is just a startingpoint. For most applications, you need to do some additional workto your model to make it useful in your application. To refine yourmodel so that it can be used in the Movies application, you'llultimately need to do all of the following:</font></p><ul><p><li>Remove primaryand foreign keys as class properties.</li></p><p><li>Add relationships to your model if the wizard didn't haveenough information to add them for you.</li></p><p><li>Configure your model's relationships in the Advanced RelationshipInspector.</li></p><p><li>Generate source files for the Talent class.</li></p></ul><p><font face="Times">These steps are described in more detail throughout the restof this tutorial.</font></p><a name = "TPXREF138"></a><h3><font face="Helvetica,Arial,Lucida Grande">OpeningYour Model</font></h3><ol><p><li>In ProjectBuilder, click the Resources category.</li></p><p><li>Select <code>Movies.eomodeld</code>.</li></p><p><li>Double-click the model icon.<P><img src = "../Art/pbopnmdl.gif" alt = "[image: ../Art/pbopnmdl.gif]"></li></p></ol><p><font face="Times"></font></p><p><font face="Times">Project Builder opens your model file in EOModeler, launchingEOModeler first if it isn't already running. EOModeler displaysyour model in the Model Editor. It lists the entities for the tablesyou specified in the wizard-Movie, MovieRole, and Talent.</font></p><P><img src = "../Art/mdleditr.gif" alt = "[image: ../Art/mdleditr.gif]"><a name = "TPXREF139"></a><h3><font face="Helvetica,Arial,Lucida Grande">RemovingForeign Keys as Class Properties</font></h3><p><font face="Times">By default, the wizard makes all of an entity's attributes,except primary keys, <em>class properties</em>. Whenan attribute is a class property, it means that the property isa part of your enterprise object, usually as an instance variable.</font></p><p><font face="Times">You should mark as class properties only those attributeswhose values are meaningful in the objects that are created whenyou fetch from the database. Attributes that are essentially databaseartifacts, such as primary and foreign keys, shouldn't be markedas class properties unless the key has meaning to the user and mustbe displayed in the user interface.</font></p><p><font face="Times">Eliminating primary and foreign keys as class properties hasno adverse effect on how Enterprise Objects Framework manages enterpriseobjects in your application.</font></p><ol><p><li>In the leftframe (or <em>tree view</em>), click the Movie entity.<p>Theright frame switches from a view of the entities in the model toa view of Movie's attributes.</p><p>A <img src = "../Art/key.gif" alt = "[image: ../Art/key.gif]"> symbol in the first columnmeans that the attribute is a primary key for the selected entity.A <img src = "../Art/diamond.gif" alt = "[image: ../Art/diamond.gif]"> symbolin the second column means that the attribute is a class property.</p></li></p><p><li>Click in the Class Property column to remove the <img src = "../Art/diamond.gif" alt = "[image: ../Art/diamond.gif]"> symbol for the <code>studioId</code> attribute, whichis a foreign key. The wizard didn't make <code>movieId</code> aclass property because it is a primary key.</li></p></ol><P><img src = "../Art/rmclsprp.gif" alt = "[image: ../Art/rmclsprp.gif]"><a name = "TPXREF140"></a><h3><font face="Helvetica,Arial,Lucida Grande">AddingRelationships to Your Model</font></h3><p><font face="Times">The Movies application uses two pairs of inverse relationships.The first pair defines the relationship between the Movie and MovieRoleentities, while the second pair defines the relationship betweenthe MovieRole and Talent entities. An Enterprise Objects Framework relationshipis <em>directed</em>; that is, a relationship has asource and a destination. Generally models define a relationshipfor each direction.</font></p><ol><p><li>Select theMovie entity.<p>The right frame of the Model Editor shows theMovie's relationships as well as its attributes.</p><P><img src = "../Art/showrels.gif" alt = "[image: ../Art/showrels.gif]"><p>If your Movieentity doesn't have a <code>movieRoles</code> relationship,it means that the database server's schema information for yourdatabase didn't have enough information for the wizard to createthem. You need to create them by hand now. The next several steps explainhow.</p></li></p><p><li>Choose Property &gt; Add Relationship.<p>A new relationshipnamed "Relationship" is added in the table view at the bottomof the Model Editor. The new relationship is already selected.</p></li></p><p><li>With the relationship selected in the right frame of the ModelEditor, click the  <img src = "../Art/inspector.gif" alt = "[image: ../Art/inspector.gif]"> button(in the toolbar) to inspect the relationship.<P><img src = "../Art/relinsp.gif" alt = "[image: ../Art/relinsp.gif]"></li></p><p><li>In the Inspector, select the To Many option.</li></p><p><li>Select MovieRole as the destination entity.</li></p><p><li>Select <code>movieId</code> inthe Source Attributes list.</li></p><p><li>Select <code>movieId</code> inthe Destination Attributes list.</li></p><p><li>Click Connect.<p>EOModeler automatically renames the relationshipbased on the name of the destination entity. For example, afterconnecting a to-many relationship from Movie to MovieRole, EOModelernames the relationship "movieRoles". To-one relationships are namedwith the singular form of the destination entity's name. For example, EOModelernames the inverse to-one relationship (from MovieRole to Movie)"movie".</p><p>If the wizard created your relationshipand used a name other than "movieRoles", consider renaming therelationship. The rest of this tutorial assumes that your relationshipsare named using EOModeler's naming convention.</p></li></p><p><li>Repeat the steps above to create the following relationships(if they do not already exist):<p>A to-one relationship named"movie" in the MovieRole entity where</p><ul><p><li>The destination entityis Movie.</li></p><p><li>The source attribute is <code>movieId</code>.</li></p><p><li>The destination attribute is <code>movieId</code>.<p>Ato-one relationship named "talent" in the MovieRole entity where</p></li></p><p><li>The destination entity is Talent.</li></p><p><li>The source attribute is <code>talentId</code>.</li></p><p><li>The destination attribute is <code>talentId</code>.<p>Ato-many relationship named "movieRoles" in the Talent entitywhere</p></li></p><p><li>The destination entity is MovieRole.</li></p><p><li>The source attribute is <code>talentId</code>.</li></p><p><li>The destination attribute is <code>talentId</code>.</li></p></ul></li></p><p><li>Choose Tools &gt; Diagram View to switch the Model Editorto Diagram View.</li></p></ol><P><img src = "../Art/popupbtn.gif" alt = "[image: ../Art/popupbtn.gif]"><p><font face="Times">At this point your model has all the relationships it needs.The Diagram View gives you an overview of the entities in the modeland their relationships to other entities.</font></p><P><img src = "../Art/diagram.gif" alt = "[image: ../Art/diagram.gif]"><p><font face="Times">You can also use the Diagram View to edit your model. Double-clickan attribute or relationship to change its name. To create a relationshipand its inverse, Control-drag from the relationship's source attributeto its destination attribute. </font></p><a name = "TPXREF141"></a><h3><font face="Helvetica,Arial,Lucida Grande">Usingthe Advanced Relationship Inspector</font></h3><p><font face="Times">There are several additional settings you use to configurea relationship's referential integrity rules. For these, use theAdvanced Relationship Inspector.</font></p><ol><p><li>Inspect Movie's <code>movieRoles</code> relationship.</li></p><p><li>In the Inspector, click the Advanced Relationship button.<P><img src = "../Art/advIisp.gif" alt = "[image: ../Art/advIisp.gif]"></li></p><p><li>Ensure that the delete rule is set to Cascade.<p>If thewizard created relationships for you, the relationship's deleterule should already be set to Cascade. You specified this in thewizard. If you created your relationships by hand, you'll haveto set the delete rule yourself.</p></li></p><p><li>Ensure that the Owns Destination box is checked.<p>As withthe delete rule, if the wizard created relationships for you, therelationship's Owns Destination box should already be checked.If you created your relationships by hand, you'll have to checkthis box yourself.</p></li></p><p><li>Check the Propagate Primary Key box.<p>A relationship thatpropagates its primary key <em>propagates</em> its keyvalue to newly inserted objects in the destination of the relationship.In this case, checking the Propagate Primary Key box means thatif you create a new MovieRole and add it to a Movie's list ofMovieRoles, the Movie object automatically assigns its <code>movieId</code> valueas the value for the new MovieRole's <code>movieId</code> property.</p><p>Thisoption is usually used with relationships that own their destination.For more information on propagating primary keys, see  <a href="#BCIDBJEG">"Where Do Primary Keys Come From?"</a>.</p></li></p><p><li>Ensure that Talent's <code>movieRoles</code> relationshiphas its delete rule set to Deny.</li></p><p><li>Ensure that Talent's <code>movieRoles</code> relationshipowns its destination.</li></p><p><li>Set Talent's <code>movieRoles</code> relationshipto propagate its primary key.</li></p><p><li>Choose Model &gt; Save to save your model.</li></p></ol><a name = "BCIDBJEG"></a><h3><font face="Helvetica,Arial,Lucida Grande">WhereDo Primary Keys Come From?</font></h3><p><font face="Times">Enterprise Objects Framework uses primary keys to identifyenterprise objects in memory, and it works best if you never changean enterprise object's primary key from its initial value. Consequently,applications usually generate and assign primary key values automaticallyinstead of having users provide them. For example, the Movies application assignsa <code>movieId</code> value to anew movie when it's created, and the value never changes afterward.The Movies interface doesn't even display <code>movieId</code> valuesbecause they aren't meaningful to users of the application.</font></p><p><font face="Times">Enterprise Objects Framework provides several mechanisms forgenerating and assigning unique values to primary key attributes.By default, Enterprise Objects Framework uses a native databasemechanism to assign primary key values. See the chapter "Answersto Common Design Questions" in the <em>Enterprise ObjectsFramework Developer's Guide</em> for more information.</font></p><p><font face="Times">The Movies application generates primary key values for Movieand Talent objects using the default mechanism, but MovieRole isa special case because</font></p><ul><p><li>MovieRole'sprimary key is compound. The default behavior of generating a primary keyvalue using a native database mechanism works only on simple (notcompound) primary keys.</li></p><p><li>A MovieRole's primary key attributes, <code>movieId</code> and <code>talentId</code>,must match the corresponding attributes in the MovieRole's Movieand Talent objects. The default mechanism generates new, uniquevalues.</li></p></ul><p><font face="Times">Instead of the default mechanism, Enterprise Objects Frameworkuses primary key propagation to assign primary keys to MovieRoleobjects. By configuring the Movie's <code>movieRoles</code> relationshipto propagate primary key, the Framework knows to assign a new MovieRole's <code>movieId</code> tothe same value as the <code>movieId</code> ofthe MovieRole's Movie. Similarly, a new MovieRole's <code>talentId</code> isset to the same value as the <code>talentId</code> ofthe MovieRole's Talent.</font></p>    <br><a href="Adding_the__etails_Page.html" target="_right"><img src="../Images/previous.gif" border="0" alt="Previous"></a><a href="Setting_Up__nfiguration.html" target="_right"><img src="../Images/next.gif" border="0" alt="Next"></a>&nbsp;<p><font face="Geneva,Helvetica,Arial" size="1">&#169; 2001 Apple Computer, Inc.</font></p><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></html>