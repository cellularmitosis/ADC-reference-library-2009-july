<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE> Using kIsrIsNotComplete</TITLE></HEAD><BODY BGCOLOR="#ffffff"><DIV><a name="top"></a><!-- start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!-- start of path --><font face="Geneva,Helvetica,Arial" size="1"><b><br>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Documentation</a> &gt; <!-- a href="" target="_top" -->Hardware<!-- /a -->  <b>&gt; </b><a href="../../devicemgrs.html" target="_top">Device Managers and Drivers</a> <b>&gt; </b><a href="../pci_srvcs.html" target="_top">PCI Card Services</a> <b>&gt; </b>Designing PCI Cards and Drivers for Power Macintosh Computers</font><br><br><!-- end of path --><A HREF="PCI_BOOK.171.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.172.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.174.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><HR></DIV><H1 CLASS="H3.Heading3"><A NAME="pgfId=4237"> </A>Using kIsrIsNotComplete</H1><P CLASS="T1.Text1"><A NAME="pgfId=4238"> </A>An ISR returning <TT CLASS="cv">kIsrIsNotComplete</TT> produces slightly more complex behavior. An ISR returns <TT CLASS="cv">kIsrIsNotComplete</TT> only when its device was not the device requesting service. Even though a leaf ISR was invoked, the interrupt request is still outstanding and the ISR for the requesting device must be found. If the member set containing the ISR just invoked has no dispatching modifying options, then the next interrupt member in the set will have its ISR invoked. In the current example, the ISR of IST member set D, <TT CLASS="cv">InterruptMemberNumber</TT> 2, would be invoked. Assuming that this ISR serviced its device and returned <TT CLASS="cv">kIsrIsComplete</TT>, dispatching would be complete since no higher interrupt set had any dispatching modifier options set. </P><P CLASS="T1.Text1"><A NAME="pgfId=4239"> </A>If the ISR of IST member set D, <TT CLASS="cv">InterruptMemberNumber</TT> 2, also returned <TT CLASS="cv">kIsrIsNotComplete</TT>, however, the ISR of the next interrupt member in the parent set would be invoked. In the example, <TT CLASS="cv">InterruptMemberNumber</TT> 3 of member set C is already the last member in set C, so this set is skipped and the next higher set is examined (in this case, set B). Set B is found to have higher members, resulting in the ISR of member set B, <TT CLASS="cv">InterruptMemberNumber</TT> 3, being invoked. Assuming that this ISR serviced its device and returned <TT CLASS="cv">kIsrIsComplete</TT>, dispatching would be finished. </P><P CLASS="T1.Text1"><A NAME="pgfId=4240"> </A>The behavior just described is a classic left-branch recursive tree walk. It is employed when no means exist for directly identifying exactly which device is requesting service. Devices must be polled, by invoking their ISRs, to find and service the requesting device.</P><P CLASS="T1.Text1"><A NAME="pgfId=4241"> </A>While this behavior will correctly poll for the requesting device, it is sometimes inappropriate to poll devices in the order that they appear in the member set. In the example, assume that interrupt set B has its dispatching modifier option set to reinvoke the parent ISR if <TT CLASS="cv">kIsrIsNotComplete</TT> is returned. In the example just cited, when the traversal toward the root encounters <TT CLASS="cv">InterruptMemberNumber</TT> 2 of member set B, the parent set member A, <TT CLASS="cv">InterruptMemberNumber</TT> 1, has its ISR reinvoked. This ISR could then return <TT CLASS="cv">InterruptMemberNumber</TT> 4 to invoke member set B, <TT CLASS="cv">InterruptMemberNumber</TT> 4. In this way, <TT CLASS="cv">kIsrIsNotComplete</TT> should be used when the priority of devices is not the same as the order in which devices appear in their member sets.</P><HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 26 March 99)<P><A HREF="PCI_BOOK.171.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.172.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.174.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></HTML>