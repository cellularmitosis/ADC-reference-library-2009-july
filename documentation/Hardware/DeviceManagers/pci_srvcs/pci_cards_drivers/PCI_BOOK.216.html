<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE> VSLPrepareCursorForHardwareCursor13</TITLE></HEAD><BODY BGCOLOR="#ffffff"><DIV><a name="top"></a><!-- start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!-- start of path --><font face="Geneva,Helvetica,Arial" size="1"><b><br>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Documentation</a> &gt; <!-- a href="" target="_top" -->Hardware<!-- /a -->  <b>&gt; </b><a href="../../devicemgrs.html" target="_top">Device Managers and Drivers</a> <b>&gt; </b><a href="../pci_srvcs.html" target="_top">PCI Card Services</a> <b>&gt; </b>Designing PCI Cards and Drivers for Power Macintosh Computers</font><br><br><!-- end of path --><A HREF="PCI_BOOK.215.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.215.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.217.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><HR></DIV><H1 CLASS="RoH.RoutineHeading"><A NAME="pgfId=3949"> </A><A NAME="42530"> </A>VSLPrepareCursorForHardwareCursor</H1><CODE CLASS="RD.RoutineDeclare"><A NAME="pgfId=16679"> </A>Boolean VSLPrepareCursorForHardwareCursor<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(void *cursorRef,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HardwareCursorDescriptorPtr hardwareDescriptor,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HardwareCursorInfoPtr hwCursorInfo);</CODE><DL COMPACT><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=16683"> </A><TT CLASS="cv">cursorRef</TT><A NAME="26520"> </A></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=3952"> </A>Reference to the cursor passed in by QuickDraw.</DD><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=16693"> </A><TT CLASS="cv">hardwareDescriptor</TT></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=3953"> </A> Hardware cursor format.</DD><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=16703"> </A><TT CLASS="cv">hwCursorInfo</TT></DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=3954"> </A>Passed back to the driver to program the hardware cursor.</DD></DL COMPACT><DIV><H5 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=3955"> </A>DESCRIPTION</H5><P CLASS="T1.Text1"><A NAME="pgfId=3956"> </A>If the <TT CLASS="cv">cursorRef</TT> passed to the driver is capable of being rendered by the hardware cursor, <TT CLASS="cv">VSLPrepareCursorForHardwareCursor</TT> returns <TT CLASS="cv">true</TT>; otherwise, it returns <TT CLASS="cv">false</TT>. Cases where the routine returns <TT CLASS="cv">false</TT> include a cursor needing more colors than the hardware can supply, a cursor that is too big, and a cursor requiring special pixel types that the hardware doesn't support, such as inverted pixels.</P><P CLASS="T1.Text1"><A NAME="pgfId=3957"> </A>The driver uses the following structure to describe its hardware cursor:</P><CODE CLASS="Cv.Code"><A NAME="pgfId=16714"> </A>enum {<BR>&nbsp;&nbsp;&nbsp;&nbsp;kTransparentEncoding&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 0,<BR>&nbsp;&nbsp;&nbsp;&nbsp;kInvertingEncoding<BR>};</CODE><CODE CLASS="Cv.Code"><A NAME="pgfId=16718"> </A>enum {<BR>&nbsp;&nbsp;&nbsp;&nbsp;kTransparentEncodingShift&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= (kTransparentEncoding &lt;&lt; 1),<BR>&nbsp;&nbsp;&nbsp;&nbsp;kTransparentEncodedPixel&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= (0x01 &lt;&lt; kTransparentEncodingShift),<BR>&nbsp;&nbsp;&nbsp;&nbsp;kInvertingEncodingShift&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= (kInvertingEncoding &lt;&lt; 1),<BR>&nbsp;&nbsp;&nbsp;&nbsp;kInvertingEncodedPixel&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= (0x01 &lt;&lt; kInvertingEncodingShift),<BR>};</CODE><CODE CLASS="Cv.Code"><A NAME="pgfId=16722"> </A>enum {<BR>&nbsp;&nbsp;&nbsp;&nbsp;kHardwareCursorDescriptorMajorVersion = 0x0001,<BR>&nbsp;&nbsp;&nbsp;&nbsp;kHardwareCursorDescriptorMinorVersion = 0x0000<BR>};</CODE><CODE CLASS="Cv.Code"><A NAME="pgfId=16726"> </A>struct HardwareCursorDescriptorRec {<BR>&nbsp;&nbsp;&nbsp;&nbsp;UInt16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;majorVersion;<BR>&nbsp;&nbsp;&nbsp;&nbsp;UInt16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minorVersion;<BR>&nbsp;&nbsp;&nbsp;&nbsp;UInt32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height;<BR>&nbsp;&nbsp;&nbsp;&nbsp;UInt32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width;<BR>&nbsp;&nbsp;&nbsp;&nbsp;UInt32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bitDepth;<BR>&nbsp;&nbsp;&nbsp;&nbsp;UInt32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maskBitDepth;<BR>&nbsp;&nbsp;&nbsp;&nbsp;UInt32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numColors;<BR>&nbsp;&nbsp;&nbsp;&nbsp;UInt32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*colorEncodings;<BR>&nbsp;&nbsp;&nbsp;&nbsp;UInt32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flags;<BR>&nbsp;&nbsp;&nbsp;&nbsp;UInt32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;supportedSpecialEncodings;<BR>&nbsp;&nbsp;&nbsp;&nbsp;UInt32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;specialEncodings[16];<BR>};</CODE><CODE CLASS="Cv.Code"><A NAME="pgfId=16730"> </A>typedef struct HardwareCursorDescriptorRec HardwareCursorDescriptorRec, <BR>*HardwareCursorDescriptorPtr;</CODE><P CLASS="T1.Text1"><A NAME="pgfId=3963"> </A>The <TT CLASS="cv">majorVersion</TT> and <TT CLASS="cv">minorVersion</TT> fields describe the version of the descriptor record. The driver must set these to <TT CLASS="cv">kHardwareCursorDescriptorMajorVersion</TT> and <TT CLASS="cv">kHardwareCursorDescriptorMinorVersion</TT>. Doing so will provide compatibility with the conversion routine if the descriptor is changed in future releases of the VSL.</P><P CLASS="T1.Text1"><A NAME="pgfId=3964"> </A>The <TT CLASS="cv">height</TT> and <TT CLASS="cv">width</TT> fields specify the maximum cursor height and width, in pixels, supported by the hardware.</P><P CLASS="T1.Text1"><A NAME="pgfId=3965"> </A>The <TT CLASS="cv">bitDepth</TT> field specifies the bit depth of the hardware cursor.</P><P CLASS="T1.Text1"><A NAME="pgfId=3966"> </A>The <TT CLASS="cv">maskBitDepth</TT> field is currently unused but reserved for future use. The driver must set this field to 0.</P><P CLASS="T1.Text1"><A NAME="pgfId=3967"> </A>The <TT CLASS="cv">numColors</TT> field specifies the number of colors supported by the hardware.</P><P CLASS="T1.Text1"><A NAME="pgfId=3968"> </A>The <TT CLASS="cv">colorEncodings</TT> field points to an array that specifies the hardware pixel encodings that map to the colors in the hardware cursor color table. The first entry in this array specifies the hardware cursor pixel value that corresponds to the first entry in the hardware cursor's color table; the second entry in this array specifies the pixel value for the second entry in the hardware's color table, and so on.</P><P CLASS="T1.Text1"><A NAME="pgfId=3969"> </A>The <TT CLASS="cv">flags</TT> field is used for extra information about the hardware. Currently, all flag bits are reserved and must be set to 0.</P><P CLASS="T1.Text1"><A NAME="pgfId=3970"> </A>The <TT CLASS="cv">supportedSpecialEncodings</TT> field specifies the type of special pixels supported by the hardware cursor and how they're implemented.</P><P CLASS="T1.Text1"><A NAME="pgfId=3971"> </A>The special pixel types supported by the descriptor are transparent pixels and inverting pixels. Transparent pixels are invisible, and the frame buffer pixel underneath a transparent hardware cursor pixel is seen. Inverting hardware cursor pixels invert the frame buffer pixel underneath.</P><P CLASS="T1.Text1"><A NAME="pgfId=3972"> </A>The <TT CLASS="cv">specialEncodings</TT> field is an array that specifies the pixel values for special encodings. Use the constants <TT CLASS="cv">kTransparentEncoding</TT> and <TT CLASS="cv">kInvertingEncoding</TT> to index into the array.</P></DIV><DIV><H5 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=3973"> </A>EXAMPLES</H5><P CLASS="T1.Text1"><A NAME="pgfId=3974"> </A>The following hardware descriptor specifies a typical two-color hardware cursor:</P><CODE CLASS="Cv.Code"><A NAME="pgfId=16734"> </A>UInt32  cursorColorEncodings[] =<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;0, 1<BR>};</CODE><CODE CLASS="Cv.Code"><A NAME="pgfId=16738"> </A>HardwareCursorDescriptorRec  hardwareCursorDescriptor =<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;kHardwareCursorDescriptorMajorVersion,&nbsp;&nbsp;// major version number<BR>&nbsp;&nbsp;&nbsp;&nbsp;kHardwareCursorDescriptorMinorVersion,&nbsp;&nbsp;// minor version number<BR>&nbsp;&nbsp;&nbsp;&nbsp;32,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// height<BR>&nbsp;&nbsp;&nbsp;&nbsp;32,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// width<BR>&nbsp;&nbsp;&nbsp;&nbsp;2,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// pixel depth<BR>&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// mask depth<BR>&nbsp;&nbsp;&nbsp;&nbsp;2,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// number of cursor colors<BR>&nbsp;&nbsp;&nbsp;&nbsp;&amp;cursorColorEncodings,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// color pixel encodings<BR>&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// flags<BR>&nbsp;&nbsp;&nbsp;&nbsp;kTransparentEncodedPixel |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// supports transparent pixels<BR>&nbsp;&nbsp;&nbsp;&nbsp;kInvertingEncodedPixel,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// supports inverting pixels<BR>&nbsp;&nbsp;&nbsp;&nbsp;2,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// transparent pixel encoding<BR>&nbsp;&nbsp;&nbsp;&nbsp;3,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// inverting pixel encoding<BR>&nbsp;&nbsp;&nbsp;&nbsp;0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 // unused encodings<BR>}</CODE><P CLASS="T1.Text1"><A NAME="pgfId=3977"> </A>The foregoing describes a 2-bit-per-pixel hardware cursor that can be up to 32 by 32 pixels in size and supports transparent and inverting pixels. A cursor pixel value of 0 will display the first color in the cursor's color map, and a pixel value of 1 will display the second color. A cursor pixel value of 2 will display the color of the screen pixel underneath the cursor. A cursor pixel value of 3 will display the inverse of the color of the screen pixel underneath the cursor.</P><P CLASS="T1.Text1"><A NAME="pgfId=3978"> </A>The following hardware descriptor describes a three-color hardware cursor:</P><CODE CLASS="Cv.Code"><A NAME="pgfId=16742"> </A>UInt32 cursorColorEncodings[] =<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;1, 2, 3<BR>};<BR><BR>HardwareCursorDescriptorRec  hardwareCursorDescriptor =<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;kHardwareCursorDescriptorMajorVersion,&nbsp;&nbsp;// major version number<BR>&nbsp;&nbsp;&nbsp;&nbsp;kHardwareCursorDescriptorMinorVersion,&nbsp;&nbsp;// minor version number<BR>&nbsp;&nbsp;&nbsp;&nbsp;32,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// height<BR>&nbsp;&nbsp;&nbsp;&nbsp;32,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// width<BR>&nbsp;&nbsp;&nbsp;&nbsp;2,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// pixel depth<BR>&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// mask depth<BR>&nbsp;&nbsp;&nbsp;&nbsp;3,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// number of cursor colors<BR>&nbsp;&nbsp;&nbsp;&nbsp;&amp;cursorColorEncodings,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// color pixel encodings<BR>&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// flags<BR>&nbsp;&nbsp;&nbsp;&nbsp;kTransparentEncodedPixel,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// supports transparent pixels<BR>&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// transparent pixel encoding<BR>&nbsp;&nbsp;&nbsp;&nbsp;0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 // unused encodings<BR>};</CODE><P CLASS="T1.Text1"><A NAME="pgfId=3980"> </A>The foregoing describes a 2-bit-per-pixel hardware cursor that can be up to 32 by 32 pixels in size and supports transparent pixels. A cursor pixel value of 1 displays the first color in the cursor's color map, a pixel value of 2 displays the second color, and a pixel value of 3 displays the third color. A cursor pixel value of 0 displays the color of the screen pixel underneath the cursor. If the cursor requires inverting pixels (for example, the I-beam text edit cursor), a call to <TT CLASS="cv">VSLPrepareCursorForHardwareCursor</TT> will return <TT CLASS="cv">false</TT> and the driver should let the cursor be implemented in software.</P><P CLASS="T1.Text1"><A NAME="pgfId=3981"> </A>The <TT CLASS="cv">VSLPrepareCursorForHardwareCursor</TT> call will return the information that the driver needs to program the hardware cursor in the following data structure:</P><CODE CLASS="Cv.Code"><A NAME="pgfId=16746"> </A>enum {<BR>&nbsp;&nbsp;&nbsp;&nbsp;kHardwareCursorInfoMajorVersion&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 0x0001,<BR>&nbsp;&nbsp;&nbsp;&nbsp;kHardwareCursorInfoMinorVersion&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 0x0000<BR>};</CODE><CODE CLASS="Cv.Code"><A NAME="pgfId=16750"> </A>struct HardwareCursorInfoRec {<BR>&nbsp;&nbsp;&nbsp;&nbsp;UInt16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;majorVersion;<BR>&nbsp;&nbsp;&nbsp;&nbsp;UInt16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minorVersion;<BR>&nbsp;&nbsp;&nbsp;&nbsp;UInt32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cursorHeight;<BR>&nbsp;&nbsp;&nbsp;&nbsp;UInt32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cursorWidth;<BR>&nbsp;&nbsp;&nbsp;&nbsp;CTabPtr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colorMap;<BR>&nbsp;&nbsp;&nbsp;&nbsp;Ptr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hardwareCursor;<BR>&nbsp;&nbsp;&nbsp;&nbsp;UInt32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reserved[6];<BR>};</CODE><br><CODE CLASS="RD.RoutineDeclare"><A NAME="pgfId=16754"> </A>typedef struct HardwareCursorInfoRec HardwareCursorInfoRec, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*HardwareCursorInfoPtr;</CODE><P CLASS="T1.Text1"><A NAME="pgfId=3985"> </A>The <TT CLASS="cv">majorVersion</TT> and <TT CLASS="cv">minorVersion</TT> fields describe what version of the info record is being used. The driver must set these to <TT CLASS="cv">kHardwareCursorInfoMajorVersion</TT> and <TT CLASS="cv">kHardwareCursorInfoMinorVersion</TT>. Doing so will provide compatibility with the conversion routine if the descriptor is changed in future releases of the VSL.</P><P CLASS="T1.Text1"><A NAME="pgfId=3986"> </A>The <TT CLASS="cv">cursorHeight</TT> and <TT CLASS="cv">cursorWidth</TT> fields specify the height and width of the cursor passed in from QuickDraw.</P><P CLASS="T1.Text1"><A NAME="pgfId=3987"> </A>The <TT CLASS="cv">colorMap</TT> field is the table of colors that the cursor uses. A table big enough to hold all of the colors supported by the hardware cursor must be passed to the <TT CLASS="cv">VSLPrepareCursorForHardwareCursor</TT> call, which will fill this table with the appropriate colors. These colors are taken from the color table in the <TT CLASS="cv">gDevice</TT> record for the driver's display. The driver must perform any required gamma correction on this color table.</P><P CLASS="T1.Text1"><A NAME="pgfId=3988"> </A>The <TT CLASS="cv">hardwareCursor</TT> field points to the buffer containing the converted image for  the hardware cursor. A buffer big enough to hold the largest cursor supported by the hardware must be passed to the <TT CLASS="cv">VSLPrepareCursorForHardwareCursor</TT> call, which will fill this buffer with the appropriate pixel values. The conversion call will not necessarily fill the entire buffer if the cursor passed from QuickDraw is smaller than the largest cursor supported by the hardware. The <TT CLASS="cv">hardwareCursor</TT> buffer image's row bytes will equal <TT CLASS="cv">cursorWidth</TT> times the pixel depth of the hardware cursor. The driver must set the extra pixels to be transparent.</P><P CLASS="T1.Text1"><A NAME="pgfId=3989"> </A>The <TT CLASS="cv">reserved</TT> field is an array of reserved values, and the driver must set these to 0.</P></DIV><HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 26 March 99)<P><A HREF="PCI_BOOK.215.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.215.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.217.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></HTML>