<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>QuickTime VR: Wired Actions and QuickTime VR Movies</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Wired Actions and QuickTime VR Movies"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40000944-CH212" title="Wired Actions and QuickTime VR Movies"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../index.html#//apple_ref/doc/uid/TP30000440-TP30000433" target="_top">QuickTime</a> &gt; <a href="../../VirtualReality-date.html#//apple_ref/doc/uid/TP30000440-TP30000433-TP30000589" target="_top">Virtual Reality</a> &gt; <a href="../0Preface/QTVR-preface.html#//apple_ref/doc/uid/TP40000944-CH204-DontLinkElementID_2">QuickTime VR</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../7Chap/7-QTVR-atoms-file-format.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../Biblio/QTVR-biblio.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40000944-CH212-DontLinkElementID_142" title="Wired Actions and QuickTime VR Movies"></a><h1><a name="//apple_ref/doc/uid/TP40000944-CH212-BBCDGEHH" title="Wired Actions and QuickTime VR Movies"></a>Wired Actions and QuickTime VR Movies</h1><p>This appendix explains in step-by-step detail how you can add wired actions to a QuickTime VR movie. The programming tasks involved in adding those wired actions are outlined here. </p><p>The complete sample code is available at </p><p><span class="content_text"><a href="../../../../samplecode/Sample_Code/QuickTime.htm" target="_top">http://developer.apple.com/samplecode/Sample_Code/QuickTime.htm</a></span></p><a name="//apple_ref/doc/uid/TP40000944-CH212-TPXREF101" title="Adding Wired Actions to a QuickTime VR Movie"></a><h2>Adding Wired Actions to a QuickTime VR Movie</h2><p>There are two kinds of wired actions that you can add to QuickTime VR movies: </p><ul class="ul"><li class="li"><p>actions that are global to a particular node––for example, a node-specific action might be setting the pan and tilt angles that are used when the user first enters the node. </p></li><li class="li"><p>actions associated with a particular hot spot in a node––for example, a hot-spot-specific action might be playing a sound when the mouse is moved over the hot spot.</p></li></ul><p>All currently supported QTVR wired actions are specific to some particular node, so the atom containers implementing the actions are placed in the node information atom container that is contained in the media sample for that node in the QTVR track. Note that wired actions can be in a sprite or Flash track. </p><a name="//apple_ref/doc/uid/TP40000944-CH212-TPXREF102" title="Programming Tasks"></a><h3>Programming Tasks</h3><p>The programming tasks at hand can be distilled into these steps: </p><ol class="ol"><li class="li"><p>Find a media sample in the QTVR track. </p></li><li class="li"><p>Construct some atom containers for the desired actions.</p></li><li class="li"><p>Place those action containers into the appropriate place in the media sample.</p></li><li class="li"><p>Write the modified media sample back into the QTVR track. </p></li><li class="li"><p>Put an atom into the media property atom container to enable wired action processing.</p></li></ol><a name="//apple_ref/doc/uid/TP40000944-CH212-TPXREF103" title="Step #1&acirc;&#128;&#147;&acirc;&#128;&#147;Getting the Movie File and Adding Wired Actions"></a><h4>Step #1––Getting the Movie File and Adding Wired Actions</h4><p>To get a movie file from the user, you call: </p><div class="codesample"><table><tr><td scope="row"><pre>    StandardGetFile(NULL, 1, myTypeList, &amp;myReply);<span></span></pre></td></tr></table></div><p>Now to add some wired actions to the movie file, if it is a QuickTime VR movie, you do this: </p><div class="codesample"><table><tr><td scope="row"><pre>    if (myReply.sfGood)<span></span></pre></td></tr><tr><td scope="row"><pre>        AddVRAct_AddWiredActionsToQTVRMovie(&amp;myReply.sfFile);<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000944-CH212-TPXREF104" title="Step #2&acirc;&#128;&#147;&acirc;&#128;&#147;Constructing Some Atom Containers"></a><h4>Step #2––Constructing Some Atom Containers</h4><p>You call <code><!--a-->AddVRAct_GetFirstHotSpot<!--/a--></code>, which returns through the <code>theHotSpotID</code> parameter the ID of the first hot spot in the specified atom container (which is assumed to be a node information atom container).</p><p>The returned ID is not necessarily the numerically least ID; it is just the ID of the first hot spot atom in the atom container.</p><div class="codesample"><table><tr><td scope="row"><pre>static OSErr AddVRAct_GetFirstHotSpot (Handle theSample,<span></span></pre></td></tr><tr><td scope="row"><pre>                                     long *theHotSpotID)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    QTAtom              myHotSpotParentAtom = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>    QTAtom              myHotSpotAtom = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>    OSErr               myErr = noErr;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    *theHotSpotID = 0;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myHotSpotParentAtom = QTFindChildByIndex(theSample,<span></span></pre></td></tr><tr><td scope="row"><pre>                                            kParentAtomIsContainer,<span></span></pre></td></tr><tr><td scope="row"><pre>                                            kQTVRHotSpotParentAtomType,<span></span></pre></td></tr><tr><td scope="row"><pre>                                            kIndexOne, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myHotSpotParentAtom != 0)<span></span></pre></td></tr><tr><td scope="row"><pre>        myHotSpotAtom = QTFindChildByIndex(theSample, myHotSpotParentAtom,<span></span></pre></td></tr><tr><td scope="row"><pre>                                            kQTVRHotSpotAtomType,<span></span></pre></td></tr><tr><td scope="row"><pre>                                            kIndexOne, theHotSpotID);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    return(myErr);<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Now you call <code><!--a-->AddVRAct_CreateHotSpotActionContainer<!--/a--></code>, which returns through the <code>theActions</code> parameter an atom container that contains a hot spot action.</p><a name="//apple_ref/doc/uid/TP40000944-CH212-TPXREF105" title="Step #3&acirc;&#128;&#147;&acirc;&#128;&#147;Setting the Pan Angle"></a><h4>Step #3––Setting the Pan Angle</h4><p>Next, you set the pan angle to 10.0 degrees when the hot spot is clicked.</p><div class="codesample"><table><tr><td scope="row"><pre>static OSErr AddVRAct_CreateHotSpotActionContainer<span></span></pre></td></tr><tr><td scope="row"><pre>                     (QTAtomContainer *theActions)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    QTAtom          myEventAtom = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>    QTAtom          myActionAtom = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>    long            myAction;<span></span></pre></td></tr><tr><td scope="row"><pre>    float           myPanAngle;<span></span></pre></td></tr><tr><td scope="row"><pre>    OSErr           myErr = noErr;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = QTNewAtomContainer(theActions);<span></span></pre></td></tr><tr><td scope="row"><pre>    .<span></span></pre></td></tr><tr><td scope="row"><pre>    .<span></span></pre></td></tr><tr><td scope="row"><pre>    .<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = QTInsertChild(*theActions, kParentAtomIsContainer,<span></span></pre></td></tr><tr><td scope="row"><pre>                            kQTEventType, kQTEventMouseClick, kIndexOne,<span></span></pre></td></tr><tr><td scope="row"><pre>                            kZeroDataLength, NULL, &amp;myEventAtom);<span></span></pre></td></tr><tr><td scope="row"><pre>    .<span></span></pre></td></tr><tr><td scope="row"><pre>    .<span></span></pre></td></tr><tr><td scope="row"><pre>    .<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = QTInsertChild(*theActions, myEventAtom, kAction, kIndexOne,<span></span></pre></td></tr><tr><td scope="row"><pre>                            kIndexOne, kZeroDataLength, NULL,<span></span></pre></td></tr><tr><td scope="row"><pre>                            &amp;myActionAtom);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myAction = EndianS32_NtoB(kActionQTVRSetPanAngle);<span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = QTInsertChild(*theActions, myActionAtom, kWhichAction,<span></span></pre></td></tr><tr><td scope="row"><pre>                         kIndexOne, kIndexOne, sizeof(long),<span></span></pre></td></tr><tr><td scope="row"><pre>                         &amp;myAction, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myPanAngle = 10.0;<span></span></pre></td></tr><tr><td scope="row"><pre>    AddVRAct_ConvertFloatToBigEndian(&amp;myPanAngle);<span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = QTInsertChild(*theActions, myActionAtom, kActionParameter,<span></span></pre></td></tr><tr><td scope="row"><pre>                         kIndexOne, kIndexOne, sizeof(float), &amp;myPanAngle,<span></span></pre></td></tr><tr><td scope="row"><pre>                         NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>    .<span></span></pre></td></tr><tr><td scope="row"><pre>    .<span></span></pre></td></tr><tr><td scope="row"><pre>    .<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000944-CH212-TPXREF106" title="Step #4&acirc;&#128;&#147;&acirc;&#128;&#147;Setting the Pan Angle to 180.0 Degrees"></a><h4>Step #4––Setting the Pan Angle to 180.0 Degrees</h4><p>You now call <code><!--a-->AddVRAct_CreateFrameLoadedActionContainer<!--/a--></code>, which returns through the <code>theActions</code> parameter an atom container that contains a frame-loaded event action.</p><p>Next, you set the pan angle to 180.0 degrees.</p><div class="codesample"><table><tr><td scope="row"><pre>static OSErr AddVRAct_CreateFrameLoadedActionContainer<span></span></pre></td></tr><tr><td scope="row"><pre>                         (QTAtomContainer *theActions)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    QTAtom          myEventAtom = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>    QTAtom          myActionAtom = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>    long            myAction;<span></span></pre></td></tr><tr><td scope="row"><pre>    float           myPanAngle;<span></span></pre></td></tr><tr><td scope="row"><pre>    OSErr           myErr = noErr;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = QTNewAtomContainer(theActions);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = QTInsertChild(*theActions, kParentAtomIsContainer,<span></span></pre></td></tr><tr><td scope="row"><pre>                         kQTEventFrameLoaded, kIndexOne, kIndexOne,<span></span></pre></td></tr><tr><td scope="row"><pre>                         kZeroDataLength, NULL, &amp;myEventAtom);<span></span></pre></td></tr><tr><td scope="row"><pre>    .<span></span></pre></td></tr><tr><td scope="row"><pre>    .<span></span></pre></td></tr><tr><td scope="row"><pre>    .<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = QTInsertChild(*theActions, myEventAtom, kAction, kIndexOne,<span></span></pre></td></tr><tr><td scope="row"><pre>                         kIndexOne, kZeroDataLength, NULL,<span></span></pre></td></tr><tr><td scope="row"><pre>                         &amp;myActionAtom);<span></span></pre></td></tr><tr><td scope="row"><pre>    .<span></span></pre></td></tr><tr><td scope="row"><pre>    .<span></span></pre></td></tr><tr><td scope="row"><pre>    .<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myAction = EndianS32_NtoB(kActionQTVRSetPanAngle);<span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = QTInsertChild(*theActions, myActionAtom, kWhichAction,<span></span></pre></td></tr><tr><td scope="row"><pre>                         kIndexOne, kIndexOne, sizeof(long),<span></span></pre></td></tr><tr><td scope="row"><pre>                         &amp;myAction, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>    .<span></span></pre></td></tr><tr><td scope="row"><pre>    .<span></span></pre></td></tr><tr><td scope="row"><pre>    .<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myPanAngle = 180.0;<span></span></pre></td></tr><tr><td scope="row"><pre>    AddVRAct_ConvertFloatToBigEndian(&amp;myPanAngle);<span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = QTInsertChild(*theActions, myActionAtom, kActionParameter,<span></span></pre></td></tr><tr><td scope="row"><pre>                         kIndexOne, kIndexOne, sizeof(float),<span></span></pre></td></tr><tr><td scope="row"><pre>                         &amp;myPanAngle, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>    .<span></span></pre></td></tr><tr><td scope="row"><pre>    .<span></span></pre></td></tr><tr><td scope="row"><pre>    .<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000944-CH212-TPXREF107" title="Step #5&acirc;&#128;&#147;&acirc;&#128;&#147;Setting Actions to be Frame-Loaded"></a><h4>Step #5––Setting Actions to be Frame-Loaded</h4><p>Now you call <code><!--a-->AddVRAct_SetFrameLoadedWiredActions<!--/a--></code> to set the specified actions to be a frame-loaded action. If theActions is NULL, you remove any existing frame-loaded action from <code>theSample</code>.</p><p>The <code>theSample</code> parameter is assumed to be a node information atom container; any actions that are global to the node should be inserted at the root level of this atom container. In addition, the container type should be the same as the event type and should have an atom ID of 1.</p><div class="codesample"><table><tr><td scope="row"><pre>static OSErr AddVRAct_SetFrameLoadedWiredActions<span></span></pre></td></tr><tr><td scope="row"><pre>                         (Handle theSample, QTAtomContainer theActions)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    QTAtom          myEventAtom = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>    QTAtom          myTargetAtom = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>    OSErr           myErr = noErr;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // look for a frame-loaded action atom<span></span></pre></td></tr><tr><td scope="row"><pre>    // in the specified actions atom container<span></span></pre></td></tr><tr><td scope="row"><pre>    if (theActions != NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>        myEventAtom = QTFindChildByID(theActions, kParentAtomIsContainer,<span></span></pre></td></tr><tr><td scope="row"><pre>                                     kQTEventFrameLoaded, kIndexOne,<span></span></pre></td></tr><tr><td scope="row"><pre>                                     NULL);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // look for a frame-loaded action atom<span></span></pre></td></tr><tr><td scope="row"><pre>    // in the node information atom container<span></span></pre></td></tr><tr><td scope="row"><pre>    myTargetAtom = QTFindChildByID(theSample, kParentAtomIsContainer,<span></span></pre></td></tr><tr><td scope="row"><pre>                                    kQTEventFrameLoaded, kIndexOne, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myTargetAtom != 0) {<span></span></pre></td></tr><tr><td scope="row"><pre>        // if there is already a frame-loaded event atom in the node<span></span></pre></td></tr><tr><td scope="row"><pre>        // information atom container,<span></span></pre></td></tr><tr><td scope="row"><pre>        // then either replace it with the one we were passed or remove it<span></span></pre></td></tr><tr><td scope="row"><pre>        if (theActions != NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>            myErr = QTReplaceAtom(theSample, myTargetAtom, theActions,<span></span></pre></td></tr><tr><td scope="row"><pre>                                    myEventAtom);<span></span></pre></td></tr><tr><td scope="row"><pre>        else<span></span></pre></td></tr><tr><td scope="row"><pre>            myErr = QTRemoveAtom(theSample, myTargetAtom);<span></span></pre></td></tr><tr><td scope="row"><pre>    }  else {<span></span></pre></td></tr><tr><td scope="row"><pre>        // there is no frame-loaded event atom<span></span></pre></td></tr><tr><td scope="row"><pre>        // in the node information atom container,<span></span></pre></td></tr><tr><td scope="row"><pre>        // so add in the one we were passed<span></span></pre></td></tr><tr><td scope="row"><pre>        if (theActions != NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>            myErr = QTInsertChildren(theSample, kParentAtomIsContainer,<span></span></pre></td></tr><tr><td scope="row"><pre>                                    theActions);<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    return(myErr);<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000944-CH212-TPXREF108" title="Step #6&acirc;&#128;&#147;&acirc;&#128;&#147;Setting Hot Spot Actions"></a><h4>Step #6––Setting Hot Spot Actions</h4><p>Now using <code><!--a-->AddVRAct_SetWiredActionsToHotSpot<!--/a--></code>, you set the specified actions to be a hot-spot action. </p><p>If <em>theActions</em> is NULL, you remove any existing hot-spot actions for the specified hot spot from <em>theSample</em>.</p><div class="codesample"><table><tr><td scope="row"><pre>static OSErr AddVRAct_SetWiredActionsToHotSpot (Handle theSample, long<span></span></pre></td></tr><tr><td scope="row"><pre>                                                 theHotSpotID,<span></span></pre></td></tr><tr><td scope="row"><pre>                                                 QTAtomContainer<span></span></pre></td></tr><tr><td scope="row"><pre>                                                 theActions)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    QTAtom                  myHotSpotParentAtom = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>    QTAtom                  myHotSpotAtom = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>                            short   myCount, myIndex;<span></span></pre></td></tr><tr><td scope="row"><pre>    OSErr                   myErr = paramErr;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myHotSpotParentAtom = QTFindChildByIndex(theSample,<span></span></pre></td></tr><tr><td scope="row"><pre>                                            kParentAtomIsContainer,<span></span></pre></td></tr><tr><td scope="row"><pre>                                            kQTVRHotSpotParentAtomType,<span></span></pre></td></tr><tr><td scope="row"><pre>                                            kIndexOne, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myHotSpotParentAtom == NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myHotSpotAtom = QTFindChildByID(theSample, myHotSpotParentAtom,<span></span></pre></td></tr><tr><td scope="row"><pre>                                 kQTVRHotSpotAtomType, theHotSpotID,<span></span></pre></td></tr><tr><td scope="row"><pre>                                 NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myHotSpotAtom == NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // see how many events are already associated<span></span></pre></td></tr><tr><td scope="row"><pre>    // with the specified hot spot<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myCount = QTCountChildrenOfType(theSample, myHotSpotAtom,<span></span></pre></td></tr><tr><td scope="row"><pre>                                     kQTEventType);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    for (myIndex = myCount; myIndex > 0; myIndex--) {<span></span></pre></td></tr><tr><td scope="row"><pre>        QTAtom              myTargetAtom = 0;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        // remove all the existing events<span></span></pre></td></tr><tr><td scope="row"><pre>        myTargetAtom = QTFindChildByIndex(theSample, myHotSpotAtom,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         kQTEventType, myIndex, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>        if (myTargetAtom != 0) {<span></span></pre></td></tr><tr><td scope="row"><pre>            myErr = QTRemoveAtom(theSample, myTargetAtom);<span></span></pre></td></tr><tr><td scope="row"><pre>            if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>                goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    if (theActions) {<span></span></pre></td></tr><tr><td scope="row"><pre>        myErr = QTInsertChildren(theSample, myHotSpotAtom, theActions);<span></span></pre></td></tr><tr><td scope="row"><pre>        if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>            goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>bail:<span></span></pre></td></tr><tr><td scope="row"><pre>    return(myErr);<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000944-CH212-TPXREF109" title="Step #7&acirc;&#128;&#147;&acirc;&#128;&#147;Adding a Media Property Atom"></a><h4>Step #7––Adding a Media Property Atom</h4><p>To add a media property atom to the specified media, you call <code><!--a-->AddVRAct_WriteMediaPropertyAtom<!--/a--></code>.</p><p>You assume that the data passed through the <code>theProperty</code> parameter is big-endian.</p><div class="codesample"><table><tr><td scope="row"><pre>static OSErr AddVRAct_WriteMediaPropertyAtom (Media theMedia,<span></span></pre></td></tr><tr><td scope="row"><pre>             long thePropertyID, long thePropertySize, void *theProperty)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    QTAtomContainer             myPropertyAtom = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre>    QTAtom                  myAtom = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>    OSErr               myErr = noErr;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // get the current media property atom<span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = GetMediaPropertyAtom(theMedia, &amp;myPropertyAtom);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // if there isn't one yet, then create one<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myPropertyAtom == NULL) {<span></span></pre></td></tr><tr><td scope="row"><pre>        myErr = QTNewAtomContainer(&amp;myPropertyAtom);<span></span></pre></td></tr><tr><td scope="row"><pre>        if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>            goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // see if there is an existing atom of the specified type;<span></span></pre></td></tr><tr><td scope="row"><pre>    // if not, then create one<span></span></pre></td></tr><tr><td scope="row"><pre>    myAtom = QTFindChildByID(myPropertyAtom, kParentAtomIsContainer,<span></span></pre></td></tr><tr><td scope="row"><pre>                            thePropertyID, kIndexOne, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myAtom == NULL) {<span></span></pre></td></tr><tr><td scope="row"><pre>        myErr = QTInsertChild(myPropertyAtom, kParentAtomIsContainer,<span></span></pre></td></tr><tr><td scope="row"><pre>                             thePropertyID, kIndexOne, kIndexZero,<span></span></pre></td></tr><tr><td scope="row"><pre>                             kZeroDataLength, NULL, &amp;myAtom);<span></span></pre></td></tr><tr><td scope="row"><pre>        if ((myErr != noErr) || (myAtom == NULL))<span></span></pre></td></tr><tr><td scope="row"><pre>            goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // set the data of the specified atom to the data passed in<span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = QTSetAtomData(myPropertyAtom, myAtom, thePropertySize,<span></span></pre></td></tr><tr><td scope="row"><pre>                         (Ptr)theProperty);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // write the new atom data out to the media property atom<span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = SetMediaPropertyAtom(theMedia, myPropertyAtom);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>bail:<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myPropertyAtom != NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>        myErr = QTDisposeAtomContainer(myPropertyAtom);<span></span></pre></td></tr><tr><td scope="row"><pre>    // this kills any error report above<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    return(myErr);<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000944-CH212-TPXREF110" title="Step #8&acirc;&#128;&#147;&acirc;&#128;&#147;Adding Wired Actions"></a><h4>Step #8––Adding Wired Actions</h4><p>To add some wired actions to the specified QTVR movie, you call <code><!--a-->AddVRAct_AddWiredActionsToQTVRMovie<!--/a--></code>.</p><p>Wired actions are added to a QTVR movie by adding atom containers in the appropriate locations.</p><div class="codesample"><table><tr><td scope="row"><pre>static void AddVRAct_AddWiredActionsToQTVRMovie (FSSpec *theFSSpec)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    short                           myResID = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>    short                           myResRefNum = -1;<span></span></pre></td></tr><tr><td scope="row"><pre>    Movie                           myMovie = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre>    Track                           myTrack = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre>    Media                           myMedia = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre>    TimeValue                       myTrackOffset;<span></span></pre></td></tr><tr><td scope="row"><pre>    TimeValue                       myMediaTime;<span></span></pre></td></tr><tr><td scope="row"><pre>    TimeValue                       mySampleDuration;<span></span></pre></td></tr><tr><td scope="row"><pre>    TimeValue                       mySelectionDuration;<span></span></pre></td></tr><tr><td scope="row"><pre>    TimeValue                       myNewMediaTime;<span></span></pre></td></tr><tr><td scope="row"><pre>    QTVRSampleDescriptionHandle     myQTVRDesc = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre>    Handle                          mySample = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre>    short                           mySampleFlags;<span></span></pre></td></tr><tr><td scope="row"><pre>    Fixed                           myTrackEditRate;<span></span></pre></td></tr><tr><td scope="row"><pre>    QTAtomContainer                 myActions = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre>    Boolean                         myHasActions;<span></span></pre></td></tr><tr><td scope="row"><pre>    long                            myHotSpotID = 0L;<span></span></pre></td></tr><tr><td scope="row"><pre>    OSErr                           myErr = noErr;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000944-CH212-TPXREF111" title="Step #9&acirc;&#128;&#147;&acirc;&#128;&#147;Opening the Movie and Getting the Track"></a><h4>Step #9––Opening the Movie and Getting the Track</h4><p>You open the movie file for reading and writing and get the QTVR track from the movie. </p><div class="codesample"><table><tr><td scope="row"><pre>    myErr = OpenMovieFile(theFSSpec, &amp;myResRefNum, fsRdWrPerm);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = NewMovieFromFile(&amp;myMovie, myResRefNum, &amp;myResID, NULL,<span></span></pre></td></tr><tr><td scope="row"><pre>                            newMovieActive, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // find the first QTVR track in the movie;<span></span></pre></td></tr><tr><td scope="row"><pre>    // this assumes that the movie is a QuickTime VR movie formatted<span></span></pre></td></tr><tr><td scope="row"><pre>    // according to version 2.0 or later<span></span></pre></td></tr><tr><td scope="row"><pre>    // (version 1.0 VR movies don't have a QTVR track)<span></span></pre></td></tr><tr><td scope="row"><pre>    myTrack = GetMovieIndTrackType(myMovie, kIndexOne, kQTVRQTVRType,<span></span></pre></td></tr><tr><td scope="row"><pre>                                movieTrackMediaType);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myTrack == NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000944-CH212-TPXREF112" title="Step #10&acirc;&#128;&#147;&acirc;&#128;&#147;Getting the First Media Sample"></a><h4>Step #10––Getting the First Media Sample</h4><p>You call <code><a href="../../Reference/QTRef_TrackAndMedia/Reference/reference.html#//apple_ref/doc/c_ref/GetTrackMedia" target="_top">GetTrackMedia</a></code> to get the first media sample in the QTVR track. </p><p>The QTVR track contains one media sample for each node in the movie; that sample contains a node information atom container, which contains general information about the node (such as its type, its ID, its name, and a list of its hot spots). </p><div class="codesample"><table><tr><td scope="row"><pre>    myMedia = GetTrackMedia(myTrack);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myMedia == NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myTrackOffset = GetTrackOffset(myTrack);<span></span></pre></td></tr><tr><td scope="row"><pre>    myMediaTime = TrackTimeToMediaTime(myTrackOffset, myTrack);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // allocate some storage to hold the sample description<span></span></pre></td></tr><tr><td scope="row"><pre>    // for the QTVR track<span></span></pre></td></tr><tr><td scope="row"><pre>    myQTVRDesc = (QTVRSampleDescriptionHandle)NewHandle(4);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myQTVRDesc == NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    mySample = NewHandle(0);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (mySample == NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = GetMediaSample(myMedia, mySample, 0, NULL, myMediaTime, NULL,<span></span></pre></td></tr><tr><td scope="row"><pre>                            &amp;mySampleDuration,<span></span></pre></td></tr><tr><td scope="row"><pre>                            (SampleDescriptionHandle)myQTVRDesc, NULL, 1,<span></span></pre></td></tr><tr><td scope="row"><pre>                            NULL, &amp;mySampleFlags);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre>// create an action container for frame-loaded actions<span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = AddVRAct_CreateFrameLoadedActionContainer(&amp;myActions);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // add frame-loaded actions to sample<span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = AddVRAct_SetFrameLoadedWiredActions(mySample, myActions);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = QTDisposeAtomContainer(myActions);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre>// find the first hot spot in the selected node<span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = AddVRAct_GetFirstHotSpot(mySample, &amp;myHotSpotID);<span></span></pre></td></tr><tr><td scope="row"><pre>    if ((myErr != noErr) || (myHotSpotID == 0))<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // create an action container for hot-spot actions<span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = AddVRAct_CreateHotSpotActionContainer(&amp;myActions);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // add hot-spot actions to sample<span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = AddVRAct_SetWiredActionsToHotSpot(mySample, myHotSpotID,<span></span></pre></td></tr><tr><td scope="row"><pre>                                             myActions);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre>//replace sample in media<span></span></pre></td></tr><tr><td scope="row"><pre>myTrackEditRate = GetTrackEditRate(myTrack, myTrackOffset);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (GetMoviesError() != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    GetTrackNextInterestingTime(myTrack, nextTimeMediaSample |<span></span></pre></td></tr><tr><td scope="row"><pre>                                nextTimeEdgeOK, myTrackOffset, fixed1,<span></span></pre></td></tr><tr><td scope="row"><pre>                                NULL, &amp;mySelectionDuration);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (GetMoviesError() != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = DeleteTrackSegment(myTrack, myTrackOffset,<span></span></pre></td></tr><tr><td scope="row"><pre>                             mySelectionDuration);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = BeginMediaEdits(myMedia);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = AddMediaSample( myMedia,<span></span></pre></td></tr><tr><td scope="row"><pre>                            mySample,<span></span></pre></td></tr><tr><td scope="row"><pre>                            0,<span></span></pre></td></tr><tr><td scope="row"><pre>                            GetHandleSize(mySample),<span></span></pre></td></tr><tr><td scope="row"><pre>                            mySampleDuration,<span></span></pre></td></tr><tr><td scope="row"><pre>                            (SampleDescriptionHandle)myQTVRDesc,<span></span></pre></td></tr><tr><td scope="row"><pre>                            1,<span></span></pre></td></tr><tr><td scope="row"><pre>                            mySampleFlags,<span></span></pre></td></tr><tr><td scope="row"><pre>                            &amp;myNewMediaTime);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = EndMediaEdits(myMedia);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // add the media to the track<span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = InsertMediaIntoTrack(myTrack, myTrackOffset, myNewMediaTime,<span></span></pre></td></tr><tr><td scope="row"><pre>                                mySelectionDuration, myTrackEditRate);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre>    // set the actions property atom, to enable wired action processing<span></span></pre></td></tr><tr><td scope="row"><pre>    // myHasActions = true; since sizeof(Boolean) == 1,<span></span></pre></td></tr><tr><td scope="row"><pre>    // there is no need to swap bytes here<span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = AddVRAct_WriteMediaPropertyAtom(myMedia,<span></span></pre></td></tr><tr><td scope="row"><pre>                                        kSpriteTrackPropertyHasActions,<span></span></pre></td></tr><tr><td scope="row"><pre>                                        sizeof(Boolean), &amp;myHasActions);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre>// update the movie resource<span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = UpdateMovieResource(myMovie, myResRefNum, myResID, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myErr != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        goto bail;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // close the movie file<span></span></pre></td></tr><tr><td scope="row"><pre>    myErr = CloseMovieFile(myResRefNum);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>bail:<span></span></pre></td></tr><tr><td scope="row"><pre>    if (myActions != NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>        (void)QTDisposeAtomContainer(myActions);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    if (mySample != NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>        DisposeHandle(mySample);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    if (myQTVRDesc != NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>        DisposeHandle((Handle)myQTVRDesc);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    if (myMovie != NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>        DisposeMovie(myMovie);<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000944-CH212-TPXREF113" title="Step #11&acirc;&#128;&#147;&acirc;&#128;&#147;Converting to Big-Endian Format"></a><h4>Step #11––Converting to Big-Endian Format</h4><p>You call <code><!--a-->AddVRAct_ConvertFloatToBigEndian<!--/a--></code> to convert the specified floating-point number to big-endian format.</p><div class="codesample"><table><tr><td scope="row"><pre>void AddVRAct_ConvertFloatToBigEndian (float *theFloat)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    unsigned long               *myLongPtr;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    myLongPtr = (unsigned long *)theFloat;<span></span></pre></td></tr><tr><td scope="row"><pre>    *myLongPtr = EndianU32_NtoB(*myLongPtr);<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p></p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../7Chap/7-QTVR-atoms-file-format.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../Biblio/QTVR-biblio.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2002, 2005 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2005-06-04<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/QuickTime/InsideQT_QTVR/AppA/appendix_a.html%3Fid%3DTP40000944-2.3&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/QuickTime/InsideQT_QTVR/AppA/appendix_a.html%3Fid%3DTP40000944-2.3&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/QuickTime/InsideQT_QTVR/AppA/appendix_a.html%3Fid%3DTP40000944-2.3&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>