<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Xgrid Programming Guide: Using the Xgrid Command-Line Client</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Using the Xgrid Command-Line Client"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/CH05" title="Using the Xgrid Command-Line Client"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000426" target="_top">Mac OS X Server</a> &gt; <a href="../../../HighPerformanceComputing-date.html#//apple_ref/doc/uid/TP30000440-TP30000426-TP40001893" target="_top">High Performance Computing</a> &gt; <a href="../Introduction/Introduction.html#//apple_ref/doc/uid/TP40006246-CH1-DontLinkElementID_36">Xgrid Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../GettingStarted/GettingStarted.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../UsingJobSubmitter/UsingJobSubmitter.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/CH05-SW2" title="Using the Xgrid Command-Line Client"></a><h1>Using the Xgrid Command-Line Client</h1><p>Mac OS X version 10.4 and later includes the <code>xgrid</code> command-line utility. For some applications, the <code>xgrid</code> command-line tool is all the client software you need. In any event, you should become familiar with it to get a better understanding of Xgrid before writing an Xgrid-enabled client application. </p><p>The <code>xgrid</code> command-line utility is an Xgrid client.  You can submit a job to a controller by typing xgrid followed by the controller’s host name and a job specification. </p><p>The job specification includes the name and path of an executable file, such as an application or a shell script, and any arguments to pass to the executable file. </p><p>You have the option of supplying an input file or a directory of files. If you supply an input directory, it is copied to each agent and becomes the working directory for the executable file.</p><p>You also have the option of specifying an output file or directory. </p><div class="importantbox"><a name="//apple_ref/doc/uid/CH05-DontLinkElementID_45" title="Important:"></a><p><strong>Important:</strong>&nbsp;You have the option of providing a relative path or an absolute path when specifying executable files, input files and directories, and output files and directories. When a relative path is used, the executable and the input files or directories are copied to the agents, and the output files or directories are created for every agent and collected by the controller. If you specify an <em>absolute</em> path to the executable, input, or output files or directories, those files are assumed to exist on the agent computers, or to be available to the agents as part of a shared file system, at the path location specified. They are not copied or created.</p><p></p></div><p>As each agent completes its task, the standard output and error streams are returned to the controller. You can pipe these streams to files or direct them to the output and error streams of the shell that submitted the job. You can also retrieve any other files created in the agent’s working directory during job execution. These files are returned to the output directory specified when the job is submitted.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="Usingthexgridcommandlineclient.html#//apple_ref/doc/uid/CH05-DontLinkElementID_23">Basic xgrid Syntax</a>
				
			<br/>
			
        
			
			
				<a href="Usingthexgridcommandlineclient.html#//apple_ref/doc/uid/CH05-DontLinkElementID_24">Running a Job Synchronously</a>
				
			<br/>
			
        
			
			
				<a href="Usingthexgridcommandlineclient.html#//apple_ref/doc/uid/CH05-DontLinkElementID_25">Submitting a Job for Asynchronous Execution</a>
				
			<br/>
			
        
			
			
				<a href="Usingthexgridcommandlineclient.html#//apple_ref/doc/uid/CH05-DontLinkElementID_26">Submitting a Batch Job</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/CH05-DontLinkElementID_23" title="Basic xgrid Syntax"></a><h2>Basic xgrid Syntax</h2><p>If you type <code>man xgrid</code> from within the Terminal application, you see an illustration of the syntax for the command-line tool. The first few lines are shown in <span class="content_text"><a href="Usingthexgridcommandlineclient.html#//apple_ref/doc/uid/CH05-SW1">Listing 3-1</a></span>.</p><a name="//apple_ref/doc/uid/CH05-SW1" title="Listing 3-1Excerpt from the xgrid man page"></a><p class="codesample"><strong>Listing 3-1&nbsp;&nbsp;</strong>Excerpt from the xgrid man page</p><div class="codesample"><table><tr><td scope="row"><pre>SYNOPSIS<span></span></pre></td></tr><tr><td scope="row"><pre>        xgrid [-h[ostname] hostname] [-auth { Password | Kerberos }] [-p[assword] password]<span></span></pre></td></tr><tr><td scope="row"><pre>        xgrid -job run [-gid grid-identifier] [-si stdin] [-in indir] [-so stdout] [-se stderr] [-out outdir]<span></span></pre></td></tr><tr><td scope="row"><pre>        [-email email-address]<span></span></pre></td></tr><tr><td scope="row"><pre>       cmd [arg1 [...]]<span></span></pre></td></tr><tr><td scope="row"><pre>       xgrid -job submit [-gid grid-identifier] [-si stdin] [-in indir] [-dids jobid [, jobid]*]<span></span></pre></td></tr><tr><td scope="row"><pre>       [-email email-address]<span></span></pre></td></tr><tr><td scope="row"><pre>       cmd [arg1 [...]]<span></span></pre></td></tr></table></div><p>The first parameter is <code>-h</code>, followed by the host name or IP address of the controller.</p><p>Example: <code>xgrid -h localhost</code></p><p>You can optionally include a method of authentication and a password.</p><p>The next parameter of interest is the job specification. You can either run a job synchronously, by passing <code>-job run</code>, or submit a job for asynchronous execution by passing <code>-job submit</code>. In either case, you must then specify a grid, and can optionally redirect the standard input and output.</p><p>If you submit a job asynchronously, rather than running it synchronously, you can include an email address to be notified when the job terminates.</p><a name="//apple_ref/doc/uid/CH05-DontLinkElementID_24" title="Running a Job Synchronously"></a><h2>Running a Job Synchronously</h2><p>Here’s a very simple example that runs the <code>cal</code> program using a controller on the local host:</p><a name="//apple_ref/doc/uid/CH05-DontLinkElementID_46" title="Listing 3-2Running a job synchronously"></a><p class="codesample"><strong>Listing 3-2&nbsp;&nbsp;</strong>Running a job synchronously</p><div class="codesample"><table><tr><td scope="row"><pre>xgrid -h localhost -job run /usr/bin/cal 2007<span></span></pre></td></tr></table></div><p>By specifying the full path, you prevent the executable file from being copied to the agent. Instead, it is run in place at the specified path location. No working directory is created.</p><p>By specifying <code>run</code> instead of <code>submit</code>, you tell <code>xgrid</code> to execute the command synchronously. The command line returns nothing until the job is complete.</p><p>Since the optional input and output specifications have been omitted, standard output is used for the results.</p><a name="//apple_ref/doc/uid/CH05-DontLinkElementID_25" title="Submitting a Job for Asynchronous Execution"></a><h2>Submitting a Job for Asynchronous Execution</h2><p>Now let’s look at a more complex example. It submits the file <code>myscript</code> with a group of files in an input directory.  An email address is passed that will be used to notify someone at every job state change. The results are saved in files in an output directory, then the job is deleted:</p><a name="//apple_ref/doc/uid/CH05-DontLinkElementID_47" title="Listing 3-3Submitting a job asynchronously"></a><p class="codesample"><strong>Listing 3-3&nbsp;&nbsp;</strong>Submitting a job asynchronously</p><div class="codesample"><table><tr><td scope="row"><pre>$ xgrid -job submit -in ~/data/working -email somebody@apple.com myscript param1 param2<span></span></pre></td></tr><tr><td scope="row"><pre>          { jobIdentifier = 27; }<span></span></pre></td></tr><tr><td scope="row"><pre>          $ xgrid -job results -id 27 -so job.out -se job.err -out job-outdir<span></span></pre></td></tr><tr><td scope="row"><pre>           $ xgrid -job delete -id 27<span></span></pre></td></tr></table></div><p>In this example, <code>xgrid</code> is told to execute the job asynchronously by passing <code>submit</code> instead of <code>run</code>.</p><p>Use the <code>-in</code> parameter to pass an input directory. This directory is copied to each agent and becomes the working directory on the agent’s host computer. You can include anything needed in the working directory, such as additonal input files, libraries, and executables. The executable file is run in this directory.</p><p>Next, specify the script to run, along with any input parameters. This completes the first line of input.</p><p>A job identifier is returned.</p><p>The next line of the example uses the job identifier to assign file names for the standard output, standard error, and job output for this particular job.</p><p>The last line deletes the job.</p><a name="//apple_ref/doc/uid/CH05-DontLinkElementID_26" title="Submitting a Batch Job"></a><h2>Submitting a Batch Job</h2><p>Here’s how to submit a batch job, consisting of multiple tasks. If enough agents are available, all of the tasks are performed simultaneously. Otherwise, each available agent is assigned a task and the first agent to finish is assigned another task, and so on until all the tasks have been completed.</p><p>To submit a batch job, you must include a property list file, describing each task to be performed. The <code>man</code> page for <code>xgrid</code> describes the structure of the property list file, but here’s a helpful shortcut—submit each individual task as its own job initially, and let <code>xgrid</code> generate the property list file for you. When the task completes, you can retrieve the property list file. You can edit the list to modify a task, duplicating it as necessary, or concatenate the property list files of several tasks into one batch. </p><p>For example, if you submit the <code>cal</code> program as a job, it looks like this:</p><div class="codesample"><table><tr><td scope="row"><pre>xgrid -job submit /usr/bin/cal  6 2007<span></span></pre></td></tr></table></div><p>The <code>xgrid</code> command returns a job ID. When the job completes, you can use the job identifier to retrieve the complete job specification, including the property list:</p><div class="codesample"><table><tr><td scope="row"><pre>xgrid -job specification -id n<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    jobSpecification = {<span></span></pre></td></tr><tr><td scope="row"><pre>        applicationIdentifier = "com.apple.xgrid.cli";<span></span></pre></td></tr><tr><td scope="row"><pre>        inputFiles = {};<span></span></pre></td></tr><tr><td scope="row"><pre>        name = "/usr/bin/cal";<span></span></pre></td></tr><tr><td scope="row"><pre>        submissionIdentifier = abc;<span></span></pre></td></tr><tr><td scope="row"><pre>        taskSpecifications = {<span></span></pre></td></tr><tr><td scope="row"><pre>            0 = {arguments = (6, 2007); command = "/usr/bin/cal"; };<span></span></pre></td></tr><tr><td scope="row"><pre>       };<span></span></pre></td></tr><tr><td scope="row"><pre>   };<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Copy the returned job specification and save it using the <code>.plist</code> file suffix. You can then submit the file to Xgrid as part of a batch job specification. If the example above were named <code>batch.plist</code>, you could submit the job like this:</p><div class="codesample"><table><tr><td scope="row"><pre>xgrid -job batch batch.plist<span></span></pre></td></tr></table></div><p>Before going any further with Xgrid programming, try breaking up your job into executable tasks and submitting them using the <code>xgrid</code> command-line utility. The experience will provide a great deal of useful information to you about how to plan and execute your program.</p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../GettingStarted/GettingStarted.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../UsingJobSubmitter/UsingJobSubmitter.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-10-31<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/MacOSXServer/Conceptual/Xgrid_Programming_Guide/Usingthexgridcommandlineclient/Usingthexgridcommandlineclient.html%3Fid%3DTP40006246-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/MacOSXServer/Conceptual/Xgrid_Programming_Guide/Usingthexgridcommandlineclient/Usingthexgridcommandlineclient.html%3Fid%3DTP40006246-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/MacOSXServer/Conceptual/Xgrid_Programming_Guide/Usingthexgridcommandlineclient/Usingthexgridcommandlineclient.html%3Fid%3DTP40006246-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>