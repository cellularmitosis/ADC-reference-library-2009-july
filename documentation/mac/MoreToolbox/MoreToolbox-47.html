<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>UseResFile (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING47></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-46.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-48.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-9.html"><B>Chapter 1 - Resource Manager</B></A> / <A HREF="MoreToolbox-24.html"><B>Resource Manager Reference</B></A><BR><DL><DD><A HREF="MoreToolbox-30.html"><B>Resource Manager Routines</B></A> / <A HREF="MoreToolbox-45.html"><B>Getting and Setting the Current Resource File</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING47-0></A>
<H3><A NAME=MARKER-9-273></A><A NAME=MARKER-9-274></A>UseResFile</H3>
 <A NAME=MARKER-11-275></A><A NAME=MARKER-11-210></A>You can use the <CODE>UseResFile</CODE> procedure to set the current resource file.<P>
<PRE>
PROCEDURE UseResFile (refNum: Integer);
</PRE>
<DL>
<DT><CODE>refNum</CODE>
<DD> The file reference number for a resource fork.
</DL>
<A NAME=HEADING47-4></A>
<H5>DESCRIPTION</H5>
 The <CODE>UseResFile</CODE> procedure searches the list of files whose resource forks have been opened for the file specified by the <CODE>refNum</CODE> parameter. If the specified file is found, the Resource Manager sets the current resource file to the specified file. If there's no resource fork open for a file with that reference number, <CODE>UseResFile</CODE> does nothing. To set the current resource file to the System file, use 0 for the <CODE>refNum</CODE> parameter.<P>
 Open resource forks are arranged as a linked list with the most recently opened resource fork at the beginning. When searching open resource forks, the Resource Manager starts with the most recently opened file. You can call the <CODE>UseResFile</CODE> procedure to set the current resource file to a file opened earlier, and thereby start subsequent searches with the specified file. In this way, you can cause any files higher in the resource chain to be left out of subsequent searches.<P>
 When a new resource fork is opened, this action overrides previous calls to <CODE>UseResFile</CODE> and the entire list is searched. For example, if five resource forks are opened in the order R0, R1, R2, R3, and R4, the search order is R4-R3-R2-R1-R0. Calling <CODE>UseResFile(R2)</CODE> changes the search order to R2-R1-R0; R4 and R3 are not searched. When the resource fork of a new file (R5) is opened, the search order becomes R5-R4-R3-R2-R1-R0.<P>
 You typically call <CODE>CurResFile</CODE> to get and save the current resource file, <CODE>UseResFile</CODE> to set the current resource file to the desired file, then (after you are finished using the resource) <CODE>UseResFile</CODE> to restore the current resource file to its previous value. Calling <CODE>UseResFile(0)</CODE> causes the Resource Manager to search only the System file's resource map. This is useful if you no longer wish to override a system resource with one by the same name in your application's resource fork. <P>
<A NAME=HEADING47-9></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 The <CODE>FSpOpenResFile</CODE>, <CODE>HOpenResFile</CODE>, and <CODE>OpenResFile</CODE> functions, which also set the current resource file, override previous calls to <CODE>UseResFile</CODE>.<P>
<A NAME=HEADING47-11></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The settings of the system global variables <CODE>RomMapInsert</CODE> and <CODE>TmpResLoad</CODE> affect resource search order. These global variables determine whether the Resource Manager searches ROM-resident resources before the System file's resources.<P>
 The Resource Manager normally searches ROM resources only when you use the <CODE>RGetResource</CODE> function to get a handle to the resource, and even then only after it searches the System file's resource fork. To search for a resource in ROM before searching the System file's resource fork, your application must first alter the resource search order by inserting the ROM resource map in front of the System file's resource map. <A NAME=MARKER-2-277></A><P>
 When the value of the system global variable <CODE>RomMapInsert</CODE> is <CODE>TRUE</CODE>, the Resource Manager inserts the ROM resource map before the System file's resource map for the next call only (including any Resource Manager routine that gets a resource, not just <CODE>RGetResource</CODE>). When the value of <CODE>RomMapInsert</CODE> is <CODE>TRUE</CODE>, the adjacent variable <CODE>TmpResLoad</CODE> determines whether the value of the global variable <CODE>ResLoad</CODE> is considered <CODE>TRUE</CODE> or <CODE>FALSE</CODE>, overriding the actual value of <CODE>ResLoad</CODE> for the next call only. The values of the <CODE>RomMapInsert</CODE> and <CODE>TmpResLoad</CODE> variables are cleared after each call to a Resource Manager routine. <P>
 You can use two global constants to set these variables in tandem. Set the system global variable <CODE>RomMapInsert</CODE> to the global constant <CODE>mapTrue</CODE> to insert the ROM resource map with <CODE>SetResLoad(TRUE)</CODE>. Set the system global variable <CODE>RomMapInsert</CODE> to the global constant <CODE>mapFalse</CODE> to insert the ROM resource map with <CODE>SetResLoad(FALSE)</CODE>.<P>
<A NAME=HEADING47-16></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>resFNotFound<TD>-193<TD>Resource file not found</TABLE>
</H5>
<A NAME=HEADING47-17></A>
<H5>SEE ALSO</H5>
 To check for errors, call the <CODE>ResError</CODE> function as described on <A HREF=MoreToolbox-35.html#MARKER-9-220>page 1-47</A>.<P>
 For an example of the use of the <CODE>UseResFile</CODE> procedure, see <A HREF=MoreToolbox-20.html#MARKER-9-163>Listing 1-8 on page 1-23</A>.<P>
 For descriptions of the <CODE>FSpOpenResFile</CODE>, <CODE>HOpenResFile</CODE>, and <CODE>OpenResFile</CODE> functions, see <A HREF=MoreToolbox-40.html#MARKER-9-242>page 1-54</A> through <A HREF=MoreToolbox-44.html#MARKER-9-262>page 1-62</A>. For a description of the <CODE>SetResLoad</CODE> procedure, see <A HREF=MoreToolbox-55.html#MARKER-9-305>page 1-74</A>. <A NAME=MARKER-11-231></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-46.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-48.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
