<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Cocoa Scripting Guide: Object Specifiers</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Object Specifiers"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40002164-CH3" title="Object Specifiers"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../Scripting-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000569" target="_top">Scripting &amp; Automation</a> &gt; <a href="../SApps_intro/SAppsIntro.html#//apple_ref/doc/uid/TP40001982-BCICHGIE">Cocoa Scripting Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../SApps_get_set/SAppsGetSet.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../SApps_script_cmds/SAppsScriptCmds.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40002164-CH3-SW1" title="Object Specifiers"></a><h1>Object Specifiers</h1><p><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_334"></a>An<a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_335"></a> <strong>object specifier</strong> locates a scriptable object within an application’s containment hierarchy. Cocoa scripting makes use of object specifiers to find objects in your application while executing a script command and to return information requested by a script. This chapter describes how Cocoa scripting uses object specifiers and how your application provides object specifiers for its scriptable objects. </p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="SAppsObjectSpecifiers.html#//apple_ref/doc/uid/TP40002164-CH3-SW10">Overview of Object Specifiers</a>
				
			<br/>
			
        
			
			
				<a href="SAppsObjectSpecifiers.html#//apple_ref/doc/uid/TP40002164-CH3-SW4">Cocoa Object Specifier Classes</a>
				
			<br/>
			
        
			
			
				<a href="SAppsObjectSpecifiers.html#//apple_ref/doc/uid/TP40002164-CH3-SW17">Implementing the Object Specifier Method</a>
				
			<br/>
			
        
			
			
				<a href="SAppsObjectSpecifiers.html#//apple_ref/doc/uid/TP40002164-CH3-SW6">Implementing A Method for Evaluating Object Specifiers</a>
				
			<br/>
			
        
			
			
				<a href="SAppsObjectSpecifiers.html#//apple_ref/doc/uid/TP40002164-CH3-SW15">Implicitly Specified Subcontainers</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40002164-CH3-SW10" title="Overview of Object Specifiers"></a><h2>Overview of Object Specifiers</h2><p><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_336"></a>An AppleScript script contains statements that manipulate the objects in an application's AppleScript object model. The part of a script statement that identifies an object, such as <code>fourth word</code>, is called a <strong>reference</strong>. A reference rarely occurs in isolation. Usually a script statement consists of a series of references, preceded by a command and typically connected to each other by <code>in</code> or <code>of</code>, such as <code>get the fourth word in the third paragraph of document "Quarterly Report"</code>.</p><p>An Apple event encapsulates the operation specified by a script statement and delivers it to the application. For Apple events that correspond to commands defined in the application's sdef file, Cocoa scripting converts the Apple event into a script command that contains all the information necessary to perform the operation.</p><p>To describe the objects specified by a reference, the command uses object specifiers. Where a script statement identifies an object in the AppleScript object model, an object specifier identifies the corresponding object in the application itself. When the application must return an object to the calling script, Cocoa scripting also uses an object specifier, supplied by your application, to identify the object.</p><p>There is not always a one-to-one correspondence between AppleScript objects and objects in your application's implementation. For example, a <code>character</code> object in a script does not have a corresponding <code>character</code> object in the application.</p><a name="//apple_ref/doc/uid/TP40002164-CH3-SW13" title="Object Specifiers and KVC"></a><h3>Object Specifiers and KVC</h3><p><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_337"></a>Cocoa scripting relies on key-value coding (KVC) when evaluating object specifiers. When an application first needs to work with scriptability information, Cocoa scripting loads information from the application's sdef file into a global instance of <code>NSScriptSuiteRegistry</code>. At that time, it registers class descriptions for your scriptable classes. As a result, Cocoa and your application can obtain script class description information, including keys, about scriptable classes for use with object specifiers.</p><p>For more information, see <span class="content_text"><a href="../SApps_about_apps/SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-SW1">“Loading Scriptability Information.”</a></span></p><a name="//apple_ref/doc/uid/TP40002164-CH3-SW16" title="When to Implement an Object Specifier Method"></a><h3>When to Implement an Object Specifier Method</h3><p><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_338"></a>Any class in your application that is part of the containment hierarchy for your scriptability support will most likely require an object specifier method. When a script statement targets your application, the application may need to return a reply. For example, the result of a <code>get</code> command is often an object or a list of objects. When Cocoa returns these objects in the reply Apple event, it does not return pointers to Objective-C objects, it returns object specifiers that locate scriptable objects within the containment hierarchy. As part of building these specifiers, Cocoa calls on your scriptable objects to supply specifiers for themselves.</p><p>You provide an object specifier for a scriptable class by implementing the <code>objectSpecifier</code> method. That method is defined in <code><a href="../../../Reference/Foundation/Protocols/NSScriptObjectSpecifiers_Protocol/Reference/Reference.html#//apple_ref/occ/cat/NSScriptObjectSpecifiers" target="_top">NSScriptObjectSpecifiers</a></code> (note the trailing "s"), a category on <code><a href="../../../Reference/Foundation/Classes/NSObject_Class/Reference/Reference.html#//apple_ref/occ/cl/NSObject" target="_top">NSObject</a></code> that implements a version that just returns <code>nil</code>.</p><a name="//apple_ref/doc/uid/TP40002164-CH3-SW7" title="About Object Specifier Classes"></a><h3>About Object Specifier Classes</h3><p><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_339"></a>An <code>objectSpecifier</code> method returns an instance of one of the classes listed in <span class="content_text"><a href="SAppsObjectSpecifiers.html#//apple_ref/doc/uid/TP40002164-CH3-SW2">Table 6-1</a></span>, which are subclasses of <code>NSScriptObjectSpecifier</code>. Classes such as <code>NSNameSpecifier</code> and <code>NSUniqueIDSpecifier</code> represent the standard AppleScript reference forms, so you shouldn't need to subclass them. You pick the best version for the object you need to specify—see Technical Note TN2106, "<span class="content_text"><a href="http://developer.apple.com/technotes/tn2002/tn2106.html" target="_top">Scripting Interface Guidelines,</a></span>" for guidance. For example, if the object has a unique name or unique ID, use the corresponding specifier type. For an unnamed object with no ID, such as a rectangle or a paragraph of text, you may want to return an index specifier.</p><p>Most subclasses of <code>NSScriptObjectSpecifier</code> have a specific initializer that you should use.</p><p>Most initializer methods for an object specifier class include the following parameters:</p><ul class="spaceabove"><li class="li"><p><code>(NSScriptClassDescription *)classDescription</code></p><p>Here you supply a class description for the container class of the specified object. You must always supply a class description for a specifier.</p><p>If you already have an object specifier for a container, you can obtain a class description for that container object using the <code>NSScriptObjectSpecifier</code> method <code>keyClassDescription</code>, as shown in <span class="content_text"><a href="SAppsObjectSpecifiers.html#//apple_ref/doc/uid/TP40002164-CH3-CJBDAGIE">Listing 6-1</a></span>.</p><p>When you can get the class of a container object (for example, by invoking <code>[NSApp class]</code>), you can use the <code>classDescriptionForClass</code> method to determine the container description, as shown in <span class="content_text"><a href="SAppsObjectSpecifiers.html#//apple_ref/doc/uid/TP40002164-CH3-SW8">Listing 6-2</a></span>. If you have an instance of the container’s class, you can instead use the <code>NSObject</code> instance method <code>classDescription</code> to obtain a container description.</p></li><li class="li"><p><code>(NSScriptObjectSpecifier *)specifier</code></p><p>Here you supply an object specifier for the parent container of the specified object. You typically obtain it by invoking the <code>objectSpecifier</code> method of the containing object.</p><p>An object that has no container specifier is known as the <a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_340"></a><strong>top-level specifier</strong>. In most cases, the top-level specifier is the application itself. You can specify the top-level specifier by passing <code>nil</code> for this parameter. (That is the only time you can pass <code>nil</code> for a container specifier, and even then you must specify a container class description.)</p></li><li class="li"><p><code>(NSString *)key</code></p><p>Here you supply a key that tells the parent container how to find the specified object. The key you pass is based on information supplied in your sdef file. For example, Sketch defines the <code>"graphics"</code> key to identify the graphics array in a Sketch document. (Sketch actually defines the singular <code>"graphic"</code> as an element of the <code>document</code> class, but Cocoa scripting applies its default rules, described in <span class="content_text"><a href="../SApps_implement/SAppsImplement.html#//apple_ref/doc/uid/20000037-SW1">“Provide Keys for Key-Value Coding,”</a></span> to convert this key to the string <code>"graphics"</code>.)</p></li></ul><p>For an annotated example of an <code>objectSpecifier</code> method, see <span class="content_text"><a href="SAppsObjectSpecifiers.html#//apple_ref/doc/uid/TP40002164-CH3-1090231">“An Object Specifier Method for a Rectangle in Sketch.”</a></span><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_341"></a></p><a name="//apple_ref/doc/uid/TP40002164-CH3-SW14" title="A Closer Look at an Object Specifier"></a><h3>A Closer Look at an Object Specifier</h3><p><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_342"></a>Consider the object model and containment hierarchy diagram for the Sketch sample application, shown in <span class="content_text">Figure 6-1</span>. The left side of this illustration shows scriptable Sketch objects, the right side the corresponding application containment hierarchy. For a script statement that identifies a <code>rectangle</code> object on the left, Cocoa scripting supplies an object specifier that locates the rectangle and its containing document within the containment hierarchy on the right.</p><br/><div><a name="//apple_ref/doc/uid/TP40002164-CH3-SW3" title="Figure 6-1Sketch object model and containment hierarchy revisited"></a><p><strong>Figure 6-1&nbsp;&nbsp;</strong>Sketch object model and containment hierarchy revisited</p><img src = "../Art/contaiment_hierarchy.gif" alt = "Sketch containment hierarchy revisited" width="434" height="243"></div><br/><p>Each object specifier contains a reference to its containing object, which allows object specifiers to represent objects that can be deeply nested within an object hierarchy. The outermost container, represented by a nil object specifier, is usually the <code>application</code> object, although it can be an object specifier involved in a <code>whose</code> clause (<code>NSWhoseSpecifier</code>) or the container for a range evaluation.</p><p><span class="content_text">Figure 6-2</span> shows the nested object specifiers for the statement <code>first rectangle in document "SketchDocOne"</code>:<a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_343"></a></p><br/><div><a name="//apple_ref/doc/uid/TP40002164-CH3-SW5" title="Figure 6-2Nested object specifiers for a Sketch rectangle"></a><p><strong>Figure 6-2&nbsp;&nbsp;</strong>Nested object specifiers for a Sketch rectangle</p><img src = "../Art/object_specifier.gif" alt = "Object specifiers that identify the first rectangle" width="490" height="194"></div><br/><p>Here is how to interpret the information in this figure:</p><ol class="ol"><li class="li"><p>An index specifier specifies the first rectangle, which is an object of class <code>SKTRectangle</code>. The specifier has these components:</p><ul class="ul"><li class="li"><p>The index for the specified object, which in this example has the value <code>0</code>.</p><p>This is the zero-based index of the specified rectangle in its containing array. Because Sketch's graphics arrays can contain other kinds of graphics, the index for the first rectangle won't always have the value <code>0</code>—for example, if preceded by four circle graphics, the index would have the value <code>4</code>.</p></li><li class="li"><p>A key that specifies the collection for the specified object, which in this example has the value <code>"graphics"</code>.</p><p>The graphics array is the collection for the indexed object. The key matches information provided by your sdef and made available in the running application as described in <span class="content_text"><a href="SAppsObjectSpecifiers.html#//apple_ref/doc/uid/TP40002164-CH3-SW13">“Object Specifiers and KVC.”</a></span></p></li><li class="li"><p>A container reference  that specifies the parent for this object specifier. In this example the container is the object specifier for the document <code>"SketchDocOne"</code>.</p></li></ul></li><li class="li"><p>A name specifier specifies the document containing the first rectangle, which is an object of class <code>SKTDrawDocument</code>. The specifier has these components:</p><ul class="ul"><li class="li"><p>The name for the specified object, which in this example has the value <code>"SketchDocOne"</code>.</p></li><li class="li"><p>A key that specifies the collection for the specified object, which in this example has the value <code>"orderedDocuments"</code>.</p><p>The application's ordered array of documents is the collection for the named document, though in this case, the order is unimportant.</p></li><li class="li"><p>A container reference  that specifies the parent for this object specifier. In this example, the reference is <code>nil</code>, specifying that the array of documents is contained by the <code>application</code> object.</p></li></ul><p>A script statement, and thus an object specifier, can specify objects that don't currently exist in the application, causing an error condition when the script is executed. For example, the specified document may not exist, or it may not contain the specified graphic. Code within a command class should check for and be prepared to handle common error conditions. (Validation is not considered appropriate for KVC getter and setter methods.)<a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_344"></a></p></li></ol><a name="//apple_ref/doc/uid/TP40002164-CH3-SW9" title="Evaluation of Nested Specifiers"></a><h3>Evaluation of Nested Specifiers</h3><p><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_345"></a>When Cocoa scripting prepares a script command for a script that contains a reference, it converts the reference into a nested series of object specifiers, such as the ones shown in <span class="content_text"><a href="SAppsObjectSpecifiers.html#//apple_ref/doc/uid/TP40002164-CH3-SW5">Figure 6-2</a></span>. It packages these <a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_346"></a>nested object specifiers as a receiver of the command (or in some cases as an argument of the command). When the command is executed, the application evaluates the object specifiers in its own context to discover the specified objects.</p><p>Evaluation starts with the top-level specifier and proceeds down the chain of object specifiers, evaluating and resolving each until the identity of the final, nested child object is determined. This object is a receiver (or receivers) of the command or one of the command’s arguments. Key-value coding is used as the standard mechanism for evaluation. An object specifier queries its evaluated container for the value of the key associated with the object specifier.</p><p>Evaluation of object specifiers is described in more detail in <span class="content_text"><a href="../SApps_script_cmds/SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW16">“Script Commands and Object Specifiers.”</a></span><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_347"></a></p><a name="//apple_ref/doc/uid/TP40002164-CH3-SW4" title="Cocoa Object Specifier Classes"></a><h2>Cocoa Object Specifier Classes</h2><p><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_348"></a>AppleScript recognizes many types of references. For the standard reference forms, Cocoa defines subclasses of the abstract class <code><a href="../../../Reference/Foundation/Classes/NSScriptObjectSpecifier_Class/Reference/Reference.html#//apple_ref/occ/cl/NSScriptObjectSpecifier" target="_top">NSScriptObjectSpecifier</a></code>. These classes are shown in <span class="content_text">Table 6-1</span>.  Each of these object specifier classes deals with identifying objects in collections (<code>NSArray</code> objects).</p><p>These classes are unusual in that they provide one of the few examples where your application routinely creates instances of scripting classes defined by Cocoa. You do that in the object specifier methods for your scriptable classes. For more information on these and related classes, see also <span class="content_text"><a href="../SApps_script_classes/SAppsScriptClasses.html#//apple_ref/doc/uid/20000034-998718">Table 9-2</a></span>.<a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_349"></a><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_350"></a></p><a name="//apple_ref/doc/uid/TP40002164-CH3-SW2" title="Table 6-1 AppleScript reference forms and corresponding object specifier classes"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/20001242-1077314" title="Table 6-1 AppleScript reference forms and corresponding object specifier classes"></a><strong>Table 6-1&nbsp;&nbsp;</strong> AppleScript reference forms and corresponding object specifier classes</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Reference forms</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Cocoa Class</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th></tr><tr><td  scope="row"><p>Arbitrary<a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_351"></a></p></td><td ><p><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_352"></a><code><a href="../../../Reference/Foundation/Classes/NSRandomSpecifier_Class/Reference/Reference.html#//apple_ref/occ/cl/NSRandomSpecifier" target="_top">NSRandomSpecifier</a></code></p></td><td ><p>Specifies an arbitrary object in a collection.</p><p>Example: <code>any word</code>, <code>some document</code></p></td></tr><tr><td  scope="row"><p>Filter<a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_353"></a></p></td><td ><p><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_354"></a><code><a href="../../../Reference/Foundation/Classes/NSWhoseSpecifier_Class/Reference/Reference.html#//apple_ref/occ/cl/NSWhoseSpecifier" target="_top">NSWhoseSpecifier</a></code></p></td><td ><p>Specifies every object in a particular container that matches specified conditions defined by a Boolean expression.</p><p>Example: <code>words whose color is blue</code> or <code>document whose name is "Letter to Santa Claus"</code></p></td></tr><tr><td  scope="row"><p>ID<a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_355"></a></p></td><td ><p><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_356"></a><code><a href="../../../Reference/Foundation/Classes/NSUniqueIDSpecifier_Class/Reference/Reference.html#//apple_ref/occ/cl/NSUniqueIDSpecifier" target="_top">NSUniqueIDSpecifier</a></code></p></td><td ><p>Specifies an object in a collection by unique ID.</p><p>Example: <code>window id 739</code></p></td></tr><tr><td  scope="row"><p>Index<a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_357"></a></p></td><td ><p><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_358"></a><code><a href="../../../Reference/Foundation/Classes/NSIndexSpecifier_Class/Reference/Reference.html#//apple_ref/occ/cl/NSIndexSpecifier" target="_top">NSIndexSpecifier</a></code></p></td><td ><p>Specifies an object in a collection by index.</p><p>Examples: <code>word 5</code>, <code>front document</code></p></td></tr><tr><td  scope="row"><p>Middle<a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_359"></a></p></td><td ><p><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_360"></a><code><a href="../../../Reference/Foundation/Classes/NSMiddleSpecifier_Class/Reference/Reference.html#//apple_ref/occ/cl/NSMiddleSpecifier" target="_top">NSMiddleSpecifier</a></code></p></td><td ><p>Specifies the middle object in a collection.</p><p>Example: <code>middle word of paragraph 2</code></p></td></tr><tr><td  scope="row"><p>Name<a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_361"></a></p></td><td ><p><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_362"></a><code><a href="../../../Reference/Foundation/Classes/NSNameSpecifier_Class/Reference/Reference.html#//apple_ref/occ/cl/NSNameSpecifier" target="_top">NSNameSpecifier</a></code></p></td><td ><p>Specifies an object in a collection by name. See class documentation for evaluation mechanism.</p><p>Example: <code>window named "Report"</code></p></td></tr><tr><td  scope="row"><p>Property,</p><p>Every<a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_363"></a><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_364"></a></p></td><td ><p><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_365"></a><code><a href="../../../Reference/Foundation/Classes/NSPropertySpecifier_Class/Reference/Reference.html#//apple_ref/occ/cl/NSPropertySpecifier" target="_top">NSPropertySpecifier</a></code></p></td><td ><p>Specifies an attribute (property) or relationship of an object.</p><p>Example: <code>color</code> (Property), <code>every graphic of the front document</code> (Every)</p></td></tr><tr><td  scope="row"><p>Range<a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_366"></a></p></td><td ><p><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_367"></a><code><a href="../../../Reference/Foundation/Classes/NSRangeSpecifier_Class/Reference/Reference.html#//apple_ref/occ/cl/NSRangeSpecifier" target="_top">NSRangeSpecifier</a></code></p></td><td ><p>Specifies a range of objects in a collection.</p><p>Example: <code>words 5 through 10</code></p></td></tr><tr><td  scope="row"><p>Relative<a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_368"></a></p></td><td ><p><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_369"></a><code><a href="../../../Reference/Foundation/Classes/NSRelativeSpecifier_Class/Reference/Reference.html#//apple_ref/occ/cl/NSRelativeSpecifier" target="_top">NSRelativeSpecifier</a></code></p></td><td ><p>Specifies the position of an object in relation to another object.</p><p>Example: <code>before word 5</code></p></td></tr></table></div><p>It is unlikely that you will need to subclass any of these classes, as they already cover the standard set of valid AppleScript reference forms. However, if you do need to create a subclass, you must override the primitive method <code>indicesOfObjectsByEvaluatingWithContainer:count:</code> to return indices to the elements within the container whose values are matched with the child specifier's key. In addition, you may need to declare any special instance variables and implement an initializer that invokes the designated initializer of its superclass, <code>initWithContainerClassDescription:containerSpecifier:key:</code>, and initializes these variables.</p><p>In addition to the concrete subclasses of <code>NSScriptObjectSpecifier</code> shown in <span class="content_text">Table 6-1</span>, Cocoa provides other classes that assist the object-specifier classes in evaluation. Instances of these classes help to indicate relative position and represent Boolean and logical expressions in which object specifiers are involved.</p><p>A script statement can also contain filter references, which identify objects in containers based on the conditions specified in Boolean expressions. These expressions can be linked together by <a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_370"></a>logical operators (AND, OR, NOT) and return the appropriate <code>true</code> or <code>false</code> value. Filter references begin with the words <code>whose</code> or <code>where</code>, as in <code>get words where color is blue or color is red</code> and <code>rectangles whose x position is greater than 45</code>. These references can contain phrases such as <code>is</code>, <code>is equal to</code> or <code>is greater than</code>, as well as their symbolic equivalents (such as <code>=</code> and <code>></code>).</p><p>Instances of the <code><a href="../../../Reference/Foundation/Classes/NSWhoseSpecifier_Class/Reference/Reference.html#//apple_ref/occ/cl/NSWhoseSpecifier" target="_top">NSWhoseSpecifier</a></code> class represent filter reference forms in Cocoa. These instances hold a “test” instance variable, which is an <code><a href="../../../Reference/Foundation/Classes/NSScriptWhoseTest_Class/Reference/Reference.html#//apple_ref/occ/cl/NSScriptWhoseTest" target="_top">NSScriptWhoseTest</a></code> object.</p><p>For information about these and related classes, see <span class="content_text"><a href="../SApps_script_classes/SAppsScriptClasses.html#//apple_ref/doc/uid/20000034-1069383">“Object Specifiers, Logical Tests, and Related Categories.”</a></span><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_371"></a></p><a name="//apple_ref/doc/uid/TP40002164-CH3-SW17" title="Implementing the Object Specifier Method"></a><h2>Implementing the Object Specifier Method</h2><p><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_372"></a>The following sections provide examples of how to implement the object specifier defined by <code><a href="../../../Reference/Foundation/Protocols/NSScriptObjectSpecifiers_Protocol/Reference/Reference.html#//apple_ref/occ/cat/NSScriptObjectSpecifiers" target="_top">NSScriptObjectSpecifiers</a></code>.</p><a name="//apple_ref/doc/uid/TP40002164-CH3-1090231" title="An Object Specifier Method for a Rectangle in Sketch"></a><h3>An Object Specifier Method for a Rectangle in Sketch</h3><p><span class="content_text">Listing 6-1</span> shows how the Sketch sample application (available from Apple) implements the <code>objectSpecifier</code> method for the <code>SKTGraphic</code> class.</p><a name="//apple_ref/doc/uid/TP40002164-CH3-CJBDAGIE" title="Listing 6-1An object specifier method for a rectangle"></a><p class="codesample"><a name="//apple_ref/doc/uid/20000037-1090817" title="Listing 6-1An object specifier method for a rectangle"></a><strong>Listing 6-1&nbsp;&nbsp;</strong>An object specifier method for a rectangle</p><div class="codesample"><table><tr><td scope="row"><pre>- (NSScriptObjectSpecifier *)objectSpecifier{<span></span></pre></td></tr><tr><td scope="row"><pre>    NSArray *graphics = [[self document] graphics];<span>// 1</span></pre></td></tr><tr><td scope="row"><pre>    unsigned index = [graphics indexOfObjectIdenticalTo:self];<span>// 2</span></pre></td></tr><tr><td scope="row"><pre>    if (index != NSNotFound) {<span></span></pre></td></tr><tr><td scope="row"><pre>       NSScriptObjectSpecifier *containerRef = [[self document] objectSpecifier];<span>// 3</span></pre></td></tr><tr><td scope="row"><pre>        return [[[NSIndexSpecifier allocWithZone:[self zone]]<span></span></pre></td></tr><tr><td scope="row"><pre>            initWithContainerClassDescription:[containerRef keyClassDescription]<span></span></pre></td></tr><tr><td scope="row"><pre>            containerSpecifier:containerRef key:@"graphics" index:index] autorelease];<span>// 4</span></pre></td></tr><tr><td scope="row"><pre>    } else {<span></span></pre></td></tr><tr><td scope="row"><pre>        return nil;<span>// 5</span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div>	<p>Here’s a description of how this method provides an object specifier for a graphics object. The returned specifier consists of an index specifier for the graphic in its container, and a container specifier for the document that contains the array of graphics:</p><ol class="ol"><li class="li"><p>From its document, it gets the array of graphics and determines the index of the receiving graphic, if it is contained in the array.</p></li><li class="li"><p>It gets the object specifier of the document that contains the graphic.</p><p>Sketch defines the <code>SKTDrawDocument</code> class as a subclass of <code>NSDocument</code>. The object specifier method for <code>NSDocument</code> returns an instance of <code>NSNameSpecifier</code> that identifies the document by name within the application's array of ordered documents.</p></li><li class="li"><p>It creates and initializes an index specifier (type <code>NSIndexSpecifier</code>) for the receiving graphic and returns it.</p><p>The specifier locates the graphic by index within the graphics in its document. Although an AppleScript script asks for indexed items as though they are one-based, this index specifier, which locates objects within an array that correspond to the specified items, works with zero-based values. For information about the other parameters, see <span class="content_text"><a href="SAppsObjectSpecifiers.html#//apple_ref/doc/uid/TP40002164-CH3-SW7">“About Object Specifier Classes.”</a></span><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_373"></a></p></li></ol><a name="//apple_ref/doc/uid/TP40002164-CH3-SW18" title="Specifying the Application Object as a Container"></a><h3>Specifying the Application Object as a Container</h3><p><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_374"></a>To specify the application object as the top-level container for a specifier, you can use code like the following. This snippet is part of the document class and obtains an object specifier for the document by name (rather than by index, which may become invalid if the document ordering changes):</p><a name="//apple_ref/doc/uid/TP40002164-CH3-SW8" title="Listing 6-2Specifying the application as a container"></a><p class="codesample"><strong>Listing 6-2&nbsp;&nbsp;</strong>Specifying the application as a container</p><div class="codesample"><table><tr><td scope="row"><pre>NSScriptClassDescription *containerClassDesc = (NSScriptClassDescription *)<span></span></pre></td></tr><tr><td scope="row"><pre>    [NSScriptClassDescription classDescriptionForClass:[NSApp class]];<span>// 1</span></pre></td></tr><tr><td scope="row"><pre>return [[[NSNameSpecifier alloc]<span></span></pre></td></tr><tr><td scope="row"><pre>    initWithContainerClassDescription:containerClassDesc<span></span></pre></td></tr><tr><td scope="row"><pre>    containerSpecifier:nil key:@"orderedDocuments"<span></span></pre></td></tr><tr><td scope="row"><pre>    name:[self lastComponentOfFileName]] autorelease];<span>// 2</span></pre></td></tr></table></div><p>Here’s a description of what this code snippet does:</p><ol class="ol"><li class="li"><p>The application is the container for a list of ordered documents, so this code first obtains a class description from the global application object, <code>NSApp</code>. (You never pass <code>nil</code> for the class description.)</p></li><li class="li"><p>It then creates and returns an autoreleased object specifier of type <code>NSNameSpecifier</code>, passing <code>nil</code> for the <code>containerSpecifier</code> parameter to specify the top-level container, the application. (This is the only case in which you can pass <code>nil</code> for the container.)</p><p>It invokes the <code>NSDocument</code> method <code>lastComponentOfFileName</code> to obtain the name of the document and uses it to construct a name specifier object.<a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_375"></a></p></li></ol><a name="//apple_ref/doc/uid/TP40002164-CH3-SW6" title="Implementing A Method for Evaluating Object Specifiers"></a><h2>Implementing A Method for Evaluating Object Specifiers</h2><p><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_376"></a>Container classes that want to evaluate certain object specifiers on their own should implement the <code>indicesOfObjectsByEvaluatingObjectSpecifier:</code> method defined by <code><a href="../../../Reference/Foundation/Protocols/NSScriptObjectSpecifiers_Protocol/Reference/Reference.html#//apple_ref/occ/cat/NSScriptObjectSpecifiers" target="_top">NSScriptObjectSpecifiers</a></code> (a category on <code>NSObject</code>). For example, you might choose to implement this method if you find that <code>whose</code> clause evaluation is too slow and you want to do your own evaluation to speed it up (though for most applications, performance of the default <code>whose</code> mechanism should be sufficient).</p><p>If this method returns <code>nil</code>, the object specifier method for the class does its own evaluation. If this method returns an array, the object specifier uses the <code>NSNumber</code> objects in the array as the indices of the specified objects.</p><p>Therefore, if you implement this method and when you evaluate the specifier there are no objects that match, return an empty array, not <code>nil</code>. If you find only one object, you return its index in an array. Returning an array with a single index where the index is –1 is interpreted to mean all the objects match.</p><p>The Sketch application implements this method in its document class, as shown in <span class="content_text">Listing 6-3</span>. This allows Sketch to directly handle some range and relative specifiers for graphics, so it can support script statements such as <code>graphics from circle 3 to circle 5</code>, <code>circles from graphic 1 to graphic 10</code>, or <code>circle before rectangle 3</code>.</p><a name="//apple_ref/doc/uid/TP40002164-CH3-SW11" title="Listing 6-3indicesOfObjectsByEvaluatingObjectSpecifier: method from Sketch"></a><p class="codesample"><strong>Listing 6-3&nbsp;&nbsp;</strong>indicesOfObjectsByEvaluatingObjectSpecifier: method from Sketch</p><div class="codesample"><table><tr><td scope="row"><pre>- (NSArray *)indicesOfObjectsByEvaluatingObjectSpecifier:(NSScriptObjectSpecifier *)specifier {<a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_377"></a><span></span></pre></td></tr><tr><td scope="row"><pre>    if ([specifier isKindOfClass:[NSRangeSpecifier class]]) {<span>// 1</span></pre></td></tr><tr><td scope="row"><pre>        return [self indicesOfObjectsByEvaluatingRangeSpecifier:(NSRangeSpecifier *)specifier];<span></span></pre></td></tr><tr><td scope="row"><pre>    } else if ([specifier isKindOfClass:[NSRelativeSpecifier class]]) {<span>// 2</span></pre></td></tr><tr><td scope="row"><pre>        return [self indicesOfObjectsByEvaluatingRelativeSpecifier:(NSRelativeSpecifier *)specifier];<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    return nil;<span>// 3</span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Here’s a description of how this method works:</p><ol class="ol"><li class="li"><p>If the passed specifier is a range specifier, it returns the result of invoking another Sketch method to evaluate the specifier.</p><p>The method <code>indicesOfObjectsByEvaluatingRangeSpecifier:</code> allows more flexible range specifiers to be used with the different graphic keys of a <code>SKTDrawDocument</code>.</p><p>You can examine this method in Sketch. Describing it in full is beyond the scope of this discussion.</p></li><li class="li"><p>If the passed specifier is a relative specifier, it returns the result of invoking another Sketch method to evaluate the specifier.</p><p>The method <code>indicesOfObjectsByEvaluatingRelativeSpecifier:</code> allows more flexible relative specifiers to be used.</p><p>Again, this method is available in Sketch, but is beyond the scope of this discussion.</p></li><li class="li"><p>For any other type of specifier, this method returns <code>nil</code> so that the default object specifier evaluation will take place.<a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_378"></a></p></li></ol><a name="//apple_ref/doc/uid/TP40002164-CH3-SW15" title="Implicitly Specified Subcontainers"></a><h2>Implicitly Specified Subcontainers</h2><p><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_379"></a><a name="//apple_ref/doc/uid/TP40002164-CH3-DontLinkElementID_380"></a>Cocoa Scripting provides support for implicitly specified subcontainers. An <strong>implicitly specified subcontainer</strong> is an object container that can be specified in an AppleScript script by context, rather than by an explicit reference. Without this feature, a script would have to fully specify the path to a word in, for example, a TextEdit document:</p><p><code>fourth word of text of front document</code></p><p>You can make life easier for scripters who use your application by saving them the trouble of writing full references to objects in situations where part of the reference can be safely assumed. For example, the following would be a simpler, but reasonable way to refer to the same word, since text is the obvious container of words in a document:</p><p><code>fourth word of front document</code></p><p>That is, you can allow <code>of text</code> to be implicitly specified by context, instead of explicitly specified in the script.</p><p>To support an implicitly specified subcontainer, you add a <code>contents</code> element to the <code>class</code> element for the containing class in your sdef file. The <code>contents</code> element indicates that a scripter can obtain the contents of an object of this class type without specifying the container that holds the contents.</p><p>For example, suppose your application has a document class, <code>MyTextDocument</code>, that handles text with an instance of the <code>NSTextStorage</code> class. <code>NSTextStorage</code> supports scriptability for words, paragraphs, and the other text items listed in <span class="content_text"><a href="../SApps_implement/SAppsImplement.html#//apple_ref/doc/uid/20000037-SW5">Table 3-2</a></span>.</p><p>Your application can turn the text storage instance into an implicitly specified subcontainer, so that a user won't have to specify it in a script, but can specify just the document, as in the sample shown above. To do so, you add a <code>contents</code> entry for the <code>document</code> class to support, as shown in <span class="content_text">Listing 6-4</span>. This <code>contents</code> element specifies that for a script to access the text-related contents of a <code>document</code> object, it can just specify the <code>document</code> object, without having to specify a container within the object.</p><p>The <code>MyTextDocument</code> class would implement accessors that match the Cocoa key defined in the sdef: that is, <code>contents</code> and <code>setContents:</code>. For an idea of what these accessors might look like, see the similarly named accessors for the text area class (<code>SKTTextArea</code>) in the Sketch application.</p><a name="//apple_ref/doc/uid/TP40002164-CH3-SW12" title="Listing 6-4Class definition for text document, containing a contents element"></a><p class="codesample"><strong>Listing 6-4&nbsp;&nbsp;</strong>Class definition for text document, containing a contents element</p><div class="codesample"><table><tr><td scope="row"><pre>        &lt;class name="document" code="docu"<span></span></pre></td></tr><tr><td scope="row"><pre>                description="A text document."><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;cocoa class="MyTextDocument"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;contents name="text contents" code="TeCo" type="rich text"<span></span></pre></td></tr><tr><td scope="row"><pre>                description="The text of the document."><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;cocoa key="contents"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;/contents><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;/class><span></span></pre></td></tr></table></div><p>When you supply a <code>contents</code> entry, an appropriate <code>NSPropertySpecifier</code> will be inserted into the object specifier containment chain when a reference using that container class would otherwise be invalid.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40002164-CH3-SW19" title="Note"></a><p><strong>Note:</strong>&nbsp;For applications that supply scriptability information through script suite and script terminology files, implicit subcontainers are supported by a <code>DefaultSubcontainerAttribute</code> entry in the <code>class</code> dictionary. The value of the entry must be the key of one of the entries in the <code>Attributes</code> or <code>ToOneRelationships</code> dictionary of the class. For example, the TextEdit application’s <code>TextEdit.scriptSuite</code> file includes an entry in its document dictionary to support implicitly specified text storage. The following is an excerpt from that file:</p><div class="codesample"><table><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre> [...]<span></span></pre></td></tr><tr><td scope="row"><pre>      "Classes" = {<span></span></pre></td></tr><tr><td scope="row"><pre>          [...]<span></span></pre></td></tr><tr><td scope="row"><pre>          "Document" = {<span></span></pre></td></tr><tr><td scope="row"><pre>              "Superclass" = "NSCoreSuite.NSDocument";<span></span></pre></td></tr><tr><td scope="row"><pre>              "AppleEventCode" = "docu";<span></span></pre></td></tr><tr><td scope="row"><pre>              "DefaultSubcontainerAttribute" = "textStorage";<span></span></pre></td></tr><tr><td scope="row"><pre>              "ToOneRelationships" = {<span></span></pre></td></tr><tr><td scope="row"><pre>                  "textStorage" = {<span></span></pre></td></tr><tr><td scope="row"><pre>                      "Type" = "NSTextStorage";<span></span></pre></td></tr><tr><td scope="row"><pre>                      "AppleEventCode" = "ctxt";<span></span></pre></td></tr><tr><td scope="row"><pre>                  };<span></span></pre></td></tr><tr><td scope="row"><pre>              };<span></span></pre></td></tr><tr><td scope="row"><pre>          };<span></span></pre></td></tr><tr><td scope="row"><pre>      };  }<span></span></pre></td></tr></table></div></div>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../SApps_get_set/SAppsGetSet.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../SApps_script_cmds/SAppsScriptCmds.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-03-11<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Conceptual/ScriptableCocoaApplications/SApps_object_specifiers/SAppsObjectSpecifiers.html%3Fid%3DTP40002164-2.4&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Conceptual/ScriptableCocoaApplications/SApps_object_specifiers/SAppsObjectSpecifiers.html%3Fid%3DTP40002164-2.4&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Conceptual/ScriptableCocoaApplications/SApps_object_specifiers/SAppsObjectSpecifiers.html%3Fid%3DTP40002164-2.4&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>