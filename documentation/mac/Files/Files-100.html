<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Disk and Volume Organization (IM: F)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING100></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Files-99.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-101.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Files-2.html"><B>Files</B></A> / <BR><DD><A HREF="Files-72.html"><B>Chapter 2 - File Manager</B></A> / <A HREF="Files-99.html"><B>Data Organization on Volumes</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING100-0></A>
<H2>Disk and Volume Organization</H2>
 <A NAME=MARKER-2-414></A>A <B>disk</B> is a physical medium capable of storing information. Examples of disks include 3.5-inch floppy disks, SCSI hard disks and CD-ROM discs, and even RAM disks. A SCSI disk may be divided into one or more partitions. A <B>partition</B> is simply part of a disk that has been allocated to a particular operating system, file system, or device driver. For example, you can partition a single SCSI disk into both Macintosh partitions and A/UX partitions. The Macintosh partitions are typically used to hold Macintosh volumes. An A/UX partition can contain an A/UX file system, but it can also be used as a paging area for virtual memory or as a storage area for autorecovery files.<A NAME=MARKER-2-415></A><A NAME=MARKER-9-34></A><A NAME=MARKER-2-417></A><P>
 The information describing the division of a SCSI disk into partitions is contained in the disk's <B>partition map,</B> which is always located in the first physical block (512 bytes) on a disk. The partition map specifies the first and last physical blocks in each partition, as well as additional information about the partition (such as its type). The exact structure of a partition map is described in the chapter "SCSI Manager" in <I><A HREF="../Devices/Devices-2.html">Inside Macintosh: Devices</A></I>.<A NAME=MARKER-2-418></A><A NAME=MARKER-2-419></A><P>
 Often the first partition on a SCSI disk, following the partition map, is the driver partition that contains the actual device driver used to communicate with the disk. (There is, however, no requirement that the driver partition be the first partition on a disk.) <A HREF=#MARKER-9-424>Figure 2-4</A> illustrates a typical organization of partitions on a disk.<P>
 A partition can contain at most one volume. A <B>volume</B> is a single disk partition that contains both file data and the file and directory information necessary to maintain the appropriate data organization or file system. For example, a volume can contain a Macintosh, ProDOS, MS-DOS, or A/UX file system structure. Notice in <A HREF=#MARKER-9-424>Figure 2-4</A> that a Macintosh volume occupies only part of the entire physical disk, and that there can be multiple partitions (both Macintosh volumes or other types of partitions) on a given disk.<A NAME=MARKER-2-420></A><P>
<DL>
<DT><B>Note</B>
<DD>The disk organization illustrated in <A HREF=#MARKER-9-424>Figure 2-4</A> does not apply to Macintosh 3.5-inch floppy disks. Because each floppy disk is one volume, there is no need for a disk partition map. Also, there is no device driver partition on a floppy disk.<EM></EM><A NAME=MARKER-9-210></A>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 The remainder of this section describes only <B>HFS volumes,</B> that is, Macintosh file systems organized using the hierarchical file system (HFS) implemented on the Macintosh Plus and later models.<A NAME=MARKER-2-57></A><A NAME=MARKER-9-211></A><P>
 Each HFS volume begins with two boot blocks. The boot blocks on the startup volume are read at system startup time and contain booting instructions and other important information such as the name of the System file and the Finder. Following the boot blocks are two additional structures, the master directory block and the volume bitmap. <P>
 The master directory block contains information about the volume, such as the date and time of the volume's creation and the number of files on the volume. The volume bitmap contains a record of which blocks in the volume are currently in use.<P>
<B>Figure 2-4  <A NAME=MARKER-9-424></A>Organization of partitions on a disk</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/FM_L-04.jpg"> <p>
 The largest portion of a volume consists of four types of information or areas:<P>
<UL>
<LI>applications and data files
<LI>the catalog file
<LI>the extents overflow file
<LI>unused space<P>
</UL>
 The general structure of an HFS volume is illustrated in <A HREF=#MARKER-9-425>Figure 2-5</A>. <P>
<B>Figure 2-5  <A NAME=MARKER-9-425></A>Organization of a volume</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/FM_L-05.jpg"> <p>
 All the areas on a volume are of fixed size and location, except for the catalog file and the extents overflow file. These two files can appear anywhere between the volume bitmap and the alternate master directory block (MDB). They can appear in any order and are not necessarily contiguous.<A NAME=MARKER-2-426></A><P>
 The information on all block-formatted volumes is organized in logical blocks and allocation blocks. Logical blocks contain a number of bytes of standard information (512 bytes on Macintosh-initialized volumes). Allocation blocks are composed of any integral number of logical blocks and are simply a means of grouping logical blocks in more convenient parcels. The allocation block size is a volume parameter whose value is set when the volume is initialized; it cannot be changed unless the volume is reinitialized.<A NAME=MARKER-2-427></A><A NAME=MARKER-2-428></A><A NAME=MARKER-2-429></A><P>
 <A NAME=MARKER-2-41></A>To promote file contiguity and avoid fragmentation, space is allocated to files in groups of allocation blocks, or clumps<B>.</B> The clump size is always a multiple of the allocation block size, and it's the minimum number of bytes to allocate each time the <CODE>Allocate</CODE> function is called or the physical end-of-file is reached during a write operation. The clump size is specified in the catalog information for a file; you can determine the clump size using the <CODE>PBGetCatInfo</CODE> function.<A NAME=MARKER-2-431></A><P>
 The rest of this section describes in detail the structure of the boot blocks, the master directory block, and the catalog and extents overflow files. It also describes the general structure of a B*-tree, because the catalog and extents overflow files are both organized as B*-trees.<A NAME=MARKER-2-432></A><A NAME=MARKER-2-433></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Files-99.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-101.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Files-3.html">&copy; Apple Computer, Inc.</A><br>2 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
