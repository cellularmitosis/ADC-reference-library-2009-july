<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Cocoa Scripting Guide: Getting and Setting Properties and Elements</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Getting and Setting Properties and Elements"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40002164-CH18" title="Getting and Setting Properties and Elements"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../Scripting-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000569" target="_top">Scripting &amp; Automation</a> &gt; <a href="../SApps_intro/SAppsIntro.html#//apple_ref/doc/uid/TP40001982-BCICHGIE">Cocoa Scripting Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../SApps_creating_sdef/SAppsCreateSdef.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../SApps_object_specifiers/SAppsObjectSpecifiers.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40002164-CH18-SW1" title="Getting and Setting Properties and Elements"></a><h1>Getting and Setting Properties and Elements</h1><p><a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_203"></a><a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_204"></a>This chapter describes how to work with Cocoa scripting to allow it to get and set the values of properties and elements in your scriptable application. It also provides examples of KVC-compliant accessor methods.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="SAppsGetSet.html#//apple_ref/doc/uid/TP40002164-CH18-SW11">Overview of Getting and Setting Values</a>
				
			<br/>
			
        
			
			
				<a href="SAppsGetSet.html#//apple_ref/doc/uid/TP40002164-CH18-SW9">Key-Value Coding and Cocoa Scripting</a>
				
			<br/>
			
        
			
			
				<a href="SAppsGetSet.html#//apple_ref/doc/uid/TP40002164-CH18-SW2">Sample KVC-Compliant Accessor Methods</a>
				
			<br/>
			
        
			
			
				<a href="SAppsGetSet.html#//apple_ref/doc/uid/TP40002164-CH18-SW3">Special Accessor Methods</a>
				
			<br/>
			
        
			
			
				<a href="SAppsGetSet.html#//apple_ref/doc/uid/TP40002164-CH18-SW21">Support for the Properties Property</a>
				
			<br/>
			
        
			
			
				<a href="SAppsGetSet.html#//apple_ref/doc/uid/TP40002164-CH18-SW5">Coercion</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40002164-CH18-SW11" title="Overview of Getting and Setting Values"></a><h2>Overview of Getting and Setting Values</h2><p>Allowing scripters to get and set values of scriptable objects is an important part of scriptability. In your sdef, you define keys for scriptable properties and elements. In your application, properties are equivalent to attribute and to-one relationships, while elements are represented by to-many relationships.</p><p>Cocoa scripting supports getting and setting values through the use of key-value coding (KVC). For your application to work with this support, you must comply with KVC conventions in naming the keys in your sdef file and the corresponding accessor methods (or instance variables) in your scriptable classes:</p><ul class="ul"><li class="li"><p>In your sdef file, you define keys for the scriptable properties and elements of your scriptable classes, as described in <span class="content_text"><a href="../SApps_implement/SAppsImplement.html#//apple_ref/doc/uid/20000037-SW1">“Provide Keys for Key-Value Coding.”</a></span> Cocoa scripting uses these keys when it invokes KVC to get and set values.</p></li><li class="li"><p>In your application code, accessors (or instance variables) for scriptable properties and elements must match the keys specified in your sdef file and the naming conventions described in <span class="content_text"><a href="SAppsGetSet.html#//apple_ref/doc/uid/TP40002164-CH18-SW4">“Maintain KVC Compliance.”</a></span></p></li></ul><p>In handling <code>get</code> and <code>set</code> scripting commands, Cocoa scripting takes care of the following automatically:</p><ul class="ul"><li class="li"><p>It provides the <code>NSGetCommand</code> and <code>NSSetCommand</code> classes and automatically instantiates the appropriate object when your application receives a <code>get</code> or <code>set</code> Apple event. You rarely need to subclass these classes.</p></li><li class="li"><p>It automatically invokes key-value coding (KVC) methods to get or set values when a <code>get</code> or <code>set</code> command is executed—your application doesn't need to call KVC methods directly.</p></li></ul><p>For a description of how Cocoa scripting and an application work together to perform a <code>set</code> command, see <span class="content_text"><a href="../SApps_about_apps/SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-1149806">“A Real World Scripting Example.”</a></span></p><a name="//apple_ref/doc/uid/TP40002164-CH18-SW9" title="Key-Value Coding and Cocoa Scripting"></a><h2>Key-Value Coding and Cocoa Scripting</h2><p><a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_205"></a>When Cocoa scripting uses KVC to get and set values, it calls one of several KVC methods, depending on the type of relationship involved (properties or elements) and on whether the operation is a get or a set. These include two primitive instance methods of the <code><a href="../../../Reference/Foundation/Classes/NSObject_Class/Reference/Reference.html#//apple_ref/occ/cl/NSObject" target="_top">NSObject</a></code> class: <a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_206"></a><code>valueForKey:</code> and <a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_207"></a><code>setValue:forKey:</code>. These methods are used primarily in dealing with properties, though they can also handle element collections in a simple but potentially inefficient way. For more efficient handling of collections, KVC invokes <code>mutableArrayValueForKey:</code>.</p><p>These KVC methods in turn search your method list for specific methods in a specific order, as described in <em><a href="../../KeyValueCoding/index.html#//apple_ref/doc/uid/10000107i" target="_top">Key-Value Coding Programming Guide</a></em>. Templates for the methods KVC looks for are described in <span class="content_text"><a href="SAppsGetSet.html#//apple_ref/doc/uid/TP40002164-CH18-SW4">“Maintain KVC Compliance.”</a></span></p><p>Your application doesn't invoke or override KVC methods—it just names its accessor methods or instance variables so that KVC can find them.</p><a name="//apple_ref/doc/uid/TP40002164-CH18-SW4" title="Maintain KVC Compliance"></a><h3>Maintain KVC Compliance</h3><p><a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_208"></a>For Cocoa scripting to work successfully with KVC, every scriptable class in your application must be KVC-compliant for every key corresponding to its scriptable properties and elements. To ensure this, you must define keys in your sdef file as described in <span class="content_text"><a href="../SApps_implement/SAppsImplement.html#//apple_ref/doc/uid/20000037-SW1">“Provide Keys for Key-Value Coding,”</a></span> and you must adhere to the following naming conventions for your accessor methods or instance variables (where you replace &lt;key> or &lt;Key> with the key string to construct the actual method name):</p><ul class="spaceabove"><li class="li"><p>For properties (attributes and to-one relationships), you implement <code>&lt;key></code> and, if the property is not read-only,  <code>set&lt;Key>:</code> accessors.</p></li><li class="li"><p>For element classes (to-many relationships), you implement <code>&lt;key></code> and, if the element class is not read-only, <code>insertObject:in&lt;Key>AtIndex:</code> and <code>removeObjectFrom&lt;Key>AtIndex:</code> methods. For better performance, you may also need to implement <code>replaceObjectIn&lt;Key>AtIndex:withObject:</code>.</p><p>If there is no way to efficiently implement <code>&lt;key></code> (for example, if the value of the to-many relationship is not naturally stored in an instance of <code>NSArray</code>), you can instead implement <code>countOf&lt;Key></code> and <code>objectIn&lt;Key>AtIndex:</code>. KVC's <code>valueForKey:</code> and <code>mutableArrayValueForKey:</code>, which are invoked by Cocoa scripting, will return collection proxies that invoke your methods when appropriate.</p></li><li class="li"><p>To let Cocoa automatically create an array proxy to handle element collections, you can implement <a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_209"></a><code>countOf&lt;Key></code> and <a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_210"></a><code>objectIn&lt;Key>AtIndex:</code> methods.</p><p>If the to-many relationship is mutable, you should also implement <a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_211"></a><code>insertObject:in&lt;Key>AtIndex:</code> and <a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_212"></a><code>removeObjectFrom&lt;Key>AtIndex:</code> methods.</p><p>And  for better performance, you may need to implement <a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_213"></a><code>replaceObjectIn&lt;Key>AtIndex:withObject:</code>.</p><p>KVC invokes these methods regardless of the class used to model the relationship, so you can use array-based or non-array-based collections, including custom collections you have defined.  But it's up to you to implement the methods to work with your underlying data. The code should be quite straightforward; if you are working with arrays, it often requires just a call to an array method that corresponds to the accessor method.</p></li><li class="li"><p>As an alternative to implementing accessor methods, you can take advantage of KVC's direct instance variable access feature. You do this by merely giving an instance variable a name that matches a key defined in your sdef, with an optional leading underscore—for example, <code>xPosition</code> or <code>_xPosition</code>,</p><p>Instance variables corresponding to writable element classes must be of type <code>NSMutableArray</code> if you do not implement the <code>insertObject:in&lt;Key>AtIndex:</code> and <code>removeObjectFrom&lt;Key>AtIndex:</code> methods.</p></li><li class="li"><p>For element classes that can be accessed by name or ID (that is, the class has properties identified by the four character code <code>'pnam'</code> or <code>'ID  '</code>), you can optimize the evaluation of name and ID specifiers by implementing the methods <a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_214"></a><code>valueIn&lt;Key>WithName:</code> or <a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_215"></a><code>valueIn&lt;Key>WithUniqueID:</code>, respectively.</p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_13" title="Important:"></a><p><strong>Important:</strong>&nbsp;In your implementation of <code>valueIn&lt;Key>WithName:</code>, string matching should honor the current AppleScript considerations, such as <code>considering case</code> or <code>ignoring diacriticals</code>. Name data may come to your application as plain or Unicode text, so be prepared to handle either, even if you do not use full Unicode internally.</p><p>In your implementation of <code>valueIn&lt;Key>WithUniqueID:</code>, ID data should not honor the current AppleScript considerations, such as <code>considering case</code>. Treat IDs as always case-‌insensitive, or as always case-‌sensitive if case is relevant (that is, if <code>"ijkl"</code> and <code>"IJKL"</code> are both valid and different).</p><p></p></div></li></ul><p>If you follow standard Cocoa naming conventions for accessors, you're already on the way to KVC compliance:</p><ul class="spaceabove"><li class="li"><p>A “get” accessor should start with a lower case letter and have the same name as the variable it is accessing—for example, <code>xPosition</code>.</p></li><li class="li"><p>A “set” accessor should start with “set”, followed by the name of the variable, with the first letter capitalized—for example, <code>setXPosition</code>.</p></li></ul><p>For examples of KVC-compliant accessor methods based on the templates described here, see <span class="content_text"><a href="SAppsGetSet.html#//apple_ref/doc/uid/TP40002164-CH18-SW2">“Sample KVC-Compliant Accessor Methods.”</a></span><a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_216"></a></p><a name="//apple_ref/doc/uid/TP40002164-CH18-SW6" title="On Omitting KVC Accessors"></a><h3>On Omitting KVC Accessors</h3><p><a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_217"></a>The use of accessor methods supports data encapsulation, a standard coding practice. However, in cases where you are providing KVC access to your data solely to support scriptability (or Cocoa bindings), encapsulation may be less important, and you might choose to omit accessor methods altogether. If so, you need only maintain KVC compliance in naming your instance variables to match the keys in your sdef.</p><p>You might also choose to use direct instance variable access as a convenience during prototyping or feasibility testing, then add accessor methods later in the development cycle.</p><a name="//apple_ref/doc/uid/TP40002164-CH18-SW7" title="Performance Considerations With KVC"></a><h3>Performance Considerations With KVC</h3><p><a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_218"></a><a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_219"></a>KVC access to simple values is fast enough that it should not be a performance bottleneck. In general, KVC is smart enough to search for the most efficient methods your classes provide that match the KVC naming conventions. For example, for to-many relationships, KVC looks first for collection mutation methods, then for setter methods; if neither is available, it tries for direct instance variable access.</p><p><span class="content_text"><a href="SAppsGetSet.html#//apple_ref/doc/uid/TP40002164-CH18-SW4">“Maintain KVC Compliance”</a></span> describes the collection methods you should implement for best performance (<a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_220"></a><code>insertObject:in&lt;Key>AtIndex:</code> and <a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_221"></a><code>removeObjectFrom&lt;Key>AtIndex:</code>).  </p><p>You can instead merely implement a setter method (as in, <code>set&lt;Key>:</code>) and KVC will invoke it, but be aware of what KVC, as used by Cocoa Scripting, must do in that case: for an insertion or removal, it must get the value array, make a mutable copy of it, mutate the copy, and then set it again. This can be slow.</p><a name="//apple_ref/doc/uid/TP40002164-CH18-SW10" title="Interaction With Key-Value Observing"></a><h3>Interaction With Key-Value Observing</h3><p><a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_222"></a>Because Cocoa scripting invokes <a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_223"></a><code>setValue:forKey:</code> instead of <a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_224"></a><code>takeValue:forKey:</code> (a deprecated KVC method), changes to model objects made by AppleScript scripts are observable using automatic key-value observing. However, if the container in question overrides <code>takeValue:forKey:</code>, Cocoa scripting invokes <code>takeValue:forKey:</code> for backward binary compatibility.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40002164-CH18-SW12" title="Note"></a><p><strong>Note:</strong>&nbsp;In Mac OS version 10.3, Cocoa scripting did not use key-value coding methods introduced in that version of the OS, such as <code>setValue:forKey:</code> and <a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_225"></a><code>mutableArrayValueForKey:</code>, so automatic key-value observing (KVO) was not supported for model object changes caused by scripts.</p></div><p>Cocoa scripting does not depend on KVO. However, if your application uses Cocoa bindings, you should follow the guidelines described in <em><a href="../../KeyValueObserving/index.html#//apple_ref/doc/uid/10000177i" target="_top">Key-Value Observing Programming Guide</a></em>. For related information in this document, see <span class="content_text"><a href="../SApps_about_apps/SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-SW13">“Interaction With Cocoa Bindings and Core Data.”</a></span></p><a name="//apple_ref/doc/uid/TP40002164-CH18-SW13" title="KVC Conversion of Scalar and Structure Values"></a><h3>KVC Conversion of Scalar and Structure Values</h3><p><a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_226"></a><a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_227"></a>The default implementations of the KVC methods <a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_228"></a><code>valueForKey:</code> and <a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_229"></a><code>setValue:forKey:</code> provide support for automatic object wrapping of scalar data types such as <code>BOOL</code>, <code>char</code>, <code>double</code>, <code>float</code>, <code>int</code>, and structures such as <code>NSPoint</code>, <code>NSRange</code>, and <code>NSRect</code>. When Cocoa scripting invokes <code>valueForKey:</code> to get a value, KVC automatically converts the value to an <code>NSNumber</code> object (for scalars) or <code>NSValue</code> object (for structures) if necessary.</p><p>Similarly, <code>setValue:forKey:</code> determines the data type required by the appropriate accessor or instance variable for the specified key. If the data type is not an object, then the value is extracted from the passed object using the appropriate <code>NSNumber</code> or<code>NSValue</code> method.</p><p>For more information, including a table of the supported types, see <span class="content_text"><a href="../../KeyValueCoding/Concepts/DataTypes.html#//apple_ref/doc/uid/20002171" target="_top">Scalar and Structure Support</a></span> in <em><a href="../../KeyValueCoding/index.html#//apple_ref/doc/uid/10000107i" target="_top">Key-Value Coding Programming Guide</a></em>.</p><a name="//apple_ref/doc/uid/TP40002164-CH18-SW14" title="Scripting Additions to KVC"></a><h3>Scripting Additions to KVC</h3><p><a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_230"></a>Cocoa defines the category <code><a href="../../../Reference/Foundation/Protocols/NSScriptKeyValueCoding_Protocol/Reference/Reference.html#//apple_ref/occ/cat/NSScriptKeyValueCoding" target="_top">NSScriptKeyValueCoding</a></code> to provide scripting-related additions to the key-value coding methods implemented in <code>NSObject</code>. The methods in this category on <code>NSObject</code> provide additional capabilities for working with key-value coding, including getting and setting key values by index in a collection and coercing (or converting) a key value. Additional methods allow the implementer of a scriptable container class to provide fast access to elements that are referenced by name and unique ID.<a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_231"></a></p><a name="//apple_ref/doc/uid/TP40002164-CH18-SW2" title="Sample KVC-Compliant Accessor Methods"></a><h2>Sample KVC-Compliant Accessor Methods</h2><p><a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_232"></a>Suppose you have a <code>DrawingCanvas</code> class that you want to make scriptable. In a simple scenario, you want scripts to be able to access the properties of graphical shapes associated with a canvas object, and you also want scripts to be able to access a boolean value indicating whether the canvas has been modified. Assume that scripters can get and set properties of a shape, but can only read the current value of the modified property.</p><p>First, you specify the keys <code>"shape"</code> and <code>"modified"</code> in the scriptability information for your application. To do this, you could define the following entries in the <code>class</code> definition for the <code>drawing canvas</code> scriptable object class in your sdef file:</p><div class="codesample"><table><tr><td scope="row"><pre>    &lt;property name="modified" code="iMod" type="boolean" access="ro"<span></span></pre></td></tr><tr><td scope="row"><pre>        description="Has the canvas been modified since the last save?"><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/property><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;element type="shape"><span></span></pre></td></tr></table></div><p></p><p>The two keys also become instance variables of the <code>DrawingCanvas</code> class. Remember that Cocoa scripting pluralizes the key for an element, as shown in the declared array variable, <code>shapes</code>. However, the instance variable names don't have to match the keys if you provide complete KVC-compliant method coverage.</p><div class="codesample"><table><tr><td scope="row"><pre>@interface DrawingCanvas: NSObject &lt;NSCoding> {<span></span></pre></td></tr><tr><td scope="row"><pre>    NSMutableArray *shapes; // An array of shape objects<span></span></pre></td></tr><tr><td scope="row"><pre>    BOOL modified; // Whether the canvas has been modified<span></span></pre></td></tr><tr><td scope="row"><pre>    // ...<span></span></pre></td></tr></table></div><p>The following sections provide sample accessors for these properties, based on the KVC accessor method templates described in <span class="content_text"><a href="SAppsGetSet.html#//apple_ref/doc/uid/TP40002164-CH18-SW4">“Maintain KVC Compliance.”</a></span> Depending on the implementation, some examples might require additional application-dependent code that is not shown here.</p><a name="//apple_ref/doc/uid/TP40002164-CH18-SW15" title="Single-Value Access"></a><h3>Single-Value Access</h3><p><a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_233"></a>To provide scriptable access to the boolean property of the <code>DrawingCanvas</code> class, based on the key <code>"modified"</code>, you can define a KVC-compliant getter method like the following:</p><a name="//apple_ref/doc/uid/TP40002164-CH18-SW16" title="Listing 5-1Boolean property getter"></a><p class="codesample"><strong>Listing 5-1&nbsp;&nbsp;</strong>Boolean property getter</p><div class="codesample"><table><tr><td scope="row"><pre>- (BOOL)modified<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    // If necessary, obtain or update value<span></span></pre></td></tr><tr><td scope="row"><pre>    return modified;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>If the <code>modified</code> property were settable (if the property were defined as read/write, the default), you could define a KVC-compliant setter method like the following:</p><a name="//apple_ref/doc/uid/TP40002164-CH18-SW17" title="Listing 5-2Boolean property setter"></a><p class="codesample"><strong>Listing 5-2&nbsp;&nbsp;</strong>Boolean property setter</p><div class="codesample"><table><tr><td scope="row"><pre>- (void)setModified:(BOOL)flag<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    modified = flag;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>As noted in <span class="content_text"><a href="SAppsGetSet.html#//apple_ref/doc/uid/TP40002164-CH18-SW6">“On Omitting KVC Accessors,”</a></span>  in cases where you are providing KVC access to your data solely to support scriptability, you might choose to omit accessor methods. If so, you need only name your instance variables to match the keys in your sdef—in this case, <code>modified</code> or <code>_modified</code>.</p><a name="//apple_ref/doc/uid/TP40002164-CH18-SW18" title="Collection Value Access"></a><h3>Collection Value Access</h3><p><a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_234"></a>For simple scriptable access to a to-many relationship, you can implement accessor methods like those in <span class="content_text">Listing 5-3</span>. However, the setter method may not be efficient, for reasons described in <span class="content_text"><a href="SAppsGetSet.html#//apple_ref/doc/uid/TP40002164-CH18-SW7">“Performance Considerations With KVC.”</a></span></p><a name="//apple_ref/doc/uid/TP40002164-CH18-SW8" title="Listing 5-3Simple array element accessors"></a><p class="codesample"><strong>Listing 5-3&nbsp;&nbsp;</strong>Simple array element accessors</p><div class="codesample"><table><tr><td scope="row"><pre>- (NSArray *)shapes<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    return [[shapes retain]autorelease];<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre>- (void)setShapes:(NSArray *)newShapes<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    if (shapes != newShapes)<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>        [shapes release];<span></span></pre></td></tr><tr><td scope="row"><pre>        shapes = [newShapes copy];<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>You can support KVC access for to-many relationships by implementing indexed accessor methods. These accessors work whether or not the related objects are stored in an array—Cocoa automatically creates an array proxy for you if needed.</p><p>For best performance, you should implement the two KVC-compliant methods shown in the next listing, instead of the <code>setShapes:</code> method:</p><a name="//apple_ref/doc/uid/TP40002164-CH18-SW19" title="Listing 5-4Array element insert/delete accessors (by index)"></a><p class="codesample"><strong>Listing 5-4&nbsp;&nbsp;</strong>Array element insert/delete accessors (by index)</p><div class="codesample"><table><tr><td scope="row"><pre>-(void)insertObject:(id)anObject inShapesAtIndex:(unsigned)index<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    [shapes insertObject:anObject atIndex:index];<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>-(void)removeObjectFromShapesAtIndex:(unsigned)index<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    [shapes removeObjectAtIndex:index];<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>And finally, to provide even more efficient mutation of the array, you can also implement a KVC-compliant method like the following:</p><a name="//apple_ref/doc/uid/TP40002164-CH18-SW20" title="Listing 5-5Array element replacement accessor (by index)"></a><p class="codesample"><strong>Listing 5-5&nbsp;&nbsp;</strong>Array element replacement accessor (by index)</p><div class="codesample"><table><tr><td scope="row"><pre>-(void)replaceObjectInShapesAtIndex:(unsigned)index withObject:(id)anObject<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    // possible implementation-specific code<span></span></pre></td></tr><tr><td scope="row"><pre>    [shapes replaceObjectAtIndex:index withObject:anObject];<a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_235"></a><span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40002164-CH18-SW3" title="Special Accessor Methods"></a><h2>Special Accessor Methods</h2><p><a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_236"></a>Sometimes an accessor method must do something special to support scripting. For example, consider the documents managed by a document-based application. When a script asks for an application’s documents, the application could invoke the <code>documents</code> method of the <code>NSDocumentController</code> object to obtain all currently opened documents, ordered by creation.</p><p>However, this is not what is expected by the scripter. AppleScript has the notion of a <code>first document</code> and a <code>last document</code> (as well as <code>front document</code>, <code>document 1</code>, and related notations), and this implies an ordering of documents visible on the screen. The <code>NSApplication</code> class therefore implements the <code>orderedDocuments</code> method, which, in response to a request for its documents, returns an array of document objects, where the position of a document in the array is based on the front to back ordering of its associated (on-screen) window.</p><p>Sometimes an application's object model provides scripting access to objects at a level of granularity that would be impractical to implement with individual objects. For example, an AppleScript script can ask for the <code>characters</code> of a text document, but it would be quite expensive for an application to represent each character as an object. The <code>NSTextStorage</code> class handles this case with a special accessor method, <code>characters</code> </p><a name="//apple_ref/doc/uid/TP40002164-CH18-SW21" title="Support for the Properties Property"></a><h2>Support for the Properties Property</h2><p><a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_237"></a>It is common for good scriptable applications to make the  complete set of properties for each scriptable object available in the form of a single record that is the value of the <code>properties</code> property. A category on <code>NSObject</code> (defined in the Foundation file <code>NSObjectScripting.h</code>) declares the following public KVC accessor methods for this property:</p><div class="codesample"><table><tr><td scope="row"><pre>- (NSDictionary *)scriptingProperties;<span></span></pre></td></tr><tr><td scope="row"><pre>- (void)setScriptingProperties:(NSDictionary *)properties;<span></span></pre></td></tr></table></div><p>For all scriptable classes that inherit from <code>item</code>, Cocoa scripting provides automatic scriptability support for the <code>properties</code> property. So if your scriptable classes that descend from <code>NSObject</code> provide KVC-compliant accessors for their individual scriptable properties and elements, you will automatically have support for the <code>properties</code> property.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40002164-CH18-SW22" title="Note"></a><p><strong>Note:</strong>&nbsp;For applications that supply scriptability information through script suite and script terminology files, the <code>AbstractObject</code> scriptable class (which corresponds to <code>NSObject</code>) specifies a base class that scriptable classes can inherit from. Cocoa Scripting uses this class, declared in the Foundation files <code>NSCoreSuite.scriptSuite</code> and <code>NSCoreSuite.scriptTerminology</code>, to provide support for the <code>properties</code> property.</p></div><a name="//apple_ref/doc/uid/TP40002164-CH18-SW5" title="Coercion"></a><h2>Coercion</h2><p><a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_238"></a>Coercion is the process of converting data from one type to another. AppleScript provides many default (or built-in) coercions. For example, when it executes the statement <code>set theValue to "20.05" as number</code>, AppleScript converts the string <code>"20.05"</code> to the numeric value <code>20.05</code>.</p><p>Cocoa scripting supports the types shown in <span class="content_text"><a href="../SApps_about_apps/SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-SW12">“Built-in Support for Basic AppleScript Types,”</a></span> and makes use of the default coercions as needed when it handles Apple events received by a Cocoa application. For information on the default coercions, see <span class="content_text"><a href="../../../../AppleScript/Conceptual/AppleEvents/appendix3_aepg/appendix3_aepg.html#//apple_ref/doc/uid/TP40001449-CH213" target="_top">Default Coercion Handlers</a></span> in <em><a href="../../../../AppleScript/Conceptual/AppleEvents/index.html#//apple_ref/doc/uid/TP40001449" target="_top">Apple Events Programming Guide</a></em>.<a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_239"></a><a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_240"></a><a name="//apple_ref/doc/uid/TP40002164-CH18-DontLinkElementID_241"></a></p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../SApps_creating_sdef/SAppsCreateSdef.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../SApps_object_specifiers/SAppsObjectSpecifiers.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-03-11<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Conceptual/ScriptableCocoaApplications/SApps_get_set/SAppsGetSet.html%3Fid%3DTP40002164-2.4&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Conceptual/ScriptableCocoaApplications/SApps_get_set/SAppsGetSet.html%3Fid%3DTP40002164-2.4&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Conceptual/ScriptableCocoaApplications/SApps_get_set/SAppsGetSet.html%3Fid%3DTP40002164-2.4&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>