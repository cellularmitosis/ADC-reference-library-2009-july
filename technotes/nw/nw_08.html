<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note NW08: Opening AppleTalk</title> <meta name="keywords" content=""><meta name="Description" content="Technical Note NW08: ">                                       <meta name="categories" content="Networking"><meta name="week-posted" content="Jan 30, 1989 - Feb 3, 1989"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF" TEXT="#000000"><a name="//apple_ref/doc/uid/DTS10002550" title="Opening AppleTalk"></a><a name="top"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxNetworking-date.html">Networking</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/Networking/idxHardwareDrivers-date.html" target="_blank">Networking > Hardware & Drivers</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note NW08</div>
<div id="pageheadsub">Opening AppleTalk</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->					<p id="menutext">					<a href="#Introduction">Introduction</a><BR><BR>					 <a href="#References">References</a><BR><BR><a href="#Downloads">Downloadables</a></p>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">This Technical Note describes the most effective, safe, and compatible way toopen the AppleTalk drivers, .MPP and .ATP.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Feb 01 1989]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR><!-- begin_content --><a name="Introduction"></a><h2>Introduction</h2><P>The process of opening the AppleTalk drivers, .MPP and .ATP, can be greatlysimplified.  The AppleTalk Manager chapters of <i>Inside Macintosh</i> describethe calls <code>MPPOpen</code> and <code>ATPLoad</code> for use by high-levellanguages.  They also describe the process of examining low-memory globals<code>SPConfig</code> and <code>PortBUse</code> before calling <code>_Open</code> forassembly language use of AppleTalk.</p><p>Starting with the 128K ROM, the .MPP driver already has all the code built infor checking the low-memory globals <code>SPConfig</code> and <code>PortBUse</code>before trying to complete the <code>_Open</code> call.  Furthermore, the .MPPdriver will automatically open the .ATP driver as part of its opening process.Therefore, since all of the required checks are made inside the driver itself,we recommend that a simple <code>_Open</code> call be made to the .MPP driver whenyou need to use AppleTalk.  In a high-level language like Pascal, this callwould look like the following:</p><p>In C:</p><P>And in assembly language:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>openAT    SUB.W    #ioQElSize,SP    ; Make space for paramblock on stack            ; since _Open is always synchronous.            ;  Using .W is slightly more efficient            ; and is safe since ioQElSize is small.    MOVE.L    SP,A0    ; Point A0 to paramblock.    LEA    mppName,A1    ; Point A1 to driver name.    MOVE.L    A1,ioFileName(A0); Put pointer to name in paramblock.    CLR.B    ioPermssn(A0)    ; Clear so won't look like OpenDeskAcc._Open    MOVE.W    ioRefNum(A0),D1    ;You might want this later. Who knows?    ADD.W    #ioQElSize,SP    ; Reclaim space on stack.    RTS        ; D0 contains result code.mppName    DC.B    4</pre>	</TD></TR></TABLE></CENTER><p>By using just the simple <code>_Open</code> call to the .MPP driver, you can ensurethat your code will be compatible with future versions of AppleTalk that mightnot make use of low-memory globals.</p><a name="References"></a><h2>References</h2><P><i>Inside Macintosh</i>, Volumes II-261, IV-229, &amp; V-507, TheAppleTalk Manager</p>        <P><A NAME=Downloads></A></P>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (32K)</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/nw_08.pdf">Download</A></P>               </TD>            </TR>                     </TABLE>         <BR>         <P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/nw/nw_08.html%3Fid%3DDTS10002550-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/nw/nw_08.html%3Fid%3DDTS10002550-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/nw/nw_08.html%3Fid%3DDTS10002550-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>