<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Drawing Icons in an Icon Family (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING273></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-272.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-274.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-269.html"><B>Chapter 5 - Icon Utilities</B></A> / <A HREF="MoreToolbox-272.html"><B>Using the Icon Utilities</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING273-0></A>
<H2>Drawing Icons in an Icon Family</H2>
 <A NAME=MARKER-2-223></A>You can define different versions of an icon for specific sizes and bit depths as part of a single icon family whose members share the same resource ID. If you define all your application's icons in icon families, you can use Icon Utilities routines to draw the icon using the icon family member that is best suited for the destination rectangle and the current bit depth of the display device. When your application uses Icon Utilities routines like <CODE>PlotIconSuite</CODE> or <CODE>PlotIconID</CODE> to plot icons, it doesn't have to determine which icon in the icon family is best suited for a given destination rectangle and bit depth; instead, the routines automatically display the appropriate icon.<P>
 You can also define individual icons of resource type <CODE>'ICON'</CODE>, <CODE>'cicn'</CODE>, or <CODE>'SICN'</CODE> that are not part of an icon family and use Icon Utilities routines to draw them when necessary. For information about drawing these types of icons, see the section <A HREF=MoreToolbox-274.html#MARKER-9-111>"Drawing Icons That Are Not Part of an Icon Family" beginning on page 5-13</A>.<P>
 You can use the Icon Utilities to draw icons using modes or <B>transforms</B> that alter the icon's appearance in standard ways that are analogous to Finder states for icons. For example, the Finder draws a selected icon differently than it draws one that is not selected; to do so, the Finder specifies the transform constant <CODE>ttSelected</CODE> when it calls Icon Utilities routines to draw a selected icon. If you need to apply a particular transform to an icon, some Icon Utilities routines allow you to apply transforms for both standard Finder states and Finder label colors when you draw the icon.<A NAME=MARKER-2-74></A><P>
 Many of the Icon Utilities routines can also automatically align an icon within its destination rectangle. For example, the generic document icon that appears in the Finder is taller than it is wide. Some Icon Utilities routines allow you to draw such an icon without any special alignment, align it at the left or right of the destination rectangle, or use various other alignments.<P>
 Depending on the size of the rectangle, the Icon Utilities routines may stretch or shrink the icon to fit. To draw icons without stretching them, these routines require that the destination rectangle have the exact dimensions of a standard icon: that is, depending on the icon resource type, 32 by 32 pixels, 16 by 16 pixels, or 12 by 16 pixels. If you use destination rectangles of other sizes, these routines stretch or shrink the icons to fit the rectangles.<A NAME=MARKER-2-87></A> <P>
 An icon family is a collection of icons representing a single object. Each icon in the family shares the same resource ID as other icons in the family but has its own resource type identifying the icon data it contains. The simplest way to draw an icon from an icon family is to pass the family's resource ID to the <CODE>PlotIconID</CODE> function, which draws the appropriate icon from the family for the specified destination rectangle and bit depth. The next section, <A HREF=#MARKER-9-90>"Drawing an Icon Directly From a Resource,"</A> describes how to use <CODE>PlotIconID</CODE>.<P>
 Alternatively, you can first use the <CODE>GetIconSuite</CODE> function to read the resource data for some or all icons in an icon family into memory. Given a resource ID and one or more resource types, the <CODE>GetIconSuite</CODE> function reads in resource data for each icon with the specified resource ID and resource types and collects handles to the resource data in an icon suite. An <B>icon suite</B> typically consists of one or more handles to icon resources from a single icon family that have been read into memory. The <CODE>GetIconSuite</CODE> function returns a handle for the requested icon suite; you can pass this handle to <CODE>PlotIconSuite</CODE> and other Icon Utilities routines. Like <CODE>PlotIconID</CODE>, <CODE>PlotIconSuite</CODE> draws the appropriate icon from an icon suite for the specified destination rectangle and bit depth. The section <A HREF=#MARKER-9-96>"Getting an Icon Suite and Drawing One of Its Icons" on page 5-11</A> describes how to use the <CODE>GetIconSuite</CODE> and <CODE>PlotIconSuite</CODE> routines. <A NAME=MARKER-9-229></A><P>
 An icon suite can in turn contain handles to each of the six icon resources that an icon family can contain, or it can contain handles to only a subset of the icon resources in an icon family. However, for best results, an icon suite should always include a black-and-white icon and icon mask for any icons you provide; that is, it should include a resource of type <CODE>'ICN#'</CODE> in addition to any other large icons you provide as well as a resource of type <CODE>'ics#'</CODE> in addition to any other small icons you provide. When you create an icon suite from icon family resources, the associated resource file should remain open while you use Icon Utilities routines.<P>
 Two types of handles exist in an icon suite: handles to icon data associated with a resource and handles to icon data that isn't associated with a resource. You typically use <CODE>GetIconSuite</CODE> to fill an icon suite with handles to icon resource data. You typically <BR>use <CODE>AddIconToSuite</CODE> to add to an icon suite handles to icon data. When you use <CODE>AddIconToSuite</CODE>, the handles that you add to the suite do not have to be associated with a resource fork. For example, your application might get icon data from the desktop database rather than reading it from a resource, or your application might read icon data from a resource and then detach it. In either case, you can provide a handle to the icon data and use <CODE>AddIconToSuite</CODE> to add the handle to the icon suite. <P>
 An <B>icon cache</B> is like an icon suite, except that an icon cache also contains a pointer to an application-defined <B>icon getter function</B> and a pointer to data that is associated with the icon suite. You can pass a handle to an icon cache to any of the Icon Utilities routines that accept a handle to an icon suite. An icon cache typically does not contain handles to the icon resources for all icon family members. Instead, if the icon cache does not contain an entry for a specific type of icon in an icon family, the Icon Utilities routines call your application's icon getter function to retrieve the data for that icon type. The icon getter function should return either a handle to the icon data or <CODE>NIL</CODE> to indicate that no icon data exists for the specified icon type. <A NAME=MARKER-2-77></A><P>
<A NAME=HEADING273-11></A>
<H3><A NAME=MARKER-9-90></A>Drawing an Icon Directly From a Resource</H3>
 <A NAME=MARKER-2-91></A>To draw an icon from an icon family without first creating an icon suite, use the <CODE>PlotIconID</CODE> function. <A HREF=#MARKER-9-92>Listing 5-1</A> shows an application-defined procedure that draws an icon from an icon family. Given a resource ID, the <CODE>PlotIconID</CODE> function determines which member of the icon family to draw and then draws the icon in the given rectangle with the specified transform and alignment. <P>
<B>Listing 5-1  <A NAME=MARKER-9-92></A>Drawing the icon from an icon family that is best suited to the user's display <A NAME=MARKER-2-93></A></B><P>
<PRE>
PROCEDURE MyDrawIconFromFamily (resID: Integer; destRect: Rect);
VAR
   align:         IconAlignmentType;
   transform:     IconTransformType;
   myErr:         OSErr;
BEGIN
   align := atAbsoluteCenter; {specify alignment (centered)}
   transform := ttNone;       {specify no special transforms}
   {draw the icon, using the icon type best suited for the }
   { destination rect and current bit depth of the display device}
   myErr := PlotIconID(destRect, align, transform, resID);
END;
</PRE>
 The <CODE>PlotIconID</CODE> function determines, from the size of the specified destination rectangle and the current bit depth of the display device, which icon of a given size from an icon family to draw. For example, if the coordinates of the destination rectangle are (100,100,116,116) and the display device is set to 4-bit color, the <CODE>PlotIconID</CODE> function draws the icon of type <CODE>'ics4'</CODE> if that icon is available in the icon family. <A NAME=MARKER-2-385></A><P>
 If the width or height of a destination rectangle is greater than or equal to 32, <CODE>PlotIconID</CODE> uses the 32-by-32 pixel icon with the appropriate bit depth for the display device. If the destination rectangle is less than 32 by 32 pixels and greater than 16 pixels wide or 12 pixels high, <CODE>PlotIconID</CODE> uses the 16-by-16 pixel icon with the appropriate bit depth. If the destination rectangle's height is less than or equal to 12 pixels or its width is less than or equal to 16 pixels, <CODE>PlotIconID</CODE> uses the 12-by-16 pixel icon with the appropriate bit depth. (Typically only the Finder and the Standard File Package use 12-by-16 pixel icons.)<P>
 Depending on the size of the rectangle, the <CODE>PlotIconID</CODE> function may stretch or shrink the icon to fit. To draw icons without stretching them, <CODE>PlotIconID</CODE> requires that the destination rectangle have the exact dimensions of a standard icon: that is, depending on the icon resource type, 32 by 32 pixels, 16 by 16 pixels, or 12 by 16 pixels. If you use destination rectangles of other sizes, <CODE>PlotIconID</CODE> stretches or shrinks the icons to fit the rectangles.<A NAME=MARKER-2-112></A><P>
<A NAME=HEADING273-18></A>
<H3><A NAME=MARKER-9-96></A>Getting an Icon Suite and Drawing One of Its Icons</H3>
 <A NAME=MARKER-9-122></A><A HREF=#MARKER-9-98>Listing 5-2</A> shows how you can use the <CODE>GetIconSuite</CODE> and <CODE>PlotIconSuite</CODE> functions to get an icon suite and then draw the icon from the suite that is best suited to the destination rectangle and the current bit depth of the display device. <P>
<B>Listing 5-2  <A NAME=MARKER-9-98></A>Drawing the icon from an icon suite that is best suited to the display device <A NAME=MARKER-2-99></A></B><P>
<PRE>
PROCEDURE MyDrawIconInSuite (resID: Integer; destRect: Rect; 
                             VAR iconSuiteHdl: Handle);
VAR
   iconType:      IconSelectorValue;
   align:         IconAlignmentType;
   transform:     IconTransformType;
   myErr:         OSErr;
BEGIN
   iconType := svAllAvailable;   {get all icons in icon family}
   myErr := GetIconSuite(iconSuiteHdl, resID, iconType);
   IF iconSuiteHdl &lt;&gt; NIL THEN
   BEGIN
      align := atAbsoluteCenter; {specify alignment (centered)}
      transform := ttNone;       {specify no special transforms}
      {draw the icon, using the icon type best suited for the }
      { destination rect &amp; current bit depth of display device}
      myErr := PlotIconSuite(destRect, align, transform,
                             iconSuiteHdl);
   END;
END;
</PRE>
 The application-defined procedure <CODE>MyDrawIconInSuite</CODE> shown in <A HREF=#MARKER-9-98>Listing 5-2</A> first uses the <CODE>GetIconSuite</CODE> function, specifying the constant <CODE>svAllAvailable</CODE> in the third parameter, to get all icons from the icon family with the specified resource ID and to collect the handles to the data for each icon into an icon suite. (You can use other constants in the third parameter of <CODE>GetIconSuite</CODE> to request only certain members of an icon family for an icon suite.) The <CODE>MyDrawIconInSuite</CODE> procedure then draws an icon from this suite using the <CODE>PlotIconSuite</CODE> function. <P>
 Like the <CODE>PlotIconID</CODE> function described in the previous section, the <CODE>PlotIconSuite</CODE> function determines, from the size of the specified destination rectangle and the current bit depth of the display device, which icon from the icon suite to draw. <P>
 You can also specify various transforms and alignments to <CODE>PlotIconSuite</CODE>. For example, the code in <A HREF=#MARKER-9-98>Listing 5-2</A> specifies that <CODE>PlotIconSuite</CODE> should center the icon within the destination rectangle. <A NAME=MARKER-9-107></A><P>
<A NAME=HEADING273-25></A>
<H3><A NAME=MARKER-9-101></A>Drawing Specific Icons From an Icon Family</H3>
 In most cases you should use <CODE>PlotIconID</CODE> or <CODE>PlotIconSuite</CODE> to draw an icon from an icon family, because these routines automatically select the best version of an icon to display for a given destination rectangle and bit depth. The preceding sections, <A HREF=#MARKER-9-90>"Drawing an Icon Directly From a Resource"</A> and <A HREF=#MARKER-9-96>"Getting an Icon Suite and Drawing One of Its Icons,"</A> describe how to use these routines.<A NAME=MARKER-9-400></A><P>
 If you need to plot a specific icon from an icon family rather than using the Icon Utilities to select a family member, you must first create an icon suite that contains only the icon from the desired resource type and its corresponding mask. You can then use <CODE>PlotIconSuite</CODE> to plot the icon. In this case <CODE>PlotIconSuite</CODE> still attempts to use the best icon available for the given destination rectangle and bit depth; however, by limiting the icon resources available in the icon suite, you can force <CODE>PlotIconSuite</CODE> to plot either the black-and-white icon from the <CODE>'ICN#'</CODE> resource or just one of the other available resources. <A HREF=#MARKER-9-103>Listing 5-3</A> demonstrates how to do this. <P>
<B>Listing 5-3  <A NAME=MARKER-9-103></A>Drawing a specific icon from an icon family or icon suite <A NAME=MARKER-2-312></A></B><P>
<PRE>
PROCEDURE MyDrawThisIcon (destRect: Rect; resID: Integer;
                          VAR iconSuiteHdl: Handle);
VAR
   align:         IconAlignmentType;
   transform:     IconTransformType;
   myErr:         OSErr;
BEGIN
   {get only the 'ICN#' and 'icl4' icons and collect them in an }
   { icon suite}
   myErr := GetIconSuite(iconSuiteHdl, resID, 
                         svLarge1Bit + svLarge4Bit);
   IF iconSuiteHdl &lt;&gt; NIL THEN
   BEGIN
      align := atAbsoluteCenter; {specify alignment (centered)}
      transform := ttNone;       {specify no special transforms}
      {draw the best icon from the suite referenced by the icon }
      { suite handle; since the suite contains only 'ICN#' and }
      { 'icl4' icons, PlotIconSuite draws the best of the two}
      myErr := PlotIconSuite(destRect, align, transform,
                             iconSuiteHdl);
   END;
END;
</PRE>
 The application-defined procedure <CODE>MyDrawThisIcon</CODE> passes the constants <CODE>svLarge1Bit</CODE> and <CODE>svLarge4Bit</CODE> to <CODE>GetIconSuite</CODE>. In response, <CODE>GetIconSuite</CODE> reads only the <CODE>'ICN#'</CODE> and <CODE>'icl4'</CODE> resources into memory, storing handles to the icon resource data in the icon suite. <CODE>MyDrawThisIcon</CODE> then uses <CODE>PlotIconSuite</CODE> to plot the best available icon from the suite.<P>
 If the bit depth of the display device is 1, the <CODE>PlotIconSuite</CODE> function in <A HREF=#MARKER-9-103>Listing 5-3</A> displays the black-and-white version of the icon from the <CODE>'ICN#'</CODE> resource, regardless <BR>of the size of the destination rectangle. If the bit depth of the display device is greater than 1, <CODE>PlotIconSuite</CODE> draws the icon from the <CODE>'icl4'</CODE> resource, regardless of the size of the destination rectangle. <A NAME=MARKER-2-105></A><P>
<A NAME=HEADING273-32></A>
<H3><A NAME=MARKER-9-106></A>Manipulating Icons</H3>
 <A NAME=MARKER-9-135></A>You can use the <CODE>GetIconFromSuite</CODE> function to get a handle to the pixel data for a specific icon from an icon suite. You can use the handle returned by the function<CODE> GetIconFromSuite</CODE> to manipulate the icon data--for example, to alter its color or add three-dimensional shading--but not to draw the icon with other Icon Utilities routines such as <CODE>PlotIconHandle</CODE>.<P>
 <A HREF=#MARKER-9-108>Listing 5-4</A> provides an example of an application-defined procedure, <CODE>MyGetIconData</CODE>, that calls <CODE>GetIconFromSuite</CODE> and manipulates the icon data.<P>
<B>Listing 5-4  <A NAME=MARKER-9-108></A>Manipulating icon data in memory <A NAME=MARKER-2-316></A></B><P>
<PRE>
PROCEDURE MyGetIconData (iconType: ResType; iconSuite: Handle;
                         VAR iconHandle: Handle);
VAR 
   myErr: OSErr;
BEGIN
   {get the data for the icon with iconType from the suite}
   myErr := GetIconFromSuite(iconHandle, iconSuite, iconType);
   {do whatever with the data}
   myErr := MyManipulateIconData(iconHandle, iconType);
END;
</PRE>
 The Icon Utilities also include routines that allow you to perform an action on one or more icons in an icon suite and to perform hit-testing on icons. For information about these routines, see <A HREF=MoreToolbox-300.html#MARKER-9-226>"Performing Operations on Icons in an Icon Suite"</A> and <A HREF=MoreToolbox-313.html#MARKER-9-257>"Determining Whether a Point or Rectangle Is Within an Icon"</A> beginning on <A HREF=MoreToolbox-300.html#MARKER-9-226>page 5-38</A> and <A HREF=MoreToolbox-313.html#MARKER-9-257>page 5-46</A>, respectively. <A NAME=MARKER-2-67></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-272.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-274.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
