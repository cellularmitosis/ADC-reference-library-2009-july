<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Summary of the Process Manager (IM: Pr)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING52></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Processes-51.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Processes-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Processes-171.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Processes-53.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html"><B>Inside Macintosh:</B></A> <A HREF="Processes-2.html"><B>Processes</B></A><BR><DD><A HREF="Processes-21.html"><B>Chapter 2 - Process Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING52-0></A>
<H1>Summary of the Process Manager</H1>
<A NAME=HEADING52-1></A>
<H2>Pascal Summary</H2>
<A NAME=HEADING52-2></A>
<H3>Constants</H3>
<PRE>
CONST
      {Gestalt selector and response bits}
      gestaltOSAttr              = 'os  ';   {O/S attributes selector}
      gestaltLaunchCanReturn     = 1;        {can return from launch}
      gestaltLaunchFullFileSpec  = 2;        {LaunchApplication is available}
      gestaltLaunchControl       = 3;        {Process Manager is available}

      {process identification constants}
      kNoProcess                 = 0;        {process doesn't exist}
      kSystemProcess             = 1;        {process belongs to OS}
      kCurrentProcess            = 2;        {the current process}

      {launch control flags}
      launchContinue             = $4000;    {continue after launch}
      launchNoFileFlags          = $0800;    {ignore launchFileFlags}
      launchUseMinimum           = $0400;    {use minimum or greater size}
      launchDontSwitch           = $0200;    {launch app. in background}
      launchAllow24Bit           = $0100;    {reserved}
      launchInhibitDaemon        = $0080;    {don't launch background app.}
      
      {launch parameter block length and ID}
      extendedBlockLen           = sizeof(LaunchParamBlockRec) - 12;
      extendedBlock              = $4C43;    {extended block}
      
      {flags in processMode field}
      modeDeskAccessory          = $00020000;   {process is desk acc}
      modeMultiLaunch            = $00010000;   {from app file's flags}
      modeNeedSuspendResume      = $00004000;   {from 'SIZE' resource}
      modeCanBackground          = $00001000;   {from 'SIZE' resource}
      modeDoesActivateOnFGSwitch = $00000800;   {from 'SIZE' resource}
      modeOnlyBackground         = $00000400;   {from 'SIZE' resource}
      modeGetFrontClicks         = $00000200;   {from 'SIZE' resource}
      modeGetAppDiedMsg          = $00000100;   {from 'SIZE' resource}
      mode32BitCompatible        = $00000080;   {from 'SIZE' resource}
      modeHighLevelEventAware    = $00000040;   {from 'SIZE' resource}
      modeLocalAndRemoteHLEvents = $00000020;   {from 'SIZE' resource}
      modeStationeryAware        = $00000010;   {from 'SIZE' resource}
      modeUseTextEditServices    = $00000008;   {from 'SIZE' resource}
</PRE>
<A NAME=HEADING52-4></A>
<H3>Data Types</H3>
<A NAME=HEADING52-5></A>
<H4>Process Serial Number</H4>
<PRE>
TYPE 
   ProcessSerialNumber     = 
   RECORD
      highLongOfPSN:       LongInt;             {high-order 32 bits of psn}
      lowLongOfPSN:        LongInt;             {low-order 32 bits of psn}
   END;

   ProcessSerialNumberPtr  = ^ProcessSerialNumber;
</PRE>
<A NAME=HEADING52-7></A>
<H4>Process Information Record</H4>
<PRE>
   ProcessInfoRec          =
   RECORD
      processInfoLength:   LongInt;             {length of record}
      processName:         StringPtr;           {name of process}
      processNumber:       ProcessSerialNumber; {psn of the process}
      processType:         LongInt;             {file type of app file}
      processSignature:    OSType;              {signature of app file}
      processMode:         LongInt;             {'SIZE' resource flags}
      processLocation:     Ptr;                 {address of partition}
      processSize:         LongInt;             {partition size}
      processFreeMem:      LongInt;             {free bytes in heap}
      processLauncher:     ProcessSerialNumber; {proc that launched this one}
      processLaunchDate:   LongInt;             {time when launched}
      processActiveTime:   LongInt;             {accumulated CPU time}
      processAppSpec:      FSSpecPtr;           {location of the file}
   END;

   ProcessInfoRecPtr       = ^ProcessInfoRec;
</PRE>
<A NAME=HEADING52-9></A>
<H4>Application Parameters Record</H4>
<PRE>
   AppParameters           =
   RECORD
      theMsgEvent:         EventRecord;         {event (high-level)}
      eventRefCon:         LongInt;             {reference constant}
      messageLength:       LongInt;             {length of buffer}
      messageBuffer:       ARRAY [0..0] OF SignedByte;
   END;

   AppParametersPtr        =   ^AppParameters;
</PRE>
<A NAME=HEADING52-11></A>
<H4>Launch Parameter Block</H4>
<PRE>
   LaunchFlags             =   Integer;
   LaunchParamBlockRec     = 
   RECORD
      reserved1:           LongInt;             {reserved}
      reserved2:           Integer;             {reserved}
      launchBlockID:       Integer;             {extended block}
      launchEPBLength:     LongInt;             {length of block}
      launchFileFlags:     Integer;             {app's Finder flags}
      launchControlFlags:  LaunchFlags;         {launch options}
      launchAppSpec:       FSSpecPtr;           {location of app's file}
      launchProcessSN:     ProcessSerialNumber; {returned psn}
      launchPreferredSize: LongInt;             {returned pref size}
      launchMinimumSize:   LongInt;             {returned min size}
      launchAvailableSize: LongInt;             {returned avail size}
      launchAppParameters: AppParametersPtr;    {high-level event}
   END;

   LaunchPBPtr             =  ^LaunchParamBlockRec;
</PRE>
<A NAME=HEADING52-14></A>
<H3>Routines</H3>
<A NAME=HEADING52-15></A>
<H4>Getting Process Information</H4>
<PRE>
FUNCTION GetCurrentProcess	(VAR PSN: ProcessSerialNumber): OSErr;
FUNCTION GetNextProcess		(VAR PSN: ProcessSerialNumber): OSErr;
FUNCTION GetProcessInformation
				(PSN: ProcessSerialNumber;
				VAR info: ProcessInfoRec): OSErr;
FUNCTION SameProcess		(PSN1: ProcessSerialNumber; 
				PSN2: ProcessSerialNumber; 
				VAR result: Boolean): OSErr;
FUNCTION GetFrontProcess	(VAR PSN: ProcessSerialNumber): OSErr;
FUNCTION SetFrontProcess	(PSN: ProcessSerialNumber): OSErr;
FUNCTION WakeUpProcess		(PSN: ProcessSerialNumber): OSErr;
</PRE>
<A NAME=HEADING52-24></A>
<H4>Launching Applications and Desk Accessories</H4>
<PRE>
FUNCTION LaunchApplication	(LaunchParams: LaunchPBPtr): OSErr;
FUNCTION LaunchDeskAccessory	(pFileSpec: FSSpecPtr; pDAName: StringPtr): 
				OSErr;
</PRE>
<A NAME=HEADING52-27></A>
<H4>Terminating a Process</H4>
<PRE>
PROCEDURE ExitToShell;
</PRE>
<A NAME=HEADING52-29></A>
<H2>C Summary</H2>
<A NAME=HEADING52-30></A>
<H3>Constants</H3>
<PRE>
/*Gestalt selector and response bits*/
#define gestaltOSAttr               'os  '   /*O/S attributes selector*/
#define gestaltLaunchCanReturn      1        /*can return from launch*/
#define gestaltLaunchFullFileSpec   2        /*LaunchApplication available*/
#define gestaltLaunchControl        3        /*Process Manager is available*/

/*process identification constants*/
enum {
      kNoProcess                    0,       /*process doesn't exist*/
      kSystemProcess                1,       /*process belongs to OS*/
      kCurrentProcess               2        /*the current process*/
};
/*launch control flags*/
enum {
      launchContinue             = 0x4000,   /*continue after launch*/
      launchNoFileFlags          = 0x0800,   /*ignore launchFileFlags*/
      launchUseMinimum           = 0x0400,   /*use minimum or greater size*/
      launchDontSwitch           = 0x0200,   /*launch app. in background*/
      launchAllow24Bit           = 0x0100,   /*reserved*/
      launchInhibitDaemon        = 0x0080    /*don't launch background app.*/
};
/*launch parameter block length and ID*/
#define extendedBlockLen            (sizeof(LaunchParamBlockRec) - 12)
#define extendedBlock               ((unsigned short)'LC')
      
/*flags in processMode field*/
enum {
      modeDeskAccessory          = 0x00020000,  /*process is desk acc*/
      modeMultiLaunch            = 0x00010000,  /*from app file's flags*/
      modeNeedSuspendResume      = 0x00004000,  /*from 'SIZE' resource*/
      modeCanBackground          = 0x00001000,  /*from 'SIZE' resource*/
      modeDoesActivateOnFGSwitch = 0x00000800,  /*from 'SIZE' resource*/
      modeOnlyBackground         = 0x00000400,  /*from 'SIZE' resource*/
      modeGetFrontClicks         = 0x00000200,  /*from 'SIZE' resource*/
      modeGetAppDiedMsg          = 0x00000100,  /*from 'SIZE' resource*/
      mode32BitCompatible        = 0x00000080,  /*from 'SIZE' resource*/
      modeHighLevelEventAware    = 0x00000040,  /*from 'SIZE' resource*/
      modeLocalAndRemoteHLEvents = 0x00000020,  /*from 'SIZE' resource*/
      modeStationeryAware        = 0x00000010,  /*from 'SIZE' resource*/
      modeUseTextEditServices    = 0x00000008   /*from 'SIZE' resource*/
};
</PRE>
<A NAME=HEADING52-34></A>
<H3>Data Types</H3>
<A NAME=HEADING52-35></A>
<H4>Process Serial Number</H4>
<PRE>
struct ProcessSerialNumber {
      unsigned long        highLongOfPSN;       /*high-order 32 bits of psn*/
      unsigned long        lowLongOfPSN;        /*low-order 32 bits of psn*/
};

typedef struct ProcessSerialNumber ProcessSerialNumber;
typedef ProcessSerialNumber *ProcessSerialNumberPtr;
</PRE>
<A NAME=HEADING52-37></A>
<H4>Process Information Record</H4>
<PRE>
struct ProcessInfoRec {
      unsigned long        processInfoLength;   /*length of record*/
      StringPtr            processName;         /*name of process*/
      ProcessSerialNumber  processNumber;       /*psn of the process*/
      unsigned long        processType;         /*file type of app file*/
      OSType               processSignature;    /*signature of app file*/
      unsigned long        processMode;         /*'SIZE' resource flags*/
      Ptr                  processLocation;     /*address of partition*/
      unsigned long        processSize;         /*partition size*/
      unsigned long        processFreeMem;      /*free bytes in heap*/
      ProcessSerialNumber  processLauncher;     /*proc that launched this */
                                                /* one*/
      unsigned long        processLaunchDate;   /*time when launched*/
      unsigned long        processActiveTime;   /*accumulated CPU time*/
      FSSpecPtr            processAppSpec;      /*location of the file*/
};

typedef struct ProcessInfoRec ProcessInfoRec;
typedef ProcessInfoRec *ProcessInfoRecPtr;
</PRE>
<A NAME=HEADING52-39></A>
<H4>Application Parameters Record</H4>
<PRE>
struct AppParameters {
      EventRecord          theMsgEvent;         /*event (high-level)*/
      unsigned long        eventRefCon;         /*reference constant*/
      unsigned long        messageLength;       /*length of buffer*/
};

typedef struct AppParameters AppParameters;
typedef AppParameters *AppParametersPtr;
</PRE>
<A NAME=HEADING52-41></A>
<H4>Launch Parameter Block</H4>
<PRE>
typedef unsigned short LaunchFlags;
struct LaunchParamBlockRec {
      unsigned long        reserved1;           /*reserved*/
      unsigned short       reserved2;           /*reserved*/
      unsigned short       launchBlockID;       /*extended block*/
      unsigned long        launchEPBLength;     /*length of block*/
      unsigned short       launchFileFlags;     /*app's Finder flags*/
      LaunchFlags          launchControlFlags;  /*launch options*/
      FSSpecPtr            launchAppSpec;       /*location of app's file*/
      ProcessSerialNumber  launchProcessSN;     /*returned psn*/
      unsigned long        launchPreferredSize; /*returned pref size*/
      unsigned long        launchMinimumSize;   /*returned min size*/
      unsigned long        launchAvailableSize; /*returned avail size*/
      AppParametersPtr     launchAppParameters; /*high-level event*/
};

typedef struct LaunchParamBlockRec LaunchParamBlockRec;
typedef LaunchParamBlockRec *LaunchPBPtr;
</PRE>
<A NAME=HEADING52-44></A>
<H3>Routines</H3>
<A NAME=HEADING52-45></A>
<H4>Getting Process Information</H4>
<PRE>
pascal	OSErr	GetCurrentProcess		(ProcessSerialNumber *PSN);
pascal	OSErr	GetNextProcess			(ProcessSerialNumber *PSN);
pascal	OSErr	GetProcessInformation		(const ProcessSerialNumber *PSN,
						ProcessInfoRecPtr info);
pascal	OSErr	SameProcess			(const ProcessSerialNumber *PSN1, 
						const ProcessSerialNumber *PSN2, 
						Boolean *result);
pascal	OSErr	GetFrontProcess			(ProcessSerialNumber *PSN);
pascal	OSErr	SetFrontProcess			(const ProcessSerialNumber *PSN);
pascal	OSErr	WakeUpProcess			(const ProcessSerialNumber *PSN);
</PRE>
<A NAME=HEADING52-57></A>
<H4>Launching Applications and Desk Accessories</H4>
<PRE>
pascal	OSErr	LaunchApplication		(const LaunchParamBlockRec *LaunchParams);
pascal	OSErr	LaunchDeskAccessory		(const FSSpec *pFileSpec,
						ConstStr255Param pDAName);
</PRE>
<A NAME=HEADING52-62></A>
<H4>Terminating a Process</H4>
<PRE>
pascal	void	ExitToShell				(void);
</PRE>
<A NAME=HEADING52-64></A>
<H2>Assembly-Language Summary</H2>
<A NAME=HEADING52-65></A>
<H3>Data Structures</H3>
<A NAME=HEADING52-66></A>
<H4>Process Serial Number
<TABLE BORDER="0" CELLPADDING=3><TD>0<TD>highLongOfPSN<TD>long<TD>high-order 32-bits of process serial number<TR>
<TD>4<TD>lowLongOfPSN<TD>long<TD>low-order 32-bits of process serial number</TABLE>
</H4>
<A NAME=HEADING52-67></A>
<H4>Process Information Record
<TABLE BORDER="0" CELLPADDING=3><TD>0<TD>processInfoLength<TD>long<TD>length of this record<TR>
<TD>4<TD>processName<TD>long<TD>name of process<TR>
<TD>8<TD>processNumber<TD>2 longs<TD>process serial number of the process<TR>
<TD>16<TD>processType<TD>long<TD>type of application file<TR>
<TD>20<TD>processSignature<TD>long<TD>signature of application file<TR>
<TD>24<TD>processMode<TD>long<TD>flags from <CODE>'SIZE'</CODE> resource<TR>
<TD>28<TD>processLocation<TD>long<TD>address of process partition<TR>
<TD>32<TD>processSize<TD>long<TD>partition size (in bytes)<TR>
<TD>36<TD>processFreeMem<TD>long<TD>amount of free memory in application heap<TR>
<TD>40<TD>processLauncher<TD>2 longs<TD>process that launched this one<TR>
<TD>48<TD>processLaunchDate<TD>long<TD>value of <CODE>Ticks</CODE> at time of launch<TR>
<TD>52<TD>processActiveTime<TD>long<TD>total time spent using the CPU<TR>
<TD>56<TD>processAppSpec<TD>long<TD>location of the file</TABLE>
</H4>
<A NAME=HEADING52-68></A>
<H4>Application Parameters Record
<TABLE BORDER="0" CELLPADDING=3><TD>0<TD>theMsgEvent<TD>16 bytes<TD>the high-level event record<TR>
<TD>16<TD>eventRefCon<TD>long<TD>reference constant<TR>
<TD>20<TD>messageLength<TD>long<TD>length of buffer<TR>
<TD>24<TD>messageBuffer<TD>byte<TD>first byte of the message buffer</TABLE>
</H4>
<A NAME=HEADING52-69></A>
<H4>Launch Parameter Block
<TABLE BORDER="0" CELLPADDING=3><TD>0<TD><CODE>reserved1</CODE><TD>long<TD>reserved<TR>
<TD>4<TD><CODE>reserved2</CODE><TD>word<TD>reserved<TR>
<TD>6<TD><CODE>launchBlockID</CODE><TD>word<TD>specifies whether block is extended<TR>
<TD>8<TD><CODE>launchEPBLength</CODE><TD>long<TD>length (in bytes) of rest of parameter block<TR>
<TD>12<TD><CODE>launchFileFlags</CODE><TD>word<TD>the Finder flags for the application file<TR>
<TD>14<TD><CODE>launchControlFlags</CODE><TD>word<TD>flags that specify launch options<TR>
<TD>16<TD><CODE>launchAppSpec</CODE><TD>long<TD>address of <CODE>FSSpec</CODE> that specifies the application file <BR>to launch<TR>
<TD>20<TD><CODE>launchProcessSN</CODE><TD>2 longs<TD>process serial number<TR>
<TD>28<TD><CODE>launchPreferredSize</CODE><TD>long<TD>application's preferred partition size<TR>
<TD>32<TD><CODE>launchMinimumSize</CODE><TD>long<TD>application's minimum partition size<TR>
<TD>36<TD><CODE>launchAvailableSize</CODE><TD>long<TD>maximum partition size available<TR>
<TD>40<TD><CODE>launchAppParameters</CODE><TD>long<TD>high-level event for launched application</TABLE>
</H4>
<A NAME=HEADING52-70></A>
<H3>Trap Macros</H3>
<A NAME=HEADING52-71></A>
<H4>Trap Macro Names
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Pascal name<TH>Trap macro name<TR>
<TD>LaunchApplication<TD><CODE>_Launch</CODE><TR>
<TD>ExitToShell<TD>_ExitToShell</TABLE>
</H4>
<A NAME=HEADING52-72></A>
<H4>Trap Macros Requiring Routine Selectors</H4>
_OSDispatch
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Selector<TH>Routine<TR>
<TD>$0036<TD>LaunchDeskAccessory<TR>
<TD>$0037<TD>GetCurrentProcess<TR>
<TD>$0038<TD>GetNextProcess<TR>
<TD>$0039<TD>GetFrontProcess<TR>
<TD>$003A<TD>GetProcessInformation<TR>
<TD>$003B<TD>SetFrontProcess<TR>
<TD>$003C<TD>WakeUpProcess<TR>
<TD>$003D<TD>SameProcess</TABLE>

</PRE>
<A NAME=HEADING52-74></A>
<H2>Result Codes
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>paramErr<TD>-50<TD>Process serial number is invalid<TR>
<TD>memFullErr<TD>-108<TD>Not enough memory to allocate the partition size specified in the <CODE>'SIZE'</CODE> resource<TR>
<TD>resNotFound<TD>-192<TD>Resource not found<TR>
<TD>procNotFound<TD>-600<TD>No eligible process with specified process serial number<TR>
<TD>memFragErr<TD>-601<TD>Not enough room to launch application with special requirements<TR>
<TD>appModeErr<TD>-602<TD>Addressing mode is 32-bit, but application is not 32-bit clean<TR>
<TD>appMemFullErr<TD> -605<TD>Partition size specified in <CODE>'SIZE'</CODE> resource is not big enough for launch<TR>
<TD>appIsDaemon <TD>-606<TD>Application is background-only</TABLE>
</H2>
 <A NAME=MARKER-2-26></A><A NAME=MARKER-2-242></A><P>
</BLOCKQUOTE><P>
<HR>
<center>
<A HREF="Processes-51.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Processes-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Processes-171.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Processes-53.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Processes-3.html">&copy; Apple Computer, Inc.</A><br>17 JUN 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
