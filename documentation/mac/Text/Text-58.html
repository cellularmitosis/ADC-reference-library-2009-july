<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>The Edit Record(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING58></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-57.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-59.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-40.html"><B>Chapter 2 - TextEdit</B></A> / <A HREF="Text-56.html"><B>TextEdit Reference</B></A><BR><DL><DD><A HREF="Text-57.html"><B>Data Structures</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING58-0></A>
<H3>The Edit Record</H3>
 The<A NAME=MARKER-2-361></A> edit record c<A NAME=MARKER-2-265></A>ontains display, storage, styling, and other information related to editing that TextEdit requires. Although some fields are used differently for multistyled edit records and monostyled edit records, the structure of an edit record is the same whether the text is multistyled or monostyled.<P>
<PRE>
TYPE  TERec = 
      RECORD         
         destRect:   Rect;    {destination rectangle}
         viewRect:   Rect;    {view rectangle}
         selRect:    Rect;    {the selection rectangle}
         lineHeight: Integer; {used for vertical spacing of lines}
         fontAscent: Integer; {used for caret/highlighting }
                              { position}
         selPoint:   Point;   {point selected with the mouse}
         selStart:   Integer; {start of selection range}
         selEnd:     Integer; {end of selection range}
         active:     Integer; {set when record is activated or }
                              { deactivated}
         wordBreak:  ProcPtr; {word break hook}
         clikLoop:   ProcPtr; {click loop hook}
         clickTime:  LongInt; {used internally}
         clickLoc:   Integer; {used internally}
         caretTime:  LongInt; {used internally}
         caretState: Integer; {used internally}
         just:       Integer; {alignment of text}
         teLength:   Integer; {length of text}
         hText:      Handle;  {handle to text to be edited}
         hDispatchRec: Handle;{handle to TextEdit dispatch record}
         clikStuff:  Integer; {used internally}
         crOnly:     Integer; {if &lt;0, new line at Return only}
         txFont:     Integer; {text font.Otherwise, if txSize is }
                              { -1, combines with txFace to hold }
                              { a handle to the style record.}
         txFace:     Style;   {character style; unpacked byte. }
                              { Otherwise, if txSize is -1, } 
                              { combines with txFont to hold a }
                              { handle to the style record}
         txMode:     Integer; {pen mode}
         txSize:     Integer; {tells if multistyled }
                              { edit record; if not, font size}
         inPort:     GrafPtr; {a pointer to the graphics port }
                              { for this TERec}
         highHook:   ProcPtr; {used for text highlighting}
         caretHook:  ProcPtr; {used for caret appearance}
         nLines:     Integer; {number of lines}
         lineStarts: ARRAY[0..16000] OF Integer;
                              {positions of line starts}
   END;
TYPE  TEPtr    = ^TERec;
      TEHandle = ^TEPtr
</PRE>
<DL>
<H5>Field Description</H5>
<DT><CODE>destRect</CODE> 
<DD> The destination<A NAME=MARKER-9-284></A> rectangle, in local coordinates.
<DT><CODE>viewRect</CODE> 
<DD> The view rectangle, i<A NAME=MARKER-2-1002></A>n local coordinates.
<DT><CODE>selRect</CODE>
<DD> The selection rectangle, whose boundaries are defined in <BR>local coordinates. This value is the current selection range or insertion point.
<DT><CODE>lineHeight</CODE> 
<DD> The vertical spacing of lines of text. Vertical spacing may be fixed or it may vary from line to line, depending upon specific text attributes. If the value of <CODE>lineHeight</CODE> is greater than 0, this field specifies the fixed vertical distance from the ascent line of one line of text down to the ascent line of the next.
<DT>
<DD> If the value of <CODE>lineHeight</CODE> is less than 1, then this field specifies the vertical distance from the ascent line of one line of text down to the ascent line of the next calculated independently for each line, based on the maximum value for any individual character attribute on that line.
<DT><CODE>fontAscent</CODE>
<DD> The font ascent line. If the value of <CODE>fontAscent</CODE> is greater than 0, this field specifies how far above the base line the pen is positioned to begin drawing the caret or highlighting.
<DT>
<DD> For single-spaced text, this is the height of the text in pixels (the height of the tallest characters in the font from the base line). If the value of <CODE>fontAscent</CODE> is less than 1, this field specifies the font ascent calculated independently for each line, based on maximum value for any individual character attribute on that line.
<DT><CODE>selPoint </CODE>
<DD> The point selected with the mouse, in the local coordinates of the current graphics port. The assembly-language offset for this field is named <CODE>teSelPoint</CODE>.
<DT><CODE>selStart</CODE> 
<DD> The byte offset of the beginning of a selection range. Note that byte offset 0 refers to the first byte in the text buffer.
<DT><CODE>selEnd</CODE>
<DD> The byte offset of the end of a selection range. To include that byte, this value must be 1 greater than the position of the last byte offset of the text.
<DT><CODE>active</CODE>
<DD> This field is used internally by TextEdit. It is set when an edit record is activated through <CODE>TEActivate</CODE> and then reset when the edit record is rendered inactive through <CODE>TEDeactivate</CODE>. To ensure future compatibility, use <A NAME=MARKER-2-415></A><CODE>TEActivate</CODE> or <A NAME=MARKER-2-377></A><CODE>TEDeactivate</CODE> to access this field.
<DT><CODE>wordBreak</CODE>
<DD> The record's word selection break routine. This routine determines the word that is highlighted when the user double-clicks in the text and the position at which text is   wrapped at the end of a line.
<DT><CODE>clikLoop</CODE>
<DD> The pointer to the click loop routine.The specified click loop routine is called repeatedly by the <CODE>TEClick</CODE> procedure as long as the mouse button is held down within the text.
<DT><CODE>clickTime</CODE>
<DD> This field is for internal use only.
<DT><CODE>clickLoc</CODE>
<DD> This field is for internal use only.
<DT><CODE>caretTime</CODE>
<DD> This field is for internal use only.
<DT><CODE>caretState</CODE>
<DD> This field is for internal use only.
<DT><CODE>just</CODE>
<DD> The type of text alignment: default (according to primary line direction), left, center, or right.<A NAME=MARKER-2-958></A>
<DT><CODE>teLength</CODE>
<DD> The number of bytes in the text to be edited. For two-byte systems, potentially twice the number of characters. Initially set to zero. The maximum length is 32767 bytes.
<DT><CODE>hText</CODE>
<DD> A handle to the text. Initially, it points to a zero-length block of text in the heap.
<DT><CODE>hDispatchRec</CODE>
<DD> The handle to the TextEdit dispatch record. This field is for internal use only; do not modify this field, or copy it to another edit record. Each edit record has its own dispatch record. Attempting to use the dispatch record of one edit record with another edit record can cause TextEdit to crash.
<DT><CODE>clikStuff</CODE>
<DD> This field is for internal use only. TextEdit sets this field to reflect whether the most recent mouse-down event occurred on the leading or trailing edge of a glyph. TextEdit uses this value in determining a caret position.
<DT><CODE>crOnly</CODE>
<DD> A value specifying whether or not text wraps at the right edge of the destination rectangle. If <CODE>crOnly</CODE> is positive, text does wrap.
<DT>
<DD> If <CODE>crOnly</CODE> is negative, new lines are specified explicitly by <CODE>Return</CODE> characters only; text does not wrap at the edge of the destination rectangle. (This is useful in an application similar to a programming-language editor, where you may not want a single line of code to be split onto two lines.)
<DT><CODE>txFont</CODE>
<DD> The font of all the text in the edit record if the <CODE>txSize</CODE> field of this edit record \xD1 0. If you change this value, the entire text of this <BR>edit record has the new characteristic when it is redrawn; also, remember to change the <CODE>lineHeight</CODE> and <CODE>fontAscent</CODE> fields <BR>as well.
<DT>
<DD> If the <CODE>txSize</CODE> field is -1, this field combines with <CODE>txFace</CODE> to hold a handle to the associated style record.
<DT><CODE>txFace</CODE>
<DD> The character attributes of all the text in an edit record if the <CODE>txSize</CODE> field of this edit record \xD1 0. If you change this value, the entire text of this edit record has the new characteristic when it is redrawn; also, remember to change the <CODE>lineHeight</CODE> and <CODE>fontAscent</CODE> fields as well.
<DT>
<DD> If the <CODE>txSize</CODE> field is -1, this field combines with <CODE>txFont</CODE> to hold a handle to the associated style record.
<DT><CODE>txMode</CODE>
<DD> The pen mode of all the text in the edit record. If you change this value, the entire text of this edit record has the new characteristic when it is redrawn; also, remember to change the <CODE>lineHeight</CODE> and <CODE>fontAscent</CODE> fields as well.
<DT><CODE>txSize</CODE>
<DD> Depending on its value, <CODE>txSize</CODE> either contains the point size of all of the text or it acts as a flag indicating whether or not there is associated character attribute information. If <CODE>txSize</CODE> \xD1 0, this is a monostyled edit record, that is, all text is set in a single font, size, and face, and the value of <CODE>txSize</CODE> is the size of the text. If <CODE>txSize</CODE> is -1, the edit record contains associated character attribute information and the <CODE>txFont</CODE> and <CODE>txFace</CODE> fields combine to form a handle to the style record.
<DT><CODE>inPort</CODE>
<DD> A pointer to the graphics port associated with this edit record.
<DT><CODE>highHook</CODE> 
<DD> A pointer to the routine that deals with text highlighting. In assembly language, the <CODE>highHook</CODE> field is located at the offset <CODE>teHiHook</CODE>. For more information, see the following section, <A HREF=Text-59.html#MARKER-9-381>"The High Hook and Caret Hook Fields."</A>
<DT><CODE>caretHook</CODE>
<DD> A pointer to the routine that controls the appearance of the caret. In assembly language, the <CODE>caretHook</CODE> field is located at the offset <CODE>teCarHook</CODE>. For more information, see the following section, <A HREF=Text-59.html#MARKER-9-381>"The High Hook and Caret Hook Fields."</A>
<DT><CODE>nLines</CODE>
<DD> The number of lines in the text.
<DT><CODE>lineStarts</CODE> 
<DD> An array c<A NAME=MARKER-9-767></A>ontaining the character<A NAME=MARKER-21-90></A> position of the first character in each line. It is declared to have 16001 elements to comply with Pascal range checking. This is a dynamic data structure having only as many elements as needed. TextEdit calculates these values internally, so do not change the elements of the <CODE>lineStarts</CODE> array. Because this data structure grows and shrinks, the size of the edit record changes.
</DL>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-57.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-59.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
