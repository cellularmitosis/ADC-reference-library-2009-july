<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><meta name="keywords" content="window color table control resources"><meta name="Description" content="Technical Note TB33: This Technical Note describes the  'wctb'and 'cctb' resources, what they are, and how they are used."><title>Technical Note TB33: Color, Windows and 7.0</title> <meta name="categories" content="Human Interface Toolbox"><meta name="week-posted" content="Dec 31, 1990 - Jan 4, 1991"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002784" title="Color, Windows and 7.0"></a><a name="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxCarbon-date.html">Carbon</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/Carbon/idxHumanInterfaceToolbox-date.html" target="_blank">Carbon > Human Interface Toolbox</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TB33</div>
<div id="pageheadsub">Color, Windows and 7.0</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext"><A HREF="#Section1">Introduction</A><BR><BR><A HREF="#Section2">Effects on existing applications</A><BR><BR><A HREF="#Section3">The Facts Ma'am, Just the Facts....</A><BR><BR><A HREF="#Section4">But How Does It Work?</A><BR><BR><A HREF="#Section5">Dialog and Alert Boxes</A><BR><BR><A HREF="#Section6">Buttons, Radio Buttons, Check Boxes, and Text</A><BR><BR><A HREF="#Section7">And for Those Who Eke Out a Living at the Deep End....</A><BR><BR><A HREF="#Section8">So what about the Drag Manager?</A><BR><BR><A HREF="#Section9">And You Thought It Would Never End!</A><BR><BR><A HREF="#Changes">Change History</A><BR><BR><A HREF="#References">References</A><BR><BR><A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext"></p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Oct 01 1992]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><a name=Section1></A><h2>Introduction</h2><P>System software version 7.0 introduces a new look for the Macintosh desktop. Inorder to implement those changes, <code>'wctb'</code> and <code>'cctb'</code> resourceshave changed in both form and use; it is now up to developers to take the leadand help the new standard work. The task can be divided into two main areas: inmost cases all developers have to do is to stick to the system resources inorder to provide a homogeneous feel to the user; developers in this group needonly make sure the old 'wctb's are disposed of and that all dialogs and windowsare based on CGrafPorts. The other case is more restricted and involvesdevelopers that need to use their own colors; these applications have to definethe resources using the new templates and do a careful selection of the colorsin order not to break the color scheme implemented by the system.</p><p>The good news is that the mechanics of coloring windows through the use of<code>'wctb'</code> resources is amazingly well documented in <i>InsideMacintosh</i> Volume V; the bad news is that System 7 uses a new and completelydifferent scheme for colorizing windows. The new method uses <code>'wctb'</code>resources that are different than what is described in <i>Inside Macintosh</i>Volume V in both their contents and use, and it is no longer recommended thatapplications provide their own <code>'wctb'</code>s or that they change system<code>'wctb'</code> resources at all.</p><p>This change is not arbitrary. System 7 establishes a new user interface thatnot only presents a new and better-looking appearance for windows, but alsoenhances the user perception of function. The new look helps the user find theplace to click in order to produce a certain result.</p><p>As with most of the rest of the interface, Apple has already done the researchand testing for you, so let the system do the work, and you can focus on yourapplication's code. Of course an application <b>can</b> replace the<code>'wctb'</code> provided by the system, but the results are bound to produceless-than-desirable results.</p><P><A HREF="#top">Back to top</A></p><a name="Section2"></a><h2>Effects on existing applications</h2><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>Note:</B><BR><code>'cctb'</code> resources are now tightly coupled to <code>'wctb'</code>s(especially for scroll bars) and therefore the discussion about the effects ofthe new scheme on old <code>'wctb'</code>s also applies to <code>'cctb'</code>s; theextent of the effect depends on the type of application.</P></TD></TR></TABLE></CENTER><BR><p>Applications that directly access <code>'wctb'</code> resources to customize colorwindows using only the old resource format will not work; these resources aredifferent, and the elements that correspond to the old parts perform newfunctions or are ignored. Directly accessing <code>'wctb'</code> resources maycause system crashes and/or produce really ugly results.</p><p>Solution: Revise applications and utilities that manipulate <code>'wctb'</code>s totake into account the new data structure.</p><p>The system will ignore old-style <code>'wctb'</code> resources; as a resultapplications that provide their own pre-System 7 window color table resourceswill not get the colors they used to see. The system will use the default lookfor the windows. If new style resources are provided, then the entries will beused according to the new scheme; chances are the results are not going to beas good as those obtained with the system colors.</p><p>Solution: Take away the old resources and get used to the new system colors;your users will appreciate that your windows are similar to those across thesystem. In the few cases where it makes sense, update your resources to the newtemplates.</p><p>Applications that carry their own <code>'WDEF'</code> and <code>'CDEF'</code> resourceswill not get the new nice-looking windows provided by the system, and althoughthese applications should not experience problems since they are doing all thework themselves, the result will be a negative one from the good user interfaceperspective. These applications will have windows with the old look when allothers look modern.</p><p>Solution: Developers should revise their applications to include<code>'WDEF'</code> and <code>'CDEF'</code> resources that are compatible with the newcolor interface. As of this writing, sample code for <code>'WDEF'</code> can befound on AppleLink in the following location:</p><p>        "Developer Support:Developer Services:System Software:<br>          Macintosh US System Software:System 7 Golden Master:Sys7WDEF.PKG"</p><p>Certain colors are counted on to produce the correct shades in this new colorinterface; applications that completely destroy the color environment of thesystem will cause interface problems for the user. In the few cases when thesystem can find colors that produce a similar shading effect, the system willuse those colors and display windows using the color interface (although notthe same as all the other windows since the colors are different). When thesystem can not come up with a reasonable alternative for the colors it needs,it reverts to displaying black-and-white windows.</p><p>Solution: Developers should revise their applications so that they don't takeover the color environment and don't leave the colors all screwed up whenswitching out. Do use the Palette Manager, don't blast color tables, and don'thog all the available colors. The key to happiness is moderation.</p><P><A HREF="#top">Back to top</A></p><a name="Section3"></a><h2>The Facts Ma'am, Just the Facts....</h2><p>The new data structure for <code>'wctb'</code> resources resembles the old format,but more "part" fields are now present. The part codes for the new<code>'wctb'</code>s are:</p><table width=600>	<tr>		<td width=20 align=left scope="row"></td><td width=50 align=left>Part code:		</td>    		<td width=300 align=left>Part it corresponds to:		</td>	</tr>	<tr>		<td align="left" scope="row">0</td><td align="left">wContentColor</td><td align="left">Content area of the window</td>	</tr>	<tr>		<td align="left" scope="row">1</td><td align="left">wFrameColor</td><td align="left">Frame</td>	</tr>	<tr>		<td align="left" scope="row">2</td><td align="left">wTextColor</td><td align="left">Window title color and default text color for dialog buttons</td>	</tr>	<tr>		<td align="left" scope="row">3</td><td align="left">wHiliteColor</td><td align="left">Reserved</td>	</tr>	<tr>		<td align="left" scope="row">4</td><td align="left">wTitleBarColor</td><td align="left">Reserved</td>	</tr>	<tr>		<td align="left" scope="row">5</td><td align="left">wHiliteColorLight</td><td align="left">Used to produce colors in title bar stripes and for grayed</td>	</tr>	<tr>		<td align="left" scope="row">text</td>	</tr>	<tr>		<td align="left" scope="row">6</td><td align="left">wHiliteColorDark</td><td align="left">Used to produce colors in title bar stripes and for grayed</td>	</tr>	<tr>		<td align="left" scope="row">text</td>	</tr>	<tr>		<td align="left" scope="row">7</td><td align="left">wTitleBarLight</td><td align="left">Used to produce colors in title bar background</td>	</tr>	<tr>		<td align="left" scope="row">8</td><td align="left">wTitleBarDark</td><td align="left">Used to produce colors in title bar background</td>	</tr>	<tr>		<td align="left" scope="row">9</td><td align="left">wDialogLight</td><td align="left">Used to produce the colors in a dialog box's beveled frame</td>	</tr>	<tr>		<td align="left" scope="row">10</td><td align="left">wDialogDark</td><td align="left">Used to produce the colors in a dialog box's beveled frame</td>	</tr>	<tr>		<td align="left" scope="row">11</td><td align="left">wTingeLight</td><td align="left">Used to produce tinges in parts of windows</td>	</tr>	<tr>		<td align="left" scope="row">12</td><td align="left">wTingeDark</td><td align="left">Used to produce tinges in parts of windows</td>	</tr></table><P>The colors in the windows are generated algorithmically using the colors in theSystem 7 <code>'wctb'</code>. Most of the colors are shades between the light anddark colors. For example, the background color of the title bar is a shade inbetween <code>wTitleBarLight </code>and <code>wTitleBarDark</code>. The resulting coloris obtained as described later in this document.</p><p><code>'cctb'</code> resources are also different; here are the part codes and theircorresponding parts for <code>'cctb'</code>:</p><TABLE><TR><td width=20 align=left></TD><td align="left">Part code:</td><td align="left">Part it corresponds to:</td></TR><TR><td align="left">0</td><td align="left">cFrameColor</td><td align="left">Frames controls</td></TR><TR><td align="left">1</td><td align="left">cBodyColor</td><td align="left">Background color in buttons</td></TR><TR><td align="left">2</td><td align="left">cTextColor</td><td align="left">Interior text in buttons and legend for radio buttons and check boxes</td></TR><TR><td align="left">3</td><td align="left">cThumbColor</td><td align="left">Reserved</td></TR><TR><td align="left">4</td><td align="left">cFillPatColor</td><td align="left">Reserved</td></TR><TR><td align="left">5</td><td align="left">cArrowsColorLight</td><td align="left">Used to produce colors in arrows and scroll bar background color</td></TR><TR><td align="left">6</td><td align="left">cArrowsColorDark</td><td align="left">Used to produce colors in arrows and scroll bar backgroundcolor</td></TR><TR><td align="left">7</td><td align="left">cThumbLight</td><td align="left">Used to produce colors in thumb</td></TR><TR><td align="left">8</td><td align="left">cThumbDark</td><td align="left">Used to produce colors in thumb</td></TR><TR><td align="left">9</td><td align="left">cHiliteLight</td><td align="left">(corresponding to wHiliteLight)</td></TR><TR><td align="left">10</td><td align="left">cHiliteDark</td><td align="left">(corresponding to wHiliteDark)</td></TR><TR><td align="left">11</td><td align="left">cTitleBarLight</td><td align="left">(corresponding to wTitleBarLight)</td></TR><TR><td align="left">12</td><td align="left">cTitleBarDark</td><td align="left">(corresponding to wTitleBarDark)</td></TR><TR><td align="left">13</td><td align="left">cTingeLight</td><td align="left">(corresponding to wTingeLight) Affects 5-6 and 7-8 above</td></TR><TR><td align="left">14</td><td align="left">cTingeDark</td><td align="left">(corresponding to wTingeDark)</td></tr></table><P><A HREF="#top">Back to top</A></p><a name="Section4"></a><h2>But How Does It Work?</h2><p>In System 7, windows and scroll bars are drawn in color on a color device 8bits deep or more (4 bits deep or more in gray-scale devices) independent ofthe type of <code>GrafPort</code>. The design gives windows and scroll bars a "gray" lookwith subtle color tints around the corners; these tinges are intended to givethe user hints about the functions of the different parts.</p><p>When a window is active it will be drawn with the frame in<code>wFrameColor</code>, the title in <code>wTextColor</code>, and the drag bar, thescroll bars and all the gadgets (size, zoom, and close boxes) in a gray colorwith the edges showing the tints; note that in the context of this TechnicalNote gray color can be different from RGB gray (R=G=B); for example, if thelight color is red and the dark color is blue then the "gray" result will bepurple. It is also important to note that the exact gray result may not beavailable in the color table of the target device in which case a closeequivalent is used. In the cases when there is no equivalent available, thesystem resorts to black-and-white (old-style) windows.</p><p>When the window is inactive, the frame is drawn in a grayed<code>wFrameColor</code> to indicate its disabled state; the drag bar, the gadgets,and the scroll bar of the window are whited out and the title will be grayedout (using gray color to display text, not the dithered gray produced with a 50percent pattern) based on <code>wHiliteColorLight</code> and<code>wHiliteColorDark</code>. When the gadgets of a scroll bar (thumb and arrows)are enabled, they are drawn in gray with tinting (coordinated with the colortheme used by the window!); when disabled the thumb disappears altogether andthe arrows show in gray, but with no tinges.</p><p>In keeping the overall scheme of color interface, the background pattern ofscroll bars has to be a gray pattern based on <code>cArrowsColorLight</code> and<code>cArrowsColorDark</code>; when the scroll bar is disabled (when no scrollingis necessary to show all the items in a window) then the scroll bar will bedisplayed in a solid gray. Don't confuse this grayed out state with unselectedwindows that present the scroll bars as well as the drag bar and all gadgetscompletely whited out.</p><CENTER><BR><p><img src="images/tb_33_001.gif" alt="Active Window--Active scroll bars" width=160 height=144><BR><b>Figure 1  Active Window--Active scroll bars</b></p><BR><BR><p><img src="images/tb_33_002.gif" alt="Active Window--Horizontal scroll bar disabled" width=168 height=132><BR><b>Figure 2  Active Window--Horizontal scroll bar disabled</b></p><BR><BR><p><img src="images/tb_33_003.gif" alt="Inactive Window--Notice gray title" width=160 height=144><BR><b>Figure 3  Inactive Window--Notice gray title</b></P><BR></CENTER><P><A HREF="#top">Back to top</A></p><a name="Section5"></a><h2>Dialog and Alert Boxes</h2><P>Dialog and alert boxes have also been colorized following the same themeas in windows, but instead of a tinged border, dialog and alert boxes aredisplayed with a beveled border outlined with black; the bevel, with itsspectrum of colors spreading between <code>wDialogLight</code> and<code>wDialogDark</code> as indicated by <code>DialogShades</code> produce athree-dimensional effect. When a dialog box becomes inactive, the outlinereverts to gray.</p><P align=center><img src="images/tb_33_004.gif" alt="dialog box" width=288 height=136></p><p>Regardless of the port (<code>GrafPort</code> or <code>CGrafPort</code>). dialog and alert boxes aredisplayed using the shading scheme when the target device is set to 8 bits perpixel or more and colors, or when the target device is gray scale and set to 4bits per pixel or more.</p><P><A HREF="#top">Back to top</A></p><a name="Section6"></a><h2>Buttons, Radio Buttons, Check Boxes, and Text</h2><p>Scroll bars are not the only controls affected by <code>'cctb'</code> resources. Ingeneral the names of the parts give a clear idea of what effect is produced bya given color. One area that is slightly different is text; the text in buttonsis drawn using <code>cTextColor</code> in a fashion similar to pre-System 7systems, but when the button is disabled, the new system displays the textusing gray color instead of using dithered gray like it did in earliersystems.</p><p>A gray color is used to draw the text of disabled buttons whenever the dialogis a <code>CGrafPort</code> and the depth of the target device is 2 bits per pixel or more.Dialog boxes based on old-style ports will display disabled text using the olddithered gray.</p><p>The text associated with radio buttons and check boxes follows the sameprinciples. Text is the key to indicate the state (enabled or not) of radiobuttons and check boxes since the body of radio buttons and check boxes isdrawn using <code>cFrameColor</code> whether the control is enabled or not.</p><P><A HREF="#top">Back to top</A></p><a name="Section7"></a><h2>And for Those Who Eke Out a Living at the Deep End ...</h2><p>Although readily available, the <code>'WDEF'</code> code has proven to be a littlebit difficult a source of information for developers wanting to add System 7color to their own <code>'WDEF'</code>s. The following is an attempt to help thosedevelopers see through the mud.</p><p>As mentioned before, the color present in the <code>'wctb'</code> is used bothdirectly and as shades obtained by mixing light and dark colors. The questionis which colors and in what proportions; the answer to how to mix the color isthe shade tables found in the <code>'WDEF'</code>:</p><table>	<tr>		<th>Colors from 'wctb'</th>	</tr>	<tr>		<td align="left" scope="row">Light Color</td><td align="left">Dark Color</td><td align="left">Rate</td><td align="left">Shade</td>	</tr>	<tr>		<td align="left" scope="row"></td>	</tr>	<tr>		<td align="left" scope="row">HiliteShades</td><td align="left">wHiliteLight, wHiliteDark,</td><td align="left"> $0</td><td align="left">; wHiliteShade0</td>	</tr>	<tr>		<td align="left" scope="row">wHiliteLight</td><td align="left">wHiliteDark,</td><td align="left"> $7</td><td align="left">    ; wHiliteShade7</td>	</tr>	<tr>		<td align="left" scope="row">wHiliteLight</td><td align="left">wHiliteDark,</td><td align="left">  $8</td><td align="left">    ; wHiliteShade8</td>	</tr>	<tr>		<td align="left" scope="row">wHiliteLight</td><td align="left">wHiliteDark,</td><td align="left">  $A</td><td align="left">    ; wHiliteShadeA</td>	</tr>	<tr>		<td align="left" scope="row">wHiliteLight</td><td align="left">wHiliteDark,</td><td align="left">  $D</td><td align="left">    ; wHiliteShadeD</td>	</tr>	<tr>		<td align="left" scope="row"></td>	</tr>	<tr>		<td align="left" scope="row">TitleBarShades</td><td align="left">wTitleBarLight, wTitleBarDark</td><td align="left">  $0</td><td align="left">    ; wTitleBarShade0</td>	</tr>	<tr>		<td align="left" scope="row">wTitleBarLight</td><td align="left">wTitleBarDark</td><td align="left">  $1    </td><td align="left">; wTitleBarShade1</td>	</tr>	<tr>		<td align="left" scope="row">wTitleBarLight</td><td align="left">wTitleBarDark</td><td align="left">  $4    </td><td align="left">; wTitleBarShade4</td>	</tr>	<tr>		<td align="left" scope="row"></td>	</tr>	<tr>		<td align="left" scope="row">DialogShades</td><td align="left">wDialogLight, wDialogDark,</td><td align="left">   $0    </td><td align="left">; wDialogShade0w</td>	</tr>	<tr>		<td align="left" scope="row">wDialogLight</td><td align="left">wDialogDark,</td><td align="left">   $4    </td><td align="left">; wDialogShade4w</td>	</tr>	<tr>		<td align="left" scope="row">wDialogLight</td><td align="left">wDialogDark,</td><td align="left">   $6</td><td align="left">    ; wDialogShade6w</td>	</tr>	<tr>		<td align="left" scope="row">wDialogLight</td><td align="left">wDialogDark,</td><td align="left">   $B    </td><td align="left">; wDialogShadeBb</td>	</tr>	<tr>		<td align="left" scope="row">wDialogLight</td><td align="left">wDialogDark,</td><td align="left">   $F    </td><td align="left">; wDialogShadeF</td>	</tr>	<tr>		<td align="left" scope="row"></td>	</tr>	<tr>		<td align="left" scope="row">TingeShades</td><td align="left">wTingeLight, wTitleBarDark,</td><td align="left">  $0</td><td align="left">    ; wLTinge0</td>	</tr>	<tr>		<td align="left" scope="row">wTingeLight,</td><td align="left"> wTingeDark,</td><td align="left">  $4</td><td align="left">; wLTinge4</td></tr><TR><td align="left">wTitleBarLight</td><td align="left">wTingeDark,</td><td align="left">$F</td><td align="left">; wDTingeF</td>	</tr></table><P>The shade tables contain the light and dark colors plus the "shady" factor foreach case, so <code>wHiliteShadeA</code> is a combination of <code>wHiliteLight</code>and <code>wHiliteDark</code> and modified by a factor of $A. In simple terms thismeans that the dark color is subtracted from the light color and the result ismultiplied by the factor involved. Note that since in this case the colors areexpressed in RGB form the higher rates produce lighter colors.</p><p>The shades described above are what the <code>'WDEF'</code> checks for in eachdevice it has to draw to. If the shades are available then the window isrendered using the fancy colors; if the shades are not available then black andwhite and, in the case of inactive windows, patterns are used.</p><p>Let's use the title bar as an example of how the shades are used. Note thatsome colors are directly taken from the <code>'wctb'</code> and others representmixtures of colors:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>Title bar itself:Foreground color  Background color(title bar frame)(to clear title bar rectangle)When window activewFrameColorwTitleBarShade1(wTitleBarLight+wTitleBarDark, $1)When window inactivewHiliteShadeAwContentColor(wHiliteLight+wHiliteDark, $1)================================================================Foreground color forLeft-Top sidesRight-Bottom sidesrect inside title bar(present only when wLTinge0wLTinge4window active)(wTingeLight+wHiliteDark, $0)(wTingeLight+wTingeDark, $4)================================================================*Title stringForeground color*When window activeWhen window inactive**wTextColorwHiliteShade7(wHiliteLight+wHiliteDark, $7)================================================================Title bar stripesForeground coloronly when window activewHiliteShade8(wHiliteLight+wHiliteDark, $8)</pre>	</TD></TR></TABLE></CENTER><P><A HREF="#top">Back to top</A></p><a name="Section8"></a><h2>So what about the Drag Manager?<br></h2><P>If you have a window with your own color table and things aren't set up justso, you probably noticed that calls to <code>ShowDragHilite</code> result in a graydrag hilite instead of the usual color one.  The Drag Manager uses the colortable in the window's <code>AuxWinRec</code> to determine the color used for thehilite.  If the window color table:</p><ul type="disc">	<li>doesn't exist,</li>	<li>doesn't have a minimum number of entries, or</li>	<li>doesn't have a <code>wTingeLight</code> and <code>wTingeDark</code> entry,</li></ul><p>a default 50% gray is used for the drag highlight color.  Often this isdesirable, since the window color-based hilites may clash or be invisible withyour customized window color table, but in some cases you may want the samecolor for your hilite regions.</p><p align=center><img src="images/tb_33_005.gif" alt="Drag hilite region based on window colors" width=256 height=166></p><p align=center><b>Figure 5</b>. Drag hilite region based on window colors</P><p>To stay consistent with what the user chooses in the Colors Control Panel, usethe <code>wTingeLight</code> and <code>wTingeDark</code> entries from the defaultwindow color table (obtained by calling <code>GetAuxWin</code>) as your window'stinge entries.  In order to stay consistent with any changes in the ColorsControl Panel, you may want to compare your tinge entries with the defaultentries when you receive an update event, and reset your color table if thedefault entries have changed.  If a change is made in the Colors Control Panel,every window on the screen will receive an update event, so you'll catch thechange as soon as it happens:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>   case updateEvt:      whichWindow = (WindowPtr) mainEventRec.message;      if (TingeColorChanged(whichWindow) == true)         SyncTingeColors(whichWindow);      SetPort(whichWindow);      BeginUpdate(whichWindow);</pre>	</TD></TR></TABLE></CENTER><p>Here's an example showing how to fill in the color table entries after a newwindow has been created.  Note that this calls <code>GetAuxWin</code> in theGetWinCTab routine to obtain the System's default window color table:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>//----------------------------------------------------------------------------// SyncTingeColors//// Set the tinge colors in this window to the ones found in the default// window color table.//----------------------------------------------------------------------------void SyncTingeColors(WindowPtr theWindow){   WCTabHandle   newWinCTab;   short         index;   newWinCTab = (WCTabHandle) GetWinCTab(theWindow);   if (newWinCTab != nil) {      // OK, we have our window color table, now set it to have      // the System's color table entries for light and dark      // tinges (to match what the user selected in the Colors      // Control Panel.)      CTabHandle defaultWCTB;      RGBColor   defaultTingeDark, defaultTingeLight;      Boolean    hasEntry;      // Pass a nil to get the default window color table      defaultWCTB = GetWinCTab(nil);      if (defaultWCTB != nil) {         // OK, we have the default color table, set our         // window's tinge entries accordingly         // Get a pointer to the wTingeLight in my window         for (index = (*newWinCTab)-&gt;ctSize; index &gt; 0; index --) {            if ((*newWinCTab)-&gt;ctTable[index].value == wTingeLight)   {               // Our window's color table has an entry for wTingeLight,               // so copy the System's light tinge if we can find it.               hasEntry = GetRGBFromCTable(&amp;defaultTingeLight, defaultWCTB,                                            wTingeLight);               if (hasEntry == true)                  BlockMoveData(&amp;defaultTingeLight,                       &amp;(*newWinCTab)-&gt;ctTable[index].rgb,                       sizeof(RGBColor));            }         }         // Get a pointer to the wTingeDark in my window         for (index = (*newWinCTab)-&gt;ctSize; index &gt; 0; index --) {            if ((*newWinCTab)-&gt;ctTable[index].value == wTingeDark)   {               // Our window's color table has an entry for wTingeDark,               // so copy the System's light tinge if we can find it.               hasEntry = GetRGBFromCTable(&amp;defaultTingeDark,                                   defaultWCTB, wTingeDark);               if (hasEntry == true)                  BlockMoveData(&amp;defaultTingeDark,                       &amp;(*newWinCTab)-&gt;ctTable[index].rgb,                       sizeof(RGBColor));            }         }      }      // Finally, set the color table      SetWinColor(theWindow, newWinCTab);   }}//----------------------------------------------------------------------------// GetWinCTab//// Given a Window pointer, this will return the color table associated with// that window.  Note, you can pass nil to this routine to get the default// window color table.  Check out the documentation on GetAuxWin for details.//----------------------------------------------------------------------------CTabHandle GetWinCTab(WindowPtr theWindow){   CTabHandle   returnCTab = nil;   AuxWinHandle   defaultAuxWin;   (void) GetAuxWin(theWindow, &amp;defaultAuxWin);   if (defaultAuxWin != nil)      returnCTab = (*defaultAuxWin)-&gt;awCTable;   return returnCTab;}//----------------------------------------------------------------------------// GetRGBFromCTable//// Fills in a struct with the RGBColor asked for in the whichValue param.// Returns true if the color is filled in properly, and false if it isn't.//----------------------------------------------------------------------------Boolean GetRGBFromCTable(RGBColor *returnColor, CTabHandle colorTable,                         short whichValue){   Boolean  entryFound = false;   short    index;   if (colorTable != nil) {      for (index = (*colorTable)-&gt;ctSize; index &gt; 0; index --)         if ((*colorTable)-&gt;ctTable[index].value == whichValue) {            *returnColor = (*colorTable)-&gt;ctTable[index].rgb;            entryFound = true;            break;         }   }   return entryFound;</pre>	</TD></TR></TABLE></CENTER><P><A HREF="#top">Back to top</A></p><a name="Section9"></a><h2>And You Thought It Would Never End!</h2><p>As always, all applications should refrain from nonfriendly practices whendealing with the color environment; they should use the Palette Manager, andshould never change color tables directly.</p><P><A HREF="#top">Back to top</A></p><a name = "References"></a><h2>References</h2><P><i>Inside Macintosh</i>, Volumes V and VI, Color QuickDraw, WindowManager, Dialog Manager, and Palette Manager</p><p>Snippet GrayWindow &amp; Color Hilites</p><p>Snippet WDEFColorSample</p><p>WDEF code from AppleLink</p><P><A HREF="#top">Back to top</A></p>   <P><A NAME=Changes></A></P>                  <H2>Change History</H2>                                  <TABLE BORDER=0 CELLPADDING=3 WIDTH=544>            <TR>               <td width=100 align=left>                  <P ALIGN=center>01-January-1991</P>               </TD>               <td align="left">                  <P>Originally written.</P>               </TD>            </TR>            <TR>               <td width=100 align=left>                  <P ALIGN=center>01-May-1992</P>               </TD>               <td align="left">                  <P>In this Note, we have removed mention of<code>GetGray</code> and added text describing how colorization of windows reallyworks (kind of).</P>               </TD>            </TR>                         <TR>               <td width=100 align=left>                  <P ALIGN=center>01-October-1992</P>               </TD>               <td align="left">                  <P>Now includes some information on how to obtainand maintain Drag hilite colors for windows with non-default window colortables.</P>               </TD>            </TR>         </TABLE>                  <a name="Downloads"></a>       <P><A HREF="#top">Back to top</A></p><h2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (188K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/tb_33.pdf">Download</A></P>               </TD>            </TR>                    </TABLE>         <BR></TD></TR></table></center><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tb/tb_33.html%3Fid%3DDTS10002784-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tb/tb_33.html%3Fid%3DDTS10002784-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tb/tb_33.html%3Fid%3DDTS10002784-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>