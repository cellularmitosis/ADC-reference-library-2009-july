<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css">   <title>Technical Note NW550: MacTCP Q&amp;As</title><meta name="keywords" content=""><meta name="Description" content="Technical Note NW550: ">    <meta name="categories" content="Networking"><meta name="week-posted" content="Jun 1, 1998 - Jun 5, 1998"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF" TEXT="#000000"><a name="//apple_ref/doc/uid/DTS10002580" title="MacTCP Q&As"></a><a name="top"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxMacOS9Earlier-date.html">Mac OS 9 & Earlier</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/index.html" target="_blank">Reference Library</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note NW550</div>
<div id="pageheadsub">MacTCP Q&amp;As</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->					<p id="menutext"><a href="#Downloads">Downloadables</a></p>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">This Technote contains a collection of archived Q&amp;Asrelating to a specific topic--questions sent to Developer TechnicalSupport along with answers from the highly-trained DTS engineers.Current Q&amp;A's can be found on the<a href="../../qa/index.html">Macintosh Technical Q&amp;A's website</A>.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Oct 01 1990]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR><!-- begin_content --><a name="Section1"></a><h2>OK to abort a MacTCP name resolver call</h2><p>Date Written: 9-Mar-1993</P><P>Last reviewed: 5-Jun-1998</P><P>Is it possible to abort an outstanding MacTCP name resolver callbefore it completes? The <CODE>CloseResolver</CODE> call descriptionsays that "[b]efore the application exits, the<CODE>CloseResolver</CODE> call must be made to release memorystructures and terminate all outstanding domain name server calls."The very next sentence says that "<CODE>CloseResolver</CODE> mustnot be called until all outstanding resolver calls have beencompleted." Which of these statements is correct? If it's the latterone, then does that mean that if I make a <CODE>StrToAddr</CODE> calland it returns cache fault that I have to wait for the result proc to becalled before my application can quit? How long is that likely to be?</P><P>There is no way to cancel an asynchronous name resolver request.You must not call <CODE>CloseResolver</CODE> until all outstandingname resolver calls are complete. You must call<CODE>CloseResolver</CODE> before quitting your application. Therefore, if you have an outstanding DNR request and the userselects <I>Quit</I>, your application must delay quitting until the nameresolver request has completed.</P><P>You can see this behavior in many existing MacTCP applications,which put up a modeless dialog that says "Waiting for DNR requests tocomplete before quitting" if you attempt to quit them while thereare outstanding name resolver requests.</P><P>The timeout for name resolver calls is hard-coded to 37 seconds(MacTCP) or about 2 minutes (Open Transport MacTCP backwardcompatibility); if no response is received  after that period, thecall  will complete with an error.  You should not rely on thesetimeout values in your application, since they are subject to change.</P><P>You can circumvent this restriction by using the<a href="../../documentation/mac/NetworkingOT/NetworkingWOT-51.html">OpenTransport Internet services interface</A>, which allows you to cancelasynchronous requests by simply calling <CODE>OTCloseProvider</CODE>on the Internet services provider.</P><P>One other thing to be aware of is that, although you can performmultiple name resolver lookups simultaneously, MacTCP has a hard,global limit of 4 simultaneous outstanding name resolver requests. In general, DTS recommends that your application not issue more thanone outstanding name resolver request; otherwise, you may preventother applications from using the name resolver. Furthermore, if aname resolver request returns the <CODE>outOfMemory</CODE> errorcode, you may want to retry the request at some later date.</P><P>Again, these restrictions do not apply to the Open TransportInternet services interface.</P><P>Finally, the interrupt-safe nature of the MacTCP name resolver isdocumented in<a href="../tn/tn1104.html">Technote1104: Interrupt-Safe Routines</A>.</P><h2>Maintaining a listening server socket on MacTCP</h2><P>Date Written: 1-Feb-1993</P><P>Last reviewed: 5-Jun-1998</P><P>I need to consistently listen on the same port for incomingconnections. This behavior is analogous to the Listen and Acceptfunctionality provided by the industry-standard socket interface forTCP on UNIX systems. That is, I listen on a port/socket for incomingconnections; when a remote system attempts to connect, a new socketis created representing that connection, and the port/socketperforming the listen continues to listen for other connectionrequests.</P><P>When using the <CODE>TCPPassiveOpen</CODE> operation under MacTCP,the listen operation doesn't persist once an incoming connection isestablished. That is, the stream used to listen for an incomingrequest becomes the connection with the remote system. Once thatconnection is established, there's no stream listening for subsequentconnection requests. Is there any way I can keep a listener active atall times? My application needs to have a listener constantly, or atleast with as short a window of unavailability as possible.</P><P>You're right that MacTCP's non-socket interface has noway to maintain a persistent listener using MacTCP. To emulate thisfunctionality, you'll have to keep more than one listener active atall times. You can do this by queuing multiple<CODE>TCPPassiveOpen</CODE> commands asynchronously to the MacTCPdriver. How many to queue depends on how fast you expect connectionsto come in and how quickly you can re-queue new opens afterconnections are made. Three listeners should probably be enough if you expect a relatively small number of connections and you can re-queue new parameter blocks as you receive connections.</P><P><CODE>PBControlAsync</CODE> is safe to call at interrupt time inthis case. Any asynchronous calls to MacTCP will queue up and wait,so it's safe to post them from an interrupt or an ASR. However, sincethere isn't an ASR event for Notify, I agree that using an ASR isn'ta solution for you in this case.</P><P>There is some sample code you might find useful. On the ToolchestDeveloper CD, under the path ":SampleCode:Snippets:Networking:<A HREF = "downloads/TCP_Server.sea.hqx">TCPServer</A>:" you'll find a sample server that uses TCP.</P><h2>MacTCP over ARA requires MacIP gateway</h2><P>Date Written: 10-Dec-1992</P><P>Last reviewed: 5-Jun-1998</P><P>When I dial into my AppleTalk network none of my MacTCP-basedsoftware works. I have MacTCP configured with an IP number on theremote machine, and Telnet (a MacTCP-based application) runs fine,but I can't connect to any of the hosts on the network I'm dialedinto. What could be causing this problem?</P><P>The problem may occur because you don't have a MacIP gateway on thedial-in net to act as a proxy IP encapsulation service. When youselect the AppleTalk icon (such as LocalTalk, EtherTalk, or Dial-In)in the MacTCP control panel, you're using a MDEV (IP Link layer) thatencapsulates the IP data into an AppleTalk packet and sends it out.You therefore need to have something on the other side that willbreak out the IP data from the AppleTalk packet and send it out as anIP frame on the network you're dialed into.</P><P>There are several third-party solutions to this problem, the ShivaFastPath and Cayman Gator Boxes being the most common. The feature isofficially called MacIP, but it is also known as IP Encapsulation orKIP. If you use MacTCP this way, you must select the zone the MacIP gateway is in via the pop-up menu in the MacTCP control panel.You must also configure the MacIP gateway to give out IP numbers, andset the remote Macintosh to "Server" IP addressing in the MacTCPcontrol panel.</P><P>Note: Two Mac OS computers using MacIP should be able tocommunicate peer to peer, but they won't be able to contact non-MacIPdevices.</P><P>Definition: MacIP: The act of taking IP data frames (packets) andplacing them inside an AppleTalk packet for transport over anAppleTalk-only media (also known as LocalTalk and ARA). MacIP is also known as KIP or KSTAR, which are both names left over from the KineticsFastPath. The protocol specification is available<a href="http://developer.apple.com/dev/opentransport/">online</A>.</P><h2>MacTCP ARP limits are hard-coded</h2><P>Date Written: 22-Sep-1992</P><P>Last reviewed: 5-Jun-1998</P><P>Is it possible to increase ARP cache size? It appears that MacTCPhas memory to cache 35 to 40 entries. If my application sends out IPrequests periodically to about 40 unique IP stations, MacTCP dropssome entries, and makes an ARP request. Is there any way to programthe cache size to a higher limit?</P><P>Unfortunately, the number of ARP table entries is hard-coded to 20in the MacTCP source code, and the ARP time-out for aging entries outof the ARP cache is also hard-coded to 10 minutes. There's no way tochange these values, since they are in the code as #defines and usedthroughout.</P><P>Under Open Transport, these values are tunable using the<a href="http://developer.apple.com/macos/opentransport/nw_tools.html">OTAdvance Tuner</A>.</P><h2>How to cancel transactions under MacTCP</h2><P>Date Written: 7-Dec-1990</P><P>Last reviewed: 5-Jun-1998</P><P>How do I cancel transactions (specifically connect requests) underMacTCP? I know that I can specify a timeout; however, I would likethe user to be able to hit "Command-." if the transaction's tired ofwaiting. I tried <CODE>KillIO</CODE> but that seems to crash.</P><P>MacTCP does not support the <CODE>KillIO</CODE> call to abort atransaction. You should use <CODE>TCPRelease</CODE>. <CODE>TCPRelease</CODE> aborts the current activity and releases thestream. As an alternative, a <CODE>TCPPassiveOpen</CODE> can becanceled by issuing an <CODE>TCPActiveOpen</CODE> from the samemachine on the listening port.</P><P>Note: There is no need to call both <CODE>TCPAbort</CODE> and<CODE>TCPRelease</CODE>. <CODE>TCPRelease</CODE> performs a<CODE>TCPAbort</CODE> before releasing the stream.</P><P>Note: You should call <CODE>TCPRelease</CODE> once--and only once--for each stream you create using <CODE>TCPCreate</CODE>.</P><h2>Porting a TCP/IP application to Mac OS</h2><P>Date Written: 19-Mar-1991</P><P>Last reviewed: 5-Jun-1998</P><P>We need the following to port our mainframe front-end applicationto the Mac OS:</P><UL>   <LI>a C++ compiler compatible with AT&amp;T 2.0 (and ANSI C)</li>      <LI>a TCP/IP library with an Application Programming Interface   (API) similar to sockets</li>      <LI>an Ethernet card</li></UL><P>Apple's Mac OS developer tools, including a C++ compiler, areavailable<a href="http://developer.apple.com/tools/">online</A>.There are also a number of third party C++ compilers for Mac OS.</P><P>Sockets is the general UNIX (Berkeley) API for TCP/IP programming.Apple currently offers some libraries that allow you to work withMacTCP but not APIs similar to sockets. There are, fortunately, a numberof<a href="http://developer.apple.com/macos/opentransport/nw_links.html">third-partysocket libraries</A> for MacTCP.</P><P>Ethernet cards are available from a number of sources, includingApple.</P><h2>MacTCP gateway address and subnet mask fields</h2><P>Date Written: 7-May-1991</P><P>Last reviewed: 5-Jun-1998</P><P>What are the MacTCP Subnet Mask and Gateway Address fields usedfor?</P><P>In the TCP/IP protocol, there are a couple of provisions forsimplifying the addressing scheme for smaller local networks. One ofthese is the subnet mask. It allows the sender to identify thedestination machine by a shorter address, which is long enough todistinguish all the machines on the local network. This mask is madeup of four octets, and is used as a bitwise mask to show how manybits are being used to specify the network number, subnet number, andnode. The gateway address field specifies the IP address of the localnetwork's router. Packets destined for another network are sent tothis router, which then transmits the packets to other networks.</P><P>For more details on the TCP/IP protocol suite, see<I>Internetworking with TCP/IP, Volume 1, Principles, Protocols andArchitecture</I> , 3rd ed., Douglas E Comer, Prentice Hall, 1995, ISBN0-13-216987-8.</P><h2>Communicating different processes on the same Mac with MacTCP</h2><P>Date Written: 5-Jun-1991</P><P>Last reviewed: 5-Jun-1998</P><P>Is it possible to have both the source and the destinationapplication on the same machine if they are using MacTCP tocommunicate? If so, what should I do to make sure both applicationsshare the processor so this works properly?</P><P>It is possible to use MacTCP to communicate to different processeson the same Mac OS computer. Unlike PPC, MacTCP does not bypass thenetwork for same-machine connections, so there may be some "networktraffic" involved, depending on your selected link-layer.</P><P>As far as "sharing" the processor goes, this is <I>very</I>important in what you are doing. Here's a brief outline of what youneed to do:</P><UL>   <LI>Make asynchronous MacTCP driver calls;</li>      <LI>If you want to use polled I/O, you can wait for   <CODE>ioResult</CODE> &lt; 1 to tell when the call completes.   Otherwise, you may want to have a completion routine which queues   completed calls for processing at event time; or</li>      <LI>Call <CODE>WaitNextEvent</CODE> or <CODE>EventAvail</CODE>   while waiting for driver calls to complete (this gives time to the   other MacTCP applications).</li></UL><P>For a good reference on using "idle procs" to give time tobackground applications when using MacTCP, refer to the article,"MacTCP Cookbook" in <I>develop,</I> Issue 6 and get John Norstad's<A HREF = "ftp://ftp.acns.nwu.edu/pub/newswatcher/">NewsWatcher sourcecode</A>.</P><h2>How to tell how many of <CODE>StrToAddr</CODE>'s network addresses are valid</h2><P>Date Written: 30-Aug-1991</P><P>Last reviewed: 5-Jun-1998</P><P>Using <CODE>StrToAddr</CODE>, you can receive up to four IPnetwork addresses returned by the service for the host requested, butthe MacTCP Programmer's Guide does not say how to determine the number of valid addresses. According to the name resolver code, MacTCPzeros out 4 long words before the <CODE>StrToAddr</CODE> lookup andthen fills in the addresses it finds. This means that the arraycontains <I>at most</I>  4 addresses, and is terminated by a zeroaddress (0.0.0.0) if fewer than four addresses are returned.</P><h2>MacTCP resolver code is in domain name resolver</h2><P>Date Written: 17-Sep-1991</P><P>Last reviewed: 5-Jun-1998</P><P>Is the MacTCP resolver code contained in the "MacTCP DNR" file?</P><P>The resolver code is contained in the "MacTCP DNR" file, as wellas in the MacTCP control panel. The DNR code is stored as a resourcefile in the System Folder and is read into memory as necessary inorder to convert host names into addresses. It is used in conjunctionwith a domain name server or with the local hosts file.</P><h2>MacTCP Hosts file location and function</h2><P>Date Written: 17-Sep-1991</P><P>Last reviewed: 5-Jun-1998</P><P>Where should the MacTCP Hosts file be located, and who looks forthat file?</P><P>According to the MacTCP 1.0 Documentation Kit (APDA #M0217LL/A),the Hosts file should be located in the user's System Folder. Thefile maps machine names to Internet addresses, providing the sameservice as the domain name server. The Hosts file can be used if youhave no domain server on your network. It is also suggested that thisfile be used for frequently used name-to-address mappings.Instructions on setting up the file are included in the MacTCPdocumentation.</P><h2>MacTCP "obtain address" options</h2><P>Date Written: 24-Sep-1991</P><P>Last reviewed: 5-Jun-1998</P><P>Under MacTCP, what is the significance of the "obtain address"options, with respect to (1) manually, (2) server, and (3)dynamically?</P><P>According to the MacTCP 1.0 Documentation Kit (APDA #M0217LL/A),"obtain address" means the following:</P><OL>   <LI>Manually -- You will need to fill in some or all of the fields   in the IP Address box;</li>      <LI>Server -- The Internet Protocol (IP) address for the user   Macintosh is automatically obtained from a server the first time   MacTCP is opened after a restart. This option requires:     <UL>      <LI>Reverse Address Resolution Protocol (RARP) or Bootstrap      Protocol (BootP) server on an Ethernet, or</li>            <LI>MacIP gateway on an AppleTalk network that's compatible      with the MacIP protocol as defined      <a href="http://developer.apple.com/dev/opentransport/">online</A>.</li>            </UL></li>      <LI>Dynamically -- The node portion of the IP address for the user   Macintosh is set dynamically the first time MacTCP is opened after   a restart. MacTCP chooses a random address and tries to confirm   whether another machine is using that address. If it is, it   chooses another random address.  The process repeats until an   unused address is found. With this option you still need to set   some of the fields in the IP Address Box.</li></OL><P>All these processes are described in further detail in the MacTCPdocumentation.</P><P>Note: Most non-Mac OS systems label what MacTCP calls Serveraddressing as "dynamic" addressing, and do not support MacTCP'sDynamic addressing method.</P><h2>MacTCP and SLIP</h2><P>Date Written: 6-Nov-1991</P><P>Last reviewed: 5-Jun-1998</P><P>Does MacTCP actually support SLIP? If not, does Apple plan toprovide SLIP support in the future. Does anyone know of any companythat does a SLIP for the Mac OS?</P><P>SLIP is an asynchronous, serial line protocol developed forrunning TCP/IP over serial communications lines in a point-to-pointconfiguration. SLIP was developed to transmit IP packets overlow-speed, sometimes noisy, asynchronous communications lines whereerror recovery and an efficient line protocol are needed. The SLIPprotocol is now being replaced with a new serial line protocol named"PPP," which uses a more efficient means of establishing apoint-to-point IP connection.</P><P>MacTCP includes hooks that let you write different link-layermodules. This makes possible the development of interfaces to SLIP,PPP, and to any other link layer that someone may need, likebroadband, X.25, and FDDI. Apple does not currently provide supportin MacTCP for SLIP or any other serial line protocol. There are,however, several third-party SLIP and PPP extensions available foruse with MacTCP, and Apple now bundles an Open Transport-compatiblePPP implementation with Mac OS.</P><h2>MacTCP <CODE>StrToAddr</CODE> and header's <CODE>hostInfo</CODE> record structure</h2><P>Date Written: 12-Dec-1991</P><P>Last reviewed: 5-Jun-1998</P><P>I'm using MacTCP 1.1 with Think C, and when calling<CODE>StrToAddr</CODE> with hostname = "90.25.3.240", the returnedaddr field has the following:</P><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    addr [0] = 0X00005A19</pre>	</TD></TR></TABLE></CENTER><P>The correct answer should be addr <CODE>[0] = 0X5A1903F0</CODE>. What's the problem?</P><P>The <CODE>StrToAddr</CODE> problem you are experiencing is related to ashortcoming in the header files. The structure for the<CODE>hostInfo</CODE> record you are accessing (from"AddressXlation.h") is as follows:</P><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    typedef struct hostInfo {        int rtnCode;        char cname[255];        unsigned long addr[NUM_ALT_ADDRS];</pre>	</TD></TR></TABLE></CENTER><P>The problem with the way the structure is defined is that<CODE>rtnCode</CODE> is defined as an "int." The size of an int isdependent on your development environment. In MPW, ints are 4 bytes,while Think C uses 2 byte ints as its default. If you're using ThinkC, you will see the addresses shifted forward in the storage by 2bytes, since the <CODE>rtnCode</CODE> structure causes the rest ofthe struct to be shifted forward in memory.</P><P>If you're using Think C 5.0 or later, you can either check the"Use 4 byte ints" check-box in the preferences, or you can change theheader files to use "long" in place of "int" (a Think C long is thesame size as an MPW int). Alternatively, you should upgrade to<a href="http://developer.apple.com/sdk/">Universal Interfaces</A>,which contains MacTCP headers that are compatible with most Mac OS Ccompilers, including Think C.</P><h2>MacTCP <CODE>EnumCache</CODE> data enumeration sequence</h2><P>Date Written: 12/12/91</P><P>Last reviewed: 5-Jun-1998</P><P>Does MacTCP's <CODE>EnumCache</CODE> name resolver call return thedata randomly or in a particular order?</P><P>Since the <CODE>EnumCache</CODE> documentation doesn't specify anyparticular sequence for name resolver cache enumeration, it's best toplay it safe and not assume any particular order for the datareturned by the call. Since the internals of the name resolver maychange in the future (for example, Open Transport MacTCP backwardcompatibility), you probably don't want to rely on any undocumenteddata ordering assumptions. If you want the entries separated, thebest way probably would be to have a dynamically sized array for eachof the entry types (such as addresses, <CODE>HInfo</CODE>, and nameservers) and fill them in the <CODE>EnumCache</CODE> callback.</P><h2>MacTCP addressing modes and Shiva Fastpath</h2><P>Date Written: 12-Dec-1991</P><P>Last reviewed: 5-Jun-1998</P><P>When I attempt to connect to a LocalTalk net using MacTCP 1.1after opening the MacTCP driver, this error occurs: "Error openingdriver / Error in getting address (-23004)". I'm running System 7.0on a Macintosh IIci with Shiva Fastpath 4.0, and I've configured TCPAdmin as follows:</P><OL>   <LI>Indicate Resident Zone</li>      <LI>Click More</li>      <LI>Dynamic addressing</li>      <LI>Range 1 to 65534</li>      <LI>Enter Gateway Address (address of Fastpath for resident zone)</li>      <LI>Enter Domain Name &amp; Address</li></OL><P>The Fastpath won't work with MacTCP configured to use dynamicaddressing. You need to set MacTCP to use server-based addressing. Ifyou change this setting, and the FastPath is configured correctly,you should be up and running.</P><h2>MacTCP 1.1 and sending urgent data per RFC 1122 or 793</h2><P>Date Written: 7-Apr-1992</P><P>Last reviewed: 5-Jun-1998</P><P>MacTCP 1.1 packets containing "urgent data" have the so-called"urgent pointer" set according to RFC 1122. All our TCP/IP hostsexpect a behavior corresponding to RFC 793, however. Is there apossibility to configure MacTCP to this effect?</P><P>MacTCP can send urgent data according to either RFC 1122 or RFC793; however, it is not a setting in the driver that determines this.When a programmer makes the <CODE>TCPSend</CODE> call, they set aflag in the parameter block that indicates whether or not to useurgent data, and which version of urgent data to use. Therefore, youwould have to modify the program that you are using to set up theparameter blocks appropriately.</P><P>To send urgent data using the non-compliant RFC 793 method, setthe <CODE>urgentFlag</CODE> field of the <CODE>TCPSend</CODE>parameter block to 2. Any other non-zero value of<CODE>urgentFlag</CODE> indicates the RFC 1122 method should be used.</P><h2>MacTCP 1.1 ICMP echo request documentation bug</h2><P>Date Written: 13-Feb-1992</P><P>Last reviewed: 5-Jun-1998</P><P>I'm trying to use the ICMP echo request function described on page88 of the MacTCP Developer's Kit 1.1 manual to "ping" a TCP hostbefore trying to open a connection. The problems I'm having seemcentered around the <CODE>ICMPEchoNotifyProc</CODE>. If I declare thecallback as</P><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre></pre>	</TD></TR></TABLE></CENTER><P>the routine gets called and the <CODE>ICMPParamBlockPtr</CODE> isvalid. But after the callback returns, my computer crashes. Can yougive me any suggestions as to how to make this puppy work?</P><P>You've found a bug in the manual. The<CODE>ICMPEchoNotifyProc</CODE> is actually defined as:</P><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre></pre>	</TD></TR></TABLE></CENTER><P>The definition is correct in "MacTCP.h".</P><P>Note that in this definition, the callback uses C-, not Pascal-calling conventions. In C, the caller removes the parameters from the stack, not the callee, and since your routine has already removed the parameters before returning, they are removed twice, corrupting thestack. Changing your procedure to use C-calling conventions shouldfix your problem.</P><h2>MacTCP 1.1 &amp; 1.0.1 compatibility</h2><P>Date Written: 13-Feb-1992</P><P>Last reviewed: 5-Jun-1998</P><P>We have implemented a TCP/IP product using MacTCP Development Kitversion 1.1. If MacTCP version 1.0.1 is installed, will there be anycompatibility problems with our implementation.?</P><P>There are only a very few new calls in MacTCP 1.1 that aren't inthe 1.0.1 driver. Among these are:</P><UL>   <LI>Name resolver <CODE>HInfo</CODE> and <CODE>MXInfo</CODE> calls</li>      <LI>UDP multi-port sends and receives</li>   <LI>ICMP echo protocol support</li></UL><P>As long as you're not using any of these features, any programdeveloped for MacTCP 1.1 will work with 1.0.1.</P><h2>MacTCP 1.1 header file incompatibilities and fixes</h2><P>Date Written: 30-Sep-1991</P><P>Last reviewed: 5-Jun-1998</P><P>MacTCP 1.1, Apple's System 7-compatible version of MacTCP, fixesseveral problems in earlier releases, but doesn't address severalheader file incompatibilities. The latest MacTCP header (which haveall been rolled into a single file, "MacTCP.h") are available as partof <a href="http://developer.apple.com/sdk/">UniversalInterfaces</A>.</P><h2>No Pascal headers for MacTCP</h2><P>Date Written: 19-Mar-1992</P><P>Last reviewed: 5-Jun-1998</P><P>I want to access MacTCP in a Pascal program. Do you have the Cparameter block definitions available as Pascal records or will Ihave to do my own translation?</P><P>"MacTCP.p" is available as part of<a href="http://developer.apple.com/sdk/">Universal Interfaces</A>.However, programming MacTCP in Pascal is still a challenge because ofproblems compiling the "dnr.c" file and implementing C callbacks inPascal. Libraries and sample that show how to call MacTCP from Pascalare available from <A HREF = "http://www.stairways.com">StairwaysShareware</A>.  For more hints and tips about Pascal programming onMac OS, check out <A HREF = "http://www.pascal-central.com/">PascalCentral</A>.</P><h2>MacTCP Type of Service documentation fix</h2><P>Date Written: 21-Apr-1992</P><P>Last reviewed: 5-Jun-1998</P><P>Are MacTCP's Type Of Service (Reliability, Low Delay, andThroughput) bit settings swapped in the documentation?</P><P>The bit settings in the MacTCP programmer's documentation arereversed for the Type of Service constants. The bit settings shouldbe as follows:</P><TABLE BORDER=1 WIDTH=225>   <TR>      <td align="left">         <P><B>Type of Service Byte (3-bit field)</B></p>      </TD></TR>   <TR>      <td align="left">         <P>Bit 0 set for low delay</p>      </TD></TR>   <TR>      <td align="left">         <P>Bit 1 set for high reliability</p>      </TD></TR>   <TR>      <td align="left">         <P>Bit 2 set for high throughput</p>      </TD></TR></TABLE><P>If you wish to correct these settings they can be found on page 35of the <I>MacTCP Programmer's Guide</I>.</P><h2>MacTCP ULP timeout documentation fix</h2><P>Date Written: 5-May-1992</P><P>Last reviewed: 5-Jun-1998</P><P>In the MacTCP Developer's Kit (Version 1.1) there is a ULP timeoutaction field which is used in several PowerBook calls to MacTCP. Forsome calls, zero indicates an abort and nonzero indicates a report.<CODE>TCPSend</CODE>, <CODE>TCPClose</CODE> and<CODE>TCPStatus</CODE> are this way. For other calls, the reverse isdocumented (0 indicates report and 1 indicates abort).<CODE>TCPActiveOpen</CODE> and <CODE>TCPPassiveOpen</CODE> aredocumented this way. Can I believe the documentation or are thereerrors in it? If there are errors, what is the correct way it shouldbe ?</P><P>According to the MacTCP source code, you're right, thedocumentation is incorrect. For each of the calls with a ULP timeoutaction, the correct values are:</P><TABLE BORDER=1 WIDTH=150>   <TR>      <td width=39 align=left>         <P><B>Value</B></p>      </TD><td align="left">         <P><B>Action</B></p>      </TD></TR>   <TR>      <td width=39 align=left>         <P>1</p>      </TD><td align="left">         <P>abort</p>      </TD></TR>   <TR>      <td width=39 align=left>         <P>0</p>      </TD><td align="left">         <P>report only</P>      </TD></TR></TABLE><h2>Mac OS Communications Toolbox MacTCP tools</h2><P>Date Written: 6/10/92</P><P>Last reviewed: 5-Jun-1998</P><P>My application uses the Mac OS Communications Toolbox and ADSP toconnect to network services. What software do I need to get to makethe same connections using TCP/IP? MacTCP or other recommendations?</P><P>Apple only makes one MacTCP Communications Toolbox tool that worksspecifically with MacX and TCP/IP (the TCP Tool). This tool is notsupported for use by third party developers. For CTB/MacTCPconnection tools which are supported, you need to get a third-partyCTB MacTCP tool. These are available from several vendors. Forexample, TCPack from ASC (Advanced Software Concepts) is a set ofConnection Tools designed to allow simultaneous TCP/IP connectionsusing Apple's MacTCP driver. All Apple's terminal tools (asc3270,asc5250, etc.), the Apple standard terminal tools (TTY, VT100, VT320),as well as several third-party terminal tools can be used to enterterminal sessions with TCPack. TCP/Tools from InterCon Systems isanother package which allows you to use existing CTB applications tolog onto Unix workstations using your LocalTalk or EtherTalknetwork.</p><BR><P><A HREF="#top">Back to top</A></P><P><A NAME=Downloads></A></P>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (64K)</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/nw_550.pdf">Download</A></P>               </TD>            </TR>                     </TABLE>         <BR>         <P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/nw/nw_550.html%3Fid%3DDTS10002580-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/nw/nw_550.html%3Fid%3DDTS10002580-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/nw/nw_550.html%3Fid%3DDTS10002580-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>