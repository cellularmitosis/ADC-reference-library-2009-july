<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!-- Template 03-24-01 --><!--Includes revisions to code listings--><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note DV10: Monitor Depth : Gimmie Depth Or Gimmie Death</title><meta name="keywords" content="Mac OS 8 monitor depth SetDepth HasDepth gdFlags"><meta name="Description" content="Technical Note DV10:  This Technical Note describes two systemcalls, SetDepth which allows an application to change thedepth and flags for a given device, and HasDepth which checkswhether a device supports a particular depth and flags setting.Technical Note includes short discussion on when and howan application should change the system screen settings.">                                      <meta name="categories" content="Devices"><meta name="week-posted" content="Mar 26, 1990 - Apr 6, 1990"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002400" title="Monitor Depth : Gimmie Depth Or Gimmie Death"></a><A NAME="top"></A><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxGraphicsImaging-date.html">Graphics & Imaging</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/GraphicsImaging/idxHardwareDrivers-date.html" target="_blank">Graphics & Imaging > Hardware & Drivers</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note DV10</div>
<div id="pageheadsub">Monitor Depth : Gimmie Depth Or Gimmie Death</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                   <td background="images/tnmenubody.gif" width=300 align=left>                        <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->					<p id="menutext"><a href="#Section1">Historic Novella</a><BR><BR><a href="#Section2">The Calls</a><BR><BR><a href="#references">References</a><BR><BR><a href="#changes">Change History</a><BR><BR><A href="#downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>		<td width=300 valign="top" align=left>	<!-- begin_intro_text --><P id = "introtext">This Technical Note describes two new system calls that allow an application tochange the depth and flags for a given device and also check whether a devicesupports a particular depth and flags setting.  Apple provides these calls togive developers a better way to help <b>users</b> make changes when theyconsider it appropriate.  Abusive use of these calls is a sure way to guaranteethat the Thought Police come after you to confiscate your Macintoshes, yourstock of Mountain Dew&reg;, and your Technical Notes binder.  This Note assumesfamiliarity with <i>Inside Macintosh</i>, Volume V, Graphics Devices.</p><!-- end_intro_text --><!-- begin_date --><h3>Updated: [April 01 1990]</h3><!-- end_date -->                </TD>             </TR>          </TABLE> <!-- end_header_box --><BR><BR><hr width=500 align=center><BR><BR><!-- begin_content --><a name="Section1"></a><h2>Historic Novella</h2><p>Since the introduction of the Macintosh II, developers have had the strong urgeto change the depth of Macintosh screens under program control.  Developersoften ask, "How can I change the depth from my application like the Monitorscdev does?"  The reasons for this question have varied from pure Macintoshhacking spirit to valid reasons to the lack of finding a good solution whichwould work regardless of the depth setting the user may choose.</p><p>A poor scenario occurs when a developer wants to impose a certain depth andcolor or black and white setting because the application does not work well, ifat all, with any other configuration.  The responses from DTS always includequestions about what happens to the application when the system in use does notsupport this "optimal" configuration or when one monitor is set to the magicconfiguration, but others are not, or when the user brings the application tothe front and it finds that the user has changed the setting to something withwhich it is not equipped to deal.</p><p>On the other hand, DTS does see situations where an application that deals withcertain image types may work better with a particular setting and would like topresent the user with a dialog box similar to the Monitors cdev to allow theuser to change the depth and color settings from within the application.</p><p>Not everyone agrees on the wisdom of providing facilities for an application toallow users to change depth and color settings from within itself, but allagree that a well-behaved application (remembering that well-behavedapplications are more likely to survive system and hardware changes) shouldonly change depth and color settings in the following circumstances:</p><ul type="disc">	<li>Depth changes can <b>only</b> be made with the user's consent; never change depths because it is simply convenient for the application.  The user paid for his system and if the user wants color, be prepared to give color.  If the user wants millions of colors, don't change the display to one-bit black and white.<BR><BR></li>	<li>The minimal amount of user input to change depth and color settings should be to provide a preferences dialog box where the user would be given a yes or no choice to change depths when a particular action is chosen.  The application should make the "no" choice the default and have a sensible mechanism for handling the situation when the user chooses no.<BR><BR></li>	<li>Under <b>no</b> condition should an application change depth or color settings while in the background.  An application should only initiate depth or color changes when it is the frontmost application; do not twiddle with the user's settings while in the background.<BR><BR></li></ul>  <P><A HREF="#top">Back to top</A></P>  <a name="Section2"></a><h2>The Calls</h2><p>Beginning with System Software 6.0.5 (regardless of whether or not 32-BitQuickDraw is installed), applications can make a call to <code>SetDepth</code> tochange the depth and flag settings for a given device.</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>FUNCTION SetDepth(gd:GDHandle; newDepth,whichFlags, newFlags: Integer):Integer;    INLINE $203C,$000A, $0013,$AAA2; { Move.L #$000A0013,D0                                      _PMgrDispatch                                    }pascal short SetDepth(GDHandle gd, short  newDepth,short whichFlags, short newFlags)                      = {0x203C, 0x000A, 0x0013, 0xAAA2};</pre>	</TD></TR></TABLE></CENTER><p>Where <code>gd</code> is the device to be changed, <code>newDepth</code> is the desireddepth (you can pass the bit depth or the mode necessary to set the requesteddepth,) <code>whichFlags</code> is a bit field selector specifying which bits in<code>newFlags</code> are meaningful, and <code>newFlags</code> are bits to be set inthe <code>gdFlags</code> field of the device record as specified by <code>whichFlags</code>.  For example, if you want to set a depth of eight in black and white, the call would be as follows:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>        someResult := SetDepth(myGDevice,8,1,0);</pre>	</TD></TR></TABLE></CENTER><p>In this call, <code>newDepth = 8</code> sets an eight-bit depth, <code>whichFlags =1</code> indicates that only bit one of <code>newFlags</code> is important, and<code>newFlags = 0</code> clears the <code>gdDevType</code> flag in the device record(0 = monochrome, 1 = color).  <code>SetDepth</code> returns zero if successful or anon-zero value if it cannot impose the desired depth on the requested device.</p><p>Also beginning with System Software 6.0.5, applications can make a call to<code>HasDepth</code> to verify if a given device supports a mode for the desireddepth.</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>FUNCTION HasDepth(gd:GDHandle; newDepth,whichFlags, newFlags: Integer):Integer;    INLINE $203C,$000A $0014,$AAA2; { Move.L #$000A0014,D0                                      _PMgrDispatch                                    }pascal short HasDepth(GDHandle gd, short  newDepth,short whichFlags, short newFlags)                      = {0x203C,0x000A 0x0014,0xAAA2};</pre>	</TD></TR></TABLE></CENTER><p>Where <code>gd</code> is the device to be verified, <code>newDepth</code> is thedesired depth, <code>whichFlags</code> is a bit field selector specifying whichbits in <code>newFlags</code> are meaningful, and <code>newFlags</code> are bits to bechecked in the <code>gdFlags</code> field of the device record as specified by<code>whichFlags</code>.  <code>HasDepth</code> returns zero if the desired depth orflag setting is not supported on the given device; otherwise, <code>HasDepth</code>returns the <code>mode</code> necessary to set the device to the desired depth(which may be passed as the <code>newDepth</code> parameter in a call to <code>SetDepth</code>).</p><a name="references"></a><h2>References</h2><P><i>Inside Macintosh</i>, Volume V, Graphics Devices</p><P><i>Designing Cards and Drivers for the Macintosh Family</i>, Second Edition</p><p>Mountain Dew is a registered trademark of Pepsico, Inc.</p><P><A HREF="#top">Back to top</A></P><a name="changes"></a><h2>Change History</h2> <TABLE BORDER=0 CELLPADDING=3 WIDTH=544>   <TR>               <td width=100 align=left>                  <P ALIGN=center>01-February-1990</P>               </TD>               <td align="left">                  <P>Originally written.</P>               </TD>            </TR>         <TR>               <td width=100 align=left>                  <P ALIGN=center>01-April-1990</P>               </TD>               <td align="left">                  <P>Corrected trap addresses and dispatch numbers inthe <code>SetDepth</code> and <code>GetDepth</code> definitions.</P>               </TD>            </TR></table><P><A HREF="#top">Back to top</A></P>         <a name="downloads"></a>         <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center>                                    <img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (64K)</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/dv_10.pdf">Download</A></P>               </TD>            </TR>         </TABLE>         <BR>                  <P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/dv/dv_10.html%3Fid%3DDTS10002400-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/dv/dv_10.html%3Fid%3DDTS10002400-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/dv/dv_10.html%3Fid%3DDTS10002400-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>