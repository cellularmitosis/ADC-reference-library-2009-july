<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>OSAScriptError(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING353></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-352.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-354.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-331.html"><B>Chapter 10 - Scripting Components</B></A> / <A HREF="IAC-344.html"><B>Scripting Components Reference</B></A><BR><DL><DD><A HREF="IAC-346.html"><B>Required Scripting Component Routines</B></A> / <A HREF="IAC-350.html"><B>Executing and Disposing of Scripts</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING353-0></A>
<H3><A NAME=MARKER-9-181></A>OSAScriptError</H3>
 You can use the <CODE>OSAScriptError</CODE> function to get information about errors that occur during script execution.<A NAME=MARKER-2-182></A><P>
<PRE>
FUNCTION OSAScriptError(scriptingComponent: ComponentInstance;
                        selector: OSType;
                        desiredType: DescType;
                        VAR resultingErrorDescription: AEDesc)
                        : OSAError;
</PRE>
<DL>
<DT><CODE>scriptingComponent</CODE>
<DD> A component instance created by a prior call to the Component Manager function <CODE>OpenDefaultComponent</CODE> or <CODE>OpenComponent</CODE> (see <A HREF=IAC-332.html#MARKER-9-76>page 10-4</A>).
<DT><CODE>selector</CODE>
<DD> A value that determines what <CODE>OSAScriptError</CODE> returns. The value can be one of these constants: <A NAME=MARKER-2-404></A>
</DL>
<PRE>
            CONST
               kOSAErrorNumber            = 'errn';
               kOSAErrorMessage           = 'errs';
               kOSAErrorBriefMessage      = 'errb';
               kOSAErrorApp               = 'erap';
               kOSAErrorPartialResult     = 'ptlr';
               kOSAErrorOffendingObject   = 'erob';
               kOSAErrorRange             = 'erng';
</PRE>
<DL>
<DT><CODE>desiredType</CODE>
<DD> The desired descriptor type of the resulting descriptor record. The description that follows explains how this is determined by the value passed in the <CODE>selector</CODE> parameter. 
<DT><CODE>resultingErrorDescription</CODE>
<DD> The resulting descriptor record.
</DL>
<A NAME=HEADING353-8></A>
<H5>DESCRIPTION</H5>
 Whenever the <CODE>OSAExecute</CODE> function returns the error <CODE>errOSAScriptError</CODE>, you can use the <CODE>OSAScriptError</CODE> function to get more specific information about the error from the scripting component that encountered it. (This information remains available only until the next call to the same scripting component.) The information returned by <CODE>OSAScriptError</CODE> depends on the value passed in the <CODE>selector</CODE> parameter, which also determines the descriptor type you should specify in the <CODE>desiredType</CODE> parameter.
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Constant<TH>Information returned in <CODE>resultingErrorDescription</CODE> parameter<TR>
<TD>kOSAErrorNumber<TD>Error number for either system error or scripting component error. The value of <CODE>desiredType</CODE> must be <CODE>typeShortInteger</CODE>. <A NAME=MARKER-8-169></A><TR>
<TD>kOSAErrorMessage<TD>Error message associated with error number, including both the name of the application and a description of the error. This constant is sufficient for simple error reporting. The value of <CODE>desiredType</CODE> must be <CODE>typeChar</CODE> or another text descriptor type. <A NAME=MARKER-21-68></A><TR>
<TD>kOSAErrorBriefMessage<TD>Brief error message associated with error number, excluding the name of the application, any partial result, and the offending object. The value of <CODE>desiredType</CODE> must be <CODE>typeChar</CODE> or another text descriptor type. <A NAME=MARKER-2-81></A><TR>
<TD>kOSAErrorApp<TD>Either the name or the process serial number (PSN) of the application that received the error, if it was the result of sending an Apple event. The value of<CODE> desiredType</CODE> must be <CODE>typeProcessSerialNumber</CODE> (for the PSN) or a text descriptor type such as <CODE>typeChar</CODE> (for the name). <A NAME=MARKER-21-88></A><TR>
<TD>kOSAErrorPartialResult<TD>Partial result returned after a call to <CODE>AESend</CODE> that failed. This consists of a reply parameter that contains some but not all of the information requested.The value of <CODE>desiredType</CODE> must be <CODE>typeBest</CODE> (for the best type) or <CODE>typeWildCard</CODE> (for the default type). <A NAME=MARKER-6-174></A><TR>
<TD>kOSAErrorOffendingObject<TD>An object specifier record for the object that caused the error. The value of <CODE>desiredType</CODE> must be <CODE>typeObjectSpecifier</CODE>, <CODE>typeBest</CODE>, or <CODE>typeWildCard</CODE>. For some scripting components, including AppleScript, these three values are equivalent. <A NAME=MARKER-2-103></A><TR>
<TD>kOSAErrorRange<TD>Range of source data in which error occurred. The value of <CODE>desiredType</CODE> must be <CODE>typeOSAErrorRange</CODE>. <A NAME=MARKER-21-109></A></TABLE>
 <A NAME=MARKER-2-357></A><P>
 Every scripting component should support calls to <CODE>OSAScriptError</CODE> that pass <CODE>kOSAErrorNumber</CODE>, <CODE>kOSAErrorMessage</CODE>, or <CODE>kOSAErrorPartialResult</CODE> in the <CODE>selector</CODE> parameter. <P>
 Some scripting components may also support calls that pass other values in the <CODE>selector</CODE> parameter, including <CODE>kOSAErrorRange</CODE>, which provides start and end positions delimiting the errant expression in the source data. If the value of the selector parameter is <CODE>kOSAErrorRange</CODE>, the value of <CODE>desiredType</CODE> must be <CODE>typeOSAErrorRange</CODE>. <A NAME=MARKER-2-185></A><P>
<PRE>
CONST typeOSAErrorRange          = 'erng';
</PRE>
 A descriptor record of type <CODE>typeOSAErrorRange</CODE> is an AE record that consists of two descriptor records of <CODE>typeShortInteger</CODE> specified by these keywords:<P>
<PRE>
CONST
   keyOSASourceStart    = 'srcs'; {start of error range}
   keyOSASourceEnd      = 'srce'; {end of error range}
</PRE>
 <A NAME=MARKER-2-186></A>If the value of the <CODE>selector</CODE> parameter is kOSAErrorNumbe<CODE>r</CODE>, scripting components may return, in the <CODE>resultingErrorDescription</CODE> parameter, one of these general error codes: 
<TABLE BORDER="0" CELLPADDING=3><TD>errOSACantCoerce<TD>-1700<TD>Same as <CODE>errAECoercionFail</CODE>; can't coerce data to requested descriptor type<TR>
<TD>errOSACantAccess<TD>-1728<TD>Same as <CODE>errAENoSuchObject</CODE>; runtime error in resolution of object specifier record<TR>
<TD>errOSAGeneralError<TD>-2700<TD>General runtime error <TR>
<TD>errOSADivideByZero<TD>-2701<TD>Attempt to divide by zero<TR>
<TD>errOSANumericOverflow<TD>-2702<TD>Numeric overflow<TR>
<TD>errOSACantLaunch<TD>-2703<TD>Can't launch specified file because it isn't an application<TR>
<TD>errOSAAppNotHighLevelEventAware<TD>-2704<TD>Doesn't respond to Apple events<TR>
<TD>errOSACorruptTerminology<TD>-2705<TD>The application has a corrupted <CODE>'aete'</CODE> resource<TR>
<TD>errOSAStackOverflow<TD>-2706<TD>Stack overflow<TR>
<TD>errOSAInternalTableOverflow<TD>-2707<TD>Internal table overflow <TR>
<TD>errASDataBlockTooLarge<TD>-2708<TD>Attempt to create a value larger than the allowable size<TR>
<TD>errOSATypeError<TD>-1703<TD>Same as <CODE>errAEWrongDataType</CODE>; wrong descriptor type<TR>
<TD>errOSAMessageNotUnderstood<TD>-1708<TD>Same as <CODE>errAEEventNotHandled</CODE>; event not handled or message not understood<TR>
<TD>errOSAUndefinedMessage<TD>-1717<TD>Same as <CODE>errAEHandlerNotFound</CODE>; handler not found for message<TR>
<TD>errOSAIllegalIndex<TD>-1728<TD>Same as <CODE>errAEIllegalIndex</CODE>; not a valid index<TR>
<TD>errOSAIllegalRange<TD>-2720<TD>Same as errAEImpossibleRange; range of specified objects not possible<TR>
<TD>errOSASyntaxError<TD>-2740<TD>General syntax error<TR>
<TD>errOSASyntaxTypeError<TD>-2741<TD>Syntax error; parser expected one type but found another<TR>
<TD>errOSATokenTooLong<TD>-2742<TD>Identifier too long<TR>
<TD>&nbsp;<TD>&nbsp;<TD>&nbsp;<TR>
<TD>errOSAMissingParameter<TD>-1701<TD>Same as <CODE>errAEDescNotFound</CODE>; descriptor record not found<TR>
<TD>errOSAParameterMismatch<TD>-1721<TD>Same as <CODE>errAEWrongNumberArgs</CODE>; wrong number of arguments<TR>
<TD>errOSADuplicateParameter<TD>-2750<TD>Parameter specified more than once<TR>
<TD>errOSADuplicateProperty<TD>-2751<TD>Property specified more than once<TR>
<TD>errOSADuplicateHandler<TD>-2752<TD>Handler defined more than once<TR>
<TD>errOSAUndefinedVariable<TD>-2753<TD>Undefined variable<TR>
<TD>errOSAInconsistentDeclarations<TD>-2754<TD>Inconsistent declarations<TR>
<TD>errOSAControlFlowError<TD>-2755<TD>Control flow error</TABLE>
<P>
 Although scripting components are not required to support these error codes, their use simplifies error handling for applications that run scripts created by multiple components. <A NAME=MARKER-2-187></A><P>
 <A NAME=MARKER-2-188></A>If the value of the <CODE>selector</CODE> parameter is kOSAErrorNumber, the AppleScript component may return, in the <CODE>resultingErrorDescription</CODE> parameter, one of these error codes:
<TABLE BORDER="0" CELLPADDING=3><TD>errAECantConsiderAndIgnore<TD>-2720<TD>Can't both consider and ignore a parameter<TR>
<TD>errASCantCompareMoreThan32k<TD>-2721<TD>Can't compare text larger than 32K <TR>
<TD>errASCantCompareMixedScripts<TD>-2722<TD>Can't compare text from different script systems<TR>
<TD>errASTerminologyNestingTooDeep<TD>-2760<TD>Tell statements nested too deeply<TR>
<TD>errASInconsistentNames<TD>-2780<TD>Syntax error; names at beginning and end of handler are inconsistent (AppleScript English dialect only) <A NAME=MARKER-2-67></A></TABLE>
<P>
<A NAME=HEADING353-18></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 If you call <CODE>OSAScriptError</CODE> using an instance of the generic scripting component, the generic scripting component uses the same instance of a scripting component that it used for the previous call.<P>
<A NAME=HEADING353-20></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>errOSACantCoerce<TD>-1700<TD>Desired type not supported by scripting component<TR>
<TD>errOSASystemError<TD>-1750<TD>General scripting system error<TR>
<TD>errOSABadSelector<TD>-1754<TD>Selector value not supported by scripting component <A NAME=MARKER-9-1></A><TR>
<TD>badComponentInstance<TD>$80008001<TD>Invalid component instance</TABLE>
</H5>
<A NAME=HEADING353-21></A>
<H5>SEE ALSO</H5>
 For an example of the use of <CODE>OSAScriptError</CODE>, see <A HREF=IAC-334.html#MARKER-9-96>Listing 10-3 on page 10-11</A>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-352.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-354.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
