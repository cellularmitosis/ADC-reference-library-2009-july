<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>OSAExecuteEvent(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING393></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-392.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-394.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-331.html"><B>Chapter 10 - Scripting Components</B></A> / <A HREF="IAC-344.html"><B>Scripting Components Reference</B></A><BR><DL><DD><A HREF="IAC-361.html"><B>Optional Scripting Component Routines</B></A> / <A HREF="IAC-390.html"><B>Using Script Contexts to Handle Apple Events</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING393-0></A>
<H3>OSAExecuteEvent</H3>
 You can use the <CODE>OSAExecuteEvent</CODE> function to handle an Apple event with the aid of a script context and obtain a script ID for the resulting script value.<A NAME=MARKER-2-256></A><P>
<PRE>
FUNCTION OSAExecuteEvent(scriptingComponent: ComponentInstance;
                         theAppleEvent: AppleEvent;
                         contextID: OSAID;
                         modeFlags: LongInt;
                         VAR resultingScriptValueID: OSAID)
                         : OSAError;
</PRE>
<DL>
<DT><CODE>scriptingComponent</CODE>
<DD> A component instance created by a prior call to the Component Manager function <CODE>OpenDefaultComponent</CODE> or <CODE>OpenComponent</CODE> (see <A HREF=IAC-332.html#MARKER-9-76>page 10-4</A>).
<DT><CODE>theAppleEvent</CODE>
<DD> The Apple event to be handled.
<DT><CODE>contextID</CODE>
<DD> The script ID for the script context to be used to handle the Apple event.
<DT><CODE>modeFlags</CODE>
<DD> Information used by individual scripting components. To avoid setting any mode flags, specify <CODE>kOSAModeNull</CODE>. Other possible mode flags are listed in the description that follows.
<DT><CODE>resultingScriptValueID</CODE>
<DD> A script ID for the resulting script value.
</DL>
<A NAME=HEADING393-8></A>
<H5>DESCRIPTION</H5>
 The <CODE>OSAExecuteEvent</CODE> function attempts to use the script context specified by the <CODE>contextID</CODE> parameter to handle the Apple event specified by the <CODE>theAppleEvent</CODE> parameter. If the scripting component determines that the script context can't handle the event (for example, if a script written in AppleScript doesn't include statements that handle the event), <CODE>OSAExecuteEvent</CODE> immediately returns <CODE>errAEEventNotHandled</CODE> rather than <CODE>errOSAScriptError</CODE>.<P>
 If the scripting component determines that the script context can handle the event, <CODE>OSAExecuteEvent</CODE> executes the script context's handler and returns the resulting script ID. If execution of the script context's handler for the event generates an error, <CODE>OSAExecuteEvent</CODE> returns <CODE>errOSAScriptError</CODE>, and you can get more detailed error information by calling the <CODE>OSAScriptError</CODE> function.<P>
 You can control the way in which the scripting component executes a script context by adding any of these flags to the <CODE>modeFlags</CODE> parameter:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Flag<TH>Description<TR>
<TD>kOSAModeNeverInteract<TD>Adds <CODE>kAENeverInteract</CODE> to <CODE>sendMode</CODE> parameter of <CODE>AESend</CODE> for events sent when script is executed.<TR>
<TD>kOSAModeCanInteract<TD>Adds <CODE>kAECanInteract</CODE> to <CODE>sendMode</CODE> parameter of <CODE>AESend</CODE> for events sent when script is executed.<TR>
<TD>kOSAModeAlwaysInteract<TD>Adds <CODE>kAEAlwaysInteract</CODE> to <CODE>sendMode</CODE> parameter of <CODE>AESend</CODE> for events sent when script is executed.<TR>
<TD>kOSAModeCantSwitchLayer<TD>Prevents use of <CODE>kAECanSwitchLayer</CODE> in <CODE>sendMode</CODE> parameter of <CODE>AESend</CODE> for events sent when script is executed (the opposite of the Apple Event Manager's interpretation of the same bit).<TR>
<TD>kOSAModeDontReconnect<TD>Adds <CODE>kAEDontReconnect</CODE> to <CODE>sendMode</CODE> parameter of <CODE>AESend</CODE> for events sent when script is executed.<TR>
<TD>kOSAModeDoRecord<TD>Prevents use of <CODE>kAEDontRecord</CODE> in <CODE>sendMode</CODE> parameter of <CODE>AESend</CODE> for events sent when script is executed (the opposite of the Apple Event Manager's interpretation of the same bit).</TABLE>
<P>
 If the script context identified by the <CODE>contextID</CODE> parameter specifies that the Apple event should be passed to the application's default handler for that event (for example, with an AppleScript <CODE>continue</CODE> statement), <CODE>OSAExecuteEvent</CODE> passes the event to the resume dispatch function currently being used by the scripting component. The resume dispatch function dispatches the event directly to the application's standard handler for that event (that is, without calling <CODE>OSAExecuteEvent</CODE> again). If the <CODE>contextID</CODE> parameter is <CODE>kOSANullScript</CODE>, the <CODE>OSAExecuteEvent</CODE> function passes the event directly to the resume dispatch function. If a call to the resume dispatch function is successful, execution of the script context proceeds from the point at which the resume dispatch function was called.<P>
<DL>
<DT><B>IMPORTANT</B>
<DD>The <CODE>OSAExecuteEvent</CODE> function can generate the result code <CODE>errAEEventNotHandled</CODE> in at least two ways. If the scripting component determines that a script context doesn't declare a handler for a particular event, <CODE>OSAExecuteEvent</CODE> immediately returns <CODE>errAEEventNotHandled</CODE>. If a scripting component calls its resume dispatch function during script execution and the application's standard handler for the event fails to handle it, <CODE>OSAExecuteEvent</CODE> returns <CODE>errOSAScriptError</CODE> and a call to <CODE>OSAScriptError</CODE> with <CODE>kOSAErrorNumber</CODE> in the <CODE>selector</CODE> parameter returns <CODE>errAEEventNotHandled</CODE> as the resulting error description.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
<A NAME=HEADING393-14></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>errAEEventNotHandled<TD>-1708<TD>Script context doesn't contain handler for event<TR>
<TD>errOSASystemError<TD>-1750<TD>General scripting system error<TR>
<TD>errOSAInvalidID<TD>-1751<TD>Invalid script ID<TR>
<TD>errOSAScriptError<TD>-1753<TD>Error occurred during execution or because of an attempt to pass event to a <CODE>NIL</CODE> resume dispatch function<TR>
<TD>badComponentInstance<TD>$80008001<TD>Invalid component instance<A NAME=MARKER-2-346></A></TABLE>
</H5>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-392.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-394.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
