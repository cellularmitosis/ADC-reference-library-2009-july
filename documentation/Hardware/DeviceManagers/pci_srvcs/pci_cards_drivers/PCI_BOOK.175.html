<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE> Interrupt Source Tree Construction</TITLE></HEAD><BODY BGCOLOR="#ffffff"><DIV><a name="top"></a><!-- start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!-- start of path --><font face="Geneva,Helvetica,Arial" size="1"><b><br>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Documentation</a> &gt; <!-- a href="" target="_top" -->Hardware<!-- /a -->  <b>&gt; </b><a href="../../devicemgrs.html" target="_top">Device Managers and Drivers</a> <b>&gt; </b><a href="../pci_srvcs.html" target="_top">PCI Card Services</a> <b>&gt; </b>Designing PCI Cards and Drivers for Power Macintosh Computers</font><br><br><!-- end of path --><A HREF="PCI_BOOK.16b.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.174.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.176.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><HR></DIV><H1 CLASS="H2.Heading2"><A NAME="pgfId=4246"> </A><A NAME="10277"> </A>Interrupt Source Tree Construction</H1><P CLASS="T1.Text1"><A NAME="pgfId=4247"> </A>The Mac&nbsp;OS startup process automatically performs the initial construction and maintenance of the IST for all built-in I/O ASICs, PCI expansion cards, and PCI-to-PCI bridges that use the default PCI bridge IST extensions.</P><DIV><blockquote><p CLASS="NoteHead"><b><A NAME="pgfId=19143"> </A>Note</b></p><P CLASS="Note"><A NAME="pgfId=4248"> </A>Expansion card developers normally have no need to construct the IST but may need to extend it as described in <A HREF="PCI_BOOK.17a.html#28789" CLASS="XRef">Explicit IST Extension</A>. The following description of the initial construction process is included for completeness. </P></blockquote><P CLASS="T1.Text1"><A NAME="pgfId=4255"> </A>The interrupt tree is constructed by creating new sets of child members under existing child members, which thus become parent members. The preexisting root member is used as the parent member for the first layer of the tree. As each new child member is created, a null ISR is installed and its IER and IDR routines are inherited from the parent. If built-in interrupt controller hardware can enable and disable interrupts for each of the interrupt members in the new interrupt set, IERs and IDRs tailored to each interrupt member are installed. When a child member becomes a parent member, a transversal ISR is installed on top of the null ISR for dispatching its child members. This process is repeated for as many layers and IST members as required. Typically, the default IST originally created services all the fixed hardware devices and slots on the Power Macintosh main logic board.</P><P CLASS="T1.Text1"><A NAME="pgfId=4256"> </A>Having child members inherit their parents' IERs and IDRs allows devices that don't have hardware enabling and disabling support to still use IER and IDR functions. Invoking an IER or IDR for such a device will transparently invoke the parent member's IER or IDR. At some point up the interrupt tree, main logic board hardware will physically enable or disable interrupts intended for the device.</P></DIV><DIV><blockquote><p CLASS="ImportantHead"><b><A NAME="pgfId=19145"> </A>IMPORTANT</b></p><P CLASS="I.Important"><A NAME="pgfId=4257"> </A>Default enablers, disablers, and transversal ISRs for all Macintosh built-in I/O devices are provided and installed by Apple I/O family experts. Drivers that use the family expert APIs are more portable and are more likely to be compatible with future Apple products. </P></blockquote></DIV><DIV><blockquote><p CLASS="WarningHead"><b><A NAME="pgfId=19147"> </A>WARNING</b></p><P CLASS="W.Warning"><A NAME="pgfId=4261"> </A>The Apple built-in handlers can be overridden by other software. However, built-in interrupt enablers, disablers, and transversal ISRs are very specific to the hardware platform. Detailed knowledge of the built-in interrupt controller hardware is required to successfully override one. </P></blockquote></DIV><HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 26 March 99)<P><A HREF="PCI_BOOK.16b.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.174.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.176.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></HTML>