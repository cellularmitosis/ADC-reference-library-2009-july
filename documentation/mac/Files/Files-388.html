<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Summary of the Disk Initialization Manager (IM: F)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING388></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Files-387.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-389.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Files-2.html"><B>Files</B></A> / <BR><DD><A HREF="Files-367.html"><B>Chapter 5 - Disk Initialization Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING388-0></A>
<H1>Summary of the Disk Initialization Manager</H1>
<A NAME=HEADING388-1></A>
<H2>Pascal Summary</H2>
<A NAME=HEADING388-2></A>
<H3>Data Types</H3>
<A NAME=HEADING388-3></A>
<H4>HFS Defaults Record</H4>
<PRE>
TYPE HFSDefaults =
RECORD
   sigWord:    PACKED ARRAY[0..1] OF Byte;   {signature word}
   abSize:     LongInt;                      {allocation block size in bytes}
   clpSize:    LongInt;                      {clump size in bytes}
   nxFreeFN:   LongInt;                      {next free file number}
   btClpSize:  LongInt;                      {B*-tree clump size in bytes}
   rsrv1:      Integer;                      {reserved}
   rsrv2:      Integer;                      {reserved}
   rsrv3:      Integer;                      {reserved}
END;
</PRE>
<A NAME=HEADING388-5></A>
<H3>Routines</H3>
<A NAME=HEADING388-6></A>
<H4>Loading and Unloading the Disk Initialization Manager</H4>
<PRE>
PROCEDURE DILoad;
PROCEDURE DIUnload;
</PRE>
<A NAME=HEADING388-9></A>
<H4>Initializing a Disk</H4>
<PRE>
FUNCTION DIBadMount		(where: Point; evtMessage: LongInt): Integer;
</PRE>
<A NAME=HEADING388-11></A>
<H4>Low-Level Disk-Initialization Routines</H4>
<PRE>
FUNCTION DIFormat		(drvNum: Integer): OSErr;
FUNCTION DIVerify		(drvNum: Integer): OSErr;
FUNCTION DIZero			(drvNum: Integer; volName: Str255): OSErr;
</PRE>
<A NAME=HEADING388-15></A>
<H2>C Summary</H2>
<A NAME=HEADING388-16></A>
<H3>Data Types</H3>
<A NAME=HEADING388-17></A>
<H4>HFS Defaults Record</H4>
<PRE>
struct HFSDefaults {
      char        sigWord[2];    /*signature word*/
      long        abSize;        /*allocation block size in bytes*/
      long        clpSize;       /*clump size in bytes*/
      long        nxFreeFN;      /*next free file number*/
      long        btClpSize;     /*B-Tree clump size in bytes*/
      short       rsrv1;         /*reserved*/
      short       rsrv2;         /*reserved*/
      short       rsrv3;         /*reserved*/
};
typedef struct HFSDefaults HFSDefaults;
</PRE>
<A NAME=HEADING388-20></A>
<H3>Routines</H3>
<A NAME=HEADING388-21></A>
<H4>Loading and Unloading the Disk Initialization Package</H4>
<PRE>
pascal void DILoad	(void);
pascal void DIUnload	(void);
</PRE>
<A NAME=HEADING388-24></A>
<H4>Initializing a Disk</H4>
<PRE>
pascal short DIBadMount	(Point where, long evtMessage);
</PRE>
<A NAME=HEADING388-26></A>
<H4>Low-Level Disk-Initialization Routines</H4>
<PRE>
pascal OSErr DIFormat	(short drvNum);
pascal OSErr DIVerify	(short drvNum);
pascal OSErr DIZero	(short drvNum, const Str255 volName);
</PRE>
<A NAME=HEADING388-30></A>
<H2>Assembly-Language Summary</H2>
<A NAME=HEADING388-31></A>
<H3>Data Structures</H3>
<A NAME=HEADING388-32></A>
<H4><CODE>HFSDefaults</CODE> Data Structure
<TABLE BORDER="0" CELLPADDING=3><TD>0<TD><CODE>sigWord</CODE><TD>word<TD>signature word<TR>
<TD>2<TD><CODE>abSize</CODE><TD>long<TD>allocation block size in bytes<TR>
<TD>6<TD><CODE>clpSize</CODE><TD>long<TD>clump size in bytes<TR>
<TD>10<TD><CODE>nxFreeFN</CODE><TD>long<TD>next free file number<TR>
<TD>14<TD><CODE>btClpSize</CODE><TD>long<TD>B*-tree clump size in bytes<TR>
<TD>18<TD><CODE>rsrv1</CODE><TD>word<TD>reserved<TR>
<TD>20<TD><CODE>rsrv2</CODE><TD>word<TD>reserved<TR>
<TD>22<TD><CODE>rsrv3</CODE><TD>word<TD>reserved</TABLE>
</H4>
<A NAME=HEADING388-33></A>
<H3>Trap Macros</H3>
<A NAME=HEADING388-34></A>
<H4>Trap Macro Requiring Routine Selectors</H4>
<PRE>
<CODE>_Pack2<A NAME=MARKER-2-110></A> </CODE>
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Selector<TH>Routine<TR>
<TD>$0000<TD><CODE>DIBadMount</CODE><TR>
<TD>$0002<TD><CODE>DILoad</CODE><TR>
<TD>$0004<TD><CODE>DIUnload</CODE><TR>
<TD>$0006<TD><CODE>DIFormat</CODE><TR>
<TD>$0008<TD><CODE>DIVerify</CODE><TR>
<TD>$000A<TD><CODE>DIZero</CODE></TABLE>

</PRE>
<A NAME=HEADING388-36></A>
<H3>Global Variables
<TABLE BORDER="0" CELLPADDING=3><TD>FmtDefaults<TD>long<TD>Pointer to substitute values for hierarchical volume directories.</TABLE>
</H3>
<A NAME=HEADING388-37></A>
<H2>Result Codes<CODE>
<TABLE BORDER="0" CELLPADDING=3><TD>[no name]<TD>2<TD>Disk in specified drive is already mounted<TR>
<TD>[no name]<TD>1<TD>User canceled initializing<TR>
<TD>noErr<TD>0<TD>No error<TR>
<TD>ioErr<TD>-36<TD>I/O error<TR>
<TD>paramErr<TD>-50<TD>Drive number specified is bad<TR>
<TD>volOnLinErr<TD>-55<TD>Volume is already online<TR>
<TD>nsDrvErr<TD>-56<TD>No such drive<TR>
<TD>noMacDskErr<TD>-57<TD>Disk is not a Macintosh disk<TR>
<TD>extFSErr<TD>-58<TD>Disk has external file system<TR>
<TD>badMDBErr<TD>-60<TD>Master directory block is bad<TR>
<TD>lastDskErr<TD>-64<TD>Last of the range of low-level disk errors<TR>
<TD>firstDskErr<TD>-84<TD>First of the range of low-level disk errors<TR>
<TD>memFullErr<TD>-108<TD>Not enough memory</TABLE>
</CODE></H2>
 <CODE><A NAME=MARKER-2-111></A></CODE><P>
</BLOCKQUOTE><P>

</BLOCKQUOTE>
<HR>
<center>
<A HREF="Files-387.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-389.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Files-3.html">&copy; Apple Computer, Inc.</A><br>2 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
