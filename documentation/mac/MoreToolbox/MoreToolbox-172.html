<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>HMGetHelpMenuHandle (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING172></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-171.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-173.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-138.html"><B>Chapter 3 - Help Manager</B></A> / <A HREF="MoreToolbox-157.html"><B>Help Manager Reference</B></A><BR><DL><DD><A HREF="MoreToolbox-161.html"><B>Help Manager Routines </B></A> / <A HREF="MoreToolbox-171.html"><B>Adding Items to the Help Menu</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING172-0></A>
<H3>HMGetHelpMenuHandle</H3>
 To append items to the Help menu, use the <CODE>HMGetHelpMenuHandle</CODE> function. <P>
<PRE>
FUNCTION HMGetHelpMenuHandle (VAR mh: MenuHandle): OSErr;
</PRE>
<DL>
<DT><CODE>mh</CODE>
<DD> A copy of a handle to the Help menu. 
</DL>
<A NAME=HEADING172-4></A>
<H5>DESCRIPTION</H5>
 The <CODE>HMGetHelpMenuHandle</CODE> function returns in its <CODE>mh</CODE> parameter a handle to your application's help menu. With this handle, you can append items to the Help menu by using the <CODE>AppendMenu</CODE> procedure or other related Menu Manager routines. The Help Manager automatically adds the divider line that separates your items from the rest of the Help menu.<P>
 Be sure to define help balloons for your items in the Help menu by creating an <CODE>'hmnu'</CODE> resource and specifying the <CODE>kHMHelpMenuID</CODE> constant as its resource ID. <P>
 The Menu Manager functions <CODE>MenuSelect</CODE> and <CODE>MenuKey</CODE> return a result with the menu ID in the high word and the menu item in the low word. Both functions return the <CODE>HelpMgrID</CODE> constant in the high word when the user chooses an appended item from the Help menu. The number of the appended menu item is returned in the low word <BR>of the function result. In the future, Apple Computer, Inc., may choose to add other items to the Help menu. To determine the number of items in the Help menu, call the Menu Manager function <CODE>CountMItems</CODE>.<P>
<A NAME=HEADING172-8></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 Do not use the Menu Manager function <CODE>GetMenuHandle</CODE> to get a handle to the Help menu, because <CODE>GetMenuHandle</CODE> returns a handle to the global Help menu, not the <BR>Help menu that is specific to your application.<P>
<A NAME=HEADING172-10></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The trap macro and routine selector for the <CODE>HMGetHelpMenuHandle</CODE> function are
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Trap macro<TH>Selector<TR>
<TD>_Pack14<TD>$0200</TABLE>
<P>
<A NAME=HEADING172-12></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>paramErr<TD>-50<TD>Error in parameter list<TR>
<TD>memFullErr<TD>-108<TD>Not enough room in heap zone<TR>
<TD>resNotFound<TD>-192<TD>Unable to read resource<TR>
<TD>hmHelpManagerNotInited<TD>-855<TD>Help menu not set up</TABLE>
</H5>
<A NAME=HEADING172-13></A>
<H5>SEE ALSO</H5>
 <A HREF=MoreToolbox-155.html#MARKER-9-396>"Adding Menu Items to the Help Menu" beginning on page 3-83</A> provides details and illustrative sample code for using <CODE>HMGetHelpMenuHandle</CODE>. The <CODE>'hmnu'</CODE> resource is described in detail in <A HREF=MoreToolbox-147.html#MARKER-9-157>"Providing Help Balloons for Menus" beginning on page 3-24</A>. See the chapter "Menu Manager" in <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I> for information about <CODE>AppendMenu</CODE>, <CODE>MenuSelect</CODE>, <CODE>MenuKey</CODE>, and other Menu Manager routines.<A NAME=MARKER-2-478></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-171.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-173.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
