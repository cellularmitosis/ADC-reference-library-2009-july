<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>dspCLListen(IM:N)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING133></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Networking-132.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Networking-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Networking-304.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt= "Book Index"></A> <A HREF="Networking-134.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Networking-2.html"><B>Networking</B></A> / <BR><DD><A HREF="Networking-98.html"><B>Chapter 5 - AppleTalk Data Stream Protocol (ADSP) </B></A> / <A HREF="Networking-115.html"><B>ADSP Reference</B></A><BR><DL><DD><A HREF="Networking-122.html"><B>Routines</B></A> / <A HREF="Networking-131.html"><B>Establishing and Terminating an ADSP Connection Listener</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING133-0></A>
<H3>dspCLListen </H3>
 The <A NAME=MARKER-2-385></A><CODE>dspCLListen</CODE> routine causes a connection listener to listen for connection requests. You use the <CODE>PBControl</CODE> function to call the <CODE>dspCLListen</CODE> routine. See <A HREF=Networking-122.html#MARKER-9-273>"Routines" on page 5-43</A> for a description of the <CODE>PBControl</CODE> function.<A NAME=MARKER-2-59></A><P>
<B>
<TABLE BORDER="0" CELLPADDING=3><TD>--><TD>ioCompletion<TD>ProcPtr<TD>A pointer to a completion routine.<TR>
<TD><A NAME=MARKER-2-28></A><--<TD>ioResult<TD>OSErr<TD>The function result. <TR>
<TD>--><TD>ioCRefNum<TD>Integer<TD>The driver reference number.<TR>
<TD>--><TD>csCode<TD>Integer<TD>Always <CODE>dspCLListen</CODE> for this function.<TR>
<TD>--><TD>ccbRefNum<TD>Integer<TD>The CCB reference number. <TR>
<TD><--<TD>remoteCID<TD>Integer<TD>The ID of the remote connection end.<TR>
<TD><--<TD>remoteAddress<TD>AddrBlock<TD>The remote internet address.<TR>
<TD>--><TD>filterAddress<TD>AddrBlock<TD>A filter for open-connection requests.<TR>
<TD><--<TD>sendSeq<TD>LongInt<TD>The initial send sequence number.<TR>
<TD><--<TD>sendWindow<TD>Integer<TD>The initial size of the remote <BR>receive queue.<TR>
<TD><--<TD>attnSendSeq<TD>LongInt<TD>The attention send sequence number.</TABLE>
</B><P>
<DL>
<H5>Field Description</H5>
<DT><CODE>csCode</CODE>
<DD> The routine selector, always <CODE>dspCLListen</CODE> for this routine.
<DT><CODE>ccbRefNum</CODE>
<DD> The CCB reference number that the <CODE>dspCLInit</CODE> routine returned.
<DT><CODE>remoteCID</CODE>
<DD> The identification number of the remote connection end. You must pass this value to the <CODE>dspOpen</CODE> routine when you open the connec-<BR>tion or to the <CODE>dspCLDeny</CODE> routine when you deny the connection request. The <CODE>dspCLListen</CODE> routine returns this number.
<DT><CODE>remoteAddress</CODE>
<DD> The internet address of the remote socket that sent a request to open a connection. This address consists of a 2-byte network number, a 1-byte node ID, and a 1-byte socket number. You must pass this value to the <CODE>dspOpen</CODE> routine when you open the connection or to the <CODE>dspCLDeny</CODE> routine when you deny the connection request.
<DT><CODE>filterAddress</CODE>
<DD> <A NAME=MARKER-2-387></A>The internet address of the socket from which you will accept a connection request. The address consists of three fields: a 2-byte network number, a 1-byte node ID, and a 1-byte socket number. Specify 0 for any of these fields for which you wish to impose no restrictions. If you specify a filter address of $00082500, for example, the connection listener accepts a connection request from any socket at node $25 of network $0008. <A NAME=MARKER-9-179></A>
<DT><CODE>sendSeq</CODE>
<DD> The sequence number of the first byte that the local connection end will send to the remote connection end. ADSP uses this number to coordinate communications and to check for errors. You must pass this value to the <CODE>dspOpen</CODE> routine when you open the connection.<A NAME=MARKER-9-189></A>
<DT><CODE>sendWindow</CODE>
<DD> The sequence number of the last byte that the remote connection end has buffer space to receive. ADSP uses this number to coordinate communications and to check for errors. You must pass this value to the <CODE>dspOpen</CODE> routine when you open the connection.<A NAME=MARKER-9-69></A>
<DT><CODE>attnSendSeq</CODE> 
<DD> The sequence number of the next attention packet that the local connection end will transmit. ADSP uses this number to ensure that attention packets are delivered in the correct order and to check for errors. You must pass this value to the <CODE>dspOpe</CODE>n routine when you open the connection.<A NAME=MARKER-2-391></A>
</DL>
<A NAME=HEADING133-11></A>
<H5>DESCRIPTION</H5>
 The <CODE>dspCLListen</CODE> routine initiates the connection listener. You must have already used the <CODE>dspCLInit</CODE> routine to establish a connection listener before using the <CODE>dspCLListen</CODE> routine. The <CODE>dspCLListen</CODE> routine is used only by connection servers.<A NAME=MARKER-9-115></A><P>
 When ADSP receives an open-connection request from a socket that satisfies the address requirements of the <CODE>filterAddress</CODE> parameter, it returns values for the <CODE>remoteCID</CODE>, <CODE>remoteAddress</CODE>, <CODE>sendSeq</CODE>, <CODE>sendWindow</CODE>, and <CODE>attnSendSeq</CODE> parameters and completes execution of the <CODE>dspCLListen</CODE> routine. You must then either accept the open-connection request by calling the <CODE>dspOpen</CODE> routine in the <CODE>ocAccept</CODE> mode or <BR>deny the request by calling the <CODE>dspCLDeny</CODE> routine.<P>
 You can call the <CODE>dspCLListen</CODE> routine several times, specifying the same connection listener. For example, if you wanted to accept connections from any or all of three different addresses, you could call the <CODE>dspCLListen</CODE> routine three times with a different value for the <A NAME=MARKER-2-393></A><CODE>filterAddress</CODE> parameter each time. Note that you must execute the <CODE>dspCLListen</CODE> routine asynchronously to take advantage of this feature.<P>
<A NAME=HEADING133-15></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 To execute the <CODE>dspCLListen</CODE> routine from assembly language, call the <CODE>_Control</CODE> trap macro with a value of <CODE>dspCLListen</CODE> in the <CODE>csCode</CODE> field of the parameter block. <P>
<A NAME=HEADING133-17></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>errState<TD>-1278<TD>Not a connection listener<TR>
<TD>errAborted<TD>-1279<TD>Request aborted by the <CODE>dspRemove</CODE> routine<TR>
<TD>errRefNum<TD>-1280<TD>Bad connection reference number</TABLE>
</H5>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Networking-132.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Networking-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Networking-304.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt= "Book Index"></A> <A HREF="Networking-134.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Networking-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
