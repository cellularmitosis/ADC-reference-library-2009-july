<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!--Template 06-20-02--><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Q&amp;A CS13: Missing ColorSync Profiles</title>	<meta name="keywords" content="Mac OS 8 ColorSync Manager 2.6 profiles control panel desc">	<meta name="Description" content="Technical Q&amp;A CS13: Q&amp;A gives a descripton of ColorSync profilesfocusing on the desc tag of the profile. Then gives reasonswhy an incorrect desc tag, which consists of three strings,would cause profiles to not show up in ColorSync's controlpanel or in its pop-up Menus. "><meta name="categories" content="Color"><meta name="week-posted" content="May 3, 1999 - May 7, 1999"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10001141" title="Missing ColorSync Profiles"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalqas/index.html">Technical Q&As</a> &gt; <a href="../../technicalqas/GraphicsImaging/index.html">Graphics & Imaging</a> &gt; <a href="../../technicalqas/GraphicsImaging/idxColorSync-date.html">ColorSync</a> &gt; </p><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Q&amp;A CS13</div>
<div id="pageheadsub">Missing ColorSync Profiles</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><!-- begin_content --> <CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=555> <TR> <td align="left"><hr width=500 align=center><p id=p2>Q: I've just installed ColorSync 2.6 and noticed some of my profiles no longer show up in the ColorSync control panel or the ColorSync plug-ins pop-up menus, even though they are properly installed in the "ColorSync Profiles" folder? What's going on?</p><p id=p4>A: One important change in the recent release of ColorSync (version 2.6) is how it handles the description (<CODE>'desc'</CODE>) tag of ICC profiles.</p><p id=p4>The <CODE><code>'desc'</code></CODE> tag of a profile, as defined by the ICC, contains up to three strings.  The first is a required 7-bit roman ASCII string.  The second is an optional localized Unicode string.  The third, also optional, is a localized string in Mac script-code format.  Applications typically use one of the available strings to show the name of profiles in a list or pop-up menu.  There are a few other important devilish details in the ICC definition of the <code>'desc'</code> tag.  One is that all three strings must be null terminated.  Another is that all three strings are preceded by a character count that includes the null terminator.  It also worth noting that for the Unicode string, the character count must not be confused with a byte count because each Unicode character requires two bytes.</p><p id=p4>Previous releases of ColorSync only make partial use of this tag and as a result  performed only limited error checking on its contents.  For example, the ColorSync function <CODE>CMGetScriptProfileDescription</CODE> would return the Macscript-code from a profile if it was present and, if not, it would return the 7-bit roman ASCII string.  The Unicode string was simply ignored and in some cases, if the Unicode and/or Mac script-code string were non-compliant, ColorSync would return garbage (or the ACSII string if you were lucky) without returning <CODE>cmProfileErr</CODE> code.</p><p id=p4>ColorSync 2.6 is the first release of the technology that was designed to run both on Mac OS and Windows.  Since Mac script-code format strings are not usable on Windows, ColorSync clients need to have access to thelocalized Unicode string. (Unicode strings are also becoming more usable on Macs.)  For this reason a new call, <CODE>CMGetProfileDescriptions</CODE>, was added to access all three possible strings.  In doing so much stricter attention hadto be paid to the compliance of the <code>'desc'</code> tag.  For example, if either the ASCII string or the Mac script-code strings is not null terminated or if any of the string's character counts are invalid or beyond the range of the <code>'desc'</code> tag, the and <CODE>cmProfileErr</CODE> code is returned.</p><p id=p4>In order to achieve optimal performance when applications add profiles to a list or pop-up menu, ColorSync maintains a cache of all the profiles installed in the "ColorSync Profiles" folder and its sub-directories.  Among other things, this cache file contains the three possible names of each profile obtained by calling <CODE>CMGetProfileDescriptions</CODE>.  If <CODE>CMGetProfileDescriptions</CODE> returns an error because the <code>'desc'</code> tag is non-compliant, then the profile is not added to the cache.  This is why non-compliant profiles--even though they are properly installed in the "ColorSync Profiles" folder--no longer show up in the ColorSync control panel or the ColorSync plug-ins pop-up menus with ColorSync 2.6 installed.</p><p id=p4>The remedy for this problem is to repair the affected profiles.Unfortunately the "Rename Profile" AppleScript that is installed as part of ColorSync 2.6 cannot be used to repair profiles with bad <code>'desc'</code> tags because it can only operate on profiles in the ColorSync profile cache. Instead, a simple stand-alone tool called "Profile First Aid" to verify and repair any profile will be made available on the <A HREF="http://www.apple.com/colorsync/">ColorSync web site</A>.</p></td> </tr> </table></CENTER><!-- end_content --><!-- begin_date --><H4 ALIGN=center>[May 03 1999]</H4><!-- end_date --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/qa/c/cs13.html%3Fid%3DDTS10001141-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/qa/c/cs13.html%3Fid%3DDTS10001141-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/qa/c/cs13.html%3Fid%3DDTS10001141-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --> <hr width=500 align=center> </BODY> </HTML>