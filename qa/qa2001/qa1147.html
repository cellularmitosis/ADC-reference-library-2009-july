<HTML><!--This file created 6/12/2002 11:06 PM by Claris Home Page version 3.0--><HEAD>   <title>Technical Q&amp;A QA1147: Programmatic configuration of a Movie Export Component</title>   <META NAME=GENERATOR CONTENT="Claris Home Page 3.0">   <X-CLARIS-WINDOW TOP=44 BOTTOM=738 LEFT=5 RIGHT=995>   <X-CLARIS-TAGVIEW MODE=full><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><meta name="keywords" content="Movie Export Component, Configuration"><meta name="Description" content="Technical Q&amp;A QA1147: This Q&amp;A demonstrates how you can programmaticallyconfigure a Movie Export Component without showing the MovieExport Dialog"><meta name="categories" content="QuickTime Movie Toolbox"><meta name="week-posted" content="Jun 17, 2002 - Jun 21, 2002"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10001692" title="Programmatic configuration of a Movie Export Component"></a><P><!-- top_of_header_marker_comment --> <!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalqas/index.html">Technical Q&As</a> &gt; <a href="../../technicalqas/QuickTime/index.html">QuickTime</a> &gt; <a href="../../technicalqas/QuickTime/idxImportExport-date.html">Import & Export</a> &gt; </p><!-- end_header_information --> <!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Q&amp;A QA1147</div>
<div id="pageheadsub">Programmatic configuration of a Movie Export Component</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --></P><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600>   <TR>      <td align="left">         <P><!-- begin_content -->                  <hr width=500 align=center>                  </P>                  <P id=p2>Q: I'm trying to export a movie directly to a Raw         AVI file, I've tried using the built-in exporter in         QuickTime but I seem to only get a Cinepak compressed AVI. I         can use MovieExportDoUserDialog to put up the export dialog         and change the settings, but I don't want to do that. Can I         change the settings programmatically?</P>                  <P id=p4>A: You can use QuickTime's built-in Movie to AVI         File export component to export with several codecs. The         default is Cinepak, but you can programmatically configure         the component to use another compressor. Use         MovieExportGetSettingsAsAtomContainer to retrieve the         exporter settings as a QTAtomContainer, modify the spatial         settings, then use MovieExportSetSettingsFromAtomContainer         to configure the export component.</P>                  <P id=p4>Listing 1 demonstrates setting up the AVI export         component to programmatically use the Indeo 4 codec         (kIndeo4CodecType), but you could just as easily choose         Windows Raw codec (kWindowsRawCodecType) etc.</P>                  <P id=p4><BR>         </P>                  <CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550>            <TR>               <td bgcolor="#E6E6E6" align=left>                  <pre> OSErr SpitAVIMovie(const Movie inMovie, const FSSpecPtr inFile){    ScriptCode           fileScript = smCurrentScript; // use smSystemScript on Windows    MovieExportComponent movieExporter = NULL;    QTAtomContainer      exportSettings = NULL;    QTAtom               videAtom = 0,                         sptlAtom = 0;    SCSpatialSettings    spatialSetting;    OSErr                err = noErr;    // Open the AVI 'spit' component    err = OpenADefaultComponent(MovieExportType, kQTFileTypeAVI, &amp;movieExporter);    if (err || !movieExporter) goto bail;    // Get the default settings    err = MovieExportGetSettingsAsAtomContainer(movieExporter, &amp;exportSettings);    if (err) goto bail;    // Find the 'vide' Atom which contains the spatial settings    videAtom = QTFindChildByID(exportSettings, kParentAtomIsContainer,                               kQTSettingsVideo,                               1, NULL);    if (0 == videAtom) { err = cannotFindAtomErr; goto bail; }    // Find the 'sptl' Atom - Spatial Settings    sptlAtom = QTFindChildByID(exportSettings, videAtom,                               scSpatialSettingsType,                               1, NULL);    if (0 == sptlAtom) { err = cannotFindAtomErr; goto bail; }    // Set up our settings    spatialSetting.codecType = EndianU32_NtoB(kIndeo4CodecType); // or kWindowsRawCodecType    spatialSetting.codec = 0;    spatialSetting.depth = EndianU16_NtoB(24);    spatialSetting.spatialQuality = EndianU32_NtoB(codecLosslessQuality);    // Change the atom data to reflect our settings    err = QTSetAtomData(exportSettings, sptlAtom,                        sizeof(spatialSetting),                        &amp;spatialSetting);    if (err) goto bail;    // Set the exporter settings    err = MovieExportSetSettingsFromAtomContainer(movieExporter, exportSettings);    if (err) goto bail;    // Go ahead and spit    err = ConvertMovieToFile(inMovie, NULL, inFile, 0, 0, fileScript, NULL, 0, movieExporter);bail:    if (movieExporter) CloseComponent(movieExporter);    if (exportSettings) QTDisposeAtomContainer(exportSettings);    return err;}                  </pre>               </TD>            </TR>            <TR>               <td align="left">                  <P><B>Listing 1</B>. Export to AVI</P>               </TD>            </TR>         </TABLE>         </CENTER>                  <P><B>References:</B></P>                  <BLOCKQUOTE><A href="../../documentation/quicktime/qtdevdocs/RM/rmDataExchange.htm" TARGET="_blank">Movie            Data Exchange Documentation</A>                        <P><A href="../../documentation/quicktime/qtdevdocs/APIREF/SOURCESI/convertmovietofile.htm" TARGET="_blank">ConvertMovieToFile            API</A></P>                        <P><A HREF="http://developer.apple.com/quicktime/icefloe/dispatch006.html" TARGET="_blank">Dispatch            6 - Finding Movie Export Components</A></P></BLOCKQUOTE>                  <P>                  <hr width=500 align=center>                  </P>                  <!-- begin_date --><H4><CENTER>[Jun 18 2002]</CENTER></H4><!-- end_date -->      </TD>   </TR></TABLE></CENTER><P><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/qa/qa2001/qa1147.html%3Fid%3DDTS10001692-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/qa/qa2001/qa1147.html%3Fid%3DDTS10001692-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/qa/qa2001/qa1147.html%3Fid%3DDTS10001692-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></P></BODY></HTML>