<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE> Automatic IST Extension Operation</TITLE></HEAD><BODY BGCOLOR="#ffffff"><DIV><a name="top"></a><!-- start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!-- start of path --><font face="Geneva,Helvetica,Arial" size="1"><b><br>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Documentation</a> &gt; <!-- a href="" target="_top" -->Hardware<!-- /a -->  <b>&gt; </b><a href="../../devicemgrs.html" target="_top">Device Managers and Drivers</a> <b>&gt; </b><a href="../pci_srvcs.html" target="_top">PCI Card Services</a> <b>&gt; </b>Designing PCI Cards and Drivers for Power Macintosh Computers</font><br><br><!-- end of path --><A HREF="PCI_BOOK.177.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.178.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.17a.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><HR></DIV><H1 CLASS="H3.Heading3"><A NAME="pgfId=4296"> </A>Automatic IST Extension Operation</H1><P CLASS="T1.Text1"><A NAME="pgfId=4297"> </A>The nature of the PCI-to-PCI bridge devices available on the market today imposes some limitations on automatic IST extensions. While today's PCI-to-PCI bridge devices transparently handle the addressing aspects of PCI buses, they do not do the same for interrupt request signals. Also, there is no current standard among card vendors for providing hardware registers that indicate which device is requesting service. Hence, card vendors often simply wire the interrupt request signals from all devices together into a single signal and feed that directly to the main logic board's slot. The IST that is constructed for the main logic board can tell that something wants service on the multifunction expansion card, but it cannot tell exactly which device. To accommodate this &quot;lowest common denominator&quot; behavior, the IST extensions from the slot IST member uses dispatching modification options to poll the extended IST members, as described in <A HREF="PCI_BOOK.17d.html#36133" CLASS="XRef">InterruptHandler</A>.</P><P CLASS="T1.Text1"><A NAME="pgfId=4301"> </A>When polling is used, certain actions must be observed by the ISRs, IERs, and IDRs attached to the extended IST members. Each PCI-to-PCI bridge's IST member has a special bridge dispatching ISR installed. This transversal ISR handles all the devices requesting interrupt service during a single IST transversal. Once all of the device's ISRs return <TT CLASS="cv">kIsrIsNotComplete</TT>, the transversal ISR returns <TT CLASS="cv">kIsrIsComplete</TT> to the dispatcher to indicate that interrupt processing is complete. The transversal ISR also implements a simple fairness algorithm that keeps any one device from dominating the interrupt service requests. It makes sure that the same device isn't serviced twice in a row (unless only one device is requesting service), regardless of the number of IST transversals.</P><P CLASS="T1.Text1"><A NAME="pgfId=4302"> </A>In addition, separate software flags are maintained for each extended IST member to enable and disable interrupt servicing. Invoking an extended IST member's IDR and IER functions has two implicit effects. First, invoking the IDR only prevents the extended IST member's ISR from being invoked; it does not disable the device's ability to request an interrupt. It is the responsibility of the driver to disable interrupt requests from the actual device. Second, invoking the IER not only allows the extended IST member's ISR to be invoked; it also traverses the IST back to the main logic board's slot IST member, invoking the IER of each IST member encountered. Thus, a driver needs only invoke its device's IER to allow interrupt requests through the IST.</P><HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 26 March 99)<P><A HREF="PCI_BOOK.177.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.178.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.17a.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></HTML>