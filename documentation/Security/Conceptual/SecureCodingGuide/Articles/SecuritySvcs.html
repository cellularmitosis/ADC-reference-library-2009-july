<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Secure Coding Guide: Mac OS X and iPhone OS Security Services</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Mac OS X and iPhone OS Security Services"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40002650" title="Mac OS X and iPhone OS Security Services"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000434" target="_top">Security</a> &gt; <a href="../index.html" target="_top">Secure Coding Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="TypesSecVuln.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="BufferOverflows.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/TP40002650-SW1" title="Mac OS X and iPhone OS Security Services"></a><hr /><H1>Mac OS X and iPhone OS Security Services</H1><p>This article provides a brief introduction to the high-level security application programming interfaces (APIs) and user features provided by Mac OS X and iPhone OS. For more information on these features, see <em><a href="../../Security_Overview/index.html#//apple_ref/doc/uid/TP30000976" target="_top">Security Overview</a></em>.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="SecuritySvcs.html#//apple_ref/doc/uid/TP40002650-TPXREF101">Authentication</a>
				
			<br/>
			
        
			
			
				<a href="SecuritySvcs.html#//apple_ref/doc/uid/TP40002650-CHDEEDHC">Authorization</a>
				
			<br/>
			
        
			
			
				<a href="SecuritySvcs.html#//apple_ref/doc/uid/TP40002650-TPXREF102">Cryptography</a>
				
			<br/>
			
        
			
			
				<a href="SecuritySvcs.html#//apple_ref/doc/uid/TP40002650-CHDDDBDF">Certificates</a>
				
			<br/>
			
        
			
			
				<a href="SecuritySvcs.html#//apple_ref/doc/uid/TP40002650-CHDDJIHA">Keychain</a>
				
			<br/>
			
        
			
			
				<a href="SecuritySvcs.html#//apple_ref/doc/uid/TP40002650-SW2">Smart Cards</a>
				
			<br/>
			
        
			
			
				<a href="SecuritySvcs.html#//apple_ref/doc/uid/TP40002650-CHDHDIBB">Secure Communication</a>
				
			<br/>
			
        
			
			
				<a href="SecuritySvcs.html#//apple_ref/doc/uid/TP40002650-CHDIGAIC">Security Interface Framework</a>
				
			<br/>
			
        
			
			
				<a href="SecuritySvcs.html#//apple_ref/doc/uid/TP40002650-CHDDFIAC">Movie Toolbox Access Keys</a>
				
			<br/>
			
        
			
			
				<a href="SecuritySvcs.html#//apple_ref/doc/uid/TP40002650-TPXREF104">User-Level Security Features</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40002650-TPXREF101" title="Authentication"></a><h2>Authentication</h2><p><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_203"></a>Authentication is the process of verifying the identity of a user or service. Authentication is normally done only as a step in authorization, which is the process of granting an entity permission to perform a particular operation. If you use the Mac OS X Authorization Services API, it handles authentication for you when necessary. Because Authorization Services implements all available authentication methods, using this API means you don't have to worry about implementing new authentication services (smart cards, biometric readers, and so forth) when they become available—your users get them automatically. </p><p>In iPhone OS, the user can set a four-digit personal identification number (PIN) to prevent unauthorized use of the device. Therefore the user of the device is presumed to be authorized to do so. In addition, each application is digitally signed and can therefore be authenticated by the operating system. Therefore, there are no authentication or authorization APIs in iPhone OS.</p><p>Because authentication requires the handling of secret information (such as a user's password), it can be difficult to write secure authentication code. Authorization Services handles the authentication interaction with the user, thus relieving you of this responsibility. See <em><a href="../../../Reference/authorization_ref/index.html#//apple_ref/doc/uid/TP30000826" target="_top">Authorization Services C Reference</a></em> and <em><a href="../../authorization_concepts/index.html#//apple_ref/doc/uid/TP30000995" target="_top">Authorization Services Programming Guide</a></em> for details. </p><p>Authentication is often necessary over a network—for example, to determine whether it is safe to send credit card information to a specific website. Digital certificates are often used for this purpose. The Mac OS X and iPhone OS APIs for handling digital certificates are described in <em><a href="../../../Reference/certifkeytrustservices/index.html#//apple_ref/doc/uid/TP30000157" target="_top">Certificate, Key, and Trust Services Reference</a></em> and <em><a href="../../CertKeyTrustProgGuide/index.html#//apple_ref/doc/uid/TP40001358" target="_top">Certificate, Key, and Trust Services Programming Guide</a></em>. To exchange certificates over a secure connection, use the Secure Transport API (see <em><a href="../../../Reference/secureTransportRef/index.html#//apple_ref/doc/uid/TP30000155" target="_top">Secure Transport Reference</a></em>) or one of the high-level APIs that call Secure Transport—see <em><a href="../../../../Networking/Conceptual/CFNetwork/index.html#//apple_ref/doc/uid/TP30001132" target="_top">CFNetwork Programming Guide</a></em> or <em><a href="../../../../Cocoa/Conceptual/URLLoadingSystem/index.html#//apple_ref/doc/uid/10000165i" target="_top">URL Loading System</a></em>. To authenticate with a directory server, use the Open Directory API (see <em><a href="../../../../Networking/Conceptual/Open_Directory/index.html#//apple_ref/doc/uid/TP40000917" target="_top">Open Directory Programming Guide</a></em>).</p><a name="//apple_ref/doc/uid/TP40002650-CHDEEDHC" title="Authorization"></a><h2>Authorization</h2><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_204"></a><p>Authorization is the process by which an entity such as a user or a server gets the right to perform a restricted operation. (Authorization can also refer to the right itself, as in “Bob has the authorization to run that program.”) Authorization usually involves first authenticating the entity and then determining whether it has the appropriate permissions. </p><p>The principal Mac OS X API for authorization is Authorization Services. (As discussed in <span class="content_text"><a href="SecuritySvcs.html#//apple_ref/doc/uid/TP40002650-TPXREF101">“Authentication,”</a></span> iPhone OS does not provide this API.) Authorization Services is built on top of BSD. Unlike BSD, however, which can control access at the level of individual files or programs, Authorization Services lets you determine whether an entity should have access to specific features or data within your application. Authorization Services uses a <strong>policy database</strong> to determine the rights of a given authenticated user. Authorization Services includes functions to read, add, edit, and delete policy database items. Modifying the policy database requires administrator access; if an application is not running with sufficient privileges, the user is prompted to authenticate as an administrator before the database is altered. </p><p>It is important to understand that Authorization Services does not enforce access controls. All that this API can do is to let you know whether the user is authenticated and whether they have permission to carry out the action they wish to perform. It is up to your program to either deny the action or carry it out. </p><p>In iPhone OS, on the other hand, each application is granted access permissions for its own files and certain system services when it’s signed by Apple, Inc. When installed on a device, the iPhone OS operating system enforces these permissions.</p><p>Occasionally a Mac OS X application needs to perform some operation that requires running with root privileges; for example, when installing new software. In order to avoid having the entire application run as <code>root</code>, in this case you should create a separate helper tool that runs with root privileges only as long as is necessary. See <em><a href="../../authorization_concepts/index.html#//apple_ref/doc/uid/TP30000995" target="_top">Authorization Services Programming Guide</a></em> and the <em><a href="../../../../../samplecode/BetterAuthorizationSample/index.html#//apple_ref/doc/uid/DTS10004207" target="_top">BetterAuthorizationSample</a></em> sample code for more information on creating such a tool.</p><p>To learn how to use Authorization Services, start with <em><a href="../../authorization_concepts/index.html#//apple_ref/doc/uid/TP30000995" target="_top">Authorization Services Programming Guide</a></em> and then look at <em><a href="../../../Reference/authorization_ref/index.html#//apple_ref/doc/uid/TP30000826" target="_top">Authorization Services C Reference</a></em>. There are also technical notes, Q&amp;As, and sample code for Authorization Services available from the <span class="content_text"><a href="../../../../../referencelibrary/Security/index.html#//apple_ref/doc/uid/TP30000943-TP30000434" target="_top">Reference Library > Security</a></span> page on the ADC website.</p><a name="//apple_ref/doc/uid/TP40002650-TPXREF102" title="Cryptography"></a><h2>Cryptography</h2><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_205"></a><p>Authorization Services, Certificate, Key, and Trust Services, file access controls, and other access and authorization services can only serve to protect data if the attacker is working remotely (over a network) or has only a short time to act. Given physical access to the computer and plenty of time, an attacker can defeat or bypass any authorization method or access controls. In this case, the only way to protect your data is through encryption.</p><p>You can use <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_206"></a>Keychain Services to encrypt and store small amounts of data (see <em><a href="../../../Reference/keychainservices/index.html#//apple_ref/doc/uid/TP30000898" target="_top">Keychain Services Reference</a></em> and <em><a href="../../keychainServConcepts/index.html#//apple_ref/doc/uid/TP30000897" target="_top">Keychain Services Programming Guide</a></em>). If you want to encrypt or decrypt larger amounts of data in Mac OS X, you can use the Common Security Services Manager <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_207"></a>(CSSM) <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_208"></a>Cryptographic Services Manager. This manager also has functions to create and verify digital signatures, generate cryptographic keys, and create cryptographic hashes. In iPhone OS, the Certificate, Key, and Trust Services API provides functions for generating encryption keys, creating and verifying digital signatures, and encrypting blocks of data; see <em><a href="../../../Reference/certifkeytrustservices/index.html#//apple_ref/doc/uid/TP30000157" target="_top">Certificate, Key, and Trust Services Reference</a></em>. For Mac OS X, to see exactly which security protocols and algorithms are supported by Apple’s Cryptographic Service Provider (CSP) implementation, see <em><a href="../../../Reference/SecAppleCryptoSpec/Apple_Cryptographic_Service_Provider_Functional_Specification.pdf" target="_top">Apple Cryptographic Service Provider Functional Specification</a></em>.</p><p>The sample code <em><a href="../../../../../samplecode/CryptoSample/index.html#//apple_ref/doc/uid/DTS10001086" target="_top">CryptoSample</a></em> contains source code and program examples for a library intended to facilitate the use of the Cryptographic Services Manager, specifically for symmetric encryption and message digest calculation. </p><p>The lower-level APIs provided by Apple’s implementation of CSSM are fully documented in <em>Common Security: CDSA and CSSM</em>, version 2 (with corrigenda), from the Open Group (<span class="content_text"><a href="http://www.opengroup.org/security/cdsa.htm" target="_blank">http://www.opengroup.org/security/cdsa.htm</a></span>).</p><a name="//apple_ref/doc/uid/TP40002650-CHDDDBDF" title="Certificates"></a><h2>Certificates</h2><p>Mac OS X and iPhone OS include APIs to read and evaluate digital certificates that conform to the X.509 standard. Among other things, an X.509 digital certificate includes a digital signature that can be used to ensure that the certificate has not been altered and to indicate the identity of the issuer, and a public key that can be used to encrypt data so that it can be read only by the holder of the certificate. Each digital certificate also contains <em>certificate extensions</em>), which establish a <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_209"></a><strong>level of trust</strong> for the certificate. Mac OS X includes several trust policies, where a <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_210"></a><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_211"></a><strong>trust policy</strong> is a set of rules that specify the appropriate uses for a certificate that has a specific level of trust. In other words, the level of trust for a certificate is used to answer the question “Should I trust this certificate for this action?” See <em><a href="../../../Reference/SecAppleTrustPolicyModuleSpec/Apple_Trust_Policy_Module_Functional_Specification.pdf" target="_top">Apple Trust Policy Module Functional Specification</a></em> for information about the trust policies included with Mac OS X. The iPhone OS trust policies are available through specific functions in Certificate, Key, and Trust Services. For more details about the contents and uses of digital certificates, see <em><a href="../../Security_Overview/index.html#//apple_ref/doc/uid/TP30000976" target="_top">Security Overview</a></em>. For more information about policy functions in Certificate, Key, and Trust Services, see <em><a href="../../../Reference/certifkeytrustservices/index.html#//apple_ref/doc/uid/TP30000157" target="_top">Certificate, Key, and Trust Services Reference</a></em>.</p><p><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_212"></a>Certificate, Key, and Trust Services is a C API for managing certificates, public and private keys, and trust policies. Certificate, Key, and Trust Services uses the keychain for storage and retrieval of certificates and keys, and uses the trust policies provided by Apple.</p><p>Because <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_213"></a>certificates are used by secure networking protocols for authentication, the <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_214"></a>Secure Transport API includes a variety of functions to manage the use of certificates and root certificates in a secure connection. See <em><a href="../../../Reference/secureTransportRef/index.html#//apple_ref/doc/uid/TP30000155" target="_top">Secure Transport Reference</a></em> for more information about Secure Transport.</p><p>To display the contents of a <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_215"></a>certificate in a Mac OS X user interface, you can use the <code>SFCertificatePanel</code> and <code>SFCertificateView</code> classes in the Security Interface Framework API. In addition, the <code>SFCertificateTrustPanel</code> class displays trust decisions and lets the user edit trust decisions. See <em><a href="../../../Reference/SecurityObjectiveC/index.html#//apple_ref/doc/uid/TP30000996" target="_top">Security Interface Framework Reference</a></em> for more information about this API. </p><p>If the users of your software are not security experts or computer professionals, they probably do not know much about the purpose and use of digital certificates. Therefore, you should take care to make your user interface as clear and explicit as possible if you detect a problem with a certificate. Explain the problem in simple language and give the user as much guidance as possible in choosing how to proceed. For example, if a certificate cannot be verified because the root certificate used to verify the digital signature is not included in the root certificate database, you can offer to display the root certificate and give the user the option of adding it to the list of recognized root certificates. However, you should explain that this is a dangerous thing to do unless the user is very confident of the authenticity and trustworthiness of that certificate. </p><a name="//apple_ref/doc/uid/TP40002650-CHDDJIHA" title="Keychain"></a><h2>Keychain</h2><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_216"></a><p>Many applications and websites require a username and password, and it is bad security practice to use the same password for everything. On the other hand, few users can remember a large number of unique passwords and writing them down is also a risk. Mac OS X and iPhone OS solve this problem by providing secure, encrypted storage for passwords and other secrets in a password-protected database called the <strong>keychain</strong>. The keychain is also used to store certificates, which are not encrypted by the keychain, but which contain encryption keys and encrypted data. Applications can use <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_217"></a> Keychain Services to store, retrieve, and read keychain items, and Certificate, Key, and Trust Services to store and retrieve certificates and keys. In iPhone OS, Keychain Services checks an application’s signature before giving it access to a keychain, and lets an application have access only to its own keychain items (with the possible exception of items for which the application has obtained persistent references). In Mac OS X, Keychain Services displays an authorization dialog when permission is needed from the user to open a keychain or access a secret keychain item. The user can unlock a keychain with a single password, and applications can then use that keychain to store and retrieve data. Users can use the Keychain Access utility for the same purpose. In iPhone OS, the user is never asked to authenticate and no Keychain Access utility is provided by Apple.</p><p>Note that the keychain is designed to protect a user's secrets from others. Because the user has access to all secrets in the keychain, it is not useful for protecting a vendor's secrets from the user.</p><p>In most cases, a keychain-aware application does not have to do any keychain management and only has to call a few functions to store or retrieve keychain items. By default, Keychain Services automatically interacts with the user to unlock a keychain when necessary in Mac OS X. In iPhone OS, the operating system handles keychain access without user interaction. Because the user can create multiple keychains in Mac OS X and can specify which one is the default keychain, you should not make any assumptions about which keychain to write to or to search. The default keychain may or may not be the login keychain. Always use the default keychain unless you have a specific reason to do otherwise. </p><p>Passwords, private keys, and other secrets are encrypted on the keychain. In Mac OS X, the user provides a password that is used to encrypt and decrypt these items. In iPhone OS, the system generates its own password and uses it to give an application access to its own keychain items. When the user backs up iPhone OS data, the data is stored in plaintext on the computer, with the exception of the encrypted keychain data, which remains encrypted. Therefore, to prevent possible compromise of secrets in <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_218"></a>backup data, it is very important for iPhone OS applications to always use the keychain to store passwords and other sensitive data.</p><p>To get started using Keychain Services, see <em><a href="../../keychainServConcepts/index.html#//apple_ref/doc/uid/TP30000897" target="_top">Keychain Services Programming Guide</a></em> (Mac OS X only) and <em><a href="../../../Reference/keychainservices/index.html#//apple_ref/doc/uid/TP30000898" target="_top">Keychain Services Reference</a></em>. </p><a name="//apple_ref/doc/uid/TP40002650-SW2" title="Smart Cards"></a><h2>Smart Cards</h2><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_219"></a><p>Because passwords are often insecure—either because the user selects one that's easy to guess or because they are stored insecurely—some businesses and government agencies are starting to use smart cards for authentication. A <strong>smart card</strong> is a plastic card similar in size to a credit card that has memory and a microprocessor embedded in it and is therefore capable of both storing information and processing it. For security purposes, smart cards can store passwords, certificates, and keys. A smart card normally requires a personal identification number (PIN) or biometric measurement (such as a fingerprint) as an additional security measure. Because an attacker needs both the physical card and the PIN, neither stealing the card nor guessing or finding the PIN alone is enough to compromise security. Because it contains a microprocessor, a smart card can carry out its own authentication evaluation offline before releasing information. Smart cards can exchange information with a personal computer through a smart card reader.</p><p>If you use Authorization Services to authenticate users, you don't have to do anything extra to support smart cards—Authorization Services handles interaction with the user and the interface with the card for you. If you want to provide your own smart card, see the description of Apple's smart card project on the ADC Security home page at <span class="content_text"><a href="http://developer.apple.com/security/" target="_top">http://developer.apple.com/security/</a></span>. That page includes a link to Apple’s Smart Card Services SDK code. You must agree to the Apple Public Source License (APSL) before you can download the code. The PC/SC Workgroup (<span class="content_text"><a href="http://www.pcscworkgroup.com/" target="_blank">http://www.pcscworkgroup.com/</a></span>) has established a standard for accessing cards and writing card reader drivers. Apple is a core member of the PC/SC Workgroup.</p><a name="//apple_ref/doc/uid/TP40002650-CHDHDIBB" title="Secure Communication"></a><h2>Secure Communication</h2><p>One important aspect of computer security is the secure communication of data over a network. Mac OS X and iPhone OS use the SSL and TLS protocols and provide the Secure Transport (Mac OS X only), CFNetwork, and URL Loading System APIs for secure communication. No network should be considered to be secure without the use of a secure networking protocol. Even if you are using an internal network with no connections to the Internet, you need to use secure communication protocols and encryption to protect critical data. In a 2005 security survey by <em>CSO</em> magazine (in cooperation with the U.S. Secret Service and Carnegie Mellon University Software Engineering Institute's CERT Coordination Center), 23% of respondents said current or former employees were the greatest cyber security threat. Because 21% of the companies surveyed weren't sure who was the greatest threat, the real number may be higher. Software to intercept network communication packets is readily available. It's not paranoia to think that one of your employees might be trying to steal secrets over your internal network.</p><a name="//apple_ref/doc/uid/TP40002650-SW3" title="Secure Transport"></a><h3>Secure Transport</h3><div class="notebox"><a name="//apple_ref/doc/uid/TP40002650-SW6" title="iPhone OS Note"></a><p><strong>iPhone OS Note:</strong>&nbsp;The Secure Transport programming interface is not available in iPhone OS. Use the CFNetwork programming interface instead.</p></div><p><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_220"></a>Secure Transport is Apple’s implementation of <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_221"></a>SSL and <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_222"></a><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_223"></a>TLS, used to create secure connections over TCP/IP connections such as the Internet. You can use the Secure Transport API to set parameters for a secure session, open and maintain a session, and close a session.</p><p><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_224"></a><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_225"></a><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_226"></a>SSL and TLS use certificate-based authentication (see <span class="content_text"><a href="SecuritySvcs.html#//apple_ref/doc/uid/TP40002650-CHDDDBDF">“Certificates”</a></span>) to ensure that you are communicating with a valid server, they validate data to prevent tampering, and they can use public-key cryptography to guard against eavesdropping or message forgery. SSL is built into all major browsers and web servers (the most recent versions also include TLS). Whenever you use a secure website—for example, to send your credit card number to a vendor over the Internet—and see a protocol identifier of <code><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_227"></a>https</code> rather than <code>http</code> at the beginning of the URL—you are using SSL or TLS for communication. </p><p>Although the TLS protocol is not interoperable with SSL, Secure Transport switches to SSL 3.0 if it cannot negotiate a TLS session with the other end of the connection. </p><p>Secure Transport has no transport-layer dependencies; it can be used with BSD sockets, Open Transport, or any other transport-layer protocol available. </p><p>To get started with Secure Transport, see <em><a href="../../../Reference/secureTransportRef/index.html#//apple_ref/doc/uid/TP30000155" target="_top">Secure Transport Reference</a></em>. For sample code, see <em><a href="../../../../../samplecode/SSLSample/index.html#//apple_ref/doc/uid/DTS10001088" target="_top">SSLSample</a></em>. For more information on the SSL standard, see <span class="content_text"><a href="http://wp.netscape.com/eng/ssl3/" target="_blank">http://wp.netscape.com/eng/ssl3/</a></span> and for the TLS standard, see <span class="content_text"><a href="http://www.ietf.org/html.charters/tls-charter.html" target="_blank">http://www.ietf.org/html.charters/tls-charter.html</a></span>. </p><a name="//apple_ref/doc/uid/TP40002650-CHDFGEIH" title="CFNetwork"></a><h3>CFNetwork</h3><p><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_228"></a>CFNetwork is an API for creating, sending, and receiving serialized messages over a network. CFNetwork can be used to set up and maintain a secure SSL or TLS networking session. It lets you add authentication information to a message and specify an SSL or TLS protocol version to encrypt and decrypt the data stream. For more information about the CFNetwork API, see <em><a href="../../../../Networking/Conceptual/CFNetwork/index.html#//apple_ref/doc/uid/TP30001132" target="_top">CFNetwork Programming Guide</a></em>. For more complete support for SSL and TLS, use Secure Transport.</p><a name="//apple_ref/doc/uid/TP40002650-TPXREF103" title="URL Loading System"></a><h3>URL Loading System</h3><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_229"></a><p>The URL Loading System is a high-level API that you can use to access the contents of <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_230"></a><code>HTTP://</code>, <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_231"></a><code>HTTPS://</code>, and <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_232"></a><code>FTP://</code> URLs. Because <code>HTTPS://</code> websites use <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_233"></a>SSL or <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_234"></a>TLS to protect data transfers, you can use the URL Loading System as a secure transport API. See <em><a href="../../../../Cocoa/Conceptual/URLLoadingSystem/index.html#//apple_ref/doc/uid/10000165i" target="_top">URL Loading System</a></em> for information about this API.</p><a name="//apple_ref/doc/uid/TP40002650-CHDIGAIC" title="Security Interface Framework"></a><h2>Security Interface Framework</h2><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_235"></a><div class="notebox"><a name="//apple_ref/doc/uid/TP40002650-SW7" title="iPhone OS Note"></a><p><strong>iPhone OS Note:</strong>&nbsp;The Security Interface Framework is not available in iPhone OS. In iPhone OS, applications are restricted in their use of the keychain, and it is not necessary for the user to create a new keychain or change keychain settings.</p></div><p>One way to avoid adding security vulnerabilities to your code is to use Apple's security APIs whenever possible. The Security Interface Framework API provides security-related UI elements, as follows:</p><ul class="ul"><li class="li"><p>The<a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_236"></a><code>SFAuthorizationView</code> class implements an authorization view in a window. An authorization view is a lock icon and accompanying text that indicates whether an operation can be performed. When the user clicks a closed lock icon, an authorization dialog displays. Once the user is authorized, the lock icon appears open. When the user clicks the open lock, Authorization Services restricts access again and changes the icon to the closed state.</p></li><li class="li"><p>The <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_237"></a><code>SFCertificateView</code> and <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_238"></a><code>SFCertificatePanel</code> classes display the contents of a certificate. </p></li><li class="li"><p>The <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_239"></a><code>SFCertificateTrustPanel</code> class displays and optionally lets the user edit the trust settings in a certificate. </p></li><li class="li"><p>The <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_240"></a><code>SFChooseIdentityPanel</code> class displays a list of identities in the system and lets the user select one. (In this context, <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_241"></a><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_242"></a><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_243"></a><strong>identity</strong> refers to the combination of a private key and its associated certificate.)  </p></li><li class="li"><p>The <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_244"></a><code>SFKeychainSavePanel</code> class adds an interface to an application that lets the user save a new keychain. The user interface is nearly identical to that used for saving a file. The difference is that this class returns a keychain in addition to a filename and lets the user specify a password for the keychain.</p></li><li class="li"><p>The <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_245"></a><code>SFKeychainSettingsPanel</code> class displays an interface that lets the user change keychain settings.  </p></li></ul><p>Documentation for the Security Interface framework is in <em><a href="../../../Reference/SecurityObjectiveC/index.html#//apple_ref/doc/uid/TP30000996" target="_top">Security Interface Framework Reference</a></em>.</p><a name="//apple_ref/doc/uid/TP40002650-CHDDFIAC" title="Movie Toolbox Access Keys"></a><h2>Movie Toolbox Access Keys</h2><p><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_246"></a><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_247"></a>Movie Toolbox Access Keys is a QuickTime API that provides password protection to QuickTime data. You can add password protection to a QuickTime movie—so that only users who know the password can view the movie—or you can add password protection to data, so that only an application that has registered that access key can get access to the data. </p><p>For documentation on Movie Toolbox Access Keys, see <span class="content_text"><a href="../../../../QuickTime/RM/MovieInternals/MTTimeSpace/G-Chapter/7MovieToolboxAccessK.html#//apple_ref/doc/uid/TP40000911-MovieToolboxAccessKeys" target="_top">Movie Toolbox Access Keys</a></span>. This API is not available in iPhone OS.</p><a name="//apple_ref/doc/uid/TP40002650-TPXREF104" title="User-Level Security Features"></a><h2>User-Level Security Features</h2><p>There are many security features built into Mac OS X and iPhone OS, including industry-standard digital signatures and encryption for Apple’s Mail application, and authentication for the Safari web browser. In iPhone OS, these features are largely invisible to the user, as security is handled by the system without the user’s intervention. in Mac OS X, the four features most visible to users are:</p><ul class="ul"><li class="li"><p> Security system preferences</p></li><li class="li"><p>FileVault, which users can configure through Security system preferences</p></li><li class="li"><p>Accounts system preferences</p></li><li class="li"><p>The Keychain Access application</p></li></ul><a name="//apple_ref/doc/uid/TP40002650-TPXREF105" title="Security System Preferences"></a><h3>Security System Preferences</h3><p><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_248"></a>Security system preferences let the user configure FileVault (discussed next) and control some aspects of authorization on the computer, such as whether the user is automatically logged in on startup and whether a password is needed to wake from sleep. The default settings tend to be chosen more for user convenience than for security. If your code handles secure data, you should encourage your users to select more secure settings for these preferences.</p><p>At the bottom of the dialog is the lock icon provided by the authorization view (see <span class="content_text"><a href="SecuritySvcs.html#//apple_ref/doc/uid/TP40002650-CHDIGAIC">“Security Interface Framework”</a></span>). When this icon shows a closed lock, authorization is required before the user can change the settings in this system preferences dialog.</p><a name="//apple_ref/doc/uid/TP40002650-TPXREF106" title="FileVault"></a><h3>FileVault</h3><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_249"></a><p>When the user turns on <strong>FileVault</strong>, Mac OS X uses 128-bit <strong>AES encryption</strong> to encrypt everything in the user’s home folder. The AES (Advanced Encryption Standard) is a symmetric-key algorithm adopted by the National Institute of Standards and Technology (NIST) as a standard for government and private use to protect sensitive, nonclassified data. It enables very fast and highly secure encryption and decryption of data. </p><p>As long as the user is authenticated and logged in, the system automatically unencrypts any file the user opens. However, no other user can gain access to these files. This option provides maximum security for a user's files if all sensitive data is stored in the user's home directory, if automatic login is disabled, and if a password is required to wake from sleep or from the screen saver. If a user wants to securely store files somewhere other than their home directory (such as on an external hard disk or removable media), they can create an encrypted disk image.</p><p>Full documentation of the AES algorithm is available on the NIST website at <span class="content_text"><a href="http://csrc.nist.gov/CryptoToolkit/aes/" target="_blank">http://csrc.nist.gov/CryptoToolkit/aes/</a></span>.</p><a name="//apple_ref/doc/uid/TP40002650-SW4" title="Accounts System Preferences"></a><h3>Accounts System Preferences</h3><p>When a user installs Mac OS X on a computer, that user automatically becomes a member of the <code>admin</code> group. Subsequently, the user or any other member of the <code>admin</code> group can use <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_250"></a>Accounts system preferences to add new users to the system. </p><p>For each new user, the administrator can specify whether that user is a member of the <code>admin</code> group. If a FileVault master password has been set, the administrator can also turn on FileVault for the new account. </p><p>If the new user is not a member of the <code>admin</code> group, the administrator can limit the system features and applications to which that user has access.</p><a name="//apple_ref/doc/uid/TP40002650-CHDIFGGC" title="Keychain Access"></a><h3>Keychain Access</h3><p><a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_251"></a><strong>Keychain Access</strong> is a utility that gives users access to Keychain Services (see <span class="content_text"><a href="SecuritySvcs.html#//apple_ref/doc/uid/TP40002650-CHDDJIHA">“Keychain”</a></span>). A user can see the passwords, certificates, and other data that are stored in their keychain. They can create new keychains, add and delete keychain items, lock and unlock keychains, and select one keychain to be the default.</p><p>Keychain Access lets the user see what <a name="//apple_ref/doc/uid/TP40002650-DontLinkElementID_252"></a>certificates are available for use by email and web applications, who owns each certificate, and who issued each certificate. Certificates are described in <span class="content_text"><a href="SecuritySvcs.html#//apple_ref/doc/uid/TP40002650-CHDDDBDF">“Certificates.”</a></span></p><p>The user can see and change passwords stored for various applications and can securely store other secrets such as credit card numbers and notes. When a keychain is locked and an application needs to gain access to a keychain item, Keychain Services prompts the user for a password. </p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="TypesSecVuln.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="BufferOverflows.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-05-23<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Security/Conceptual/SecureCodingGuide/Articles/SecuritySvcs.html%3Fid%3DTP40002415-2.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Security/Conceptual/SecureCodingGuide/Articles/SecuritySvcs.html%3Fid%3DTP40002415-2.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Security/Conceptual/SecureCodingGuide/Articles/SecuritySvcs.html%3Fid%3DTP40002415-2.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
