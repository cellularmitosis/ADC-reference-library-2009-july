<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Retrieving the Variable-Length Data From an Item(IM: XU)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING200></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="GXEnvironment-199.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="GXEnvironment-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="GXEnvironment-445.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="GXEnvironment-201.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="GXEnvironment-2.html"><B>QuickDraw GX Environment and Utilities</B></A> / <BR><DD><A HREF="GXEnvironment-182.html"><B>Chapter 5 - Collection Manager</B></A> / <A HREF="GXEnvironment-188.html"><B>Using the Collection Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING200-0></A>
<H2><A NAME=MARKER-9-77></A>Retrieving the Variable-Length Data From an Item</H2>
 The Collection Manager provides three functions that return a copy of the information in an item's variable-length data. These three functions differ in how they allow you to specify which item you want information about:<P>
<UL>
<LI>The <CODE>GetCollectionItem</CODE> function requires that you specify the collection tag and collection ID of the desired item.
<LI>The <CODE>GetIndexedCollectionItem</CODE> function requires that you specify the collection index of the desired item.
<LI>The <CODE>GetTaggedCollectionItem</CODE> function requires that you specify the collection tag and tag list position of the desired item.<P>
</UL>
<DL>
<DT><B>Note</B>
<DD>The Collection Manager also provides the utility function <CODE>GetCollectionItemHdl</CODE>, which returns a copy of the item's data in a block of memory referenced by a Macintosh Memory Manager handle, rather than a pointer. See <A HREF=GXEnvironment-262.html#MARKER-9-255>page 5-94</A> for more information about this function.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 These functions each return two pieces of information about the specified item--the size of its variable-length data and a copy of the data itself. You can specify that you want to determine either the size or the data or both (or neither, actually, although that doesn't prove to be very useful).<P>
 Typically, you call these functions twice:<P>
<UL>
<LI>once to determine the size of the data (if you don't already know the size)
<LI>once (after allocating enough memory) to obtain a copy of the data.<P>
</UL>
 <A HREF=#MARKER-9-80>Listing 5-15</A> shows how to use the <CODE>GetCollectionItem</CODE> function to retrieve the variable-length data from an item. This sample code uses the <CODE>pointsAndQuotes</CODE> collection defined in <A HREF=GXEnvironment-193.html#MARKER-9-43>"Adding Items to a Collection" beginning on page 5-17</A>.<P>
<B>Listing 5-15  <A NAME=MARKER-9-80></A>Retrieving the variable-length data from an item</B><P>
<PRE>
long theSize;
char *theData;
.
.
.
anErr = GetCollectionItem(pointsAndQuotes,
                          'QUOT', 0, /* tag and id */
                          &amp;theSize,
                          dontWantData);
                       
theData = (char *) NewPtr(theSize);

anErr = GetCollectionItem(pointsAndQuotes,
                          'QUOT', 0,
                          dontWantSize,
                          theData);
</PRE>
 If you specify a non-<CODE>NIL</CODE> value for the size parameter, the <CODE>GetCollectionItem</CODE> function returns in the size parameter the actual number of bytes of the item's data. <P>
 If you specify non-<CODE>NIL</CODE> values for both the size and data parameters, the number of bytes returned in the data parameter is either the value specified by the size parameter or the actual number of bytes of the specified item's data, whichever is lower. <P>
 You can also use the <CODE>GetIndexedCollectionItem</CODE> function to retrieve an item's data, given the item's collection index rather than its collection tag and collection ID, as shown in <A HREF=#MARKER-9-81>Listing 5-16</A>.<P>
<B>Listing 5-16  <A NAME=MARKER-9-81></A>Retrieving the variable-length data from an item using the item's index</B><P>
<PRE>
long index;
long theSize;
char *theData;
.
.
.
/* get the index and data size */
anErr = GetCollectionItemInfo(pointsAndQuotes, 
                              'QUOT', 0, /* tag and id */
                              &amp;index, 
                              &amp;theSize, 
                              dontWantAttributes;
.
.
.
theData = (char *) NewPtr(theSize);

anErr = GetIndexedCollectionItem(pointsAndQuotes,
                                 index,
                                 dontWantSize,
                                 theData);
</PRE>
 Similarly, you can use the <CODE>GetTaggedCollectionItem</CODE> function to retrieve an item's data, given the item's collection tag and tag list position, as shown in <A HREF=#MARKER-9-82>Listing 5-17</A>.<P>
<B>Listing 5-17  <A NAME=MARKER-9-82></A>Retrieving the variable-length data from an item using the tag and tag list position</B><P>
<PRE>
long index;
long theSize;
char *theData;
.
.
.
anErr = GetTaggedCollectionItem(pointsAndQuotes,
                                'QUOT',
                                1, /* first of the 'QUOT' items */
                                &amp;theSize,
                                dontWantData);
                       
theData = (char *) NewPtr(theSize);

anErr = GetTaggedCollectionItem(pointsAndQuotes,
                                'QUOT',
                                1, /* first of the 'QUOT' items */
                                dontWantSize,
                                (void *) theData);
</PRE>
 For more information about identifying collection items, see <A HREF=GXEnvironment-187.html#MARKER-9-23>"Methods of Identifying Collection Items" on page 5-11</A>. <P>
 For more information about the <CODE>GetCollectionItem,</CODE> <CODE>GetIndexedCollectionItem</CODE>, and <CODE>GetTaggedCollectionItem</CODE> functions, see <A HREF=GXEnvironment-240.html#MARKER-9-195>"Retrieving the Variable-Length Data From an Item" beginning on page 5-70</A>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="GXEnvironment-199.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="GXEnvironment-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="GXEnvironment-445.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="GXEnvironment-201.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="GXEnvironment-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
