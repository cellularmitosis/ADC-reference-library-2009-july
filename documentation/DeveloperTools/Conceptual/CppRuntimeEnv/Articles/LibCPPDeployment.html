<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>C++ Runtime Environment Programming Guide: Deploying Applications With the C++ Runtime</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Deploying Applications With the C++ Runtime"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001668" title="Deploying Applications With the C++ Runtime"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000436" target="_top">Tools</a> &gt; <a href="../../../CompilersDebuggers-date.html#//apple_ref/doc/uid/TP30000440-TP30000436-TP30001025" target="_top">Compiling &amp; Debugging</a> &gt; <a href="../index.html" target="_top">C++ Runtime Environment Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="CPPROverview.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="CompatibleLibs.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/TP40001668-SW2" title="Deploying Applications With the C++ Runtime"></a><hr /><H1><a name="//apple_ref/doc/uid/TP40001668-BCIFHCHA" title="Deploying Applications With the C++ Runtime"></a>Deploying Applications With the C++ Runtime</H1><p>In most situations, you should never have to worry about linking against the C++ runtime environment. When you build your C++ code, GCC chooses the most appropriate version of the C++ standard library and links to it. For applications compiled using GCC 3.3, the compiler links to the static C++ standard library <code>libstdc++.a</code>. For applications compiled using GCC 4.0, the compiler links to the dynamic C++ standard library <code>libstdc++.dylib</code> by default (<code>libstdc++.a</code> is also available as an option). </p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001668-DontLinkElementID_11" title="Note"></a><p><strong>Note:</strong>&nbsp;Whenever you build C++ programs for earlier versions of Mac OS X, be sure to use the SDKs that come with XCode Tools. For more information on using these SDKs, see <em><a href="../../cross_development/index.html#//apple_ref/doc/uid/10000163i" target="_top">Cross-Development Programming Guide</a></em>. </p></div><p>The following sections describe issues you may encounter when linking against the dynamic runtime or the new static runtime. There are no known issues worth noting for deploying code using the original static C++ runtime. </p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="LibCPPDeployment.html#//apple_ref/doc/uid/TP40001668-SW3">Caveats for Using the New C++ Runtimes</a>
				
			<br/>
			
        
			
			
				<a href="LibCPPDeployment.html#//apple_ref/doc/uid/TP40001668-DontLinkElementID_5">Deploying With the New Dynamic Runtime</a>
				
			<br/>
			
        
			
			
				<a href="LibCPPDeployment.html#//apple_ref/doc/uid/TP40001668-SW1">Deploying With the New Static Runtime</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001668-SW3" title="Caveats for Using the New C++ Runtimes"></a><h2>Caveats for Using the New C++ Runtimes</h2><p>The following caveats apply to the new static and dynamic C++ runtimes. </p><ul class="ul"><li class="li"><p>If your program must run on versions of Mac OS X prior to 10.3.9, as well as Mac OS X v10.3.9 and later, you must use the GCC 3.3 compiler and build your program using the original static C++ standard library (<code>libstdc++.a</code>).</p></li><li class="li"><p>Applications that run on Mac OS X 10.3.9 must not try to use the <code>long double</code> type or any of the functions associated with it. Support for the 128-bit <code>long double</code> type was not introduced until Mac OS X 10.4. Similarly, full support for <code>sinl</code>, <code>expl</code>, and all other <code>long double</code> math functions defined by the C standard is available only in 10.4 and later.</p></li><li class="li"><p>When overriding the <code>new</code> and <code>delete</code> operators, your overrides will be visible across shared library boundaries (application wide) unless you specifically takes steps to make them hidden (such as with an (un)export list).  Even uses of <code>new</code>/<code>delete</code> in system frameworks, in the dynamic C++ runtime (even if you are only indirectly linked to it) or in other modules (possibly linked statically or dynamically to the C++ runtime) will use your overrides, unless that module also has overridden <code>new</code>/<code>delete</code> operators.</p><p>Unless you are sure that code modules are using the same operator <code>new</code> and <code>delete</code>, do not transfer memory ownership across shared library boundaries. </p></li><li class="li"><p>Multithreaded applications which use the standard stream (<code>std::cin</code>, <code>std::cout</code>, and so on) must explicitly synchronize their use of these global objects if there is any chance that two threads may simultaneously access one of them. Functions that set global state (such as <code>set_terminate</code>, <code>set_unexpected</code>, and so on) must also be explicitly synchronized if multiple threads can call them at once.  In general:</p><ol class="ol"><li class="li"><p> It is safe to simultaneously call <code>const</code> and non-<code>const</code> methods from different threads to distinct objects.</p></li><li class="li"><p>It is safe to simultaneously call <code>const</code> methods, and methods otherwise guaranteed not to alter the state of an object (or invalidate outstanding references and iterators of a container) from different threads to the same object.</p></li><li class="li"><p>It is not safe for different threads to simultaneously access the same object when at least one thread calls non-<code>const</code> methods, or methods that invalidate outstanding references or iterators to the object. The programmer is responsible for using thread synchronization primitives to avoid such situations.</p></li></ol></li></ul><a name="//apple_ref/doc/uid/TP40001668-DontLinkElementID_5" title="Deploying With the New Dynamic Runtime"></a><h2>Deploying With the New Dynamic Runtime</h2><p>This is the library used by default when using GCC 4.0 and is appropriate when targeting Mac OS X v10.3.9 and later. For a list of caveats for using this library, see <span class="content_text"><a href="LibCPPDeployment.html#//apple_ref/doc/uid/TP40001668-SW3">“Caveats for Using the New C++ Runtimes.”</a></span>  </p><a name="//apple_ref/doc/uid/TP40001668-SW1" title="Deploying With the New Static Runtime"></a><h2>Deploying With the New Static Runtime</h2><p>In Xcode 2.3, a new version of the static C++ standard library <code>libstdc++-static.a</code> was introduced.  You can link against the new static C++ standard library using Xcode 2.3 or the command line. To link against the library using Xcode, simply set "C++ Standard Library Type" in the build settings to "Static".  To link against this library on the command line, use <code>gcc</code> instead of <code>g++</code> and append the following two commands to the end of the command: <code>-shared-libgcc</code> and <code>-lstdc++-static</code>. For example:</p><div class="codesample"><table><tr><td scope="row"><pre>gcc one.o two.o -o my_application -shared-libgcc -lstdc++-static<span></span></pre></td></tr></table></div><div class="notebox"><a name="//apple_ref/doc/uid/TP40001668-DontLinkElementID_12" title="Note"></a><p><strong>Note:</strong>&nbsp;The extra options to specify the static C++ runtime must appear at the end of the command. </p></div><p>For a list of caveats for using this library, see <span class="content_text"><a href="LibCPPDeployment.html#//apple_ref/doc/uid/TP40001668-SW3">“Caveats for Using the New C++ Runtimes”</a></span> and the next section. </p><a name="//apple_ref/doc/uid/TP40001668-DontLinkElementID_6" title="Additional Caveats for Using the New Static Runtime"></a><h3>Additional Caveats for Using the New Static Runtime</h3><p>The new static C++ standard library marks all of its symbols as "hidden", which means those symbols are not exported by an application that links to the library. It is still possible, however, for symbols from the C++ library to be exported by your application. For example, your application might include symbols from the library in header files or other visible locations. To prevent symbols from being accidentally exported, you must use an export list for any binaries that link against the static C++ library. (For more information about the use of export lists, see <em><!--a target="_top" -->Xcode 2.3 User Guide<!--/a--></em>. For information on using visibility pragmas and visibility switches to control symbol visibility in your own code, see <span class="content_text"><a href="SymbolVisibility.html#//apple_ref/doc/uid/TP40001670-CJBGBHEJ">“Controlling Symbol Visibility.”</a></span>) </p><div class="warningbox"><img src="../../../../Resources/Images/icon_warning.gif" alt="!" width="20" height="20" border="0" class="warningicon" /><a name="//apple_ref/doc/uid/TP40001668-DontLinkElementID_13" title="Warning:"></a><p><strong>Warning:</strong>&nbsp;Remember that the system frameworks continue to use the dynamic version of the C++ standard library. If you link your binary against the static C++ library and one or more system frameworks, you may run into namespace conflicts. You must ensure that no C++ symbols (symbols starting with <code>_Z</code>) are exported from binaries that use the static C++ standard library. If it does export such symbols, your binary may potentially stop working after the installation of a system upgrade, software update, or security update. </p><p></p><div class="clear"></div></div><p>Callback functions (such as registered with <code>std::set_terminate</code>) are only effective when triggered within the same code module.</p><p>This static library has the same size disadvantages as the one used with gcc 3.3.  For details about this issue, see <span class="content_text"><a href="CPPROverview.html#//apple_ref/doc/uid/TP40001667-97487">“Advantages of a Shared C++ Runtime .”</a></span></p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="CPPROverview.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="CompatibleLibs.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2005, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-06-28<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/DeveloperTools/Conceptual/CppRuntimeEnv/Articles/LibCPPDeployment.html%3Fid%3DTP40001666-1.4&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/DeveloperTools/Conceptual/CppRuntimeEnv/Articles/LibCPPDeployment.html%3Fid%3DTP40001666-1.4&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/DeveloperTools/Conceptual/CppRuntimeEnv/Articles/LibCPPDeployment.html%3Fid%3DTP40001666-1.4&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
