<!-- legacy work start --><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"        "http://www.w3.org/TR/html4/loose.dtd"><!-- legacy work end --><HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><TITLE> Sound Compression and Expansion (deprecated)</title><!-- legacy work start -->        <META NAME="Generator" CONTENT="manual">        <META http-equiv="content-type" CONTENT="text/html;charset=utf-8">        <META NAME = "Copyright" CONTENT="Copyright 2007 Apple Inc. All Rights Reserved.">        <META NAME="IndexTitle" CONTENT="Sound Input Manager (Not Recommended)">        <meta name="xcode-display" content="render">        <LINK REL="stylesheet" TYPE="text/css" HREF="../../../Resources/CSS/frameset_styles.css"> <!-- before submitting, globally replace ".." with "developer.apple.com" -->        <script type="text/javascript" language="JavaScript" src="../../../Resources/JavaScript/page.js"></script><!-- legacy work end --></HEAD><BODY BGCOLOR="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- path goes here --><!-- QTnavbar start --><P><I>Inside Macintosh: Sound</I><P>| <A target="doc" HREF="imsoundmgr.8.htm">Previous</A> | <A target="doc" HREF="imsoundmgr.1.htm">Chapter contents</A> | <A target="doc" HREF="imsoundmgr.htm">Chapter top</A> | <A target="doc" HREF="imsoundmgr.2.htm">Section top</A> | <A target="doc" HREF="imsoundmgr.a.htm">Next</a> | <!-- QTnavbar end --><!-- legacy work start --><script type="text/javascript"> placeWatermark()</script><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox" style="position: relative;"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b><i>Sound Input Manager</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="http://developer.apple.com/referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div><!-- legacy work end --><H1 CLASS="H2.Heading2"><A NAME="pgfId=3115"> </A><A NAME="14645"> </A>Sound Compression and Expansion</H1><P CLASS="T0.Text0"><A NAME="pgfId=3116"> </A><A NAME="marker=588"> </A><A NAME="marker=584"> </A><A NAME="marker=579"> </A>One minute of monophonic sound recorded with the fidelity you would expect from a commercial compact disc occupies about 5.3 MB of disk space. One minute of sound digitized by the current low-fidelity digitizing peripherals for Macintosh computers occupies more than 1 MB of disk space. Even one minute of telephone-quality speech takes up more than half of a megabyte on a disk. Despite the increased capacities of mass-storage devices, disk space can be a problem if your application incorporates large amounts of sampled sound. The space problem is particularly acute for multimedia applications. Because a large portion of the space occupied by a multimedia application is likely to be taken up by sound data, the complexity and richness of the application's sound component are limited.<A NAME="marker=206"> </A></P><P CLASS="T1.Text1"><A NAME="pgfId=3117"> </A><A NAME="marker=1076"> </A>To help remedy this problem, the Sound Manager includes a set of routines known collectively as <B CLASS="bold">Macintosh Audio Compression and Expansion</B> <B CLASS="bold">(MACE).</B> MACE enables you to provide more audio information in a given amount of storage space by allowing you to compress sound data and then expand it for playback. These enhancements are based entirely in software and require no specialized hardware.</P><P CLASS="T1.Text1"><A NAME="pgfId=3118"> </A>The audio compression and expansion features allow you to enhance your application by including more audio data. MACE also relieves some distribution problems by reducing the number of disks required for shipping an application that relies heavily on sound. MACE has made some kinds of applications, such as talking dictionaries and foreign language-instruction software, more feasible than before.</P><P CLASS="T1.Text1"><A NAME="pgfId=3119"> </A>MACE adds three main kinds of capabilities to those already present in the Sound Manager: audio data compression, real-time expansion and playback of compressed audio data, and buffered expansion and playback of compressed audio data.</P><UL><LI CLASS="B1.Bullet1"><A NAME="pgfId=3120"> </A><B CLASS="bold">Compression.</B> The Sound Manager can compress a buffer of digital audio data either in the original buffer or in a separate buffer. If a segment of audio data is too large to fit into a single buffer, your application can make repeated calls to the compression routine.</LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=3121"> </A><B CLASS="bold">Real-time expansion playback.</B> The Sound Manager can expand compressed audio data contained in a small internal buffer and play it back at the same time. Because the audio data expansion and playback occur at the same time, there is more of a strain on the CPU when using this method of sound expansion rather than buffered expansion.<A NAME="marker=1570"> </A></LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=3122"> </A><B CLASS="bold">Buffered expansion.</B> The Sound Manager can expand a specified buffer of compressed audio data and store the result in a separate buffer. The expanded buffer can then be played back using other Sound Manager routines with minimal processor overhead during playback. Applications that require screen updates or user interaction during playback (such as animation or multimedia applications) should use buffered expansion.<A NAME="marker=1571"> </A></LI></UL><P CLASS="T1.Text1"><A NAME="pgfId=3123"> </A>MACE provides audio data compression and expansion capabilities in ratios of either 3:1 or 6:1 for all currently supported Macintosh models, from the Macintosh Plus forward. The principal tradeoff when using MACE is that the expanded audio data suffers a loss of fidelity in comparison to the original data. A small amount of noise is introduced into a 3:1 compressed sound when it is expanded and played back, and a greater amount of noise for the 6:1 ratio. The 3:1 buffer-to-buffer compression and expansion option is well suited for high-fidelity sounds. The 6:1 buffer-to-buffer compression and expansion option provides greater compression at the expense of lower-fidelity results and is recommended for voice data only. This technique reduces the frequency bandwidth of the audio signal by a factor of two to achieve the higher compression ratio.</P><P CLASS="T1.Text1"><A NAME="pgfId=2052"> </A>MACE allows for the compression of both monophonic and stereo sounds. However, some Macintosh computer models (such as the Macintosh Plus and Macintosh SE) cannot expand stereo sounds.<A NAME="marker=31"> </A></P><P CLASS="Note"><A NAME="pgfId=3132"> </A>With Sound Manager versions prior to 3.0, some Macintosh computers play only the right channel of stereo <TT CLASS="cv">'snd&nbsp;'</TT> data through the internal speaker. Certain Macintosh II models can play only a single channel through the internal speaker. Sound Manager version 3.0 removes both of these limitations.  </P><P CLASS="T1.Text1"><A NAME="pgfId=3133"> </A>Existing applications that use the Sound Manager's <TT CLASS="cv">SndPlay</TT> function to play digitized audio signals can play compressed audio signals without modification or recompilation.<A NAME="marker=1081"> </A></P><P CLASS="T1.Text1"><A NAME="pgfId=2896"> </A>The MACE routines assume that each original sample consists of 8-bit sound in binary offset format. The compression techniques do not, however, depend on a particular <B CLASS="bold">sample rate</B> (the rate at which samples are recorded). <A target="doc" HREF="imsoundmgr.9.htm#41736" CLASS="XRef">Table 1-2</A> shows some common sample rates, expressed both as hertz and as unsigned fixed-point values.<A NAME="marker=372"> </A></P><TABLE><CAPTION><P CLASS="Tb.Table"><A NAME="pgfId=4100"> </A>Table&nbsp;2 <A NAME="41736"> </A>Sample rates</P></CAPTION><TR><TH ROWSPAN="1" COLSPAN="1"><P CLASS="TbH.TblHd"><A NAME="pgfId=2833"> </A>Rate (Hz)</P></TH><TH ROWSPAN="1" COLSPAN="1"><P CLASS="TbH.TblHd"><A NAME="pgfId=2834"> </A>Sample rate value (Fixed)</P></TH></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=2843"> </A>44100.00000</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=2844"> </A>$AC440000</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=2841"> </A>22254.54545</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=2842"> </A>$56EE8BA3</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=2845"> </A>22050.00000</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=2846"> </A>$56EE8BA3</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=2839"> </A>11127.27273</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=2840"> </A>$2B7745D1</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=2848"> </A>11025.00000</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=2849"> </A>$2B110000</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=2837"> </A>7418.1818</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=2838"> </A>$1CFA2E8B</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=2835"> </A>5563.6363</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=2836"> </A>$15BBA2E8</P></TD></TR></TABLE><P CLASS="T1.Text1"><A NAME="pgfId=4084"> </A>The Sound Manager defines constants for the most common sample rates:</P><CODE CLASS="Cv.Code"><A NAME="pgfId=9659"> </A>CONST<BR>&nbsp;&nbsp;&nbsp;&nbsp;rate44khz&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $AC440000;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{44100.00000 in fixed-point}<BR>&nbsp;&nbsp;&nbsp;&nbsp;rate22khz&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $56EE8BA3;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{22254.54545 in fixed-point}<BR>&nbsp;&nbsp;&nbsp;&nbsp;rate22050hz&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $56220000;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{22050.00000 in fixed-point}<BR>&nbsp;&nbsp;&nbsp;&nbsp;rate11khz&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $2B7745D1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{11127.27273 in fixed-point}<BR>&nbsp;&nbsp;&nbsp;&nbsp;rate11025hz&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $2B110000;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{11025.00000 in fixed-point}<BR></CODE><P CLASS="T1.Text1"><A NAME="pgfId=2775"> </A><A NAME="marker=9661"> </A>The compression techniques produce their best quality output when the sample rate is the same as the output rate of the sound hardware of the machine playing the audio data. The output rate used in most current Macintosh computers is 22.254 kilohertz (hereafter referred to as the 22&nbsp;kHz rate). Because of speed limitations, the Macintosh Plus and Macintosh SE cannot perform sample-rate conversion during expansion playback. On those machines, all sounds are played back at a 22&nbsp;kHz rate. To provide consistent quality in sounds that might be played on different machines, you should record all sounds at a 22&nbsp;kHz sample rate.<A NAME="marker=203"> </A><A NAME="marker=371"> </A><A NAME="marker=1083"> </A></P><P CLASS="T1.Text1"><A NAME="pgfId=2051"> </A>The MACE algorithms are optimized to provide the best sound quality possible through the internal speaker in real time. However, the user who employs high-quality speakers might notice a high-frequency hiss for some sounds compressed at the 3:1 ratio. This hiss results from a design tradeoff between maintaining real-time operation on the Macintosh Plus and preserving as much frequency bandwidth of the signal as possible. If you think that your output might be played on high-quality speakers, you might want to filter out the hiss before compression by passing the audio output through an equalizer that removes frequencies above 10&nbsp;kHz. When you use the 6:1 compression and expansion ratio, your frequency response is cut in half. For example, when you use the 22&nbsp;kHz sample rate, the highest frequency possible would normally be 11&nbsp;kHz; however, after compressing and expanding the data at the 6:1 ratio, the highest frequency you could get would be only 5.5&nbsp;kHz.<A NAME="marker=590"> </A><A NAME="marker=591"> </A><A NAME="marker=207"> </A><A NAME="marker=1577"> </A></P><P CLASS="Note"><A NAME="pgfId=3082"> </A>The Sound Manager uses compressions and decompression components (codecs) to handle the MACE capabilities. You can provide custom codecs to use other compression and decompression algorithms. See the chapter &quot;Sound Components&quot; in this book for information on developing audio codecs. </P><hr>&#169; 1999 Apple Computer, Inc.<!-- QTnavbar start --><P><I>Inside Macintosh: Sound</I><P>| <A target="doc" HREF="imsoundmgr.8.htm">Previous</A> | <A target="doc" HREF="imsoundmgr.1.htm">Chapter contents</A> | <A target="doc" HREF="imsoundmgr.htm">Chapter top</A> | <A target="doc" HREF="imsoundmgr.2.htm">Section top</A> | <A target="doc" HREF="imsoundmgr.a.htm">Next</a> | <!-- QTnavbar end --><!-- legacy work start --><script type="text/javascript"> placeWatermark()</script><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox" style="position: relative;"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b><i>Sound Input Manager</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="http://developer.apple.com/referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div><!-- legacy work end --></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY></HTML>