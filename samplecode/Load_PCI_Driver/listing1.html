<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>

	<!-- BEGIN META TAG INFO -->
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<link rel="home" href="http://developer.apple.com/">
	<link rel="find" href="http://developer.apple.com/search/">
	<link rel="stylesheet" type="text/css" href="../../documentation/css/adcstyle.css" title="fonts">
	<script language="JavaScript" src="../../documentation/js/adc.js" type="text/javascript"></script>
	<!-- END META TAG INFO -->
	
	<!-- BEGIN TITLE -->
	<title>Load PCI Driver - /FullPath.c</title>
	<!-- END TITLE -->
<script language="JavaScript">
function JumpToNewPage() {
	window.location=document.scpopupmenu.gotop.value;
	return true;
}
</script>

</head>

<!-- BEGIN BODY OPEN -->
<body>
<!--END BODY OPEN -->

<!-- START CENTER OPEN -->
<center>
<!-- END CENTER OPEN -->

	<!-- BEGIN LOGO AND SEARCH -->
	<!--#include virtual="/includes/adcnavbar"-->
	<!-- END LOGO AND SEARCH -->
		
		
	<!-- START BREADCRUMB -->
	<div id="breadcrumb">
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td scope="row"><img width="340" height="10" src="images/1dot.gif" alt=""></td>
			<td><img width="340" height="10" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr valign="middle">
			<td align="left" colspan="2">
			<a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../samplecode/index.html">Sample Code</a> &gt; <a href="../../samplecode/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../samplecode/LegacyTechnologies/idxHardwareDrivers-date.html">Hardware & Drivers</a> &gt; <A HREF="javascript:location.replace('index.html');">Load PCI Driver</A> &gt; 
			</td>
		</tr>
		<tr>
			<td colspan="2" scope="row"><img width="680" height="35" src="images/1dot.gif" alt=""></td>
		</tr>
	</table>
	</div>
	<!-- END BREADCRUMB -->

	<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/HardwareDrivers/index.html" target="_blank">Reference Library > Hardware & Drivers</a></li>
	</ul>
</div>




</div></div></div>

	<!-- START MAIN CONTENT -->
	
	<!-- START TITLE GRAPHIC AND INTRO-->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td><h1><div id="pagehead">Load PCI Driver</div></h1></td>
		</tr>
	</table>
	<!-- END TITLE GRAPHIC AND INTRO -->
	<!-- START WIDE COLUMN -->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td id="scdetails">
				<h2>/FullPath.c</h2>
				<form name="scpopupmenu" onSubmit="return false;" method=post>
				<p><strong>View Source Code:</strong> 
					<select name="gotop" onChange="JumpToNewPage();" style="width:340px"><option selected value="ingnore">Select File</option>
<option value="listing1.html">/FullPath.c</option>
<option value="listing2.html">/FullPath.h</option>
<option value="listing3.html">/Load PCI Driver.c</option>
<option value="listing4.html">/MoreFiles/DirectoryCopy.h</option>
<option value="listing5.html">/MoreFiles/FileCopy.h</option>
<option value="listing6.html">/MoreFiles/FSpCompat.h</option>
<option value="listing7.html">/MoreFiles/IterateDirectory.h</option>
<option value="listing8.html">/MoreFiles/MoreDesktopMgr.h</option>
<option value="listing9.html">/MoreFiles/MoreFiles.h</option>
<option value="listing10.html">/MoreFiles/MoreFilesExtras.h</option>
<option value="listing11.html">/MoreFiles/Optimization.h</option>
<option value="listing12.html">/MoreFiles/OptimizationEnd.h</option>
<option value="listing13.html">/MoreFiles/Search.h</option>
<option value="listing14.html">/SimpleApp/SimpleApp.h</option></select>
				</p>
				</form>
				<p><strong><a href="Load_PCI_Driver.zip">Download Sample</a></strong> (&#147;Load_PCI_Driver.zip&#148;, 340.5K)<BR>
<strong><a href="Load_PCI_Driver.dmg">Download Sample</a></strong> (&#147;Load_PCI_Driver.dmg&#148;, 445.4K)</p>
				<!--
				<p><strong><a href="#">Download Sample</a></strong> (&#147;filename.sit&#148;, 500K)</p>
				-->
			</td>
		</tr>
		<tr>
			<td scope="row"><img width="680" height="10" src="images/1dot.gif" alt=""><br>
			<img height="1" width="680" src="images/1dot_919699.gif" alt=""><br>
			<img width="680" height="20" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr>
			<td scope="row">
	<!--googleon: index -->
<pre class="sourcecodebox">/*  File:    FullPath.c  Contains:  Routines for dealing with full pathnames... if you really must.  Written by:     Copyright:  Copyright &copy; 1995-1999 by Apple Computer, Inc., All Rights Reserved.        You may incorporate this Apple sample source code into your program(s) without        restriction. This Apple sample source code has been provided &quot;AS IS&quot; and the        responsibility for its operation is yours. You are not permitted to redistribute        this Apple sample source code as &quot;Apple sample source code&quot; after having made        changes. If you're going to re-distribute the source, we require that you make        it clear in the source that the code was descended from Apple sample source        code, but that you've made changes.  Change History (most recent first):        8/3/1999  Karl Groethe  Updated for Metrowerks Codewarror Pro 2.1        */#include &lt;Types.h&gt;#include &lt;Errors.h&gt;#include &lt;Memory.h&gt;#include &lt;Files.h&gt;#include &lt;TextUtils.h&gt;#include &lt;Aliases.h&gt;#include &quot;FSpCompat.h&quot;#include &quot;FullPath.h&quot;#define  __COMPILINGMOREFILES/*  IMPORTANT NOTE:    The use of full pathnames is strongly discouraged. Full pathnames are  particularly unreliable as a means of identifying files, directories  or volumes within your application, for two primary reasons:    *   The user can change the name of any element in the path at virtually    any time.  *  Volume names on the Macintosh are *not* unique. Multiple    mounted volumes can have the same name. For this reason, the use of    a full pathname to identify a specific volume may not produce the    results you expect. If more than one volume has the same name and    a full pathname is used, the File Manager currently uses the first    mounted volume it finds with a matching name in the volume queue.    In general, you should use a file's name, parent directory ID, and  volume reference number to identify a file you want to open, delete,  or otherwise manipulate.    If you need to remember the location of a particular file across  subsequent system boots, use the Alias Manager to create an alias record  describing the file. If the Alias Manager is not available, you can save  the file's name, its parent directory ID, and the name of the volume on  which it's located. Although none of these methods is foolproof, they are  much more reliable than using full pathnames to identify files.    Nonetheless, it is sometimes useful to display a file's full pathname to  the user. For example, a backup utility might display a list of full  pathnames of files as it copies them onto the backup medium. Or, a  utility might want to display a dialog box showing the full pathname of  a file when it needs the user's confirmation to delete the file. No  matter how unreliable full pathnames may be from a file-specification  viewpoint, users understand them more readily than volume reference  numbers or directory IDs. (Hint: Use the TruncString function from  TextUtils.h with truncMiddle as the truncWhere argument to shorten  full pathnames to a displayable length.)    The following technique for constructing the full pathname of a file is  intended for display purposes only. Applications that depend on any  particular structure of a full pathname are likely to fail on alternate  foreign file systems or under future system software versions.*//*****************************************************************************/pascal  OSErr  GetFullPath(short vRefNum,              long dirID,              ConstStr255Param name,              short *fullPathLength,              Handle *fullPath){  OSErr    result;  FSSpec    spec;    *fullPathLength = 0;  *fullPath = NULL;    result = FSMakeFSSpecCompat(vRefNum, dirID, name, &amp;spec);  if ( result == noErr )  {    result = FSpGetFullPath(&amp;spec, fullPathLength, fullPath);  }    return ( result );}/*****************************************************************************/pascal  OSErr  FSpGetFullPath(const FSSpec *spec,                 short *fullPathLength,                 Handle *fullPath){  OSErr    result;  FSSpec    tempSpec;  CInfoPBRec  pb;    *fullPathLength = 0;  *fullPath = NULL;    /* Make a copy of the input FSSpec that can be modified */  BlockMoveData(spec, &amp;tempSpec, sizeof(FSSpec));    if ( tempSpec.parID == fsRtParID )  {    /* The object is a volume */        /* Add a colon to make it a full pathname */    ++tempSpec.name[0];    tempSpec.name[tempSpec.name[0]] = ':';        /* We're done */    result = PtrToHand(&amp;tempSpec.name[1], fullPath, tempSpec.name[0]);  }  else  {    /* The object isn't a volume */        /* Is the object a file or a directory? */    pb.dirInfo.ioNamePtr = tempSpec.name;    pb.dirInfo.ioVRefNum = tempSpec.vRefNum;    pb.dirInfo.ioDrDirID = tempSpec.parID;    pb.dirInfo.ioFDirIndex = 0;    result = PBGetCatInfoSync(&amp;pb);    if ( result == noErr )    {      /* if the object is a directory, append a colon so full pathname ends with colon */      if ( (pb.hFileInfo.ioFlAttrib &amp; ioDirMask) != 0 )      {        ++tempSpec.name[0];        tempSpec.name[tempSpec.name[0]] = ':';      }            /* Put the object name in first */      result = PtrToHand(&amp;tempSpec.name[1], fullPath, tempSpec.name[0]);      if ( result == noErr )      {        /* Get the ancestor directory names */        pb.dirInfo.ioNamePtr = tempSpec.name;        pb.dirInfo.ioVRefNum = tempSpec.vRefNum;        pb.dirInfo.ioDrParID = tempSpec.parID;        do  /* loop until we have an error or find the root directory */        {          pb.dirInfo.ioFDirIndex = -1;          pb.dirInfo.ioDrDirID = pb.dirInfo.ioDrParID;          result = PBGetCatInfoSync(&amp;pb);          if ( result == noErr )          {            /* Append colon to directory name */            ++tempSpec.name[0];            tempSpec.name[tempSpec.name[0]] = ':';                        /* Add directory name to beginning of fullPath */            (void) Munger(*fullPath, 0, NULL, 0, &amp;tempSpec.name[1], tempSpec.name[0]);            result = MemError();          }        } while ( (result == noErr) &amp;&amp; (pb.dirInfo.ioDrDirID != fsRtDirID) );      }    }  }  if ( result == noErr )  {    /* Return the length */    *fullPathLength = GetHandleSize(*fullPath);  }  else  {    /* Dispose of the handle and return NULL and zero length */    if ( *fullPath != NULL )    {      DisposeHandle(*fullPath);    }    *fullPath = NULL;    *fullPathLength = 0;  }    return ( result );}/*****************************************************************************/pascal OSErr FSpLocationFromFullPath(short fullPathLength,                   const void *fullPath,                   FSSpec *spec){  AliasHandle  alias;  OSErr    result;  Boolean    wasChanged;  Str32    nullString;    /* Create a minimal alias from the full pathname */  nullString[0] = 0;  /* null string to indicate no zone or server name */  result = NewAliasMinimalFromFullPath(fullPathLength, fullPath, nullString, nullString, &amp;alias);  if ( result == noErr )  {    /* Let the Alias Manager resolve the alias. */    result = ResolveAlias(NULL, alias, spec, &amp;wasChanged);        DisposeHandle((Handle)alias);  /* Free up memory used */  }  return ( result );}/*****************************************************************************/pascal OSErr LocationFromFullPath(short fullPathLength,                  const void *fullPath,                  short *vRefNum,                  long *parID,                  Str31 name){  OSErr  result;  FSSpec  spec;    result = FSpLocationFromFullPath(fullPathLength, fullPath, &amp;spec);  if ( result == noErr )  {    *vRefNum = spec.vRefNum;    *parID = spec.parID;    BlockMoveData(&amp;spec.name[0], &amp;name[0], spec.name[0] + 1);  }  return ( result );}/*****************************************************************************/</pre>
	<!--googleoff: index -->
			</td>
		</tr>
	</table>
	<!-- END WIDE COLUMN -->

	<!-- END MAIN CONTENT -->
		<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/samplecode/Load_PCI_Driver/listing1.html%3Fid%3DDTS10000439-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/samplecode/Load_PCI_Driver/listing1.html%3Fid%3DDTS10000439-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/samplecode/Load_PCI_Driver/listing1.html%3Fid%3DDTS10000439-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

	<!-- START BOTTOM APPLE NAVIGATION -->
	<!--#include virtual="/includes/footer"-->
	<!-- END BOTTOM APPLE NAVIGATION -->

<!-- START CENTER CLOSE -->
</center>
<!-- END CENTER CLOSE -->

</body>
</html>