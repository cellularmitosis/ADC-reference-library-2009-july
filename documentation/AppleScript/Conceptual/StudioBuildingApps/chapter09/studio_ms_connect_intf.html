<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>AppleScript Studio Programming Guide: Mail Search Tutorial: Connect the Interface</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Mail Search Tutorial: Connect the Interface"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20001256" title="Mail Search Tutorial: Connect the Interface"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../ScriptingAutomation/index.html#//apple_ref/doc/uid/TP30000440-TP40005948" target="_top">Scripting &amp; Automation</a> &gt; <a href="../../../../ScriptingAutomation/AppleScript-date.html#//apple_ref/doc/uid/TP30000440-TP40005948-TP30000481" target="_top">AppleScript</a> &gt; <a href="../chapter01/studio_intro_book.html#//apple_ref/doc/uid/20001248-TPXREF101">AppleScript Studio Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../chapter08/studio_ms_create_intf.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../chapter10/studio_write_code.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/20001256-TPXREF101" title="Mail Search Tutorial: Connect the Interface"></a><h1>Mail Search Tutorial: Connect the Interface</h1><p>Mail Search is a fairly complex AppleScript Studio application that searches for specified text in messages in the Mac OS X Mail application. In previous chapters you’ve designed the application, created a project, and built the user interface with the Interface Builder application. In this chapter, you connect objects in the interface to handlers in the application’s script file.</p><p>This chapter assumes you have completed previous Mail Search tutorial chapters.</p><a name="//apple_ref/doc/uid/20001256-TPXREF155" title="Connect the Interface"></a><h2>Connect the Interface</h2><p>Now that you’ve built Mail Search’s interface, you need to perform additional steps in Interface Builder to connect objects in the interface to event handlers in the project. In <span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-BCIHEBHE">“Event Handlers in Mail Search,”</a></span> you identified handlers that would be needed for various objects. You don’t need any handlers for the status dialog or the message window, but you do need to make connections for Mail Search’s application object and search window. For the search window, you also need to connect data source objects to provide data to the search results and mailbox views. (A data source object, described in more detail below, is a special object supplied by AppleScript Studio that provides row and column data to a table or outline view.) The next sections describe how to make these connections.</p><a name="//apple_ref/doc/uid/20001256-TPXREF182" title="Connect the Application Object"></a><h3>Connect the Application Object</h3><p>The application object in an AppleScript Studio application is represented by the File’s Owner object in the Instances tab in the MainMenu.nib window. This object is described in <span class="content_text"><a href="../chapter03/studio_components.html#//apple_ref/doc/uid/20001250-TPXREF161">“Interface Creation”</a></span> and shown in <span class="content_text">Figure 8-1</span>. Your application can use this object to connect handlers that are called at various interesting times, such as when the application is launched or activated. For a look at the available handlers, see <span class="content_text">Figure 8-2</span>.</p><br/><div><a name="//apple_ref/doc/uid/20001256-BCIHBJAA" title="Figure 8-1The File&acirc;&#128;&#153;s Owner instance in the MainMenu.nib window"></a><p><strong>Figure 8-1&nbsp;&nbsp;</strong>The File’s Owner instance in the MainMenu.nib window</p><img src = "../art/files_owner_in_nib.gif" alt = "The File’s Owner instance in the MainMenu.nib window" width="389" height="268"></div><br/><p>Mail Search uses the <code>will finish launching</code> handler to perform necessary initialization after the application has created its interface but has not yet completed launching. To connect this handler, perform the following steps:</p><ol class="ol"><li class="li"><p>Select the File’s Owner object in the Instances tab in the MainMenu.nib window, as shown in <span class="content_text">Figure 8-1</span>.</p></li><li class="li"><p>Choose Show Info from the Tools menu or type Command-Shift-I to open the Info window. Use the pop-up menu at the top of the window to display the AppleScript pane. Then click the disclosure triangle to reveal the handlers in the Application group. The result is shown in <span class="content_text">Figure 8-2</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001256-BCIDEIDE" title="Figure 8-2The Info window for the File&acirc;&#128;&#153;s Owner instance"></a><p><strong>Figure 8-2&nbsp;&nbsp;</strong>The Info window for the File’s Owner instance</p><img src = "../art/files_owner_info.gif" alt = "The Info window for the File’s Owner instance" width="289" height="647"></div></li><li class="li"><p>To connect the handler, perform the following steps:</p><ol class="ol"><li class="ol ol"><p>Select the <code>will finish launching</code> checkbox.</p></li><li class="ol ol"><p>Select the file <code>Mail Search.applescript</code> in the Script list.</p></li><li class="ol ol"><p>Click the Edit Script button.</p></li></ol><p>When you click the Edit Script button, Interface Builder inserts an empty <code>will finish launching</code> handler in the script file and opens the file in an Xcode editor window. The handler is shown in <span class="content_text">Listing 8-1</span>. You add statements to this handler in <span class="content_text"><a href="../chapter10/studio_write_code.html#//apple_ref/doc/uid/20001257-TPXREF195">“Application Object Handler.”</a></span></p><div class="notebox"><a name="//apple_ref/doc/uid/20001256-DontLinkElementID_53" title="Note"></a><p><strong>Note:</strong>&nbsp;All event handlers start with the keyword <code>on</code>. Handlers can have zero or more parameters. The <code>will finish launching</code> handler has one parameter, <code>theObject</code>, which represents the user interface object that received the <code>clicked</code> message. Most event handlers in AppleScript Studio have this same parameter.</p></div><a name="//apple_ref/doc/uid/20001256-CJBJHEGF" title="Listing 8-1A new handler declaration for the will finish launching handler"></a><br/><br/><p class="codesample"><strong>Listing 8-1&nbsp;&nbsp;</strong>A new handler declaration for the <code>will finish launching</code> handler</p><div class="codesample"><table><tr><td scope="row"><pre>on will finish launching theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    (*Add your script here.*)<span></span></pre></td></tr><tr><td scope="row"><pre>end will finish launching<span></span></pre></td></tr></table></div></li><li class="li"><p>When you create a new event handler for an object, you should also insert a comment that specifies which object initiates calls to the handler. In this case, you could add the line <code>(* "Called from the application object just prior to completion of launching." *)</code>. In some cases, more than one object of the same type may be connected to the handler. This situation is described in <span class="content_text"><a href="../chapter04/studio_detail.html#//apple_ref/doc/uid/20001251-TPXREF180">“Deciding How Many Script Files to Use.”</a></span></p></li><li class="li"><p>To verify that the handler is correctly connected, you can replace the comment <code>(*Add your script here.*)</code> with <code>display dialog "In the will finish launching handler."</code></p><p>You can build and run the application by typing Command-R, choosing Build and Run from the Build menu, or clicking the Build and Run button. You should see the dialog after the application launches.</p><p>As you work through additional sections that connect handlers, you can use the same techniques to verify that the handlers are working.</p><div class="importantbox"><a name="//apple_ref/doc/uid/20001256-DontLinkElementID_54" title="Important:"></a><p><strong>Important:</strong>&nbsp;After editing a script file in Xcode, you should always save it before returning to Interface Builder to add more connections.</p><p></p></div></li><li class="li"><p>As always, save the nib file after completing your changes.</p></li></ol><p>As noted in <span class="content_text"><a href="../chapter08/studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-TPXREF165">“Add the Message Window to the Nib File,”</a></span> the first time you make a change in the AppleScript pane, Interface Builder adds a new instance named AppleScript Info to the nib window.</p><a name="//apple_ref/doc/uid/20001256-TPXREF183" title="Connect Interface Items in the Search Window"></a><h3>Connect Interface Items in the Search Window</h3><p>The search window is the main place where you connect Mail Search’s interface to event handlers. You also need to connect data source objects to provide data to the search results and mailbox views. To make these connections, perform these steps, which are described in detail in the sections that follow:</p><ol class="ol"><li class="li"><p>Connect event handlers to the search window.</p></li><li class="li"><p>Connect an event handler to the text field.</p></li><li class="li"><p>Connect an event handler to the find button.</p></li><li class="li"><p>Connect an event handler to the search results view.</p></li><li class="li"><p>Connect data source objects to the mailboxes view and the search results view.</p></li></ol><a name="//apple_ref/doc/uid/20001256-TPXREF190" title="Connect the Search Window"></a><h4>Connect the Search Window</h4><p>As described in <span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-BCIGJAJC">“Plan the Code,”</a></span> Mail Search needs to know when a search window is opened, activated, or closed. To add these handlers, perform the following steps:</p><ol class="ol"><li class="li"><p>If the Document.nib file is not already open in Interface Builder, open it.</p></li><li class="li"><p>Select the Mail Search instance in the nib window.</p></li><li class="li"><p>Choose Show Info from the Tools menu or type Command-Shift-I to open the Info window. Use the pop-up menu at the top of the window to display the AppleScript pane. Then click the disclosure triangle to reveal the handlers in the Window group. The result is shown in <span class="content_text">Figure 8-3</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001256-BCIIFDBA" title="Figure 8-3The Info window for the Mail Search window instance"></a><p><strong>Figure 8-3&nbsp;&nbsp;</strong>The Info window for the Mail Search window instance</p><img src = "../art/window_info_window.gif" alt = "The Info window for the Mail Search window instance" width="289" height="559"></div></li><li class="li"><p>To connect the handlers, perform the following steps:</p><ol class="ol"><li class="ol ol"><p>Select the checkboxes for <code>became main</code>, <code>will close</code>, and <code>will open</code>.</p></li><li class="ol ol"><p>To connect the handlers, select the checkbox for the script file <code>Mail Search.applescript</code> in the Script list.</p></li><li class="ol ol"><p>Click the Edit Script button.</p></li></ol><p>When you click the Edit Script button, Interface Builder inserts empty handlers for the three event handlers in the script file and opens the file in an Xcode editor window. The handlers are shown in <span class="content_text">Listing 8-2</span>. You add statements to these handlers in <span class="content_text"><a href="../chapter10/studio_write_code.html#//apple_ref/doc/uid/20001257-TPXREF196">“Search Window Handlers.”</a></span></p><a name="//apple_ref/doc/uid/20001256-CJBFICHJ" title="Listing 8-2New handler declarations for several handlers"></a><br/><br/><p class="codesample"><strong>Listing 8-2&nbsp;&nbsp;</strong>New handler declarations for several handlers</p><div class="codesample"><table><tr><td scope="row"><pre>on became main theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    (*Add your script here.*)<span></span></pre></td></tr><tr><td scope="row"><pre>end became main<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>on will close theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    (*Add your script here.*)<span></span></pre></td></tr><tr><td scope="row"><pre>end will close<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>on will open theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    (*Add your script here.*)<span></span></pre></td></tr><tr><td scope="row"><pre>end will open<span></span></pre></td></tr></table></div></li><li class="li"><p>To verify that the handlers are correctly connected, you can add <code>display dialog</code> statements, as described in <span class="content_text"><a href="studio_ms_connect_intf.html#//apple_ref/doc/uid/20001256-TPXREF182">“Connect the Application Object.”</a></span> You may also wish to add comments that the <code>theObject</code> parameter will be a search window object.</p></li></ol><a name="//apple_ref/doc/uid/20001256-TPXREF191" title="Connect the Text Field"></a><h4>Connect the Text Field</h4><p>A user types text to search for in the text field in the search window. In this section, you connect an action handler to the text field so that when a user presses the Enter key, Mail Search initiates a search. To add this handler, perform the following steps:</p><ol class="ol"><li class="li"><p>In Interface Builder, open the Info window for the Mail Search window instance and display the AppleScript pane, as described in <span class="content_text"><a href="studio_ms_connect_intf.html#//apple_ref/doc/uid/20001256-TPXREF182">“Connect the Application Object.”</a></span></p></li><li class="li"><p>Select the text field in the search window.</p></li><li class="li"><p>Click to open the Action group, then select the checkbox for the <code>action</code> handler. The result is shown in <span class="content_text">Figure 8-4</span>.</p><p>Action handlers get their name from a Cocoa concept known as target-action. In this case, pressing the return key can cause a text field object to send an action message to its target (in Cocoa, the target is a method, but here it is a handler). Other examples of action events are <code>clicked</code> and <code>double-clicked</code>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001256-BCIDIJCJ" title="Figure 8-4The Info window for the search text field"></a><p><strong>Figure 8-4&nbsp;&nbsp;</strong>The Info window for the search text field</p><img src = "../art/setting_text_action.gif" alt = "The Info window for the search text field" width="289" height="560"></div></li><li class="li"><p>Connect the handler as in previous sections by selecting the file <code>Mail Search.applescript</code> in the Script list, then click the Edit Script button to open the script in an Xcode editor window.</p><p>The resulting handler declaration is shown in <span class="content_text">Listing 8-3</span>. You add statements to this handler in <span class="content_text"><a href="../chapter10/studio_write_code.html#//apple_ref/doc/uid/20001257-BCIEFGFA">“Text Field Handler.”</a></span></p><a name="//apple_ref/doc/uid/20001256-CJBDAFEC" title="Listing 8-3A new action handler for a text field"></a><br/><br/><p class="codesample"><strong>Listing 8-3&nbsp;&nbsp;</strong>A new <code>action</code> handler for a text field</p><div class="codesample"><table><tr><td scope="row"><pre>on action theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    (*Add your script here.*)<span></span></pre></td></tr><tr><td scope="row"><pre>end action<span></span></pre></td></tr></table></div></li><li class="li"><p>To verify that the handler is correctly connected, you can add <code>display dialog</code> statements, as described in <span class="content_text"><a href="studio_ms_connect_intf.html#//apple_ref/doc/uid/20001256-TPXREF182">“Connect the Application Object.”</a></span> You may also wish to add a comment that the <code>theObject</code> parameter will be a text view object.</p></li></ol><a name="//apple_ref/doc/uid/20001256-TPXREF192" title="Connect the Find Button"></a><h4>Connect the Find Button</h4><p>A user clicks the find button in Mail Search’s search window to initiate a search. To enable this behavior, you connect a <code>clicked</code> handler for the find button. To do so, perform steps similar to those you’ve used in previous sections:</p><ul class="spaceabove"><li class="li"><p>select the find button</p></li><li class="li"><p>open the Info window</p></li><li class="li"><p>display the AppleScript pane</p></li><li class="li"><p>select the checkbox for the <code>clicked</code> handler</p></li><li class="li"><p>To connect the handlers, select the checkbox for the script file <code>Mail Search.applescript</code>; the result is shown in <span class="content_text">Figure 8-5</span>.</p></li><li class="li"><p>click the Edit Script button to insert a <code>clicked</code> handler declaration in the script file</p></li></ul><p>You can examine the resulting handler declaration in Xcode. You add statements to the handler in <span class="content_text"><a href="../chapter10/studio_write_code.html#//apple_ref/doc/uid/20001257-TPXREF197">“Find Button Handler.”</a></span></p><br/><div><a name="//apple_ref/doc/uid/20001256-BCIBBFJD" title="Figure 8-5The Info window for the find button"></a><p><strong>Figure 8-5&nbsp;&nbsp;</strong>The Info window for the find button</p><img src = "../art/find_button_info.gif" alt = "The Info window for the find button" width="289" height="559"></div><br/><a name="//apple_ref/doc/uid/20001256-TPXREF193" title="Connect the Search Results View"></a><h4>Connect the Search Results View</h4><p>Mail Search uses a table view to show search results—the found messages that contain the search text. When a user double-clicks a found message in the table view, Mail Search displays the message in a separate window. To support this behavior, the table view object needs a <code>double-clicked</code> handler.</p><p>To connect a <code>double-clicked</code> handler for the table view in the search window, perform the same steps you’ve used in previous sections:</p><ul class="spaceabove"><li class="li"><p>click, then double-click (and double-click again if necessary) to select the table view</p></li><li class="li"><p>open the Info window</p></li><li class="li"><p>display the AppleScript pane</p></li><li class="li"><p>select the checkbox for the <code>double-clicked</code> handler</p></li><li class="li"><p>select the checkbox for the script file <code>Mail Search.applescript</code></p></li><li class="li"><p>click the Edit Script button to insert a <code>double-clicked</code> handler declaration in the script file</p></li></ul><p>The result before clicking the Edit Script button is shown in <span class="content_text">Figure 8-6</span>.</p><p>In <span class="content_text">Figure 8-6</span>, the Action group and clicked checkboxes have dashes while the double clicked checkbox has a checkmark. A handler checkbox (such as the double clicked checkbox) can have one of three states:</p><ul class="spaceabove"><li class="li"><p>Empty: Indicates there is no handler with that name in the currently selected script.</p></li><li class="li"><p>Dashed: Indicates that there is an event handler with that name in the currently selected script, but that the current object isn’t connected to it (so presumably some other object is).</p></li><li class="li"><p>Checked: Indicates there is an event handler with that name in the currently selected script (or that such a handler will be added when you edit the script), and it is (or will be) connected to the current object in the Info window.</p></li></ul><p>A group checkbox (such as the Action group checkbox) can have one of the same three states:</p><ul class="spaceabove"><li class="li"><p>Empty: Indicates no event handler in that group is checked.</p></li><li class="li"><p>Dashed: Indicates at least one event handler in that group is checked.</p></li><li class="li"><p>Checked: Indicates every event handler in that group is checked.</p></li></ul><br/><div><a name="//apple_ref/doc/uid/20001256-BCICBDGJ" title="Figure 8-6The Info window for the search results table view"></a><p><strong>Figure 8-6&nbsp;&nbsp;</strong>The Info window for the search results table view</p><img src = "../art/table_view_info.gif" alt = "The Info window for the search results table view" width="288" height="559"></div><br/><p>You can examine the resulting <code>double-clicked</code> handler declaration in Xcode. You add statements to the handler in <span class="content_text"><a href="../chapter10/studio_write_code.html#//apple_ref/doc/uid/20001257-TPXREF198">“Search Results Table View Handler.”</a></span></p><a name="//apple_ref/doc/uid/20001256-BCIGBGCD" title="Provide a Data Source Object for the Mailboxes View"></a><h4>Provide a Data Source Object for the Mailboxes View</h4><p>Mail Search uses an outline view to display a list of all mailboxes from all accounts. An outline view can display hierarchical data, similarly to the way the Finder displays directories and files in a list view. The outline view needs to be connected to a <strong>data source object</strong>—a special object supplied by AppleScript Studio that provides row data (in this case, mailbox names) to a table or outline view.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001256-DontLinkElementID_55" title="Note"></a><p><strong>Note:</strong>&nbsp;See the Older Release Notes in Xcode for information on how to create a data source and hook it up with two lines in your script file, rather than following the steps listed here.</p></div><p>To create a data source object and connect it to the outline view in the search window, perform these steps (assuming you still have the search window from the <code>Document.nib</code> file open in Interface Builder, along with the Info window):</p><ol class="ol"><li class="li"><p>Click the AppleScript button in the Palette window toolbar to select the AppleScript pane. There currently is a single image in that pane, representing a data source object.</p></li><li class="li"><p>Drag a data source object from the Palette window to the Document.nib window. The result is shown in <span class="content_text">Figure 8-7</span>. The letters “ASK” come from AppleScriptKit, the framework that defines this data source.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001256-BCIHCHCH" title="Figure 8-7The Document.nib window with a data source object"></a><p><strong>Figure 8-7&nbsp;&nbsp;</strong>The Document.nib window with a data source object</p><img src = "../art/data_source_in_nib.gif" alt = "The Document.nib window with a data source object" width="388" height="267"></div></li><li class="li"><p>Double-click the name (“ASKDataSource”) and change it to “Mailboxes”.</p></li><li class="li"><p>Double-click to select the outline view in the search window. Be sure the view appears as in <span class="content_text"><a href="../chapter08/studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-BCIEAFIB">Figure 7-42</a></span>, so that you know it’s selected.</p></li><li class="li"><p>Press and hold the Control key and drag from the outline view to the data source object in the Document.nib window. This step is shown in <span class="content_text">Figure 8-8</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001256-TPXREF184" title="Figure 8-8Connecting the outline view to the data source object"></a><p><strong>Figure 8-8&nbsp;&nbsp;</strong>Connecting the outline view to the data source object</p><img src = "../art/connecting_outline.gif" alt = "Connecting the outline view to the data source object" width="560" height="730"></div></li><li class="li"><p>At this point, the Info window displays the Connections pane. Double-click the dataSource outlet. This connects the outline view to the data source object. The result is shown in <span class="content_text">Figure 8-9</span>.</p><p>Even though you named the data source “Mailboxes,” the destination of the connection in <span class="content_text">Figure 8-9</span> is still “ASKDataSource.”</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001256-BCIFDCBH" title="Figure 8-9The Info window for the outline view after connecting a data source outlet"></a><p><strong>Figure 8-9&nbsp;&nbsp;</strong>The Info window for the outline view after connecting a data source outlet</p><img src = "../art/info_outline_datasource.gif" alt = "The Info window for the outline view after connecting a data source outlet" width="289" height="558"></div></li><li class="li"><p>Mail Search also needs an identifier for the column header (which has the column title Mailboxes) in the outline view. Data source objects use identifiers specify columns and rows, since they can be shuffled. To provide an identifier, perform these steps:</p><ol class="ol"><li class="ol ol"><p>With the outline view still selected in the search window, click to select the column header.</p></li><li class="ol ol"><p>Choose the Attributes pane in the Info window.</p></li><li class="ol ol"><p>Type “mailboxes” in the Identifier text field. The result is shown in <span class="content_text">Figure 8-10</span>.</p></li></ol><div class="item_figure"><a name="//apple_ref/doc/uid/20001256-BCICJDAB" title="Figure 8-10The Info window after entering an outline column identifier"></a><p><strong>Figure 8-10&nbsp;&nbsp;</strong>The Info window after entering an outline column identifier</p><img src = "../art/info_outline_column.gif" alt = "The Info window after entering an outline column identifier" width="289" height="559"></div></li><li class="li"><p>Don’t forget to periodically save the nib file.</p></li></ol><a name="//apple_ref/doc/uid/20001256-BCICCIGJ" title="Examining an Object Hierarchy in the Nib View"></a><h4>Examining an Object Hierarchy in the Nib View</h4><p>In <span class="content_text"><a href="../chapter08/studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-TPXREF181">“Group the Outline View and Table View in a Split View,”</a></span> you saw that once you have a series of deeply nested views, it can become difficult to select one of them. However, Interface Builder provides a mechanism to make it easier to display view hierarchies and connections, and to select nested objects. That mechanism consists of displaying the nib window in outline view. In this case, “outline view” refers to a mode of window display, not an outline view object.</p><p><span class="content_text">Figure 8-11</span> shows the Document.nib window after connecting a data source for the outline view object.</p><br/><div><a name="//apple_ref/doc/uid/20001256-BCIBHFAE" title="Figure 8-11The Document.nib window"></a><p><strong>Figure 8-11&nbsp;&nbsp;</strong>The Document.nib window</p><img src = "../art/document_nib.gif" alt = "The Document.nib window" width="388" height="267"></div><br/><p>By clicking the small outline view icon on the right-hand side of the view, you can display contents of the window in outline view, as shown in <span class="content_text">Figure 8-12</span>.</p><br/><div><a name="//apple_ref/doc/uid/20001256-BCIBBDJI" title="Figure 8-12The Document.nib window in outline view"></a><p><strong>Figure 8-12&nbsp;&nbsp;</strong>The Document.nib window in outline view</p><img src = "../art/document_nib_outline.gif" alt = "The Document.nib window in outline view" width="462" height="322"></div><br/><p>In this case, the window shows the expanded hierarchy for the search window. Instead of interface objects (such as buttons), it shows the Cocoa classes for the objects (NSButton). You can view the hierarchy for any object in the nib window. Double-clicking an object (such as NSOutlineView (Mailboxes)) in the Instances tab selects the object in its window, providing a simple way to select a nested item such as an outline view within a scroller within a split view. If the Info window is open, it also displays the object in the Info window.</p><p>To examine the connections for an object, you click the small triangles next to it in the right-hand column. For example, <span class="content_text">Figure 8-13</span> shows the connections for the NSOutlineView object (the mailboxes outline view).</p><br/><div><a name="//apple_ref/doc/uid/20001256-BCIEBEDH" title="Figure 8-13Connections for the NSOutlineView object"></a><p><strong>Figure 8-13&nbsp;&nbsp;</strong>Connections for the NSOutlineView object</p><img src = "../art/outline_connections.gif" alt = "Connections for the NSOutlineView object" width="463" height="321"></div><br/><a name="//apple_ref/doc/uid/20001256-TPXREF194" title="Provide a Data Source Object for the Search Results View"></a><h4>Provide a Data Source Object for the Search Results View</h4><p>Mail Search uses a table view to display the messages found by a search. The table includes columns for the message sender, the message subject, and the message mailbox. The table view needs to be connected to a data source object that provides row data to the table view.</p><p>To create a data source object and connect it to the table view in the search window, perform the same series of steps you used to connect a data source to the outline view in <span class="content_text"><a href="studio_ms_connect_intf.html#//apple_ref/doc/uid/20001256-BCIGBGCD">“Provide a Data Source Object for the Mailboxes View.”</a></span> Assuming you still have the search window from the <code>Document.nib</code> file open in Interface Builder, along with the Info window, the steps include:</p><ol class="ol"><li class="li"><p>Drag a data source object from the AppleScript pane in the Palette window to the Document.nib window.</p></li><li class="li"><p>Change the name of the data source object from “ASKDataSource” to “Messages”.</p></li><li class="li"><p>Select the table view in the search window, then press and hold the Control key and drag from the table view to the Messages data source object in the Document.nib window.</p></li><li class="li"><p>Double-click the dataSource outlet in the Connections pane of the Info window. to connect the table view to the data source object. The result is shown in <span class="content_text">Figure 8-14</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001256-BCIJAJCA" title="Figure 8-14The Info window for the table view after connecting a data source outlet"></a><p><strong>Figure 8-14&nbsp;&nbsp;</strong>The Info window for the table view after connecting a data source outlet</p><img src = "../art/info_table_datasource.gif" alt = "The Info window for the table view after connecting a data source outlet" width="289" height="558"></div></li><li class="li"><p>You also need to provide an identifier for each column header (the column headers are titled From, Subject, and Mailbox) in the table view. To do so, perform these steps:</p><ol class="ol"><li class="ol ol"><p>With the table view still selected in the search window, click to select the column header.</p></li><li class="ol ol"><p>Choose the Attributes pane in the Info window.</p></li><li class="ol ol"><p>Type the name (either “from,” “subject,” or “mailbox”) in the Identifier text field. Save your results after typing each new identifier. The result for the From column header is shown in <span class="content_text">Figure 8-15</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001256-BCIHEBAD" title="Figure 8-15The Info window after entering a table column identifier"></a><p><strong>Figure 8-15&nbsp;&nbsp;</strong>The Info window after entering a table column identifier</p><img src = "../art/info_column_from.gif" alt = "The Info window after entering a table column identifier" width="289" height="560"></div></li></ol></li><li class="li"><p>As always, save the Document nib file after completing your changes.</p></li></ol><p>You have now completed connecting the interface for the Mail Search application.</p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../chapter08/studio_ms_create_intf.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../chapter10/studio_write_code.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2001, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-04-04<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/chapter09/studio_ms_connect_intf.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/chapter09/studio_ms_connect_intf.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/chapter09/studio_ms_connect_intf.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>