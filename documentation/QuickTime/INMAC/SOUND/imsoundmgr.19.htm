<!-- legacy work start --><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"        "http://www.w3.org/TR/html4/loose.dtd"><!-- legacy work end --><HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><TITLE> Obtaining Information About All Sound Channels (deprecated)</title><!-- legacy work start -->        <META NAME="Generator" CONTENT="manual">        <META http-equiv="content-type" CONTENT="text/html;charset=utf-8">        <META NAME = "Copyright" CONTENT="Copyright 2007 Apple Inc. All Rights Reserved.">        <META NAME="IndexTitle" CONTENT="Sound Input Manager (Not Recommended)">        <meta name="xcode-display" content="render">        <LINK REL="stylesheet" TYPE="text/css" HREF="../../../Resources/CSS/frameset_styles.css"> <!-- before submitting, globally replace ".." with "developer.apple.com" -->        <script type="text/javascript" language="JavaScript" src="../../../Resources/JavaScript/page.js"></script><!-- legacy work end --></HEAD><BODY BGCOLOR="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- path goes here --><!-- QTnavbar start --><P><I>Inside Macintosh: Sound</I><P>| <A target="doc" HREF="imsoundmgr.18.htm">Previous</A> | <A target="doc" HREF="imsoundmgr.1.htm">Chapter contents</A> | <A target="doc" HREF="imsoundmgr.htm">Chapter top</A> | <A target="doc" HREF="imsoundmgr.14.htm">Section top</A> | <A target="doc" HREF="imsoundmgr.1a.htm">Next</a> | <!-- QTnavbar end --><!-- legacy work start --><script type="text/javascript"> placeWatermark()</script><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox" style="position: relative;"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b><i>Sound Input Manager</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="http://developer.apple.com/referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div><!-- legacy work end --><H1 CLASS="H3.Heading3"><A NAME="pgfId=3681"> </A>Obtaining Information About All Sound Channels<A NAME="marker=800"> </A></H1><P CLASS="T0.Text0"><A NAME="pgfId=3682"> </A>You can use the <TT CLASS="cv">SndManagerStatus</TT> function to determine information about all the sound channels that are currently allocated by all applications. For example, you can use this function to determine how many channels are currently allocated. One of the parameters required by the <TT CLASS="cv">SndManagerStatus</TT> function is a pointer to a Sound Manager status record, which you must allocate before calling <TT CLASS="cv">SndManagerStatus</TT>. A&nbsp;Sound Manager status record has this structure:<A NAME="marker=283"> </A><A NAME="marker=1606"> </A></P><CODE CLASS="Cv.Code"><A NAME="pgfId=9817"> </A>TYPE SMStatus =<BR>PACKED RECORD<BR>&nbsp;&nbsp;&nbsp;&nbsp;smMaxCPULoad:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Integer;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{maximum load on all channels}<BR>&nbsp;&nbsp;&nbsp;&nbsp;smNumChannels:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Integer;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{number of allocated channels}<BR>&nbsp;&nbsp;&nbsp;&nbsp;smCurCPULoad:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Integer;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{current load on all channels}<BR>END;<BR></CODE><P CLASS="T1.Text1"><A NAME="pgfId=2740"> </A><A NAME="marker=9819"> </A>The <TT CLASS="cv">smNumChannels</TT> field contains the number of sound channels currently allocated. This does not mean that the channels are actually being used, only that they have been created with the <TT CLASS="cv">SndNewChannel</TT> function and not yet disposed.</P><P CLASS="T1.Text1"><A NAME="pgfId=2742"> </A>The Sound Manager uses information that it returns in the <TT CLASS="cv">smMaxCPULoad</TT> and <TT CLASS="cv">smCurCPULoad</TT> fields to help it determine whether it can allocate a new channel when&nbsp;your application calls the <TT CLASS="cv">SndNewChannel</TT> function. The Sound Manager sets <TT CLASS="cv">smMaxCPULoad</TT> to a default value of 100 at startup time, and the <TT CLASS="cv">smCurCPULoad</TT> field reflects the approximate percentage of CPU processing power currently taken by allocated sound channels.</P><P CLASS="W.Warning"><A NAME="pgfId=2743"> </A>Your application should not reply on the values returned in the <TT CLASS="cv">smMaxCPULoad</TT> and <TT CLASS="cv">smCurCPULoad</TT> fields. To determine if it is safe to allocate a channel, simply try to allocate it with the <TT CLASS="cv">SndNewChannel</TT> function. That function returns the appropriate result code if allocating the channel would put too much of a strain on CPU processing. <A NAME="marker=1172"> </A></P><P CLASS="T1.Text1"><A NAME="pgfId=3689"> </A><A NAME="marker=1180"> </A><A target="doc" HREF="imsoundmgr.19.htm#29419" CLASS="XRef">Listing 1-24</A> illustrates the use of <TT CLASS="cv">SndManagerStatus</TT>. It defines a function that returns the number of sound channels currently allocated by all applications.<A NAME="marker=768"> </A></P><P CLASS="L.Listing"><A NAME="pgfId=3690"> </A>Listing&nbsp;24 <A NAME="29419"> </A>Determining the number of allocated sound channels</P><CODE CLASS="Cv.Code"><A NAME="pgfId=9823"> </A>FUNCTION MyGetNumChannels: Integer;<BR>VAR<BR>&nbsp;&nbsp;&nbsp;&nbsp;myErr:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OSErr;<BR>&nbsp;&nbsp;&nbsp;&nbsp;mySMStatus:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMStatus;<BR>BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;MyGetNumChannels := 0;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myErr := SndManagerStatus (Sizeof(SMStatus), @mySMStatus);<BR>&nbsp;&nbsp;&nbsp;&nbsp;IF myErr = noErr THEN<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MyGetNumChannels := mySMStatus.smNumChannels;<BR>END;<BR></CODE><hr>&#169; 1999 Apple Computer, Inc.<!-- QTnavbar start --><P><I>Inside Macintosh: Sound</I><P>| <A target="doc" HREF="imsoundmgr.18.htm">Previous</A> | <A target="doc" HREF="imsoundmgr.1.htm">Chapter contents</A> | <A target="doc" HREF="imsoundmgr.htm">Chapter top</A> | <A target="doc" HREF="imsoundmgr.14.htm">Section top</A> | <A target="doc" HREF="imsoundmgr.1a.htm">Next</a> | <!-- QTnavbar end --><!-- legacy work start --><script type="text/javascript"> placeWatermark()</script><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox" style="position: relative;"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b><i>Sound Input Manager</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="http://developer.apple.com/referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div><!-- legacy work end --></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY></HTML>