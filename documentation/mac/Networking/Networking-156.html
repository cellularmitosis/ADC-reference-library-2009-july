<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>The ATP Parameter Block(IM:N)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING156></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Networking-155.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Networking-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Networking-304.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt= "Book Index"></A> <A HREF="Networking-157.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Networking-2.html"><B>Networking</B></A> / <BR><DD><A HREF="Networking-143.html"><B>Chapter 6 - AppleTalk Transaction Protocol (ATP)</B></A> / <A HREF="Networking-153.html"><B>ATP Reference</B></A><BR><DL><DD><A HREF="Networking-154.html"><B>Data Structures</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING156-0></A>
<H3><A NAME=MARKER-9-115></A><A NAME=MARKER-21-116></A>The ATP Parameter Block<A NAME=MARKER-2-50></A></H3>
 <A NAME=MARKER-14-118></A><A NAME=MARKER-2-85></A>The ATP functions require a pointer to an ATP parameter block that is used to pass the input and output parameters associated with the function. The <A NAME=MARKER-2-120></A><CODE>ATPParamBlock</CODE> data type defines the ATP parameter block. The ATP parameter block includes variant records <A NAME=MARKER-2-121></A>for the fields that are particular to an ATP routine. <P>
 This section defines the fields that are common to all ATP functions that use the ATP parameter block. (The <CODE>BuildBDS</CODE> function does not use the ATP parameter block.) These common fields are either filled in by the MPW interface or returned by the function; your application does not need to provide values for these fields. This section does not define reserved fields, which are used internally by the .ATP driver or not at all. The fields that are used for specific functions only are defined in the descriptions of the functions to which they apply. <P>
<PRE>
TYPE ATPParamBlock = 
PACKED RECORD
   qLink:         QElemPtr;         {reserved}
   qType:         Integer;          {reserved}
   ioTrap:        Integer;          {reserved}
   ioCmdAddr:     Ptr;              {reserved}
   ioCompletion:  ProcPtr;          {completion routine}
   ioResult:      OSErr;            {result code}
   userData:      Longint;          {ATP user bytes}
   reqTID:        Integer;          {request transaction ID}
   ioRefNum:      Integer;          {driver reference number}
   csCode:        Integer;          {call command code}
   atpSocket:     Byte;             {currBitMap or socket number}
   CASE MPPParmType OF 
      SendRequestParm,
      SendResponseParm,
      GetRequestParm,
      AddResponseParm,
      KillSendReqParm:
         (atpFlags:        Byte;    {control information}
         addrBlock:        AddrBlock;  
                                    {source/dest. socket address}
         reqLength:        Integer; {request/response length}
         reqPointer:       Ptr;     {ptr to request/response data}
         bdsPointer:       Ptr;     {ptr to response BDS}
      CASE MPPParmType OF
         SendRequestParm:
            (numOfBuffs:   Byte;    {number of responses expected}
            timeOutVal:    Byte;    {timeout interval}
            numOfResps:    Byte;    {number of responses }
                                    { actually received}
            retryCount:    Byte;    {number of retries}
            intBuff:       Integer; {used internally for }
                                    { PNSendRequest}
            TRelTime:      Byte);   {TRelease time for extended }
                                    { send request}
         SendResponseParm:
            (filler0:      Byte;    {bitmap}
            bdsSize:       Byte;    {number of BDS elements}
            transID:       Integer);{transaction ID}
         GetRequestParm:
            (bitmap:       Byte;    {bitmap}
            filler1:       Byte);   {reserved}
         AddResponseParm:
            (rspNum:       Byte;    {sequence number}
            filler2:       Byte);   {reserved}
         KillSendReqParm
            (aKillQEl:     Ptr));   {ptr to (queue element) function to }
                                    { cancel}
END;

ATPPBPtr =  ^ATPParamBlock; 
</PRE>
<DL>
<H5>Field Description</H5>
<DT><CODE><A NAME=MARKER-2-39></A>ioCompletion</CODE>
<DD> A pointer to a completion routine that you can provide. When you execute a function <A NAME=MARKER-2-134></A>asynchronously, the .ATP driver calls your completion routine when it completes execution of the function if you specify a pointer to the routine as the value of this field. Specify <CODE>NIL</CODE> for this field if you do not wish to provide a completion routine. If you execute a function synchronously, the .ATP driver ignores the <CODE>ioCompletion</CODE> field. For information about completion routines, see the chapter "Introduction to AppleTalk" in this book. 
<DT><CODE><A NAME=MARKER-2-58></A>ioResult </CODE>
<DD> The result of the function. If you call the function asynchronously, the .ATP driver sets this field to 1 as soon as you call the function, and it changes the field to the actual result code when the function completes execution. 
<DT><CODE><A NAME=MARKER-2-79></A>ioRefNum</CODE> 
<DD> The .ATP driver reference number. The MPW interface fills in <BR>this field.<A NAME=MARKER-2-156></A>
<DT><CODE><A NAME=MARKER-2-80></A>csCode</CODE> 
<DD> The command code for the ATP function to be executed. The MPW interface fills in this value for<A NAME=MARKER-9-37></A> you.<A NAME=MARKER-2-79></A><A NAME=MARKER-2-78></A>
</DL>



</BLOCKQUOTE>
<HR>
<center>
<A HREF="Networking-155.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Networking-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Networking-304.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt= "Book Index"></A> <A HREF="Networking-157.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Networking-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
