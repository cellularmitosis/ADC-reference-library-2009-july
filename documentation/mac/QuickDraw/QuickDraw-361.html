<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>MyInitPickMethod (IM: Im)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING361></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!--end of header -->

<center>
<A HREF="QuickDraw-360.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="QuickDraw-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="QuickDraw-476.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="QuickDraw-362.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="QuickDraw-2.html"><B>Imaging With QuickDraw</B></A> / <BR><DD><A HREF="QuickDraw-332.html"><B>Chapter 7 - Pictures</B></A> / <A HREF="QuickDraw-335.html"><B>Pictures Reference</B></A><BR><DL><DD><A HREF="QuickDraw-360.html"><B>Application-Defined Routines</B></A> / <A HREF="QuickDraw-352.html"><B></B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING361-0></A>
<H3><A NAME=MARKER-9-266></A>MyInitPickMethod</H3>
 <A NAME=MARKER-9-493></A>Your color-picking method (<CODE>'cpmt'</CODE>) resource should include a routine that specifies its color bank and allocates whatever data your color-picking method needs. Here is how you would declare this routine if it were a Pascal function named <CODE>MyInitPickMethod</CODE>:<A NAME=MARKER-2-268></A><P>
<PRE>
FUNCTION MyInitPickMethod (colorsRequested: Integer; 
                           VAR dataRef: LongInt; 
                           VAR colorBankType: Integer): OSErr;
</PRE>
<DL>
<DT><CODE>colorsRequested</CODE>
<DD> The number of colors requested by your application to be gathered for examination in a <CODE>ColorTable</CODE> or <CODE>Palette</CODE> record.
<DT><CODE>dataRef</CODE>
<DD> A handle to any data needed by your color-picking method; that is, if your application allocates and uses additional data, it should return a handle to it in this parameter.
<DT><CODE>colorBankType</CODE>
<DD> The type of color bank your color-picking method uses. Your <CODE>MyInitPickMethod</CODE> routine should return one of three valid color bank types, which it can represent with one of these constants:
</DL>
<PRE>
            CONST
            colorBankIsCustom       = -1; {gathers colors into a }
                                          { custom color bank}
            colorBankIsExactAnd555  = 0;  {gathers exact colors }
                                          { if there are less }
                                          { than 256 unique }
                                          { colors in picture; }
                                          { otherwise gathers }
                                          { colors for picture }
                                          { in a 5-5-5 histogram}
            colorBankIs555          = 1;  {gathers colors into a }
                                          { 5-5-5 histogram}
</PRE>
<DL>
<DT>
<DD> <A NAME=MARKER-2-269></A>Return the <CODE>colorBankIs555</CODE> constant in this parameter if you want to let the Picture Utilities gather the colors for a picture or a pixel map into a 5-5-5 histogram. When you return the <CODE>colorBankIs555</CODE> constant, the Picture Utilities call your <CODE>MyCalcColorTable</CODE> routine with a pointer to the color bank (that is, to the 5-5-5 histogram). Your <CODE>MyCalcColorTable</CODE> routine (described on <A HREF=QuickDraw-363.html#MARKER-9-276>page 7-64</A>) selects whatever colors it needs from this color bank. Then the Picture Utilities function called by your application returns these colors in a <CODE>Palette</CODE> record, a <CODE>ColorTable</CODE> record, or both, as requested by your application.
<DT><CODE></CODE>
<DD> Return the <CODE>ColorBankIsExactAnd555</CODE> constant in this parameter to make the Picture Utilities return exact colors if there are less than 256 unique colors in the picture; otherwise, the Picture Utilities gather the colors for the picture in a 5-5-5 histogram, just as they do when you return the <CODE>colorBankIs555</CODE> constant. If the picture or pixel map has fewer colors than your application requests when it calls a Picture Utilities function, the Picture Utilities function returns all of the colors contained in the color bank. If the picture or pixel map contains more colors than your application requests, the Picture Utilities call your <CODE>MyCalcColorTable</CODE> routine to select which colors to return. 
<DT>
<DD> Return the <CODE>colorBankIsCustom</CODE> constant in this parameter if you want to implement your own color bank for storing the colors in a picture or a pixel map. For example, because the 5-5-5 histogram that the Picture Utilities provide gathers colors to a resolution of 5 bits per color, your application may want to create a histogram with a resolution of 8 bits per color. When you return the <CODE>colorBankIsCustom</CODE> constant, the Picture Utilities call your <CODE>MyRecordColors</CODE> routine (explained in the next routine description) to create this color bank. The Picture Utilities also call your <CODE>MyCalcColorTable</CODE> routine to select colors from this color bank.
</DL>
<A NAME=HEADING361-10></A>
<H5>DESCRIPTION</H5>
 Your <CODE>MyInitPickMethod</CODE> routine should allocate whatever data your color-picking method needs and store a handle to your data in the location pointed to by the <CODE>dataRef</CODE> parameter. In the <CODE>colorBankType</CODE> parameter, your <CODE>MyInitPickMethod</CODE> routine must also return the type of color bank your color-picking method uses for color storage. If your <CODE>MyInitPickMethod</CODE> routine generates any error, it should return the error as its function result.<P>
 The 5-5-5 histogram that the Picture Utilities provide if you return the <CODE>ColorBankIs555</CODE> or <CODE>ColorBankIsExactAnd555</CODE> constant in the <CODE>colorBankType</CODE> parameter is like a reversed <CODE>cSpecArray</CODE> record, which is an array of <CODE>ColorSpec</CODE> records. (The <CODE>cSpecArray</CODE> and <CODE>ColorSpec</CODE> records are described in the chapter "Color QuickDraw" in this book.) This 5-5-5 histogram is an array of 32,768 integers, where the <I>index</I> into the array is the color: 5 bits of red, followed by 5 bits of green, followed by 5 bits of blue. Each <I>entry</I> in the array is the number of colors in the picture that are approximated by the index color for that entry. <P>
 For example, suppose there were three instances of the following color in the pixel map: 
<TABLE BORDER="0" CELLPADDING=3><TD ALIGN=LEFT>Red <TD>=<TD>%1101 1010 1010 1110<TR>
<TD>Green<TD>=<TD>%0111 1010 1011 0001<TR>
<TD>Blue<TD>=<TD>%0101 1011 0110 1010</TABLE>
<P>
 This color would be represented by index % 0 11011-01111-01011 (in hexadecimal, $6DEB), and the value in the histogram at this index would be 3, because there are three instances of this color.<A NAME=MARKER-9-176></A> <P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="QuickDraw-360.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="QuickDraw-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="QuickDraw-476.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="QuickDraw-362.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="QuickDraw-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
