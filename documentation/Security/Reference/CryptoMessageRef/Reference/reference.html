<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Cryptographic Message Syntax Services Reference</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Cryptographic Message Syntax Services Reference"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40006264-DontLinkChapterID_1" title="Cryptographic Message Syntax Services Reference"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> &gt; <a href="../../../../../reference/Security/index.html#//apple_ref/doc/uid/TP30001281-TP30000434" target="_top">Security</a> &gt; <a href="../../../../../reference/Security/idxCryptography-date.html#//apple_ref/doc/uid/TP30001281-TP30000434-TP30001026" target="_top">Cryptography</a> &gt; <a href="../index.html" target="_top">Cryptographic Message Syntax Services Reference</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <!-- Previous button --><span style="margin-left: 8px"><a href="../RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40006264-DontLinkChapterID_1-DontLinkElementID_18" title="Cryptographic Message Syntax Services Reference"></a><h1>Cryptographic Message Syntax Services Reference</h1><div class="spec_sheet_info_box"><table cellspacing="0" class="specbox"><tr><td scope="row"><strong><span style="white-space: nowrap;">Framework</span></strong></td><td><div style="margin-bottom:1px">Security.framework</div></td></tr><tr><td scope="row"><strong><span style="white-space: nowrap;">Declared in</span></strong></td><td><div style="margin-bottom:1px"><span class="content_text">CMSDecoder.h</span><br/><span class="content_text">CMSEncoder.h</span><br/></div></td></tr></table></div><br/><a name="//apple_ref/doc/uid/TP40006264-CH1-DontLinkElementID_13" title="Overview"></a><h2>Overview</h2><p>Cryptographic Message Syntax Services is an API that implements Cryptographic Message Syntax (CMS) digital signatures and encryption for S/MIME messages. </p><p>A CMS message can be signed, encrypted, or both. A message can be signed by an arbitrary number of signers and can be encrypted for an arbitrary number of recipients.  In CMS terminology, this module performs encryption using the enveloped-data content type and signing using the signed-data content type.</p><p>If the message is both signed and encrypted, it uses <em>nested ContentInfo types</em> in CMS terminology. In this case, the enveloped data content contains the signed data content; that is, the message is first signed and then the signed content is encrypted. </p><p>Cryptographic Message Syntax is defined in RFC 3852: <em>Cryptographic Message Syntax (CMS)</em> (<span class="content_text"><a href="http://www.ietf.org/rfc/rfc3852.txt" target="_blank">http://www.ietf.org/rfc/rfc3852.txt</a></span>). </p><p>S/MIME is defined in RFC 3851: <em>Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1 Message Specification</em> (<span class="content_text"><a href="http://www.ietf.org/rfc/rfc3851.txt" target="_blank">http://www.ietf.org/rfc/rfc3851.txt</a></span>)</p><a name="//apple_ref/doc/uid/TP40006264-DontLinkChapterID_1-DontLinkElementID_14" title="Functions by Task"></a><h2>Functions by Task</h2>
<a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_3" title="Initializing The Encoder"></a>
    
    <h3 class="tasks">Initializing The Encoder</h3>
        
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCreate">CMSEncoderCreate</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Creates a CMSEncoder reference. '/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSEncoderGetTypeID">CMSEncoderGetTypeID</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Returns the type identifier for the CMSEncoder opaque type.'/>
            </span></li>
    </ul>


<a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_5" title="Specifying Message Characteristics"></a>
    
    <h3 class="tasks">Specifying Message Characteristics</h3>
        
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSEncoderAddSigners">CMSEncoderAddSigners</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Specifies signers of the message.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCopySigners">CMSEncoderCopySigners</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Obtains the array of signers specified with the <code>CMSEncoderAddSigners</code> function.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSEncoderAddRecipients">CMSEncoderAddRecipients</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Specifies a message is to be encrypted and specifies the recipients of the message.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCopyRecipients">CMSEncoderCopyRecipients</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Obtains the array of recipients specified with the <code>CMSEncoderAddRecipients</code> function.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSEncoderSetHasDetachedContent">CMSEncoderSetHasDetachedContent</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Specifies whether the signed data is to be separate from the message.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSEncoderGetHasDetachedContent">CMSEncoderGetHasDetachedContent</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Indicates whether the message is to have detached content.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSEncoderSetEncapsulatedContentType">CMSEncoderSetEncapsulatedContentType</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Specifies an object identifier for the encapsulated data of a signed message.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCopyEncapsulatedContentType">CMSEncoderCopyEncapsulatedContentType</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Obtains the object identifier for the encapsulated data of a signed message.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSEncoderAddSupportingCerts">CMSEncoderAddSupportingCerts</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Adds certificates to a message.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCopySupportingCerts">CMSEncoderCopySupportingCerts</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Obtains the certificates added to a message with <code>CMSEncoderAddSupportingCerts</code>.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSEncoderAddSignedAttributes">CMSEncoderAddSignedAttributes</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Specifies attributes for a signed message.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSEncoderSetCertificateChainMode">CMSEncoderSetCertificateChainMode</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Specifies which certificates to include in a signed CMS message.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSEncoderGetCertificateChainMode">CMSEncoderGetCertificateChainMode</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Obtains a constant that indicates which certificates are to be included in a signed CMS message.'/>
            </span></li>
    </ul>


<a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_6" title="Encoding The Message"></a>
    
    <h3 class="tasks">Encoding The Message</h3>
        
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSEncoderUpdateContent">CMSEncoderUpdateContent</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Feeds content bytes into the encoder.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCopyEncodedContent">CMSEncoderCopyEncodedContent</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Finishes encoding the message and obtains the encoded result.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSEncode">CMSEncode</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Encodes a message and obtains the result in one high-level function call.'/>
            </span></li>
    </ul>


<a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_7" title="Initializing The Decoder"></a>
    
    <h3 class="tasks">Initializing The Decoder</h3>
        
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCreate">CMSDecoderCreate</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Creates a CMSDecoder.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSDecoderGetTypeID">CMSDecoderGetTypeID</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Returns the type identifier for the CMSDecoder opaque type.'/>
            </span></li>
    </ul>


<a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_8" title="Decoding The Message"></a>
    
    <h3 class="tasks">Decoding The Message</h3>
        
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSDecoderUpdateMessage">CMSDecoderUpdateMessage</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Feeds raw bytes of the message to be decoded into the decoder.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSDecoderFinalizeMessage">CMSDecoderFinalizeMessage</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Indicates that there is no more data to decode.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSDecoderSetDetachedContent">CMSDecoderSetDetachedContent</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Specifies the message’s detached content, if any.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCopyDetachedContent">CMSDecoderCopyDetachedContent</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Obtains the detached content specified with the <code>CMSDecoderSetDetachedContent</code> function.'/>
            </span></li>
    </ul>


<a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_9" title="Verifying The Signature"></a>
    
    <h3 class="tasks">Verifying The Signature</h3>
        
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSDecoderSetSearchKeychain">CMSDecoderSetSearchKeychain</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Specifies the keychains to search for intermediate certificates to be used in verifying a signed message&#8217;s signer certificates.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSDecoderGetNumSigners">CMSDecoderGetNumSigners</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Obtains the number of signers of a message.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCopySignerStatus">CMSDecoderCopySignerStatus</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Obtains the status of a CMS message&#8217;s signature.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCopySignerEmailAddress">CMSDecoderCopySignerEmailAddress</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Obtains the email address of the specified signer of a CMS message.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCopySignerCert">CMSDecoderCopySignerCert</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Obtains the certificate of the specified signer of a CMS message.'/>
            </span></li>
    </ul>


<a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_12" title="Obtaining Message Content"></a>
    
    <h3 class="tasks">Obtaining Message Content</h3>
        
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSDecoderIsContentEncrypted">CMSDecoderIsContentEncrypted</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Determines whether a CMS message was encrypted.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCopyEncapsulatedContentType">CMSDecoderCopyEncapsulatedContentType</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Obtains the object identifier for the encapsulated data of a signed message.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCopyAllCerts">CMSDecoderCopyAllCerts</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Obtain an array of all of the certificates in a message.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCopyContent">CMSDecoderCopyContent</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Obtain the message content, if any.'/>
            </span></li>
    </ul>

<a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_15" title="Functions"></a><h2>Functions</h2><a name="//apple_ref/c/func/CMSDecoderCopyAllCerts" title="CMSDecoderCopyAllCerts"></a><a name="//apple_ref/doc/c_ref/CMSDecoderCopyAllCerts" title="CMSDecoderCopyAllCerts"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW24" title="CMSDecoderCopyAllCerts"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_20"></a><h3 class="tight">CMSDecoderCopyAllCerts</h3><p class="spaceabove">Obtain an array of all of the certificates in a message.</p><p class="spaceabove"><pre>
OSStatus CMSDecoderCopyAllCerts(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSDecoderRef">CMSDecoderRef</a>        cmsDecoder,
   <a href="../../../../CoreFoundation/Reference/CFArrayRef/Reference/reference.html#//apple_ref/doc/c_ref/CFArrayRef" target="_top">CFArrayRef</a>            *certsOut
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsDecoder</em></dt><dd><p>The CMSDecoder reference returned by the <code>CMSDecoderCreate</code> function.</p></dd><dt><em>certsOut</em></dt><dd><p>On return, points to an array of <code>SecCertificateRef</code> objects. Returns <code>NULL</code> if the message does not contain any certificates (the message was encrypted but not signed); this is not considered an error. You must use the <code>CFRelease</code> function to free this reference when you are finished using it.</p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span> </p><h5 class="tight">Discussion</h5><p>A CMS message can contain arbitrary sets of certificates other than or in addition to those indicating the identity of signers. You can use this function to retrieve such certificates from a message. If the message was signed, it contains signer certificates. You can use the <code>CMSDecoderGetNumSigners</code> and <code>CMSDecoderCopySignerCert</code> functions to retrieve the certificates for a specific signer.</p><p>You cannot call this function until after you have called the <code>CMSDecoderFinalizeMessage</code> function.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCreate">CMSDecoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderFinalizeMessage">CMSDecoderFinalizeMessage</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderAddSupportingCerts">CMSEncoderAddSupportingCerts</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderGetNumSigners">CMSDecoderGetNumSigners</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCopySignerCert">CMSDecoderCopySignerCert</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSDecoder.h</code><a name="//apple_ref/c/func/CMSDecoderCopyContent" title="CMSDecoderCopyContent"></a><a name="//apple_ref/doc/c_ref/CMSDecoderCopyContent" title="CMSDecoderCopyContent"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW27" title="CMSDecoderCopyContent"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_21"></a><h3 class="tight">CMSDecoderCopyContent</h3><p class="spaceabove">Obtain the message content, if any.</p><p class="spaceabove"><pre>
OSStatus CMSDecoderCopyContent(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSDecoderRef">CMSDecoderRef</a>        cmsDecoder,
   <a href="../../../../CoreFoundation/Reference/CFDataRef/Reference/reference.html#//apple_ref/doc/c_ref/CFDataRef" target="_top">CFDataRef</a>            *contentOut
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsDecoder</em></dt><dd><p>The CMSDecoder reference returned by the <code>CMSDecoderCreate</code> function.</p></dd><dt><em>contentOut</em></dt><dd><p>On return, points to the message’s content. Returns <code>NULL</code> if the content is detached. You must use the <code>CFRelease</code> function to free this reference when you are finished using it.</p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Discussion</h5><p>If the message has detached content, you are responsible for retrieving the content. In that case, you use the <code>CMSDecoderSetDetachedContent</code> function to tell the decoder the location of the content.</p><p>You cannot call this function until after you have called the <code>CMSDecoderFinalizeMessage</code> function.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCreate">CMSDecoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderSetDetachedContent">CMSDecoderSetDetachedContent</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderSetHasDetachedContent">CMSEncoderSetHasDetachedContent</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderFinalizeMessage">CMSDecoderFinalizeMessage</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSDecoder.h</code><a name="//apple_ref/c/func/CMSDecoderCopyDetachedContent" title="CMSDecoderCopyDetachedContent"></a><a name="//apple_ref/doc/c_ref/CMSDecoderCopyDetachedContent" title="CMSDecoderCopyDetachedContent"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW28" title="CMSDecoderCopyDetachedContent"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_22"></a><h3 class="tight">CMSDecoderCopyDetachedContent</h3><p class="spaceabove">Obtains the detached content specified with the <code>CMSDecoderSetDetachedContent</code> function.</p><p class="spaceabove"><pre>
OSStatus CMSDecoderCopyDetachedContent(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSDecoderRef">CMSDecoderRef</a>        cmsDecoder,
   <a href="../../../../CoreFoundation/Reference/CFDataRef/Reference/reference.html#//apple_ref/doc/c_ref/CFDataRef" target="_top">CFDataRef</a>            *detachedContentOut
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsDecoder</em></dt><dd><p>The CMSDecoder reference returned by the <code>CMSDecoderCreate</code> function.</p></dd><dt><em>detachedContentOut</em></dt><dd><p>On return, points to the data reference specified by an earlier call to the <code>CMSDecoderSetDetachedContent</code> function. Returns a NULL data reference if no detached content has been specified. You must use the <code>CFRelease</code> function to free this reference when you are finished using it. </p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCreate">CMSDecoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderSetDetachedContent">CMSDecoderSetDetachedContent</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSDecoder.h</code><a name="//apple_ref/c/func/CMSDecoderCopyEncapsulatedContentType" title="CMSDecoderCopyEncapsulatedContentType"></a><a name="//apple_ref/doc/c_ref/CMSDecoderCopyEncapsulatedContentType" title="CMSDecoderCopyEncapsulatedContentType"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW23" title="CMSDecoderCopyEncapsulatedContentType"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_23"></a><h3 class="tight">CMSDecoderCopyEncapsulatedContentType</h3><p class="spaceabove">Obtains the object identifier for the encapsulated data of a signed message.</p><p class="spaceabove"><pre>
OSStatus CMSDecoderCopyEncapsulatedContentType(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSDecoderRef">CMSDecoderRef</a>        cmsDecoder,
   <a href="../../../../CoreFoundation/Reference/CFDataRef/Reference/reference.html#//apple_ref/doc/c_ref/CFDataRef" target="_top">CFDataRef</a>           *eContentTypeOut
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsDecoder</em></dt><dd><p>The CMSDecoder reference returned by the <code>CMSDecoderCreate</code> function.</p></dd><dt><em>eContentTypeOut</em></dt><dd><p>On return, the object identifier for the encapsulated data in a signed message.  Returns <code>NULL</code> if the message was not signed. </p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Discussion</h5><p>In a signed message, the signed data consists of any type of content (referred to as the <em>encapsulated content</em>, because it is encapsulated in the signed data) plus the signature values. The content type of the encapsulated data is indicated by an object identifier. The default value for the OID is <code>id-data</code>, which indicates MIME-encoded content. </p><p>You cannot call this function until after you have called the <code>CMSDecoderFinalizeMessage</code> function.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCreate">CMSDecoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderFinalizeMessage">CMSDecoderFinalizeMessage</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderSetEncapsulatedContentType">CMSEncoderSetEncapsulatedContentType</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSDecoder.h</code><a name="//apple_ref/c/func/CMSDecoderCopySignerCert" title="CMSDecoderCopySignerCert"></a><a name="//apple_ref/doc/c_ref/CMSDecoderCopySignerCert" title="CMSDecoderCopySignerCert"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW25" title="CMSDecoderCopySignerCert"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_24"></a><h3 class="tight">CMSDecoderCopySignerCert</h3><p class="spaceabove">Obtains the certificate of the specified signer of a CMS message.</p><p class="spaceabove"><pre>
OSStatus CMSDecoderCopySignerCert(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSDecoderRef">CMSDecoderRef</a>        cmsDecoder,
   size_t               signerIndex,
   <a href="../../certifkeytrustservices/Reference/reference.html#//apple_ref/doc/c_ref/SecCertificateRef" target="_top">SecCertificateRef</a>   *signerCertOut
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsDecoder</em></dt><dd><p>The CMSDecoder reference returned by the <code>CMSDecoderCreate</code> function.</p></dd><dt><em>signerIndex</em></dt><dd><p>A number indicating which signer’s email address to return. Signer index numbers start with 0. Use the <code>CMSDecoderGetNumSigners</code> function to determine the total number of signers for a message. </p></dd><dt><em>signerCertOut</em></dt><dd><p>On return, points to the certificate of the specified signer. </p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span> Returns <code>paramErr</code> (–50) if the CMS message was not signed or if <code>signerIndex</code> is greater than the number of signers of the message minus one (signerIndex > (numSigners – 1)).</p><h5 class="tight">Discussion</h5><p>You cannot call this function until after you have called the <code>CMSDecoderFinalizeMessage</code> function.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCreate">CMSDecoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderGetNumSigners">CMSDecoderGetNumSigners</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderFinalizeMessage">CMSDecoderFinalizeMessage</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSDecoder.h</code><a name="//apple_ref/c/func/CMSDecoderCopySignerEmailAddress" title="CMSDecoderCopySignerEmailAddress"></a><a name="//apple_ref/doc/c_ref/CMSDecoderCopySignerEmailAddress" title="CMSDecoderCopySignerEmailAddress"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_11" title="CMSDecoderCopySignerEmailAddress"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_25"></a><h3 class="tight">CMSDecoderCopySignerEmailAddress</h3><p class="spaceabove">Obtains the email address of the specified signer of a CMS message.</p><p class="spaceabove"><pre>
OSStatus CMSDecoderCopySignerEmailAddress(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSDecoderRef">CMSDecoderRef</a>        cmsDecoder,
   size_t               signerIndex,
   <a href="../../../../CoreFoundation/Reference/CFStringRef/Reference/reference.html#//apple_ref/doc/c_ref/CFStringRef" target="_top">CFStringRef</a>         *signerEmailAddressOut
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsDecoder</em></dt><dd><p>The CMSDecoder reference returned by the <code>CMSDecoderCreate</code> function.</p></dd><dt><em>signerIndex</em></dt><dd><p>A number indicating which signer’s email address to return. Signer index numbers start with 0. Use the <code>CMSDecoderGetNumSigners</code> function to determine the total number of signers for a message. </p></dd><dt><em>signerEmailAddressOut</em></dt><dd><p>On return, points to the email address of the specified signer. </p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span>  Returns <code>paramErr</code> (–50) if the CMS message was not signed or if <code>signerIndex</code> is greater than the number of signers of the message minus one (<code>signerIndex > (numSigners – 1)</code>).</p><h5 class="tight">Discussion</h5><p>You cannot call this function until after you have called the <code>CMSDecoderFinalizeMessage</code> function.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCreate">CMSDecoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderGetNumSigners">CMSDecoderGetNumSigners</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderFinalizeMessage">CMSDecoderFinalizeMessage</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSDecoder.h</code><a name="//apple_ref/c/func/CMSDecoderCopySignerStatus" title="CMSDecoderCopySignerStatus"></a><a name="//apple_ref/doc/c_ref/CMSDecoderCopySignerStatus" title="CMSDecoderCopySignerStatus"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW4" title="CMSDecoderCopySignerStatus"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_26"></a><h3 class="tight">CMSDecoderCopySignerStatus</h3><p class="spaceabove">Obtains the status of a CMS message's signature.</p><p class="spaceabove"><pre>
OSStatus CMSDecoderCopySignerStatus(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSDecoderRef">CMSDecoderRef</a>        cmsDecoder,
   size_t               signerIndex,
   <a href="../../../../CoreFoundation/Reference/CFTypeRef/Reference/reference.html#//apple_ref/doc/c_ref/CFTypeRef" target="_top">CFTypeRef</a>            policyOrArray,
   <!--a-->Boolean<!--/a-->              evaluateSecTrust,
   <a href="reference.html#//apple_ref/doc/c_ref/CMSSignerStatus">CMSSignerStatus</a>     *signerStatusOut,
   <a href="../../certifkeytrustservices/Reference/reference.html#//apple_ref/doc/c_ref/SecTrustRef" target="_top">SecTrustRef</a>         *secTrustOut,
   <a href="../../../../Carbon/Reference/ErrorHandler/Reference/reference.html#//apple_ref/doc/c_ref/OSStatus" target="_top">OSStatus</a>            *certVerifyResultCodeOut
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsDecoder</em></dt><dd><p>The CMSDecoder reference returned by the <code>CMSDecoderCreate</code> function.</p></dd><dt><em>signerIndex</em></dt><dd><p>A number indicating which signer to examine. Signer index numbers start with 0. Use the <code>CMSDecoderGetNumSigners</code> function to determine the total number of signers for a message. </p></dd><dt><em>policyOrArray</em></dt><dd><p>The trust policy or policies to be used to verify the signer’s certificate. You can specify either a single <code>SecPolicyRef</code> object or a <code>CFArray</code> of <code>SecPolicyRef</code> objects. Trust policies are discussed in <span class="content_text"><a href="../../../Conceptual/CertKeyTrustProgGuide/02concepts/concepts.html#//apple_ref/doc/uid/TP40001358-CH204" target="_top">Certificate, Key, and Trust Services Concepts</a></span> in <em><a href="../../../Conceptual/CertKeyTrustProgGuide/index.html#//apple_ref/doc/uid/TP40001358" target="_top">Certificate, Key, and Trust Services Programming Guide</a></em>.</p></dd><dt><em>evaluateSecTrust</em></dt><dd><p>Set to <code>TRUE</code> to cause the decoder to call the <code>SecTrustEvaluate</code> function to evaluate the <code>SecTrust</code> object created for the evaluation of the signer certificate. Set to <code>FALSE</code> if you intend to call the <code>SecTrustEvaluate</code> function for the <code>SecTrust</code> object returned by the <code>secTrustOut</code> parameter. </p></dd><dt><em>signerStatusOut</em></dt><dd><p>If you specify <code>TRUE</code> for the <code>evaluateSecTrust</code> parameter, on return this parameter indicates the status of the signature. See <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/CMSSignerStatus">“Signature Status Constants”</a></span> for possible results. Pass in <code>NULL</code> if you don’t want a value returned. </p></dd><dt><em>secTrustOut</em></dt><dd><p>On return this parameter points to a <code>SecTrust</code> object. If you specified <code>TRUE</code> for the <code>evaluateTrust</code> parameter, this is the trust object that was used to verify the signer's certificate. If you specified <code>FALSE</code> for the <code>evaluateTrust</code> parameter, you can call the <code>SecTrustEvaluate</code> function to evaluate the <code>SecTrust</code> object. Pass <code>NULL</code> if you do not want this object returned. You must use the <code>CFRelease</code> function to free this reference when you are finished using it.</p></dd><dt><em>certVerifyResultCodeOut</em></dt><dd><p>If you specify <code>TRUE</code> for the <code>evaluateSecTrust</code> parameter, on return this parameter indicates the result of the certificate verification.  Pass in <code>NULL</code> if you don’t want a value returned. </p><p>Some of the most common results returned in this parameter include:</p><dl class="termdef">	<dt><code>CSSMERR_TP_INVALID_ANCHOR_CERT</code></dt><dd><p>The certificate was verified through the certificate chain to a self-signed root certificate that was present in the message, but that root certificate is not a known, trusted root certificate. </p></dd><dt><code>CSSMERR_TP_NOT_TRUSTED</code></dt><dd><p>The certificate could not be verified back to a root certificate.</p></dd><dt><code>CSSMERR_TP_VERIFICATION_FAILURE</code></dt><dd><p>The root certificate failed verification.  </p></dd><dt><code>CSSMERR_TP_VERIFY_ACTION_FAILED</code></dt><dd><p>Trust could not be established according to the specified trust policy. </p></dd><dt><code>CSSMERR_TP_INVALID_CERTIFICATE</code></dt><dd><p>The signer’s leaf certificate was not valid. </p></dd><dt><code>CSSMERR_TP_CERT_EXPIRED</code></dt><dd><p>A certificate in the chain was expired at the time of verification.</p></dd><dt><code>CSSMERR_TP_CERT_NOT_VALID_YET</code></dt><dd><p>A certificate in the chain was not yet valid at the time of verification.</p></dd></dl></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span> A result of <code>noErr</code> indicates only that the function completed successfully; it does not indicate that the signature is verified or the certificates are valid. See the <code>signerStatusOut</code> and <code>certVerifyResultCodeOut</code> parameters for the verification and certificate validation results.</p><h5 class="tight">Discussion</h5><p>You cannot call this function until after you have called the <code>CMSDecoderFinalizeMessage</code> function. Although the message has been fully decoded when the <code>CMSDecoderFinalizeMessage</code> function returns with no error, the signature can’t be validated or certificates verified until this function is called.</p><p>A CMS message can be signed by multiple signers; this function returns the status associated with one signer as specified by the <code>signerIndex</code> parameter.</p><p>If you both pass in <code>FALSE</code> for the <code>evaluateSecTrust</code> parameter and <code>NULL</code> for the <code>secTrustOut</code> parameter, no evaluation of the signer certificate can occur.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCreate">CMSDecoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderFinalizeMessage">CMSDecoderFinalizeMessage</a></code></li><li class="availability">  <code><a href="../../certifkeytrustservices/Reference/reference.html#//apple_ref/c/func/SecTrustEvaluate" target="_top">SecTrustEvaluate</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSDecoder.h</code><a name="//apple_ref/c/func/CMSDecoderCreate" title="CMSDecoderCreate"></a><a name="//apple_ref/doc/c_ref/CMSDecoderCreate" title="CMSDecoderCreate"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW2" title="CMSDecoderCreate"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_27"></a><h3 class="tight">CMSDecoderCreate</h3><p class="spaceabove">Creates a CMSDecoder.</p><p class="spaceabove"><pre>
   
OSStatus CMSDecoderCreate(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSDecoderRef">CMSDecoderRef</a>        *cmsDecoderOut
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsDecoderOut</em></dt><dd><p>On return, points to a CMSDecoder reference. You must use the <code>CFRelease</code> function to free this reference when you are finished using it.</p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Discussion</h5><p>This is the first function in a sequence of decoder functions that you call to get information from a CMS message. The other functions in the sequence require you to pass in the CMSDecoder reference returned by this function. The next function in the sequence is <code>CMSDecoderUpdateMessage</code>.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderUpdateMessage">CMSDecoderUpdateMessage</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSDecoder.h</code><a name="//apple_ref/c/func/CMSDecoderFinalizeMessage" title="CMSDecoderFinalizeMessage"></a><a name="//apple_ref/doc/c_ref/CMSDecoderFinalizeMessage" title="CMSDecoderFinalizeMessage"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW3" title="CMSDecoderFinalizeMessage"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_28"></a><h3 class="tight">CMSDecoderFinalizeMessage</h3><p class="spaceabove">Indicates that there is no more data to decode.</p><p class="spaceabove"><pre>
OSStatus CMSDecoderFinalizeMessage(     <a href="reference.html#//apple_ref/doc/c_ref/CMSDecoderRef">CMSDecoderRef</a>        cmsDecoder
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsDecoder</em></dt><dd><p>The CMSDecoder reference returned by the <code>CMSDecoderCreate</code> function.</p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. Returns <code>errSecUnknownFormat</code> upon detection of an improperly formatted CMS message. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes”</a></span> for other result codes. </p><h5 class="tight">Discussion</h5><p>When you call this function, the decoder finishes decoding the message. If the message was encrypted and this function returns a result code of <code>noErr</code>, the message was successfully decrypted. Call the <code>CMSDecoderCopyContent</code> function to retrieve the message content. Call the <code>CMSDecoderGetNumSigners</code> function to find out if the message was signed and, if so, how many signers there were.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCreate">CMSDecoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCopyContent">CMSDecoderCopyContent</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderGetNumSigners">CMSDecoderGetNumSigners</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSDecoder.h</code><a name="//apple_ref/c/func/CMSDecoderGetNumSigners" title="CMSDecoderGetNumSigners"></a><a name="//apple_ref/doc/c_ref/CMSDecoderGetNumSigners" title="CMSDecoderGetNumSigners"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW21" title="CMSDecoderGetNumSigners"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_29"></a><h3 class="tight">CMSDecoderGetNumSigners</h3><p class="spaceabove">Obtains the number of signers of a message.</p><p class="spaceabove"><pre>
OSStatus CMSDecoderGetNumSigners(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSDecoderRef">CMSDecoderRef</a>        cmsDecoder,
   size_t              *numSignersOut
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsDecoder</em></dt><dd><p>The CMSDecoder reference returned by the <code>CMSDecoderCreate</code> function.</p></dd><dt><em>numSignersOut</em></dt><dd><p>On return, the number of signers of the message. Zero indicates that the message was not signed. </p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Discussion</h5><p>Call the <code>CMSDecoderCopySignerStatus</code> function to determine the status of a signature. </p><p>You cannot call this function until after you have called the <code>CMSDecoderFinalizeMessage</code> function.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCreate">CMSDecoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCopySignerStatus">CMSDecoderCopySignerStatus</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderFinalizeMessage">CMSDecoderFinalizeMessage</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSDecoder.h</code><a name="//apple_ref/c/func/CMSDecoderGetTypeID" title="CMSDecoderGetTypeID"></a><a name="//apple_ref/doc/c_ref/CMSDecoderGetTypeID" title="CMSDecoderGetTypeID"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW30" title="CMSDecoderGetTypeID"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_30"></a><h3 class="tight">CMSDecoderGetTypeID</h3><p class="spaceabove">Returns the type identifier for the CMSDecoder opaque type.</p><p class="spaceabove"><pre>
<a href="../../../../CoreFoundation/Reference/CFTypeRef/Reference/reference.html#//apple_ref/doc/c_ref/CFTypeID" target="_top">CFTypeID</a> CMSDecoderGetTypeID(void);
</pre></p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">Declared In</h5><code>CMSDecoder.h</code><a name="//apple_ref/c/func/CMSDecoderIsContentEncrypted" title="CMSDecoderIsContentEncrypted"></a><a name="//apple_ref/doc/c_ref/CMSDecoderIsContentEncrypted" title="CMSDecoderIsContentEncrypted"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW22" title="CMSDecoderIsContentEncrypted"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_31"></a><h3 class="tight">CMSDecoderIsContentEncrypted</h3><p class="spaceabove">Determines whether a CMS message was encrypted.</p><p class="spaceabove"><pre>
OSStatus CMSDecoderIsContentEncrypted(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSDecoderRef">CMSDecoderRef</a>        cmsDecoder,
   <!--a-->Boolean<!--/a-->             *isEncryptedOut
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsDecoder</em></dt><dd><p>The CMSDecoder reference returned by the <code>CMSDecoderCreate</code> function.</p></dd><dt><em>isEncryptedOut</em></dt><dd><p>Returns <code>TRUE</code> if the message was encrypted.</p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Discussion</h5><p>Note that if the message was encrypted and the decoding succeeded (<code>CMSDecoderFinalizeMessage</code> returned <code>noErr</code>), then the message was successfully decrypted. Call <code>CMSDecoderCopyContent</code> to retrieve the decrypted content.</p><p>You cannot call this function until after you have called the <code>CMSDecoderFinalizeMessage</code> function.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCreate">CMSDecoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderFinalizeMessage">CMSDecoderFinalizeMessage</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCopyContent">CMSDecoderCopyContent</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderAddRecipients">CMSEncoderAddRecipients</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSDecoder.h</code><a name="//apple_ref/c/func/CMSDecoderSetDetachedContent" title="CMSDecoderSetDetachedContent"></a><a name="//apple_ref/doc/c_ref/CMSDecoderSetDetachedContent" title="CMSDecoderSetDetachedContent"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW20" title="CMSDecoderSetDetachedContent"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_32"></a><h3 class="tight">CMSDecoderSetDetachedContent</h3><p class="spaceabove">Specifies the message’s detached content, if any.</p><p class="spaceabove"><pre>
OSStatus CMSDecoderSetDetachedContent(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSDecoderRef">CMSDecoderRef</a>        cmsDecoder,
   <a href="../../../../CoreFoundation/Reference/CFDataRef/Reference/reference.html#//apple_ref/doc/c_ref/CFDataRef" target="_top">CFDataRef</a>            detachedContent
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsDecoder</em></dt><dd><p>The CMSDecoder reference returned by the <code>CMSDecoderCreate</code> function.</p></dd><dt><em>detachedContent</em></dt><dd><p>A reference to the message’s detached content.</p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Discussion</h5><p>The data of a signed CMS message can optionally be sent separately from the message. If the message’s content is detached from the message, you must call this function to tell the decoder where to find the message content.</p><p>Encrypted messages, including those that are also signed, cannot use detached content. </p><p>You can call this function either before or after decoding the message (by calling the <code>CMSDecoderUpdateMessage</code> and <code>CMSDecoderFinalizeMessage</code> functions). If a signed message has detached content, however, you must call this function before you can use the <code>CMSDecoderCopySignerStatus</code> function to ascertain the signature status.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCreate">CMSDecoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderUpdateMessage">CMSDecoderUpdateMessage</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderFinalizeMessage">CMSDecoderFinalizeMessage</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCopySignerStatus">CMSDecoderCopySignerStatus</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCopyDetachedContent">CMSDecoderCopyDetachedContent</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderSetHasDetachedContent">CMSEncoderSetHasDetachedContent</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSDecoder.h</code><a name="//apple_ref/c/func/CMSDecoderSetSearchKeychain" title="CMSDecoderSetSearchKeychain"></a><a name="//apple_ref/doc/c_ref/CMSDecoderSetSearchKeychain" title="CMSDecoderSetSearchKeychain"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_10" title="CMSDecoderSetSearchKeychain"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_33"></a><h3 class="tight">CMSDecoderSetSearchKeychain</h3><p class="spaceabove">Specifies the keychains to search for intermediate certificates to be used in verifying a signed message's signer certificates.</p><p class="spaceabove"><pre>
OSStatus CMSDecoderSetSearchKeychain(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSDecoderRef">CMSDecoderRef</a>        cmsDecoder,
   <a href="../../../../CoreFoundation/Reference/CFTypeRef/Reference/reference.html#//apple_ref/doc/c_ref/CFTypeRef" target="_top">CFTypeRef</a>            keychainOrArray
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsDecoder</em></dt><dd><p>The CMSDecoder reference returned by the <code>CMSDecoderCreate</code> function.</p></dd><dt><em>keychainOrArray</em></dt><dd><p>Either a single keychain to search, specified as a keychain object (type <code>SecKeychainRef</code>), or a set of keychains specified as a <code>CFArray</code> of keychain objects. If you specify an empty <code>CFArrayRef</code>, no keychains are searched for intermediate certificates. </p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Discussion</h5><p>If you don’t call this function, the decoder uses the default keychain search list to search for intermediate certificates. </p><p>If you do call this function, you must call it before you call the <code>CMSDecoderCopySignerStatus</code> function.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCreate">CMSDecoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCopySignerStatus">CMSDecoderCopySignerStatus</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSDecoder.h</code><a name="//apple_ref/c/func/CMSDecoderUpdateMessage" title="CMSDecoderUpdateMessage"></a><a name="//apple_ref/doc/c_ref/CMSDecoderUpdateMessage" title="CMSDecoderUpdateMessage"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW26" title="CMSDecoderUpdateMessage"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_34"></a><h3 class="tight">CMSDecoderUpdateMessage</h3><p class="spaceabove">Feeds raw bytes of the message to be decoded into the decoder.</p><p class="spaceabove"><pre>
OSStatus CMSDecoderUpdateMessage(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSDecoderRef">CMSDecoderRef</a>        cmsDecoder,
   const void          *msgBytes,
   size_t               msgBytesLen
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsDecoder</em></dt><dd><p>The CMSDecoder reference returned by the <code>CMSDecoderCreate</code> function.</p></dd><dt><em>msgBytes</em></dt><dd><p>A pointer to the data to be decoded.</p></dd><dt><em>msgBytesLen</em></dt><dd><p>The length of the data, in bytes.</p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. Returns <code>errSecUnknownFormat</code> upon detection of an improperly formatted CMS message. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes”</a></span> for other result codes. </p><h5 class="tight">Discussion</h5><p>This function can be called multiple times. Call the <code>CMSDecoderFinalizeMessage</code> function when you have no more data to decode.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCreate">CMSDecoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderFinalizeMessage">CMSDecoderFinalizeMessage</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSDecoder.h</code><a name="//apple_ref/c/func/CMSEncode" title="CMSEncode"></a><a name="//apple_ref/doc/c_ref/CMSEncode" title="CMSEncode"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW19" title="CMSEncode"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_35"></a><h3 class="tight">CMSEncode</h3><p class="spaceabove">Encodes a message and obtains the result in one high-level function call.</p><p class="spaceabove"><pre>
OSStatus CMSEncode(
   <a href="../../../../CoreFoundation/Reference/CFTypeRef/Reference/reference.html#//apple_ref/doc/c_ref/CFTypeRef" target="_top">CFTypeRef</a>             signers,
   <a href="../../../../CoreFoundation/Reference/CFTypeRef/Reference/reference.html#//apple_ref/doc/c_ref/CFTypeRef" target="_top">CFTypeRef</a>             recipients,
   const <!--a-->CSSM_OID<!--/a-->       *eContentType,
   <!--a-->Boolean<!--/a-->               detachedContent,
   <a href="reference.html#//apple_ref/doc/c_ref/CMSSignedAttributes">CMSSignedAttributes</a>   signedAttributes,
   const void           *content,
   size_t                contentLen,
   <a href="../../../../CoreFoundation/Reference/CFDataRef/Reference/reference.html#//apple_ref/doc/c_ref/CFDataRef" target="_top">CFDataRef</a>            *encodedContentOut
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>signers</em></dt><dd><p>The identity object for the identity of one signer, specified as type <code>SecIdentityRef</code>, or a <code>CFArray</code> of identity objects of type<code>SecIdentityRef</code>. Pass <code>NULL</code> for this parameter if you do not want to sign the message.</p></dd><dt><em>recipients</em></dt><dd><p>A certificate containing a public encryption key for one message recipient, specified as a certificate object (type <code>SecCertificateRef</code>), or a <code>CFArray</code> of certificate objects. Pass NULL for this parameter if you do not want to encrypt the message.</p></dd><dt><em>eContentType</em></dt><dd><p>The object identifier for the encapsulated data in a signed message. This parameter is optional. If you pass <code>0</code>, the value <code>id-data</code> is used. (This is the normal encapsulated content type for applications such as S/MIME, which uses it to indicate MIME-encoded content.) You can pass any value that is meaningful to your application. </p></dd><dt><em>detachedContent</em></dt><dd><p>Specify <code>TRUE</code> if the signed data is to be separate from the message; that is, if the message is<em>not</em> to include the data to be signed. You cannot specify <code>TRUE</code> for this parameter for an encrypted message.</p></dd><dt><em>signedAttributes</em></dt><dd><p>Attribute flags as defined in <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/CMSSignedAttributes">“Attributes For Signed Messages.”</a></span> Attributes are optional for signed messages and are not used in other types of CMS messages. The use of attributes is described in section 2.5 of the S/MIME 3.1 specification. </p></dd><dt><em>content</em></dt><dd><p>The content that you want to add to the message. The content must conform to the type set in the <code>CMSEncoderSetEncapsulatedContentType</code> parameter (or type <code>id-data</code> if that function has not been called).</p></dd><dt><em>contentLen</em></dt><dd><p>The length of the content being added, in bytes.</p></dd><dt><em>encodedContentOut</em></dt><dd><p>On return, points to the encoded message. You must use the <code>CFRelease</code> function to free this reference when you are finished using it.</p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Discussion</h5><p>If you use this function, you must include content and you must provide valid non-<code>NULL</code> input for at least one of the <code>signers</code> and <code>recipients</code> parameters. You can both encrypt and sign a message; however, you cannot use detached content with an encrypted message. If you want to create a message that contains certificates and no other content, you must use the <code>CMSEncoderAddSupportingCerts</code> function instead of this one. To gain more control over the process of encoding a message, call the sequence of functions beginning with the <code>CMSEncoderCreate</code> function instead of this one. </p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderAddSupportingCerts">CMSEncoderAddSupportingCerts</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCreate">CMSEncoderCreate</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSEncoder.h</code><a name="//apple_ref/c/func/CMSEncoderAddRecipients" title="CMSEncoderAddRecipients"></a><a name="//apple_ref/doc/c_ref/CMSEncoderAddRecipients" title="CMSEncoderAddRecipients"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW7" title="CMSEncoderAddRecipients"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_36"></a><h3 class="tight">CMSEncoderAddRecipients</h3><p class="spaceabove">Specifies a message is to be encrypted and specifies the recipients of the message.</p><p class="spaceabove"><pre>
OSStatus CMSEncoderAddRecipients(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSEncoderRef">CMSEncoderRef</a>        cmsEncoder,
   <a href="../../../../CoreFoundation/Reference/CFTypeRef/Reference/reference.html#//apple_ref/doc/c_ref/CFTypeRef" target="_top">CFTypeRef</a>            recipientOrArray
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsEncoder</em></dt><dd><p>The CMSEncoder reference returned by the <code>CMSEncoderCreate</code> function.</p></dd><dt><em>recipientOrArray</em></dt><dd><p>Either a single certificate containing a public encryption key for one message recipient, specified as a certificate object (type <code>SecCertificateRef</code>), or a set of certificates specified as a <code>CFArray</code> of certificate objects.</p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Discussion</h5><p>Your keychain must contain a certificate that supports encryption for each recipient. You can call this function more than once for the same message. </p><p>You can both sign and encrypt the same message; however, you cannot call both this function and the <code>CMSEncoderSetHasDetachedContent</code> function for the same message. </p><p>If you do call this function, you must call it before the first call to the <code>CMSEncoderUpdateContent</code> function.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCreate">CMSEncoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderSetHasDetachedContent">CMSEncoderSetHasDetachedContent</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderUpdateContent">CMSEncoderUpdateContent</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCopyRecipients">CMSEncoderCopyRecipients</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderIsContentEncrypted">CMSDecoderIsContentEncrypted</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSEncoder.h</code><a name="//apple_ref/c/func/CMSEncoderAddSignedAttributes" title="CMSEncoderAddSignedAttributes"></a><a name="//apple_ref/doc/c_ref/CMSEncoderAddSignedAttributes" title="CMSEncoderAddSignedAttributes"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW29" title="CMSEncoderAddSignedAttributes"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_37"></a><h3 class="tight">CMSEncoderAddSignedAttributes</h3><p class="spaceabove">Specifies attributes for a signed message.</p><p class="spaceabove"><pre>
OSStatus CMSEncoderAddSignedAttributes(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSEncoderRef">CMSEncoderRef</a>          cmsEncoder,
   <a href="reference.html#//apple_ref/doc/c_ref/CMSSignedAttributes">CMSSignedAttributes</a>    signedAttributes
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsEncoder</em></dt><dd><p>The CMSEncoder reference returned by the <code>CMSEncoderCreate</code> function.</p></dd><dt><em>signedAttributes</em></dt><dd><p>Attribute flags as defined in <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/CMSSignedAttributes">“Attributes For Signed Messages.”</a></span></p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Discussion</h5><p>Attributes are optional for signed messages. They are not used for other types of CMS messages.  The use of attributes is described in section 2.5 of the S/MIME 3.1 specification.</p><p>If you do call this function, you must call it before the first call to the <code>CMSEncoderUpdateContent</code> function.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCreate">CMSEncoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderUpdateContent">CMSEncoderUpdateContent</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSEncoder.h</code><a name="//apple_ref/c/func/CMSEncoderAddSigners" title="CMSEncoderAddSigners"></a><a name="//apple_ref/doc/c_ref/CMSEncoderAddSigners" title="CMSEncoderAddSigners"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW6" title="CMSEncoderAddSigners"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_38"></a><h3 class="tight">CMSEncoderAddSigners</h3><p class="spaceabove">Specifies signers of the message.</p><p class="spaceabove"><pre>
OSStatus CMSEncoderAddSigners(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSEncoderRef">CMSEncoderRef</a>        cmsEncoder,
   <a href="../../../../CoreFoundation/Reference/CFTypeRef/Reference/reference.html#//apple_ref/doc/c_ref/CFTypeRef" target="_top">CFTypeRef</a>            signerOrArray
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsEncoder</em></dt><dd><p>The CMSEncoder reference returned by the <code>CMSEncoderCreate</code> function.</p></dd><dt><em>signerOrArray</em></dt><dd><p>The identity object for the identity of one signer, specified as type <code>SecIdentityRef</code>, or a <code>CFArray</code> of identity objects of type<code>SecIdentityRef</code>.</p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Discussion</h5><p>Call this function only if the message is to be signed. You can call this function more than once for the same message. </p><p>If you do call this function, you must call it before the first call to the <code>CMSEncoderUpdateContent</code> function.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCreate">CMSEncoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderUpdateContent">CMSEncoderUpdateContent</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCopySigners">CMSEncoderCopySigners</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCopySignerStatus">CMSDecoderCopySignerStatus</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSEncoder.h</code><a name="//apple_ref/c/func/CMSEncoderAddSupportingCerts" title="CMSEncoderAddSupportingCerts"></a><a name="//apple_ref/doc/c_ref/CMSEncoderAddSupportingCerts" title="CMSEncoderAddSupportingCerts"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW16" title="CMSEncoderAddSupportingCerts"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_39"></a><h3 class="tight">CMSEncoderAddSupportingCerts</h3><p class="spaceabove">Adds certificates to a message.</p><p class="spaceabove"><pre>
OSStatus CMSEncoderAddSupportingCerts(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSEncoderRef">CMSEncoderRef</a>        cmsEncoder,
   <a href="../../../../CoreFoundation/Reference/CFTypeRef/Reference/reference.html#//apple_ref/doc/c_ref/CFTypeRef" target="_top">CFTypeRef</a>            certOrArray
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsEncoder</em></dt><dd><p>The CMSEncoder reference returned by the <code>CMSEncoderCreate</code> function.</p></dd><dt><em>certOrArray</em></dt><dd><p>Either a single certificate, specified as a certificate object (type <code>SecCertificateRef</code>), or a set of certificates specified as a <code>CFArray</code> of certificate objects.</p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Discussion</h5><p>A CMS message can contain arbitrary sets of certificates other than or in addition to those indicating the identity of signers. You can use this function to add such certificates to a message. It is not necessary to call this function for a normal signed message. When you create a signed message, Cryptographic Message Services automatically adds the signer certificates and any intermediate certificates needed to verify the signers.  </p><p>You can use this function even if you don’t sign or encrypt the message, in order to transport one or more certificates. To do so, call <code>CMSEncoderCreate</code> to obtain a <code>CMSEncoderRef</code> reference, call <code>CMSEncoderAddSupportingCerts</code> one or more times, and then call <code>CMSEncoderCopyEncodedContent</code> to complete the message. No additional content need be specified. </p><p>If you do add content to the message in addition to the certificates, you must call this function before the first call to the <code>CMSEncoderUpdateContent</code> function. </p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCreate">CMSEncoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCopyEncodedContent">CMSEncoderCopyEncodedContent</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderUpdateContent">CMSEncoderUpdateContent</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCopySupportingCerts">CMSEncoderCopySupportingCerts</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCopyAllCerts">CMSDecoderCopyAllCerts</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSEncoder.h</code><a name="//apple_ref/c/func/CMSEncoderCopyEncapsulatedContentType" title="CMSEncoderCopyEncapsulatedContentType"></a><a name="//apple_ref/doc/c_ref/CMSEncoderCopyEncapsulatedContentType" title="CMSEncoderCopyEncapsulatedContentType"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW10" title="CMSEncoderCopyEncapsulatedContentType"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_40"></a><h3 class="tight">CMSEncoderCopyEncapsulatedContentType</h3><p class="spaceabove">Obtains the object identifier for the encapsulated data of a signed message.</p><p class="spaceabove"><pre>
   
OSStatus CMSEncoderCopyEncapsulatedContentType(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSEncoderRef">CMSEncoderRef</a>        cmsEncoder,
   <a href="../../../../CoreFoundation/Reference/CFDataRef/Reference/reference.html#//apple_ref/doc/c_ref/CFDataRef" target="_top">CFDataRef</a>           *eContentTypeOut
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsEncoder</em></dt><dd><p>The CMSEncoder reference returned by the <code>CMSEncoderCreate</code> function.</p></dd><dt><em>eContentTypeOut</em></dt><dd><p>On return, points to the object identifier for the encapsulated data in the signed message. </p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Discussion</h5><p>In a signed message, the signed data consists of any type of data (the <em>encapsulated content</em>) plus the signature values. This function returns the object identifier (OID) of the encapsulated content as it was specified with the <code>CMSEncoderSetEncapsulatedContentType</code> function. </p><p>If the <code>CMSEncoderSetEncapsulatedContentType</code> function has not been called for this message, this function returns a  <code>NULL</code> pointer. </p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCreate">CMSEncoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderSetEncapsulatedContentType">CMSEncoderSetEncapsulatedContentType</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSEncoder.h</code><a name="//apple_ref/c/func/CMSEncoderCopyEncodedContent" title="CMSEncoderCopyEncodedContent"></a><a name="//apple_ref/doc/c_ref/CMSEncoderCopyEncodedContent" title="CMSEncoderCopyEncodedContent"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW14" title="CMSEncoderCopyEncodedContent"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_41"></a><h3 class="tight">CMSEncoderCopyEncodedContent</h3><p class="spaceabove">Finishes encoding the message and obtains the encoded result.</p><p class="spaceabove"><pre>
OSStatus CMSEncoderCopyEncodedContent(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSEncoderRef">CMSEncoderRef</a>        cmsEncoder,
   <a href="../../../../CoreFoundation/Reference/CFDataRef/Reference/reference.html#//apple_ref/doc/c_ref/CFDataRef" target="_top">CFDataRef</a>           *encodedContentOut
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsEncoder</em></dt><dd><p>The CMSEncoder reference returned by the <code>CMSEncoderCreate</code> function.</p></dd><dt><em>encodedContentOut</em></dt><dd><p>On return, points to the encoded message. You must use the <code>CFRelease</code> function to free this reference when you are finished using it.</p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Discussion</h5><p>This is the last function in the sequence of encoding functions you call when creating a signed or encrypted message. In many cases, you can call the <code>CMSEncode</code> function alone instead of using the sequence of encoding functions.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCreate">CMSEncoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncode">CMSEncode</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSEncoder.h</code><a name="//apple_ref/c/func/CMSEncoderCopyRecipients" title="CMSEncoderCopyRecipients"></a><a name="//apple_ref/doc/c_ref/CMSEncoderCopyRecipients" title="CMSEncoderCopyRecipients"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW12" title="CMSEncoderCopyRecipients"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_42"></a><h3 class="tight">CMSEncoderCopyRecipients</h3><p class="spaceabove">Obtains the array of recipients specified with the <code>CMSEncoderAddRecipients</code> function.</p><p class="spaceabove"><pre>
OSStatus CMSEncoderCopyRecipients(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSEncoderRef">CMSEncoderRef</a>        cmsEncoder,
   <a href="../../../../CoreFoundation/Reference/CFArrayRef/Reference/reference.html#//apple_ref/doc/c_ref/CFArrayRef" target="_top">CFArrayRef</a>          *recipientsOut
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsEncoder</em></dt><dd><p>The CMSEncoder reference returned by the <code>CMSEncoderCreate</code> function.</p></dd><dt><em>recipientsOut</em></dt><dd><p>On return, points to an array of certificate objects of type <code>SecCertificateRef</code> of the recipients of the message. If the <code>CMSEncoderAddRecipients</code> function has not been called for this message, this function returns a <code>NULL</code> array. You must use the <code>CFRelease</code> function to free this reference when you are finished using it. </p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCreate">CMSEncoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderAddRecipients">CMSEncoderAddRecipients</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSEncoder.h</code><a name="//apple_ref/c/func/CMSEncoderCopySigners" title="CMSEncoderCopySigners"></a><a name="//apple_ref/doc/c_ref/CMSEncoderCopySigners" title="CMSEncoderCopySigners"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW11" title="CMSEncoderCopySigners"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_43"></a><h3 class="tight">CMSEncoderCopySigners</h3><p class="spaceabove">Obtains the array of signers specified with the <code>CMSEncoderAddSigners</code> function.</p><p class="spaceabove"><pre>
OSStatus CMSEncoderCopySigners(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSEncoderRef">CMSEncoderRef</a>        cmsEncoder,
   <a href="../../../../CoreFoundation/Reference/CFArrayRef/Reference/reference.html#//apple_ref/doc/c_ref/CFArrayRef" target="_top">CFArrayRef</a>          *signersOut
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsEncoder</em></dt><dd><p>The CMSEncoder reference returned by the <code>CMSEncoderCreate</code> function.</p></dd><dt><em>signersOut</em></dt><dd><p>On return, points to an array of identity objects of type <code>SecIdentityRef</code> of the signers of the message. If the <code>CMSEncoderAddSigners</code> function has not been called for this message, this function returns a <code>NULL</code> array. You must use the <code>CFRelease</code> function to free this reference when you are finished using it. </p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCreate">CMSEncoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderAddSigners">CMSEncoderAddSigners</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSEncoder.h</code><a name="//apple_ref/c/func/CMSEncoderCopySupportingCerts" title="CMSEncoderCopySupportingCerts"></a><a name="//apple_ref/doc/c_ref/CMSEncoderCopySupportingCerts" title="CMSEncoderCopySupportingCerts"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW15" title="CMSEncoderCopySupportingCerts"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_44"></a><h3 class="tight">CMSEncoderCopySupportingCerts</h3><p class="spaceabove">Obtains the certificates added to a message with <code>CMSEncoderAddSupportingCerts</code>.</p><p class="spaceabove"><pre>
OSStatus CMSEncoderCopySupportingCerts(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSEncoderRef">CMSEncoderRef</a>        cmsEncoder,
   <a href="../../../../CoreFoundation/Reference/CFArrayRef/Reference/reference.html#//apple_ref/doc/c_ref/CFArrayRef" target="_top">CFArrayRef</a>          *certsOut
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsEncoder</em></dt><dd><p>The CMSEncoder reference returned by the <code>CMSEncoderCreate</code> function.</p></dd><dt><em>certsOut</em></dt><dd><p>On return, points to a CFArray of <code>SecCertificateRef</code> objects. You must use the <code>CFRelease</code> function to free this reference when you are finished using it. </p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Discussion</h5><p>A CMS message can contain arbitrary sets of certificates other than or in addition to those indicating the identity of signers. You can use this function to obtain any such certificates added with the <code>CMSEncoderAddSupportingCerts</code> function.  If <code>CMSEncoderAddSupportingCerts</code> has not been called, this function returns a <code>NULL</code> value for <code>certsOut</code>. Note that this function does not return the signing certificates, if any.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCreate">CMSEncoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderAddSupportingCerts">CMSEncoderAddSupportingCerts</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSEncoder.h</code><a name="//apple_ref/c/func/CMSEncoderCreate" title="CMSEncoderCreate"></a><a name="//apple_ref/doc/c_ref/CMSEncoderCreate" title="CMSEncoderCreate"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW1" title="CMSEncoderCreate"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_45"></a><h3 class="tight">CMSEncoderCreate</h3><p class="spaceabove">Creates a CMSEncoder reference. </p><p class="spaceabove"><pre>
OSStatus CMSEncoderCreate(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSEncoderRef">CMSEncoderRef</a>        *cmsEncoderOut
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsEncoderOut</em></dt><dd><p>On return, points to a CMSEncoder reference. You must use the <code>CFRelease</code> function to free this reference when you are finished using it.</p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Discussion</h5><p>This is the first function in a sequence of encoder functions that you call to sign or encrypt a message. The other functions in the sequence require you to pass in the CMSEncoder reference returned by this function. In many cases, you can call the <code>CMSEncode</code> function alone instead of this sequence of encoder functions.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncode">CMSEncode</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSEncoder.h</code><a name="//apple_ref/c/func/CMSEncoderGetCertificateChainMode" title="CMSEncoderGetCertificateChainMode"></a><a name="//apple_ref/doc/c_ref/CMSEncoderGetCertificateChainMode" title="CMSEncoderGetCertificateChainMode"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW17" title="CMSEncoderGetCertificateChainMode"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_46"></a><h3 class="tight">CMSEncoderGetCertificateChainMode</h3><p class="spaceabove">Obtains a constant that indicates which certificates are to be included in a signed CMS message.</p><p class="spaceabove"><pre>
OSStatus CMSEncoderGetCertificateChainMode(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSEncoderRef">CMSEncoderRef</a>               cmsEncoder,
   <a href="reference.html#//apple_ref/doc/c_ref/CMSCertificateChainMode">CMSCertificateChainMode</a>    *chainModeOut
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsEncoder</em></dt><dd><p>The CMSEncoder reference returned by the <code>CMSEncoderCreate</code> function.</p></dd><dt><em>chainMode</em></dt><dd><p>On return, a constant that indicates which certificate or certificates are to be included in the message. See <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/CMSCertificateChainMode">“Certificate Inclusion Constants.”</a></span></p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCreate">CMSEncoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderSetCertificateChainMode">CMSEncoderSetCertificateChainMode</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSEncoder.h</code><a name="//apple_ref/c/func/CMSEncoderGetHasDetachedContent" title="CMSEncoderGetHasDetachedContent"></a><a name="//apple_ref/doc/c_ref/CMSEncoderGetHasDetachedContent" title="CMSEncoderGetHasDetachedContent"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW13" title="CMSEncoderGetHasDetachedContent"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_47"></a><h3 class="tight">CMSEncoderGetHasDetachedContent</h3><p class="spaceabove">Indicates whether the message is to have detached content.</p><p class="spaceabove"><pre>
OSStatus CMSEncoderGetHasDetachedContent(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSEncoderRef">CMSEncoderRef</a>        cmsEncoder,
   <!--a-->Boolean<!--/a-->             *detachedContentOut
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsEncoder</em></dt><dd><p>The CMSEncoder reference returned by the <code>CMSEncoderCreate</code> function.</p></dd><dt><em>detachedContentOut</em></dt><dd><p>Returns <code>TRUE</code> if the message has detached content.</p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Discussion</h5><p>This function returns the value specified in <code>CMSEncoderSetHasDetachedContent</code> if that function has been called; otherwise it returns <code>FALSE</code>.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCreate">CMSDecoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderSetHasDetachedContent">CMSEncoderSetHasDetachedContent</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSEncoder.h</code><a name="//apple_ref/c/func/CMSEncoderGetTypeID" title="CMSEncoderGetTypeID"></a><a name="//apple_ref/doc/c_ref/CMSEncoderGetTypeID" title="CMSEncoderGetTypeID"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_4" title="CMSEncoderGetTypeID"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_48"></a><h3 class="tight">CMSEncoderGetTypeID</h3><p class="spaceabove">Returns the type identifier for the CMSEncoder opaque type.</p><p class="spaceabove"><pre>
<a href="../../../../CoreFoundation/Reference/CFTypeRef/Reference/reference.html#//apple_ref/doc/c_ref/CFTypeID" target="_top">CFTypeID</a> CMSEncoderGetTypeID(void);
</pre></p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">Declared In</h5><code>CMSEncoder.h</code><a name="//apple_ref/c/func/CMSEncoderSetCertificateChainMode" title="CMSEncoderSetCertificateChainMode"></a><a name="//apple_ref/doc/c_ref/CMSEncoderSetCertificateChainMode" title="CMSEncoderSetCertificateChainMode"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW18" title="CMSEncoderSetCertificateChainMode"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_49"></a><h3 class="tight">CMSEncoderSetCertificateChainMode</h3><p class="spaceabove">Specifies which certificates to include in a signed CMS message.</p><p class="spaceabove"><pre>
OSStatus CMSEncoderSetCertificateChainMode(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSEncoderRef">CMSEncoderRef</a>              cmsEncoder,
   <a href="reference.html#//apple_ref/doc/c_ref/CMSCertificateChainMode">CMSCertificateChainMode</a>    chainMode
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsEncoder</em></dt><dd><p>The CMSEncoder reference returned by the <code>CMSEncoderCreate</code> function.</p></dd><dt><em>chainMode</em></dt><dd><p>A constant that indicates which certificate or certificates to include in the message. See <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/CMSCertificateChainMode">“Certificate Inclusion Constants.”</a></span></p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Discussion</h5><p>This function is used only for signed messages and is optional. If you don’t call this function, the default, <code>kCMSCertificateChain</code>, is used. In this case the message includes the signer certificate plus all certificates needed to verify the signer certificate, up to but not including the root  certificate. </p><p>If you do call this function, you must call it before the first call to the <code>CMSEncoderUpdateContent</code> function.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCreate">CMSEncoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderUpdateContent">CMSEncoderUpdateContent</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderGetCertificateChainMode">CMSEncoderGetCertificateChainMode</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSEncoder.h</code><a name="//apple_ref/c/func/CMSEncoderSetEncapsulatedContentType" title="CMSEncoderSetEncapsulatedContentType"></a><a name="//apple_ref/doc/c_ref/CMSEncoderSetEncapsulatedContentType" title="CMSEncoderSetEncapsulatedContentType"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW9" title="CMSEncoderSetEncapsulatedContentType"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_50"></a><h3 class="tight">CMSEncoderSetEncapsulatedContentType</h3><p class="spaceabove">Specifies an object identifier for the encapsulated data of a signed message.</p><p class="spaceabove"><pre>
OSStatus CMSEncoderSetEncapsulatedContentType(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSEncoderRef">CMSEncoderRef</a>        cmsEncoder,
   const <!--a-->CSSM_OID<!--/a-->      *eContentType
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsEncoder</em></dt><dd><p>The CMSEncoder reference returned by the <code>CMSEncoderCreate</code> function.</p></dd><dt><em>eContentType</em></dt><dd><p>The object identifier for the encapsulated data in a signed message. </p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Discussion</h5><p>In a signed message, the signed data consists of any type of content (referred to as the <em>encapsulated content</em>, because it is encapsulated in the signed data) plus the signature values. You can indicate the content type of the encapsulated data by specifying an object identifier (OID) in the <code>eContentType</code> parameter of this function. The default value for the OID (used if this function is not called) is <code>id-data</code>. This is the normal encapsulated content type for applications such as S/MIME, which uses it to indicate MIME-encoded content. You can pass any value that is meaningful to your application. Examples of CMS OIDs are listed in <span class="content_text"><a href="http://www.imc.org/ietf-smime/other-smime-oids.asn" target="_blank">http://www.imc.org/ietf-smime/other-smime-oids.asn</a></span>.</p><p>If you do call this function, you must call it before the first call to the <code>CMSEncoderUpdateContent</code> function.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCreate">CMSEncoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderUpdateContent">CMSEncoderUpdateContent</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCopyEncapsulatedContentType">CMSEncoderCopyEncapsulatedContentType</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCopyEncapsulatedContentType">CMSDecoderCopyEncapsulatedContentType</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSEncoder.h</code><a name="//apple_ref/c/func/CMSEncoderSetHasDetachedContent" title="CMSEncoderSetHasDetachedContent"></a><a name="//apple_ref/doc/c_ref/CMSEncoderSetHasDetachedContent" title="CMSEncoderSetHasDetachedContent"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW8" title="CMSEncoderSetHasDetachedContent"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_51"></a><h3 class="tight">CMSEncoderSetHasDetachedContent</h3><p class="spaceabove">Specifies whether the signed data is to be separate from the message.</p><p class="spaceabove"><pre>
OSStatus CMSEncoderSetHasDetachedContent(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSEncoderRef">CMSEncoderRef</a>        cmsEncoder,
   <!--a-->Boolean<!--/a-->              detachedContent
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsEncoder</em></dt><dd><p>The CMSEncoder reference returned by the <code>CMSEncoderCreate</code> function.</p></dd><dt><em>detachedContent</em></dt><dd><p>Specify <code>TRUE</code> if the signed data is to be separate from the message; that is, if the message is<em>not</em> to include the data to be signed.</p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Discussion</h5><p>A signed CMS message can optionally be sent separately from the signed data. The default, if this function is not called, is <code>detachedContent=FALSE</code>; that is, the message contains the data to be signed.</p><p>Encrypted messages, including those that are also signed, cannot use detached content. </p><p>If you do call this function, you must call it before the first call to the <code>CMSEncoderUpdateContent</code> function.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCreate">CMSEncoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderUpdateContent">CMSEncoderUpdateContent</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderGetHasDetachedContent">CMSEncoderGetHasDetachedContent</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSDecoderSetDetachedContent">CMSDecoderSetDetachedContent</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSEncoder.h</code><a name="//apple_ref/c/func/CMSEncoderUpdateContent" title="CMSEncoderUpdateContent"></a><a name="//apple_ref/doc/c_ref/CMSEncoderUpdateContent" title="CMSEncoderUpdateContent"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-SW5" title="CMSEncoderUpdateContent"></a><a name="//apple_ref/doc/uid/TP40006264-CH2-DontLinkElementID_52"></a><h3 class="tight">CMSEncoderUpdateContent</h3><p class="spaceabove">Feeds content bytes into the encoder.</p><p class="spaceabove"><pre>
OSStatus CMSEncoderUpdateContent(
   <a href="reference.html#//apple_ref/doc/c_ref/CMSEncoderRef">CMSEncoderRef</a>        cmsEncoder,
   const void          *content,
   size_t               contentLen
);
</pre></p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>cmsEncoder</em></dt><dd><p>The CMSEncoder reference returned by the <code>CMSEncoderCreate</code> function.</p></dd><dt><em>content</em></dt><dd><p>The content that you want to add to the message. The content must conform to the type set with the <code>CMSEncoderSetEncapsulatedContentType</code> function (or type <code>id-data</code> if that function has not been called). </p></dd><dt><em>contentLen</em></dt><dd><p>The length of the content being added, in bytes.</p></dd></dl><h5 class="tight">Return Value</h5><p>A result code. See <span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG">“Cryptographic Message Services Result Codes.”</a></span></p><h5 class="tight">Discussion</h5><p>You use this function to add the content that is to be signed or encrypted. If the message is only a container for certificates added with the <code>CMSEncoderAddSupportingCerts</code> function and has no other content, do not call this function. This function can be called multiple times. </p><p>After you are finished adding content, call the <code>CMSEncoderCopyEncodedContent</code> function to complete the message creation process.</p><p>None of the setter functions (<code>CMSEncoderSetHasDetachedContent</code>, <code>CMSEncoderSetEncapsulatedContentType</code>, or <code>CMSEncoderSetCertificateChainMode</code>) can be called after this function has been called. </p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCreate">CMSEncoderCreate</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderSetEncapsulatedContentType">CMSEncoderSetEncapsulatedContentType</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderAddSupportingCerts">CMSEncoderAddSupportingCerts</a></code></li><li class="availability">  <code><a href="reference.html#//apple_ref/c/func/CMSEncoderCopyEncodedContent">CMSEncoderCopyEncodedContent</a></code></li></ul><h5 class="tight">Declared In</h5><code>CMSEncoder.h</code><a name="//apple_ref/doc/uid/TP40006264-CH3-DontLinkElementID_16" title="Data Types"></a><h2>Data Types</h2><a name="//apple_ref/c/tdef/CMSEncoderRef" title="CMSEncoderRef"></a><a name="//apple_ref/doc/c_ref/CMSEncoderRef" title="CMSEncoderRef"></a><a name="//apple_ref/doc/uid/TP40006264-CH3-DontLinkElementID_1" title="CMSEncoderRef"></a><a name="//apple_ref/doc/uid/TP40006264-CH3-DontLinkElementID_53"></a><h3 class="tight">CMSEncoderRef</h3><p class="spaceabove">Opaque reference to a CMS encoder object.</p><p class="spaceabove"><pre>
typedef struct _CMSEncoder *CMSEncoderRef;
</pre></p><h5 class="tight">Discussion</h5><p>This is object is compatible with Core Foundation and uses standard Core Foundation semantics. Dispose of it with the <code><a href="../../../../CoreFoundation/Reference/CFTypeRef/Reference/reference.html#//apple_ref/c/func/CFRelease" target="_top">CFRelease</a></code> function.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">Declared In</h5><code>CMSEncoder.h</code><a name="//apple_ref/c/tdef/CMSDecoderRef" title="CMSDecoderRef"></a><a name="//apple_ref/doc/c_ref/CMSDecoderRef" title="CMSDecoderRef"></a><a name="//apple_ref/doc/uid/TP40006264-CH3-DontLinkElementID_2" title="CMSDecoderRef"></a><a name="//apple_ref/doc/uid/TP40006264-CH3-DontLinkElementID_54"></a><h3 class="tight">CMSDecoderRef</h3><p class="spaceabove">Opaque reference to a CMS decoder object.</p><p class="spaceabove"><pre>
typedef struct _CMSDecoder *CMSDecoderRef;
</pre></p><h5 class="tight">Discussion</h5><p>This is object is compatible with Core Foundation and uses standard Core Foundation semantics. Dispose of it with the <code><a href="../../../../CoreFoundation/Reference/CFTypeRef/Reference/reference.html#//apple_ref/c/func/CFRelease" target="_top">CFRelease</a></code> function.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">Declared In</h5><code>CMSDecoder.h</code><a name="//apple_ref/doc/uid/TP40006264-CH4-DontLinkElementID_17" title="Constants"></a><h2>Constants</h2><a name="//apple_ref/c/tdef/CMSSignedAttributes" title="Attributes For Signed Messages" role="Enum"></a><a name="//apple_ref/doc/c_ref/CMSSignedAttributes" title="Attributes For Signed Messages" role="Enum"></a><a name="//apple_ref/doc/uid/TP40006264-CH4-SW1" title="Attributes For Signed Messages" role="Enum"></a><a name="//apple_ref/doc/uid/TP40006264-CH4-DontLinkElementID_55"></a><h3 class="tight">Attributes For Signed Messages</h3><p class="spaceabove">Optional attributes that can be specified with the <code><a href="reference.html#//apple_ref/c/func/CMSEncoderAddSignedAttributes">CMSEncoderAddSignedAttributes</a></code> function. </p><p class="spaceabove"><pre>
enum {
   <a href="reference.html#//apple_ref/doc/c_ref/kCMSAttrNone">kCMSAttrNone</a>                         = 0<!--a-->x0000<!--/a-->,
   <a href="reference.html#//apple_ref/doc/c_ref/kCMSAttrSmimeCapabilities">kCMSAttrSmimeCapabilities</a>            = 0<!--a-->x0001<!--/a-->,
   <a href="reference.html#//apple_ref/doc/c_ref/kCMSAttrSmimeEncryptionKeyPrefs">kCMSAttrSmimeEncryptionKeyPrefs</a>      = 0<!--a-->x0002<!--/a-->,
   <a href="reference.html#//apple_ref/doc/c_ref/kCMSAttrSmimeMSEncryptionKeyPrefs">kCMSAttrSmimeMSEncryptionKeyPrefs</a>    = 0<!--a-->x0004<!--/a-->,
   <a href="reference.html#//apple_ref/doc/c_ref/kCMSAttrSigningTime">kCMSAttrSigningTime</a>                  = 0<!--a-->x0008<!--/a-->
};
typedef uint32_t CMSSignedAttributes;
</pre></p><h5 class="tight">Constants</h5><dl class="termdef"><a name="//apple_ref/c/econst/kCMSAttrNone" title="kCMSAttrNone"></a><a name="//apple_ref/doc/c_ref/kCMSAttrNone" title="kCMSAttrNone"></a><a name="//apple_ref/doc/uid/TP40006264-CH4-DontLinkElementID_56"></a><dt><code>kCMSAttrNone</code></dt><dd><p>No attributes.</p><p>Available in Mac OS X v10.5 and later.</p><p>Declared in <code>CMSEncoder.h</code>.</p></dd><a name="//apple_ref/c/econst/kCMSAttrSmimeCapabilities" title="kCMSAttrSmimeCapabilities"></a><a name="//apple_ref/doc/c_ref/kCMSAttrSmimeCapabilities" title="kCMSAttrSmimeCapabilities"></a><a name="//apple_ref/doc/uid/TP40006264-CH4-DontLinkElementID_57"></a><dt><code>kCMSAttrSmimeCapabilities</code></dt><dd><p>Adds information to the signed message that identifies signature, encryption, and digest algorithms supported by the encoder. Adding this attribute does not change the way in which the message is encoded. See RFC 2311: <em>S/MIME Version 2 Message Specification</em> (<span class="content_text"><a href="http://www.ietf.org/rfc/rfc2311.txt" target="_blank">http://www.ietf.org/rfc/rfc2311.txt</a></span>) section 2.5.2 for more information about the capabilities attribute.
</p><p>Available in Mac OS X v10.5 and later.</p><p>Declared in <code>CMSEncoder.h</code>.</p></dd><a name="//apple_ref/c/econst/kCMSAttrSmimeEncryptionKeyPrefs" title="kCMSAttrSmimeEncryptionKeyPrefs"></a><a name="//apple_ref/doc/c_ref/kCMSAttrSmimeEncryptionKeyPrefs" title="kCMSAttrSmimeEncryptionKeyPrefs"></a><a name="//apple_ref/doc/uid/TP40006264-CH4-DontLinkElementID_58"></a><dt><code>kCMSAttrSmimeEncryptionKeyPrefs</code></dt><dd><p>Indicates that the signing certificate included with the message is the preferred one for S/MIME encryption. </p><p>Available in Mac OS X v10.5 and later.</p><p>Declared in <code>CMSEncoder.h</code>.</p></dd><a name="//apple_ref/c/econst/kCMSAttrSmimeMSEncryptionKeyPrefs" title="kCMSAttrSmimeMSEncryptionKeyPrefs"></a><a name="//apple_ref/doc/c_ref/kCMSAttrSmimeMSEncryptionKeyPrefs" title="kCMSAttrSmimeMSEncryptionKeyPrefs"></a><a name="//apple_ref/doc/uid/TP40006264-CH4-DontLinkElementID_59"></a><dt><code>kCMSAttrSmimeMSEncryptionKeyPrefs</code></dt><dd><p>Same as <code>kCMSSmimeEncryptionKeyPrefs</code>, using an attribute object identifier (OID) preferred by Microsoft.</p><p>Available in Mac OS X v10.5 and later.</p><p>Declared in <code>CMSEncoder.h</code>.</p></dd><a name="//apple_ref/c/econst/kCMSAttrSigningTime" title="kCMSAttrSigningTime"></a><a name="//apple_ref/doc/c_ref/kCMSAttrSigningTime" title="kCMSAttrSigningTime"></a><a name="//apple_ref/doc/uid/TP40006264-CH4-DontLinkElementID_60"></a><dt><code>kCMSAttrSigningTime</code></dt><dd><p>Causes the encoder to include the signing time. </p><p>Available in Mac OS X v10.5 and later.</p><p>Declared in <code>CMSEncoder.h</code>.</p></dd></dl><h5 class="tight">Discussion</h5><p>These flags cause the encoder to add attributes to a signed message that can be interpreted by the recipient.  These attributes are not used for unsigned messages.</p><h5 class="tight">Declared In</h5><code>CMSEncoder.h</code><a name="//apple_ref/c/tdef/CMSCertificateChainMode" title="Certificate Inclusion Constants" role="Enum"></a><a name="//apple_ref/doc/c_ref/CMSCertificateChainMode" title="Certificate Inclusion Constants" role="Enum"></a><a name="//apple_ref/doc/uid/TP40006264-CH4-SW2" title="Certificate Inclusion Constants" role="Enum"></a><a name="//apple_ref/doc/uid/TP40006264-CH4-DontLinkElementID_61"></a><h3 class="tight">Certificate Inclusion Constants</h3><p class="spaceabove">Constants that can be set by the <code><a href="reference.html#//apple_ref/c/func/CMSEncoderSetCertificateChainMode">CMSEncoderSetCertificateChainMode</a></code> function to specify what certificates to include in a signed message.</p><p class="spaceabove"><pre>
enum {
   <a href="reference.html#//apple_ref/doc/c_ref/kCMSCertificateNone">kCMSCertificateNone</a> = 0,
   <a href="reference.html#//apple_ref/doc/c_ref/kCMSCertificateSignerOnly">kCMSCertificateSignerOnly</a>,
   <a href="reference.html#//apple_ref/doc/c_ref/kCMSCertificateChain">kCMSCertificateChain</a>,
   <a href="reference.html#//apple_ref/doc/c_ref/kCMSCertificateChainWithRoot">kCMSCertificateChainWithRoot</a>
};
typedef uint32_t CMSCertificateChainMode;
</pre></p><h5 class="tight">Constants</h5><dl class="termdef"><a name="//apple_ref/c/econst/kCMSCertificateNone" title="kCMSCertificateNone"></a><a name="//apple_ref/doc/c_ref/kCMSCertificateNone" title="kCMSCertificateNone"></a><a name="//apple_ref/doc/uid/TP40006264-CH4-DontLinkElementID_62"></a><dt><code>kCMSCertificateNone</code></dt><dd><p>Don't include any certificates.</p><p>Available in Mac OS X v10.5 and later.</p><p>Declared in <code>CMSEncoder.h</code>.</p></dd><a name="//apple_ref/c/econst/kCMSCertificateSignerOnly" title="kCMSCertificateSignerOnly"></a><a name="//apple_ref/doc/c_ref/kCMSCertificateSignerOnly" title="kCMSCertificateSignerOnly"></a><a name="//apple_ref/doc/uid/TP40006264-CH4-DontLinkElementID_63"></a><dt><code>kCMSCertificateSignerOnly</code></dt><dd><p>Only include signer certificates.</p><p>Available in Mac OS X v10.5 and later.</p><p>Declared in <code>CMSEncoder.h</code>.</p></dd><a name="//apple_ref/c/econst/kCMSCertificateChain" title="kCMSCertificateChain"></a><a name="//apple_ref/doc/c_ref/kCMSCertificateChain" title="kCMSCertificateChain"></a><a name="//apple_ref/doc/uid/TP40006264-CH4-DontLinkElementID_64"></a><dt><code>kCMSCertificateChain</code></dt><dd><p>Include the signer certificate chain up to but not including the root certificate.</p><p>Available in Mac OS X v10.5 and later.</p><p>Declared in <code>CMSEncoder.h</code>.</p></dd><a name="//apple_ref/c/econst/kCMSCertificateChainWithRoot" title="kCMSCertificateChainWithRoot"></a><a name="//apple_ref/doc/c_ref/kCMSCertificateChainWithRoot" title="kCMSCertificateChainWithRoot"></a><a name="//apple_ref/doc/uid/TP40006264-CH4-DontLinkElementID_65"></a><dt><code>kCMSCertificateChainWithRoot</code></dt><dd><p>Include the entire signer certificate chain, including the root certificate.</p><p>Available in Mac OS X v10.5 and later.</p><p>Declared in <code>CMSEncoder.h</code>.</p></dd></dl><h5 class="tight">Declared In</h5><code>CMSEncoder.h</code><a name="//apple_ref/c/tdef/CMSSignerStatus" title="Signature Status Constants" role="Enum"></a><a name="//apple_ref/doc/c_ref/CMSSignerStatus" title="Signature Status Constants" role="Enum"></a><a name="//apple_ref/doc/uid/TP40006264-CH4-SW3" title="Signature Status Constants" role="Enum"></a><a name="//apple_ref/doc/uid/TP40006264-CH4-DontLinkElementID_66"></a><h3 class="tight">Signature Status Constants</h3><p class="spaceabove">Constants that indicate the status of the signature and signer information in a signed message, as obtained by the <code><a href="reference.html#//apple_ref/c/func/CMSDecoderCopySignerStatus">CMSDecoderCopySignerStatus</a></code> function.</p><p class="spaceabove"><pre>
enum {     <a href="reference.html#//apple_ref/doc/c_ref/kCMSSignerUnsigned">kCMSSignerUnsigned</a> = 0,
   <a href="reference.html#//apple_ref/doc/c_ref/kCMSSignerValid">kCMSSignerValid</a>,
   <a href="reference.html#//apple_ref/doc/c_ref/kCMSSignerNeedsDetachedContent">kCMSSignerNeedsDetachedContent</a>,
   <a href="reference.html#//apple_ref/doc/c_ref/kCMSSignerInvalidSignature">kCMSSignerInvalidSignature</a>,
   <a href="reference.html#//apple_ref/doc/c_ref/kCMSSignerInvalidCert">kCMSSignerInvalidCert</a>,
   <a href="reference.html#//apple_ref/doc/c_ref/kCMSSignerInvalidIndex">kCMSSignerInvalidIndex</a>  }; typedef uint32_t CMSSignerStatus;
</pre></p><h5 class="tight">Constants</h5><dl class="termdef"><a name="//apple_ref/c/econst/kCMSSignerUnsigned" title="kCMSSignerUnsigned"></a><a name="//apple_ref/doc/c_ref/kCMSSignerUnsigned" title="kCMSSignerUnsigned"></a><a name="//apple_ref/doc/uid/TP40006264-CH4-DontLinkElementID_67"></a><dt><code>kCMSSignerUnsigned</code></dt><dd><p>The message was not signed.</p><p>Available in Mac OS X v10.5 and later.</p><p>Declared in <code>CMSDecoder.h</code>.</p></dd><a name="//apple_ref/c/econst/kCMSSignerValid" title="kCMSSignerValid"></a><a name="//apple_ref/doc/c_ref/kCMSSignerValid" title="kCMSSignerValid"></a><a name="//apple_ref/doc/uid/TP40006264-CH4-DontLinkElementID_68"></a><dt><code>kCMSSignerValid</code></dt><dd><p>The message was signed and both the signature and the signer certificate have been verified.</p><p>Available in Mac OS X v10.5 and later.</p><p>Declared in <code>CMSDecoder.h</code>.</p></dd><a name="//apple_ref/c/econst/kCMSSignerNeedsDetachedContent" title="kCMSSignerNeedsDetachedContent"></a><a name="//apple_ref/doc/c_ref/kCMSSignerNeedsDetachedContent" title="kCMSSignerNeedsDetachedContent"></a><a name="//apple_ref/doc/uid/TP40006264-CH4-DontLinkElementID_69"></a><dt><code>kCMSSignerNeedsDetachedContent</code></dt><dd><p>The message was signed but has detached content. You must call the <code><a href="reference.html#//apple_ref/c/func/CMSDecoderSetDetachedContent">CMSDecoderSetDetachedContent</a></code> function before ascertaining the signature status.</p><p>Available in Mac OS X v10.5 and later.</p><p>Declared in <code>CMSDecoder.h</code>.</p></dd><a name="//apple_ref/c/econst/kCMSSignerInvalidSignature" title="kCMSSignerInvalidSignature"></a><a name="//apple_ref/doc/c_ref/kCMSSignerInvalidSignature" title="kCMSSignerInvalidSignature"></a><a name="//apple_ref/doc/uid/TP40006264-CH4-DontLinkElementID_70"></a><dt><code>kCMSSignerInvalidSignature</code></dt><dd><p>The message was signed but the signature is invalid.</p><p>Available in Mac OS X v10.5 and later.</p><p>Declared in <code>CMSDecoder.h</code>.</p></dd><a name="//apple_ref/c/econst/kCMSSignerInvalidCert" title="kCMSSignerInvalidCert"></a><a name="//apple_ref/doc/c_ref/kCMSSignerInvalidCert" title="kCMSSignerInvalidCert"></a><a name="//apple_ref/doc/uid/TP40006264-CH4-DontLinkElementID_71"></a><dt><code>kCMSSignerInvalidCert</code></dt><dd><p>The message was signed but the signer's certificate could not be verified.</p><p>Available in Mac OS X v10.5 and later.</p><p>Declared in <code>CMSDecoder.h</code>.</p></dd><a name="//apple_ref/c/econst/kCMSSignerInvalidIndex" title="kCMSSignerInvalidIndex"></a><a name="//apple_ref/doc/c_ref/kCMSSignerInvalidIndex" title="kCMSSignerInvalidIndex"></a><a name="//apple_ref/doc/uid/TP40006264-CH4-DontLinkElementID_72"></a><dt><code>kCMSSignerInvalidIndex</code></dt><dd><p>The specified value for the signer index (<code>signerIndex</code> parameter) is greater than the number of signers of the message minus one (<code>signerIndex > (numSigners – 1)</code>).</p><p>Available in Mac OS X v10.5 and later.</p><p>Declared in <code>CMSDecoder.h</code>.</p></dd></dl><h5 class="tight">Declared In</h5><code>CMSDecoder.h</code><a name="//apple_ref/doc/uid/TP40006264-CH5-CJBEABHG" title="Result Codes"></a><h2><a name="//apple_ref/doc/uid/TP40006264-CH5-95690" title="Result Codes"></a><a name="//apple_ref/doc/uid/TP40006264-CH5-TPXREF120" title="Result Codes"></a>Result Codes</h2>
<p>Security API result codes are defined in Security/Secbase.h and listed in the table below. The assigned error space for security APIs is discontinuous: –25240 through –25279 and –25290 through –25329. Security APIs may also return <code>noErr</code> (0) or <code>paramErr</code> (–50), or CSSM result codes (see <em>Common Security: CDSA and CSSM, version 2 (with corrigenda)</em> from The Open Group (<span class="content_text"><a href="http://www.opengroup.org/security/cdsa.htm" target="_blank">http://www.opengroup.org/security/cdsa.htm</a></span>)).</p>




<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><tr><th scope="col" align="left"><strong>Result Code</strong></th><th scope="col" align="left"><strong>Value</strong></th><th scope="col" align="left"><strong>Description</strong></th></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_73"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecNotAvailable" title="errSecNotAvailable"></a><a name="//apple_ref/doc/c_ref/errSecNotAvailable" title="errSecNotAvailable"></a><code>errSecNotAvailable</code></td>
<td align="right" valign="top" class="content_text noWrap">–25291</td>

<td valign="top" class="content_text"><p>No trust results are available.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_74"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecReadOnly" title="errSecReadOnly"></a><a name="//apple_ref/doc/c_ref/errSecReadOnly" title="errSecReadOnly"></a><code>errSecReadOnly</code></td>
<td align="right" valign="top" class="content_text noWrap">–25292</td>

<td valign="top" class="content_text"><p>Read only error.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_75"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecAuthFailed" title="errSecAuthFailed"></a><a name="//apple_ref/doc/c_ref/errSecAuthFailed" title="errSecAuthFailed"></a><code>errSecAuthFailed</code></td>
<td align="right" valign="top" class="content_text noWrap">–25293</td>

<td valign="top" class="content_text"><p>Authorization/Authentication failed.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_76"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecNoSuchKeychain" title="errSecNoSuchKeychain"></a><a name="//apple_ref/doc/c_ref/errSecNoSuchKeychain" title="errSecNoSuchKeychain"></a><code>errSecNoSuchKeychain</code></td>
<td align="right" valign="top" class="content_text noWrap">–25294</td>

<td valign="top" class="content_text"><p>The keychain does not exist.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_77"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecInvalidKeychain" title="errSecInvalidKeychain"></a><a name="//apple_ref/doc/c_ref/errSecInvalidKeychain" title="errSecInvalidKeychain"></a><code>errSecInvalidKeychain</code></td>
<td align="right" valign="top" class="content_text noWrap">–25295</td>

<td valign="top" class="content_text"><p>The keychain is not valid.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_78"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecDuplicateKeychain" title="errSecDuplicateKeychain"></a><a name="//apple_ref/doc/c_ref/errSecDuplicateKeychain" title="errSecDuplicateKeychain"></a><code>errSecDuplicateKeychain</code></td>
<td align="right" valign="top" class="content_text noWrap">–25296</td>

<td valign="top" class="content_text"><p>A keychain with the same name already exists.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_79"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecDuplicateCallback" title="errSecDuplicateCallback"></a><a name="//apple_ref/doc/c_ref/errSecDuplicateCallback" title="errSecDuplicateCallback"></a><code>errSecDuplicateCallback</code></td>
<td align="right" valign="top" class="content_text noWrap">–25297</td>

<td valign="top" class="content_text"><p>More than one callback of the same name
exists.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_80"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecInvalidCallback" title="errSecInvalidCallback"></a><a name="//apple_ref/doc/c_ref/errSecInvalidCallback" title="errSecInvalidCallback"></a><code>errSecInvalidCallback</code></td>
<td align="right" valign="top" class="content_text noWrap">–25298</td>

<td valign="top" class="content_text"><p>The callback is not valid.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_81"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecDuplicateItem" title="errSecDuplicateItem"></a><a name="//apple_ref/doc/c_ref/errSecDuplicateItem" title="errSecDuplicateItem"></a><code>errSecDuplicateItem</code></td>
<td align="right" valign="top" class="content_text noWrap">–25299</td>

<td valign="top" class="content_text"><p>The item already exists.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_82"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecItemNotFound" title="errSecItemNotFound"></a><a name="//apple_ref/doc/c_ref/errSecItemNotFound" title="errSecItemNotFound"></a><code>errSecItemNotFound</code></td>
<td align="right" valign="top" class="content_text noWrap">–25300</td>

<td valign="top" class="content_text"><p>The item cannot be found.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_83"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecBufferTooSmall" title="errSecBufferTooSmall"></a><a name="//apple_ref/doc/c_ref/errSecBufferTooSmall" title="errSecBufferTooSmall"></a><code>errSecBufferTooSmall</code></td>
<td align="right" valign="top" class="content_text noWrap">–25301</td>

<td valign="top" class="content_text"><p>The buffer is too small.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_84"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecDataTooLarge" title="errSecDataTooLarge"></a><a name="//apple_ref/doc/c_ref/errSecDataTooLarge" title="errSecDataTooLarge"></a><code>errSecDataTooLarge</code></td>
<td align="right" valign="top" class="content_text noWrap">–25302</td>

<td valign="top" class="content_text"><p>The data is too large for the particular data type.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_85"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecNoSuchAttr" title="errSecNoSuchAttr"></a><a name="//apple_ref/doc/c_ref/errSecNoSuchAttr" title="errSecNoSuchAttr"></a><code>errSecNoSuchAttr</code></td>
<td align="right" valign="top" class="content_text noWrap">–25303</td>

<td valign="top" class="content_text"><p>The attribute does not exist.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_86"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecInvalidItemRef" title="errSecInvalidItemRef"></a><a name="//apple_ref/doc/c_ref/errSecInvalidItemRef" title="errSecInvalidItemRef"></a><code>errSecInvalidItemRef</code></td>
<td align="right" valign="top" class="content_text noWrap">–25304</td>

<td valign="top" class="content_text"><p>The item reference is invalid.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_87"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecInvalidSearchRef" title="errSecInvalidSearchRef"></a><a name="//apple_ref/doc/c_ref/errSecInvalidSearchRef" title="errSecInvalidSearchRef"></a><code>errSecInvalidSearchRef</code></td>
<td align="right" valign="top" class="content_text noWrap">–25305</td>

<td valign="top" class="content_text"><p>The search reference is invalid.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_88"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecNoSuchClass" title="errSecNoSuchClass"></a><a name="//apple_ref/doc/c_ref/errSecNoSuchClass" title="errSecNoSuchClass"></a><code>errSecNoSuchClass</code></td>
<td align="right" valign="top" class="content_text noWrap">–25306</td>

<td valign="top" class="content_text"><p>The keychain item class does not exist.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_89"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecNoDefaultKeychain" title="errSecNoDefaultKeychain"></a><a name="//apple_ref/doc/c_ref/errSecNoDefaultKeychain" title="errSecNoDefaultKeychain"></a><code>errSecNoDefaultKeychain</code></td>
<td align="right" valign="top" class="content_text noWrap">–25307</td>

<td valign="top" class="content_text"><p>A default keychain does not exist.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_90"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecInteractionNotAllowed" title="errSecInteractionNotAllowed"></a><a name="//apple_ref/doc/c_ref/errSecInteractionNotAllowed" title="errSecInteractionNotAllowed"></a><code>errSecInteractionNotAllowed</code></td>
<td align="right" valign="top" class="content_text noWrap">–25308</td>

<td valign="top" class="content_text"><p>Interaction with the Security Server is not allowed.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_91"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecReadOnlyAttr" title="errSecReadOnlyAttr"></a><a name="//apple_ref/doc/c_ref/errSecReadOnlyAttr" title="errSecReadOnlyAttr"></a><code>errSecReadOnlyAttr</code></td>
<td align="right" valign="top" class="content_text noWrap">–25309</td>

<td valign="top" class="content_text"><p>The attribute is read only.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_92"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecWrongSecVersion" title="errSecWrongSecVersion"></a><a name="//apple_ref/doc/c_ref/errSecWrongSecVersion" title="errSecWrongSecVersion"></a><code>errSecWrongSecVersion</code></td>
<td align="right" valign="top" class="content_text noWrap">–25310</td>

<td valign="top" class="content_text"><p>The version is incorrect.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_93"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecKeySizeNotAllowed" title="errSecKeySizeNotAllowed"></a><a name="//apple_ref/doc/c_ref/errSecKeySizeNotAllowed" title="errSecKeySizeNotAllowed"></a><code>errSecKeySizeNotAllowed</code></td>
<td align="right" valign="top" class="content_text noWrap">–25311</td>

<td valign="top" class="content_text"><p>The key size is not allowed.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_94"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecNoStorageModule" title="errSecNoStorageModule"></a><a name="//apple_ref/doc/c_ref/errSecNoStorageModule" title="errSecNoStorageModule"></a><code>errSecNoStorageModule</code></td>
<td align="right" valign="top" class="content_text noWrap">–25312</td>

<td valign="top" class="content_text"><p>There is no storage module available.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_95"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecNoCertificateModule" title="errSecNoCertificateModule"></a><a name="//apple_ref/doc/c_ref/errSecNoCertificateModule" title="errSecNoCertificateModule"></a><code>errSecNoCertificateModule</code></td>
<td align="right" valign="top" class="content_text noWrap">–25313</td>

<td valign="top" class="content_text"><p>There is no certificate module available.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_96"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecNoPolicyModule" title="errSecNoPolicyModule"></a><a name="//apple_ref/doc/c_ref/errSecNoPolicyModule" title="errSecNoPolicyModule"></a><code>errSecNoPolicyModule</code></td>
<td align="right" valign="top" class="content_text noWrap">–25314</td>

<td valign="top" class="content_text"><p>There is no policy module available.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_97"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecInteractionRequired" title="errSecInteractionRequired"></a><a name="//apple_ref/doc/c_ref/errSecInteractionRequired" title="errSecInteractionRequired"></a><code>errSecInteractionRequired</code></td>
<td align="right" valign="top" class="content_text noWrap">–25315</td>

<td valign="top" class="content_text"><p>User interaction is required.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_98"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecDataNotAvailable" title="errSecDataNotAvailable"></a><a name="//apple_ref/doc/c_ref/errSecDataNotAvailable" title="errSecDataNotAvailable"></a><code>errSecDataNotAvailable</code></td>
<td align="right" valign="top" class="content_text noWrap">–25316</td>

<td valign="top" class="content_text"><p>The data is not available.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_99"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecDataNotModifiable" title="errSecDataNotModifiable"></a><a name="//apple_ref/doc/c_ref/errSecDataNotModifiable" title="errSecDataNotModifiable"></a><code>errSecDataNotModifiable</code></td>
<td align="right" valign="top" class="content_text noWrap">–25317</td>

<td valign="top" class="content_text"><p>The data is not modifiable.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_100"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecCreateChainFailed" title="errSecCreateChainFailed"></a><a name="//apple_ref/doc/c_ref/errSecCreateChainFailed" title="errSecCreateChainFailed"></a><code>errSecCreateChainFailed</code></td>
<td align="right" valign="top" class="content_text noWrap">–25318</td>

<td valign="top" class="content_text"><p>The attempt to create a certificate chain failed.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_101"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecInvalidPrefsDomain" title="errSecInvalidPrefsDomain"></a><a name="//apple_ref/doc/c_ref/errSecInvalidPrefsDomain" title="errSecInvalidPrefsDomain"></a><code>errSecInvalidPrefsDomain</code></td>
<td align="right" valign="top" class="content_text noWrap">–25319</td>

<td valign="top" class="content_text"><p>The preference domain specified is invalid.
This error is available in Mac OS X v10.3 and later.</p><p>Available in Mac OS X v10.3 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_102"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecACLNotSimple" title="errSecACLNotSimple"></a><a name="//apple_ref/doc/c_ref/errSecACLNotSimple" title="errSecACLNotSimple"></a><code>errSecACLNotSimple</code></td>
<td align="right" valign="top" class="content_text noWrap">–25240</td>

<td valign="top" class="content_text"><p>The access control list is not in standard simple form.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_103"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecPolicyNotFound" title="errSecPolicyNotFound"></a><a name="//apple_ref/doc/c_ref/errSecPolicyNotFound" title="errSecPolicyNotFound"></a><code>errSecPolicyNotFound</code></td>
<td align="right" valign="top" class="content_text noWrap">–25241</td>

<td valign="top" class="content_text"><p>The policy specified cannot be found.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_104"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecInvalidTrustSetting" title="errSecInvalidTrustSetting"></a><a name="//apple_ref/doc/c_ref/errSecInvalidTrustSetting" title="errSecInvalidTrustSetting"></a><code>errSecInvalidTrustSetting</code></td>
<td align="right" valign="top" class="content_text noWrap">–25242</td>

<td valign="top" class="content_text"><p>The trust setting is invalid.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_105"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecNoAccessForItem" title="errSecNoAccessForItem"></a><a name="//apple_ref/doc/c_ref/errSecNoAccessForItem" title="errSecNoAccessForItem"></a><code>errSecNoAccessForItem</code></td>
<td align="right" valign="top" class="content_text noWrap">–25243</td>

<td valign="top" class="content_text"><p>The specified item has no access control.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_106"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecInvalidOwnerEdit" title="errSecInvalidOwnerEdit"></a><a name="//apple_ref/doc/c_ref/errSecInvalidOwnerEdit" title="errSecInvalidOwnerEdit"></a><code>errSecInvalidOwnerEdit</code></td>
<td align="right" valign="top" class="content_text noWrap">–25244</td>

<td valign="top" class="content_text"><p>An invalid attempt to change the owner of an item.</p><p>Available in Mac OS X v10.2 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_107"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecTrustNotAvailable" title="errSecTrustNotAvailable"></a><a name="//apple_ref/doc/c_ref/errSecTrustNotAvailable" title="errSecTrustNotAvailable"></a><code>errSecTrustNotAvailable</code></td>
<td align="right" valign="top" class="content_text noWrap">–25245</td>

<td valign="top" class="content_text"><p>No trust results are available.</p><p>Available in Mac OS X v10.3 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_108"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecUnsupportedFormat" title="errSecUnsupportedFormat"></a><a name="//apple_ref/doc/c_ref/errSecUnsupportedFormat" title="errSecUnsupportedFormat"></a><code>errSecUnsupportedFormat</code></td>
<td align="right" valign="top" class="content_text noWrap">–25256</td>

<td valign="top" class="content_text"><p>The specified import or export format is not supported.</p><p>Available in Mac OS X v10.4 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_109"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecUnknownFormat" title="errSecUnknownFormat"></a><a name="//apple_ref/doc/c_ref/errSecUnknownFormat" title="errSecUnknownFormat"></a><code>errSecUnknownFormat</code></td>
<td align="right" valign="top" class="content_text noWrap">–25257</td>

<td valign="top" class="content_text"><p>The item you are trying to import has an unknown format.</p><p>Available in Mac OS X v10.4 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_110"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecKeyIsSensitive" title="errSecKeyIsSensitive"></a><a name="//apple_ref/doc/c_ref/errSecKeyIsSensitive" title="errSecKeyIsSensitive"></a><code>errSecKeyIsSensitive</code></td>
<td align="right" valign="top" class="content_text noWrap">–25258</td>

<td valign="top" class="content_text"><p>The key must be wrapped to be exported.</p><p>Available in Mac OS X v10.4 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_111"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecMultiplePrivKeys" title="errSecMultiplePrivKeys"></a><a name="//apple_ref/doc/c_ref/errSecMultiplePrivKeys" title="errSecMultiplePrivKeys"></a><code>errSecMultiplePrivKeys</code></td>
<td align="right" valign="top" class="content_text noWrap">–25259</td>

<td valign="top" class="content_text"><p>An attempt was made to import multiple private keys.</p><p>Available in Mac OS X v10.4 and later.</p></td></tr>
<tr>
<a name="//apple_ref/doc/uid/TP40006264-CH5-DontLinkElementID_112"></a><td valign="top" scope="row"><a name="//apple_ref/c/econst/errSecPassphraseRequired" title="errSecPassphraseRequired"></a><a name="//apple_ref/doc/c_ref/errSecPassphraseRequired" title="errSecPassphraseRequired"></a><code>errSecPassphraseRequired</code></td>
<td align="right" valign="top" class="content_text noWrap">–25260</td>

<td valign="top" class="content_text"><p>A password is required for import or export.</p><p>Available in Mac OS X v10.4 and later.</p></td></tr>
</table></div>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <!-- Previous button --><span style="margin-left: 8px"><a href="../RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-10-31<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Security/Reference/CryptoMessageRef/Reference/reference.html%3Fid%3DTP40006264-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Security/Reference/CryptoMessageRef/Reference/reference.html%3Fid%3DTP40006264-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Security/Reference/CryptoMessageRef/Reference/reference.html%3Fid%3DTP40006264-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>