<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Xsan Reference</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Xsan Reference"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40004357-DontLinkChapterID_1" title="Xsan Reference"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> &gt; <a href="../../../../../reference/Storage/index.html#//apple_ref/doc/uid/TP30001281-TP40001898" target="_top">Storage</a> &gt; <a href="../../../../../reference/Storage/idxFileManagement-date.html#//apple_ref/doc/uid/TP30001281-TP40001898-TP30000448" target="_top">File Management</a> &gt; <a href="../index.html" target="_top">Xsan Reference</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <!-- Previous button --><span style="margin-left: 8px"><a href="../RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40004357-DontLinkChapterID_1-DontLinkElementID_3" title="Xsan Reference"></a><h1>Xsan Reference</h1><div class="spec_sheet_info_box"><table cellspacing="0" class="specbox"><tr><td scope="row"><strong><span class="noWrap">Companion guide</span></strong></td><td><div style="margin-bottom:1px"><span class="content_text"><a href="../../../../Networking/Conceptual/Xsan/index.html#//apple_ref/doc/uid/TP40001165" target="_top">Xsan Programming Guide</a></span><br/></div></td></tr></table></div><br/><a name="//apple_ref/doc/uid/TP40004357-CH1-DontLinkElementID_1" title="Overview"></a><h2>Overview</h2><p>This book describes the <code>fcntl</code>(2) requests that make up the Xsan API.</p><a name="//apple_ref/doc/uid/TP40004357-DontLinkChapterID_1-DontLinkElementID_2" title="Functions by Task"></a><h2>Functions by Task</h2><p>The <code>fcntl</code>(2) requests are organized into the following sections:</p>
<ul class="ul"><li class="li"><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40004357-CH206-359102">“Getting Information About Xsan.”</a></span> This section describes the <code>fcntl</code>(2) request that gets version information about Xsan, including the version, build, and creation date of a kernel that includes Xsan, and the API version.</p></li>
<li class="li"><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40004357-CH206-380989">“Managing Affinities.”</a></span> This section describes the <code>fcntl</code>(2) requests for getting and setting a file’s affinity.</p></li>
<li class="li"><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40004357-CH206-353133">“Managing Space in Files.”</a></span> This section describes the <code>fcntl</code>(2) requests for managing space in files. There is a request that allocates extent space in a file and a request that gets the list of the extent space that has been allocated for a file.</p></li>
<li class="li"><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40004357-CH206-314819">“Working With Real-Time I/O.”</a></span> This section describes <code>fcntl</code>(2) requests that manage real-time I/O. Real-time I/O can be enabled for a storage pool or for an individual file descriptor. When real-time I/O is enabled for a storage pool, you must also enable real-time I/O for a specific file descriptor. This section also includes requests that get the real-time I/O parameters of a storage pool and that disable real-time I/O for a file descriptor.</p></li>
<li class="li"><p><span class="content_text"><a href="reference.html#//apple_ref/doc/uid/TP40004357-CH206-326426">“Managing Quotas.”</a></span> This section describes <code>fcntl</code>(2) requests that allow you to get the current disk usage for a user or a group and to set the disk quota limits for a user or a group.</p></li></ul>
<a name="//apple_ref/doc/uid/TP40004357-CH206-359102" title="Getting Information About Xsan"></a><a name="//apple_ref/doc/uid/TP40004357-CH206-BBCJBBGD" title="Getting Information About Xsan"></a>
    
    <h3 class="tasks"><a name="//apple_ref/doc/uid/TP40004357-CH206-TPXREF113" title="Getting Information About Xsan"></a>Getting Information About Xsan</h3>
    <p>This request described in this section gets Xsan version information, consisting of version, build, and creation date of a kernel that includes Xsan, and the API version.</p>    
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/F_GETVERINFO">F_GETVERINFO</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Gets Xsan version information.'/>
            </span></li>
    </ul>


<a name="//apple_ref/doc/uid/TP40004357-CH206-380989" title="Managing Affinities"></a><a name="//apple_ref/doc/uid/TP40004357-CH206-BBCDJGBI" title="Managing Affinities"></a>
    
    <h3 class="tasks"><a name="//apple_ref/doc/uid/TP40004357-CH206-TPXREF114" title="Managing Affinities"></a>Managing Affinities</h3>
    <p>The requests described in this section are for getting and setting the affinity for a file.</p>    
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/F_GETAFFINITY">F_GETAFFINITY</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Gets the affinity for a file.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/F_SETAFFINITY">F_SETAFFINITY</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Sets the affinity for a file.'/>
            </span></li>
    </ul>


<a name="//apple_ref/doc/uid/TP40004357-CH206-353133" title="Managing Space in Files"></a><a name="//apple_ref/doc/uid/TP40004357-CH206-BBCFBCID" title="Managing Space in Files"></a>
    
    <h3 class="tasks"><a name="//apple_ref/doc/uid/TP40004357-CH206-TPXREF115" title="Managing Space in Files"></a>Managing Space in Files</h3>
    <p>The requests described in this section allow you to allocate extent space in and file and get the list of extent space that has already been allocated in a file.</p>    
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/F_ALLOCEXTSPACE">F_ALLOCEXTSPACE</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Allocates extent space in a file.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/F_GETEXTLIST">F_GETEXTLIST</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Gets the list of extents for a file.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/F_LOADEXT">F_LOADEXT</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Pre-loads a range of extents for a file.'/>
            </span></li>
    </ul>


<a name="//apple_ref/doc/uid/TP40004357-CH206-314819" title="Working With Real-Time I/O"></a><a name="//apple_ref/doc/uid/TP40004357-CH206-BBCIJJJG" title="Working With Real-Time I/O"></a>
    
    <h3 class="tasks"><a name="//apple_ref/doc/uid/TP40004357-CH206-TPXREF116" title="Working With Real-Time I/O"></a>Working With Real-Time I/O</h3>
    <p>The <code>fcntl</code>(2) requests described in this section manage real-time I/O. Real-time  I/O can be enabled for a storage pool or a file descriptor by the <code>F_SETRTIO</code> request. When real-time I/O is enabled for a storage pool, you must also make a <code>F_ENABLERTIO</code> request for a specific file descriptor. This section also includes requests that get the real-time I/O parameters of a storage pool and that disable real-time I/O for a file descriptor.</p>    
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/F_SETRTIO">F_SETRTIO</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Enables the real-time I/O feature for a storage pool or a file.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/F_GETRTIO">F_GETRTIO</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Gets the real-time I/O parameters for a storage pool.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/F_ENABLERTIO">F_ENABLERTIO</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Enables real-time I/O for a file descriptor.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/F_DISABLERTIO">F_DISABLERTIO</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Disables real-time I/O for a file descriptor.'/>
            </span></li>
    </ul>


<a name="//apple_ref/doc/uid/TP40004357-CH206-326426" title="Managing Quotas"></a><a name="//apple_ref/doc/uid/TP40004357-CH206-BBCCIJFG" title="Managing Quotas"></a>
    
    <h3 class="tasks"><a name="//apple_ref/doc/uid/TP40004357-CH206-TPXREF117" title="Managing Quotas"></a>Managing Quotas</h3>
    <p>These <code>fcntl</code> requests allow you to get the current disk usage for a user or a group and set the disk quota limits for a user or a group.</p>    
    <ul class="tooltip">
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/F_GETQUOTA">F_GETQUOTA</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Gets the current quota usage and limits for a user or a group.'/>
            </span></li>
            <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                
                <code><a href="reference.html#//apple_ref/c/func/F_SETQUOTA">F_SETQUOTA</a></code>
                
					<img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Sets quota limits for a user or a group.'/>
            </span></li>
    </ul>

<a name="//apple_ref/doc/uid/TP40004357-CH206-253250" title="Functions"></a><a name="//apple_ref/doc/uid/TP40004357-CH206-BBCEJDCJ" title="Functions"></a><h2><a name="//apple_ref/doc/uid/TP40004357-CH206-TPXREF111" title="Functions"></a>Functions</h2>






















<a name="//apple_ref/c/func/F_ALLOCEXTSPACE" title="F_ALLOCEXTSPACE"></a><a name="//apple_ref/doc/c_ref/F_ALLOCEXTSPACE" title="F_ALLOCEXTSPACE"></a><a name="//apple_ref/doc/uid/TP40004357-CH206-BBCIBCAI" title="F_ALLOCEXTSPACE"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH206-DontLinkElementID_5"></a><h3 class="tight">F_ALLOCEXTSPACE</h3>
<p class="spaceabove">Allocates extent space in a file.</p>
<p class="spaceabove"><pre>
fcntl (
int fd,
AllocSpaceReqReply_t ReqReply);
   
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>fd</em></dt>
<dd><p>File descriptor for the file for which extent space is to be allocated.</p></dd>
<dt><em>ReqReply</em></dt>
<dd><p>An <code>AllocSpaceReqReply_t</code> union consisting of an <code>AllocSpaceReq_t</code> structure <code><a href="reference.html#//apple_ref/c/tdef/AllocSpaceReq_t">AllocSpaceReq_t Structure</a></code> and an <code>AllocSpaceReply_t</code> structure <code><a href="reference.html#//apple_ref/c/tdef/AllocSpaceReply_t">AllocSpaceReply_t Structure</a></code>. For details on the <code>AllocSpaceReqReply_t</code> union, see <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/AllocSpaceReqReply_t">AllocSpaceReqReply_t Union</a></span>.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>Zero indicates success; –1 indicates failure and <code>errno</code> is set to indicate the error. Possible values include <code>ENOSPC</code> (insufficient space in the file system to satisfy the request), <code>EINVAL</code> (invalid affinity), and <code>EEXISTS</code> (an allocation already exists that maps some or all of the specified offset and length).</p>
<h5 class="tight">Discussion</h5>
<p>This request allocates in the file specified by <code>fd</code> a single extent of the specified size (<code>aq_size</code>) beginning at the next file system block boundary beyond the current end of file. The number of bytes allocated is rounded up to the file system block size.</p>
<p>You can also specify the offset (<code>ac_offset</code>) at which the allocation is to start, in which case, the request allocates space at the specified offset, rounded up to the file system block size. If any portion of &lt;offset + size> has already been allocated, this request returns <code>EEXISTS</code>.</p>
<p>In both cases, the file size is updated if the allocation causes an increase in the current end of file.</p>
<p>You can also use this request to set the file’s affinity. When a file’s affinity is set, this and all future allocations will be made only from storage pools that have the matching affinity. If the file’s affinity has already been set, using this request to set the file’s affinity has no effect.</p>
<p>You can also use this request to cause extent information to be loaded into the file system client’s extent mapping tables. Loading extent information improves performance by eliminating a subsequent trip to the metadata controller to retrieve extent information for the range mapped by this request.All byte sizes and offsets are rounded up to the nearest file system block size. On output, the <code>AllocSpaceReqReply_t</code> union contains the actual allocated size and offset.</p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in Xsan version 1.0.</p><a name="//apple_ref/c/func/F_DISABLERTIO" title="F_DISABLERTIO"></a><a name="//apple_ref/doc/c_ref/F_DISABLERTIO" title="F_DISABLERTIO"></a><a name="//apple_ref/doc/uid/TP40004357-CH206-BBCFAACC" title="F_DISABLERTIO"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH206-DontLinkElementID_6"></a><h3 class="tight">F_DISABLERTIO</h3>
<p class="spaceabove">Disables real-time I/O for a file descriptor.</p>
<p class="spaceabove"><pre>
fcntl (
int fd,
F_DISABLERTIO);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>fd</em></dt>
<dd><p>File descriptor for the target file.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>Zero indicates success; –1 indicates failure and <code>errno</code> is set to indicate the error.</p>
<h5 class="tight">Discussion</h5>
<p>This request disables the real-time I/O for the specified file descriptor and releases bandwidth to the file system. Any subsequent I/O using the specified file descriptor will be gated even if the storage pool remains in real-time mode. Real-time I/O is also disabled and bandwidth released to the file system when <code>fd</code> is closed.</p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in Xsan version 1.0.</p><a name="//apple_ref/c/func/F_ENABLERTIO" title="F_ENABLERTIO"></a><a name="//apple_ref/doc/c_ref/F_ENABLERTIO" title="F_ENABLERTIO"></a><a name="//apple_ref/doc/uid/TP40004357-CH206-BBCEDDHI" title="F_ENABLERTIO"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH206-DontLinkElementID_7"></a><h3 class="tight">F_ENABLERTIO</h3>
<p class="spaceabove">Enables real-time I/O for a file descriptor.</p>
<p class="spaceabove"><pre>
fcntl (
int fd,
F_ENABLERTIO);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>fd</em></dt>
<dd><p>File descriptor for the target file.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>Zero indicates success; –1 indicates failure and <code>errno</code> is set to indicate the error.</p>
<h5 class="tight">Discussion</h5>
<p>This request enables real-time I/O for the specified file descriptor, which gives the file descriptor full, ungated access to the SAN. File descriptors for which real-time I/O is enabled remain in real-time mode until real-time mode is explicitly disabled (by making an <code><a href="reference.html#//apple_ref/c/func/F_DISABLERTIO">F_DISABLERTIO</a></code> request or the file descriptor is closed.</p>
<p>It is important to note that gating occurs on a file descriptor basis, not a file basis. It is therefore possible for multiple threads with multiple file descriptors to share a file, and for some of them to receive ungated (real-time) access, while the others have gated access.</p>
<p>You do not need to make this request if the file descriptor refers to a regular file and the file descriptor was specified in an <code><a href="reference.html#//apple_ref/c/func/F_SETRTIO">F_SETRTIO</a></code> request.</p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in Xsan version 1.0.</p><a name="//apple_ref/c/func/F_GETAFFINITY" title="F_GETAFFINITY"></a><a name="//apple_ref/doc/c_ref/F_GETAFFINITY" title="F_GETAFFINITY"></a><a name="//apple_ref/doc/uid/TP40004357-CH206-BBCHBHGC" title="F_GETAFFINITY"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH206-DontLinkElementID_8"></a><h3 class="tight">F_GETAFFINITY</h3>
<p class="spaceabove">Gets the affinity for a file.</p>
<p class="spaceabove"><pre>
fcntl(
int fd,
F_GETAFFINITY,
GetAffinityReply_t reply);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>fd</em></dt>
<dd><p>File descriptor for the target file.</p></dd>
<dt><em>reply</em></dt>
<dd><p>A <code>GetAffinityReply_t</code> structure. For details, see <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/GetAffinityReply_t">GetAffinityReply_t Structure</a></span>.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>Zero indicates success; –1 indicates failure and <code>errno</code> is set to indicate the error.</p>
<h5 class="tight">Discussion</h5>
<p>This request gets the current affinity for the file specified by <code>fd</code>. When a file’s affinity is set, all future allocations are made only from storage pools that have an affinity that matches the file’s affinity. In this way, the affinity is used to direct space allocations from specific storage pools.</p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in Xsan version 1.0.</p><a name="//apple_ref/c/func/F_GETEXTLIST" title="F_GETEXTLIST"></a><a name="//apple_ref/doc/c_ref/F_GETEXTLIST" title="F_GETEXTLIST"></a><a name="//apple_ref/doc/uid/TP40004357-CH206-BBCGDAJE" title="F_GETEXTLIST"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH206-DontLinkElementID_9"></a><h3 class="tight">F_GETEXTLIST</h3>
<p class="spaceabove">Gets the list of extents for a file.</p>
<p class="spaceabove"><pre>
fcntl(
int fd,
F_GETEXTLIST,
GetExtListReqReply_t reqreply);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>fd</em></dt>
<dd><p>File descriptor for the target file.</p></dd>
<dt><em>reqreply</em></dt>
<dd><p>A <code>GetExtListReqReply_t</code> union consisting of a <code>GetExtListReq_t</code> structure <code><a href="reference.html#//apple_ref/c/tdef/GetExtListReq_t">GetExtListReq_t Structure</a></code> and a <code>GetExtListReply_t</code> structure <code><a href="reference.html#//apple_ref/c/tdef/GetExtListReply_t">GetExtListReply_t Structure</a></code>. For details on the <code>GetExtListReqReply_t</code> union, see <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/GetExtListReqReply_t">GetExtListReqReply_t Union</a></span>.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p><code>ENOENT</code> indicates that all of the file’s extents have been returned; –1 indicates failure and <code>errno</code> is set to indicate the error. Possible values include <code>EFAULT</code> (buffer is invalid) and <code>EINVAL</code> (invalid starting offset, which probably indicates that the extent list has changed).</p>
<h5 class="tight">Discussion</h5>
<p>This iterative request returns as many extents as possible in a single request directly from the metadata controller but does not load the extents in the file system client’s extent map.</p>
<p>The caller is responsible for allocating and freeing buffers used by this request. A file may have many extents, so the caller can iterate over the list, specifying a different starting offset in the <code>gq_startfrbase</code> field of the <code>GetExtListReq_t</code> <code><a href="reference.html#//apple_ref/c/tdef/GetExtListReq_t">GetExtListReq_t Structure</a></code> structure. When no more extents are available, this request returns <code>ENOENT</code>. </p>
<p>The caller must allocate the buffer for the reply data and initialize the <code>gq_buf</code> field of the <code>GetExtListReply_t</code> <code><a href="reference.html#//apple_ref/c/tdef/GetExtListReply_t">GetExtListReply_t Structure</a></code> structure to point to it. The buffer should be aligned on a minimum of an 8 byte boundary.</p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in Xsan version 1.0.</p><a name="//apple_ref/c/func/F_GETQUOTA" title="F_GETQUOTA"></a><a name="//apple_ref/doc/c_ref/F_GETQUOTA" title="F_GETQUOTA"></a><a name="//apple_ref/doc/uid/TP40004357-CH206-BBCGAABG" title="F_GETQUOTA"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH206-DontLinkElementID_10"></a><h3 class="tight">F_GETQUOTA</h3>
<p class="spaceabove">Gets the current quota usage and limits for a user or a group.</p>
<p class="spaceabove"><pre>
fcntl(
int fd,
F_GETQUOTA,
GetQuotaReqReply_t reqreply);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>fd</em></dt>
<dd><p>File descriptor for any file; usually a file descriptor for the root directory.</p></dd>
<dt><em>reqreply</em></dt>
<dd><p>A <code>GetQuotaReqReply_t</code> union consisting of a <code>GetQuotaReq_t</code> structure<code><a href="reference.html#//apple_ref/c/tdef/GetQuotaReq_t">GetQuotaReq_t Structure</a></code> and a <code>GetQuotaReply_t</code> structure <code><a href="reference.html#//apple_ref/c/tdef/GetQuotaReply_t">GetQuotaReply_t Structure</a></code>. For details on the <code>GetQuotaReqReply_t</code> union, see <span class="content_text"><a href="reference.html#//apple_ref/c/tag/_getquotareqreply">GetQuotaReqReply_t Union</a></span>.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>Zero indicates success; –1 indicates failure and <code>errno</code> is set to indicate the error. Possible values include <code>ENOTSUP</code> (the quota system is not enabled on the metadata controller, the file system client, or both), <code>EINVAL</code> (the <code>gq_type</code> field of the <code>GetQuotaReq_t</code> structure is not <code>QUOTA_TYPE_USER</code> or <code>QUOTA_TYPE_GROUP</code>), or <code>ENOENT</code> (the <code>gq_quotaname</code> field of the <code>GetQuotaReq_t</code> structure is not a valid user or group name).</p>
<h5 class="tight">Discussion</h5>
<p>This request gets the current quota usage and limits for the specified user or group. The <code>fd</code> parameter may refer to any open file or directory that resides on the file system; it does not have to represent a file owned by the user or group whose quota values are being queried.</p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in Xsan version 1.0.</p><a name="//apple_ref/c/func/F_GETRTIO" title="F_GETRTIO"></a><a name="//apple_ref/doc/c_ref/F_GETRTIO" title="F_GETRTIO"></a><a name="//apple_ref/doc/uid/TP40004357-CH206-BBCJGDCF" title="F_GETRTIO"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH206-DontLinkElementID_11"></a><h3 class="tight">F_GETRTIO</h3>
<p class="spaceabove">Gets the real-time I/O parameters for a storage pool.</p>
<p class="spaceabove"><pre>
fcntl (
int fd,
RtQueryReqReply_t reqreply);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>fd</em></dt>
<dd><p>File descriptor for the target file, which can be any file in the file system.</p></dd>
<dt><em>reqreply</em></dt>
<dd><p>An <code>RtQueryReqReply_t</code> union consisting of an <code>RtReq_t</code> structure <code><a href="reference.html#//apple_ref/c/tdef/RtReq_t">RtReq_t Structure</a></code> and an <code>RtQueryReply_t</code> structure <code><a href="reference.html#//apple_ref/c/tdef/RtQueryReply_t">RtQueryReply_t Structure</a></code>. For details on the <code>RtQueryReqReply_t</code> union, see <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/RtQueryReqReply_t">RtQueryReqReply_t Union</a></span>.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>Zero indicates success; –1 indicates failure and <code>errno</code> is set to indicate the error.</p>
<h5 class="tight">Discussion</h5>
<p>This request returns the real-time parameters for a storage pool. The parameters include the stripe group number, the real-time I/O limit in I/O operations per second, the amount of real-time I/O currently committed to file system clients, the number of non-real-time I/O operations per second a file system client is most likely to obtain when requesting non-real-time I/O, and the number of file system clients that have outstanding non-real-time I/O tokens.</p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in Xsan version 1.0.</p><a name="//apple_ref/c/func/F_GETVERINFO" title="F_GETVERINFO"></a><a name="//apple_ref/doc/c_ref/F_GETVERINFO" title="F_GETVERINFO"></a><a name="//apple_ref/doc/uid/TP40004357-CH206-BBCDHCCJ" title="F_GETVERINFO"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH206-DontLinkElementID_12"></a><h3 class="tight">F_GETVERINFO</h3>
<p class="spaceabove">Gets Xsan version information.</p>
<p class="spaceabove"><pre>
fcntl (
int fd,
F_GETVERINFO,
VerInfoReply_t reply);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>fd</em></dt>
<dd><p>File descriptor for any file.</p></dd>
<dt><em>reply</em></dt>
<dd><p>A <code>VerInfoReply_t</code> structure. On output, the version, build, and creation date of a kernel that includes Xsan, and the API version. For details, see <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/VerInfoReply_t">VerInfoReply_t Structure</a></span>.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>Zero indicates success; –1 indicates failure and <code>errno</code> is set to indicate the error.</p>
<h5 class="tight">Discussion</h5>
<p>This request returns the version, build, and creation date of a kernel that includes Xsan, as well as the version of this API, in a <code>VerInfoReply_t</code> structure.</p>
<p>Call <code>statfs</code>(2) to determine whether a volume is an Xsan volume. For Xsan folumes, <code>statfs</code>(2) returns <code>acfs</code> in the <code>f_fstypename</code> field.</p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in Xsan version 1.0.</p><a name="//apple_ref/c/func/F_LOADEXT" title="F_LOADEXT"></a><a name="//apple_ref/doc/c_ref/F_LOADEXT" title="F_LOADEXT"></a><a name="//apple_ref/doc/uid/TP40004357-CH206-BBCHDCFD" title="F_LOADEXT"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH206-DontLinkElementID_13"></a><h3 class="tight">F_LOADEXT</h3>
<p class="spaceabove">Pre-loads a range of extents for a file.</p>
<p class="spaceabove"><pre>
fcntl(
int fd,
F_LOADEXT,
LoadExtReq_t req);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>fd</em></dt>
<dd><p>File descriptor for the target file.</p></dd>
<dt><em>req</em></dt>
<dd><p>A <code>LoadExtReq_t</code> <code><a href="reference.html#//apple_ref/c/tdef/LoadExtReq_t">LoadExtReq_t Structure</a></code> structure.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>Zero indicates success; –1 indicates failure and <code>errno</code> is set to indicate the error.</p>
<h5 class="tight">Discussion</h5>
<p>This request pre-loads the specified extent information and is used to increase performance when the file is first accessed. Any holes in the file are preserved.</p>
<p>This request does not allocate any space.</p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in Xsan version 1.0.</p><a name="//apple_ref/c/func/F_SETAFFINITY" title="F_SETAFFINITY"></a><a name="//apple_ref/doc/c_ref/F_SETAFFINITY" title="F_SETAFFINITY"></a><a name="//apple_ref/doc/uid/TP40004357-CH206-BBCHAECE" title="F_SETAFFINITY"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH206-DontLinkElementID_14"></a><h3 class="tight">F_SETAFFINITY</h3>
<p class="spaceabove">Sets the affinity for a file.</p>
<p class="spaceabove"><pre>
fcntl(
int fd,
F_SETAFFINITY,
SetAffinityReq_t req);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>fd</em></dt>
<dd><p>File descriptor for the target file.</p></dd>
<dt><em>req</em></dt>
<dd><p>A <code>SetAffinityReq_t</code> structure. For details, see <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/SetAffinityReq_t">SetAffinityReq_t Structure</a></span>.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>Zero indicates success; –1 indicates failure and <code>errno</code> is set to indicate the error.</p>
<h5 class="tight">Discussion</h5>
<p>This request sets the affinity for a file. When a file’s affinity is set, all future allocations are made only from storage pools that have an affinity that matches the file’s affinity.</p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in Xsan version 1.0.</p><a name="//apple_ref/c/func/F_SETQUOTA" title="F_SETQUOTA"></a><a name="//apple_ref/doc/c_ref/F_SETQUOTA" title="F_SETQUOTA"></a><a name="//apple_ref/doc/uid/TP40004357-CH206-BBCDJJFE" title="F_SETQUOTA"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH206-DontLinkElementID_15"></a><h3 class="tight">F_SETQUOTA</h3>
<p class="spaceabove">Sets quota limits for a user or a group.</p>

<p class="spaceabove"><pre>
fcntl(
int fd,
F_SETQUOTA,
SetQuotaReq_t req);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>fd</em></dt>
<dd><p>File descriptor for any file; usually a file descriptor for the root directory.</p></dd>
<dt><em>req</em></dt>
<dd><p>A <code>SetQuotaReq_t</code> structure. For details, see <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/SetQuotaReq_t">SetQuotaReq_t Structure</a></span>.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>Zero indicates success; –1 indicates failure and <code>errno</code> is set to indicate the error. Possible values include <code>ENOTSUP</code> (the quota system is not enabled on the metadata controller or the file system client, or both), <code>EINVAL</code> (the <code>sq_type</code> field of the <code>SetQuotaReq_t</code> structure is not <code>QUOTA_TYPE_USER</code> or <code>QUOTA_TYPE_GROUP</code>), <code>ENOENT</code> (the <code>sq_quotaname</code> field of the <code>SetQuotaReq_t</code> structure is not a valid user or group name), or <code>EIO</code> (the <code>sq_softlimit</code> field of the <code>SetQuotaReq_t</code> structure is greater than <code>sq_hardlimit</code> field of that structure, or an internal error occurred).</p>
<h5 class="tight">Discussion</h5>
<p>This request sets the quota limit for the specified user or group. The <code>fd</code> parameter may refer to any open file or directory that resides on the file system; it does not have to represent a file owned by the user or group whose quota values are being set.</p>
<p>The quota system automatically rounds up the specified hard and soft limits to the nearest file system block size.</p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in Xsan version 1.0.</p><a name="//apple_ref/c/func/F_SETRTIO" title="F_SETRTIO"></a><a name="//apple_ref/doc/c_ref/F_SETRTIO" title="F_SETRTIO"></a><a name="//apple_ref/doc/uid/TP40004357-CH206-BBCGDCFD" title="F_SETRTIO"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH206-DontLinkElementID_16"></a><h3 class="tight">F_SETRTIO</h3>
<p class="spaceabove">Enables the real-time I/O feature for a storage pool or a file.</p>
<p class="spaceabove"><pre>
fcntl (
int fd;
RtReqRepy_t reqrep);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>fd</em></dt>
<dd><p>File descriptor for the target file, in which case, the request affects the target file only, or file descriptor for the root directory, in which case, the request affects all files in the storage pool.</p></dd>
<dt><em>reqreply</em></dt>
<dd><p>An <code>RtReqReply_t</code> union consisting of an<code> RtReq_t</code> structure <code><a href="reference.html#//apple_ref/c/tdef/RtReq_t">RtReq_t Structure</a></code> and an <code>RtReply_t</code> structure <code><a href="reference.html#//apple_ref/c/tdef/RtReply_t">RtReply_t Structure</a></code>. For details on the <code>RtReqReply_t</code> union, see <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/RtReqReply_t">RtReqReply_t Union</a></span>.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>Zero indicates success; –1 indicates failure and <code>errno</code> is set to indicate the error.</p>
<h5 class="tight">Discussion</h5>
<p>This request makes the real-time I/O feature available for files in a storage pool (if <code>fd</code> refers to the root directory) or enables real-time I/O for a file (if <code>fd</code> refers to a regular file). Storage pools can have different access characteristics and can be used for different types of files (for example, audio and video files), so real-time I/O is set on a storage pool basis, as opposed to a file system basis.</p>
<p>The caller specifies the desired number of I/O operations per second or the number of megabytes per second for the storage pool or file in the <code>rq_rtios</code> field or the <code>rq_rtmb</code> field of the <code>RtReq_t</code> structure <code><a href="reference.html#//apple_ref/c/tdef/RtReq_t">RtReq_t Structure</a></code>. The desired number of I/O operations per second can be calculated by dividing megabytes per second by the file system block size, stripe breadth, and stripe depth. For example, given an 8 disk storage pool with a stripe breadth of 16 and a file system block size of 4KB, a requested rate of 50 MB per second would be (50MB per second * 1024KB) / (8 * 16 * 4KB) = 100 I/O operations per second.</p>
<p>If the desired amount of bandwidth is not be available at the time of the request, in which case the <code>F_SETRTIO</code> request will successfully but with less than the requested amount. If that amount of bandwidth is not acceptable, you should disable real-time I/O mode for the storage pool or file and make the request again. Alternatively, you can set the <code>RT_MUST</code> flag in the <code>flags</code> field of the <code>RtReq_t</code> structure <code><a href="reference.html#//apple_ref/c/tdef/RtReq_t">RtReq_t Structure</a></code> when making an <code>F_SETRTIO</code> request. When the <code>RT_MUST</code> flag is set, the <code>F_SETRTIO</code> request fails when the requested amount of bandwidth is not available. You can repeat the request until the desired amount of bandwidth is available.</p>
<p>You can reduce the number of I/O operations per second or the number of megabytes per second by setting the <code>RT_CLEAR</code> flag, setting the <code>rq_rtios</code> field or the <code>rq_rtmb</code> field to the amount to be subtracted, and making this request again.</p>
<p>If the file descriptor is for the root directory of the file system (<code>/</code>), upon successful return from this request the parameters specified by this request apply to all files on the specified storage pool that are opened and put into real-time I/O mode by an <code><a href="reference.html#//apple_ref/c/func/F_ENABLERTIO">F_ENABLERTIO</a></code> request.</p>
<p>To remove a storage pool from real-time I/O mode, specify zero in the <code>rq_rtios</code> field or the <code>rq_rtmb</code> field of the <code>RtReq_t</code> structure, set the <code>RT_CLEAR</code> flag, and make this request again. Any file descriptors that are in real-time mode return to non-real-time I/O mode but are not gated. Note that closing the file descriptor for the root directory does not make real-time I/O mode unavailable on the storage pool.</p>
<p>If the file descriptor is for a regular file, upon successful return from this request, the file descriptor is in real-time I/O mode, and no additional requests are required. Extent structure mapping is loaded by default. You can disable extent structure mapping by setting <code>RT_NOLOAD</code> in the <code>rq_flags</code> field of the <code>RtReq_t</code> structure. After this request, existing file descriptors on the storage pool are gated and any new file descriptors that are opened are gated. Making an <code>F_SETRTIO</code> request for a regular file (as opposed to an <code>F_ENABLERTIO</code> request) allows non-cooperating applications to request different amounts of real-time I/O on the same storage pool.</p>
<p>If the same file is shared in real-time and non-real-time mode, the caller must use the <code>fcntl</code>(2) system call to differentiate between real-time and non-real-time accesses. This is because file descriptor flags are not exported down to the file system. The call to identify the real-time file descriptor is <code>fcntl(fd, F_SETFL, O_SYNC)</code>.</p>
<p>Explicitly or implicitly closing the file descriptor disables real-time I/O mode and causes the bandwidth allocated for real-time I/O to be returned to the system. However, if a file has multiple file descriptors, real-time I/O is not disabled until the last file descriptor is closed. When real-time I/O mode is disabled and no other file descriptor on the storage pool is in real-time I/O mode, other file descriptors that are open are no longer gated.</p>
<p>If the system running the metadata controller software is rebooted or is reset, file system clients attempt to renegotiate the real-time I/O requirements for storage pools and individual files with the metadata controller. Renegotiation may introduce a period of instability. The order in which requests are processed during the recovery period may make it impossible to guarantee the same bandwidth as prior to the reboot or reset. If the same amount of real-time bandwidth cannot be obtained during recovery processing, the next access to a file descriptor that is real-time mode will fail and an event will be logged in the system log.</p>
<p>The file system cannot distinguish between the use of <code>O_SYNC</code> for identifying real-time file descriptors and for specifying synchronous writes. Therefore, when a file is opened <code>O_SYNC</code> or if <code>O_SYNC</code> is set on the file via <code>fcntl</code>(2), all writes are synchronous and all I/O performed on the file is non-gated.</p>
<h5 class="tight">Version Notes</h5>
<p>Introduced in Xsan version 1.0.</p><a name="//apple_ref/doc/uid/TP40004357-CH1g-257841" title="Data Types"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCFABFD" title="Data Types"></a><h2><a name="//apple_ref/doc/uid/TP40004357-CH1g-TPXREF109" title="Data Types"></a>Data Types</h2>
<a name="//apple_ref/c/tdef/AllocSpaceReqReply_t" title="AllocSpaceReqReply_t Union"></a><a name="//apple_ref/doc/c_ref/AllocSpaceReqReply_t" title="AllocSpaceReqReply_t Union"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCFGCFJ" title="AllocSpaceReqReply_t Union"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_17"></a><h3 class="tight">AllocSpaceReqReply_t Union</h3>
<p class="spaceabove">Union used to allocate extent space in a file.</p>
<p class="spaceabove"><pre>
typedef union _allocspacereqreply {
AllocSpaceReq_t req;
AllocSpaceReply_t reply
} AllocSpaceReqReply_t;
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>req</code></dt>
<dd><p>An <code>AllocSpaceReq_t</code> structure containing information describing how the extent space is to be allocated. For details, see <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/AllocSpaceReq_t">AllocSpaceReq_t Structure</a></span>.</p></dd>
<dt><code>reply</code></dt>
<dd><p>An <code>AllocSpaceReply_t</code> structure. On output, this structure contains information describing the results of the allocation. For details, see <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/AllocSpaceReply_t">AllocSpaceReply_t Structure</a></span>.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>AllocSpaceReqReply_t</code> union is used as a parameter to the <code><a href="reference.html#//apple_ref/c/func/F_ALLOCEXTSPACE">F_ALLOCEXTSPACE</a></code> request.</p>
<a name="//apple_ref/c/tdef/AllocSpaceReq_t" title="AllocSpaceReq_t Structure"></a><a name="//apple_ref/doc/c_ref/AllocSpaceReq_t" title="AllocSpaceReq_t Structure"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCIGGJG" title="AllocSpaceReq_t Structure"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_18"></a><h3 class="tight">AllocSpaceReq_t Structure</h3>
<p class="spaceabove">Structure used to request the allocation of extent space in a file.</p>
<p class="spaceabove"><pre>
typedef struct _AllocSpaceReq {
uint64_t aq_size;
uint64_t aq_offset;
uint64_t aq_affinitykey;
uint32_t aq_flags;
#define ALLOC_OFFSET 0x01
#define ALLOC_LOAD_EXT 0x02
#define ALLOC_STRIPE_ALIGN 0x04
#define ALLOC_AFFINITY 0x08
#define ALLOC_KEEPSIZE 0x10
#define ALLOC_PERFECTFIT 0x20
uint32_t aq_pad1;
} AllocSpaceReq_t;
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>aq_size</code></dt>
<dd><p>Number of bytes to allocate; must not be zero. If not a multiple of the file system block size, the number is rounded up to the nearest file system block size.</p></dd>
<dt><code>aq_offset</code></dt>
<dd><p>If <code>ALLOC_OFFSET</code> is set, then <code>aq_size</code> bytes (rounded up to the nearest file system block size) will be allocated starting at the file byte offset <code>aq_offset</code> (rounded up to the nearest file system block size). If <code>ALLOC_OFFSET</code> is not set, the value of <code>aq_offset</code> is ignored when allocating space and the space is allocated at the end of the file.</p></dd>
<dt><code>aq_affinitykey</code></dt>
<dd><p>Affinity identifier specifying the affinity for the allocation; valid only if <code>ALLOC_AFFINITY</code> is set in <code>aq_flags</code>. The affinity identifier forces the space to be allocated exclusively from storage pools with a matching affinity.</p></dd>
<dt><code>aq_flags</code></dt>
<dd><p>Control flags. For details, see <code><!--a  -->Space Allocation Control Flags<!--/a--></code>.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code></code><code>AllocSpaceReq_t</code> structure is used to request the allocation of extent space in a file. This structure is a member of the <code>AllocSpaceReqReply_t</code> union <code><a href="reference.html#//apple_ref/c/tdef/AllocSpaceReqReply_t">AllocSpaceReqReply_t Union</a></code> that is passed as a parameter to the <code><a href="reference.html#//apple_ref/c/func/F_ALLOCEXTSPACE">F_ALLOCEXTSPACE</a></code> request.</p>
<a name="//apple_ref/c/tdef/AllocSpaceReply_t" title="AllocSpaceReply_t Structure"></a><a name="//apple_ref/doc/c_ref/AllocSpaceReply_t" title="AllocSpaceReply_t Structure"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCHAEGE" title="AllocSpaceReply_t Structure"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_19"></a><h3 class="tight">AllocSpaceReply_t Structure</h3>
<p class="spaceabove">Structure used for receiving replies from requests to allocate extent space.</p>
<p class="spaceabove"><pre>
typedef struct _AllocSpaceReply {
uint64_t ar_size;
uint64_t ar_offset;
} AllocSpaceReply_t;
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>ar_size</code></dt>
<dd><p>The amount of extent space that was allocated in bytes and rounded up, if necessary to the nearest file system block size.</p></dd>
<dt><code>ar_offset</code></dt>
<dd><p>The file byte offset at which the extent space was allocated. If <code>ALLOC_OFFSET</code> was set in the <code>aq_flags</code> field of the <code>AllocSpaceReq_t</code> structure <code><a href="reference.html#//apple_ref/c/tdef/AllocSpaceReq_t">AllocSpaceReq_t Structure</a></code>, the space was allocated starting at the specified file byte offset. If <code>ALLOC_OFFSET</code> was not set, the space was allocated at the end of the file.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code></code><code>AllocSpaceReply_t</code> structure is used to receive the results of allocating extent space in a file. This structure is a member of the <code>AllocSpaceReqReply_t</code> union <code><a href="reference.html#//apple_ref/c/tdef/AllocSpaceReqReply_t">AllocSpaceReqReply_t Union</a></code> that is passed as a parameter to the <code><a href="reference.html#//apple_ref/c/func/F_ALLOCEXTSPACE">F_ALLOCEXTSPACE</a></code> request.</p>
<a name="//apple_ref/c/tdef/CvExternalExtent_t" title="CvExternalExtent_t Structure"></a><a name="//apple_ref/doc/c_ref/CvExternalExtent_t" title="CvExternalExtent_t Structure"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCJEGCB" title="CvExternalExtent_t Structure"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_20"></a><h3 class="tight">CvExternalExtent_t Structure</h3>
<p class="spaceabove">Structure used to describe an extent of a file.</p>
<p class="spaceabove"><pre>
typedef struct _cvexternalextent {
uint64_t ex_frbase;
uint64_t ex_base;
uint64_t ex_end;
uint32_t ex_sg;
uint32_t ex_depth;
} CvExternalExtent_t;
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>ex_frbase</code></dt>
<dd><p>File-relative starting byte offset. This offset can be anywhere in the extent; it does not have to correspond exactly to the starting offset of an extent. Any extent that contains <code>ex_frbase</code> is returned.</p></dd>
<dt><code>ex_base</code></dt>
<dd><p>File system starting byte offset.</p></dd>
<dt><code>ex_end</code></dt>
<dd><p>File system ending byte, inclusive. This byte offset is inclusive and specifies the last valid byte in the extent, so it is not a multiple of the file system block size. To get the starting offset of the next extent, add one to <code>ex_end</code>.</p></dd>
<dt><code>ex_sg</code></dt>
<dd><p>Storage pool ordinal.</p></dd>
<dt><code>ex_depth</code></dt>
<dd><p>Depth of the storage pool for this extent. Storage pools can grow and shrink dynamically, so the depth of the extent may not match the current depth of the storage pool.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code></code><code>CvExternalExtent_t</code> structure is used to receive information the describes an extent of a file when an <code><a href="reference.html#//apple_ref/c/func/F_GETEXTLIST">F_GETEXTLIST</a></code> request is made.</p>
<a name="//apple_ref/c/tdef/GetAffinityReply_t" title="GetAffinityReply_t Structure"></a><a name="//apple_ref/doc/c_ref/GetAffinityReply_t" title="GetAffinityReply_t Structure"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCDFDHJ" title="GetAffinityReply_t Structure"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_21"></a><h3 class="tight">GetAffinityReply_t Structure</h3>
<p class="spaceabove">Structure used to receive the affinity for a file.</p>
<p class="spaceabove"><pre>
typedef struct getaffinityreply {
uint64_t ar_affinity;
} GetAffinityReply_t;
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>ar_affinity</code></dt>
<dd><p>The file’s current affinity.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>GetAffinityReply_t</code> structure is used as a parameter to the <code><a href="reference.html#//apple_ref/c/func/F_GETAFFINITY">F_GETAFFINITY</a></code> request to receive the affinity for a file.</p>
<a name="//apple_ref/c/tdef/GetExtListReqReply_t" title="GetExtListReqReply_t Union"></a><a name="//apple_ref/doc/c_ref/GetExtListReqReply_t" title="GetExtListReqReply_t Union"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCICEHI" title="GetExtListReqReply_t Union"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_22"></a><h3 class="tight">GetExtListReqReply_t Union</h3>
<p class="spaceabove">Union used to get the list of extents for a file.</p>
<p class="spaceabove"><pre>
typedef union _getextlistreqrep {
GetExtListReq_t req;
GetExtListReply_t reply;
} GetExtListReqReply_t;
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>req</code></dt>
<dd><p>A <code>GetExtListReq_t</code> structure specifying the file whose extents are to be obtained. For details, see <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/GetExtListReq_t">GetExtListReq_t Structure</a></span>.</p></dd>
<dt><code>reply</code></dt>
<dd><p>A <code>GetExtListReply_t</code> structure. On output, this structure contains the results of the request. For details, see <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/GetExtListReply_t">GetExtListReply_t Structure</a></span>.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>GetExtListReqReply_t</code> union is used as a parameter to the <code><a href="reference.html#//apple_ref/c/func/F_GETEXTLIST">F_GETEXTLIST</a></code> request.</p>
<a name="//apple_ref/c/tdef/GetExtListReq_t" title="GetExtListReq_t Structure"></a><a name="//apple_ref/doc/c_ref/GetExtListReq_t" title="GetExtListReq_t Structure"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCJIHIA" title="GetExtListReq_t Structure"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_23"></a><h3 class="tight">GetExtListReq_t Structure</h3>
<p class="spaceabove">Structure used to request the list of extents for a file.</p>
<p class="spaceabove"><pre>
typedef struct _getextlistreq {
uint64_t gq_startfrbase;
uint32_t gq_numbufs;
uint32_t gq_pad1;
void *qb_buf;
} GetExtListReq_t;
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>gq_startfrbase</code></dt>
<dd><p>Starting file-relative byte offset.</p></dd>
<dt><code>gq_numbufs</code></dt>
<dd><p>Number of <code>CvExternalExtent_t</code> structures the buffer pointed to by <code>qb_buf</code> can accommodate. For information on this structure, see <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/CvExternalExtent_t">CvExternalExtent_t Structure</a></span>.</p></dd>
<dt><code>gq_pad1</code></dt>
<dd><p>Pad.</p></dd>
<dt><code>gq_buf</code></dt>
<dd><p>User-allocated buffer where <code><a href="reference.html#//apple_ref/c/func/F_GETEXTLIST">F_GETEXTLIST</a></code> is to place an array of <code>CvExternalExtent_t</code> structures.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code></code><code>GetExtListReq_t</code> structure is used to request the list of extents in a file. This structure is a member of the <code>GetExtListReqReply_t</code> union <code><a href="reference.html#//apple_ref/c/tdef/GetExtListReqReply_t">GetExtListReqReply_t Union</a></code> that is passed as a parameter to the <code><a href="reference.html#//apple_ref/c/func/F_GETEXTLIST">F_GETEXTLIST</a></code> request.</p>
<a name="//apple_ref/c/tdef/GetExtListReply_t" title="GetExtListReply_t Structure"></a><a name="//apple_ref/doc/c_ref/GetExtListReply_t" title="GetExtListReply_t Structure"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCFHABG" title="GetExtListReply_t Structure"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_24"></a><h3 class="tight">GetExtListReply_t Structure</h3>
<p class="spaceabove">Structure used to receive the list of extents for a file.</p>
<p class="spaceabove"><pre>
typedef struct _getextlistreply {
uint32_t gr_numreturned;
uint32_t gr_pad;
} GetExtListReply_t;
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>gr_numreturned</code></dt>
<dd><p>Number of <code>CvExternalExtent_t</code> <code><a href="reference.html#//apple_ref/c/tdef/CvExternalExtent_t">CvExternalExtent_t Structure</a></code> structures in the buffer pointed to by the <code>gq_buf</code> field in the <code>GetExtListReq_t</code> structure.</p></dd>
<dt><code>gr_pad</code></dt>
<dd><p>Pad.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code></code><code>GetExtListReply_t</code> structure is used to receive the list of extent space for a file. This structure is a member of the <code><a href="reference.html#//apple_ref/c/tdef/GetExtListReqReply_t">GetExtListReqReply_t Union</a></code> union that is passed as a parameter to the <code><a href="reference.html#//apple_ref/c/func/F_GETEXTLIST">F_GETEXTLIST</a></code> request.</p>
<a name="//apple_ref/c/tag/_getquotareqreply" title="GetQuotaReqReply_t Union"></a><a name="//apple_ref/doc/c_ref/_getquotareqreply" title="GetQuotaReqReply_t Union"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCDGAIF" title="GetQuotaReqReply_t Union"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_25"></a><h3 class="tight">GetQuotaReqReply_t Union</h3>
<p class="spaceabove">Union used to get quota information for a user or group.</p>
<p class="spaceabove"><pre>
typedef union _getquotareqreply {
GetQuotaReq_t req;
GetQuotaReply_t reply;
} GetQuotaReqReply_t
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>req</code></dt>
<dd><p>A <code>GetQuotaReq_t</code> structure specifying the user or group for which quota information is to be obtained. For details, see <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/GetQuotaReq_t">GetQuotaReq_t Structure</a></span>.</p></dd>
<dt><code>reply</code></dt>
<dd><p>A <code>GetQuotaReply_t</code> structure. On output, this structure contains the results of the request. For details, see <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/GetQuotaReply_t">GetQuotaReply_t Structure</a></span>.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>GetQuotaReqReply_t</code> union is used as a parameter to the <code><a href="reference.html#//apple_ref/c/func/F_GETQUOTA">F_GETQUOTA</a></code> request.</p>
<a name="//apple_ref/c/tdef/GetQuotaReq_t" title="GetQuotaReq_t Structure"></a><a name="//apple_ref/doc/c_ref/GetQuotaReq_t" title="GetQuotaReq_t Structure"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCFIDJB" title="GetQuotaReq_t Structure"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_26"></a><h3 class="tight">GetQuotaReq_t Structure</h3>
<p class="spaceabove">Structure used to request quota information for a user or a group.</p>
<p class="spaceabove"><pre>
#define MAX_QUOTA_NAME_LENGTH 256
typedef struct _getquotareq {
uint32_t gq_type;
#define <!--a-->QUOTA_TYPE_USER<!--/a-->(uint32_t)’U’
#define <!--a-->QUOTA_TYPE_GROUP<!--/a-->(uint32_t)’G’
uint32_t gq_pad;
char gq_quotaname[MAX_QUOTA_NAME_LENGTH];
} GetQuotaReq_t;
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>gq_type</code></dt>
<dd><p>Type of quota (user or group) to get; must be <code>QUOTA_TYPE_USER</code> or <code>QUOTA_TYPE_GROUP</code>.</p></dd>
<dt><code>gq_pad</code></dt>
<dd><p>Pad.</p></dd>
<dt><code>gq_quotaname</code></dt>
<dd><p>The null-terminated name of the user or group whose quota is being obtained.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code></code><code>GetQuotaReq_t</code> structure is used to request quota information for a user or a group. This structure is a member of the <code>GetQuotaReqReply_t</code> union <code><a href="reference.html#//apple_ref/c/tag/_getquotareqreply">GetQuotaReqReply_t Union</a></code> that is passed as a parameter to the <code><a href="reference.html#//apple_ref/c/func/F_GETQUOTA">F_GETQUOTA</a></code> request.</p>
<a name="//apple_ref/c/tdef/GetQuotaReply_t" title="GetQuotaReply_t Structure"></a><a name="//apple_ref/doc/c_ref/GetQuotaReply_t" title="GetQuotaReply_t Structure"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCEICED" title="GetQuotaReply_t Structure"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_27"></a><h3 class="tight">GetQuotaReply_t Structure</h3>
<p class="spaceabove">Structure used to receive quota information for a user or group.</p>
<p class="spaceabove"><pre>
typedef struct _getquotareply {
uint64_t gr_hardlimit;
uint64_t gr_softlimit;
uint64_t gr_cursize;
uint32_t gr_timelimit;
uint32_t gr_timeout;
} GetQuotaReply_t;
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>gr_hardlimit</code></dt>
<dd><p>The hard quota limit in bytes, rounded up to the nearest file system block.</p></dd>
<dt><code>gr_softlimit</code></dt>
<dd><p>The soft quota limit in bytes, rounded up to the nearest file system block.</p></dd>
<dt><code>gr_cursize</code></dt>
<dd><p>The current usage in bytes, rounded up to the nearest file system block.</p></dd>
<dt><code>gr_timelimit</code></dt>
<dd><p>When the soft limit is exceeded, <code>gr_timelimit</code> contains the amount of time (in minutes) before the soft limit will be treated as a hard limit.</p></dd>
<dt><code>gr_timeout</code></dt>
<dd><p>If the soft quota has been exceeded, <code>gr_timeout</code> contains the time in seconds since January 1, 1970 at which the soft limit will be treated as a hard limit.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>GetQuotaReply_t</code> structure is used to receive quota information for a user or a group. This structure is a member of the <code>GetQuotaReqReply_t</code> union <code><a href="reference.html#//apple_ref/c/tag/_getquotareqreply">GetQuotaReqReply_t Union</a></code> that is passed as a parameter to the <code><a href="reference.html#//apple_ref/c/func/F_GETQUOTA">F_GETQUOTA</a></code> request.</p>
<a name="//apple_ref/c/tdef/LoadExtReq_t" title="LoadExtReq_t Structure"></a><a name="//apple_ref/doc/c_ref/LoadExtReq_t" title="LoadExtReq_t Structure"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCJJACI" title="LoadExtReq_t Structure"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_28"></a><h3 class="tight">LoadExtReq_t Structure</h3>
<p class="spaceabove">Structure used to specify the range of extents that is to be pre-loaded.</p>
<p class="spaceabove"><pre>
typedef struct _LoadExtReq {
uint64_t lq_size;
uint64_t lq_offset;
uint32_t lq_pad1;
uint32_t lq_pad2;
} LoadExtReq_t;
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>lq_size</code></dt>
<dd><p>The amount of extent space in bytes that is to be pre-loaded and rounded up, if necessary to the nearest file system block size.</p></dd>
<dt><code>lq_offset</code></dt>
<dd><p>The starting file byte offset of the range of extents that is to be pre-loaded.</p></dd>
<dt><code>lq_pad1</code></dt>
<dd><p>Pad.</p></dd>
<dt><code>lq_pad2</code></dt>
<dd><p>Pad.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>LoadExtReq_t</code> structure is used to specify the starting byte offset and the size of the extent space that is to be pre-loaded. This structure is passed as a parameter to the <code><a href="reference.html#//apple_ref/c/func/F_LOADEXT">F_LOADEXT</a></code> request.</p>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCGGBCB" title="Real-Time I/O Control Flags"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_29"></a><h3 class="tight">Real-Time I/O Control Flags</h3>
<p class="spaceabove">The real-time I/O control flags are used when requesting real-time I/O for a storage pool or file descriptor.</p>
<p class="spaceabove"><pre>
   
</pre></p>
<h5 class="tight">Discussion</h5>
<p>The real-time I/O control flags are specified in the <code>rq_flags</code> field of the <code>RtReq_t</code> structure <code><a href="reference.html#//apple_ref/c/tdef/RtReq_t">RtReq_t Structure</a></code> when making an <code><a href="reference.html#//apple_ref/c/func/F_SETRTIO">F_SETRTIO</a></code> request. The following flags are available:</p><a name="//apple_ref/doc/uid/TP40004357-CH1g-385808" title="Table 1Real-time I/O control flags"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">
<caption class="tablecaption"><strong>Table 1&nbsp;&nbsp;</strong>Real-time I/O control flags</caption>

<tr>
<td  scope="row"><p><code>RT_IO</code></p></td>
<td ><p>Indicates that the <code>rr_rtio</code> field of the <code>RtReq_t</code> structure <code><a href="reference.html#//apple_ref/c/tdef/RtReq_t">RtReq_t Structure</a></code> contains valid data and that the request for real-time I/O is being made in real-time I/O operations per second.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>RT_MB</code></p></td>
<td ><p>Indicates that the <code>rr_rtmb</code> field of the <code>RtReq_t</code> structure <code><a href="reference.html#//apple_ref/c/tdef/RtReq_t">RtReq_t Structure</a></code> contains is valid data and that the request for real-time I/O is being made in megabytes per second.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>RT_CLEAR</code></p></td>
<td ><p>Disables real-time I/O for the specified storage pool. For each <code>F_SETRTIO</code> request, <code>RT_CLEAR</code> or <code>RT_SET</code> must be set.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>RT_SET</code></p></td>
<td ><p>Enables real-time I/O for the specified storage pool or file descriptor. For each <code>F_SETRTIO</code> request, <code>RT_CLEAR</code> or <code>RT_SET</code> must be set.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>RT_MUST</code></p></td>
<td ><p>Causes the request for real-time I/O to fail if the requested amount of bandwidth cannot be satisfied. Using this flag prevents the metadata controller from returning a lesser amount than was requested.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>RT_SEQ</code></p></td>
<td ><p>Reserved for future use.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>RT_NOGATE</code></p></td>
<td ><p>Puts the specified file descriptor into ungated mode if <code>RT_SET</code> is also set. In this mode, I/O using this file descriptor is not in real-time I/O mode, yet does not consume non-real-time I/O bandwidth and is not gated. This flag is typically set for files that are accessed infrequently, such as index files, where the caller takes full responsibility to ensure that enough bandwidth is available. When <code>RT_NOGATE</code> is set, the <code>rq_rtios</code> and <code>rq_rtmb</code> fields of the <code>RtReq_t</code> structure should not contain valid data. If <code>RT_NOGATE</code> <code>and
RT_CLEAR</code> are set, the file descriptor is removed from this mode.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>RT_NOLOAD</code></p></td>
<td ><p>Prevents the loading of extent structure mapping.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>RT_ABSOLUTE</code></p></td>
<td ><p>Indicates that the request is an absolute request and not one of a series of multiple incremental requests.</p></td>
</tr>

</table></div>
<a name="//apple_ref/c/tdef/RtQueryReqReply_t" title="RtQueryReqReply_t Union"></a><a name="//apple_ref/doc/c_ref/RtQueryReqReply_t" title="RtQueryReqReply_t Union"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCHABBC" title="RtQueryReqReply_t Union"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_30"></a><h3 class="tight">RtQueryReqReply_t Union</h3>
<p class="spaceabove">Union used to get the real-time parameters for a storage pool.</p>
<p class="spaceabove"><pre>
typedef union rtqueryreqrep {
RtReq_t req;
RtQueryReply_t reply;
} RtQueryReqReply_t;
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>req</code></dt>
<dd><p>An <code>RtReq_t</code> structure specifying the storage pool whose real-time parameters are to be obtained. You must also set the <code>rq_flags</code> field of this structure to <code>RT_GET</code>. For details, see <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/RtReq_t">RtReq_t Structure</a></span>.</p></dd>
<dt><code>reply</code></dt>
<dd><p>An <code>RtQueryReply_t</code> structure. On output, this structure contains the results of the request. For details, see <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/RtQueryReply_t">RtQueryReply_t Structure</a></span>.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>RtQueryReqReply_t</code> union is used as a parameter to the <code><a href="reference.html#//apple_ref/c/func/F_GETRTIO">F_GETRTIO</a></code> request.</p>
<a name="//apple_ref/c/tdef/RtQueryReply_t" title="RtQueryReply_t Structure"></a><a name="//apple_ref/doc/c_ref/RtQueryReply_t" title="RtQueryReply_t Structure"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCDAGAB" title="RtQueryReply_t Structure"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_31"></a><h3 class="tight">RtQueryReply_t Structure</h3>
<p class="spaceabove">Structure used to receive the results of requesting the real-time parameters for a storage pool.</p>
<p class="spaceabove"><pre>
typedef struct _rtqueryreply {
uint32_t rrq_sgid;
uint32_t rrq_state;
#define RT_STATE_NONREALTIME 0x01
#define RT_STATE_REALTIME 0x02
#define RT_STATE_REQUEST 0x04
#define RT_STATE_TIMEOUT 0x10
int32_t rrq_limit;
int32_t rrq_cur;
int32_t rrq_nrtio_hint;
uint32_t rrq_nrtio_clients;
} RtQueryReply_t;
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>rrq_sgid</code></dt>
<dd><p>Storage pool ordinal.</p></dd>
<dt><code>rrq_state</code></dt>
<dd><p>Flags indicating the storage pool’s state with respect to real-time I/O. For details, see <code><!--a  -->Real-Time I/O Status Flags<!--/a--></code>.</p></dd>
<dt><code>rrq_limit</code></dt>
<dd><p>Configured real-time I/O limit in I/O operations per second.</p></dd>
<dt><code>rrq_cur</code></dt>
<dd><p>Current amount of real-time I/O committed to file system clients in I/O operations per second.</p></dd>
<dt><code>rrq_nrtio_hint</code></dt>
<dd><p>Amount of non-real-time I/O in operations per second a file system client is most likely to obtain when requesting a non-real-time I/O token.</p></dd>
<dt><code>rrq_nrtio_hint</code></dt>
<dd><p>Number of file system clients with outstanding non-real-time I/O tokens.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>RtQueryReply_t</code> structure is used to receive the results of requesting the real-time I/O parameters for a storage pool. This structure is a member of the <code>RtQueryReqReply_t</code> union <code><a href="reference.html#//apple_ref/c/tdef/RtQueryReqReply_t">RtQueryReqReply_t Union</a></code> that is passed as a parameter to the <code><a href="reference.html#//apple_ref/c/func/F_GETRTIO">F_GETRTIO</a></code> request.</p>
<a name="//apple_ref/c/tdef/RtReqReply_t" title="RtReqReply_t Union"></a><a name="//apple_ref/doc/c_ref/RtReqReply_t" title="RtReqReply_t Union"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCEBFGI" title="RtReqReply_t Union"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_32"></a><h3 class="tight">RtReqReply_t Union</h3>
<p class="spaceabove">Union used to request real-time I/O on a storage pool or file descriptor.</p>
<p class="spaceabove"><pre>
typedef union rtreqrep {
RtReq_t req;
RtReply_t reply;
} RtReqReply_t;
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>req</code></dt>
<dd><p>An <code>RtReq_t</code> structure describing how real-time I/O is to be set. For details, see <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/RtReq_t">RtReq_t Structure</a></span>.</p></dd>
<dt><code>reply</code></dt>
<dd><p>An <code>RtReply_t</code> structure. On output, this structure contains the results of the request. For details, see <span class="content_text"><a href="reference.html#//apple_ref/c/tdef/RtReply_t">RtReply_t Structure</a></span>.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>RtReqReply_t</code> union is used as a parameter to the <code><a href="reference.html#//apple_ref/c/func/F_SETRTIO">F_SETRTIO</a></code> request.</p>
<a name="//apple_ref/c/tdef/RtReq_t" title="RtReq_t Structure"></a><a name="//apple_ref/doc/c_ref/RtReq_t" title="RtReq_t Structure"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCCJEJI" title="RtReq_t Structure"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_33"></a><h3 class="tight">RtReq_t Structure</h3>
<p class="spaceabove">Structure used to request real-time I/O on a storage pool or file descriptor.</p>
<p class="spaceabove"><pre>
typedef struct _rtreq {
union {
   uint32_t ru_rtios;
   uint32_t ru_rtmb;
} rq_un;
#define rq_rtios rq_un.ru_rtios
#define rq_rtmb rq_un.ru_rtmb
uint32_t rq_flags;
#define RT_IO 0x01
#define RT_MB 0x02
#define RT_CLEAR 0x04
#define RT_SET 0x08
#define RT_MUST 0x10
#define RT_SEQ 0x20
#define RT_GET 0x40
#define RT_NOGATE 0x80
#define RT_NOLOAD 0x100
#define RT_ABSOLUTE 0x200
uint32_t rq_sgid;
uint32_t rq_pad;
} RtReq_t;
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>rq_rtios</code></dt>
<dd><p>Requested real-time I/O operations per sec. Valid only if <code>RT_IO</code> is set in the <code>rq_flags</code> field of this structure. If <code>RT_IO</code> is set, <code>RT_MB</code> cannot be set in the <code>rq_flags</code> field.</p></dd>
<dt><code>rq_rtmb</code></dt>
<dd><p>Requested megabytes per sec. Valid only if <code>RT_MB</code> is set in the <code>rq_flags</code> field of this structure; If <code>RT_MB</code> is set, <code>RT_IO</code> cannot be set in the <code>rq_flags</code> field.</p></dd>
<dt><code>rq_flags</code></dt>
<dd><p>Control flags. For details, see <span class="content_text"><!--a  -->Real-Time I/O Control Flags<!--/a--></span>.</p></dd>
<dt><code>rq_sgid</code></dt>
<dd><p>Storage pool ordinal that identifies this storage pool.</p></dd>
<dt><code>rq_pad</code></dt>
<dd><p>Pad.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>RtReq_t</code> structure is used to request the real-time I/O parameters. This structure is a member of the <code>RtReqReply_t</code> union <code><a href="reference.html#//apple_ref/c/tdef/RtReqReply_t">RtReqReply_t Union</a></code> that is passed as a parameter to the <code><a href="reference.html#//apple_ref/c/func/F_SETRTIO">F_SETRTIO</a></code> request.</p>
<a name="//apple_ref/c/tdef/RtReply_t" title="RtReply_t Structure"></a><a name="//apple_ref/doc/c_ref/RtReply_t" title="RtReply_t Structure"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCFDFJI" title="RtReply_t Structure"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_34"></a><h3 class="tight">RtReply_t Structure</h3>
<p class="spaceabove">Structure used to receive replies from requests for real-time I/O.</p>
<p class="spaceabove"><pre>
typedef struct _rtreply {
union {
   int32_t ru_rtios;
   int32_t ru_rtmb;
} rr_un;
#define rr_rtio rr_un.ru_rtois
#define rr_rtmb rr_un.ru_rtmb
uint32_t rr_flags;
#define RT_IO 0x01
#define RT_MB 0x02
} RtReply_t;
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>rr_rtio</code></dt>
<dd><p>Allowed real-time I/O operations per second. This field is valid only if the <code>RT_IO</code> flag is set in the <code>rr_flags</code> field. This value may be less than or greater than the amount requested if the <code>RT_MUST</code> flag was not set in the <code>rq_flags</code> field when the request for real-time I/O was made. For information on these flags, see <span class="content_text"><!--a  -->Real-Time I/O Control Flags<!--/a--></span>.</p></dd>
<dt><code>rr_rtmb</code></dt>
<dd><p>Allowed real-time megabytes per second. Valid only if <code>RT_MB</code> is set in the <code>rr_flags</code> field. This value may be less than or greater than the amount requested if the <code>RT_MUST</code> flag was not set in the <code>rq_flags</code> field when the request for real-time I/O was made. For information on these flags, see <span class="content_text"><!--a  -->Real-Time I/O Control Flags<!--/a--></span>.</p></dd>
<dt><code>rr_flags</code></dt>
<dd><p>Flag indicating that the request for real-time I/O was granted in real-time operations per second (<code>RT_IO</code>) or in real-time megabytes per second (<code>RT_MB</code>).</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>RtReply_t</code> structure is used to receive the results of requesting real-time I/O for a storage group or a file. This structure is a member of the <code>RtReqReply_t</code> union <code><a href="reference.html#//apple_ref/c/tdef/RtReqReply_t">RtReqReply_t Union</a></code> that is passed as a parameter to the <code><a href="reference.html#//apple_ref/c/func/F_SETRTIO">F_SETRTIO</a></code> request.</p>
<a name="//apple_ref/c/tdef/SetAffinityReq_t" title="SetAffinityReq_t Structure"></a><a name="//apple_ref/doc/c_ref/SetAffinityReq_t" title="SetAffinityReq_t Structure"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCHCFFH" title="SetAffinityReq_t Structure"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_35"></a><h3 class="tight">SetAffinityReq_t Structure</h3>
<p class="spaceabove">Structure used to set the affinity for a file.</p>
<p class="spaceabove"><pre>
typedef struct setaffinityreq {
uint64_t sq_affinity;
} SetAffinityReq_t;
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>sq_affinity</code></dt>
<dd><p>The affinity that is to be set.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>SetAffinityReq_t</code> structure is used to set the affinity for a file and is passed as a parameter to the <code><a href="reference.html#//apple_ref/c/func/F_SETAFFINITY">F_SETAFFINITY</a></code> request.</p>
<a name="//apple_ref/c/tdef/SetQuotaReq_t" title="SetQuotaReq_t Structure"></a><a name="//apple_ref/doc/c_ref/SetQuotaReq_t" title="SetQuotaReq_t Structure"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCHHJDH" title="SetQuotaReq_t Structure"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_36"></a><h3 class="tight">SetQuotaReq_t Structure</h3>
<p class="spaceabove">Structure used to set quota limitations for a user or a group.</p>
<p class="spaceabove"><pre>
#define MAX_QUOTA_NAME_LENGTH 256
typedef struct setquotareq {
uint32_t sq_quotaname[MAX_QUOTA_NAME_LENGTH];
uint32_t sq_type;
#define <!--a-->QUOTA_TYPE_USER<!--/a-->(uint32_t)’U’
#define <!--a-->QUOTA_TYPE_GROUP<!--/a-->(uint32_t)’G’
uint32_t sq_timelimit;
uint64_t sq_hardlimit;
uint64_t sq_softlimit;
} SetQuotaReq_t;
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>sq_quotaname</code></dt>
<dd><p>Name of the user or group whose quota limits are being set.</p></dd>
<dt><code>sq_type</code></dt>
<dd><p>Type of name specified by <code>sq_quotaname</code>; must be <code>QUOTA_TYPE_USER</code> or <code>QUOTA_TYPE_GROUP</code>.</p></dd>
<dt><code>sq_timelimit</code></dt>
<dd><p>Soft quota grace period, in minutes.</p></dd>
<dt><code>sq_hardlimit</code></dt>
<dd><p>Hard limit in bytes.</p></dd>
<dt><code>sq_softlimit</code></dt>
<dd><p>Soft limit in bytes.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>SetQuotaReq_t</code> structure is used to set quota limitations for a user or a group. It is a passed as a parameter to the <code><a href="reference.html#//apple_ref/c/func/F_SETQUOTA">F_SETQUOTA</a></code> request.</p>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCHIFFH" title="Real-Time I/O Status Flags"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_37"></a><h3 class="tight">Real-Time I/O Status Flags</h3>
<p class="spaceabove">The real-time I/O status flags indicate the state of real-time I/O with respect to a storage pool.</p>
<p class="spaceabove"><pre>
   
</pre></p>
<h5 class="tight">Discussion</h5>
<p>The real-time I/O status flags are returned in the <code>rrq_state</code> field of the <code>RtQueryReply_t</code> structure <code><a href="reference.html#//apple_ref/c/tdef/RtQueryReply_t">RtQueryReply_t Structure</a></code> that is returned b <code><a href="reference.html#//apple_ref/c/func/F_GETRTIO">F_GETRTIO</a></code>. The following values are possible:</p><a name="//apple_ref/doc/uid/TP40004357-CH1g-385818" title="Table 2Real-time I/O status flags"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">
<caption class="tablecaption"><strong>Table 2&nbsp;&nbsp;</strong>Real-time I/O status flags</caption>

<tr>
<td  scope="row"><p><code>RT_STATE_NONREALTIME</code></p></td>
<td ><p>Indicates that the storage pool is not in real-time I/O mode.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>RT_STATE_REALTIME</code></p></td>
<td ><p>Indicates that the storage pool is in real-time I/O mode.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>RT_STATE_REQUEST</code></p></td>
<td ><p>Indicates that real-time I/O mode for the storage pool has been requested but the storage pool is not yet in real-time I/O mode.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>RT_STATE_TIMEOUT</code></p></td>
<td ><p>Indicates that real-time I/O mode for the storage pool has been requested but that the request has timed out.</p></td>
</tr>

</table></div>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCIGIGE" title="Space Allocation Control Flags"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_38"></a><h3 class="tight">Space Allocation Control Flags</h3>
<p class="spaceabove">The space allocation control flags are used when allocating extent space in a file.</p>
<p class="spaceabove"><pre>
   
</pre></p>
<h5 class="tight">Discussion</h5>
<p>The space allocation control flags are set in the <code>aq_flags</code> field of the <code>AllocSpaceReq_t</code> structure <code><a href="reference.html#//apple_ref/c/tdef/AllocSpaceReq_t">AllocSpaceReq_t Structure</a></code> that is passed to <code><a href="reference.html#//apple_ref/c/func/F_ALLOCEXTSPACE">F_ALLOCEXTSPACE</a></code>. The following space allocation control flags are available:</p><a name="//apple_ref/doc/uid/TP40004357-CH1g-385813" title="Table 3"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">
<caption class="tablecaption"><strong>Table 3&nbsp;&nbsp;</strong></caption>

<tr>
<td  scope="row"><p><code>ALLOC_OFFSET</code></p></td>
<td ><p>Indicates that the <code>aq_offset</code> field of the <code>AllocSpaceReq_t</code><code></code> structure is valid.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>ALLOC_LOAD_EXT</code></p></td>
<td ><p>Causes extent structure mapping to be loaded on the file system client and added to the client file system.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>ALLOC_STRIPE_ALIGN</code></p></td>
<td ><p>Causes space to be allocated starting at a storage pool boundary.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>ALLOC_AFFINITY</code></p></td>
<td ><p>Indicates that the <code>aq_affinitykey</code> field of the <code>AllocSpaceReq_t</code> structure is valid.</p></td>
</tr>

</table></div>
<a name="//apple_ref/c/tdef/VerInfoReply_t" title="VerInfoReply_t Structure"></a><a name="//apple_ref/doc/c_ref/VerInfoReply_t" title="VerInfoReply_t Structure"></a><a name="//apple_ref/doc/uid/TP40004357-CH1g-BBCEBEEG" title="VerInfoReply_t Structure"></a>
<a name="//apple_ref/doc/uid/TP40004357-CH1g-DontLinkElementID_39"></a><h3 class="tight">VerInfoReply_t Structure</h3>
<p class="spaceabove">Structure used to receive Xsan version information.</p>
<p class="spaceabove"><pre>
#define CVVERINFO_MAX 64
typedef struct _verinfo_reply {
char vr_version[CVVERINFO_MAX];
char vr_build[CVVERINFO_MAX];
char vr_creationdate[CVVERINFO_MAX];
uint32_t vr_apiversion;
uint32_t vr_pad1;
} VerInfoReply_t;
</pre></p>
<h5 class="tight">Fields</h5><dl class="termdef">
<dt><code>vr_version</code></dt>
<dd><p>String containing the release and build number, such as <code>#!@$ Xsan Client Revision 2.5.0 Build
26</code>.</p></dd>
<dt><code>vr_build</code></dt>
<dd><p>String containing platform information, such as <code>#!@$
Built for Darwin 7.3.0</code>.</p></dd>
<dt><code>vr_creationdate</code></dt>
<dd><p>String containing the creation date, such as <code>#!@$
Created on Tues Apr 6 14:15:53 PST 2004</code>.</p></dd>
<dt><code>vr_apiversion</code></dt>
<dd><p>Version of this API.</p></dd>
<dt><code>vr_pad1</code></dt>
<dd><p>Pad.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>VerInfoReply_t</code> structure is provided as a parameter to the <code><a href="reference.html#//apple_ref/c/func/F_GETVERINFO">F_GETVERINFO</a></code> request in order to receive the results of that request.</p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <!-- Previous button --><span style="margin-left: 8px"><a href="../RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-05-23<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Storage/Reference/Xsan_Reference/Reference/reference.html%3Fid%3DTP40004357-2.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Storage/Reference/Xsan_Reference/Reference/reference.html%3Fid%3DTP40004357-2.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Storage/Reference/Xsan_Reference/Reference/reference.html%3Fid%3DTP40004357-2.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>