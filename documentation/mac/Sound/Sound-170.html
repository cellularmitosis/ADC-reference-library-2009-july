<!-- legacy work start -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<!-- legacy work end -->


<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)

LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>SetupSndHeader (IM: S)  (deprecated)</Title>

<!-- legacy work start -->
        <META NAME="Generator" CONTENT="manual">
        <META http-equiv="content-type" CONTENT="text/html;charset=utf-8">
        <META NAME = "Copyright" CONTENT="Copyright 2007 Apple Inc. All Rights Reserved.">
        <META NAME="IndexTitle" CONTENT="Inside Macintosh: Sound (Not Recommended)">
        <meta name="xcode-display" content="render">

        <LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css"> <!-- before submitting, globally replace ".." with "developer.apple.com" -->
        <script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
<!-- legacy work end -->

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<A NAME=HEADING170></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Sound-169.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Sound-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Sound-336.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Sound-171.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Sound-2.html"><B>Sound</B></A> / <BR><DD><A HREF="Sound-137.html"><B>Chapter 3 - Sound Input Manager</B></A> / <A HREF="Sound-146.html"><B>Sound Input Manager Reference</B></A><BR><DL><DD><A HREF="Sound-152.html"><B>Sound Input Manager Routines</B></A> / <A HREF="Sound-169.html"><B>Constructing Sound Resource and File Headers</B></A></DL></DL></FONT><P>
<HR>

<!-- legacy work start -->
<script type="text/javascript"> placeWatermark()</script>
<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
<i>Inside Macintosh: Sound</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="http://developer.apple.com/referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div>
<!-- legacy work end -->


<BLOCKQUOTE>
<A NAME=HEADING170-0></A>
<H3><A NAME=MARKER-11-305></A>SetupSndHeader<A NAME=MARKER-2-274></A><A NAME=MARKER-2-307></A></H3>
 <A NAME=MARKER-2-259></A>You can use the <CODE>SetupSndHeader</CODE> function to construct a sound resource containing sampled sound that can be passed to the <CODE>SndPlay</CODE> function.<P>
<PRE>
FUNCTION SetupSndHeader (sndHandle: Handle;
                           numChannels: Integer;
                           sampleRate: Fixed;
                           sampleSize: Integer; 
                           compressionType: OSType; 
                           baseFrequency: Integer; 
                           numBytes: LongInt; 
                           VAR headerLen: Integer): OSErr;
</PRE>
<DL>
<DT><CODE>sndHandle</CODE>
<DD> A handle to a block of memory that is at least large enough to store the sound resource header information. The handle is not resized in any way upon successful completion of <CODE>SetupSndHeader</CODE>. The <CODE>SetupSndHeader</CODE> function simply fills the relocatable block specified by this parameter with the header information needed for a format 1 <CODE>'snd '</CODE> resource, including the sound resource header, the list of sound commands, and a sampled sound header. It is your application's responsibility to append the desired sampled-sound data.
<DT><CODE>numChannels</CODE>
<DD> The number of channels for the sound; one channel is equivalent to monaural sound and two channels are equivalent to stereo sound.
<DT><CODE>sampleRate</CODE>
<DD> The rate at which the sound was recorded. The sample rate is declared as a <CODE>Fixed</CODE> data type. In order to accommodate sample rates greater than 32 kHz, the most significant bit is not treated as a sign bit; instead, that bit is interpreted as having the value 32,768.
<DT><CODE>sampleSize</CODE>
<DD> The sample size for the original sound (that is, bits per sample).
<DT><CODE>compressionType</CODE>
<DD> The compression type for the sound (<CODE>'NONE'</CODE>, <CODE>'MAC3'</CODE>, <CODE>'MAC6'</CODE>, or other third-party types).
<DT><CODE>baseFrequency</CODE>
<DD> The base frequency for the sound, expressed as a MIDI note value.
<DT><CODE>numBytes</CODE>
<DD> The number of bytes of audio data that are to be stored in the handle. (This value is not necessarily the same as the number of samples in the sound.)
<DT><CODE>headerLen</CODE>
<DD> On exit, the size (in bytes) of the <CODE>'snd '</CODE> resource header that is created. In no case will this length exceed 100 bytes. This field allows you to put the audio data right after the header in the relocatable block specified by the <CODE>sndHandle</CODE> parameter. The value returned depends on the type of sound header created.
</DL>
<A NAME=HEADING170-11></A>
<H5>DESCRIPTION</H5>
 The <CODE>SetupSndHeader</CODE> function creates a format 1 <CODE>'snd '</CODE> resource for a sampled sound. The resource contains a sound resource header that links the sound to the sampled synthesizer, a single sound command (a <CODE>bufferCmd</CODE> command to play the accompanying data), and a sampled sound header. You can use <CODE>SetupSndHeader</CODE> to construct a sampled sound header that can be passed to the Sound Manager's <CODE>SndPlay</CODE> function or stored as an <CODE>'snd '</CODE> resource. After calling the <CODE>SetupSndHeader</CODE> function, your application should place the sampled-sound data directly after the sampled sound header so that, in essence, the sampled sound header's final field contains the sound data.<A NAME=MARKER-2-6></A><P>
 The sampled sound is in one of three formats depending on several of the parameters passed. <A HREF=#MARKER-9-1>Table 3-1</A> shows how <CODE>SetupSndHeader</CODE> determines what kind of sound header to create. 
<TABLE BORDER="0" CELLPADDING=3>
<CAPTION><A NAME=MARKER-9-1></A>The sampled sound header format used by <CODE>SetupSndHeader</CODE></CAPTION>
<TH>compressionType<TH>numChannels<TH>sampleSize<TH>Sampled sound header format<TR>
<TD>'NONE'<TD>1<TD>8<TD>SoundHeader<TR>
<TD>'NONE'<TD>1<TD>16<TD>ExtSoundHeader<TR>
<TD>'NONE'<TD>2<TD>any<TD>ExtSoundHeader<TR>
<TD> not <CODE>'NONE'</CODE><TD>any<TD>any<TD>CmpSoundHeader<A NAME=MARKER-2-40></A></TABLE>
<P>
 A good way to use this function is to create a handle in which you want to store a sampled sound, then call <CODE>SetupSndHeader</CODE> with the <CODE>numBytes</CODE> parameter set to <CODE>0</CODE> to see how much room the header for that sound will occupy and hence where to append the audio data. Then record the data into the handle and call <CODE>SetupSndHeader</CODE> again with <CODE>numBytes</CODE> set to the correct amount of sound data recorded. The handle filled out in this way can be passed to <CODE>SndPlay</CODE> to play the sound.<P>
<A NAME=HEADING170-15></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 You cannot call the <CODE>SetupSndHeader</CODE> function at interrupt time.<P>
<A NAME=HEADING170-17></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The trap macro and routine selector for the <CODE>SetupSndHeader</CODE> function are
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Trap macro<TH>Selector<TR>
<TD>_SoundDispatch<TD>$0D480014</TABLE>
<P>
<A NAME=HEADING170-19></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>noErr<TH>0<TH>No error<TR>
<TD>siInvalidCompression<TD>-223<TD>Invalid compression type</TABLE>
</H5>
<A NAME=HEADING170-20></A>
<H5>SEE ALSO</H5>
 For an example that uses the <CODE>SetupSndHeader</CODE> function to set up a sound header before recording, see <A HREF=Sound-143.html#MARKER-9-75>Listing 3-1 on page 3-7</A>.<A NAME=MARKER-2-9></A><A NAME=MARKER-2-129></A><A NAME=MARKER-2-283></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Sound-169.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Sound-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Sound-336.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Sound-171.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Sound-3.html">&copy; Apple Computer, Inc.</A><br>2 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
