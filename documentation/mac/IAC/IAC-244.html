<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Writing Object Accessor Functions That Find Properties(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING244></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-243.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-245.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-231.html"><B>Chapter 6 - Resolving and Creating Object Specifier Records</B></A> / <A HREF="IAC-242.html"><B>Writing Object Accessor Functions</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING244-0></A>
<H2>Writing Object Accessor Functions That Find Properties</H2>
 <A NAME=MARKER-2-174></A>The Apple event object to which a property belongs is that property's container. Your application should provide an object accessor function for finding properties in containers identified by tokens of various descriptor types. Your application does not need to be given a property's specific object class in order to find that property; instead, you can specify the object class ID for any property with the constant <CODE>cProperty</CODE>. Thus, you can write a single object accessor function that can find any property of an object identified by a token of a given descriptor type. <A NAME=MARKER-2-175></A><P>
 To install such an object accessor function, you can add a single entry to the object accessor dispatch table that specifies the desired object class as <CODE>cProperty</CODE> for a given token descriptor type. For example, <A HREF=#MARKER-9-176>Listing 6-9</A> shows an object accessor function that identifies any property of a window.<P>
<B>Listing 6-9  <A NAME=MARKER-9-176></A>An object accessor function that identifies any property of a window<A NAME=MARKER-2-304></A></B><P>
<PRE>
FUNCTION MyFindPropertyOfWindowObjectAccessor 
                              (desiredClass: DescType; 
                              containerToken: AEDesc; 
                              containerClass: DescType;
                              keyForm: DescType; keyData: AEDesc;
                              VAR token: AEDesc; 
                              theRefCon: LongInt): OSErr;
VAR
   theProperty: DescType;
BEGIN
   MyFindPropertyOfWindowObjectAccessor := noErr;
   MyGetPropFromKeyData(keyData, theProperty);
   IF keyForm = formPropertyID THEN
   BEGIN
      IF theProperty = pName THEN
         {create token that identifies name property of the }
         { window}
         MyCreateToken(typeMyWindowProp, containerToken, pName, 
                        token)
      ELSE
      IF theProperty = pBounds THEN
         {create token that identifies bounds property of the }
         { window}
         MyCreateToken(typeMyWindowProp, containerToken, pBounds, 
                        token)

      {create tokens for other properties as appropriate}

      ELSE
         MyFindPropertyOfWindowObjectAccessor := 
                                          kErrorPropNotFound;
   END
   ELSE
      MyFindPropertyOfWindowObjectAccessor := 
                                          kKeyFormNotSupported;
END; 
</PRE>
 The <CODE>MyFindPropertyOfWindowObjectAccessor</CODE> function takes a token that identifies a window and creates a token that identifies the requested property of that window. See <A HREF=IAC-245.html#MARKER-9-181>Figure 6-6 on page 6-46</A> for an illustration of the logical organization of a token of descriptor type <CODE>typeMyWindowProp</CODE>.<P>
 This simplified example merely translates information about the requested property and the window to which it belongs into the form of a token of type <CODE>typeMyWindowProp</CODE>. This token can then be used by Apple event handlers to identify the corresponding window and its property, so that a handler can either retrieve the value of the property (for example, a Get Data handler) or change the value of the property (for example, a Set Data handler). Like other tokens, a token that identifies a property should always contain a reference to the corresponding property and the object to which it belongs--not a copy of the data for that object's property. <P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-243.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-245.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
