<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Text Attributes: Accessing Attributes</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Accessing Attributes"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="toc.html"/>
	<meta id="RESOURCES" content="../../../Resources" />
	<meta name="ROBOTS" content="NOINDEX"/>
	<link rel="stylesheet" type="text/css" href="../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20000161" title="Accessing Attributes"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../index.html#//apple_ref/doc/uid/TP30000440-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../TextFonts-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000461" target="_top">Text &amp; Fonts</a> &gt; <a href="index.html" target="_top">Text Attributes</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="SetTextAttributes.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="ChangingAttrStrings.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/20000161-BAJBBCBI" title="Accessing Attributes"></a><hr /><H1>Accessing Attributes</H1><p><a name="//apple_ref/doc/uid/20000161-DontLinkElementID_10"></a><a name="//apple_ref/doc/uid/20000161-DontLinkElementID_11"></a>An attributed<a name="//apple_ref/doc/uid/20000161-DontLinkElementID_12"></a> string identifies attributes by name, storing a value under the attribute name in an <code>NSDictionary</code> object, which is in turn associated with an <code>NSRange</code> that indicates the characters to which the dictionary’s attributes apply. You can assign any attribute name-value pair you wish to a range of characters, in addition to the standard attributes.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="AccessingAttrs.html#//apple_ref/doc/uid/20000161-DontLinkElementID_1">Retrieving Attribute Values</a>
				
			<br/>
			
        
			
			
				<a href="AccessingAttrs.html#//apple_ref/doc/uid/20000161-DontLinkElementID_2">Effective and Maximal Ranges</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/20000161-DontLinkElementID_1" title="Retrieving Attribute Values"></a><h2>Retrieving Attribute Values</h2><p>With an immutable attributed string, you assign all attributes when you create the string. In Java, you use the constructors. In Objective-C, you use methods such as <code>initWithString:attributes:<a name="//apple_ref/doc/uid/20000161-DontLinkElementID_13"></a></code>, which explicitly take an <code>NSDictionary</code> object of name-value pairs, or <code>initWithString:<a name="//apple_ref/doc/uid/20000161-DontLinkElementID_14"></a></code>, which assigns no attributes. And the Application Kit’s extensions to <code>NSAttributedString</code> adds methods that take an RTF file or an HTML file. See <span class="content_text"><a href="ChangingAttrStrings.html#//apple_ref/doc/uid/20000162-BBCBGCDG">“Changing an Attributed String”</a></span> for information on assigning attributes with a mutable attributed string.</p><p>To retrieve attribute values from either type of attributed string, use any of these methods:</p><ul class="simple"><li><p><code>attributesAtIndex:effectiveRange:<a name="//apple_ref/doc/uid/20000161-DontLinkElementID_15"></a></code></p></li><li><p><code>attributesAtIndex:longestEffectiveRange:inRange:<a name="//apple_ref/doc/uid/20000161-DontLinkElementID_16"></a></code></p></li><li><p><code>attribute:atIndex:effectiveRange:<a name="//apple_ref/doc/uid/20000161-DontLinkElementID_17"></a></code></p></li><li><p><code>attribute:atIndex:longestEffectiveRange:inRange:<a name="//apple_ref/doc/uid/20000161-DontLinkElementID_18"></a></code></p></li><li><p><code>fontAttributesInRange:<a name="//apple_ref/doc/uid/20000161-DontLinkElementID_19"></a></code></p></li><li><p><code>rulerAttributesInRange:<a name="//apple_ref/doc/uid/20000161-DontLinkElementID_20"></a></code></p></li></ul><p>The first two methods return all attributes at a given index, the <code>attribute:...</code> methods return the value of a single named attribute. The Application Kit’s extensions to <code>NSAttributedString</code> add <code>fontAttributesInRange:</code> and <code>rulerAttributesInRange:</code>, which return attributes defined to apply only to characters or to whole paragraphs, respectively.</p><p>The first four methods also return by reference the effective range and the longest effective range of the attributes<a name="//apple_ref/doc/uid/20000161-DontLinkElementID_21"></a><a name="//apple_ref/doc/uid/20000161-DontLinkElementID_22"></a>. These ranges allow you to determine the extent of attributes. Conceptually, each character in an attributed string has its own collection of attributes; however, it’s often useful to know when the attributes and values are the same over a series of characters. This allows a routine to progress through an attributed string in chunks larger than a single character. In retrieving the effective range, an attributed string simply looks up information in its attribute mapping, essentially the dictionary of attributes that apply at the index requested. In retrieving the longest effective range, the attributed string continues checking characters past this basic range as long as the attribute values are the same. This extra comparison increases the execution time for these methods but guarantees a precise maximal range for the attributes requested.</p><a name="//apple_ref/doc/uid/20000161-DontLinkElementID_2" title="Effective and Maximal Ranges"></a><h2>Effective and Maximal Ranges</h2><p>Methods that return an effective range by reference are not guaranteed to return the maximal range to which the attribute(s) apply; they are merely guaranteed to return some range over which they apply. In practice they will return whatever range is readily available from the attributed string's internal storage mechanisms, which may depend on the implementation and on the precise history of modifications to the attributed string.</p><p>Methods that return a longest effective range by reference, on the other hand, are guaranteed to return the longest range containing the specified index to which the attribute(s) in question apply (constrained by the value of the argument passed in for <code>inRange:</code>). For efficiency, it is important that the <code>inRange:</code> argument should be as small as appropriate for the range of interest to the client.</p><p>When you iterate over an attributed string by attribute ranges, either sort of method may be appropriate depending on the situation. If there is some processing to be done for each range, and you know that the full range for a given attribute is going to have to be handled eventually, it may be more efficient to use the longest-effective-range variant, so as not to have to handle the range in pieces. However, you should use the longest-effective-range methods with caution, because the longest effective range could be quite long—potentially the entire length of the document, if the <code>inRange:</code> argument is not constrained. </p><p>The Objective-C code fragment below progresses through an attributed string in chunks based on the effective range. The fictitious analyzer object here counts the number of characters in each font. The while loop progresses as long as the effective range retrieved does not include the end of the attributed string, retrieving the font in effect just past the latest retrieved range. For each font attribute retrieved, the analyzer tallies the number of characters in the effective range. In this example, it is possible that consecutive invocations of <code>attribute:atIndex:effectiveRange:<a name="//apple_ref/doc/uid/20000161-DontLinkElementID_23"></a></code> will return the same value.</p><div class="codesample"><table><tr><td scope="row"><pre>NSAttributedString *attrStr;<span></span></pre></td></tr><tr><td scope="row"><pre>unsigned int length;<span></span></pre></td></tr><tr><td scope="row"><pre>NSRange effectiveRange;<span></span></pre></td></tr><tr><td scope="row"><pre>id attributeValue;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>length = [attrStr length];<span></span></pre></td></tr><tr><td scope="row"><pre>effectiveRange = NSMakeRange(0, 0);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>while (NSMaxRange(effectiveRange) &lt; length) {<span></span></pre></td></tr><tr><td scope="row"><pre>    attributeValue = [attrStr attribute:NSFontAttributeName<span></span></pre></td></tr><tr><td scope="row"><pre>        atIndex:NSMaxRange(effectiveRange) effectiveRange:&amp;effectiveRange];<span></span></pre></td></tr><tr><td scope="row"><pre>    [analyzer tallyCharacterRange:effectiveRange font:attributeValue];<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>In contrast, the next Objective-C code fragment progresses through the attributed string according to the maximum effective range for each font. In this case, the analyzer counts font changes, which may not be represented by merely retrieving effective ranges. In this case the while loop is predicated on the length of the limiting range, which begins as the entire length of the attributed string and is whittled down as the loop progresses. After the analyzer records the font change, the limit range is adjusted to account for the longest effective range retrieved.</p><div class="codesample"><table><tr><td scope="row"><pre>NSAttributedString *attrStr;<span></span></pre></td></tr><tr><td scope="row"><pre>NSRange limitRange;<span></span></pre></td></tr><tr><td scope="row"><pre>NSRange effectiveRange;<span></span></pre></td></tr><tr><td scope="row"><pre>id attributeValue;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>limitRange = NSMakeRange(0, [attrStr length]);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>while (limitRange.length > 0) {<span></span></pre></td></tr><tr><td scope="row"><pre>    attributeValue = [attrStr attribute:NSFontAttributeName<span></span></pre></td></tr><tr><td scope="row"><pre>        atIndex:limitRange.location longestEffectiveRange:&amp;effectiveRange<span></span></pre></td></tr><tr><td scope="row"><pre>        inRange:limitRange];<span></span></pre></td></tr><tr><td scope="row"><pre>    [analyzer recordFontChange:attributeValue];<span></span></pre></td></tr><tr><td scope="row"><pre>    limitRange = NSMakeRange(NSMaxRange(effectiveRange),<span></span></pre></td></tr><tr><td scope="row"><pre>        NSMaxRange(limitRange) - NSMaxRange(effectiveRange));<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Note that the second code fragment is more complex. Because of this, and because <code>attribute:atIndex:longestEffectiveRange:inRange:</code> is somewhat slower than <code>attribute:atIndex:effectiveRange:</code>, you should typically use it only when absolutely necessary for the work you’re performing. In most cases working by effective range is enough.</p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="SetTextAttributes.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="ChangingAttrStrings.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 1997, 2004 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2004-02-16<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Conceptual/TextAttributes/AccessingAttrs.html%3Fid%3D10000088i-2.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Conceptual/TextAttributes/AccessingAttrs.html%3Fid%3D10000088i-2.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Conceptual/TextAttributes/AccessingAttrs.html%3Fid%3D10000088i-2.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
