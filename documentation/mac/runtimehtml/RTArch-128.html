<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>The Far Model Segment Header Structure</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING128></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="RTArch-127.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="RTArch-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="RTArch-147.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="RTArch-129.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="RTArch-2.html"><B>Mac OS Runtime Architectures</B></A> / <BR><DD><A HREF="RTArch-115.html"><B>Chapter 10 - Classic 68K Runtime Architecture</B></A> / <A HREF="RTArch-124.html"><B>How 32-Bit Everything Is Implemented</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING128-0></A>
<H2><A NAME=MARKER-9-71></A><A NAME=MARKER-21-72></A>The Far Model Segment Header Structure</H2>
 <A NAME=MARKER-2-73></A>Near model segments have a 4-byte header that provides the information required by the Segment Manager to transform jump table entries from their unloaded state to their loaded state. Segments linked with the <CODE>-model far</CODE> option have a larger header and contain relocation information. The format of the far model segment header is shown in <A HREF=#MARKER-9-75>Figure 10-11</A>. Following the header are the code, the A5 relocation information, and the segment relocation information.<P>
<B>Figure 10-11  <A NAME=MARKER-9-75></A>The far model segment header</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/RUN-29.jpg"> <P>
 The meaning of each field in <A HREF=#MARKER-9-75>Figure 10-11</A> is as follows.<A NAME=MARKER-2-76></A>
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Address<TH>Entry<TR>
<TD>$0<TD>This field determines whether the segment has been built according to the far model option. Namely, the first word of the segment header must match the version field in the jump-table flag entry, $FFFF.<TR>
<TD>$2<TD>Reserved.<TR>
<TD>$4<TD>The byte offset from A5 of the first near model jump table entry.<TR>
<TD>$8<TD>The number of near entries. <TR>
<TD>$C<TD>The byte offset from A5 of the first far model jump table entry.<TR>
<TD>$10<TD>The number of far model entries.<TR>
<TD>$14<TD>The offset (from the beginning of the segment) of the relocation information for A5-relative references. A5-relocation information contains the addresses of all instructions in a segment that references far model global data or far model jump table entries.<TR>
<TD>$18<TD>The current A5 value, which is added to the offset specified in the A5-relative address field of the instruction to calculate the actual address.<TR>
<TD>$1C<TD>The offset, from the beginning of the segment, of the relocation information for PC-relative references.<TR>
<TD>$20<TD>The segment load address, which is added to the offset specified in the A5-relative address field of the instruction to calculate the actual address of the entry point.<TR>
<TD>$24<TD>Reserved.</TABLE>
<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="RTArch-127.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="RTArch-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="RTArch-147.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="RTArch-129.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="RTArch-3.html">&copy; Apple Computer, Inc.</A><br>11 MARCH 1997<P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML> 
