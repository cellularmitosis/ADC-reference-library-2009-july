<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Key-Remap Resource (Type 'itlk')(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING581></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-580.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-582.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-570.html"><B>Appendix C - Keyboard Resources</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING581-0></A>
<H1><A NAME=MARKER-9-60></A>Key-Remap Resource (Type 'itlk')</H1>
 <A NAME=MARKER-2-61></A>The key-remap resource (resource type <CODE>'itlk'</CODE>) is used by the <CODE>KeyTranslate</CODE> function to ensure that all international keyboard layouts work on all Macintosh keyboards. The key-remap resource specifies how to remap the virtual key codes produced by certain key combinations before <CODE>KeyTranslate</CODE> converts the virtual key codes to character codes with a keyboard-layout (<CODE>'KCHR'</CODE>) resource. <CODE>KeyTranslate</CODE> is described in the chapter "Event Manager" in <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I>.<A NAME=MARKER-2-9></A><P>
 There is one key-remap resource per keyboard-layout resource that needs it. The <CODE>'itlk'</CODE> resource has the same resource ID as the keyboard-layout resource with which it is associated. The Operating System loads key-remap resources from the System file only.<P>
 The key-remap resource consists of an integer count of entries followed by a set of 8-byte entries. <A HREF=#MARKER-9-63>Figure C-5</A> shows the format of an entry.<P>
<B>Figure C-5  <A NAME=MARKER-9-63></A>Format of an entry in the key-remap resource</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/KR_L-03.jpg">
 <A NAME=MARKER-2-64></A>Before the <CODE>KeyTranslate</CODE> function begins processing with the keyboard-layout resource, it determines which entry in the key-remap resource to use. It tests each entry in the key-remap resource to see whether<P>
<UL>
<LI>the actual keyboard type matches the keyboard type element
<LI>the product of an <CODE>AND</CODE> operation on the actual virtual key code with the key code mask matches the current key code element
<LI>the product of an <CODE>AND</CODE> operation on the actual modifiers with the modifiers mask matches the current modifiers element<P>
</UL>
 If all three match, <CODE>KeyTranslate</CODE> substitutes the new modifiers and virtual key code from that entry before applying them to the keyboard-layout resource.<P>
 To allow for a more compact table when several virtual key codes produced from one key (using different modifiers) are all mapped together to a different key, an additional step is taken. <CODE>KeyTranslate</CODE> uses the modifiers mask and key-code mask in the key-remap entry to produce a number of new modifiers and virtual key codes. Here is how a single entry can remap all modifier combinations for a given key:<P>
<OL>
<LI>An <CODE>AND</CODE> operation is performed on the new modifiers and new virtual key code with the modifiers mask and the key-code mask from the entry.
<LI>An <CODE>AND</CODE> operation is performed on the actual modifiers and actual virtual key code with the 1's complement of the modifiers mask and key code mask from the entry.
<LI>The <CODE>OR</CODE> of these two operations is the final result that is used for key translation.<P>
</OL>
<DL>
<DT><B>Note</B>
<DD>If the keyboard type is 259 (the ID for the ISO layout of the small Macintosh 512K Keyboard), the third field in the key-remap resource (which usually contains the current virtual key code) consists of the raw key code. See <A HREF=Text-571.html#MARKER-9-1>Table C-1 on page C-4</A> of this appendix for a list of the keyboard types.<A NAME=MARKER-2-65></A><EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-580.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-582.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
