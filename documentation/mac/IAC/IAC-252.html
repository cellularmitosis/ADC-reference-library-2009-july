<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Creating a Simple Object Specifier Record(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING252></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-251.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-253.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-231.html"><B>Chapter 6 - Resolving and Creating Object Specifier Records</B></A> / <A HREF="IAC-251.html"><B>Creating Object Specifier Records</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING252-0></A>
<H2><A NAME=MARKER-9-235></A>Creating a Simple Object Specifier Record</H2>
 <A NAME=MARKER-2-278></A>This section shows how to use the <CODE>CreateObjSpecifier</CODE> function to create the object specifier record shown in <A HREF=IAC-251.html#MARKER-9-50>Table 6-7</A>. The <CODE>CreateObjSpecifier</CODE> function creates the necessary keyword-specified descriptor records for the class ID, container, key form, and key data and returns the resulting object specifier record as a descriptor record of type <CODE>typeObjectSpecifier</CODE>.<P>
 <A HREF=#MARKER-9-237>Listing 6-12</A> shows how the <CODE>CreateObjSpecifier</CODE> function creates an object specifier record from parameters that an application specifies.<P>
<B>Listing 6-12  <A NAME=MARKER-9-237></A>Creating an object specifier record using <CODE>CreateObjSpecifier</CODE></B><P>
<PRE>
VAR
   desiredClass:        DescType; 
   myObjectContainer:   AEDesc; 
   myKeyForm:           DescType; 
   myKeyDataDesc:       AEDesc; 
   disposeInputs:       Boolean; 
   myObjSpecRec:        AEDesc;
   myErr:               OSErr;

desiredClass := cRow;
myObjectContainer := MyGetContainer;
myKeyForm := formAbsolutePosition;
myKeyDataDesc := MyGetKeyData;
disposeInputs := TRUE;
{create an object specifier record}
myErr := CreateObjSpecifier(desiredClass, myObjectContainer, 
                              myKeyForm, myKeyDataDesc, 
                              disposeInputs, myObjSpecRec);
</PRE>
 The code shown in <A HREF=#MARKER-9-237>Listing 6-12</A> demonstrates how an application might use the <CODE>CreateObjSpecifier</CODE> function to create four keyword-specified descriptor records as part of a descriptor record of type <CODE>typeObjectSpecifier</CODE>. The <CODE>CreateObjSpecifier</CODE> function returns a result code of <CODE>noErr</CODE> if the object specifier record was successfully created. The object specifier record returned in the <CODE>myObjSpecRec</CODE> parameter describes an Apple event object of the class specified by the <CODE>desiredClass</CODE> parameter, located in the container specified by the <CODE>myObjectContainer</CODE> parameter, with the key form specified by the <CODE>myKeyForm</CODE> parameter and key data specified by the <CODE>myKeyDataDesc</CODE> parameter. <P>
 You can specify <CODE>TRUE</CODE> in the <CODE>disposeInputs</CODE> parameter if you want the <CODE>CreateObjSpecifier</CODE> function to dispose of the descriptor records you created for the <CODE>myObjectContainer</CODE> and <CODE>myKeyDataDesc</CODE> parameters. If you specify <CODE>FALSE</CODE>, then your application is responsible for disposing of these leftover descriptor records. <A NAME=MARKER-2-238></A><P>
 <A HREF=#MARKER-9-239>Listing 6-13</A> shows an application-defined function that uses <CODE>CreateObjSpecifier</CODE> to create an object specifier record for the first row in the table named "Summary of Sales" in the document "Sales Report," then uses the object specifier record returned in the <CODE>myObjSpecRec</CODE> parameter as the direct parameter for a Get Data event. <P>
<B>Listing 6-13  <A NAME=MARKER-9-239></A>Using <CODE>CreateObjSpecifier</CODE> in an application-defined function<A NAME=MARKER-2-240></A></B><P>
<PRE>
FUNCTION MyRequestRowFromTarget (targetAddress: AEAddressDesc; 
                                 VAR reply: AppleEvent): OSErr;
VAR
   desiredClass:           DescType;
   myKeyForm:              DescType;
   myObjectContainer:      AEDesc;
   myObjSpecRec:           AEDesc;
   myKeyDataDesc:          AEDesc;
   keyData:                LongInt;
   theAppleEvent:          AppleEvent;
   myErr:                  OSErr;
   ignoreErr:              OSErr;

BEGIN
   {initialize (set to null descriptor records) the two descriptor records } 
   { that must eventually be disposed of}
   MyInit2DescRecs(myObjSpecRec, theAppleEvent);

   desiredClass := cRow;                     {specify the class}
                                             {specify container for the row}
   myErr := MyCreateTableContainer(myObjectContainer, 
                                    'Summary of Sales', 'Sales Report');
   IF myErr = noErr THEN 
   BEGIN
      myKeyForm := formAbsolutePosition;     {specify the key form}
      keyData := 1;                          {specify the key data for row}
      myErr := AECreateDesc(typeLongInteger, @keyData, Sizeof(keyData), 
                              myKeyDataDesc);
      IF myErr = noErr THEN
         {create the object specifier record}
         myErr := CreateObjSpecifier(desiredClass, myObjectContainer, 
                                       myKeyForm, myKeyDataDesc, 
                                       TRUE, myObjSpecRec);
      IF myErr = noErr THEN
         {myObjSpecRec now describes an Apple event object, and will become } 
         { direct parameter of a Get Data event; first create Get Data event}
         myErr := AECreateAppleEvent(kAECoreSuite, kAEGetData, targetAddress, 
                                       kAutoGenerateReturnID, 
                                       kAnyTransactionID, theAppleEvent);



      IF myErr = noErr THEN
         {add myObjSpecRec as the direct parameter of the Get Data event}
         myErr := AEPutParamDesc(theAppleEvent, keyDirectObject,
                                 myObjSpecRec);
      IF myErr = noErr THEN
         myErr := AESend(theAppleEvent, reply, kAEWaitReply + 
                         kAENeverInteract, kAENormalPriority, 120, 
                         @MyIdleFunction, NIL);
   END;
   ignoreErr := AEDisposeDesc(myObjSpecRec);
   ignoreErr := AEDisposeDesc(theAppleEvent);
   MyRequestRowFromTarget := myErr;
END;
</PRE>
 The <CODE>MyRequestRowFromTarget</CODE> function shown in <A HREF=#MARKER-9-239>Listing 6-13</A> specifies the class ID as <CODE>cRow</CODE>, indicating that the desired Apple event object is a row in a table. It uses the application-defined function <CODE>MyCreateTableContainer</CODE> to create an object specifier record for the table that contains the row, passing "Summary of Sales" and "Sales Report" as the second and third parameters to identify the name of the table and the name of the document that contains the table. (The next section, <A HREF=#MARKER-9-242>"Specifying the Container Hierarchy,"</A> explains how to construct the <CODE>MyCreateTableContainer</CODE> function.) It then specifies the key form as the constant <CODE>formAbsolutePosition</CODE>, which indicates that the key data specifies the position of the row within its container; sets the <CODE>keyData</CODE> variable to 1, indicating the first row, and uses <CODE>AECreateDesc</CODE> to create a descriptor record for the key data; and uses <CODE>CreateObjSpecifier</CODE> to create the object specifier record that describes the desired word.<P>
 The desired row is now fully described by the <CODE>myObjSpecRec</CODE> variable, which contains a descriptor record of type <CODE>typeObjectSpecifier</CODE> that contains the three nested object specifier records shown in <A HREF=IAC-251.html#MARKER-9-50>Table 6-7 on page 6-67</A>. After using <CODE>AECreateAppleEvent</CODE> to create a Get Data event, the <CODE>MyRequestRowFromTarget</CODE> function uses the <CODE>AEPutParamDesc</CODE> function to add the <CODE>myObjSpecRec</CODE> variable to the Get Data event as a direct parameter, then uses <CODE>AESend</CODE> to send the Get Data event.<P>
 Note that the <CODE>MyRequestRowFromTarget</CODE> function begins by using the application-defined function <CODE>MyInit2DescRecs</CODE> to set <CODE>myObjSpecRec</CODE> and <CODE>theAppleEvent</CODE> to null descriptor records. These two functions must be disposed of whether the function is successful or not. By setting them to null descriptor records, the function can dispose of them at the end regardless of where an error may have occurred.<A NAME=MARKER-2-402></A><P>
<A NAME=HEADING252-13></A>
<H3><A NAME=MARKER-9-242></A>Specifying the Container Hierarchy</H3>
 <A NAME=MARKER-2-243></A><A NAME=MARKER-2-244></A><A NAME=MARKER-2-245></A>Because the container for an object specifier record usually consists of a chain of other object specifier records that specify the container hierarchy, your application must create all the object specifier records in the chain, starting with the record for the outermost container. <A HREF=#MARKER-9-246>Listing 6-14</A> and <A HREF=#MARKER-9-248>Listing 6-15</A> demonstrate how to use the <CODE>CreateObjSpecifier</CODE> function to create the first two object specifier records in such a chain: the records for a document and a table. <P>
<B>Listing 6-14  <A NAME=MARKER-9-246></A>Specifying a document container<A NAME=MARKER-2-247></A></B><P>
<PRE>
FUNCTION MyCreateDocContainer (VAR myDocContainer: AEDesc;
                               docName: Str255): OSErr;
VAR
   myDocDescRec:  AEDesc;
   nullDescRec:   AEDesc;
   myErr:         OSErr;
BEGIN
   {create a descriptor record for the name of the document}
   myErr := AECreateDesc(typeChar, @docName[1], 
                           Length(docName), myDocDescRec);
   IF myErr = noErr THEN
      {create a null descriptor record}
      myErr := AECreateDesc(typeNull, NIL, 0, nullDescRec);
   IF myErr = noErr THEN
      {create an object specifier record to specify the }
      { document object}
      myErr := CreateObjSpecifier(cDocument, nullDescRec, 
                                  formName, myDocDescRec, TRUE, 
                                  myDocContainer);
   MyCreateDocContainer := myErr;
END;
</PRE>
 The function <CODE>MyCreateDocContainer</CODE> in <A HREF=#MARKER-9-246>Listing 6-14</A> creates an object specifier record that identifies a document by name. It starts by using the <CODE>AECreateDesc</CODE> function to create two descriptor records: one of type <CODE>typeChar</CODE> for the name of the document, and one of type <CODE>typeNull</CODE> for the null descriptor record that specifies the default container (because the document is not contained in any other Apple event object). These two descriptor records can then be used as parameters for the <CODE>CreateObjSpecifier</CODE> function, which returns an object specifier record (that is, a descriptor record of type <CODE>typeObjectSpecifier</CODE>) in the <CODE>myDocContainer</CODE> variable. The object specifier record specifies an Apple event object of the object class <CODE>cDocument</CODE> in the container specified by the <CODE>nullDescRec</CODE> variable with a key form of <CODE>formName</CODE> and the key data specified by the <CODE>myDocDescRec</CODE> variable. This object specifier can be used by itself to specify a document, or it can be used to specify the container for another Apple event object.<P>
 <A HREF=#MARKER-9-248>Listing 6-15</A> shows an application-defined function, <CODE>MyCreateTableContainer</CODE>, that creates an object specifier record describing a table contained in a document. <P>
<B>Listing 6-15  <A NAME=MARKER-9-248></A>Specifying a table container<A NAME=MARKER-2-249></A><A NAME=MARKER-2-250></A></B><P>
<PRE>
FUNCTION MyCreateTableContainer (VAR myTableContainer: AEDesc;
                                 tableName: Str255;
                                 docName: Str255): OSErr;
VAR
   myDocDescRec:        AEDesc;
   myTableDescRec:      AEDesc;
   myErr:               OSErr;
BEGIN
   {create a container for the document}
   myErr := MyCreateDocContainer(myDocDescRec, docName);
   IF myErr = noErr THEN
   BEGIN
      {create the table container, }
      { first specify the descriptor record for the key data}
      myErr := AECreateDesc(typeChar, @tableName[1], 
                              Length(tableName), myTableDescRec);
      IF myErr = noErr THEN
         myErr := CreateObjSpecifier(cTable, myDocDescRec,
                                    formName, myTableDescRec, 
                                    TRUE, myTableContainer);
   END;
   MyCreateTableContainer := myErr;
END;
</PRE>
 The function <CODE>MyCreateTableContainer</CODE> in <A HREF=#MARKER-9-248>Listing 6-15</A> starts by using the function <CODE>MyCreateDocContainer</CODE> from <A HREF=#MARKER-9-246>Listing 6-14</A> to create an object specifier record that identifies the table's container--the document in which the table is located. Then it uses the <CODE>AECreateDesc</CODE> function to create a descriptor record for the key data--a name that, when combined with the key form <CODE>formName</CODE>, will identify the table in the document. The object specifier record for the document and the descriptor record specifying the table's name are passed to the function <CODE>CreateObjSpecifier</CODE>. It returns an object specifier record in the <CODE>myTableContainer</CODE> parameter that specifies an Apple event object of the object class <CODE>cTable</CODE> in the container specified by the <CODE>MyDocDescRec</CODE> variable with a key form of <CODE>formName</CODE> and the key data specified by the <CODE>myTableDescRec</CODE> variable. This object specifier record can be used by itself to specify a table, or it can be used to specify the container for another Apple event object.<P>
 <A HREF=#MARKER-9-239>Listing 6-13</A> uses the <CODE>MyCreateTableContainer</CODE> function shown in <A HREF=#MARKER-9-248>Listing 6-15</A> to specify the container hierarchy illustrated in <A HREF=IAC-251.html#MARKER-9-50>Table 6-7 on page 6-67</A>. The nested object specifier records shown in <A HREF=IAC-251.html#MARKER-9-50>Table 6-7</A> use the key forms <CODE>formName</CODE> and <CODE>formRelativePosition</CODE>. You can create key data for the key forms <CODE>formPropertyID</CODE>, <CODE>formUniqueID</CODE>, and <CODE>formRelativePosition</CODE> using similar techniques.<A NAME=MARKER-2-430></A> <A NAME=MARKER-2-228></A> <A NAME=MARKER-21-348></A> <A NAME=MARKER-2-254></A> <A NAME=MARKER-2-255></A><P>
<A NAME=HEADING252-23></A>
<H3>Specifying a Property</H3>
 <A NAME=MARKER-2-256></A>The key form <CODE>formPropertyID</CODE> allows your application to specify key data identifying a property of the object specified as a container. For example, an object specifier record that identifies the font property of a word specifies <CODE>cProperty</CODE> as the class ID, an object specifier record for the word as the property's container, <CODE>formPropertyID</CODE> as the key form, and the constant <CODE>pFont</CODE> as the key data. <P>
 Note that an object specifier record that identifies a property does not include a value for the property, such as <CODE>Palatino</CODE>. The value of a property is returned or set as a parameter of an Apple event. For example, an application that sends a Get Data event to get the <CODE>pFont</CODE> property of a word receives a value such as <CODE>Palatino</CODE> in the <CODE>keyAEResult</CODE> parameter of the reply event, and an application that sends a Set Data event to change the <CODE>pFont</CODE> property of a word specifies a font in the <CODE>keyAEData</CODE> parameter of the Set Data event. <P>
 To specify the key data for a key form of <CODE>formPropertyID</CODE>, your application must create a descriptor record of <CODE>typeType</CODE> whose data consists of a constant specifying a property. You can use <CODE>AECreateDesc</CODE> to create a descriptor record that specifies the constant for a property, then use <CODE>CreateObjSpecifier</CODE> to add the descriptor record to an object specifier record as a keyword-specified descriptor record with the keyword <CODE>keyAEKeyData<A NAME=MARKER-2-257></A></CODE>.<P>
 For more information about object specifier records that specify a property, see <A HREF=IAC-237.html#MARKER-9-103>"Key Data for a Property ID" on page 6-14</A>.<P>
<A NAME=HEADING252-28></A>
<H3>Specifying a Relative Position</H3>
 <A NAME=MARKER-2-258></A><A NAME=MARKER-2-259></A><A NAME=MARKER-2-260></A>The key form <CODE>formRelativePosition</CODE> allows your application to specify key data identifying an element or a set of elements that are immediately before or after the specified container. For example, if the container is a table, you could use a key form of <CODE>formRelativePosition</CODE> to specify the paragraph before or after the table. <P>
 To specify the key data for a key form of <CODE>formRelativePosition</CODE>, your application must create a descriptor record of <CODE>typeEnumerated</CODE> whose data consists of a constant specifying either the element after (<CODE>kAENext</CODE>) or the element before (<CODE>kAEPrevious</CODE>) the specified container.<P>
 You can use <CODE>AECreateDesc</CODE> to create a descriptor record that specifies one of these constants, then use <CODE>CreateObjectSpecifier</CODE> to add it to an object specifier record as a keyword-specified descriptor record with the keyword <CODE>keyAEKeyData</CODE>.<P>
 For more information about object specifier records that specify a relative position, see <A HREF=IAC-238.html#MARKER-9-112>"Key Data for Relative Position" on page 6-16</A>. <A NAME=MARKER-2-261></A> <A NAME=MARKER-2-262></A> <CODE><A NAME=MARKER-2-263></A></CODE><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-251.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-253.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
