<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>NCMUseProfileComment(IM: ACI Ref)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING271></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->




<!-- Main Body -->

<CENTER>
<P>
<A HREF="ACIReference-270.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="ACIReference-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="ACIReference-371.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="ACIReference-272.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="ACIReference-2.html"><B>Advanced Color Imaging Reference</B></A> / <BR><DD><A HREF="ACIReference-154.html"><B>Chapter 3 - ColorSync Manager Reference for Applications and Device Drivers</B></A> / <A HREF="ACIReference-218.html"><B>ColorSync Manager Functions</B></A><BR><DL><DD><A HREF="ACIReference-269.html"><B>Working With Profiles and Profile Identifiers in Pictures</B></A> / <A HREF="ACIReference-204.html"><B></B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING271-0></A>
<H3><A NAME=MARKER-11-416></A><A NAME=MARKER-9-417></A>NCMUseProfileComment</H3>
 Automatically embeds a profile or a profile identifier into an open picture.<P>
<PRE>
pascal CMError NCMUseProfileComment (
CMProfileRef prof, 
unsigned long flags);
</PRE>
<DL>
<DT><CODE>prof</CODE>
<DD> A profile reference <A HREF=ACIReference-210.html#MARKER-9-299>(page 3-63)</A> to the profile to embed.
<DT><CODE>flags</CODE>
<DD> A flag value in which individual bits determine settings. You set the low bit to 0 to embed a profile or to 1 to embed a profile identifier. Other bits are reserved for future use. ColorSync provides constant values for setting and testing the flags parameter, described in <A HREF=ACIReference-166.html#MARKER-9-100>"Constants for Embedding Profiles and Profile Identifiers" (page 3-19)</A>.
<DT><I>function result</I>
<DD> A result code of type CMError. See <A HREF=ACIReference-313.html#MARKER-9-479>"Result Codes" (page 3-174)</A> for a list of ColorSync-specific result codes.
</DL>
<A NAME=HEADING271-6></A>
<H5>DISCUSSION</H5>
 The <CODE>NCMUseProfileComment</CODE> function <A NAME=MARKER-2-418></A>automatically generates the picture comments required to embed the specified profile or profile identifier into the open picture.<P>
 To embed a profile, you call NCMUseProfileComment with the low bit of the flags parameter set to 0. The NCMUseProfileComment function calls the QuickDraw <CODE>PicComment</CODE> function with a picture comment <CODE>kind</CODE> value of <CODE>cmComment</CODE> and a 4-byte selector that describes the type of data in the picture comment: 0 to begin the profile, 1 to continue, and 2 to end the profile. If the size in bytes of the profile and the 4-byte selector together exceed 32 KB, this function segments the profile data and embeds the multiple segments in consecutive order using selector 1 to embed each segment. <A HREF=#nonexistent-marker>Figure 4-7 (page 4-33)</A> in <I>Advanced Color Imaging on the Mac OS</I> shows how profile data is embedded in a PICT file picture.<P>
 To embed a profile identifier <A HREF=ACIReference-212.html#MARKER-9-304>(page 3-64)</A>, you call NCMUseProfileComment with the low bit of the flags parameter set to 1. The function extracts the necessary information from the profile reference (prof) to embed a profile identifier for the profile. The profile reference can refer to a previously embedded profile or to a profile on disk in the ColorSyncTM Profiles folder.<P>
<DL>
<DT><B>IMPORTANT</B>
<DD>You can use this function to embed all types of ColorSync 2.x profiles in an image, including device-linked profiles, but not abstract profiles. You cannot use this function to embed ColorSync 1.0 profiles in an image.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 The <CODE>NCMUseProfileComment</CODE> function precedes the profile it embeds with a picture comment of <CODE>kind cmBeginProfile</CODE>. For embedding to work correctly, the currently effective profile must be terminated by a picture comment of kind <CODE>cmEndProfile</CODE> after drawing operations using that profile are performed. You are responsible for adding the picture comment of <CODE>kind cmEndProfile</CODE>. If a picture comment was not specified to end the profile following the drawing operations to which the profile applies, the profile will remain in effect until the next embedded profile is introduced with a picture comment of <CODE>kind cmBeginProfile</CODE>. However, use of the next profile might not be the intended action. Always pair use of the <CODE>cmBeginProfile</CODE> and <CODE>cmEndProfile</CODE> picture comments. When the ColorSync Manager encounters a <CODE>cmEndProfile</CODE> picture comment, it restores use of the system profile for matching until it encounters another <CODE>cmBeginProfile</CODE> picture comment.<P>
 For more information on the PicComment selector values used by <CODE>NCMUseProfileComment</CODE>, see <A HREF=ACIReference-165.html#MARKER-9-94>"Picture Comment Selectors for Embedding Profile Information" (page 3-18)</A>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="ACIReference-270.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="ACIReference-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="ACIReference-371.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="ACIReference-272.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="ACIReference-3.html">&copy; Apple Computer, Inc.</A><br>11 NOV 1996<P>
<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->
</BODY>
</HTML> 
