<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!-- Template 01-August-01 --><!-- Includes revisions to graphics tags --><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note FL33: Standard File Customization</title><meta name="keywords" content="Mac OS 8 SFPGetFile customization dialog hook file filter "><meta name="Description" content="Technical Note FL33: This Technical Note contains an exampleprogram that demonstrates how SFPGetFile can be customizedusing the dialog hook and file filter functions. SFPGetFile'sdialog hook function and file filter function enable youto customize SFPGetFile's behavior to fit the needs of yourapplication. Also included is a detailed description of howto modify the Resource Compiler Input File.">                                       <meta name="categories" content="Files"><meta name="week-posted" content="Sep 30, 1985 - Oct 4, 1985"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002459" title="Standard File Customization"></a><A NAME="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxUserExperience-date.html">User Experience</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/UserExperience/index.html" target="_blank">Reference Library > User Experience</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note FL33</div>
<div id="pageheadsub">Standard File Customization</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext">					<A HREF="#Introduction">Introduction</a><BR><BR> 					<A HREF="#Section1">Modifying the Resource Compiler Input File</a><BR><BR> <A HREF="#Section2">The Dialog Hook</a><BR><BR> <A HREF="#Section3">The File Filter</a><BR><BR> <A HREF="#Section4">MPW Pascal Source</a><BR><BR> <A HREF="#Section5">MPW C Source</a><BR><BR> <A HREF="#Section6">Rez Input File</a><BR><BR> 					 <A HREF="#References">References</A><BR><BR>   <A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">This note contains an example program that demonstrates how <code>SFPGetFile</code>can be customized using the dialog hook and file filter functions.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Oct 01 1995]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR><!-- begin_content --><a name="Introduction"></a><h2>Introduction</h2><p><code>SFPGetFile</code>'s dialog hook function and file filter function enable you tocustomize <code>SFPGetFile</code>'s behavior to fit the needs of your application.This technical note consists primarily of a short example program that</p>        <p>1) changes the title of the Open button to '<code>MyOpen</code>',</p><p>2) adds two radio buttons so that the user can choose to display either textfiles or text files and applications,</p><p>3) adds a quit button to the <code>SFPGetFile</code> dialog.</p><p>All this is done in a way so as to provide compatibility with the MacintoshFile System (MFS), the Hierarchical File System (HFS) and (hopefully) futuresystems. If you have any questions as you read, the complete source of the demoprogram and the resource compiler input file is provided at the end of thistechnical note.</p><p>Basically, we need to do three things: add our extra controls to the resourcecompiler input file, write a dialog hook function, and write a file filter function.</p><P><A HREF="#top">Back to top</A></P><a name="Section1"></a><h2>Modifying the Resource Compiler Input File</h2><p>First we need to define a dialog in our resource file. It will be DLOG #128:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    CONST myDLOGID = 128;</pre>	</TD></TR></TABLE></CENTER><p>and its Rez description is:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    resource 'DLOG' (128, purgeable) {        {0, 0, 200, 349},        dBoxProc, invisible, noGoAway,        0x0,        128,        "MyGF"    };</pre>	</TD></TR></TABLE></CENTER><p>The above coordinates (0 0 200 349) are from the standard Standard File dialog.If you need to change the size of the dialog to accommodate new controls,change these coordinates. Next we need to add a DITL in our resource file thatis the same as the standard HFS DITL #-4000 except for one item. We need tochange the left coordinate of UserItem #4, or part of the dialog will be hiddenif we're running under MFS:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    /* [4] */    /* left coordinate changed from 232 to 252 so program will       work on MFS */    {39, 252, 59, 347},    UserItem {         disabled    };</pre>	</TD></TR></TABLE></CENTER><p>None of the other items of the DITL should be changed, so that your programwill remain as compatible as possible with different versions of Standard File.Finally, we need to add three items to this DITL, two radio buttons and onebutton (to serve as a quit button)</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    /* [11] textButton */    {1, 14, 20, 142},    RadioButton {        enabled,        "Text files only"    };    /* [12] textAppButton */    {19, 14, 38, 176},    RadioButton {        enabled,        "Text and applications"    };    /* [13] quitButton */    {6, 256, 24, 336},    Button {        enabled,        "Quit"    }</pre>	</TD></TR></TABLE></CENTER><p>Because we've added three items, we need also need to change the item count forthe DITL from 10 to 13. We also include the following in our resource file:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>resource 'STR#' (256) {    {/* array StringArray: 1 elements */        /* [1] */        "MyOpen"    }};</pre>	</TD></TR></TABLE></CENTER><p>That's all there is to modify in the resource file.</p><P><A HREF="#top">Back to top</A></P><a name="Section2"></a><h2>The Dialog Hook</h2><p>We will be calling <code>SFPGetFile</code> as follows:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    SFPGetFile (wher, '', @SFFileFilter, NumFileTypes, MyFileTypes, @MySFHook,reply, myDLOGID,nil);</pre>	</TD></TR></TABLE></CENTER><p>Notice that we're passing <code>@MySFHook</code> to Standard File. This is theaddress of our dialog hook routine. Our dialog hook is declared as:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    FUNCTION MySFHook(MySFitem: INTEGER; theDialog: DialogPtr):INTEGER;</pre>	</TD></TR></TABLE></CENTER><p>A dialog hook routine allows us to see every item hit before standard file actson it. This allows us to handle controls that aren't in the standard <code>SFPGetFile</code>'s DITL or to handle standard controls in non-standard ways. The dialog hook in this example consists of a case statement with <code>MySFitem</code> as the case selector. Before <code>SFPGetFile</code>displays its dialog, it calls our dialog hook, passing it a -1 as <code>MySFitem</code>. This gives us a chance to initialize our controls. Here we will set the <code>textAppButton</code> to off<b> </b>and the <code>textButton</code> to on:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    GetDItem(theDialog,textAppButton,itemType,itemToChange,itemBox);     SetCtlValue(controlHandle(itemToChange),btnOff);     GetDItem(theDialog,textButton,itemType,itemToChange,itemBox);     SetCtlValue(controlHandle(itemToChange),btnOn); </pre>	</TD></TR></TABLE></CENTER><p>and we can also change the title of an existing control. Here's how we mightchange the title of the Open button using a string that we get from a resource file:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    GetIndString(buttonTitle,256,1);     If buttonTitle &lt;&gt; '' then Begin { if we really got the resource}         GetDItem(theDialog,getOpen,itemType,itemToChange,itemBox);         SetCtitle(controlHandle(itemToChange),buttonTitle);    End; {if} {if we didn't get the resource, don't change the title}</pre>	</TD></TR></TABLE></CENTER><p>Upon completion of our routine that handles the -1, we return a -1 to standard file:</p> <CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>MySFHook:= MySFItem; {pass back the same item we were sent}</pre>	</TD></TR></TABLE></CENTER><p>We now have a <code>SFPGetFile</code> dialog displayed that has a quit button and two radio buttons (the <code>textOnly</code> button is on, the <code>TextApp</code> button is off). In addition, the standard Open button has been renamed to <code>MyOpen</code> (or whatever STR is the first string in STR# 256). This was all done before <code>SFPGetFile</code> displayed the dialog. Once our hook is exited, SFPGetFile displays the dialog and calls ModalDialog.</p><p>When the user clicks on an item in the dialog, our hook is called again. We canthen take appropriate actions, such as highlighting the <code>textButton</code> andun-highlighting the <code>textAppButton</code> if the user clicks on the <code>textButton</code>. At thistime, we can also update a global variable (<code>textOnly</code>) that we will use in ourfile filter function to tell us which files to display. Notice that we canredisplay the file list by returning a 101 as the result of <code>MySFHook</code>. (StandardFile for Systems newer than 4.3 will also read the low memory globals,<code>CurDirStore</code> and <code>SFSaveDisk</code>, and switch directories when necessary if a 101 isreturned as the result. Thus, you can point Standard File to a new directory,or a new disk.) For example, when the <code>textButton</code> is hit we turn the<code>textAppButton</code> off, turn the textButton on, update the global variable textOnly,and tell <code>SFPGetFile</code> to redisplay the list of files the user can choose from:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    if not textOnly then Begin  {if textOnly was turned off, turn it on now}         GetDItem(theDialog,textAppButton,itemType,itemToChange,itemBox);         SetCtlValue(controlHandle(itemToChange),btnOff);         GetDItem(theDialog,textButton,itemType,itemToChange,itemBox);         SetCtlValue(controlHandle(itemToChange),btnOn);         textOnly:=TRUE;     {toggle our global variable for use in the filter}         MySFHook:= reDrawList;{101}       {we must tell SF to redraw the list}     End;  {if not textOnly}</pre>	</TD></TR></TABLE></CENTER><p>If our quit button is hit, we can pass <code>SFPGetFile</code> back the cancelbutton:</p> <CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    MySFHook:= getCancel;</pre>	</TD></TR></TABLE></CENTER><p>If one of <code>SFPGetFile</code>'s standard items is hit, it is very important to pass thatitem back to <code>SFPGetFile</code>:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    MySFHook:= MySFItem; {pass back the same item we were sent}</pre>	</TD></TR></TABLE></CENTER><P><A HREF="#top">Back to top</A></P><a name="Section3"></a><h2>The File Filter</h2><p>Remember, we called <code>SFPGetFile</code> as follows:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    SFPGetFile (wher, '', @SFFileFilter, NumFileTypes,                 MyFileTypes, @MySFHook, reply,myDLOGID,nil);</pre>	</TD></TR></TABLE></CENTER><p>Notice that we're passing <code>@SFFileFilter </code>to <code>SFPGetFile</code>. Thisis the address of our file filter routine. A file filter is declared as:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    FUNCTION SFFileFilter (p: ParmBlkPtr): BOOLEAN;</pre>	</TD></TR></TABLE></CENTER><p>A file filter routine allows us to control which files <code>SFPGetFile</code> will display for the user. Our file filter is called for every file (of the type(s) specified in  the typelist) on an MFS disk, or for every file (of the type(s) specified in the typelist) in the current directory on an HFS disk. In addition, <code>SFPGetFile</code> displays HFS folders forus automatically. Our file filter selects which files should appear in the dialog by returning FALSE for every file that should be shown and TRUE for every file that shouldn't.</p><p>For example, using our global variable <code>textOnly</code> (which we set in ourdialog hook, remember?):</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    FUNCTION SFFileFilter(p:parmBlkPtr):boolean;    Begin {SFFileFilter}        SFFileFilter:= TRUE;                        {Don't show it -- default}        if textOnly then           if p^.ioFlFndrInfo.fdType = 'TEXT' then               SFFileFilter:= FALSE                      {Show TEXT files only}           else Begin           End  {dummy else}       else           if (p^.ioFlFndrInfo.fdType = 'TEXT') or                    (p^.ioFlFndrInfo.fdType = 'APPL') then                         SFFileFilter:= FALSE;       { show TEXT or APPL files}    End;  {SFFileFilter}</pre>	</TD></TR></TABLE></CENTER><p><code>SFPGetFile</code> calls the file filter after it has called our dialog hook.Please remember that the filter is passed every file of the types specified in the typelist (<code>MyFileTypes</code>). If you want your application to be able to choose from all files, pass <code>SFPGetFile</code> a -1 as <code>numTypes</code>. For information about parameters to <code>SFPGetFile</code> that haven't been discussed in this technical note, see the Standard File Package chapter of <i>Inside Macintosh</i>.</p><p>That's all there is to it!! Now that you know how to modify <code>SFPGetFile</code>to suit your needs, please don't rush off and load up the dialog window withall kinds of controls and text. Please make sure that you adhere to Macintoshinterface standards. Similar techniques can be used with <code>SFGetFile</code>,<code>SFPutFile</code> and <code>SFPPutFile</code>.</p><p>The complete source of the demo program and of the resource compiler input file follows:</p><P><A HREF="#top">Back to top</A></P><a name="Section4"></a><h2>MPW Pascal Source</h2><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>{$R-}{Jim Friedlander    Macintosh Technical Support 9/30/85}program SFGetDemo;USES     MemTypes,     QuickDraw,     OSIntf,     ToolIntf,     PackIntf;{$D+}CONST  myDLOGID = 128; {ID of our dialog for use with SFPGetFile}VAR  wher: Point; { where to display dialog }  reply: SFReply; { reply record }  textOnly: BOOLEAN; { tells us which files are currently being displayed}  myFileTypes: SFTypeList; { we won't actually use this }  NumFileTypes: integer;{----------------------------------------------------------------------------}FUNCTION MySFHook(MySFitem:integer; theDialog:DialogPtr): integer;CONST  textButton        = 11;      {DITL item number of textButton}  textAppButton    = 12;      {DITL item number of textAppButton}  quitButton        = 13;      {DITL item number of quitButton}  stayInSF         =  0;        {if we want to stay in SF after getting an  Open hit, we can pass back a 0 from our hook (not used inthis example) }  firstTime        = -1;        {the first time our hook is called, it is                    passed a -1}{The following line is the key to the whole routine -- the magic 101!!}  reDrawList     = 101;    {returning 101 as item number will cause                     the file list to be recalculated}  btnOn        = 1;        {control value for on}  btnOff         = 0;        {control value for off}VAR  itemToChange: Handle; {needed for GetDItem and SetCtlValue}  itemBox:Rect;            {needed for GetDItem}  itemType:integer;                {needed for GetDItem}  buttonTitle: Str255;           {needed for GetIndString}Begin {MySFHook}  case MySFItem of    firstTime: Begin { before the dialog is drawn, our hook gets                     called with a -1 (firstTime) as the item so                    we can change things like button titles,                    etc. }{Here we will set the textAppButton to OFF, the textButton to ON}        GetDItem(theDialog,textAppButton,itemType,itemToChange,itemBox);        SetCtlValue(controlHandle(itemToChange),btnOff);        GetDItem(theDialog,textButton,itemType,itemToChange,itemBox);        SetCtlValue(controlHandle(itemToChange),btnOn);        GetIndString(buttonTitle,256,1); {get the button title from a resource file}        If buttonTitle &lt;&gt; '' then Begin        { if we got the resource}            GetDItem(theDialog,getOpen,itemType,itemToChange,itemBox);                            {get handle to open button}            SetCtitle(controlHandle(itemToChange),buttonTitle);        End; {if}                {if we can't get the resource, we                        just won't change the open button's                        title}        MySFHook:= MySFItem;        {pass back the same item we were                         sent}    End;  {firstTime}{Here we will turn the textAppButton OFF, the textButton ON and redraw the list}    textButton: Begin        if not textOnly then Begin            GetDItem(theDialog,textAppButton,itemType,itemToChange,itemBox);            SetCtlValue(controlHandle(itemToChange),btnOff);            GetDItem(theDialog,textButton,itemType,itemToChange,itemBox);            SetCtlValue(controlHandle(itemToChange),btnOn);            textOnly:=TRUE;            MySFHook:= reDrawList;    {we must tell SF to redraw the list}        End;  {if not textOnly}    End;  {textOnlyButton}{Here we turn the textButton OFF, the textAppButton ON and redraw the list}    textAppButton: Begin        if textOnly then Begin            GetDItem(theDialog,TextButton,itemType,itemToChange,itemBox);            SetCtlValue(controlHandle(itemToChange),BtnOff);            GetDItem(theDialog,TextAppButton,itemType,itemToChange,itemBox);            SetCtlValue(controlHandle(itemToChange),BtnOn);            TextOnly:=FALSE;            MySFHook:= reDrawList;    {we must tell SF to redraw the list}          End;  {if not textOnly}        End;  {textAppButton}    quitButton:  MySFHook:= getCancel;    {Pass SF back a 'cancel button'}{!!!!very important !!!! We pass SF's 'standard' hits back to SF}    otherwise  Begin                  MySFHook:= MySFItem;    { the item hit was one of SF's                        standard items... }    End;  {otherwise}            { so just pass it back}  End;  {case}End;  {MySFHook}{-----------------------------------------------------------------------------}FUNCTION SFFileFilter(p:parmBlkPtr):boolean; {general strategy -- check value                           of global vartextOnly to see                           which files to display}Begin {SFFileFilter}  SFFileFilter:= TRUE; {Don't show it -- default}  if textOnly then      if p^.ioFlFndrInfo.fdType = 'TEXT' then          SFFileFilter:= FALSE        {Show it}      else Begin      End  {dummy else}  else      if (p^.ioFlFndrInfo.fdType = 'TEXT') or (p^.ioFlFndrInfo.fdType = 'APPL') then          SFFileFilter:= FALSE;        {Show it}End;  {SFFileFilter}{-----------------------------------------------------------------------------}Begin {main program}   InitGraf (@thePort);   InitFonts;   InitWindows;   TEInit;   InitDialogs (nil);   wher.h:=80;   wher.v:=90;   NumFileTypes:= -1;          {Display all files}{ we don't need to initialize MyFileTypes, because we want to get a chance to filterevery file on the disk in SFFileFilter - we will decide what to show and what not to.If you want to filter just certain types of files by name, you would set up MyFileTypesand NumFileTypes accordingly}   repeat    {each time SFPGetFile is called, display will be text-only files}       textOnly:= TRUE;       SFPGetFile (wher, '', @SFFileFilter, NumFileTypes, MyFileTypes,       @MySFHook,reply,myDLOGID,nil);   until reply.good = FALSE;{until a cancel button hit ( or a Quit button -- thanks to our dialog hook ) }End.</pre>	</TD></TR></TABLE></CENTER><P><A HREF="#top">Back to top</A></P><a name="Section5"></a><h2>MPW C Source</h2><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>#include &lt;Types.h&gt;#include &lt;Quickdraw.h&gt;#include &lt;Resources.h&gt;#include &lt;Fonts.h&gt;#include &lt;Windows.h&gt;#include &lt;Menus.h&gt;#include &lt;TextEdit.h&gt;#include &lt;Events.h&gt;#include &lt;Dialogs.h&gt;#include &lt;Packages.h&gt;#include &lt;Files.h&gt;#include &lt;Controls.h&gt;#include &lt;ToolUtils.h&gt;#define    textButton    11     /*DITL item number of textButton*/#define    textAppButton    12    /*DITL item number of textAppButton*/#define    quitButton    13    /*DITL item number of quitButton*/#define    stayInSF    0    /*if we want to stay in SF after getting an                    Open hit, we can pass back a 0 from our                    hook  (not used in this example) */#define    firstTime    -1    /* the first time our hook is called, it is                    passed a -1*/#define    reDrawList    101    /* This line is the key to the whole                    routine the magic 101!! returning 101 as                    item number will cause the file list to be                    recalculated*/#define    btnOn        1    /*control value for on*/#define    btnOff        0    /*control value for off*/#define     myDLOGID    128    /*resource ID of our DLOG for SFPGetFile*/Boolean        textOnly; /* tells us which files are currently being displayed*/main(){    /*main program*/        pascal short MySFHook();        pascal Boolean flFilter();        Point      wher;            /* where to display dialog*/        SFReply      reply;                /* reply record */        SFTypeList    myFileTypes;          /* we won't use this */        short int      NumFileTypes = -1;    InitGraf(&amp;qd.thePort);    InitFonts();    FlushEvents(everyEvent, 0);    InitWindows();    TEInit();    InitDialogs(nil);    InitCursor();   wher.h=80;   wher.v=90;/* we don't need to initialize MyFileTypes, because we want to get a chance toilter every file on  the disk in flFilter - we will decide what to show and whatnot to. if you want to filter just certain types of files by name, you would setup MyFileTypes and NumFileTypes accordingly*/   do {    textOnly= true;     /*each time SFPGetFile is called, initial                    display will be text-only files*/       SFPGetFile(&amp;wher,"",flFilter, NumFileTypes,myFileTypes,            MySFHook, &amp;reply,myDLOGID,nil);   } while (reply.good);    /*until we get a cancel button hit                 (or a Quit button in this case ) */} /* main */pascal short MySFHook(short MySFItem,DialogPtr theDialog){Handle  itemToChange;            /*needed for GetDItem and SetCtlValue*/Rect    itemBox;                /*needed for GetDItem*/short    itemType;                   /*needed for GetDItem*/char    buttonTitle[256];        /*needed for GetIndString*/  switch (MySFItem)  {    case firstTime:        /* before the dialog is drawn, our hook gets called with a -1         (firstTime)... as the item so we can change things like button         titles, etc. Here we set the textAppButton to OFF, the         textButton to ON*/        GetDItem(theDialog,textAppButton,&amp;itemType,&amp;itemToChange,&amp;itemBox);        SetCtlValue(itemToChange,btnOff);        GetDItem(theDialog,textButton,&amp;itemType,&amp;itemToChange,&amp;itemBox);        SetCtlValue(itemToChange,btnOn);        /*get the button title from a resource file*/        GetIndString((char *)buttonTitle,256,1);        if (buttonTitle[0] != 0)    /* check the length of the p-string                        to see if we got the resource*/        {    /*get a handle to the open button*/    GetDItem(theDialog,getOpen,&amp;itemType,&amp;itemToChange,&amp;itemBox);            SetCTitle(itemToChange,buttonTitle);          } /*if we can't get the resource, we just                      won't change the open button's title*/        return MySFItem; /*pass back the same item we were sent*/        break;/*Here we turn the textAppButton OFF, the textButton ON and redraw the list*/    case textButton:        if (!textOnly) {GetDItem(theDialog,textAppButton,&amp;itemType,&amp;itemToChange,&amp;itemBox);           SetCtlValue(itemToChange,btnOff);GetDItem(theDialog,textButton,&amp;itemType,&amp;itemToChange,&amp;itemBox);                SetCtlValue(itemToChange,btnOn);                textOnly=true;                    return(reDrawList);    /*must tell SF to redraw the list*/               }                  /*if !textOnly*/        return MySFItem;        break;             /*Here we will turn the textButton                        OFF, the textAppButton ON and redraw                        the list*/    case textAppButton:        if (textOnly)            {GetDItem(theDialog,textButton,&amp;itemType,&amp;itemToChange,&amp;itemBox);                    SetCtlValue(itemToChange,btnOff);GetDItem(theDialog,textAppButton,&amp;itemType,&amp;itemToChange,&amp;itemBox);                    SetCtlValue(itemToChange,btnOn);                    textOnly=false;                    return(reDrawList);    /* must tell SF to redraw the list*/           }  /*if not textOnly*/        return MySFItem;     /*pass back the same item we were sent*/        break;    case quitButton:        return(getCancel); /*Pass SF back a 'cancel button'*//*!!!very important !!!! We must pass SF's 'standard' item hits back to SF*/    default:        return(MySFItem); /* the item was one of SF's standard items... */  }  /*switch*/      return(MySFItem); /* return what we got */}  /*MySFHook*/pascal Boolean flFilter(pb)FileParam    *pb;{/* is this gross or what??? */return((textOnly) ? ((pb-&gt;ioFlFndrInfo.fdType) != 'TEXT') :    ((pb-&gt;ioFlFndrInfo.fdType) != 'TEXT') &amp;&amp;    ((pb-&gt;ioFlFndrInfo.fdType) != 'APPL'));}  /*flFilter*/</pre>	</TD></TR></TABLE></CENTER><P><A HREF="#top">Back to top</A></P><a name="Section6"></a><h2>Rez Input File</h2><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>#include "types.r"resource 'STR#' (256) {    {        "MyOpen"    }};resource 'DLOG' (128, purgeable) {    {0, 0, 200, 349},    dBoxProc,    invisible,    noGoAway,    0x0,    128,    "MyGF"};resource 'DITL' (128, purgeable) {    {        /* [1] */        {138, 256, 156, 336},        Button { enabled, "Open" };        /* [2] */        {1152, 59, 1232, 77},        Button { enabled, "Hidden" };        /* [3] */        {163, 256, 181, 336},        Button { enabled, "Cancel" };        /* [4] */        {39, 252, 59, 347},        UserItem { disabled };        /* [5] */        {68, 256, 86, 336},        Button { enabled, "Eject" };        /* [6] */        {93, 256, 111, 336},        Button { enabled, "Drive" };        /* [7] */        {39, 12, 185, 230},        UserItem { enabled };        /* [8] */        {39, 229, 185, 245},        UserItem { enabled };        /* [9] */        {124, 252, 125, 340},        UserItem { disabled };        /* [10] */        {1044, 20, 1145, 116},        StaticText { disabled, "" };        /* [11] */        {1, 14, 20, 142},        RadioButton { enabled, "Text files only" };        /* [12] */        {19, 14, 38, 176},        RadioButton { enabled, "Text and applications" };        /* [13] */        {6, 256, 24, 336},        Button { enabled, "Quit" }    }};</pre>	</TD></TR></TABLE></CENTER><P><A HREF="#top">Back to top</A></P><a name="References"></a><h2>References</h2><p>The Standard File Package</p><P><A HREF="#top">Back to top</A></P><P><A NAME=Downloads></A></P>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (68K)</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/fl_33.pdf">Download</A></P>               </TD>            </TR></table><BR><P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/fl/fl_33.html%3Fid%3DDTS10002459-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/fl/fl_33.html%3Fid%3DDTS10002459-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/fl/fl_33.html%3Fid%3DDTS10002459-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>