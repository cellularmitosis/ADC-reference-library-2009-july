<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/1998/REC-html40-19980424/loose.dtd">
<html>
<head>
<title>kpi_ipfilter.h</title>
<meta http-equiv="Content-Type" content="text/html; charset=ascii">
<meta name="generator" content="HeaderDoc">
<style><!--
#tocMenu {
		display: block;
		position:fixed;
		top:0px;
		left:0px;
		width:210px;
		height:100%;
		background:transparent;
}
#bodyText {
		margin-left: 210px;
}
--></style>
<meta id="toc-file" name="toc-file" content="toc.html">
<script language="JavaScript" src="../../../../Resources/JavaScript/page.js" type="text/javascript"></script><link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css">
<style type="text/css"><!--.keyword {background:#ffffff; color:#761550;}.template {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.function {background:#ffffff; color:#000000;}.string {background: #ffffff; color:#891315;}.preprocessor {background:#ffffff; color:#236e25}.comment {background:#ffffff; color:#236e25}.char {background: #ffffff; color:#0000ff;}.var {background:#ffffff; color:#000000;}.type {background:#ffffff; color:#761550;}.param {background:#ffffff; color:#000000;}.graybox {         border-top: 1px solid #919699;         border-left: 1px solid #919699;         margin-bottom: 10px;         }  .graybox th {         padding: 4px 8px 4px 8px;         background: #E2E2E2;         font-size: 12px;         font-weight: bold;         border-bottom: 1px solid #919699;         border-right: 1px solid #919699;         }  .graybox td {         padding: 8px;         font-size: 12px;         text-align: left;         vertical-align: top;         border-bottom: 1px solid #919699;         border-right: 1px solid #919699;         }  --></style>
</head>
<body bgcolor="#ffffff" onload="initialize_page();">
<noscript>
<div id="tocMenu">
<iframe id="toc_content" name="toc_content" src="toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
</div>
</noscript>
<div id="bodyText">
<!-- start of header -->

<!-- start of header -->
<!--#include virtual="/includes/framesetheader"-->
<!-- end of header -->

<table width="600"><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <a href="../../../../../reference/Darwin/index.html#//apple_ref/doc/uid/TP30001281-TP30000422" target="_top">Darwin</a> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/kernel_fw_leo" target="_top">Kernel Framework Reference</a></font>
<!-- end breadcrumb insert request -->
<p>&#160;</p>
</td></tr></table>
<!-- end of header --><a name="top"></a>
<a name="//apple_ref/doc/header/kpi_ipfilter.h" title="kpi_ipfilter.h"></a>
<hr>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h1><a name="kpi_ipfilter.h">kpi_ipfilter.h</a></h1>
</td></tr></table>
<div class="spec_sheet_info_box"><table cellspacing="0" class="specbox"><tr>
<td scope="row"><b>Includes:</b></td>
<td><div style="margin-bottom:1px"><div class="content_text">
<!-- a -->&lt;sys/kernel_types.h&gt;<!-- /a -->
</div></div></td>
</tr></table></div>
<h2>Overview</h2>
<!-- begin discussion --><p>This header defines an API to attach IP filters. IP filters may be
attached to intercept either IPv4 or IPv6 packets. The filters can
intercept all IP packets in to and out of the host regardless of
interface.<!-- end discussion -->
</p>
<hr>
<br><h2>Functions</h2>
<a name="HeaderDoc_functions"></a>
<dl>
<dt><tt><a href="index.html#//apple_ref/c/func/ipf_addv4" target="_top">ipf_addv4</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/c/func/ipf_addv6" target="_top">ipf_addv6</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/c/func/ipf_inject_input" target="_top">ipf_inject_input</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/c/func/ipf_inject_output" target="_top">ipf_inject_output</a></tt></dt>
<dd></dd>
<dt><tt><a href="index.html#//apple_ref/c/func/ipf_remove" target="_top">ipf_remove</a></tt></dt>
<dd></dd>
</dl>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/ipf_addv4;   name=ipf_addv4 --><a name="//apple_ref/c/func/ipf_addv4"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="ipf_addv4">ipf_addv4</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><!-- a --><span class="type">errno_t</span><!-- /a --> <a href="index.html#//apple_ref/c/func/ipf_addv4" target="_top" class="function"><span class="function">ipf_addv4</span></a>(
    <span class="keyword">const</span> <!-- a --><span class="var">struct</span><!-- /a --> <!-- a --><span class="var">ipf_filter</span><!-- /a --><span class="var">*</span> <!-- a --><span class="var">filter</span><!-- /a -->,
    <!-- a --><span class="var">ipfilter_t</span><!-- /a --> <span class="var">*</span><!-- a --><span class="var">filter_ref</span><!-- /a -->);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>filter</code></dt>
<dd><p>A structure defining the filter.</p></dd>
<dt><code>filter_ref</code></dt>
<dd><p>A reference to the filter used to detach it.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->0 on success otherwise the errno error.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Attaches an IPv4 ip filter.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/ipf_addv6;   name=ipf_addv6 --><a name="//apple_ref/c/func/ipf_addv6"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="ipf_addv6">ipf_addv6</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><!-- a --><span class="type">errno_t</span><!-- /a --> <a href="index.html#//apple_ref/c/func/ipf_addv6" target="_top" class="function"><span class="function">ipf_addv6</span></a>(
    <span class="keyword">const</span> <!-- a --><span class="var">struct</span><!-- /a --> <!-- a --><span class="var">ipf_filter</span><!-- /a --><span class="var">*</span> <!-- a --><span class="var">filter</span><!-- /a -->,
    <!-- a --><span class="var">ipfilter_t</span><!-- /a --> <span class="var">*</span><!-- a --><span class="var">filter_ref</span><!-- /a -->);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>filter</code></dt>
<dd><p>A structure defining the filter.</p></dd>
<dt><code>filter_ref</code></dt>
<dd><p>A reference to the filter used to detach it.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->0 on success otherwise the errno error.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Attaches an IPv6 ip filter.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/ipf_inject_input;   name=ipf_inject_input --><a name="//apple_ref/c/func/ipf_inject_input"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="ipf_inject_input">ipf_inject_input</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><!-- a --><span class="type">errno_t</span><!-- /a --> <a href="index.html#//apple_ref/c/func/ipf_inject_input" target="_top" class="function"><span class="function">ipf_inject_input</span></a>(
    <!-- a --><span class="type">mbuf_t</span><!-- /a --> <span class="param">data</span>,
    <a href="index.html#//apple_ref/c/tdef/ipfilter_t" target="_top" class="type"><span class="type">ipfilter_t</span></a> <span class="param">filter_ref</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>data</code></dt>
<dd><p>The complete IPv4 or IPv6 packet, receive interface must
be set.</p></dd>
<dt><code>filter_ref</code></dt>
<dd><p>The reference to the filter injecting the data</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->0 on success otherwise the errno error.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Inject an IP packet as though it had just been
reassembled in ip_input. When re-injecting a packet intercepted
by the filter's ipf_input function, an IP filter can pass its
reference to avoid processing the packet twice. This also
prevents ip filters installed before this filter from
getting a chance to process the packet. If the filter modified
the packet, it should not specify the filter ref to give other
filters a chance to process the new packet.
</p>
<p>Caller is responsible for freeing mbuf chain in the event that
ipf_inject_input returns an error.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/ipf_inject_output;   name=ipf_inject_output --><a name="//apple_ref/c/func/ipf_inject_output"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="ipf_inject_output">ipf_inject_output</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><!-- a --><span class="type">errno_t</span><!-- /a --> <a href="index.html#//apple_ref/c/func/ipf_inject_output" target="_top" class="function"><span class="function">ipf_inject_output</span></a>(
    <!-- a --><span class="type">mbuf_t</span><!-- /a --> <span class="param">data</span>,
    <a href="index.html#//apple_ref/c/tdef/ipfilter_t" target="_top" class="type"><span class="type">ipfilter_t</span></a> <span class="param">filter_ref</span>,
    <!-- a --><span class="type">ipf_pktopts_t</span><!-- /a --> <span class="param">options</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>data</code></dt>
<dd><p>The complete IPv4 or IPv6 packet.</p></dd>
<dt><code>filter_ref</code></dt>
<dd><p>The reference to the filter injecting the data</p></dd>
<dt><code>options</code></dt>
<dd><p>Output options for the packet</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->0 on success otherwise the errno error. ipf_inject_output
will always free the mbuf.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Inject an IP packet as though it had just been sent to
ip_output. When re-injecting a packet intercepted by the
filter's ipf_output function, an IP filter can pass its
reference to avoid processing the packet twice. This also
prevents ip filters installed before this filter from getting a
chance to process the packet. If the filter modified the packet,
it should not specify the filter ref to give other filters a
chance to process the new packet.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=func;  uid=//apple_ref/c/func/ipf_remove;   name=ipf_remove --><a name="//apple_ref/c/func/ipf_remove"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="ipf_remove">ipf_remove</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><!-- a --><span class="type">errno_t</span><!-- /a --> <a href="index.html#//apple_ref/c/func/ipf_remove" target="_top" class="function"><span class="function">ipf_remove</span></a>(
    <a href="index.html#//apple_ref/c/tdef/ipfilter_t" target="_top" class="type"><span class="type">ipfilter_t</span></a> <span class="param">filter_ref</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>filter_ref</code></dt>
<dd><p>The reference to the filter returned from ipf_addv4 or
ipf_addv6.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->0 on success otherwise the errno error.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Detaches an IPv4 or IPv6 filter.
<!-- end discussion -->
</p>
<p></p>
<h2>Typedefs</h2>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/ipf_detach_func;   name=ipf_detach_func --><a name="//apple_ref/c/tdef/ipf_detach_func"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="ipf_detach_func">ipf_detach_func</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> ( <span class="type">*</span><!-- a --><span class="function">ipf_detach_func</span><!-- /a -->)(
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">cookie</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Fields</font></h5>
<dl>
<dt><code>cookie</code></dt>
<dd><p>The cookie specified when your filter was attached.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>ipf_detach_func is called to notify your filter that it
has been detached.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=title:tdef;  uid=//apple_ref/doc/title:tdef/ipf_filter;   name=ipf_filter --><a name="//apple_ref/doc/title:tdef/ipf_filter"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="ipf_filter">ipf_filter</a></h3>
</td></tr></table>
<hr>
<p></p>
<b>See Also:</b><blockquote><dl>
<dt>
<a href="index.html#//apple_ref/c/tag/ipf_filter" target="_top"><p>ipf_filter</p></a>
</dt>
<dd></dd>
<dt>
<a href="index.html#//apple_ref/c/tag/opaque_ipfilter" target="_top"><p>opaque_ipfilter</p></a>
</dt>
<dd></dd>
<dt>
<a href="index.html#//apple_ref/c/tdef/ipfilter_t" target="_top"><p>ipfilter_t</p></a>
</dt>
<dd></dd>
</dl></blockquote>
<pre><span class="keyword">typedef</span> <span class="keyword">struct</span> <a href="index.html#//apple_ref/c/tag/opaque_ipfilter" target="_top" class="type"><span class="type">opaque_ipfilter</span></a><span class="type">*</span> <!-- a --><span class="var">ipfilter_t</span><!-- /a -->;  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Fields</font></h5>
<dl>
<dt><code>cookie</code></dt>
<dd><p>A kext defined cookie that will be passed to all
filter functions.</p></dd>
<dt><code>name</code></dt>
<dd><p>A filter name used for debugging purposes.</p></dd>
<dt><code>ipf_input</code></dt>
<dd><p>The filter function to handle inbound packets.</p></dd>
<dt><code>ipf_output</code></dt>
<dd><p>The filter function to handle outbound packets.</p></dd>
<dt><code>ipf_detach</code></dt>
<dd><p>The filter function to notify of a detach.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This structure is used to define an IP filter for
use with the ipf_addv4 or ipf_addv6 function.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/ipf_input_func;   name=ipf_input_func --><a name="//apple_ref/c/tdef/ipf_input_func"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="ipf_input_func">ipf_input_func</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <!-- a --><span class="type">errno_t</span><!-- /a --> ( <span class="type">*</span><!-- a --><span class="function">ipf_input_func</span><!-- /a -->)(
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">cookie</span>,
    <!-- a --><span class="type">mbuf_t</span><!-- /a --> <span class="type">*</span><span class="param">data</span>,
    <!-- a --><span class="type">int</span><!-- /a --> <span class="param">offset</span>,
    <!-- a --><span class="type">u_int8_t</span><!-- /a --> <span class="param">protocol</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>cookie</code></dt>
<dd><p>The cookie specified when your filter was attached.</p></dd>
<dt><code>data</code></dt>
<dd><p>The reassembled ip packet, data will start at the ip
header.</p></dd>
<dt><code>offset</code></dt>
<dd><p>An offset to the next header
(udp/tcp/icmp/esp/etc...).</p></dd>
<dt><code>protocol</code></dt>
<dd><p>The protocol type (udp/tcp/icmp/etc...) of the IP packet</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Return:
0 - The caller will continue with normal processing of the packet.
EJUSTRETURN - The caller will stop processing the packet, the packet will not be freed.
Anything Else - The caller will free the packet and stop processing.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>ipf_input_func is used to filter incoming ip packets.
The IP filter is called for packets from all interfaces. The
filter is called between when the general IP processing is
handled and when the packet is passed up to the next layer
protocol such as udp or tcp. In the case of encapsulation, such
as UDP in ESP (IPSec), your filter will be called once for ESP
and then again for UDP. This will give your filter an
opportunity to process the ESP header as well as the decrypted
packet. Offset and protocol are used to determine where in the
packet processing is currently occuring. If you're only
interested in TCP or UDP packets, just return 0 if protocol
doesn't match TCP or UDP.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/ipf_output_func;   name=ipf_output_func --><a name="//apple_ref/c/tdef/ipf_output_func"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="ipf_output_func">ipf_output_func</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><span class="keyword">typedef</span> <!-- a --><span class="type">errno_t</span><!-- /a --> ( <span class="type">*</span><!-- a --><span class="function">ipf_output_func</span><!-- /a -->)(
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">cookie</span>,
    <!-- a --><span class="type">mbuf_t</span><!-- /a --> <span class="type">*</span><span class="param">data</span>,
    <!-- a --><span class="type">ipf_pktopts_t</span><!-- /a --> <span class="param">options</span>);  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>cookie</code></dt>
<dd><p>The cookie specified when your filter was attached.</p></dd>
<dt><code>data</code></dt>
<dd><p>The ip packet, will contain an IP header followed by the
rest of the IP packet.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Return:
0 - The caller will continue with normal processing of the packet.
EJUSTRETURN - The caller will stop processing the packet, the packet will not be freed.
Anything Else - The caller will free the packet and stop processing.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>ipf_output_func is used to filter outbound ip packets.
The IP filter is called for packets to all interfaces. The
filter is called before fragmentation and IPSec processing. If
you need to change the destination IP address, call
ipf_inject_output and return EJUSTRETURN.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/ipfilter_t;   name=ipfilter_t --><a name="//apple_ref/c/tdef/ipfilter_t"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="ipfilter_t">ipfilter_t</a></h3>
</td></tr></table>
<hr>
<p></p>
<b>See Also:</b><blockquote><dl>
<dt>
<a href="index.html#//apple_ref/c/tag/ipf_filter" target="_top"><p>ipf_filter</p></a>
</dt>
<dd></dd>
<dt>
<a href="index.html#//apple_ref/c/tag/opaque_ipfilter" target="_top"><p>opaque_ipfilter</p></a>
</dt>
<dd></dd>
<dt>
<a href="index.html#//apple_ref/doc/title:tdef/ipf_filter" target="_top"><p>ipf_filter</p></a>
</dt>
<dd></dd>
</dl></blockquote>
<pre><span class="keyword">typedef</span> <span class="keyword">struct</span> <a href="index.html#//apple_ref/c/tag/opaque_ipfilter" target="_top" class="type"><span class="type">opaque_ipfilter</span></a><span class="type">*</span> <!-- a --><span class="var">ipfilter_t</span><!-- /a -->;  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Fields</font></h5>
<dl>
<dt><code>cookie</code></dt>
<dd><p>A kext defined cookie that will be passed to all
filter functions.</p></dd>
<dt><code>name</code></dt>
<dd><p>A filter name used for debugging purposes.</p></dd>
<dt><code>ipf_input</code></dt>
<dd><p>The filter function to handle inbound packets.</p></dd>
<dt><code>ipf_output</code></dt>
<dd><p>The filter function to handle outbound packets.</p></dd>
<dt><code>ipf_detach</code></dt>
<dd><p>The filter function to notify of a detach.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This structure is used to define an IP filter for
use with the ipf_addv4 or ipf_addv6 function.
<!-- end discussion -->
</p>
<p></p>
<h2>Structs and Unions</h2>
<hr>
<!-- headerDoc=tag;  uid=//apple_ref/c/tag/ipf_filter;   name=ipf_filter --><a name="//apple_ref/c/tag/ipf_filter"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="ipf_filter">ipf_filter</a></h3>
</td></tr></table>
<hr>
<p></p>
<b>See Also:</b><blockquote><dl>
<dt>
<a href="index.html#//apple_ref/c/tag/opaque_ipfilter" target="_top"><p>opaque_ipfilter</p></a>
</dt>
<dd></dd>
<dt>
<a href="index.html#//apple_ref/doc/title:tdef/ipf_filter" target="_top"><p>ipf_filter</p></a>
</dt>
<dd></dd>
<dt>
<a href="index.html#//apple_ref/c/tdef/ipfilter_t" target="_top"><p>ipfilter_t</p></a>
</dt>
<dd></dd>
</dl></blockquote>
<pre><span class="keyword">struct</span> <a href="index.html#//apple_ref/c/tag/ipf_filter" target="_top" class="type"><span class="type">ipf_filter</span></a> { 
    <a href="../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><!-- a --><span class="var">cookie</span><!-- /a -->; 
    <span class="keyword">const</span> <!-- a --><span class="var">char</span><!-- /a --><span class="var">*</span> <!-- a --><span class="var">name</span><!-- /a -->; 
    <a href="index.html#//apple_ref/c/tdef/ipf_input_func" target="_top" class="type"><span class="type">ipf_input_func</span></a> <!-- a --><span class="var">ipf_input</span><!-- /a -->; 
    <a href="index.html#//apple_ref/c/tdef/ipf_output_func" target="_top" class="type"><span class="type">ipf_output_func</span></a> <!-- a --><span class="var">ipf_output</span><!-- /a -->; 
    <a href="index.html#//apple_ref/c/tdef/ipf_detach_func" target="_top" class="type"><span class="type">ipf_detach_func</span></a> <!-- a --><span class="var">ipf_detach</span><!-- /a -->; 
};  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Fields</font></h5>
<dl>
<dt><code>cookie</code></dt>
<dd><p>A kext defined cookie that will be passed to all
filter functions.</p></dd>
<dt><code>name</code></dt>
<dd><p>A filter name used for debugging purposes.</p></dd>
<dt><code>ipf_input</code></dt>
<dd><p>The filter function to handle inbound packets.</p></dd>
<dt><code>ipf_output</code></dt>
<dd><p>The filter function to handle outbound packets.</p></dd>
<dt><code>ipf_detach</code></dt>
<dd><p>The filter function to notify of a detach.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This structure is used to define an IP filter for
use with the ipf_addv4 or ipf_addv6 function.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=tag;  uid=//apple_ref/c/tag/opaque_ipfilter;   name=opaque_ipfilter --><a name="//apple_ref/c/tag/opaque_ipfilter"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="opaque_ipfilter">opaque_ipfilter</a></h3>
</td></tr></table>
<hr>
<p></p>
<b>See Also:</b><blockquote><dl>
<dt>
<a href="index.html#//apple_ref/c/tag/ipf_filter" target="_top"><p>ipf_filter</p></a>
</dt>
<dd></dd>
<dt>
<a href="index.html#//apple_ref/doc/title:tdef/ipf_filter" target="_top"><p>ipf_filter</p></a>
</dt>
<dd></dd>
<dt>
<a href="index.html#//apple_ref/c/tdef/ipfilter_t" target="_top"><p>ipfilter_t</p></a>
</dt>
<dd></dd>
</dl></blockquote>
<pre><span class="keyword">struct</span> <!-- a --><span class="var">opaque_ipfilter</span><!-- /a -->;  </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Fields</font></h5>
<dl>
<dt><code>cookie</code></dt>
<dd><p>A kext defined cookie that will be passed to all
filter functions.</p></dd>
<dt><code>name</code></dt>
<dd><p>A filter name used for debugging purposes.</p></dd>
<dt><code>ipf_input</code></dt>
<dd><p>The filter function to handle inbound packets.</p></dd>
<dt><code>ipf_output</code></dt>
<dd><p>The filter function to handle outbound packets.</p></dd>
<dt><code>ipf_detach</code></dt>
<dd><p>The filter function to notify of a detach.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This structure is used to define an IP filter for
use with the ipf_addv4 or ipf_addv6 function.
<!-- end discussion -->
</p>
<p></p>
<p><!-- start of footer -->

<!-- start of footer --> 
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/KernelIOKitFramework/kpi_ipfilter_h/index.html%3Fid%3DTP30000816-3.4&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/KernelIOKitFramework/kpi_ipfilter_h/index.html%3Fid%3DTP30000816-3.4&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/KernelIOKitFramework/kpi_ipfilter_h/index.html%3Fid%3DTP30000816-3.4&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</p>
<p>&#160;</p>
<!--#include virtual="/footer"-->
<!-- end of footer -->


<!-- end of footer -->
Last Updated: 2008-12-19
</div>
<!-- headerDoc=Header;  uid=//apple_ref/doc/header/kpi_ipfilter.h;   name=kpi_ipfilter.h --><a name="//apple_ref/doc/header/kpi_ipfilter.h"></a>
</body>
</html>
