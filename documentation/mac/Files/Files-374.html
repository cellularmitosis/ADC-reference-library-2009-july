<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Erasing Initialized Disks (IM: F)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING374></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Files-373.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-375.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Files-2.html"><B>Files</B></A> / <BR><DD><A HREF="Files-367.html"><B>Chapter 5 - Disk Initialization Manager</B></A> / <A HREF="Files-372.html"><B>Using the Disk Initialization Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING374-0></A>
<H2><A NAME=MARKER-2-57></A>Erasing Initialized Disks</H2>
 You can use the standard interface provided by the <CODE>DIBadMount</CODE> function to reinitialize disks that are already initialized correctly. Doing so permanently erases their contents, but does not change their names.<P>
 To reinitialize a disk, call <CODE>DIBadMount</CODE> with the high word of the event message equal to the result code <CODE>noErr</CODE>. The <CODE>DIBadMount</CODE> function presents the standard interface to initialize the disk in the drive whose number is specified by the low word of the event message. However, because the Disk Initialization Manager cannot know why your application wishes to reinitialize a disk, it cannot provide the initial text for the disk initialization dialog box. Therefore, your application must use the Dialog Manager's <CODE>ParamText</CODE> procedure to create a customized message, as illustrated in <A HREF=#MARKER-9-60>Listing 5-2</A>.<A NAME=MARKER-2-59></A><P>
 If you need to reinitialize a valid disk but do not have access to the event message from when the disk was formatted, you can artificially create an event message by setting the event message to an integer representing the drive number, as follows:<P>
<PRE>
myEvent.message := driveNum;
</PRE>
 Doing so sets each of the high-order bits of the artificial event message to 0, which is desired because the constant <CODE>noErr</CODE> is equal to 0.<P>
 <A HREF=#MARKER-9-60>Listing 5-2</A> defines a procedure for displaying a disk initialization dialog box that allows the user to reinitialize the disk in the drive specified by <CODE>driveNum</CODE>. The disk initialization dialog box displays the text specified in the <CODE>myString</CODE> parameter. The procedure in <A HREF=#MARKER-9-60>Listing 5-2</A> in turn calls a procedure named <CODE>DoError</CODE>. You must define <CODE>DoError</CODE> to <BR>process the result code if the initialization did not successfully complete. The disk initialization dialog box does alert the user if the operation is not successfully completed, and the disk is ejected. However, your application might need to know that a formerly mounted disk is no longer mounted because reinitialization failed.<P>
<B>Listing 5-2  <A NAME=MARKER-9-60></A>Reinitializing a valid disk</B><P>
<PRE>
PROCEDURE DoEraseDisk (driveNum: Integer; myString: Str255);
VAR
   myPoint:          Point;            
   myErr:            Integer;          {result code}
BEGIN
   DILoad;                             {load Disk Initialization Manager}
   ParamText(myString, '', '', '');    {set dialog text}
   SetPt(myPoint, 120, 120);           {set top left of dialog box}
   myErr := DIBadMount(myPoint, driveNum);
                                       {allow user to confirm erase}
   IF myErr &lt;&gt; noErr THEN
      DoError(myErr);                  {respond to error, if necessary}
   DIUnload;                           {unload Disk Initialization Manager}
END;
</PRE>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Files-373.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-375.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Files-3.html">&copy; Apple Computer, Inc.</A><br>2 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
