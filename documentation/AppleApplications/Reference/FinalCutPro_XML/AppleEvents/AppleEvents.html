<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Final Cut Pro XML Interchange Format: Apple Events and Final Cut Pro</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Apple Events and Final Cut Pro"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30001149-CH292" title="Apple Events and Final Cut Pro"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000418" target="_top">Apple Applications</a> &gt; <a href="../../../FinalCutProFinalCutExpress-date.html#//apple_ref/doc/uid/TP30000440-TP30000418-TP30000510" target="_top">Final Cut Pro/Final Cut Express</a> &gt; <a href="../AboutThisDoc/AboutThisDoc.html#//apple_ref/doc/uid/TP30001152-TPXREF101">Final Cut Pro XML Interchange Format</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../Interpolation/Interpolation.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../VersionsoftheInterchangeFormat/VersionsoftheInterchangeFormat.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP30001149-CH292-SW1" title="Apple Events and Final Cut Pro"></a>
<h1>Apple Events and Final Cut Pro</h1>

<p>Final Cut Pro version 5.1.2 and later offers support for Apple events that external applications can use to directly manage the import and export of XML in a Final Cut project.</p>

<p>These custom Apple events provide the following functions:</p>

<ul class="ul">
<li class="li"><p>Open a project file.</p></li>
<li class="li"><p>Close a project file, either saving or discarding any changes.</p></li>
<li class="li"><p>Retrieve the XML representation of a project file.</p></li>
<li class="li"><p>Send XML data to Final Cut Pro directly for import.</p></li>
</ul>

<p>To alert the user to changes in a project that result from these import or export operations, there are also several Apple events that control the display of project information, including:</p>


<ul class="ul">
<li class="li"><p>Select a single item in the Browser and highlight it for the user.</p></li>
<li class="li"><p>Open individual items from the Browser into the Viewer window.</p></li>
<li class="li"><p>Use Final Cut's built-in Find mechanism to locate specific elements of a project.</p></li>

</ul><p><strong>New in Final Cut Pro 6.0.2</strong></p><p>Final Cut Pro 6.0.2 provides new Apple Events that support the following functions:</p><ul class="ul"><li class="li"><p>Get a list of all open project files.</p></li><li class="li"><p>Update information about a media file.</p></li><li class="li"><p>Get an XML representation of all available effects.</p></li><li class="li"><p>Retrieve the XML representation of a single item.</p></li></ul><div class="notebox"><a name="//apple_ref/doc/uid/TP30001149-CH292-SW2" title="Note"></a><p><strong>Note:</strong>&nbsp;

The Apple Developer website provides <span class="content_text"><a href="http://developer.apple.com/samplecode/AppleApplications/idxFinalCutProFinalCutExpress-date.html" target="_top">sample code</a></span> that demonstrates the use of Apple events in Final Cut Pro. The sample code includes a header file you can use in constructing your own application.</p></div>



<a name="//apple_ref/doc/uid/TP30001149-CH292-SW3" title="Final Cut Pro Apple Events"></a>
<h2>Final Cut Pro Apple Events</h2>



<dl class="table-display"><a name="//apple_ref/doc/uid/TP30001149-CH292-SW4" title="Open Project ( kFCPOpenProjectFile &#39;ofcP&#39; )"></a>
<br/><strong><dt>Open Project ( kFCPOpenProjectFile 'ofcP' )</dt></strong>

<dt>Description</dt>
<dd>Opens a specified project file. If the project file is already open, the event brings it to the foreground inside Final Cut Pro.</dd>


<dt>Parameter</dt>
<dd><code>kFCPProjectFileKey 'fcpP'
typeFSRef/typeFileURL</code>. The project file to open.</dd>
</dl><p class="clear"></p>


<dl class="table-display"><a name="//apple_ref/doc/uid/TP30001149-CH292-SW5" title="Close Project (kFCPSaveAndCloseProjectFile &#39;cfcP&#39; )"></a>
<br/><strong><dt>Close Project (kFCPSaveAndCloseProjectFile 'cfcP' )</dt></strong>


<dt>Description</dt>
<dd>Closes the specified project file, either saving any changes or discarding them.  </dd>



<dt>Parameters</dt>
<dd>
<code>kFCPProjectFileKey 'fcpP' typeFSRef/typeFileURL</code>. The project to close. If the project is not open, nothing happens. If no project is specified, the most recently opened file is closed.
</dd>



<dt></dt>
<dd>
<code>kFCPProjectFileCloseFlagsKey 'fcCF'
typeSInt32</code>. A flag controlling the behavior of the close event. The possible values are:</dd>



<dt></dt>
<dd>
<ul class="simple_termdef">
<li class="simple_termdef"><p><code>kFCPSaveAndCloseProject</code> - saves any changes and then closes the file.</p></li>
<li class="simple_termdef"><p><code>kFCPDiscardAndCloseProject</code> - discards any changes and closes the file.</p></li>
</ul>

If no flag is specified, the default behavior is save and close.

</dd>


</dl><p class="clear"></p><dl class="table-display"><a name="//apple_ref/doc/uid/TP30001149-CH292-SW6" title="Update Media File (kFCPUpdateMediaFile  &#39;udfF&#39; )"></a><br/><strong><dt>Update Media File (kFCPUpdateMediaFile  'udfF' )</dt></strong><dt>Description</dt><dd>Requests Final Cut Pro to examine a media file modification time and perform a silent reconnect or update if necessary. </dd><dt>Parameters</dt><dd><code>kFCPMediaFileKey 'fcpM' typeFSRef/typeFileURL</code>. The media file to examine and update.</dd></dl><p class="clear"></p><dl class="table-display"><a name="//apple_ref/doc/uid/TP30001149-CH292-SW7" title="Get Open Projects List (kFCPGetAllOpenProjects &#39;fcLP&#39; )"></a><br/><strong><dt>Get Open Projects List (kFCPGetAllOpenProjects 'fcLP' )</dt></strong><dt>Description</dt><dd>Returns a list of open project files as FSRefs. Only projects with an associated file are returned.</dd><dt>Results</dt><dd><code>kFCPOpenProjectList 'fcOP'</code>. An AEList of AERecords, each of which has a <code>kFCPOneOpenProjectFile </code>parameter. </dd><dt></dt><dd><code>kFCPOneOpenProjectFile 'fcPf'</code>. A single path to a project file in the list of open projects. This parameter only occurs within the AEList returned by <code>kFCPOpenProjectList</code>. Its value is a file FSRef.</dd></dl><p class="clear"></p>

<dl class="table-display"><a name="//apple_ref/doc/uid/TP30001149-CH292-SW8" title="Get Project XML (kFCPGetDocumentXML &#39;eXML&#39;)"></a>
<br/><strong><dt>Get Project XML (kFCPGetDocumentXML 'eXML')</dt></strong>


<dt>Description</dt>
<dd>Requests the XML representation of a Final Cut project. If the project file is closed, it is first opened. The project is always brought to the foreground in Final Cut. If a project file is not specified, no XML is returned.</dd>



<dt>Parameters</dt>
<dd>
<code>kFCPProjectFileKey 'fcpP' typeFSRef/typeFileURL</code>. The project to operate on.
</dd>



<dt></dt>
<dd>
<code>kFCPXMLDataVersion 'xmlV' typeFloat</code>. The version of the Final Cut Pro XML Interchange Format to use. If unspecified, then the current version is used.</dd>



<dt>Results</dt>
<dd>
<code>kFCPXMLDataKey 'xmlD' typeUTF8Text</code>. The XML data for the project represented as a UTF-8 string.
</dd>


</dl><p class="clear"></p><dl class="table-display"><a name="//apple_ref/doc/uid/TP30001149-CH292-SW9" title="Get Item XML (kFCPGetItemXML &#39;gXML&#39;)"></a><br/><strong><dt>Get Item XML (kFCPGetItemXML 'gXML')</dt></strong><dt>Description</dt><dd>Requests the XML representation of a single item in a Final Cut Pro project by UUID. If the project is not open, it is first opened and brought to the foreground. If no project file or UUID is provided, no XML is returned.</dd><dt>Parameters</dt><dd><code>kFCPProjectFileKey 'fcpP' typeFSRef/typeFileURL</code>. The project to operate on.</dd><dt></dt><dd><code>kFCPItemUUID 'fcIU' typeUTF8Text</code>. The UUID for the item.</dd><dt></dt><dd><code>kFCPXMLDataVersion 'xmlV' typeFloat</code>. The version of the Final Cut Pro XML Interchange Format to use. If unspecified, then the current version is used.</dd><dt>Results</dt><dd><code>kFCPXMLDataKey 'xmlD' typeUTF8Text</code>. The XML data for the item represented as a UTF-8 string.</dd></dl><p class="clear"></p>

<dl class="table-display"><a name="//apple_ref/doc/uid/TP30001149-CH292-SW10" title="Import XML (kFCPImportXMLToDocument &#39;iXML&#39;)"></a>
<br/><strong><dt>Import XML (kFCPImportXMLToDocument 'iXML')</dt></strong>


<dt>Description</dt>
<dd>Directly imports XML into Final Cut Pro without referencing XML saved on disk. You can specify a specific project file to import the XML into. If you don’t specify a file, the XML is imported into a new, untitled project. Using <code>updatebehavior</code>, you can specify whether the imported items replace items in the project or are simply appended to the project. </dd>



<dt>Parameter</dt>
<dd>
<code>kFCPProjectFileKey 'fcpP' typeFSRef/typeFileURL</code>. The project to import into. If unspecified, a new untitled project is created.
</dd>



<dt></dt>
<dd>
<code>kFCPXMLDataKey 'xmlD' typeUTF8Text</code>. The XML data to import represented as a UTF-8 string. Note this is a buffer of XML data, not a URL. See the <span class="content_text"><a href="http://developer.apple.com/samplecode/AppleApplications/idxFinalCutProFinalCutExpress-date.html" target="_top">sample code</a></span> for Apple Events in Final Cut Pro.
</dd>


</dl><p class="clear"></p><dl class="table-display"><a name="//apple_ref/doc/uid/TP30001149-CH292-SW11" title="Get All Effects (kFCPGetAllEffectsXML  &#39;eFXX&#39;)"></a><br/><strong><dt>Get All Effects (kFCPGetAllEffectsXML  'eFXX')</dt></strong><dt>Description</dt><dd>Allows an application to request the XML representation of all installed effects. </dd><dt>Parameters</dt><dd><code>kFCPXMLDataVersion 'xmlV' typeFloat</code>. An optional value controlling the version of the XML Interchange Format to use. The default is the current version.</dd><dt>Results</dt><dd><code>kFCPXMLDataKey 'xmlD' typeUTF8Text</code>. The XML data represented as a UTF-8 string. NOTE: The XML for effects cannot be imported back into Final Cut Pro.</dd></dl><p class="clear"></p>

<dl class="table-display"><a name="//apple_ref/doc/uid/TP30001149-CH292-SW12" title="Select Item (kFCPSelectItemInBrowser &#39;fcSI&#39;)"></a>
<br/><strong><dt>Select Item (kFCPSelectItemInBrowser 'fcSI')</dt></strong>


<dt>Description</dt>
<dd>Highlights a specified item or items in the Browser window. Use this event to bring one or more items to the attention of the user.</dd>



<dt>Parameters</dt>
<dd>
<code>kFCPProjectFileKey 'fcpP' typeFSRef/typeFileURL</code>. The project file to operate on.
</dd>



<dt></dt>
<dd>
<code>kFCPItemUUID 'fcIU' typeUTF8Text</code>. The UUID of a single item to select in the Browser.
</dd>
<dt></dt><dd><code>kFCPItemsToSelectList 'fcSL' AEDescList</code>. A list specifying multiple items to select at the same time. The parameter is an AEList of AERecords each of which has a single <code>kFCPItemUUID</code> parameter. </dd><dt></dt><dd>NOTE: You can use either a <code>kFCPItemUUID</code> parameter or a <code>kFCPItemsToSelectList</code> parameter, but not both.</dd>

</dl><p class="clear"></p>

<dl class="table-display"><a name="//apple_ref/doc/uid/TP30001149-CH292-SW13" title="Open Item (kFCPOpenItemInProject &#39;fcOI&#39;)"></a>
<br/><strong><dt>Open Item (kFCPOpenItemInProject 'fcOI')</dt></strong>


<dt>Description</dt>
<dd>Opens a specified item. Clips open in the Viewer; sequences in the Timeline; bins in a separate window.
</dd>



<dt>Parameters</dt>
<dd>
<code>kFCPProjectFileKey 'fcpP' typeFSRef/typeFileURL</code>. The project file to operate on.
</dd>



<dt></dt>
<dd>
<code>kFCPItemUUID 'fcIU' typeUTF8Text</code>. The UUID of the item to open.
</dd>


</dl><p class="clear"></p>

<dl class="table-display"><a name="//apple_ref/doc/uid/TP30001149-CH292-SW14" title="Find Items (kFCPFindItemsInProject &#39;ffcP&#39;)"></a>
<br/><strong><dt>Find Items (kFCPFindItemsInProject 'ffcP')</dt></strong>


<dt>Description</dt>
<dd>Searches for items. If the Find Results window is active, the search takes place among elements in this window. Otherwise, the search takes place in the Browser. The search results are displayed in a new Find Results window. This lets you bring multiple items to the attention of the user at one time.</dd>



<dt></dt>
<dd>The <code>kFCPFindParameters</code> list contains one or more entries that compose the search criteria. You can use multiple entries to precisely control the results obtained. For example, one entry can specify that the Name column of the items must start with a string 'Camera' and the next entry specifies that the Notes column must not contain the string 'bad take'. Each criteria entry is made up of four elements: the string to search for, the way to match the string, the column to search, and whether to use matching or non-matching items. Note that each criteria entry is an AERecord, so the list consists of records, each of which contains several parameters.
</dd>



<dt>Parameters</dt>
<dd>
<code>kFCPProjectFileKey 'fcpP' typeFSRef/typeFileURL</code>. The project file to operate on.
</dd>



<dt></dt>
<dd>
<code>kFCPFindLogicMode	 'fndL' typeSInt32</code>. The logic mode for the search. You can combine search criteria using AND (all criteria apply) or OR (only one criteria need apply). Possible values are: </dd>




<dt></dt>
<dd>
<ul class="simple_termdef">
<li class="simple_termdef"><p><code>kFCPFindLogicAnd = 0</code></p></li>
<li class="simple_termdef"><p><code>kFCPFindLogicOr = 1</code></p></li>
</ul>
</dd>



<dt></dt>
<dd>
<code>kFCPFindParameters 'fndP' typeAEList
typeAERecord</code>. An AEDescList list of criteria AERecords. The list is made up of one or more "criteria" records that define the string to search for, the string matching logic to use, whether to find matching items or items that don't match (i.e. 'skip'), and the name of a Browser column to search in. There are four criteria you can specify: <code>kFCPFindSearchString, kFCPFindOmitCriteria,
kFCPFindMatchMode</code> and <code>kFCPFindColumnName
</code>.
</dd>



<dt>Search criteria</dt>
<dd>
<code>kFCPFindSearchString 'fndS' typeUFT8Text</code>. The string to search for.
</dd>



<dt></dt>
<dd>
<code>kFCPFindOmitCriteria 'fndO' typeSInt32</code>. The way the seach criteria should be used. A zero value means find items that match the search string. A non-zero value means find items that don't match the seach string. (That is, skip any item matching the search string.)
</dd>




<dt></dt>
<dd>
<code>kFCPFindMatchMode 'fndM' typeSInt32</code>. The way a string should be matched. Valid entries are:
</dd>



<dt></dt>
<dd>
<ul class="simple_termdef">
<li class="simple_termdef"><p><code>kFCPFindMatchStartsWith = (1 &lt;&lt; 0)</code></p></li>
<li class="simple_termdef"><p><code>kFCPFindMatchContains = (1 &lt;&lt; 1)</code></p></li>
<li class="simple_termdef"><p><code>kFCPFindMatchEquals = (1 &lt;&lt; 2 )</code></p></li>
<li class="simple_termdef"><p><code>kFCPFindMatchEndsWith = (1 &lt;&lt; 3)</code></p></li>
<li class="simple_termdef"><p><code>kFCPFindMatchLessThan = (1 &lt;&lt; 4)</code></p></li>
<li class="simple_termdef"><p><code>kFCPFindMatchGreaterThan = (1 &lt;&lt; 5)</code></p></li>
</ul>
</dd>



<dt></dt>
<dd>
<code>kFCPFindColumnName 'fndC' typeUTF8Text</code>. Restricts the search to a specific Browser column. If not specified or if the passed string is not a valid entry, then all columns are searched. Valid column names are: <code>name, duration, in, out, start, end, scene, shottake, lognote, good, label, label2, mastercomment1, mastercomment2, mastercomment3, mastercomment4, clipcommenta, clipcommentb.</code>

</dd>




</dl><p class="clear"></p>







        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../Interpolation/Interpolation.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../VersionsoftheInterchangeFormat/VersionsoftheInterchangeFormat.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2003, 2009 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2009-02-04<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleApplications/Reference/FinalCutPro_XML/AppleEvents/AppleEvents.html%3Fid%3DTP30001149-4.3&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleApplications/Reference/FinalCutPro_XML/AppleEvents/AppleEvents.html%3Fid%3DTP30001149-4.3&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleApplications/Reference/FinalCutPro_XML/AppleEvents/AppleEvents.html%3Fid%3DTP30001149-4.3&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>