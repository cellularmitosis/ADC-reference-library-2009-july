<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>The DSP Parameter Block(IM:N)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING119></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Networking-118.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Networking-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Networking-304.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt= "Book Index"></A> <A HREF="Networking-120.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Networking-2.html"><B>Networking</B></A> / <BR><DD><A HREF="Networking-98.html"><B>Chapter 5 - AppleTalk Data Stream Protocol (ADSP) </B></A> / <A HREF="Networking-115.html"><B>ADSP Reference</B></A><BR><DL><DD><A HREF="Networking-116.html"><B>Data Structures</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING119-0></A>
<H3><A NAME=MARKER-9-115></A><A NAME=MARKER-21-116></A>The DSP Parameter Block</H3>
 <A NAME=MARKER-2-23></A>The ADSP routines, which you execute by calling the Device Manager's <CODE>PBControl</CODE> <A NAME=MARKER-2-255></A>function, require a pointer to a DSP parameter block that holds all of the input and output values associated with the routine. The DSP parameter block contains variant records used by particular routines. The <CODE>DSPParamBlock</CODE> data type defines the DSP parameter block. <P>
 This section defines the fields that are common to all ADSP routines that use the DSP parameter block. The fields that are used for specific routines only are defined in the descriptions of the routines to which they apply. The reserved fields, which are used internally by the .DSP driver or not at all, are not defined.<P>
<PRE>
TYPE DSPParamBlock = 
PACKED RECORD
   qLink:            QElemPtr;   {reserved}
   qType:            Integer;    {reserved}
   ioTrap:           Integer;    {reserved}
   ioCmdAddr:        Ptr;        {reserved}
   ioCompletion:     ProcPtr;    {completion routine}
   ioResult:         OSErr;      {result code}
   ioNamePtr:        StringPtr;  {reserved}
   ioVRefNum:        Integer;    {reserved}
   ioCRefNum:        Integer;    {driver reference number}
   csCode:           Integer;    {primary command code}
   qStatus:          LongInt;    {reserved}
   ccbRefNum:        Integer;    {CCB reference number}
CASE Integer OF
dspInit, dspCLInit:
   (ccbPtr:       TPCCB;         {pointer to CCB}
   userRoutine:   ProcPtr;       {pointer to user routine}
   sendQSize:     Integer;       {size of send queue}
   sendQueue:     Ptr;           {pointer to send queue}
   recvQSize:     Integer;       {size of receive queue}
   recvQueue:     Ptr;           {pointer to receive queue}
   attnPtr:       Ptr;           {pointer to attention-message }
                                 { buffer}
   localSocket:   Byte;          {local socket number}
   filler1:       Byte);         {filler for proper alignment}
dspOpen, dspCLListen, dspCLDeny:
   (localCID:     Integer;       {local connection ID}
   remoteCID:     Integer;       {remote connection ID}
   remoteAddress: AddrBlock;     {remote internet address}
   filterAddress: AddrBlock;     {address filter}
   sendSeq:       LongInt;       {send sequence number}
   sendWindow:    Integer;       {size of remote buffer}
   recvSeq:       LongInt;       {receive sequence number}
   attnSendSeq:   LongInt;       {attention send seq number}
   attnRecvSeq:   LongInt;       {attention receive seq num}
   ocMode:        Byte;          {connection-opening mode}
   ocInterval:    Byte;          {interval bet. open requests}
   ocMaximum:     Byte;          {retries of open-conn req}
   filler2:       Byte);         {filler for proper alignment}
dspClose, dspRemove:
   (abort:        Byte;          {abort send requests}
   filler3:       Byte);         {filler for proper alignment}
dspStatus:
   (statusCCB:    TPCCB;         {pointer to CCB}
   sendQPending:  Integer;       {bytes waiting in send queue}
   sendQFree:     Integer;       {available send-queue buffer}
   recvQPending:  Integer;       {bytes in receive queue}
   recvQFree:     Integer);      {avail receive-queue buffer}
dspRead, dspWrite:
   (reqCount:     Integer;       {requested number of bytes}
   actCount:      Integer;       {actual number of bytes}
   dataPtr:       Ptr;           {pointer to data buffer}
   eom:           Byte;          {1 if end of message}
   flush:         Byte);         {1 to send data now}
dspAttention:
   (attnCode:     Integer;       {client attention code}
   attnSize:      Integer;       {size of attention data}
   attnData:      Ptr;           {pointer to attention data}
   attnInterval:  Byte;          {reserved}
   filler4:       Byte);         {filler for proper alignment}
dspOptions:
   (sendBlocking: Integer;       {send-blocking threshold}
   sendTimer:     Byte;          {reserved}
   rtmtTimer:     Byte;          {reserved}
   badSeqMax:     Byte;          {retransmit advice threshold}
   useCheckSum:   Byte);         {DDP checksum for packets}
dspNewCID:
   (newCID:       Integer);      {new connection ID}
END;
</PRE>
<DL>
<H5>Field Description</H5>
<DT><A NAME=MARKER-2-256></A>ioCompletion
<DD> A pointer to a completion routine that you can provide; the Device Manager calls your completion routine when it completes execution of the <CODE>PBControl</CODE> function, if you execute <CODE>PBControl</CODE> asynchro-<BR>nously and you specify a pointer to the routine as the value of this field. Specify <CODE>NIL</CODE> for this field if you do not wish to provide a completion routine. If you execute a function synchronously, AppleTalk ignores the <CODE>ioCompletion</CODE> field. For information about completion routines, see the chapter "Introduction to AppleTalk" in this book. 
<DT><A NAME=MARKER-2-257></A>ioResult 
<DD> The result of the function. If you call the routine asynchronously, the Device Manager sets this field to 1 as soon as you call the routine and it changes the field to the actual result code when the routine completes execution. 
<DT><CODE><A NAME=MARKER-2-258></A>ioCRefNum</CODE>
<DD> The driver reference number that is returned by the <CODE>OpenDriver</CODE> function. You must specify this number every time you call the <BR>.DSP driver.
<DT><A NAME=MARKER-2-259></A>csCode 
<DD> T     he command code for the ADSP routine to be executed. You must fill in this field before calling the <CODE>PBControl</CODE> function. You use the following constants as values for this field:<CODE>
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>&nbsp;<TH><CODE>csCode</CODE> command<TH>Action<TR>
<TD>&nbsp;<TD>dspInit <TD>Create a new connection end<TR>
<TD>&nbsp;<TD>dspRemove<TD>Remove a connection end<TR>
<TD>&nbsp;<TD>dspOpen<TD>Open a connection<TR>
<TD>&nbsp;<TD>dspClose<TD>Close a connection<TR>
<TD>&nbsp;<TD>dspCLInit<TD>Create a connection listener<TR>
<TD>&nbsp;<TD>dspCLRemove<TD>Remove a connection listener<TR>
<TD>&nbsp;<TD>dspCLListen<TD>Post a listener request<TR>
<TD>&nbsp;<TD>dspCLDeny<TD>Deny an open-connection request<TR>
<TD>&nbsp;<TD>dspStatus<TD>Get status of connection end<TR>
<TD>&nbsp;<TD>dspRead<TD>Read data from the connection<TR>
<TD>&nbsp;<TD>dspWrite<TD>Write data on the connection<TR>
<TD>&nbsp;<TD>dspAttention<TD>Send an attention message<TR>
<TD>&nbsp;<TD>dspOptions<TD>Set connection end options<TR>
<TD>&nbsp;<TD>dspReset<TD>Forward reset the connection<TR>
<TD>&nbsp;<TD>dspNewCID<TD><A NAME=MARKER-13-45></A><A NAME=MARKER-13-46></A><A NAME=MARKER-13-47></A><A NAME=MARKER-13-48></A><A NAME=MARKER-13-49></A><A NAME=MARKER-13-50></A><A NAME=MARKER-13-51></A><A NAME=MARKER-13-52></A><A NAME=MARKER-13-53></A><A NAME=MARKER-13-54></A><A NAME=MARKER-13-55></A><A NAME=MARKER-13-56></A><A NAME=MARKER-13-57></A><A NAME=MARKER-13-58></A>Generate a CID for a connection end <A NAME=MARKER-2-59></A><A NAME=MARKER-2-60></A><A NAME=MARKER-2-61></A><A NAME=MARKER-2-62></A><A NAME=MARKER-2-63></A><A NAME=MARKER-2-64></A><A NAME=MARKER-2-65></A><A NAME=MARKER-2-67></A><A NAME=MARKER-2-68></A><A NAME=MARKER-2-69></A><A NAME=MARKER-2-70></A><A NAME=MARKER-2-71></A><A NAME=MARKER-2-72></A></TABLE>
</CODE>
<DT><CODE>qStatus</CODE> 
<DD> This field is reserved for use by ADSP. 
<DT><CODE>ccbRefNum</CODE>
<DD> The reference number of the connection control block (CCB). ADSP returns the CCB reference number in response to the <CODE>dspInit</CODE> routine. You must specify this number as a parameter to every .DSP driver routine you call <A NAME=MARKER-2-260></A>subsequently<A NAME=MARKER-2-27></A>.<A NAME=MARKER-2-262></A><A NAME=MARKER-2-263></A>
</DL>



</BLOCKQUOTE>
<HR>
<center>
<A HREF="Networking-118.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Networking-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Networking-304.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt= "Book Index"></A> <A HREF="Networking-120.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Networking-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
