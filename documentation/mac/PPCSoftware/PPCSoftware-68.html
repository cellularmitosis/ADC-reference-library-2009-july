<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>About the Exception Manager (IM: PS)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING68></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="PPCSoftware-67.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="PPCSoftware-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="PPCSoftware-86.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="PPCSoftware-69.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="PPCSoftware-2.html"><B>PowerPC System Software</B></A> / <BR><DD><A HREF="PPCSoftware-67.html"><B>Chapter 4 - Exception Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING68-0></A>
<H1>About the Exception Manager</H1>
 An <B>exception<A NAME=MARKER-2-3></A></B> is an error or other special condition detected by the microprocessor in the course of program execution. When an exception occurs, the Operating System transfers control synchronously to the relevant <B>exception handler<A NAME=MARKER-2-4></A>,</B> which attempts to recover gracefully from the error or special condition. The kinds of errors or other conditions that give rise to exceptions differ from one processor to another. On 680x0 processors, for example, an exception is generated if the currently executing program attempts to divide by zero. By contrast, the PowerPC processor does not generate an exception under <BR>that condition.<P>
 In general, applications or other types of software (including much of the Macintosh Operating System and the Macintosh Toolbox) cannot tolerate the occurrence of exceptions. To provide some measure of protection from potentially fatal exceptions, the Operating System installs its own set of exception handlers. You can, if necessary, use the Exception Manager to install application-specific exception handlers. Any exception handlers that you install apply only to your current context and only to exceptions that are not first intercepted and handled by the Operating System.<P>
<DL>
<DT><B>IMPORTANT</B>
<DD>Not all exceptions that occur in your application's context are passed to your exception handler. Certain exceptions (for example, page faults) are handled completely by the Operating System's exception handlers. As a result, those exceptions do not affect the normal execution of your application or other software.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 When your exception handler is called, the Exception Manager passes it a parameter that contains information about the state of the machine at the time the exception occurred. On PowerPC processor-based Macintosh computers, this information includes<P>
<UL>
<LI>the kind of exception that occurred
<LI>the contents of the 32 general-purpose registers
<LI>the contents of the special-purpose registers (such as the Link Register and the Condition Register)<A NAME=MARKER-2-6></A>
<LI>the contents of the 32 floating-point registers<A NAME=MARKER-9-343></A><P>
</UL>
 Your exception handler can handle the exception in various ways. For example, it might modify the machine state and then resume execution. Similarly, your exception handler might simply transfer control to some other code. In rare instances, however, your exception handler might not be able to handle the exception; when this happens, the exception is usually fatal to your application.<P>
<A NAME=HEADING68-10></A>
<H2>Exception Contexts<A NAME=MARKER-2-8></A></H2>
 In the first version of the system software for PowerPC processor-based Macintosh computers, each application can install its own exception handler, which remains the active handler as long as that application is the current application. In other words, the exception handler of the current application is called for all exceptions not intercepted <BR>by the Operating System. In general, this mechanism results in the execution of the appropriate exception handler. It's possible, however, for code you install to cause exceptions that are handled by some other application's exception handler. For instance, exceptions that arise during the asynchronous execution of code (such as VBL tasks, Time Manager tasks, and I/O completion routines) are handled by the exception handler of whatever application happens to be the current application at the time the exception occurs. If that application has not installed an exception handler, the exception might not be handled.<P>
 All asynchronous code executed in the first version of the system software for PowerPC processor-based Macintosh computers is executed under the 68LC040 Emulator, in which case the exceptions are handled using the existing 680x0 mechanisms. If, however, a routine executed asynchronously calls some code that is native PowerPC code, and if that native code causes an exception to occur, then the current application's exception handler (if any) is called to handle the exception.<P>
<A NAME=HEADING68-13></A>
<H2>Types of Exceptions</H2>
 In the first version of the system software for PowerPC processor-based Macintosh computers, the following conditions can cause exceptions while your application or other software is executing in native mode:<P>
<UL>
<LI>an attempt to write to write-protected memory
<LI>an attempt to access (that is, read, write, or fetch) data at a logical address that is <BR>not assigned
<LI>an attempt to execute trap instructions or other instructions that are not part of the supported application programming interface
<LI>an attempt to execute invalid instructions or an invalid form of a valid instruction
<LI>an attempt to execute privileged instructions when the system is not in <BR>privileged mode
<LI>in appropriate circumstances, reaching a breakpoint
<LI>in appropriate circumstances, reaching a trace point<P>
</UL>
 The Exception Manager defines a number of <B>exception codes<A NAME=MARKER-2-9></A></B> that indicate these and other conditions. An exception code is a constant that indicates which kind of exception has occurred.<P>
<PRE>
typedef unsigned long         ExceptionKind;    /*kind of exception*/
enum {
   /*exception codes*/
   unknownException                    = 0,     /*unknown exception type*/
   illegalInstructionException         = 1,     /*illegal instruction*/
   trapException                       = 2,     /*unknown trap type*/
   accessException                     = 3,     /*failed memory access*/
   unmappedMemoryException             = 4,     /*memory is unmapped*/
   excludedMemoryException             = 5,     /*memory is excluded*/
   readOnlyMemoryException             = 6,     /*memory is read-only*/
   unresolvablePageFaultException      = 7,     /*unresolvable page fault*/
   privilegeViolationException         = 8,     /*privilege violation*/
   traceException                      = 9,     /*trace*/
   instructionBreakpointException      = 10,    /*instruction breakpoint*/
   dataBreakpointException             = 11,    /*data breakpoint*/
   integerException                    = 12,    /*unused*/
   floatingPointException              = 13,    /*floating point*/
   stackOverflowException              = 14,    /*stack overflow*/
   terminationException                = 15     /*task is being terminated*/
};
</PRE>
 Not all of these exception codes are used in the first version of the system software for PowerPC processor-based Macintosh computers; see <A HREF=PPCSoftware-72.html#MARKER-9-34>"Exception Kinds" on page 4-9</A> for a complete explanation of these constants.<P>

</BLOCKQUOTE>
<HR>
<center>
<A HREF="PPCSoftware-67.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="PPCSoftware-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="PPCSoftware-86.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="PPCSoftware-69.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="PPCSoftware-3.html">&copy; Apple Computer, Inc.</A><br>3 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
