<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Handling Print Menu Commands (MacApp PG)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING120></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MacAppProgGuide-119.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-121.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MacAppProgGuide-2.html"><B>Programmer's Guide to MacApp</B></A> / <A HREF="MacAppProgGuide-78.html"><B>Part 2 - Working With MacApp</B></A><BR><DD><A HREF="MacAppProgGuide-118.html"><B>Chapter 23 - Working With Printing</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING120-0></A>
<H1><A NAME=MARKER-9-20></A>Handling Print Menu Commands</H1>
 <A NAME=MARKER-2-21></A>Human interface guidelines specify that all Print commands be included in the File menu. MacApp defines command constants for the Print, Print One, Page Setup, and Show Breaks menu commands. These command constants are handled by the <CODE>DoMenuCommand</CODE> method of the print handler for the view to be printed or by the <CODE>DoMenuCommand</CODE> method of a <CODE>TPrintMenuBehavior</CODE> object attached to the view's document. Both of these <CODE>DoMenuCommand</CODE> methods call the <CODE><A NAME=MARKER-9-23></A>DoPrintCommand</CODE> method of the print-handler object. In the <CODE>TStdPrintHandler</CODE> class, the <CODE>DoPrintCommand</CODE> method handles Print commands as follows:<P>
<DL>
<DT>Print
<DD> Has the command constant <CODE>cPrint</CODE>. The print handler creates and posts a <CODE>TPrintCommand</CODE> object. The <CODE>DoIt</CODE> method of the command object calls the print handler's <CODE>PoseJobDialog</CODE> method to display the print dialog box and prepare for printing. If the user clicks OK, the <CODE>DoIt</CODE> method calls the print handler's <CODE>Print</CODE> method to perform printing. The <CODE>TPrintCommand</CODE> object makes the printing operation recordable but not undoable. 
</DL>
<B>Figure 23-1  <A NAME=MARKER-2-24></A><A NAME=MARKER-9-25></A>Printing classes and methods</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/MacApp_PG-L-013.gif"><P>
<DL>
<DT>Print One
<DD> Has the command constant <CODE>cPrintOne</CODE>. The print handler creates and posts a <CODE>TPrintCommand</CODE> object. The <CODE>DoIt</CODE> method of the command object does not display a print dialog--instead it calls the print handler's <CODE>SetupPrintOne</CODE> method to validate the print record and set the first page to 1 and the last page to 9999. Then it calls the print handler's <CODE>Print</CODE> method to perform printing.
<DT>Page Setup
<DD> Has the command constant <CODE>cPageSetup</CODE>. The print handler calls its own <CODE>PosePageSetupDialog</CODE> method to display the page setup dialog box. If the user clicks OK, the print handler creates a <CODE>TPrintStyleChangeCommand</CODE> object and posts it to the command queue; the command object makes page setup changes undoable.
<DT>Show Breaks
<DD> Has the command constant <CODE>cShowBreaks</CODE>. The print handler toggles the value of its <CODE>fShowBreaks</CODE> instance variable and calls its own <CODE>InvalPageFeedback</CODE> method to force redrawing of the view so that page breaks are shown or not shown, as specified.
</DL>
 The <CODE>DoPrintCommand</CODE> method also handles the <CODE>cFinderPrint</CODE> and <CODE>cDragPrint</CODE> command constants:<P>
<DL>
<DT>Finder printing
<DD> For <CODE>cFinderPrint</CODE>, the print handler calls its own <CODE>SetupForFinder</CODE> method to prepare for printing, then calls its own <CODE>Print</CODE> method to do the printing.
<DT>Drag printing
<DD> The <CODE>cDragPrint</CODE> command is handled similarly to the Print One command. The print handler first calls <CODE>SetupPrintOne</CODE>, then calls its own <CODE>Print</CODE> method to do the printing.<A NAME=MARKER-2-26></A><A NAME=MARKER-10-17></A>
</DL>



</BLOCKQUOTE>
<HR>
<center>
<A HREF="MacAppProgGuide-119.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-121.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MacAppProgGuide-3.html">&copy; Apple Computer, Inc.</A><br>25 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
