<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>QuickTime Component Creation Guide: Functions For Displaying Previews</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Functions For Displaying Previews"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40000898-FunctionsForDisplayingPreviews" title="Functions For Displaying Previews"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000433" target="_top">QuickTime</a> &gt; <a href="../../../../QuickTimeComponentCreation-date.html#//apple_ref/doc/uid/TP30000440-TP30000433-TP30000595" target="_top">QuickTime Component Creation</a> &gt; <a href="../A-Intro/1Introduction.html#//apple_ref/doc/uid/TP40000898-IntroductiontoQuickTimeComponentCreationGuide-DontLinkElementID_38">QuickTime Component Creation Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../F-Chapter/6CreatingPreviewComp.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../Z-RevHistory/revisionhistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40000898-FunctionsForDisplayingPreviews-SW1" title="Functions For Displaying Previews"></a>
<h1>Functions For Displaying Previews</h1>



<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="7FunctionsForDisplay.html#//apple_ref/doc/uid/TP40000898-FunctionsForDisplayingPreviews-DontLinkElementID_32">Introduction</a>
				
			<br/>
			
        
			
			
				<a href="7FunctionsForDisplay.html#//apple_ref/doc/uid/TP40000898-FunctionsForDisplayingPreviews-DontLinkElementID_33">Handling Events</a>
				
			<br/>
			
        
			
			
				<a href="7FunctionsForDisplay.html#//apple_ref/doc/uid/TP40000898-FunctionsForDisplayingPreviews-DontLinkElementID_34">Creating Previews</a>
				
			<br/>
			
        
			
			
				<a href="7FunctionsForDisplay.html#//apple_ref/doc/uid/TP40000898-FunctionsForDisplayingPreviews-DontLinkElementID_35">The Preview Resource</a>
				
			<br/>
			
        
			
			
				<a href="7FunctionsForDisplay.html#//apple_ref/doc/uid/TP40000898-FunctionsForDisplayingPreviews-DontLinkElementID_36">Data Types</a>
				
			<br/>
			
        
			
			
				<a href="7FunctionsForDisplay.html#//apple_ref/doc/uid/TP40000898-FunctionsForDisplayingPreviews-DontLinkElementID_37">Constants</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40000898-FunctionsForDisplayingPreviews-DontLinkElementID_32" title="Introduction"></a><h2>Introduction</h2>
<p>This chapter describes the functions for displaying previews, handling events in previews, and creating previews that are provided by preview components. These functions are described from the perspective of the Image Compression Manager, which is most likely to call preview components. If you are developing a preview component, your component must behave as described here.</p>
<a name="//apple_ref/doc/uid/TP40000898-FunctionsForDisplayingPreviews-DontLinkElementID_33" title="Handling Events"></a>
<h2><a name="//apple_ref/doc/uid/TP40000898-FunctionsForDisplayingPreviews-HandlingEvents" title="Handling Events"></a>Handling Events</h2>
<p>The <code><a href="../../../../Reference/QTRef_MovieComponents/Reference/reference.html#//apple_ref/c/func/PreviewEvent" target="_top">PreviewEvent</a></code> function is provided so that your preview component can do standard event filtering.</p>

<a name="//apple_ref/doc/uid/TP40000898-FunctionsForDisplayingPreviews-DontLinkElementID_34" title="Creating Previews"></a>
<h2><a name="//apple_ref/doc/uid/TP40000898-FunctionsForDisplayingPreviews-CreatingPreviews" title="Creating Previews"></a>Creating Previews</h2>
<p>Two functions are available for use in creating previews. The <code><a href="../../../../Reference/QTRef_MovieComponents/Reference/reference.html#//apple_ref/c/func/PreviewMakePreview" target="_top">PreviewMakePreview</a></code> function creates previews by allocating a handle to data to be added to the file. On the other hand, the <code><a href="../../../../Reference/QTRef_MovieComponents/Reference/reference.html#//apple_ref/c/func/PreviewMakePreviewReference" target="_top">PreviewMakePreviewReference</a></code> function makes previews by returning the type and identification number of a resource within the file to be used as the preview for the file.</p>

<a name="//apple_ref/doc/uid/TP40000898-FunctionsForDisplayingPreviews-DontLinkElementID_35" title="The Preview Resource"></a>
<h2><a name="//apple_ref/doc/uid/TP40000898-FunctionsForDisplayingPreviews-ThePreviewResource" title="The Preview Resource"></a>The Preview Resource</h2>
<p>This section describes the preview resource, which is used to store a visual preview, and the preview resource item structure, which is an array that allows you to store additional preview information.</p>
<p>The preview display code assumes that the data fork of the file is formatted using QuickTime atoms. See <em><a href="../../../MovieBasics/MTEditing/index.html#//apple_ref/doc/uid/TP40000908" target="_top">QuickTime Movie Basics</a></em> for information on atom-based storage.</p>
<p>Adding a preview results in at least two atoms being added to the data file. The first atom has a <code>pnot</code> tag. Its basic structure is the same as the <code>pnotResource</code> structure.</p>

<div class="codesample"><table><tr><td scope="row"><pre>struct PreviewResourceRecord {<span></span></pre></td></tr><tr><td scope="row"><pre>    unsigned long       modDate;<span></span></pre></td></tr><tr><td scope="row"><pre>    short               version;<span></span></pre></td></tr><tr><td scope="row"><pre>    OSType              resType;<span></span></pre></td></tr><tr><td scope="row"><pre>    short               resID;<span></span></pre></td></tr><tr><td scope="row"><pre>};<span></span></pre></td></tr></table></div>

<div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Term</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Definition</p></th>
</tr>


<tr>
<td  scope="row"><p><code>modDate</code></p></td>
<td ><p>Contains the modification time (in the standard Macintosh format of seconds since midnight, January 1, 1904) of the file for which the preview was created. This parameter allows you to find out if the preview is out of date with the contents of the file.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>version</code></p></td>
<td ><p>Contains the version number of the preview resource. The low bit of the version is a flag for preview components that only reference their data. If the bit is set, it indicates that the resource identified in the preview resource is not owned by the preview component, but is part of the file. It is not removed when the preview is updated or removed (using the Image Compression Manager's <code>MakeFilePreview</code> or <code>AddFilePreview</code> function), as it would if the version number were 0.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>resType</code></p></td>
<td ><p>Identifies the type of the preview component used to display the preview data and the type of the atom containing the preview data.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>resID</code></p></td>
<td ><p>Contains the index (1-based) of the atom to be used. For example, a <code>resType</code> of PICT and a <code>resID</code> of 2 tells QuickTime to use the second PICT atom in the file for the preview data.</p></td>
</tr>

</table></div>

<a name="//apple_ref/doc/uid/TP40000898-FunctionsForDisplayingPreviews-DontLinkElementID_36" title="Data Types"></a>
<h2><a name="//apple_ref/doc/uid/TP40000898-FunctionsForDisplayingPreviews-DataTypes" title="Data Types"></a>Data Types</h2>
<p>This section defines the component instance used by preview components, and lists the data structures for preview resources and the preview resource item structure. See <span class="content_text"><a href="../E-Chapter/5PreviewComponents.html#//apple_ref/doc/uid/TP40000898-PreviewComponents-ThePreviewResource">The Preview Resource</a></span> above, which includes the new <code><!--a target="_top" -->PreviewResourceRecord<!--/a--></code> data structure.</p>

<div class="codesample"><table><tr><td scope="row"><pre>typedef ComponentInstance pnotComponent;<span></span></pre></td></tr><tr><td scope="row"><pre>typedef struct pnotResource {<span></span></pre></td></tr><tr><td scope="row"><pre>    unsigned long  modDate;     /* modification date */<span></span></pre></td></tr><tr><td scope="row"><pre>    short          version;     /* version number of preview resource */<span></span></pre></td></tr><tr><td scope="row"><pre>    OSType         resType;     /* type of resource used as preview cache */<span></span></pre></td></tr><tr><td scope="row"><pre>    short          resID;       /* resource identification number<span></span></pre></td></tr><tr><td scope="row"><pre>                                   of resource used as preview cache */<span></span></pre></td></tr><tr><td scope="row"><pre>    short          numResItems; /* number of additional file descriptions */<span></span></pre></td></tr><tr><td scope="row"><pre>    pnotResItem    resItem[ ];  /* array of file descriptions */<span></span></pre></td></tr><tr><td scope="row"><pre>} pnotResource;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>typedef struct pnotResItem {<span></span></pre></td></tr><tr><td scope="row"><pre>    unsigned long       modDate;     /* last modification date of item */<span></span></pre></td></tr><tr><td scope="row"><pre>    OSType              useType;     /* what type of data */<span></span></pre></td></tr><tr><td scope="row"><pre>    OSType              resType;     /* resource type containing item */<span></span></pre></td></tr><tr><td scope="row"><pre>    short               resID;       /* resource ID containing this item */<span></span></pre></td></tr><tr><td scope="row"><pre>    short               rgnCode;     /* region code */<span></span></pre></td></tr><tr><td scope="row"><pre>    long                reserved;    /* set to 0 */<span></span></pre></td></tr><tr><td scope="row"><pre>} pnotResItem; *pnotResItemPtr;<span></span></pre></td></tr></table></div>


<a name="//apple_ref/doc/uid/TP40000898-FunctionsForDisplayingPreviews-DontLinkElementID_37" title="Constants"></a>
<h2><a name="//apple_ref/doc/uid/TP40000898-FunctionsForDisplayingPreviews-Constants" title="Constants"></a>Constants</h2>
<p>This section defines the constants that are used to communicate with preview components. These are primarily flags that describe the preview components capabilities and requirements.</p>

<div class="codesample"><table><tr><td scope="row"><pre>enum {<span></span></pre></td></tr><tr><td scope="row"><pre>    pnotComponentWantsEvents    = 1, /* component requires events */<span></span></pre></td></tr><tr><td scope="row"><pre>    pnotComponentNeedsNoCache   = 2  /* component does not require cache */<span></span></pre></td></tr><tr><td scope="row"><pre>};<span></span></pre></td></tr><tr><td scope="row"><pre>enum {<span></span></pre></td></tr><tr><td scope="row"><pre>  kPreviewShowDataSelector             = 1, /* PreviewShowData */<span></span></pre></td></tr><tr><td scope="row"><pre>  kPreviewMakePreviewSelector          = 2, /* PreviewMakePreview */<span></span></pre></td></tr><tr><td scope="row"><pre>  kPreviewMakePreviewReferenceSelector = 3, /* PreviewMakePreviewReference */<span></span></pre></td></tr><tr><td scope="row"><pre>  kPreviewEventSelector                = 4  /* PreviewEvent */<span></span></pre></td></tr><tr><td scope="row"><pre>};<span></span></pre></td></tr><tr><td scope="row"><pre>#define ShowFilePreviewComponentType 'pnot'     /* creates previews */<span></span></pre></td></tr><tr><td scope="row"><pre>#define CreateFilePreviewComponentType 'pmak'   /* displays previews */<span></span></pre></td></tr></table></div>





        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../F-Chapter/6CreatingPreviewComp.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../Z-RevHistory/revisionhistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2005, 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-01-08<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/QuickTime/RM/WritingQTComponents/MHCreating/G-Chapter/7FunctionsForDisplay.html%3Fid%3DTP40000898-3.1&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/QuickTime/RM/WritingQTComponents/MHCreating/G-Chapter/7FunctionsForDisplay.html%3Fid%3DTP40000898-3.1&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/QuickTime/RM/WritingQTComponents/MHCreating/G-Chapter/7FunctionsForDisplay.html%3Fid%3DTP40000898-3.1&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>