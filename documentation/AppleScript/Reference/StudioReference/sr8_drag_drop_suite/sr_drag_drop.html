<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>AppleScript Studio Terminology Reference: Drag and Drop Suite</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Drag and Drop Suite"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20011222" title="Drag and Drop Suite"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> &gt; <a href="../../../../../reference/ScriptingAutomation/index.html#//apple_ref/doc/uid/TP30001281-TP40005948" target="_top">Scripting &amp; Automation</a> &gt; <a href="../../../../../reference/ScriptingAutomation/idxTools-date.html#//apple_ref/doc/uid/TP30001281-TP40005948-TP30000463" target="_top">Tools</a> &gt; <a href="../index.html" target="_top">AppleScript Studio Terminology Reference</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../sr7_doc_suite/sr_document.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../sr9_menu_suite/sr_menu.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/20011222-TPXREF101" title="Drag and Drop Suite"></a><h1>Drag and Drop Suite</h1><p>This chapter describes the terminology in the Drag and Drop suite, which is available starting in AppleScript Studio version 1.2. This suite defines terms for working with drag and drop, including the <code>drag info</code> class to provide information about a drag, as well as events you use to handle dragging, tracking, preparing for a drop, and concluding a drop. For related information, see the <code><a href="../sr3_app_suite/sr_app.html#//apple_ref/doc/uid/20011217-BAJFJJEF">pasteboard</a></code> class.</p>
<p>Initial drag-and-drop support was added in AppleScript Studio 1.2. It provides the ability for various user interface elements to receive drag events. It does not, however, allow for initiating drag operations (other than those already supported by Cocoa classes).</p>
<p>Additional support for drag and drop was added in AppleScript Studio 1.4:</p>
<ul class="ul"><li class="li"><p>A new property, <code>allows reordering</code>, supports automatic reordering of items in data views. Setting this property to <code>true</code> for a <code><a href="../sr6_data_suite/sr_data_view.html#//apple_ref/doc/uid/20011220-ASKDataViewSuite.Classes.NSTableView">table view</a></code> allows the user to drag rows up and down within the table view, in effect changing the order. However, if the data source is sorted, then <code>allows
reordering</code> is ignored.</p><p>The Outline Reorder and Table Reorder example applications demonstrate how to use this feature.</p></li>
<li class="li"><p>You can drag and drop rows or items within a data view. In addition to the automatic support provided by <code>allows
reordering</code>, you can allow drag and drop of external items into data views, with the additional ability to specify where in the table or outline view to drop items.</p><p>In order to provide this support there are several new event handlers available to <code><a href="../sr6_data_suite/sr_data_view.html#//apple_ref/doc/uid/20011220-ASKDataViewSuite.Classes.NSOutlineView">outline view</a></code> and <code><a href="../sr6_data_suite/sr_data_view.html#//apple_ref/doc/uid/20011220-ASKDataViewSuite.Classes.NSTableView">table view</a></code> objects:</p><ul class="nested">
<li class="nested li"><p><code><a href="../sr6_data_suite/sr_data_view.html#//apple_ref/doc/uid/20011220-BBCCCIDJ">accept outline drop</a></code></p></li>
<li class="nested li"><p><code><a href="../sr6_data_suite/sr_data_view.html#//apple_ref/doc/uid/20011220-BBCCJIBJ">prepare outline drag</a></code></p></li>
<li class="nested li"><p><code><a href="../sr6_data_suite/sr_data_view.html#//apple_ref/doc/uid/20011220-BBCFDIEH">prepare outline drop</a></code></p></li>
<li class="nested li"><p><code><a href="../sr6_data_suite/sr_data_view.html#//apple_ref/doc/uid/20011220-ASKDragAndDropSuite.Commands.DragUpdated">accept table drop</a></code></p></li>
<li class="nested li"><p><code><a href="../sr6_data_suite/sr_data_view.html#//apple_ref/doc/uid/20011220-BBCDEGGJ">prepare table drag</a></code></p></li>
<li class="nested li"><p><code><a href="../sr6_data_suite/sr_data_view.html#//apple_ref/doc/uid/20011220-BBCHCAEA">prepare table drop</a></code></p></li></ul></li></ul>
<p>Among the classes that support drag and drop are <code><a href="../sr5_control_suite/sr_control.html#//apple_ref/doc/uid/20011219-ASKControlViewSuite.Classes.NSButton">button</a></code>, <code><a href="../sr4_container_suite/sr_container.html#//apple_ref/doc/uid/20011218-ASKContainerViewSuite.Classes.NSClipView">clip view</a></code>, <code><a href="../sr5_control_suite/sr_control.html#//apple_ref/doc/uid/20011219-ASKControlViewSuite.Classes.NSColorWell">color well</a></code>, <code><a href="../sr5_control_suite/sr_control.html#//apple_ref/doc/uid/20011219-ASKControlViewSuite.Classes.NSComboBox">combo box</a></code> <code><a href="../sr5_control_suite/sr_control.html#//apple_ref/doc/uid/20011219-ASKControlViewSuite.Classes.NSControl">control</a></code>,<code><a href="../sr5_control_suite/sr_control.html#//apple_ref/doc/uid/20011219-ASKControlViewSuite.Classes.NSImageView">image view</a></code>, <code><a href="../sr5_control_suite/sr_control.html#//apple_ref/doc/uid/20011219-ASKControlViewSuite.Classes.NSMatrix">matrix</a></code>, <code><a href="../sr5_control_suite/sr_control.html#//apple_ref/doc/uid/20011219-ASKControlViewSuite.Classes.NSMovieView">movie view</a></code>, <code><a href="../sr5_control_suite/sr_control.html#//apple_ref/doc/uid/20011219-ASKControlViewSuite.Classes.NSPopUpButton">popup button</a></code>, <code><a href="../sr5_control_suite/sr_control.html#//apple_ref/doc/uid/20011219-ASKControlViewSuite.Classes.NSProgressIndicator">progress indicator</a></code>, <code><a href="../sr4_container_suite/sr_container.html#//apple_ref/doc/uid/20011218-ASKContainerViewSuite.Classes.NSScrollView">scroll view</a></code>, <code><a href="../sr5_control_suite/sr_control.html#//apple_ref/doc/uid/20011219-ASKControlViewSuite.Classes.NSSlider">slider</a></code>, <code><a href="../sr5_control_suite/sr_control.html#//apple_ref/doc/uid/20011219-ASKControlViewSuite.Classes.NSStepper">stepper</a></code>, <code><a href="../sr4_container_suite/sr_container.html#//apple_ref/doc/uid/20011218-ASKContainerViewSuite.Classes.NSTabView">tab view</a></code>, <code><a href="../sr5_control_suite/sr_control.html#//apple_ref/doc/uid/20011219-ASKControlViewSuite.Classes.NSTextField">text field</a></code>, <code><a href="../sr11_textview_suite/sr_text_view.html#//apple_ref/doc/uid/20011225-ASKTextViewSuite.Classes.NSTextView">text view</a></code>, and <code><a href="../sr4_container_suite/sr_container.html#//apple_ref/doc/uid/20011218-ASKContainerViewSuite.Classes.NSView">view</a></code>.</p>
<p>For an object to respond to any of the drag-and-drop event handlers (described in <span class="content_text"><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands">“Events”</a></span>), you must register the drag types that the object can accept. You do this with the <code><a href="../sr3_app_suite/sr_app.html#//apple_ref/doc/uid/20011217-BAJEJCIB">register</a></code> command, using its <code>drag
type</code> parameter to supply a list of the supported pasteboard drag types. Possible pasteboard types are listed with the <code><a href="../sr3_app_suite/sr_app.html#//apple_ref/doc/uid/20011217-BAJFJJEF">pasteboard</a></code> class.</p>
<p>The <code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.Drop">drop</a></code> event handler is the only required handler for supporting dropped data in AppleScript Studio. However, see the <code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.ConcludeDrop">conclude drop</a></code> handler for information on providing drag and drop for <code><a href="../sr11_textview_suite/sr_text_view.html#//apple_ref/doc/uid/20011225-ASKTextViewSuite.Classes.NSTextView">text view</a></code> and <code><a href="../sr5_control_suite/sr_control.html#//apple_ref/doc/uid/20011219-ASKControlViewSuite.Classes.NSTextField">text field</a></code> objects.</p>

<a name="//apple_ref/doc/uid/20011222-BAJJBGIA" title="Terminology"></a>
<h1>Terminology</h1><a name="//apple_ref/doc/uid/20011222-DontLinkElementID_1943"></a>
<p>The classes and events in the Drag and Drop suite are described in the following sections:</p>
<ul class="simple"><li><p><span class="content_text"><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-BAJGIABG">“Classes”</a></span></p></li>
<li><p><span class="content_text"><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands">“Events”</a></span></p></li></ul>
<p>For enumerated constants, see <span class="content_text"><a href="../sr3_app_suite/sr_app.html#//apple_ref/doc/uid/20011217-ASKApplicationSuite.Enumerations">“Enumerations.”</a></span></p>
<a name="//apple_ref/doc/uid/20011222-BAJGIABG" title="Classes"></a><h2>Classes</h2>
<p>The Drag and Drop suite contains the following class:</p>
<ul class="simple"><li><p><code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-BAJDCEDJ">drag info</a></code></p></li></ul>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_1944"></a><span class="content_text"><a name="//apple_ref/doc/uid/20011222-BAJDCEDJ" title="drag info"></a><div class="code_head">drag info</div>
<div class="content_text"><blockquote><a name="//apple_ref/doc/uid/20011222-DontLinkElementID_807" title="Plural"></a><strong>Plural: </strong><code>drag infos</code></blockquote>
<blockquote><strong>Inherits from: </strong><code><a href="../sr3_app_suite/sr_app.html#//apple_ref/doc/uid/20011217-ASKApplicationSuite.Classes.AbstractObject">item</a></code></blockquote>
<blockquote><a name="//apple_ref/doc/uid/20011222-DontLinkElementID_808" title="Cocoa Class"></a><strong>Cocoa Class: </strong>ASKDragInfo</blockquote></div>
<div class="content_text"><p>Represents information and data for the current drag operation.</p>
<p>A <code>drag info</code> object is passed to each of the drag-and-drop event handlers described in <span class="content_text"><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands">“Events.”</a></span></p>
<p>The most useful property of the <code>drag
info</code> class is the <code><a href="../sr3_app_suite/sr_app.html#//apple_ref/doc/uid/20011217-BAJFJJEF">pasteboard</a></code> property. It contains the data for the drag, which your application can extract and use in the <code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.Drop">drop</a></code> or other event handlers.</p></div>
<a name="//apple_ref/doc/uid/20011222-TPXREF626" title="Properties of drag info objects"></a><h5><a name="//apple_ref/doc/uid/20011222-448395" title="Properties of drag info objects"></a>Properties of drag info objects</h5>
<p>In addition to the properties it inherits from the <code><a href="../sr3_app_suite/sr_app.html#//apple_ref/doc/uid/20011217-ASKApplicationSuite.Classes.AbstractObject">item</a></code> class, a drag info object has these properties:</p>
<table border="0" cellpadding="0" cellspacing="1" width="100%"><a name="//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Classes.ASKDragInfo.Properties.draggingDestinationWindow"></a>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_1945"></a><tr><td valign="bottom" height="30" colspan="5" scope="row"><code>destination window </code></td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="top" height="10" width="65" class="content_text">Access:</td><td valign="top" height="10" class="content_text" colspan="3">read only</td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="top" height="10" width="65" class="content_text">Class:</td><td valign="top" height="10" class="content_text" colspan="3"><code><a href="../sr3_app_suite/sr_app.html#//apple_ref/doc/uid/20011217-ASKApplicationSuite.Classes.NSWindow">window</a></code></td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="bottom" height="20" colspan="4" class="content_text">the destination window for the dragging operation</td></tr>
<a name="//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Classes.ASKDragInfo.Properties.draggedImage"></a>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_1946"></a><tr><td valign="bottom" height="30" colspan="5" scope="row"><code>image </code></td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="top" height="10" width="65" class="content_text">Access:</td><td valign="top" height="10" class="content_text" colspan="3">read only</td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="top" height="10" width="65" class="content_text">Class:</td><td valign="top" height="10" class="content_text" colspan="3"><em>anything</em></td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="bottom" height="20" colspan="4" class="content_text">the image being dragged</td></tr>
<a name="//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Classes.ASKDragInfo.Properties.draggedImageLocation"></a>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_1947"></a><tr><td valign="bottom" height="30" colspan="5" scope="row"><code>image location </code></td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="top" height="10" width="65" class="content_text">Access:</td><td valign="top" height="10" class="content_text" colspan="3">read only</td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="top" height="10" width="65" class="content_text">Class:</td><td valign="top" height="10" class="content_text" colspan="3"><em>point</em></td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="bottom" height="20" colspan="4" class="content_text">not supported (through AppleScript Studio version 1.4); the location of the image being dragged; the location is returned as a two-item list of numbers <code>{left, bottom}</code>; see the <code>bounds</code> property of the <code><a href="../sr3_app_suite/sr_app.html#//apple_ref/doc/uid/20011217-ASKApplicationSuite.Classes.NSWindow">window</a></code> class for information on the coordinate system; for changes introduced in AppleScript Studio version 1.4, see the main discussion for the <code><a href="../sr3_app_suite/sr_app.html#//apple_ref/doc/uid/20011217-ASKApplicationSuite.Classes.NSApplication">application</a></code> class, as well as the <code><a href="../sr3_app_suite/sr_app.html#//apple_ref/doc/uid/20011217-ASKApplicationSuite.Classes.NSApplication.Properties.colorPanel_ask">coordinate system</a></code> property of that class</td></tr>
<a name="//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Classes.ASKDragInfo.Properties.draggingLocation"></a>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_1948"></a><tr><td valign="bottom" height="30" colspan="5" scope="row"><code>location </code></td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="top" height="10" width="65" class="content_text">Access:</td><td valign="top" height="10" class="content_text" colspan="3">read only</td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="top" height="10" width="65" class="content_text">Class:</td><td valign="top" height="10" class="content_text" colspan="3"><em>point</em></td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="bottom" height="20" colspan="4" class="content_text">not supported (through AppleScript Studio version 1.4); the current location in the destination window for the dragging operation, as a two-item list of numbers <code>{left, bottom}</code>; each window has its own coordinate system, with the origin in the lower left corner; see the <code>bounds</code> property of the <code><a href="../sr3_app_suite/sr_app.html#//apple_ref/doc/uid/20011217-ASKApplicationSuite.Classes.NSWindow">window</a></code> class for more information on the coordinate system; for changes introduced in AppleScript Studio version 1.4, see the main discussion for the <code><a href="../sr3_app_suite/sr_app.html#//apple_ref/doc/uid/20011217-ASKApplicationSuite.Classes.NSApplication">application</a></code> class, as well as the <code><a href="../sr3_app_suite/sr_app.html#//apple_ref/doc/uid/20011217-ASKApplicationSuite.Classes.NSApplication.Properties.colorPanel_ask">coordinate system</a></code> property of that class</td></tr>
<a name="//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Classes.ASKDragInfo.Properties.draggingPasteboard"></a>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_1949"></a><tr><td valign="bottom" height="30" colspan="5" scope="row"><code>pasteboard </code></td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="top" height="10" width="65" class="content_text">Access:</td><td valign="top" height="10" class="content_text" colspan="3">read only</td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="top" height="10" width="65" class="content_text">Class:</td><td valign="top" height="10" class="content_text" colspan="3"><code><a href="../sr3_app_suite/sr_app.html#//apple_ref/doc/uid/20011217-BAJFJJEF">pasteboard</a></code></td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="bottom" height="20" colspan="4" class="content_text">the pasteboard that contains the drag data</td></tr>
<a name="//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Classes.ASKDragInfo.Properties.draggingSequenceNumber"></a>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_1950"></a><tr><td valign="bottom" height="30" colspan="5" scope="row"><code>sequence number </code></td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="top" height="10" width="65" class="content_text">Access:</td><td valign="top" height="10" class="content_text" colspan="3">read only</td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="top" height="10" width="65" class="content_text">Class:</td><td valign="top" height="10" class="content_text" colspan="3"><em>integer</em></td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="bottom" height="20" colspan="4" class="content_text">not supported (through AppleScript Studio version 1.4); the unique identifier for the dragging operation</td></tr>
<a name="//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Classes.ASKDragInfo.Properties.draggingSource"></a>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_1951"></a><tr><td valign="bottom" height="30" colspan="5" scope="row"><code>source </code></td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="top" height="10" width="65" class="content_text">Access:</td><td valign="top" height="10" class="content_text" colspan="3">read only</td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="top" height="10" width="65" class="content_text">Class:</td><td valign="top" height="10" class="content_text" colspan="3"><code><a href="../sr3_app_suite/sr_app.html#//apple_ref/doc/uid/20011217-ASKApplicationSuite.Classes.AbstractObject">item</a></code></td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="bottom" height="20" colspan="4" class="content_text">the source of the dragged data</td></tr>
<a name="//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Classes.ASKDragInfo.Properties.draggingSourceOperationMask"></a>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_1952"></a><tr><td valign="bottom" height="30" colspan="5" scope="row"><code>source mask </code></td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="top" height="10" width="65" class="content_text">Access:</td><td valign="top" height="10" class="content_text" colspan="3">read only</td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="top" height="10" width="65" class="content_text">Class:</td><td valign="top" height="10" class="content_text" colspan="3"><em>enumerated constant</em> from <span class="content_text"><a href="../sr3_app_suite/sr_app.html#//apple_ref/doc/uid/20011217-BBCHJBAI">Drag Operation</a></span></td></tr>
<tr><td width="10" scope="row">&nbsp;</td><td valign="bottom" height="20" colspan="4" class="content_text">defines the type of drag; not supported until AppleScript Studio version 1.4 </td></tr></table><br/><br/>
<a name="//apple_ref/doc/uid/20011222-TPXREF629" title="Events supported by drag info objects"></a><h5><a name="//apple_ref/doc/uid/20011222-448753" title="Events supported by drag info objects"></a>Events supported by drag info objects</h5>
<p>This class is not accessible in Interface Builder, and you cannot connect any event handlers to it.</p>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_809" title="Examples"></a><h5>Examples</h5>

<p>The following example shows one way to examine a <code>drag
info</code> object in a <code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.Drop">drop</a></code> event handler. This handler returns <code>false</code>, canceling the drop, if the pasteboard of the drag info does not contain the “string” type. If it does contain that type, the handler uses the string data from the pasteboard to set the title of the object the data was dropped on and returns <code>true</code> to complete the drop operation.</p>
<div class="codesample"><table><tr><td scope="row"><pre>on drop theObject drag info dragInfo<span></span></pre></td></tr><tr><td scope="row"><pre>    set dropped to false<span></span></pre></td></tr><tr><td scope="row"><pre>    if "string" is in types of pasteboard of dragInfo  then<span></span></pre></td></tr><tr><td scope="row"><pre>        set title of theObject to contents of pasteboard of dragInfo<span></span></pre></td></tr><tr><td scope="row"><pre>        set dropped to true<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>    return dropped<span></span></pre></td></tr><tr><td scope="row"><pre>end drop<span></span></pre></td></tr></table></div>
<h5 class="tight">Version Notes</h5>
<p>The <code>image location</code>, <code>location</code>, <code>sequence
number</code>, and <code>source mask</code> properties in this class are not supported, through AppleScript Studio version 1.4.</p>
<p>The <code>drag info</code> class was added in AppleScript Studio version 1.2.</p></span>
<a name="//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands" title="Events"></a><h2>Events</h2>
<p>Objects in the Drag and Drop Suite support the following events (an event is an action, typically generated through interaction with an application’s user interface, that causes a handler for the appropriate object to be executed). To determine which classes support which commands, see the individual class descriptions.</p>
<ul class="ul"><li class="li"><p><code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.ConcludeDrop">conclude drop</a></code></p></li>
<li class="li"><p><code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.Drag">drag</a></code></p></li>
<li class="li"><p><code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.DragEntered">drag entered</a></code></p></li>
<li class="li"><p><code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.DragExited">drag exited</a></code></p></li>
<li class="li"><p><code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.DragUpdated">drag updated</a></code></p></li>
<li class="li"><p><code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.Drop">drop</a></code></p></li>
<li class="li"><p><code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.PrepareDrop">prepare drop</a></code></p></li></ul>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_1953"></a><div class="content_text"><a name="//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.ConcludeDrop" title="conclude drop"></a>
<div class="code_head">conclude drop</div>
<p>Called to complete a successful drop operation.</p>
<p>This handler is only called if both the <code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.PrepareDrop">prepare drop</a></code> and <code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.Drop">drop</a></code> event handlers were successful. You can use this handler, for example, to clean up any state that was set or changed in the <code>prepare drop</code> handler.</p>
<p>The <code>drop</code> handler is the only required handler for supporting dropped data in AppleScript Studio.</p>
<p>Both the <code><a href="../sr11_textview_suite/sr_text_view.html#//apple_ref/doc/uid/20011225-ASKTextViewSuite.Classes.NSTextView">text view</a></code> and <code><a href="../sr5_control_suite/sr_control.html#//apple_ref/doc/uid/20011219-ASKControlViewSuite.Classes.NSTextField">text field</a></code> classes have built-in support for dropped text, provided automatically by the Cocoa classes they are based on (<code><a href="../../../../Cocoa/Reference/ApplicationKit/Classes/NSTextView_Class/Reference/Reference.html#//apple_ref/occ/cl/NSTextView" target="_top">NSTextView</a></code> and <code><a href="../../../../Cocoa/Reference/ApplicationKit/Classes/NSTextField_Class/Reference/Reference.html#//apple_ref/occ/cl/NSTextField" target="_top">NSTextField</a></code>). If that’s all the support for dropped text your application needs for objects of these types, you don’t need to do anything extra. However, an application that wants to handle data that is dropped on a text view or a text field, and not allow the default support to handle it, should take these steps:</p>
<ul class="ul"><li class="li"><p>register the drag types the text view or text field can handle; see the <code><a href="../sr3_app_suite/sr_app.html#//apple_ref/doc/uid/20011217-BAJEJCIB">register</a></code> command for details</p></li>
<li class="li"><p>connect a <code>drop</code> handler to handle dropped text for the text view or text field</p></li>
<li class="li"><p>connect an empty <code>conclude drop</code> handler for the text view or text field; this will prevent the text objects from providing their own support for dropped text</p></li></ul>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_810" title="Syntax"></a><h5>Syntax</h5><table border="0"  cellpadding="3" cellspacing="1">


<tr>
<td valign="top" height="10" width="200" colspan="2" scope="row"><a name="//apple_ref/doc/uid/20011222-DontLinkElementID_811" title="conclude drop"></a><code>conclude drop</code></td>
<td valign="top" height="10" width="90"><em>reference</em></td>
<td valign="top" height="10" width="90"  class="content_text"><span class="content_text">required</span></td>
</tr>
<tr>
<td width="20" class="content_text" scope="row">&nbsp;</td><td valign="top" height="10" width="180" class="content_text"><code>drag info</code></td>
<td valign="top" height="10" width="90"><em>drag info</em></td>
<td valign="top" height="10" width="90"  class="content_text"><span class="content_text">required</span></td>
</tr>

</table>
<h5 class="tight">Parameters</h5><dl class="termdef">

<tr><td valign="bottom" height="30" colspan="5" scope="row"><em>reference</em></td></tr>
<dd><p>a reference to the object whose <code>conclude
drop</code> handler is called</p></dd>
<tr><td valign="bottom" height="30" colspan="5" scope="row"><code>drag info</code>&nbsp; <em><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-BAJDCEDJ">drag info</a></em></td></tr>
<dd><p>the information about the drag operation</p></dd></dl>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_812" title="Examples"></a><h5>Examples</h5>
<p>When you connect a <code>conclude drop</code> handler to an object in Interface Builder, AppleScript Studio supplies an empty handler template. Your handler can take any necessary steps to deal with the conclusion of the drop that it didn’t take care of in its <code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.Drop">drop</a></code> handler. For example, the handler might clean up any state that was set or changed in the <code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.PrepareDrop">prepare drop</a></code> handler.</p>
<div class="codesample"><table><tr><td scope="row"><pre>on conclude drop theObject drag info dragInfo<span></span></pre></td></tr><tr><td scope="row"><pre>    (* Statements to deal with the concluded drop. *)<span></span></pre></td></tr><tr><td scope="row"><pre>end conclude drop<span></span></pre></td></tr></table></div>
<p>See also the description above for this class.</p>
<h5 class="tight">Version Notes</h5>
<p>The <code>conclude drop</code> event handler was added in AppleScript Studio version 1.2.</p></div>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_1954"></a><div class="content_text"><a name="//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.Drag" title="drag"></a><div class="code_head">drag</div>
<p>Not supported (through AppleScript Studio version 1.4).</p>
<p>Support for this event handler is planned for a later version of AppleScript Studio.</p>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_813" title="Syntax"></a><h5>Syntax</h5><table border="0"  cellpadding="3" cellspacing="1">

<tr>
<td valign="top" height="10" width="200" colspan="2" scope="row"><a name="//apple_ref/doc/uid/20011222-DontLinkElementID_814" title="drag"></a><code>drag</code></td>
<td valign="top" height="10" width="90"><em>reference</em></td>
<td valign="top" height="10" width="90"  class="content_text"><span class="content_text">required</span></td>
</tr>
<tr>
<td width="20" class="content_text" scope="row">&nbsp;</td><td valign="top" height="10" width="180" class="content_text"><code>drag info</code></td>
<td valign="top" height="10" width="90"><em>drag info</em></td>
<td valign="top" height="10" width="90"  class="content_text"><span class="content_text">required</span></td>
</tr>

</table>
<h5 class="tight">Parameters</h5><dl class="termdef">
<tr><td valign="bottom" height="30" colspan="5" scope="row"><em>reference</em></td></tr>
<dd><p>a reference to the object whose <code>drag</code> handler is called</p></dd>
<tr><td valign="bottom" height="30" colspan="5" scope="row"><code>drag info</code>&nbsp; <em><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-BAJDCEDJ">drag info</a></em></td></tr>
<dd><p>the information about the drag operation</p></dd></dl>
<h5 class="tight">Version Notes</h5>
<p>The <code>drag</code> event handler was added in AppleScript Studio version 1.2, although it does nothing in that version.</p></div>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_1955"></a><div class="content_text"><a name="//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.DragEntered" title="drag entered"></a>
<div class="code_head">drag entered</div>
<p>Called when a user drags the registered type of data into the bounds of the object.</p>
<p>Your application may not need a <code>drag
entered</code> handler, as the <code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.Drop">drop</a></code> handler is the only required handler for supporting dropped data in AppleScript Studio.</p>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_815" title="Syntax"></a><h5>Syntax</h5><table border="0"  cellpadding="3" cellspacing="1">

<tr>
<td valign="top" height="10" width="200" colspan="2" scope="row"><a name="//apple_ref/doc/uid/20011222-DontLinkElementID_816" title="drag entered"></a><code>drag entered</code></td>
<td valign="top" height="10" width="90"><em>reference</em></td>
<td valign="top" height="10" width="90"  class="content_text"><span class="content_text">required</span></td>
</tr>
<tr>
<td width="20" class="content_text" scope="row">&nbsp;</td><td valign="top" height="10" width="180" class="content_text"><code>drag info</code></td>
<td valign="top" height="10" width="90"><em>drag info</em></td>
<td valign="top" height="10" width="90"  class="content_text"><span class="content_text">required</span></td>
</tr>

</table>
<h5 class="tight">Parameters</h5><dl class="termdef">
<tr><td valign="bottom" height="30" colspan="5" scope="row"><em>reference</em></td></tr>
<dd><p>a reference to the object whose <code>drag
entered</code> handler is called</p></dd>
<tr><td valign="bottom" height="30" colspan="5" scope="row"><code>drag info</code>&nbsp; <em><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-BAJDCEDJ">drag info</a></em></td></tr>
<dd><p>the information about the drag operation</p></dd></dl>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_817" title="Examples"></a><h5>Examples</h5>
<p>When you connect a <code>drag entered</code> handler to an object in Interface Builder, AppleScript Studio supplies an empty handler template. The <code>theObject</code> parameter refers to the object for which a potential drag has entered the object’s bounds. The <code>dragInfo</code> parameter provides access to a <code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-BAJDCEDJ">drag info</a></code> object that contains all pertinent information for the drag operation. Your handler can take any necessary steps, such as providing visual feedback that it can accept information from the drag.</p>
<div class="codesample"><table><tr><td scope="row"><pre>on drag entered theObject drag info dragInfo<span></span></pre></td></tr><tr><td scope="row"><pre>    (* Statements to deal with the drag entering. *)<span></span></pre></td></tr><tr><td scope="row"><pre>end drag entered<span></span></pre></td></tr></table></div>
<h5 class="tight">Version Notes</h5>
<p>The <code>drag entered</code> event handler was added in AppleScript Studio version 1.2.</p></div>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_1956"></a><div class="content_text"><a name="//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.DragExited" title="drag exited"></a>
<div class="code_head">drag exited</div>
<p>Called when a user drags the registered type of data out of the bounds of the object.</p>
<p>Your application may not need a <code>drag
exited</code> handler, as the <code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.Drop">drop</a></code> handler is the only required handler for supporting dropped data in AppleScript Studio.</p>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_818" title="Syntax"></a><h5>Syntax</h5><table border="0"  cellpadding="3" cellspacing="1">

<tr>
<td valign="top" height="10" width="200" colspan="2" scope="row"><a name="//apple_ref/doc/uid/20011222-DontLinkElementID_819" title="drag exited"></a><code>drag exited</code></td>
<td valign="top" height="10" width="90"><em>reference</em></td>
<td valign="top" height="10" width="90"  class="content_text"><span class="content_text">required</span></td>
</tr>
<tr>
<td width="20" class="content_text" scope="row">&nbsp;</td><td valign="top" height="10" width="180" class="content_text"><code>drag info</code></td>
<td valign="top" height="10" width="90"><em>drag info</em></td>
<td valign="top" height="10" width="90"  class="content_text"><span class="content_text">required</span></td>
</tr>

</table>
<h5 class="tight">Parameters</h5><dl class="termdef">
<tr><td valign="bottom" height="30" colspan="5" scope="row"><em>reference</em></td></tr>
<dd><p>a reference to the object whose <code>drag
exited</code> handler is called</p></dd>
<tr><td valign="bottom" height="30" colspan="5" scope="row"><code>drag info</code>&nbsp; <em><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-BAJDCEDJ">drag info</a></em></td></tr>
<dd><p>the information about the drag operation</p></dd></dl>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_820" title="Examples"></a><h5>Examples</h5>
<p>When you connect a <code>drag exited</code> handler to an object in Interface Builder, AppleScript Studio supplies an empty handler template. The <code>theObject</code> parameter refers to the object for which a potential drag has exited the object’s bounds. The <code>dragInfo</code> parameter provides access to a <code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-BAJDCEDJ">drag info</a></code> object that contains all pertinent information for the drag operation. Your handler can take any necessary steps, such as providing visual feedback that it is no longer waiting to accept information from the drag.</p>
<div class="codesample"><table><tr><td scope="row"><pre>on drag exited theObject drag info dragInfo<span></span></pre></td></tr><tr><td scope="row"><pre>    (* Statements to deal with the drag exiting. *)<span></span></pre></td></tr><tr><td scope="row"><pre>end drag exited<span></span></pre></td></tr></table></div>
<h5 class="tight">Version Notes</h5>
<p>The <code>drag exited</code> event handler was added in AppleScript Studio version 1.2.</p></div>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_1957"></a><div class="content_text"><a name="//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.DragUpdated" title="drag updated"></a>
<div class="code_head">drag updated</div>
<p>Called when a user moves a registered drag type within the bounds of the object.</p>
<p>Your application may not need a <code>drag
updated</code> handler, as the <code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.Drop">drop</a></code> handler is the only required handler for supporting dropped data in AppleScript Studio.</p>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_821" title="Syntax"></a><h5>Syntax</h5><table border="0"  cellpadding="3" cellspacing="1">

<tr>
<td valign="top" height="10" width="200" colspan="2" scope="row"><a name="//apple_ref/doc/uid/20011222-DontLinkElementID_822" title="drag updated"></a><code>drag updated</code></td>
<td valign="top" height="10" width="90"><em>reference</em></td>
<td valign="top" height="10" width="90"  class="content_text"><span class="content_text">required</span></td>
</tr>
<tr>
<td width="20" class="content_text" scope="row">&nbsp;</td><td valign="top" height="10" width="180" class="content_text"><code>drag info</code></td>
<td valign="top" height="10" width="90"><em>drag info</em></td>
<td valign="top" height="10" width="90"  class="content_text"><span class="content_text">required</span></td>
</tr>

</table>
<h5 class="tight">Parameters</h5><dl class="termdef">
<tr><td valign="bottom" height="30" colspan="5" scope="row"><em>reference</em></td></tr>
<dd><p>a reference to the object whose <code>drag
updated</code> handler is called</p></dd>
<tr><td valign="bottom" height="30" colspan="5" scope="row"><code>drag info</code>&nbsp; <em><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-BAJDCEDJ">drag info</a></em></td></tr>
<dd><p>the information about the drag operation</p></dd></dl>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_823" title="Examples"></a><h5>Examples</h5>
<p>When you connect a <code>drag updated</code> handler to an object in Interface Builder, AppleScript Studio supplies an empty handler template. The <code>theObject</code> parameter refers to the object in whose bounds a drag with a registered type has moved. The <code>dragInfo</code> parameter provides access to a <code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-BAJDCEDJ">drag info</a></code> object that contains all pertinent information for the drag operation. Your handler can take any necessary steps, such as providing visual feedback as to where the drag data might be inserted. Note however, that through AppleScript Studio version 1.3, you cannot access the <code>location</code> property of a <code>drag info</code> object, so the ability to determine an insertion point is limited.</p>
<div class="codesample"><table><tr><td scope="row"><pre>on drag updated theObject drag info dragInfo<span></span></pre></td></tr><tr><td scope="row"><pre>    (* Statements to deal with the drag updating. *)<span></span></pre></td></tr><tr><td scope="row"><pre>end drag updated<span></span></pre></td></tr></table></div>
<h5 class="tight">Version Notes</h5>
<p>The <code>drag updated</code> event handler was added in AppleScript Studio version 1.2.</p></div>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_1958"></a><div class="content_text"><a name="//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.Drop" title="drop"></a><div class="code_head">drop</div>
<p>Called when a user has dropped data with a registered data type onto an object.</p>
<p>You return <code>false</code> from this event handler to cancel the drop operation; otherwise you must return <code>true</code> to signal success for the drop operation.</p>
<p>You can examine the <code><a href="../sr3_app_suite/sr_app.html#//apple_ref/doc/uid/20011217-BAJFJJEF">pasteboard</a></code> property of the <code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-BAJDCEDJ">drag info</a></code> parameter to obtain the data for the drop in the requested format. If you use the <code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.PrepareDrop">prepare drop</a></code> handler to verify that the data you need is present, you will know that data is available when the <code>drop</code> handler is called.</p>
<p>The <code>drop</code> handler is the only required handler for supporting dropped data in AppleScript Studio. However, see the <code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.ConcludeDrop">conclude drop</a></code> event handler for information on providing drag and drop for <code><a href="../sr11_textview_suite/sr_text_view.html#//apple_ref/doc/uid/20011225-ASKTextViewSuite.Classes.NSTextView">text view</a></code> and <code><a href="../sr5_control_suite/sr_control.html#//apple_ref/doc/uid/20011219-ASKControlViewSuite.Classes.NSTextField">text field</a></code> objects.</p>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_824" title="Syntax"></a><h5>Syntax</h5><table border="0"  cellpadding="3" cellspacing="1">

<tr>
<td valign="top" height="10" width="200" colspan="2" scope="row"><a name="//apple_ref/doc/uid/20011222-DontLinkElementID_825" title="drop"></a><code>drop</code></td>
<td valign="top" height="10" width="90"><em>reference</em></td>
<td valign="top" height="10" width="90"  class="content_text"><span class="content_text">required</span></td>
</tr>
<tr>
<td width="20" class="content_text" scope="row">&nbsp;</td><td valign="top" height="10" width="180" class="content_text"><code>drag info</code></td>
<td valign="top" height="10" width="90"><em>drag info</em></td>
<td valign="top" height="10" width="90"  class="content_text"><span class="content_text">required</span></td>
</tr>

</table>
<h5 class="tight">Parameters</h5><dl class="termdef">
<tr><td valign="bottom" height="30" colspan="5" scope="row"><em>reference</em></td></tr>
<dd><p>a reference to the object whose handler is called to receive the dropped data</p></dd>
<tr><td valign="bottom" height="30" colspan="5" scope="row"><code>drag info</code>&nbsp; <em><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-BAJDCEDJ">drag info</a></em></td></tr>
<dd><p>the information about the drag operation</p></dd></dl>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_826" title="Examples"></a><h5>Examples</h5>
<p>The Drag and Drop sample application (distributed with AppleScript Studio, starting with version 1.2) demonstrates how various objects can accept dragged data. The following <code>drop</code> handler, from the file <code>Text.applescript</code> in that application, shows how to accept dragged text data in a <code><a href="../sr5_control_suite/sr_control.html#//apple_ref/doc/uid/20011219-ASKControlViewSuite.Classes.NSTextField">text field</a></code>.</p>
<p>The <code>drop</code> event handler is called when the appropriate type of data is dropped onto the object. All of the pertinent information about the drop is contained in the <code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-BAJDCEDJ">drag info</a></code> object (passed in the <code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-BAJDCEDJ">drag info</a></code> parameter). In this case, the handler just checks the <code><a href="../sr3_app_suite/sr_app.html#//apple_ref/doc/uid/20011217-BAJFJJEF">pasteboard</a></code> of the <code>drag
info</code> object for the “string” data type. If it is present, the handler uses it to set the contents of the passed text field (from the <code>theObject</code> parameter).</p>
<div class="codesample"><table><tr><td scope="row"><pre>on drop theObject drag info dragInfo<span></span></pre></td></tr><tr><td scope="row"><pre>    -- We are only interested in the "string" data type<span></span></pre></td></tr><tr><td scope="row"><pre>        -- If that type is present, set the contents of the text<span></span></pre></td></tr><tr><td scope="row"><pre>        --  field to the contents of the pasteboard<span></span></pre></td></tr><tr><td scope="row"><pre>    if "string" is in types of pasteboard of dragInfo  then<span></span></pre></td></tr><tr><td scope="row"><pre>        set string value of theObject to contents of pasteboard  of dragInfo<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    return true<span></span></pre></td></tr><tr><td scope="row"><pre>end drop<span></span></pre></td></tr></table></div>
<p>By default, the <code>preferred type</code> property for a pasteboard is “string”, which is why the handler above doesn’t set the preferred type. To explicitly set the preferred type of a pasteboard (in this example, the “general” pasteboard) to “string” before getting data from the pasteboard, you could use the following statements:</p>
<div class="codesample"><table><tr><td scope="row"><pre>set preferred type of pasteboard "general" to "string"<span></span></pre></td></tr><tr><td scope="row"><pre>if "string" is in types of pasteboard "general"  then<span></span></pre></td></tr><tr><td scope="row"><pre>    set myString to contents of pasteboard "general"<span></span></pre></td></tr></table></div>
<h5 class="tight">Version Notes</h5>
<p>The <code>drop</code> event handler was added in AppleScript Studio version 1.2.</p></div>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_1959"></a><div class="content_text"><a name="//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.PrepareDrop" title="prepare drop"></a>
<div class="code_head">prepare drop</div>
<p>Called when a user has dropped the dragged data onto the object.</p>
<p>You return <code>false</code> from this event handler to cancel the drop operation; otherwise you must return <code>true</code> to continue the drop operation.</p>
<p>You can examine the <code><a href="../sr3_app_suite/sr_app.html#//apple_ref/doc/uid/20011217-BAJFJJEF">pasteboard</a></code> property of the <code>drag
info</code> parameter to determine, for example, whether it contains data in the format you want.</p>
<p>Your application may not need a <code>prepare
drop</code> handler, as the <code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-ASKDragAndDropSuite.Commands.Drop">drop</a></code> handler is the only required handler for supporting dropped data in AppleScript Studio.</p>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_827" title="Syntax"></a><h5>Syntax</h5><table border="0"  cellpadding="3" cellspacing="1">

<tr>
<td valign="top" height="10" width="200" colspan="2" scope="row"><a name="//apple_ref/doc/uid/20011222-DontLinkElementID_828" title="prepare drop"></a><code>prepare drop</code></td>
<td valign="top" height="10" width="90"><em>reference</em></td>
<td valign="top" height="10" width="90"  class="content_text"><span class="content_text">required</span></td>
</tr>
<tr>
<td width="20" class="content_text" scope="row">&nbsp;</td><td valign="top" height="10" width="180" class="content_text"><code>drag info</code></td>
<td valign="top" height="10" width="90"><em>drag info</em></td>
<td valign="top" height="10" width="90"  class="content_text"><span class="content_text">required</span></td>
</tr>

</table>
<h5 class="tight">Parameters</h5><dl class="termdef">
<tr><td valign="bottom" height="30" colspan="5" scope="row"><em>reference</em></td></tr>
<dd><p>a reference to the object whose handler is called</p></dd>
<tr><td valign="bottom" height="30" colspan="5" scope="row"><code>drag info</code>&nbsp; <em><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-BAJDCEDJ">drag info</a></em></td></tr>
<dd><p>the information about the drag operation</p></dd></dl>
<a name="//apple_ref/doc/uid/20011222-DontLinkElementID_829" title="Examples"></a><h5>Examples</h5>
<p>When you connect a <code>prepare drop</code> handler to an object in Interface Builder, AppleScript Studio supplies an empty handler template. The <code>theObject</code> parameter refers to the object for which a drop is about to take place. The <code>dragInfo</code> parameter provides access to a <code><a href="sr_drag_drop.html#//apple_ref/doc/uid/20011222-BAJDCEDJ">drag info</a></code> object that contains all pertinent information for the drag operation. Your handler can do any necessary preparation, such as making sure the necessary data is present for the drop operation to take place. The handler should return <code>false</code> to cancel the drop operation or <code>true</code> to allow it.</p>
<div class="codesample"><table><tr><td scope="row"><pre>on prepare drop theObject drag info dragInfo<span></span></pre></td></tr><tr><td scope="row"><pre>    (* Statements to prepare for a drop.<span></span></pre></td></tr><tr><td scope="row"><pre>        In this example, only allow drop if string info available.  *)<span></span></pre></td></tr><tr><td scope="row"><pre>    if "string" is in types of pasteboard of dragInfo  then<span></span></pre></td></tr><tr><td scope="row"><pre>        return true<span></span></pre></td></tr><tr><td scope="row"><pre>    else<span></span></pre></td></tr><tr><td scope="row"><pre>        return false<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end prepare drop<span></span></pre></td></tr></table></div>
<h5 class="tight">Version Notes</h5>
<p>The <code>prepare drop</code> event handler was added in AppleScript Studio version 1.2.</p></div>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../sr7_doc_suite/sr_document.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../sr9_menu_suite/sr_menu.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-10-31<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleScript/Reference/StudioReference/sr8_drag_drop_suite/sr_drag_drop.html%3Fid%3DTP30000892-3.4&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleScript/Reference/StudioReference/sr8_drag_drop_suite/sr_drag_drop.html%3Fid%3DTP30000892-3.4&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleScript/Reference/StudioReference/sr8_drag_drop_suite/sr_drag_drop.html%3Fid%3DTP30000892-3.4&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>