#include <Files.h>#include <Devices.h>#include "GetDriveType.h"#define csGetDriveType 96typedef struct ADriveTypeRec {	QElemPtr		qLink;	short			qType;	short			ioTrap;	Ptr				ioCmdAddr;	IOCompletionUPP	ioCompletion;	OSErr			ioResult;	StringPtr		ioNamePtr;	short			ioVRefNum;	short			ioCRefNum;    short           csCode;    struct {            short int driveType;            short int csParam[10];	// 11 shorts total.    } csParam;} ADriveTypeRec;pascal  OSErr GetDriveType(short ioRefNum, short *Type) {   OSErr           osErr;   ADriveTypeRec   *pb;   pb = (ADriveTypeRec *) NewPtrClear(sizeof (*pb));   osErr = MemError();   if (0 != pb && noErr == osErr)    {       (*pb).ioCRefNum     = ioRefNum;       (*pb).ioVRefNum     = 1;		// always define; may have multiple drives       (*pb).ioCompletion  = nil;       (*pb).ioNamePtr     = nil;       (*pb).csCode        = csGetDriveType;       osErr = PBStatusSync((ParmBlkPtr)pb);	// status, not control call       if(osErr == noErr)         *Type = (*pb).csParam.driveType;       DisposPtr((Ptr) pb);   }   return osErr;}