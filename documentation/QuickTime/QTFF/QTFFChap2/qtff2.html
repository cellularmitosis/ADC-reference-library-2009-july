<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>QuickTime File Format Specification: Movie Atoms</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Movie Atoms"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40000939-CH204" title="Movie Atoms"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> &gt; <a href="../../../../reference/QuickTime/index.html#//apple_ref/doc/uid/TP30001281-TP30000433" target="_top">QuickTime</a> &gt; <a href="../../../../reference/QuickTime/idxFileFormatSpecification-date.html#//apple_ref/doc/uid/TP30001281-TP30000433-TP30000509" target="_top">File Format Specification</a> &gt; <a href="../QTFFPreface/qtffPreface.html#//apple_ref/doc/uid/TP40000939-CH202-TPXREF101">QuickTime File Format Specification</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../QTFFChap1/qtff1.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../QTFFChap3/qtff3.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40000939-CH204-SW1" title="Movie Atoms"></a><h1><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCDFCDD" title="Movie Atoms"></a>Movie Atoms</h1>
<p>This chapter provides a general introduction to QuickTime movie atoms, as well as specific details on the layout and usage of these atoms. Each atom type discussed in this chapter is shown with an accompanying illustration that contains offset information, followed by field descriptions.</p>
<p>This chapter is divided into the following major sections:</p>
<ul class="ul"><li class="li"><p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-55265">“Overview of Movie Atoms”</a></span> discusses QuickTime movie atoms, which act as containers for information that describes a movie’s data. A conceptual illustration is provided that shows the organization of a simple, one-track QuickTime movie. Profile atoms, color table atoms, and user data atoms are also discussed.</p></li>
<li class="li"><p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33299">“Track Atoms”</a></span> describes track atoms, which define a single track of a movie. Track profile atoms, track user data atoms, and hint tracks are also discussed.</p></li>
<li class="li"><p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33303">“Media Atoms”</a></span> discusses media atoms, which define a track’s movie data, such as the media type and media time scale.</p></li>
<li class="li"><p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33307">“Sample Atoms”</a></span> discusses sample table atoms, which specify where media samples are located, their duration, and so on. The section also includes examples of how you use these atoms. </p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_29" title="Note"></a><p><strong>Note:</strong>&nbsp;Media atoms and sample atoms do <em>not</em> contain actual sample data, such as video frames or audio samples. They contain metadata used to locate and interpret such samples.</p></div></li>
<li class="li"><p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33313">“Compressed Movie Resources”</a></span> discusses compressed movie resources, in which a lossless compression algorithm is used to compress the contents of the movie atom, including any track, media, or sample atoms. The contents must be decompressed before the movie atom can be parsed.</p></li>
<li class="li"><p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25756">“Reference Movies”</a></span> discusses movies that contain a reference movie atom (a list of references to alternate movies, as well as the criteria for selecting the correct movie from a list of alternates). Movie atoms that contain a reference movie atom do not necessarily contain track, media, or sample atoms.</p></li></ul>
<a name="//apple_ref/doc/uid/TP40000939-CH204-55265" title="Overview of Movie Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCGDJID" title="Overview of Movie Atoms"></a><h2>Overview of Movie Atoms</h2>
<p>QuickTime movie atoms have an atom type of <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_252"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_253"></a><code>'moov'</code>. These atoms act as a container for the information that describes a movie’s data. This information, or metadata, is stored in a number of different types of atoms. Generally speaking, only metadata is stored in a movie atom. Sample data for the movie, such as audio or video samples, are referenced in the movie atom, but are not contained in it.</p>
<p>The movie atom is essentially a container of other atoms. These atoms, taken together, describe the contents of a movie. At the highest level, movie atoms typically contain track atoms, which in turn contain media atoms. At the lowest level you find the leaf atoms, which contain non-atom data, usually in the form of a table or a set of data elements. For example, a track atom contains an edit atom, which in turn contains an <em>edit list atom</em>, a leaf atom which contains data in the form of an edit list table. All of these atoms are discussed later in this document.</p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-55900">Figure 2-1</a></span> provides a conceptual view of the organization of a simple, one-track QuickTime movie. Each nested box in the illustration represents an atom that belongs to its parent atom. The figure does not show the data regions of any of the atoms. These areas are described in the sections that follow.</p>
<p>Note that this figure shows the organization of a standard movie atom. It is possible to compress the movie metadata using a lossless compression algorithm. In such cases, the movie atom contains only a single child atom—the compressed movie atom (<code>'cmov'</code>). When this child atom is uncompressed, its contents conform to the structure shown in the following illustration. For details, see <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33313">“Compressed Movie Resources”</a></span></p>
<p>It is also possible to create a reference movie, a movie that refers to other movies; in this case the movie atom may contain only a reference movie atom (<code>'rmra'</code>). For details, see “Reference Movies”. Ultimately, the chain must end in either a standard movie atom, such as the one in the following illustration, or a compressed movie atom, which can be uncompressed to obtain the same structure.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-55900" title="Figure 2-1Sample organization of a one-track video movie"></a><p><strong>Figure 2-1&nbsp;&nbsp;</strong>Sample organization of a one-track video movie</p><img src = "../art/qtff_08.gif" alt = "Sample organization of a one-track video movie" width="548" height="737"></div><br/>
<a name="//apple_ref/doc/uid/TP40000939-CH204-55911" title="The Movie Atom"></a><h3>The Movie Atom</h3>
<p>You use movie atoms to specify the information that defines a movie—that is, the information that allows your application to interpret the sample data that is stored elsewhere. The movie atom may contain a movie profile atom, which summarizes the main features of the movie, such as the necessary codecs and maximum bitrate, and it usually contains a movie header atom, which defines the time scale and duration information for the entire movie, as well as its display characteristics. In addition, the movie atom contains a track atom for each track in the movie. </p>
<p>The movie atom has an atom type of <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_254"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_255"></a><code>'moov'</code>. It contains other types of atoms, including at least one of three possible atoms—the movie header atom (<code>'mvhd'</code>), the compressed movie atom (<code>'cmov'</code>), or a reference movie atom (<code>'rmra'</code>). An uncompressed movie atom can contain both a movie header atom and a reference movie atom, but it must contain at least one of the two. It can also contain several other atoms, such as a profile atom (<code>'prfl'</code>), clipping atom (<a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_256"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_257"></a><code>'clip'</code>), one or more track atoms (<a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_258"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_259"></a><code>'trak'</code>), a color table atom (<a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_260"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_261"></a><code>'ctab'</code>), and a user data atom (<a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_262"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_263"></a><code>'udta'</code>).</p>
<p>Compressed movie atoms and reference movie atoms are discussed separately. This section describes normal uncompressed movie atoms.</p>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_30" title="Note"></a><p><strong>Note:</strong>&nbsp;The movie profile atom is introduced in the <em>QuickTime File Format Specification</em> for 2004. </p></div>
<p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_264"></a><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-32943">Figure 2-2</a></span> shows the layout of a typical movie atom. </p>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_31" title="Note"></a><p><strong>Note:</strong>&nbsp;As previously mentioned, leaf atoms are shown as white boxes, while container atoms are shown as gray boxes.</p></div>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-32943" title="Figure 2-2The layout of a movie atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCHHGDG" title="Figure 2-2The layout of a movie atom"></a><p><strong>Figure 2-2&nbsp;&nbsp;</strong>The layout of a movie atom</p>
<img src = "../art/qtff_09.jpg" alt = "The layout of a movie atom" ></div><br/>
<p>A movie atom may contain the following fields:</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>The number of bytes in this movie atom.</p></dd>
<dt>Type</dt>
<dd><p>The type of this movie atom; this field must be set to <code>'moov'</code>.</p></dd>
<dt>Profile atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-54948">“The Movie Profile Atom”</a></span> for more information.</p></dd>
<dt>Movie header atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-56313">“Movie Header Atoms”</a></span> for more information.</p></dd>
<dt>Movie clipping atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25556">“Clipping Atoms”</a></span> for more information.</p></dd>
<dt>Track atoms</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33299">“Track Atoms”</a></span> for details on track atoms and their associated atoms.</p></dd>
<dt>User data atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25538">“User Data Atoms”</a></span> for more information about user data atoms.</p></dd>
<dt>Color table atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25533">“Color Table Atoms”</a></span> for a discussion of the color table atom.</p></dd>
<dt>Compressed movie atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33313">“Compressed Movie Resources”</a></span> for a discussion of compressed movie atoms.</p></dd>
<dt>Reference movie atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25756">“Reference Movies”</a></span> for a discussion of reference movie atoms.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-54948" title="The Movie Profile Atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCBDEFE" title="The Movie Profile Atom"></a><h3>The Movie Profile Atom</h3><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_265"></a>
<p>The movie profile atom summarizes the features and complexity of a movie, such as the required codecs and maximum bitrate, in order to help player applications or devices quickly determine whether they have the necessary resources to play the movie. </p>
<p>Features for a movie typically include the movie’s maximum video and audio bitrate, a list of audio and video codec types, the movie’s video dimensions, and any applicable MPEG-4 profiles and levels. This is all information that can also be obtained by examining the contents of the movie file in more detail. This summary is intended to allow applications or devices to quickly determine whether they can play the movie. It is not intended as a container for information that is not found elsewhere in the movie, and should not be used as one.</p>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_32" title="Note"></a><p><strong>Note:</strong>&nbsp;The fact that a feature does not appear in the profile atom does not mean it is not present in the movie. The profile atom itself may not be present, or may list only a subset of movie features. The features listed in the profile atom are all present, but the list is not necessarily complete.</p></div>
<p>When creating a profile atom, it is permissible to omit some features that are present in the movie, but it is required to fully specify any features that are included in the profile. For example, a movie containing video may or may not have a video codec type feature in the profile atom, but if any video codec type feature is included in the profile atom, every required video codec must be listed in the profile atom.</p>
<p>The movie profile atom is a profile atom (<code>'prfl'</code>) whose parent is a movie atom. This is distinct from the track profile atom, whose parent is a track atom. The structure of the profile atom is identical in both cases, but the contents of a movie profile atom describe the movie as a whole, while the contents of a track profile atom are specific to a particular track.</p>
<p>The movie profile atom is a new feature of the <em>QuickTime File Format Specification</em> for 2004. </p>
<p>The profile atom contains a list of features. In a movie profile atom, these features summarize the movie as a whole. In a track profile atom, these features describe a particular track.</p>
<p>Each entry in the feature list consists of four 32-bit fields: </p>
<ul class="spaceabove"><li class="li"><p>The first field is reserved and must be set to zero.</p></li>
<li class="li"><p>The second field is the part-ID, which defines the feature as being either brand-specific or universal. Brand-specific features are particular to a specific brand. Universal features are can be found in any file type that uses the profile atom. Universal features have a part-ID of four ASCII spaces (0x20202020). Brand-specific features have a part-ID that is one of the Compatible_Brand codes for that file type, as specified in the file type atom (<code>'ftyp'</code>). For example, the part-ID for QuickTime-specific features is <code>'qt  '</code>. All features described in this document, however, are universal. </p></li>
<li class="li"><p>The third field is the feature code, or name, a 32-bit unsigned integer that is usually best interpreted as four ASCII characters. Example: the maximum video bitrate feature has a feature code or name of <code>'mvbr'</code>. It is permissible to use a feature code value of zero (0x00000000, <em>not</em> four ASCII zero characters) as a placeholder in one or more name-value pairs. The reader should ignore feature codes of value zero.</p></li>
<li class="li"><p>The fourth field is the value, which is also a 32-bit field. The value may be a signed or unsigned integer, or a fixed-point value, or contain sub-fields, or consist of a packed array; it can be interpreted only in relation to the specific feature.</p></li></ul>
<p>For details on the structure and contents of profile atoms, see <span class="content_text"><a href="../QTFFAppenF/QTFFAppenF.html#//apple_ref/doc/uid/TP40000939-CH226-SW1">“Profile Atom Guidelines.”</a></span></p>
<a name="//apple_ref/doc/uid/TP40000939-CH204-56313" title="Movie Header Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCGFGJG" title="Movie Header Atoms"></a><h3>Movie Header Atoms</h3>
<p>You use the <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_266"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_267"></a>movie header atom to specify the characteristics of an entire QuickTime movie. The data contained in this atom defines characteristics of the entire QuickTime movie, such as time scale and duration. It has an atom type value of <code>'mvhd'</code>.</p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-32947">Figure 2-3</a></span> shows the layout of the movie header atom. The movie header atom is a leaf atom. </p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-32947" title="Figure 2-3The layout of a movie header atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCHGDHC" title="Figure 2-3The layout of a movie header atom"></a><p><strong>Figure 2-3&nbsp;&nbsp;</strong>The layout of a movie header atom</p>
<img src = "../art/qt_l_095.gif" alt = "The layout of a movie header atom" width="329" height="490"></div><br/>
<p>You define a movie header atom by specifying the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this movie header atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; must be set to <code>'mvhd'</code>.</p></dd>
<dt>Version</dt>
<dd><p>A 1-byte specification of the version of this movie header atom.</p></dd>
<dt>Flags</dt>
<dd><p> Three bytes of space for future movie header flags. </p></dd>
<dt>Creation time</dt>
<dd><p>A 32-bit integer that specifies the calendar date and time (in seconds since midnight, January 1, 1904) when the movie atom was created. It is strongly recommended that this value should be specified using coordinated universal time (UTC).</p></dd>
<dt>Modification time</dt>
<dd><p>A 32-bit integer that specifies the calendar date and time (in seconds since midnight, January 1, 1904) when the movie atom was changed. BooleanIt is strongly recommended that this value should be specified using coordinated universal time (UTC).</p></dd>
<dt>Time scale</dt>
<dd><p>A time value that indicates the time scale for this movie—that is, the number of time units that pass per second in its time coordinate system. A time coordinate system that measures time in sixtieths of a second, for example, has a time scale of 60.</p></dd>
<dt>Duration</dt>
<dd><p>A time value that indicates the duration of the movie in time scale units. Note that this property is derived from the movie’s tracks. The value of this field corresponds to the duration of the longest track in the movie. </p></dd>
<dt>Preferred rate</dt>
<dd><p>A 32-bit fixed-point number that specifies the rate at which to play this movie. A value of 1.0 indicates normal rate.</p></dd>
<dt>Preferred volume</dt>
<dd><p>A 16-bit fixed-point number that specifies how loud to play this movie’s sound. A value of 1.0 indicates full volume.</p></dd>
<dt>Reserved</dt>
<dd><p>Ten bytes reserved for use by Apple. Set to 0.</p></dd>
<dt>Matrix structure</dt>
<dd><p>The matrix structure associated with this movie. A matrix shows how to map points from one coordinate space into another. See <span class="content_text"><a href="../QTFFChap4/qtff4.html#//apple_ref/doc/uid/TP40000939-CH206-18737">“Matrices”</a></span> for a discussion of how display matrices are used in QuickTime. </p></dd>
<dt>Preview time</dt>
<dd><p>The time value in the movie at which the preview begins.</p></dd>
<dt>Preview duration</dt>
<dd><p>The duration of the movie preview in movie time scale units. </p></dd>
<dt>Poster time</dt>
<dd><p>The time value of the time of the movie poster.</p></dd>
<dt>Selection time</dt>
<dd><p>The time value for the start time of the current selection.</p></dd>
<dt>Selection duration</dt>
<dd><p>The duration of the current selection in movie time scale units.</p></dd>
<dt>Current time</dt>
<dd><p>The time value for current time position within the movie.</p></dd>
<dt>Next track ID</dt>
<dd><p>A 32-bit integer that indicates a value to use for the track ID number of the next track added to this movie. Note that 0 is not a valid track ID value.</p></dd></dl>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_33" title="Note"></a><p><strong>Note:</strong>&nbsp;The creation and modification date should be set using coordinated universal time (UTC). In prior versions of the QuickTime file format, this was not specified, and these fields were commonly set to local time for the time zone where the movie was created.</p></div>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25533" title="Color Table Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCBDJEB" title="Color Table Atoms"></a><h3>Color Table Atoms</h3>
<p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_268"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_269"></a>Color table atoms define a list of preferred colors for displaying the movie on devices that support only 256 colors. The list may contain up to 256 colors. These optional atoms have a type value of <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_270"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_271"></a><code>'ctab'</code>. The color table atom contains a Macintosh color table data structure. </p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-32951">Figure 2-4</a></span> shows the layout of the color table atom.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-32951" title="Figure 2-4The layout of a color table atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCFEEIJ" title="Figure 2-4The layout of a color table atom"></a><p><strong>Figure 2-4&nbsp;&nbsp;</strong>The layout of a color table atom</p>
<img src = "../art/qt_l_202.gif" alt = "The layout of a color table atom" width="263" height="164"></div><br/>
<p>The color table atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this color table atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'ctab'</code>.</p></dd>
<dt>Color table seed</dt>
<dd><p>A 32-bit integer that must be set to 0.</p></dd>
<dt>Color table flags</dt>
<dd><p>A 16-bit integer that must be set to 0x8000. </p></dd>
<dt>Color table size</dt>
<dd><p>A 16-bit integer that indicates the number of colors in the following color array. This is a zero-relative value; setting this field to 0 means that there is one color in the array.</p></dd>
<dt>Color array</dt>
<dd><p>An array of colors. Each color is made of four unsigned 16-bit integers. The first integer must be set to 0, the second is the red value, the third is the green value, and the fourth is the blue value.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25538" title="User Data Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCCFFGD" title="User Data Atoms"></a><h3>User Data Atoms</h3>
<p>User data atoms allow you to define and store data associated with a QuickTime object, such as a movie, track, or media. This includes both information that QuickTime looks for, such as copyright information or whether a movie should loop, and arbitrary information—provided by and for your application—that QuickTime simply ignores. </p>
<p>A user data atom whose immediate parent is a movie atom contains data relevant to the movie as a whole. A user data atom whose parent is a track atom contains information relevant to that specific track. A QuickTime movie file may contain many user data atoms, but only one user data atom is allowed as the immediate child of any given movie atom or track atom. </p>
<p>The user data atom has an atom type of <code>'udta'</code>. Inside the user data atom is a list of atoms describing each piece of user data. User data provides a simple way to extend the information stored in a QuickTime movie. For example, user data atoms can store a movie’s window position, playback characteristics, or creation information. </p>
<p>This section describes the data atoms that QuickTime recognizes. You may create new data atom types that your own application recognizes. Applications should ignore any data atom types they do not recognize.</p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-32955">Figure 2-5</a></span> shows the layout of a user data atom.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-32955" title="Figure 2-5The layout of a user data atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCDHHIH" title="Figure 2-5The layout of a user data atom"></a><p><strong>Figure 2-5&nbsp;&nbsp;</strong>The layout of a user data atom</p>
<img src = "../art/qt_l_032.gif" alt = "The layout of a user data atom" width="212" height="247"></div><br/>
<p>The user data atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this user data atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'udta'</code>.</p></dd>
<dt>User data list</dt>
<dd><p>A user data list that is formatted as a series of atoms. Each data element in the user data list contains size and type information along with its data. For historical reasons, the data list is optionally terminated by a 32-bit integer set to 0. If you are writing a program to read user data atoms, you should allow for the terminating 0. However, if you are writing a program to create user data atoms, you can safely leave out the trailing 0. </p><p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-63839">Table 2-1</a></span> lists the currently defined list entry types.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_272"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-63839" title="Table 2-1User data list entry types "></a><a name="//apple_ref/doc/uid/TP40000939-CH204-TPXREF101" title="Table 2-1User data list entry types "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">
<caption class="tablecaption"><strong>Table 2-1&nbsp;&nbsp;</strong>User data list entry types </caption>

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>List entry type</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>For Sorting</p></th>
</tr>


<tr>
<td  scope="row"><p><code>'©arg'</code></p></td>
<td ><p>Name of arranger</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©ark'</code></p></td>
<td ><p>Keyword(s) for arranger</p></td>
<td ><p>X</p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©cok'</code></p></td>
<td ><p>Keyword(s) for composer</p></td>
<td ><p>X</p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©com'</code></p></td>
<td ><p>Name of composer</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©cpy'</code></p></td>
<td ><p>Copyright statement</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©day'</code></p></td>
<td ><p>Date the movie content was created</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©dir'</code></p></td>
<td ><p>Name of movie’s director</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©ed1'</code> to <code>'©ed9'</code></p></td>
<td ><p>Edit dates and descriptions</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©fmt'</code></p></td>
<td ><p>Indication of movie format (computer-generated, digitized, and so on)</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©inf'</code></p></td>
<td ><p>Information about the movie</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©isr'</code></p></td>
<td ><p>ISRC code</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©lab'</code></p></td>
<td ><p>Name of record label</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©lal'</code></p></td>
<td ><p>URL of record label</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©mak'</code></p></td>
<td ><p>Name of file creator or maker</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©mal'</code></p></td>
<td ><p>URL of file creator or maker</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©nak'</code></p></td>
<td ><p>Title keyword(s) of the content</p></td>
<td ><p>X</p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©nam'</code></p></td>
<td ><p>Title of the content</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©pdk'</code></p></td>
<td ><p>Keyword(s) for producer</p></td>
<td ><p>X</p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©phg'</code></p></td>
<td ><p>Recording copyright statement, normally preceded by the symbol <img src = "../art/phono_symbol.gif" alt = "image: ../art/phono_symbol.gif" width="11" height="11"></p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©prd'</code></p></td>
<td ><p>Name of producer</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©prf'</code></p></td>
<td ><p>Names of performers</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©prk'</code></p></td>
<td ><p>Keyword(s) of main artist and performer</p></td>
<td ><p>X</p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©prl'</code></p></td>
<td ><p>URL of main artist and performer</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©req'</code></p></td>
<td ><p>Special hardware and software requirements</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©snk'</code></p></td>
<td ><p>Sub-title keyword(s) of the content</p></td>
<td ><p>X</p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©snm'</code></p></td>
<td ><p>Sub-title of content</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©src'</code></p></td>
<td ><p>Credits for those who provided movie source content</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©swf'</code></p></td>
<td ><p>Name of songwriter</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©swk'</code></p></td>
<td ><p>Keyword(s) for songwriter</p></td>
<td ><p>X</p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©swr'</code></p></td>
<td ><p>Name and version number of the software (or hardware) that generated this movie</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'©wrt'</code></p></td>
<td ><p>Name of movie’s writer</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'AllF'</code></p></td>
<td ><p>Play all frames—byte indicating that all frames of video should be played, regardless of timing</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'hinf'</code></p></td>
<td ><p>Hint track information—statistical data for real-time streaming of a particular track. For more information, see <span class="content_text"><a href="../QTFFChap3/qtff3.html#//apple_ref/doc/uid/TP40000939-CH205-57907">“Hint Track User Data Atom.”</a></span></p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'hnti'</code></p></td>
<td ><p>Hint info atom—data used for real-time streaming of a movie or a track. For more information, see <span class="content_text"><a href="../QTFFChap3/qtff3.html#//apple_ref/doc/uid/TP40000939-CH205-57913">“Movie Hint Info Atom”</a></span> and <span class="content_text"><a href="../QTFFChap3/qtff3.html#//apple_ref/doc/uid/TP40000939-CH205-57907">“Hint Track User Data Atom.”</a></span></p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'name'</code></p></td>
<td ><p>Name of object</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'LOOP'</code></p></td>
<td ><p>Long integer indicating looping style. This atom is not present unless the movie is set to loop. Values are 0 for normal looping, 1 for palindromic looping.</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'ptv '</code></p></td>
<td ><p>Print to video—display movie in full screen mode. This atom contains a 16-byte structure, described in <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25544">“Print to Video (Full Screen Mode).”</a></span></p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'SelO'</code></p></td>
<td ><p>Play selection only—byte indicating that only the selected area of the movie should be played</p></td>
<td ><p></p></td>
</tr>
<tr>
<td  scope="row"><p><code>'WLOC'</code></p></td>
<td ><p>Default window location for movie—two 16-bit values, {x,y}</p></td>
<td ><p></p></td>
</tr>

</table></div>
<p>The user-data items labelled “keywords” and marked as “For Sorting” are for use when the display text does not have a pre-determined sorting order (for example, in oriental languages when the sorting depends on the contextual meaning). These keywords can be sorted algorithmically to place the corresponding items in correct order.</p>
<p>The window location, looping, play selection only, play all frames, and print to video atoms control the way QuickTime displays a movie. These atoms are interpreted <em>only</em> if the user data atom’s immediate parent is a movie atom (<code>'moov'</code>). If they are included as part of a track atom’s user data, they are ignored.</p>
<a name="//apple_ref/doc/uid/TP40000939-CH204-58499" title="User Data Text Strings and Language Codes"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCGFIDH" title="User Data Text Strings and Language Codes"></a><h4>User Data Text Strings and Language Codes</h4>
<p>All user data list entries whose type begins with the © character (ASCII 169) are defined to be international text. These list entries must contain a list of text strings with associated language codes. By storing multiple versions of the same text, a single user data text item can contain translations for different languages. </p>
<p>The list of text strings uses a small integer atom format, which is identical to the QuickTime atom format except that it uses 16-bit values for size and type instead of 32-bit values. The first value is the size of the string, including the size and type, and the second value is the language code for the string.</p>
<p>User data text strings may use either Macintosh text encoding or Unicode text encoding. The format of the language code determines the text encoding format. Macintosh language codes are followed by Macintosh-encoded text. If the language code is specified using the ISO language codes listed in specification ISO 639-2/T, the text uses Unicode text encoding. Multiple versions of the same text may use different encoding schemes. When Unicode is used, the text is in UTF-8 unless it starts with a byte-order-mark (BOM, 0xFEFF. ), whereupon the text is in UTF-16. Both the BOM and the UTF-16 text should be big-endian.</p>
<div class="importantbox"><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_34" title="Important:"></a><p><strong>Important:</strong>&nbsp;

Language code values less than 0x800 are Macintosh language codes; larger values are ISO language codes.</p><p></p></div>
<p>ISO language codes are three-character codes. In order to fit inside a 16-bit field, the characters must be packed into three 5-bit sub-fields. This packing is described in <code><a href="../QTFFChap4/qtff4.html#//apple_ref/doc/uid/TP40000939-CH206-35103">ISO Language Codes</a></code>.</p>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25544" title="Print to Video (Full Screen Mode)"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCDHDJJ" title="Print to Video (Full Screen Mode)"></a><h4>Print to Video (Full Screen Mode)</h4>
<p>A movie atom’s user data atom may contain a print to video atom (<code>'ptv '</code>) . If a print to video atom is present, QuickTime plays the movie in full-screen mode, with no window and no visible controller. Any portion of the screen not occupied by the movie is cleared to black. The user must press the <code>esc</code> key to exit full-screen mode.</p>
<p>This atom is often added and removed transiently to control the display mode of a movie for a single presentation, but it can also be stored as part of the permanent movie file.</p>
<p>The print to video atom consists of the following data.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this user data item.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the item type; this field must be set to <code>'ptv '</code>. Note that the fourth character is an ASCII blank (0x20).</p></dd>
<dt>Display size</dt>
<dd><p>A 16-bit <em>little-endian</em> integer indicating the display size for the movie: 0 indicates that the movie should be played at its normal size; 1 indicates that the movie should be played at double size; 2 indicates that the movie should be played at half size; 3 indicates that the movie should be scaled to fill the screen; 4 indicates that the movie should be played at its current size (this last value is normally used when the print to video atom is inserted transiently and the movie has been temporarily resized).</p></dd>
<dt>Reserved1</dt>
<dd><p>A 16-bit integer whose value should be 0.</p></dd>
<dt>Reserved2</dt>
<dd><p>A 16-bit integer whose value should be 0.</p></dd>
<dt>Slide show</dt>
<dd><p>An 8-bit Boolean whose value is 1 for a slide show. In slide show mode, the movie advances one frame each time the right-arrow key is pressed. Audio is muted.</p></dd>
<dt>Play on open</dt>
<dd><p>An 8-bit Boolean whose value is normally 1, indicating that the movie should play when opened. Since there is no visible controller in full-screen mode, applications should always set this field to 1 to prevent user confusion.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-33299" title="Track Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCBEAIF" title="Track Atoms"></a><h2>Track Atoms</h2>
<p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_273"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_274"></a>Track atoms define a single track of a movie. A movie may consist of one or more tracks. Each track is independent of the other tracks in the movie and carries its own temporal and spatial information. Each track atom contains its associated media atom. </p>
<p>Tracks are used specifically for the following purposes: </p>
<ul class="ul"><li class="li"><p>To contain media data references and descriptions (media tracks). </p></li>
<li class="li"><p>To contain modifier tracks (tweens, and so forth).</p></li>
<li class="li"><p>To contain packetization information for streaming protocols (<a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_275"></a>hint tracks). Hint tracks may contain references to media sample data or copies of media sample data. For more information about hint tracks, refer to <span class="content_text"><a href="../QTFFChap3/qtff3.html#//apple_ref/doc/uid/TP40000939-CH205-69871">“Hint Media.”</a></span> </p></li></ul>
<p>Note that a QuickTime movie cannot consist solely of hint tracks or modifier tracks; there must be at least one media track. Furthermore, media tracks cannot be deleted from a hinted movie, even if the hint tracks contain copies of the media sample data—in addition to the hint tracks, the entire unhinted movie must remain.</p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-32959">Figure 2-6</a></span> shows the layout of a track atom. Track atoms have an atom type value of <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_276"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_277"></a><code>'trak'</code>. The track atom requires a track header atom (<a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_278"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_279"></a><code>'tkhd'</code>) and a media atom (<a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_280"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_281"></a><code>'mdia'</code>). Other child atoms are optional, and may include a track profile atom (<code>'prfl'</code>), a track clipping atom (<a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_282"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_283"></a><code>'clip'</code>), a track matte atom (<a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_284"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_285"></a><code>'matt'</code>), an edit atom (<a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_286"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_287"></a><code>'edts'</code>), a track reference atom (<code>'tref'</code>), a track load settings atom (<code>'load'</code>), a track input map atom (<code>'imap'</code>), and a user data atom (<code>'udta'</code>).</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-32959" title="Figure 2-6The layout of a track atom "></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCIIGHA" title="Figure 2-6The layout of a track atom "></a><p><strong>Figure 2-6&nbsp;&nbsp;</strong>The layout of a track atom </p>
<img src = "../art/qtff_11.gif" alt = "The layout of a track atom" width="232" height="316"></div><br/>
<p>Track atoms contain the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this track atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'trak'</code>.</p></dd>
<dt>Track profile atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-58763">“Track Profile Atom”</a></span> for details.</p></dd>
<dt>Track header atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25550">“Track Header Atoms”</a></span> for details.</p></dd>
<dt>Clipping atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25556">“Clipping Atoms”</a></span> for more information.</p></dd>
<dt>Track matte atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25567">“Track Matte Atoms”</a></span> for more information. </p></dd>
<dt>Edit atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25579">“Edit Atoms”</a></span> for details. </p></dd>
<dt>Track reference atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25604">“Track Reference Atoms”</a></span>” for details.</p></dd>
<dt>Track load settings atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25598">“Track Load Settings Atoms”</a></span> for details.</p></dd>
<dt>Track input map atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25610">“Track Input Map Atoms”</a></span>” for details.</p></dd>
<dt>Media atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33303">“Media Atoms”</a></span> for details.</p></dd>
<dt>User-defined data atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25538">“User Data Atoms”</a></span> for more information.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-58763" title="Track Profile Atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-CJBCAJIB" title="Track Profile Atom"></a><h3>Track Profile Atom</h3>
<p>Profile atoms can be children of movie atoms or track atoms. For details on profile atoms, see <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-54948">“The Movie Profile Atom.”</a></span></p>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25550" title="Track Header Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCEIDFA" title="Track Header Atoms"></a><h3>Track Header Atoms</h3>
<p>The <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_288"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_289"></a>track header atom specifies the characteristics of a single track within a movie. A track header atom contains a size field that specifies the number of bytes and a type field that indicates the format of the data (defined by the atom type <code>'tkhd'</code>).</p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-32963">Figure 2-7</a></span> shows the structure of the track header atom.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-32963" title="Figure 2-7The layout of a track header atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCDGHEF" title="Figure 2-7The layout of a track header atom"></a><p><strong>Figure 2-7&nbsp;&nbsp;</strong>The layout of a track header atom</p>
<img src = "../art/qt_l_096.gif" alt = "The layout of a track header atom" width="282" height="556"></div><br/>
<p>The track header atom contains the track characteristics for the track, including temporal, spatial, and volume information. </p>
<p>Track header atoms contain the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this track header atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'tkhd'</code>.</p></dd>
<dt>Version</dt>
<dd><p>A 1-byte specification of the version of this track header.</p></dd>
<dt>Flags</dt>
<dd><p>Three bytes that are reserved for the track header flags. These flags indicate how the track is used in the movie. The following flags are valid (all flags are enabled when set to 1).</p><p>Track enabled  </p><p>Indicates that the track is enabled. Flag value is 0x0001.</p><p>Track in movie</p><p>Indicates that the track is used in the movie. Flag value is 0x0002.</p><p>Track in preview</p><p>Indicates that the track is used in the movie’s preview. Flag value is 0x0004.</p><p>Track in poster</p><p>Indicates that the track is used in the movie’s poster. Flag value is 0x0008.</p></dd>
<dt>Creation time</dt>
<dd><p>A 32-bit integer that indicates the calendar date and time (expressed in seconds since midnight, January 1, 1904) when the track header was created. It is strongly recommended that this value should be specified using coordinated universal time (UTC).</p></dd>
<dt>Modification time</dt>
<dd><p>A 32-bit integer that indicates the calendar date and time (expressed in seconds since midnight, January 1, 1904) when the track header was changed. It is strongly recommended that this value should be specified using coordinated universal time (UTC).</p></dd>
<dt>Track ID</dt>
<dd><p>A 32-bit integer that uniquely identifies the track. The value 0 cannot be used.</p></dd>
<dt>Reserved</dt>
<dd><p>A 32-bit integer that is reserved for use by Apple. Set this field to 0.</p></dd>
<dt>Duration</dt>
<dd><p>A time value that indicates the duration of this track (in the movie’s time coordinate system). Note that this property is derived from the track’s edits. The value of this field is equal to the sum of the durations of all of the track’s edits. If there is no edit list, then the duration is the sum of the sample durations, converted into the movie timescale. </p></dd>
<dt>Reserved</dt>
<dd><p>An 8-byte value that is reserved for use by Apple. Set this field to 0.</p></dd>
<dt>Layer</dt>
<dd><p>A 16-bit integer that indicates this track’s spatial priority in its movie. The QuickTime Movie Toolbox uses this value to determine how tracks overlay one another. Tracks with lower layer values are displayed in front of tracks with higher layer values.</p></dd>
<dt>Alternate group</dt>
<dd><p>A 16-bit integer that specifies a collection of movie tracks that contain alternate data for one another. QuickTime chooses one track from the group to be used when the movie is played. The choice may be based on such considerations as playback quality, language, or the capabilities of the computer.</p></dd>
<dt>Volume</dt>
<dd><p>A 16-bit fixed-point value that indicates how loudly this track’s sound is to be played. A value of 1.0 indicates normal volume.</p></dd>
<dt>Reserved</dt>
<dd><p>A 16-bit integer that is reserved for use by Apple. Set this field to 0.</p></dd>
<dt>Matrix structure</dt>
<dd><p>The matrix structure associated with this track. See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-32967">Figure 2-8</a></span> for an illustration of a matrix structure.</p></dd>
<dt>Track width</dt>
<dd><p>A 32-bit fixed-point number that specifies the width of this track in pixels. </p></dd>
<dt>Track height</dt>
<dd><p>A 32-bit fixed-point number that indicates the height of this track in pixels.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25556" title="Clipping Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCIHBFG" title="Clipping Atoms"></a><h3>Clipping Atoms</h3>
<p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_290"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_291"></a>Clipping atoms specify the clipping regions for movies and for tracks. The clipping atom has an atom type value of <code>'clip'</code>.</p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-32967">Figure 2-8</a></span> shows the layout of a clipping atom.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-32967" title="Figure 2-8The layout of a clipping atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCGHCBG" title="Figure 2-8The layout of a clipping atom"></a><p><strong>Figure 2-8&nbsp;&nbsp;</strong>The layout of a clipping atom</p>
<img src = "../art/qt_l_033.gif" alt = "The layout of a clipping atom" width="257" height="240"></div><br/>
<p>Clipping atoms contain the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this clipping atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'clip'</code>.</p></dd>
<dt><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_292"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_293"></a>Clipping region atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25561">“Clipping Region Atoms.”</a></span> </p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25561" title="Clipping Region Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCHDAIB" title="Clipping Region Atoms"></a><h3>Clipping Region Atoms</h3>
<p>The clipping region atom contains the data that specifies the clipping region, including its size, bounding box, and region. Clipping region atoms have an atom type value of <code>'crgn'</code>.</p>
<p>The layout of the clipping region atom is shown in <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-32967">Figure 2-8</a></span>. </p>
<p>Clipping region atoms contain the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this clipping region atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'crgn'</code>.</p></dd>
<dt>Region size</dt>
<dd><p>The region size, region boundary box, and clipping region data fields constitute a QuickDraw region. </p></dd>
<dt>Region boundary box</dt>
<dd><p>The region size, region boundary box, and clipping region data fields constitute a QuickDraw region. </p></dd>
<dt>Clipping region data</dt>
<dd><p>The region size, region boundary box, and clipping region data fields constitute a QuickDraw region. </p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25567" title="Track Matte Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCFEDAI" title="Track Matte Atoms"></a><h3>Track Matte Atoms</h3>
<p>Track matte atoms are used to visually blend the track’s image when it is displayed. </p>
<p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_294"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_295"></a>Track matte atoms have an atom type value of <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_296"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_297"></a><code>'matt'</code>.</p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-32971">Figure 2-9</a></span> shows the layout of track matte atoms.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-32971" title="Figure 2-9The layout of a track matte atom "></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCDEJFC" title="Figure 2-9The layout of a track matte atom "></a><p><strong>Figure 2-9&nbsp;&nbsp;</strong>The layout of a track matte atom </p>
<img src = "../art/qt_l_068.gif" alt = "The layout of a track matte atom" width="209" height="284"></div><br/>
<p>Track matte atoms contain the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this track matte atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'matt'</code>.</p></dd><dt>Compressed matte atom</dt><dd><p>The actual matte data.</p><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25573">“Compressed Matte Atoms”</a></span> for details. </p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25573" title="Compressed Matte Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCEIDJD" title="Compressed Matte Atoms"></a><h3>Compressed Matte Atoms</h3>
<p>The <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_298"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_299"></a>compressed matte atom specifies the image description structure and the matte data associated with a particular matte atom. Compressed matte atoms have an atom type value of <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_300"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_301"></a><code>'kmat'</code>.</p>
<p>The layout of the compressed matte atom is shown in <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-32971">Figure 2-9</a></span>.</p>
<p>Compressed matte atoms contain the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this compressed matte atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'kmat'</code>.</p></dd>
<dt>Version</dt>
<dd><p>A 1-byte specification of the version of this compressed matte atom.</p></dd>
<dt>Flags</dt>
<dd><p>Three bytes of space for flags. Set this field to 0.</p></dd>
<dt>Matte image description structure</dt>
<dd><p>An image description structure associated with this matte data. The image description contains detailed information that governs how the matte data is used. See <span class="content_text"><a href="../QTFFChap3/qtff3.html#//apple_ref/doc/uid/TP40000939-CH205-74550">“Video Sample Description”</a></span> for more information about image descriptions.</p></dd>
<dt>Matte data</dt>
<dd><p>The compressed matte data, which is of variable length.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25579" title="Edit Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCCFBEF" title="Edit Atoms"></a><h3>Edit Atoms</h3><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_302"></a>
<p>You use edit atoms to define the portions of the media that are to be used to build up a track for a movie. The edits themselves are contained in an edit list table, which consists of time offset and duration values for each segment. Edit atoms have an atom type value of <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_303"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_304"></a><code>'edts'.</code></p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-32975">Figure 2-10</a></span> shows the layout of an edit atom.</p>
<p>In the absence of an edit list, the presentation of a track starts immediately. An empty edit is used to offset the start time of a track.</p>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_35" title="Note"></a><p><strong>Note:</strong>&nbsp;If the edit atom or the edit list atom is missing, you can assume that the entire media is used by the track.</p></div>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-32975" title="Figure 2-10The layout of an edit atom "></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCCEECC" title="Figure 2-10The layout of an edit atom "></a><p><strong>Figure 2-10&nbsp;&nbsp;</strong>The layout of an edit atom </p>
<img src = "../art/qt_l_034.gif" alt = "The layout of an edit atom" width="211" height="283"></div><br/>
<p>Edit atoms contain the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this edit atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'edts'</code>.</p></dd>
<dt>Edit list atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25592">“Edit List Atoms.”</a></span> </p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25592" title="Edit List Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCGDIJF" title="Edit List Atoms"></a><h3>Edit List Atoms</h3>
<p>You use the <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_305"></a>edit list atom, also shown in <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-32975">Figure 2-10</a></span>, to map from a time in a movie to a time in a media, and ultimately to media data. This information is in the form of entries in an edit list table, shown in <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-32979">Figure 2-11</a></span>. Edit list atoms have an atom type value of <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_306"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_307"></a><code>'elst'</code>.</p>
<p>Edit list atoms contain the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this edit list atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'elst'</code>.</p></dd>
<dt>Version</dt>
<dd><p>A 1-byte specification of the version of this edit list atom.</p></dd>
<dt>Flags</dt>
<dd><p>Three bytes of space for flags. Set this field to 0.</p></dd>
<dt>Number of entries</dt>
<dd><p>A 32-bit integer that specifies the number of entries in the edit list atom that follows.</p></dd>
<dt>Edit list table</dt>
<dd><p>An array of 32-bit values, grouped into entries containing 3 values each. <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-32979">Figure 2-11</a></span> shows the layout of the entries in this table.</p></dd></dl>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-32979" title="Figure 2-11The layout of an edit list table entry"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCGCCFH" title="Figure 2-11The layout of an edit list table entry"></a><p><strong>Figure 2-11&nbsp;&nbsp;</strong>The layout of an edit list table entry</p><img src = "../art/qt_l_100.gif" alt = "The layout of an edit list table entry" width="313" height="62"></div><br/>
<p>An edit list table entry contains the following elements.</p>
<dl class="termdef">	<dt>Track duration</dt>
<dd><p>A 32-bit integer that specifies the duration of this edit segment in units of the movie’s time scale.</p></dd>
<dt>Media time</dt>
<dd><p>A 32-bit integer containing the starting time within the media of this edit segment (in media timescale units). If this field is set to –1, it is an empty edit. The last edit in a track should never be an empty edit. Any difference between the movie’s duration and the track’s duration is expressed as an implicit empty edit. </p></dd>
<dt>Media rate</dt>
<dd><p>A 32-bit fixed-point number that specifies the relative rate at which to play the media corresponding to this edit segment. This rate value cannot be 0 or negative. </p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25598" title="Track Load Settings Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCGIIFI" title="Track Load Settings Atoms"></a><h3>Track Load Settings Atoms</h3>
<p>Track load settings atoms contain information that indicates how the track is to be used in its movie. Applications that read QuickTime files can use this information to process the movie data more efficiently. Track load settings atoms have an atom type value of <code>'load'</code>.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-32983" title="Figure 2-12The layout of a track load settings atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-TPXREF102" title="Figure 2-12The layout of a track load settings atom"></a><p><strong>Figure 2-12&nbsp;&nbsp;</strong>The layout of a track load settings atom</p><img src = "../art/qt_l_203.gif" alt = "The layout of a track load settings atom" width="198" height="172"></div><br/>
<p>Track load settings atoms contain the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this track load settings atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'load'</code>.</p></dd>
<dt>Preload start time </dt>
<dd><p>A 32-bit integer specifying the starting time, in the movie’s time coordinate system, of a segment of the track that is to be preloaded. Used in conjunction with the preload duration.</p></dd>
<dt>Preload duration</dt>
<dd><p>A 32-bit integer specifying the duration, in the movie’s time coordinate system, of a segment of the track that is to be preloaded. If the duration is set to –1, it means that the preload segment extends from the preload start time to the end of the track. All media data in the segment of the track defined by the preload start time and preload duration values should be loaded into memory when the movie is to be played.</p></dd>
<dt>Preload flags</dt>
<dd><p>A 32-bit integer containing flags governing the preload operation. Only two flags are defined, and they are mutually exclusive. If preload flags is set to 1, the track is to be preloaded regardless of whether it is enabled. If preload flags is set to 2, the track is to be preloaded only if it is enabled.</p></dd>
<dt>Default hints</dt>
<dd><p>A 32-bit integer containing playback hints. More than one flag may be enabled. Flags are enabled by setting them to 1. The following flags are defined.</p><p>Double buffer </p><p>This flag indicates that the track should be played using double-buffered I/O. This flag’s value is 0x0020. </p><p>High quality </p><p>This flag indicates that the track should be displayed at highest possible quality, without regard to real-time performance considerations. This flag’s value is 0x0100.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25604" title="Track Reference Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCGDBAF" title="Track Reference Atoms"></a><h3>Track Reference Atoms</h3>
<p>Track reference atoms define relationships between tracks. Track reference atoms allow one track to specify how it is related to other tracks. For example, if a movie has three video tracks and three sound tracks, track references allow you to identify the related sound and video tracks. Track reference atoms have an atom type value of <code>'tref'</code>.</p>
<p>Track references are unidirectional and point from the recipient track to the source track. For example, a video track may reference a time code track to indicate where its time code is stored, but the time code track would not reference the video track. The time code track is the source of time information for the video track.</p>
<p>A single track may reference multiple tracks. For example, a video track could reference a sound track to indicate that the two are synchronized and a time code track to indicate where its time code is stored. </p>
<p>A single track may also be referenced by multiple tracks. For example, both a sound and video track could reference the same time code track if they share the same timing information.</p>
<p>If this atom is not present, the track is not referencing any other track in any way. Note that the array of track reference type atoms is sized to fill the track reference atom. Track references with a reference index of 0 are permitted. This indicates no reference.</p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-32987">Figure 2-13</a></span> shows the layout of a track reference atom. </p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-32987" title="Figure 2-13The layout of a track reference atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCBCDFD" title="Figure 2-13The layout of a track reference atom"></a><p><strong>Figure 2-13&nbsp;&nbsp;</strong>The layout of a track reference atom</p>
<img src = "../art/qt_l_204.gif" alt = "The layout of a track reference atom" width="206" height="231"></div><br/>
<p>A track reference atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this track reference atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'tref'</code>.</p></dd>
<dt>Track reference type atoms</dt>
<dd><p>A list of track reference type atoms containing the track reference information. These atoms are described next.</p></dd></dl>
<p>Each track reference atom defines relationships with tracks of a specific type. The reference type implies a track type. <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-38449">Table 2-2</a></span> shows the track reference types and their descriptions. </p><a name="//apple_ref/doc/uid/TP40000939-CH204-38449" title="Table 2-2Track reference types "></a><a name="//apple_ref/doc/uid/TP40000939-CH204-TPXREF103" title="Table 2-2Track reference types "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">
<caption class="tablecaption"><strong>Table 2-2&nbsp;&nbsp;</strong>Track reference types </caption>

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Reference type</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>'tmcd'</code></p></td>
<td ><p>Time code. Usually references a time code track.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>'chap'</code></p></td>
<td ><p>Chapter or scene list. Usually references a text track.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>'sync'</code></p></td>
<td ><p>Synchronization. Usually between a video and sound track. Indicates that the two tracks are synchronized. The reference can be from either track to the other, or there may be two references.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>'scpt'</code></p></td>
<td ><p>Transcript. Usually references a text track. </p></td>
</tr>
<tr>
<td  scope="row"><p><code>'ssrc'</code></p></td>
<td ><p>Nonprimary source. Indicates that the referenced track should send its data to this track, rather than presenting it. The referencing track will use the data to modify how it presents its data. See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25610">“Track Input Map Atoms”</a></span> for more information.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>'hint'</code></p></td>
<td ><p>The referenced tracks contain the original media for this hint track. </p></td>
</tr>

</table></div>
<p>Each track reference type atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this track reference type atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to one of the values shown in <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-38449">Table 2-2</a></span>.</p></dd>
<dt>Track IDs</dt>
<dd><p>A list of track ID values (32-bit integers) specifying the related tracks. Note that this is one case where track ID values can be set to 0. Unused entries in the atom may have a track ID value of 0. Setting the track ID to 0 may be more convenient than deleting the reference. </p></dd></dl>
<p>You can determine the number of track references stored in a track reference type atom by subtracting its header size from its overall size and then dividing by the size, in bytes, of a track ID.</p>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25610" title="Track Input Map Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCDJBFG" title="Track Input Map Atoms"></a><h3>Track Input Map Atoms</h3>
<p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_308"></a>Track input map atoms define how data being sent to this track from its nonprimary sources is to be interpreted. Track references of type <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_309"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_310"></a><code>'ssrc'</code> define a track’s secondary data sources. These sources provide additional data that is to be used when processing the track. Track input map atoms have an atom type value of <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_311"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_312"></a><code>'imap'</code>.</p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-32991">Figure 2-14</a></span> shows the layout of a track input atom. This atom contains one or more track input atoms. Note that the track input map atom is a QT atom structure. </p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-32991" title="Figure 2-14The layout of a track input map atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCFBGHD" title="Figure 2-14The layout of a track input map atom"></a><p><strong>Figure 2-14&nbsp;&nbsp;</strong>The layout of a track input map atom</p>
<img src = "../art/qt_l_205.gif" alt = "The layout of a track input map atom" width="194" height="528"></div><br/>
<p>Each track input map atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this track input map atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'imap'</code>.</p></dd>
<dt>Track input atoms</dt>
<dd><p>A list of track input atoms specifying how to use the input data.</p></dd></dl>
<p></p>
<p>The input map defines all of the track’s secondary inputs. Each secondary input is defined using a separate track input atom. </p>
<p>Each track input atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this track input atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>' in'</code> (note that the two leading bytes must be set to 0x00).</p></dd>
<dt>Atom ID</dt>
<dd><p>A 32-bit integer relating this track input atom to its secondary input. The value of this field corresponds to the index of the secondary input in the track reference atom. That is, the first secondary input corresponds to the track input atom with an atom ID value of 1; the second to the track input atom with an atom ID of 2, and so on.</p></dd>
<dt>Reserved</dt>
<dd><p>A 16-bit integer that must be set to 0.</p></dd>
<dt>Child count</dt>
<dd><p>A 16-bit integer specifying the number of child atoms in this atom.</p></dd>
<dt>Reserved</dt>
<dd><p>A 32-bit integer that must be set to 0.</p></dd></dl>
<p>The track input atom, in turn, may contain two other types of atoms: input type atoms and object ID atoms. The input type atom is required; it specifies how the data is to be interpreted.</p>
<p>The input type atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this input type atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>' ty'</code> (note that the two leading bytes must be set to 0x00).</p></dd>
<dt>Input type</dt>
<dd><p>A 32-bit integer that specifies the type of data that is to be received from the secondary data source. <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-47171">Table 2-3</a></span> lists valid values for this field.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-47171" title="Table 2-3Input types"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-TPXREF104" title="Table 2-3Input types"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">
<caption class="tablecaption"><strong>Table 2-3&nbsp;&nbsp;</strong>Input types</caption>

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Input identifier</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Value</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><code>kTrackModifierTypeMatrix </code></p></td>
<td ><p>1</p></td>
<td ><p>A 3 x 3 transformation matrix to transform the track’s location, scaling, and so on.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>kTrackModifierTypeClip </code></p></td>
<td ><p>2</p></td>
<td ><p>A QuickDraw clipping region to change the track’s shape. </p></td>
</tr>
<tr>
<td  scope="row"><p><code>kTrackModifierTypeVolume </code></p></td>
<td ><p>3</p></td>
<td ><p>An 8.8 fixed-point value indicating the relative sound volume. This is used for fading the volume. </p></td>
</tr>
<tr>
<td  scope="row"><p><code>kTrackModifierTypeBalance </code></p></td>
<td ><p>4</p></td>
<td ><p>A 16-bit integer indicating the sound balance level. This is used for panning the sound location. </p></td>
</tr>
<tr>
<td  scope="row"><p><code>kTrackModifierTypeGraphicsMode</code></p></td>
<td ><p>5</p></td>
<td ><p>A graphics mode record (32-bit integer indicating graphics mode, followed by an RGB color) to modify the track’s graphics mode for visual fades. </p></td>
</tr>
<tr>
<td  scope="row"><p><code>kTrackModifierObjectMatrix </code></p></td>
<td ><p>6</p></td>
<td ><p>A 3x3 transformation matrix to transform an object within the track’s location, scaling, and so on.</p></td>
</tr>
<tr>
<td  scope="row"><p><code>kTrackModifierObjectGraphicsMode</code></p></td>
<td ><p>7</p></td>
<td ><p>A graphics mode record (32-bit integer indicating graphics mode, followed by an RGB color) to modify an object within the track’s graphics mode for visual fades. </p></td>
</tr>
<tr>
<td  scope="row"><p><code>kTrackModifierTypeImage </code></p></td>
<td ><p><code>'vide’</code></p></td>
<td ><p>Compressed image data for an object within the track. Note that this was <code>kTrackModifierTypeSpriteImage</code>. </p></td>
</tr>

</table></div>
<p>If the input is operating on an object within the track (for example, a sprite within a sprite track), an object ID atom must be included in the track input atom to identify the object. </p>
<p>The object ID atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this object ID atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'obid'</code>.</p></dd>
<dt>Object ID</dt>
<dd><p>A 32-bit integer identifying the object.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-33303" title="Media Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCHFJFA" title="Media Atoms"></a><h2>Media Atoms</h2>
<p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_313"></a>Media atoms describe and define a track’s media type and sample data. The media atom contains information that specifies the media type, such as sound or video, the media handler component used to interpret the sample data, the media timescale and track duration, and media-and-track-specific information such as sound volume or graphics mode. It also contains the media data references, which typically specify the file where the sample data is stored, and the sample table atoms, which specify the sample description, duration, and byte offset from the data reference for each media sample. </p>
<p>The media atom has an atom type of <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_314"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_315"></a><code>'mdia'</code>. It must contain a media header atom (<a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_316"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_317"></a><code>'mdhd'</code>), and it can contain a handler reference (<a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_318"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_319"></a><code>'hdlr'</code>) atom, media information (<a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_320"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_321"></a><code>'minf'</code>) atom, and user data (<a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_322"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_323"></a><code>'udta'</code>) atom. </p>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_36" title="Note"></a><p><strong>Note:</strong>&nbsp;Do not confuse the media atom (<code>'mdia'</code>) with the media <em>data</em> atom (<code>'mdat'</code>). The media atom contains only <em>references</em> to media data; the media data atom contains the actual media samples.</p></div>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-32995">Figure 2-15</a></span> shows the layout of a media atom.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-32995" title="Figure 2-15The layout of a media atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCJFAII" title="Figure 2-15The layout of a media atom"></a><p><strong>Figure 2-15&nbsp;&nbsp;</strong>The layout of a media atom</p>
<img src = "../art/qt_l_030.gif" alt = "The layout of a media atom" width="242" height="178"></div><br/>
<p>Media atoms contain the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this media atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'mdia'</code>.</p></dd>
<dt>Media header atom</dt>
<dd><p>This atom contains the standard media information. See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25615">“Media Header Atoms.”</a></span></p></dd>
<dt>Handler reference atom</dt>
<dd><p>This atom identifies the media handler component that is to be used to interpret the media data. See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25621">“Handler Reference Atoms”</a></span> for more information.</p><p>Note that the handler reference atom tells you the kind of media this media atom contains—for example, video or sound. The layout of the media information atom is specific to the media handler that is to interpret the media. <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25626">“Media Information Atoms”</a></span> discusses how data may be stored in a media, using the video media format defined by Apple as an example.</p></dd>
<dt>Media information atom</dt>
<dd><p>This atom contains data specific to the media type for use by the media handler component. See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25626">“Media Information Atoms.”</a></span></p></dd>
<dt>User data atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25538">“User Data Atoms.”</a></span> </p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25615" title="Media Header Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCHCFID" title="Media Header Atoms"></a><h3>Media Header Atoms</h3>
<p>The <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_324"></a>media header atom specifies the characteristics of a media, including time scale and duration. The media header atom has an atom type of <code>'mdhd'</code>. </p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-32999">Figure 2-16</a></span> shows the layout of the media header atom.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-32999" title="Figure 2-16The layout of a media header atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCHEHHB" title="Figure 2-16The layout of a media header atom"></a><p><strong>Figure 2-16&nbsp;&nbsp;</strong>The layout of a media header atom</p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_325"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_326"></a>
<img src = "../art/qt_l_097.gif" alt = "The layout of a media header atom" width="224" height="278"></div><br/>
<p>Media header atoms contain the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this media header atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'mdhd'</code>.</p></dd>
<dt>Version</dt>
<dd><p>One byte that specifies the version of this header atom.</p></dd>
<dt>Flags</dt>
<dd><p>Three bytes of space for media header flags. Set this field to 0.</p></dd>
<dt>Creation time</dt>
<dd><p>A 32-bit integer that specifies (in seconds since midnight,  January 1, 1904) when the media atom was created. It is strongly recommended that this value should be specified using coordinated universal time (UTC).</p></dd>
<dt>Modification time</dt>
<dd><p>A 32-bit integer that specifies (in seconds since midnight,  January 1, 1904) when the media atom was changed. It is strongly recommended that this value should be specified using coordinated universal time (UTC).</p></dd>
<dt>Time scale</dt>
<dd><p>A time value that indicates the time scale for this media—that is, the number of time units that pass per second in its time coordinate system.</p></dd>
<dt>Duration</dt>
<dd><p>The duration of this media in units of its time scale.</p></dd>
<dt>Language</dt>
<dd><p>A 16-bit integer that specifies the language code for this media. See <span class="content_text"><a href="../QTFFChap4/qtff4.html#//apple_ref/doc/uid/TP40000939-CH206-27005">“Language Code Values”</a></span> for valid language codes.</p></dd>
<dt>Quality</dt>
<dd><p>A 16-bit integer that specifies the media’s playback quality—that is, its suitability for playback in a given environment. </p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25621" title="Handler Reference Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCIBHFD" title="Handler Reference Atoms"></a><h3>Handler Reference Atoms</h3>
<p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_327"></a>The handler reference atom specifies the media handler component that is to be used to interpret the media’s data. The handler reference atom has an atom type value of <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_328"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_329"></a><code>'hdlr'</code>.</p>
<p>Historically, the handler reference atom was also used for data references. However, this use may now be ignored. </p>
<p>The handler atom within a media atom declares the process by which the media data in the stream may be presented, and thus, the nature of the media in a stream. For example, a video handler would handle a video track. </p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33004">Figure 2-17</a></span> shows the layout of a handler reference atom.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33004" title="Figure 2-17The layout of a handler reference atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCGGGCC" title="Figure 2-17The layout of a handler reference atom"></a><p><strong>Figure 2-17&nbsp;&nbsp;</strong>The layout of a handler reference atom</p><img src = "../art/qt_l_031.gif" alt = "The layout of a handler reference atom" width="203" height="275"></div><br/>
<p>Handler reference atoms contain the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this handler reference atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'hdlr'</code>.</p></dd>
<dt>Version</dt>
<dd><p>A 1-byte specification of the version of this handler information.</p></dd>
<dt>Flags</dt>
<dd><p>A 3-byte space for handler information flags. Set this field to 0.</p></dd>
<dt>Component type</dt>
<dd><p>A four-character code that identifies the type of the handler. Only two values are valid for this field: <code>'mhlr'</code> for media handlers and <code>'dhlr'</code> for data handlers.</p></dd>
<dt>Component subtype</dt>
<dd><p>A four-character code that identifies the type of the media handler or data handler. For media handlers, this field defines the type of data—for example, <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_330"></a><code>'vide'</code> for video data or <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_331"></a><code>'soun'</code> for sound data.</p><p>For data handlers, this field defines the data reference type—for example, a component subtype value of <code>'alis'</code> identifies a file alias.</p></dd>
<dt>Component manufacturer</dt>
<dd><p>Reserved. Set to 0.</p></dd>
<dt>Component flags</dt>
<dd><p>Reserved. Set to 0.</p></dd>
<dt>Component flags mask</dt>
<dd><p>Reserved. Set to 0.</p></dd>
<dt>Component name</dt>
<dd><p>A (counted) string that specifies the name of the component—that is, the media handler used when this media was created. This field may contain a zero-length (empty) string.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25626" title="Media Information Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCHEIJG" title="Media Information Atoms"></a><h3>Media Information Atoms</h3>
<p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_332"></a>Media information atoms (defined by the <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_333"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_334"></a><code>'minf'</code> atom type) store handler-specific information for a track’s media data. The media handler uses this information to map from media time to media data and to process the media data. </p>
<p>These atoms contain information that is specific to the type of data defined by the media. Further, the format and content of media information atoms are dictated by the media handler that is responsible for interpreting the media data stream. Another media handler would not know how to interpret this information. </p>
<p>This section describes the atoms that store media information for the video (<a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_335"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_336"></a><code>'vmhd'</code>), sound (<a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_337"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_338"></a><code>'smhd'</code>), and base (<a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_339"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_340"></a><code>'gmhd'</code>) portions of QuickTime movies. </p>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_37" title="Note"></a><p><strong>Note:</strong>&nbsp;<span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25726">“Using Sample Atoms”</a></span> discusses how the video media handler locates samples in a video media.</p></div>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25638" title="Video Media Information Atoms"></a><h3>Video Media Information Atoms</h3>
<p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_341"></a>Video media information atoms are the highest-level atoms in video media. These atoms contain a number of other atoms that define specific characteristics of the video media data. <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33008">Figure 2-18</a></span> shows the layout of a video media information atom.<a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_342"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_343"></a></p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33008" title="Figure 2-18The layout of a media information atom for video"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCGHCJJ" title="Figure 2-18The layout of a media information atom for video"></a><p><strong>Figure 2-18&nbsp;&nbsp;</strong>The layout of a media information atom for video</p><img src = "../art/qt_l_035.jpg" alt = "The layout of a media information atom for video" ></div><br/>
<p>The video media information atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this video media information atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'minf'</code>.</p></dd>
<dt>Video media information atom </dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25642">“Video Media Information Header Atoms.”</a></span> </p></dd>
<dt>Handler reference atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25621">“Handler Reference Atoms.”</a></span> </p></dd>
<dt>Data information atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25675">“Data Information Atoms.”</a></span></p></dd>
<dt>Sample table atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25685">“Sample Table Atoms.”</a></span></p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25642" title="Video Media Information Header Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCFDGIG" title="Video Media Information Header Atoms"></a><h3>Video Media Information Header Atoms</h3>
<p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_344"></a>Video media information header atoms define specific color and graphics mode information. </p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33012">Figure 2-19</a></span> shows the structure of a video media information header atom. </p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33012" title="Figure 2-19The layout of a media information header atom for video"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCJBAEC" title="Figure 2-19The layout of a media information header atom for video"></a><p><strong>Figure 2-19&nbsp;&nbsp;</strong>The layout of a media information header atom for video</p><img src = "../art/qt_l_101.gif" alt = "The layout of a media information header atom for video" width="214" height="198"></div><br/>
<p>The video media information header atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this video media information header atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'vmhd'</code>.</p></dd>
<dt>Version</dt>
<dd><p>A 1-byte specification of the version of this video media information header atom.</p></dd>
<dt>Flags</dt>
<dd><p>A 3-byte space for video media information flags. There is one defined flag.</p><p>No lean ahead</p><p>This is a compatibility flag that allows QuickTime to distinguish between movies created with QuickTime 1.0 and newer movies. You should always set this flag to 1, unless you are creating a movie intended for playback using version 1.0 of QuickTime. This flag’s value is 0x0001. </p></dd>
<dt>Graphics mode</dt>
<dd><p>A 16-bit integer that specifies the transfer mode. The transfer mode specifies which Boolean operation QuickDraw should perform when drawing or transferring an image from one location to another. See <span class="content_text"><a href="../QTFFChap4/qtff4.html#//apple_ref/doc/uid/TP40000939-CH206-18741">“Graphics Modes”</a></span> for a list of graphics modes supported by QuickTime. </p></dd>
<dt>Opcolor</dt>
<dd><p>Three 16-bit values that specify the red, green, and blue colors for the transfer mode operation indicated in the graphics mode field.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25647" title="Sound Media Information Atoms"></a><h3>Sound Media Information Atoms</h3>
<p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_345"></a>Sound media information atoms are the highest-level atoms in sound media. These atoms contain a number of other atoms that define specific characteristics of the sound media data. <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33016">Figure 2-20</a></span> shows the layout of a sound media information atom.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33016" title="Figure 2-20The layout of a media information atom for sound"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCHAAGA" title="Figure 2-20The layout of a media information atom for sound"></a><p><strong>Figure 2-20&nbsp;&nbsp;</strong>The layout of a media information atom for sound</p><img src = "../art/qt_l_104.gif" alt = "The layout of a media information atom for sound" width="305" height="182"></div><br/>
<p>The sound media information atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this sound media information atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'minf'</code>.</p></dd>
<dt>Sound media information header atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25652">“Sound Media Information Header Atoms.”</a></span></p></dd>
<dt>Handler reference atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25621">“Handler Reference Atoms.”</a></span></p></dd>
<dt>Data information atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25675">“Data Information Atoms.”</a></span></p></dd>
<dt>Sample table atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25685">“Sample Table Atoms.”</a></span></p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25652" title="Sound Media Information Header Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCFEAAI" title="Sound Media Information Header Atoms"></a><h3>Sound Media Information Header Atoms</h3>
<p>The sound media information header atom (shown in <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33020">Figure 2-21</a></span>) stores the sound media’s control information, such as balance.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33020" title="Figure 2-21The layout of a sound media information header atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCFFFBE" title="Figure 2-21The layout of a sound media information header atom"></a><p><strong>Figure 2-21&nbsp;&nbsp;</strong>The layout of a sound media information header atom</p><img src = "../art/qt_l_105.gif" alt = "The layout of a sound media information header atom" width="190" height="179"></div><br/>
<p>The sound media information header atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this sound media information header atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'smhd'</code>.</p></dd>
<dt>Version</dt>
<dd><p>A 1-byte specification of the version of this sound media information header atom.</p></dd>
<dt>Flags</dt>
<dd><p>A 3-byte space for sound media information flags. Set this field to 0.</p></dd>
<dt>Balance</dt>
<dd><p>A 16-bit integer that specifies the sound balance of this sound media. Sound balance is the setting that controls the mix of sound between the two speakers of a computer. This field is normally set to 0. See <span class="content_text"><a href="../QTFFChap4/qtff4.html#//apple_ref/doc/uid/TP40000939-CH206-18749">“Balance”</a></span> for more information about balance values. </p></dd>
<dt>Reserved</dt>
<dd><p>Reserved for use by Apple. Set this field to 0.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25658" title="Base Media Information Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCBJEBH" title="Base Media Information Atoms"></a><h3>Base Media Information Atoms</h3>
<p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_346"></a>The base media information atom (shown in <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33024">Figure 2-22</a></span>) stores the media information for media types such as text, MPEG, time code, and music.</p>
<p>Media types that are derived from the base media handler may add other atoms within the base media information atom, as appropriate. At present, the only media type that defines any additional atoms is the timecode media. See <span class="content_text"><a href="../QTFFChap3/qtff3.html#//apple_ref/doc/uid/TP40000939-CH205-57415">“Timecode Media Information Atom”</a></span> for more information about timecode media.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33024" title="Figure 2-22The layout of a base media information atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCHHJGH" title="Figure 2-22The layout of a base media information atom"></a><p><strong>Figure 2-22&nbsp;&nbsp;</strong>The layout of a base media information atom</p><img src = "../art/qt_l_206.gif" alt = "The layout of a base media information atom" width="287" height="163"></div><br/>
<p>The base media information atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this base media information atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'minf'</code>.</p></dd>
<dt>Base media information header atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25663">“Base Media Information Header Atoms.”</a></span> </p></dd>
<dt>Base media info atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25669">“Base Media Info Atoms.”</a></span> </p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25663" title="Base Media Information Header Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCIIDIA" title="Base Media Information Header Atoms"></a><h3>Base Media Information Header Atoms</h3>
<p>The base media information header atom indicates that this media information atom pertains to a base media.</p>
<p>The base media information header atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this base media information header atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'gmhd'</code>.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25669" title="Base Media Info Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCCHBFJ" title="Base Media Info Atoms"></a><h3>Base Media Info Atoms</h3>
<p>The base media info atom, contained in the base media information atom, defines the media’s control information, including graphics mode and balance information. </p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33028">Figure 2-23</a></span> shows the layout of the base media info atom.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33028" title="Figure 2-23The layout of a base media info atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCBABHB" title="Figure 2-23The layout of a base media info atom"></a><p><strong>Figure 2-23&nbsp;&nbsp;</strong>The layout of a base media info atom</p>
<img src = "../art/qt_l_207.gif" alt = "The layout of a base media info atom" width="195" height="213"></div><br/>
<p>The base media info atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this base media info atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'gmin'</code>.</p></dd>
<dt>Version</dt>
<dd><p>A 1-byte specification of the version of this base media information header atom.</p></dd>
<dt>Flags</dt>
<dd><p>A 3-byte space for base media information flags. Set this field to 0.</p></dd>
<dt>Graphics mode</dt>
<dd><p>A 16-bit integer that specifies the transfer mode. The transfer mode specifies which Boolean operation QuickDraw should perform when drawing or transferring an image from one location to another. See <span class="content_text"><a href="../QTFFChap4/qtff4.html#//apple_ref/doc/uid/TP40000939-CH206-18741">“Graphics Modes”</a></span> for more information about graphics modes supported by QuickTime. </p></dd>
<dt>Opcolor</dt>
<dd><p>Three 16-bit values that specify the red, green, and blue colors for the transfer mode operation indicated in the graphics mode field.</p></dd>
<dt>Balance</dt>
<dd><p>A 16-bit integer that specifies the sound balance of this media. Sound balance is the setting that controls the mix of sound between the two speakers of a computer. This field is normally set to 0. See <span class="content_text"><a href="../QTFFChap4/qtff4.html#//apple_ref/doc/uid/TP40000939-CH206-18749">“Balance”</a></span> for more information about balance values.</p></dd>
<dt>Reserved</dt>
<dd><p>Reserved for use by Apple. Set this field to 0.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25675" title="Data Information Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCIFAIC" title="Data Information Atoms"></a><h3>Data Information Atoms</h3>
<p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_347"></a>The handler reference atom (described in <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25621">“Handler Reference Atoms”</a></span>) contains information specifying the data handler component that provides access to the media data. The data handler component uses the data information atom to interpret the media’s data. Data information atoms have an atom type value of <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_348"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_349"></a><code>'dinf'</code>.</p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33032">Figure 2-24</a></span> shows the layout of the data information atom.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33032" title="Figure 2-24The layout of a data information atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCEFGGH" title="Figure 2-24The layout of a data information atom"></a><p><strong>Figure 2-24&nbsp;&nbsp;</strong>The layout of a data information atom</p><img src = "../art/qt_l_036.gif" alt = "The layout of a data information atom" width="235" height="558"></div><br/>
<p>The data information atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this data information atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'dinf'</code>.</p></dd>
<dt>Data reference atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25680">“Data Reference Atoms.”</a></span> </p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25680" title="Data Reference Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCGGDAE" title="Data Reference Atoms"></a><h3>Data Reference Atoms</h3>
<p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_350"></a>Data reference atoms contain tabular data that instructs the data handler component how to access the media’s data. <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_351"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_352"></a><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33032">Figure 2-24</a></span> shows the data reference atom. </p>
<p>The data reference atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this data reference atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_353"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_354"></a><code>'dref'</code>.</p></dd>
<dt>Version</dt>
<dd><p>A 1-byte specification of the version of this data reference atom.</p></dd>
<dt>Flags</dt>
<dd><p>A 3-byte space for data reference flags. Set this field to 0.</p></dd>
<dt>Number of entries</dt>
<dd><p>A 32-bit integer containing the count of data references that follow.</p></dd>
<dt>Data references</dt>
<dd><p>An array of data references. </p></dd></dl>
<p></p>
<p>Each data reference is formatted like an atom and contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in the data reference.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that specifies the type of the data in the data reference. <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-38840">Table 2-4</a></span> lists valid type values.</p></dd>
<dt>Version</dt>
<dd><p>A 1-byte specification of the version of the data reference.</p></dd>
<dt>Flags</dt>
<dd><p>A 3-byte space for data reference flags. There is one defined flag.</p><p>Self reference</p><p>This flag indicates that the media’s data is in the same file as the movie atom. On the Macintosh, and other file systems with multifork files, set this flag to 1 even if the data resides in a different fork from the movie atom. This flag’s value is 0x0001. </p></dd>
<dt>Data </dt>
<dd><p>The data reference information. </p></dd></dl>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-38840">Table 2-4</a></span> shows the currently defined data reference types that may be stored in a header atom.</p><a name="//apple_ref/doc/uid/TP40000939-CH204-38840" title="Table 2-4Data reference types "></a><a name="//apple_ref/doc/uid/TP40000939-CH204-TPXREF105" title="Table 2-4Data reference types "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">
<caption class="tablecaption"><strong>Table 2-4&nbsp;&nbsp;</strong>Data reference types </caption>

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data reference type</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
</tr>


<tr>
<td  scope="row"><p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_355"></a><code>'alis'</code></p></td>
<td ><p>Data reference is a Macintosh alias. An alias contains information about the file, including its full path name. </p></td>
</tr>
<tr>
<td  scope="row"><p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_356"></a><code>'rsrc'</code></p></td>
<td ><p>Data reference is a Macintosh alias. Appended to the end of the alias is the resource type (stored as a 32-bit integer) and ID (stored as a 16-bit signed integer) to use within the specified file.</p></td>
</tr>
<tr>
<td  scope="row"><p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_357"></a><code>'url '</code></p></td>
<td ><p>A C string that specifies a URL. There may be additional data after the C string. </p></td>
</tr>

</table></div>
<a name="//apple_ref/doc/uid/TP40000939-CH204-33307" title="Sample Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCJEIIA" title="Sample Atoms"></a><h2>Sample Atoms</h2><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_358"></a>
<p>QuickTime stores media data in samples. A sample is a single element in a sequence of time-ordered data. <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_359"></a>Samples are stored in the media, and they may have varying durations. </p>
<p>Samples are stored in a series of <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_360"></a>chunks in a media. Chunks are a collection of data samples in a media that allow optimized data access. A chunk may contain one or more samples. Chunks in a media may have different sizes, and the individual samples within a chunk may have different sizes from one another, as shown in <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33036">Figure 2-25</a></span>.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33036" title="Figure 2-25Samples in a media"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCDBFGE" title="Figure 2-25Samples in a media"></a><p><strong>Figure 2-25&nbsp;&nbsp;</strong>Samples in a media</p>
<img src = "../art/qt_l_037.gif" alt = "Samples in a media" width="183" height="335"></div><br/>
<p>One way to describe a sample is to use a <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_361"></a>sample table atom. The sample table atom acts as a storehouse of information about the samples and contains a number of different types of atoms. The various atoms contain information that allows the media handler to parse the samples in the proper order. This approach enforces an ordering of the samples without requiring that the sample data be stored sequentially with respect to movie time in the actual data stream. </p>
<p>The next section discusses the sample table atom. Subsequent sections discuss each of the atoms that may reside in a sample table atom.</p>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25685" title="Sample Table Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCBFDFF" title="Sample Table Atoms"></a><h3>Sample Table Atoms</h3>
<p>The sample table atom contains information for converting from media time to sample number to sample location. This atom also indicates how to interpret the sample (for example, whether to decompress the video data and, if so, how). This section describes the format and content of the sample table atom.</p>
<p>The sample table atom has an atom type of <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_362"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_363"></a><code>'stbl'</code>. It can contain the sample description atom, the time-to-sample atom, the sync sample atom, the sample-to-chunk atom, the sample size atom, the chunk offset atom, and the shadow sync atom.</p>
<p>The sample table atom contains all the time and data indexing of the media samples in a track. Using tables, it is possible to locate samples in time, determine their type, and determine their size, container, and offset into that container.</p>
<p>If the track that contains the sample table atom references no data, then the sample table atom does not need to contain any child atoms (not a very useful media track).</p>
<p>If the track that the sample table atom is contained in does reference data, then the following child atoms are required: sample description, sample size, sample to chunk, and chunk offset. All of the subtables of the sample table use the same total sample count. </p>
<p>The sample description atom must contain at least one entry. A sample description atom is required because it contains the data reference index field that indicates which data reference atom to use to retrieve the media samples. Without the sample description, it is not possible to determine where the media samples are stored. The sync sample atom is optional. If the sync sample atom is not present, all samples are implicitly sync samples.</p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33040">Figure 2-26</a></span> shows the layout of the sample table atom. </p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33040" title="Figure 2-26The layout of a sample table atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCJFDFI" title="Figure 2-26The layout of a sample table atom"></a><p><strong>Figure 2-26&nbsp;&nbsp;</strong>The layout of a sample table atom</p>
<img src = "../art/qt_l_038.gif" alt = "The layout of a sample table atom" width="252" height="220"></div><br/>
<p>The sample table atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this sample table atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'stbl'</code>.</p></dd>
<dt>Sample description atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25691">“Sample Description Atoms.”</a></span></p></dd>
<dt>Time-to-sample atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25696">“Time-to-Sample Atoms.”</a></span></p></dd>
<dt>Sync sample atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25701">“Sync Sample Atoms.”</a></span></p></dd>
<dt>Sample-to-chunk atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25706">“Sample-to-Chunk Atoms.”</a></span></p></dd>
<dt>Sample size atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25710">“Sample Size Atoms.”</a></span></p></dd>
<dt>Chunk offset atom</dt>
<dd><p>See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25715">“Chunk Offset Atoms.”</a></span></p></dd>
<dt>Shadow sync atom</dt>
<dd><p>Reserved for future use. </p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25691" title="Sample Description Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCHHGBH" title="Sample Description Atoms"></a><h3>Sample Description Atoms</h3>
<p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_364"></a>The sample description atom stores information that allows you to decode samples in the media. The data stored in the sample description varies, depending on the media type. For example, in the case of video media, the sample descriptions are image description structures. The sample description information for each media type is explained in <span class="content_text"><a href="../QTFFChap3/qtff3.html#//apple_ref/doc/uid/TP40000939-CH205-SW1">“Media Data Atom Types”</a></span> </p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33044">Figure 2-27</a></span> shows the layout of the sample description atom.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33044" title="Figure 2-27The layout of a sample description atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCIHBFD" title="Figure 2-27The layout of a sample description atom"></a><p><strong>Figure 2-27&nbsp;&nbsp;</strong>The layout of a sample description atom</p><img src = "../art/qt_l_109.gif" alt = "The layout of a sample description atom" width="212" height="181"></div><br/>
<p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_365"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_366"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_367"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_368"></a>The sample description atom has an atom type of <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_369"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_370"></a><code>'stsd'</code>. The sample description atom contains a table of sample descriptions. A media may have one or more sample descriptions, depending upon the number of different encoding schemes used in the media and on the number of files used to store the data. The sample-to-chunk atom identifies the sample description for each sample in the media by specifying the index into this table for the appropriate description (see <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25706">“Sample-to-Chunk Atoms”</a></span>).</p>
<p>The sample description atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this sample description atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'stsd'</code>.</p></dd>
<dt>Version</dt>
<dd><p>A 1-byte specification of the version of this sample description atom.</p></dd>
<dt>Flags</dt>
<dd><p>A 3-byte space for sample description flags. Set this field to 0.</p></dd>
<dt>Number of entries</dt>
<dd><p>A 32-bit integer containing the number of sample descriptions that follow.</p></dd>
<dt>Sample description table </dt>
<dd><p>An array of sample descriptions. For details, see <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-61112">“General Structure of a Sample Description.”</a></span></p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-61112" title="General Structure of a Sample Description"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCFCHBA" title="General Structure of a Sample Description"></a><h4>General Structure of a Sample Description</h4>
<p>While the exact format of the sample description varies by media type, the first four fields of every sample description are the same.</p>
<dl class="termdef">	<dt>Sample description size</dt>
<dd><p> A 32-bit integer indicating the number of bytes in the sample description.</p></dd>
<dt>Data format</dt>
<dd><p>A 32-bit integer indicating the format of the stored data. This depends on the media type, but is usually either the compression format or the media type.</p></dd>
<dt>Reserved</dt>
<dd><p>Six bytes that must be set to 0.</p></dd>
<dt>Data reference index</dt>
<dd><p>A 16-bit integer that contains the index of the data reference to use to retrieve data associated with samples that use this sample description. Data references are stored in data reference atoms.</p></dd></dl>
<p>These four fields may be followed by additional data specific to the media type and data format. See <span class="content_text"><a href="../QTFFChap3/qtff3.html#//apple_ref/doc/uid/TP40000939-CH205-SW1">“Media Data Atom Types”</a></span> for additional details regarding specific media types and media formats.</p>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25696" title="Time-to-Sample Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCGFJII" title="Time-to-Sample Atoms"></a><h3>Time-to-Sample Atoms</h3>
<p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_371"></a>Time-to-sample atoms store duration information for a media’s samples, providing a mapping from a time in a media to the corresponding data sample. The time-to-sample atom has an atom type of <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_372"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_373"></a><code>'stts'</code>.</p>
<p>You can determine the appropriate sample for any time in a media by examining the time-to-sample atom table, which is contained in the time-to-sample atom.</p>
<p>The atom contains a compact version of a table that allows indexing from time to sample number. Other tables provide sample sizes and pointers from the sample number. Each entry in the table gives the number of consecutive samples with the same time delta, and the delta of those samples. By adding the deltas, a complete time-to-sample map can be built.</p>
<p>The atom contains time deltas: <code>DT(n+1)
= DT(n) + STTS(n)</code> where <code>STTS(n)</code> is the (uncompressed) table entry for sample n and DT is the display time for sample (n). The sample entries are ordered by time stamps; therefore, the deltas are all nonnegative. The DT axis has a zero origin; <code>DT(i) = SUM (</code>for<code> j=0 </code>to<code> i-1 </code>of<code> delta(j)</code>), and the sum of all deltas gives the length of the media in the track (not mapped to the overall time scale, and not considering any edit list). The edit list atom provides the initial DT value if it is nonempty (nonzero).</p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33048">Figure 2-28</a></span> shows the layout of the time-to-sample atom.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33048" title="Figure 2-28The layout of a time-to-sample atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCIFAJB" title="Figure 2-28The layout of a time-to-sample atom"></a><p><strong>Figure 2-28&nbsp;&nbsp;</strong>The layout of a time-to-sample atom</p>
<img src = "../art/qt_l_106.gif" alt = "The layout of a time-to-sample atom" width="209" height="180"></div><br/>
<p>The time-to-sample atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this time-to-sample atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'stts'</code>.</p></dd>
<dt>Version</dt>
<dd><p>A 1-byte specification of the version of this time-to-sample atom.</p></dd>
<dt>Flags</dt>
<dd><p>A 3-byte space for time-to-sample flags. Set this field to 0.</p></dd>
<dt>Number of entries</dt>
<dd><p>A 32-bit integer containing the count of entries in the time-to-sample table.</p></dd>
<dt>Time-to-sample table</dt>
<dd><p>A table that defines the duration of each sample in the media. Each table entry contains a count field and a duration field. The structure of the time-to-sample table is shown in <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33052">Figure 2-29</a></span>.</p></dd></dl>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33052" title="Figure 2-29The layout of a time-to-sample table entry"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCJDBID" title="Figure 2-29The layout of a time-to-sample table entry"></a><p><strong>Figure 2-29&nbsp;&nbsp;</strong>The layout of a time-to-sample table entry</p><img src = "../art/qt_l_113.gif" alt = "The layout of a time-to-sample table entry" width="220" height="62"></div><br/>
<p>You define a time-to-sample table entry by specifying these fields:</p>
<dl class="termdef">	<dt>Sample count</dt>
<dd><p>A 32-bit integer that specifies the number of consecutive samples that have the same duration.</p></dd>
<dt>Sample duration</dt>
<dd><p>A 32-bit integer that specifies the duration of each sample.</p></dd></dl>
<p>Entries in the table describe samples according to their order in the media and their duration. If consecutive samples have the same duration, a single table entry can be used to define more than one sample. In these cases, the count field indicates the number of consecutive samples that have the same duration. For example, if a video media has a constant frame rate, this table would have one entry and the count would be equal to the number of samples. </p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33056">Figure 2-30</a></span> presents an example of a time-to-sample table that is based on the chunked media data shown in <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33036">Figure 2-25</a></span>. That data stream contains a total of nine samples that correspond in count and duration to the entries of the table shown here. Even though samples 4, 5, and 6 are in the same chunk, sample 4 has a duration of 3, and samples 5 and 6 have a duration of 2.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33056" title="Figure 2-30An example of a time-to-sample table"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCHCIEA" title="Figure 2-30An example of a time-to-sample table"></a><p><strong>Figure 2-30&nbsp;&nbsp;</strong>An example of a time-to-sample table</p>
<img src = "../art/qt_l_039.gif" alt = "An example of a time-to-sample table" width="186" height="128"></div><br/>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25701" title="Sync Sample Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCBDIDH" title="Sync Sample Atoms"></a><h3>Sync Sample Atoms</h3>
<p>The <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_374"></a>sync sample atom identifies the <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_375"></a>key frames in the media. In a media that contains compressed data, key frames define starting points for portions of a temporally compressed sequence. The key frame is self-contained—that is, it is independent of preceding frames. Subsequent frames may depend on the key frame.</p>
<p>The sync sample atom provides a compact marking of the random access points within a stream. The table is arranged in strictly increasing order of sample number. If this table is not present, every sample is implicitly a random access point.</p>
<p>Sync sample atoms have an atom type of <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_376"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_377"></a><code>'stss'</code>. The sync sample atom contains a table of sample numbers. Each entry in the table identifies a sample that is a key frame for the media. If no sync sample atom exists, then all the samples are key frames.</p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33060">Figure 2-31</a></span> shows the layout of a sync sample atom.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33060" title="Figure 2-31The layout of a sync sample atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCIDCIB" title="Figure 2-31The layout of a sync sample atom"></a><p><strong>Figure 2-31&nbsp;&nbsp;</strong>The layout of a sync sample atom</p>
<img src = "../art/qt_l_111.gif" alt = "The layout of a sync sample atom" width="212" height="182"></div><br/>
<p>The sync sample atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this sync sample atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'stss'</code>.</p></dd>
<dt>Version</dt>
<dd><p>A 1-byte specification of the version of this sync sample atom.</p></dd>
<dt>Flags</dt>
<dd><p>A 3-byte space for sync sample flags. Set this field to 0.</p></dd>
<dt>Number of entries</dt>
<dd><p>A 32-bit integer containing the count of entries in the sync sample table.</p></dd>
<dt>Sync sample table</dt>
<dd><p>A table of sample numbers; each sample number corresponds to a key frame. <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33064">Figure 2-32</a></span> shows the layout of the sync sample table.</p></dd></dl>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33064" title="Figure 2-32The layout of a sync sample table"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCDBBDH" title="Figure 2-32The layout of a sync sample table"></a><p><strong>Figure 2-32&nbsp;&nbsp;</strong>The layout of a sync sample table</p>
<img src = "../art/qt_l_115.gif" alt = "The layout of a sync sample table" width="154" height="110"></div><br/>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25706" title="Sample-to-Chunk Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCIDAFD" title="Sample-to-Chunk Atoms"></a><h3>Sample-to-Chunk Atoms</h3>
<p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_378"></a>As samples are added to a media, they are collected into chunks that allow optimized data access. A chunk contains one or more samples. Chunks in a media may have different sizes, and the samples within a chunk may have different sizes. The sample-to-chunk atom stores chunk information for the samples in a media. </p>
<p>Sample-to-chunk atoms have an atom type of <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_379"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_380"></a><code>'stsc'</code>. The sample-to-chunk atom contains a table that maps samples to chunks in the media data stream. By examining the sample-to-chunk atom, you can determine the chunk that contains a specific sample.</p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33068">Figure 2-33</a></span> shows the layout of the sample-to-chunk atom.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33068" title="Figure 2-33The layout of a sample-to-chunk atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCIHJEB" title="Figure 2-33The layout of a sample-to-chunk atom"></a><p><strong>Figure 2-33&nbsp;&nbsp;</strong>The layout of a sample-to-chunk atom</p>
<img src = "../art/qt_l_107.gif" alt = "The layout of a sample-to-chunk atom" width="202" height="181"></div><br/>
<p>The sample-to-chunk atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this sample-to-chunk atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'stsc'</code>.</p></dd>
<dt>Version</dt>
<dd><p>A 1-byte specification of the version of this sample-to-chunk atom.</p></dd>
<dt>Flags</dt>
<dd><p>A 3-byte space for sample-to-chunk flags. Set this field to 0.</p></dd>
<dt>Number of entries</dt>
<dd><p>A 32-bit integer containing the count of entries in the sample-to-chunk table.</p></dd>
<dt>Sample-to-chunk table</dt>
<dd><p>A table that maps samples to chunks. <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33072">Figure 2-34</a></span> shows the structure of an entry in a sample-to-chunk table. Each sample-to-chunk atom contains such a table, which identifies the chunk for each sample in a media. Each entry in the table contains a first chunk field, a samples per chunk field, and a sample description ID field. From this information, you can ascertain where samples reside in the media data.</p></dd></dl>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33072" title="Figure 2-34The layout of a sample-to-chunk table entry"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCEJCGE" title="Figure 2-34The layout of a sample-to-chunk table entry"></a><p><strong>Figure 2-34&nbsp;&nbsp;</strong>The layout of a sample-to-chunk table entry</p><img src = "../art/qt_l_114.gif" alt = "The layout of a sample-to-chunk table entry" width="342" height="62"></div><br/>
<p>You define a sample-to-chunk table entry by specifying the following data elements.</p>
<dl class="termdef">	<dt>First chunk</dt>
<dd><p>The first chunk number using this table entry.</p></dd>
<dt>Samples per chunk</dt>
<dd><p>The number of samples in each chunk.</p></dd>
<dt>Sample description ID</dt>
<dd><p>The identification number associated with the sample description for the sample. For details on sample description atoms, see <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25691">“Sample Description Atoms.”</a></span></p></dd></dl>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-38960">Figure 2-35</a></span> shows an example of a sample-to-chunk table that is based on the data stream shown in <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33036">Figure 2-25</a></span>. </p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-38960" title="Figure 2-35An example of a sample-to-chunk table"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCDEEIG" title="Figure 2-35An example of a sample-to-chunk table"></a><p><strong>Figure 2-35&nbsp;&nbsp;</strong>An example of a sample-to-chunk table</p>
<img src = "../art/qt_l_040.gif" alt = "An example of a sample-to-chunk table" width="283" height="124"></div><br/>
<p>Each table entry corresponds to a set of consecutive chunks, each of which contains the same number of samples. Furthermore, each of the samples in these chunks must use the same sample description. Whenever the number of samples per chunk or the sample description changes, you must create a new table entry. If all the chunks have the same number of samples per chunk and use the same sample description, this table has one entry.</p>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25710" title="Sample Size Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCBBCGB" title="Sample Size Atoms"></a><h3>Sample Size Atoms</h3>
<p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_381"></a>You use sample size atoms to specify the size of each sample in the media. <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_382"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_383"></a>Sample size atoms have an atom type of <code>'stsz'</code>. </p>
<p>The sample size atom contains the sample count and a table giving the size of each sample. This allows the media data itself to be unframed. The total number of samples in the media is always indicated in the sample count. If the default size is indicated, then no table follows.</p>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33080">Figure 2-36</a></span> shows the layout of the sample size atom.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33080" title="Figure 2-36The layout of a sample size atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCJDFDB" title="Figure 2-36The layout of a sample size atom"></a><p><strong>Figure 2-36&nbsp;&nbsp;</strong>The layout of a sample size atom</p>
<img src = "../art/qt_l_108.gif" alt = "The layout of a sample size atom" width="212" height="204"></div><br/>
<p>The sample size atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this sample size atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'stsz'</code>.</p></dd>
<dt>Version</dt>
<dd><p>A 1-byte specification of the version of this sample size atom.</p></dd>
<dt>Flags</dt>
<dd><p>A 3-byte space for sample size flags. Set this field to 0.</p></dd>
<dt>Sample size</dt>
<dd><p>A 32-bit integer specifying the sample size. If all the samples are the same size, this field contains that size value. If this field is set to 0, then the samples have different sizes, and those sizes are stored in the sample size table. </p></dd>
<dt>Number of entries</dt>
<dd><p>A 32-bit integer containing the count of entries in the sample size table.</p></dd>
<dt>Sample size table</dt>
<dd><p>A table containing the sample size information. The sample size table contains an entry for every sample in the media’s data stream. Each table entry contains a size field. The size field contains the size, in bytes, of the sample in question. The table is indexed by sample number—the first entry corresponds to the first sample, the second entry is for the second sample, and so on.</p></dd></dl>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33084">Figure 2-37</a></span> shows a sample size table.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33084" title="Figure 2-37An example of a sample size table"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCFHFGA" title="Figure 2-37An example of a sample size table"></a><p><strong>Figure 2-37&nbsp;&nbsp;</strong>An example of a sample size table</p>
<img src = "../art/qt_l_042.gif" alt = "An example of a sample size table" width="152" height="110"></div><br/>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25715" title="Chunk Offset Atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCHAEEA" title="Chunk Offset Atoms"></a><h3>Chunk Offset Atoms</h3>
<p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_384"></a>Chunk offset atoms identify the location of each chunk of data in the media’s data stream. Chunk offset atoms have an atom type of <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_385"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_386"></a><code>'stco'</code>. </p>
<p>The chunk-offset table gives the index of each chunk into the containing file. There are two variants, permitting the use of 32-bit or 64-bit offsets. The latter is useful when managing very large movies. Only one of these variants occurs in any single instance of a sample table atom.</p>
<p>Note that offsets are file offsets, not the offset into any atom within the file (for example, a <code>'mdat'</code> atom). This permits referring to media data in files without any atom structure. However, be careful when constructing a self-contained QuickTime file with its metadata (movie atom) at the front because the size of the movie atom affects the chunk offsets to the media data.</p>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_38" title="Note"></a><p><strong>Note:</strong>&nbsp;The sample table atom can contain a 64-bit chunk offset atom (<code>STChunkOffset64AID
= 'co64'</code>). When this atom appears, it is used in place of the original chunk offset atom, which can contain only 32-bit offsets. When QuickTime writes movie files, it uses the 64-bit chunk offset atom only if there are chunks that use the high 32-bits of the chunk offset. Otherwise, the original 32-bit chunk offset atom is used to ensure compatibility with previous versions of QuickTime. </p></div>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33088">Figure 2-38</a></span> shows the layout of a chunk offset atom. </p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33088" title="Figure 2-38The layout of a chunk offset atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCFGHFD" title="Figure 2-38The layout of a chunk offset atom"></a><p><strong>Figure 2-38&nbsp;&nbsp;</strong>The layout of a chunk offset atom</p>
<img src = "../art/qt_l_112.gif" alt = "The layout of a chunk offset atom" width="207" height="181"></div><br/>
<p>The chunk offset atom contains the following data elements.</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>A 32-bit integer that specifies the number of bytes in this chunk offset atom.</p></dd>
<dt>Type</dt>
<dd><p>A 32-bit integer that identifies the atom type; this field must be set to <code>'stco'</code>.</p></dd>
<dt>Version</dt>
<dd><p>A 1-byte specification of the version of this chunk offset atom.</p></dd>
<dt>Flags</dt>
<dd><p>A 3-byte space for chunk offset flags. Set this field to 0.</p></dd>
<dt>Number of entries</dt>
<dd><p>A 32-bit integer containing the count of entries in the chunk offset table.</p></dd>
<dt>Chunk offset table</dt>
<dd><p>A chunk offset table consisting of an array of offset values. There is one table entry for each chunk in the media. The offset contains the byte offset from the beginning of the data stream to the chunk. The table is indexed by chunk number—the first table entry corresponds to the first chunk, the second table entry is for the second chunk, and so on. </p></dd></dl>
<p><span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-33092">Figure 2-39</a></span> shows an example of a chunk offset table. </p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33092" title="Figure 2-39An example of a chunk offset table"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCGFFBH" title="Figure 2-39An example of a chunk offset table"></a><p><strong>Figure 2-39&nbsp;&nbsp;</strong>An example of a chunk offset table</p>
<img src = "../art/qt_l_041.gif" alt = "An example of a chunk offset table" width="143" height="110"></div><br/>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25726" title="Using Sample Atoms "></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCBIDGD" title="Using Sample Atoms "></a><h3>Using Sample Atoms </h3><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_387"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_388"></a>
<p>This section presents examples using the atoms just described. These examples are intended to help you understand the relationships between these atoms.</p>
<p>The first section, <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25733">“Finding a Sample,”</a></span> describes the steps that the video media handler uses to find the sample that contains the media data for a particular time in a media. The second section, <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25739">“Finding a Key Frame,”</a></span> describes the steps that the video media handler uses to find an appropriate key frame for a specific time in a movie.</p>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25733" title="Finding a Sample"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCDGDDF" title="Finding a Sample"></a><h4>Finding a Sample</h4>
<p>When QuickTime displays a movie or track, it “tells” the appropriate media handler to access the media data for a particular time. The media handler must correctly interpret the data stream to retrieve the requested data. In the case of video media, the media handler traverses several atoms to find the location and size of a sample for a given media time. </p>
<p>The media handler performs the following steps:</p>
<ol class="ol"><li class="li"><p>Determines the time in the media time coordinate system.</p></li>
<li class="li"><p>Examines the time-to-sample atom to determine the sample number that contains the data for the specified time.</p></li>
<li class="li"><p>Scans the sample-to-chunk atom to discover which chunk contains the sample in question.</p></li>
<li class="li"><p>Extracts the offset to the chunk from the chunk offset atom.</p></li>
<li class="li"><p>Finds the offset within the chunk and the sample’s size by using the sample size atom.</p></li></ol>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25739" title="Finding a Key Frame"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCGAGJJ" title="Finding a Key Frame"></a><h4>Finding a Key Frame</h4>
<p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_389"></a>Finding a key frame for a specified time in a movie is slightly more complicated than finding a sample for a specified time. The media handler must use the sync sample atom and the time-to-sample atom together in order to find a key frame.</p>
<p>The media handler performs the following steps:</p>
<ol class="ol"><li class="li"><p>Examines the time-to-sample atom to determine the sample number that contains the data for the specified time.</p></li>
<li class="li"><p>Scans the sync sample atom to find the key frame that precedes the sample number chosen in step 1.</p></li>
<li class="li"><p>Scans the sample-to-chunk atom to discover which chunk contains the key frame.</p></li>
<li class="li"><p>Extracts the offset to the chunk from the chunk offset atom.</p></li>
<li class="li"><p>Finds the offset within the chunk and the sample’s size by using the sample size atom.</p></li></ol>
<a name="//apple_ref/doc/uid/TP40000939-CH204-33313" title="Compressed Movie Resources"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCDACCD" title="Compressed Movie Resources"></a><h2>Compressed Movie Resources</h2>
<p>Most QuickTime movies have metadata in addition to their media data. Media data can be <a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_390"></a>compressed using a variety of video and sound compression algorithms. Beginning with QuickTime 3, it also became possible to compress the<a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_391"></a> metadata—more commonly known as the movie resource. However, the movie resource cannot be compressed by means of a lossy compression algorithm because it contains critical information, such as the video and audio compression types used, individual frame offsets, and timing information. To compress the movie resource, therefore, lossless data compression algorithms must be used. </p>
<p>Compressing movie resources using data compression typically reduces the size of the movie resource by 50% or more. For QuickTime movies that are streamed over the Internet, this can substantially reduce the startup latency of the movie, and therefore has a number of distinct advantages.</p>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25744" title="Allowing QuickTime to Compress the Movie Resource"></a><h3>Allowing QuickTime to Compress the Movie Resource</h3>
<p>Most application developers won’t need to know the details of how movie resources are compressed. The Movie Toolbox <code>FlattenMovie</code> and <code>FlattenMovieData</code> functions compress the movie resource if so requested by the application. To accomplish this, applications only need to set the <code>flattenCompressMovieResource</code> flag when calling either function. The QuickTime movie export component also provides users with the option of compressing the movie resource when exporting or creating a new movie through export.</p>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25750" title="Structure of a Compressed Movie Resource"></a><h3>Structure of a Compressed Movie Resource</h3>
<p>A compressed movie resource, similar to an uncompressed movie resource, is made up of a group of QuickTime atoms arranged in a hierarchy. </p>
<p>Like an uncompressed movie resource, the outermost atom is a movie atom. Within the movie atom, there is a single compressed movie atom, which contains all other required atoms. The compressed movie atom has two subatoms. The first is a data compression atom, which contains a single 32-bit integer that identifies what lossless data compression algorithm was used to compress the movie resource. The second child atom is the compressed movie data, which contains the compressed movie resource itself. The first 32-bit integer in the compressed movie data atom indicates the uncompressed size of the movie resource, and then the compressed movie resource data follows.</p>
<p>The contents of a complete compressed movie are shown in <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-39086">Table 2-5</a></span>. The constants that define the atom types are defined in <code>MoviesFormat.h</code>. The four-character codes for each atom type are also shown.</p>
<a name="//apple_ref/doc/uid/TP40000939-CH204-39086" title="Table 2-5Contents of complete compressed movie "></a><a name="//apple_ref/doc/uid/TP40000939-CH204-TPXREF106" title="Table 2-5Contents of complete compressed movie "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">
<caption class="tablecaption"><strong>Table 2-5&nbsp;&nbsp;</strong>Contents of complete compressed movie </caption>

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Atom type</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Four-character code</p></th>
</tr>


<tr>
<td  scope="row"><p>Movie </p></td>
<td ><p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_392"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_393"></a><code>'moov'</code></p></td>
</tr>
<tr>
<td  scope="row"><p>Compressed movie</p></td>
<td ><p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_394"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_395"></a><code>'cmov'</code></p></td>
</tr>
<tr>
<td  scope="row"><p>Data compression atom</p></td>
<td ><p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_396"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_397"></a><code>'dcom'</code></p></td>
</tr>
<tr>
<td  scope="row"><p>Compressed movie data</p></td>
<td ><p><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_398"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_399"></a><code>'cmvd'</code></p></td>
</tr>
<tr>
<td  scope="row"><p>32-bit integer</p></td>
<td ><p>Uncompressed size</p></td>
</tr>

</table></div>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25756" title="Reference Movies"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCCHCDJ" title="Reference Movies"></a><h2>Reference Movies</h2>
<p>A QuickTime movie can act as a container for a set of alternate movies that should be displayed under specified conditions. One of these movies may be contained within the same file; any others are included by reference.</p>
<p>For example, a QuickTime movie can contain a list of references to movies having different data rates, allowing an application to choose the best-looking movie that can play smoothly as it downloads over the Internet, based on the user’s connection speed. </p>
<p>A movie that contains references to alternate movies is called a reference movie.</p>
<p>A reference movie contains a reference movie atom (<code>'rmra'</code>) at the top level of the movie atom. The movie atom may also contain a movie header atom, or it may contain the reference movie atom alone.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33096" title="Figure 2-40A movie atom containing a &#39;rmra&#39; atom instead of a &#39;mvhd&#39; atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-TPXREF107" title="Figure 2-40A movie atom containing a &#39;rmra&#39; atom instead of a &#39;mvhd&#39; atom"></a><p><strong>Figure 2-40&nbsp;&nbsp;</strong>A movie atom containing a <code>'rmra'</code> atom instead of a <code>'mvhd'</code> atom</p>
<img src = "../art/qt_l_028a.gif" alt = "A movie atom containing a 'rmra' atom instead of a 'mvhd' atom" width="259" height="143"></div><br/>
<p>The reference movie atom contains one or more reference movie descriptor atoms, each of which describes an alternate movie.</p>
<p>Each reference movie descriptor atom contains a data reference atom, which specifies the location of a movie.</p>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_39" title="Note"></a><p><strong>Note:</strong>&nbsp;Movie locations are specified using QuickTime data references. QuickTime supports multiple types of data reference, but alternate movies are generally specified using data reference types of either url (<code>'url
'</code>) or file alias (<code>'alis'</code>).</p></div>
<p>A reference movie descriptor atom may contain other atoms that specify the movie’s system requirements and the movie quality. If so, there will be an atom of an appropriate type for each requirement that must be met for the movie to play, and there may be a quality atom as well. </p>
<p>Applications should play the highest-quality movie whose requirements are met by the user’s system. If the data reference to the selected movie cannot be resolved—because the file cannot be found, for example—the application should recursively attempt to play the next-highest-quality movie until it succeeds or has exhausted the list of movies whose requirements are met.</p>
<p>If a movie contains both a reference movie atom and a movie header atom, applications should play the appropriate movie indicated by the reference movie atom. </p>
<p>If the user’s system does not meet any of the alternate movies’ criteria, or none of the qualifying data references can be resolved, applications should play the movie defined in the movie header atom. (The movie defined in the movie header atom can also be indicated by one of the alternate movie references.)</p>
<p>The movie header atom is sometimes used to provide a fallback movie for applications that can play older QuickTime movies but do not understand reference movies.</p>
<p>When parsing a reference movie, the reader should treat the URL or file reference in the reference movie atom as a new starting point, making no assumptions that the reference is a valid URL, or an existing file, or a well-formed and playable QuickTime movie.</p>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25770" title="Reference Movie Atom"></a><h3>Reference Movie Atom</h3>
<p>A reference movie atom contains references to one or more movies. It can optionally contain a list of system requirements in order for each movie to play, and a quality rating for each movie. It is typically used to specify a list of alternate movies to be played under different conditions.</p>
<p>A reference movie atom’s parent is always a movie atom (<code>'moov'</code>). Only one reference movie atom is allowed in a given movie atom.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33103" title="Figure 2-41A &#39;rmra&#39; atom with multiple &#39;rmda&#39; atoms"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-TPXREF108" title="Figure 2-41A &#39;rmra&#39; atom with multiple &#39;rmda&#39; atoms"></a><p><strong>Figure 2-41&nbsp;&nbsp;</strong>A<code> 'rmra'</code> atom with multiple <code>'rmda'</code> atoms</p>
<img src = "../art/qt_l_028b.jpg" alt = "A 'rmra' atom with multiple 'rmda' atoms" ></div><br/>
<p>A reference movie atom may contain the following fields:</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>The number of bytes in this reference movie atom.</p></dd>
<dt>Type</dt>
<dd><p>The type of this atom; this field must be set to <code>'rmra'</code>.</p></dd>
<dt>Reference movie descriptor atom</dt>
<dd><p> A reference movie atom must contain at least one reference movie descriptor atom, and typically contains more than one. See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25776">“Reference Movie Descriptor Atom”</a></span> for more information.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25776" title="Reference Movie Descriptor Atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCGAIFH" title="Reference Movie Descriptor Atom"></a><h3>Reference Movie Descriptor Atom</h3>
<p>Each reference movie descriptor atom contains other atoms that describe where a particular movie can be found, and optionally what the system requirements are to play that movie, as well as an optional quality rating for that movie.</p>
<p>A reference movie descriptor atom’s parent is always a movie reference atom (<code>'rmra'</code>). Multiple reference movie descriptor atoms are allowed in a given movie reference atom, and more than one is usually present.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000939-CH204-33110" title="Figure 2-42Reference movie descriptor atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-TPXREF109" title="Figure 2-42Reference movie descriptor atom"></a><p><strong>Figure 2-42&nbsp;&nbsp;</strong>Reference movie descriptor atom</p>
<img src = "../art/qt_l_028c.jpg" alt = "Reference movie descriptor atom" ></div><br/>
<p>A reference movie descriptor atom may contain the following fields:</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>The number of bytes in this reference movie descriptor atom.</p></dd>
<dt>Type</dt>
<dd><p>The type of this atom; this field must be set to <code>'rmda'</code>.</p></dd>
<dt>Data reference atom</dt>
<dd><p>Each reference movie atom must contain exactly one data reference atom. See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25680">“Data Reference Atoms”</a></span> for more information.</p></dd>
<dt>Data rate atom</dt>
<dd><p>A reference movie atom may contain an optional data rate atom. Only one data rate atom can be present. See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25786">“Data Rate Atom”</a></span> for more information.</p></dd>
<dt>CPU speed atom</dt>
<dd><p>A reference movie atom may contain an optional CPU speed atom. Only one CPU speed atom can be present. See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25792">“CPU Speed Atom”</a></span> for more information.</p></dd>
<dt>Version check atom</dt>
<dd><p>A reference movie atom may contain an optional version check atom. Multiple version check atoms can be present. See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25804">“Version Check Atom”</a></span> for more information.</p></dd>
<dt>Component detect atom</dt>
<dd><p> A reference movie atom may contain an optional component detect atom. Multiple component detect atoms can be present. See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25810">“Component Detect Atom”</a></span> for more information.</p></dd>
<dt>Quality atom</dt>
<dd><p>A reference movie atom may contain an optional quality atom. Only one quality atom can be present. See <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25822">“Quality Atom”</a></span> for more information.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25781" title="Data Reference Atom"></a><h3>Data Reference Atom</h3>
<p>A data reference atom contains the information necessary to locate a movie, or a stream or file that QuickTime can play, typically in the form of a URL or a file alias.</p>
<p>Only one data reference atom is allowed in a given movie reference descriptor atom.</p>
<p>A data reference atom may contain the following fields:</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>The number of bytes in this data reference atom.</p></dd>
<dt>Type</dt>
<dd><p>The type of this atom; this field must be set to <code>'rdrf'</code>.</p></dd>
<dt>Flags</dt>
<dd><p>A 32-bit integer containing flags. One flag is currently defined: movie is self-contained.  If the least-significant bit is set to 1, the movie is self-contained. This requires that the parent movie contain a movie header atom as well as a reference movie atom. In other words, the current <code>'moov'</code> atom must contain both a <code>'rmra'</code> atom and a <code>'mvhd' </code>atom. To resolve this data reference, an application uses the movie defined in the movie header atom, ignoring the remainder of the fields in this data reference atom, which are used only to specify external movies.</p></dd>
<dt>Data reference type</dt>
<dd><p>The data reference type. A value of <code>'alis'</code> indicates a file system alias record. A value of <code>'url
'</code> indicates a string containing a uniform resource locator. Note that the fourth character in <code>'url
'</code> is an ASCII blank (0x20).</p></dd>
<dt>Data reference size</dt>
<dd><p>The size of the data reference in bytes, expressed as a 32-bit integer.</p></dd>
<dt>Data reference</dt>
<dd><p>A data reference to a QuickTime movie, or to a stream or file that QuickTime can play. If the reference type is <code>'alis'</code> this field contains the contents of an <code>AliasHandle</code>. If the reference type is <code>'url '</code> this field contains a null-terminated string that can be interpreted as a URL. The URL can be absolute or relative, and can specify any protocol that QuickTime supports, including <code>http://</code>,<code> ftp://</code>,  <code>rtsp://</code>, <code>file:///</code>, and <code>data:</code>.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25786" title="Data Rate Atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCBFABB" title="Data Rate Atom"></a><h3>Data Rate Atom</h3>
<p>A data rate atom specifies the minimum data rate required to play a movie. This is normally compared to the connection speed setting in the user’s QuickTime Settings control panel. Applications should play the movie with the highest data rate less than or equal to the user’s connection speed. If the connection speed is slower than any movie’s data rate, applications should play the movie with the lowest data rate. The movie with the highest data rate is assumed to have the highest quality.</p>
<p>Only one data rate atom is allowed in a given reference movie descriptor atom.</p>
<p>A data rate atom may contain the following fields:</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>The number of bytes in this data rate atom.</p></dd>
<dt>Type</dt>
<dd><p>The type of this atom; this field must be set to <code>'rmdr'</code>.</p></dd>
<dt>Flags</dt>
<dd><p>A 32-bit integer that is currently always 0.</p></dd>
<dt>Data rate</dt>
<dd><p>The required data rate in bits per second, expressed as a 32-bit integer.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25792" title="CPU Speed Atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCHIHCI" title="CPU Speed Atom"></a><h3>CPU Speed Atom</h3>
<p>A CPU speed atom specifies the minimum computing power needed to display a movie. QuickTime performs an internal test to determine the speed of the user’s computer. </p>
<p>This is not a simple measurement of clock speed—it is a measurement of performance for QuickTime-related operations. Speed is expressed as a relative value between 100 and 2^31, in multiples of 100. </p>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40000939-CH204-DontLinkElementID_40" title="Note"></a><p><strong>Note:</strong>&nbsp;Typical scores might range from a minimum score of 100, which would describe a computer as slow as, or slower than, a 166 MHz Pentium or 120 MHz PowerPC, to a maximum score of 600 for a 500 MHz Pentium III or 400 MHz G4 PowerPC. A computer with a graphics accelerator and a Gigahertz clock speed might score as high as 1000. Future computers will score higher.</p></div>
<p>Applications should play the movie with the highest specified CPU speed that is less than or equal to the user’s speed. If the user’s speed is lower than any movie’s CPU speed, applications should play the movie with the lowest CPU speed requirement. The movie with the highest CPU speed is assumed to be the highest quality.</p>
<p>Only one CPU speed atom is allowed in a given reference movie descriptor atom.</p>
<p>A CPU speed atom may contain the following fields:</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>The number of bytes in this CPU speed atom.</p></dd>
<dt>Type</dt>
<dd><p>The type of this atom; this field must be set to <code>'rmcs'</code>.</p></dd>
<dt>Flags</dt>
<dd><p>A 32-bit integer that is currently always 0.</p></dd>
<dt>CPU speed</dt>
<dd><p>A relative ranking of required computer speed, expressed as a 32-bit integer divisible by 100, with larger numbers indicating higher speed.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25804" title="Version Check Atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCHBHHE" title="Version Check Atom"></a><h3>Version Check Atom</h3>
<p>A version check atom specifies a software package, such as QuickTime or QuickTime VR, and the version of that package needed to display a movie. The package is specified using a Macintosh Gestalt type, such a <code>'qtim'</code> for QuickTime (QuickTime provides support for these Gestalt tests in the Windows computing environment).</p>
<p>You can specify a minimum required version to be returned by the Gestalt check, or you can require that a specific value be returned after performing a binary <code>AND</code> operation on the Gestalt bitfield and a mask.</p>
<p>Multiple version check atoms are allowed within a given reference movie descriptor atom. Applications should not attempt to play a movie unless all version checks are successful.</p>
<p>A version check atom may contain the following fields:</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>The number of bytes in this version check atom.</p></dd>
<dt>Type</dt>
<dd><p>The type of this atom; this field must be set to <code>'rmvc'</code>.</p></dd>
<dt>Flags</dt>
<dd><p>A 32-bit integer that is currently always 0.</p></dd>
<dt>Software package</dt>
<dd><p>A 32-bit Gestalt type, such as <code>'qtim'</code>, specifying the software package to check for.</p></dd>
<dt>Version</dt>
<dd><p>An unsigned 32-bit integer containing either the minimum required version or the required value after a binary <code>AND</code> operation.</p></dd>
<dt>Mask</dt>
<dd><p>The mask for a binary <code>AND</code> operation on the Gestalt bitfield.</p></dd>
<dt>Check type</dt>
<dd><p>The type of check to perform, expressed as 16-bit integer. Set to 0 for a minimum version check, set to 1 for a required value after a binary <code>AND</code> of the Gestalt bitfield and the mask.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25810" title="Component Detect Atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCGIHCH" title="Component Detect Atom"></a><h3>Component Detect Atom</h3>
<p>A component detect atom specifies a QuickTime component, such as a particular video decompressor, required to play the movie. The component type, subtype, and other required attributes can be specified, as well as a minimum version.</p>
<p>Multiple component detect atoms are allowed within a given reference movie descriptor atom. Applications should not attempt to play a movie unless at least the minimum versions of all required components are present.</p>
<p>A component detect atom may contain the following fields:</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>The number of bytes in this component detect atom.</p></dd>
<dt>Type</dt>
<dd><p>The type of this atom; this field must be set to <code>'rmcd'</code>.</p></dd>
<dt>Flags</dt>
<dd><p>A 32-bit integer that is currently always 0.</p></dd>
<dt>Component description</dt>
<dd><p> A component description record. For details, see <span class="content_text"><a href="qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25816">“Component Description Record.”</a></span></p></dd>
<dt>Minimum version</dt>
<dd><p>An unsigned 32-bit integer containing the minimum required version of the specified component.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25816" title="Component Description Record"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCEGDII" title="Component Description Record"></a><h4>Component Description Record</h4>
<p>Describes a class of components by their attributes. Fields that are set to 0 are treated as “don’t care.”</p>
<div class="codesample"><table><tr><td scope="row"><pre>struct ComponentDescription {<span></span></pre></td></tr><tr><td scope="row"><pre>OSType           componentType;<span></span></pre></td></tr><tr><td scope="row"><pre>OSType           componentSubType;<span></span></pre></td></tr><tr><td scope="row"><pre>OSType           componentManufacturer;<span></span></pre></td></tr><tr><td scope="row"><pre>unsigned long    componentFlags;<span></span></pre></td></tr><tr><td scope="row"><pre>unsigned long    componentFlagsMask;<span></span></pre></td></tr><tr><td scope="row"><pre>};<span></span></pre></td></tr></table></div>
<dl class="termdef">	<dt><code>componentType</code></dt>
<dd><p> A four-character code that identifies the type of component. </p></dd>
<dt><code>componentSubType</code></dt>
<dd><p>A four-character code that identifies the subtype of the component. For example, the subtype of an image compressor component indicates the compression algorithm employed by the compressor. A value of 0 matches any subtype.</p></dd>
<dt><code>componentManufacturer</code></dt>
<dd><p> A four-character code that identifies the manufacturer of the component. Components provided by Apple have a manufacturer value of <code>'appl'</code>. A value of 0 matches any manufacturer.</p></dd>
<dt><code>componentFlags</code> </dt>
<dd><p>A 32-bit field that contains flags describing required component capabilities. The high-order 8 bits should be set to 0. The low-order 24 bits are specific to each component type. These flags can be used to indicate the presence of features or capabilities in a given component. </p></dd>
<dt><code>componentFlagsMask</code></dt>
<dd><p> A 32-bit field that indicates which flags in the <code>componentFlags</code> field are relevant to this operation. For each flag in the <code>componentFlags</code> field that is to be considered as a search criterion, set the corresponding bit in this field to 1. To ignore a flag, set the bit to 0. </p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-39797" title="Constants"></a><h3>Constants</h3>
<dl class="termdef">	<dt><code>canMovieImportInPlace</code></dt>
<dd><p>Set this bit if a movie import component must be able to create a movie from a file without having to write to a separate disk file. Examples include MPEG and AIFF import components.</p></dd></dl>
<dl class="termdef">	<dt><code>movieImportSubTypeIsFileExtension</code></dt>
<dd><p>Set this bit if the component's subtype is a file extension instead of a Macintosh file type. For example, if you require an import component that opens files with an extension of <code>.doc</code>, set this flag and set your component subtype to <code>'DOC
'</code>.</p></dd></dl>
<dl class="termdef">	<dt><code>canMovieImportFiles</code></dt>
<dd><p>Set this bit if a movie import component must import files.</p></dd></dl>
<a name="//apple_ref/doc/uid/TP40000939-CH204-25822" title="Quality Atom"></a><a name="//apple_ref/doc/uid/TP40000939-CH204-BBCECHBB" title="Quality Atom"></a><h3>Quality Atom</h3>
<p>A quality atom describes the relative quality of a movie. This acts as a tiebreaker if more than one movie meets the specified requirements, and it is not otherwise obvious which movie should be played. </p>
<p>This would be the case if two qualified movies have the same data rate and CPU speed requirements, for example, or if one movie requires a higher data rate and another requires a higher CPU speed, but both can be played on the current system. In these cases, applications should play the movie with the highest quality, as specified in the quality atom.</p>
<p>Only one quality atom is allowed in a given reference movie descriptor atom.</p>
<p>A quality atom may contain the following fields:</p>
<dl class="termdef">	<dt>Size</dt>
<dd><p>The number of bytes in this quality atom.</p></dd>
<dt>Type</dt>
<dd><p>The type of this atom; this field must be set to <code>'rmqu'</code>.</p></dd>
<dt>Quality</dt>
<dd><p>The relative quality of the movie, expressed as a 32-bit integer. A larger number indicates higher quality. A unique value should be given to each movie.</p></dd></dl>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../QTFFChap1/qtff1.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../QTFFChap3/qtff3.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2004, 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-09-04<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/QuickTime/QTFF/QTFFChap2/qtff2.html%3Fid%3DTP40000939-3.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/QuickTime/QTFF/QTFFChap2/qtff2.html%3Fid%3DTP40000939-3.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/QuickTime/QTFF/QTFFChap2/qtff2.html%3Fid%3DTP40000939-3.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>