<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>PackBits (IM: U)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING60></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="OSUtilities-59.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="OSUtilities-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="OSUtilities-222.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="OSUtilities-61.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="OSUtilities-2.html"><B>Operating System Utilities</B></A> / <BR><DD><A HREF="OSUtilities-38.html"><B>Chapter 3 - Mathematical and Logical Utilities</B></A> / <A HREF="OSUtilities-41.html"><B>Mathematical and Logical Utilities Reference</B></A><BR><DL><DD><A HREF="OSUtilities-44.html"><B>Routines</B></A> / <A HREF="OSUtilities-59.html"><B>Compressing and Decompressing Data</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING60-0></A>
<H3><A NAME=MARKER-11-168></A>PackBits<A NAME=MARKER-2-70></A></H3>
 You can use the <CODE>PackBits</CODE> procedure to compress a data buffer stored in RAM.<P>
<PRE>
PROCEDURE PackBits (VAR srcPtr, dstPtr: Ptr; srcBytes: Integer);
</PRE>
<DL>
<DT><CODE>srcPtr</CODE>
<DD> On entry, a pointer to the first byte of a buffer of data to be compressed. On exit, a pointer to the first byte following the bytes compressed.
<DT><CODE>dstPtr</CODE>
<DD> On entry, a pointer to the first byte in which to store compressed data. On exit, a pointer to the first byte following the compressed data.
<DT><CODE>srcBytes</CODE>
<DD> The number of bytes of uncompressed data to be compressed. In versions of software prior to version 6.0.2, this number must be 127 or less.
</DL>
<A NAME=HEADING60-6></A>
<H5>DESCRIPTION</H5>
 The <CODE>PackBits</CODE> procedure compresses <CODE>srcBytes</CODE> bytes of data beginning at the location specified by the <CODE>srcPtr</CODE> parameter and stores it at the location specified by the <CODE>dstPtr</CODE> parameter. It then modifies the <CODE>srcPtr</CODE> and <CODE>dstPtr</CODE> variables to point to the first bytes after the uncompressed and compressed data, respectively.<P>
 Your application must allocate memory for the destination buffer itself. In general, you should allocate enough memory for a worst-case scenario. In the worst case, the destination buffer is 128 bytes long for each block of source data up to 127 bytes. Thus, you can use the following formula to determine how much space to allocate for the destination buffer:<P>
<PRE>
maxDstBytes := srcBytes + (srcBytes+126) DIV 127;
</PRE>
 where <CODE>maxDstBytes</CODE> stands for the maximum number of destination bytes.<P>
 The <CODE>PackBits</CODE> algorithm is most effective on data buffers in which there are likely to be series of bytes containing the same value. For example, resources of many formats often contain many consecutive zeros. If you have a data buffer in which there are only likely to be series of words or long words containing the same value, <CODE>PackBits</CODE> is unlikely to be effective.<P>
 Because your application must allocate memory for the source and destination buffers, <CODE>PackBits</CODE> does not move relocatable blocks. Thus, you can call it at interrupt time.<A NAME=MARKER-2-170></A><P>
<A NAME=HEADING60-13></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 Because <CODE>PackBits</CODE> changes the values of the <CODE>srcPtr</CODE> and <CODE>dstPtr</CODE> parameters, you should pass to <CODE>PackBits</CODE> only copies of pointers to the source and destination buffers. This allows you to access the beginning of the source and destination buffers after <CODE>PackBits</CODE> returns. Also, if the source or destination buffer is stored in an unlocked, relocatable block, this technique prevents <CODE>PackBits</CODE> from changing the value of a master pointer, which would make the original handle invalid. <P>
<A NAME=HEADING60-15></A>
<H5>SEE ALSO</H5>
 For an example of the use of the <CODE>PackBits</CODE> procedure, see <A HREF=OSUtilities-40.html#MARKER-9-95>Listing 3-3 on page 3-20</A>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="OSUtilities-59.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="OSUtilities-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="OSUtilities-222.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="OSUtilities-61.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="OSUtilities-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
