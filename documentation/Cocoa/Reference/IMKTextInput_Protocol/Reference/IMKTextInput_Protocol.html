<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>IMKTextInput Protocol Reference</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="IMKTextInput Protocol Reference"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40006160-CH3" title="IMKTextInput"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> &gt; <a href="../../../../../reference/Cocoa/index.html#//apple_ref/doc/uid/TP30001281-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../../../reference/Cocoa/idxInternationalization-date.html#//apple_ref/doc/uid/TP30001281-TP30000416-TP30001072" target="_top">Internationalization</a> &gt; <a href="../index.html" target="_top">IMKTextInput Protocol Reference</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <!-- Previous button --><span style="margin-left: 8px"><a href="../RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/occ/intf/IMKTextInput" title="IMKTextInput"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-BCIHFHHB" title="IMKTextInput"></a><h1>IMKTextInput Protocol Reference</h1><div class="spec_sheet_info_box"><table cellspacing="0" class="specbox"><tr><td scope="row"><strong><span class="noWrap">Adopted by</span></strong></td><td><div style="margin-bottom:1px"><span class="content_text"><!--a  -->IMKInputSession<!--/a--></span><br/></div></td></tr><tr><td scope="row"><strong><span style="white-space: nowrap;">Framework</span></strong></td><td><div style="margin-bottom:1px">System/Library/Frameworks/Carbon.framework/HIToolbox.framework</div></td></tr><tr><td scope="row"><strong>Availability</strong></td><td><div style="margin-bottom:1px"><div>Available in Mac OS X v10.5 and later.</div></div></td></tr><tr><td scope="row"><strong><span style="white-space: nowrap;">Declared in</span></strong></td><td><div style="margin-bottom:1px"><span class="content_text">IMKInputSession.h</span><br/></div></td></tr></table></div><br/>

<a name="//apple_ref/doc/uid/TP40006160-CH3-743333" title="Overview"></a><h2>Overview</h2><p class="spaceabove">The <code>IMKTextInput</code> protocol defines methods for communicating with client input sessions.  An input method uses this protocol to send text or obtain information about client text.</p><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_13" title="Tasks"></a><h2>Tasks</h2>
<a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_14" title="Working with Text Ranges"></a>
		<h3 class="tasks">Working with Text Ranges</h3>
		
		
		
		
		<ul class="tooltip">
			
				
                <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                    
                    <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/insertText:replacementRange:">&#8211;&#xA0;insertText:replacementRange:</a></code>
                    
                    			
                        <img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Sends  fully converted text  to an input session.'/>
                    
                </span></li>
			
				
                <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                    
                    <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/setMarkedText:selectionRange:replacementRange:">&#8211;&#xA0;setMarkedText:selectionRange:replacementRange:</a></code>
                    
                    			
                        <img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Inserts the provided text and marks it to indicate that it is part of an active input session.'/>
                    
                </span></li>
			
				
                <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                    
                    <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/selectedRange">&#8211;&#xA0;selectedRange</a></code>
                    
                    			
                        <img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Returns the current selection range.'/>
                    
                </span></li>
			
				
                <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                    
                    <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/markedRange">&#8211;&#xA0;markedRange</a></code>
                    
                    			
                        <img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Returns the range in the document that is occupied by marked text, that is, the current inline session.'/>
                    
                </span></li>
			
				
                <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                    
                    <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/attributedSubstringFromRange:">&#8211;&#xA0;attributedSubstringFromRange:</a></code>
                    
                    			
                        <img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Returns the attributed string for the provided range of text.'/>
                    
                </span></li>
			
		</ul>


<a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_15" title="Working with Character Indexes"></a>
		<h3 class="tasks">Working with Character Indexes</h3>
		
		
		
		
		<ul class="tooltip">
			
				
                <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                    
                    <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/characterIndexForPoint:tracking:inMarkedRange:">&#8211;&#xA0;characterIndexForPoint:tracking:inMarkedRange:</a></code>
                    
                    			
                        <img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Returns the location in the text document that maps to a global point.'/>
                    
                </span></li>
			
				
                <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                    
                    <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/attributesForCharacterIndex:lineHeightRectangle:">&#8211;&#xA0;attributesForCharacterIndex:lineHeightRectangle:</a></code>
                    
                    			
                        <img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Returns a dictionary of text attributes for the text at the provided character index. '/>
                    
                </span></li>
			
		</ul>


<a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_16" title="Getting Attributes and Length"></a>
		<h3 class="tasks">Getting Attributes and Length</h3>
		
		
		
		
		<ul class="tooltip">
			
				
                <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                    
                    <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/length">&#8211;&#xA0;length</a></code>
                    
                    			
                        <img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Returns the length of the text document.'/>
                    
                </span></li>
			
				
                <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                    
                    <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/validAttributesForMarkedText">&#8211;&#xA0;validAttributesForMarkedText</a></code>
                    
                    			
                        <img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Returns an array of names for the attributes supported by the receiver.'/>
                    
                </span></li>
			
		</ul>


<a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_17" title="Managing Text Input"></a>
		<h3 class="tasks">Managing Text Input</h3>
		
		
		
		
		<ul class="tooltip">
			
				
                <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                    
                    <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/overrideKeyboardWithKeyboardNamed:">&#8211;&#xA0;overrideKeyboardWithKeyboardNamed:</a></code>
                    
                    			
                        <img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Overrides the current keyboard.'/>
                    
                </span></li>
			
				
                <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                    
                    <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/selectInputMode:">&#8211;&#xA0;selectInputMode:</a></code>
                    
                    			
                        <img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Selects a new input mode.'/>
                    
                </span></li>
			
				
                <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                    
                    <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/supportsUnicode">&#8211;&#xA0;supportsUnicode</a></code>
                    
                    			
                        <img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Tests to see if the current input session supports Unicode text.'/>
                    
                </span></li>
			
				
                <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                    
                    <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/bundleIdentifier">&#8211;&#xA0;bundleIdentifier</a></code>
                    
                    			
                        <img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Returns the bundle identifier for the process that the input session is attached to.'/>
                    
                </span></li>
			
				
                <li class="tooltip"><span onMouseOut="hidetip()" onMouseOver="showtip(this,event);">
                    
                    <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/windowLevel">&#8211;&#xA0;windowLevel</a></code>
                    
                    			
                        <img src="../../../../Resources/Images/info_icon.jpg" width="10" height="10" border="0" class="tooltipicon" abstract='Returns the window level for a client window.'/>
                    
                </span></li>
			
		</ul>


<a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_18" title="Instance Methods"></a><h2>Instance Methods</h2><a name="//apple_ref/occ/intfm/IMKTextInput/attributedSubstringFromRange:" title="attributedSubstringFromRange:"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_2" title="attributedSubstringFromRange:"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_20"></a><h3 class="verytight">attributedSubstringFromRange:</h3><p class="spaceabove">Returns the attributed string for the provided range of text.</p><p class="spaceabovemethod">- (NSAttributedString*)attributedSubstringFromRange:(NSRange)range</p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>range</em></dt><dd><p>The range of text, relative to the document, that specifies the string to retrieve.</p></dd></dl><h5 class="tight">Return Value</h5><p>The attributed string. See the <code>CTStringAttributes.h</code> header file for the attributes that can be included in this string. If the client does not support the TSMDocumentAccess protocol, the returned string is created from data obtained by sending the client application a <code>kEventTextInputGetSelectedText</code> Carbon event. The returned <code>NSAttributedString</code> object is an autoreleased object.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/attributesForCharacterIndex:lineHeightRectangle:">&#8211;&#xA0;attributesForCharacterIndex:lineHeightRectangle:</a></code></li></ul><h5 class="tight">Declared In</h5><code>IMKInputSession.h</code><a name="//apple_ref/occ/intfm/IMKTextInput/attributesForCharacterIndex:lineHeightRectangle:" title="attributesForCharacterIndex:lineHeightRectangle:"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-SW4" title="attributesForCharacterIndex:lineHeightRectangle:"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_21"></a><h3 class="verytight">attributesForCharacterIndex:lineHeightRectangle:</h3><p class="spaceabove">Returns a dictionary of text attributes for the text at the provided character index. </p><p class="spaceabovemethod">- (NSDictionary*)attributesForCharacterIndex:(NSUInteger)index lineHeightRectangle:(NSRect*)lineRect</p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>index</em></dt><dd><p>The character index whose attributes you want to retrieve. The index is relative to the inline session. Note that if there is no inline session the value of index should be <code>0</code>, which indicates that the information should be taken from the current selection.</p></dd><dt><em>lineRect</em></dt><dd><p>On return, a rectangle that frames a one-pixel wide rectangle with the height of the line. This rectangle is oriented the same way the line is oriented.</p></dd></dl><h5 class="tight">Return Value</h5><p>A dictionary hat contains the text attributes for the text at the provided character index. The returned <code>NSDictionary</code> object is an autoreleased object. The attributes include the <code>CTFontRef</code> for the text at that index, and the text orientation. The text orientation is indicated by an <code>NSNumber</code> whose value is 0 if the text is vertically oriented and 1 if the text is horizontally oriented. The key for this value is <code>IMKTextOrientationKey</code>. </p><h5 class="tight">Discussion</h5><p>An input method calls this method to place a candidate window on screen.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/characterIndexForPoint:tracking:inMarkedRange:">&#8211;&#xA0;characterIndexForPoint:tracking:inMarkedRange:</a></code></li></ul><h5 class="tight">Declared In</h5><code>IMKInputSession.h</code><a name="//apple_ref/occ/intfm/IMKTextInput/bundleIdentifier" title="bundleIdentifier"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_8" title="bundleIdentifier"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_22"></a><h3 class="verytight">bundleIdentifier</h3><p class="spaceabove">Returns the bundle identifier for the process that the input session is attached to.</p><p class="spaceabovemethod">-(NSString*)bundleIdentifier</p><h5 class="tight">Return Value</h5><p>The bundle identifier for the process that the input session is attached to. The returned <code>NSString</code> is an autoreleased object. </p><h5 class="tight">Discussion</h5><p>Many input methods need to be able to identify the process that input sessions belong to. This method provides that service.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">Declared In</h5><code>IMKInputSession.h</code><a name="//apple_ref/occ/intfm/IMKTextInput/characterIndexForPoint:tracking:inMarkedRange:" title="characterIndexForPoint:tracking:inMarkedRange:"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-SW5" title="characterIndexForPoint:tracking:inMarkedRange:"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_23"></a><h3 class="verytight">characterIndexForPoint:tracking:inMarkedRange:</h3><p class="spaceabove">Returns the location in the text document that maps to a global point.</p><p class="spaceabovemethod">- (NSInteger)characterIndexForPoint:(NSPoint)point tracking:(IMKLocationToOffsetMappingMode)mappingMode inMarkedRange:(BOOL*)inMarkedRange</p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>point</em></dt><dd><p>The point to map. This is a global point, typically from a mouse down operation.</p></dd><dt><em>mappingMode</em></dt><dd><p>The mapping mode. If the input method is tracking the mouse, the mode should be <code>kIMKMouseTrackingMode</code>. If the input method simply wants to map a screen position to an offset, than set the mode to k<code>IMKNearestBoundaryMode</code>.</p></dd><dt><em>inMarkedRange</em></dt><dd><p>On return, if the point is inside the text body and inside the marked range, this parameter is set to <code>YES</code>. Otherwise, if the point is outside the marked range, then on return this parameter is set to <code>NO</code>.</p></dd></dl><h5 class="tight">Return Value</h5><p>The location in the text document.</p><h5 class="tight">Discussion</h5><p>If the input method is tracking the mouse, the application should highlight to the active inline area.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/attributesForCharacterIndex:lineHeightRectangle:">&#8211;&#xA0;attributesForCharacterIndex:lineHeightRectangle:</a></code></li></ul><h5 class="tight">Declared In</h5><code>IMKInputSession.h</code><a name="//apple_ref/occ/intfm/IMKTextInput/insertText:replacementRange:" title="insertText:replacementRange:"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_1" title="insertText:replacementRange:"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_24"></a><h3 class="verytight">insertText:replacementRange:</h3><p class="spaceabove">Sends  fully converted text  to an input session.</p><p class="spaceabovemethod">- (void)insertText:(id)string replacementRange:(NSRange)replacementRange</p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>string</em></dt><dd><p>The converted text.</p></dd><dt><em>replacementRange</em></dt><dd><p>The replacement range. This parameter allows input methods to insert text at a location other than the current selection. If you use it, the replacement range should be relative to the beginning of the client document. If the string should be inserted at the current selection specify a replacement range with a location and length of <code>NSNotFound</code>. If the client does not support the <code>TSMDocumentAccess</code> protocol, this method ignores the replacement range string.</p></dd></dl><h5 class="tight">Discussion</h5><p>When an input method finishes a conversion it calls this method and passes the finished text as an <code>NSString</code> or <code>NSAttributedString</code> object. </p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">Declared In</h5><code>IMKInputSession.h</code><a name="//apple_ref/occ/intfm/IMKTextInput/length" title="length"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_3" title="length"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_25"></a><h3 class="verytight">length</h3><p class="spaceabove">Returns the length of the text document.</p><p class="spaceabovemethod">- (NSInteger)length</p><h5 class="tight">Return Value</h5><p>The text document length. If the client does not support the <code>TSMDocumentAccess</code> protocol the returned value is <code>NSNotFound</code>. </p><h5 class="tight">Discussion</h5><p>This method can be computationally expense depending on how the client  stores text. For that reason, you should avoid calling this method frequently.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">Declared In</h5><code>IMKInputSession.h</code><a name="//apple_ref/occ/intfm/IMKTextInput/markedRange" title="markedRange"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-SW1" title="markedRange"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_26"></a><h3 class="verytight">markedRange</h3><p class="spaceabove">Returns the range in the document that is occupied by marked text, that is, the current inline session.</p><p class="spaceabovemethod">- (NSRange)markedRange</p><h5 class="tight">Return Value</h5><p>The range of the marked text.</p><h5 class="tight">Discussion</h5><p>While an input method is converting text input and sending it to the client, the client maintains a range of text that is marked. The marked text is underlined in certain ways to indicate to the user that their keystrokes are in the process of being converted by an input method and the conversion has not yet been finalized. The input method uses this method to request that range.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/setMarkedText:selectionRange:replacementRange:">&#8211;&#xA0;setMarkedText:selectionRange:replacementRange:</a></code></li></ul><h5 class="tight">Declared In</h5><code>IMKInputSession.h</code><a name="//apple_ref/occ/intfm/IMKTextInput/overrideKeyboardWithKeyboardNamed:" title="overrideKeyboardWithKeyboardNamed:"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_5" title="overrideKeyboardWithKeyboardNamed:"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_27"></a><h3 class="verytight">overrideKeyboardWithKeyboardNamed:</h3><p class="spaceabove">Overrides the current keyboard.</p><p class="spaceabovemethod">-(void)overrideKeyboardWithKeyboardNamed:(NSString*)keyboardUniqueName</p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>keyboardUniqueName</em></dt><dd><p>A unique keyboard name.</p></dd></dl><h5 class="tight">Discussion</h5><p>The client tries to locate a keyboard layout with that name in the input method  bundle. If a layout is found it is passed to the client who then tells the text service manager to use that layout for keyboard events. Input methods should call the method each time they are activated. If an input method uses a system keyboard to override the current keyboard, they are responsible for determining the unique name of the keyboard. Typically this name a DNS type name such as: <code>com.apple.&lt;some name></code>.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">Declared In</h5><code>IMKInputSession.h</code><a name="//apple_ref/occ/intfm/IMKTextInput/selectedRange" title="selectedRange"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-SW3" title="selectedRange"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_28"></a><h3 class="verytight">selectedRange</h3><p class="spaceabove">Returns the current selection range.</p><p class="spaceabovemethod">- (NSRange)selectedRange</p><h5 class="tight">Return Value</h5><p>The current selection range, relative to the client document. If the client does not support the <code>TSMDocumentAccess</code> protocol the returned range has a location value of <code>NSNotFound</code> and a length of <code>NSNotFound</code>.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/setMarkedText:selectionRange:replacementRange:">&#8211;&#xA0;setMarkedText:selectionRange:replacementRange:</a></code></li></ul><h5 class="tight">Declared In</h5><code>IMKInputSession.h</code><a name="//apple_ref/occ/intfm/IMKTextInput/selectInputMode:" title="selectInputMode:"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_6" title="selectInputMode:"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_29"></a><h3 class="verytight">selectInputMode:</h3><p class="spaceabove">Selects a new input mode.</p><p class="spaceabovemethod">-(void)selectInputMode:(NSString*)modeIdentifier</p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>modeIdentifier</em></dt><dd><p>An <code>NSString</code> object with a DNS format, such as: <code>com.&lt;company name> .inputmethod.&lt;some name></code>. The identifier should match one of the keys in the component input mode dictionary. </p></dd></dl><h5 class="tight">Discussion</h5><p>This method allows an input method to change its mode directly.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">Declared In</h5><code>IMKInputSession.h</code><a name="//apple_ref/occ/intfm/IMKTextInput/setMarkedText:selectionRange:replacementRange:" title="setMarkedText:selectionRange:replacementRange:"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-SW2" title="setMarkedText:selectionRange:replacementRange:"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_30"></a><h3 class="verytight">setMarkedText:selectionRange:replacementRange:</h3><p class="spaceabove">Inserts the provided text and marks it to indicate that it is part of an active input session.</p><p class="spaceabovemethod">- (void)setMarkedText:(id)string selectionRange:(NSRange)selectionRange replacementRange:(NSRange)replacementRange</p><h5 class="tight">Parameters</h5><dl class="termdef"><dt><em>string</em></dt><dd><p>An <code>NSString</code> or an <code>NSAttributedString</code> object. Passing an <code>NSString</code> object produces default marking. On a 72 dpi screen the default marking is a 2 pixel black underline for the entire string. </p></dd><dt><em>selectionRange</em></dt><dd><p>The selection range, which is  relative to the <code>string</code> parameter. For example, if the string contains the these characters: "INPUT" and the range is (5,0), the selection is set immediately after the "T." </p></dd><dt><em>replacementRange</em></dt><dd><p>A range that specifies the location in the client document where the marked text should be placed. If the marked text should be placed at the current cursor location <code>replacementRange</code> equals <code>NSNotFound</code>. If  not <code>NSNotFound</code>, the replacement range is relative to the client document ( <code>0</code> is the beginning of the document) and NOT the string parameter. Currently, the replacement range is sent to the client via the kEventParamTextInputSendReplaceRange Carbon Event parameter. For this parameter to be used the client must support the TSMDocumentAccess protocol. If a client does not support the TSMDocumentAccess protocol the <code>replacementRange</code> parameter is ignored.</p></dd></dl><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/markedRange">&#8211;&#xA0;markedRange</a></code></li><li class="availability">  <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/selectedRange">&#8211;&#xA0;selectedRange</a></code></li></ul><h5 class="tight">Declared In</h5><code>IMKInputSession.h</code><a name="//apple_ref/occ/intfm/IMKTextInput/supportsUnicode" title="supportsUnicode"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_7" title="supportsUnicode"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_31"></a><h3 class="verytight">supportsUnicode</h3><p class="spaceabove">Tests to see if the current input session supports Unicode text.</p><p class="spaceabovemethod">-(BOOL)supportsUnicode</p><h5 class="tight">Return Value</h5><p><code>YES</code> if the current  input session supports Unicode text; otherwise <code>NO</code>.</p><h5 class="tight">Discussion</h5><p>Input methods that restrict the character codes sent to a client if that client does not support Unicode text should call this method to learn whether a given input session supports Unicode text.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">Declared In</h5><code>IMKInputSession.h</code><a name="//apple_ref/occ/intfm/IMKTextInput/validAttributesForMarkedText" title="validAttributesForMarkedText"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_4" title="validAttributesForMarkedText"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_32"></a><h3 class="verytight">validAttributesForMarkedText</h3><p class="spaceabove">Returns an array of names for the attributes supported by the receiver.</p><p class="spaceabovemethod">- (NSArray*)validAttributesForMarkedText</p><h5 class="tight">Return Value</h5><p>An array of attribute names. The returned <code>NSArray</code> should not be released unless it is first retained.</p><h5 class="tight">Discussion</h5><p>Input methods should restrict the attributes used to create attributed strings to the attributes in this array.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">See Also</h5><ul class="availability"><li class="availability">  <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/attributesForCharacterIndex:lineHeightRectangle:">&#8211;&#xA0;attributesForCharacterIndex:lineHeightRectangle:</a></code></li><li class="availability">  <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/markedRange">&#8211;&#xA0;markedRange</a></code></li></ul><h5 class="tight">Declared In</h5><code>IMKInputSession.h</code><a name="//apple_ref/occ/intfm/IMKTextInput/windowLevel" title="windowLevel"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_9" title="windowLevel"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_33"></a><h3 class="verytight">windowLevel</h3><p class="spaceabove">Returns the window level for a client window.</p><p class="spaceabovemethod">-(CGWindowLevel)windowLevel</p><h5 class="tight">Return Value</h5><p>The window level for a client window.</p><h5 class="tight">Discussion</h5><p>Call this to determine the client  window level. Internally, the <code>IMKCandidates</code> class uses this method to determine the correct level for candidate display. Therefore, input methods that use <code>IMKCandidates</code> have no reason to call this method. However, many input method developers build their own candidate display system, and this method is provided for their use. In order to display a candidate window at the correct level, use this method to obtain the client window level, increment the returned level, and then apply that level to any candidate windows.</p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.5 and later.</li></ul><h5 class="tight">Declared In</h5><code>IMKInputSession.h</code>
<a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_10" title="Constants"></a><h2>Constants</h2><a name="//apple_ref/c/tdef/IMKLocationToOffsetMappingMode" title="IMKLocationToOffsetMappingMode" role="Enum"></a><a name="//apple_ref/doc/c_ref/IMKLocationToOffsetMappingMode" title="IMKLocationToOffsetMappingMode" role="Enum"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_11" title="IMKLocationToOffsetMappingMode" role="Enum"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_34"></a><h3 class="tight">IMKLocationToOffsetMappingMode</h3><p class="spaceabove">List modes for mapping a screen location to a text offset.</p><p class="spaceabove"><pre>
enum {   <a href="IMKTextInput_Protocol.html#//apple_ref/doc/c_ref/kIMKMouseTrackingMode">kIMKMouseTrackingMode</a> = (1&lt;&lt;0),
   <a href="IMKTextInput_Protocol.html#//apple_ref/doc/c_ref/kIMKNearestBoundaryMode">kIMKNearestBoundaryMode</a> = (1&lt;&lt;1) };typedef <a href="../../Foundation/Miscellaneous/Foundation_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/NSInteger" target="_top">NSInteger</a> IMKLocationToOffsetMappingMode;
</pre></p><h5 class="tight">Constants</h5><dl class="termdef"><a name="//apple_ref/c/econst/kIMKMouseTrackingMode" title="kIMKMouseTrackingMode"></a><a name="//apple_ref/doc/c_ref/kIMKMouseTrackingMode" title="kIMKMouseTrackingMode"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_35"></a><dt><code>kIMKMouseTrackingMode</code></dt><dd><p>Mouse tracking mode. When tracking, a coordinate does not change the offset until the coordinate is completely past a given character. </p><p>Available in Mac OS X v10.5 and later.</p><p>Declared in <code>IMKInputSession.h</code>.</p></dd><a name="//apple_ref/c/econst/kIMKNearestBoundaryMode" title="kIMKNearestBoundaryMode"></a><a name="//apple_ref/doc/c_ref/kIMKNearestBoundaryMode" title="kIMKNearestBoundaryMode"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_36"></a><dt><code>kIMKNearestBoundaryMode</code></dt><dd><p>Nearest boundary mode. When trying to place an insertion point, a coordinate is mapped to the nearest character boundary.</p><p>Available in Mac OS X v10.5 and later.</p><p>Declared in <code>IMKInputSession.h</code>.</p></dd></dl><h5 class="tight">Declared In</h5><code>IMKInputSession.h</code><a name="//apple_ref/doc/constant_group/IMKTextOrientationName" title="IMKTextOrientationName" role="GlobalDataGroup"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_12" title="IMKTextOrientationName" role="GlobalDataGroup"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_37"></a><h3 class="tight">IMKTextOrientationName</h3><p class="spaceabove">The text orientation name key.</p><p class="spaceabove"><pre>
extern const *<a href="../../Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/doc/c_ref/NSString" target="_top">NSString IMKTextOrientationName</a>;
</pre></p><h5 class="tight">Constants</h5><dl class="termdef"><a name="//apple_ref/c/data/IMKTextOrientationName" title="IMKTextOrientationName"></a><a name="//apple_ref/doc/c_ref/IMKTextOrientationName" title="IMKTextOrientationName"></a><a name="//apple_ref/doc/uid/TP40006160-CH3-DontLinkElementID_38"></a><dt><code>IMKTextOrientationName</code></dt><dd><p>The key used to find the client  text orientation value, which is part of the dictionary returned by the method <code><a href="IMKTextInput_Protocol.html#//apple_ref/occ/intfm/IMKTextInput/attributesForCharacterIndex:lineHeightRectangle:" target="_self">attributesForCharacterIndex:lineHeightRectangle:</a></code>. The associated value is an <code>NSNumber</code> object that represents a <code>BOOL</code> value. A value of <code>1</code> means the client  text uses a horizontal layout. A value of <code>0</code> means that the client  text uses a vertical layout.</p><p>Available in Mac OS X v10.5 and later.</p><p>Declared in <code>IMKInputSession.h</code>.</p></dd></dl><h5 class="tight">Declared In</h5><code>IMKInputSession.h</code>


        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <!-- Previous button --><span style="margin-left: 8px"><a href="../RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-06-05<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Reference/IMKTextInput_Protocol/Reference/IMKTextInput_Protocol.html%3Fid%3DTP40006160-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Reference/IMKTextInput_Protocol/Reference/IMKTextInput_Protocol.html%3Fid%3DTP40006160-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Reference/IMKTextInput_Protocol/Reference/IMKTextInput_Protocol.html%3Fid%3DTP40006160-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>