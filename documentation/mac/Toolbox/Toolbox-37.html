<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Obtaining Information About Events(IM:Tb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING37></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Toolbox-36.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-38.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Toolbox-2.html"><B>Macintosh Toolbox Essentials</B></A> / <BR><DD><A HREF="Toolbox-28.html"><B>Chapter 2 - Event Manager</B></A> / <A HREF="Toolbox-36.html"><B>Using the Event Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING37-0></A>
<H2>Obtaining Information About Events</H2>
 <A NAME=MARKER-2-365></A>You get information about events through the event record. The <CODE>EventRecord</CODE> data type defines the event record and has this structure:<P>
<PRE>
TYPE  EventRecord = 
      RECORD
         what:       Integer;       {event code}
         message:    LongInt;       {event message}
         when:       LongInt;       {ticks since startup}
         where:      Point;         {mouse location}
         modifiers:  Integer;       {modifier flags}
      END;
</PRE>
<DL>
<H5>Field Description</H5>
<DT><CODE>what</CODE>
<DD> The <CODE>what</CODE> field indicates the type of event received. The type of event can be identified by these constants: <A NAME=MARKER-2-173></A>
</DL>
<PRE>
               CONST
               nullEvent         = 0; {no other pending events}
               mouseDown         = 1; {mouse button pressed}
               mouseUp           = 2; {mouse button released}
               keyDown           = 3; {key pressed}
               keyUp             = 4; {key released}
               autoKey           = 5; {key repeatedly held down}
               updateEvt         = 6; {window needs updating}
               diskEvt           = 7; {disk inserted}
               activateEvt       = 8; {activate/deactivate window}
               osEvt             = 15;{operating-system event-- }
                                      { resume, suspend, or }
                                      { mouse-moved}
               kHighLevelEvent   = 23;{high-level event}
</PRE>
<DL>
<DT><CODE>message</CODE>
<DD> The <CODE>message</CODE> field contains additional information associated with the event. The interpretation of this information depends on the event type. The contents of the <CODE>message</CODE> field for each event type are summarized here:<A NAME=MARKER-2-348></A><CODE>
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>&nbsp;<TH>Event type<TH>Event message<TR>
<TD>&nbsp;<TD>null, mouse-up, mouse-down<TD>Undefined.<TR>
<TD>&nbsp;<TD>key-up, key-down, auto-key<TD>Character code and virtual key code in low-order word. For Apple Desktop Bus (ADB) keyboards, the low byte of the high-order word contains the ADB address of the keyboard where the keyboard event occurred. The high byte of the high-order word is reserved.<TR>
<TD>&nbsp;<TD>update, activate<TD>Pointer to the window to update, activate, or deactivate.<TR>
<TD>&nbsp;<TD>disk-inserted<TD>Drive number in low-order word, File Manager result code in high-order word.<TR>
<TD>&nbsp;<TD>resume<TD>The <CODE>suspendResumeMessage</CODE> constant in bits 24-31 and a 1 in bit 0 to indicate the event is a resume event. Bit 1 contains either a 1 or a 0 to indicate if Clipboard conversion is required, and bits 2-23 are reserved.<TR>
<TD>&nbsp;<TD>suspend<TD>The <CODE>suspendResumeMessage</CODE> constant in bits 24-31 and a 0 in bit 0 to indicate the event is a suspend event. Bit 1 is undefined, and bits 2-23 are reserved.<TR>
<TD>&nbsp;<TD>mouse-moved<TD>The <CODE>mouseMovedMessage</CODE> constant in bits 24-31. Bits 2-23 are reserved, and bit 0 and bit 1 are undefined.<TR>
<TD>&nbsp;<TD>high-level<TD>Class of events to which the high-level event belongs. The <CODE>message</CODE> and <CODE>where</CODE> fields of <BR>a high-level event define the specific type of high-level event received.</TABLE>
</CODE>
<DT><CODE>when</CODE>
<DD> The <CODE>when</CODE> field indicates the time when the event was posted (in ticks since system startup). When needed, you can use the <CODE>when</CODE> field to compare how much time has elapsed between successive mouse events.
<DT><CODE>where</CODE>
<DD> For low-level events and operating-system events, the <CODE>where</CODE> field contains the location of the cursor at the time the event was posted (in global coordinates).
<DT>
<DD> For high-level events, the <CODE>where</CODE> field contains a second event specifier, the event ID. The event ID defines the particular type of event within the class of events defined by the <CODE>message</CODE> field of the high-level event. For high-level events, you should interpret the <CODE>where</CODE> field as having the data type <CODE>OSType</CODE>, not <CODE>Point</CODE>.
<DT><CODE>modifiers</CODE>
<DD> <A NAME=MARKER-9-586></A>The <CODE>modifiers</CODE> field contains information about the state of the modifier keys and the mouse button at the time the event was posted. For activate events, this field also indicates whether the window should be activated or deactivated. In System 7 it also indicates whether a mouse-down event caused your application to switch to the foreground.
</DL>
 Each of the modifier keys is represented by a specific bit in the <CODE>modifiers</CODE> field of the event record. <A HREF=#MARKER-9-85>Figure 2-5</A> shows how to interpret the <CODE>modifiers</CODE> field. You can examine the <CODE>modifiers</CODE> field of the event record to determine which, if any, of the modifier keys were pressed at the time of the event. The modifier keys include the Option, Command, Caps Lock, Control, and Shift keys. If your application attaches special meaning to any of these keys in combination with other keys or when the mouse button is down, you can test the state of the <CODE>modifiers</CODE> field to determine the action your application should take. For example, you can use this information to determine whether the user pressed the Command key and another key at the same time to make a menu selection. <A NAME=MARKER-2-181></A><P>
<B>Figure 2-5  <A NAME=MARKER-9-85></A>The <CODE>modifiers</CODE> field of the event record </B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/Figure_1-5_EV-05.jpg"><P>
 Bit 0 in the <CODE>modifiers</CODE> field gives additional information that is valid only if the event is an activate event or a mouse-down event. <P>
 For activate events, the value of bit 0 is 1 if the window pointed to by the event message should be activated, and the value is 0 if the window should be deactivated.<P>
 For mouse-down events in System 7, bit 0 indicates whether a mouse-down event caused your application to switch to the foreground. If so, bit 0 contains 1; otherwise, <BR>it contains 0. <P>
 You can also use these constants as masks to test the setting of various bits in the <CODE>modifiers</CODE> field:<P>
<PRE>
CONST activeFlag  = 1;     {set if window being activated or if }
                           { mouse-down event caused fgnd switch}
      btnState    = 128;   {set if mouse button up}
      cmdKey      = 256;   {set if Command key down}
      shiftKey    = 512;   {set if Shift key down}
      alphaLock   = 1024;  {set if Caps Lock key down}
      optionKey   = 2048;  {set if Option key down}
      controlKey  = 4096;  {set if Control key down}
</PRE>
 Note that the bit giving information about the mouse button is set if the mouse button is up. The bits for the modifier keys are set if the corresponding key is down.<P>
 Some keyboards do not distinguish between the right or left Control, Shift, and Option keys; for example, the virtual key code for the right Shift key and left Shift key might be the same. For these keyboards, if the user presses the Control, Shift, or Option key, the Event Manager sets only the bits corresponding to the <CODE>shiftKey</CODE>, <CODE>optionKey</CODE>, and <CODE>controlKey</CODE> constants. For keyboards that do distinguish between these keys, the Event Manager sets the bits in the <CODE>modifiers</CODE> field to indicate whether the right or left Control, Shift, or Option keys were pressed. For example, the Event Manager sets bit 13 in the  <CODE>modifiers</CODE> field if the user presses the right Shift key and sets bit 9 if the user presses the left Shift key. In most cases your application should not need to distinguish between the left and right Control, Shift, and Option keys. <A NAME=MARKER-2-57></A><A NAME=MARKER-2-87></A><A NAME=MARKER-2-368></A><A NAME=MARKER-2-308></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Toolbox-36.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-38.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Toolbox-3.html">&copy; Apple Computer, Inc.</A><br>11 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
