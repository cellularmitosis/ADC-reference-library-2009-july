<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Adding Items to a Collection(IM: XU)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING193></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="GXEnvironment-192.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="GXEnvironment-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="GXEnvironment-445.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="GXEnvironment-194.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="GXEnvironment-2.html"><B>QuickDraw GX Environment and Utilities</B></A> / <BR><DD><A HREF="GXEnvironment-182.html"><B>Chapter 5 - Collection Manager</B></A> / <A HREF="GXEnvironment-188.html"><B>Using the Collection Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING193-0></A>
<H2><A NAME=MARKER-9-43></A>Adding Items to a Collection</H2>
 <A NAME=MARKER-2-44></A>Once you've created a collection object, you can add new items to the collection using the <CODE>AddCollectionItem</CODE> function. With this function, you specify the collection tag and collection ID that you want associated with the new item, the size of the new item's variable-length data, and a pointer to the data.<P>
<DL>
<DT><B>Note</B>
<DD>The Collection Manager also provides a utility function, <CODE>AddCollectionItemHdl</CODE>, which allows you to specify a handle, rather than a pointer, to the data. See <A HREF=GXEnvironment-260.html#MARKER-9-247>page 5-92</A> for more information about this function.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 <A HREF=#MARKER-9-45>Listing 5-3</A> creates a new collection object and adds ten items to it. Each item has the collection tag <CODE>'GXPT'</CODE>, the items have collection IDs 0 through 9, and each item contains two coordinates that make up a QuickDraw GX point.<P>
<B>Listing 5-3  <A NAME=MARKER-9-45></A>Adding items to a collection</B><P>
<PRE>
OSErr anErr;
Collection pointsAndQuotes;
gxPoint location;
long count;
.
.
.
pointsAndQuotes = NewCollection();

location.x = ff(10);
location.y = ff(10);
   
for (count = 0; count &lt; 10; count++) {
   anErr = AddCollectionItem(pointsAndQuotes,  
                             'GXPT',  /* tag */
                             count,   /* id */
                             sizeof(gxPoint),     /* size */
                             &amp;location); /* data */
                          
   location.x += ff(1);  /* change data for next item */
   location.y += ff(1);
}
</PRE>
 The collection resulting from the code in <A HREF=#MARKER-9-45>Listing 5-3</A> is very similar to an array: the items are numbered sequentially starting with 0, and all items are of the same size. Unlike arrays, however, collections are not limited to these properties. For example, you can add items to a collection dynamically, increasing the total number of collection items during run time. That is, you do not have to specify the capacity of the collection at compile time. Also, collection IDs do not have to be sequential. To demonstrate, the code<P>
<PRE>
location.x = ff(100);
location.y = ff(100);
anErr = AddCollectionItem(pointsAndQuotes, 
                          'GXPT', 20, /* tag and id */
                          sizeof(gxPoint),     /* size */
                          &amp;location); /* data */
</PRE>
 adds an eleventh item to the collection from <A HREF=#MARKER-9-45>Listing 5-3</A>. The collection tag of the new item is <CODE>'GXPT'</CODE>, but the new item has a collection ID of 20. <P>
 When you add this item to the collection, the Collection Manager assigns it a tag list position, reflecting its position in the list of items with the same collection tag. This tag list position can change if you add a new item with the same collection tag. For example, the call<P>
<PRE>
anErr = AddCollectionItem(pointsAndQuotes, 
                          'GXPT', 15, /* tag and id */
                          sizeof(gxPoint),     /* size */
                          &amp;location); /* data */
</PRE>
 adds a new item with the <CODE>'GXPT'</CODE> collection tag and a collection ID of 15. Adding this item can change the tag list position of any other item with the <CODE>'GXPT'</CODE> collection tag.<P>
 So far, the example collection contains items of the same size. You can also use the <CODE>AddCollectionItem</CODE> function to add items with variable-length data, as shown in <A HREF=#MARKER-9-46>Listing 5-4</A>.<P>
<B>Listing 5-4  <A NAME=MARKER-9-46></A>Adding items with variable-length data to a collection</B><P>
<PRE>
anErr = AddCollectionItem(pointsAndQuotes, 
                          'QUOT', 0,  /* tag and id */
                          17,  /* size */
                          &quot;Le plus ca change&quot;);  /* data */

anErr = AddCollectionItem(pointsAndQuotes, 
                          'QUOT', 1, 
                          29, &quot;Fourscore and seven years ago&quot;);

anErr = AddCollectionItem(pointsAndQuotes, 
                          'QUOT', 2,
                          18, &quot;It's not the heat.&quot;);
</PRE>
 The sample code from <A HREF=#MARKER-9-46>Listing 5-4</A> adds three new items to the example collection. Each of these items, which have collection tag <CODE>'QUOT'</CODE>, contains a string of characters as its variable-length data; however, each item contains a string of different length.<P>
 Note that the <CODE>AddCollectionItem</CODE> function copies the information from the block of memory pointed to by its final parameter into the specified collection item. After adding the item, you can change your copy of the information (the copy that the last parameter points to) without affecting the value of the item's variable-length data.<P>
 You can use the <CODE>CountCollectionItems</CODE> function to count the number of items in a collection. For example, after the call<P>
<PRE>
totalItems = CountCollectionItems(pointsAndQuotes);
</PRE>
 the <CODE>totalItems</CODE> variable contains the value 15 (12 items with points and 3 items with quotes).<P>
 You can use the <CODE>CountTaggedCollectionItems</CODE> function to count the number of items in a collection that have a specified collection tag. For example, after the call<P>
<PRE>
quotedItems = CountTaggedCollectionItems(pointsAndQuotes, 'QUOT');
</PRE>
 the <CODE>quotedItems</CODE> variable contains the value 3.<P>
 For more information about the <CODE>AddCollectionItem</CODE> function, see <A HREF=GXEnvironment-229.html#MARKER-9-161>page 5-62</A>. <P>
 For more information about the <CODE>CountCollectionItems</CODE> and <CODE>CountTaggedCollectionItems</CODE> functions, see <A HREF=GXEnvironment-237.html#MARKER-9-188>"Counting Items in a Collection" beginning on page 5-69</A>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="GXEnvironment-192.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="GXEnvironment-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="GXEnvironment-445.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="GXEnvironment-194.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="GXEnvironment-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
