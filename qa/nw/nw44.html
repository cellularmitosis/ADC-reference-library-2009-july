<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!--Template 06-20-02--><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Q&amp;A NW44: OT Serial Port I/O Handshaking</title><meta name="keywords" content="Mac OS 8 Open Transport Serial Port I/O handshaking"><meta name="Description" content="Technical Q&amp;A NW44: Q&amp;A describes how to specify and controlOpen Transport Serial port I/O handshaking."><meta name="categories" content="Networking"><meta name="week-posted" content="Nov 25, 1996 - Nov 29, 1996"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10001456" title="OT Serial Port I/O Handshaking"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalqas/index.html">Technical Q&As</a> &gt; <a href="../../technicalqas/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalqas/LegacyTechnologies/idxNetworking-date.html">Networking</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/Networking/index.html" target="_blank">Reference Library > Networking</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Q&amp;A NW44</div>
<div id="pageheadsub">OT Serial Port I/O Handshaking</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment -->						<!-- begin_content --> <CENTER><TABLE BORDER=0 CELLPADDING=0 WIDTH=600><TR> <td align="left"><hr width=500 align=center><p id = p2>Q:  How do I specify and control Open Transport Serial port I/O handshaking? The options seem a bit confusing.</p><p id=p4>A: By using the the <code>SRL_OPT_HANDSHAKE</code> Option provided by the Open Transport native interfaces you can customize serial port handshaking in variety of ways. For instance, you can request that input handshake be controlled by the CTS line, or by the <code>XON/OFF </code>sequence. The handshaking behavior is specified by a 4-byte unsigned integer value that is passed in with the <code>SRL_OPT_HANDSHAKE</code> Option: </p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>+=====-========-========-========-========-========-========-========-========+|  Bit|   7    |   6    |   5    |   4    |   3    |   2    |   1    |   0    ||Byte |        |        |        |        |        |        |        |        ||=====+========+========+=====================================================||  0  |        |        |        |        |        |        |        |        ||-----+-----------------------------------------------------------------------||  1  |        |        |        |        | DTR    | CTS    | XON/OFF| XON/OFF||     |        |        |        |        | Output | Input  | Input  | Output ||-----+-----------------------------------------------------------------------||  2  |                         XON character                                 ||-----+-----------------------------------------------------------------------||  3  |                         XOff character                                |+=============================================================================+</pre>	</TD></TR></TABLE></CENTER><p id=p4>The high word (16 bits) of the integer is a bitmap with 1 or more of the following bits set:</P><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>        kOTSerialXOnOffInputHandshake   = 1        kOTSerialXOnOffOutputHandshake  = 2        kOTSerialCTSInputHandshake      = 4        kOTSerialDTROutputHandshake     = 8</pre>	</TD></TR></TABLE></CENTER><p id=p4>The 2nd lowest byte is the <code>XOn</code> character value; the lowest byte is the <code>XOff</code> character value.</P><p id=p4>If these values are 0, and <code>XOnOff</code> handshaking was requested, the default values of Control-S for <code>XOff</code> and Control-Q for <code>XOn</code> will be used.</P> <p id=p4>There is an inline function (or #define for C users) <CODE>SerialHandshakeData(type, onChar, offChar)</CODE> defined in OpenTptSerial.h can be used to create this 4-byte value. The default value of this option is no handshaking.</P><p id=p4>For instance, if you wish to enable <code>XON/XOFF</code> input handshaking, but you wanted to specify that the <code>XON</code> char be a ^T instead of an ^Q. You would create an option structure in this manner.</P><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    TOption     opt;    opt.len     = kOTFourByteOptionSize;    opt.level   = XTI_GENERIC;    opt.name    = SERIAL_OPT_HANDSHAKE;    opt.value   = OTSerialHandshakeData  (kOTSerialXOnOffInputHandshake,                              ('T' &amp; ~0x40),                // normally kOTSerialDefaultOnCharkOTSerialDefaultOffChar);</pre>	</TD></TR></TABLE></CENTER><p id =p4>                                            You also have the ability to control the XOff state of the serial input port by using the                        the <code>I_SetSerialXOffState Ioctl</code> command. A value of 0 will unconditionally clear the <code>XOFF</code> state, while a value of 1 will unconditionally set it. </p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>OTIoctl(theSerialEndpoint, I_SetSerialXOffState, 1);    // Set XOFF state to ON</pre>	</TD></TR></TABLE></CENTER><p id=p4>The <code>I_SetSerialXOn</code> Ioctl causes the serial port to send an <code>XON</code> character. A value of 0 will only cause it to be sent if we're in the <code>XOFF</code> state, while a value of 1 will unconditionally send the character.</P><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>OTIoctl(theSerialEndpoint, I_SetSerialXOn, 1);          // Unconditionally send an XON</pre>	</TD></TR></TABLE></CENTER><p id=p4>Conversely, the <code>I_SetSerialXOff Ioctl</code> causes the serial port to send an <code>XOFF</code> character. A value of 0 will only cause it to be sent if we're in the <code>XON</code> state, while a value of 1 will unconditionally send the character.</P><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>OTIoctl(theSerialEndpoint, I_SetSerialXOff, 1);         // Unconditionally send an XOFF</pre>	</TD></TR></TABLE></CENTER></td></tr></table></center><!-- end_content --><!-- begin_date --><H4 ALIGN=center>[Nov 27 1996]</H4><!-- end_date --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/qa/nw/nw44.html%3Fid%3DDTS10001456-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/qa/nw/nw44.html%3Fid%3DDTS10001456-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/qa/nw/nw44.html%3Fid%3DDTS10001456-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --><hr width=500 align=center> </BODY></HTML>