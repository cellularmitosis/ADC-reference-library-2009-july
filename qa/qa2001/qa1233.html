<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><TITLE>Technical Q&amp;A QA1233: 'dynamic shared library not made a weak library in output with MACOSX_DEPLOYMENT_TARGET...' bug</TITLE><meta name="keywords" content="weak library MACOSX_DEPLOYMENT_TARGET ld QA1233 1233"><meta name="Description" content="Workarounds for the ld weak linking unused library/MACOSX_DEPLOYMENT_TARGET
bug"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002282" title="'dynamic shared library not made a weak library in output with MACOSX_DEPLOYMENT_TARGET...' bug"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalqas/index.html">Technical Q&As</a> &gt; <a href="../../technicalqas/DeveloperTools/index.html">Tools</a> &gt; <a href="../../technicalqas/DeveloperTools/idxCompilersDebuggers-date.html">Compiling & Debugging</a> &gt; </p><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Q&amp;A QA1233</div>
<div id="pageheadsub">'dynamic shared library not made a weak library in output with MACOSX_DEPLOYMENT_TARGET...' bug</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600> <TR> <TD><!-- begin_content --><HR width="500" align=center>         <P id=p2>Q:      Why does 'ld' give me a warning about my MACOSX_DEPLOYMENT_TARGET      environment variable and failing to weak link when I try      to build?</p>         <P id=p4>A:      When building in Project Builder using the December 2002      Mac OS X Developer Tools, you may get the following warning:</p>						<P id=p4><code>ld: warning dynamic shared library:</code></p>						<p id=p4><code>/path/to/a/library/or/framework/that/you/link/against not made a weak library in output with MACOSX_DEPLOYMENT_TARGET environment variable set to: 10.1</code></p>						<P id=p4>      This is most likely due to bug #3094497, which should be      fixed in the next major release of the Mac OS X Developer      Tools.  Here is what is happening: the framework or library      (call it library A) listed by ld is linked by your application,      but you use no symbols directly from it.  Another framework      or library (call it library B) that you link against and      use DOES use symbols from library A.  The linker gets confused,      and tries to weak link library A, when it should instead      be linking it strongly.  Since by default the MACOSX_DEPLOYMENT_TARGET      environment variable (which controls binary features introduced      in specific OS versions) is set to 10.1, and weak linking      was introduced in 10.2, the warning is generated.</p>						<P id=p4>      Here are two suggested workarounds in the meantime:</p><P id=p4>      1) If you do not mind weak linking against library A and      do not mind requiring Mac OS X 10.2 or higher to run, you      can set the MACOSX_DEPLOYMENT_TARGET to 10.2 in a target      build setting in Project Builder.  Note that after doing      this, if you are using cpp-precomp precompiled header technology      (instead of newer precompiled header technology like the      PFE) you may see lots of warnings about your precompiled      headers being broken.  To fix this, you need to rebuild your      precompiled headers  like so from Terminal:</p><P id=p4>      setenv MACOSX_DEPLOYMENT_TARGET 10.2</p><P id=p4>      sudo fixPrecomps -force</p><P id=p4>      2) If you do in fact need to continue building for Mac OS      X 10.1 and higher, or don't wish to start weak linking against      library A, then you can make a gratuitous reference to a      symbol in the library to get the linker to strongly link      against it.</p>          <HR width="500" align=center> <!-- begin_date --><H4 ALIGN=center>[Apr 01, 2003]</H4><!-- end_date --></TD> </TR> </TABLE></CENTER><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/qa/qa2001/qa1233.html%3Fid%3DDTS10002282-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/qa/qa2001/qa1233.html%3Fid%3DDTS10002282-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/qa/qa2001/qa1233.html%3Fid%3DDTS10002282-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>