<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE> Code Execution in General</TITLE></HEAD><BODY BGCOLOR="#ffffff"><DIV><a name="top"></a><!-- start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!-- start of path --><font face="Geneva,Helvetica,Arial" size="1"><b><br>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Documentation</a> &gt; <!-- a href="" target="_top" -->Hardware<!-- /a -->  <b>&gt; </b><a href="../../devicemgrs.html" target="_top">Device Managers and Drivers</a> <b>&gt; </b><a href="../pci_srvcs.html" target="_top">PCI Card Services</a> <b>&gt; </b>Designing PCI Cards and Drivers for Power Macintosh Computers</font><br><br><!-- end of path --><A HREF="PCI_BOOK.b3.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.b3.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.b5.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><HR></DIV><H1 CLASS="H2.Heading2"><A NAME="pgfId=3494"> </A>Code Execution in General</H1><P CLASS="T1.Text1"><A NAME="pgfId=3497"> </A>The environments in which code execution can occur are described in <A HREF="PCI_BOOK.75.html#28012" CLASS="XRef">Noninterrupt and Interrupt-Level Execution</A> and may be summarized as follows:</P><UL><LI CLASS="B1.Bullet1"><A NAME="pgfId=3499"> </A><B CLASS="bold">Task level</B> is where applications and most other code are executed.</LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=3500"> </A><B CLASS="bold">Hardware interrupt level</B> execution occurs as a direct result of a hardware interrupt request. The software executed at hardware interrupt level includes installable interrupt handlers for PCI and other devices as well as Apple-supplied interrupt handlers.</LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=3501"> </A><B CLASS="bold">Secondary interrupt level</B> is similar to the deferred task environment. The secondary interrupt queue is filled with requests to execute subroutines posted for execution by hardware interrupt handlers. Secondary interrupt handlers always execute sequentially. For synchronization purposes, code running at task level may also post secondary interrupt handlers for execution; these are processed synchronously from the perspective of the task level, but are serialized with all other secondary interrupt handlers.</LI></UL><DIV><blockquote><p CLASS="ImportantHead"><b><A NAME="pgfId=16620"> </A>IMPORTANT</b></p><P CLASS="I.Important"><A NAME="pgfId=3502"> </A>Hardware interrupt handlers can nest on current versions of the Mac OS, but may not be able to in future products. </P></blockquote><P CLASS="T1.Text1"><A NAME="pgfId=3506"> </A>Different execution levels have different restrictions. Task-level execution may make use of nearly any operating-system or Toolbox service, but secondary interrupt tasks and hardware interrupt handlers are allowed only a subset of those services. Eventhough a service may be described as callable from task level, you can't call it from any task-level code. For example, drivers are not allowed to call the Toolbox.</P></DIV><DIV><blockquote><p CLASS="NoteHead"><b><A NAME="pgfId=16622"> </A>Note</b></p><P CLASS="Note"><A NAME="pgfId=3507"> </A>Some confusion in System 7 programming results from ad hoc rules governing execution contexts. In System 7, applications have one set of rules while their VBL tasks, Time Manager tasks, and I/O completion routines all have their own rules. Rules that establish when certain system services can and cannot be used are difficult to understand and are not fully established. For further discussion of this topic, see the discussion in Technote 1104, &quot;Interrupt Safe Routines.&quot; </P></blockquote></DIV><HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 26 March 99)<P><A HREF="PCI_BOOK.b3.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.b3.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.b5.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></HTML>