<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Contents of a Query Document(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING484></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-483.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-485.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-469.html"><B>Chapter 12 - Data Access Manager</B></A> / <A HREF="IAC-482.html"><B>Creating a Query Document</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING484-0></A>
<H2><A NAME=MARKER-21-227></A>Contents of a Query Document</H2>
 <A NAME=MARKER-2-228></A>The query document must contain<A NAME=MARKER-2-229></A><P>
<UL>
<LI>one <CODE>'qrsc'</CODE> resource, as defined in the next section, <A HREF=IAC-485.html#MARKER-9-234>"Query Records and Query Resources"</A>
<LI>one <CODE>'STR#'</CODE> resource that contains the name of the database extension to be used, plus any host, user name, password, and connection string needed for the <CODE>DBInit</CODE> function 
<LI>one or more <CODE>'wstr'</CODE> resources containing queries--that is, strings of commands and data that the <CODE>DBSend</CODE> function sends to the data server and that the <CODE>DBExec</CODE> function executes<P>
</UL>
 A <CODE>'wstr'</CODE> resource consists of a 2-byte length field followed by a character string. (The <I>w</I> in <CODE>'wstr'</CODE> refers to the length word as opposed to the length byte used in an <CODE>'STR '</CODE> resource.) Each <CODE>'wstr'</CODE> resource contains one query (or one query template, to be modified by the query definition function before it is sent to the data server). The <CODE>'qrsc'</CODE> resource includes an array that lists the resource ID numbers of all of the <CODE>'wstr'</CODE> resources in the query document and an index into the array that specifies which one of the <CODE>'wstr'</CODE> resources should be sent to the data server.<A NAME=MARKER-2-230></A><P>
 In addition, the query document may contain<P>
<UL>
<LI>a <CODE>'qdef'</CODE> resource that contains a query definition function
<LI>any resources needed by the query definition function, such as <CODE>'DLOG'</CODE> and <CODE>'DITL'</CODE> resources (which support dialog boxes)
<LI>resources to support an icon (to replace the default icon that the Finder uses for files of type <CODE>'qery'</CODE>); see the chapter "Finder Interface" in <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I> for more information on icon resources and for guidelines on designing icons<P>
</UL>
 <A HREF=#MARKER-9-231>Figure 12-7</A> illustrates the relationship between the resources in a query document and the query record. <P>
<B>Figure 12-7  <A NAME=MARKER-9-231></A><A NAME=MARKER-21-232></A>The relationship between resources in a query document and the query record</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/DA-L-06.jpg"><P>
 The query document in <A HREF=#MARKER-9-231>Figure 12-7</A> contains a <CODE>'qrsc'</CODE> resource that specifies the resource ID of a <CODE>'qdef'</CODE> resource, the resource IDs of three <CODE>'wstr'</CODE> resources, and the resource ID of an <CODE>'STR#'</CODE> resource. It also specifies which of the three <CODE>'wstr'</CODE> resources represents the current query.<P>
 The <CODE>DBGetNewQuery</CODE> function creates the query record and partial queries from this information. Your application can use the <CODE>DBStartQuery</CODE> function to send a query to a data server. The <CODE>DBStartQuery</CODE> function calls the query definition function referred to by the query record (if any). The query definition function can prompt the user for information and modify the query as needed. <A HREF=#MARKER-9-233>Figure 12-8</A> illustrates a query record that contains a handle to an array of queries, a handle to a query definition function, and an index that identifies the current query. The query definition function displays a dialog box and modifies the current query according to the user's input. Once the query definition function modifies the current query and returns, the <CODE>DBStartQuery</CODE> function sends the query to the data server.<P>
<B>Figure 12-8  <A NAME=MARKER-9-233></A>The relationship between a query definition function and queries</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/DA-L-10.jpg"><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-483.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-485.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
