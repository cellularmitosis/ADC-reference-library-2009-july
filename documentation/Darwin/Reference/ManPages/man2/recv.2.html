<html><head><title>Mac OS X Developer Tools
 Manual Page For recv(2)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/2/recv" title="Mac OS X Developer Tools
 Manual Page for recv(2)"><!-- headerDoc=man; indexgroup=Section 2; uid="//apple_ref/doc/man/2/recv"; name=recv(2) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac&nbsp;OS&nbsp;X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>

<p style='text-align:justify;'>This manual page is associated with the Mac&nbsp;OS&nbsp;X
developer tools.  The software or headers described may not be present on your
Mac&nbsp;OS&nbsp;X installation until you install the developer tools
package.  This package is available on your Mac&nbsp;OS&nbsp;X installation DVD,
and the latest versions can be downloaded from
<a href="http://developer.apple.com/tools/download/">developer.apple.com</a>.</p>

<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
RECV(2)                     BSD System Calls Manual                    RECV(2)

<b>NAME</b>
     <b>recv</b>, <b>recvfrom</b>, <b>recvmsg</b> -- receive a message from a socket

<b>LIBRARY</b>
     Standard C Library (libc, -lc)

<b>SYNOPSIS</b>
     <b>#include</b> <b>&lt;sys/socket.h&gt;</b>

     <u>ssize</u><b>_</b><u>t</u>
     <b>recv</b>(<u>int</u> <u>socket</u>, <u>void</u> <u>*buffer</u>, <u>size</u><b>_</b><u>t</u> <u>length</u>, <u>int</u> <u>flags</u>);

     <u>ssize</u><b>_</b><u>t</u>
     <b>recvfrom</b>(<u>int</u> <u>socket</u>, <u>void</u> <u>*restrict</u> <u>buffer</u>, <u>size</u><b>_</b><u>t</u> <u>length</u>, <u>int</u> <u>flags</u>,
         <u>struct</u> <u>sockaddr</u> <u>*restrict</u> <u>address</u>, <u>socklen</u><b>_</b><u>t</u> <u>*restrict</u> <u>address</u><b>_</b><u>len</u>);

     <u>ssize</u><b>_</b><u>t</u>
     <b>recvmsg</b>(<u>int</u> <u>socket</u>, <u>struct</u> <u>msghdr</u> <u>*message</u>, <u>int</u> <u>flags</u>);

<b>DESCRIPTION</b>
     The <b>recvfrom</b>() and <b>recvmsg</b>() system calls are used to receive messages from a socket, and may be used
     to receive data on a socket whether or not it is connection-oriented.

     If <u>address</u> is not a null pointer and the socket is not connection-oriented, the source address of the
     message is filled in.  The <u>address</u><b>_</b><u>len</u> argument is a value-result argument, initialized to the size of
     the buffer associated with <u>address</u>, and modified on return to indicate the actual size of the address
     stored there.

     The <b>recv</b>() function is normally used only on a <u>connected</u> socket (see <a href="connect.2.html#//apple_ref/doc/man/2/connect">connect(2)</a>) and is identical to
     <b>recvfrom</b>() with a null pointer passed as its <u>address</u> argument.  As it is redundant, it may not be sup-<font color="#ffffff" class="whiteout">ported&nbsp;supported</font>
     ported in future releases.

     All three routines return the length of the message on successful completion.  If a message is too long
     to fit in the supplied buffer, excess bytes may be discarded depending on the type of socket the mes-<font color="#ffffff" class="whiteout">sage&nbsp;message</font>
     sage is received from (see <a href="socket.2.html#//apple_ref/doc/man/2/socket">socket(2)</a>).

     If no messages are available at the socket, the receive call waits for a message to arrive, unless the
     socket is nonblocking (see <a href="fcntl.2.html#//apple_ref/doc/man/2/fcntl">fcntl(2)</a>) in which case the value -1 is returned and the external variable
     <u>errno</u> set to EAGAIN.  The receive calls normally return any data available, up to the requested amount,
     rather than waiting for receipt of the full amount requested; this behavior is affected by the socket-<font color="#ffffff" class="whiteout">level&nbsp;socketlevel</font>
     level options SO_RCVLOWAT and SO_RCVTIMEO described in <a href="getsockopt.2.html#//apple_ref/doc/man/2/getsockopt">getsockopt(2)</a>.

     The <a href="select.2.html#//apple_ref/doc/man/2/select">select(2)</a> system call may be used to determine when more data arrive.

     If no messages are available to be received and the peer has performed an orderly shutdown, the value 0
     is returned.

     The <u>flags</u> argument to a <b>recv</b>() function is formed by <u>or</u>'ing one or more of the values:

           MSG_OOB        process out-of-band data
           MSG_PEEK       peek at incoming message
           MSG_WAITALL    wait for full request or error

     The MSG_OOB flag requests receipt of out-of-band data that would not be received in the normal data
     stream.  Some protocols place expedited data at the head of the normal data queue, and thus this flag
     cannot be used with such protocols.  The MSG_PEEK flag causes the receive operation to return data from
     the beginning of the receive queue without removing that data from the queue.  Thus, a subsequent
     receive call will return the same data.  The MSG_WAITALL flag requests that the operation block until
     the full request is satisfied.  However, the call may still return less data than requested if a signal
     is caught, an error or disconnect occurs, or the next data to be received is of a different type than
     that returned.

     The <b>recvmsg</b>() system call uses a <u>msghdr</u> structure to minimize the number of directly supplied argu-<font color="#ffffff" class="whiteout">ments.&nbsp;arguments.</font>
     ments.  This structure has the following form, as defined in &lt;<u>sys/socket.h&gt;</u>:

     struct msghdr {
             void            *msg_name;      /* optional address */
             socklen_t       msg_namelen;    /* size of address */
             struct          iovec *msg_iov; /* scatter/gather array */
             int             msg_iovlen;     /* # elements in msg_iov */
             void            *msg_control;   /* ancillary data, see below */
             socklen_t       msg_controllen; /* ancillary data buffer len */
             int             msg_flags;      /* flags on received message */
     };

     Here <u>msg</u><b>_</b><u>name</u> and <u>msg</u><b>_</b><u>namelen</u> specify the destination address if the socket is unconnected; <u>msg</u><b>_</b><u>name</u>
     may be given as a null pointer if no names are desired or required.  The <u>msg</u><b>_</b><u>iov</u> and <u>msg</u><b>_</b><u>iovlen</u> argu-<font color="#ffffff" class="whiteout">ments&nbsp;arguments</font>
     ments describe scatter gather locations, as discussed in <a href="read.2.html#//apple_ref/doc/man/2/read">read(2)</a>.  The <u>msg</u><b>_</b><u>control</u> argument, which has
     length <u>msg</u><b>_</b><u>controllen</u>, points to a buffer for other protocol control related messages or other miscel-<font color="#ffffff" class="whiteout">laneous&nbsp;miscellaneous</font>
     laneous ancillary data.  The messages are of the form:

     struct cmsghdr {
             u_int   cmsg_len;       /* data byte count, including hdr */
             int     cmsg_level;     /* originating protocol */
             int     cmsg_type;      /* protocol-specific type */
     /* followed by
             u_char  cmsg_data[]; */
     };

     As an example, one could use this to learn of changes in the data-stream in XNS/SPP, or in ISO, to
     obtain user-connection-request data by requesting a <b>recvmsg</b>() with no data buffer provided immediately
     after an <b>accept</b>() system call.

     Open file descriptors are now passed as ancillary data for AF_UNIX domain sockets, with <u>cmsg</u><b>_</b><u>level</u> set
     to SOL_SOCKET and <u>cmsg</u><b>_</b><u>type</u> set to SCM_RIGHTS.

     The <u>msg</u><b>_</b><u>flags</u> field is set on return according to the message received.  MSG_EOR indicates end-of-<font color="#ffffff" class="whiteout">record;&nbsp;end-ofrecord;</font>
     record; the data returned completed a record (generally used with sockets of type SOCK_SEQPACKET).
     MSG_TRUNC indicates that the trailing portion of a datagram was discarded because the datagram was
     larger than the buffer supplied.  MSG_CTRUNC indicates that some control data were discarded due to
     lack of space in the buffer for ancillary data.  MSG_OOB is returned to indicate that expedited or out-<font color="#ffffff" class="whiteout">of-band&nbsp;outof-band</font>
     of-band data were received.

<b>RETURN</b> <b>VALUES</b>
     These calls return the number of bytes received, or -1 if an error occurred.

     For TCP sockets, the return value 0 means the peer has closed its half side of the connection.

<b>ERRORS</b>
     The calls fail if:

     [EAGAIN]           The socket is marked non-blocking, and the receive operation would block, or a
                        receive timeout had been set, and the timeout expired before data were received.

     [EBADF]            The argument <u>socket</u> is an invalid descriptor.

     [ECONNRESET]       The connection is closed by the peer during a receive attempt on a socket.

     [EFAULT]           The receive buffer <!-- a -->pointer(s)<!-- /a --> point outside the process's address space.

     [EINTR]            The receive was interrupted by delivery of a signal before any data were available.

     [EINVAL]           MSG_OOB is set, but no out-of-band data is available.

     [ENOBUFS]          An attempt to allocate a memory buffer fails.

     [ENOTCONN]         The socket is associated with a connection-oriented protocol and has not been con-<font color="#ffffff" class="whiteout">nected&nbsp;connected</font>
                        nected (see <a href="connect.2.html#//apple_ref/doc/man/2/connect">connect(2)</a> and <a href="accept.2.html#//apple_ref/doc/man/2/accept">accept(2)</a>).

     [ENOTSOCK]         The argument <u>socket</u> does not refer to a socket.

     [EOPNOTSUPP]       The type and/or protocol of <u>socket</u> do not support the <!-- a -->option(s)<!-- /a --> specified in <u>flags</u>.

     [ETIMEDOUT]        The connection timed out.

     The <b>recvfrom</b>() call may also fail if:

     [EINVAL]           The total of the iov_len values overflows a ssize_t.

     The <b>recvmsg</b>() call may also fail if:

     [EMSGSIZE]         The requested message size is invalid.

     [ENOMEM]           Insufficient memory is available.

<b>SEE</b> <b>ALSO</b>
     <a href="fcntl.2.html#//apple_ref/doc/man/2/fcntl">fcntl(2)</a>, <a href="getsockopt.2.html#//apple_ref/doc/man/2/getsockopt">getsockopt(2)</a>, <a href="read.2.html#//apple_ref/doc/man/2/read">read(2)</a>, <a href="select.2.html#//apple_ref/doc/man/2/select">select(2)</a>, <a href="socket.2.html#//apple_ref/doc/man/2/socket">socket(2)</a>

<b>HISTORY</b>
     The <b>recv</b>() function appeared in 4.2BSD.

BSD                              May 15, 2006                              BSD
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man2/recv.2.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man2/recv.2.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man2/recv.2.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
