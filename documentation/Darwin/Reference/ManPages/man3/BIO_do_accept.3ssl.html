<html><head><title>Mac OS X Developer Tools
 Manual Page For BIO_do_accept(3ssl)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/3ssl/BIO_do_accept" title="Mac OS X Developer Tools
 Manual Page for BIO_do_accept(3ssl)"><a name="//apple_ref/doc/man/3/BIO_do_accept" title="Mac OS X Developer Tools
 Manual Page for BIO_do_accept(3ssl)"><!-- headerDoc=man; indexgroup=Section 3ssl; uid="//apple_ref/doc/man/3ssl/BIO_do_accept"; name=BIO_do_accept(3ssl) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac&nbsp;OS&nbsp;X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>

<p style='text-align:justify;'>This manual page is associated with the Mac&nbsp;OS&nbsp;X
developer tools.  The software or headers described may not be present on your
Mac&nbsp;OS&nbsp;X installation until you install the developer tools
package.  This package is available on your Mac&nbsp;OS&nbsp;X installation DVD,
and the latest versions can be downloaded from
<a href="http://developer.apple.com/tools/download/">developer.apple.com</a>.</p>

<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
BIO_s_accept(3)                                    OpenSSL                                   <a href="BIO_s_accept.3ssl.html#//apple_ref/doc/man/3/BIO_s_accept">BIO_s_accept(3)</a>



<b>NAME</b>
       BIO_s_accept, BIO_set_accept_port, BIO_get_accept_port, BIO_set_nbio_accept, BIO_set_accept_bios,
       BIO_set_bind_mode, BIO_get_bind_mode, BIO_do_accept - accept BIO

<b>SYNOPSIS</b>
        #include &lt;openssl/bio.h&gt;

        BIO_METHOD *BIO_s_accept(void);

        long BIO_set_accept_port(BIO *b, char *name);
        char *BIO_get_accept_port(BIO *b);

        BIO *BIO_new_accept(char *host_port);

        long BIO_set_nbio_accept(BIO *b, int n);
        long BIO_set_accept_bios(BIO *b, char *bio);

        long BIO_set_bind_mode(BIO *b, long mode);
        long BIO_get_bind_mode(BIO *b, long dummy);

        #define BIO_BIND_NORMAL                0
        #define BIO_BIND_REUSEADDR_IF_UNUSED   1
        #define BIO_BIND_REUSEADDR             2

        int BIO_do_accept(BIO *b);

<b>DESCRIPTION</b>
       <u>BIO</u><b>_</b><u>s</u><b>_</b><u>accept()</u> returns the accept BIO method. This is a wrapper round the platform's TCP/IP socket
       accept routines.

       Using accept BIOs, TCP/IP connections can be accepted and data transferred using only BIO routines.
       In this way any platform specific operations are hidden by the BIO abstraction.

       Read and write operations on an accept BIO will perform I/O on the underlying connection. If no
       connection is established and the port (see below) is set up properly then the BIO waits for an
       incoming connection.

       Accept BIOs support <u>BIO</u><b>_</b><u>puts()</u> but not <u>BIO</u><b>_</b><u>gets()</u>.

       If the close flag is set on an accept BIO then any active connection on that chain is shutdown and
       the socket closed when the BIO is freed.

       Calling <u>BIO</u><b>_</b><u>reset()</u> on a accept BIO will close any active connection and reset the BIO into a state
       where it awaits another incoming connection.

       <u>BIO</u><b>_</b><u>get</u><b>_</b><u>fd()</u> and <u>BIO</u><b>_</b><u>set</u><b>_</b><u>fd()</u> can be called to retrieve or set the accept socket. See <a href="BIO_s_fd.3ssl.html#//apple_ref/doc/man/3/BIO_s_fd"><u>BIO</u><b>_</b><u>s</u><b>_</b><u>fd</u>(3)</a>

       <u>BIO</u><b>_</b><u>set</u><b>_</b><u>accept</u><b>_</b><u>port()</u> uses the string <b>name</b> to set the accept port. The port is represented as a
       string of the form "host:port", where "host" is the interface to use and "port" is the port.  Either
       or both values can be "*" which is interpreted as meaning any interface or port respectively. "port"
       has the same syntax as the port specified in <u>BIO</u><b>_</b><u>set</u><b>_</b><u>conn</u><b>_</b><u>port()</u> for connect BIOs, that is it can be
       a numerical port string or a string to lookup using <u>getservbyname()</u> and a string table.

       <u>BIO</u><b>_</b><u>new</u><b>_</b><u>accept()</u> combines <u>BIO</u><b>_</b><u>new()</u> and <u>BIO</u><b>_</b><u>set</u><b>_</b><u>accept</u><b>_</b><u>port()</u> into a single call: that is it creates
       a new accept BIO with port <b>host_port</b>.

       <u>BIO</u><b>_</b><u>set</u><b>_</b><u>nbio</u><b>_</b><u>accept()</u> sets the accept socket to blocking mode (the default) if <b>n</b> is 0 or non blocking
       mode if <b>n</b> is 1.

       <u>BIO</u><b>_</b><u>set</u><b>_</b><u>accept</u><b>_</b><u>bios()</u> can be used to set a chain of BIOs which will be duplicated and prepended to
       the chain when an incoming connection is received. This is useful if, for example, a buffering or SSL
       BIO is required for each connection. The chain of BIOs must not be freed after this call, they will
       be automatically freed when the accept BIO is freed.

       <u>BIO</u><b>_</b><u>set</u><b>_</b><u>bind</u><b>_</b><u>mode()</u> and <u>BIO</u><b>_</b><u>get</u><b>_</b><u>bind</u><b>_</b><u>mode()</u> set and retrieve the current bind mode. If
       BIO_BIND_NORMAL (the default) is set then another socket cannot be bound to the same port. If
       BIO_BIND_REUSEADDR is set then other sockets can bind to the same port. If
       BIO_BIND_REUSEADDR_IF_UNUSED is set then and attempt is first made to use BIO_BIN_NORMAL, if this
       fails and the port is not in use then a second attempt is made using BIO_BIND_REUSEADDR.

       <u>BIO</u><b>_</b><u>do</u><b>_</b><u>accept()</u> serves two functions. When it is first called, after the accept BIO has been setup,
       it will attempt to create the accept socket and bind an address to it. Second and subsequent calls to
       <u>BIO</u><b>_</b><u>do</u><b>_</b><u>accept()</u> will await an incoming connection, or request a retry in non blocking mode.

<b>NOTES</b>
       When an accept BIO is at the end of a chain it will await an incoming connection before processing
       I/O calls. When an accept BIO is not at then end of a chain it passes I/O calls to the next BIO in
       the chain.

       When a connection is established a new socket BIO is created for the connection and appended to the
       chain. That is the chain is now accept-&gt;socket. This effectively means that attempting I/O on an
       initial accept socket will await an incoming connection then perform I/O on it.

       If any additional BIOs have been set using <u>BIO</u><b>_</b><u>set</u><b>_</b><u>accept</u><b>_</b><u>bios()</u> then they are placed between the
       socket and the accept BIO, that is the chain will be accept-&gt;otherbios-&gt;socket.

       If a server wishes to process multiple connections (as is normally the case) then the accept BIO must
       be made available for further incoming connections. This can be done by waiting for a connection and
       then calling:

        connection = BIO_pop(accept);

       After this call <b>connection</b> will contain a BIO for the recently established connection and <b>accept</b> will
       now be a single BIO again which can be used to await further incoming connections.  If no further
       connections will be accepted the <b>accept</b> can be freed using <u>BIO</u><b>_</b><u>free()</u>.

       If only a single connection will be processed it is possible to perform I/O using the accept BIO
       itself. This is often undesirable however because the accept BIO will still accept additional
       incoming connections. This can be resolved by using <u>BIO</u><b>_</b><u>pop()</u> (see above) and freeing up the accept
       BIO after the initial connection.

       If the underlying accept socket is non-blocking and <u>BIO</u><b>_</b><u>do</u><b>_</b><u>accept()</u> is called to await an incoming
       connection it is possible for <u>BIO</u><b>_</b><u>should</u><b>_</b><u>io</u><b>_</b><u>special()</u> with the reason BIO_RR_ACCEPT. If this happens
       then it is an indication that an accept attempt would block: the application should take appropriate
       action to wait until the underlying socket has accepted a connection and retry the call.

       <u>BIO</u><b>_</b><u>set</u><b>_</b><u>accept</u><b>_</b><u>port()</u>, <u>BIO</u><b>_</b><u>get</u><b>_</b><u>accept</u><b>_</b><u>port()</u>, <u>BIO</u><b>_</b><u>set</u><b>_</b><u>nbio</u><b>_</b><u>accept()</u>, <u>BIO</u><b>_</b><u>set</u><b>_</b><u>accept</u><b>_</b><u>bios()</u>,
       <u>BIO</u><b>_</b><u>set</u><b>_</b><u>bind</u><b>_</b><u>mode()</u>, <u>BIO</u><b>_</b><u>get</u><b>_</b><u>bind</u><b>_</b><u>mode()</u> and <u>BIO</u><b>_</b><u>do</u><b>_</b><u>accept()</u> are macros.

<b>RETURN</b> <b>VALUES</b>
       TBA

<b>EXAMPLE</b>
       This example accepts two connections on port 4444, sends messages down each and finally closes both
       down.

        BIO *abio, *cbio, *cbio2;
        ERR_load_crypto_strings();
        abio = BIO_new_accept("4444");

        /* First call to BIO_accept() sets up accept BIO */
        if(BIO_do_accept(abio) &lt;= 0) {
               fprintf(stderr, "Error setting up accept\n");
               ERR_print_errors_fp(stderr);
               exit(0);
        }

        /* Wait for incoming connection */
        if(BIO_do_accept(abio) &lt;= 0) {
               fprintf(stderr, "Error accepting connection\n");
               ERR_print_errors_fp(stderr);
               exit(0);
        }
        fprintf(stderr, "Connection 1 established\n");
        /* Retrieve BIO for connection */
        cbio = BIO_pop(abio);
        BIO_puts(cbio, "Connection 1: Sending out Data on initial connection\n");
        fprintf(stderr, "Sent out data on connection 1\n");
        /* Wait for another connection */
        if(BIO_do_accept(abio) &lt;= 0) {
               fprintf(stderr, "Error accepting connection\n");
               ERR_print_errors_fp(stderr);
               exit(0);
        }
        fprintf(stderr, "Connection 2 established\n");
        /* Close accept BIO to refuse further connections */
        cbio2 = BIO_pop(abio);
        BIO_free(abio);
        BIO_puts(cbio2, "Connection 2: Sending out Data on second\n");
        fprintf(stderr, "Sent out data on connection 2\n");

        BIO_puts(cbio, "Connection 1: Second connection established\n");
        /* Close the two established connections */
        BIO_free(cbio);
        BIO_free(cbio2);

<b>SEE</b> <b>ALSO</b>
       TBA



0.9.7l                                           2002-12-12                                  <a href="BIO_s_accept.3ssl.html#//apple_ref/doc/man/3/BIO_s_accept">BIO_s_accept(3)</a>
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man3/BIO_do_accept.3ssl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man3/BIO_do_accept.3ssl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man3/BIO_do_accept.3ssl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
