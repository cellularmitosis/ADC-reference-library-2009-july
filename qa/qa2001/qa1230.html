<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Q&amp;A QA1230: Movie Export Components - Supporting a MovieProgressProc</title><meta name="keywords" content="MovieProgressProc, Movie Export Component"><meta name="Description" content="Technical Q&amp;A QA1230: This Q&amp;A explains the steps neededto support a Movie Progress Proc in a Movie Export Component."><meta name="categories" content="QuickTime Components"><meta name="week-posted" content="Dec 30, 2002 - Jan 3, 2003"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10001753" title="Movie Export Components - Supporting a MovieProgressProc"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalqas/index.html">Technical Q&As</a> &gt; <a href="../../technicalqas/QuickTime/index.html">QuickTime</a> &gt; <a href="../../technicalqas/QuickTime/idxQuickTimeComponentCreation-date.html">QuickTime Component Creation</a> &gt; </p><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Q&amp;A QA1230</div>
<div id="pageheadsub">Movie Export Components - Supporting a MovieProgressProc</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER>			<TABLE BORDER=0 CELLSPACING=1 WIDTH=600> <TR> <TD align="left"><!-- begin_content --><hr width=500 align=center>         <P id=p2>Q: I'm working on a Movie Export Component which encodes and writes data to a file. This process takes some time and I'd like to support a progress procedure. I've read about the MovieProgressProc but it seems to only apply to functions like <code>ConvertMovieToFile</code> and <code>PutMovieIntoTypedHandle</code>. How do I support a ProgressProc in my Export Component?</p>						<P id=p4>A: Supporting a Progress Procedure in your Export Component is quite straightforward.</p>						<p id=p4>The application will supply a <code>MovieProgressProc</code> conforming to the prototype in Listing 1. This is the user function you will call from your component.</p>						<div align="center">							<table border=0 cellpadding=4 width=550>								<tr>									<td bgcolor="#E6E6E6" align=left scope="row">										<pre>OSErr MyMovieProgressProc(Movie theMovie,                          short message,                          short whatOperation,                          Fixed percentDone,                          long  refcon);</pre>									</td>								</tr>								<tr>									<td align="left" scope="row">										<p><b>Listing 1</b>. Prototype for an application defined MovieProgressProc.</p>									</td>								</tr>							</table>						</div>						<p id=p4>You will need to support the <code>SetProgressProc</code> selector and implement the <code>SetProgressProc</code> function in your Export Component. This allows your component to be called with the <code>MovieExportSetProgressProc</code> API.</p>						<div align="center">							<table border=0 cellpadding=4 width=550>								<tr>									<td bgcolor="#E6E6E6" align=left scope="row">										<pre>ComponentCall (SetProgressProc)</pre>									</td>								</tr>								<tr>									<td align="left" scope="row">										<p><b>Listing 2</b>. Supporting the SetProgressProc selector.</p>									</td>								</tr>							</table>						</div>						<p id=p4>QuickTime will then call your Export Component with the <code>ProgressProc</code> (a <code>MovieProgressUPP</code>) and <code>refcon</code>. Store this <code>MovieProgressUPP</code> and <code>refcon</code> in your component globals for later use.</p>						<div align="center">							<table border=0 cellpadding=4 width=550>								<tr>									<td bgcolor="#E6E6E6" align=left scope="row">										<pre>pascal ComponentResult MyExport_SetProgressProc(                                myExportGlobals  glob,                                MovieProgressUPP proc,                                long             refcon){    if ((NULL == proc) || (-1 == proc)) return paramErr;    glob-&gt;progressProc = proc;    glob-&gt;progressProcRefCon = refCon;    return noErr;}</pre>									</td>								</tr>								<tr>									<td align="left" scope="row">										<p><b>Listing 3</b>. Export component SetProgressProc implementation.</p>									</td>								</tr>							</table>						</div>						<p id=p4>During the export process (when your component is doing its work), call the progress procedure using <code>InvokeMovieProgressUPP</code> making sure to supply the appropriate messages and updated percentage values to indicate your progress.</p>						<p id=p4>The <code>message</code> parameter should be set to one of the following values:</p>						<ul>							<li id=p4><code>movieProgressOpen</code> - your exporter is starting long operation, this <b>must</b> always be the first message.							<li id=p4><code>movieProgressUpdatePercent</code> - relative completion of the operation.							<li id=p4><code>movieProgressClose</code> - export operation done, this <b>must</b> be the last message.						</ul>						<p id=p4>The <code>whatOperation</code> parameter should be set to reflect the export operation:</p>						<ul>							<li id=p4><code>progressOpExportMovie</code> - export operation.						</ul>						<CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>InvokeMovieProgressUPP(        NULL,                  // movie        movieProgress...,      // movieProgressOpen,                               // movieProgressUpdatePercent                               // or movieProgressClose        progressOpExportMovie, // exporting        myPercentDone,         // a fixed value 1.0 == 100% done        store-&gt;progressProcRefCon,        glob-&gt;progressProc);</pre></TD></TR>								<TR><TD align="left"><P><B>Listing 4</B>. Calling the MovieProgressProc from an Export Component</P></TD></TR>							</TABLE></CENTER>						<p id=p4>Application developers should note that the &quot;Default Progress Proc&quot; value of -1 cannot be used with <code>MovieExportSetProgressProc</code>. This API requires that you supply a valid callback function.</p>						<h4 id=p4>References:</h4>						<ul>							<li id=p4><a href="../../documentation/quicktime/qtdevdocs/APIREF/SOURCESII/movieexportsetprogressproc.htm" target="_blank">MovieExportSetProgressProc</a>							<li id=p4><a href="../../documentation/quicktime/qtdevdocs/APIREF/SOURCESIII/movieprogressproc.htm" target="_blank">MovieProgressProc</a>							<li id=p4><a href="../../documentation/quicktime/qtdevdocs/INMAC/QT/iqMovieToolbox.53.htm" target="_blank">Progress Functions</a>							<li id=p4><a href="../../documentation/quicktime/qtdevdocs/APIREF/SOURCESV/wwpgcoverfs.htm" target="_blank">Working with Progress and Cover Functions</a>							<li id=p4><a href="../../documentation/quicktime/qtdevdocs/APIREF/SOURCESIII/setmovieprogressproc.htm" target="_blank">SetMovieProgressProc</a>							<li id=p4><a href="../../documentation/quicktime/qtdevdocs/APIREF/SOURCESII/newmovieprogressupp.htm" target="_blank">NewMovieProgressUPP</a>							<li id=p4><a href="../../documentation/quicktime/qtdevdocs/APIREF/SOURCESI/disposemovieprogressupp.htm" target="_blank">DisposeMovieProgressUPP</a>						</ul>						<hr width=500 align=center>						<!-- begin_date --><H4 ALIGN=center>[Jan 31 2003]</H4><!-- end_date --></TD> </TR> </TABLE>		</CENTER><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/qa/qa2001/qa1230.html%3Fid%3DDTS10001753-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/qa/qa2001/qa1230.html%3Fid%3DDTS10001753-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/qa/qa2001/qa1230.html%3Fid%3DDTS10001753-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>