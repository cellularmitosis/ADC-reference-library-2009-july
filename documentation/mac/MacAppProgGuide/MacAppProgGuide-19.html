<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Processing Events (MacApp PG)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING19></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MacAppProgGuide-18.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-20.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MacAppProgGuide-2.html"><B>Programmer's Guide to MacApp</B></A> / <BR><DD><A HREF="MacAppProgGuide-14.html"><B>Chapter 1 - MacApp Overview</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING19-0></A>
<H1><A NAME=MARKER-9-56></A><A NAME=MARKER-2-57></A>Processing Events</H1>
 Macintosh applications are driven by events. An application receives many kinds of events: activate and update events from the operating system, mouse and keystroke events generated by user actions, Apple events from a number of possible sources (the system, another application, a script, the application itself), and so on. In a MacApp application, the application object receives and dispatches these events. <A HREF=#MARKER-9-58>Figure 1-4</A> shows an application receiving and dispatching simple events.<P>
<B>Figure 1-4  <A NAME=MARKER-9-58></A><A NAME=MARKER-2-59></A>An application receiving events and dispatching them to objects</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/MacApp_PG-L-064.gif"><P>
 The application object has several mechanisms for determining which object should handle an event. The next sections describe how events are dispatched, and how objects handle the events they receive.<P>
<A NAME=HEADING19-5></A>
<H2>Direct Dispatching</H2>
 The application object dispatches some events directly to a particular object. For example, update and activate events are dispatched directly to the window object for the window to be updated or activated.<P>
<A NAME=HEADING19-7></A>
<H2>View Hierarchy Dispatching</H2>
 Mouse-up and mouse-down events are dispatched to a view hierarchy. The event is passed first to the window in which it occurred. The window object iterates through its views, giving each view a chance to handle the mouse event. Each view object iterates through its subviews in the same way.<P>
<A NAME=HEADING19-9></A>
<H2>Target Chain Dispatching</H2>
 There are usually a number of objects in your application that can handle an event. MacApp organizes these objects into a linked chain, called a <B><A NAME=MARKER-2-60></A>target chain.</B> The object at the head of the chain is called the <B><A NAME=MARKER-2-61></A>current target object.</B><P>
 <A HREF=#MARKER-9-62>Figure 1-5</A> shows a typical target chain. The current target object is a view in the open window "untitled." The next object in the chain is the view's superview, followed by its window, its document, and the application object.<P>
<B>Figure 1-5  <A NAME=MARKER-9-62></A><A NAME=MARKER-2-63></A>The objects in a typical target chain</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/MacApp_PG-L-031.gif"><P>
 MacApp handles menu choices and keystrokes by calling a method of the current target object. The target object either handles the event or sends it to the next object in the chain. For more information on direct dispatching, view hierarchy dispatching, and the target chain, see <A HREF=MacAppProgGuide-40.html#MARKER-9-19>Chapter 5, "Events and Commands."</A><P>
<A NAME=HEADING19-15></A>
<H3>Apple Event Dispatching</H3>
 Apple events are dispatched by the combined efforts of the application object, MacApp's global scripting dispatcher object, and the scripting support supplied by the Macintosh Operating System. Apple event dispatching is described in detail in <A HREF=MacAppProgGuide-48.html#MARKER-9-19>Chapter 6, "Scripting."</A><P>
<A NAME=HEADING19-17></A>
<H2>Handling Events</H2>
 MacApp supplies a sophisticated mechanism for handling an event once it has been dispatched to an object. An object may handle an event by performing the specified action directly, but more often it creates a command object that is capable of doing and undoing the action.<P>
<A NAME=HEADING19-19></A>
<H3>Handling an Event With a Command Object</H3>
 A simple command object contains data and methods to perform an action. More sophisticated command objects support reversing the command action through <CODE>Undo</CODE> and <CODE>Redo</CODE> methods.<P>
 Your application posts command objects to the command queue, which is described in the next section. MacApp calls methods of the command object at the appropriate time to do, undo, or redo the command action.<P>
<DL>
<DT><B>Note</B>
<DD>A command object is capable of sending an Apple event to record the command action or to allow an attached script to perform the action. For more information, see <A HREF=MacAppProgGuide-48.html#MARKER-9-19>Chapter 6, "Scripting."</A><EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
<A NAME=HEADING19-23></A>
<H3><A NAME=MARKER-9-64></A>The Command Queue</H3>
 Command objects posted by your application are inserted into a queue maintained by the application object. MacApp uses its main event loop to repeatedly retrieve either an event from the operating system or a command from the command queue. Toolbox events received by MacApp are normally dispatched directly upon receipt. Commands are retrieved from the command queue and processed in order.<P>
<A NAME=HEADING19-25></A>
<H3>Event and Command Classes</H3>
 The <CODE>TEvent</CODE> class is an abstract base class that provides a common parent for classes that represent events and commands. MacApp provides many subclasses of <CODE>TEvent</CODE>, including<P>
<UL>
<LI><B><A NAME=MARKER-2-65></A>TToolboxEvent.</B> MacApp uses the <CODE>TToolboxEvent</CODE> class to encapsulate the information from a Macintosh Toolbox event, such as a mouse-down event. The <CODE>fEvent</CODE> field stores the low-level information from the event's Toolbox event record.
<LI><B><A NAME=MARKER-2-66></A>TCommand.</B> <CODE>TCommand</CODE> is an abstract base class for classes that perform operations that can be done, undone, and redone. MacApp provides many subclasses of <CODE>TCommand</CODE>. Two commonly used command classes are <CODE>TTracker</CODE> and <CODE>TUndoRedoCommand</CODE>.<P>
<UL>
<LI><B><A NAME=MARKER-2-67></A>TTracker.</B> This class has methods for tracking the mouse, constraining the mouse, and providing user feedback for the mouse.
<LI><B><A NAME=MARKER-2-68></A>TUndoRedoCommand.</B> MacApp uses the <CODE>TUndoRedoCommand</CODE> class to undo and redo the command action of other command classes.<P>
</UL>
</UL>
<A NAME=HEADING19-31></A>
<H3>Event-Handling and Command-Handling Classes</H3>
 The <CODE><A NAME=MARKER-2-69></A>TEventHandler</CODE> class provides fields and methods for handling events such as mouse-down events and menu commands. The <CODE><A NAME=MARKER-2-70></A>TCommandHandler</CODE> class, a subclass of <CODE>TEventHandler</CODE>, adds support for creating command objects to perform operations that can be done, undone, and redone.<P>
 Since most objects that handle events create commands to perform the operation specified by the event, you rarely define a direct subclass of <CODE>TEventHandler</CODE>. It is more common to define a subclass of <CODE>TCommandHandler</CODE>, or of one of the command-handler subclasses provided by MacApp.<P>
<DL>
<DT><B>Note</B>
<DD>Since the <CODE>TCommandHandler</CODE> class can both handle menu commands and create command objects, you can take your pick as to which capability its name refers to.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 MacApp's most widely used classes, including <CODE>TApplication</CODE>, <CODE>TDocument</CODE>, <CODE>TView</CODE>, and <CODE>TWindow</CODE>, are based on <CODE>TCommandHandler</CODE> and are therefore capable of handling both events and commands. Classes that descend from <CODE>TBehavior</CODE> can also handle events. Behaviors are described in <A HREF=MacAppProgGuide-40.html#MARKER-9-19>Chapter 5, "Events and Commands."</A><A NAME=MARKER-2-71></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MacAppProgGuide-18.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-20.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MacAppProgGuide-3.html">&copy; Apple Computer, Inc.</A><br>25 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
