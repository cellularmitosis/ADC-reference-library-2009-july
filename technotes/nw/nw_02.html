<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note NW02: AppleTalk Interface Update</title><meta name="keywords" content=""><meta name="Description" content="Technical Note NW02: ">                                       <meta name="categories" content="Networking"><meta name="week-posted" content="Jun 29, 1987 - Jul 3, 1987"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF" TEXT="#000000"><a name="//apple_ref/doc/uid/DTS10002544" title="AppleTalk Interface Update"></a><a name="top"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxNetworking-date.html">Networking</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/Networking/index.html" target="_blank">Reference Library > Networking</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note NW02</div>
<div id="pageheadsub">AppleTalk Interface Update</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->					<p id="menutext">					<a href="#Introduction">Introduction</a><BR><BR>					<a href="#Section1">Synchronous and Asynchronous calls</a><BR><BR>					<a href="#Section2">Packed data structures</a><BR><BR>					<a href="#Section3">Zone Interface Protocol</a><BR><BR>					<a href="#References">References</a><BR><BR><a href="#Downloads">Downloadables</a></p>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext"></p> <!-- end_intro_text --><!-- begin_date --><h3 align=center>[Jul 01 1987]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR><!-- begin_content --><a name="Introduction"></a><h2>Introduction</h2><p>M.NW.HL.AppleTalk announced that we would be moving to a simplified AppleTalkManager interface. That interface is available now, as part of MPW 2.0 andnewer.</p><p>Documentation for this new interface is contained in the AppleTalk Managerchapter of <i>Inside Macintosh Volume V</i>. This technical note contains someof the preliminary documentation for this interface and some useful pointsabout information about it, and AppleTalk in general.<BR><br><br>The original AppleTalk Pascal Interfaces, known as <code>ABPasIntf</code>, weredesigned to simplify use of AppleTalk from high-level languages. Instead,they've caused us a few compatibility problems. We've decided to encourage useof the same interface that assembly-language AppleTalk uses, a parameter-blockinterface in the same style as the low-level interfaces to the File and DeviceManagers.</p><p>The original calls are still supported (and will be for a while) as an"alternate" interface, but we suggest that you consider moving to the new"preferred" calls. Be warned that use of the original calls may causecompatibility problems with future system software. Also, new protocols (likeASP, the AppleTalk Session Protocol) are only provided with the newinterfaces.</p><p>The new interface uses parameter blocks like those used by the File and DeviceManagers; you fill out the call-specific fields of the block, and a smallamount of glue code (provided with development environments like MPW) turns theparameter block into a <code>Control</code> call to the appropriate AppleTalkdriver.</p><p>Most calls have an interface like:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    FUNCTION PSomeCall(thePBPtr: ATPPBptr; asyncFlag: BOOLEAN): OSErr;</pre>	</TD></TR></TABLE></CENTER><p>The glue fills in the fields <code>csCode</code> and <code>ioRefNum</code> with theappropriate value for the call you're making.</p><P><A HREF="#top">Back to top</A></P><a name="Section1"></a><h2>Synchronous and Asynchronous calls</h2><p>You can still make calls synchronously ("do it now") or asynchronously ("startit now, finish it soon"). If you choose to make a call asynchronously, be sureto provide a completion routine in the <code>ioCompletion</code> field (to becalled when the call finally finishes), or poll the <code>ioResult</code> field ofthe parameter block (the call is done if <code>ioResult</code> is less than orequal to 0).</p><p>You must not move or dispose of a parameter block before the call finishes;when the call does complete, you are responsible for throwing the parameterblock away (if you allocated it using Memory Manager routines).</p><p>Note that the alternate interfaces generated a network event on completion ofan asynchronous call; this service is not provided by the preferred interfaces,partly because of future compatibility problems. See M.NW.NoNetEvents forbackground information.</p><P><A HREF="#top">Back to top</A></P><a name="Section2"></a><h2>Packed data structures</h2><p>Several of the data structures used by the new interfaces are packed; Pascaldoesn't deal well with these structures. Special calls are provided forbuilding LAP and DPP write-data structures, NBP names-table elements, and ATPbuffer data structures.</p><p>For example, when registering a name (using <code>PRegisterName)</code>, you'll usea <code>NamesTableEntry</code> structure. This structure consists of a few unpackedfields, followed by an entity-name: three strings (representing the object,type, and zone fields of the name) packed together. You can call<code>NBPSetNTE</code> to pack the strings into the <code>NamesTableEntry</code>structure. When you remove the name (<code>PRemoveName</code>), you'll use theentity-name by itself; you can use <code>NBPSetEntity</code> to pack it in.</p><P><A HREF="#top">Back to top</A></P><a name="Section3"></a><h2>Zone Interface Protocol</h2><P>A function, <code>GetBridgeAddress</code>, is provided to obtain the node ID of abridge, for use in ZIP transactions (zero is returned if no bridge is presenton your network). You make ZIP calls using ATP requests, as described in the<i>Inside AppleTalk</i> chapter on ZIP.</p><a name="References"></a><h2>References</h2><p>The AppleTalk Manager</p><p><i>Inside AppleTalk</i> (for ZIP information)</p><p><A HREF = "nw_05.html">M.NW.HL.AppleTalk</a></p><p><A HREF = "nw_07.html">M.NW.NoNetEvents</a></p>                                     <P><A HREF="#top">Back to top</A></P>                                    <P><A NAME=Downloads></A></P>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (36K)</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/nw_02.pdf">Download</A></P>               </TD>            </TR>                     </TABLE>         <BR>         <P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/nw/nw_02.html%3Fid%3DDTS10002544-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/nw/nw_02.html%3Fid%3DDTS10002544-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/nw/nw_02.html%3Fid%3DDTS10002544-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>