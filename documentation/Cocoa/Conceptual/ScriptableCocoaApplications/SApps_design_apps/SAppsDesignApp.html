<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Cocoa Scripting Guide: Designing for Scriptability</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Designing for Scriptability"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001978" title="Designing for Scriptability"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../Scripting-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000569" target="_top">Scripting &amp; Automation</a> &gt; <a href="../SApps_intro/SAppsIntro.html#//apple_ref/doc/uid/TP40001982-BCICHGIE">Cocoa Scripting Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../SApps_about_apps/SAppsAboutApps.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../SApps_implement/SAppsImplement.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40001978-BBCBCIJE" title="Designing for Scriptability"></a><h1>Designing for Scriptability</h1><p>This chapter provides high-level checklists for designing a new scriptable Cocoa application and adding scriptability to an existing application.</p><p>Whether you’re designing a Cocoa application from scratch or adding a new feature to an existing application, you go through a standard set of design steps, tailored to your experience, the systems you work with, and the project at hand. The process is no different when you’re designing for scriptability.</p><p>The following steps provide an outline for your design process, but are not intended to be comprehensive. However, links are provided to additional design information in this and other documents.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="SAppsDesignApp.html#//apple_ref/doc/uid/TP40001978-BCIEIHEJ">Designing a New Scriptable Application</a>
				
			<br/>
			
        
			
			
				<a href="SAppsDesignApp.html#//apple_ref/doc/uid/TP40001978-1134635">Adding Scriptability to an Existing Application</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001978-1137578" title="Designing a New Scriptable Application"></a><a name="//apple_ref/doc/uid/TP40001978-BCIEIHEJ" title="Designing a New Scriptable Application"></a><h2>Designing a New Scriptable Application</h2><p><a name="//apple_ref/doc/uid/TP40001978-DontLinkElementID_172"></a>To design a new scriptable Cocoa application, consider using the following steps:</p><ol class="ol"><li class="li"><p>For your overall application design, work with the Model-View-Controller (MVC) design pattern, which is widely followed in Cocoa applications. MVC is described in detail in <em><a href="../../CocoaFundamentals/index.html#//apple_ref/doc/uid/TP40002974" target="_top">Cocoa Fundamentals Guide</a></em>.</p><p>Good scripting support generally calls for scripting the model, rather than the view layer. For more information, see <span class="content_text"><a href="../SApps_implement/SAppsImplement.html#//apple_ref/doc/uid/20000037-1088066">“Concentrate Scriptable Behavior in Model Objects.”</a></span></p><p>Cocoa bindings and Core Data also work with the MVC design pattern. See  <span class="content_text"><a href="../SApps_about_apps/SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-SW13">“Interaction With Cocoa Bindings and Core Data”</a></span> for more information.</p></li><li class="li"><p>Think about scripting very early in your design.</p><p>When you first start defining the requirements for your application, consider the kinds of features you’ll want to make scriptable and how users might script those features to automate operations with your application. This can help provide insight into the overall goals for your application.</p><p>You'll want the terms you specify to look natural in AppleScript's English-like grammar. Scripting terms won't necessarily be an exact match for the terminology you use within your application's code.</p><p>Technical Note TN2106, "<span class="content_text"><a href="http://developer.apple.com/technotes/tn2002/tn2106.html" target="_top">Scripting Interface Guidelines,</a></span>" supplies valuable information on how to provide a clean and consistent scripting interface for your application.</p></li><li class="li"><p>Work out the design for your AppleScript object model—the objects scripters will use in their scripts, and the inheritance and containment relationships between them.</p><p>This includes identifying the scriptable properties of your scriptable classes and providing a set of keys to identify them. (You'll use this information later, in your sdef file, to provide the keys Cocoa scripting uses with key-value coding. However, in many cases, you won't need to specify keys explicitly—Cocoa can determine them automatically by applying its default rules to the property names.)</p><p>For more information, see <span class="content_text"><a href="../SApps_implement/SAppsImplement.html#//apple_ref/doc/uid/20000037-SW1">“Provide Keys for Key-Value Coding.”</a></span></p></li><li class="li"><p>Determine which of the standard AppleScript commands your application will support. Cocoa provides support for most of the standard scripting commands, including <code>close</code>, <code>count</code>, <code>delete</code>, <code>duplicate</code>, <code>exists</code>, <code>get</code>, <code>make</code>, <code>move</code>, <code>open</code>, <code>print</code>, <code>quit</code>, <code>save</code>, and <code>set</code>, but your application has to do some work too.</p><p>Scripters expect your application to support whichever of these commands make sense for it, and to make the commands work in standard ways. By meeting these expectations, you gain two kinds of leverage:</p><ul class="ul"><li class="li"><p>You can take advantage of scripters’ existing knowledge, so that your application’s scriptability is easier for them to understand and use (meaning fewer complaints and support calls).</p></li><li class="li"><p>Supporting a few commands can provide a lot of scriptability—for example, if you provide access through the <code>get</code> and <code>set</code> commands to five properties in each of the two most important classes in your application, that’s 20 scriptable operations—2 commands times 5 properties times 2 classes. In many cases, support for the <code>get</code> and <code>set</code> commands requires relatively little coding effort.</p></li></ul></li><li class="li"><p>To support application-specific operations that can’t be handled by one of the Cocoa scripting command classes, define new script command subclasses for those operations.</p><p>Keep in mind that you can often accomplish a goal with an existing command. For example, rather than define a new <code>rename</code> command, you can use the existing <code>set</code> command to set the <code>name</code> property of an object to the new name.</p><p>For more information, see <span class="content_text"><a href="../SApps_script_cmds/SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-BBCBCIJE">“Script Commands.”</a></span></p></li><li class="li"><p>Create the actual scripting definition file (sdef) for your application.</p><p>This is listed as a design step because it is possible to define an sdef and actually compile scripts against it in a test or skeleton application before you’ve written code to support your scriptability. You can even let scripters in your target audience work with your application's terminology and provide feedback.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001978-SW1" title="Note"></a><p><strong>Note:</strong>&nbsp;To test changes you make to an sdef file, you must quit the application, rebuild, and relaunch it to pick up the changes. In addition, the Script Editor application caches scriptability information, so you may need to quit and relaunch Script Editor as well.</p></div><p>Doing this step early can help immensely in refining your scripting support and ensuring that it is user-friendly for scripters. In addition, your AppleScript dictionary can serve as a useful design document for the entire application.</p><p>Although you can wait to write your scripting terminology until you implement the application, writing it first will help to ensure consistency and usability. And during implementation, you don't need to implement support for your terminology all at once—you can do it incrementally as you become more familiar with the process.</p><p>For information on creating an sdef file, see <span class="content_text"><a href="../SApps_creating_sdef/SAppsCreateSdef.html#//apple_ref/doc/uid/TP40001979-BBCBCIJE">“Preparing a Scripting Definition File.”</a></span></p></li><li class="li"><p>Design the application classes that will support scriptability. Make sure these classes support the scripting object model you have defined, including both inheritance and containment relationships.</p><p>You must name the accessor methods for scriptable properties of these classes to match the keys you defined earlier, as described in <span class="content_text"><a href="../SApps_get_set/SAppsGetSet.html#//apple_ref/doc/uid/TP40002164-CH18-SW4">“Maintain KVC Compliance.”</a></span></p></li><li class="li"><p><a name="//apple_ref/doc/uid/TP40001978-DontLinkElementID_173"></a><a name="//apple_ref/doc/uid/TP40001978-DontLinkElementID_174"></a>Plan for testing.</p><p>Your testing should include creation and regular execution of AppleScript scripts that exercise the application’s functionality. The ability to automate your testing and to more easily perform regression testing is one of the big gains of making your application scriptable.</p><p>Performance represents another important area of testing for most applications. For a general introduction, see <em><a href="../../../../../referencelibrary/GettingStarted/GS_Performance/index.html#//apple_ref/doc/uid/TP30001082" target="_top">Getting Started with Performance</a></em>. For issues specific to scriptable applications, see <span class="content_text"><a href="../SApps_debugging/SAppsDebugging.html#//apple_ref/doc/uid/TP40001981-SW1">“Performance Issues for Scriptability.”</a></span></p><p>And of course, you should also plan for unit testing or other kinds of testing that you customarily use.</p><p>For issues to cover in your test plan, see <span class="content_text"><a href="../SApps_debugging/SAppsDebugging.html#//apple_ref/doc/uid/TP40001981-SW2">“Scriptability Test Plan.”</a></span><a name="//apple_ref/doc/uid/TP40001978-DontLinkElementID_175"></a></p></li></ol><a name="//apple_ref/doc/uid/TP40001978-1134635" title="Adding Scriptability to an Existing Application"></a><h2>Adding Scriptability to an Existing Application</h2><p><a name="//apple_ref/doc/uid/TP40001978-DontLinkElementID_176"></a>To add scriptability to an existing Cocoa application, consider using the following steps. (Some steps are abbreviated, where they repeat those found in <span class="content_text"><a href="SAppsDesignApp.html#//apple_ref/doc/uid/TP40001978-1137578">“Designing a New Scriptable Application.”</a></span>)</p><ol class="ol"><li class="li"><p>If time allows, and especially if there are other reasons to redesign the application, consider a major redesign, following the steps described previously for designing a new scriptable application.</p></li><li class="li"><p>Experiment with creating a scripting definition file for your application.</p><p>As noted previously, you can compile scripts against your terminology before you’ve written any code. That helps you identify the scripting objects and terminology you want to provide for scripters (your AppleScript object model), as well as the underlying application information you need to expose to support that terminology. It also helps determine the scale of the effort to make the application scriptable.</p></li><li class="li"><p>In classes containing information you want to make scriptable, make use of any instance variables or accessor methods that are already key-value coding compliant.</p><p>If not, you can add KVC-compliant accessors to support scriptability. One convenient way to do this is through the use of an <a name="//apple_ref/doc/uid/TP40001978-DontLinkElementID_177"></a>Objective-C category. This approach is most appropriate in the case where you are primarily making existing properties and elements scriptable. It can also be useful when you don't have free access to the existing code.</p></li><li class="li"><p><a name="//apple_ref/doc/uid/TP40001978-DontLinkElementID_178"></a>Consider designing scriptable “helper” classes to implement the object hierarchy you expose to scripters. These classes can maintain references to application objects that contain the actual information scripters will be working with.</p><p>You can define helper classes from scratch, adding properties and relationships as needed to support your AppleScript object model. To access the underlying data, you have to invoke methods in existing classes—this is where you’re likely to find the most complexity in retrofitting an existing application.</p><p>This approach is most appropriate in the case where you need to pull together properties from multiple application classes to represent one AppleScript object model class, or where a category won't work because you need to add new instance variables.</p></li><li class="li"><p>Determine which of the standard AppleScript commands your application will support and plan new script command subclasses for any additional commands that are needed.</p></li><li class="li"><p>Plan for testing, using both AppleScript scripts and other testing options available to you.<a name="//apple_ref/doc/uid/TP40001978-DontLinkElementID_179"></a></p></li></ol>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../SApps_about_apps/SAppsAboutApps.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../SApps_implement/SAppsImplement.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-03-11<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Conceptual/ScriptableCocoaApplications/SApps_design_apps/SAppsDesignApp.html%3Fid%3DTP40002164-2.4&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Conceptual/ScriptableCocoaApplications/SApps_design_apps/SAppsDesignApp.html%3Fid%3DTP40002164-2.4&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Conceptual/ScriptableCocoaApplications/SApps_design_apps/SAppsDesignApp.html%3Fid%3DTP40002164-2.4&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>