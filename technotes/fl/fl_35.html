<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!-- Template 01-August-01 --><!-- Includes revisions to graphics tags --><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note FL35: Determining Which File System Is Active</title><meta name="keywords" content="Mac OS 8 file system active HFS PBHGetVInfo 64K ROM"><meta name="Description" content="Technical Note FL35: This Technical Note discusses how todetermine which file system a particular volume is running.It also details how to determine if a 64k ROM is runningunder HFS."><meta name="categories" content="Files"><meta name="week-posted" content="Nov 25, 1985 - Dec 6, 1985"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002461" title="Determining Which File System Is Active"></a><A NAME="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxCarbon-date.html">Carbon</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/Carbon/idxFileManagement-date.html" target="_blank">Carbon > File Management</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note FL35</div>
<div id="pageheadsub">Determining Which File System Is Active</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext">					<A HREF="#Introduction">Introduction</a><BR><BR> <A HREF="#References">References</A><BR><BR>   <A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id ="introtext">This Technical Note discusses how to determine which file system a particular volume is running.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Dec 01 1985]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR><!-- begin_content --><a name="Introduction"></a><h2>Introduction</h2><P>Under certain circumstances it is necessary to determine which file system is currently running on a particular volume. For example, on a 64K ROM machine, your application (i.e., especially disk recovery utilities or disk editors, etc.) may need to check for MFS versus HFS.  Note that this is usually not necessary, because all ROMs, except the original 64K ROMs, include HFS.  If your application only runs on 128K ROMs or newer, you do not need to check for HFS versus MFS.  You may need to check if a particular volume is in High Sierra, ISO 9660, or audio CD format.</p><p>Before performing these file system checks, be sure to call <code>_SysEnvirons</code>, to make sure the machine on which you are running has ROMs which know about the calls you need.</p><p>To check for HFS on 64K ROM machines, check the low-memory global <code>FSFCBLen</code> (at location<code>$3F6</code>).  This global is one word in length (two bytes) and is equal to -1 if MFS is active and a positive number (currently <code>$5E</code>) if HFS is active.  From Pascal, the following wouldperform the check:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    CONST      FSFCBLen = $3F6;    {address of the low-memory global}    VAR      HFS: ^INTEGER;      ...      HFS:= POINTER(FSFCBLen);      IF HFS^ &gt; 0 THEN          {we're running HFS}      ELSE          {we're running MFS}      END;</pre>	</TD></TR></TABLE></CENTER><p>If an application determines that it is running under HFS, it should not  assume that all mounted volumes are HFS.  To check individual volumes for HFS, call <code>_PBHGetVInfo</code> and check the directory signature (the <code>ioVSigWord</code> field of an <code>HParamBlockRec</code>).  A directory signature of $D2D7 means the volume is an MFS volume, while a directory signature of $4244 means the volume is an HFS volume.</p><p>To find out if a volume uses a file system other than HFS or MFS, call <code>_PBHGetVInfo</code> and check the file system ID (the <code>ioVFSID</code> field of an <code>HParamBlockRec</code>).  A file system ID of $0000 means the volume is either HFS or MFS.  A file system ID of $4242 means the volume is a High Sierra volume, while a file system ID of $4147 is an ISO 9660 volume, and a file system ID of $4A48 is an audio CD volume.  AppleShare and other file systems use a dynamic technique of obtaining the first unused file system ID; therefore, low-numbered IDs cannot be associated with any particular file system.</p><p>When dealing with High Sierra and ISO 9660 formats, do not assume that the volumes are CD-ROM discs.  Support for these file systems is done with the External File System hook in the File Manager, so any block-based media could potentially be in these formats.  It is possible to have a High Sierra formatted floppy disk, although it would be useless except for testing purposes.</p><a name="References"></a><h2>References</h2><p><i>Inside Macintosh</i>, Volume IV, File Manager</p><p>Technical Note M.FL.ISO9660 -- <u><A HREF = "fl_25.html">ISO 9660 &amp; High Sierra CD-ROM Formats</a></u></p><p>Technical Note M.OV.GestaltSysEnvirons -- <u><A HREF = "../ov/ov_16.html">_Gestalt &amp; _SysEnvirons - a Never Ending Story</a></u></p><P><A HREF="#top">Back to top</A></P><P><A NAME=Downloads></A></P>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (48K)</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/fl_35.pdf">Download</A></P>               </TD>            </TR></table><BR><P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/fl/fl_35.html%3Fid%3DDTS10002461-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/fl/fl_35.html%3Fid%3DDTS10002461-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/fl/fl_35.html%3Fid%3DDTS10002461-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --><hr width=500 align=center></BODY></HTML>