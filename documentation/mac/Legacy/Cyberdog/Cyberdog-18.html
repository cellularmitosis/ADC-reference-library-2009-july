<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>A Cyberdog Example(Cyberdog)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING18></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->




<!-- Main Body -->

<CENTER>
<P>
<A HREF="Cyberdog-17.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Cyberdog-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Cyberdog-319.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Cyberdog-19.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Cyberdog-2.html"><B>Cyberdog Programmer's Kit</B></A> / <A HREF="Cyberdog-10.html"><B>Part 1 - Basics</B></A><BR><DD><A HREF="Cyberdog-15.html"><B>Chapter 2 - Development Overview</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING18-0></A>
<H1><A NAME=MARKER-9-96></A>A Cyberdog Example</H1>
 This section describes an example that illustrates how the key Cyberdog objects cooperate at runtime to access and display Internet data. The example includes two Cyberdog display parts:<P>
<UL>
<LI>Gopher display part that displays the contents of a Gopher directory from a Gopher server. The Gopher display part is displayed embedded in the navigator.
<LI>text display part that displays a text item stored on a Gopher server. The text display part is displayed in its own window.<P>
</UL>
<A NAME=HEADING18-4></A>
<H2>Gopher Display Part</H2>
 <A NAME=MARKER-2-97></A>The Cyberdog Gopher display part, shown in <A HREF=#MARKER-9-99>Figure 2-11</A>, displays Gopher directories; it knows how to interpret data coming from a Gopher server and how to display Gopher directories in a meaningful way. In particular, the <A NAME=MARKER-2-98></A>Gopher display part knows that the Gopher directory entries represent links to other data located on the Gopher server and displays those links differently from other content. When the user clicks on a link, the Gopher display part initiates retrieving the content referenced by the link.<P>
<B>Figure 2-11  <A NAME=MARKER-9-99></A>The Gopher display part embedded in the navigator</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/CD_LS-22.jpg"><P>
 In addition to displaying the contents of a Gopher directory, the Gopher display part must be able to<P>
<UL>
<LI>download Gopher directories using a stream
<LI>display status information while downloading
<LI>add its menu items to the menu bar
<LI>interact with the log and the notebook
<LI>embed itself in a navigator<P>
</UL>
 In addition to its Cyberdog-specific features, the Gopher display part retains all the features of an ordinary OpenDoc part. It can display content, be embedded in other parts, store its content, and so on.<P>
 The Gopher display part is embedded in the Cyberdog navigator; both the Gopher display part and the navigator are contained in the Cyberdog session document. The Gopher display part has an extension subclassed from <CODE>CyberPartExtension</CODE>. The extension receives Cyberdog-related messages; the part and its extension cooperate to respond to those messages. <P>
 The Gopher display part displays the content referenced by a <CODE>GopherItem</CODE> object (an object subclassed from class <CODE>CyberItem</CODE>). In addition, the Gopher display part caches a <CODE>GopherItem</CODE> object for each link in the Gopher directory. The Gopher display part is responsible for initiating a response when the user clicks on a link. The runtime object relationships of the Gopher display part are shown in <A HREF=#MARKER-2-49>Figure 2-12</A>. <P>
<B>Figure 2-12  <A NAME=MARKER-2-49></A>Gopher display part object relationships</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/CD_L-06.jpg"><P>
<A NAME=HEADING18-19></A>
<H2>Creating and Opening the Text Display Part</H2>
 When the user clicks on one of the links shown in <A HREF=#MARKER-9-99>Figure 2-11</A>, the Gopher display part calls the corresponding Cyberdog item's <CODE><A NAME=MARKER-2-102></A>Open</CODE> method. The <CODE>Open</CODE> method does two things:<P>
<UL>
<LI>It creates a Cyberdog text display part because the Cyberdog item the user clicked on references text data.
<LI>It calls the text display part's <CODE><A NAME=MARKER-2-103></A>OpenCyberItem</CODE> method to notify the text display part it is being opened by a Cyberdog item.<P>
</UL>
 The Cyberdog text display part is an OpenDoc part whose part editor can display text and has been extended with a <CODE>CyberPartExtension</CODE> subclass. The text display part is created in the Cyberdog session document. The editor for the Cyberdog text display part is shown in <A HREF=#MARKER-9-104>Figure 2-13</A>.<P>
<B>Figure 2-13  <A NAME=MARKER-9-104></A>The text display part</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/CD_S-21.gif"><P>
 Once the text display part has been created, the Cyberdog item's <CODE>Open</CODE> method calls the text display part's <CODE>OpenCyberItem</CODE> method, passing the text display part the <CODE>CyberItem</CODE> object to be opened. The default implementation of <CODE>OpenCyberItem</CODE> does two things:<P>
<UL>
<LI>It calls <CODE>SetCyberItem</CODE> to cache the <CODE>CyberItem</CODE> object in the text display part's extension.
<LI>It calls the text display part's <CODE>Open</CODE> method, which opens the part.<P>
</UL>
 Developers of Cyberdog display parts usually override <CODE>OpenCyberItem</CODE> to receive notification that the part is opening; typically, in addition to the implementation described above, <CODE>OpenCyberItem</CODE> creates a Cyberdog stream, initiates the download operation, and adds the Cyberdog item to the log.<A NAME=MARKER-2-106></A><P>
<A NAME=HEADING18-30></A>
<H2>Downloading Content to the Text Display Part</H2>
 <A NAME=MARKER-2-107></A>Once the text display part has been created, it needs to download the content referenced by its Cyberdog item. The Cyberdog item relies on a Cyberdog stream to download the data for the text display part.<P>
 In its <CODE>OpenCyberItem</CODE> method, the text display part requests a stream object from its Cyberdog item by calling the Cyberdog item's <CODE>CreateCyberStream</CODE> method. The Cyberdog item returns a <CODE>GopherStream</CODE> object (an object subclassed from class <CODE>CyberStream</CODE>), initialized to download the data referenced by the Cyberdog item from the Gopher server. Then, <CODE>OpenCyberItem</CODE> calls the stream's <CODE><A NAME=MARKER-2-109></A>Open</CODE> method to initiate the download operation.<P>
 <A NAME=MARKER-10-110></A><A HREF=#MARKER-9-111>Figure 2-14</A> shows the runtime relationships between the text display part, the Cyberdog item, and the Cyberdog stream.<P>
<B>Figure 2-14  <A NAME=MARKER-9-111></A>Downloading object relationships</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/CD_L-07.jpg"><P>
 <A NAME=MARKER-10-112></A>The <A NAME=MARKER-2-113></A>stream's <CODE>Open</CODE> method signals the stream to start downloading. <CODE>Open</CODE> is an asynchronous method; it returns to the Cyberdog text display part immediately, and the stream proceeds to download at its own pace in separate thread. The stream needs to resolve the address to find the data, establish a connection, and begin downloading the data.<P>
 The text display part calls the stream's <CODE><A NAME=MARKER-2-114></A>GetStreamStatus</CODE> method periodically to monitor the progress of the download operation. <CODE>GetStreamStatus</CODE> returns a set of flags that indicate status and error conditions. In particular, <CODE>GetStreamStatus</CODE> returns the <CODE><A NAME=MARKER-2-115></A>kCDDataAvailable</CODE> flag when the stream has some data downloaded and ready for the text display part to read. If data is available, the text display part calls the stream's <CODE><A NAME=MARKER-2-116></A>GetBuffer</CODE> method to retrieve a buffer of downloaded data. When the text display part is finished using a buffer, it calls <CODE><A NAME=MARKER-2-117></A>ReleaseBuffer</CODE> to release the buffer back to the stream. When <CODE>GetStreamStatus</CODE> returns the <CODE><A NAME=MARKER-2-118></A>kCDDownloadComplete</CODE> flag, the text display part deletes the stream object. <P>
 The stream methods <CODE>GetStreamStatus</CODE>, <CODE>GetBuffer</CODE>, and <CODE>ReleaseBuffer</CODE> are all synchronous methods; they are designed so that a stream object can always respond immediately. The stream knows its status without any lengthy computation, and <CODE>GetBuffer</CODE> and <CODE>ReleaseBuffer</CODE> operate on data the stream has already downloaded<A NAME=MARKER-2-87></A>.<A NAME=MARKER-2-120></A><P>

</BLOCKQUOTE>
<HR>
<center>
<A HREF="Cyberdog-17.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Cyberdog-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Cyberdog-319.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Cyberdog-19.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Cyberdog-3.html">&copy; Apple Computer, Inc.</A><br>13 JUL 1996</center></font><P>
<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->
</BODY>
</HTML>   
