<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!-- Template 03-24-01 --><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note TN1058: QuickDraw GX 'ptyp' Resource: Calculations, Uses &amp; Limitations</title>    <meta name="keywords" content="Mac OS 8 Quickdraw GX pytp default paper type editor">    <meta name="Description" content="Technical Note TN1058: The information in this Technote isstill relevant up to and including Mac OS 7.6 with QuickDrawGX 1.1.5. Apple no longer supports QuickDraw GX. This TechnicalNote This discusses the 'ptyp' resource in detail, showshow to calculate your page and paper rectangles for the resource,        discusses how to set your paper type as the defaultpaper type, gives an overview of the known bugs and theirworkarounds,         gives a brief overview of how to createa paper type with QuickDraw GX's Paper Type Editor and howto alter those        paper types into 'ptyp' resources ."><meta name="categories" content="QuickDraw GX"><meta name="week-posted" content="Jul 1, 1996 - Jul 5, 1996"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002899" title="QuickDraw GX 'ptyp' Resource: Calculations, Uses & Limitations"></a><A NAME="top"></A><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxPrinting-date.html">Printing</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/Printing/index.html" target="_blank">Reference Library > Printing</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TN1058</div>
<div id="pageheadsub">QuickDraw GX 'ptyp' Resource: Calculations, Uses &amp; Limitations</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"> <!-- begin_header_box --> <table width="600" cellpadding="0" cellspacing="0" border="0">	<tr>		<td width=300 valign="top" align=left scope="row">			<table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>				</tr>				<tr bgcolor="#e6e6e6">					<td background="images/tnmenubody.gif" width=300 align=left>						<span id="menutitle">							CONTENTS                             <br>                            <br>						</span>					</td>				</tr>				<tr bgcolor="#e6e6e6">					<td background="images/tnmenubody.gif" width=300 align=left><!-- begin_toc --><p id="menutext"><A HREF = "#RTFToC1">The 'ptyp' Resource Defined</a><br><br><A HREF = "#RTFToC2">Calculating the Page and Paper Rectangle Values</a><br><br><A HREF = "#RTFToC3">Making Your Paper Type the Default Type</a><br><br><A HREF = "#RTFToC4">Making Sure Your New Paper Type Appears in the Print Dialog</a><br><br><A HREF = "#RTFToC5">The Paper Type Editor</a><br><br><A HREF = "#Summary">Summary</a><br><br><A HREF="#References">References</A><BR><BR><A HREF="#Downloads">Downloadables</A></p>			<!-- end_toc --> 								</td>				</tr>				<tr>					<td width=300 align=left scope="row">						<img src="images/tnmenubottom.gif" alt="" width=300 height=16>					</td>				</tr>			</table>		</td>		<td width=300 valign="top" align=left>			<!-- begin_intro_text --><P id = "introtext">For some time now, Apple developers have been confused by the 'ptyp' (papertype) resource in QuickDraw GX. This is a result of sparse documentation andproblems with QuickDraw GX's use of this resource. This Technote:</p><ul><li>discusses the <code>'ptyp'</code> resource in detail</li><li>shows how to calculate your page and paper rectangles for the resource</li><li>discusses how to set your paper type as the default paper type </li><li>gives an overview of the known bugs and their workarounds</li><li>gives a brief overview of how to create a paper type with QuickDraw GX'sPaper Type Editor and how to alter those paper types into <code>'ptyp'</code> resources.</li></ul><P id = "introtext">This Note is primarily intended for QuickDraw GX printer driver developers whowish to use the 'ptyp' resource in their printer drivers.</p><TABLE BORDER="0"><TR>    <td bgcolor="#EEEEEE" align=left>        <P id = "introtext"><B>Important for all Apple Printing and Graphics Developers: </B></p><P id = "introtext">        The information in this Technote is still relevant up to and including        <A HREF = "tn1090.html">Mac OS 7.6</A>        with QuickDraw GX 1.1.5. Beginning with the release of Mac OS 8.0,        however, Apple plans to deliver a system which incorporates QuickDraw GX        graphics and typography <B>only</B>. QuickDraw GX printer drivers and GX printing        extensions will <B>not</B> be supported in Mac OS 8.0 or in future Mac OS releases. Apple's        goal is to simplify the user experience of printing by unifying the Macintosh        graphic and printing architectures and standardizing on the classic Printing        Manager. </P>            </TD></TR></TABLE><!-- end_intro_text --><!-- begin_date --><h3>&nbsp;Updated: [July 1 1996]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_header_box --> <BR><BR><hr width=500 align=center>          <BR><BR> <!-- begin_content --><a name = "RTFToC1"></A><H2>The 'ptyp' Resource Defined</H2><P>Table 3-9 on page 3-54 of <i>Inside Macintosh: QuickDraw GX Printing Extensionsand Drivers</i> summarizes all of the possible resources that you can use inyour QuickDraw GX printer driver. The <code>'ptyp'</code> resource is mentioned in thistable, but not discussed or documented further in the <i>Inside Macintosh: QuickDraw GX</i> series. GX printer driver developers need to understand thedefinition of this resource in order to create customized paper types for theirdrivers.</p><P>The following section introduces you to the internal  structure of the <code>'ptyp'</code>resource.</p><p><b>Definition</b></p><p>The paper type resource, of type <code>gxPaperTypeType</code>, provides you with a mechanismto create paper types that are customized for their QuickDraw GX printerdriver. This resource is optional.</p><P>The structure of paper type resource is: </p><TABLE ALIGN=CENTER BORDER=0 cellspacing=1 CELLPADDING=4 width=460><TR><td width=250 valign=top align=left><B>'ptyp'</B></td><td width=250 valign=top align=left><B>Type</B></td></tr><TR><td width=250 valign=top align=left>Paper Type Name</td><td width=250 valign=top align=left>pstring</td></tr><TR><td width=250 valign=top align=left>Page Rectangle</td><td width=250 valign=top align=left>gxRectangle</td></tr><TR><td width=250 valign=top align=left>Paper Rectangle</td><td width=250 valign=top align=left>gxRectangle</td></tr><TR><td width=250 valign=top align=left>Base Paper</td><td width=250 valign=top align=left>longint</td></tr><TR><td width=250 valign=top align=left>Creator Type</td><td width=250 valign=top align=left>literal longint</td></tr><TR><td width=250 valign=top align=left>Unit of Measure</td><td width=250 valign=top align=left>byte</td></tr><TR><td width=250 valign=top align=left>PaperType Style    flags</td><td width=250 valign=top align=left>unsigned bitstring</td></tr><TR><td width=250 valign=top align=left>Default flags</td><td width=250 valign=top align=left>unsigned bitstring</td></tr><TR><td width=250 valign=top align=left>Reserved flags</td><td width=250 valign=top align=left>unsigned bitstring</td></tr><TR><td width=250 valign=top align=left>Embedded Collection</td><td width=250 valign=top align=left>longint</td></tr><TR><td width=500 valign=top align=left><b>array- Collection Items</b></td></tr><TR><td width=250 valign=top align=left>- Collection tag</td><td width=250 valign=top align=left>longint</td></tr><TR><td width=250 valign=top align=left>- Collection id</td><td width=250 valign=top align=left>longint</td></tr><TR><td width=250 valign=top align=left>- Collection attribute bits- lock</td><td width=250 valign=top align=left>Boolean</td></tr><TR><td width=250 valign=top align=left>- Collection attribute bits- persistent</td><td width=250 valign=top align=left>Boolean</td></tr><TR><td width=250 valign=top align=left>- Reserved attribute bits</td><td width=250 valign=top align=left>unsigned bitstring</td></tr><TR><td width=250 valign=top align=left>- User attribute bits</td><td width=250 valign=top align=left>unsigned bitstring</td></tr><TR><td width=250 valign=top align=left>- Data</td><td width=250 valign=top align=left>wstring</td></tr></TABLE><p>The paper type resource consists of entries, flags and one or more collectionitems:</p><ul><li>Paper Type Name:  The name to display in the paper type list presented to theuser in the page set-up dialog.</li><li>Page Rectangle: The page rectangle measurements of the paper type.</li><li>Paper Rectangle: The paper rectangle measurements of the paper type.</li><li>Base Paper: The base paper type from which this new paper type is derived.</li></ul><TABLE ALIGN=CENTER BORDER=0 cellspacing=1 CELLPADDING=4 width=260><TR><td width=480 valign=top align=left><B>Constant</B></td><td width=120 valign=top align=left><CENTER><B>Value</B></center></td></tr><TR><td width=480 valign=top align=left>unknownBase</td><td width=120 valign=top align=left>0<CENTER></center></td></tr><TR><td width=480 valign=top align=left>usLetterBase</td><td width=120 valign=top align=left>1<CENTER></center></td></tr><TR><td width=480 valign=top align=left>usLegalBase</td><td width=120 valign=top align=left>2<CENTER></center></td></tr><TR><td width=480 valign=top align=left>a4LetterBase</td><td width=120 valign=top align=left>3<CENTER></center></td></tr><TR><td width=480 valign=top align=left>b5LetterBase</td><td width=120 valign=top align=left>4<CENTER></center></td></tr><TR><td width=480 valign=top align=left>tabloidBase</td><td width=120 valign=top align=left>5<CENTER></center></td></tr></table><Ul><li>Creator Type: The creator of the paper type.</li><li>Unit of Measure: Unit of measure the paper is in.</li></ul><TABLE ALIGN=CENTER BORDER=0 cellspacing=1 CELLPADDING=4 width=260><TR><td width=480 valign=top align=left><B>Constant</B></td><td width=120 valign=top align=left><CENTER><B>Value</B></center></td></tr><TR><td width=480 valign=top align=left>pica</td><td width=120 valign=top align=left>0<CENTER></center></td></tr><TR><td width=480 valign=top align=left>mm</td><td width=120 valign=top align=left>1<CENTER></center></td></tr><TR><td width=480 valign=top align=left>inch</td><td width=120 valign=top align=left>2<CENTER></center></td></tr></table><UL><li>PaperType Style flags: Notates whether this paper type is for old, new orboth old and new print dialogs.</li></ul><TABLE ALIGN=CENTER BORDER=0 cellspacing=1 CELLPADDING=4 width=260><TR><td width=480 valign=top align=left><B>Constant</B></td><td width=120 valign=top align=left><CENTER><B>Value</B></center></td></tr><TR><td width=480 valign=top align=left>newStylePaperType</td><td width=120 valign=top align=left>1<CENTER></center></td></tr><TR><td width=480 valign=top align=left>oldStylePaperType</td><td width=120 valign=top align=left>2<CENTER></center></td></tr><TR><td width=480 valign=top align=left>oldAndNewStylePaperType</td><td width=120 valign=top align=left>3<CENTER></center></td></tr></table>The Collection Item entries tell QuickDraw GX about the paper type's collectioninformation and include the following fields: <DL>    <DT><B>- Collection tag: </B></dt>        <DD><P>A collection tag is a four-character identifier that, in conjunction with the collection ID, uniquely identifies the collection item.</p></dd>    <DT><B>- Collection ID: </B></dt>        <DD><P> A collection ID is a long value that, in conjunction with thecollection tag, uniquely identifies the collection item.</p></dd>        <DT><B>- Collection attribute bits- lock: </B></dt>        <DD><P>locks the item down to avoid replacement.</p></dd>        <DT><B>- Collection attribute bits- persistent: </B></dt>        <DD><P>identifies whether or not to flattenthis item when flattening the collection.</p></dd>        <DT><B>- Reserved attribute bits: </B></dt>        <DD><P>bits that are reserved internally.</p></dd>    <DT><B>- User attribute bits: </B></dt>        <DD><P>bits you can define for purposes suitable to yourneeds.</p></dd>        <DT><B>- Data: </B></dt>        <DD><P>contains the actual data of the collection item.</p></dd></DL><P>For more information on collection items, see Chapter 5 of <i>Inside Macintosh: QuickDraw GX Environment and Utilities</i>.</p><P>The  structure of the <code>'ptyp'</code> resource can be seen in GXPrintingResTypes.r onthe Developer CD Series: Mac OS SDK Edition.</p><P><A HREF="#top">Back to top</A></P><a name = "RTFToC2"></A><H2>Calculating the Page and Paper Rectangle Values</H2><P>Developers often ask how to calculate the hexadecimal values from their pagesize. For instance, if you have US Letter paper with a page rectangle thatmeasures 8.10667 inches by 10.7867 inches, what hexadecimal values do you placein the page rectangle area of the <code>'ptyp'</code> resource? To calculate the correctvalue for the horizontal measurement, simply follow these steps: </p><ol><li>Convert inches to pixels. Multiply 8.10667  by 72 (for 72 dpi). The resultis  583.68005 pixels.</li><li>Convert the pixel value to hexadecimal to get <code>0x0247AE18</code>.<br>For the vertical value, repeat steps 1 and 2, multiplying 10.7867 inchesinstead of 8.10667.</li></ol><P>The same calculation steps also are valid for calculations of the paper sizearea in the <code>'ptyp'</code> resource.</p><p>Once you are finished with the calculations, the top portion of your <code>'ptyp'</code>resource will look like the following: </p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>resource gxPaperTypeType (gxPrintingDriverBaseID+1, &quot;US Letter&quot;,kResAttributes){&quot;US Letter&quot;,/*page rectangle*/0x00000000,     /*0.0*/0x00000000,     /*0.0*/0x0247AE18,     /*8.10667*/0x0308A3DC,     /*10.7867*//*paper rectangle*/0xFFF1D70C,     /*-0.196666*/0xFFF870A8,     /*-0.104999*/0x0247AE18,     /*8.30333*/0x0308A3DC,     /*10.895*/usLetterType,kCreatorType,inch,etc.}</pre>	</TD></TR></TABLE></CENTER><P><A HREF="#top">Back to top</A></P><a name = "RTFToC3"></A><H2>Making Your Paper Type the Default Type</H2><p>This section introduces you to a flag to make your new paper type the defaultin your printer driver. It also discusses some known bugs in QuickDraw GX andtheir workarounds.</p><H3>The Flag</H3><P>In order to set your paper type as the default, you need to set theisDefaultPaperType flag in your <code>'ptyp'</code> resource. Setting this flag letsQuickDraw GX "know" that this is the paper type your driver should default to.</p><p>If QuickDraw GX encounters more than one paper type in your driver with the<code>isDefaultPaperType</code> flag set, QuickDraw GX will either fail or choose the firstpaper type it "sees." In either case, it is not a good idea to have more thanone paper type in your resource fork with the <code>isDefaultPaperType</code> flag set.</p><H3>A Known bug</H3>                      <p>There is a known bug in QuickDraw GX related to default paper types andpaper matching. For instance, if you set a default paper type of 'A4 portrait'in your driver, it often does not turn out to be the default paper type in yourprint dialog. The reason is that QuickDraw GX internally adds the standardpapertypes (e.g., A4, US Letter, etc,)  to your driver. During paper matchingQuickDraw GX "thinks" it is finding a better fit for the current pagedimensions than the assigned 'A4 portrait' papertype. It will  then default toQuickDraw GX's internal A4 papertype instead.</p><H3>Several Workarounds</H3><P>There are a few workarounds to this bug, depending on the behavior youare seeing.</p><p><B>Workaround #1: </B> </p><p>If you are defaulting to a non-standard papertype, such as Letterhead,Stationery or Three-hole Punch, the best workaround is to remove that papertypefrom the Extensions folder.</p><p><B>Workaround #2: </B> </p><p>If you are defaulting to another standard papertype, the easiest thing you cando is to open your driver with ResEdit and either remove or edit the <code>'ptyp'</code>resource for the incorrectly matched papertype.</p><P>Currently, these are the only known workarounds. Neither may be veryuser-friendly, but in both cases, they ought to force the driver to default tothe correct papertype.</p><P><A HREF="#top">Back to top</A></P><a name = "RTFToC4"></A><H2>Making Sure Your New Paper Type Appears in the Print Dialog</H2><p>Many GX developers want their paper types to appear in the print dialogs. Inorder for this to happen for both old and new print dialogs, two conditionsmust be met: First, the <code>'ptyp'</code> resource must be present in the resource fork ofthe driver, as opposed to a paper type file in the System Extensions folder.Second, the <code>'ptyp'</code> must have the <code>oldAndNewStylePaperType</code> flag set. If you wantto limit the paper types to just old or new print dialogs, you can set eitherthe <code>oldStylePaperType</code> or the <code>newStylePaperType</code> flags.</p><P><A HREF="#top">Back to top</A></P><a name = "RTFToC5"></A><H2>The Paper Type Editor</H2><P>QuickDraw GX ships with the Paper Type Editor utility. You can install thisutility from the GX utilities section when you install QuickDraw GX on yourMacintosh. The Paper Type Editor allows you to create your own custom papertypes, which are then placed in the Extensions folder.</p><p>Developers are usually interested in how they can use the Paper Type Editor tocreate paper type resources to ship with their QuickDraw GX printer drivers. Inorder to convert the paper type that the Paper Type Editor creates into a<code>'ptyp'</code> resource, you need to DeRez the paper type, set the<code>oldAndNewStylePaperType</code> flag (and the <code>isDefaultPaperType</code> flag if necessary),Rez it back and copy it into your printer driver's resource fork. Afterrestarting, the paper types should correctly appear in your QuickDraw GXprinter driver.</p><P><A HREF="#top">Back to top</A></P><a name = "RTFToC6"></a><H2>Summary</H2><p>The <code>'ptyp'</code> resource can very useful to QuickDraw GX printer driver developersbecause it allows you to create custom paper types. The <code>'ptyp'</code> resource is notadequately documented in the <i>Inside Macintosh: QuickDraw GX</i> suite ofbooks. Despite some known bugs with the QuickDraw GX's use of the resource,there are several good workarounds to allow you to continue with your GXdevelopment.</p><P><A HREF="#top">Back to top</A></P><A NAME="References"></a><H2>References</h2><p><i>Inside Macintosh: QuickDraw GX Printing Extensions and Drivers.</i></p><p><i>Inside Macintosh: QuickDraw GX Printing.</i></p><p><i>Inside Macintosh: QuickDraw GX  Environment and Utilities.</i></p><p><i>Macintosh Technical Note 1028.</i></p><p><i>Developer CD Series: Mac OS SDK Edition: Development Kits(Disc I): Interfaces and Libraries: Interfaces: RIncludes: GXPrintingResTypes.r.</i></p><P><A HREF="#top">Back to top</A></P>         <P><A NAME=Downloads></A></P>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="500">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (64K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/tn1058.pdf">Download</A></P>               </TD>            </TR></TABLE><P><A HREF="#top">Back to top</A></P></TD></TR></table></center><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tn/tn1058.html%3Fid%3DDTS10002899-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tn/tn1058.html%3Fid%3DDTS10002899-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tn/tn1058.html%3Fid%3DDTS10002899-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>