<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>

	<!-- BEGIN META TAG INFO -->
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<link rel="home" href="http://developer.apple.com/">
	<link rel="find" href="http://developer.apple.com/search/">
	<link rel="stylesheet" type="text/css" href="../../documentation/css/adcstyle.css" title="fonts">
	<script language="JavaScript" src="../../documentation/js/adc.js" type="text/javascript"></script>
	<!-- END META TAG INFO -->
	
	<!-- BEGIN TITLE -->
	<title>ProcDoggie - /ProcDoggie.p</title>
	<!-- END TITLE -->
<script language="JavaScript">
function JumpToNewPage() {
	window.location=document.scpopupmenu.gotop.value;
	return true;
}
</script>

</head>

<!-- BEGIN BODY OPEN -->
<body>
<!--END BODY OPEN -->

<!-- START CENTER OPEN -->
<center>
<!-- END CENTER OPEN -->

	<!-- BEGIN LOGO AND SEARCH -->
	<!--#include virtual="/includes/adcnavbar"-->
	<!-- END LOGO AND SEARCH -->
		
		
	<!-- START BREADCRUMB -->
	<div id="breadcrumb">
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td scope="row"><img width="340" height="10" src="images/1dot.gif" alt=""></td>
			<td><img width="340" height="10" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr valign="middle">
			<td align="left" colspan="2">
			<a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../samplecode/index.html">Sample Code</a> &gt; <a href="../../samplecode/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../samplecode/LegacyTechnologies/idxCarbon-date.html">Carbon</a> &gt; <A HREF="javascript:location.replace('index.html');">ProcDoggie</A> &gt; 
			</td>
		</tr>
		<tr>
			<td colspan="2" scope="row"><img width="680" height="35" src="images/1dot.gif" alt=""></td>
		</tr>
	</table>
	</div>
	<!-- END BREADCRUMB -->

	<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/Carbon/idxProcessManagement-date.html" target="_blank">Carbon > Process Management</a></li>
	</ul>
</div>




</div></div></div>

	<!-- START MAIN CONTENT -->
	
	<!-- START TITLE GRAPHIC AND INTRO-->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td><h1><div id="pagehead">ProcDoggie</div></h1></td>
		</tr>
	</table>
	<!-- END TITLE GRAPHIC AND INTRO -->
	<!-- START WIDE COLUMN -->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td id="scdetails">
				<h2>/ProcDoggie.p</h2>
				<form name="scpopupmenu" onSubmit="return false;" method=post>
				<p><strong>View Source Code:</strong> 
					<select name="gotop" onChange="JumpToNewPage();" style="width:340px"><option selected value="ingnore">Select File</option>
<option value="listing1.html">/ProcDoggie.p</option>
<option value="listing2.html">/StubLDEF/StubLDEF.p</option>
<option value="listing3.html">/UDialogUtils.p</option>
<option value="listing4.html">/UEmergMem.p</option>
<option value="listing5.html">/UEvents.p</option>
<option value="listing6.html">/UGlobals.p</option>
<option value="listing7.html">/UMenuHandler.p</option>
<option value="listing8.html">/UProcessGuts.p</option>
<option value="listing9.html">/UProcessLDEF.p</option>
<option value="listing10.html">/UProcessUtils.p</option></select>
				</p>
				</form>
				<p><strong><a href="ProcDoggie.zip">Download Sample</a></strong> (&#147;ProcDoggie.zip&#148;, 94.4K)<BR>
<strong><a href="ProcDoggie.dmg">Download Sample</a></strong> (&#147;ProcDoggie.dmg&#148;, 163.0K)</p>
				<!--
				<p><strong><a href="#">Download Sample</a></strong> (&#147;filename.sit&#148;, 500K)</p>
				-->
			</td>
		</tr>
		<tr>
			<td scope="row"><img width="680" height="10" src="images/1dot.gif" alt=""><br>
			<img height="1" width="680" src="images/1dot_919699.gif" alt=""><br>
			<img width="680" height="20" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr>
			<td scope="row">
	<!--googleon: index -->
<pre class="sourcecodebox">{  File:    ProcDoggie.p  Contains:  Main program file for the ProcDoggie application.  Written by: Forrest Tanaka    Copyright:  Copyright &copy; 1988-1999 by Apple Computer, Inc., All Rights Reserved.        You may incorporate this Apple sample source code into your program(s) without        restriction. This Apple sample source code has been provided &quot;AS IS&quot; and the        responsibility for its operation is yours. You are not permitted to redistribute        this Apple sample source code as &quot;Apple sample source code&quot; after having made        changes. If you're going to re-distribute the source, we require that you make        it clear in the source that the code was descended from Apple sample source        code, but that you've made changes.  Change History (most recent first):        7/27/1999  Karl Groethe  Updated for Metrowerks Codewarror Pro 2.1        }PROGRAM ProcDoggie;{[j=20/57/1$] Pasmat Options}  (******************************************************************************** Used Units*******************************************************************************)  USES    AppleEvents    ,Fonts    ,ToolUtils    ,DiskInit    ,SegLoad    ,GestaltEqu        (* Application *)    ,UGlobals    ,UEmergMem    ,UProcessUtils    ,UMenuHandler    ,UProcessGuts    ,UEvents    ;(******************************************************************************** Constants*******************************************************************************)  CONST    kBecomingActive = TRUE; {Pass to DoActivateEvt; indicates becoming active}(******************************************************************************** Global Variables*******************************************************************************)  VAR    gProcessListWind: WindowPtr; {Pointer to the process list window}{$S Main}(******************************************************************************** DoneRequiredParams - Done processing required params; OK?** DoneRequiredParams checks to see if the AppleEvent specified by the* anAppleEvent parameter has any required parameters that we haven't yet* processed.  If there aren't any left, then noErr is returned.  If there are* required parameters that haven't been processed yet, then errAEEventNotHandled* is returned.  If any other errors occur, then that error code is returned.*******************************************************************************)  FUNCTION DoneRequiredParams (anAppleEvent: AppleEvent): OSErr;    VAR      typeCode:   DescType; {Type of AppleEvent attribute found; ignored}      actualSize: Size;     {Actual size of parameters; ignored}      error:      OSErr;  BEGIN    (* Are there any required parameters in AppleEvent we didn't process? *)       error := AEGetAttributePtr (anAppleEvent, keyMissedKeywordAttr,          typeWildCard, (*&lt;*)typeCode, NIL, 0, (*&lt;*)actualSize);      IF error = errAEDescNotFound THEN        (* No required parameters left, so no error *)        DoneRequiredParams := noErr      ELSE IF error = noErr THEN        (* There was at least one required parameter we didn't process *)        DoneRequiredParams := errAEEventNotHandled      ELSE        (* Some other error happened *)        DoneRequiredParams := error  END;{$S Main}(******************************************************************************** HandleAEquit - Handler for 'quit' AppleEvent** This is the AppleEvent handler for the 'quit' AppleEvent as passed in the* quitAppleEvent parameter by the AppleEvent Manager.  The DoQuit routine is* called which causes this application to quit at the start of the next* iteration of the main event loop.** Though the quit AppleEvent doesn't contain any parameters, the standard thing* to do in reaction to any AppleEvent is to check to see if there are any* required parameters in the AppleEvent that this routine doesn't recognise.* DoneRequiredParms checks for this condition and returns an error if there are* in fact required parameters in the AppleEvent or if some other error occurs* during the check.*******************************************************************************)  FUNCTION HandleAEquit (VAR quitAppleEvent: AppleEvent;                         VAR reply:          AppleEvent;                         handlerRefCon:  LongInt): OSErr;    VAR      error: OSErr;    PROCEDURE RecoverError (errorCode: OSErr);    BEGIN      HandleAEquit := errorCode;      EXIT (HandleAEquit)    END;  BEGIN    {$unused reply}    {$unused handlerRefCon}    (* quit AE has no parms, but check in case the client requires any *)    error := DoneRequiredParams (quitAppleEvent);    IF error &lt;&gt; noErr THEN      RecoverError (error);    (* Handle the Quit command *)    error := DoQuit;    IF error &lt;&gt; noErr THEN      RecoverError(error);    HandleAEquit := noErr  END;{$S Startup}(******************************************************************************** StartUp - Do whatever has to be done to initialize the application** This routine is called after the heap is initialized to initialize the* application.  This involves initializing the toolbox, emergency memory, and* loading up the menus.  If any errors occur while doing this, StartUp displays* an alert telling the user what the error was and then ExitToShell is called.* This is an unusual way to react to errors, and I only do it here because it's* so early in execution that there really isn't much else that can be done.** See this UEmergMem unit in this application for details about emergency* memory.*******************************************************************************)  PROCEDURE StartUp;    CONST      kSysHandler = TRUE; {Specifies that AE handler is in system heap}    VAR      error: OSErr;    PROCEDURE HandleError (messageClass: Integer;                           messageIndex: Integer);      VAR        junkError : OSErr;        junkItemHit: Integer; {Result of alert; ignored}    BEGIN      junkError := ShowStopAlert (messageClass, messageIndex, junkItemHit);      ExitToShell    END;        VAR      gestaltResponse: LongInt;  BEGIN    (* Initialize the toolbox *)    InitGraf (@qd.thePort);    InitFonts;    InitWindows;    InitMenus;    TEInit;    InitDialogs (NIL);        (* Check environment. *)    IF (Gestalt(gestaltSystemVersion, gestaltResponse) &lt;&gt; noErr) | ( gestaltResponse &lt; $0700) THEN      HandleError(rMiscErrMessages, kMiscSystemTooSmall);    (* We make the assumption that if we have System 7 then we have a bunch of other      System 7 features that we rely on, namely:            o new Standard File calls      o AppleEvents      o Process Manager          While this is counter to the philosophy of Gestalt, it sure makes the code smaller.      It's also a sensible approach for &quot;big bang&quot; system releases like System 7.      Besides, ProcDoggie can do nothing useful without the Process Manager (which      was introduced with System 7), so there's no point in us 'limping along',      using old style Standard File calls and so on, when we can't display a      process list.    *)        (* Initialise some boring parts of our application.  Basically this involves      making some UPPs.    *)    InitGlobals;    InitProcessGuts;    (* Initialize emergency memory *)    InitEmergMem;    IF FailLowMemory (0) THEN      HandleError (rMemErrMessages, kMemErrAppOpenMsg);    (* Load the menus and draw the menu bar *)    StartMenus;    IF FailLowMemory (0) THEN      HandleError (rMemErrMessages, kMemErrAppOpenMsg)    ELSE IF gError &lt;&gt; noErr THEN      IF gError = memFullErr THEN        HandleError (rMemErrMessages, kMemErrAppOpenMsg)      ELSE IF gError = resNotFound THEN        HandleError (rResErrMessages, kResErrAppDamageMsg)      ELSE        HandleError (rMiscErrMessages, kMiscErrUnknownMsg);    (* Install the AppleEvent handler *)    error := AEInstallEventHandler (kCoreEventClass, kAEQuitApplication,        NewAEEventHandlerProc(@HandleAEquit), 0, NOT kSysHandler);    IF (error = memFullErr) | FailLowMemory (0) THEN      HandleError (rMemErrMessages, kMemErrAppOpenMsg)    ELSE IF error &lt;&gt; noErr THEN      HandleError (rMiscErrMessages, kMiscErrUnknownMsg)  END;{$S Main}(******************************************************************************** EventLoop - Main event loop for this application** This is the main event loop of this application.  During every iteration of* the event loop, the menus are kept up-to-date, and the Process List window and* all of the open Process Information windows are given time to update* themselves to current conditions.  Also, NoEmergMem is called to detect* whether the emergency memory was used.  If it was, then RecoverEmergMem is* called in an attept to get it back.  If it can't, then some commands could be* disabled until the memory can be recovered.*******************************************************************************)  PROCEDURE EventLoop;    VAR      anEvent: EventRecord; {An incoming event}  BEGIN    FixMenus;    InitCursor;    gQuitting := FALSE;    (* We loop &quot;forever,&quot; or until the Quit handler calls ExitToShell *)    WHILE NOT gQuitting DO      BEGIN        (* Give all open windows some time *)        IdleAllProcessWindows;        (* Try to reallocate emergency memory if it's been used *)        IF NoEmergMem THEN          RecoverEmergMem;        (* Fix the menus to reflect current conditions *)        FixMenus;        (* It's time to get and examine an event *)        IF WaitNextEvent (everyEvent, (*&lt;*)anEvent, kMaxSleepTime, NIL) THEN          BEGIN            DoEvent(anEvent);          END      END  END;BEGIN  (* Set up the heap *)  MaxApplZone;  MoreMasters;  MoreMasters;  MoreMasters;  MoreMasters;  MoreMasters;  MoreMasters;  (* Do anything that must be done at program start-up *)  StartUp;  {$ifc not GENERATINGCFM}    UnloadSeg (@StartUp);  {$endc}  (* Set the default launch mode *)  SetLaunchMode (kJustLaunch);  (* Open the process list window *)  gProcessListWind := CreateProcessListWindow;  (* Enter the main event loop *)  EventLoopEND.</pre>
	<!--googleoff: index -->
			</td>
		</tr>
	</table>
	<!-- END WIDE COLUMN -->

	<!-- END MAIN CONTENT -->
		<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/samplecode/ProcDoggie/listing1.html%3Fid%3DDTS10000315-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/samplecode/ProcDoggie/listing1.html%3Fid%3DDTS10000315-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/samplecode/ProcDoggie/listing1.html%3Fid%3DDTS10000315-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

	<!-- START BOTTOM APPLE NAVIGATION -->
	<!--#include virtual="/includes/footer"-->
	<!-- END BOTTOM APPLE NAVIGATION -->

<!-- START CENTER CLOSE -->
</center>
<!-- END CENTER CLOSE -->

</body>
</html>