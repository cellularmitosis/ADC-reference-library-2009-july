<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>CloseEdition(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING75></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-74.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-76.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-23.html"><B>Chapter 2 - Edition Manager</B></A> / <A HREF="IAC-48.html"><B>Edition Manager Reference</B></A><BR><DL><DD><A HREF="IAC-52.html"><B>Edition Manager Routines</B></A> / <A HREF="IAC-74.html"><B>Closing an Edition After Reading or Writing</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING75-0></A>
<H3>CloseEdition</H3>
 Use the <CODE>CloseEdition</CODE> function to close an edition after you finish reading from or writing to it.<P>
<PRE>
FUNCTION CloseEdition (whichEdition: EditionRefNum; 
                       successful: Boolean): OSErr;
</PRE>
<DL>
<DT><CODE>whichEdition</CODE>
<DD> The reference number for the edition. 
<DT><CODE>successful</CODE>
<DD> A value that indicates whether your application was successful (<CODE>TRUE</CODE>) or unsuccessful (<CODE>FALSE</CODE>) in reading from or writing data to the edition.
</DL>
<A NAME=HEADING75-5></A>
<H5>DESCRIPTION</H5>
 When a subscriber successfully finishes reading data from the edition, the <CODE>CloseEdition</CODE> function takes the modification date of the edition file that you have read and puts it in the <CODE>mdDate</CODE> field of the subscriber's section record. This indicates that the data contained in the edition and the subscriber section within the document are the same.<P>
 When a subscriber is unsuccessful in reading data from an edition (because there is not enough memory, or you didn't find a format that you can read), set the <CODE>successful</CODE> parameter to <CODE>FALSE</CODE>. The <CODE>CloseEdition</CODE> function then closes the edition, but does not set the <CODE>mdDate</CODE> field. This implies that the subscriber is not updated with the latest edition.<P>
 When a publisher successfully finishes writing data to an edition, the <CODE>CloseEdition</CODE> function makes the data that the publisher has written to the edition available to any subscribers and sets the corresponding edition file's modification date (<CODE>ioFlMdDat</CODE>) to the <CODE>mdDate</CODE> field of the publisher's section record. The Edition Manager then sends a Section Read event to all current subscribers set to automatic update mode. At this point, the file type of the edition file is set based on the first known format that the publisher wrote.<P>
 When a publisher is unsuccessful in writing data to an edition, the <CODE>CloseEdition</CODE> function discards what the publisher has written to the edition. The data contained in the edition prior to writing remains unchanged, and Section Read events are not sent to subscribers. <A NAME=MARKER-2-60></A><P>
<A NAME=HEADING75-10></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>ioErr<TD>-36<TD>I/O error<TR>
<TD>fnOpnErr<TD>-38<TD>File not open<TR>
<TD>rfNumErr<TD>-51<TD>Bad edition reference number<TR>
<TD>editionMgrInitErr<TD>-450<TD>Manager not initialized</TABLE>
</H5>
<A NAME=HEADING75-11></A>
<H5>SEE ALSO</H5>
 For an example of the use of <CODE>CloseEdition</CODE>, see <A HREF=IAC-32.html#MARKER-9-186>Listing 2-5</A> beginning on <BR><A HREF=IAC-32.html#MARKER-9-186>page 2-36</A>. <P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-74.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-76.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
