<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note PT565: MPW Pascal Q&amp;As</title>                                       <meta name="categories" content="Platforms and Tools"><meta name="week-posted" content="Oct 1, 1990 - Oct 5, 1990"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002706" title="MPW Pascal Q&As"></a><a name="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxTools-date.html">Tools</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/DeveloperTools/idxCompilersDebuggers-date.html" target="_blank">Tools > Compiling & Debugging</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note PT565</div>
<div id="pageheadsub">MPW Pascal Q&amp;As</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext"><A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><p id="introtext">This Technical Note contains a collection of archived Q&amp;As relating to a specifictopic - questions sent the Developer Support Center (DSC) along withanswers from the DSC engineers. Current Q&amp;A's can be found on the <A HREF = "../../qa/index.html">Macintosh Technical Q&amp;A's web site</a>.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Oct 01 1990]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><a name=Section1></A><h2>Introduction</h2>            <h2>MPW Pascal converts SINGLE numbers to extended</h2><P>Date Written:  1/22/91</p><P>Last reviewed:  6/14/93</p><p>Why does MPW Pascal convert SINGLE numbers to extended, create a temporary areafor them, and then pass a pointer to those extended numbers on the stack?</p><P> The conversion of single-precision values to extended is being done tomaintain accuracy. It's entirely possible to generate values of extendedprecision while doing the intermediate math with single-precision values, andthe MPW compilers do this conversion to preserve accuracy.</p><p>If your application doesn't need the accuracy, you can declare the parametersto be of type <code>LONGINT</code>, and typecast them as necessary within your procedure orfunction. There's no way to tell the MPW compilers not to do the conversion ifthe parameters are declared as SINGLE.</p><h2>MPW 3.2 Paslib.o library and standalone code</h2><P>Date Written:  7/26/91</p><P>Last reviewed:  8/30/91</p><p>Linking a standalone code resource with the MPW 3.2 Paslib.o library generatesthe following link error message:</p><p>The same link works fine if the MPW 3.1 Paslib.o is used. Linking with the newMPW 3.2 Paslib.o causes Pascal modules such as %_MUL4, %_DIV4, %_MOD$, and%_CAT to be stored in a new segment called Paslib 1. However, standalone coderesource should just have the one segment.</p><p>To link a standalone code resource with the MPW 3.2 Paslib.o library, use the-sn option (like -sn PASLIB=Main) to pull all of the Pascal modules into yourMain segment. If your main segment is called something other than Main, you cansubstitute that name in the -sn option instead of Main.</p><p>For more information on segmentation, check out the "Segmentation" section ofChapter 10 of the MPW Reference Manual.</p><h2>Macintosh toolbox &amp; Pascal procedure parameters</h2><P>Date Written:  6/6/91</p><P>Last reviewed:  6/14/93</p><p>The Macintosh toolbox does not support nested procedure pointers as parameters,although Pascal can support them in "native Pascal" usage. Consequently, Pascalrequires that functions like the <code>SFPGetFile</code> filter and hook be globalfunctions; they cannot be local to the method calling <code>SFPGetFile</code> nor can theybe separate methods of an object calling <code>SFPGetFile</code>. Likewise, variables usedby the filter and hook must be global. For further reading, the MacintoshTechnical Note "Pascal To C: PROCEDURE Parameters" provides technicalities ofthis issue.</p><h2>Pascal Dispose function bugs</h2><P>Date Written:  5/3/89</p><P>Last reviewed:  12/17/90</p><p>I am having a hard time getting the Pascal function "<code>Dispose</code>" to work. Itdoesn't seem to be freeing up memory.</p><P>Surprisingly, <code>Dispose</code> doesn't work and has NEVER worked! As far as we know,there have been two bugs in the <code>Dispose</code> routine that have been in there fromday 1.</p><p>The first bug has to do with the interaction between the code that the Pascalcompiler creates, and the library routine (<code>%_DISPOSE</code>) it calls to do the actualdirty work. When the <code>Dispose</code> procedure gets compiled, the pointer to the memoryblock you want to free up and the amount of memory you want to free up arepushed onto the stack. Then a call to <code>%_DISPOSE</code> is made. However, thisroutine--written in Pascal--is declared to accept the memory pointer as a VARparameter. This means that it is expecting a pointer to the parameter, and notthe parameter itself.</p><p>The second bug occurs when trying to free a block of memory that doesn't haveany free memory in front of it within its sub-heap. When this occurs, the firstblock in the heap gets slightly corrupted; your data is still intact, but theheader that identifies it gets smashed. The result of this is that the heaproutines do not properly detect when the heap is empty and should be disposedof.</p><p>These problems are fixed in MPW 3.1. In the meantime, there are a couple ofthings you might be able to do. The first is use the Memory Manager routines,and not the Pascal heap routines. Second, Mark and Release are bug free (and sois New), so you may try using them. Release will dispose of any additionalallocated heap blocks. NOTE: Mark and Release only work if "<code>forDispose</code>" isFALSE.</p><h2>Booleans and short circuits don't mix</h2><P>Date Written:  11/17/89</p><P>Last reviewed:  6/14/93</p><p>I can't get expressions containing Booleans and short circuit in my MPW Pascalprogram to evaluate correctly. I have to use all of the same type. Is this abug?</p><P>Your workaround is correct. Presently this isn't a bug. The MPW documentationstates that mixing of short circuits and regular Booleans in the sameexpression IS NOT supported.</p><p>It is in Chapter 6, page 100 of the Pascal 3.0 manual.</p><h2>Why Pascal objects in HyperCard XCMDs is a challenge</h2><P>Date Written:  4/24/91</p><P>Last reviewed:  6/14/91</p><p>Is possible to declare MPW Pascal objects in a HyperCard XCMD?</p><P>It's possible but very difficult to use Pascal objects in an XCMD becauseObject Pascal uses the jump table in its method dispatch mechanism. XCMDs andother standalone code resources don't have a jump table. See the MacintoshTechnical Note "Stand-Alone Code, <i>ad nauseam</i>" for more information aboutthis.</p><br>         <a name=Downloads></A>                  <P><A HREF="#top">Back to top</A></p><h2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (35K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/pt_565.pdf">Download</A></P>               </TD>            </TR>                    </TABLE>         <BR></TD></TR></table></center><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/pt/pt_565.html%3Fid%3DDTS10002706-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/pt/pt_565.html%3Fid%3DDTS10002706-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/pt/pt_565.html%3Fid%3DDTS10002706-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>