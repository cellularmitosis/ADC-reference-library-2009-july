<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Using Script Contexts to Handle Apple Events(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING390></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-389.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-391.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-331.html"><B>Chapter 10 - Scripting Components</B></A> / <A HREF="IAC-344.html"><B>Scripting Components Reference</B></A><BR><DL><DD><A HREF="IAC-361.html"><B>Optional Scripting Component Routines</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING390-0></A>
<H3><A NAME=MARKER-9-248></A>Using Script Contexts to Handle Apple Events</H3>
 <A NAME=MARKER-2-367></A>The optional routines described in this section allow your application to use script contexts to handle Apple events. One way to do this is to install a general Apple event handler in your application's special handler dispatch table. The general Apple event handler provides initial handling for every Apple event received by your application. (For an example of such a handler, see <A HREF=IAC-338.html#MARKER-9-135>"Using a Script Context to Handle an Apple Event" on page 10-19</A>.)<P>
 The general Apple event handler extracts the event's direct parameter, obtains a script ID for the script context associated with the object described in the direct parameter, and passes the Apple event and the script ID to either <CODE>OSAExecuteEvent</CODE> or <CODE>OSADoEvent</CODE>. The main difference between these two functions is that <CODE>OSAExecuteEvent</CODE> returns a script ID for the resulting script value, whereas <CODE>OSADoEvent</CODE> returns a reply Apple event that includes either the resulting script value or information about any errors that occurred.<P>
 If the scripting component determines that a script context can't handle the specified event (for example, if an AppleScript script context doesn't include statements that handle the event), <CODE>OSAExecuteEvent</CODE> and <CODE>OSADoEvent</CODE> return <CODE>errAEEventNotHandled</CODE>. This causes the Apple Event Manager to look for an appropriate handler in the application's Apple event dispatch table or elsewhere, using standard Apple event dispatching. If the scripting component determines that a script context passed to <CODE>OSAExecuteEvent</CODE> or <CODE>OSADoEvent</CODE> can handle the event, the function attempts to use the script context for that purpose.<P>
 Script contexts can in turn pass an event to a resume dispatch function with a statement that's equivalent to an AppleScript <CODE>continue</CODE> statement. The <CODE>OSASetResumeDispatchProc</CODE> and <CODE>OSAGetResumeDispatchProc</CODE> functions allow your application to set and get pointers to the resume dispatch function used by a scripting component. These functions use the following type for a pointer to a resume dispatch function:<P>
<PRE>
TYPE AEHandlerProcPtr = EventHandlerProcPtr;
</PRE>
 A resume dispatch function takes the same parameters as an Apple event handler and dispatches an event to an application's standard handler for that event.<P>
 If you need to create a new, empty script context, you can use the <CODE>OSAMakeContext</CODE> function.<P>
 A scripting component that supports the functions described in this section has the <CODE>kOSASupportsEventHandling</CODE> bit set in the <CODE>componentFlags</CODE> field of its component description record.<A NAME=MARKER-2-250></A><P>
<HR>
<B>Subtopics</B>
<B><!-- TOC --><DL>
<DL>
<DT><A HREF="IAC-391.html#HEADING391-0">OSASetResumeDispatchProc</A>
<DD>
<DT><A HREF="IAC-392.html#HEADING392-0">OSAGetResumeDispatchProc</A>
<DD>
<DT><A HREF="IAC-393.html#HEADING393-0">OSAExecuteEvent</A>
<DD>
<DT><A HREF="IAC-394.html#HEADING394-0">OSADoEvent</A>
<DD>
<DT><A HREF="IAC-395.html#HEADING395-0">OSAMakeContext</A>
<DD>
</DL>
</DL>
</B>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-389.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-391.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
