<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Providing Help Balloons for Menus (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING147></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-146.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-148.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-138.html"><B>Chapter 3 - Help Manager</B></A> / <A HREF="MoreToolbox-143.html"><B>Using the Help Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING147-0></A>
<H2><A NAME=MARKER-9-157></A><A NAME=MARKER-21-158></A>Providing Help Balloons for Menus</H2>
 <A NAME=MARKER-9-27></A><A NAME=MARKER-2-179></A><A NAME=MARKER-2-161></A>If your application uses the standard menu definition procedure, you'll find that it's easier <A NAME=MARKER-2-38></A>to provide help balloons for menus than for any of your other interface features. This section is relatively lengthy compared to the sections describing dialog boxes, alert boxes, and windows because it explains in detail much of the work you'll also perform when supplying help balloons for those items.<P>
 This section assumes that your application uses the standard menu definition procedure. If your application uses its own menu definition procedure, you must use Help Manager routines to display and remove help balloons. These routines are described in <A HREF=MoreToolbox-165.html#MARKER-9-447>"Displaying and Removing Help Balloons" on page 3-92</A>. Even if you use these routines, you should read this section so that your balloons emulate the behavior that the Help Manager provides for menus using the standard menu definition function.<P>
 To create help balloons for a menu--pull-down, pop-up, or hierarchical--that uses the standard menu definition procedure, create a resource of type <CODE>'hmnu'</CODE> in which you specify help balloons for the menu title and for each menu item. You create a separate <CODE>'hmnu'</CODE> resource for each menu.<P>
<DL>
<DT><B>Note</B>
<DD>BalloonWriter, available from APDA, is a tool that gives nonprogrammers an easy, intuitive way to create help balloons for menus. BalloonWriter creates <CODE>'hmnu'</CODE> resources as appropriate and places them in the resource file of your application; BalloonWriter likewise creates and stores <CODE>'STR '</CODE>, <CODE>'STR#'</CODE>, and <CODE>'TEXT'</CODE> resources that contain the help messages authored by nonprogramming writers. <BR>For menus that use custom menu definition procedures, nonprogrammers can use BalloonWriter to provide you with delimited ASCII text that you can then use in conjunction with <CODE>HMShowBalloon</CODE> to display the desired help balloons.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 The Help Manager can display different help balloons for the various states of a menu item. Each menu item can have up to four help balloons associated with it, one for each state: <P>
<UL>
<LI>enabled
<LI>disabled (that is, dimmed)
<LI>enabled and checked
<LI>enabled and marked (that is, marked by a symbol other than a checkmark--for example, a bullet or a diamond) <P>
</UL>
 For example, you can define a help balloon that the Help Manager displays when the Cut command is enabled and another help balloon for display when the Cut command is dimmed. Remember that the help balloon you provide for a dimmed menu item should explain why it isn't currently available or, if more appropriate, how to make it available.<P>
<DL>
<DT><B>Note</B>
<DD>Although <CODE>enabled</CODE> and <CODE>disabled</CODE> are the constants you use in a resource file to display or dim menus and menu items, you shouldn't use these terms in your help balloons or user guides. Rather, use the term <I>menus, menu commands,</I> or <I>menu items</I> for those that are enabled, and use the term <I>not available</I> or <I>dimmed</I> to distinguish those that have been disabled.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 When your application calls the Menu Manager function <CODE>MenuSelect</CODE> or <CODE>MenuKey</CODE>, the Menu Manager automatically tracks the cursor, highlights enabled menu items, and displays any additional hierarchical or pop-up menus as the user moves the mouse. As the user drags the cursor across or through a menu, the Menu Manager uses the Help Manager to display any help balloons associated with the current state of the menu title or menu item.<P>
 If there is sufficient memory, the standard menu definition procedure saves the bits behind the help balloon and restores these bits for quick updating of the screen. If there isn't sufficient memory to save the bits behind the help balloon, then--as with menus--the procedure generates appropriate update events. <A HREF=#MARKER-9-163>Figure 3-9</A> shows help balloons for two instances of a menu, one with the Cut command dimmed, the other with the Cut command enabled.<P>
<B>Figure 3-9  <A NAME=MARKER-9-163></A><A NAME=MARKER-21-164></A>Help balloons for different states of the Cut command</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/HM-S-09.jpg">
 You don't specify hot rectangles or tip coordinates for menus. The rectangles defined by the Menu Manager for menu titles and menu items are used as hot rectangles. The Help Manager initially tries to draw a help balloon for a menu item using variation code 0 (shown in <A HREF=MoreToolbox-140.html#MARKER-9-48>Figure 3-4 on page 3-9</A>) with the tip placed 8 pixels inside the right edge and halfway between the top and bottom edges of the menu item's rectangle. If the balloon's initial position lies wholly or partially offscreen, the Help Manager tries to redraw the balloon by moving its tip to the left edge of the item's rectangle and using variation <BR>code 3. The Help Manager uses variation codes 1 and 2 in its attempts to draw help balloons for menu titles. The Help Manager never moves the tip for menu titles; instead, the tip is always located just below the bottom of the menu bar at the midpoint of the menu title's text.<A NAME=MARKER-2-397></A><A NAME=MARKER-2-60></A><P>
 The resource ID of each <CODE>'hmnu'</CODE> resource should match the corresponding menu ID. For example, to provide help balloons for a menu with ID 130, create an <CODE>'hmnu'</CODE> resource with resource ID 130.<P>
 The <CODE>'hmnu'</CODE> resource contains four types of components, listed below. Each component consists of several elements that contain information used by the Help Manager.<P>
<UL>
<LI>The <B>header component</B> is where you specify information that applies to all help balloons specified in this resource--information such as the version number of the Help Manager, the balloon definition function, and the variation code.
<LI>The <B>missing-items component</B> is where you specify help messages for any menu items missing from or unspecified in the rest of the resource. This is useful, for example, for allowing several menu items to share the same help message.
<LI>The <B>menu-title component</B> is where you specify help messages for the menu title.
<LI>A<B> menu-item component</B> is where you specify the help messages for a particular menu item. You can include any number of menu-item components; however, <BR>the menu-item components in the <CODE>'hmnu'</CODE> resource must appear in the order in which their corresponding menu items appear in the menu. If you do not provide menu-item components for any items at the bottom of a menu, a help message from the missing-items component is used.<P>
</UL>
 <A NAME=MARKER-2-396></A>Here is the general Rez input format of an <CODE>'hmnu'</CODE> resource. (Rez is the resource compiler provided with Apple's Macintosh Programming Workshop [MPW], available from APDA.)
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Component<TH>Element<TR>
<TD rowspan=4>Header<TD>Help Manager version<TR>
<TD>Options<TR>
<TD>Balloon definition function<TR>
<TD>Variation code<TR>
<TD rowspan=5>Missing item<TD>Identifier<TR>
<TD>Help message for missing enabled items<TR>
<TD>Help message for missing items dimmed by application<TR>
<TD>Help message for missing enabled-and-checked items<TR>
<TD>Help message for missing enabled-and-marked items<TR>
<TD rowspan=5>Menu title<TD>Identifier<TR>
<TD>Help message for enabled menu title<TR>
<TD>Help message for menu title dimmed by application<TR>
<TD>Help message for menu title dimmed by system software<TR>
<TD>Help message for menu items dimmed by system software<TR>
<TD rowspan=5>First menu item<TD>Identifier<TR>
<TD>Help message for enabled menu item<TR>
<TD>Help message for menu item dimmed by your application<TR>
<TD>Help message for enabled-and-checked menu item<TR>
<TD>Help message for enabled-and-marked menu item<TR>
<TD rowspan=4>Next menu item<TD>(Same as for first menu item)<TR>
<TD>. <TR>
<TD>. <TR>
<TD>.<A NAME=MARKER-2-32></A><TR>
<TD>Last menu item<TD>(Same as for first menu item)</TABLE>
<P>
 <A HREF=#MARKER-9-169>Listing 3-1</A> shows Rez input code for the <CODE>'hmnu'</CODE> resource for an Edit menu.<A NAME=MARKER-9-295></A><P>
<B>Listing 3-1  <A NAME=MARKER-9-169></A><A NAME=MARKER-21-170></A>Rez input for a partial <CODE>'hmnu'</CODE> resource</B><P>
<PRE>
resource 'hmnu' (130, &quot;Edit&quot;, purgeable) {
   /*header component*/
   HelpMgrVersion,
   hmDefaultOptions,       /*options*/
   0,                      /*balloon definition function*/
   0,                      /*variation code*/
   /*missing-items component*/
   HMSkipItem {
      /*no missing items, so skip to menu-title component*/
      },
      { /*menu-title component*/
         HMStringItem { /*use following P-strings*/
            /*use string below when menu is enabled*/
            &quot;Edit menu\n\nUse this menu to manipulate text.&quot;,
            /*use string below when app dims menu*/
            &quot;Edit menu\n\nUse this menu to manipulate text. &quot;
               &quot;Not available because you do not have permission &quot;
               &quot;to alter this file.&quot;,
            /*use string below for title dimmed by system */
            /* software for an alert or modal dialog box*/
            &quot;Edit menu\n\nUse this menu to manipulate text. &quot;
               &quot;Not available because a dialog box is on &quot;
               &quot;the screen.&quot;,
            /*use string below for all items when system */
            /* software dims them for an alert or modal */
            /* dialog box*/
            &quot;This item is not available because a dialog box &quot;
               &quot;is on the screen.&quot;,
         },

      /*first menu-item component: Undo command*/
         HMStringItem {/*use following P-strings*/
            /*use string below when command is enabled*/
            &quot;Cancels your last edit.&quot;,
            /*use string below when app dims the command*/
            &quot;Cancels your last edit. Not available because &quot;
               &quot;you haven't performed an editing action yet.&quot;, 
            /*can't check the item, so empty string goes below*/
            &quot;&quot;,
            /*can't mark the item, so empty string goes below*/
            &quot;&quot;,
         },
      /*second menu-item component: divider line*/
         HMSkipItem { /*no help balloons for divider lines*/
         },
      /*third menu-item component: Cut command*/
         HMStringItem { /*use following P-strings*/
            /*use string below when command is enabled*/
            &quot;Cuts the selected text to the Clipboard.&quot;,
            /*use string below when app dims the command*/
            &quot;Cuts the selected text to the Clipboard. &quot;
               &quot;Not available now because no text is selected.&quot;,
            /*can't check item, so empty string goes below*/
            &quot;&quot;,
            /*can't mark item, so empty string goes below*/
            &quot;&quot;,
         }
      /*menu-item components for Copy, Paste, and Clear */
      /* commands go here*/
      }
};
</PRE>
<A NAME=HEADING147-27></A>
<H3><A NAME=MARKER-9-171></A>Specifying Header Information for the 'hmnu' Resource</H3>
 The header component of an <CODE>'hmnu'</CODE> resource consists of these elements:<P>
<OL>
<LI>Help Manager version.
<LI>Options.
<LI>Balloon definition function.
<LI>Variation code.<P>
</OL>
 Always specify the <CODE>HelpMgrVersion</CODE> constant for the Help Manager version element.<A NAME=MARKER-2-240></A><P>
 <A NAME=MARKER-21-267></A>For the options element, you must specify the constant <CODE>hmDefaultOptions</CODE>.<P>
 The third element in the header component specifies the resource ID of the window definition function that is used to draw the frame of the help balloon. To use the standard balloon definition function, specify 0 for this element; this is the suggested default. If you use your own balloon definition function (as described in <A HREF=MoreToolbox-156.html#MARKER-9-412>"Writing Your Own Balloon Definition Function" on page 3-86</A>), specify its resource ID for this element.<P>
 The fourth element in the header component specifies the preferred position of the help balloon. For example, the standard balloon definition function displays help balloons according to eight different positions. If you specified the standard balloon definition for the preceding element, supply a variation code from 0 to 7 to display the balloon according to one of the eight positions shown in <A HREF=MoreToolbox-140.html#MARKER-9-48>Figure 3-4 on page 3-9</A>. The preferred variation code is 0. If you are unsure of which variation code to use, specify 0; the Help Manager will use a different variant if another is more appropriate. If you use your own balloon definition function, you specify its variation code for this element of the header component.<P>
<A NAME=HEADING147-37></A>
<H3><A NAME=MARKER-9-174></A>Specifying Help for Menu Items Missing From the Resource</H3>
 After the header component, you specify the format and help messages for help balloons for missing items, for the menu title, and for the menu items.<A NAME=MARKER-9-99></A><P>
 Use the missing-items component of the <CODE>'hmnu'</CODE> resource to specify how the Help Manager handles menu items that are not described in this resource. You can also use the missing-items component to supply help messages for menu items that are described in the <CODE>'hmnu'</CODE> resource but that lack help messages for any particular states. <P>
 The missing-items component of this resource is useful when you have menu items with similar characteristics or when the number of menu items is variable. For example, if <BR>the help message for a dimmed item applies to all dimmed menu items, you can specify a help message once in the third element of the missing-items component instead of repeating it in every third element of the various menu-item components.<P>
 The missing-items component consists of the following five elements:<P>
<OL>
<LI>An identifier (either <CODE>HMStringItem</CODE>, <CODE>HMSTRResItem</CODE>, <CODE>HMStringResItem</CODE>, <CODE>HMPictItem</CODE>, <CODE>HMTEResItem</CODE>, or <CODE>HMSkipItem</CODE>) for the format of the help messages.
<LI>The help message when a menu item is enabled. This message is displayed either when the item itself is not specified in a menu-item component of this <CODE>'hmnu'</CODE> resource or when its help message <I>is</I> specified in a menu-item component, but specified with either an empty string or a resource ID of 0.
<LI>The help message when your application dims the menu item. This message is displayed either when the item itself is not specified in a menu-item component of this <CODE>'hmnu'</CODE> resource or when its help message <I>is</I> specified in a menu-item component, but specified with either an empty string or a resource ID of 0.
<LI>The help message when a menu item is enabled and checked. This message is displayed either when the item itself is not specified in a menu-item component of this <CODE>'hmnu'</CODE> resource or when its help message <I>is</I> specified in a menu-item component, but specified with either an empty string or a resource ID of 0.
<LI>The help message when a menu item is enabled and marked (with a character other than a checkmark). This message is displayed either when the item itself is not specified in a menu-item component of this <CODE>'hmnu'</CODE> resource or when its help message <I>is</I> specified in a menu-item component, but specified with either an empty string or a resource ID of 0.<P>
</OL>
 For missing items (as for the rest of the items listed in an <CODE>'hmnu'</CODE> resource), you store the help messages in text strings within this resource or in separate <CODE>'STR '</CODE>, <CODE>'STR#'</CODE>, <CODE>'PICT'</CODE>, or <CODE>'TEXT'</CODE> and <CODE>'styl'</CODE> resources. For the first element in the missing-items component, use one of the identifiers described in <A HREF=MoreToolbox-145.html#MARKER-9-122>"Specifying the Format for Help Messages" on page 3-21</A>. These identifiers indicate how and where you store your <BR>help messages. Then, depending on the identifier you specify, for the next four elements supply either text strings for help messages or resource IDs of resources that contain help messages.<P>
 There are two additional identifiers that you can specify for menu items in <CODE>'hmnu'</CODE> resources. These identifiers are explained in <A HREF=#MARKER-9-202>"Specifying Help for a Changing Menu Item" on page 3-39</A> and in <A HREF=#MARKER-9-212>"Specifying Resources by Item Name" on page 3-41</A>.
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Identifier<TH>Purpose<TR>
<TD>HMCompareItem <TD>The Help Manager displays help for the current menu item only when it matches a specified string.<TR>
<TD>HMNamedResourceItem<TD>The Help Manager displays the help message from the resource that has the same name as the current menu item.</TABLE>
<P>
 <A HREF=#MARKER-9-176>Listing 3-2 on page 3-32</A> illustrates the help resource for a menu titled Colors. Notice in the missing-items component that the element describing dimmed states for menu items has the message "Not available; either you have not selected text to color, or your monitor does not support color." Because this resource doesn't specify a message for any individual command's dimmed state, this message appears in help balloons for the Blue, Green, and Red commands whenever the application disables them. If there are many reasons why your application may have dimmed an item, don't name them all. Instead, describe one or two of the most likely reasons.<P>
<DL>
<DT><B>Note</B>
<DD>As described in the chapter "Dialog Manager" in <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I>, system software automatically dims your application's menus as appropriate whenever an alert box or a fixed-position modal dialog box appears on the screen. You supply help messages for menu titles and menu items dimmed by system software in the third and fourth elements of the menu-title component of the <CODE>'hmnu'</CODE> resource, as described in the next section. If your application uses <I>movable</I> modal dialog boxes or modeless dialog boxes, your application must dim its menus as appropriate and provide an alternate <CODE>'hmnu'</CODE> resource for this state, as described in <A HREF=#MARKER-9-218>"Providing Help Balloons for Menus You Disable for Dialog Boxes" beginning on page 3-43</A>.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
<B>Listing 3-2  <A NAME=MARKER-9-176></A>Rez input for the missing-items component of an <CODE>'hmnu'</CODE> resource</B><P>
<PRE>
resource 'hmnu' (132, &quot;Colors&quot;, purgeable) {
   /*header component*/
   HelpMgrVersion, hmDefaultOptions, 0, 0,
   /*missing-items component*/
   HMStringItem {
      &quot;&quot;,      /*no missing enabled items*/
      /*help messages for all items that app dims are below*/
      &quot;Not available; either you have not selected &quot;
         &quot;text to color, or your monitor does &quot;
         &quot;not support color.&quot;,
      &quot;&quot;,      /*no missing enabled-and-checked items*/
      &quot;&quot;,      /*no missing enabled-and-marked items*/
      },
   {  /*menu-title component*/
      HMStringItem {    /*use these P-strings for help messages*/
         /*use string below when menu is enabled*/
         &quot;Colors menu\n\nUse this menu to display text in color.&quot;,
         /*use string below when app dims menu title*/
         &quot;Colors menu\n\nUse this menu to display text in color.&quot;
            &quot;Not available because this monitor does not 
            support color.&quot;,
         /*use string below when system software dims menu */
         /* title for an alert or modal dialog box*/
         &quot;Colors menu\n\nUse this menu to display text in color. &quot;
            &quot;Not available because a dialog box is on the &quot;
            &quot;screen.&quot;,
         /*use string below for all items when system dims */
         /* them for alert and modal dialog boxes*/
         &quot;Colors your selected text. This item is not &quot;
            &quot;available because a dialog box is on the screen.&quot;,
      },
      /*first menu-item component: Blue command*/
      HMStringItem {/*use these P-strings for help messages*/
         /*use string below when command is enabled*/
         &quot;Displays the selected text in blue.&quot;,
         &quot;&quot;,   /*use missing-items help when app dims menu*/
         &quot;&quot;,   /*can't check command, so use empty string here*/
         &quot;&quot;,   /*can't mark command, so use empty string here*/
      },
      /*second menu-item component: Green command*/
      HMStringItem {/*use these P-strings for help messages*/
         /*use string below when command is enabled*/
         &quot;Displays the selected text in green.&quot;,
         &quot;&quot;,   /*use missing-items help when app dims menu*/
         &quot;&quot;,   /*can't check command, so use empty string here*/
         &quot;&quot;,   /*can't mark command, so use empty string here*/
      },
      /*third menu-item component: Red command*/
      HMStringItem {/*use these P-strings for help messages*/
         /*use string below when command is enabled*/
         &quot;Displays the selected text in red.&quot;,
         &quot;&quot;,   /*use missing-items help when app dims menu*/
         &quot;&quot;,   /*can't check command, so use empty string here*/
         &quot;&quot;,   /*can't mark command, so use empty string here*/
      }
   }
};
</PRE>
<A NAME=HEADING147-54></A>
<H3><A NAME=MARKER-9-177></A>Specifying Help for Menu Titles and for Items Dimmed by System Software</H3>
 <A NAME=MARKER-2-317></A>After the missing-items component, use the menu-title component to specify the help messages for the menu title and for menu items dimmed by system software. The menu-title component consists of the following five elements<A NAME=MARKER-2-221></A>:<P>
<OL>
<LI>An identifier (either <CODE>HMStringItem</CODE>, <CODE>HMSTRResItem</CODE>, <CODE>HMStringResItem</CODE>, <CODE>HMPictItem</CODE>, <CODE>HMTEResItem</CODE>, or <CODE>HMSkipItem</CODE>) that indicates the format of the help messages.
<LI>The help message for the menu title when the menu title is enabled.
<LI>The help message for the menu title when your application dims the menu title.
<LI>The help message for the menu title when system software dims the menu title at the appearance of an alert box or a modal dialog box.
<LI>The help message for all menu items when system software dims them at the appearance of an alert box or a modal dialog box.<P>
</OL>
 As in the missing-items component, use the first element in the menu-title component to specify an identifier that describes the format for the help messages. Depending on the identifier you specify, for the other elements you supply either text strings for the help messages or the resource IDs of resources that contain the help messages. The second, third, and fourth elements correspond to states of the menu title; the fifth element corresponds to a state of all the menu items.<P>
 Use the second element of the menu-title component to specify a help message that describes the purpose of the menu when it's enabled. For menus in the menu bar, the beginning of the message should name the menu and then concisely describe what kinds of commands are in the menu, as shown in <A HREF=#MARKER-9-183>Figure 3-10</A>. (<A HREF=#MARKER-9-176>Listing 3-2 on page 3-32</A> specifies the menu title--"Colors menu"--and then includes the special characters <CODE>\n\n</CODE> to specify two new lines in a Rez input file before specifying a description of the menu itself.)<A NAME=MARKER-0-180></A><A NAME=MARKER-2-53></A><A NAME=MARKER-2-95></A><P>
<B>Figure 3-10  <A NAME=MARKER-9-183></A>A help balloon for an enabled menu title</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/HM-S-10.jpg">
 Because some pull-down menus in the menu bar are identified by icons, not words, offer additional clarification in your help balloon by always providing a name for pull-down menus. For pop-up menus, simply describe what the user does with the menu; don't give the menu a name.<P>
 Use the third element of the menu-title component to specify a help message that identifies the menu, describes what it does, and then describes why your application has dimmed the menu title. As much as possible, repeat the text that you use for the title's enabled state, then describe why it is not enabled. See <A HREF=#MARKER-9-184>Figure 3-11</A> for an example and see <A HREF=#MARKER-9-176>Listing 3-2 on page 3-32</A> for the Rez input that specifies the help message for the help balloon shown in the figure.<P>
<B>Figure 3-11  <A NAME=MARKER-9-184></A>A help balloon for a dimmed menu title</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/HM-S-11.jpg">
 In general, you should use the phrase "Not available because" to introduce your explanation of a dimmed title. If there are several reasons why a menu title might be dimmed, don't name them all. Instead, describe one or two of the most likely reasons.<P>
 <A NAME=MARKER-2-322></A>Use the fourth element of the menu-title component to specify a help message that describes why system software has dimmed the menu title--that is, because the user must respond to an alert box or modal dialog box on the screen. <A HREF=#MARKER-9-186>Figure 3-12</A> illustrates an appropriate help balloon for this situation.<P>
<B>Figure 3-12  <A NAME=MARKER-9-186></A>A help balloon for a menu title dimmed by the Dialog Manager</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/HM-S-12.jpg">
 Starting with system software version 7.0, users have been able to use selected menus while the screen displays an alert box or a modal dialog box. For example, the Show Balloons (or Hide Balloons) command is always available from the Help menu so that users can see your help balloons for the modal dialog box or alert box. While some menus are accessible (in particular, the Help, Keyboard, and--when appropriate-- Edit menus), others aren't. The chapter "Dialog Manager" in <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I> describes the circumstances under which menus are enabled or disabled when alert boxes and dialog boxes are displayed.<P>
<DL>
<DT><B>Note</B>
<DD>If your application uses <I>movable</I> modal dialog boxes, you must dim your menus and provide an alternate <CODE>'hmnu'</CODE> resource for this state, as described in <A HREF=#MARKER-9-218>"Providing Help Balloons for Menus You Disable for Dialog Boxes" beginning on page 3-43</A>.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 Use the fifth element to specify the help message for all menu items whenever system software dims them because of an alert box or a modal dialog box. Because this message is used for all items in the menu, it needs to be somewhat general, as shown in <BR><A HREF=#MARKER-9-191>Figure 3-13</A>. <A NAME=MARKER-2-404></A><A NAME=MARKER-2-357></A><A NAME=MARKER-2-238></A> <P>
<B>Figure 3-13  <A NAME=MARKER-9-191></A>A help balloon for menu items dimmed by the Dialog Manager</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/HM-S-13.jpg">
<A NAME=HEADING147-78></A>
<H3>Specifying Help for Menu Items</H3>
 <A NAME=MARKER-9-225></A>After you create the header component, the missing-items component, and the menu-title component, you specify help messages in a menu-item component for <BR>each menu item. The menu-item components in the <CODE>'hmnu'</CODE> resource must appear in the order in which their corresponding menu items appear in the menu. (Because of this, if you have menu items that your application can add while it is running, you should add these dynamic items to the end of the menu to simplify your implementation of help balloons for your nondynamic items.)<P>
 The menu-item component consists of the following five elements:<P>
<OL>
<LI>An identifier (either <CODE>HMStringItem</CODE>, <CODE>HMSTRResItem</CODE>, <CODE>HMStringResItem</CODE>, <CODE>HMPictItem</CODE>, <CODE>HMTEResItem</CODE>, or <CODE>HMSkipItem</CODE>) that indicates the format of the help messages.
<LI>The help message for the menu item when the item is enabled.
<LI>The help message for the menu item when your application dims the item.
<LI>The help message for the menu item when the item is enabled and checked.
<LI>The help message for the menu item when the item is enabled and marked with a character other than a checkmark.<P>
</OL>
 For the first element of each menu-item component, supply an identifier to describe the format of the help messages in that component. Then, depending on the identifier you specify, use the other elements of the menu-item component to supply either text strings for the help messages or the resource IDs of resources that contain the help messages.<P>
 You can use the <CODE>HMSkipItem</CODE> identifier for items that appear in your menu but for which you don't provide a help balloon. For example, you can specify <CODE>HMSkipItem</CODE> for divider lines that appear in menus. (Divider lines cannot have help balloons.) If you specify <CODE>HMSkipItem</CODE>, the Help Manager does not display help balloons for that menu item, even if the missing-items component specifies a help message.<P>
 For the second element, specify a help message that describes what the item usually does. Don't name the menu item. Begin with a verb describing what happens when the user chooses the item. For example, the help balloon for the Undo command in an Edit menu should contain something similar to the information in <A HREF=#MARKER-9-195>Figure 3-14</A>. <A NAME=MARKER-2-147></A> <P>
<B>Figure 3-14  <A NAME=MARKER-9-195></A>A help balloon for a menu item</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/HM-S-14.jpg">
 For menu items that display a dialog box, it is usually unnecessary to state that a dialog box will appear. The fact that a menu item displays a dialog box is not what the user wants to know; the user wants to know what choosing the menu item ultimately accomplishes.<P>
 For the third element, specify a help message that describes what the menu item does and why your application has dimmed the item. As much as possible, repeat the text <BR>that you use for the item's enabled state, and then describe why it is not enabled. In general, you should use the phrase "Not available because" to introduce your explanation of the dimmed item. If there are multiple reasons why an item might be dimmed, don't name them all. Instead, describe one or two of the most likely reasons. <A HREF=#MARKER-9-196>Figure 3-15</A> gives an example of a help message for a dimmed Undo command.<P>
<B>Figure 3-15  <A NAME=MARKER-9-196></A>A help balloon for a dimmed menu item</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/HM-S-15.jpg">
 If your application checks or otherwise marks a menu item, use the fourth and fifth elements of that item's component in the <CODE>'hmnu'</CODE> resource to describe the special condition indicated by that state. As with dimmed states, try to repeat the text that you use for the title's enabled state, and then describe why it is checked or marked. If there are multiple reasons why an item might be checked or marked, don't name them all. Instead, describe one or two of the most likely reasons.<A NAME=MARKER-2-252></A><P>
 Note that, for any component in the resource, you can specify only one format for all of its help messages. For example, if you specify the <CODE>HMSTRResItem</CODE> identifier in a menu-item component for the Undo command, you must store all help messages specified in that component in <CODE>'STR '</CODE> resources. (However, if you specify a resource ID of 0 or an empty string as the help message of any item in order to use the help message from the missing-items component, the help message follows the format specified in the missing-items component.)<P>
 You do not have to provide a help message for every state of a menu item. If you do <BR>not provide a help message for a particular state, the Help Manager uses the help message specified in the missing-items component. If the missing-items component does not specify a help message for that state either, the Help Manager does not display a help balloon.<P>
 <A HREF=#MARKER-9-200>Listing 3-3</A> shows a sample <CODE>'hmnu'</CODE> resource for another Edit menu. <BR>Although <A HREF=#MARKER-9-169>Listing 3-1</A> and <A HREF=#MARKER-9-176>Listing 3-2</A> illustrate <CODE>'hmnu'</CODE> resources that contain their own Pascal-string help messages, you should keep your help messages in separate, more easily localized resources. The <CODE>'hmnu'</CODE> resource in <A HREF=#MARKER-9-200>Listing 3-3</A> stores its help messages in a separate <CODE>'STR#'</CODE> resource (which is given a corresponding resource ID of 130 for easier maintenance).<A NAME=MARKER-2-276></A><P>
<B>Listing 3-3  <A NAME=MARKER-9-200></A><A NAME=MARKER-21-201></A>Rez input for corresponding <CODE>'hmnu'</CODE> and <CODE>'STR#'</CODE> resources</B><P>
<PRE>
resource 'hmnu' (130, &quot;Edit menu help&quot;, purgeable) {
   HelpMgrVersion, 0, 0, 0,   /*standard header component*/
   HMSkipItem {               /*missing-items component*/
      /*no missing items, so skip to menu-title component*/
      },
   {  /*menu title and items below*/
      /*menu-title component*/
      HMStringResItem {/*use an 'STR#' for help messages*/
         130,1,   /*'STR#' res ID, index when menu is enabled*/
         130,2,   /*'STR#' res ID, index when app dims menu*/
         130,3,   /*'STR#', index for title that system */
                  /* software dims for all alert and modal */
                  /* dialog boxes*/
         130,4    /*'STR#', index for items that system */
                  /* software dims for all alert and modal */
                  /* dialog boxes*/
      },
         /*first menu-item component: Undo command*/
      HMStringResItem { /*use 'STR#' resource for help messages*/
         130,5,   /*'STR#' res ID, index when item is enabled*/
         130,6,   /*'STR#' res ID, index when item is dimmed*/
         0,0,     /*can't check command*/
         0,0      /*can't mark command*/
      },
         /*second menu-item component: divider line*/
      HMSkipItem {   /*no balloon help for divider lines*/
      },
         /*third menu-item component: Cut command*/
      HMStringResItem { /*use an 'STR#' for help messages*/
         130,7,   /*'STR#' res ID, index when item is enabled*/
         130,8,   /*'STR#' res ID, index when app dims item*/
         0,0,     /*can't check command*/
         0,0      /*can't mark command*/
      },
         /*menu-item component for Copy command goes here*/
   }
};
resource 'STR#' (130, &quot;Edit menu help strings&quot;) { 
   /*help text for Edit menu*/
   { /*array StringArray: 17 elements*/
   /*[1] help text for enabled Edit menu title*/
   &quot;Use this menu to cancel your last action, to manipulate &quot;
      &quot;text, to select the entire content of a document, &quot;
      &quot;and to show what's on the Clipboard.&quot;;
   /*[2] help text for Edit menu title dimmed by app*/
   &quot;Use this menu to cancel your last action, to manipulate &quot;
      &quot;text, to select the entire content of a document, &quot;
      &quot;and to show what's on the Clipboard. Not &quot;
      &quot;available now.&quot;;
   /*[3] help text for Edit menu title dimmed by system */
   /* software for all alert and modal dialog boxes */
   /* that don't contain editable text items*/
   &quot;Use this menu to cancel your last action, to manipulate &quot;
      &quot;text, to select the entire content of a document, and &quot;
      &quot;to show what's on the Clipboard. Not available &quot; 
      &quot;because a dialog box is on the screen.&quot;;
   /*[4] help for Edit menu items that system software dims */
   /* for all alert and modal dialog boxes */
   /* that don't contain editable text items*/
   &quot;Not available because a dialog box is on the screen.&quot;;
   /*[5] help text for enabled Undo command*/
   &quot;Cancels your last action. Use this command to replace &quot;
      &quot;material you have cut or cleared, or to remove material &quot;
      &quot;you have pasted or typed.&quot;;
   /*[6] help text for Undo command dimmed by app*/
   &quot;Cancels your last action. Use this command to replace &quot;
      &quot;material you have cut or cleared, or to remove material &quot; 
      &quot;you have pasted or typed. Not available because your &quot;
      &quot;last action did not involve cutting, pasting, &quot;
      &quot;or typing.&quot;;
   /*help text for all other commands goes here*/
   }
};
</PRE>
 The <CODE>'hmnu'</CODE> resource in <A HREF=#MARKER-9-200>Listing 3-3</A> specifies the standard balloon definition function and variation code in the third and fourth elements of the header component. The missing-items component is specified using the <CODE>HMSkipItem</CODE> identifier, meaning that this <CODE>'hmnu'</CODE> resource does not provide any help balloons for menu items that are missing from this resource or that do not have help messages specified for any states.<P>
 Following the menu-title component, the menu-item components for the menu items are listed in the order in which the items appear in the menu. For menu-item components that do not specify information for a particular state, the Help Manager normally uses the information from the missing-items component. However, in <A HREF=#MARKER-9-200>Listing 3-3</A> the <CODE>'hmnu'</CODE> resource does not specify a help message in the missing-items component. Instead, all help messages are specified in each menu-item component in this resource. Because there are no enabled-and-checked or enabled-and-marked states for the Undo and Copy commands, these states are specified with resource IDs of 0.<P>
 As described in the chapter "Dialog Manager" in <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I>, system software does not dim your application's Edit menu when you display a dialog box that contains editable text items. <A HREF=#MARKER-9-200>Listing 3-3</A> nevertheless provides help messages for a dimmed Edit menu for those instances when the application displays alert boxes and dialog boxes that do not contain editable text items.<P>
<A NAME=HEADING147-106></A>
<H3><A NAME=MARKER-9-202></A>Specifying Help for a Changing Menu Item</H3>
 <A NAME=MARKER-2-374></A>If you have a menu item that changes names, you can use the <CODE>HMCompareItem</CODE> identifier to compare a string against the current menu item in that position. If the string specified after the <CODE>HMCompareItem</CODE> identifier matches the name of the current menu item, the Help Manager displays the help messages specified in the next four elements of the <CODE>'hmnu'</CODE> resource. Because of performance considerations, the <CODE>HMCompareItem</CODE> identifier shouldn't be used unless necessary.<P>
 <A NAME=MARKER-2-72></A>A menu-item component that uses the <CODE>HMCompareItem</CODE> identifier uses a different format than other menu-item components do. Here are the seven elements you use for specifying help in an <CODE>'hmnu'</CODE> resource for a changing menu item.<P>
<OL>
<LI>The <CODE>HMCompareItem</CODE> identifier.
<LI>The string to compare against current menu item.
<LI>The identifier (either <CODE>HMStringItem</CODE>, <CODE>HMSTRResItem</CODE>, <CODE>HMStringResItem</CODE>, <CODE>HMPictItem</CODE>, <CODE>HMTEResItem</CODE>, or <CODE>HMSkipItem</CODE>) that indicates the format of the help messages.
<LI>The help message for the menu item when the item is enabled.
<LI>The help message for the menu item when the item is dimmed.
<LI>The help message for the menu item when the item is enabled and checked.
<LI>The help message for the menu item when the item is enabled and marked.<P>
</OL>
 Create a component that uses the <CODE>HMCompareItem</CODE> identifier for every item name that can appear in a particular menu position. For example, <A HREF=#MARKER-9-207>Listing 3-4</A> shows an <CODE>'hmnu'</CODE> resource for a menu command that toggles between Show Colors and Hide Colors.<A NAME=MARKER-9-164></A><P>
<DL>
<DT><B>Note</B>
<DD>It is important to provide components for all possible strings that can appear in the changing item. Also note that if you use the <CODE>HMCompareItem</CODE> identifier for a menu item, you should ensure that the following menu item has a text string that is different from the one that the <CODE>HMCompareItem</CODE> menu-item component compares against.<EM></EM><A NAME=MARKER-2-14></A>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
<B>Listing 3-4  <A NAME=MARKER-9-207></A><A NAME=MARKER-21-208></A>Rez input for an <CODE>'hmnu'</CODE> resource that uses <CODE>HMCompareItem</CODE> for a changing menu item</B><P>
<PRE>
resource 'hmnu' (132, &quot;Colors menu help&quot;, purgeable) {
   /*see Listing 3-2 for missing-items example*/
   /*see Listing 3-2 for Colors menu title's help example*/
      HMCompareItem {   /*help message if first command is */
                        /* called Show Colors*/
         &quot;Show Colors&quot;,
         HMStringResItem {
            132, 1,        /*enabled*/
            0, 0,          /*use missing items*/
            0, 0,          /*item can't be checked*/
            0, 0           /*no marked state*/
         },
      },
      HMCompareItem {   /*help if the first command is */
                        /* called Hide Colors*/
         &quot;Hide Colors&quot;,
         HMStringResItem {
            132, 2,        /*enabled*/
            0, 0,          /*use missing items*/
            0, 0,          /*item can't be checked*/
            0, 0           /*no marked state*/
         },
      },
      /*Blue command's help messages*/
      HMStringItem { /*use these P-strings for help messages*/
            /*use string below when command is enabled*/
         &quot;Displays the selected text in blue.&quot;,
         &quot;&quot;,   /*use missing-items help when menu is dimmed*/
         &quot;&quot;,   /*can't check command--use empty string here*/
         &quot;&quot;,   /*can't mark command--use empty string here*/
      },
      /*see Listing 3-2 for other commands' examples*/
   }
};

resource 'STR#' (132, &quot;Hide &amp; Show Colors commands help text&quot;) {
      {
      /*[1] help text for enabled Show command*/
      &quot;Shows text in previously selected colors.&quot;;
      /*[2] help text for enabled Hide command*/
      &quot;Shows text in black and white only.&quot;;
      }
};
</PRE>
 As illustrated in <A HREF=#MARKER-9-210>Figure 3-16</A>, when the menu command is Show Colors, the Help Manager displays the help message described by the first <CODE>HMCompareItem</CODE> component. When the menu command is Hide Colors, the Help Manager displays the help message described by the second <CODE>HMCompareItem</CODE> identifier.<A NAME=MARKER-2-125></A><P>
<B>Figure 3-16  <A NAME=MARKER-9-210></A><A NAME=MARKER-21-211></A>Help balloons for a changing menu item</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/HM-S-16.jpg">
<A NAME=HEADING147-123></A>
<H3><A NAME=MARKER-9-212></A>Specifying Resources by Item Name</H3>
 <A NAME=MARKER-9-65></A>You can also specify help messages in a component with the <CODE>HMNamedResourceItem</CODE> identifier, which causes the Help Manager to use a resource whose name matches the name and state of the current menu item. A menu-item component that uses the <CODE>HMNamedResourceItem</CODE> identifier uses a different format than the other menu-item components do. Here are the two elements you use for specifying named resources as help messages in an <CODE>'hmnu'</CODE> resource. <P>
<OL>
<LI>The <CODE>HMNamedResourceItem</CODE> identifier.
<LI>A resource type (either <CODE>'STR '</CODE>, <CODE>'PICT'</CODE>, or, for text, <CODE>'TEXT'</CODE>) that contains the help messages for the current menu item. If you specify <CODE>'TEXT'</CODE>, you also get style information for the <CODE>'TEXT'</CODE> resource by creating a resource of type <CODE>'styl'</CODE> with the same name.<P>
</OL>
 To provide help for a menu item when it is enabled, create a resource with the same name as the menu item, then put the help message for the enabled menu item in <BR>this resource. The Help Manager uses the <CODE>GetNamedResource</CODE> function to find the resource--of the type specified in the second element of the menu-item component--that has the same name as the current menu item.<A NAME=MARKER-2-55></A><P>
 To provide help for a menu item when it is dim, create a resource with a name consisting of the menu item and an exclamation point (!), then put the help message for the dimmed menu item in this resource. When the menu item is dimmed, the Help Manager appends an exclamation point to the name of the menu item and searches for a resource by that name. Similarly, if a menu item is enabled and marked with a checkmark or other mark, the Help Manager appends the mark to the name of the current menu item and looks for a resource by that name.<A NAME=MARKER-2-269></A><P>
 For example, the <CODE>'hmnu'</CODE> resource in <A HREF=#MARKER-9-217>Listing 3-5</A> specifies that the Help Manager extracts the help message from a resource named <CODE>Red</CODE> of type <CODE>'STR '</CODE> when displaying a help balloon for an enabled menu command named Red. If the menu item is dimmed, the Help Manager gets the <CODE>'STR '</CODE> resource with the name <CODE>Red!</CODE> and uses its text string for the help message. If the Red command could be marked with an asterisk (*), the Help Manager would search for the resource with the name <CODE>Red*</CODE> of type <CODE>'STR '</CODE>.<A NAME=MARKER-2-15></A><P>
<B>Listing 3-5  <A NAME=MARKER-9-217></A>Rez input for specifying help messages with named resources</B><P>
<PRE>
resource 'hmnu' (132, &quot;Colors menu help&quot;, purgeable) {
         /*see Listing 3-2 for header, missing-items, */
         /* menu-title, and menu-item components*/
      HMNamedResourceItem {   /*Red command's help message*/
         'STR '/*use the 'STR ' resource named &quot;Red&quot;*/
      }
   }
};
resource 'STR ' (333, &quot;Red&quot;) {   /*help text for enabled */
                                 /* Red command*/
      &quot;Displays the selected text in red.&quot;
};
resource 'STR ' (334, &quot;Red!&quot;) {  /*help text for dimmed */
                                 /* Red command*/
      &quot;Not available; either you have not selected text to &quot;
      &quot;color, or your monitor does not support color.&quot;,
}; 
</PRE>
<A NAME=HEADING147-132></A>
<H3><A NAME=MARKER-9-218></A>Providing Help Balloons for Menus You Disable for Dialog Boxes</H3>
 <A NAME=MARKER-21-291></A>The Dialog Manager and the Menu Manager interact to provide various degrees of access to the menus in your menu bar. For alert boxes and modal dialog boxes without editable text items, you can simply allow system software to dim your menu titles and menu items as appropriate. As described in <A HREF=#MARKER-9-177>"Specifying Help for Menu Titles and for Items Dimmed by System Software" beginning on page 3-33</A>, you specify help balloons for these dimmed menu titles and menu items in the fourth and fifth elements of your <CODE>'hmnu'</CODE> resources' menu-title components.<P>
 However, because system software cannot handle the Undo or Clear command (or any other context-appropriate command) for you, your application should handle its own menu bar access for modal dialog boxes with editable text items by performing the following tasks:<P>
<UL>
<LI>Use the Menu Manager function <CODE>DisableItem</CODE> to disable the Apple menu or the first item in the Apple menu (typically, your application's About command) in order to take control of its menu bar access when displaying a modal dialog box.
<LI>Use the Menu Manager function <CODE>DisableItem</CODE> to disable all of your application's menus except the Edit menu, as well as any inappropriate commands in the Edit menu.
<LI>Use the Dialog Manager procedures <CODE>DialogCut</CODE>, <CODE>DialogCopy</CODE>, <CODE>DialogPaste</CODE>, and <CODE>DialogDelete</CODE> to support the Cut, Copy, Paste, and Clear commands in editable text items.
<LI>Provide your own code for supporting the Undo command.
<LI>Use the Menu Manager function <CODE>EnableItem</CODE> to enable your application's items in the Help menu as appropriate (system software disables all items except the Hide Balloons/Show Balloons command).<P>
</UL>
 You don't need to do anything else for the system-handled menus--namely, Application, Keyboard, and Help. System software handles these menus for you automatically.<P>
 Although it always leaves the Help, Keyboard, and Application menus and their commands enabled, system software does nothing else to manage the menu bar when you display movable modal and modeless dialog boxes. Instead, your application should allow or deny access to the rest of your menus as appropriate to the context. For example, if your application displays a modeless dialog box for a search-and-replace command, you should allow access to the Edit menu to assist the user with the editable text items, and you should allow use of the File menu so that the user can open another file to be searched. However, you should disable other menus if their commands cannot be used inside the active modeless dialog box.<P>
 When creating a modeless dialog box, your application should perform the following tasks:<P>
<UL>
<LI>Use the Menu Manager function <CODE>DisableItem</CODE> to disable only those menus whose commands are invalid in the current context.
<LI>If the modeless dialog box includes editable text items, use the Dialog Manager procedures <CODE>DialogCut</CODE>, <CODE>DialogCopy</CODE>, <CODE>DialogPaste</CODE>, and <CODE>DialogDelete</CODE> to support the Cut, Copy, Paste, and Clear commands in editable text items.
<LI>Enable your application's items in the Help menu, as appropriate. (System software disables all items except the Hide Balloons/Show Balloons command.)<P>
</UL>
 When your application creates a movable modal dialog box, it should perform the following tasks:<P>
<UL>
<LI>Leave the Apple menu enabled so that the user can open other applications with it.
<LI>If your movable modal dialog box contains editable text items, leave the Edit menu enabled but use the Dialog Manager procedures <CODE>DialogCut</CODE>, <CODE>DialogCopy</CODE>, <CODE>DialogPaste</CODE>, and <CODE>DialogDelete</CODE> to support the Cut, Copy, Paste, and Clear commands.
<LI>Use the Menu Manager function <CODE>DisableItem</CODE> to disable all of your other menus.<P>
</UL>
 See the chapters "Menu Manager" and "Dialog Manager" in <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I> for more information about menus, alert boxes, and dialog boxes.<P>
 When you use the Menu Manager function <CODE>DisableItem</CODE> to dim your menus, the Help Manager does not know that you have dimmed them because you're displaying a dialog box; instead, the Help Manager assumes that you've dimmed them for some other reason. Whenever you dim your own menus--for whatever reason--the Help Manager always uses the second element of your menu-title component and the second elements of your menu-item components. <P>
 To provide help messages that explain that the menu and its items are dim because your application dimmed them to display a dialog box, you must use an alternate <CODE>'hmnu'</CODE> resource. <P>
 For example, if an application were to allow only one document at a time to be opened, it would dim the New command in the File menu whenever a document were open. The second element of that item's component specifies a help message similar to this.<P>
<PRE>
/*help message for dimmed New command*/
&quot;Opens a new SurfWriter document called \&quot;Untitled\&quot;. &quot;
&quot;Not available now because a SurfWriter document is &quot;
&quot;already open. (SurfWriter can open only one document &quot;
&quot;at a time.)&quot;;
</PRE>
 This is not an appropriate message for the item's help balloon when the application displays a modal dialog box that contains an editable text item--but unless the application changes the <CODE>'hmnu'</CODE> resource for its File menu, this is the message that the Help Manager displays.<P>
 To handle those menus that you dim for dialog boxes, your application must use alternate <CODE>'hmnu'</CODE> resources. In an alternate <CODE>'hmnu'</CODE> resource, use the second element of the missing-items component and the second element of the menu-title component to specify help balloons for the menu's dimmed title and all of its dimmed items, as shown in <A HREF=#MARKER-9-220>Listing 3-6</A>.<P>
<B>Listing 3-6  <A NAME=MARKER-9-220></A>Specifying an alternate <CODE>'hmnu'</CODE> resource for a menu that your application disables when it displays movable modal dialog boxes<A NAME=MARKER-2-398></A></B><P>
<PRE>
resource 'hmnu' (kFileHelpID, purgeable) 
{  /*use this when my application dims the menu to display */
   /* a modal dialog box with editable text items*/
   /*header component*/
   HelpMgrVersion, hmDefaultOptions, 0, 0,
   /*missing-items component*/
   HMStringResItem {
      0, 0,          /*missing enabled items: not applicable */
                     /* because they're all dim*/
      256, 1,        /*use this help string for all dimmed */
                     /* menu items--they're all missing from */
                     /* this resource*/
      0, 0,          /*missing enabled-and-checked items: not */
                     /* applicable because they'd be dimmed*/
      0, 0,          /*missing enabled-and-marked items: not */
                     /* applicable because they'd be dimmed*/
   },
   /*menu-title component*/
   {  /*File menu title help when dimmed for a movable modal*/
      HMStringResItem {
         0, 0,          /*no enabled title: it's dimmed*/
         256, 2,        /*use this help string for menu title */
                        /* dimmed for a movable modal dialog*/
         0, 0,          /*Help Manager doesn't look here for */
                        /* movable modal dialogs*/
         0, 0,          /*Help Manager doesn't look here for*/
                        /* movable modal dialogs*/
      },
   }        /*use missing-items info for all dimmed menu items*/
};
resource 'STR#' (256, &quot;help messages for dimmed menus&quot;) {
/*use these when my application dims menus to show a */
/* modal dialog box*/
   {
   /*[1] Dimmed items help text*/
   &quot;Not available now because a dialog box is on &quot;
   &quot;the screen.&quot;.
   /*[2] help message for dimmed File menu title*/
   &quot;File menu\n\nUse this menu to open, close, save, and print &quot;
   &quot;SurfWriter documents, and to quit SurfWriter. &quot;
   &quot;Not available because a dialog box is on the screen.&quot;;
   /*[3] help message for dimmed Tools menu title*/
   &quot;Tools menu\n\nUse this menu to ... &quot; /*more text goes here*/
      &quot;Not available because a dialog box is on the screen.&quot;;
   /*help messages for other dimmed menu titles go here*/
};
</PRE>
 Use the <CODE>HMSetMenuResID</CODE> function to associate alternate <CODE>'hmnu'</CODE> resources with your menus whenever your application displays a movable modal dialog box. <A HREF=#MARKER-9-222>Listing 3-7</A> illustrates how an application disables its menus and then reassigns them appropriately, using alternate <CODE>'hmnu'</CODE> resources before displaying a dialog box.<P>
<B>Listing 3-7  <A NAME=MARKER-9-222></A>Reassigning <CODE>'hmnu'</CODE> resources before displaying a movable modal dialog box</B><P>
<PRE>
PROCEDURE MyAdjustMenusForDialogs;
VAR
   window:     WindowPtr;
   windowType: Integer;
   myErr:      OSErr;
   menu:       MenuHandle;
BEGIN
   window := FrontWindow;
   windowType := MyGetWindowType(window);
   CASE windowType OF
      kMyModalDialogs:
      BEGIN
         menu := GetMenuHandle(mApple);   {get handle to Apple menu}
         IF menu = NIL THEN
            EXIT(MyAdjustMenusForDialogs);
         DisableItem(menu, 0);   {disable Apple menu to get control of menus}
         myErr := HMSetMenuResID(mFile, kFileHelpID); {set up help balloons}
         menu := GetMenuHandle(mFile);       {get handle to File menu}
         IF menu = NIL THEN
            EXIT(MyAdjustMenusForDialogs);
         DisableItem(menu, 0);      {disable File menu}
         myErr := HMSetMenuResID(mFile, kFileHelpID); {set up help balloons}
         IF myErr &lt;&gt; NoErr THEN
            EXIT(MyAdjustMenusForDialogs);
         menu := GetMenuHandle(mTools);   {get handle to Tools menu}
         IF menu = NIL THEN
            EXIT(MyAdjustMenusForDialogs);
         DisableItem(menu, 0);         {disable Tools menu}
         myErr := HMSetMenuResID(mTools, kToolsHelpID);  {help balloons}
         IF myErr &lt;&gt; NoErr THEN
            EXIT(MyAdjustMenusForDialogs);
         MyAdjustEditMenuForModalDialogs;
      END;        {of kMyModalDialogs CASE} 
      kMyGlobalChangesModelessDialog: 
         ;  {adjust menus here as needed}
      kMyMovableModalDialog: 
         ;  {adjust menus here as follows: }
            { diable all menus except Apple, }
            { call MyAdjustEditMenuForModalDialogs for editable text items}
   END; {of CASE}
END;
</PRE>
 The <CODE>MyAdjustMenusForDialogs</CODE> routine in <A HREF=#MARKER-9-222>Listing 3-7</A> first determines what type of dialog box is in front: modal, movable modal, or modeless. For modal dialog boxes, <CODE>MyAdjustMenusForDialogs</CODE> disables the Apple menu so that the application can take control of its menus away from the Dialog Manager. The <CODE>MyAdjustMenusForDialogs</CODE> routine then uses the Menu Manager routines <CODE>GetMenuHandle</CODE> and <CODE>DisableItem</CODE> to disable all other application menus except the Edit menu. <P>
 To adjust the items in the Edit menu, <CODE>MyAdjustMenusForDialogs</CODE> calls another application-defined routine, <CODE>MyAdjustEditMenuForModalDialogs</CODE>. The <CODE>MyAdjustEditMenuForModalDialogs</CODE> routine, which is not shown in this volume, uses application-defined code to implement the Undo command; uses the Menu Manager procedure <CODE>EnableItem</CODE> to enable the Cut, Copy, Paste, and Clear commands when appropriate; and disables the commands that support Edition Manager capabilities.<P>
 After removing a dialog box from the screen, enable the appropriate menus again and use the <CODE>HMSetMenuResID</CODE> function to reassociate your original help balloons with the reenabled menus. (You can pass -1 to the <CODE>HMSetMenuResID</CODE> function to remap menus to their previous <CODE>'hmnu'</CODE> resources.)<A NAME=MARKER-21-142></A><A NAME=MARKER-2-96></A><A NAME=MARKER-2-78></A><A NAME=MARKER-2-170></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-146.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-148.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
