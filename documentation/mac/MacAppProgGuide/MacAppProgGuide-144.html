<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Recipes--Balloon Help (MacApp PG)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING144></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MacAppProgGuide-143.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-145.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MacAppProgGuide-2.html"><B>Programmer's Guide to MacApp</B></A> / <A HREF="MacAppProgGuide-78.html"><B>Part 2 - Working With MacApp</B></A><BR><DD><A HREF="MacAppProgGuide-142.html"><B>Chapter 30 - Working With Balloon Help</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING144-0></A>
<H1><A NAME=MARKER-10-9></A>Recipes--Balloon Help</H1>
 The recipes and sample code in this section demonstrate how to specify Balloon Help for a view, how to change the help resource for a view while your application is running, and how to specify Balloon Help for a menu.<P>
<A NAME=HEADING144-2></A>
<H2><A NAME=MARKER-2-28></A>Recipe--Specifying Balloon Help for a View</H2>
 To specify Balloon Help for a view, you perform these steps:<P>
<OL>
<LI>Add an <CODE>'hdlg'</CODE> resource to your resource definition file.
<LI>Associate the help resource with any view that uses it.<P>
</OL>
 The sample code shown in this recipe is from the DemoDialogs application.<P>
<A NAME=HEADING144-7></A>
<H3>Adding an 'hdlg' Resource to Your Resource Definition File</H3>
 A help balloon resource can contain text, a picture, or both. The format for your help messages can be text strings within help resources, text strings within <CODE>'STR '</CODE> resources, lists of text strings within <CODE>'STR#'</CODE> resources, styled text using <CODE>'TEXT'</CODE> and <CODE>'styl'</CODE> resources, or pictures stored in <CODE>'PICT'</CODE> resources.<P>
 The <CODE>'hdlg'</CODE> resource specifies the window contents and the placement of the balloon. The Help Manager uses this information to calculate the size of the help balloon, insert text line breaks, and locate the balloon onscreen.<P>
<DL>
<DT><B>Note</B>
<DD>The "Help Manager" chapter in <I><A HREF="../MoreToolbox/MoreToolbox-2.html">Inside Macintosh: More Macintosh Toolbox</A></I> refers to the hot rectangle area for a balloon. MacApp does not use the hot rectangle, so unless you call the Help Manager directly, it doesn't matter what value you assign it.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 The following <CODE>'hdlg'</CODE> resource is from the DemoDialogs sample application. This help resource is for the dialog box created when the user chooses "Cursors and Balloons" from the Dialogs menu. The resource has been modified slightly for clarity.<P>
<PRE>
// Balloon Help for views with IDs 'ADN1' and 'ADN2'.
resource 'hdlg' (kAdn1Balloon) 
{
   HelpMgrVersion,
   0,
   hmDefaultOptions,
   0,                   // Balloon definition function.
   5,                   // Variation code.
   HMSkipItem {},       // No missing item help.
   {
      // Text help for view with ID 'ADN1'.
      HMStringItem 
      {
         { -1,0 },      // Tip location.
         { 0,0,0,0 },   // MacApp doesn't use the hot rectangle.
         // Next 4 fields define text for enabled, disabled, checked, and other:
         &quot;Enabled, frame and shadow adornment, plus cursor&quot;,
         &quot;Disabled,frame and shadow adornment, plus cursor&quot;,
         &quot;Checked&quot; ,
         &quot;Other state&quot; 
      },
      // 'PICT' help for view with ID 'ADN2'.
      HMPictItem 
      {
         { -1,0 },      // Tip location.
         { 0,0,0,0 },   // MacApp doesn't use the hot rectangle.
         1000,          // PICT ID for enabled state.
         1000,          // PICT ID for disabled state.
         1000,          // PICT ID for checked state.
         1000,          // PICT ID for any other state.
      },
   }
};
</PRE>
 The resource ID for this <CODE>'hdlg</CODE>' resource is defined as<P>
<PRE>
#define  kAdn1Balloon   128
</PRE>
 The variation code in the balloon definition specifies the placement of the balloon. If the specified variation code would cause all or part of the help balloon to be offscreen, the Help Manager will try other variation codes to attempt to make the balloon fully visible.<P>
 Notice that there are actually four help strings for the view <CODE>'ADN1'</CODE>--one for each possible state of the view or item. MacApp constants are defined for the four states:
<TABLE BORDER="0" CELLPADDING=3><TD><CODE><A NAME=MARKER-9-1></A>kHMEnabledItem</CODE><TD>Indicates the item is enabled.<TR>
<TD><CODE>kHMDisabledItem</CODE><TD>Indicates the item is disabled.<TR>
<TD><CODE>kHMCheckedItem</CODE> <TD>Indicates the item is checked.<TR>
<TD><CODE>kHMOtherItem</CODE><TD>Indicates the item is in a state other than enabled, disabled, or checked.</TABLE>
<P>
 The help resource for the view named <CODE>'ADN2'</CODE> specifies a picture with a <CODE>'PICT'</CODE> resource ID. Again, there are four possible states of the view, but in this case the same picture is used for each state.<P>
<A NAME=HEADING144-18></A>
<H3>Associating the Help Resource With a View</H3>
 MacApp makes it easy to associate a help resource with a view--you can use a view editor to specify the view's help resource by setting two fields of the view:
<TABLE BORDER="0" CELLPADDING=3><TD><CODE>fHelpID</CODE><TD>Set this to the ID of the help resource. A help resource can be used by multiple views.<TR>
<TD><CODE><A NAME=MARKER-2-3></A>fHelpIndex</CODE> <TD>Set this to the index into the help resource for the view. A resource may contain multiple help definitions.</TABLE>
<P>
 When your application reads the <CODE>'View'</CODE> resource and creates a view object from it, the <CODE>fHelpID</CODE> and <CODE>fHelpIndex</CODE> instance variables are assigned the values you specified. (Creating views from resources is described in <A HREF=MacAppProgGuide-101.html#MARKER-9-58>"Specifying Views With View Resource Templates," beginning on page 217</A>.)<P>
 Once you have associated a help resource with a view, MacApp takes care of showing and removing the help balloon at the appropriate time.<A NAME=MARKER-2-29></A><P>
<A NAME=HEADING144-22></A>
<H2><A NAME=MARKER-2-30></A>Recipe--Changing the Help Resource Associated With <BR>a View</H2>
 To change the help resource associated with a view, you modify the values of the two variables described in the previous recipe, <CODE><A NAME=MARKER-2-31></A>fHelpID</CODE> and <CODE>fHelpIndex</CODE>.<P>
 Suppose you have defined the following constants for a help resource definition and the index of a resource within that definition:<P>
<PRE>
const short kSpecialBalloonHelpID = 129;
const short kMySpecialPurposeHelpIndex = 1;
</PRE>
 The <CODE>TView</CODE> class provides accessor methods to get the values of <CODE>fHelpID</CODE> and <CODE>fHelpIndex</CODE>, but not to set them. However, your view objects can set these instance variables directly, as shown in the code fragment below.<P>
 To determine the help state of a view before setting its help resource ID and index, you call the <CODE>TView</CODE> method <CODE>GetHelpState</CODE>. The <CODE>GetHelpState</CODE> method returns one of the four constants described on <A HREF=#MARKER-9-1>page 642</A>: <CODE>kHMEnabledItem</CODE>, <CODE>kHMDisabledItem</CODE>, <CODE>kHMCheckedItem</CODE>, or <CODE>kHMOtherItem</CODE>.<P>
 You can change the help resource for a view with code similar to the following, in a method of your view class:<P>
<PRE>
if (this-&gt;GetHelpState() == kHMEnabledItem)
{
   this-&gt;fHelpID = kSpecialBalloonHelpID;
   this-&gt;fHelpIndex = kMySpecialPurposeHelpIndex;
}
</PRE>
<A NAME=HEADING144-30></A>
<H2><A NAME=MARKER-2-32></A>Recipe--Using Balloon Help With a Menu</H2>
 This recipe depends only on the Help Manager, not on MacApp. Similar code can be used in any application.<P>
 To use Balloon Help with a menu, you perform these steps:<P>
<OL>
<LI>Add an <CODE>'hmnu'</CODE> (Help menu) resource to your resource definition file. The <CODE>'hmnu'</CODE> resource should specify the resource ID of the <CODE>'CMNU'</CODE> or <CODE>'MENU'</CODE> resource it is associated with.
<LI>Provide a <CODE>'STR#'</CODE> resource containing the help strings that are specified in the <CODE>'hmnu'</CODE> resource.<P>
</OL>
 The following excerpts, from an <A NAME=MARKER-2-33></A><CODE>'hmnu'</CODE> resource and a <CODE>'<A NAME=MARKER-2-34></A>STR#'</CODE> resource, are from the file <CODE>DemoDialogs.r</CODE> in the DemoDialogs sample application. Here is the Help menu resource definition for the Dialogs menu:<P>
<PRE>
resource 'hmnu' (mDialogs) 
{
   HelpMgrVersion,
   hmDefaultOptions,
   0, // Balloon definition function.
   0, // Variation code.
   // Missing items.
   HMStringResItem 
   {
      kDialogsMenuHelp,1,
      kDialogsMenuHelp,1,
      kDialogsMenuHelp,1,
      kDialogsMenuHelp,1,
   },
   // Title and items.
   {  
      // Menu title.
      HMStringResItem 
      {
         kDialogsMenuHelp,2,
         kDialogsMenuHelp,2,
         kDialogsMenuHelp,2,
         kDialogsMenuHelp,2,
      },
      // First item in menu: Views by Procedures.
      HMStringResItem 
      {
         kDialogsMenuHelp,3,
         kDialogsMenuHelp,3,
         kDialogsMenuHelp,3,
         kDialogsMenuHelp,3,
      },
      // Second item in menu: Views by Templates.
      HMStringResItem 
      {
         kDialogsMenuHelp,4,
         kDialogsMenuHelp,4,
         kDialogsMenuHelp,4,
         kDialogsMenuHelp,4,
      },
   // Some items not shown.
}
</PRE>
 The following is a string list resource definition for the Help menu items:<P>
<PRE>
resource 'STR#' (kDialogsMenuHelp, purgeable)
{ 
   {
      &quot;No help yet for this item&quot;,
      &quot;Choose the items in this menu to open various example windows&quot;,
      &quot;A window containing a variety of views, created programmatically without
         a 'View' resource.&quot;,
      &quot;A window containing a variety of views, created from a 'View' resource.&quot;,
      // Some items not shown.
   }
};
</PRE>
 The <CODE>'hmnu'</CODE> resource above specifies a menu ID of <CODE>mDialogs</CODE>--the Dialog menu in the DemoDialogs sample program. "Views by Procedures" is the first item in that menu. The following line from the <CODE>'hmnu'</CODE> resource specifies that the help for the "Views by Procedures" item should be retrieved from a string list resource (<CODE>'STR#'</CODE>):<P>
<PRE>
HMStringResItem
</PRE>
 The next four lines specify the string resource and the indexes of the strings in that resource to use when the menu item is enabled, disabled, checked, and in any other state. In this sample, the same string is used in each case:<P>
<PRE>
kDialogsMenuHelp,3,
</PRE>
 For example, if Balloon Help is turned on and a user drags the cursor over the "Views by Procedures" menu choice, the Help Manager will determine that the help to show in the balloon is string number 3 from the <CODE>'STR#'</CODE> resource with ID <CODE>kDialogsMenuHelp</CODE>. The user sees a balloon with the string "A window containing a variety of views, created programmatically without a 'View' resource."<A NAME=MARKER-2-35></A><A NAME=MARKER-2-36></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MacAppProgGuide-143.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-145.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MacAppProgGuide-3.html">&copy; Apple Computer, Inc.</A><br>25 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
