<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!-- Template 01-August-01 --><!-- Includes revisions to graphics tags --><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note FL520: File Manager Overview Q&amp;As</title><meta name="keywords" content="Mac OS 8 File Manager vers desktop accessories HFSDispatch PBHGetVolParms"><meta name="Description" content="Technical Note FL520: This Technical Note contains a collectionof archived Q&amp;As relating to the File Manager--questionssent the Developer Support Center (DSC) along with answersfrom the DSC engineers. Archived Q&amp;As include: The limitson the number of files in a Macintosh Folder; How to determinewhat File Manager calls are available; and Why does System7 get rid of 'vers' resources in the desktop accessorieswhen dropped into the System Folder icon.">                                       <meta name="categories" content="Files"><meta name="week-posted" content="Oct 1, 1990 - Oct 5, 1990"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002467" title="File Manager Overview Q&As"></a><A NAME="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxMacOS9Earlier-date.html">Mac OS 9 & Earlier</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/index.html" target="_blank">Reference Library</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note FL520</div>
<div id="pageheadsub">File Manager Overview Q&amp;As</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext"><A HREF="#Section1">Macintosh folder file limits<BR><BR></a><A HREF="#Section2">Determining which Macintosh File Manager calls are available<BR><BR></a><A HREF="#Section3">System 7.0 DAs and 'vers' resources<BR><BR></a>   <A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id ="introtext">This Technical Note contains a collection of archived Q&amp;As relating to a specific topic--questions sent the Developer Support Center (DSC) along with answers from the DSC engineers. Current Q&amp;As can be found on the <a href="../../qa/index.html">Macintosh Technical Q&amp;As web site</a>.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Oct 01 1990]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR><!-- begin_content --><a name="Section1"></a><h2>Macintosh folder file limits</h2><p>Date Written:  11/9/92</p><p>Last reviewed:  6/14/93</p><p>What (if at all) is the limitation on the number of files in a folder? In otherwords, is there a number N, such that if I have N files in a folder, and I tryto Create file number N+1, I'll get some error?</p><p>___</p><p>In general, the number of files that can be put in an HFS directory isunlimited; there isn't any point at which you'll receive an error from Create,because new file description records can almost always be created. The only wayyou can get a disk full error back from Create is if the catalog file needs togrow to add your new record and the disk is full, but this should be extremelyrare; even when the disk is full, there's generally room to create dozens offiles or folders before the catalog file will need to be enlarged, as it'sgrown in relatively large chunks.</p><p>There are, however, a couple of related limits on large numbers of files.Because HFS allocates space in "allocation blocks," and there can be at most65,536 allocation blocks on a volume, there's a limit of 65,536 files thatcontain data on a volume. If your disk is full with 65,536 one-block files,you'll probably be able to create more files (Create will succeed), but no datawill be able to be written to them. In reality, the limit on the number offiles is somewhat smaller; the catalog and extents files will each occupyspace. Also, because the allocation block size needs to be an even multiple of512 bytes, most volumes won't have a full 65,536 allocation blocks; they'llhave as many as they can, somewhere between 32,767 and 65,536 (except for smallvolumes, which may have less). In addition, each fork (either the data fork orthe resource fork) of a file needs to be separately allocated, so each countsas a file for this calculation.</p><p>There's also a practical limit on how many files can be placed in a folder. HFScan maintain as many files as required in a directory; however, because theindex field is a short, if there are more than 32,767 files in a folder, theycan't be enumerated. Thus, while they can be identified and opened by name,there's no way to index through them to determine what's in the directorywithout deleting or moving some of the files.</p><p>These limit descriptions apply to HFS only; other file systems may be availableon the Macintosh, such as MFS, MS-DOS, ISO 9660, or virtually any file system via an AppleTalk Filing Protocol (AFP) translator. These descriptions also don't include limitations of the Finder, the Standard File Package, or any other intermediaries. The Finder and Standard File are likely to become quite unusable long before you run into the limits of HFS. Also, while HFS will continue to function, it wasn't designed for optimum performance with extremely large numbers of files; for more dire warnings on this subject, see the Macintosh Technical Note "Don't Abuse the Managers."</p><P><A HREF="#top">Back to top</A></P><a name="Section2"></a><h2>Determining which Macintosh File Manager calls are available</h2><p>Date Written:  3/5/92</p><p>Last reviewed:  6/14/93</p><p>Many of the new File Manager calls are just _HFSDispatch with new selectorcodes. How do I check whether a given selector is implemented? An example of anew File manager call is _GetVolParms. Currently I don't check, I just read theresult code. It seems to be OK. How should I interpret the response from Gestalt when called with gestaltFSAttr? As I read it the gestaltFullExtFSDispatching tells me that all the calls are available. Are there times that only a few of them are available? PBHGetVolParams seems to be available at all times anyway. Where do I find more info on the workings of HFSDispatch? In general I would appreciate some more info on the compatibility issue.</p><p>___</p><p>There are two issues. One is that not all versions of the File Manager supportall calls. The other is that even if the File Manager supports the calls,individual volumes may not.</p><p>The first issue is addressed by Gestalt's gestaltFSAttr selector. Prior toSystem 7.0, HFSDispatch supported a fixed range of selectors. The result wasthat some advanced file services were unavailable, even though the volume wouldsupport them. A good example is PBCatSearch. If you mount an AppleShare 3.0 orFileShare volume under System 6 with the AppleShare 3.0 Chooser extension, thevolume will report via PBHGetVolParms that bHasCatSearch is true. But if youtry to make the call, you will get back a paramErr because HFSDispatch doesn'tknow about the CatSearch selector.</p><p>Under System 7.0, the system no longer restricts the range of HFSDispatchselectors. For external file systems, this means it is up to the external filesystem to determine whether or not it can handle the selector and to return anappropriate error if it cannot.</p><p>This is the meaning of the gestaltFullExtFSDispatching flag. If it is true thenthere are no limitations on the range of selectors.</p><p>The second problem is that even though HFSDispatch won't limit the range ofselectors, the volume may still not support the call. To turn my previousexample around, making a PBCatSearch call under System 7.0 to a pre-AppleShare3.0 volume will result in an error because the volume doesn't support the call.</p><p>The best way to determine if a volume supports a feature is to use PBHGetVolParms. This can return most of the information you need about advanced file system calls. Unfortunately, there can be problems, even with that. For example, when the user turns FileSharing on and off, the bHasPersonalAccessPrivileges flag can change. So you can't just test attributes once and assume they never change.</p><p>As far as knowing whether PBHGetVolParms is available, this is not a new call.It is documented in the chapter titled "File Manager Extensions In a SharedEnvironment" in <i>Inside Macintosh</i> Volume V. The way to check for it is tosimply call it and if you get back a paramErr, it is unsupported (IM-V-387).This seems to be what you are doing, so you should be safe.</p><p>So, to summarize, there is no guaranteed way to know if a particular selectorwill work (but it should never crash, just return paramErr). The right sequenceof steps is to first check to see if HFS supports the full range of calls, thencheck for specific features using PBHGetVolParms. And in any event, you shouldalways check for errors and be prepared to take appropriate action. A goodexample of how to do this can be found in the latest (January 1992) version ofthe Technote titled, <u><A HREF = "fl_31.html">"Searching Volumes--Solutions and Problems."</a></u></p><P><A HREF="#top">Back to top</A></P><a name="Section3"></a><h2>System 7.0 DAs and 'vers' resources</h2><p>Date Written:  9/3/91</p><p>Last reviewed:  10/8/91</p><p>Why does System 7 get rid of my 'vers' resources in my desk accessories whendropped into the System Folder icon?</p><p>___</p><p>The System 7 Finder takes over some of the job of the old Font/DA Moverprogram. The Font/DA Mover took great pains to keep all resources owned by theDA together with the driver resource. This is mentioned in the Macintosh Technical Note <u><A HREF = "../tb/tb_20.html">"Shortcut for Owned Resources,"</a></u> as well as in <i>Inside Macintosh</i> Volume I, page 109.</p><p>Under System 7, the 'vers' resource used for Finder information is not owned bythe desk accessory, so when the Finder copies the desk accessory it skips theresources extraneous to the DA--including the 'vers' resource.</p><p>The simplest thing to do is to provide a System 7-ready version of your DA (see<i>Inside Macintosh</i> Volume VI, page 9-32). The Finder will not strip offresources if the file type is already 'dfil' when the DA is dragged to theSystem Folder. You can also provide a version of the DA in a suitcase forSystem 6, or you can instruct System 6 users to hold down the Option key whileclicking Open in Font/DA Mover if they want to install your DA.</p><P><A HREF="#top">Back to top</A></P><P><A NAME=Downloads></A></P>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (48K)</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/fl_520.pdf">Download</A></P>               </TD>            </TR></table><BR><P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/fl/fl_520.html%3Fid%3DDTS10002467-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/fl/fl_520.html%3Fid%3DDTS10002467-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/fl/fl_520.html%3Fid%3DDTS10002467-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --><hr width=500 align=center></BODY></HTML>