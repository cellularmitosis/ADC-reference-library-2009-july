<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="Stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note TN2046: AEStream and Friends</title><meta name="keywords" content="AppleScript Application Apple event events script scripting"><meta name="Description" content="Technical Note TN2046: This technical note discusses variousmethods of using AppleScripts inside of applications."><STYLE TYPE="text/css">#menutext3	{	font-family: helvetica, geneva, arial, sans-serif;	font-size: 10px;	margin-left: 45px;	line-height: 14px;	}H3 {	color: #000000;	font-family: geneva, arial, helvetica, sans-serif;	font-size: 12px;	font-weight: bold;}H4 {	color: #000000;	font-family: geneva, arial, helvetica, sans-serif;	font-size: 9px;	font-weight: bold;}</STYLE><meta name="categories" content="Processes, Interapplication Communication and AppleScript"><meta name="week-posted" content="Mar 25, 2002 - Mar 29, 2002"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10003079" title="AEStream and Friends"></a><A NAME="topofdocument"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/Carbon/index.html">Carbon</a> &gt; <a href="../../technicalnotes/Carbon/idxInterapplicationCommunication-date.html">Interapplication Communication</a> &gt; </p><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TN2046</div>
<div id="pageheadsub">AEStream and Friends</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left">         <!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                        <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc --><p id="menutext"><A HREF="#astrmintro">Introduction</A><BR><A HREF="#atrmtips">AEStream* Tips</A><BR><A HREF="#opcldstream">Opening and Closing an Apple event Stream</A><BR></p><p id="menutext2"><A HREF="#AEStreamOpen">AEStreamOpen</A><BR><A HREF="#AEStreamClose">AEStreamClose</A><BR></p><p id="menutext"><A HREF="#wrtthmdown">Writing Descriptors</A><BR></p><p id="menutext2"><A HREF="#AEStreamWriteAEDesc">AEStreamWriteAEDesc</A><BR><A HREF="#AEStreamWriteDesc">AEStreamWriteDesc</A><BR><A HREF="#AEStreamOpenDesc">AEStreamOpenDesc</A><BR><A HREF="#AEStreamWriteData">AEStreamWriteData</A><BR><A HREF="#AEStreamCloseDesc">AEStreamCloseDesc</A><BR></p><p id="menutext"><A HREF="#wrtnglsts">Writing Lists</A><BR></p><p id="menutext2"><A HREF="#AEStreamOpenList">AEStreamOpenList</A><BR><A HREF="#AEStreamCloseList">AEStreamCloseList</A><BR></p><p id="menutext"><A HREF="#wrtngrecs">Writing Records</A><BR></p><p id="menutext2"><A HREF="#AEStreamOpenRecord">AEStreamOpenRecord</A><BR><A HREF="#AEStreamCloseRecord">AEStreamCloseRecord</A><BR><A HREF="#AEStreamSetRecordType">AEStreamSetRecordType</A><BR><A HREF="#AEStreamWriteKeyDesc">AEStreamWriteKeyDesc</A><BR><A HREF="#AEStreamOpenKeyDesc">AEStreamOpenKeyDesc</A><BR><A HREF="#AEStreamWriteKey">AEStreamWriteKey</A><BR></p><p id="menutext"><A HREF="#wrtngevents">Writing Apple Event Records</A><BR></p><p id="menutext2"><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A><BR><A HREF="#AEStreamCreateEvent">AEStreamCreateEvent</A><BR><A HREF="#AEStreamOptionalParam">AEStreamOptionalParam</A><BR></p><p id="menutext"><A HREF="#doenleoads">Downloadables</A><BR></p>                   <!-- end_toc -->                  </td>                </tr>                 <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left>            <!-- begin_intro_text --><p id="introtext">This Technote describes the <CODE>AEStream*</CODE> collection ofAPIs that can be used to construct Apple event records and Apple eventdescriptors using stream oriented calling conventions.  These APIs allow you to useinteresting and easy to maintain stream oriented algorithms forcreating complex Apple event descriptor records.</P><p id="introtext">The <CODE>AEStream*</CODE> routines are not intended to bea replacement for the other documented Apple Event Manager APIs.  Rather, they supplementthe other APIs and accomodate different styles of programming.  Together withthe other collection of Apple Event Manager APIs, the <CODE>AEStream*</CODE> routines make it simplerto create Apple event descriptor records in a wider variety of algorithms.</P><p id="introtext">This Note is directed at application developers interested in using streamoriented algorithms for constructing complex Apple event descriptors.</P><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Mar 29 2002]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content -->     <A NAME="astrmintro" x-level=1 x-title="Introduction"></A><H2>Introduction</H2><P>The <CODE>AEStream*</CODE> routines allow you to append data to Apple event descriptorrecords in a way that is similar to opening and writing data to a file.Once an <CODE>AEStreamRef</CODE> has been opened, callers can append informationto the stream using <CODE>AEStream</CODE>* routines describing the resultingdescriptor that should be created.  The commands sent to the stream are savedin the <CODE>AEStreamRef</CODE> but they are not actually combined tocreate a descriptor record until the <CODE>AEStreamRef</CODE> is closed.</p><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td align="left"><P><B><A NAME="simplecreate" kind = "Listing">Listing 1</A>.</B> An example illustratinghow to make a simple descriptor.</P></TD></TR><TR><td bgcolor="#E6E6E6" align=left><pre>    AEStreamRef ref;    char* p = "Hello World";        /* open the stream */    ref = <A HREF="#AEStreamOpen">AEStreamOpen</A>();    if (ref != NULL) {            /* save a descriptor to the stream */        err = <A HREF="#AEStreamWriteDesc">AEStreamWriteDesc</A>( ref, typeChar, p, strlen(p));        if (err == noErr) {                /* close the stream gathering the contents                into theNewDesc, a new descriptor */            <A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A> theNewDesc;            err = <A HREF="#AEStreamClose">AEStreamClose</A>( ref, &theNewDesc);            if (err == noErr) {                /* here we would use the new descriptor                for some purpose */                    /* dispose of the descriptor once we're                    finished with it. */                <A HREF="http://developer.apple.com/documentation/mac/IAC/IAC-176.html">AEDisposeDesc</A>(&theNewDesc);            }        } else {                /* if an error occurred creating the descriptor,                close the stream and discard the result. */            <A HREF="#AEStreamClose">AEStreamClose</A>( ref, NULL);        }    }</pre></TD></TR></TABLE></CENTER><BR><BR><p>In the simplest case, an <CODE>AEStreamRef</CODE> can be used to create simpledescriptor records as shown in <A HREF="#simplecreate">Listing 1</A>.  But, going bythis sample, it's not obvious that there is any advantage to using the <CODE>AEStream*</CODE> callsrather than using a simple call to <CODE><A HREF="http://developer.apple.com/documentation/mac/IAC/IAC-209.html">AECreateDesc</A></CODE> as shown in <A HREF="#listingtwo">Listing 2</A>.And, it is true, in this particular case, there is no particular advantage to usingthe <CODE>AEStream*</CODE> calls.  However, in some similar circumstances the <CODE>AEStream*</CODE> calls mayprove to be a better choice than simply calling <CODE><A HREF="http://developer.apple.com/documentation/mac/IAC/IAC-209.html">AECreateDesc</A></CODE>.</p><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td align="left"><P><B><A NAME="listingtwo" kind = "Listing">Listing 2</A>.</B> An example illustratinghow to make a simple descriptor using <CODE><A HREF="http://developer.apple.com/documentation/mac/IAC/IAC-209.html">AECreateDesc</A></CODE>.</P></TD></TR><TR><td bgcolor="#E6E6E6" align=left><pre>    char* p = "Hello World";    err = <A HREF="http://developer.apple.com/documentation/mac/IAC/IAC-209.html">AECreateDesc</A>(typeChar, p, strlen(p), &textDesc);</pre></TD></TR></TABLE></CENTER><BR><BR>                    <p>Say, for example, the contents of the descriptor record are complex and cannot be determined all at once, but you would like to accumulate that datain sequence as the contents of the descriptor record.  To create such a descriptorusing <CODE><A HREF="http://developer.apple.com/documentation/mac/IAC/IAC-209.html">AECreateDesc</A></CODE>, you would have to accumulate the data yourself, collect itinto a large contiguous block of memory, and then copy the data to a descriptorby calling <CODE><A HREF="http://developer.apple.com/documentation/mac/IAC/IAC-209.html">AECreateDesc</A></CODE>.  However, the <CODE>AEStream*</CODE> routines provide facilitiesfor performing these operations without having to maintain any additional housekeeping information.  As shown in <A HREF="#listingthree">Listing 3</A>, repeatedcalls to the <CODE><A HREF="#AEStreamWriteData">AEStreamWriteData</A></CODE> routine can be used to build-up the contents ofa descriptor record.  Also, when calling <CODE><A HREF="#AEStreamWriteData">AEStreamWriteData</A></CODE>, there is no need to specify allof the information that will be included in the descriptor at the same time (itcould be collected across a number of calls in many different routines, for example).</p><A NAME="AddTextDesc"></A><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td align="left"><P><B><A NAME="listingthree" kind = "Listing">Listing 3</A>.</B> An example illustrating how to build a simple descriptor, one letter at a time.</P></TD></TR><TR><td bgcolor="#E6E6E6" align=left><pre>    /* AddTextDesc adds a text descriptor containing the    text in the string pointed to by theText to an AEStreamRef.    It adds the text one character at a time illustrate how the    AEStream* routines can be used to build up the data contents    of descriptors incrementally. */<a href="../../qa/ov/ov02.html">OSStatus</A> AddTextDesc(AEStreamRef ref, char* theText) {    char* p;    <a href="../../qa/ov/ov02.html">OSStatus</A> err;        /* start a descriptor of type text */    err = <A HREF="#AEStreamOpenDesc">AEStreamOpenDesc</A>( ref, typeChar);    if (err == noErr) {            /* add the string to the descriptor,            one letter at a time */        for (p=theText; *p; p++) {                /* write a single character */            err = <A HREF="#AEStreamWriteData">AEStreamWriteData</A>( ref, p, 1);            if (err != noErr) break;        }        if (err == noErr) {                /* mark the end of the descriptor */            err = <A HREF="#AEStreamCloseDesc">AEStreamCloseDesc</A>(AEStreamRef ref);        }    }    return err;}....    AEStreamRef ref;    ref = <A HREF="#AEStreamOpen">AEStreamOpen</A>();    if (ref != NULL) {            /* call our AddTextDesc to add a text descriptor to            the AEStreamRef */        err = AddTextDesc(ref, "Hello World");        if (err == noErr) {            <A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A> theNewDesc;                /* close the stream gathering the contents                into theNewDesc, a new descriptor */            err = <A HREF="#AEStreamClose">AEStreamClose</A>( ref, &theNewDesc);            if (err == noErr) {                /* here we would use the new descriptor                for some purpose */                    /* dispose of the descriptor once we're                    finished with it. */                <A HREF="http://developer.apple.com/documentation/mac/IAC/IAC-176.html">AEDisposeDesc</A>(&theNewDesc);            }        } else {                /* if an error occurred creating the descriptor,                close the stream and discard the result. */            <A HREF="#AEStreamClose">AEStreamClose</A>( ref, NULL);        }    }</pre></TD></TR></TABLE></CENTER><BR><BR><p>In the implementation of some algorithms, it may make more sense to incrementallybuild a descriptor record using techiques similar to those used in<A HREF="#listingthree">Listing 3</A>.  Similarly, you may use the <CODE>AEStream*</CODE> routinesto incrementally build <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDescList.html">AEDescList</A></CODE> structures and <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE>structures.  For instance, to build a list <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDescList.html">AEDescList</A></CODE>, we simply bracketa sequence of calls writing individual descriptors with calls to <CODE><A HREF="#AEStreamOpenList">AEStreamOpenList</A></CODE>and <CODE><A HREF="#AEStreamCloseList">AEStreamCloseList</A></CODE>.  The <CODE>AddAListOfStrings</CODE> routine defined in <A HREF="#listingfour">Listing 4</A> shows an example of how to use these routinesto create a simple list of text descriptors.  And, as one may expect, it is perfectlyacceptable to nest calls to <CODE><A HREF="#AEStreamOpenList">AEStreamOpenList</A></CODE> and <CODE><A HREF="#AEStreamCloseList">AEStreamCloseList</A></CODE>to create lists inside of lists.</p><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td align="left"><P><B><A NAME="listingfour" kind = "Listing">Listing 4</A>.</B> An example illustratinghow to make a complex descriptor containing a list of strings.</P></TD></TR><TR><td bgcolor="#E6E6E6" align=left><pre>    /* AddAListOfStrings appends a single <A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDescList.html">AEDescList</A> structure to    the AEStreamRef containing a list of n descriptors of typeChar    built using the array of string pointers provided in the strings    parameter. */<a href="../../qa/ov/ov02.html">OSStatus</A> AddAListOfStrings(AEStreamRef ref, char** strings, long n) {    <a href="../../qa/ov/ov02.html">OSStatus</A> err;    long i;            /* start collecting items into a list */    err = <A HREF="#AEStreamOpenList">AEStreamOpenList</A>(ref);    if (err == noErr) {            /* add all of our strings to the list            using the <A HREF="#AddTextDesc">AddTextDesc</A> routine defined in            <A HREF="#listingthree">Listing 3</A> */        for (i=0; i&lt;n; i++) {            err = <A HREF="#AddTextDesc">AddTextDesc</A>(ref, strings[i]);            if (err != noErr) break;        }            /* close the list */        if (err == noErr) {            err = <A HREF="#AEStreamCloseList">AEStreamCloseList</A>(ref);        }    }    return err;}        /* a list of strings we will use to create our        descriptor list */    char* gStringList[] = {        "Hello World",        "Apple events",        "AEStream*",        "one last string"    };    AEStreamRef ref;    long i;    <a href="../../qa/ov/ov02.html">OSStatus</A> err;        /* open a stream */    ref = <A HREF="#AEStreamOpen">AEStreamOpen</A>();    if (ref != NULL) {            /* add a descriptor containing list of strings to            the AEStream */        err = AddAListOfStrings(ref, gStringList,                           sizeof(gStringList)/sizeof(char*));            /* close the AEStream, saving the new            descriptor if no errors occurred */        if (err == noErr) {            <A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A> theNewDesc;                /* close the stream gathering the contents                into theNewDesc, a new descriptor */            err = <A HREF="#AEStreamClose">AEStreamClose</A>( ref, &theNewDesc);            if (err == noErr) {                /* here we would use the new descriptor                for some purpose */                    /* dispose of the descriptor once we're                    finished with it. */                <A HREF="http://developer.apple.com/documentation/mac/IAC/IAC-176.html">AEDisposeDesc</A>(&theNewDesc);            }        } else {                /* if an error occurred creating the descriptor,                close the stream and discard the result. */            <A HREF="#AEStreamClose">AEStreamClose</A>( ref, NULL);        }    }</pre></TD></TR></TABLE></CENTER><BR><BR><p>Similar techniques can be used to construct complex <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE>s andto add parameters to Apple event records.  For the most part, adding descriptorsto records and parameters to Apple events proceeds in a similar fashion to creatinga <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDescList.html">AEDescList</A></CODE>; however, the <CODE>AEStream*</CODE> routines have additional provisions that allowyou to specify record types and keywords associated with descriptors in records.Routines for creating records and adding elements to them are presented laterin this document.</p><P><A HREF="#topofdocument">Back to top</A></P><BR><BR><A NAME="atrmtips" x-level=1 x-title="AEStream* Tips"></A><H2>AEStream* Tips</H2><p>Here are some key points to remember when using the <CODE>AEStream*</CODE> routines:</p><UL><LI>You create exactly one descriptor record between calls to <CODE><A HREF="#AEStreamOpen">AEStreamOpen</A></CODE>and <CODE><A HREF="#AEStreamClose">AEStreamClose</A></CODE>.  Don't expect <CODE>AEStream*</CODE> to automatically create a listfor you if you write more than one descriptor between <CODE><A HREF="#AEStreamOpen">AEStreamOpen</A></CODE> and <CODE><A HREF="#AEStreamClose">AEStreamClose</A></CODE>.If you want to create a list, then add the descriptors between calls to<CODE><A HREF="#AEStreamOpenList">AEStreamOpenList</A></CODE> and <CODE><A HREF="#AEStreamCloseList">AEStreamCloseList</A></CODE>.<BR><BR></LI><LI>Be careful to balance all of your calls.  For every call to <CODE><A HREF="#AEStreamOpenDesc">AEStreamOpenDesc</A></CODE> there must be a call to <CODE><A HREF="#AEStreamCloseDesc">AEStreamCloseDesc</A></CODE>, for every <CODE><A HREF="#AEStreamOpenList">AEStreamOpenList</A></CODE> call theremust be a corresponding <CODE><A HREF="#AEStreamCloseList">AEStreamCloseList</A></CODE> call, and so on.  As shown in the outlineprovided in <A HREF="#stsketch">Listing 5</A>, it is possible make complex calling sequences to the<CODE>AEStream*</CODE> routines to create complex nested structures.<BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td align="left"><P><B><A NAME="stsketch" kind = "Listing">Listing 5</A>.</B> An outline of a calling sequenceillustrating how calls to <CODE>AEStream*</CODE> can be nested to create a complex Apple event descriptor.</P></TD></TR><TR><td bgcolor="#E6E6E6" align=left><pre>open a stream   begin a list      write a descriptor      write a descriptor      open a descriptor         write some data         write some data         write some data         write some data      close the descriptor      open a record         set the record type         write a key/descriptor pair         write a key/descriptor pair      close the record      begin a list         write a descriptor         write a descriptor         open a record            set the record type            write a key/descriptor pair            write a key/descriptor pair         close the record      end a list      write a descriptor   end a listclose the stream -&gt; a new descriptor</pre></TD></TR></TABLE></CENTER><BR><BR>The <CODE>AEStream*</CODE> routines maintain state information that tracksthe nesting of calls made to the library.  This is necessary for its own operation, but it alsouses this information to report errors.  If your calls to the library are not balanced properly,<CODE><A HREF="#AEStreamClose">AEStreamClose</A></CODE> will return an <CODE>errAEStreamBadNesting</CODE> error when youtry to close the <CODE>AEStreamRef</CODE>.<BR><BR></LI><LI>Weigh other alternatives.  Ask: will your code be simpler, more clear, and easier to maintainif you use the original Apple Event Manager routines such as <CODE><A HREF="http://developer.apple.com/documentation/mac/IAC/IAC-209.html">AECreateDesc</A></CODE> or the AEBuild* routines(see Technical Note <A HREF="tn2045.html">TN2045</A>) instead of the <CODE>AEStream*</CODE>routines?  Using the <CODE>AEStream*</CODE>routines may improve the clarity of some implementations, but for others the <CODE>AEStream*</CODE> routines may not be thebest choice.<BR><BR></LI><LI>Be sure to dispose of the descriptor record created by <CODE><A HREF="#AEStreamClose">AEStreamClose</A></CODE>.  It isyour application's responsibility to dispose of the <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> recordonce it has finished using it.<BR><BR></LI></UL><P><A HREF="#topofdocument">Back to top</A></P><BR><BR><A NAME="opcldstream" x-level=1 x-title="Opening and Closing an Apple event Stream"></A><H2>Opening and Closing an Apple event Stream</H2><P>There are three routines that allow you to create and open a new<CODE>AEStreamRef</CODE> for collecting commands that will be used to create a newdescriptor record when <CODE><A HREF="#AEStreamClose">AEStreamClose</A></CODE> is called.  <CODE>AEStreamOpen</CODE> should be usedfor creating records of type <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE>, <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDescList.html">AEDescList</A></CODE>, and <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE>.  Theroutine <CODE><A HREF="#AEStreamCreateEvent">AEStreamCreateEvent</A></CODE> can be used to create new <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A></CODE> recordsand the routine <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE> can be used to open anexisting <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A></CODE> record so you can add parameters to it.  No matter which routineyou choose to open an <CODE>AEStreamRef</CODE>, you must call <CODE>AEStreamClose</CODE> to close thestream and collect all of the commands issued to the <CODE>AEStreamRef</CODE> into the resultingdescriptor record.</P><A NAME="AEStreamOpen" x-level=2 x-title="AEStreamOpen"></A><H3>AEStreamOpen</H3><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>AEStreamRef AEStreamOpen(void);</pre><P><B>Result:</B><BR>An <CODE>AEStreamRef</CODE> or, if an error occurs, thevalue <CODE>NULL</CODE>.</P></TD></TR></TABLE></CENTER><BR><BR>                 <P><CODE>AEStreamOpen</CODE> opens a new <CODE>AEStreamRef</CODE> that you can use forcollecting commands describing an Apple event descriptor record.  Once you haveopened an <CODE>AEStreamRef</CODE> you can call the other <CODE>AEStream*</CODE> routines to describethe format of the descriptor record you would like to create.  The example providedin <A HREF="#simplecreate">Listing 1</A> shows how you would call this routine. </P><P><A HREF="#topofdocument">Back to top</A></P><BR><BR><A NAME="AEStreamClose" x-level=2 x-title="AEStreamClose"></A><H3>AEStreamClose</H3><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre><a href="../../qa/ov/ov02.html">OSStatus</A> AEStreamClose(    AEStreamRef ref,    <A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A>* desc);</pre><P><B>Parameters:</B></P><UL> <LI><CODE>ref</CODE> - An <CODE>AEStreamRef</CODE> created by either <CODE><A HREF="#AEStreamOpen">AEStreamOpen</A></CODE>, <CODE><A HREF="#AEStreamCreateEvent">AEStreamCreateEvent</A></CODE> or <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE>.<BR><BR></LI> <LI><CODE>desc</CODE> - either a pointer to <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> record where the sequence of items written to the <CODE>AEStreamRef</CODE> should be saved or the value <CODE>NULL</CODE>.    If this parameter is set to NULL, then <CODE>AEStreamClose</CODE> will discard the result and dispose of the <CODE>AEStreamRef</CODE> (no matter what state it is in).<BR><BR></LI></UL><P><B>Result:</B><BR>A numeric result code indicating the success of the call. A value of <CODE>noErr</CODE>(zero) means the call succeeded.</P></TD></TR></TABLE></CENTER><BR><BR><P><CODE><A HREF="#AEStreamClose">AEStreamClose</A></CODE> closes and deallocates an <CODE>AEStreamRef</CODE> created by calling one ofthe routines <CODE><A HREF="#AEStreamOpen">AEStreamOpen</A></CODE>, <CODE><A HREF="#AEStreamCreateEvent">AEStreamCreateEvent</A></CODE> or<CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE>.  If a pointer to a descriptor is provided in thesecond parameter, then the resulting descriptor record will be stored in thatlocation.  If the <CODE>AEStreamRef</CODE> was created by <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE>or <CODE><A HREF="#AEStreamCreateEvent">AEStreamCreateEvent</A></CODE>, then the resulting descriptor will contain a completeApple event.</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>Note:</B><BR>It is the calling application's responsibility to dispose of the descriptor recordreturned by <CODE><A HREF="#AEStreamClose">AEStreamClose</A></CODE>.  Once you are finished with the descriptorrecord, you should dispose of it by calling <CODE><A HREF="http://developer.apple.com/documentation/mac/IAC/IAC-176.html">AEDisposeDesc</A></CODE>.</P></TD></TR></TABLE></CENTER><BR><BR><P>Providing a <CODE>NULL</CODE> pointer in the <CODE>desc</CODE> parameter instructs<CODE><A HREF="#AEStreamClose">AEStreamClose</A></CODE> to discard the result and dispose of the <CODE>AEStreamRef</CODE> (no matter whatstate it is in).  When you call <CODE><A HREF="#AEStreamClose">AEStreamClose</A></CODE> in this way, you do not need to worry aboutbalancing nested calls to <CODE>AEStream*</CODE> (such as, for example, <CODE><A HREF="#AEStreamOpenList">AEStreamOpenList</A></CODE> and <CODE><A HREF="#AEStreamCloseList">AEStreamCloseList</A></CODE>).This can be particularly useful in error handling situations when you would like todispose of the <CODE>AEStreamRef</CODE>, but you do not necessarily know anything about what stateit is in.</P><P>All nested sequences of calls must be appropriately balanced before <CODE><A HREF="#AEStreamClose">AEStreamClose</A></CODE>is called.  That is to say, every <CODE><A HREF="#AEStreamOpenList">AEStreamOpenList</A></CODE> call must have a corresponding<CODE><A HREF="#AEStreamCloseList">AEStreamCloseList</A></CODE> call, every <CODE><A HREF="#AEStreamOpenRecord">AEStreamOpenRecord</A></CODE> call must have a corresponding<CODE><A HREF="#AEStreamCloseRecord">AEStreamCloseRecord</A></CODE> call, and so on.  Calling <CODE><A HREF="#AEStreamClose">AEStreamClose</A></CODE> to close an <CODE>AEStreamRef</CODE>after nested calls have not been balanced properly will result in a <CODE>errAEStreamBadNesting</CODE>error.  The example listing in <A HREF="#simplecreate">Listing 1</A> illustrates how to call<CODE><A HREF="#AEStreamClose">AEStreamClose</A></CODE> to obtain the resulting descriptor record and how to call<CODE><A HREF="#AEStreamClose">AEStreamClose</A></CODE> discarding the result after an error has occurred.</P><P>In the case where <CODE><A HREF="#AEStreamClose">AEStreamClose</A></CODE> fails and returns an error, the <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE>record pointed to by the <CODE>desc</CODE> parameter will be set to a descriptor of <CODE>typeNull</CODE>.  Because of this, it is always safe to call <CODE><A HREF="http://developer.apple.com/documentation/mac/IAC/IAC-176.html">AEDisposeDesc</A></CODE>on the descriptor record returned by <CODE><A HREF="#AEStreamClose">AEStreamClose</A></CODE> no matter what result codeis returned.</P><P><A HREF="#topofdocument">Back to top</A></P><BR><BR><A NAME="wrtthmdown" x-level=1 x-title="Writing Descriptors"></A><H2>Writing Descriptors</H2><P>The <CODE>AEStream*</CODE> routines include three different facilities that allow youto add individual descriptor records to an <CODE>AEStreamRef</CODE>.<OL TYPE="1" START="0"><LI><CODE><A HREF="#AEStreamWriteAEDesc">AEStreamWriteAEDesc</A></CODE>, allows you to write a pre-built <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE>record (of any format) to an <CODE>AEStreamRef</CODE>.  This allows you to take pre-assembleddescriptors and build them into complex descriptor structures in much the sameway as you would use constants in any program.<BR><BR></LI><LI><CODE><A HREF="#AEStreamWriteDesc">AEStreamWriteDesc</A></CODE> lets you provide a data buffer and a <CODE>typeCode</CODE>that will be used to create the descriptor.<BR><BR></LI><LI>The <CODE><A HREF="#AEStreamOpenDesc">AEStreamOpenDesc</A></CODE>, <CODE><A HREF="#AEStreamWriteData">AEStreamWriteData</A></CODE>, and<CODE><A HREF="#AEStreamCloseDesc">AEStreamCloseDesc</A></CODE> calls allow you to create a descriptor recordby building up the data it contains incrementally.  All of the data providedacross multiple calls to <CODE><A HREF="#AEStreamWriteData">AEStreamWriteData</A></CODE> is combinedwhen the resulting descriptor record is created.  The example shown in<A HREF="#listingthree">Listing 3</A> shows how to use these three callsto build a descriptor record incrementally.<BR><BR></LI></OL><P>These routines are described in this section.  Keep in mind that all of these routines can be used to create individual descriptor records (<CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> records).  These same routines are used for adding descriptor records to <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDescList.html">AEDescList</A></CODE> and <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE> structures, but to do so calls to these routines must be bracketed by calls to <CODE><A HREF="#AEStreamOpenList">AEStreamOpenList</A></CODE>/<CODE><A HREF="#AEStreamCloseList">AEStreamCloseList</A></CODE>and <CODE><A HREF="#AEStreamOpenRecord">AEStreamOpenRecord</A></CODE>/<CODE><A HREF="#AEStreamCloseRecord">AEStreamCloseRecord</A></CODE>, respectively.  </P><A NAME="AEStreamWriteAEDesc" x-level=2 x-title="AEStreamWriteAEDesc"></A><H3>AEStreamWriteAEDesc</H3><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre><a href="../../qa/ov/ov02.html">OSStatus</A> AEStreamWriteAEDesc(    AEStreamRef ref,    const <A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A> *desc);</pre><P><B>Parameters:</B></P><UL> <LI><CODE>ref</CODE> - An <CODE>AEStreamRef</CODE> created by either <CODE><A HREF="#AEStreamOpen">AEStreamOpen</A></CODE>, <CODE><A HREF="#AEStreamCreateEvent">AEStreamCreateEvent</A></CODE> or <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE>.<BR><BR></LI>  <LI><CODE>desc</CODE> - a pointer to an <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> record that should be copied into the <CODE>AEStreamRef</CODE>.  <CODE>AEStreamWriteAEDesc</CODE> copies the <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> immediately so there is no need to retain this storage after calling <CODE>AEStreamWriteAEDesc</CODE>. <BR><BR></LI> </UL><P><B>Result:</B><BR>A numeric result code indicating the success of the call. A value of <CODE>noErr</CODE>(zero) means the call succeeded.</P></TD></TR></TABLE></CENTER><BR><BR><P><CODE><A HREF="#AEStreamWriteAEDesc">AEStreamWriteAEDesc</A></CODE> copies an entire existing Apple event descriptor record to the <CODE>AEStreamRef</CODE>.</P>  <P>This routine useful in cases where you have a pre-assembleddescriptor record that you would like to use in the descriptor you are creating.  Forexample, say you have a complex object specifier record that could be costly to createevery time you build a descriptor, but you would like to add it to many differentdescriptor records.  In this case, it would be more efficient to create the objectspecifier record at program start up time and then use it, much like a constant, again andagain, in calls to <CODE><A HREF="#AEStreamWriteAEDesc">AEStreamWriteAEDesc</A></CODE>.</P><P><A HREF="#topofdocument">Back to top</A></P><BR><BR><A NAME="AEStreamWriteDesc" x-level=2 x-title="AEStreamWriteDesc"></A><H3>AEStreamWriteDesc</H3><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre><a href="../../qa/ov/ov02.html">OSStatus</A> AEStreamWriteDesc(    AEStreamRef ref,    <A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/DescType.html">DescType</A> newType,    const void* data,    Size length);</pre><P><B>Parameters:</B></P><UL> <LI><CODE>ref</CODE> - An <CODE>AEStreamRef</CODE> created by either <CODE><A HREF="#AEStreamOpen">AEStreamOpen</A></CODE>, <CODE><A HREF="#AEStreamCreateEvent">AEStreamCreateEvent</A></CODE> or <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE>.<BR><BR></LI> <LI><CODE>newType</CODE> - A type code for the new <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> being copied to the <CODE>AEStreamRef</CODE>.<BR><BR></LI> <LI><CODE>data</CODE> - A pointer to a block of memory containing <CODE>length</CODE> bytes of data that will be used in the new <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> being copied to the <CODE>AEStreamRef</CODE>. <CODE>AEStreamWriteDesc</CODE> copies the data immediately so you do not need to retain this memory after calling <CODE><A HREF="#AEStreamWriteDesc">AEStreamWriteDesc</A></CODE>.<BR><BR></LI> <LI><CODE>length</CODE> - The number of bytes pointed to by the data parameter.<BR><BR></LI></UL><P><B>Result:</B><BR>A numeric result code indicating the success of the call. A value of <CODE>noErr</CODE>(zero) means the call succeeded.</P></TD></TR></TABLE></CENTER><BR><BR>                  <P><CODE><A HREF="#AEStreamWriteDesc">AEStreamWriteDesc</A></CODE> allows you to provide a <CODE>typeCode</CODE> and a databuffer that will be used to create a descriptor record.  With this routine, you mustprovide all of the data that will be used in the descriptor record all at once.  If youwould like to provide the data incrementally, then you should use the<CODE>AEStreamOpenDesc</CODE>, <CODE>AEStreamWriteData</CODE>,and <CODE><A HREF="#AEStreamCloseDesc">AEStreamCloseDesc</A></CODE> calls (described next).</P><P><A HREF="#topofdocument">Back to top</A></P><BR><BR><A NAME="AEStreamOpenDesc" x-level=2 x-title="AEStreamOpenDesc"></A><H3>AEStreamOpenDesc</H3><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre><a href="../../qa/ov/ov02.html">OSStatus</A> AEStreamOpenDesc(    AEStreamRef ref,    <A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/DescType.html">DescType</A> newType);</pre><P><B>Parameters:</B></P><UL> <LI><CODE>ref</CODE> - An <CODE>AEStreamRef</CODE> created by either <CODE><A HREF="#AEStreamOpen">AEStreamOpen</A></CODE>, <CODE><A HREF="#AEStreamCreateEvent">AEStreamCreateEvent</A></CODE> or <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE>.<BR><BR></LI> <LI><CODE>newType</CODE> - A type code for the new <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> being copied to the <CODE>AEStreamRef</CODE>.<BR><BR></LI></UL><P><B>Result:</B><BR>A numeric result code indicating the success of the call. A value of <CODE>noErr</CODE>(zero) means the call succeeded.</P></TD></TR></TABLE></CENTER><BR><BR><P>Calling <CODE>AEStreamOpenDesc</CODE> marks the beginning of a sequence of zero or morecalls to <CODE>AEStreamWriteData</CODE>.  All of the calls to <CODE>AEStreamWriteData</CODE> made betweencalls to <CODE><A HREF="#AEStreamOpenDesc">AEStreamOpenDesc</A></CODE> and <CODE><A HREF="#AEStreamCloseDesc">AEStreamCloseDesc</A></CODE> will be combined to create a descriptorwith the <CODE>typeCode</CODE> specified in the call to <CODE><A HREF="#AEStreamOpenDesc">AEStreamOpenDesc</A></CODE>.  A call to<CODE><A HREF="#AEStreamOpenDesc">AEStreamOpenDesc</A></CODE> may be followed by any number of calls <CODE>AEStreamWriteData</CODE> andmust be balanced with a call to <CODE><A HREF="#AEStreamCloseDesc">AEStreamCloseDesc</A></CODE>.</P><P><A HREF="#topofdocument">Back to top</A></P><BR><BR><A NAME="AEStreamWriteData" x-level=2 x-title="AEStreamWriteData"></A><H3>AEStreamWriteData</H3><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre><a href="../../qa/ov/ov02.html">OSStatus</A> AEStreamWriteData(    AEStreamRef ref,    const void* data,    Size length);</pre><P><B>Parameters:</B></P><UL> <LI><CODE>ref</CODE> - An <CODE>AEStreamRef</CODE> created by either <CODE><A HREF="#AEStreamOpen">AEStreamOpen</A></CODE>, <CODE><A HREF="#AEStreamCreateEvent">AEStreamCreateEvent</A></CODE> or <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE>. <CODE><A HREF="#AEStreamOpenDesc">AEStreamOpenDesc</A></CODE> or <CODE><A HREF="#AEStreamOpenKeyDesc">AEStreamOpenKeyDesc</A></CODE> must have been called on this <CODE>AEStreamRef</CODE> prior to calling <CODE>AEStreamWriteData</CODE>.<BR><BR></LI> <LI><CODE>data</CODE> - A pointer to a block of memory containing <CODE>length</CODE> bytes of data that will be used in the new <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> being copied to the <CODE>AEStreamRef</CODE>. <CODE>AEStreamWriteData</CODE> copies the data immediately so you do not need to retain this memory after calling <CODE><A HREF="#AEStreamWriteData">AEStreamWriteData</A></CODE>.<BR><BR></LI> <LI><CODE>length</CODE> - The number of bytes pointed to by the data parameter.<BR><BR></LI></UL><P><B>Result:</B><BR>A numeric result code indicating the success of the call. A value of <CODE>noErr</CODE>(zero) means the call succeeded. </P></TD></TR></TABLE></CENTER><BR><BR><P><CODE><A HREF="#AEStreamWriteData">AEStreamWriteData</A></CODE> appends data to the current descriptor record being definedin the <CODE>AEStreamRef</CODE>.  You can call this routine any number of times to buildup the data contents of a descriptor record incrementally.  Calls to <CODE><A HREF="#AEStreamWriteData">AEStreamWriteData</A></CODE>must be preceded by either a call to <CODE><A HREF="#AEStreamOpenDesc">AEStreamOpenDesc</A></CODE> or a call to<CODE><A HREF="#AEStreamOpenKeyDesc">AEStreamOpenKeyDesc</A></CODE>.  After calling <CODE><A HREF="#AEStreamWriteData">AEStreamWriteData</A></CODE> one or more times to definethe data contents of a descriptor record, you must call <CODE>AEStreamCloseDesc</CODE> to complete the descriptor'sdefinition and balance the preceding call to either <CODE><A HREF="#AEStreamOpenDesc">AEStreamOpenDesc</A></CODE> or <CODE><A HREF="#AEStreamOpenKeyDesc">AEStreamOpenKeyDesc</A></CODE>.The example shown in <A HREF="#listingthree">Listing 3</A> shows how to call <CODE><A HREF="#AEStreamWriteData">AEStreamWriteData</A></CODE>.</P><P><A HREF="#topofdocument">Back to top</A></P><BR><BR><A NAME="AEStreamCloseDesc" x-level=2 x-title="AEStreamCloseDesc"></A><H3>AEStreamCloseDesc</H3><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre><a href="../../qa/ov/ov02.html">OSStatus</A> AEStreamCloseDesc(AEStreamRef ref);</pre><P><B>Parameters:</B></P><UL> <LI><CODE>ref</CODE> - An <CODE>AEStreamRef</CODE> created by either <CODE><A HREF="#AEStreamOpen">AEStreamOpen</A></CODE>, <CODE><A HREF="#AEStreamCreateEvent">AEStreamCreateEvent</A></CODE> or <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE>. <CODE><A HREF="#AEStreamOpenDesc">AEStreamOpenDesc</A></CODE> or <CODE><A HREF="#AEStreamOpenKeyDesc">AEStreamOpenKeyDesc</A></CODE> must have been called on this <CODE>AEStreamRef</CODE> prior to calling <CODE>AEStreamCloseDesc</CODE>.<BR><BR></LI></UL><P><B>Result:</B><BR>A numeric result code indicating the success of the call. A value of <CODE>noErr</CODE>(zero) means the call succeeded.</P></TD></TR></TABLE></CENTER><BR><BR><P><CODE>AEStreamCloseDesc</CODE> is used to mark the end of a descriptor record being writtento an <CODE>AEStreamRef</CODE>.  After calling <CODE><A HREF="#AEStreamWriteData">AEStreamWriteData</A></CODE> one or more times to definethe data contents of a descriptor record, you must call this routineto complete the descriptor's definition and balance the preceding call to either<CODE><A HREF="#AEStreamOpenDesc">AEStreamOpenDesc</A></CODE> or <CODE><A HREF="#AEStreamOpenKeyDesc">AEStreamOpenKeyDesc</A></CODE>.  The example shownin <A HREF="#listingthree">Listing 3</A> shows how to call <CODE><A HREF="#AEStreamCloseDesc">AEStreamCloseDesc</A></CODE>.</P><P><A HREF="#topofdocument">Back to top</A></P><BR><BR><A NAME="wrtnglsts" x-level=1 x-title="Writing Lists"></A><H2>Writing Lists</H2><P>Routines in this section are used to delimit a group of descriptor recordsthat will be combined to create at <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDescList.html">AEDescList</A></CODE> structure in the resultingdescriptor.  </P><A NAME="AEStreamOpenList" x-level=2 x-title="AEStreamOpenList"></A><H3>AEStreamOpenList</H3><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre><a href="../../qa/ov/ov02.html">OSStatus</A> AEStreamOpenList(AEStreamRef ref);</pre><P><B>Parameters:</B></P><UL> <LI><CODE>ref</CODE> - An <CODE>AEStreamRef</CODE> created by either <CODE><A HREF="#AEStreamOpen">AEStreamOpen</A></CODE>, <CODE><A HREF="#AEStreamCreateEvent">AEStreamCreateEvent</A></CODE> or <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE>.<BR><BR></LI></UL><P><B>Result:</B><BR>A numeric result code indicating the success of the call. A value of <CODE>noErr</CODE>(zero) means the call succeeded.</P></TD></TR></TABLE></CENTER><BR><BR><P>Calling <CODE>AEStreamOpenList</CODE> marks the beginning of a sequence of zero or moredescriptor definitions that will be combined to create a single <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDescList.html">AEDescList</A></CODE>structure in the resulting descriptor record.  Every call to <CODE><A HREF="#AEStreamOpenList">AEStreamOpenList</A></CODE> mustbe balanced with a corresponding call to <CODE>AEStreamCloseList</CODE>.  The descriptors includedin an <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDescList.html">AEDescList</A></CODE> structure can be:</P><OL TYPE="1" START="0"><LI><CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE>s defined using any of the three methods described in the<A HREF="#wrtthmdown">Writing Descriptors</A> section.<BR><BR></LI><LI><CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDescList.html">AEDescList</A></CODE>s defined using the routines described in this section.<BR><BR></LI><LI><CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE>s defined using the routines described in the <A HREF="#wrtngrecs">Writing Records</A>section.<BR><BR></LI></OL><P><A HREF="#topofdocument">Back to top</A></P><BR><BR><A NAME="AEStreamCloseList" x-level=2 x-title="AEStreamCloseList"></A><H3>AEStreamCloseList</H3><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre><a href="../../qa/ov/ov02.html">OSStatus</A> AEStreamCloseList(AEStreamRef ref);</pre><P><B>Parameters:</B></P><UL> <LI><CODE>ref</CODE> - An <CODE>AEStreamRef</CODE> created by either <CODE><A HREF="#AEStreamOpen">AEStreamOpen</A></CODE>, <CODE><A HREF="#AEStreamCreateEvent">AEStreamCreateEvent</A></CODE> or <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE>.  <CODE><A HREF="#AEStreamOpenList">AEStreamOpenList</A></CODE> must have been called on this <CODE>AEStreamRef</CODE> prior to calling <CODE>AEStreamCloseList</CODE>.<BR><BR></LI></UL><P><B>Result:</B><BR>A numeric result code indicating the success of the call. A value of <CODE>noErr</CODE>(zero) means the call succeeded.</P></TD></TR></TABLE></CENTER><BR><BR>                   <P><CODE>AEStreamCloseList</CODE> is used to mark the end of a list started by callingto <CODE><A HREF="#AEStreamOpenList">AEStreamOpenList</A></CODE>.  Call this routine after writing some descriptorsto an <CODE>AEStreamRef</CODE> to balance the preceding call to <CODE><A HREF="#AEStreamOpenList">AEStreamOpenList</A></CODE>.</P><P><A HREF="#topofdocument">Back to top</A></P><BR><BR><A NAME="wrtngrecs" x-level=1 x-title="Writing Records"></A><H2>Writing Records</H2><P>Routines provided for writing <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE> structures are very similar to the set of routines provided for writing <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDescList.html">AEDescList</A></CODE> structures.  The maindifference is the routines for writing <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE> structures include provisionsfor specifying type codes associated with <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE> and the keywords associated withrecord elements.  For flexibility, the <CODE>AEStream*</CODE> routines provide more thanone way to specify these additional elements.</P><A NAME="AEStreamOpenRecord" x-level=2 x-title="AEStreamOpenRecord"></A><H3>AEStreamOpenRecord</H3><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre><a href="../../qa/ov/ov02.html">OSStatus</A> AEStreamOpenRecord(    AEStreamRef ref,    <A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/DescType.html">DescType</A> newType);</pre><P><B>Parameters:</B></P><UL> <LI><CODE>ref</CODE> - An <CODE>AEStreamRef</CODE> created by either <CODE><A HREF="#AEStreamOpen">AEStreamOpen</A></CODE>, <CODE><A HREF="#AEStreamCreateEvent">AEStreamCreateEvent</A></CODE> or <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE>.<BR><BR></LI> <LI><CODE>newType</CODE> - A type code for the new <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE> being copied to the <CODE>AEStreamRef</CODE>.  Sometimes <CODE>typeAERecord</CODE> (<CODE>'reco'</CODE>), but usually a different type is used.<BR><BR></LI> </UL><P><B>Result:</B><BR>A numeric result code indicating the success of the call. A value of <CODE>noErr</CODE>(zero) means the call succeeded.</P></TD></TR></TABLE></CENTER><BR><BR><P>Calling <CODE>AEStreamOpenRecord</CODE> marks the beginning of a sequence of zero or morekeyword/descriptor definitions that will be combined to create a single <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE>structure in the resulting descriptor record.  Every call to <CODE><A HREF="#AEStreamOpenRecord">AEStreamOpenRecord</A></CODE> mustbe balanced with a corresponding call to <CODE>AEStreamCloseRecord</CODE>.  Each keyword/descriptordefinition is introduced with a call to either <CODE><A HREF="#AEStreamWriteKeyDesc">AEStreamWriteKeyDesc</A></CODE>,<CODE><A HREF="#AEStreamOpenKeyDesc">AEStreamOpenKeyDesc</A></CODE>, or <CODE><A HREF="#AEStreamWriteKey">AEStreamWriteKey</A></CODE>.</P><P><A HREF="#topofdocument">Back to top</A></P><BR><BR><A NAME="AEStreamCloseRecord" x-level=2 x-title="AEStreamCloseRecord"></A><H3>AEStreamCloseRecord</H3><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre><a href="../../qa/ov/ov02.html">OSStatus</A> AEStreamCloseRecord(AEStreamRef ref);</pre><P><B>Parameters:</B></P><UL> <LI><CODE>ref</CODE> - An <CODE>AEStreamRef</CODE> created by either <CODE><A HREF="#AEStreamOpen">AEStreamOpen</A></CODE>, <CODE><A HREF="#AEStreamCreateEvent">AEStreamCreateEvent</A></CODE> or <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE>. <CODE><A HREF="#AEStreamOpenRecord">AEStreamOpenRecord</A></CODE> must have been called on this <CODE>AEStreamRef</CODE> prior to calling <CODE>AEStreamCloseRecord</CODE>.<BR><BR></LI></UL><P><B>Result:</B><BR>A numeric result code indicating the success of the call. A value of <CODE>noErr</CODE>(zero) means the call succeeded.</P></TD></TR></TABLE></CENTER><BR><BR>                   <P><CODE>AEStreamCloseRecord</CODE> is used to mark the end of a record started by callingto <CODE><A HREF="#AEStreamOpenRecord">AEStreamOpenRecord</A></CODE>.  Call this routine after writing some keyword/descriptor pairsto an <CODE>AEStreamRef</CODE> to balance the preceding call to <CODE><A HREF="#AEStreamOpenRecord">AEStreamOpenRecord</A></CODE>.</P><P><A HREF="#topofdocument">Back to top</A></P><BR><BR><A NAME="AEStreamSetRecordType" x-level=2 x-title="AEStreamSetRecordType"></A><H3>AEStreamSetRecordType</H3><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre><a href="../../qa/ov/ov02.html">OSStatus</A> AEStreamSetRecordType(    AEStreamRef ref,    <A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/DescType.html">DescType</A> newType);</pre><P><B>Parameters:</B></P><UL> <LI><CODE>ref</CODE> - An <CODE>AEStreamRef</CODE> created by either <CODE><A HREF="#AEStreamOpen">AEStreamOpen</A></CODE>, <CODE><A HREF="#AEStreamCreateEvent">AEStreamCreateEvent</A></CODE> or <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE>.<BR><BR></LI> <LI><CODE>newType</CODE> - A type code for the new <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE> currently being copied to the <CODE>AEStreamRef</CODE>.  Since <CODE><A HREF="#AEStreamOpenRecord">AEStreamOpenRecord</A></CODE>/<CODE><A HREF="#AEStreamCloseRecord">AEStreamCloseRecord</A></CODE> calls can be nested, this call will set the type for the record associated with the most recent <CODE><A HREF="#AEStreamOpenRecord">AEStreamOpenRecord</A></CODE> call.<BR><BR></LI> </UL><P><B>Result:</B><BR>A numeric result code indicating the success of the call. A value of <CODE>noErr</CODE>(zero) means the call succeeded.</P></TD></TR></TABLE></CENTER><BR><BR><P><CODE><A HREF="#AEStreamSetRecordType">AEStreamSetRecordType</A></CODE> can be called after <CODE><A HREF="#AEStreamOpenRecord">AEStreamOpenRecord</A></CODE> to set the typeof the <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE> being defined to a different type than the type specified in the<CODE>newType</CODE> parameter to the <CODE><A HREF="#AEStreamOpenRecord">AEStreamOpenRecord</A></CODE> call.  In the case where your codeis creating nested records, <CODE><A HREF="#AEStreamSetRecordType">AEStreamSetRecordType</A></CODE> will set the type of the<CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE> associated with the most recent call to <CODE><A HREF="#AEStreamOpenRecord">AEStreamOpenRecord</A></CODE>.This routine can only be called between <CODE><A HREF="#AEStreamOpenRecord">AEStreamOpenRecord</A></CODE>and <CODE><A HREF="#AEStreamCloseRecord">AEStreamCloseRecord</A></CODE> calls.</P><P><A HREF="#topofdocument">Back to top</A></P><BR><BR><A NAME="AEStreamWriteKeyDesc" x-level=2 x-title="AEStreamWriteKeyDesc"></A><H3>AEStreamWriteKeyDesc</H3><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre><a href="../../qa/ov/ov02.html">OSStatus</A> AEStreamWriteKeyDesc(    AEStreamRef ref,    <A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEKeyword.html">AEKeyword</A> key,    <A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/DescType.html">DescType</A> newType,    const void* data,    Size length);</pre><P><B>Parameters:</B></P><UL> <LI><CODE>ref</CODE> - An <CODE>AEStreamRef</CODE> created by either <CODE><A HREF="#AEStreamOpen">AEStreamOpen</A></CODE>, <CODE><A HREF="#AEStreamCreateEvent">AEStreamCreateEvent</A></CODE> or <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE>.  Since <CODE><A HREF="#AEStreamOpenRecord">AEStreamOpenRecord</A></CODE>/<CODE><A HREF="#AEStreamCloseRecord">AEStreamCloseRecord</A></CODE> calls can be nested, this call will add a new <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEKeyword.html">AEKeyword</A></CODE>/<CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> pair to the <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE> associated with the most recent <CODE><A HREF="#AEStreamOpenRecord">AEStreamOpenRecord</A></CODE> call.<BR><BR></LI> <LI><CODE>key</CODE> - The <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEKeyword.html">AEKeyword</A></CODE> associated with the new <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> being added to the current <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE>.<BR><BR></LI> <LI><CODE>newType</CODE> - A type code for the new <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> being copied to the <CODE>AEStreamRef</CODE>.<BR><BR></LI> <LI><CODE>data</CODE> - A pointer to a block of memory containing <CODE>length</CODE> bytes of data that will be used in the new <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> being copied to the <CODE>AEStreamRef</CODE>. <CODE><A HREF="#AEStreamWriteKeyDesc">AEStreamWriteKeyDesc</A></CODE> copies the data immediately so you do not need to retain this memory after calling <CODE><A HREF="#AEStreamWriteKeyDesc">AEStreamWriteKeyDesc</A></CODE>.<BR><BR></LI> <LI><CODE>length</CODE> - The number of bytes pointed to by the data parameter.<BR><BR></LI></UL><P><B>Result:</B><BR>A numeric result code indicating the success of the call. A value of <CODE>noErr</CODE>(zero) means the call succeeded.</P></TD></TR></TABLE></CENTER><BR><BR>                    <P>Call <CODE><A HREF="#AEStreamWriteKeyDesc">AEStreamWriteKeyDesc</A></CODE> to write a complete keyword/descriptor pair toan <CODE>AEStreamRef</CODE> for inclusion in a <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE>.This routine can only be called between <CODE><A HREF="#AEStreamOpenRecord">AEStreamOpenRecord</A></CODE>and <CODE><A HREF="#AEStreamCloseRecord">AEStreamCloseRecord</A></CODE> calls.  <CODE><A HREF="#AEStreamWriteKeyDesc">AEStreamWriteKeyDesc</A></CODE>is analogous to the Apple Event Manager routine <CODE><A HREF="http://developer.apple.com/documentation/mac/IAC/IAC-221.html">AEPutParamPtr</A></CODE>, andit is nearly the same as <CODE><A HREF="#AEStreamWriteDesc">AEStreamWriteDesc</A></CODE> (except it has anadditional <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEKeyword.html">AEKeyword</A></CODE> parameter).  The sample shown in<A HREF="#eventopen">Listing 6</A> shows how you could call this routine.</P><P>In the case where your code is creating nested records, <CODE><A HREF="#AEStreamWriteKeyDesc">AEStreamWriteKeyDesc</A></CODE>will add a <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEKeyword.html">AEKeyword</A></CODE>/<CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> pair to the <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE> associated with themost recent call to <CODE><A HREF="#AEStreamOpenRecord">AEStreamOpenRecord</A></CODE> or <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE>.<CODE><A HREF="#AEStreamWriteKeyDesc">AEStreamWriteKeyDesc</A></CODE> can only be called while an <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE>is being written - it cannot be called to add <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEKeyword.html">AEKeyword</A></CODE>/<CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> pairsto a <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE> while you are writing to a nested <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDescList.html">AEDescList</A></CODE> inside ofthat <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE>.</P><P><A HREF="#topofdocument">Back to top</A></P><BR><BR><A NAME="AEStreamOpenKeyDesc" x-level=2 x-title="AEStreamOpenKeyDesc"></A><H3>AEStreamOpenKeyDesc</H3><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre><a href="../../qa/ov/ov02.html">OSStatus</A> AEStreamOpenKeyDesc(    AEStreamRef ref,    <A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEKeyword.html">AEKeyword</A> key,    <A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/DescType.html">DescType</A> newType);</pre><P><B>Parameters:</B></P><UL> <LI><CODE>ref</CODE> - An <CODE>AEStreamRef</CODE> created by either <CODE><A HREF="#AEStreamOpen">AEStreamOpen</A></CODE>, <CODE><A HREF="#AEStreamCreateEvent">AEStreamCreateEvent</A></CODE> or <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE>.  Since <CODE><A HREF="#AEStreamOpenRecord">AEStreamOpenRecord</A></CODE>/<CODE><A HREF="#AEStreamCloseRecord">AEStreamCloseRecord</A></CODE> calls can be nested, this call will add a new <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEKeyword.html">AEKeyword</A></CODE>/<CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> pair to the <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE> associated with the most recent <CODE><A HREF="#AEStreamOpenRecord">AEStreamOpenRecord</A></CODE> call.<BR><BR></LI> <LI><CODE>key</CODE> - The <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEKeyword.html">AEKeyword</A></CODE> associated with the new <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEKeyword.html">AEKeyword</A></CODE>/<CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> pair being added to the current <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE>.<BR><BR></LI> <LI><CODE>newType</CODE> - A type code for the new <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> being copied to the <CODE>AEStreamRef</CODE>.<BR><BR></LI></UL><P><B>Result:</B><BR>A numeric result code indicating the success of the call. A value of <CODE>noErr</CODE>(zero) means the call succeeded.</P></TD></TR></TABLE></CENTER><BR><BR><P>Call <CODE><A HREF="#AEStreamOpenKeyDesc">AEStreamOpenKeyDesc</A></CODE> to start the definition of a keyword/descriptorpair for inclusion in an <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE>.<CODE><A HREF="#AEStreamOpenKeyDesc">AEStreamOpenKeyDesc</A></CODE> is the same as <CODE><A HREF="#AEStreamOpenDesc">AEStreamOpenDesc</A></CODE> with the exception that it includesan <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEKeyword.html">AEKeyword</A></CODE> parameter that will be used as the <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE> element's keyword.  You shoulduse this routine when you would like to provide thedata associated with a keyword/descriptor pair in an incremental fashion with repeatedcalls to <CODE><A HREF="#AEStreamWriteData">AEStreamWriteData</A></CODE>.  After calling <CODE><A HREF="#AEStreamOpenKeyDesc">AEStreamOpenKeyDesc</A></CODE> you shouldcall <CODE><A HREF="#AEStreamWriteData">AEStreamWriteData</A></CODE> a number of times to define the data contents for the descriptorbefore calling <CODE><A HREF="#AEStreamCloseDesc">AEStreamCloseDesc</A></CODE> to complete the definition.  </P><P>In the case where your code is creating nested records, <CODE><A HREF="#AEStreamOpenKeyDesc">AEStreamOpenKeyDesc</A></CODE>will begin a <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEKeyword.html">AEKeyword</A></CODE>/<CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> pair in the <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE> associated with themost recent call to <CODE><A HREF="#AEStreamOpenRecord">AEStreamOpenRecord</A></CODE> or <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE>.<CODE><A HREF="#AEStreamOpenKeyDesc">AEStreamOpenKeyDesc</A></CODE> can only be called while an <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE>is being written - it cannot be called to begin <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEKeyword.html">AEKeyword</A></CODE>/<CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> pairsin a <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE> while you are writing to a nested <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDescList.html">AEDescList</A></CODE> inside ofthat <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE>.</P><P><A HREF="#topofdocument">Back to top</A></P><BR><BR><A NAME="AEStreamWriteKey" x-level=2 x-title="AEStreamWriteKey"></A><H3>AEStreamWriteKey</H3><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre><a href="../../qa/ov/ov02.html">OSStatus</A> AEStreamWriteKey(    AEStreamRef ref,    <A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEKeyword.html">AEKeyword</A> key);</pre><P><B>Parameters:</B></P><UL> <LI><CODE>ref</CODE> - An <CODE>AEStreamRef</CODE> created by either <CODE><A HREF="#AEStreamOpen">AEStreamOpen</A></CODE>, <CODE><A HREF="#AEStreamCreateEvent">AEStreamCreateEvent</A></CODE> or <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE>.<BR><BR></LI> <LI><CODE>key</CODE> - The <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEKeyword.html">AEKeyword</A></CODE> associated with the new <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEKeyword.html">AEKeyword</A></CODE>/<CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> pair being added to the current <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE>.<BR><BR></LI></UL><P><B>Result:</B><BR>A numeric result code indicating the success of the call. A value of <CODE>noErr</CODE>(zero) means the call succeeded.</P></TD></TR></TABLE></CENTER><BR><BR><P>Call <CODE>AEStreamWriteKey</CODE> to start the definition of a keyword/descriptorpair for inclusion in an <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE>.  This routine only writes the keywordpart of the definition and it must be followed by a sequence of <CODE>AEStream*</CODE>calls that define exactly one descriptor record.  That descriptor can be any of thefollowing:</P><UL><LI>An <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> defined using any of the three methods described in the<A HREF="#wrtthmdown">Writing Descriptors</A> section.<BR><BR></LI><LI>An <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDescList.html">AEDescList</A></CODE> defined using the routines described in the <A HREF="#wrtnglsts">Writing Lists</A>section.<BR><BR></LI><LI>An <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE> defined using the routines described in this section.<BR><BR></LI></UL><P>The sample shown in <A HREF="#eventopen">Listing 6</A> shows how you could call this routine.</P><P>In the case where your code is creating nested records, <CODE><A HREF="#AEStreamWriteKey">AEStreamWriteKey</A></CODE>will begin a <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEKeyword.html">AEKeyword</A></CODE>/<CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> pair in the <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE> associated with themost recent call to <CODE><A HREF="#AEStreamOpenRecord">AEStreamOpenRecord</A></CODE> or <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE>.<CODE><A HREF="#AEStreamWriteKey">AEStreamWriteKey</A></CODE> can only be called while an <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE>is being written - it cannot be called to begin <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEKeyword.html">AEKeyword</A></CODE>/<CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> pairsin a <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE> while you are writing to a nested <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDescList.html">AEDescList</A></CODE> insideof that <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE>.</P><P><A HREF="#topofdocument">Back to top</A></P><BR><BR><A NAME="wrtngevents" x-level=1 x-title="Writing Apple Event Records"></A><H2>Writing Apple Event Records</H2><P>The <CODE>AEStream*</CODE> routines can be used to create complete Apple event records.<CODE><A HREF="#AEStreamCreateEvent">AEStreamCreateEvent</A></CODE> can be used to define a new <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A></CODE>record, and the routine <CODE>AEStreamOpenEvent</CODE> can be used to supplementan existing one.  Since the contents of <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A></CODE> records are formattedthe same as <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE>s, we use the same routines for filling in the parametersas we use for adding <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE> elements.  For Apple events, we use the routines<CODE><A HREF="#AEStreamWriteKeyDesc">AEStreamWriteKeyDesc</A></CODE>, <CODE><A HREF="#AEStreamOpenKeyDesc">AEStreamOpenKeyDesc</A></CODE>, or<CODE><A HREF="#AEStreamWriteKey">AEStreamWriteKey</A></CODE> defined in the <A HREF="#wrtngrecs">WritingRecords</A> section.  <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A></CODE> records include provisions for optionalparameters.  So that you can specify which of the parameters you supply areoptional, <CODE>AEStream*</CODE> provides the <CODE><A HREF="#AEStreamOptionalParam">AEStreamOptionalParam</A></CODE> call.  </P><A NAME="AEStreamOpenEvent" x-level=2 x-title="AEStreamOpenEvent"></A><H3>AEStreamOpenEvent</H3><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>AEStreamRef AEStreamOpenEvent(<A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A> *event);</pre><P><B>Parameters:</B></P><UL>  <LI><CODE>event</CODE> - An existing Apple event record that you would  like to add parameters to.<BR><BR></LI>  </UL><P><B>Result:</B><BR>An <CODE>AEStreamRef</CODE> or, if an error occurs, thevalue <CODE>NULL</CODE>.</P></TD></TR></TABLE></CENTER><BR><BR><P><CODE>AEStreamOpenEvent</CODE> allows you to open an existing <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A></CODE>record in an <CODE>AEStreamRef</CODE> so you can use the <CODE>AEStream*</CODE> routinesto append additional parameters to the event.  Once you have opened an eventrecord the contents of the event record are copied into the <CODE>AEStreamRef</CODE>.  Whenyou have finished describing the parameters for the event record, call <CODE><A HREF="#AEStreamClose">AEStreamClose</A></CODE>to save them to an <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A></CODE> record. The example shown in <A HREF="#eventopen">Listing 6</A>illustrates how to call this routine.</P><P>If there is not enough storage available to complete the operation, <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE> willreturn <CODE>NULL</CODE> and the <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A></CODE> parameter will remain unchanged.  Otherwise, if successful,<CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE> will return a vaild <CODE>AEStreamRef</CODE> and the <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A></CODE>parameter will beset to a descriptor of <CODE>typeNull</CODE>.  When you open an <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A></CODE>record using <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE>, you must define the parameters using the same routinesyou would use for adding keyword/descriptor pairs to records as described in the<A HREF="#wrtngrecs">Writing Records</A> section together with the <CODE><A HREF="#AEStreamOptionalParam">AEStreamOptionalParam</A></CODE>routine described in this section.</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td align="left"><P><B><A NAME="eventopen" kind = "Listing">Listing 6</A>.</B> An example illustratinghow to call <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE>.</P></TD></TR><TR><td bgcolor="#E6E6E6" align=left><pre><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A> event;AEStreamRef ref;<a href="../../qa/ov/ov02.html">OSStatus</A> err;char* p = "Hello World";....ref = <A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A>(&event);if (ref != NULL) {        /* add a direct parameter */    err = <A HREF="#AEStreamWriteKeyDesc">AEStreamWriteKeyDesc</A>( ref, keyDirectObject, typeChar, p, strlen(p));    if (err == noErr) {            /* add another, optional parameter. */        err = <A HREF="#AEStreamWriteKey">AEStreamWriteKey</A>( ref, 'mine');        if (err == noErr) {                /* add all of our strings to the list                using the <A HREF="#AddTextDesc">AddTextDesc</A> routine defined in                <A HREF="#listingthree">Listing 3</A> */            err = <A HREF="#AddTextDesc">AddTextDesc</A>( ref, "this is an optional parameter");            if (err == noErr) {                    /* flag the parameter with the keyword 'mine' as an                    optional parameter. */                err = <A HREF="#AEStreamOptionalParam">AEStreamOptionalParam</A>( ref, 'mine');                if (err == noErr) {                        /* close the stream */                    err = <A HREF="#AEStreamClose">AEStreamClose</A>(ref, &event);                    if (err == noErr) {                            /* send the event */                        err = <A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/Functions/Sending_an_Apple_Event.html">AESend</A>(&amp;event, ...);                    ....</pre></TD></TR></TABLE></CENTER><BR><BR>                                        <P><CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE> clears the contents of the <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A></CODE> structure passedto it and sets it to a <CODE>'null'</CODE> descriptor after it reads the <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A></CODE> into the <CODE>AEStreamRef</CODE>.  To copy the<CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A></CODE> back into this variable after you are finished writing parametersto it, call <CODE><A HREF="#AEStreamClose">AEStreamClose</A></CODE> providing this same structure as the destinationfor the resulting descriptor record.</P>                             <P><A HREF="#topofdocument">Back to top</A></P><BR><BR><A NAME="AEStreamCreateEvent" x-level=2 x-title="AEStreamCreateEvent"></A><H3>AEStreamCreateEvent</H3><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>AEStreamRef AEStreamCreateEvent(    <A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEEventClass.html">AEEventClass</A> clazz,    <A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEEventID.html">AEEventID</A> id,    <A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/DescType.html">DescType</A> targetType,    const void* targetData,    long targetLength,    short returnID,    long transactionID);</pre><P><B>Parameters:</B></P><UL><LI><CODE>clazz</CODE> - The event class for the resulting Apple event.<BR><BR></LI><LI><CODE>id</CODE> - The event id for the resulting Apple event.<BR><BR></LI><LI><CODE>targetType</CODE> - The address type for the addressing informationdescribed in the next two parameters: usually one of <CODE>typeApplSignature</CODE>,<CODE>typeProcessSerialNumber</CODE>, or <CODE>typeKernelProcessID</CODE>.<BR><BR></LI><LI><CODE>targetData</CODE> - A pointer to the address information.<BR><BR></LI><LI><CODE>targetLength</CODE> - The number of bytes pointed to by the <CODE>targetData</CODE>parameter.<BR><BR></LI><LI><CODE>returnID</CODE> - Usually, set to the value <CODE>kAutoGenerateReturnID</CODE>. See the Apple Event Manager documentation for more information.<BR><BR></LI><LI><CODE>transactionID</CODE> - Usually, set to the value <CODE>kAnyTransactionID</CODE>.See the Apple Event Manager documentation for more information.<BR><BR></LI></UL><P><B>Result:</B><BR>An <CODE>AEStreamRef</CODE> or, if an error occurs, thevalue <CODE>NULL</CODE>.</P></TD></TR></TABLE></CENTER><BR><BR>                    <P><CODE><A HREF="#AEStreamCreateEvent">AEStreamCreateEvent</A></CODE> calls <CODE><A HREF="http://developer.apple.com/documentation/mac/IAC/IAC-207.html">AECreateAppleEvent</A></CODE> before calling<CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE> to open an <CODE>AEStreamRef</CODE> for adding parameters tothe event.  </P><P><A HREF="#topofdocument">Back to top</A></P><BR><BR><A NAME="AEStreamOptionalParam" x-level=2 x-title="AEStreamOptionalParam"></A><H3>AEStreamOptionalParam</H3><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre><a href="../../qa/ov/ov02.html">OSStatus</A> AEStreamOptionalParam(    AEStreamRef ref,    <A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEKeyword.html">AEKeyword</A> key);</pre><P><B>Parameters:</B></P><UL>  <LI><CODE>ref</CODE> - An <CODE>AEStreamRef</CODE> created by either <CODE><A HREF="#AEStreamOpen">AEStreamOpen</A></CODE>, <CODE><A HREF="#AEStreamCreateEvent">AEStreamCreateEvent</A></CODE> or <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE>.<BR><BR></LI>  <LI><CODE>key</CODE> - The <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEKeyword.html">AEKeyword</A></CODE> associated with the any <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEKeyword.html">AEKeyword</A></CODE>/<CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> pair being added to an <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A></CODE>.  <CODE><A HREF="#AEStreamCreateEvent">AEStreamCreateEvent</A></CODE> or <CODE><A HREF="#AEStreamOpenEvent">AEStreamOpenEvent</A></CODE> must precede any calls to <CODE>AEStreamOptionalParam</CODE>.<BR><BR></LI> </UL><P><B>Result:</B><BR>A numeric result code indicating the success of the call. A value of <CODE>noErr</CODE>(zero) means the call succeeded.</P></TD></TR></TABLE></CENTER><BR><BR>                  <P>The <CODE><A HREF="#AEStreamOptionalParam">AEStreamOptionalParam</A></CODE> allows you to designate optional parameters(by <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEKeyword.html">AEKeyword</A></CODE>) in <CODE><A HREF="http://developer.apple.com/documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A></CODE> records.  The sample shown in <A HREF="#eventopen">Listing 6</A> shows how you could call this routine.</P><P><A HREF="#topofdocument">Back to top</A></P><BR><BR>                  <A NAME="doenleoads" x-level=1 x-title="Downloadables"></A><H2>Downloadables</H2>   <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%"><TR> <td width=50 align=left><P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P></TD> <td align="left"><P>Acrobat version of this Note (104K)</P></TD> <td width=60 align=left><P><A HREF="pdf/tn2046.pdf">Download</A></P></TD></TR></TABLE>         <P><A HREF="#topofdocument">Back to top</A></P><BR><BR></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tn/tn2046.html%3Fid%3DDTS10003079-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tn/tn2046.html%3Fid%3DDTS10003079-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tn/tn2046.html%3Fid%3DDTS10003079-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>