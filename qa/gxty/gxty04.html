<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!--Template 06-20-02--><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Q&amp;A GXTY04: QuickDraw GX and Layout Shapes</title><meta name="keywords" content="Mac OS 8 QuickDraw GX Layout Shapes GXGetLayoutJustificationGap"><meta name="Description" content="Technical Q&amp;A GXTY04: NOTE: The latest Mac OS releases, MacOS 8.5.x and 8.6, will be the final operating system releasesfrom Apple to include support for QuickDraw GX. Q&amp;A givesthe new API call for determining the difference between thewidth of a layout shape and the measured unjustified widthand provides examples for the use of this API call. Thisis in response to the problem of text within an editfieldcompressing itself to match the width of the editfield'slayout shape."><meta name="categories" content="QuickDraw GX"><meta name="week-posted" content="May 1, 1995 - May 5, 1995"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10001263" title="QuickDraw GX and Layout Shapes"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalqas/index.html">Technical Q&As</a> &gt; <a href="../../technicalqas/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalqas/LegacyTechnologies/idxGraphicsImaging-date.html">Graphics & Imaging</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/GraphicsImaging/index.html" target="_blank">Reference Library > Graphics & Imaging</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Q&amp;A GXTY04</div>
<div id="pageheadsub">QuickDraw GX and Layout Shapes</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment -->						<!-- begin_content --> <CENTER><TABLE BORDER=0 CELLPADDING=0 WIDTH=600><TR> <td align="left"><hr width=500 align=center><p id = p2>Q:  I'm using a layout shape to represent an area for editable text thatwill have a fixed position, style, font, size, and width. This layout shape hassome default text that the user is prompted to change (text content only; noother attributes).</p> <p id=p4>Each time text is added (the new text replaces the previous text string), theUI code asks whether the size of the new string goes beyond the defined width.I do this by comparing the width of the local bounds with the width givenwithin the layout-shape geometry found within the layout-options structure. Inall cases, the justification setting is 0, but the flush setting varies(left/0, center/0.5, right/1.0).</p> <p id=p4>When the user enters text into this shape, the bounds (as defined by my logicabove) may or may not be found. That is, sometimes the bounds defined by theshape and the local bounds reach a point where the local bounds are wider thanthat indicated by the shape. However, in other cases, the local bounds divergetoward the width, but it never reaches or surpasses it. In this situation, thetext is updated and begins to compress itself within the defined width.Sometimes, it appears that the compression or the meeting of the bounds dependson the font and/or the text used, but at other times, this does not seem toapply.</p> <p id=p4>Here is my algorithm:</p><ol type="1" start="1">	<li>save the current string</li>	<li>get the defined width of the layout shape (Note: If the layout options structure width is 0, a width found on a tag attached to the shape is used.)</li>	<li>update the shape with the new string</li>	<li>get the local bounds of the shape with the new string</li>	<li>compare the width of the new bounds with the defined width if bounds width &gt; defined width</li>	<li>then // in this case the new string is too long for the definition</li>	<li>reset the text string to the previous string</li>	<li>otherwise</li>	<li>return</li></ol> <p id=p4>How can I allow text to be entered till the width is reached, but notcompressed? Can I do this based on the above detail? If there is somethingwrong with this approach, can you suggest another approach I could use?</p><p id=p4>A:  The problem you describe was fixed in QuickDraw GX 1.1.1 by adding a new APIcall. The prototype for this call is:</p>   <CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre> Fixed GXGetLayoutJustificationGap (gxShape layout);</pre>	</TD></TR></TABLE></CENTER><p id=p4>This function returns information that was always generated during layout'sjustification processing, but was never made publicly visible before. Itrepresents the signed difference between the specified width for the layout andthe measured (unjustified) width.</p><p id=p4>By setting a width in the layout options, but leaving the justification factorat zero, you can keep adding text until the results of the<code>GXGetLayoutJustificationGap</code> call changes sign from positive to negative. Atthat point, the text starts to compress, so you should prohibit new text entry.It is a very fast call (since its result is cached as part of the layoutprocess anyway), so calling it on every typed character shouldn't slow thingsdown at all.</p> <p id=p4>Some examples may help clarify the usage of this call: Suppose you create alayout with the width field of the gxLayoutOptions set to 500 points and thejustification factor set to fract1 (i.e., full justification). If theunjustified width of the layout is only 450 points, this function returns +50points. Similarly, if the unjustified width is 525 points, this functionreturns -25 points. A positive value means the line will be typographicallystretched in order to fill the specified width, while a negative value meansthe line will be typographically condensed.</p> <p id=p4>Note that the justification factor in the <code>gxLayoutOptions</code> doesn't have to befract1 for this function to return useful results. For instance, by setting awidth value but leaving the justification factor set to zero, layout will notjustify the line unless the line's unjustified width exceeds the specifiedwidth. In this case, layout will typographically shrink the line. A clientprogram wishing to determine when the end of a line is reached (forlinebreaking purposes) can call this function after every character is added(as the user types, for example), and as soon as the value becomes negative,the client knows that the margin has been reached.</p>  <BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P id=p4><B>Important:</B><BR>If you have based your QuickDraw GX printer driver on the sample LaserWriterIIsc driver from the QuickDraw GX v1.0.1 SDK or the Mac OS SDK, please see theupdated sample and Read Me contained within the seed for details of importantchanges to this driver for QuickDraw GX v1.1.1.</P></TD></TR></TABLE></CENTER><BR></td></tr></table></center><!-- end_content --><!-- begin_date --><H4 ALIGN=center>[May 01 1995]</H4><!-- end_date --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/qa/gxty/gxty04.html%3Fid%3DDTS10001263-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/qa/gxty/gxty04.html%3Fid%3DDTS10001263-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/qa/gxty/gxty04.html%3Fid%3DDTS10001263-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --> <hr width=500 align=center> </BODY> </HTML>