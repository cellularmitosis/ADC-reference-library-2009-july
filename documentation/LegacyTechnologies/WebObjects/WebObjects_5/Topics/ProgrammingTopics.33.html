<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML EXPERIMENTAL 970324//EN"><HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><TITLE> Accessing Schema Information from the Database Server</TITLE></HEAD><BODY bgcolor="#ffffff">		<!-- start of header -->		<!--#include virtual="/includes/framesetheader" -->		<!-- end of header --><!-- start of path --><table cellspacing=0 border=0 width=600 valign="left"><tr><td scope="row"><font face="Geneva,Helvetica,Arial" size="1"><b>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="../../index.html" target="_top">Documentation</a> <b>></b> <a href="../webobjects.html" target="_top">WebObjects</a></font></td></tr></table><br><!-- end of path --><DIV><a name="top"></a><A HREF="TopicsTOC.html"><img src="up.gif" border="0" alt="Up"></A><nobr>&nbsp;</nobr><A HREF="ProgrammingTopics.32.html"><img src="previous.gif" border="0" alt="Previous"></A><nobr>&nbsp;</nobr><A HREF="ProgrammingTopics.34.html"><img src="next.gif" border="0" alt="Next"></A></DIV><H1 CLASS="TopictTitle"><A NAME="pgfId=606254"> </A><A NAME="24267"> </A>Accessing Schema Information from the Database Server</H1><DIV><H2 CLASS="Synopsis"><A NAME="pgfId=606144"> </A>Synopsis</H2><P CLASS="Body"><A NAME="pgfId=606145"> </A>Explains how to determine table and column information from the database server using the adaptor sublayer.</P></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606146"> </A>Discussion</H2><P CLASS="Body"><A NAME="pgfId=630407"> </A>You can read schema information from the database server with the EOAdaptorChannel &quot;describe&quot; methods:</P><UL><LI CLASS="Bulleted"><A NAME="pgfId=630411"> </A><TT CLASS="Code">describeTableNames</TT></LI><LI CLASS="Bulleted"><A NAME="pgfId=630415"> </A><TT CLASS="Code">describeModelWithTableNames</TT></LI><LI CLASS="Bulleted"><A NAME="pgfId=630419"> </A><TT CLASS="Code">describeStoredProcedureNames</TT></LI></UL><P CLASS="Body"><A NAME="pgfId=630420"> </A>The<EM CLASS="Bold"> </EM><TT CLASS="Code">describeTableNames</TT> method reads and returns an array of table names from the database. The <TT CLASS="Code">describeModelWithTableNames</TT> method constructs an EOModel out of the database's metadata, and assigns the adaptor name and connection dictionary to the new EOModel. You generally invoke <TT CLASS="Code">describeModelWithTableNames</TT> with the array of table names (or a subset) returned from <TT CLASS="Code">describeTableNames</TT>. The <TT CLASS="Code">describeStoredProcedureNames</TT> method reads an array of stored procedure names from the database. You can then use <TT CLASS="Code">addStoredProceduresNamed (addStoredProceduresNamed:toModel:</TT> in Objective-C) to add the corresponding stored procedures to a model. The following code shows how to open an adaptor and get the database schema from it.</P><DIV><H4 CLASS="Code-Listing"><A NAME="pgfId=630433"> </A>Accessing a schema from the server (Java)</H4><PRE CLASS="Code"><A NAME="pgfId=630591"> </A>EOAdaptor myAdaptor = EOAdaptor.adaptorWithName(&quot;OpenBaseLite&quot;);<A NAME="pgfId=631829"> </A>EOAdaptorContext myContext = myAdaptor.createAdaptorContext();<A NAME="pgfId=631838"> </A>EOAdaptorChannel myChannel = myContext.createAdaptorChannel();<A NAME="pgfId=631839"> </A><A NAME="pgfId=631844"> </A>/* The connection dictionary is adaptor and database dependent */<A NAME="pgfId=631849"> </A>NSMutableDictionary connDict = new NSMutableDictionary();<A NAME="pgfId=631854"> </A>connDict.setObjectForKey(&quot;Movies&quot;,&quot;DATABASENAME&quot;);<A NAME="pgfId=631859"> </A>connDict.setObjectForKey(&quot;/Local/Library/Databases&quot;,&quot;PATH&quot;);<A NAME="pgfId=631864"> </A><A NAME="pgfId=631869"> </A>myAdaptor.setConnectionDictionary(connDict);<A NAME="pgfId=631874"> </A>try {<A NAME="pgfId=631879"> </A>    myAdaptor.assertConnectionDictionaryIsValid();<A NAME="pgfId=631884"> </A>} catch (NSException exception) {<A NAME="pgfId=631889"> </A>    /* handle bad connection dictionary */<A NAME="pgfId=631894"> </A>}<A NAME="pgfId=631899"> </A><A NAME="pgfId=631904"> </A>myChannel.openChannel();<A NAME="pgfId=631909"> </A><A NAME="pgfId=631914"> </A>NSArray tableNames = myChannel.describeTableNames();<A NAME="pgfId=631919"> </A>EOModel myModel = myChannel.describeModelWithTableNames(tableNames);<A NAME="pgfId=631924"> </A><A NAME="pgfId=631929"> </A>NSArray storedProcNames = myChannel.describeStoredProcedureNames();<A NAME="pgfId=631934"> </A>myChannel.addStoredProceduresNamed(storedProcNames,myModel);<A NAME="pgfId=631939"> </A><A NAME="pgfId=631944"> </A>myChannel.closeChannel();</PRE><P CLASS="Body"><A NAME="pgfId=630610"> </A>The code first builds a connection dictionary to connect to the database with. Then it attempts to verify the connection dictionary using <TT CLASS="Code">assertConnectionDictionaryIsValid</TT>. If the connection attempt fails, the method raises an exception. Otherwise the code opens the connection to the database and gets the table names and stored procedures.</P><P CLASS="Body"><A NAME="pgfId=632030"> </A>Note that the keys for the connection dictionary depend on the particular adaptor and database server you are using. You can view the connection dictionary for a database using EOModeler in the following way.</P><P CLASS="Numbered1"><A NAME="pgfId=632070"> </A> Build a model for your database in EOModeler by invoking the File-&gt;New menu item.</P><OL><LI CLASS="Numbered"><A NAME="pgfId=632074"> </A>When you are finished, inspect the model by selecting it in the tree view and clicking the inspector button.</LI></OL></DIV></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=624378"> </A>See Also</H2><UL><LI CLASS="Bulleted"><A NAME="pgfId=630598"> </A><A HREF="ProgrammingTopics.31.html#17565" CLASS="XRef">Creating Adaptor Sublayer Objects and Connecting Them to the Server</A></LI></UL></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606211"> </A>Questions</H2><UL><LI CLASS="Bulleted"><A NAME="pgfId=630051"> </A>How do I access database schema information from the database server?</LI><LI CLASS="Bulleted"><A NAME="pgfId=630073"> </A>How do I create EOAdaptor layer objects without a model?</LI></UL></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606216"> </A>Keywords</H2><UL><LI CLASS="Bulleted"><A NAME="pgfId=606217"> </A>Adaptor</LI><LI CLASS="Bulleted"><A NAME="pgfId=630098"> </A>Model</LI><LI CLASS="Bulleted"><A NAME="pgfId=630099"> </A>Schema</LI><LI CLASS="Bulleted"><A NAME="pgfId=630100"> </A>Connection Dictionary</LI><LI CLASS="Bulleted"><A NAME="pgfId=630102"> </A>Stored Procedure</LI></UL></DIV><DIV><H2 CLASS="Heading1"><A NAME="pgfId=606225"> </A>Revision History</H2><P CLASS="Body"><A NAME="pgfId=602450"> </A>9 February, 1999. Clif Liu. First Draft.</P></DIV><hr alt="">&#169 1999 Apple Computer, Inc.<P><A HREF="TopicsTOC.html"><img src="up.gif" border="0" alt="Up"></A><nobr>&nbsp;</nobr><A HREF="ProgrammingTopics.32.html"><img src="previous.gif" border="0" alt="Previous"></A><nobr>&nbsp;</nobr><A HREF="ProgrammingTopics.34.html"><img src="next.gif" border="0" alt="Next"></A><!-- start of footer --><!--#include file="footer" --><!-- end of footer --><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></HTML>