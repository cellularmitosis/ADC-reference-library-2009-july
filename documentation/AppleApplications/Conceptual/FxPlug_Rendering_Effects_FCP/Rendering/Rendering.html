<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Rendering FxPlug Effects in Final Cut: Rendering FXPlug Effects in Final Cut</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Rendering FXPlug Effects in Final Cut"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40005346-CH3" title="Rendering FXPlug Effects in Final Cut"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000418" target="_top">Apple Applications</a> &gt; <a href="../../../FinalCutProFinalCutExpress-date.html#//apple_ref/doc/uid/TP30000440-TP30000418-TP30000510" target="_top">Final Cut Pro/Final Cut Express</a> &gt; <a href="Rendering.html#//apple_ref/doc/uid/TP40005346-CH3-DontLinkElementID_16">Rendering FxPlug Effects in Final Cut</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <!-- Previous button --><span style="margin-left: 8px"><a href="../RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40005346-CH3-DontLinkElementID_16" title="Rendering FXPlug Effects in Final Cut"></a><h1>Rendering FXPlug Effects in Final Cut</h1>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="Rendering.html#//apple_ref/doc/uid/TP40005346-CH3-DontLinkElementID_1">Introduction</a>
				
			<br/>
			
        
			
			
				<a href="Rendering.html#//apple_ref/doc/uid/TP40005346-CH3-DontLinkElementID_2">Images in Final Cut</a>
				
			<br/>
			
        
			
			
				<a href="Rendering.html#//apple_ref/doc/uid/TP40005346-CH3-DontLinkElementID_6">The RT Display Path</a>
				
			<br/>
			
        
			
			
				<a href="Rendering.html#//apple_ref/doc/uid/TP40005346-CH3-DontLinkElementID_12">The Non-RT Display Path</a>
				
			<br/>
			
        
			
			
				<a href="Rendering.html#//apple_ref/doc/uid/TP40005346-CH3-DontLinkElementID_15">Mixed Formats</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40005346-CH3-DontLinkElementID_1" title="Introduction"></a><h2>Introduction</h2><p>Rendering scenarios in Final Cut can change from moment to moment—shifting dynamically, for example, from high quality Real Time rendering to medium quality Real Time rendering, and then back again. This is the result of the core design of Final Cut—where image processing takes place on native video images exactly as they come out of the codec—and product evolution over time.</p><p>If you are creating an FxPlug effect running under Final Cut, you need to take these changing circumstances into account and structure your code accordingly so that your effect renders appropriately at all times.</p><p>This document describes Final Cut rendering scenarios where your FxPlug effect may need to adapt. It also specifies the relevant information from Final Cut that you can use to detect changing rendering circumstances. </p><p>This document does <em>not</em> recommend particular strategies an effect might use to respond to a particular rendering scenario, since each effect may handle a particular scenario differently. For example, if an effect is running on a low-res proxy image in medium quality Real Time rendering, the general idea would be for the effect to adjust itself by the render scale to produce an image similar to what it would produce in full-res high-quality. In practice, this might mean that a blur would scale its kernel size by the render scale, a geometric effect would distort itself for half-height single fields, and a color corrector would do nothing. </p><a name="//apple_ref/doc/uid/TP40005346-CH3-DontLinkElementID_2" title="Images in Final Cut"></a><h2>Images in Final Cut</h2><a name="//apple_ref/doc/uid/TP40005346-CH3-DontLinkElementID_3" title="Interlaced footage in Final Cut  "></a><h3>Interlaced footage in Final Cut  </h3><p>Single-field images in Final Cut are not stretched to full-frame height. They are half the height of a full frame. Single-field images in Motion, on the other hand, <em>are</em> stretched (line-doubled) to full-frame height.  Your effect should handle both cases</p><p>You can use the -<code>upscalesFields</code> method in the FxHostCapabilities protocol to determine if single-field images are upscaled. This method returns a Boolean value: <code>TRUE</code> if the host application upscales single fields to full-frame dimensions; <code>FALSE</code> if the host application  does not upscale single fields. </p><p>Also, because single-field images are half the height of full-frame images, their aspect ratios are adjusted as well.  A single-field image in Final Cut has half the aspect ratio of the full frame.  For example, a DV frame has an aspect ratio of 0.8888; a single DV field has an aspect ratio of 0.4444. Plugins that care about aspect ratio should be ready for this variation. </p><p>In general, the documentation for FxHostCapabilities in the FxPlug SDK spells out other differences between host applications. </p><a name="//apple_ref/doc/uid/TP40005346-CH3-DontLinkElementID_4" title="Image coordinate systems"></a><h3>Image coordinate systems</h3><p>The origin of an image in Final Cut is in the top-left corner. The origin of an image in Motion, on the other hand, is in the bottom-left corner.  Your effect should handle both cases.  You can use the <code>FxImageOrigin</code> enumeration defined in the header file <code>FxImage.h</code> to determine the orientation of an image and avoid rendering upside down. (You cannot simply assume one coordinate system or the other.) </p><div class="codesample"><table><tr><td scope="row"><pre>enum {<span></span></pre></td></tr><tr><td scope="row"><pre>   kFxImageOrigin_BOTTOM_LEFT = 0,<span></span></pre></td></tr><tr><td scope="row"><pre>    kFxImageOrigin_TOP_LEFT = 2<span></span></pre></td></tr><tr><td scope="row"><pre>};<span></span></pre></td></tr><tr><td scope="row"><pre>typedef UInt32 FxImageOrigin;<span></span></pre></td></tr></table></div>	<a name="//apple_ref/doc/uid/TP40005346-CH3-DontLinkElementID_5" title="Rowbytes"></a><h3>Rowbytes</h3><p>Bitmaps in Final Cut have padded scanlines.  FxPlug effects should use the -rowBytes accessor defined in FxBitmap.h to discover how many bytes are in each scanline of a bitmap.  An effect should not overwrite any bytes in the padding of a scanline.  In a single-field image, the padding may contain the other field of an interlaced frame.  </p><a name="//apple_ref/doc/uid/TP40005346-CH3-DontLinkElementID_6" title="The RT Display Path"></a><h2>The RT Display Path</h2><p>During normal operation, your effect is called by Final Cut’s RT (RealTime) engine.  The RT engine is responsible for updating the video displayed in the canvas window and on any external monitor. The RT engine is engaged during playback and during “scrubbing.” </p><a name="//apple_ref/doc/uid/TP40005346-CH3-DontLinkElementID_7" title="Rendering characteristics"></a><h3>Rendering characteristics</h3><p>In general, the RT engine renders images at their native resolution.  This is because the same rendered frame is sent to both the canvas window and the external monitor.  Even if the canvas is displaying only one field, or even if the canvas is not displaying the entire image due to zooming or panning, both fields of the image are rendered at 100% resolution.</p><p>The RT engine renders each field of an interlaced image individually.  This is required since keyframed parameters may have different values in different fields.  </p><p>The RT engine renders fields in temporal order: the temporally first field is rendered first, the temporally second field is rendered second.</p><p>There is an exception to these rules: if the RT engine drops to a lower quality, it may render at a lower resolution, or only render a single field, or both.  (This is discussed in-depth in a later section.)</p><a name="//apple_ref/doc/uid/TP40005346-CH3-DontLinkElementID_8" title="Example 1: DV Footage"></a><h3>Example 1: DV Footage</h3><p>How does Final Cut call effects in a simple DV sequence?  Here is an example.</p><p>DV NTSC footage has been added to a sequence created with the DV NTSC preset.  Recall that the settings for DV NTSC are the following:</p><br/><div><img src = "../art/s1.jpg" alt = "sequence" ></div><br/><p>Now add an FxPlug filter effect to this item, and move the playhead to frame 5 of the sequence.  The FxPlug filter is called to render twice: once for the first field of frame 5, and once for the second field of frame 5. </p><a name="//apple_ref/doc/uid/TP40005346-CH3-DontLinkElementID_9"></a><h4></h4><p>During the rendering process, the following information is available to the effect:</p><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p></p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>FIrst Field</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Second Field</p></th></tr><tr><td  scope="row"><p><code>renderInfo</code></p></td><td ><p></p></td><td ><p></p></td></tr><tr><td  scope="row"><p><code>frame</code></p></td><td ><p><code>5.0</code></p></td><td ><p><code>5.5</code></p></td></tr><tr><td  scope="row"><p><code>qualityLevel</code></p></td><td ><p><code>kFxQuality_HIGH</code></p></td><td ><p><code>kFxQuality_HIGH</code></p></td></tr><tr><td  scope="row"><p><code>fieldOrder</code></p></td><td ><p><code>kFxFieldOrder_LOWER_FIRST</code></p></td><td ><p><code>kFxFieldOrder_LOWER_FIRST</code></p></td></tr><tr><td  scope="row"><p><code>scaleX</code></p></td><td ><p><code>1.0</code></p></td><td ><p><code>1.0</code></p></td></tr><tr><td  scope="row"><p><code>scaleY</code></p></td><td ><p><code>1.0</code></p></td><td ><p><code>1.0</code></p></td></tr><tr><td  scope="row"><p><code>depth</code></p></td><td ><p><code>kFxDepth_UINT8</code></p></td><td ><p><code>kFxDepth_UINT8</code></p></td></tr><tr><td  scope="row"><p><code>inputImage</code></p></td><td ><p></p></td><td ><p></p></td></tr><tr><td  scope="row"><p>-<code>-width</code></p></td><td ><p><code>720</code></p></td><td ><p><code>720</code></p></td></tr><tr><td  scope="row"><p><code>-height</code></p></td><td ><p><code>240</code></p></td><td ><p><code>240</code></p></td></tr><tr><td  scope="row"><p><code>-depth</code></p></td><td ><p><code>8</code></p></td><td ><p><code>8</code></p></td></tr><tr><td  scope="row"><p><code>-pixelAspect</code></p></td><td ><p><code>0.444444</code></p></td><td ><p><code>0.444444</code></p></td></tr><tr><td  scope="row"><p><code>-field</code></p></td><td ><p><code>kFxField_LOWER</code></p></td><td ><p><code>kFxField_UPPER</code></p></td></tr><tr><td  scope="row"><p><code>-fieldOrder</code></p></td><td ><p><code>kFxFieldOrder_LOWER_FIRST</code></p></td><td ><p><code>kFxFieldOrder_LOWER_FIRST</code></p></td></tr><tr><td  scope="row"><p><code>output</code></p></td><td ><p></p></td><td ><p></p></td></tr><tr><td  scope="row"><p>-<code>-width</code></p></td><td ><p><code>720</code></p></td><td ><p><code>720</code></p></td></tr><tr><td  scope="row"><p><code>-height</code></p></td><td ><p><code>240</code></p></td><td ><p><code>240</code></p></td></tr><tr><td  scope="row"><p><code>-depth</code></p></td><td ><p><code>8</code></p></td><td ><p><code>8</code></p></td></tr><tr><td  scope="row"><p><code>-pixelAspect</code></p></td><td ><p><code>0.444444</code></p></td><td ><p><code>0.444444</code></p></td></tr><tr><td  scope="row"><p><code>-field</code></p></td><td ><p><code>kFxField_LOWER</code></p></td><td ><p><code>kFxField_UPPER</code></p></td></tr><tr><td  scope="row"><p><code>-fieldOrder</code></p></td><td ><p><code>kFxFieldOrder_LOWER_FIRST</code></p></td><td ><p><code>kFxFieldOrder_LOWER_FIRST</code></p></td></tr></table></div><p>Note these general points:</p><ul class="spaceabove"><li class="li"><p>The input and output images are full-frame width, but half-frame height.  </p></li><li class="li"><p>The images’ aspect ratios have been divided by two.</p></li><li class="li"><p>The temporally first field is rendered first.</p></li></ul><p>When Final Cut renders the second field, the information is identical except that the frame number is been incremented by 0.5 because this is the temporally second field. The input and output images are now marked as the upper field of the frame. </p><p>Effects that pay attention to frame numbers should not be surprised to receive fractional frame numbers on interlaced sequences. </p><a name="//apple_ref/doc/uid/TP40005346-CH3-DontLinkElementID_10" title="Low, Medium, and Dynamic Quality in RT"></a><h3>Low, Medium, and Dynamic Quality in RT</h3><p>In some circumstances, sequences cannot play back in realtime on all machines. When this happens, the RT engine can adjust quality in several ways in order to maintain reasonable playback performance. </p><p>The RT menu in the timeline provides various options that let the user control RT performance. The “Playback Video Quality” section of the menu is the most interesting for FxPlug developers. </p><br/><div><img src = "../art/s2.jpg" alt = "image: ../art/s2.jpg" ></div><br/><p>￼The setting for Playback Video Quality is passed as a hint to the codec when video is decompressed during playback.  Depending on this setting, the codec may produce a smaller image at lower quality, or only decompress one field instead of an interlaced frame.  The actual behavior is up to the codec.</p><p>In general, medium quality is half the resolution of high quality, and low quality (if the codec supports it) is one fourth the resolution of high quality.</p><p>By default, Playback Video Quality is set to Dynamic. This means that the RT engine, in order to maintain the frame rate, adjusts quality <em>during playback</em>.  If the RT engine cannot maintain playback at high quality, it shifts to medium quality—and then may shift back to high quality subsequently if it detects that it can.  </p><p><em>The key point is this: your effect should be ready for quality changes in the middle of playback.</em> You should not assume that image dimensions and renderInfo.scale will be constant from one frame to another. </p><p>Also note that by default, the RT engine is set to “Scrub High Quality.”  This means that rendering may drop to a lower quality during playback. </p><p>In “Safe RT” mode, the RT engine only renders effects during playback if it has profiled these effects and knows how fast they can render.  Since the RT engine cannot profile third-party effects, including FxPlug effects, these effects are not rendered during playback in Safe RT mode. (Unprofiled effects are rendered during scrub.)</p><p>To display rendered FxPlug effects during playback, the Final Cut user must switch to the Unlimited RT setting. In this mode, the RT engine attempts to render everything as quickly as possible. (If the playback quality is set to Dynamic, the RT engine may degrade playback quality in order to maintain playback speed.)</p><p><strong>Tip</strong>: To test your filter at lower quality settings, change the video playback quality to “Medium” or “Low” and turn “Scrub High Quality” off. In your render method, your plug-in should respond appropriately to changes in renderInfo.scale.</p><a name="//apple_ref/doc/uid/TP40005346-CH3-DontLinkElementID_11" title="Example 2: DV Footage at medium quality"></a><h3>Example 2: DV Footage at medium quality</h3><p>In the same DV sequence as Example 1, let’s switch the Playback Video Quality to Medium, turn off “Scrub High Quality,” and render frame 5 again. With Medium quality, the DV NTSC codec produces 360 x 240 progressive frames.  By throwing away the temporally second field, and half of the pixels in the temporally first field, the codec greatly reduces the time needed to decompress a frame. This helps speed up playback.</p><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p></p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>High Quality</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Medium Quality</p></th></tr><tr><td  scope="row"><p><code>renderInfo</code></p></td><td ><p></p></td><td ><p></p></td></tr><tr><td  scope="row"><p><code>frame</code></p></td><td ><p><code>5.0</code></p></td><td ><p><code>5.0</code></p></td></tr><tr><td  scope="row"><p><code>qualityLevel</code></p></td><td ><p><code>kFxQuality_HIGH</code></p></td><td ><p><code>kFxQuality_MEDIUM</code></p></td></tr><tr><td  scope="row"><p><code>fieldOrder</code></p></td><td ><p><code>kFxFieldOrder_LOWER_FIRST</code></p></td><td ><p><code>kFxFieldOrder_LOWER_FIRST</code></p></td></tr><tr><td  scope="row"><p><code>scaleX</code></p></td><td ><p><code>1.0</code></p></td><td ><p><code>0.5</code></p></td></tr><tr><td  scope="row"><p><code>scaleY</code></p></td><td ><p><code>1.0</code></p></td><td ><p><code>0.5</code></p></td></tr><tr><td  scope="row"><p><code>depth</code></p></td><td ><p><code>kFxDepth_UINT8</code></p></td><td ><p><code>kFxDepth_UINT8</code></p></td></tr><tr><td  scope="row"><p><code>inputImage</code></p></td><td ><p></p></td><td ><p></p></td></tr><tr><td  scope="row"><p>-<code>-width</code></p></td><td ><p><code>720</code></p></td><td ><p><code>360</code></p></td></tr><tr><td  scope="row"><p><code>-height</code></p></td><td ><p><code>240</code></p></td><td ><p><code>240</code></p></td></tr><tr><td  scope="row"><p><code>-depth</code></p></td><td ><p><code>8</code></p></td><td ><p><code>8</code></p></td></tr><tr><td  scope="row"><p><code>-pixelAspect</code></p></td><td ><p><code>0.444444</code></p></td><td ><p><code>0.888888</code></p></td></tr><tr><td  scope="row"><p><code>-field</code></p></td><td ><p><code>kFxField_LOWER</code></p></td><td ><p><code>kFxField_NONE</code></p></td></tr><tr><td  scope="row"><p><code>-fieldOrder</code></p></td><td ><p><code>kFxFieldOrder_LOWER_FIRST</code></p></td><td ><p><code>kFxFieldOrder_LOWER_FIRST</code></p></td></tr><tr><td  scope="row"><p><code>output</code></p></td><td ><p></p></td><td ><p></p></td></tr><tr><td  scope="row"><p>-<code>-width</code></p></td><td ><p><code>720</code></p></td><td ><p><code>360</code></p></td></tr><tr><td  scope="row"><p><code>-height</code></p></td><td ><p><code>240</code></p></td><td ><p><code>240</code></p></td></tr><tr><td  scope="row"><p><code>-depth</code></p></td><td ><p><code>8</code></p></td><td ><p><code>8</code></p></td></tr><tr><td  scope="row"><p><code>-pixelAspect</code></p></td><td ><p><code>0.444444</code></p></td><td ><p><code>0.444444</code></p></td></tr><tr><td  scope="row"><p><code>-field</code></p></td><td ><p><code>kFxField_LOWER</code></p></td><td ><p><code>kFxField_NONE</code></p></td></tr><tr><td  scope="row"><p><code>-fieldOrder</code></p></td><td ><p><code>kFxFieldOrder_LOWER_FIRST</code></p></td><td ><p><code>kFxFieldOrder_PROGRESSIVE</code></p></td></tr></table></div><p>The filter is only called to render once per frame.  The right row of the table (MEDIUM QUALITY) displays the information passed to the filter. Note how this differs from rendering in high quality:</p><ul class="spaceabove"><li class="li"><p>The renderInfo’s scaleX and scaleY are set to 0.5.</p></li><li class="li"><p>The input and output dimensions are half of the full resolution. (This matches the renderInfo.scale values.)</p></li><li class="li"><p>The input and output images are set to kFxField_NONE.</p></li><li class="li"><p>The output image is set to kFxFieldOrder_PROGRESSIVE.</p></li></ul><p>The DV codec returns the same result for low quality as for medium quality.  For an example a situation where low quality is different than medium quality, try one of the 1080i settings.</p><a name="//apple_ref/doc/uid/TP40005346-CH3-DontLinkElementID_12" title="The Non-RT Display Path"></a><h2>The Non-RT Display Path</h2><p>In addition to the RT engine, Final Cut has another display path which is sometimes used to draw video to the canvas window and external devices.  This display path predates the RT engine, and is used for certain display options which aren’t supported by the RT display path.  These options include:</p><ul class="ul"><li class="li"><p>Show Excess Luma or Chroma.</p></li><li class="li"><p>Display White or Checkerboard background.</p></li><li class="li"><p>View individual channels (red, green, blue, or alpha).</p></li><li class="li"><p>Use the Animation codec (specified in Sequence settings) rather than the DV codec.</p></li></ul><a name="//apple_ref/doc/uid/TP40005346-CH3-DontLinkElementID_13" title="Rendering characteristics "></a><h3>Rendering characteristics </h3><p>Unlike the RT engine, the Non-RT display path does not display the same image in both the canvas window and the external monitor.  When updating a frame, the Non-RT engine renders an image for display in the window, and then renders another image later to send to the external monitor.  The external monitor is updated at idle time, so if you are scrubbing quickly you may notice that the canvas window updates more frequently than the external device.</p><p>When the Non-RT display path renders an image for the canvas window, it renders only what will be visible in the window.  If a single field is being displayed in the window, the Non-RT path does not render both fields.  If the window is zoomed so that the image in the window is smaller than the actual frame size, the Non-RT path renders a scaled-down version of the frame.</p><p><strong>Note</strong>: the Non-RT path has another quirk.  If the canvas is set to “Show as Square Pixels” (the default), the Non-RT path renders a frame that is horizontally scaled by the aspect ratio and that is marked as having an aspect ratio of 1.0.  This is in keeping with the approach of rendering just what is displayed in the canvas window.  Currently, the FxPlug rendering code stretches the image horizontally to undo this, so FxPlug effects do not need to handle this case.  </p><a name="//apple_ref/doc/uid/TP40005346-CH3-DontLinkElementID_14" title="Example: DV Footage in the Non-RT display path"></a><h3>Example: DV Footage in the Non-RT display path</h3><p>To create an example using the Non-RT rendering path, you can turn on “Show Excess Luma:”</p><br/><div><img src = "../art/s3.jpg" alt = "image: ../art/s3.jpg" ></div><br/><p>With the canvas window set to 87% of scale, frame 5 now renders with the Non-RT path, which returns the following information:</p><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p></p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>RT Rendering</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Non-RT Rendering</p></th></tr><tr><td  scope="row"><p><code>renderInfo</code></p></td><td ><p></p></td><td ><p></p></td></tr><tr><td  scope="row"><p><code>frame</code></p></td><td ><p><code>5.0</code></p></td><td ><p><code>5.0</code></p></td></tr><tr><td  scope="row"><p><code>qualityLevel</code></p></td><td ><p><code>kFxQuality_HIGH</code></p></td><td ><p><code>kFxQuality_HIGH</code></p></td></tr><tr><td  scope="row"><p><code>fieldOrder</code></p></td><td ><p><code>kFxFieldOrder_LOWER_FIRST</code></p></td><td ><p><code>kFxFieldOrder_LOWER_FIRST</code></p></td></tr><tr><td  scope="row"><p><code>scaleX</code></p></td><td ><p><code>1.0</code></p></td><td ><p><code>0.87</code></p></td></tr><tr><td  scope="row"><p><code>scaleY</code></p></td><td ><p><code>1.0</code></p></td><td ><p><code>0.87</code></p></td></tr><tr><td  scope="row"><p><code>depth</code></p></td><td ><p><code>kFxDepth_UINT8</code></p></td><td ><p><code>kFxDepth_UINT8</code></p></td></tr><tr><td  scope="row"><p><code>inputImage</code></p></td><td ><p></p></td><td ><p></p></td></tr><tr><td  scope="row"><p>-<code>-width</code></p></td><td ><p><code>720</code></p></td><td ><p><code>626</code></p></td></tr><tr><td  scope="row"><p><code>-height</code></p></td><td ><p><code>240</code></p></td><td ><p><code>417</code></p></td></tr><tr><td  scope="row"><p><code>-depth</code></p></td><td ><p><code>8</code></p></td><td ><p><code>8</code></p></td></tr><tr><td  scope="row"><p><code>-pixelAspect</code></p></td><td ><p><code>0.444444</code></p></td><td ><p><code>1.000000</code></p></td></tr><tr><td  scope="row"><p><code>-field</code></p></td><td ><p><code>kFxField_LOWER</code></p></td><td ><p><code>kFxField_NONE</code></p></td></tr><tr><td  scope="row"><p><code>-fieldOrder</code></p></td><td ><p><code>kFxFieldOrder_LOWER_FIRST</code></p></td><td ><p><code>kFxFieldOrder_LOWER_FIRST</code></p></td></tr><tr><td  scope="row"><p><code>output</code></p></td><td ><p></p></td><td ><p></p></td></tr><tr><td  scope="row"><p>-<code>-width</code></p></td><td ><p><code>720</code></p></td><td ><p><code>626</code></p></td></tr><tr><td  scope="row"><p><code>-height</code></p></td><td ><p><code>240</code></p></td><td ><p><code>417</code></p></td></tr><tr><td  scope="row"><p><code>-depth</code></p></td><td ><p><code>8</code></p></td><td ><p><code>8</code></p></td></tr><tr><td  scope="row"><p><code>-pixelAspect</code></p></td><td ><p><code>0.444444</code></p></td><td ><p><code>0.888889</code></p></td></tr><tr><td  scope="row"><p><code>-field</code></p></td><td ><p><code>kFxField_LOWER</code></p></td><td ><p><code>kFxField_NONE</code></p></td></tr><tr><td  scope="row"><p><code>-fieldOrder</code></p></td><td ><p><code>kFxFieldOrder_LOWER_FIRST</code></p></td><td ><p><code>kFxFieldOrder_PROGRESSIVE</code></p></td></tr></table></div><p>There are several differences here. The most noticeable is that the image is smaller than DV size because the canvas window is set to 87% scale. As a result, renderInfo has a scale of 0.87, and the input and output dimensions are 87% of DV size.</p><p>Another difference: because the canvas window is not at 100% zoom, the Non-RT path only renders and displays one field.</p><p><strong>IMPORTANT:</strong> When you use the non-RT path, you may see some incorrect pixel aspect and field order values associated with the input image. In the example here, the pixel aspect for the input image should be should be 0.888889 and field order should be kFxFieldOrder_PROGRESSIVE. To avoid problems, you should only use the pixel aspect and field order values from the output image.</p><p>If there is an external device connected, the FxPlug filter is called again to render the image for this external device.  In this case, the information sent to the filter is easily understandable: the frame is DV size at 100% scale, both fields are rendered, and so on.</p><a name="//apple_ref/doc/uid/TP40005346-CH3-DontLinkElementID_15" title="Mixed Formats"></a><h2>Mixed Formats</h2><p>Mixed-format timelines have items that are in a format different from the timeline format.  Common examples  would be SD footage in an HD sequence, or a still image in a sequence.</p><p>The RT engine and the Non-RT engine handle mixed formats differently. When an effect is applied to a mixed format timeline, its render method is called one way for RT scrubbing and playback and another way for a movie. In the RT rendering engine, all items are scaled to sequence size before the effect is applied.  In Non-RT rendering, the effect is applied to the item at its native resolution.</p><p>You can use the renderInfo.scale value to detect when an item is being scaled for RT display.  However, this value is not set in the way you might expect.</p><p>Consider a 720p item in a DV NTSC sequence.  In RT, the following information is sent:</p><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><tr><td  scope="row"><p><code>renderInfo</code></p></td><td ><p></p></td></tr><tr><td  scope="row"><p><code>scaleX</code></p></td><td ><p><code>1.000000</code></p></td></tr><tr><td  scope="row"><p><code>scaleY</code></p></td><td ><p><code>1.000000</code></p></td></tr><tr><td  scope="row"><p><code>inputImage</code></p></td><td ><p></p></td></tr><tr><td  scope="row"><p><code>-width</code></p></td><td ><p><code>720</code></p></td></tr><tr><td  scope="row"><p><code>-height</code></p></td><td ><p><code>202</code></p></td></tr><tr><td  scope="row"><p><code>output</code></p></td><td ><p></p></td></tr><tr><td  scope="row"><p><code>-width</code></p></td><td ><p><code>720</code></p></td></tr><tr><td  scope="row"><p><code>-height</code></p></td><td ><p><code>202</code></p></td></tr></table></div><p>When the sequence is rendered, the following information is sent: </p><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><tr><td  scope="row"><p><code>renderInfo</code></p></td><td ><p></p></td></tr><tr><td  scope="row"><p><code>scaleX</code></p></td><td ><p><code>1.777778202</code></p></td></tr><tr><td  scope="row"><p><code>scaleY</code></p></td><td ><p><code>1.777778</code></p></td></tr><tr><td  scope="row"><p><code>inputImage</code></p></td><td ><p></p></td></tr><tr><td  scope="row"><p><code>-width</code></p></td><td ><p><code>1280</code></p></td></tr><tr><td  scope="row"><p><code>-height</code></p></td><td ><p><code>360</code></p></td></tr><tr><td  scope="row"><p><code>output</code></p></td><td ><p></p></td></tr><tr><td  scope="row"><p><code>-width</code></p></td><td ><p><code>1280</code></p></td></tr><tr><td  scope="row"><p><code>-height</code></p></td><td ><p><code>360</code></p></td></tr></table></div><p>Note that in RT, the HD image is scaled to fit into a DV frame.  The width / height aspect is maintained, so the (single-field) image is scaled to 720 x 202; this is to fit inside the 720 x 240 DV field.</p><p>In Non-RT rendering, the HD image is at full resolution.  The scale value is set to a number greater than 1.0.  This tells the effect that the image will be scaled down after render to fit into the sequence.</p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <!-- Previous button --><span style="margin-left: 8px"><a href="../RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-05-21<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleApplications/Conceptual/FxPlug_Rendering_Effects_FCP/Rendering/Rendering.html%3Fid%3DTP40005346-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleApplications/Conceptual/FxPlug_Rendering_Effects_FCP/Rendering/Rendering.html%3Fid%3DTP40005346-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleApplications/Conceptual/FxPlug_Rendering_Effects_FCP/Rendering/Rendering.html%3Fid%3DTP40005346-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>