<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>UpdateResFile (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING66></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-65.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-67.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-9.html"><B>Chapter 1 - Resource Manager</B></A> / <A HREF="MoreToolbox-24.html"><B>Resource Manager Reference</B></A><BR><DL><DD><A HREF="MoreToolbox-30.html"><B>Resource Manager Routines</B></A> / <A HREF="MoreToolbox-65.html"><B>Writing to Resource Forks</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING66-0></A>
<H3><A NAME=MARKER-9-349></A>UpdateResFile</H3>
 <A NAME=MARKER-11-350></A><A NAME=MARKER-2-351></A>You can use the <CODE>UpdateResFile</CODE> procedure to update the resource map and resource data for a resource fork without closing it.<P>
<PRE>
PROCEDURE UpdateResFile (refNum: Integer);
</PRE>
<DL>
<DT><CODE>refNum</CODE>
<DD> A file reference number for a resource fork.
</DL>
<A NAME=HEADING66-4></A>
<H5>DESCRIPTION</H5>
 Given the reference number of a file whose resource fork is open, <CODE>UpdateResFile</CODE> performs three tasks. The first task is to change, add, or remove resource data in the <BR>file's resource fork to match the resource map in memory. Changed resource data for each resource is written only if that resource's <CODE>resChanged</CODE> bit has been set by a successful call to <CODE>ChangedResource</CODE> or <CODE>AddResource</CODE>. The <CODE>UpdateResFile</CODE> procedure calls the <CODE>WriteResource</CODE> procedure to write changed or added resources to the resource fork.<P>
 The second task is to compact the resource fork, closing up any empty space created when a resource was removed, made smaller, or made larger. If a resource is made larger, the Resource Manager writes it at the end of the resource fork rather than at its original location. It then compacts the space occupied by the original resource data. The actual size of the resource fork is adjusted when a resource is removed or made larger, but not when a resource is made smaller.<P>
 The third task is to write the resource map in memory to the resource fork if your application has called the <CODE>ChangedResource</CODE> procedure for any resource listed in the resource map or if it has added or removed a resource. All changes to resource information in the resource map become permanent at this time; if you want any of these changes to be temporary, you must restore the original information before calling <CODE>UpdateResFile</CODE>.<P>
 If there's no open resource fork with the given reference number, <CODE>UpdateResFile</CODE> <BR>does nothing, and the <CODE>ResError</CODE> function returns the result code <CODE>resNotFound</CODE>. If the value of the <CODE>refNum</CODE> parameter is 0, it represents the System file's resource fork. If you call <CODE>UpdateResFile</CODE> but the <CODE>mapReadOnly</CODE> attribute of the resource fork is set, <CODE>UpdateResFile</CODE> does nothing, and the <CODE>ResError</CODE> function returns the result code <CODE>resAttrErr</CODE>.<P>
 Because the <CODE>CloseResFile</CODE> procedure calls <CODE>UpdateResFile</CODE> before it closes the resource fork, you need to call <CODE>UpdateResFile</CODE> directly only if you want to update the file without closing it.<P>
<A NAME=HEADING66-10></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>resNotFound<TD>-192<TD>Resource not found<TR>
<TD>resAttrErr<TD>-198<TD>Attribute inconsistent with operation</TABLE>
</H5>
<A NAME=HEADING66-11></A>
<H5>SEE ALSO</H5>
 To check for errors, call the <CODE>ResError</CODE> function as described on <A HREF=MoreToolbox-35.html#MARKER-9-220>page 1-47</A>.<P>
 For an example of the use of <CODE>UpdateResFile</CODE>, see <A HREF=MoreToolbox-22.html#MARKER-9-180>Listing 1-11 on page 1-32</A>. For descriptions of the <CODE>ChangedResource</CODE>, <CODE>AddResource</CODE>, and <CODE>CloseResFile</CODE> procedures, see <A HREF=MoreToolbox-63.html#MARKER-9-338>page 1-83</A>, <A HREF=MoreToolbox-64.html#MARKER-9-342>page 1-85</A>, and <A HREF=MoreToolbox-89.html#MARKER-9-432>page 1-104</A>, respectively. The <BR><CODE>WriteResource</CODE> procedure is described next. <A NAME=MARKER-2-352></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-65.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-67.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
