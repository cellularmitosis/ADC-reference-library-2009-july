<HTML>		<HEAD>        <title>ExaminingYour Project</title>		</HEAD>	<BODY bgcolor="#ffffff">		<!-- start of header -->		<!--#include virtual="/includes/framesetheader" -->		<!-- end of header --><!-- start of path --><table cellspacing=0 border=0 width=600 valign="left"><tr><td scope="row"><font face="Geneva,Helvetica,Arial" size="1"><b>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="../../../index.html">Documentation</a> <b>></b> <a href="../../webobjects.html" target="_top">WebObjects</a></font></td></tr></table><br><!-- end of path --><a href="Designing_the_Main_Page.html" target="_right"><img src="../Images/previous.gif" border="0" alt="Previous"></a><a href="Refining_Main.wo.html" target="_right"><img src="../Images/next.gif" border="0" alt="Next"></a>&nbsp;<br><!-- apple_doc: pageHeadingStart --><a name = "TPXREF119"></a><h2><font face="Helvetica,Arial,Lucida Grande">ExaminingYour Project</font></h2><!-- apple_doc: pageHeadingEnd --><p><font face="Times">Whenever you create a new project, Project Builder populatesthe project with ready-made files and directories. What it includesdepends on the choices you make in the wizard, so this project hasa set of files different from those of the GuestBook project.</font></p><p><font face="Times">Like GuestBook, the Movies project contains a Main component(<code>Main.wo</code>). It also includes somefiles that the GuestBook doesn't have: a model file, and imagesused by the Main component.</font></p><p><font face="Times">In Project Builder, navigate to the Movie project's Resourcescategory. This is where the model, named <code>Movies.eomodeld</code>,is located. Later in this tutorial you'll use EOModeler to openthe model and enhance it.</font></p><P><img src = "../Art/projreso.gif" alt = "[image: ../Art/projreso.gif]"><p><font face="Times">Navigate to the Web Server Resources category. This is whereyour project's images are located: <code>DBWizardUpdate.gif</code>, <code>DBWizardDelete.gif</code>,and <code>DBWizardInsert.gif</code>,for the "Save to database," "Delete", and "Insert/New"buttons, respectively.</font></p><p><font face="Times">The biggest difference between the GuestBook and Movies projectsis their Main components. Whereas the Main component you createdfor the GuestBook project was empty, the Main component for theMovies project contains a fully functional user interface. Also,the <code>Main.java</code> class alreadycontains code that supplies the component with behavior. In thenext sections, you'll examine the Movies project's <code>Main.wo</code> componentand its <code>Main.java</code> class.</font></p><a name = "TPXREF120"></a><h3><font face="Helvetica,Arial,Lucida Grande">Examiningthe Variables</font></h3><ol><p><li>Double-click <code>Main.wo</code> inProject Builder's Web Components category to open the Main componentin WebObjects Builder.<p>There are four variables in the objectbrowser: the <code>application</code> and <code>session</code> variables thatare available in all components and two others, <code>movie</code> and <code>movieDisplayGroup</code>.</p><p>The<code> movie</code> variableis an enterprise object that represents a row fetched from the MOVIEtable. <code>movieDisplayGroup</code> isa <em>display group</em>-an object that interactswith a database, indirectly through classes in the Enterprise ObjectsFramework. Display groups are used to fetch, insert, update, anddelete enterprise objects that are associated with a single entity.The entity of <code>movieDisplayGroup</code> isMovie, which you specified in the wizard's "Choose an entity"page.</p></li></p><p><li>In Project Builder, look at the class file <code>Main.java</code> tosee how <code>movie</code> is declared.<p>The <code>movie</code> declaration(shown below) declares <code>movie</code> tobe an EOEnterpriseObject-a Java interface that describes the generalbehavior that all enterprise objects must have.</p><pre>    /** @TypeInfo Movie */     protected EOEnterpriseObject movie;</pre><p>Atruntime, <code>movie</code> is a EOGenericRecordobject. Recall that EOGenericRecord is used to represent enterpriseobjects unless you specify a custom class. Since you didn't check the"Use custom enterprise objects" box in the wizard's "Choosewhat to include in your model" page, your application uses EOGenericRecordfor all its entities.</p><p>The comment (/** @TypeInfo Movie*/) is used by WebObjects Builder to identify <code>movie</code>'sentity (Movie). Knowing the entity allows WebObjects Builder todisplay <code>movie</code>'s attributes(<code>category</code>, <code>dateReleased</code>,and so on). You can see <code>movie</code>'sattributes if you select the <code>movie</code> variablein the WebObjects Builder's object browser.</p></li></p><p><li>In Project Builder, examine the <code>movieDisplayGroup</code> declarationin <code>Main.java</code>.<p>Thedeclaration (shown below) declares <code>movieDisplayGroup</code> tobe a WODisplayGroup.</p><pre>    protected WODisplayGroup movieDisplayGroup;</pre><p>Alsonote the comment explaining how <code>movieDisplayGroup</code> isinitialized. The <code>Main.java</code> classdoesn't have any code to create and initialize the display group.Instead, it's instantiated from an archive file, <code>Main.woo</code>,that's stored in the <code>Main.wo</code> component.You shouldn't edit <code>woo</code> filesby hand; they're maintained by WebObjects Builder. The <code>woo</code> file archivingmechanism is described in more detail later in  <a href="Refining_Main.wo.html#BCIJJBDJ" target = "_right">"Specifying a Sort Order"</a>.</p></li></p></ol><a name = "TPXREF121"></a><h3><font face="Helvetica,Arial,Lucida Grande">Examiningthe Bindings</font></h3><p><font face="Times">Now examine the bindings of your Main component in WebObjectsBuilder.</font></p><P><img src = "../Art/mainwo.gif" alt = "[image: ../Art/mainwo.gif]"><p><font face="Times"></font></p><p><font face="Times">Remember that you can use WebObjects Builder's Inspectorto see the bindings for an element's attributes. Simply selectthe element to inspect, and click the </font><img src = "../Art/inspector.gif" alt = "[image: ../Art/inspector.gif]"><font face="Times"> button to open the Inspector.</font></p><a name = "TPXREF122"></a><h4><font face="Helvetica,Arial,Lucida Grande">Bindingsin the Query Part</font></h4><p><font face="Times">In the query part of the component, <code>movieDisplayGroup.queryMatch.title</code> isbound to the title text field. There are similar bindings to thecategory text fields. The <code>queryMatch</code> bindingsallow users to specify search criteria to use when <code>movieDisplayGroup</code> nextfetches movies. The Match button is bound to <code>movieDisplayGroup.qualifyDataSource</code>,that actually performs the fetch.</font></p><p><font face="Times">For example, to display all comedies, a user types "Comedy"in the Category text field, and clicks the Match button. <code>movieDisplayGroup</code> thenrefetches, selecting only movies whose <code>category</code> valuesare set to Comedy.</font></p><P><img src = "../Art/queryprt.gif" alt = "[image: ../Art/queryprt.gif]"><a name = "TPXREF123"></a><h4><font face="Helvetica,Arial,Lucida Grande">Bindingsin the Repetition Part</font></h4><p><font face="Times">In the repetition part of the component where matching moviesare listed, <code>movieDisplayGroup.displayedObjects</code> isbound to a repetition. More specifically, <code>displayedObjects</code> isbound to the repetition's <code>list</code> attribute,providing an array of movies for the repetition to iterate over.</font></p><p><font face="Times">The <code>movie</code> variableis bound to the repetition's <code>item</code> attributeto hold each movie in turn, and <code>movie.title</code> isbound to the string element inside the repetition. These bindings producea list of movie titles.</font></p><P><img src = "../Art/repprt.gif" alt = "[image: ../Art/repprt.gif]"><p><font face="Times"></font></p><p><font face="Times">The repetition's string element is enclosed in a hyperlink.By clicking a movie title, the user <em>selects</em> thecorresponding movie.</font></p><ol><p><li>Inspect thehyperlink.<p>Its <code>action</code> attributeis bound to the action method <code>selectObject</code>.</p><P><img src = "../Art/linkinsp.gif" alt = "[image: ../Art/linkinsp.gif]"></li></p><p><li>Look in the <code>Main.java</code> classto see how the <code>selectObject</code> methodis implemented.<p>The method (shown below) simply sets the selectedobject of <code>movieDisplayGroup</code> tothe movie the user clicked.</p><pre>    public void selectObject() {         movieDisplayGroup.selectObject(movie);     }</pre></li></p></ol><a name = "TPXREF124"></a><h4><font face="Helvetica,Arial,Lucida Grande">Bindingsin the Editing Part</font></h4><p><font face="Times">The text fields in the editing part are all bound to attributesof the <code>movieDisplayGroup </code>object's<code> selectedObject</code>-themovie on which the user clicked. Typing new values into these fieldsupdates the Movie enterprise object. To actually save the updatedvalues to the database, the user must click the "Save to database"button.</font></p><P><img src = "../Art/editprt.gif" alt = "[image: ../Art/editprt.gif]"><ol><p><li>Inspect themiddle image button.<p>Its <code>action</code> attributeis bound to the action method <code>saveChanges</code>.</p></li></p><p><li>Look in the <code>Main.java</code> classto see how <code>saveChanges</code> isimplemented.<p>The method (shown below with comments omitted)simply saves any changes that have been made to <code>movieDisplayGroup</code>'sobjects to the database.</p><pre>    public void saveChanges() throws Exception {        try {            this.session().defaultEditingContext().saveChanges();        }        catch (Exception exception) {            NSLog.err.appendln("Cannot save changes ");            throw exception;        }    }</pre><p><code>this.session()</code> returnsa Session object that represents a connection to the application bya single user. A Session object provides access to an EOEditingContextobject. The expression</p><pre>    this.session().defaultEditingContext().saveChanges();</pre><p>sendsa <code>saveChanges</code> messageto the Session's <code>defaultEditingContext</code>.This default EOEditingContext object manages graphs of objects fetchedfrom the database, and all changes to the database are saved throughit. For more information, see the EOEditingContext class specificationin the <em>Enterprise Objects Framework Reference</em>.</p><p>AnEOEditingContext's <code>saveChanges</code> methoduses other Enterprise Objects Framework objects to analyze its networkof enterprise objects (Movie objects referenced by the application)for changes and then to perform a set of corresponding operationsin the database. If an error occurs during this process, <code>saveChanges</code> throwsan exception. The <code>Main.java</code> <code>saveChanges</code> methodsimply raises the exception, having the effect of returning a diagnosticpage. You could return an error page that explains the reason for thesave failure instead, but the application in this tutorial usesthe default behavior.</p></li></p><p><li>Inspect the first and third image buttons to see what their <code>action</code> attributesare bound to.<p>They are bound to the <code>movieDisplayGroup.insert</code> and <code>movieDisplayGroup.delete</code> methodsrespectively. The WODisplayGroup <code>insert</code> methodcreates a new enterprise object, then inserts it into the displaygroup's list of objects just past the current selection. The WODisplayGroup <code>delete</code> methoddeletes the display group's selected object. These changes happenonly in memory-not in the database. To actually insert a new rowin the database (or delete a row), the user must click the "Saveto database" button, invoking <code>saveChanges</code> onthe session's EOEditingContext. The editing context analyzes theenterprise objects in memory; determines if any objects have beenadded, updated, or deleted; and then executes database operationsto sync the database with the application.</p></li></p></ol>    <br><a href="Designing_the_Main_Page.html" target="_right"><img src="../Images/previous.gif" border="0" alt="Previous"></a><a href="Refining_Main.wo.html" target="_right"><img src="../Images/next.gif" border="0" alt="Next"></a>&nbsp;<p><font face="Geneva,Helvetica,Arial" size="1">&#169; 2001 Apple Computer, Inc.</font></p><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></html>