<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>BatteryStatus(IM: D)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING262></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->




<!-- Main Body -->

<CENTER>
<P>
<A HREF="Devices-261.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Devices-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Devices-328.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Devices-263.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Devices-2.html"><B>Devices</B></A> / <BR><DD><A HREF="Devices-230.html"><B>Chapter 6 - Power Manager</B></A> / <A HREF="Devices-233.html"><B>Power Manager Reference</B></A><BR><DL><DD><A HREF="Devices-240.html"><B>Power Manager Routines</B></A> / <A HREF="Devices-261.html"><B>Reading the Status of the Battery and the Battery Charger</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING262-0></A>
<H3><A NAME=MARKER-11-254></A>BatteryStatus<A NAME=MARKER-2-255></A></H3>
 You can use the <CODE>BatteryStatus</CODE> function to get information about the state of the internal battery.<P>
<PRE>
FUNCTION BatteryStatus (VAR Status: Byte; VAR Power: Byte): OSErr;
</PRE>
<DL>
<DT><CODE>Status</CODE>
<DD> On exit, a byte value whose bits encode information about the current state of the battery charger. See the description below for the meaning of each bit.
<DT><CODE>Power</CODE>
<DD> On exit, a byte whose value indicates the current level of the battery voltage. See the description below for a method of calculating the voltage from this value.
</DL>
<A NAME=HEADING262-5></A>
<H5>DESCRIPTION</H5>
 The <CODE>BatteryStatus</CODE> function returns the status of the battery charger (in the <CODE>Status</CODE> parameter) and the voltage level of the battery (in the <CODE>Power</CODE> parameter).<P>
 Bits 0 through 5 of the <CODE>Status</CODE> parameter encode information about the state of the battery charger. (Currently, bits 6 and 7 are reserved.) The Power Manager recognizes the following constants for specifying bits in the <CODE>Status</CODE> parameter.<P>
<PRE>
CONST
   chargerConnBit          = 0;     {1 if charger is connected}
   hiChargeBit             = 1;     {1 if charging at hicharge rate}
   chargeOverFlowBit       = 2;     {1 if hicharge counter has overflowed}
   batteryDeadBit          = 3;     {always 0}
   batteryLowBit           = 4;     {1 if battery is low}
   connChangedBit          = 5;     {1 if charger connection has changed}
</PRE>
<B>Constant descriptions</B><P>
<DL>
<DT><CODE>chargerConnBit</CODE>
<DD> The charger is or is not connected. If this bit is set, the battery charger is connected to the computer.
<DT><CODE>hiChargeBit</CODE>
<DD> The charge rate. If this bit is set, the battery is charging at the hicharge rate.
<DT><CODE>chargeOverFlowBit</CODE>
<DD> The hicharge counter overflow. If this bit is set, the hicharge counter has overflowed. When the hicharge counter has overflowed, it indicates that the charging circuit is having trouble charging the battery.
<DT><CODE>batteryDeadBit</CODE>
<DD> The dead battery indicator. This bit is always 0, because the Power Manager automatically shuts the system down when the battery voltage drops below a preset level.
<DT><CODE>batteryLowBit</CODE>
<DD> The battery warning. If this bit is set, the battery voltage has dropped below the value set in parameter RAM. The power management hardware sends an interrupt to the CPU once every second when battery voltage is low.<A NAME=MARKER-2-256></A><A NAME=MARKER-2-257></A>
<DT><CODE>connChangedBit</CODE>
<DD> The charger connection has or has not changed state. If this bit is set, the charger has been recently connected or disconnected.
</DL>
 The Power Manager also defines these bit masks:<P>
<PRE>
CONST
   chargerConnMask         = $1;    {charger is connected}
   hiChargeMask            = $2;    {charging at hicharge rate}
   chargeOverFlowMask      = $4;    {hicharge counter has overflowed}
   batteryDeadMask         = $8;    {battery is dead}
   batteryLowMask          = $10;   {battery is low}
   connChangedMask         = $20;   {connection has changed}
</PRE>
 Due to the nature of lead-acid batteries, the battery power remaining is difficult to measure accurately. Temperature, load, and other factors can alter the measured voltage by 30 percent or more. The Power Manager takes as many of these factors into account as possible, but the voltage measurement can still be in error by up to 10 percent. The measurement is most accurate when the computer has been in the sleep state for at least 30 minutes.<P>
 When the battery charger is connected to a portable Macintosh computer with a low battery, the battery is charged at the hicharge rate (1.5 amps) until battery voltage reaches its full charge (7.2 volts on most portable Macintosh computers). The Power Manager has a counter (the <B>hicharge counter</B>) that measures the time required to raise the battery voltage to this level.<A NAME=MARKER-2-258></A><A NAME=MARKER-2-259></A><P>
 <A NAME=MARKER-2-260></A><A NAME=MARKER-2-261></A>After the full charge level is reached, the power management circuits maintain the hicharge connection until the hicharge counter counts down to 0. This ensures that the battery is fully charged. At the end of that time, the power management circuits supply the battery with just enough current to replace the voltage lost through self-discharge.<A NAME=MARKER-2-262></A><A NAME=MARKER-2-263></A><A NAME=MARKER-2-264></A><P>
<A NAME=HEADING262-21></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error</TABLE>
</H5>
<A NAME=HEADING262-22></A>
<H5>SEE ALSO</H5>
 For more functions for determining the status of the battery and battery charger, see <A HREF=Devices-288.html#MARKER-9-325>"Getting Information About the Internal Batteries," beginning on page 6-54</A>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Devices-261.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Devices-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Devices-328.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Devices-263.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Devices-3.html">&copy; Apple Computer, Inc.</A><br>3 JUL 1996</center></font><P>
<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->
</BODY>
</HTML>  
