<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML EXPERIMENTAL 970324//EN">
<HTML>
<HEAD>
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter">
<script language="JavaScript" src="frametest.js"></script>
<TITLE> TECFlushMultipleEncodings </TITLE><LINK REL="stylesheet" TYPE="text/css" HREF="../../../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../../../Resources/JavaScript/page.js"></script>
</head>
<body bgcolor="#ffffff">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>

<DIV>
<a name="top"></a>
<!-- start of header -->
<!--#include virtual="/includes/framesetheader" -->
<!-- end of header --><A HREF="TEC.64.html"><img src="images/up.gif" border="0" alt="Up"></A><nobr>&nbsp;</nobr><A HREF="TEC.68.html"><img src="images/previous.gif" border="0" alt="Previous"></A><nobr>&nbsp;</nobr><A HREF="TEC.6a.html"><img src="images/next.gif" border="0" alt="Next"></A><nobr>&nbsp;</nobr>
<!-- insert Show/Hide frames -->
<a href="javascript:testFrame()">
<script>
<!--
document.write(frameLink);
//	-->
</script><!-- end Show/Hide frames --></A><br>
<font face="Geneva,Helvetica,Arial" size="1"><b><br>
		PATH<spacer type="horizontal" size="5">&nbsp;</b></font><a href="../../../mac8.html"><font face="Geneva,Helvetica,Arial" size="1">Mac OS 8 and 9 Developer Documentation</a>  <b>&gt;</b> Text Encoding Conversion Manager<br>
		<img src="images/im_smblue.gif" width="116" height="8"><img src="images/space.gif" width="6" height="11">Programming With the Text Encoding Conversion Manager</font><br>
		<br>
		<hr>

</DIV>
<H1>
<A NAME="pgfId=14280">
 </A>
TECFlushMultipleEncodings </H1>
<P>
<A NAME="pgfId=14330">
 </A>
Flushes out any encodings that may be stored in a converter object's temporary buffers and shifts encodings back to their default state, if any.</P>
<TT>
<A NAME="pgfId=32241">
 </A>
pascal OSStatus TECFlushMultipleEncodings(<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TECObjectRef encodingConverter, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TextPtr outputBuffer, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteCount outputBufferLength, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteCount *actualOutputLength, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TextEncodingRun outEncodingsBuffer[], <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ItemCount maxOutEncodingRuns, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ItemCount *actualOutEncodingRuns);</TT>
<DL COMPACT>
<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=32245">
 </A>
<TT>encodingConverter</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=14332">
 </A>
 The reference to the text encoding converter object whose contents are to be flushed. This is the reference returned by the function <A HREF="TEC.65.html" CLASS="XRef"><TT>TECCreateOneToManyConverter</TT></A>.</DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=32256">
 </A>
<TT>outputBuffer</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=14344">
 </A>
A pointer to a buffer for a byte stream. On return, this buffer holds the converted text. If the buffer that you allocate is not large enough to hold the entire converted text stream, an error is returned. </DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=32265">
 </A>
<TT>outputBufferLength</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=14348">
 </A>
 The length in bytes of the buffer provided by the <TT>outputBuffer</TT> parameter. </DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=32275">
 </A>
<TT>actualOutputLength</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=14352">
 </A>
 A pointer to a value of type <TT>ByteCount</TT>. On output, this value is the actual number of bytes of the converted text returned in the buffer specified by the <TT>outputBuffer</TT> parameter.</DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=32285">
 </A>
<TT>outEncodingsBuffer[]</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=14387">
 </A>
 An ordered array of text encoding runs for the destination text encoding. Note that the actual byte size of this buffer should be <TT>actualOutEncodingRuns * sizeof(TextEncodingRun)</TT>. See <A HREF="TEC.23.html" CLASS="XRef"><TT>TextEncodingRun</TT></A>
 for more information about the <TT>TextEncodingRun</TT> structure.</DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=32295">
 </A>
<TT>maxOutEncodingRuns</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=14388">
 </A>
 The maximum number of encoding runs that will fit in outEncodingsBuffer[].</DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=32305">
 </A>
<TT>actualOutEncodingRuns</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=14389">
 </A>
 A pointer to a value of type <TT>ItemCount</TT>. On return, <TT>actualOutEncodingRuns</TT> specifies how many runs were put in the buffer during conversion.</DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=32315">
 </A>
<I CLASS="italics">
function result</I>
</DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=14296">
 </A>
A result code. See <A HREF="TEC.20.html" CLASS="XRef">
Text Encoding Conversion Manager Result Codes</A>
 for a list of possible values. </DD><P>

</DL COMPACT>
<DIV>
<H5 CLASS="RSb.RoutineSbhd">
<A NAME="pgfId=14297">
 </A>
DISCUSSION</H5>
<P>
<A NAME="pgfId=14408">
 </A>
You should always call <TT>TECFlushMultipleEncodings</TT> at the end of the conversion process to flush out any data that may be stored in the temporary buffers of the text encoding converter object or perform other end-of-encoding conversion tasks. Encodings such as ISO-2022-JP that need to shift back to a certain default state at the end of a conversion can do so when this conversion function is called. <P>


<A NAME="pgfId=21046">
 </A>
In allocating an output buffer, a good rule of thumb is larger is better, basing your estimate on the byte requirements of the destination encoding. You should always allocate a buffer at least 32 bytes long. For the function to return successfully, the output buffer you allocate must be large enough to accommodate at least part of the converted text. Then, if the function cannot convert all of the text, it executes successfully, returns the portion of the text it converted, and returns the number of source bytes it removed from input in the <TT>actualInputLength</TT> parameter. You can use this number to identify the next byte to be taken and to determine how many bytes remain. To convert the remaining text, you simply call the function again with the remaining text and a new output buffer. <P>


<A NAME="pgfId=21047">
 </A>
If the output buffer you allocate is too small to accommodate <I CLASS="italics">
any</I>
 of the converted text, the function fails. For example, if the destination encoding requires bytes in addition to the actual text (for instance, an escape sequence preceding the converted text), your buffer must be large enough to accommodate both.</P>
</DIV>
<DIV>
<H4>
<A NAME="pgfId=32324">
 </A>
<BLOCKQUOTE>IMPORTANT</H4>
<P>
<A NAME="pgfId=18191">
 </A>
If the destination encoding is a character encoding scheme--such as ISO-2022-JP, which begins in ASCII and switches to other coded character sets through limited combinations of escape sequences--then you need to allocate enough space to accommodate escape sequences that signal switches. ISO-2022-JP requires 3 to 5 bytes for an escape sequence preceding the 1-byte or 2-byte character it introduces. If you allocate a buffer that is less than 5 bytes, the <TT>TECConvertText</TT> function could fail, depending on the text being converted. </P></BLOCKQUOTE>
<DIV>
<H5 CLASS="RSb.RoutineSbhd">
<A NAME="pgfId=18196">
 </A>
SEE ALSO</H5>
<P>
<A NAME="pgfId=20161">
 </A>
The function <A HREF="TEC.63.html" CLASS="XRef"><TT>TECFlushText</TT></A><P>


<A NAME="pgfId=20168">
 </A>
The function <A HREF="TEC.65.html" CLASS="XRef"><TT>TECCreateOneToManyConverter</TT></A></P>
</DIV>
</DIV>
<HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 13 Dec 99)<P><A HREF="TEC.64.html"><img src="images/up.gif" border="0" alt="Up"></A><nobr>&nbsp;</nobr><A HREF="TEC.68.html"><img src="images/previous.gif" border="0" alt="Previous"></A><nobr>&nbsp;</nobr><A HREF="TEC.6a.html"><img src="images/next.gif" border="0" alt="Next"></A><nobr>&nbsp;</nobr>
<!-- insert Show/Hide frames -->
<a href="javascript:testFrame()">
<script>
<!--
document.write(frameLink);
//	-->
</script><!-- end Show/Hide frames --></A>

<!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY>
</HTML>
