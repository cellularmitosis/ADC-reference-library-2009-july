<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Components of MacApp's Scripting Support (MacApp PG)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING51></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MacAppProgGuide-50.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-52.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MacAppProgGuide-2.html"><B>Programmer's Guide to MacApp</B></A> / <A HREF="MacAppProgGuide-21.html"><B>Part 1 - MacApp Theory and Architecture</B></A><BR><DD><A HREF="MacAppProgGuide-48.html"><B>Chapter 6 - Scripting</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING51-0></A>
<H1><A NAME=MARKER-2-59></A>Components of MacApp's Scripting Support</H1>
 MacApp provides a number of components that work together to implement scripting support for your application. The sections that follow provide additional detail on these components.<P>
<UL>
<LI><B>'<A NAME=MARKER-2-101></A>aedt' resource.</B> MacApp also provides an <B>Apple event dispatch table resource</B> that maps a received Apple event (by class ID and descriptor type) to a MacApp command number. You can add <CODE>'aedt'</CODE> resources to establish mappings for custom events.
<LI><B>'<A NAME=MARKER-2-61></A>aete' resource.</B> MacApp provides an <B>Apple event terminology extension resource</B> that defines terminology for the four required A&szlig;pple events, as well as for all of the events in the Core suite supported by MacApp. Your application can modify and extend this resource.
<LI><B><A NAME=MARKER-2-62></A>MScriptableObject.</B> The <CODE>MScriptableObject</CODE> class is a mixin (or multiple-inheritance) class that helps an object <P>
<UL>
<LI>respond to Apple events
<LI>get and set object properties
<LI>describe itself in terms the OSL can understand
<LI>return the objects it contains
<LI>have an attached script that can respond to Apple events<P>
The <CODE>TDocument</CODE>, <CODE>TFile</CODE>, <CODE>TWindow</CODE>, and other MacApp classes mix in this class, and you can add it to any class you define that doesn't already use it.<P>
</UL>
<LI><B><A NAME=MARKER-9-118></A>MDefaultScriptableObject.</B> <CODE>MDefaultScriptableObject</CODE>, a mixin subclass of <CODE>MScriptableObject</CODE>, helps an object serve as the destination for Apple events that don't specify a target object. MacApp's <CODE>TApplication</CODE> class uses this mixin class and serves as the default target for Apple events.
<LI><B><A NAME=MARKER-2-64></A>TAppleEvent.</B> The <CODE>TAppleEvent</CODE> class reads and writes Apple event data and sends Apple events.
<LI><B>TSetPropertyEvent.</B> The <CODE>TSetPropertyEvent</CODE> class, a subclass of <CODE>TAppleEvent</CODE>, sends an Apple event to change an object property for objects in a list of one or more objects.
<LI><B><A NAME=MARKER-2-65></A>TCommand.</B> The <CODE>TCommand</CODE> class provides a method to create an Apple event to make the command action recordable.
<LI><B><A NAME=MARKER-2-66></A>TSetPropertyCommand.</B> The <CODE>TSetPropertyCommand</CODE> class implements an undoable command that can automatically set object properties for your classes that override the <CODE>GetObjectProperty</CODE> and <CODE>SetObjectProperty</CODE> methods. (You may also have to override the <CODE>GetSetPropertyInfo</CODE> method.)
<LI><B><A NAME=MARKER-10-17></A>TClientCommand, TServerCommand.</B> The <CODE>TClientCommand</CODE> class and the <CODE>TServerCommand</CODE> class provide services for sending an Apple event to an external process, either synchronously or asynchronously, and processing a reply (if one is requested).
<LI><B><A NAME=MARKER-2-68></A>TExecuteScriptCommand.</B> The <CODE>TExecuteScriptCommand</CODE> class executes a script.
<LI><B><A NAME=MARKER-2-69></A>TFileBasedDocument.</B> The <CODE>TFileBasedDocument</CODE> class contains support for saving an attached script in the resource fork of a document and reading the script when the document is opened.
<LI><B><A NAME=MARKER-2-70></A>TOSADispatcher.</B> The <CODE>TOSADispatcher</CODE> class manages the resolution and dispatching of incoming and outgoing object model Apple events. During scripting initialization, the global static field <CODE>TOSADispatcher</CODE>::<CODE>fgDispatcher</CODE> is set to an instance of <CODE>TOSADispatcher</CODE>. The <CODE>fgDispatcher</CODE> object dispatches Apple events to specified objects, working with callbacks from the OSL to determine the target object.
<LI><B><A NAME=MARKER-2-72></A>TOSAScriptRep.</B> The <CODE>TOSAScriptRep</CODE> class serves as a wrapper for an attached script. The <CODE>fScript</CODE> field (of type <CODE>COSAScript</CODE>) refers to the actual script object. The <CODE>TOSAScriptRep</CODE> class keeps track of references to the script, reads and writes the script, and handles events for the script. You don't reference an instance of this class directly--you work instead through a <CODE>COSAScriptCntPtr</CODE> object.
<LI><B><A NAME=MARKER-10-1></A>COSAScript.</B> The <CODE>COSAScript</CODE> class is a wrapper for a low-level OSA script. It provides methods that call on OSA routines to send an event to the script, execute the script, set the script, dispose of the script, and so on. The <CODE>fScriptID</CODE> field (of type <CODE>OSAID</CODE>) specifies the script the class operates on.
<LI><B><A NAME=MARKER-2-74></A>COSAScriptCntPtr.</B> The <CODE>COSAScriptCntPtr</CODE> class is used as an accessor for a <CODE>TOSAScriptRep</CODE> object. This class allows multiple objects to refer to the same script. A <CODE>COSAScriptCntPtr</CODE> object keeps a count of references to the script object and deletes the object if the count goes to 0. The <CODE>MScriptableObject</CODE> class has a field of this type to refer to an attached script.<P>
</UL>
 In addition to these components, MacApp processes many Apple events automatically in the <CODE>TApplication</CODE>, <CODE>TDocument</CODE>, and <CODE>TWindow</CODE> classes, although your subclasses may need to provide some additional code.<A NAME=MARKER-2-54></A><P>



</BLOCKQUOTE>
<HR>
<center>
<A HREF="MacAppProgGuide-50.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-52.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MacAppProgGuide-3.html">&copy; Apple Computer, Inc.</A><br>25 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
