<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Scripting Components and Applications That Execute Scripts(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING292></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-291.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-293.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-288.html"><B>Chapter 7 - Introduction to Scripting</B></A> / <A HREF="IAC-289.html"><B>About Scripts and Scripting Components</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING292-0></A>
<H2><A NAME=MARKER-9-32></A>Scripting Components and Applications That Execute Scripts</H2>
 To store and execute scripts as a client application, your application must first establish a connection with a scripting component registered with the Component Manager on the same computer. Each scripting component can manipulate and execute scripts written in the corresponding scripting language when your application calls the standard scripting component routines.<A NAME=MARKER-21-208></A><P>
 Your application can use scripting component routines to<P>
<UL>
<LI>obtain a handle to a script in a form that can be saved, and load the script again when necessary
<LI>allow users to modify scripts that have been previously saved
<LI>compile and execute scripts
<LI>redirect Apple events to script contexts
<LI>supply application-defined functions for use by scripting components
<LI>control the recording process directly, turning recording off and on and saving the recorded script for use by your application<P>
</UL>
 Your application can perform these tasks as a client application regardless of whether it is scriptable or recordable. If your application is scriptable, however, it can execute scripts that control its own behavior, thus acting as both the client application and the server application for the corresponding Apple events. For example, your application can allow users to associate a script with a custom menu command that performs a series of routine actions on a selected object, sets preferences, or automates other actions within your application.<P>
 You can also use scripting component routines to execute scripts that perform tasks for your application with the aid of other applications. For example, a user of a word-processing application might be able to attach a script to a specific word so that the application executes the script whenever that word is double-clicked. Such a script could trigger Apple events that cause other applications to look up and display related information, run a QuickTime movie, perform a calculation, play a voice annotation, and so on. <P>
 Your application can associate a script with either Apple event objects or application-defined objects. Almost any user action can be used to trigger such a script: choosing a menu command, clicking a button, tabbing from one table cell to another, and so on. The script can be executed directly by the application when it detects a triggering action; or, if the script is associated with an Apple event object in the form of a script context, it can be executed automatically when a specified Apple event performs an action on that object.<P>
 The rest of this section describes one way that an application could execute such a script. Suppose a forms application allows users to create custom forms that can include scripts associated with specific fields on the form. These scripts are executed when the user presses Enter or Tab in the appropriate field. For the purposes of this example, it doesn't matter whether a field with which a script is associated is an Apple event object (which can be described in an object specifier record) or some other application-defined object (which can't be described in an object specifier record). <P>
 A company could use the forms application to create a custom order form for taking telephone orders. If the customer has ordered from the company before, the user can quickly retrieve the customer's address from the company database by typing the customer's name in a field and pressing the Tab key. In response, the application executes the script associated with the field. The script might look like this in AppleScript:<P>
<PRE>
set custName to field &quot;Customer Name&quot;

tell application SurfDB
   copy the first record in the table MyAddresses \xA8
      whose cell &quot;Customer Name&quot; = custName to Address
end tell

set field &quot;Street&quot; to item 2 of Address
set field &quot;City&quot; to item 3 of Address
set field &quot;Zip&quot; to item 4 of Address
</PRE>
 To execute such a script (or to manipulate it any other way, such as when the form is first created), the forms application must previously have established a connection with the appropriate scripting component--in this case, the AppleScript component. When the user enters a customer name and presses Tab, the forms application calls scripting component routines to execute the script. As shown in <A HREF=#MARKER-9-35>Figure 7-4</A>, the AppleScript component first sends the forms application a Get Data event that requests the contents of the "Customer Name" field and sets the variable <CODE>custName</CODE> to that value. It then sends SurfDB a Get Data event that requests the appropriate address information and copies it to the variable <CODE>Address</CODE>. (The replies to the Get Data events are not shown in <A HREF=#MARKER-9-35>Figure 7-4</A>.) Finally, the AppleScript component sends the forms application a Set Data event that copies the address information from the variable <CODE>Address</CODE> to the appropriate fields. <P>
 <A NAME=MARKER-9-405></A>The AppleScript component needs to maintain the binding of the variables <CODE>custName</CODE> and <CODE>Address</CODE> throughout execution of the script. Scripting components bind variables with the aid of a <B>script context,</B> which is a script that maintains context information for the execution of other scripts. An application specifies a script context when it executes a script. The forms application in <A HREF=#MARKER-9-35>Figure 7-4</A> provides a context for the scripting component to use whenever it executes a script associated with a button. <P>
<B>Figure 7-4  How an application uses the AppleScript component to execute a script<A NAME=MARKER-9-35></A></B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/SC-L-07.jpg"><P>
 In the example shown in <A HREF=#MARKER-9-35>Figure 7-4</A>, the application executes the script directly when the cursor is in the appropriate field and the user presses Tab or Enter. Your application can also associate such a script with an object in the form of a script context, so that the script context is executed whenever a specified Apple event acts on the field. The section <A HREF=IAC-298.html#MARKER-9-74>"Using a Script Context to Handle an Apple Event,"</A> which begins on <A HREF=IAC-298.html#MARKER-9-74>page 7-21</A>, describes this approach in more detail. <P>
 See <A HREF=IAC-296.html#MARKER-9-62>"Manipulating and Executing Scripts,"</A> which begins on <A HREF=IAC-296.html#MARKER-9-62>page 7-17</A>, for an overview of methods your application can use to save and load script data, compile source data, and perform other useful tasks with scripting component routines. The chapter "Scripting Components" in this book provides full implementation details, including sample code and human interface guidelines for associating scripts with objects. <A NAME=MARKER-2-190></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-291.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-293.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
