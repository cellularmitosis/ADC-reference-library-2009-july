<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Quartz Programming Guide for QuickDraw Developers: Using Color</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Using Color"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001098-CH226" title="Using Color"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000420" target="_top">Carbon</a> &gt; <a href="../../../GraphicsImaging-date.html#//apple_ref/doc/uid/TP30000440-TP30000420-TP30000450" target="_top">Graphics &amp; Imaging</a> &gt; <a href="../tq_intro/tq_intro.html#//apple_ref/doc/uid/TP40001098-CH201-TPXREF101">Quartz Programming Guide for QuickDraw Developers</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../tq_other/tq_other.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../tq_moving_data/tq_moving_data.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40001098-CH226-TPXREF101" title="Using Color"></a><h1>Using Color</h1><p>In Quartz, everything drawn on the page has color information associated with it. Color components are floating-point values ranging from 0.0 (no color) to 1.0 (full intensity). To support transparency, colors include an alpha component that ranges from 0.0 (transparent) to 1.0 (opaque). Quartz supports drawing with transparency in all types of graphics contexts. There are many uses for transparency in Mac OS X. For example, you can use translucent overlay windows to indicate selection.</p><p>Quartz colors are always associated with a color space. This ensures that colors are reproduced faithfully regardless of the drawing destination. Quartz supports separate color spaces for stroking and filling. Further, bitmap images and shadings are drawn to their own color spaces. When drawing is rendered to a destination, Quartz uses ColorSync to achieve accurate color matching.</p><p>If color fidelity is critical to your application, you’ll need to learn how to manage colors and how to use calibrated color spaces in Quartz. If you don’t need a sophisticated level of color-matching in your application, don’t panic. Using colors and color spaces in Quartz is straightforward. Starting in Mac OS X v10.4, you can use Generic color spaces, which let Quartz manage color for you in the best way possible, without your needing to know all the particulars of calibrated color spaces. </p><p>If you haven’t worked with color spaces, you might want to read <em><a href="../../../../GraphicsImaging/Conceptual/csintro/index.html#//apple_ref/doc/uid/TP30001148" target="_top">Color Management Overview</a></em> to learn the terminology and basic concepts associated with color and color spaces. This document discusses color perception, the dimensions associated with color, device-dependent and device-independent color spaces, color component values, color matching systems, rendering intents, color profiles, and ColorSync.</p><p>Regardless of your needs, before you start to work with color in Quartz, read <span class="content_text"><a href="../../../../GraphicsImaging/Conceptual/drawingwithquartz2d/dq_color/dq_color.html#//apple_ref/doc/uid/TP30001066-CH205" target="_top">Color and Color Spaces</a></span> in <em><a href="../../../../GraphicsImaging/Conceptual/drawingwithquartz2d/index.html#//apple_ref/doc/uid/TP30001066" target="_top">Quartz 2D Programming Guide</a></em>.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="tq_color.html#//apple_ref/doc/uid/TP40001098-CH226-DontLinkElementID_1">Converting Between QuickDraw RGB and Quartz RGB</a>
				
			<br/>
			
        
			
			
				<a href="tq_color.html#//apple_ref/doc/uid/TP40001098-CH226-CJBJCGDF">Creating Color Spaces</a>
				
			<br/>
			
        
			
			
				<a href="tq_color.html#//apple_ref/doc/uid/TP40001098-CH226-DontLinkElementID_2">Relevant Resources</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001098-CH226-DontLinkElementID_1" title="Converting Between QuickDraw RGB and Quartz RGB"></a><h2>Converting Between QuickDraw RGB and Quartz RGB</h2><p>The QuickDraw RGB data type provides storage for the red, green, and blue components of an RGB color, as shown in <span class="content_text">Listing 3-1</span>. Values for a QuickDraw color component can range from 0 to 65,535. Quartz RGB colors have an additional component for alpha. The values for each component are floating-point, and can range in value from 0.0 (component not present) to 1.0. </p><a name="//apple_ref/doc/uid/TP40001098-CH226-CJBJHCFF" title="Listing 3-1The QuickDraw RGBColor data type"></a><p class="codesample"><strong>Listing 3-1&nbsp;&nbsp;</strong>The QuickDraw RGBColor data type</p><div class="codesample"><table><tr><td scope="row"><pre>struct RGBColor {<span></span></pre></td></tr><tr><td scope="row"><pre>   unsigned short red;<span></span></pre></td></tr><tr><td scope="row"><pre>   unsigned short green;<span></span></pre></td></tr><tr><td scope="row"><pre>   unsigned short blue;<span></span></pre></td></tr><tr><td scope="row"><pre>};<span></span></pre></td></tr></table></div><p>The <code>ConvertRGBColortoCGrgba</code> routine in <span class="content_text">Listing 3-2</span> shows how to convert from QuickDraw RGB to Quartz RGB. The <code>CGrgba</code> structure in the listing contains components for red, green, blue, and alpha. To convert, the <code>ConvertRGBColortoCGrgba</code> routine divides each QuickDraw color component by 65,535. The alpha value that’s passed to the routine gets assigned to the Quartz RGB color.</p><a name="//apple_ref/doc/uid/TP40001098-CH226-CJBCAFBD" title="Listing 3-2A routine that converts RGB color to Quartz RGBA"></a><p class="codesample"><strong>Listing 3-2&nbsp;&nbsp;</strong>A routine that converts RGB color to Quartz RGBA</p><div class="codesample"><table><tr><td scope="row"><pre>struct CGrgba {<span></span></pre></td></tr><tr><td scope="row"><pre>        float r;<span></span></pre></td></tr><tr><td scope="row"><pre>        float g;<span></span></pre></td></tr><tr><td scope="row"><pre>        float b;<span></span></pre></td></tr><tr><td scope="row"><pre>        float a;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>void ConvertRGBColorToCGrgba (const RGBColor* inRGB,<span></span></pre></td></tr><tr><td scope="row"><pre>                    float alpha,<span></span></pre></td></tr><tr><td scope="row"><pre>                    CGrgba* outCGrgba)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    outCGrgba->r = (float)inRGB->red   / 65535.0;<span></span></pre></td></tr><tr><td scope="row"><pre>    outCGrgba->g = (float)inRGB->green / 65535.0;<span></span></pre></td></tr><tr><td scope="row"><pre>    outCGrgba->b = (float)inRGB->blue  / 65535.0;<span></span></pre></td></tr><tr><td scope="row"><pre>    outCGrgba->a = alpha;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001098-CH226-CJBJCGDF" title="Creating Color Spaces"></a><h2>Creating Color Spaces</h2><p>Generic color spaces let the system choose the best possible color representation for a given device and application. These are device-independent color spaces that are easy to use and recommended. Starting in Mac OS X v10.4, you can call the function <code><a href="../../../../GraphicsImaging/Reference/CGColorSpace/Reference/reference.html#//apple_ref/c/func/CGColorSpaceCreateWithName" target="_top">CGColorSpaceCreateWithName</a></code>, passing the constant <code>kCGColorSpaceGenericRGB</code>. Use of DeviceRGB is not recommended.</p><p>If your code must run in versions of Mac OS X prior to Mac OS X v10.4, see the <code>GetGenericRGBColorSpace</code> routine shown in <span class="content_text"><a href="tq_color.html#//apple_ref/doc/uid/TP40001098-CH226-CJBIDGBJ">Listing 3-3</a></span>. This routine creates a GenericRGB color space by calling the application-defined routine <code>OpenGenericProfile</code> once. <code>CreateGenericRGBColorSpace</code> keeps the color space so that it can return the color space whenever this routine is called. </p><a name="//apple_ref/doc/uid/TP40001098-CH226-CJBIDGBJ" title="Listing 3-3A routine that creates a generic RGB color space"></a><p class="codesample"><strong>Listing 3-3&nbsp;&nbsp;</strong>A routine that creates a generic RGB color space</p><div class="codesample"><table><tr><td scope="row"><pre>CGColorSpaceRef CreateGenericRGBColorSpace(void)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    static CGColorSpaceRef genericRGBColorSpace = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    if (genericRGBColorSpace == NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>        CMProfileRef genericRGBProfile = OpenGenericProfile();<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        if (genericRGBProfile)<span></span></pre></td></tr><tr><td scope="row"><pre>        {<span></span></pre></td></tr><tr><td scope="row"><pre>            genericRGBColorSpace = CGColorSpaceCreateWithPlatformColorSpace<span></span></pre></td></tr><tr><td scope="row"><pre>                                    (genericRGBProfile);<span></span></pre></td></tr><tr><td scope="row"><pre>            if (genericRGBColorSpace == NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>                fprintf(stderr, "Couldn't create the generic<span></span></pre></td></tr><tr><td scope="row"><pre>                             RGB color space\n");<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            // This routine opened the profile so it must close it<span></span></pre></td></tr><tr><td scope="row"><pre>            CMCloseProfile(genericRGBProfile);<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    return genericRGBColorSpace;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>The <code>OpenGenericProfile</code> routine (see <span class="content_text">Listing 3-4</span>) locates, opens, and returns a reference to the ColorSync profile for the calibrated Generic RGB color space. It is up to the caller to call the function <code>CMCloseProfile</code> when done with the profile reference that this function returns.</p><a name="//apple_ref/doc/uid/TP40001098-CH226-CJBEBHHG" title="Listing 3-4A routine that returns a reference to a calibrated GenericRGB color space"></a><p class="codesample"><strong>Listing 3-4&nbsp;&nbsp;</strong>A routine that returns a reference to a calibrated GenericRGB color space</p><div class="codesample"><table><tr><td scope="row"><pre>#define kGenericRGBProfilePathStr<span></span></pre></td></tr><tr><td scope="row"><pre>        "/System/Library/ColorSync/Profiles/Generic RGB Profile.icc"<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>CMProfileRef OpenGenericProfile(void)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    static CMProfileRef cachedRGBProfileRef = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // Create the profile reference only once<span></span></pre></td></tr><tr><td scope="row"><pre>    if (cachedRGBProfileRef == NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>        OSStatus            err;<span></span></pre></td></tr><tr><td scope="row"><pre>        CMProfileLocation   loc;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        loc.locType = cmPathBasedProfile;<span></span></pre></td></tr><tr><td scope="row"><pre>        strcpy(loc.u.pathLoc.path, kGenericRGBProfilePathStr);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        err = CMOpenProfile(&amp;cachedRGBProfileRef, &amp;loc);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        if (err != noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        {<span></span></pre></td></tr><tr><td scope="row"><pre>            cachedRGBProfileRef = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre>            // Log a message to the console<span></span></pre></td></tr><tr><td scope="row"><pre>            fprintf (stderr, "Couldn't open generic profile due to<span></span></pre></td></tr><tr><td scope="row"><pre>                                error %d\n",(int)err);<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    if (cachedRGBProfileRef)<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>        // Clone the profile reference so that the caller has<span></span></pre></td></tr><tr><td scope="row"><pre>        // their own reference, not our cached one.<span></span></pre></td></tr><tr><td scope="row"><pre>        CMCloneProfileRef (cachedRGBProfileRef);<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    return cachedRGBProfileRef;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001098-CH226-DontLinkElementID_2" title="Relevant Resources"></a><h2>Relevant Resources</h2><p>In <em><a href="../../../../GraphicsImaging/Conceptual/drawingwithquartz2d/index.html#//apple_ref/doc/uid/TP30001066" target="_top">Quartz 2D Programming Guide</a></em>, see</p><ul class="ul"><li class="li"><p><span class="content_text"><a href="../../../../GraphicsImaging/Conceptual/drawingwithquartz2d/dq_color/dq_color.html#//apple_ref/doc/uid/TP30001066-CH205" target="_top">Color and Color Spaces</a></span></p></li></ul><p>See these reference documents:</p><ul class="ul"><li class="li"><p><em><a href="../../../../GraphicsImaging/Reference/CGColor/index.html#//apple_ref/doc/uid/TP30000948" target="_top">CGColor Reference</a></em></p></li><li class="li"><p><em><a href="../../../../GraphicsImaging/Reference/CGColorSpace/index.html#//apple_ref/doc/uid/TP30000949" target="_top">CGColorSpace Reference</a></em></p></li></ul><p>For those new to color spaces, see <em><a href="../../../../GraphicsImaging/Conceptual/csintro/index.html#//apple_ref/doc/uid/TP30001148" target="_top">Color Management Overview</a></em>.</p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../tq_other/tq_other.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../tq_moving_data/tq_moving_data.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2004, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-09-05<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Carbon/Conceptual/QuickDrawToQuartz2D/tq_color/tq_color.html%3Fid%3DTP40001098-5.2&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Carbon/Conceptual/QuickDrawToQuartz2D/tq_color/tq_color.html%3Fid%3DTP40001098-5.2&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Carbon/Conceptual/QuickDrawToQuartz2D/tq_color/tq_color.html%3Fid%3DTP40001098-5.2&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>