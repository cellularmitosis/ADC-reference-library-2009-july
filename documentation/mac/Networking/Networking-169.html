<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>PAddResponse(IM:N)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING169></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Networking-168.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Networking-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Networking-304.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt= "Book Index"></A> <A HREF="Networking-170.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Networking-2.html"><B>Networking</B></A> / <BR><DD><A HREF="Networking-143.html"><B>Chapter 6 - AppleTalk Transaction Protocol (ATP)</B></A> / <A HREF="Networking-153.html"><B>ATP Reference</B></A><BR><DL><DD><A HREF="Networking-158.html"><B>Routines</B></A> / <A HREF="Networking-167.html"><B>Responding to Requests</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING169-0></A>
<H3>PAddResponse</H3>
 <A NAME=MARKER-11-225></A>The <A NAME=MARKER-2-100></A><CODE>PAddResponse</CODE> function sends an additional response packet to a socket that <BR>has already been sent the first part of the response message through the <CODE>PSendResponse</CODE> function. <P>
<PRE>
FUNCTION PAddResponse (thePBPtr: ATPPBPtr; async: Boolean): OSErr;
</PRE>
<DL>
<DT><CODE>thePBPtr</CODE>
<DD> A pointer to an ATP parameter block.
<DT><CODE>async</CODE>
<DD> A Boolean that indicates whether the function should be executed asynchronously or synchronously. Specify <CODE>TRUE</CODE> for asynchronous execution.
</DL>
<B>
<TABLE BORDER="0" CELLPADDING=3><TD>--><TD>ioCompletion<TD>ProcPtr<TD>A pointer to a completion routine.<TR>
<TD><--<TD>ioResult<TD>OSErr<TD>The function result.<TR>
<TD>--><TD>userData<TD>LongInt<TD>Four bytes of user data.<TR>
<TD>--><TD>csCode<TD>Integer<TD>Always <CODE>addResponse</CODE> for this function.<TR>
<TD>--><TD>atpSocket<TD>Byte<TD>The source socket number.<TR>
<TD>--><TD>atpFlags<TD>Byte<TD>The control information.<TR>
<TD>--><TD>addrBlock<TD>AddrBlock<TD>The destination socket address.<TR>
<TD>--><TD>reqLength<TD>Integer<TD>The size in bytes of the response data.<TR>
<TD>--><TD>reqPointer<TD>Ptr<TD>A pointer to the response data.<TR>
<TD>--><TD>rspNum<TD>Byte<TD>The sequence number.<TR>
<TD>--><TD>transID<TD>Integer<TD>The transaction ID.</TABLE>
</B><P>
<DL>
<H5>Field Description</H5>
<DT><CODE>userData</CODE>
<DD> Four bytes of user data that are sent in the header of the message. You can use these bytes for any purpose that you wish. 
<DT><CODE>atpSocket</CODE>
<DD> The number of the socket that is used to send the additional response.
<DT><CODE>atpFlags</CODE>
<DD> A control information field whose bits, numbered 0-7, are used <BR>as flags.
<DT>
<DD> To signal that this packet is the last packet in the transaction's response message when the number of responses is less than expected, set the end-of-message (<CODE>atpEOMvalue</CODE>) bit (bit 4). 
<DT>
<DD> ATP sets the send-transmission-status (<CODE>atpSTSvalue</CODE>) bit (bit 3) to force the requester to retransmit a request immediately, when this <BR>is necessary. 
<DT>
<DD> To direct ATP to use DDP's checksum feature, set the send checksum (<CODE>atpSendChkvalue</CODE>) bit (bit 0) of this flag. 
<DT><CODE>addrBlock</CODE>
<DD> The number of the socket to which the additional response packet is to be sent. 
<DT><CODE><A NAME=MARKER-2-101></A>reqLength</CODE>
<DD> The size in bytes of the response data to be sent.
<DT><CODE><A NAME=MARKER-2-11></A>reqPointer</CODE>
<DD> A pointer to the response data to be sent.
<DT><CODE><A NAME=MARKER-2-165></A>rspNum</CODE>
<DD> The sequence number of the response, in the range of 0 to 7. 
<DT><CODE><A NAME=MARKER-2-9></A>reqTID</CODE>
<DD> The transaction ID of the request for which this response is meant. <B></B>
</DL>
<A NAME=HEADING169-17></A>
<H5>DESCRIPTION</H5>
 The <CODE>PAddResponse</CODE> function sends an additional response packet, following the initial response sent in return to a <CODE>PSendResponse</CODE> request message. You can send multiple additional response packets, one at a time, up to a total of eight packets including the initial response packets sent in the <CODE>PSendResponse</CODE> function.<P>
 You cannot issue a <CODE>PAddResponse</CODE> call without having first called <CODE>PSendResponse</CODE>. You must provide a pointer to the buffer containing the data to be sent and specify the amount of data. Each packet can contain up to 578 bytes of data. You also must specify the sequence number of the response.<P>
<A NAME=HEADING169-20></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 If the transaction is part of an exactly-once transaction, you must allocate nonrelocatable memory for the buffer that you use for the response data, and you must not alter the contents of this buffer until the corresponding <CODE>PSendRequest</CODE> function has completed execution. <P>
<A NAME=HEADING169-22></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 To execute the <CODE>PAddResponse</CODE> function from assembly language, call the <CODE>_Control</CODE> trap macro with a value of <CODE>addResponse</CODE> in the <CODE>csCode</CODE> field of the parameter block. <BR>To execute this function from assembly language, you must also specify the .ATP driver reference<A NAME=MARKER-2-90></A> number.<A NAME=MARKER-2-60></A><P>
<A NAME=HEADING169-24></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>badATPSkt<TD>-1099<TD>Bad responding socket<TR>
<TD>badBuffNum<TD>-1100<TD>Sequence number out of range<TR>
<TD>noSendResp<TD>-1103<TD><CODE>PAddResponse</CODE> issued before <CODE>PSendResponse</CODE><TR>
<TD>noDataArea<TD>-1104<TD>Too many outstanding ATP calls</TABLE>
</H5>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Networking-168.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Networking-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Networking-304.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt= "Book Index"></A> <A HREF="Networking-170.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Networking-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
