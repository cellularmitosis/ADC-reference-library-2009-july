<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Quartz 2D Programming Guide: Overview of Quartz 2D</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Overview of Quartz 2D"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30001066-CH202" title="Overview of Quartz 2D"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000424" target="_top">Graphics &amp; Imaging</a> &gt; <a href="../../../Quartz-date.html#//apple_ref/doc/uid/TP30000440-TP30000424-TP30000559" target="_top">Quartz</a> &gt; <a href="../dq_intro/dq_intro.html#//apple_ref/doc/uid/TP30001066-CH201-TPXREF101">Quartz 2D Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../dq_intro/dq_intro.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../dq_context/dq_context.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP30001066-CH202-TPXREF101" title="Overview of Quartz 2D"></a><h1>Overview of Quartz 2D</h1><p>Quartz 2D is a two-dimensional drawing engine accessible from all Mac OS X application environments outside of the kernel. You can use the Quartz 2D application programming interface (API) to gain access to features such as path-based drawing, layer drawing, painting with transparency, shading, drawing shadows, transparency layers, color management, anti-aliased rendering, PDF document generation, and PDF metadata access.</p><p>The Mac OS X graphics and imaging architecture is shown in <span class="content_text">Figure 1-1</span>. Quartz 2D is implemented in the Core Graphics framework, a part of the Application Services umbrella framework. Your program links to <code>ApplicationServices.framework</code> to call Quartz 2D routines directly.</p><br/><div><a name="//apple_ref/doc/uid/TP30001066-CH202-BBCFEIBF" title="Figure 1-1Graphics and imaging in Mac OS X"></a><p><strong>Figure 1-1&nbsp;&nbsp;</strong>Graphics and imaging in Mac OS X</p><img src = "../Art/graphics_arch.gif" alt = "Graphics and imaging in Mac OS X" width="366" height="190"></div><br/><p>Quartz 2D can work with all other graphics and imaging technologies–Core Image, Core Video, OpenGL, and QuickTime. It’s possible to create an image in Quartz from a QuickTime graphics importer, using the QuickTime function <code><a href="../../../../QuickTime/WhatsNewQT6_4/Chap1/QT6WhatsNew.html#//apple_ref/c/func/GraphicsImportCreateCGImage" target="_top">GraphicsImportCreateCGImage</a></code>. See <em>QuickTime API Reference</em> for details.</p><p>Core Image and Core Video are technologies that are available in Mac OS X v10.4. <span class="content_text"><a href="../dq_data_mgr/dq_data_mgr.html#//apple_ref/doc/uid/TP30001066-CH216-BAJHEBHE">“Moving Data Between Quartz 2D and Core Image”</a></span> describes how you can provide images to Core Image, which is a framework that supports image processing.</p><p>Notice that QuickDraw is not depicted in <span class="content_text">Figure 1-1</span>; Quartz 2D replaces QuickDraw. If you still have QuickDraw code in your application, you can read <em><a href="../../../../Carbon/Conceptual/QuickDrawToQuartz2D/index.html#//apple_ref/doc/uid/TP40001098" target="_top">Quartz Programming Guide for QuickDraw Developers</a></em> for strategies on how to replace your old QuickDraw code in order to take advantage of the sophisticated drawing engine available through Quartz 2D.</p><p>Graphics hardware, shown in <span class="content_text">Figure 1-1</span> as the foundational layer, is important for high-performance graphics. Whenever possible, Quartz 2D leverages the power of the graphics hardware. </p><p>The following sections provide an overview of the key concepts you need to understand about the Quartz 2D drawing environment:</p><ul class="ul"><li class="li"><p><span class="content_text"><a href="dq_overview.html#//apple_ref/doc/uid/TP30001066-CH202-CJBCCHFE">“The Page”</a></span></p></li><li class="li"><p><span class="content_text"><a href="dq_overview.html#//apple_ref/doc/uid/TP30001066-CH202-TPXREF131">“Drawing Destinations: The Graphics Context”</a></span></p></li><li class="li"><p><span class="content_text"><a href="dq_overview.html#//apple_ref/doc/uid/TP30001066-CH202-BBCGCGBA">“Quartz 2D Opaque Data Types”</a></span></p></li><li class="li"><p><span class="content_text"><a href="dq_overview.html#//apple_ref/doc/uid/TP30001066-CH202-TPXREF132">“Graphics States”</a></span></p></li><li class="li"><p><span class="content_text"><a href="dq_overview.html#//apple_ref/doc/uid/TP30001066-CH202-CJBBAEEC">“Quartz 2D Coordinates”</a></span></p></li><li class="li"><p><span class="content_text"><a href="dq_overview.html#//apple_ref/doc/uid/TP30001066-CH202-CJBIBHHB">“Memory Management: Object Ownership”</a></span></p></li><li class="li"><p><span class="content_text"><a href="dq_overview.html#//apple_ref/doc/uid/TP30001066-CH202-BABJBDFD">“Quartz Performance: A Look Under the Hood”</a></span></p></li></ul><a name="//apple_ref/doc/uid/TP30001066-CH202-CJBCCHFE" title="The Page"></a><h2>The Page</h2><p>Quartz 2D uses the <strong>painter’s model</strong> for its imaging. In the painter’s model, each successive drawing operation applies a layer of “paint” to an output “canvas,” often called a <strong>page</strong>. The paint on the page can be modified by overlaying more paint through additional drawing operations. An object drawn on the page cannot be modified except by overlaying more paint. This model allows you to construct extremely sophisticated images from a small number of powerful primitives.</p><p><span class="content_text">Figure 1-2</span> shows how the painter’s model works. To get the image in the top part of the figure, the shape on the left was drawn first followed by the solid shape. The solid shape overlays the first shape, obscuring all but the perimeter of the first shape. The shapes are drawn in the opposite order in the bottom of the figure, with the solid shape drawn first. As you can see, in the painter’s model the drawing order is important.</p><br/><div><a name="//apple_ref/doc/uid/TP30001066-CH202-BBCHHEAG" title="Figure 1-2The painter&acirc;&#128;&#153;s model"></a><p><strong>Figure 1-2&nbsp;&nbsp;</strong>The painter’s model</p><img src = "../Art/painters_model.gif" alt = "The painter’s model" width="318" height="344"></div><br/><p>The page may be a real sheet of paper (if the output device is a printer); it may be a virtual sheet of paper (if the output device is a PDF file); it may even be a bitmap image. The exact nature of the page depends on the particular graphics context you use.</p><a name="//apple_ref/doc/uid/TP30001066-CH202-TPXREF131" title="Drawing Destinations: The Graphics Context"></a><h2>Drawing Destinations: The Graphics Context</h2><p>A <strong>graphics context</strong> is an opaque data type (<code><a href="../../../Reference/CGContext/Reference/reference.html#//apple_ref/c/tdef/CGContextRef" target="_top">CGContextRef</a></code>) that encapsulates the information Quartz uses to draw images to an output device, such as a PDF file, a bitmap, or a window on a display. The information inside a graphics context includes graphics drawing parameters and a device-specific representation of the paint on the page. All objects in Quartz are drawn to, or contained by, a graphics context. </p><p>You can think of a graphics context as a drawing destination, as shown in <span class="content_text">Figure 1-3</span>. When you draw with Quartz, all device-specific characteristics are contained within the specific type of graphics context you use. In other words, you can draw the same image to a different device simply by providing a different graphics context to the same sequence of Quartz drawing routines. You do not need to perform any device-specific calculations; Quartz does it for you. </p><br/><div><a name="//apple_ref/doc/uid/TP30001066-CH202-BBCJFFEJ" title="Figure 1-3Quartz drawing destinations"></a><p><strong>Figure 1-3&nbsp;&nbsp;</strong>Quartz drawing destinations</p><img src = "../Art/draw_destinations.gif" alt = "Quartz drawing destinations" width="404" height="384"></div><br/><p>These graphics contexts are available to your application:</p><ul class="ul"><li class="li"><p>A <strong>bitmap graphics context</strong> allows you to paint RGB colors, CMYK colors, or grayscale into a bitmap. A <strong>bitmap</strong> is a rectangular array (or raster) of pixels, each pixel representing a point in an image. Bitmap images are also called sampled images. The CMYK bitmap graphics context is available starting with Mac OS X v10.3. See <span class="content_text"><a href="../dq_context/dq_context.html#//apple_ref/doc/uid/TP30001066-CH203-CJBHBFFE">“Creating a Bitmap Graphics Context.”</a></span></p></li><li class="li"><p>A <strong>PDF graphics context</strong> allows you to create a PDF file. In a PDF file, your drawing is preserved as a sequence of commands. There are some significant differences between PDF files and bitmaps:</p><ul class="nested"><li class="nested li"><p>PDF files, unlike bitmaps, may contain more than one page.</p></li><li class="nested li"><p>When you draw a page from a PDF file on a different device, the resulting image is optimized for the display characteristics of that device.</p></li><li class="nested li"><p>PDF files are resolution independent by nature—the size at which they are drawn can be increased or decreased infinitely without sacrificing image detail. The user-perceived quality of a bitmap image is tied to the resolution at which the bitmap is intended to be viewed.</p></li></ul><p>See <span class="content_text"><a href="../dq_context/dq_context.html#//apple_ref/doc/uid/TP30001066-CH203-TPXREF118">“Creating a PDF Graphics Context.”</a></span></p></li><li class="li"><p>A <strong>window graphics context</strong> is a bitmap graphics context that you can use to draw into a window. Note that because Quartz 2D is a graphics engine and not a window management system, you use one of the Mac OS X application frameworks to obtain a graphics context for a window. See <span class="content_text"><a href="../dq_context/dq_context.html#//apple_ref/doc/uid/TP30001066-CH203-CJBDCHAC">“Creating a Window Graphics Context”</a></span> for information on how to obtain a graphics context in Carbon and Cocoa applications.</p></li><li class="li"><p>A <strong>layer context</strong> (<code><a href="../../../Reference/CGLayer/Reference/reference.html#//apple_ref/c/tdef/CGLayerRef" target="_top">CGLayerRef</a></code>) is an offscreen drawing destination designed for optimal performance. Introduced in Mac OS X v10.4, a layer context is a much better choice for offscreen drawing than a bitmap graphics context. See <span class="content_text"><a href="../dq_layers/dq_layers.html#//apple_ref/doc/uid/TP30001066-CH219-TPXREF101">“CGLayer Drawing.”</a></span></p></li><li class="li"><p>A <strong>PostScript graphics context</strong> is managed by the printing framework. See <span class="content_text"><a href="../dq_context/dq_context.html#//apple_ref/doc/uid/TP30001066-CH203-CJBJDEFF">“Obtaining a Graphics Context for Printing”</a></span> for more information.</p></li></ul><p>As of Mac OS X v10.4, Quartz has CGLayer objects, which are drawing layers that are associated with a graphics context. Drawing to a layer destination improves performance for certain types of drawing. For more information, see <span class="content_text"><a href="../dq_layers/dq_layers.html#//apple_ref/doc/uid/TP30001066-CH219-TPXREF101">“CGLayer Drawing.”</a></span></p><a name="//apple_ref/doc/uid/TP30001066-CH202-BBCGCGBA" title="Quartz 2D Opaque Data Types"></a><h2>Quartz 2D Opaque Data Types</h2><p>The Quartz 2D API defines a variety of opaque data types in addition to graphics contexts. Because the API is part of the Core Graphics framework, the data types and the routines that operate on them use the CG prefix. </p><p>Quartz 2D creates objects from opaque data types that your application operates on to achieve a particular drawing output. <span class="content_text">Figure 1-4</span> shows the sorts of results you can achieve when you apply drawing operations to three of the objects provided by Quartz 2D. For example: </p><ul class="ul"><li class="li"><p>You can rotate and display a PDF page by creating a PDF page object, applying a rotation operation to the graphics context, and asking Quartz 2D to draw the page to a graphics context.</p></li><li class="li"><p>You can draw a pattern by creating a pattern object, defining the shape that makes up the pattern, and setting up Quartz 2D to use the pattern as paint when it draws to a graphics context.</p></li><li class="li"><p>You can fill an area with an axial or radial shading by creating a shading object, providing a function that determines the color at each point in the shading, and then asking Quartz 2D to use the shading as a fill color.</p></li></ul><br/><div><a name="//apple_ref/doc/uid/TP30001066-CH202-BBCDJCDE" title="Figure 1-4Opaque data types are the basis of drawing primitives in Quartz 2D"></a><p><strong>Figure 1-4&nbsp;&nbsp;</strong>Opaque data types are the basis of drawing primitives in Quartz 2D</p><img src = "../Art/drawing_primitives.gif" alt = "Opaque data types are the basis of drawing primitives in Quartz 2D" width="349" height="174"></div><br/><p>The opaque data types available in Quartz 2D include the following:</p><ul class="ul"><li class="li"><p><code><a href="../../../Reference/CGPath/Reference/reference.html#//apple_ref/c/tdef/CGPathRef" target="_top">CGPathRef</a></code>, used for vector graphics to create paths that you fill or stroke. See <span class="content_text"><a href="../dq_paths/dq_paths.html#//apple_ref/doc/uid/TP30001066-CH211-TPXREF101">“Paths.”</a></span></p></li><li class="li"><p><code><a href="../../../Reference/CGImage/Reference/reference.html#//apple_ref/c/tdef/CGImageRef" target="_top">CGImageRef</a></code>, used to represent bitmap images and bitmap image masks based on sample data that you supply. See <span class="content_text"><a href="../dq_images/dq_images.html#//apple_ref/doc/uid/TP30001066-CH212-TPXREF101">“Bitmap Images and Image Masks.”</a></span></p></li><li class="li"><p><code><a href="../../../Reference/CGLayer/Reference/reference.html#//apple_ref/c/tdef/CGLayerRef" target="_top">CGLayerRef</a></code>, used to represent a drawing layer that can be used for repeated drawing (such as for backgrounds or patterns) and for offscreen drawing, available starting in Mac OS X v10.4. See <span class="content_text"><a href="../dq_layers/dq_layers.html#//apple_ref/doc/uid/TP30001066-CH219-TPXREF101">“CGLayer Drawing”</a></span></p></li><li class="li"><p><code><a href="../../../Reference/CGPattern/Reference/reference.html#//apple_ref/c/tdef/CGPatternRef" target="_top">CGPatternRef</a></code>, used for repeated drawing, available starting in Mac OS X v10.2. See <span class="content_text"><a href="../dq_patterns/dq_patterns.html#//apple_ref/doc/uid/TP30001066-CH206-TPXREF101">“Patterns.”</a></span></p></li><li class="li"><p><code><a href="../../../Reference/CGShading/Reference/reference.html#//apple_ref/c/tdef/CGShadingRef" target="_top">CGShadingRef</a></code> (available starting in Mac OS X v10.2) and <code><a href="../../../Reference/CGGradient/Reference/reference.html#//apple_ref/c/tdef/CGGradientRef" target="_top">CGGradientRef</a></code> (available starting in Mac OS X v10.5), used to paint gradients. See <span class="content_text"><a href="../dq_shadings/dq_shadings.html#//apple_ref/doc/uid/TP30001066-CH207-TPXREF101">“Gradients.”</a></span></p></li><li class="li"><p><code><a href="../../../Reference/CGFunction/Reference/reference.html#//apple_ref/c/tdef/CGFunctionRef" target="_top">CGFunctionRef</a></code>, used to define callback functions that take an arbitrary number of floating-point arguments, available starting in Mac OS X v10.2. You use this data type when you create gradients for a shading. See <span class="content_text"><a href="../dq_shadings/dq_shadings.html#//apple_ref/doc/uid/TP30001066-CH207-TPXREF101">“Gradients.”</a></span></p></li><li class="li"><p><code><a href="../../../Reference/CGColor/Reference/reference.html#//apple_ref/c/tdef/CGColorRef" target="_top">CGColorRef</a></code> and <code><a href="../../../Reference/CGColorSpace/Reference/reference.html#//apple_ref/c/tdef/CGColorSpaceRef" target="_top">CGColorSpaceRef</a></code>, used to inform Quartz how to interpret color. CGColor is available starting in Mac OS X v10.3. See <span class="content_text"><a href="../dq_color/dq_color.html#//apple_ref/doc/uid/TP30001066-CH205-TPXREF101">“Color and Color Spaces.”</a></span></p></li><li class="li"><p><code><a href="../../../Reference/CGPSConverter/Reference/reference.html#//apple_ref/c/tdef/CGPSConverterRef" target="_top">CGPSConverterRef</a></code>, used to convert PostScript to PDF, available starting in Mac OS X v10.3. See <span class="content_text"><a href="../dq_ps_convert/dq_ps_convert.html#//apple_ref/doc/uid/TP30001066-CH215-TPXREF101">“PostScript Conversion.”</a></span></p></li><li class="li"><p><code><a href="../../../Reference/CGDataConsumer/Reference/reference.html#//apple_ref/c/tdef/CGDataConsumerRef" target="_top">CGDataConsumerRef</a></code>  and <code><a href="../../../Reference/CGDataProvider/Reference/reference.html#//apple_ref/c/tdef/CGDataProviderRef" target="_top">CGDataProviderRef</a></code>, which you use to move data into and out of Quartz. See <span class="content_text"><a href="../dq_data_mgr/dq_data_mgr.html#//apple_ref/doc/uid/TP30001066-CH216-TPXREF101">“Data Management.”</a></span> </p><div class="notebox"><a name="//apple_ref/doc/uid/TP30001066-CH202-DontLinkElementID_59" title="Note"></a><p><strong>Note:</strong>&nbsp;The preferred way for managing image data in Mac OS X v10.4 and later is to use <code><a href="../../../Reference/CGImageSource/Reference/reference.html#//apple_ref/c/tdef/CGImageSourceRef" target="_top">CGImageSourceRef</a></code> and <code><a href="../../../Reference/CGImageDestination/Reference/reference.html#//apple_ref/c/tdef/CGImageDestinationRef" target="_top">CGImageDestinationRef</a></code>. See <em><a href="../../ImageIOGuide/index.html#//apple_ref/doc/uid/TP40005462" target="_top">Image I/O Programming Guide</a></em>.</p></div></li><li class="li"><p><code><a href="../../../Reference/CGFont/Reference/reference.html#//apple_ref/c/tdef/CGFontRef" target="_top">CGFontRef</a></code>, used to draw text. See <span class="content_text"><a href="../dq_text/dq_text.html#//apple_ref/doc/uid/TP30001066-CH213-TPXREF101">“Text.”</a></span></p></li><li class="li"><p><code><a href="../../../Reference/CGPDFDictionary/Reference/reference.html#//apple_ref/c/tdef/CGPDFDictionaryRef" target="_top">CGPDFDictionaryRef</a></code>, <code><a href="../../../Reference/CGPDFObject/Reference/reference.html#//apple_ref/c/tdef/CGPDFObjectRef" target="_top">CGPDFObjectRef</a></code>, <code><a href="../../../Reference/CGPDFPage/Reference/reference.html#//apple_ref/c/tdef/CGPDFPageRef" target="_top">CGPDFPageRef</a></code>, <code><a href="../../../Reference/CGPDFStream/Reference/reference.html#//apple_ref/c/tdef/CGPDFStreamRef" target="_top">CGPDFStream</a></code>, <code><a href="../../../Reference/CGPDFString/Reference/reference.html#//apple_ref/c/tdef/CGPDFStringRef" target="_top">CGPDFStringRef</a></code>, and <code><a href="../../../Reference/CGPDFArray/Reference/reference.html#//apple_ref/c/tdef/CGPDFArrayRef" target="_top">CGPDFArrayRef</a></code>, which provide access to PDF metadata, are available starting in Mac OS X v10.3. See <span class="content_text"><a href="../dq_pdf/dq_pdf.html#//apple_ref/doc/uid/TP30001066-CH214-TPXREF101">“PDF Document Creation, Viewing, and Transforming.”</a></span></p></li><li class="li"><p><code><a href="../../../Reference/CGPDFScanner/Reference/reference.html#//apple_ref/c/tdef/CGPDFScannerRef" target="_top">CGPDFScannerRef</a></code> and <code><a href="../../../Reference/CGPDFContentStream/Reference/reference.html#//apple_ref/c/tdef/CGPDFContentStreamRef" target="_top">CGPDFContentStreamRef</a></code>, which parse PDF metadata and are available starting in Mac OS X v10.4. See <span class="content_text"><a href="../dq_pdf_scan/dq_pdf_scan.html#//apple_ref/doc/uid/TP30001066-CH220-TPXREF101">“PDF Document Parsing.”</a></span></p></li></ul><a name="//apple_ref/doc/uid/TP30001066-CH202-TPXREF132" title="Graphics States"></a><h2>Graphics States</h2><p>Quartz modifies the results of drawing operations according to the parameters in the <strong>current graphics state</strong>. The graphics state contains parameters that would otherwise be taken as arguments to drawing routines. Routines that draw to a graphics context consult the graphics state to determine how to render their results. For example, when you call a function to set the fill color, you are modifying a value stored in the current graphics state. Other commonly used elements of the current graphics state include the line width, the current position, and the text font size.</p><p>The graphics context contains a stack of graphics states. When Quartz creates a graphics context, the stack is empty. When you save the graphics state, Quartz pushes a copy of the current graphics state onto the stack. When you restore the graphics state, Quartz pops the graphics state off the top of the stack. The popped state becomes the current graphics state.</p><p>The graphics context maintains a stack of graphics states. To save the current graphics state, use the function <code>CGContextSaveGState</code> to push a copy of the current graphics state onto the stack. To restore a previously saved graphics state, use the function <code>CGContextRestoreGState</code> to replace the current graphics state with the graphics state that’s on top of the stack.</p><p>Note that not all aspects of the current drawing environment are elements of the graphics state. For example, the current path is not considered part of the graphics state and is therefore not saved when you call the function <code>CGContextSaveGState</code>. The graphics state parameters that are saved when you call this function are listed in <span class="content_text">Table 1-1</span>.</p><a name="//apple_ref/doc/uid/TP30001066-CH202-BBCIJEHA" title="Table 1-1Parameters that are associated with the graphics state"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 1-1&nbsp;&nbsp;</strong>Parameters that are associated with the graphics state</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Parameters</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Discussed in this chapter</p></th></tr><tr><td  scope="row"><p>Current transformation matrix (CTM)</p></td><td ><p><span class="content_text"><a href="../dq_affine/dq_affine.html#//apple_ref/doc/uid/TP30001066-CH204-TPXREF101">“Transforms”</a></span></p></td></tr><tr><td  scope="row"><p>Clipping area</p></td><td ><p><span class="content_text"><a href="../dq_paths/dq_paths.html#//apple_ref/doc/uid/TP30001066-CH211-TPXREF101">“Paths”</a></span></p></td></tr><tr><td  scope="row"><p>Line: width, join, cap, dash, miter limit</p></td><td ><p><span class="content_text"><a href="../dq_paths/dq_paths.html#//apple_ref/doc/uid/TP30001066-CH211-TPXREF101">“Paths”</a></span></p></td></tr><tr><td  scope="row"><p>Accuracy of curve estimation (flatness)</p></td><td ><p><span class="content_text"><a href="../dq_paths/dq_paths.html#//apple_ref/doc/uid/TP30001066-CH211-TPXREF101">“Paths”</a></span></p></td></tr><tr><td  scope="row"><p>Anti-aliasing setting</p></td><td ><p><span class="content_text"><a href="../dq_context/dq_context.html#//apple_ref/doc/uid/TP30001066-CH203-TPXREF101">“Graphics Contexts”</a></span></p></td></tr><tr><td  scope="row"><p>Color: fill and stroke settings</p></td><td ><p><span class="content_text"><a href="../dq_color/dq_color.html#//apple_ref/doc/uid/TP30001066-CH205-TPXREF101">“Color and Color Spaces”</a></span></p></td></tr><tr><td  scope="row"><p>Alpha value (transparency) </p></td><td ><p><span class="content_text"><a href="../dq_color/dq_color.html#//apple_ref/doc/uid/TP30001066-CH205-TPXREF101">“Color and Color Spaces”</a></span></p></td></tr><tr><td  scope="row"><p>Rendering intent</p></td><td ><p><span class="content_text"><a href="../dq_color/dq_color.html#//apple_ref/doc/uid/TP30001066-CH205-TPXREF101">“Color and Color Spaces”</a></span></p></td></tr><tr><td  scope="row"><p>Color space: fill and stroke settings</p></td><td ><p><span class="content_text"><a href="../dq_color/dq_color.html#//apple_ref/doc/uid/TP30001066-CH205-TPXREF101">“Color and Color Spaces”</a></span></p></td></tr><tr><td  scope="row"><p>Text: font, font size, character spacing, text drawing mode</p></td><td ><p><span class="content_text"><a href="../dq_text/dq_text.html#//apple_ref/doc/uid/TP30001066-CH213-TPXREF101">“Text”</a></span></p></td></tr><tr><td  scope="row"><p>Blend mode</p></td><td ><p><span class="content_text"><a href="../dq_paths/dq_paths.html#//apple_ref/doc/uid/TP30001066-CH211-TPXREF101">“Paths”</a></span> and <span class="content_text"><a href="../dq_images/dq_images.html#//apple_ref/doc/uid/TP30001066-CH212-TPXREF101">“Bitmap Images and Image Masks”</a></span></p></td></tr></table></div><a name="//apple_ref/doc/uid/TP30001066-CH202-CJBBAEEC" title="Quartz 2D Coordinates"></a><h2>Quartz 2D Coordinates</h2><p>A coordinate system defines the range of locations used to express the location and sizes of objects to be drawn on the page. You specify the location and size of graphics in the user-space coordinate system, or, more simply, the <strong>user space</strong>. Coordinates are defined as floating-point values.</p><br/><div><a name="//apple_ref/doc/uid/TP30001066-CH202-DontLinkElementID_60" title="Figure 1-5The Quartz coordinate system"></a><p><strong>Figure 1-5&nbsp;&nbsp;</strong>The Quartz coordinate system</p><img src = "../Art/quartz_coordinates.gif" alt = "The Quartz coordinate system" width="235" height="168"></div><br/><p>Because different devices have different underlying imaging capabilities, the locations and sizes of graphics must be defined in a device-independent manner. For example, a screen display device might be capable of displaying no more than 96 pixels per inch, while a printer might be capable of displaying 300 pixels per inch. If you define the coordinate system at the device level (in this example, either 96 pixels or 300 pixels), objects drawn in that space cannot be reproduced on other devices without visible distortion. They will appear too large or too small.</p><p>Quartz accomplishes device independence with a separate coordinate system—user space—mapping it to the coordinate system of the output device—device space—using the <strong>current transformation matrix</strong>, or CTM. A <strong>matrix</strong> is a mathematical construct used to efficiently describe a set of related equations. The current transformation matrix is a particular type of matrix called an <strong>affine transform</strong>, which maps points from one coordinate space to another by applying <strong>translation</strong>, <strong>rotation</strong>, and <strong>scaling</strong> operations (calculations that move, rotate, and resize a coordinate system).</p><p>The current transformation matrix has a secondary purpose: It allows you to transform how objects are drawn. For example, to draw a box rotated by 45 degrees, you rotate the coordinate system of the page (the CTM) before you draw the box. Quartz draws to the output device using the rotated coordinate system.</p><p>A point in user space is represented by a coordinate pair (<em>x</em>, <em>y</em>), where <em>x</em> represents the location along the horizontal axis (left and right) and <em>y</em> represents the vertical axis (up and down). The <strong>origin</strong> of the user coordinate space is the point (0,0). By default, the origin is located at the lower-left corner of the page. The x-axis increases as it moves from the left toward the right of the page. The y-axis increases in value as it moves from the bottom toward the top of the page.</p><a name="//apple_ref/doc/uid/TP30001066-CH202-CJBIBHHB" title="Memory Management: Object Ownership"></a><h2>Memory Management: Object Ownership</h2><p>Quartz uses the Core Foundation memory management model, in which objects are reference counted. When created, Core Foundation objects start out with a reference count of 1. You can increment the reference count by calling a function to retain the object, and decrement the reference count by calling a function to release the object. When the reference count is decremented to 0, the object is freed. This allows objects to safely share references to other objects.</p><p>There are a few simple rules to keep in mind:</p><ul class="ul"><li class="li"><p>If you create or copy an object, you own it, and therefore you must release it. That is, in general, if you obtain an object from a function with the words “Create” or “Copy” in its name, you must release the object when you’re done with it. Otherwise, a memory leak results.</p></li><li class="li"><p>If you obtain an object from a function that does not contain the words “Create” or “Copy” in its name, you do not own a reference to the object, and you must not release it. The object will be released by its owner at some point in the future.</p></li><li class="li"><p>If you do not own an object and you need to keep it around, you must retain it and release it when you’re done with it. You use the Quartz 2D functions specific to an object to retain and release that object. For example, if you create a CGColorspace object, you use the functions <code>CGColorSpaceRetain</code> and <code>CGColorSpaceRelease</code> to retain and release the object as needed. You can also use the Core Foundation functions <code><a href="../../../../CoreFoundation/Reference/CFTypeRef/Reference/reference.html#//apple_ref/doc/c_ref/CFRetain" target="_top">CFRetain</a></code> and <code><a href="../../../../CoreFoundation/Reference/CFTypeRef/Reference/reference.html#//apple_ref/doc/c_ref/CFRelease" target="_top">CFRelease</a></code>, but you must be careful not to pass <code>NULL</code> to these functions.</p></li></ul><a name="//apple_ref/doc/uid/TP30001066-CH202-BABJBDFD" title="Quartz Performance: A Look Under the Hood"></a><h2>Quartz Performance: A Look Under the Hood</h2><p>When your application draws to a window using Quartz 2D function calls, the drawing travels from your application to the window’s backing store. From there, Quartz composites all window backing stores, including those generated by OpenGL and video playback, and sends the composite to a frame buffer.</p><p>The Quartz Compositor acts like a video mixer in which every pixel onscreen can be shared among windows in real time. Sharing is a big break from traditional windowing systems, which use a switch model. In a switch model, every pixel onscreen belongs entirely to one window or the desktop. The switch model results in a less elegant interface, with abrupt switching between windows. The video mixer model, combined with the ability to make windows translucent, allows for smooth transitions between the states of a graphical user interface and gives Mac OS X its unique and elegant look.</p><p>Quartz Extreme, introduced in Mac OS X v10.2, harnesses the power of the graphics processing unit (GPU) to composite the window backing store to the frame buffer. For computers that do not have the minimum graphics hardware needed for Quartz Extreme, Quartz uses the CPU, just as it did prior to Mac OS X v10.2.</p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../dq_intro/dq_intro.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../dq_context/dq_context.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2001, 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-12-11<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_overview/dq_overview.html%3Fid%3DTP30001066-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_overview/dq_overview.html%3Fid%3DTP30001066-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_overview/dq_overview.html%3Fid%3DTP30001066-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>