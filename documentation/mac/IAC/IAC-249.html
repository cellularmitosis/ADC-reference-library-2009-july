<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Writing an Object-Comparison Function(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING249></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-248.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-250.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-231.html"><B>Chapter 6 - Resolving and Creating Object Specifier Records</B></A> / <A HREF="IAC-247.html"><B>Writing Object Callback Functions</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING249-0></A>
<H2><A NAME=MARKER-9-212></A>Writing an Object-Comparison Function</H2>
 <A NAME=MARKER-2-213></A>To handle object specifier records that specify tests, your application should provide an object-comparison function (unless it specifies <CODE>kAEIDoWhose</CODE> as described on <A HREF=IAC-247.html#MARKER-9-207>page 6-56</A>). Your object-comparison function should be able to compare one Apple event object to another Apple event object or to another descriptor record. <P>
 You specify your object-comparison function with the <CODE>AESetObjectCallbacks</CODE> function. Whenever it is resolving object specifier records and needs to compare the value of an Apple event object with another object or with data, the Apple Event Manager calls your object-comparison function.<P>
 Here's the declaration for a sample object-comparison function:<P>
<PRE>
FUNCTION MyCompareObjects (comparisonOperator: DescType; 
                           object: AEDesc;
                           objectOrDescToCompare: AEDesc; 
                           VAR result: Boolean): OSErr;
</PRE>
 The Apple Event Manager passes the following information to your object-comparison function: a comparison operator that specifies how the two objects should be compared, a token for the first Apple event object, and either a token that describes the Apple event object to compare or a descriptor record.<P>
 It is up to your application to interpret the comparison operators it receives. The meaning of comparison operators differs according to the Apple event objects being compared, and not all comparison operators apply to all object classes. After successfully comparing the Apple event objects, your object-comparison function should return the <CODE>noErr</CODE> result code and, in the <CODE>result</CODE> parameter, a Boolean value specifying <CODE>TRUE</CODE> if the result of the comparison is true and <CODE>FALSE</CODE> otherwise. If for any reason your comparison function is unable to compare the specified Apple event objects, it should return the result code <CODE>errAEEventNotHandled</CODE>; then the Apple Event Manager will try an alternative method of comparing the Apple event objects, such as calling the equivalent system object-comparison function, if one exists.<P>
 Your object-comparison function should be able to compare an Apple event object belonging to any object class with another Apple event object. Your function should also be able to compare two Apple event objects with different object classes, if appropriate. For example, an object-comparison function for a word-processing application might be asked to compare the First Name column of a specified row in a table with the first word on a specified page--that is, to compare an Apple event object of object class <CODE>cColumn</CODE> with an Apple event object of object class <CODE>cWord</CODE>. You must decide what kinds of comparisons make sense for your application.<P>
 The <I>Apple Event Registry: Standard Suites</I> defines standard comparison operators. Here is a list of the constants that correspond to these comparison operators:<P>
<PRE>
CONST 
   kAEGreaterThan       = '&gt;   ';
   kAEGreaterThanEquals = '&gt;=  ';
   kAEEquals            = '=   ';
   kAELessThan          = '&lt;   ';
   kAELessThanEquals    = '&lt;=  ';
   kAEBeginsWith        = 'bgwt';
   kAEEndsWith          = 'ends'; 
   kAEContains          = 'cont'; 
</PRE>
 The comparison operators always relate the first operand to the second. For example, the constant kAEGreaterThan means that the object-comparison function should determine whether or not the value of the first operand is greater than the value of the second operand. For more information, see <A HREF=IAC-272.html#MARKER-9-338>page 6-103</A>.<P>
 <A HREF=#MARKER-9-214>Listing 6-11</A> shows an application-defined function, <CODE>MyCompareObjects</CODE>, that compares two Apple event objects of any object class supported by the application. <P>
<B>Listing 6-11  <A NAME=MARKER-9-214></A>Object-comparison function that compares two Apple event objects<A NAME=MARKER-9-222></A></B><P>
<PRE>
FUNCTION MyCompareObjects (comparisonOperator: DescType; 
                           theObject: AEDesc;
                           objectOrDescToCompare: AEDesc; 
                           VAR result: Boolean): OSErr;
BEGIN
   result := FALSE;
   {compare two objects for equivalence}
   IF comparisonOperator = kAEEquals THEN
      MyCompareObjects := MyCompEquals(theObject, 
                                       objectOrDescToCompare, 
                                       result)
   ELSE
      {compare two objects for greater than}
      IF comparisonOperator = kAEGreaterThan THEN
         MyCompareObjects := MyCompGreaterThan(theObject, 
                                          objectOrDescToCompare,
                                          result)
   ELSE
      {compare two objects for less than}
      IF comparisonOperator = kAELessThan THEN
         MyCompareObjects := MyCompLessThan(theObject, 
                                          objectOrDescToCompare,
                                          result)
   ELSE
   {this app does not support any other comparison operators}
      MyCompareObjects := errAEEventNotHandled;
END;
</PRE>
 The <CODE>MyCompareObjects</CODE> function calls a separate application-defined routine for each comparison operator. In each case, the application-defined routine that actually performs the comparison can compare an Apple event object with either another Apple event object or with a descriptor record's data. If for any reason the comparison cannot be performed, the <CODE>MyCompareObjects</CODE> function returns the result code <CODE>errAEEventNotHandled</CODE>. <A NAME=MARKER-2-216></A> <P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-248.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-250.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
