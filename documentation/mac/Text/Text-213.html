<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>The Global Width Table(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING213></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-212.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-214.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-181.html"><B>Chapter 4 - Font Manager</B></A> / <A HREF="Text-209.html"><B>Font Manager Reference</B></A><BR><DL><DD><A HREF="Text-210.html"><B>Data Structures</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING213-0></A>
<H3><A NAME=MARKER-9-315></A>The Global Width Table</H3>
 <A NAME=MARKER-2-69></A><A NAME=MARKER-2-278></A>The global width table record, of data type <CODE>WidthTable</CODE>, contains the widths of all the glyphs of one font. The font family, point size, and style of this font are specified in this table. Your application should use the widths found in the global width table for placement of glyphs and words both on the screen and on the printed page. You can use the <CODE>FontMetrics</CODE> procedure, described on <A HREF=Text-232.html#MARKER-9-365>page 4-50</A>, to get a handle to the global width table. However, you should not assume that the table is the same size as shown in the record declaration; it may be larger because of some private system-specific information that is attached to it.<P>
<PRE>
Type WidthTable =
PACKED RECORD
   tabData: ARRAY [1..256] OF Fixed;
                           {character widths}
   tabFont:    Handle;     {font record used to build table}
   sExtra:     LongInt;    {extra line spacing}
   style:      LongInt;    {extra line spacing due to style}
   fID:        Integer;    {font family ID}
   fSize:      Integer;    {font size request}
   face:       Integer;    {style (face) request}
   device:     Integer;    {device requested}
   inNumer:    Point;      {scale factors requested}
   inDenom:    Point;      {scale factors requested}
   aFID:       Integer;    {actual font family ID for table}
   fHand:      Handle;     {family record used to build up table}
   usedFam:    Boolean;    {used fixed-point family widths}
   aFace:      Byte;       {actual face produced}
   vOutput:    Integer;    {vertical scale output value}
   hOutput:    Integer;    {horizontal scale output value}
   vFactor:    Integer;    {vertical scale output value}
   hFactor:    Integer;    {horizontal scale output value}
   aSize:      Integer;    {size of actual font used}
   tabSize:    Integer;    {total size of table}
END;
</PRE>
<DL>
<H5>Field Description</H5>
<DT><CODE>tabData</CODE>
<DD> The widths for the glyphs in the font, in standard 32-bit fixed-point format. If a glyph is missing in the font, its entry contains the width of the missing-character glyph.
<DT><CODE>tabFont</CODE>
<DD> A handle to the font resource used to build this table.
<DT><CODE>sExtra</CODE> 
<DD> The average number of pixels by which QuickDraw widens each space in a line of text.
<DT><CODE>style</CODE>
<DD> The average number of pixels by which QuickDraw widens a line of text after applying a style<A NAME=MARKER-2-318></A>.
<DT><CODE>fID</CODE>
<DD> The font family ID of the font represented by this table. This is the ID that was used in the request to build the table. It may be different from the ID of the font family that was used, which is indicated by the <CODE>aFID</CODE> field. 
<DT><CODE>fSize</CODE>
<DD> The point size that was originally requested for the font represented by this table. The actual size used is specified in the <CODE>aSize</CODE> field.
<DT><CODE>face</CODE>
<DD> The font style that was originally requested for the font represented by this table. The actual style used is specified in the <CODE>aFace</CODE> field.
<DT><CODE>device</CODE> 
<DD> The device ID of the device on which these widths may be used.
<DT><CODE>inNumer</CODE>
<DD> The numerators of the vertical and horizontal scaling factors. The <CODE>numer</CODE> field is of type <CODE>Point</CODE> and contains two integers: the first is the numerator of the ratio for vertical scaling and the second is the numerator of the ratio for horizontal scaling.<A NAME=MARKER-2-319></A> <A NAME=MARKER-2-198></A>
<DT><CODE>inDenom</CODE>
<DD> The denominators of the vertical and horizontal scaling factors. The <CODE>denom</CODE> field is of type <CODE>Point</CODE> and contains two integers: the first is the denominator of the ratio for vertical scaling and the second is the denominator of the ratio for horizontal scaling. <A NAME=MARKER-2-113></A>
<DT><CODE>aFID</CODE>
<DD> The font family ID of the font family actually used to build this table. If the Font Manager could not find the font requested, this value may be different from the value of the <CODE>fID</CODE> field.
<DT><CODE>fHand</CODE>
<DD> The handle to the font family resource used to build this table.
<DT><CODE>usedFam</CODE>
<DD> Set to <CODE>TRUE</CODE> if the fixed-point family glyph widths were used rather than integer glyph widths.
<DT><CODE>aFace</CODE>
<DD> The font style of the font whose widths are contained in this table. 
<DT><CODE>vOutput</CODE>
<DD> The factor by which glyphs are to be expanded vertically in the current graphics port. This is a 16-bit fixed-point number, with the integer part in the high-order byte and a fractional part in the low-order byte. 
<DT><CODE>hOutput</CODE>
<DD> The factor by which glyphs are to be expanded horizontally in the current graphics port. This is a 16-bit fixed-point number, with the integer part in the high-order byte and a fractional part in the low-order byte.
<DT><CODE>vFactor</CODE>
<DD> The factor by which widths of the chosen font, after a style has been applied, have been increased vertically in the current graphics port. This is a 16-bit fixed-point number, with the integer part in the high-order byte and a fractional part in the low-order byte. The value of the <CODE>vFactor</CODE> field is not used by the Font Manager.
<DT><CODE>hFactor</CODE>
<DD> The factor by which widths of the chosen font, after a style has been applied, have been increased horizontally in the current graphics port. This is a 16-bit fixed-point number, with the integer part in the high-order byte and a fractional part in the low-order byte. 
<DT><CODE>aSize</CODE> 
<DD> The size of the font actually used to build this table. Both the point size and the font used to build this table may be different from the requested point size and font. If font scaling is disabled, the Font Manager may use a size different from the size requested and add more or less space to approximate the appearance of the font requested. See <A HREF=Text-196.html#MARKER-9-162>"The Scaling Process for a Bitmapped Font" on page 4-21</A> for more information.
<DT><CODE>tabSize</CODE>
<DD> The total size of the global width table. 
</DL>
 Multiplying the values of the <CODE>hOutput</CODE> and <CODE>vOutput</CODE> fields by the values of the <CODE>hFactor</CODE> and <CODE>vFactor</CODE> fields, respectively, gives the font scaling. (Because the value of the <CODE>vFactor</CODE> field is ignored, the Font Manager multiplies the value of the <CODE>vOutput</CODE> field by 1.) The product of the value of the <CODE>hOutput</CODE> field and an entry in the global width table is the scaled width for that glyph. <P>
 The Font Manager gathers data for the global width table from one of three data structures:<P>
<OL>
<LI>The Font Manager looks in the font resource for a table that stores fractional glyph widths. For bitmapped fonts, the Font Manager uses the glyph-width table of the bitmapped font resource (described on <A HREF=Text-250.html#MARKER-9-437>page 4-66</A>). For outline fonts, the Font Manager uses the advance width and left-side bearing values in the horizontal metrics table of the outline font (described on <A HREF=Text-262.html#MARKER-9-496>page 4-78</A>). In both cases, the values are stored in 16-bit fixed format, with the integer part in the high-order byte and the fractional part in the low-order byte. 
<LI>If there is no glyph-width table in the font resource, the Font Manager looks for the font family's glyph-width table in the font family resource, which contains fractional widths for a hypothetical 1-point font. The Font Manager calculates the actual values by multiplying these widths by the requested font size. The font family's glyph-width table is described in <A HREF=Text-274.html#MARKER-9-563>"The Family Glyph-Width Table" on page 4-92</A>. 
<LI>If there is no glyph-width table in the font family resource, and if the font is contained in a bitmapped font resource, the Font Manager derives the glyph widths from the integer widths contained in the glyph-width table of the bitmapped font resource, which is described on <A HREF=Text-250.html#MARKER-9-437>page 4-66</A>. There is no corresponding table for the outline font resource. <P>
</OL>
 Your application should obtain glyph widths either from the global width table or from the QuickDraw procedure <CODE>MeasureText</CODE>. The <CODE>MeasureText</CODE> procedure works only with text to be displayed on the screen, not with text to be printed. You can get the individual widths of glyphs of an outline font using the <CODE>OutlineMetrics</CODE> function. The <CODE>FontMetrics</CODE> procedure returns only the width of the largest glyph in a font contained in a bitmapped font resource. <P>
<DL>
<DT><B>IMPORTANT</B>
<DD>Do not use the values from the global width table if your application is running on a computer on which non-Roman script systems are installed. You can check to see if a non-Roman script system is present by calling the <CODE>GetScriptManagerVariable</CODE> function with a selector of <CODE>smEnabled</CODE>; if the function returns a value greater than 0, at least one non-Roman script system is present and you need to call <CODE>MeasureText</CODE> to measure text that is displayed on the screen. Measuring text from a non-Roman script system for printing is handled by the printer driver.<EM></EM><A NAME=MARKER-2-129></A>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 For more information about the <CODE>MeasureText</CODE> procedure, see the chapter "QuickDraw Text" in this book. The <CODE>FontMetrics</CODE> procedure is described on <A HREF=Text-232.html#MARKER-9-365>page 4-50</A> and the <CODE>OutlineMetrics</CODE> function is described on <A HREF=Text-233.html#MARKER-9-371>page 4-52</A>.<A NAME=MARKER-2-323></A><A NAME=MARKER-2-658></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-212.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-214.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
