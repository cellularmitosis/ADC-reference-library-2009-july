<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>ReserveMem (IM: M)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING98></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Memory-97.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Memory-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Memory-202.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Memory-99.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Memory-2.html"><B>Memory</B></A> / <BR><DD><A HREF="Memory-56.html"><B>Chapter 2 - Memory Manager</B></A> / <A HREF="Memory-60.html"><B>Memory Manager Reference</B></A><BR><DL><DD><A HREF="Memory-62.html"><B>Memory Manager Routines</B></A> / <A HREF="Memory-94.html"><B>Managing Relocatable Blocks</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING98-0></A>
<H3><A NAME=MARKER-11-364></A><A NAME=MARKER-9-365></A><A NAME=MARKER-2-366></A>ReserveMem<A NAME=MARKER-2-367></A></H3>
 <A NAME=MARKER-2-368></A>Use the <CODE>ReserveMem</CODE> procedure when you allocate a relocatable block that you intend to lock for long periods of time. This helps prevent heap fragmentation because it reserves space for the block as close to the bottom of the heap as possible. Consistent use of <CODE>ReserveMem</CODE> for this purpose ensures that all locked, relocatable blocks and nonrelocatable blocks are together at the bottom of the heap zone and thus do not prevent unlocked relocatable blocks from moving about the zone.<P>
<PRE>
PROCEDURE ReserveMem (cbNeeded: Size);
</PRE>
<DL>
<DT><CODE>cbNeeded</CODE>
<DD> The number of bytes to reserve near the bottom of the heap.
</DL>
<A NAME=HEADING98-4></A>
<H5>DESCRIPTION</H5>
 The <CODE>ReserveMem</CODE> procedure attempts to create free space for a block of <CODE>cbNeeded</CODE> contiguous logical bytes at the lowest possible position in the current heap zone. It pursues every available means of placing the block as close as possible to the bottom <BR>of the zone, including moving other relocatable blocks upward, expanding the zone <BR>(if possible), and purging blocks from it.<P>
 Because <CODE>ReserveMem</CODE> does not actually allocate the block, you must combine calls to <CODE>ReserveMem</CODE> with calls to the <CODE>NewHandle</CODE> function.<P>
 Do not use the <CODE>ReserveMem</CODE> procedure for a relocatable block you intend to lock for only a short period of time. If you do so and then allocate a nonrelocatable block above it, the relocatable block becomes trapped under the nonrelocatable block when you unlock that relocatable block.<P>
<DL>
<DT><B>Note</B>
<DD>It isn't necessary to call <CODE>ReserveMem</CODE> to reserve space for a nonrelocatable block, because the <CODE>NewPtr</CODE> function calls it automatically. Also, you do not need to call <CODE>ReserveMem</CODE> to reserve memory before you load a locked resource into memory, because the Resource Manager calls <CODE>ReserveMem</CODE> automatically.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
<A NAME=HEADING98-9></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 Because the <CODE>ReserveMem</CODE> procedure could move and purge memory, you should not call it at interrupt time.<P>
<A NAME=HEADING98-11></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The registers on entry and exit for <CODE>ReserveMem</CODE> are
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN = LEFT colspan=2>Registers on entry<TR>
<TD>D0<TD>Number of bytes to reserve</TABLE>

<TABLE BORDER="0" CELLPADDING=3><TH ALIGN = LEFT colspan=2>Registers on exit<TR>
<TD>D0<TD>Result code</TABLE>
<P>
 The <CODE>ReserveMem</CODE> procedure reserves memory in the current heap zone. If you want to reserve memory in the system heap zone rather than in the current heap zone, set bit 10 of the routine trap word. In most development systems, you can do this by supplying the word <CODE>SYS</CODE> as the second argument to the routine macro, as follows:<P>
<PRE>
_ResrvMem ,SYS
</PRE>
<A NAME=HEADING98-15></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>memFullErr<TD>-108<TD>Not enough memory<A NAME=MARKER-2-32></A></TABLE>
</H5>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Memory-97.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Memory-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Memory-202.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Memory-99.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Memory-3.html">&copy; Apple Computer, Inc.</A><br>3 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
