<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/1998/REC-html40-19980424/loose.dtd">
<html>
<head>
<title>IOAudioDevice</title>
<meta http-equiv="Content-Type" content="text/html; charset=ascii">
<meta name="generator" content="HeaderDoc">
<style><!--
#tocMenu {
		display: block;
		position:fixed;
		top:0px;
		left:0px;
		width:210px;
		height:100%;
		background:transparent;
}
#bodyText {
		margin-left: 210px;
}
--></style>
<meta id="toc-file" name="toc-file" content="toc.html">
<script language="JavaScript" src="../../../../../../Resources/JavaScript/page.js" type="text/javascript"></script><link rel="stylesheet" type="text/css" href="../../../../../../Resources/CSS/frameset_styles.css">
<style type="text/css"><!--.keyword {background:#ffffff; color:#761550;}.template {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.function {background:#ffffff; color:#000000;}.string {background: #ffffff; color:#891315;}.preprocessor {background:#ffffff; color:#236e25}.comment {background:#ffffff; color:#236e25}.char {background: #ffffff; color:#0000ff;}.var {background:#ffffff; color:#000000;}.type {background:#ffffff; color:#761550;}.param {background:#ffffff; color:#000000;}.graybox {         border-top: 1px solid #919699;         border-left: 1px solid #919699;         margin-bottom: 10px;         }  .graybox th {         padding: 4px 8px 4px 8px;         background: #E2E2E2;         font-size: 12px;         font-weight: bold;         border-bottom: 1px solid #919699;         border-right: 1px solid #919699;         }  .graybox td {         padding: 8px;         font-size: 12px;         text-align: left;         vertical-align: top;         border-bottom: 1px solid #919699;         border-right: 1px solid #919699;         }  --></style>
</head>
<body bgcolor="#ffffff" onload="initialize_page();">
<noscript>
<div id="tocMenu">
<iframe id="toc_content" name="toc_content" src="toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
</div>
</noscript>
<div id="bodyText">
<!-- start of header -->

<!-- start of header -->
<!--#include virtual="/includes/framesetheader"-->
<!-- end of header -->

<table width="600"><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <a href="../../../../../../../reference/Darwin/index.html#//apple_ref/doc/uid/TP30001281-TP30000422" target="_top">Darwin</a> <b>&gt;</b> <a href="../../../index.html#//apple_ref/doc/framework/kernel_fw_leo" target="_top">Kernel Framework Reference</a></font>
<!-- end breadcrumb insert request -->
<p>&#160;</p>
</td></tr></table>
<!-- end of header --><a name="top"></a>
<a name="//apple_ref/doc/class/IOAudioDevice" title="IOAudioDevice"></a>
<hr>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h1><a name="IOAudioDevice">IOAudioDevice</a></h1>
</td></tr></table>
<div class="spec_sheet_info_box"><table cellspacing="0" class="specbox">
<tr>
<td scope="row"><b>Inherits from:</b></td>
<td><div style="margin-bottom:1px"><div class="content_text">
<a href="../../../IOService_h/Classes/IOService/index.html#//apple_ref/cpp/cl/IOService" target="_top">IOService</a>
</div></div></td>
</tr>
<tr>
<td scope="row"><b>Declared In:</b></td>
<td><div style="margin-bottom:1px"><div class="content_text"><a href="../../index.html" target="_top">IOAudioDevice.h</a></div></div></td>
</tr>
</table></div>
<h2>Overview</h2>
<p><!-- begin abstract --></p>
<p>Abstract base class for a single piece of audio hardware.  The IOAudioDevice provides
the central coordination point for an audio driver.
<!-- end abstract --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>An audio driver is required to subclass IOAudioDevice in order to provide
working audio to the system.  A single driver instance will contain a single instance of the 
driver's IOAudioDevice subclass.  The subclass is responsible for mapping all hardware device
resources from the service provider nub.  It must control access to the hardware so that the
hardware doesn't get into an inconsistent state.  It is possible that different threads may make
requests of the hardware at the same time.  The IOAudioDevice superclass provides an IOWorkLoop
and IOCommandGate on the IOWorkLoop through which all hardware accesses may be synchronized.
All entry points to all parts of the driver controlled by the IOAudioFamily will be synchronized
through this one IOWorkLoop.
</p>
<p>The IOAudioDevice subclass is responsible for creating the rest of the pieces of the driver.
It must identify and create all IOAudioEngines that are not automatically created by the system
(i.e. those that are not matched and instantiated by IOKit directly).
</p>
<p>The IOAudioDevice subclass must enumerate and create all IOAudioControl objects to match
the device capabilities.
</p>
<p>It must also execute control value changes when requested by the system (for example, volume adjustments).
</p>
<p>In order to allow sleep and work to work on the system, the IOAudioDevice subclass is responsible
for performing the necessary actions to sleep and wake its hardware (and restore necessary state
on wake).
</p>
<p>The IOAudioDevice class provides timer services that allow different elements in the audio driver
to receive timer notifications as needed.  These services were designed with the idea that most
timed events in a typical audio driver need to be done at least as often as a certain interval.
Further, it is designed with the idea that being called more often than the specified interval
doesn't hurt anything - and in fact may help.  With this in mind, the timer services provided
by the IOAudioDevice class allow different targets to register for timer callbacks at least as
often as the specified interval.  The actual interval will be the smallest of the intervals of
all of the callbacks.  This way, we avoid the overhead of having many timers in a single audio
device.  As an example, each output IOAudioEngine has a timer to run the erase head.  It doesn't hurt
to have the erase head run more often.  Also, a typical IOAudioDevice subclass may need to run a timer
to check for device state changes (e.g. jack insertions).
</p>
<p>There are a number of strings passed from the driver to the CoreAudio.framework and then into
applications.  All of those strings should be localized by the driver.  In order to do that
the kext bundle should have localized string files following the Mac OS X localization 
instructions.  The IOAudioDevice should contain a property with the name of the bundle/kext
that contains the localized string resources.  To do that, the driver's personality in 
the bundle resources could have a property named 'IOAudioDeviceLocalizedBundle' with the path 
of the bundle/kext relative to '/System/Library/Extensions'.  It could also be set by the 
IOAudioDevice subclass in its initHardware() function.  To do so, call
setProperty(kIOAudioDeviceLocalizedBundleKey, "Driver.kext").
</p>
<p>In a typical driver, the IOAudioDevice subclass will implement initHardware() to perform the
hardware initialization and driver construction.  Within that initialization it must create at 
least one IOAudioEngine instance and activate it.  In order to activate a new IOAudioEngine
activateAudioEngine() should be called for each one.  It must create the IOAudioControls 
matching the hardware capabilities to allow the system to set volume, mute and input selection.  
To add those controls to the driver, each control should be attached to the IOAudioEngine to
which it applies by calling addDefaultAudioControl() on the IOAudioEngine.
During initialization it should also call setDeviceName(), setDeviceShortName() and 
setManufacturerName() with localized strings representing each of the attributes.
</p>
<p>If the driver is to work properly after sleep/wake, it must implement performPowerStateChange()
and deal with the sleep and wake transitions.  It may also deal with the idle state transitions
to turn off device power when it isn't in use (especially useful for devices attached to a 
portable running on battery power).
<!-- end discussion -->
</p>
<hr>
<br><h2>Functions</h2>
<a name="HeaderDoc_functions"></a>
<dl>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/activateAudioEngine/IOReturn/(IOAudioEngine*)" target="_top">activateAudioEngine(IOAudioEngine *)</a></tt></dt>
<dd><p>This simply calls activateAudioEngine(IOAudioEngine *audioEngine, 
bool shouldStartAudioEngine) with a value of true for shouldStartAudioEngine.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/activateAudioEngine/IOReturn/(IOAudioEngine*,bool)" target="_top">activateAudioEngine(IOAudioEngine *, bool)</a></tt></dt>
<dd><p>Adds a new IOAudioEngine object to the IOAudioDevice.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/addTimerEvent/IOReturn/(OSObject*,TimerEvent,AbsoluteTime)" target="_top">addTimerEvent</a></tt></dt>
<dd><p>Adds a TimerEvent callback for the given target called at least as often
as specified in interval.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/attachAudioPort/IOReturn/(IOAudioPort*,IORegistryEntry*,IORegistryEntry*)" target="_top">attachAudioPort</a></tt></dt>
<dd><p>Adds the port to the IOAudioDevice's list of ports and attaches the port to its parent
and attaches the child to the port.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/audioEngineStarting/void/()" target="_top">audioEngineStarting</a></tt></dt>
<dd><p>Called by IOAudioEngine when it is starting up.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/audioEngineStopped/void/()" target="_top">audioEngineStopped</a></tt></dt>
<dd><p>Called by IOAudioEngine when it has stopped.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/completePowerStateChange/IOReturn/()" target="_top">completePowerStateChange</a></tt></dt>
<dd><p>Called when a power state change is complete.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/clm/IOAudioDevice/completePowerStateChangeAction/IOReturn/(OSObject*,void*,void*,void*,void*)" target="_top">completePowerStateChangeAction</a></tt></dt>
<dd><p>IOCommandGate Action which calls protectedCompletePowerStateChange() while holding the
IOCommandGate.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/deactivateAllAudioEngines/void/()" target="_top">deactivateAllAudioEngines</a></tt></dt>
<dd><p>Deactivates all of the audio engines in the device.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/detachAllAudioPorts/void/()" target="_top">detachAllAudioPorts</a></tt></dt>
<dd><p>Deactivates all of the ports in the device.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/dispatchTimerEvents/void/(bool)" target="_top">dispatchTimerEvents</a></tt></dt>
<dd><p>Called by timerFired() to cause the timer event callbacks to be called.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/flushAudioControls/void/()" target="_top">flushAudioControls</a></tt></dt>
<dd><p>Forces each IOAudioControl in the driver to have its value flushed out to the hardware.
That will cause either the IOAudioControl's ValueChangeHandler to be called.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/free/void/()" target="_top">free</a></tt></dt>
<dd><p>Frees resources used by the IOAudioDevice instance
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/getCommandGate/IOCommandGate*/()" target="_top">getCommandGate</a></tt></dt>
<dd><p>Returns the IOCommandGate for this IOAudioDevice.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/getPendingPowerState/IOAudioDevicePowerState/()" target="_top">getPendingPowerState</a></tt></dt>
<dd><p>Returns the pending power state if a state change is in progress.  Otherwise it 
returns the current power state change.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/getPowerState/IOAudioDevicePowerState/()" target="_top">getPowerState</a></tt></dt>
<dd><p>Returns the current power state (the old power state if a change is in progress).
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/getWorkLoop/IOWorkLoop*/()" target="_top">getWorkLoop</a></tt></dt>
<dd><p>Returns the work loop for the driver.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/init/bool/(OSDictionary*)" target="_top">init</a></tt></dt>
<dd><p>Initializes a newly created instance of IOAudioDevice.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/initHardware/bool/(IOService*)" target="_top">initHardware</a></tt></dt>
<dd><p>This function is called by start() to provide a convenient place for the subclass to 
perform its initialization.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/initiatePowerStateChange/IOReturn/(UInt32*)" target="_top">initiatePowerStateChange</a></tt></dt>
<dd><p>Called internally to execute a power state change.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/performPowerStateChange/IOReturn/(IOAudioDevicePowerState,IOAudioDevicePowerState,UInt32*)" target="_top">performPowerStateChange</a></tt></dt>
<dd><p>This function is called by the IOAudioDevice when a power state change is needed.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/protectedCompletePowerStateChange/IOReturn/()" target="_top">protectedCompletePowerStateChange</a></tt></dt>
<dd><p>Called on the IOWorkLoop when a power state change is complete.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/doc/title:instm/IOAudioDevice/protectedCompletePowerStateChange()/IOReturn/()" target="_top">protectedCompletePowerStateChange()</a></tt></dt>
<dd><p>Called on the IOWorkLoop when a power state change is complete.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/protectedSetPowerState/IOReturn/(unsignedlong,IOService*)" target="_top">protectedSetPowerState</a></tt></dt>
<dd><p>Called by setPowerStateAction() to deal with a power state change from the IOService
power management facility.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/removeAllTimerEvents/void/()" target="_top">removeAllTimerEvents</a></tt></dt>
<dd><p>Removes all timer events and stops the timer.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/removeTimerEvent/void/(OSObject*)" target="_top">removeTimerEvent</a></tt></dt>
<dd><p>Removes the timer event for the given target.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/setConfigurationApplicationBundle/void/(constchar*)" target="_top">setConfigurationApplicationBundle</a></tt></dt>
<dd><p>This function is to be called if an external configuration application is available to set
which application to launch.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/setDeviceCanBeDefault/void/(UInt32)" target="_top">setDeviceCanBeDefault</a></tt></dt>
<dd><p>This function is to be called to tell CoreAudio if this device shouldn't be a default device.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/setDeviceName/void/(constchar*)" target="_top">setDeviceName</a></tt></dt>
<dd><p>Sets the name of the device.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/setDeviceShortName/void/(constchar*)" target="_top">setDeviceShortName</a></tt></dt>
<dd><p>Sets the short name of the device.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/setFamilyManagePower/void/(bool)" target="_top">setFamilyManagePower</a></tt></dt>
<dd><p>Sets whether or not the family should manage the device power through the
IOService power management APIs.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/setIdleAudioSleepTime/void/(unsignedlonglong)" target="_top">setIdleAudioSleepTime</a></tt></dt>
<dd><p>This function is to be called by a driver that doesn't want to be told about the audio
going idle immediately, but at some point in the future.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/setManufacturerName/void/(constchar*)" target="_top">setManufacturerName</a></tt></dt>
<dd><p>Sets the manufacturer name of the device.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/setPowerState/IOReturn/(unsignedlong,IOService*)" target="_top">setPowerState</a></tt></dt>
<dd><p>Called by the power management system in IOService when the power state of this 
service needs to change.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/clm/IOAudioDevice/setPowerStateAction/IOReturn/(OSObject*,void*,void*,void*,void*)" target="_top">setPowerStateAction</a></tt></dt>
<dd><p>IOCommandGate Action which calls protectedSetPowerState() while holding the IOCommandGate
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/start/bool/(IOService*)" target="_top">start</a></tt></dt>
<dd><p>This function is called automatically by the system to tell the driver to start vending
services to the rest of the system.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/stop/void/(IOService*)" target="_top">stop</a></tt></dt>
<dd><p>Stops the device after the system is done with it (or if the device is removed from the system).
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/clm/IOAudioDevice/timerFired/void/(OSObject*,IOTimerEventSource*)" target="_top">timerFired</a></tt></dt>
<dd><p>Internal static function called when the timer fires.
</p></dd>
<dt><tt><a href="index.html#//apple_ref/cpp/instm/IOAudioDevice/waitForPendingPowerStateChange/void/()" target="_top">waitForPendingPowerStateChange</a></tt></dt>
<dd><p>Called internally to wait until a pending power state change is complete.
</p></dd>
</dl>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/activateAudioEngine/IOReturn/(IOAudioEngine*);  indexgroup=Audio ;   name=IOAudioDevice::activateAudioEngine --><a name="//apple_ref/cpp/instm/IOAudioDevice/activateAudioEngine/IOReturn/(IOAudioEngine*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="activateAudioEngine(IOAudioEngine*)">activateAudioEngine(IOAudioEngine *)</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>This simply calls activateAudioEngine(IOAudioEngine *audioEngine, 
bool shouldStartAudioEngine) with a value of true for shouldStartAudioEngine.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">activateAudioEngine</span><!-- /a -->(
    <a href="../../../IOAudioEngine_h/Classes/IOAudioEngine/index.html#//apple_ref/cpp/cl/IOAudioEngine" target="_top" class="type"><span class="type">IOAudioEngine</span></a> <span class="type">*</span><span class="param">audioEngine</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>audioEngine</code></dt>
<dd><p>The IOAudioEngine instance to be activated.  It is treated as a newly 
allocated instance.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Returns true if the audio engine was successfully activated.

<!-- end return value --></p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/activateAudioEngine/IOReturn/(IOAudioEngine*,bool);  indexgroup=Audio ;   name=IOAudioDevice::activateAudioEngine --><a name="//apple_ref/cpp/instm/IOAudioDevice/activateAudioEngine/IOReturn/(IOAudioEngine*,bool)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="activateAudioEngine(IOAudioEngine*,bool)">activateAudioEngine(IOAudioEngine *, bool)</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Adds a new IOAudioEngine object to the IOAudioDevice.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">activateAudioEngine</span><!-- /a -->(
    <a href="../../../IOAudioEngine_h/Classes/IOAudioEngine/index.html#//apple_ref/cpp/cl/IOAudioEngine" target="_top" class="type"><span class="type">IOAudioEngine</span></a> <span class="type">*</span><span class="param">audioEngine</span>,
    <!-- a --><span class="type">bool</span><!-- /a --> <span class="param">shouldStartAudioEngine</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>audioEngine</code></dt>
<dd><p>The IOAudioEngine instance to be activated.</p></dd>
<dt><code>shouldStartAudioEngine</code></dt>
<dd><p>If true, the audio engine is treated as a newly allocated IOAudioEngine
instance and is appropriately attached and started according to IOKit convention.  If it is false
it is assumed that some other process (possibly the IOKit matching process) has started the
IOAudioEngine and will skip that step.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Returns true if the audio engine was successfully activated.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Once the IOAudioEngine has been activated by this function, it is ready
to begin moving audio data.  This should be called either during the subclass' initHardware()
implementation for each IOAudioEngine the device creates.  Or it should be called by
the IOAudioEngine itself if the audio engine was automatically created by IOKit's matching
process.  The system won't be able to properly track and control IOAudioEngines if
they are not activated though this function.
This implementation will retain the IOAudioEngine while it maintains control of it.  
When the audio engine is deactivated, the IOAudioEngine will be released.  If the 
IOAudioDevice subclass is passing a newly instantiated IOAudioEngine, it will need to release 
the audio engine after it has been activated.  This will insure that the refCount on the audio engine 
is correct when it gets deactivated when the driver is stopped.  That allows the audio engine to be
freed when it is no longer needed.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/addTimerEvent/IOReturn/(OSObject*,TimerEvent,AbsoluteTime);  indexgroup=Audio ;   name=IOAudioDevice::addTimerEvent --><a name="//apple_ref/cpp/instm/IOAudioDevice/addTimerEvent/IOReturn/(OSObject*,TimerEvent,AbsoluteTime)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="addTimerEvent">addTimerEvent</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Adds a TimerEvent callback for the given target called at least as often
as specified in interval.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">addTimerEvent</span><!-- /a -->(
    <a href="../../../OSObject_h/Classes/OSObject/index.html#//apple_ref/cpp/cl/OSObject" target="_top" class="type"><span class="type">OSObject</span></a> <span class="type">*</span><span class="param">target</span>,
    <!-- a --><span class="type">TimerEvent</span><!-- /a --> <span class="param">event</span>,
    <!-- a --><span class="type">AbsoluteTime</span><!-- /a --> <span class="param">interval</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>target</code></dt>
<dd><p>This parameter is the target object of the TimerEvent.</p></dd>
<dt><code>event</code></dt>
<dd><p>The callback function called each time the timer fires.</p></dd>
<dt><code>interval</code></dt>
<dd><p>The callback will be called at least this often.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Returns kIOReturnSuccess if the timer event was successfully added.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The frequency of the timer event callbacks will be the smallest interval
specified by all targets.  Only one interval and callback may be specified per target.
If a addTimerEvent is called twice with the same target, the second one overrides the
first.  There is currently a bug triggered if the first call had the smallest interval.
In that case, that smallest interval would still be used.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/attachAudioPort/IOReturn/(IOAudioPort*,IORegistryEntry*,IORegistryEntry*);  indexgroup=Audio ;   name=IOAudioDevice::attachAudioPort --><a name="//apple_ref/cpp/instm/IOAudioDevice/attachAudioPort/IOReturn/(IOAudioPort*,IORegistryEntry*,IORegistryEntry*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="attachAudioPort">attachAudioPort</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Adds the port to the IOAudioDevice's list of ports and attaches the port to its parent
and attaches the child to the port.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">attachAudioPort</span><!-- /a -->(
    <a href="../../../IOAudioPort_h/Classes/IOAudioPort/index.html#//apple_ref/cpp/cl/IOAudioPort" target="_top" class="type"><span class="type">IOAudioPort</span></a> <span class="type">*</span><span class="param">port</span>,
    <a href="../../../IORegistryEntry_h/Classes/IORegistryEntry/index.html#//apple_ref/cpp/cl/IORegistryEntry" target="_top" class="type"><span class="type">IORegistryEntry</span></a> <span class="type">*</span><span class="param">parent</span>,
    <a href="../../../IORegistryEntry_h/Classes/IORegistryEntry/index.html#//apple_ref/cpp/cl/IORegistryEntry" target="_top" class="type"><span class="type">IORegistryEntry</span></a> <span class="type">*</span><span class="param">child</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>port</code></dt>
<dd><p>The newly created IOAudioPort instance to be activated.</p></dd>
<dt><code>parent</code></dt>
<dd><p>A parent IOAudioPort or IOAudioEngine of the given port.</p></dd>
<dt><code>child</code></dt>
<dd><p>A child IOAudioPort or IOAudioEngine of the given port.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Returns true when the port has been successfully added and attached.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This function provides the functionality to represent the device's signal chain in the
IOAudioPlane in the IORegistry.  An IOAudioPort's parent(s) are before it in the signal chain
and its children are after it.  This method may be called multiple times for a single IOAudioPort.
This is necessary when there are many children or parents.  Once a relationship is made, it is not
necessary to make the reverse relationship.  A NULL value may be passed in for either the parent
or child or both.
The IOAudioPort passed in should be a newly allocated IOAudioPort instance.  This function will
appropriately attach and start the port object.  NOTE: It is not necessary to use IOAudioPorts
in a fully functional audio driver.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/audioEngineStarting/void/();  indexgroup=Audio ;   name=IOAudioDevice::audioEngineStarting --><a name="//apple_ref/cpp/instm/IOAudioDevice/audioEngineStarting/void/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="audioEngineStarting">audioEngineStarting</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Called by IOAudioEngine when it is starting up.
<!-- end abstract --></p>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">audioEngineStarting</span><!-- /a -->(); </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This should only be called while on the IOWorkLoop.  It is not intended to be called
directly.  It is called when an IOAudioEngine is starting up to allow the IOAudioDevice
to keep track of running audio engines and change the power state from kIOAudioDeviceIdle to
kIOAudioDeviceActive when the first audio engine starts up.  If the state change is done
asynchronously, it waits for the state change to complete.  This is to ensure that the
system doesn't start playing audio until the IOAudioDevice has completed its transition
to kIOAudioDeviceActive.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/audioEngineStopped/void/();  indexgroup=Audio ;   name=IOAudioDevice::audioEngineStopped --><a name="//apple_ref/cpp/instm/IOAudioDevice/audioEngineStopped/void/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="audioEngineStopped">audioEngineStopped</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Called by IOAudioEngine when it has stopped.
<!-- end abstract --></p>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">audioEngineStopped</span><!-- /a -->(); </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This should only be called while on the IOWorkLoop.  It is not intended to be called
directly.  It is called when an IOAudioEngine has stopped to allow the IOAudioDevice
to keep track of running audio engines and change the power state from kIOAudioDeviceActive
to kIOAudioDeviceIdle when the last audio engine stops.  If the state change is done 
asynchronously, it waits for the state change to complete.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/completePowerStateChange/IOReturn/();  indexgroup=Audio ;   name=IOAudioDevice::completePowerStateChange --><a name="//apple_ref/cpp/instm/IOAudioDevice/completePowerStateChange/IOReturn/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="completePowerStateChange">completePowerStateChange</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Called when a power state change is complete.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">completePowerStateChange</span><!-- /a -->(); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Returns kIOReturnSuccess on a successful completion

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>In the case of an asynchronous power state change, a subclass is responsible
for calling this function.  It is safe to call this function if not on the IOWorkLoop.
This function calls protectedCompletePowerStateChange() through the IOCommandGate and
completePowerStateChangeAction().  If the call is already on the IOWorkLoop, it is safe
to call protectedCompletePowerStateChange() directly.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=clm;  uid=//apple_ref/cpp/clm/IOAudioDevice/completePowerStateChangeAction/IOReturn/(OSObject*,void*,void*,void*,void*);  indexgroup=Audio ;   name=IOAudioDevice::completePowerStateChangeAction --><a name="//apple_ref/cpp/clm/IOAudioDevice/completePowerStateChangeAction/IOReturn/(OSObject*,void*,void*,void*,void*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="completePowerStateChangeAction">completePowerStateChangeAction</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>IOCommandGate Action which calls protectedCompletePowerStateChange() while holding the
IOCommandGate.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">static</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">completePowerStateChangeAction</span><!-- /a -->(
    <a href="../../../OSObject_h/Classes/OSObject/index.html#//apple_ref/cpp/cl/OSObject" target="_top" class="type"><span class="type">OSObject</span></a> <span class="type">*</span><span class="param">owner</span>,
    <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">arg1</span>,
    <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">arg2</span>,
    <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">arg3</span>,
    <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">arg4</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>owner</code></dt>
<dd><p>The owner of the IOCommandGate (the IOAudioDevice in this case)</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Returns the result of protectedCompletePowerStateChange()

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This is needed to allow protectedCompletePowerStateChange() to be called on the IOWorkLoop.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/deactivateAllAudioEngines/void/();  indexgroup=Audio ;   name=IOAudioDevice::deactivateAllAudioEngines --><a name="//apple_ref/cpp/instm/IOAudioDevice/deactivateAllAudioEngines/void/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="deactivateAllAudioEngines">deactivateAllAudioEngines</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Deactivates all of the audio engines in the device.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">deactivateAllAudioEngines</span><!-- /a -->(); </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This is called by the stop() and free() methods in IOAudioDevice to completely
shut down all audio engines as the driver is being shut down.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/detachAllAudioPorts/void/();  indexgroup=Audio ;   name=IOAudioDevice::detachAllAudioPorts --><a name="//apple_ref/cpp/instm/IOAudioDevice/detachAllAudioPorts/void/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="detachAllAudioPorts">detachAllAudioPorts</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Deactivates all of the ports in the device.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">detachAllAudioPorts</span><!-- /a -->(); </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This is called by the stop() and free() methods in IOAudioDevice to completely
shut down all ports as the driver is being shut down.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/dispatchTimerEvents/void/(bool);  indexgroup=Audio ;   name=IOAudioDevice::dispatchTimerEvents --><a name="//apple_ref/cpp/instm/IOAudioDevice/dispatchTimerEvents/void/(bool)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="dispatchTimerEvents">dispatchTimerEvents</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Called by timerFired() to cause the timer event callbacks to be called.
<!-- end abstract --></p>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">dispatchTimerEvents</span><!-- /a -->(
    <!-- a --><span class="type">bool</span><!-- /a --> <span class="param">force</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>force</code></dt>
<dd><p>A bool param to allow the timer events to be dispatched even if the 
device is in the kIOAudioDeviceSleep power state.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This method iterates through all of the timer event targets and calls
the callback on each.  Unless the force flag is set to true, the timer events will
only be dispatched if the power state is not kIOAudioDeviceSleep.  This prevents
unexpected timer firings while making wake-&gt;sleep-&gt;wake transitions.  This function must
be called on the IOWorkLoop.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/flushAudioControls/void/();  indexgroup=Audio ;   name=IOAudioDevice::flushAudioControls --><a name="//apple_ref/cpp/instm/IOAudioDevice/flushAudioControls/void/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="flushAudioControls">flushAudioControls</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Forces each IOAudioControl in the driver to have its value flushed out to the hardware.
That will cause either the IOAudioControl's ValueChangeHandler to be called.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">flushAudioControls</span><!-- /a -->(); </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This can be used to force the hardware to get updated with the current value 
of each control.  It may be useful during wake, for example.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/free/void/();  indexgroup=Audio ;   name=IOAudioDevice::free --><a name="//apple_ref/cpp/instm/IOAudioDevice/free/void/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="free">free</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Frees resources used by the IOAudioDevice instance
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">free</span><!-- /a -->(); </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This method will deactivate all audio audio engines and release the audioEngines OSSet.
It will also deactivate all of the audio ports and release the audioPorts OSSet.  It will release
the timerEvents OSDictionary as well as cancel any outstanding timer callbacks.  It will clean up
all of the event sources and the workLoop.
</p>
<p>Do not call this directly.  This is called automatically by the system when the instance's
refcount goes to 0.  To decrement the refcount, call release() on the object.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/getCommandGate/IOCommandGate*/();  indexgroup=Audio ;   name=IOAudioDevice::getCommandGate --><a name="//apple_ref/cpp/instm/IOAudioDevice/getCommandGate/IOCommandGate*/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="getCommandGate">getCommandGate</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Returns the IOCommandGate for this IOAudioDevice.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOCommandGate_h/Classes/IOCommandGate/index.html#//apple_ref/cpp/cl/IOCommandGate" target="_top" class="type"><span class="type">IOCommandGate</span></a> <span class="type">*</span><!-- a --><span class="function">getCommandGate</span><!-- /a -->() <span class="keyword">const</span>; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This IOCommandGate allows calls into this IOAudioDevice to be synchronized on 
the IOWorkLoop.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/getPendingPowerState/IOAudioDevicePowerState/();  indexgroup=Audio ;   name=IOAudioDevice::getPendingPowerState --><a name="//apple_ref/cpp/instm/IOAudioDevice/getPendingPowerState/IOAudioDevicePowerState/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="getPendingPowerState">getPendingPowerState</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Returns the pending power state if a state change is in progress.  Otherwise it 
returns the current power state change.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">IOAudioDevicePowerState</span><!-- /a --> <!-- a --><span class="function">getPendingPowerState</span><!-- /a -->(); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->The pending power state.

<!-- end return value --></p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/getPowerState/IOAudioDevicePowerState/();  indexgroup=Audio ;   name=IOAudioDevice::getPowerState --><a name="//apple_ref/cpp/instm/IOAudioDevice/getPowerState/IOAudioDevicePowerState/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="getPowerState">getPowerState</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Returns the current power state (the old power state if a change is in progress).
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">IOAudioDevicePowerState</span><!-- /a --> <!-- a --><span class="function">getPowerState</span><!-- /a -->(); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->The current power state.

<!-- end return value --></p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/getWorkLoop/IOWorkLoop*/();  indexgroup=Audio ;   name=IOAudioDevice::getWorkLoop --><a name="//apple_ref/cpp/instm/IOAudioDevice/getWorkLoop/IOWorkLoop*/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="getWorkLoop">getWorkLoop</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Returns the work loop for the driver.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOWorkLoop_h/Classes/IOWorkLoop/index.html#//apple_ref/cpp/cl/IOWorkLoop" target="_top" class="type"><span class="type">IOWorkLoop</span></a> <span class="type">*</span><!-- a --><span class="function">getWorkLoop</span><!-- /a -->() <span class="keyword">const</span>; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The IOWorkLoop is used to synchronized all critical aspects of the driver.  This
includes all entry points to the driver as well as power management.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/init/bool/(OSDictionary*);  indexgroup=Audio ;   name=IOAudioDevice::init --><a name="//apple_ref/cpp/instm/IOAudioDevice/init/bool/(OSDictionary*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="init">init</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Initializes a newly created instance of IOAudioDevice.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">bool</span><!-- /a --> <a href="../../../IOFWPhysicalAddressSpace_h/index.html#//apple_ref/c/func/init" target="_top" class="function"><span class="function">init</span></a>(
    <a href="../../../OSDictionary_h/Classes/OSDictionary/index.html#//apple_ref/cpp/cl/OSDictionary" target="_top" class="type"><span class="type">OSDictionary</span></a> <span class="type">*</span><span class="param">properties</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>properties</code></dt>
<dd><p>An OSDictionary of the device properties that gets passed to super::init and set
in the IORegistry.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->true if initialization was successful

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This implementation initializes all of the data structures and variables used by the
IOAudioDevice.  The currentPowerState and pendingPowerState variables are set to kIOAudioDeviceIdle.
A subclass that overrides this method must call the superclass' implementation.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/initHardware/bool/(IOService*);  indexgroup=Audio ;   name=IOAudioDevice::initHardware --><a name="//apple_ref/cpp/instm/IOAudioDevice/initHardware/bool/(IOService*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="initHardware">initHardware</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>This function is called by start() to provide a convenient place for the subclass to 
perform its initialization.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="function">initHardware</span><!-- /a -->(
    <a href="../../../IOService_h/Classes/IOService/index.html#//apple_ref/cpp/cl/IOService" target="_top" class="type"><span class="type">IOService</span></a> <span class="type">*</span><span class="param">provider</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>provider</code></dt>
<dd><p>The service provider nub for the device.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->This function should return true on a successful initialization.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>In a typical implementation, a driver would implementation this function and perform
a number of tasks.  Those include mapping hardware resources, initializing the hardware to a known
state, creating the IOAudioEngines, IOAudioControls and IOAudioStreams.  Additionally it 
should also call setDeviceName(), setDeviceShortName(), setManufacturerName().  Upon return of
this function, the device should be ready to begin vending services to the system.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/initiatePowerStateChange/IOReturn/(UInt32*);  indexgroup=Audio ;   name=IOAudioDevice::initiatePowerStateChange --><a name="//apple_ref/cpp/instm/IOAudioDevice/initiatePowerStateChange/IOReturn/(UInt32*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="initiatePowerStateChange">initiatePowerStateChange</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Called internally to execute a power state change.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">initiatePowerStateChange</span><!-- /a -->(
    <!-- a --><span class="type">UInt32</span><!-- /a --> <span class="type">*</span><!-- a --><span class="type">microsecondsUntilComplete</span><!-- /a --> = <span class="keyword">NULL</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>microsecondsUntilComplete</code></dt>
<dd><p>Pointer to the microsecondsUntilComplete that should be set
by performPowerStateChange if an asynchronous power state change was started.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Returns kIOReturnSuccess on success.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This function must be called on the IOWorkLoop.  It calls performPowerStateChange()
to let the driver process the state change.  If the state change is completed synchronously
by the driver (subclass) it calls protectedCompletePowerStateChange().  If done asynchronously
it returns the microsecondsUntilComplete that was set by performPowerStateChange().  This
function should not be called directly.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/performPowerStateChange/IOReturn/(IOAudioDevicePowerState,IOAudioDevicePowerState,UInt32*);  indexgroup=Audio ;   name=IOAudioDevice::performPowerStateChange --><a name="//apple_ref/cpp/instm/IOAudioDevice/performPowerStateChange/IOReturn/(IOAudioDevicePowerState,IOAudioDevicePowerState,UInt32*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="performPowerStateChange">performPowerStateChange</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>This function is called by the IOAudioDevice when a power state change is needed.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">performPowerStateChange</span><!-- /a -->(
    <!-- a --><span class="type">IOAudioDevicePowerState</span><!-- /a --> <span class="param">oldPowerState</span>, 
    <!-- a --><span class="type">IOAudioDevicePowerState</span><!-- /a --> <span class="param">newPowerState</span>, 
    <!-- a --><span class="type">UInt32</span><!-- /a --> <span class="type">*</span><span class="param">microsecondsUntilComplete</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>oldPowerState</code></dt>
<dd><p>The power state before the power state change</p></dd>
<dt><code>newPowerState</code></dt>
<dd><p>The power state being transitioned to</p></dd>
<dt><code>microsecondsUntilComplete</code></dt>
<dd><p>A pointer to a value representing an upper bound on
the number of microseconds to complete an asynchronous power state change.  It points
to a value of zero at the start and if it remains zero, the state change is complete
upon a successful return from the function.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Returns kIOReturnSuccess on a successful completion

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>In order to deal with power state changes, a subclass must override this function.
Any combination of old and new power states may be passed to this function.  If work is to
be performed while transitioning to sleep, check for a newPowerState of kIOAudioDeviceSleep.
If work is to be performed while transitioning from sleep, check for an oldPowerState of
kIOAudioDeviceSleep.  A power state of kIOAudioDeviceIdle means the system is awake, but
no clients are currently playing or recording audio (i.e. no IOAudioEngines are active).
A power state of kIOAudioDeviceActive means that at least one IOAudioEngine is active.
It is possible for a power state change to be performed synchronously or asynchronously.
In the case of a synchronous power state change, simple leave microsecondsUntilComplete
alone and return kIOReturnSuccess.  If an asynchronous power state change is needed the 
driver should do whatever needed to schedule another thread to finish the state change
and set the microsecondsUntilComplete to an upper bound on the amount of time it will
take to complete the power state change.  Then when the power state change is complete,
a call must be made to completePowerStateChange().  During an asynchronous power state
change, the current power state will remain the same as before the transition began, 
and the pendingPowerState is set to the new power state that will be set when the 
change is complete.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/protectedCompletePowerStateChange/IOReturn/();  indexgroup=Audio ;   name=IOAudioDevice::protectedCompletePowerStateChange --><a name="//apple_ref/cpp/instm/IOAudioDevice/protectedCompletePowerStateChange/IOReturn/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="protectedCompletePowerStateChange">protectedCompletePowerStateChange</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Called on the IOWorkLoop when a power state change is complete.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">protectedCompletePowerStateChange</span><!-- /a -->(); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Returns kIOReturnSuccess on success

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This function does the work to complete a power state change (both synchronous and
asynchronous).  If the system is waking from sleep, the timer system is restarted and the 
audio engines are resumed.  If this was called as a result of an asynchronous power state changed
it makes the IOService power management call acknowledgePowerChange() and resets the
asyncPowerStateChangeInProgress variable.  Finally it sets the currentPowerState to the
pendingPowerState.  This function must be called on the IOWorkLoop.  If a subclass is not
on the IOWorkLoop (e.g. holding the IOCommandGate), call completePowerStateChange() instead.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=title:instm;  uid=//apple_ref/doc/title:instm/IOAudioDevice/protectedCompletePowerStateChange()/IOReturn/();  indexgroup=Audio ;   name=IOAudioDevice::protectedCompletePowerStateChange() --><a name="//apple_ref/doc/title:instm/IOAudioDevice/protectedCompletePowerStateChange()/IOReturn/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="protectedCompletePowerStateChange()">protectedCompletePowerStateChange()</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Called on the IOWorkLoop when a power state change is complete.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">protectedCompletePowerStateChange</span><!-- /a -->(); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Returns kIOReturnSuccess on success

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This function does the work to complete a power state change (both synchronous and
asynchronous).  If the system is waking from sleep, the timer system is restarted and the 
audio engines are resumed.  If this was called as a result of an asynchronous power state changed
it makes the IOService power management call acknowledgePowerChange() and resets the
asyncPowerStateChangeInProgress variable.  Finally it sets the currentPowerState to the
pendingPowerState.  This function must be called on the IOWorkLoop.  If a subclass is not
on the IOWorkLoop (e.g. holding the IOCommandGate), call completePowerStateChange() instead.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/protectedSetPowerState/IOReturn/(unsignedlong,IOService*);  indexgroup=Audio ;   name=IOAudioDevice::protectedSetPowerState --><a name="//apple_ref/cpp/instm/IOAudioDevice/protectedSetPowerState/IOReturn/(unsignedlong,IOService*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="protectedSetPowerState">protectedSetPowerState</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Called by setPowerStateAction() to deal with a power state change from the IOService
power management facility.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">protectedSetPowerState</span><!-- /a -->(
    <span class="keyword">unsigned</span> <!-- a --><span class="type">long</span><!-- /a --> <span class="param">powerStateOrdinal</span>,
    <a href="../../../IOService_h/Classes/IOService/index.html#//apple_ref/cpp/cl/IOService" target="_top" class="type"><span class="type">IOService</span></a> <span class="type">*</span><span class="param">device</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>powerStateOrdinal</code></dt>
<dd><p>Param passed to setPowerState() - 0 for sleep, 1 for wake</p></dd>
<dt><code>device</code></dt>
<dd><p>Param passed to setPowerState - the device initiating the power state change</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Returns 0 if the power state change is complete - the number of microseconds until 
complete if its asynchronous.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This function is responsible for performing the necessary sleep and wake tasks
when the system is sleeping or waking.  If an outstanding power state change is in progress,
it will wait until the state changes has completed.  While sleeping, all audio engines are
stopped before calling initiatePowerStateChange() to call performPowerStateChange() to let
the driver deal with the sleep request.  When waking, it determines if the device should be
idle or active and continues to call initiatePowerStateChange().  If initiatePowerStateChange()
indicates that the power state change is occuring asynchronously, it returns the number of
microseconds.  This function must be called on the IOWorkLoop, but should not be called
directly.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/removeAllTimerEvents/void/();  indexgroup=Audio ;   name=IOAudioDevice::removeAllTimerEvents --><a name="//apple_ref/cpp/instm/IOAudioDevice/removeAllTimerEvents/void/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="removeAllTimerEvents">removeAllTimerEvents</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Removes all timer events and stops the timer.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">removeAllTimerEvents</span><!-- /a -->(); </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>Called during teardown of the driver.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/removeTimerEvent/void/(OSObject*);  indexgroup=Audio ;   name=IOAudioDevice::removeTimerEvent --><a name="//apple_ref/cpp/instm/IOAudioDevice/removeTimerEvent/void/(OSObject*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="removeTimerEvent">removeTimerEvent</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Removes the timer event for the given target.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">removeTimerEvent</span><!-- /a -->(
    <a href="../../../OSObject_h/Classes/OSObject/index.html#//apple_ref/cpp/cl/OSObject" target="_top" class="type"><span class="type">OSObject</span></a> <span class="type">*</span><span class="param">target</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>target</code></dt>
<dd><p>The target whose timer event will be removed.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>If the interval for the target to be removed is the smallest interval,
the timer interval is recalculated based on the remaining targets.  The next fire
time is readjusted based on the new interval compared to the last fire time.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/setConfigurationApplicationBundle/void/(constchar*);  indexgroup=Audio ;   name=IOAudioDevice::setConfigurationApplicationBundle --><a name="//apple_ref/cpp/instm/IOAudioDevice/setConfigurationApplicationBundle/void/(constchar*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="setConfigurationApplicationBundle">setConfigurationApplicationBundle</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>This function is to be called if an external configuration application is available to set
which application to launch.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">setConfigurationApplicationBundle</span><!-- /a -->(
    <span class="keyword">const</span> <!-- a --><span class="var">char</span><!-- /a --> <span class="var">*</span><!-- a --><span class="var">bundleID</span><!-- /a -->); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>bundleID</code></dt>
<dd><p>The bundle ID of the application to be launched by the HAL for configuration of the device and its engine(s).</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This is useful for device drivers that are too complex to be represented by the Sound Preferences
panel.  The bundle ID is a more flexible way of specifying where the application is than a hard coded path.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/setDeviceCanBeDefault/void/(UInt32);  indexgroup=Audio ;   name=IOAudioDevice::setDeviceCanBeDefault --><a name="//apple_ref/cpp/instm/IOAudioDevice/setDeviceCanBeDefault/void/(UInt32)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="setDeviceCanBeDefault">setDeviceCanBeDefault</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>This function is to be called to tell CoreAudio if this device shouldn't be a default device.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">setDeviceCanBeDefault</span><!-- /a -->(
    <!-- a --><span class="type">UInt32</span><!-- /a --> <span class="param">defaultsFlags</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>defaultsFlags</code></dt>
<dd><p>The flags to instruct CoreAudio to allow this device to be only the indicated default devices.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This is useful for device drivers that don't want to be a default device.  Can be called with
kIOAudioDeviceCanBeDefaultNothing to prevent CoreAudio from allowing this device to be any default device, or it
can be called with any combination of kIOAudioDeviceCanBeDefaultInput, kIOAudioDeviceCanBeDefaultOutput, or
kIOAudioDeviceCanBeSystemOutput.  The default is 
(kIOAudioDeviceCanBeDefaultInput | kIOAudioDeviceCanBeDefaultOutput | kIOAudioDeviceCanBeSystemOutput).
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/setDeviceName/void/(constchar*);  indexgroup=Audio ;   name=IOAudioDevice::setDeviceName --><a name="//apple_ref/cpp/instm/IOAudioDevice/setDeviceName/void/(constchar*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="setDeviceName">setDeviceName</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Sets the name of the device.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">setDeviceName</span><!-- /a -->(
    <span class="keyword">const</span> <!-- a --><span class="var">char</span><!-- /a --> <span class="var">*</span><!-- a --><span class="var">deviceName</span><!-- /a -->); </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This method should be called during initialization or startup.  It should
be set by the time initHardware() completes.  The device name is used by the 
CoreAudio.framework to identify the particular piece of hardware.  This string should
should be localized by the driver.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/setDeviceShortName/void/(constchar*);  indexgroup=Audio ;   name=IOAudioDevice::setDeviceShortName --><a name="//apple_ref/cpp/instm/IOAudioDevice/setDeviceShortName/void/(constchar*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="setDeviceShortName">setDeviceShortName</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Sets the short name of the device.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">setDeviceShortName</span><!-- /a -->(
    <span class="keyword">const</span> <!-- a --><span class="var">char</span><!-- /a --> <span class="var">*</span><!-- a --><span class="var">shortName</span><!-- /a -->); </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The short name is a shorter representation of the device name.  It may be used
by applications when the device name is too long.  It should be set by the time initHardware()
completes.  The string should be localized by the driver.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/setFamilyManagePower/void/(bool);  indexgroup=Audio ;   name=IOAudioDevice::setFamilyManagePower --><a name="//apple_ref/cpp/instm/IOAudioDevice/setFamilyManagePower/void/(bool)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="setFamilyManagePower">setFamilyManagePower</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Sets whether or not the family should manage the device power through the
IOService power management APIs.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">setFamilyManagePower</span><!-- /a -->(
    <!-- a --><span class="type">bool</span><!-- /a --> <span class="param">manage</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>manage</code></dt>
<dd><p>Set to false if it is not desired that the family does the power management</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The default behavior is for the family to manage power.  It is only necessary to 
call this function if the driver does not want the family to manage power.  It is not
recommended that this function be called because it makes power management much more
difficult for the driver.  If this function is to be called, it must be called before
initHardware() completes.  Immediately after initHardware() is called by start(), 
the power management system is initialized if the family is to manage power.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/setIdleAudioSleepTime/void/(unsignedlonglong);  indexgroup=Audio ;   name=IOAudioDevice::setIdleAudioSleepTime --><a name="//apple_ref/cpp/instm/IOAudioDevice/setIdleAudioSleepTime/void/(unsignedlonglong)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="setIdleAudioSleepTime">setIdleAudioSleepTime</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>This function is to be called by a driver that doesn't want to be told about the audio
going idle immediately, but at some point in the future.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">setIdleAudioSleepTime</span><!-- /a -->(
    <span class="keyword">unsigned</span> <!-- a --><span class="type">long</span><!-- /a --> <!-- a --><span class="type">long</span><!-- /a --> <span class="param">sleepDelay</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>sleepDelay</code></dt>
<dd><p>The amount of time, in nanoseconds, before the hardware should be told to go idle.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This is useful if the device will want to power down its hardware into an idle sleep
state, but doesn't want to do that unless audio hasn't been used for a while.  Calling this function
immediately changes the idle sleep timer and queues it up if the idle is different from the previous
idle time.  The idle time defaults to 0, which means be called immediately (backwards compatible with
previous versions of IOAudioFamily).  A value of 0xffffffffffffffffULL means don't ever tell the
driver about going idle.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/setManufacturerName/void/(constchar*);  indexgroup=Audio ;   name=IOAudioDevice::setManufacturerName --><a name="//apple_ref/cpp/instm/IOAudioDevice/setManufacturerName/void/(constchar*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="setManufacturerName">setManufacturerName</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Sets the manufacturer name of the device.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">setManufacturerName</span><!-- /a -->(
    <span class="keyword">const</span> <!-- a --><span class="var">char</span><!-- /a --> <span class="var">*</span><!-- a --><span class="var">manufacturerName</span><!-- /a -->); </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This method should be called during initialization or startup.  This should be 
called by the time initHardware() completes.  The string should be localized by the driver.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/setPowerState/IOReturn/(unsignedlong,IOService*);  indexgroup=Audio ;   name=IOAudioDevice::setPowerState --><a name="//apple_ref/cpp/instm/IOAudioDevice/setPowerState/IOReturn/(unsignedlong,IOService*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="setPowerState">setPowerState</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Called by the power management system in IOService when the power state of this 
service needs to change.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">setPowerState</span><!-- /a -->(
    <span class="keyword">unsigned</span> <!-- a --><span class="type">long</span><!-- /a --> <span class="param">powerStateOrdinal</span>,
    <a href="../../../IOService_h/Classes/IOService/index.html#//apple_ref/cpp/cl/IOService" target="_top" class="type"><span class="type">IOService</span></a> <span class="type">*</span><span class="param">device</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>powerStateOrdinal</code></dt>
<dd><p>The number of the power state as defined by the IOAudioDevice - 
0 for sleep, 1 for wake.</p></dd>
<dt><code>device</code></dt>
<dd><p>The power management policy maker.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Returns kIOPMAckImplied (0) when the power state change is complete.  Otherwise an
upper bound on the number of microseconds until the state change is complete is returned.

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The default implementation of IOAudioDevice sets up two power states for IOService
to use.  State 0 is sleep and state 1 is wake.  This function should not be called directly.
It is only supposed to be used by the IOService power management services.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=clm;  uid=//apple_ref/cpp/clm/IOAudioDevice/setPowerStateAction/IOReturn/(OSObject*,void*,void*,void*,void*);  indexgroup=Audio ;   name=IOAudioDevice::setPowerStateAction --><a name="//apple_ref/cpp/clm/IOAudioDevice/setPowerStateAction/IOReturn/(OSObject*,void*,void*,void*,void*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="setPowerStateAction">setPowerStateAction</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>IOCommandGate Action which calls protectedSetPowerState() while holding the IOCommandGate
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">static</span> <a href="../../../IOReturn_h/index.html#//apple_ref/c/tdef/IOReturn" target="_top" class="type"><span class="type">IOReturn</span></a> <!-- a --><span class="function">setPowerStateAction</span><!-- /a -->(
    <a href="../../../OSObject_h/Classes/OSObject/index.html#//apple_ref/cpp/cl/OSObject" target="_top" class="type"><span class="type">OSObject</span></a> <span class="type">*</span><span class="param">owner</span>,
    <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">arg1</span>,
    <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">arg2</span>,
    <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">arg3</span>,
    <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <span class="type">*</span><span class="param">arg4</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>owner</code></dt>
<dd><p>The owner of the IOCommandGate (the IOAudioDevice in this case)</p></dd>
<dt><code>arg1</code></dt>
<dd><p>The powerStateOrdinal to be passed to protectedSetPowerState()</p></dd>
<dt><code>arg2</code></dt>
<dd><p>The device to be passed to protectedSetPowerState()</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Returns the result of protectedSetPowerState()

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This is needed to allow protectedSetPowerState() to be called on the IOWorkLoop
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/start/bool/(IOService*);  indexgroup=Audio ;   name=IOAudioDevice::start --><a name="//apple_ref/cpp/instm/IOAudioDevice/start/bool/(IOService*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="start">start</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>This function is called automatically by the system to tell the driver to start vending
services to the rest of the system.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="function">start</span><!-- /a -->(
    <a href="../../../IOService_h/Classes/IOService/index.html#//apple_ref/cpp/cl/IOService" target="_top" class="type"><span class="type">IOService</span></a> <span class="type">*</span><span class="param">provider</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>provider</code></dt>
<dd><p>This is the service provider nub that provides access to the hardware resources.</p></dd>
</dl>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5>
<p><!-- begin return value -->Returns true on success

<!-- end return value --></p>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The start() implementation in IOAudioDevice starts by calling start() on its superclass.
It then calls initHardware() which the subclass should override to properly initialize itself and 
the hardware.  If that call succeeds, it sets up power management if the family is supposed to 
manage power (checking the familyManagePower variable).  Then finally it calls registerService() 
to make the IOAudioDevice visible in the IORegistry.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/stop/void/(IOService*);  indexgroup=Audio ;   name=IOAudioDevice::stop --><a name="//apple_ref/cpp/instm/IOAudioDevice/stop/void/(IOService*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="stop">stop</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Stops the device after the system is done with it (or if the device is removed from the system).
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">stop</span><!-- /a -->(
    <a href="../../../IOService_h/Classes/IOService/index.html#//apple_ref/cpp/cl/IOService" target="_top" class="type"><span class="type">IOService</span></a> <span class="type">*</span><span class="param">provider</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>provider</code></dt>
<dd><p>The service provider nub for the device.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The IOAudioDevice implentation of stop() disables the timer services, deactivates 
all of the audio audio engines and audio ports and stops power management of the device.
The audio engine and port deactivation causes all of the audio engines to get stopped and 
all of the audio engine and port resources and objects to be released.  A subclass' implementation 
may could shut down hardware here if necessary.  If this function is overridden by a subclass,
the superclass' implementation must be called.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=clm;  uid=//apple_ref/cpp/clm/IOAudioDevice/timerFired/void/(OSObject*,IOTimerEventSource*);  indexgroup=Audio ;   name=IOAudioDevice::timerFired --><a name="//apple_ref/cpp/clm/IOAudioDevice/timerFired/void/(OSObject*,IOTimerEventSource*)"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="timerFired">timerFired</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Internal static function called when the timer fires.
<!-- end abstract --></p>
<p></p>
<pre><tt>protected</tt>
<br><span class="keyword">static</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">timerFired</span><!-- /a -->(
    <a href="../../../OSObject_h/Classes/OSObject/index.html#//apple_ref/cpp/cl/OSObject" target="_top" class="type"><span class="type">OSObject</span></a> <span class="type">*</span><span class="param">target</span>,
    <a href="../../../IOTimerEventSource_h/Classes/IOTimerEventSource/index.html#//apple_ref/cpp/cl/IOTimerEventSource" target="_top" class="type"><span class="type">IOTimerEventSource</span></a> <span class="type">*</span><span class="param">sender</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<dl>
<dt><code>target</code></dt>
<dd><p>The IOAudioDevice instance that initiated the timer callback.</p></dd>
<dt><code>sender</code></dt>
<dd><p>The IOTimerEventSources calling this callback.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This function simply calls dispatchTimerEvents() on the IOAudioDevice to do just that.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=instm;  uid=//apple_ref/cpp/instm/IOAudioDevice/waitForPendingPowerStateChange/void/();  indexgroup=Audio ;   name=IOAudioDevice::waitForPendingPowerStateChange --><a name="//apple_ref/cpp/instm/IOAudioDevice/waitForPendingPowerStateChange/void/()"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="waitForPendingPowerStateChange">waitForPendingPowerStateChange</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Called internally to wait until a pending power state change is complete.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">virtual</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> <!-- a --><span class="function">waitForPendingPowerStateChange</span><!-- /a -->(); </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This is only used by internal functions to wait during pending power
state changes.  It is used to prevent multiple power state changes at the same time.
This function must be called while holding the IOCommandGate.  If an asynchronous 
power state change is in progress this function will block until the state change
if complete.  Once complete, it will return while still holding the IOCommandGate.
<!-- end discussion -->
</p>
<p></p>
<h2>Typedefs</h2>
<hr>
<!-- headerDoc=tdef;  uid=//apple_ref/cpp/tdef/IOAudioDevice/TimerEvent;  indexgroup=Audio ;   name=IOAudioDevice::TimerEvent --><a name="//apple_ref/cpp/tdef/IOAudioDevice/TimerEvent"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="TimerEvent">TimerEvent</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>Generic timer event callback for IOAudioDevice timer targets.
<!-- end abstract --></p>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">typedef</span> <a href="../../../../../../GraphicsImaging/Reference/ImageCaptureDeviceModulesReference/ICADevice/CompositePage.html#//apple_ref/c/tdef/void" target="_top" class="type"><span class="type">void</span></a> ( <span class="type">*</span><!-- a --><span class="function">TimerEvent</span><!-- /a -->)(
    <a href="../../../OSObject_h/Classes/OSObject/index.html#//apple_ref/cpp/cl/OSObject" target="_top" class="type"><span class="type">OSObject</span></a> <span class="type">*</span><span class="param">target</span>,
    <a href="index.html#//apple_ref/cpp/cl/IOAudioDevice" target="_top" class="type"><span class="type">IOAudioDevice</span></a> <span class="type">*</span><span class="param">audioDevice</span>); </pre>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Fields</font></h5>
<dl>
<dt><code>target</code></dt>
<dd><p>The target of the timer event - passed in when the timer event was registered.</p></dd>
<dt><code>audioDevice</code></dt>
<dd><p>The IOAudioDevice sending the event.</p></dd>
</dl>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>TimerEvent callback function takes two arguments; the target of
the timer event and the IOAudioDevice sending the event.
<!-- end discussion -->
</p>
<p></p>
<h2>Member Data</h2>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOAudioDevice/asyncPowerStateChangeInProgress;  indexgroup=Audio ;   name=IOAudioDevice::asyncPowerStateChangeInProgress --><a name="//apple_ref/cpp/data/IOAudioDevice/asyncPowerStateChangeInProgress"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="asyncPowerStateChangeInProgress">asyncPowerStateChangeInProgress</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="var">asyncPowerStateChangeInProgress</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion -->Set to true while an asynchronous power change is pending and false all other times.<!-- end discussion -->
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOAudioDevice/audioEngines;  indexgroup=Audio ;   name=IOAudioDevice::audioEngines --><a name="//apple_ref/cpp/data/IOAudioDevice/audioEngines"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="audioEngines">audioEngines</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><a href="../../../OSArray_h/Classes/OSArray/index.html#//apple_ref/cpp/cl/OSArray" target="_top" class="type"><span class="type">OSArray</span></a> <span class="type">*</span> <!-- a --><span class="var">audioEngines</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion -->The set of IOAudioEngine objects vended by the IOAudioDevice.<!-- end discussion -->
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOAudioDevice/audioPorts;  indexgroup=Audio ;   name=IOAudioDevice::audioPorts --><a name="//apple_ref/cpp/data/IOAudioDevice/audioPorts"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="audioPorts">audioPorts</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><a href="../../../OSSet_h/Classes/OSSet/index.html#//apple_ref/cpp/cl/OSSet" target="_top" class="type"><span class="type">OSSet</span></a> <span class="type">*</span> <!-- a --><span class="var">audioPorts</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion -->The set of IOAudioPort objects associated with the IOAudioDevice<!-- end discussion -->
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOAudioDevice/commandGate;  indexgroup=Audio ;   name=IOAudioDevice::commandGate --><a name="//apple_ref/cpp/data/IOAudioDevice/commandGate"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="commandGate">commandGate</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><a href="../../../IOCommandGate_h/Classes/IOCommandGate/index.html#//apple_ref/cpp/cl/IOCommandGate" target="_top" class="type"><span class="type">IOCommandGate</span></a> <span class="type">*</span><!-- a --><span class="var">commandGate</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion -->The IOCommandGate for this IOAudioDevice.  It is attached to workLoop<!-- end discussion -->
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOAudioDevice/currentPowerState;  indexgroup=Audio ;   name=IOAudioDevice::currentPowerState --><a name="//apple_ref/cpp/data/IOAudioDevice/currentPowerState"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="currentPowerState">currentPowerState</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><!-- a --><span class="type">IOAudioDevicePowerState</span><!-- /a --> <!-- a --><span class="var">currentPowerState</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion -->Used to track the existing power state - can be fetched by calling getPowerState()<!-- end discussion -->
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOAudioDevice/duringStartup;  indexgroup=Audio ;   name=IOAudioDevice::duringStartup --><a name="//apple_ref/cpp/data/IOAudioDevice/duringStartup"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="duringStartup">duringStartup</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="var">duringStartup</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion -->State variable set to true while the driver is starting up and false all other times<!-- end discussion -->
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOAudioDevice/familyManagePower;  indexgroup=Audio ;   name=IOAudioDevice::familyManagePower --><a name="//apple_ref/cpp/data/IOAudioDevice/familyManagePower"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="familyManagePower">familyManagePower</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><!-- a --><span class="type">bool</span><!-- /a --> <!-- a --><span class="var">familyManagePower</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion -->Set to true if the family is supposed to manage power - this is the default state.  It can be changed early in the initialization process with a call to setFamilyManagePower().<!-- end discussion -->
<p></p>
<hr>
<!-- headerDoc=clconst;  uid=//apple_ref/cpp/clconst/IOAudioDevice/gIOAudioPlane;  indexgroup=Audio ;   name=IOAudioDevice::gIOAudioPlane --><a name="//apple_ref/cpp/clconst/IOAudioDevice/gIOAudioPlane"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="gIOAudioPlane">gIOAudioPlane</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>public</tt>
<br><span class="keyword">static</span> <span class="keyword">const</span> <!-- a --><span class="var">IORegistryPlane</span><!-- /a --> <span class="var">*</span><!-- a --><span class="var">gIOAudioPlane</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>A static IORegistryPlane representing the new IOAudioPlane that the IOAudioFamily uses
to represent the signal chain of the device.<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOAudioDevice/minimumInterval;  indexgroup=Audio ;   name=IOAudioDevice::minimumInterval --><a name="//apple_ref/cpp/data/IOAudioDevice/minimumInterval"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="minimumInterval">minimumInterval</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><!-- a --><span class="type">AbsoluteTime</span><!-- /a --> <!-- a --><span class="var">minimumInterval</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion -->The smallest timer interval requested by all timer event targets.<!-- end discussion -->
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOAudioDevice/numRunningAudioEngines;  indexgroup=Audio ;   name=IOAudioDevice::numRunningAudioEngines --><a name="//apple_ref/cpp/data/IOAudioDevice/numRunningAudioEngines"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="numRunningAudioEngines">numRunningAudioEngines</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><!-- a --><span class="type">UInt32</span><!-- /a --> <!-- a --><span class="var">numRunningAudioEngines</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion -->The number of running IOAudioEngines.  This is used to maintain idle vs active power state.<!-- end discussion -->
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOAudioDevice/pendingPowerState;  indexgroup=Audio ;   name=IOAudioDevice::pendingPowerState --><a name="//apple_ref/cpp/data/IOAudioDevice/pendingPowerState"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="pendingPowerState">pendingPowerState</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><!-- a --><span class="type">IOAudioDevicePowerState</span><!-- /a --> <!-- a --><span class="var">pendingPowerState</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion -->If a power state change is in progress, this represents the pending power state.  All other times this is the same as the currentPowerState.<!-- end discussion -->
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOAudioDevice/previousTimerFire;  indexgroup=Audio ;   name=IOAudioDevice::previousTimerFire --><a name="//apple_ref/cpp/data/IOAudioDevice/previousTimerFire"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="previousTimerFire">previousTimerFire</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>The time of the last timer event.
<!-- end abstract --></p>
<p></p>
<pre><tt>protected</tt>
<br><!-- a --><span class="type">AbsoluteTime</span><!-- /a --> <!-- a --><span class="var">previousTimerFire</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>This is used to schedule the next timer event.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOAudioDevice/timerEvents;  indexgroup=Audio ;   name=IOAudioDevice::timerEvents --><a name="//apple_ref/cpp/data/IOAudioDevice/timerEvents"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="timerEvents">timerEvents</a></h3>
</td></tr></table>
<hr>
<p><!-- begin abstract --></p>
<p>The set of timer events in use by the device.  
<!-- end abstract --></p>
<p></p>
<pre><tt>protected</tt>
<br><a href="../../../OSDictionary_h/Classes/OSDictionary/index.html#//apple_ref/cpp/cl/OSDictionary" target="_top" class="type"><span class="type">OSDictionary</span></a> <span class="type">*</span> <!-- a --><span class="var">timerEvents</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion --><p>The key for the dictionary is the target of the event.  This means that a single target may
have only a single event associated with it.
<!-- end discussion -->
</p>
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOAudioDevice/timerEventSource;  indexgroup=Audio ;   name=IOAudioDevice::timerEventSource --><a name="//apple_ref/cpp/data/IOAudioDevice/timerEventSource"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="timerEventSource">timerEventSource</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><a href="../../../IOTimerEventSource_h/Classes/IOTimerEventSource/index.html#//apple_ref/cpp/cl/IOTimerEventSource" target="_top" class="type"><span class="type">IOTimerEventSource</span></a> <span class="type">*</span><!-- a --><span class="var">timerEventSource</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion -->An IOTimerEventSource attached to workLoop used for the timer services<!-- end discussion -->
<p></p>
<hr>
<!-- headerDoc=data;  uid=//apple_ref/cpp/data/IOAudioDevice/workLoop;  indexgroup=Audio ;   name=IOAudioDevice::workLoop --><a name="//apple_ref/cpp/data/IOAudioDevice/workLoop"></a>
<table border="0" cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row">
<h3><a name="workLoop">workLoop</a></h3>
</td></tr></table>
<hr>
<p></p>
<pre><tt>protected</tt>
<br><a href="../../../IOWorkLoop_h/Classes/IOWorkLoop/index.html#//apple_ref/cpp/cl/IOWorkLoop" target="_top" class="type"><span class="type">IOWorkLoop</span></a> <span class="type">*</span><!-- a --><span class="var">workLoop</span><!-- /a -->; </pre>
<h5 class="tight">
<font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5>
<!-- begin discussion -->The IOWorkLoop for the driver - this is shared with the other objects in the driver<!-- end discussion -->
<p></p>
<p><!-- start of footer -->

<!-- start of footer --> 
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/KernelIOKitFramework/IOAudioDevice_h/Classes/IOAudioDevice/index.html%3Fid%3DTP30000816-3.4&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/KernelIOKitFramework/IOAudioDevice_h/Classes/IOAudioDevice/index.html%3Fid%3DTP30000816-3.4&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/KernelIOKitFramework/IOAudioDevice_h/Classes/IOAudioDevice/index.html%3Fid%3DTP30000816-3.4&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</p>
<p>&#160;</p>
<!--#include virtual="/footer"-->
<!-- end of footer -->


<!-- end of footer -->
Last Updated: 2008-12-19
</div>
<!-- headerDoc=cl; uid=//apple_ref/cpp/cl/IOAudioDevice; indexgroup=Audio ; name=IOAudioDevice--><a name="//apple_ref/cpp/cl/IOAudioDevice"></a>
</body>
</html>
