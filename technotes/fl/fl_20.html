<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!-- Template 01-August-01 --><!-- Includes revisions to graphics tags --><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note FL20: File Sharing and Shared Folders</title><meta name="keywords" content="Mac OS 7 AppleShare file sharing PBGetCatInfo PBHGetDirAccess PBHSetDirAccess PBHSetFLock PBHRstFLock"><meta name="Description" content="Technical Note FL20: This Technical Note describes modificationsto the existing File Manager routines, PBGetCatInfo, PBHGetDirAccess,PBHSetDirAccess, PBHSetFLock and PBHRstFLock, when used onvolumes prepared by Macintosh System 7 File Sharing.">                                       <meta name="categories" content="Files"><meta name="week-posted" content="Jul 29, 1991 - Aug 2, 1991"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002446" title="File Sharing and Shared Folders"></a><A NAME="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p> A primary category has yet to be selected for this document. </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/index.html" target="_blank">Reference Library</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note FL20</div>
<div id="pageheadsub">File Sharing and Shared Folders</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext">					<A HREF="#Section1">Introduction</A><BR><BR> 					<A HREF="#Section2">Share Points, Shared Areas, Locked Folders<BR> and PBGetCatInfo</A><BR><BR> 					<A HREF="#Section3">Shared Folders and Blank Access Privileges</A><BR><BR> 					<A HREF="#References">References</A><BR><BR>          <A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">This Note describes modifications to the existing File Manager routines,<code>PBGetCatInfo</code>, <code>PBHGetDirAccess</code>, <code>PBHSetDirAccess</code>, <code>PBHSetFLock</code> and <code>PBHRstFLock</code>, when used on volumes prepared by Macintosh System 7 File Sharing.</p> <!-- end_intro_text --><!-- begin_date --><h3 align=center>[Aug 01 1991]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><a name="Section1"></a> <h2>Introduction</h2><p>There are several differences between System 7 File Sharing and AppleShare 2.0.1.  This Note describes what those differences mean when calling <code>PBGetCatInfo</code>, <code>PBHGetDirAccess</code>, <code>PBHSetDirAccess</code>,<code>PBHSetFLock</code> and <code>PBHRstFLock</code>on local volumes that return <code>bHasPersonalAccessPrivileges</code> to <code>PBHGetVolParms</code>.</p><P><A HREF="#top">Back to top</A></P><a name="Section2"></a><h2>Share Points, Shared Areas, Locked Folders and PBGetCatInfo</h2><p>The first notable difference between AppleShare 2.0.1 and File Sharing is thatFile Sharing allows both folders and volumes to be exported or shared over anAppleTalk network (only volumes could be shared with AppleShare 2.0.1).   Afolder or volume can be shared by selecting the "Share this item and itscontents" check box in the Finder's Sharing dialog.  A folder or volume sharedin this way is called a "share point" and its Finder icon (if it's a folder) isshown in Figure&nbsp;1.  The share point and all folders under it in thedirectory structure have access privileges and those access privileges can beset by the local user.</p><p align=center><img src="images/fl_20_001.gif" alt="Figure 1" width=36 height=33></p><p align=center><b>Figure 1</b>. Folder that is a Share Point</p><p>The server's owner is a user with "All Privileges" and can remotely access allsharable volumes and folders on the Macintosh no matter what access privilegesare set.  The owner of an AppleShare 2.0.1 server is the server administrator.The owner of a File Sharing server is the owner of the Macintosh system as setby the Sharing Setup control panel.  All other users of a server are consideredregular users.  Figure 2 shows the Finder icon of a folder that is a sharepoint mounted by some regular user.</p><p align=center><img src="images/fl_20_002.gif" alt="Figure 2" width=36 height=33></p><p align=center><b>Figure 2</b>. Folder that is a Share Point Mounted by a Regular User</p><p>Folders under a share point are already in a shared area and cannot be sharepoints.  However, those folders have access privileges so the visual feedbackgiven by the Finder is the icon shown in Figure 3.</p><p align=center><img src="images/fl_20_003.gif" alt="Figure 3" width=36 height=26></p><p align=center><b>Figure 3</b>. Folder in a Shared Area of the Folder Hierarchy</p><p>To allow applications to see share points and folders in shared areas, new bitdefinitions have been added to the <code>ioFlAttrib</code> bitmap returned by theFile Manager call <code>PBGetCatInfo</code> when the information returned is for afolder.  Bit 4 of <code>ioFlAttrib</code> is always set for folders.  If a folderis a share point, bit 5 of <code>ioFlAttrib</code> is set.  If a folder that's ashare point is mounted, bit 3 of <code>ioFlAttrib</code> is set.  If a folder is ina shared area of the folder hierarchy, bit 2 of <code>ioFlAttrib</code> is set.  Ifa folder is locked, bit 0 of <code>ioFlAttrib</code> is set.  Folders can locked orunlocked with the <code>PBHSetFLock</code> or <code>PBHRstFLock</code> calls.  Figure 4shows the <code>ioFlAttrib</code> bitmap for folders as returned by<code>PBGetCatInfo</code> under the System 7 File Manager.</p><p align=center><img src="images/fl_20_004.gif" alt="Figure 4" width=448 height=114></p><p align=center><b>Figure 4</b>. <code>ioFlAttrib</code> for a Folder</p><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>Note:</B><BR>These bits are READ-ONLY for folders.  Do not try to set thesebits with the <code>PBSetCatInfo</code> call.</P></TD></TR></TABLE></CENTER><BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>Note:</B><BR>As noted in Inside Macintosh, Volume VI, <code>PBCatSearch</code>searches only on bits 0 and 4.  The additional bits returned in <code>ioFlAttrib</code> by <code>PBGetCatInfo</code> cannot be used by <code>PBCatSearch</code>.</P></TD></TR></TABLE></CENTER><BR><P><A HREF="#top">Back to top</A></P><a name="Section3"></a><h2>Shared Folders and Blank Access Privileges</h2><p>Another difference between AppleShare 2.0.1 and File Sharing is that FileSharing supports a new user access privilege called blank access privileges.  Afolder with blank access privileges set ignores the other access privilege bitsand uses the access privilege bits of its parent.  On the local Macintosh,folders in a shared area default to blank access privileges (until setotherwise) and new folders created in a shared area are given blank accessprivileges.  Folders created over AppleShare are given the same accessprivileges as the parent folder (or volume) and are owned by the user thatcreated them.</p><p>Blank access privileges are useful because folders' access privileges now behave in a way which users expect them to.  When a folder with blank access privileges is moved around within a folder hierarchy, it always reflects the access privileges of its containing folder. However, once the blank access privileges bit has been cleared for a folder, its access privileges "stick" to that folder, and remain unchanged no matter where the folder is moved. Volumes that support blank access privileges have the <code>bHasBlankAccessPrivileges</code> bit set in <code>vMAttrib</code> longword of the volume parameter data returned by the <code>PBHGetVolParms</code> call. Folders with blank access privileges can be identified with the <code>PBHGetDirAccess</code> call.<code>PBHSetDirAccess</code> allows you to setblank access privileges.  When bit 28 of <code>ioACAccess</code> is set, blank access privileges are set for a folder.  The entire access privileges longword with the new bit for blank access privileges is shown in Figure 5.</p><p align=center><img src="images/fl_20_005.gif" alt="Figure 5" width=416 height=176></p><p align=center><b>Figure 5-Access Privileges in <code>ioACAccess</code></b></p><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>Note:</B><BR>Only the blank access privileges bit (bit 28) in the high byte of<code>ioACAccess</code> may be set when calling <code>PBHSetDirAccess</code>.  You cannot set the directory owner bit or the user's privileges of a folder.</p><P>The blank access privileges bit is not returned in the<code>ioACUser</code> field by the <code>PBGetCatInfo </code>routine.</P></TD></TR></TABLE></CENTER><BR><P><A HREF="#top">Back to top</A></P><a name="References"></a><h2>References</h2><p><i>Inside Macintosh</i>, Volume IV, The File Manager</p><p><i>Inside Macintosh</i>, Volume V, File Manager Extensions In a Shared Environment</p><p><i>Inside Macintosh</i>, Volume VI, The File Manager</p><p><i>Inside AppleTalk</i>, AppleTalk Filing Protocol</p><P><A HREF="#top">Back to top</A></P><P><A NAME=Downloads></A></P>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (136K)</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/fl_20.pdf">Download</A></P>               </TD>            </TR></table><BR><P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/fl/fl_20.html%3Fid%3DDTS10002446-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/fl/fl_20.html%3Fid%3DDTS10002446-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/fl/fl_20.html%3Fid%3DDTS10002446-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --><hr width=500 align=center></BODY></HTML>