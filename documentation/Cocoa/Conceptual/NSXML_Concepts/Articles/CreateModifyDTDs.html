<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Tree-Based XML Programming Guide for Cocoa: Creating and Modifying Document Type Definitions</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Creating and Modifying Document Type Definitions"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001402" title="Creating and Modifying Document Type Definitions"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../DataManagement-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000445" target="_top">Data Management</a> &gt; <a href="../index.html" target="_top">Tree-Based XML Programming Guide for Cocoa</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="AttributesNamespaces.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="BindingXMLObjects.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/TP40001402-BAJIIAJG" title="Creating and Modifying Document Type Definitions"></a><hr /><H1>Creating and Modifying Document Type Definitions</H1><a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_44"></a><p>With the DTD classes of NSXML you can create a Document Type Definition (DTD) or process an existing one, converting its string representation into a shallow tree structure. You can add nodes representing DTD<a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_45"></a> declarations to the tree, remove nodes from it, or change the values of those declarations. Finally, you can write out the created or modified DTD “inline” with its XML string representation. The DTD classes are NSXMLDTD<a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_46"></a> and NSXMLDTDNode<a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_47"></a>.</p><p><a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_48"></a>Usually DTDs in NSXML are internal and are set as a property of an NSXMLDocument object. When it processes an XML document, NSXML creates a DTD tree structure and attaches it to a document but only if the DTD is internal. However, you can create a DTD programmatically and write it out to its own file (that is, an external DTD) using NSXML.</p><p>When NSXML processes an existing source of XML and the <code>NSXMLDocumentValidate </code><a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_49"></a><a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_50"></a><a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_51"></a>input option is specified, it validates the XML against an internal or external DTD (see <span class="content_text"><a href="CreatingXMLDoc.html#//apple_ref/doc/uid/TP40001255-96843">“Creating a Document Object From Existing XML”</a></span>). However, validation is a separate process from the creation of the tree structure representing a DTD. (You can also dynamically validate an NSXMLDocument against its DTD by sending the <code>validateAndReturnError:<a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_52"></a></code> message to the document object.)</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="CreateModifyDTDs.html#//apple_ref/doc/uid/TP40001402-97668-BAJJBEAH">Creating a DTD</a>
				
			<br/>
			
        
			
			
				<a href="CreateModifyDTDs.html#//apple_ref/doc/uid/TP40001402-96896-BCIDFJAG">Modifying a DTD</a>
				
			<br/>
			
        
			
			
				<a href="CreateModifyDTDs.html#//apple_ref/doc/uid/TP40001402-96868">Finding the Declaration for an XML Construct</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001402-97668" title="Creating a DTD"></a><a name="//apple_ref/doc/uid/TP40001402-97668-BAJJBEAH" title="Creating a DTD"></a><h2>Creating a DTD</h2><a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_53"></a><p>If you read and process an existing source of XML using the NSXML interfaces, and that XML includes an internal DTD, a shallow (two-level) tree is created to represent the DTD. At the root of this tree<a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_54"></a> is an instance of the NSXMLDTD class<a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_55"></a>; this object has children consisting of NSXMLDTDNodeDTD nodes objects, each representing the declaration for an element, entity, attribute-list, or notation in the DTD. (The children may also include NSXMLNode objects representing comments and processing instructions found in the source DTD.) As it parses declarations and creates DTD nodes, NSXML sets the kind (<code>NSXMLNodeKind</code><a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_56"></a>) and DTD subkind (<code>NSXMLDTDNodeKind</code><a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_57"></a>) of each created node.</p><p>You can also create a standalone NSXMLDTD object from an external DTD with the <code>initWithContentsOfURL:options:error:<a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_58"></a></code> or <code>initWithData:options:error: <a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_59"></a></code> methods. Then you can associate this DTD object with an XML document object through the<code> setDTD:</code> method of the NSXMLDocument class.</p><p>The created DTD tree is associated with the XML document as a property. In programmatic terms, this means that you can access the NSXMLDTD object (and its NSXMLDTDNode children) by sending the NSXMLDocument object a <code>DTD<a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_60"></a></code> message. Once you have accessed the NSXMLDTD object you can add children, remove children, change declarations, and so on (see <span class="content_text"><a href="CreateModifyDTDs.html#//apple_ref/doc/uid/TP40001402-96896">“Modifying a DTD”</a></span>).</p><p>You can also create an entirely new DTD tree programmatically. To do so, complete the following steps:</p><ol class="ol"><li class="li"><p>Create an instance of the NSXMLDTD class.</p></li><li class="li"><p>If the DTD is to be external, set its system ID (<code>setSystemID: <a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_61"></a></code>) and, if necessary, its public ID (<code>setPublicID:</code>).</p></li><li class="li"><p>Create instances of the NSXMLDTDNode class for each declaration you want in the DTD. To create these objects you can use the <code>initWithXMLString: <a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_62"></a></code> method of the NSXMLDTDNode class, the NSXMLNode class method <code>DTDNodeWithXMLString: <a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_63"></a></code>, or the NSXMLNode <code>initWithKind:</code><a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_64"></a>method. The first two of these methods take a string equivalent to a DTD declaration, for example</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;!ELEMENT name (#PCDATA)><span></span></pre></td></tr></table></div><p>(If you use the <code>initWithKind:</code> method, you must set the string or object value of the DTD node appropriately—see <span class="content_text"><a href="CreateModifyDTDs.html#//apple_ref/doc/uid/TP40001402-96896">“Modifying a DTD.”</a></span>) Each created DTD node is automatically assigned a node kind (if one is not explicitly assigned) and a DTD subkind, based on the declaration parsed. You may reassign the subkind with the <code>setDTDKind: <a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_65"></a></code> method. </p></li><li class="li"><p>Add each created NSXMLDTDNode object to the NSXMLDTD object as a child (using <code>addChild:<a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_66"></a></code> or <code>insertChild:atIndex: <a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_67"></a></code>).</p><p>For more on creating, adding, and otherwise manipulating children of an NSXMLDTD object, see <span class="content_text"><a href="CreateModifyDTDs.html#//apple_ref/doc/uid/TP40001402-96896">“Modifying a DTD.”</a></span></p></li></ol><p>Once you have created a DTD, you must decide whether it is to be an internal or external DTD. If an internal DTD, attach it to the NSXMLDocument object using the <code>setDTD:<a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_68"></a></code> method. When you write the XML document out, the DTD string representation appears inline in the XML. If the DTD is external, don’t attach it to an NSXMLDocument but write it out separately, as illustrated in <span class="content_text">Listing 1</span>.</p><a name="//apple_ref/doc/uid/TP40001402-97249-BCIGAIGI" title="Listing 1Creating an external DTD"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP40001402-97249" title="Listing 1Creating an external DTD"></a><strong>Listing 1&nbsp;&nbsp;</strong>Creating an external DTD</p><div class="codesample"><table><tr><td scope="row"><pre>- (void)createExternalDTD {<span></span></pre></td></tr><tr><td scope="row"><pre>    NSXMLDTD *theDTD = [[[NSXMLDTD alloc] init] autorelease];<span></span></pre></td></tr><tr><td scope="row"><pre>    [theDTD setSystemID:@"http://www.boggle.com/DTDs/index.html"];<span></span></pre></td></tr><tr><td scope="row"><pre>    NSXMLDTDNode *attrNode = [[[NSXMLDTDNode alloc] initWithXMLString:<span></span></pre></td></tr><tr><td scope="row"><pre>        @"&lt;!ATTLIST phone location (home | office | mobile) 'home'>"]<span></span></pre></td></tr><tr><td scope="row"><pre>        autorelease];<span></span></pre></td></tr><tr><td scope="row"><pre>    NSXMLDTDNode *elemNode = [[[NSXMLDTDNode alloc] initWithXMLString:<span></span></pre></td></tr><tr><td scope="row"><pre>        @"&lt;!ELEMENT address (street1, street2, city, state, zip)>"]<span></span></pre></td></tr><tr><td scope="row"><pre>        autorelease];<span></span></pre></td></tr><tr><td scope="row"><pre>    NSXMLDTDNode *entNode = [[[NSXMLDTDNode alloc] initWithXMLString:<span></span></pre></td></tr><tr><td scope="row"><pre>        @"&lt;!ENTITY % children 'first, middle, last'>" ]<span></span></pre></td></tr><tr><td scope="row"><pre>         autorelease];<span></span></pre></td></tr><tr><td scope="row"><pre>    NSString *thePath = [self savePath]; // custom method<span></span></pre></td></tr><tr><td scope="row"><pre>    [theDTD addChild:attrNode];<span></span></pre></td></tr><tr><td scope="row"><pre>    [theDTD addChild:elemNode];<span></span></pre></td></tr><tr><td scope="row"><pre>    [theDTD addChild:entNode];<span></span></pre></td></tr><tr><td scope="row"><pre>    [[theDTD XMLString] writeToFile:thePath atomically:YES];<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001402-96896" title="Modifying a DTD"></a><a name="//apple_ref/doc/uid/TP40001402-96896-BCIDFJAG" title="Modifying a DTD"></a><h2>Modifying a DTD</h2><a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_69"></a><p>As with modifying an XML document, you can modify a DTD in two general ways. You can alter the structure of the tree representing the DTD by adding, removing, and replacing nodes. And you can change the value of DTD nodes, essentially modifying the declaration. </p><p>When you change the value of NSXMLDTDNode objects using <code>setStringValue:</code><a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_70"></a> or <code>setObjectValue:</code><a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_71"></a> what changes depends on the type of declaration:</p><ul class="ul"><li class="li"><p>If the type is mixed or an element declaration, the validation string is changed. For example, in the declarations</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;!ELEMENT title (#PCDATA)*><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;!ELEMENT item (head, (p | list | note))><span></span></pre></td></tr></table></div><p><code>(#PCDATA)*</code> and <code>(head, (p | list | note))</code> are validation strings.</p></li><li class="li"><p>If the type is an entity, the entity value changes. In the declaration</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;!ENTITY foo "bar"><span></span></pre></td></tr></table></div><p><code>"bar"</code> is the entity value.</p></li><li class="li"><p>If the type is an attribute-list declaration, the default value changes. In the declaration</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;!ATTLIST bar foo (moo | boo) "moo"><span></span></pre></td></tr></table></div><p><code>"moo"</code> is the default value.</p></li><li class="li"><p>Notations have no changeable value.</p></li></ul><p>The NSXMLDTD<a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_72"></a> methods for manipulating the structure of a DTD are the following:</p><ul class="simple"><li><p><code>- (void)addChild:<a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_73"></a>(NSXMLNode *)child</code></p></li><li><p><code>- (void)setChildren:<a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_74"></a>(NSArray *)children</code></p></li><li><p><code>- (void)insertChild:(NSXMLNode *)child atIndex:(unsigned)index</code></p></li><li><p><code>- (void)insertChildren:<a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_75"></a>(NSArray *)children atIndex:(unsigned)index</code></p></li><li><p><code>- (void)removeChildAtIndex:<a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_76"></a>(unsigned)index</code></p></li><li><p><code>- (void)replaceChildAtIndex:<a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_77"></a>(unsigned)index  withNode:(NSXMLNode *)node</code></p></li></ul><p>These methods, which are identical in signature and purpose to methods of NSXMLDocument and NSXMLElement, have unambiguous usages. All of them except <code>removeChildAtIndex:</code> require you to create an NSXMLDTDNode object first (or detach an existing NSXMLDTDNode object first). As briefly discussed in <span class="content_text"><a href="CreateModifyDTDs.html#//apple_ref/doc/uid/TP40001402-97668">“Creating a DTD,”</a></span> you typically create an NSXMLDTDNode object with the <code>initWithXMLString:</code> method or the <code>DTDNodeWithXMLString:</code> or <code>initWithKind:</code> methods of the NSXMLNode class. The argument of the first two methods is an NSString object representing a DTD declaration, as shown in this example:</p><div class="codesample"><table><tr><td scope="row"><pre>    NSXMLDTDNode *attrNode = [[[NSXMLDTDNode alloc] initWithXMLString:<span></span></pre></td></tr><tr><td scope="row"><pre>        @"&lt;!ATTLIST phone location (home | office | mobile) 'home'>"]<span></span></pre></td></tr><tr><td scope="row"><pre>        autorelease];<span></span></pre></td></tr></table></div><p>Note that you can also create and add children to an NSXMLDTD object that are NSXMLNode objects representing comments and processing instructions.</p><a name="//apple_ref/doc/uid/TP40001402-96868" title="Finding the Declaration for an XML Construct"></a><h2>Finding the Declaration for an XML Construct</h2><a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_78"></a><a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_79"></a><p>If you are implementing your own scheme for dynamic validation of XML, you need to know which DTD declaration governs the placement, form, and allowable values of a particular XML construct. The following conenience methods of NSXMLDTD provide you with that information:</p><ul class="simple"><li><p><code>- (NSXMLDTDNode *)entityDeclarationForName:(NSString *)name</code></p></li><li><p><code>- (NSXMLDTDNode *)elementDeclarationForName:(NSString *)name</code></p></li><li><p><code>- (NSXMLDTDNode *)attributeDeclarationForName:(NSString *)name elementName:(NSString *)elementName</code></p></li><li><p><code>- (NSXMLDTDNode *)notationDeclarationForName:(NSString *)name</code></p></li></ul><p>You provide these methods with the name of an entity, element, notation, and attribute (plus, for attributes, the element name), and they return the NSXMLDTDNode that governs the XML construct. <a name="//apple_ref/doc/uid/TP40001402-DontLinkElementID_80"></a></p><p>Alternatively, you could get the children of an NSXMLDTD object and analyze them.</p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="AttributesNamespaces.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="BindingXMLObjects.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2004, 2009 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2009-02-04<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Conceptual/NSXML_Concepts/Articles/CreateModifyDTDs.html%3Fid%3DTP40001269-2.3&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Conceptual/NSXML_Concepts/Articles/CreateModifyDTDs.html%3Fid%3DTP40001269-2.3&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Conceptual/NSXML_Concepts/Articles/CreateModifyDTDs.html%3Fid%3DTP40001269-2.3&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
