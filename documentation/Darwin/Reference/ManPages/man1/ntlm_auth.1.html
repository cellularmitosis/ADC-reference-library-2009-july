<html><head><title>Mac OS X
 Manual Page For ntlm_auth(1)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/1/ntlm_auth" title="Mac OS X
 Manual Page for ntlm_auth(1)"><!-- headerDoc=man; indexgroup=Section 1; uid="//apple_ref/doc/man/1/ntlm_auth"; name=ntlm_auth(1) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
NTLM_AUTH(1)                                                                                    NTLM_AUTH(1)



<b>NAME</b>
       ntlm_auth - tool to allow external access to Winbind's NTLM authentication function

<b>SYNOPSIS</b>
       ntlm_auth [-d debuglevel] [-l logdir] [-s &lt;smb config file&gt;]

<b>DESCRIPTION</b>
       This tool is part of the <a href="../man7/samba.7.html#//apple_ref/doc/man/7/samba"><b>samba</b>(7)</a> suite.

       ntlm_auth  is  a  helper utility that authenticates users using NT/LM authentication. It returns 0 if
       the users is authenticated successfully and 1 if access was denied. ntlm_auth uses winbind to  access
       the user and authentication data for a domain. This utility is only indended to be used by other pro-<font color="#ffffff" class="whiteout">grams&nbsp;programs</font>
       grams (currently Squid and mod_ntlm_winbind)

<b>OPERATIONAL</b> <b>REQUIREMENTS</b>
       The <a href="../man8/winbindd.8.html#//apple_ref/doc/man/8/winbindd"><b>winbindd</b>(8)</a> daemon must be operational for many of these commands to function.

       Some of these commands also require access to the directory  <u>winbindd</u><b>_</b><u>privileged</u>  in  <u>$LOCKDIR</u>.  This
       should be done either by running this command as root or providing group access to the <u>winbindd</u><b>_</b><u>priv</u>-<font color="#ffffff" class="whiteout">ileged&nbsp;winbindd_privileged</font>
       <u>ileged</u> directory. For security reasons, this directory should not be world-accessable.

<b>OPTIONS</b>
       --helper-protocol=PROTO
          Operate as a stdio-based helper. Valid helper protocols are:


             squid-2.4-basic
                Server-side helper for use with Squid 2.4's basic (plaintext) authentication.

             squid-2.5-basic
                Server-side helper for use with Squid 2.5's basic (plaintext) authentication.

             squid-2.5-ntlmssp
                Server-side helper for use with Squid 2.5's NTLMSSP authentication.

                Requires access to the directory <u>winbindd</u><b>_</b><u>privileged</u>  in  <u>$LOCKDIR</u>.  The  protocol  used  is
                described  here: <a href="http://devel.squid-cache.org/ntlm/squid_helper_protocol.html">http://devel.squid-cache.org/ntlm/squid_helper_protocol.html</a> This protocol
                has been extended to allow the NTLMSSP Negotiate packet to be included as an argument to the
                YR command. (Thus avoiding loss of information in the protocol exchange).

             ntlmssp-client-1
                Client-side  helper  for  use  with  arbitary external programs that may wish to use Samba's
                NTLMSSP authentication knowlege.

                This helper is a client, and as such may be run by any user. The protocol used is effectivly
                the  reverse  of  the  previous  protocol.  A  YR command (without any arguments) starts the
                authentication exchange.

             gss-spnego
                Server-side helper that implements GSS-SPNEGO. This uses a protocol that is almost the  same
                as  squid-2.5-ntlmssp,  but  has  some  subtle differences that are undocumented outside the
                source at this stage.

                Requires access to the directory <u>winbindd</u><b>_</b><u>privileged</u> in <u>$LOCKDIR</u>.

             gss-spnego-client
                Client-side helper that implements GSS-SPNEGO. This also uses  a  protocol  similar  to  the
                above helpers, but is currently undocumented.

             ntlm-server-1
                Server-side helper protocol, intended for use by a RADIUS server or the 'winbind' plugin for
                pppd, for the provision of MSCHAP and MSCHAPv2 authentication.

                This protocol consists of lines in for form: Parameter: value and  Paramter::  Base64-encode
                value.  The  presence of a single period indicates that one side has finished supplying data
                to the other. (Which in turn could cause the helper to authenticate the user).

                Curently implemented parameters from the external program to the helper are:


                   Username
                      The username, expected to be in Samba's unix charset.

                      <b>Example</b> <b>1.</b> Username: bob

                      <b>Example</b> <b>2.</b> Username:: Ym9i

                   Username
                      The user's domain, expected to be in Samba's unix charset.

                      <b>Example</b> <b>3.</b> Domain: WORKGROUP

                      <b>Example</b> <b>4.</b> Domain:: V09SS0dST1VQ

                   Full-Username
                      The fully qualified username, expected to be in Samba's

                      and qualified with the winbind separator.

                      <b>Example</b> <b>5.</b> Full-Username: WORKGROUPb

                      <b>Example</b> <b>6.</b> Full-Username:: V09SS0dST1VQYm9i

                   LANMAN-Challenge
                      The 8 byte LANMAN Challenge value, generated randomly by the server, or (in cases such
                      as MSCHAPv2) generated in some way by both the server and the client.

                      <b>Example</b> <b>7.</b> LANMAN-Challege: 0102030405060708

                   LANMAN-Response
                      The  24  byte  LANMAN Response value, calculated from the user's password and the sup-
                      plied LANMAN Challenge. Typically, this is provided over the network by a client wish-
                      ing to authenticate.

                      <b>Example</b> <b>8.</b> LANMAN-Response: 0102030405060708090A0B0C0D0E0F101112131415161718

                   NT-Response
                      The &gt;= 24 byte NT Response calculated from the user's password and the supplied LANMAN
                      Challenge. Typically, this is provided over the network by a client wishing to authen-
                      ticate.

                      <b>Example</b> <b>9.</b> NT-Response: 0102030405060708090A0B0C0D0E0F101112131415161718

                   Password
                      The  user's  password.  This  would  be provided by a network client, if the helper is
                      being used in a legacy situation that exposes plaintext passwords in this way.

                      <b>Example</b> <b>10.</b> Password: samba2

                      <b>Example</b> <b>11.</b> Password:: c2FtYmEy

                   Request-User-Session-Key
                      Apon sucessful authenticaiton, return the user session key associated with the  login.

                      <b>Example</b> <b>12.</b> Request-User-Session-Key: Yes

                   Request-LanMan-Session-Key
                      Apon  sucessful  authenticaiton,  return  the  LANMAN  session key associated with the
                      login.

                      <b>Example</b> <b>13.</b> Request-LanMan-Session-Key: Yes

                   <b>Warning</b>
                   Implementors should take  care  to  base64  encode            any  data  (such  as  user-
                   names/passwords)  that may contain malicous user data, such as           a newline.  They
                   may also need to decode strings from           the helper, which likewise may  have  been
                   base64 encoded.

       --username=USERNAME
          Specify username of user to authenticate

       --domain=DOMAIN
          Specify domain of user to authenticate

       --workstation=WORKSTATION
          Specify the workstation the user authenticated from

       --challenge=STRING
          NTLM challenge (in HEXADECIMAL)

       --lm-response=RESPONSE
          LM Response to the challenge (in HEXADECIMAL)

       --nt-response=RESPONSE
          NT or NTLMv2 Response to the challenge (in HEXADECIMAL)

       --password=PASSWORD
          User's plaintext password

          If not specified on the command line, this is prompted for when required.

          For  the NTLMSSP based server roles, this paramter specifies the expected password, allowing test-
          ing without winbindd operational.

       --request-lm-key
          Retreive LM session key

       --request-nt-key
          Request NT key

       --diagnostics
          Perform Diagnostics on the authentication chain. Uses the password from --password or prompts  for
          one.

       --require-membership-of={SID|Name}
          Require that a user be a member of specified group (either name or SID) for authentication to suc-
          ceed.

       -V
          Prints the program version number.

       -s &lt;configuration file&gt;
          The file specified contains the configuration details required by the server. The  information  in
          this  file  includes  server-specific  information  such  as what printcap file to use, as well as
          descriptions of all the services that the server is to provide. See <u>smb.conf</u> for more information.
          The default configuration file name is determined at compile time.

       -d|--debuglevel=level
          <u>level</u> is an integer from 0 to 10. The default value if this parameter is not specified is zero.

          The higher this value, the more detail will be logged to the log files about the activities of the
          server. At level 0, only critical errors and serious warnings will be logged. Level 1 is a reason-
          able  level  for  day-to-day running - it generates a small amount of information about operations
          carried out.

          Levels above 1 will generate considerable amounts of log data, and should only be used when inves-
          tigating  a  problem.  Levels  above  3  are designed for use only by developers and generate HUGE
          amounts of log data, most of which is extremely cryptic.

          Note that specifying this parameter here will override the

          parameter in the <u>smb.conf</u> file.

       -l|--logfile=logdirectory
          Base directory name for log/debug files. The extension <b>".progname"</b> will be appended (e.g. log.smb-
          client, log.smbd, etc...). The log file is never removed by the client.

       -h|--help
          Print a summary of command line options.

<b>EXAMPLE</b> <b>SETUP</b>
       To  setup  ntlm_auth  for use by squid 2.5, with both basic and NTLMSSP authentication, the following
       should be placed in the <u>squid.conf</u> file.




       auth_param ntlm program ntlm_auth --helper-protocol=squid-2.5-ntlmssp
       auth_param basic program ntlm_auth --helper-protocol=squid-2.5-basic
       auth_param basic children 5
       auth_param basic realm Squid proxy-caching web server
       auth_param basic credentialsttl 2 hours



       <b>Note</b>
       This example assumes that ntlm_auth has been installed into your path, and that the group permissions
       on <u>winbindd</u><b>_</b><u>privileged</u> are as described above.

       To  setup  ntlm_auth for use by squid 2.5 with group limitation in addition to the above example, the
       following should be added to the <u>squid.conf</u> file.




       auth_param ntlm program ntlm_auth --helper-protocol=squid-2.5-ntlmssp --require-membership-of='WORKGROUPauth_param basic program ntlm_auth --helper-protocol=squid-2.5-basic --require-membership-of='WORKGROUP


<b>TROUBLESHOOTING</b>
       If you're experiencing problems with authenticating Internet Explorer running under MS Windows 9X  or
       Millenium    Edition    against    ntlm_auth's   NTLMSSP   authentication   helper   (--helper-proto-
       col=squid-2.5-ntlmssp), then please read the Microsoft Knowledge  Base  article  #239869  and  follow
       instructions described there.

<b>VERSION</b>
       This man page is correct for version 3.0 of the Samba suite.

<b>AUTHOR</b>
       The  original  Samba  software  and  related  utilities were created by Andrew Tridgell. Samba is now
       developed by the Samba Team as an Open Source project similar to the way the Linux kernel  is  devel-
       oped.

       The ntlm_auth manpage was written by Jelmer Vernooij and Andrew Bartlett.




                                                                                                NTLM_AUTH(1)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man1/ntlm_auth.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man1/ntlm_auth.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man1/ntlm_auth.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
