<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>SerHShake(IM: D)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING320></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->




<!-- Main Body -->

<CENTER>
<P>
<A HREF="Devices-319.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Devices-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Devices-328.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Devices-321.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Devices-2.html"><B>Devices</B></A> / <BR><DD><A HREF="Devices-312.html"><B>Chapter 7 - Serial Driver</B></A> / <A HREF="Devices-316.html"><B>Serial Driver Reference</B></A><BR><DL><DD><A HREF="Devices-317.html"><B>Serial Driver Routines</B></A> / <A HREF="Devices-309.html"><B></B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING320-0></A>
<H3><A NAME=MARKER-9-49></A>SerHShake<A NAME=MARKER-2-50></A><A NAME=MARKER-2-65></A></H3>
 You can use the <CODE>SerHShake</CODE> function to set software handshaking options and other control information.<P>
<PRE>
FUNCTION SerHShake (refNum: Integer; flags: SerShk): OSErr;
</PRE>
<DL>
<DT><CODE>refNum</CODE>
<DD> The driver reference number of the serial output driver.
<DT><CODE>flags</CODE>
<DD> A pointer to a serial handshake record.
</DL>
<A NAME=HEADING320-5></A>
<H5>DESCRIPTION</H5>
 The <CODE>SerHShake</CODE> function enables flow control, sets flow control characters, and specifies which conditions will cause input requests to be aborted. <P>
 Note that the <CODE>SerHShake</CODE> function has been superseded by a newer function that allows control over DTR handshaking. There is no high-level interface to the new function, you access it using a Device Manager control request with a <CODE>csCode</CODE> value of 14. This function uses the same <CODE>SerShk</CODE> data structure, but adds an additional field for DTR hardware flow control. See the section <A HREF=Devices-325.html#MARKER-9-77>"Low-Level Routines," beginning on page 7-27</A>, for a description of control routine 14.<P>
 The serial handshake record is defined by the <CODE>SerShk</CODE> data type:<P>
<PRE>
TYPE SerShk = 
PACKED RECORD
   fXOn:    Byte;    {XON/XOFF output flow control flag}
   fCTS:    Byte;    {CTS output flow control flag}
   xOn:     Char;    {XON character}
   xOff:    Char;    {XOFF character}
   errs:    Byte;    {mask for errors that will terminate input}
   evts:    Byte;    {mask for status changes that cause events}
   fInX:    Byte;    {XON/XOFF input flow control flag}
   fDTR:    Byte;    {DTR input flow control flag(csCode14only)}
END;
</PRE>
<DL>
<H5>Field Description</H5>
<DT><CODE>fXOn<A NAME=MARKER-2-52></A></CODE>
<DD> Set this byte to a non-zero value to enable XON/XOFF output flow control.
<DT><CODE>fCTS<A NAME=MARKER-2-53></A></CODE>
<DD> Set this byte to a non-zero value to enable CTS output flow control.
<DT><CODE>xOn<A NAME=MARKER-2-54></A></CODE>
<DD> If XON/OFF flow control is enabled, this field specifies the character to use for XON.
<DT><CODE>xOff<A NAME=MARKER-2-55></A></CODE>
<DD> If XON/XOFF flow control is enabled, this field specifies the character to use for XOFF.
<DT><CODE>errs<A NAME=MARKER-2-56></A><A NAME=MARKER-2-57></A></CODE>
<DD> Indicates which errors will cause input requests to be terminated, using the bit mask constants shown below.
<DT><CODE>evts<A NAME=MARKER-2-58></A></CODE>
<DD> Indicates whether changes in the CTS signal or the break signal will cause the Serial Driver to post device driver events, using the bit mask constants shown below.
<DT><CODE>fInX<A NAME=MARKER-2-59></A></CODE>
<DD> Set this byte to a non-zero value to enable XON/XOFF input flow control.
<DT><CODE>fDTR<A NAME=MARKER-2-60></A></CODE>
<DD> Set this byte to a non-zero value to enable DTR input flow control. This field is only used by control function 14; it is ignored by the <CODE>SerHShake</CODE> function.
</DL>
 You can use the following constants as bit mask values for the <CODE>errs</CODE> field, to specify which errors will cause input requests to be aborted. Because these are bit mask values, you can sum them to specify more than one error condition.<P>
<PRE>
CONST
   parityErr      = 16; {parity error}
   hwOverrunErr   = 32; {hardware overrun error}
   framingErr     = 64; {framing error}
</PRE>
 You can use the following constants as bit mask values for the <CODE>evts</CODE> field, to specify which status changes will cause the Serial Driver to post device driver events. Because these are bit mask values, you can sum them to specify more than one event.<P>
<PRE>
CONST
   ctsEvent    = 32;    {change in CTS signal}
   breakEvent  = 128;   {change in break signal}
</PRE>
<DL>
<DT><B>WARNING</B>
<DD>Using device driver events is discouraged because interrupts are disabled during the event posting process, which may cause serial data to be lost or other events to be missed. Instead, you should use the <CODE>SerStatus</CODE> function to check the value of the <CODE>ctsHold</CODE> or <CODE>breakErr</CODE> flags in the serial status record.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
<A NAME=HEADING320-23></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The <CODE>SerHShake</CODE> function is equivalent to a Device Manager control request with a <CODE>csCode</CODE> value of 10. To specify DTR flow control, use a <CODE>csCode</CODE> value of 14 and set the <CODE>fDTR</CODE> flag to a non-zero value. You pass the <CODE>flags</CODE> parameter in the <CODE>csParam</CODE> field (<CODE>csParam[0]</CODE> = <CODE>flags</CODE>).<P>
<A NAME=HEADING320-25></A>
<H5><A NAME=MARKER-2-61></A>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error</TABLE>
</H5>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Devices-319.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Devices-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Devices-328.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Devices-321.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Devices-3.html">&copy; Apple Computer, Inc.</A><br>3 JUL 1996</center></font><P>
<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->
</BODY>
</HTML>  
