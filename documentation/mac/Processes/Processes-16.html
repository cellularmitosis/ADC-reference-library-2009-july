<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Process Scheduling (IM: Pr)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING16></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Processes-15.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Processes-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Processes-171.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Processes-17.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html"><B>Inside Macintosh:</B></A> <A HREF="Processes-2.html"><B>Processes</B></A><BR><DD><A HREF="Processes-12.html"><B>Chapter 1 - Introduction to Processes and Tasks</B></A> / <A HREF="Processes-14.html"><B>About Processes</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING16-0></A>
<H2>Process Scheduling</H2>
 <A NAME=MARKER-2-36></A><A NAME=MARKER-2-25></A>Your application can yield control of the CPU to other processes only at very specific times, namely when you call the Event Manager functions <CODE>WaitNextEvent</CODE> or <CODE>EventAvail</CODE>. Whenever your application calls one of these functions, the Process Manager checks the status of your process and takes the opportunity to schedule other processes.<A NAME=MARKER-2-39></A><A NAME=MARKER-2-36></A><P>
<DL>
<DT><B>Note</B>
<DD>Your application can also yield processing time to other processes as a result of calling other Toolbox routines containing internal calls to <CODE>WaitNextEvent</CODE> or <CODE>EventAvail</CODE>. For example, your application can yield the CPU to other processes as a result of calling either of the Apple Event Manager functions <CODE>AESend</CODE> or <CODE>AEInteractWithUser</CODE>. See the chapter "Apple Event Manager" in <I><A HREF="../IAC/IAC-2.html">Inside Macintosh: Interapplication Communication</A></I> for information on using these two functions.<B></B>  <B>&#183;</B>
</DL>
 In general, your application continues to receive processing time as long as any events are pending for it. When your application is the foreground process, it yields time to other processes in these situations: when the user wants to switch to another application or when no events are pending for your application. Your application can also choose to yield processing time to other processes when it is performing a lengthy operation.<A NAME=MARKER-9-34></A><P>
 A <B>major switch</B> occurs when the Process Manager switches the context of the foreground process with the context of a background process (including the A5 worlds and application-specific system global variables) and brings the background process to the front, sending the previous foreground process to the background.<A NAME=MARKER-2-44></A><A NAME=MARKER-2-52></A><A NAME=MARKER-9-94></A><A NAME=MARKER-2-112></A><A NAME=MARKER-2-123></A><P>
 When your application is the foreground process and the user elects to work with another application (by clicking in a window of another application, for example), the Process Manager sends your application a <B>suspend event</B> if the <CODE>acceptSuspendResumeEvents</CODE> bit is set in your application's <CODE>'SIZE'</CODE> resource. When your application receives a suspend event, it should prepare to suspend foreground processing, allowing the user to switch to the other application. For example, in response to the suspend event, your application should remove the highlighting from the controls of its frontmost window and take any other necessary actions. Your application is actually suspended the next time it calls <CODE>WaitNextEvent</CODE> or <CODE>EventAvail</CODE>.<A NAME=MARKER-2-60></A><A NAME=MARKER-2-91></A><P>
 After your application receives the suspend event and calls <CODE>WaitNextEvent</CODE> or <CODE>EventAvail</CODE>, the Process Manager saves the context of your process, restores the context of the process to which the user is switching, and sends a <B>resume event</B> to that process (if the <CODE>acceptSuspendResumeEvents</CODE> bit is set in its <CODE>'SIZE'</CODE> resource). In response to a resume event, your application should resume processing and start interacting with the user. For example, your application should highlight the controls of its frontmost window.<A NAME=MARKER-2-44></A><A NAME=MARKER-2-92></A><P>
 A major switch also occurs when the user hides the active application (by choosing the Hide command in the Application menu). In general, a major switch cannot occur when a modal dialog box is the frontmost window. However, a major switch can occur when a movable modal dialog box is the frontmost window.<A NAME=MARKER-2-42></A><P>
 A <B>minor switch</B> occurs when the Process Manager switches the context of a process to give time to a background process without bringing the background process to the front. For example, a minor switch occurs when no events are pending in the event queue of the foreground process. In this situation, processes running in the background have an opportunity to execute when the foreground process calls <CODE>WaitNextEvent</CODE> or <CODE>EventAvail</CODE>. (If the foreground process has one or more events pending in the event queue, then the next event is returned and the foreground process again has sole access to the CPU.)<A NAME=MARKER-2-43></A><P>
 When an application is switched out in this way, the Process Manager saves the context of the current process, restores the context of the next background process scheduled to run, and sends the background process an event. At this time, the background process can receive either update, null, or high-level events.<P>
 A background process should not perform any task that significantly limits the ability of the foreground process to respond quickly to the user. A background process should call <CODE>WaitNextEvent</CODE> often enough to let the foreground process be responsive to the user. Upon receiving an update event, the background process should update only the content of its windows. Upon receiving a null event, the background process can use the CPU to perform tasks that do not require significant amounts of processing time.<A NAME=MARKER-2-35></A><P>
 The next time the background process calls <CODE>WaitNextEvent</CODE> or <CODE>EventAvail</CODE>, the Process Manager saves the context of the background process and restores the context of the foreground process (if the foreground process is not waiting for a specified amount of time to expire before being scheduled again). The foreground process is then scheduled to execute. If no events are pending for the foreground process and it is waiting for a specified amount of time to expire, the Process Manager schedules the next background process to run. The Process Manager continues to manage the scheduling of processes in this manner.<P>
 Drivers and vertical blanking (VBL) tasks installed in the system heap are scheduled regardless of which application is currently executing. Drivers installed in an application's heap are not scheduled to run when the application is not executing. See the section <A HREF=Processes-19.html#MARKER-9-78>"Task Scheduling,"</A> beginning on <A HREF=Processes-19.html#MARKER-9-78>page 1-11</A>, for more information about the scheduling of interrupt tasks.<A NAME=MARKER-2-47></A><P>
<DL>
<DT><B>Note</B>
<DD>See the chapter "Event Manager" in <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I> for specific information on how your application can handle suspend and resume events and how your application can take advantage of the cooperative multitasking environment.<B></B>  <B>&#183;</B>
</DL>
 Whenever your application calls <CODE>WaitNextEvent</CODE> or <CODE>EventAvail</CODE>, the Process Manager checks the status of your process and takes the opportunity to schedule other processes. Using the <CODE>WaitNextEvent</CODE> function, you can control when your process is eligible to be switched out.<A NAME=MARKER-2-80></A><A NAME=MARKER-2-113></A><P>
 The <CODE>sleep</CODE> parameter of the <CODE>WaitNextEvent</CODE> function specifies a length of time, in ticks, during which the application relinquishes the CPU if no events are pending. For example, if you specify a nonzero value in the <CODE>sleep</CODE> parameter and no events are pending in your application's event queue when you call <CODE>WaitNextEvent</CODE>, the <BR>Process Manager saves the context of your process and schedules other processes until an event becomes available or the time expires. Once the specified time expires or an event becomes available for your application, your process becomes eligible to run. At this time, the Process Manager schedules your process to run at the next available chance. (You can also call the Process Manager's <CODE>WakeUpProcess</CODE> function to make a process eligible to run before the time in the <CODE>sleep</CODE> parameter expires.) If the time specified by <CODE>sleep</CODE> expires and no events are pending for your application, the Process Manager sends your application a null event.<A NAME=MARKER-2-52></A><A NAME=MARKER-2-30></A><P>
 In general, you should specify a value greater than 0 in the <CODE>sleep</CODE> parameter so that those applications that need processing time can get it. If your application performs any periodic task, then the frequency of the task usually determines what value you specify in the <CODE>sleep</CODE> parameter. The less frequent the task, the higher the value of the <CODE>sleep</CODE> parameter. A reasonable value for the <CODE>sleep</CODE> parameter is 60.<A NAME=MARKER-2-97></A><A NAME=MARKER-9-121></A><A NAME=MARKER-2-62></A><P>
</BLOCKQUOTE><P>
<HR>
<center>
<A HREF="Processes-15.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Processes-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Processes-171.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Processes-17.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Processes-3.html">&copy; Apple Computer, Inc.</A><br>17 JUN 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
