<HTML>		<HEAD>		<meta http-equiv="content-type" content="text/html;charset=iso-8859-1">		<meta name="Copyright" content="Copyright 2001 Apple Computer, Inc. All Rights Reserved.">        <title>Completing the Authors Model</title>		</HEAD>	<BODY bgcolor="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- start of path --><table cellspacing=0 border=0 width=600 valign="left"><tr><td scope="row"><font face="Geneva,Helvetica,Arial" size="1"><b>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="../../../index.html">Documentation</a> <b>&gt;</b> <a href="../../webobjects.html" target="_top">WebObjects</a></font></td></tr></table><br><!-- end of path --><a href="Working_Wit_lationships.html" target="_right"><img src="../Images/previous.gif" border="0" alt="Previous"></a><a href="Using_Relat_n_Your_Code.html" target="_right"><img src="../Images/next.gif" border="0" alt="Next"></a>&nbsp;<br><!-- apple_doc: pageHeadingStart --><a name = "TPXREF102"></a><h2><font face="Lucida Grande,Helvetica,Arial">Completing the Authors Model</font></h2><!-- apple_doc: pageHeadingEnd --><p>To complete the Authors model, you'll add the Book entityto it. After defining the entity's attributes, you'll add theBOOK table to the Authors database. Then you'll add the relationshipsbetween Author and Book.</p><br><a name = "TPXREF103"></a><h3><font face="Lucida Grande,Helvetica,Arial">Define the Book Entity</font></h3><p>In this section you'll create the Book entity and defineits attributes, including its primary and foreign keys.</p><ol><li>Open <code>Authors.eomodeld</code> inEOModeler.</font></li><li>Create a new entity.<ol><li>Choose Property &gt;Add Entity.</font></li><li>Choose Tools &gt; Inspector.</font></li><li>Enter <code>Book</code> in theName and Class text fields.</font></li><li>Enter <code>BOOK</code> in theTable Name text field.<br> <img src = "../Art/entitybookadd.gif" alt = "[image: ../Art/entitybookadd.gif]"></font></li></ol></font></li><li>Add and configure Book's attributes.<p>The Book entityhas one major attribute, <code>title</code>,which stores a book's title. It also needs a primary key attribute, <code>bookId</code>,to ensure that all the rows in the BOOK table are unique. Finally,it requires an additional attribute, a foreign key, which is usedto link a book to its author. This last attribute is named <code>authorId</code>.</p><p>Addthe <code>title</code> attribute byfollowing these steps:</p><ol><li>Make sure the Bookentity is selected in entity list.</font></li><li>Add a new attribute and name it <code>title</code>.</font></li><li>Enter <code>TITLE</code> asthe column name.</font></li><li>Enter <code>char</code> as theexternal type.</font></li><li>Choose String as the internal data type.</font></li><li>Enter <code>50</code> in theExternal Width text field.</font></li><li>Select the Allow Null Value option in the Advanced AttributeInspector.<br> <img src = "../Art/authortitle.gif" alt = "[image: ../Art/authortitle.gif]"></font></li></ol><p>Addthe <code>bookId</code> attribute:</p><ol><li>Add a new attributeand name it <code>bookId</code>.</font></li><li>Enter <code>BOOK_ID</code> asthe column name.</font></li><li>Enter <code>int</code> as theexternal data type.</font></li><li>Choose Integer as the internal data type.</font></li><li>Make sure the Allow Null Value option is not selected.<br> <img src = "../Art/bookbookid.gif" alt = "[image: ../Art/bookbookid.gif]"></font></li></ol><p>Addthe <code>authorId</code> attribute(this is the foreign key that relates a book to its author):</p><ol><li>Add a new attributeand name it <code>authorId</code>.</font></li><li>Enter <code>AUTHOR_ID</code> asthe column name.</font></li><li>Enter <code>int</code> as theexternal type.</font></li><li>Choose Integer as the internal data type.</font></li><li>Make sure the Allow Null Value option is not selected.</font></li></ol></font></li><li>Select the primary key attribute for the Book entity.<ol><li>In the <code>bookId</code> rowof the Book Attributes list, click in the column with a key as its headingso that a key appears in the row.</font></li><li>Click in the diamond column of the <code>bookId</code> rowso that the diamond disappears (the value of the <code>bookId</code> attributeis not relevant to the application).</font></li></ol></font></li><li>Make <code>authorId</code> ahidden attribute.<p>For the same reason that <code>bookId</code> isirrelevant, the value of <code>authorId</code> isof no interest to the application.</p><p>Click in the diamondcolumn of the <code>authorId</code> rowin the Book Attributes list, so that the diamond disappears.</p></font></li></ol><br><a name = "TPXREF106"></a><h3><font face="Lucida Grande,Helvetica,Arial">Create the BOOK Table</font></h3><p>In this section, you'll create the BOOK table, just likeyou created the AUTHOR table in  <a sector="mod" href="../EOMBasics/iThe_Authors_Application.html" target="_top">"Creating the AUTHOR Table"</a>.</p><ol><li>Select theBook entity from the entity list.</font></li><li>Choose Property &gt; Generate SQL.</font></li><li>Make sure that only the Create Tables option is selected.<br> <img src = "../Art/booktablecreate.gif" alt = "[image: ../Art/booktablecreate.gif]"></font></li><li>Click Execute SQL.</font></li></ol><br><a name = "TPXREF104"></a><h3><font face="Lucida Grande,Helvetica,Arial">Define the Model's Relationships</font></h3><p>Now that the Book entity is defined, you will relate it tothe Author entity.</p><p>The relationship between Author and Book is bidirectional.Each author can have many books, while each book has only one author.</p><p>Create the relationships by following these steps:</p><ol><li>Choose Tools&gt; Diagram View.</font></li><li>Control-drag from <code>Author.authorId</code> to <code>Book.authorId</code>.<p>Thiscreates two relationships: a to-many relationship from Author toBook, using <code>authorId</code> asthe linking attribute; and a to-one relationship from Book to Author,again using <code>authorId</code> asthe linking attribute.</p><p> <a href="#BBCFIGJI">Figure 12-1</a> graphically depictsthe two relationships. Book is linked to Author by a single-headedarrow, meaning that a book can have one author. Whereas Author is linkedto Book by a double-headed arrow, meaning that an author can havemore than one book.</p><br><a name = "BBCFIGJI"></a><p><b><font face="Geneva,Helvetica,Arial" size="2">Figure 12-1  Relationshipsin the Authors model</font></b></p> <img src = "../Art/authorseomodelddiagram2.gif" alt = "[image: ../Art/authorseomodelddiagram2.gif]"></font></li></ol><p>Deletion can become complex due to the relationships betweenentities. For example, if you delete an Author object, what shouldhappen to the Book objects associated with it? You can define thebehavior you desire by using delete rules in your model.</p><br><a name = "TPXREF111"></a><h4><font face="Lucida Grande,Helvetica,Arial">What Are Delete Rules?</font></h4><p>Each relationship has a <b>delete rule</b> thattells Enterprise Objects what to do when you try to delete the sourceobject. The following are the possible behaviors:</p><ul><li><b>Nullify</b> Deletethe object and nullify any relationships that point back to it fromother entities. (The value of the foreign key property in targetobjects is set to <code>null</code>.)</font></li><li><b>No action</b> Delete the object and performno other action.</font></li><li><b>Cascade</b> Delete the object and all theobjects that are targets of the relationship (child objects).</font></li><li><b>Deny</b> Do not delete the object if childobjects exist. This rule is typically used when child-object deletionshould receive special processing before the parent is deleted.</font></li></ul><br><a name = "TPXREF112"></a><h4><font face="Lucida Grande,Helvetica,Arial">Delete Rules in the AuthorsModel</font></h4><p>In the case of deletion of a book, it makes the most senseto delete the book and remove it from the Author entity's <code>books</code> relationship.This is an example of the Nullify delete rule. If you examine the <code>author</code> relationshipof the Book entity, you'll see that it is already configured withthe Nullify delete rule selected. Therefore, you don't need toalter it. However, that default is not appropriate when an authoris deleted.</p><p>Follow these steps to configure the <code>books</code> relationshipof the Authors entity so that all of an author's books are deletedwhen the author is removed from the database:</p><ol><li>Select the <code>books</code> relationshipof the Author entity.<br> <img src = "../Art/authorsentities.gif" alt = "[image: ../Art/authorsentities.gif]"></font></li><li>Open the Inspector.</font></li><li>Display the Advanced Relationship Inspector.</font></li><li>Select Cascade as the delete rule.</font></li><li>Select the Owns Destination option.<br> <img src = "../Art/deleterule.gif" alt = "[image: ../Art/deleterule.gif]"></font></li><li>Save <code>Books.eomodeld</code>.</font></li></ol><br>    <br><a href="Working_Wit_lationships.html" target="_right"><img src="../Images/previous.gif" border="0" alt="Previous"></a><a href="Using_Relat_n_Your_Code.html" target="_right"><img src="../Images/next.gif" border="0" alt="Next"></a>&nbsp;<hr alt=""><p><font face="Palatino" size="1">&#169; 2001 Apple Computer, Inc.</font></p><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></html>