<!-- legacy work start -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<!-- legacy work end -->


<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)

LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Getting and Setting Sound Input Device Information (IM: S)  (deprecated)</Title>

<!-- legacy work start -->
        <META NAME="Generator" CONTENT="manual">
        <META http-equiv="content-type" CONTENT="text/html;charset=utf-8">
        <META NAME = "Copyright" CONTENT="Copyright 2007 Apple Inc. All Rights Reserved.">
        <META NAME="IndexTitle" CONTENT="Inside Macintosh: Sound (Not Recommended)">
        <meta name="xcode-display" content="render">

        <LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css"> <!-- before submitting, globally replace ".." with "developer.apple.com" -->
        <script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
<!-- legacy work end -->

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<A NAME=HEADING144></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Sound-143.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Sound-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Sound-336.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Sound-145.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Sound-2.html"><B>Sound</B></A> / <BR><DD><A HREF="Sound-137.html"><B>Chapter 3 - Sound Input Manager</B></A> / <A HREF="Sound-142.html"><B>Using the Sound Input Manager</B></A></DL></FONT><P>
<HR>

<!-- legacy work start -->
<script type="text/javascript"> placeWatermark()</script>
<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
<i>Inside Macintosh: Sound</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="http://developer.apple.com/referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div>
<!-- legacy work end -->


<BLOCKQUOTE>
<A NAME=HEADING144-0></A>
<H2><A NAME=MARKER-9-97></A>Getting and Setting Sound Input Device Information<A NAME=MARKER-2-204></A></H2>
 <A NAME=MARKER-2-240></A>You can get information about a specific sound input device and alter a sound input device's settings by calling the functions <CODE>SPBGetDeviceInfo</CODE> and <CODE>SPBSetDeviceInfo</CODE>. These functions accept <B>sound input device information selectors</B> that determine which information you need or want to change. The selectors currently available are defined by constants of type <CODE>OSType</CODE>.<A NAME=MARKER-2-72></A><P>
 Here is a list of the selectors that all sound input device drivers must support. For complete details on all the selectors described in this section, see <A HREF=Sound-219.html#MARKER-9-438>"Sound Input Device Information Selectors" beginning on page 3-18</A>.<P>
<PRE>
CONST
   siAsync                 = 'asyn';   {asynchronous capability}
   siChannelAvailable      = 'chav';   {number of channels available}
   siCompressionAvailable  = 'cmav';   {compression types available}
   siCompressionFactor     = 'cmfa';   {current compression factor}
   siCompressionType       = 'comp';   {compression type}
   siContinuous            = 'cont';   {continuous recording}
   siDeviceBufferInfo      = 'dbin';   {size of interrupt buffer}
   siDeviceConnected       = 'dcon';   {input device connection status}
   siDeviceIcon            = 'icon';   {input device icon}
   siDeviceName            = 'name';   {input device name}
   siLevelMeterOnOff       = 'lmet';   {level meter state}
   siNumberChannels        = 'chan';   {current number of channels}
   siRecordingQuality      = 'qual';   {recording quality}
   siSampleRate            = 'srat';   {current sample rate}
   siSampleRateAvailable   = 'srav';   {sample rates available}
   siSampleSizeAvailable   = 'ssav';   {sample sizes available}
   siSampleSize            = 'ssiz';   {current sample size}
   siTwosComplementOnOff   = 'twos';   {two's complement state}
</PRE>
 The Sound Input Manager defines several selectors that specifically help it interact with sound input device drivers. Your application should not use any of these selectors, but if you are implementing a sound input device driver, you need to support these selectors. They are:<P>
<PRE>
CONST
   siCloseDriver           = 'clos';   {release driver}
   siInitializeDriver      = 'init';   {initialize driver}
   siPauseRecording        = 'paus';   {pause recording}
   siUserInterruptProc     = 'user';   {set sound input interrupt routine}
</PRE>
 Finally, there are a number of sound input device information selectors that sound input device drivers can optionally support. If you are writing an application, you can use these selectors to interact with a sound input device driver, but you should be aware that some drivers might not support all of them. To determine if a driver supports one of these selectors, you can use the <CODE>SPBGetDeviceInfo</CODE> function. If no errors are returned, then the selector is supported when using the <CODE>SPBGetDeviceInfo</CODE> and the <CODE>SPBSetDeviceInfo</CODE> functions.<P>
<PRE>
CONST
   siActiveChannels        = 'chac';   {channels active}
   siActiveLevels          = 'lmac';   {levels active}
   siAGCOnOff              = 'agc ';   {automatic gain control state}
   siCompressionHeader     = 'cmhd';   {get compression header}
   siCompressionNames      = 'cnam';   {return compression type names}
   siInputGain             = 'gain';   {input gain level}
   siInputSource           = 'sour';   {input source selector}
   siInputSourceNames      = 'snam';   {input source names}
   siOptionsDialog         = 'optd';   {display options dialog box}
   siPlayThruOnOff         = 'plth';   {play-through state}
   siStereoInputGain       = 'sgai';   {stereo input gain level}
   siVoxRecordInfo         = 'voxr';   {VOX record parameters}
   siVoxStopInfo           = 'voxs';   {VOX stop parameters}
</PRE>
 The format of the relevant data (either returned by the Sound Input Manager or provided by you) depends on the selector you provide. For example, if you want to determine the name of some sound input device, you can pass to the <CODE>SPBGetDeviceInfo</CODE> function the <CODE>siDeviceName</CODE> selector and a pointer to a 256-byte buffer. If the <CODE>SPBGetDeviceInfo</CODE> function can get the information, it fills that buffer with the name of the specified sound input device. <A HREF=#MARKER-9-101>Listing 3-2</A> illustrates one way you can determine the name of a particular sound input device.<P>
<B>Listing 3-2  <A NAME=MARKER-9-101></A>Determining the name of a sound input device</B><P>
<PRE>
FUNCTION MyGetDeviceName (myRefNum: LongInt; VAR dName: Str255): OSErr;
BEGIN
   MyGetDeviceName := SPBGetDeviceInfo(myRefNum, siDeviceName, Ptr(@dName));
END;
</PRE>
<DL>
<DT><B>Note</B>
<DD>You can get the name and icon of all connected sound input devices without using sound input information selectors by using the <CODE>SPBGetIndexedDevice</CODE> function, which is described on <A HREF=Sound-174.html#MARKER-9-320>page 3-49</A>.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 Some selectors cause the <CODE>SPBGetDeviceInfo</CODE> function to return data of other types. <A HREF=#MARKER-9-102>Listing 3-3</A> illustrates how to determine the number of channels, the sample rate, the sample size, and the compression type currently in use by a given sound input device. (The procedure defined in <A HREF=#MARKER-9-102>Listing 3-3</A> is called in the procedure defined in <A HREF=Sound-143.html#MARKER-9-75>Listing 3-1</A>.)<P>
<B>Listing 3-3  <A NAME=MARKER-9-102></A>Determining some sound input device settings</B><P>
<PRE>
PROCEDURE MyGetDeviceSettings (myRefNum: LongInt; 
                                 VAR numChannels: Integer; 
                                 VAR sampleRate: Fixed; 
                                 VAR sampleSize: Integer; 
                                 VAR compressionType: OSType);
VAR
   myErr:      OSErr;
BEGIN
   {Get number of active channels.}
   myErr := SPBGetDeviceInfo (myRefNum, siNumberChannels, Ptr(@numChannels));
   {Get sample rate.}
   myErr := SPBGetDeviceInfo(myRefNum, siSampleRate, Ptr(@sampleRate));
   {Get sample size.}
   myErr := SPBGetDeviceInfo(myRefNum, siSampleSize, Ptr(@sampleSize));
   {Get compression type.}
   myErr := SPBGetDeviceInfo(myRefNum, siCompressionType, 
                                                   Ptr(@compressionType));
END;
</PRE>
 All of the selectors that return a handle allocate the memory for that handle in the current heap zone; you are responsible for disposing of that handle when you are done with it, and you should verify that there is enough memory for such a handle before calling the selector.<A NAME=MARKER-2-352></A><A NAME=MARKER-2-34></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Sound-143.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Sound-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Sound-336.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Sound-145.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Sound-3.html">&copy; Apple Computer, Inc.</A><br>2 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
