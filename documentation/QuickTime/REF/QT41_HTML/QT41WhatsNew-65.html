<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"><HTML><head><script language="JavaScript" src="../../frametest.js"></script><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1"><META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css"><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><!-- Link line removed --><TITLE> Fetching the Parameters</TITLE><script language=javascript> window.parent.focus(); </script></HEAD><BODY BGCOLOR="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- path goes here --><!-- QTnavbar start --><P><I>Inside Macintosh: QuickTime Reference</I><P>| <A HREF="QT41WhatsNew-64.html">Previous</A> | <A HREF="QT41WhatsNew-1.html">Chapter Contents</A> | <A HREF="QT41WhatsNew.html">Chapter Top</A> | <A HREF="QT41WhatsNew-66.html">Next</A> |</P><!-- QTnavbar end --><H1 CLASS="H3-Heading3"><A NAME="pgfId-51607"></A>Fetching the Parameters</H1><P CLASS="T1-Text1"><A NAME="pgfId-51901"></A>The parameters to your custom action may be the result of a wired expression. Don't worry about analyzing the <TT>kActionParameter</TT> child atoms, the wired expression evaluation machinery has been made accessible via a movie controller action called <TT>mcActionFetchParameterAs</TT>. </P><P CLASS="T1-Text1"><A NAME="pgfId-51610"></A>Fill out a <TT>QTFetchParameterAsRecord</TT> and pass it to <TT>mcActionFetchParameterAs</TT> as in:</P><TT><A NAME="pgfId-55289"></A>CallDoMCActionProc(resolvedTarget-&gt;doMCActionCallbackProc,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resolvedTarget-&gt;callBackRefcon,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mcActionFetchParameterAs,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;fetchAs,&nbsp;&amp;handled&nbsp;);<BR><BR>struct&nbsp;QTFetchParameterAsRecord&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;QTAtomSpec&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramListSpec;<BR>&nbsp;&nbsp;&nbsp;&nbsp;long&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramIndex;<BR>&nbsp;&nbsp;&nbsp;&nbsp;long&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramType;<BR>&nbsp;&nbsp;&nbsp;&nbsp;long&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allowedFlags;<BR>&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min;<BR>&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max;<BR>&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currentValue;<BR>&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newValue;<BR>&nbsp;&nbsp;&nbsp;&nbsp;Boolean&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isUnsignedValue;<BR>};</TT><P CLASS="T1-Text1"><A NAME="pgfId-51629"></A>Set the container and atom of the <TT>paramListSpec</TT> to the <TT>actionContainer</TT> and <TT>actionAtom</TT> passed to <TT>ExecuteWiredAction()</TT>.<TT> </TT></P><P CLASS="T1-Text1"><A NAME="pgfId-51631"></A>Set the <TT>paramIndex</TT> to the index of the parameter you wish to fetch. If you allow a variable number of parameters, you may count how many child atoms of type <TT>kActionParameter</TT> the <TT>actionAtom</TT> has.</P><P CLASS="T1-Text1"><A NAME="pgfId-51633"></A>Set the <TT>paramType</TT> to one of the parameter types from the following enumeration:</P><TT><A NAME="pgfId-55293"></A>enum&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;kFetchAsBooleanPtr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1,<BR>&nbsp;&nbsp;&nbsp;&nbsp;kFetchAsShortPtr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2,<BR>&nbsp;&nbsp;&nbsp;&nbsp;kFetchAsLongPtr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3,<BR>&nbsp;&nbsp;&nbsp;&nbsp;kFetchAsMatrixRecordPtr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4,<BR>&nbsp;&nbsp;&nbsp;&nbsp;kFetchAsModifierTrackGraphicsModeRecord&nbsp;=&nbsp;5,<BR>&nbsp;&nbsp;&nbsp;&nbsp;kFetchAsHandle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6,<BR>&nbsp;&nbsp;&nbsp;&nbsp;kFetchAsStr255&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7,<BR>&nbsp;&nbsp;&nbsp;&nbsp;kFetchAsFloatPtr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;8,<BR>&nbsp;&nbsp;&nbsp;&nbsp;kFetchAsPointPtr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;9,<BR>&nbsp;&nbsp;&nbsp;&nbsp;kFetchAsNewAtomContainer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;10,<BR>&nbsp;&nbsp;&nbsp;&nbsp;kFetchAsQTEventRecordPtr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;11,<BR>&nbsp;&nbsp;&nbsp;&nbsp;kFetchAsFixedPtr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;12,<BR>&nbsp;&nbsp;&nbsp;&nbsp;kFetchAsSetControllerValuePtr&nbsp;=&nbsp;13,<BR>&nbsp;&nbsp;&nbsp;&nbsp;kFetchAsRgnHandle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;14,&nbsp;&nbsp;&nbsp;/*&nbsp;flipped&nbsp;to&nbsp;native*/<BR>&nbsp;&nbsp;&nbsp;&nbsp;kFetchAsComponentDescriptionPtr&nbsp;=&nbsp;15,<BR>&nbsp;&nbsp;&nbsp;&nbsp;kFetchAsCString&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;16<BR>};</TT><P CLASS="T1-Text1"><A NAME="pgfId-51653"></A>Set the <TT>allowedFlags</TT> to flags from the following enumeration, or zero fetching without constraints.</P><TT><A NAME="pgfId-55297"></A>enum&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;kActionFlagActionIsDelta&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1L&nbsp;&lt;&lt;&nbsp;1,<BR>&nbsp;&nbsp;&nbsp;&nbsp;kActionFlagParameterWrapsAround&nbsp;=&nbsp;1L&nbsp;&lt;&lt;&nbsp;2,<BR>&nbsp;&nbsp;&nbsp;&nbsp;kActionFlagActionIsToggle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1L&nbsp;&lt;&lt;&nbsp;3<BR>};</TT><P CLASS="T1-Text1"><A NAME="pgfId-51660"></A>If <TT>allowedFlags</TT> is not set to zero, set the <TT>min</TT>, <TT>max</TT>, <TT>current</TT>, and <TT>isUnsignedValue</TT> fields to appropriate values based on the data type being fetched.</P><P CLASS="T1-Text1"><A NAME="pgfId-51662"></A>The <TT>newValue</TT> field returns the result of the parameter. </P><P CLASS="T1-Text1"><A NAME="pgfId-51663"></A>For scalar and structure types, pass a pointer to the appropriate data type and it will be filled in.</P><P CLASS="T1-Text1"><A NAME="pgfId-51664"></A>For <TT>Handle</TT>, <TT>RgnHandle</TT>, and <TT>Cstring</TT> pass in a new empty handle that will be resized as needed, you are responsible for disposing the handle when done.</P><P CLASS="T1-Text1"><A NAME="pgfId-51665"></A>For <TT>kFetchAsNewAtomContainer, </TT>pass in a pointer to a non-allocated <TT>QTAtomContainer</TT>. On return, this container will contain the contents of the single child atom of the parameter atom and all of its children. This lets you pass arbitrary data that is not evaluated in an atom container as a parameter.</P><P CLASS="T1-Text1"><A NAME="pgfId-51667"></A>A sample custom wired action-handling component has been provided.</P><hr>&#169; 2000 Apple Computer, Inc.<!-- QTnavbar start --><P><I>Inside Macintosh: QuickTime Reference</I><P>| <A HREF="QT41WhatsNew-64.html">Previous</A> | <A HREF="QT41WhatsNew-1.html">Chapter Contents</A> | <A HREF="QT41WhatsNew.html">Chapter Top</A> | <A HREF="QT41WhatsNew-66.html">Next</A> |</P><!-- QTnavbar end --></DIV><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY></HTML>