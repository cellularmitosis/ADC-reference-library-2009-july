<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>

	<!-- BEGIN META TAG INFO -->
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<link rel="home" href="http://developer.apple.com/">
	<link rel="find" href="http://developer.apple.com/search/">
	<link rel="stylesheet" type="text/css" href="../../documentation/css/adcstyle.css" title="fonts">
	<script language="JavaScript" src="../../documentation/js/adc.js" type="text/javascript"></script>
	<!-- END META TAG INFO -->
	
	<!-- BEGIN TITLE -->
	<title>Magic Oracle - /MainFrame.java</title>
	<!-- END TITLE -->
<script language="JavaScript">
function JumpToNewPage() {
	window.location=document.scpopupmenu.gotop.value;
	return true;
}
</script>

</head>

<!-- BEGIN BODY OPEN -->
<body>
<!--END BODY OPEN -->

<!-- START CENTER OPEN -->
<center>
<!-- END CENTER OPEN -->

	<!-- BEGIN LOGO AND SEARCH -->
	<!--#include virtual="/includes/adcnavbar"-->
	<!-- END LOGO AND SEARCH -->
		
		
	<!-- START BREADCRUMB -->
	<div id="breadcrumb">
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td scope="row"><img width="340" height="10" src="images/1dot.gif" alt=""></td>
			<td><img width="340" height="10" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr valign="middle">
			<td align="left" colspan="2">
			<a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../samplecode/index.html">Sample Code</a> &gt; <a href="../../samplecode/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../samplecode/LegacyTechnologies/idxJava-date.html">Java</a> &gt; <A HREF="javascript:location.replace('index.html');">Magic Oracle</A> &gt; 
			</td>
		</tr>
		<tr>
			<td colspan="2" scope="row"><img width="680" height="35" src="images/1dot.gif" alt=""></td>
		</tr>
	</table>
	</div>
	<!-- END BREADCRUMB -->

	<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/Java/index.html" target="_blank">Reference Library > Java</a></li>
	</ul>
</div>




</div></div></div>

	<!-- START MAIN CONTENT -->
	
	<!-- START TITLE GRAPHIC AND INTRO-->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td><h1><div id="pagehead">Magic Oracle</div></h1></td>
		</tr>
	</table>
	<!-- END TITLE GRAPHIC AND INTRO -->
	<!-- START WIDE COLUMN -->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td id="scdetails">
				<h2>/MainFrame.java</h2>
				<form name="scpopupmenu" onSubmit="return false;" method=post>
				<p><strong>View Source Code:</strong> 
					<select name="gotop" onChange="JumpToNewPage();" style="width:340px"><option selected value="ingnore">Select File</option>
<option value="listing1.html">/BufferedDrawer.java</option>
<option value="listing2.html">/BufferedImage.java</option>
<option value="listing3.html">/Fortune.java</option>
<option value="listing4.html">/MainFrame.java</option>
<option value="listing5.html">/MainFrameBeanInfo.java</option>
<option value="listing6.html">/Util.java</option></select>
				</p>
				</form>
				<p><strong><a href="Magic_Oracle.zip">Download Sample</a></strong> (&#147;Magic_Oracle.zip&#148;, 369.3K)<BR>
<strong><a href="Magic_Oracle.dmg">Download Sample</a></strong> (&#147;Magic_Oracle.dmg&#148;, 331.4K)</p>
				<!--
				<p><strong><a href="#">Download Sample</a></strong> (&#147;filename.sit&#148;, 500K)</p>
				-->
			</td>
		</tr>
		<tr>
			<td scope="row"><img width="680" height="10" src="images/1dot.gif" alt=""><br>
			<img height="1" width="680" src="images/1dot_919699.gif" alt=""><br>
			<img width="680" height="20" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr>
			<td scope="row">
	<!--googleon: index -->
<pre class="sourcecodebox">/** *  Apple Worldwide Developer Technical Support * *  &quot;Magic Oracle&quot; sample demonstrating AppleScript for Java. *   User can communicate with this application via AppleScript to *  send a question string and receive an answer string in response *   *  tell Application &quot;Magic Oracle&quot; *       ask Oracle of Frame &quot;oracleFrame&quot; parameters{ &quot;question?&quot; } *  end tell * *  by Michael Hopkins, Apple Developer Technical Support * *  File:   MainFrame.java * *  Copyright &copy;1999 Apple Computer, Inc. *  All rights reserved. * *  4/99  v. 1.0  Shipped as 'Magic Oracle AppleScript for Java' sample. * *  You may incorporate this sample code into your applications without *  restriction, though the sample code has been provided &quot;AS IS&quot; and the *  responsibility for its operation is 100% yours.  However, what you are *  not permitted to do is to redistribute the source as &quot;Apple Sample *  Code&quot; after having made changes. If you're going to re-distribute the *  source, we require that you make it clear in the source that the code *  was descended from Apple Sample Code, but that you've made changes.**/import BufferedImage;import BufferedDrawer;import java.awt.*;import java.awt.event.*;/** * A class by the Magic Oracle application that is a simple extension of the  * java.awt.Frame class. It contains all the elements necessary to act as the * main window of an application. * @version 1.0, April 9, 1999 * @author Michael Hopkins, Worldwide Developer Technical Support, Apple Computer Inc. **/public class MainFrame extends Frame{  /**    * Default constructor    **/  public MainFrame()  {    setLayout(new BorderLayout(0,0));    setVisible(false);    setSize(477,418);    setBackground(new Color(12632256));        panel1 = new java.awt.Panel();    panel1.setLayout(null);    panel1.setBounds(0,388,477,30);    add(&quot;South&quot;, panel1);        button1 = new java.awt.Button();    button1.setLabel(&quot;Ask the Oracle&quot;);    button1.setBounds(212,3,100,23);    panel1.add(button1);        textField1 = new java.awt.TextField();    textField1.setText(&quot;What is thy Bidding?&quot;);    textField1.setBounds(18,3,183,26);    textField1.setForeground(new Color(0));    textField1.setBackground(new Color(16777215));    panel1.add(textField1);        bufferedImage1 = new BufferedImage();    bufferedImage1.setBounds(0,0,477,388);    bufferedImage1.setBackground(new Color(16777215));    add(&quot;Center&quot;, bufferedImage1);        setTitle(&quot;Ask the Oracle&quot;);    this.setName(&quot;oracleFrame&quot;);  /**                      * by calling setName(), we can refer to our frame as                     * Frame &quot;oracleFrame&quot; in AppleScript instead of Frame 1                     */        SymWindow aSymWindow = new SymWindow();    this.addWindowListener(aSymWindow);    SymMouse aSymMouse = new SymMouse();    bufferedImage1.addMouseListener(aSymMouse);    SymMouseMotion aSymMouseMotion = new SymMouseMotion();    bufferedImage1.addMouseMotionListener(aSymMouseMotion);    SymAction lSymAction = new SymAction();    button1.addActionListener(lSymAction);    textField1.addActionListener(lSymAction);        userInit();  }  static public void main(String args[])  {    (new MainFrame()).setVisible(true);  }  /** * UserInit  * Loads neccessary images and prepares offscreen graphics areas **/  protected void userInit()  {    String imagePath = &quot;images/Ball.jpg&quot;;    ballimage = Util.loadImage(imagePath, this);    if (ballimage == null)    {      System.err.println(&quot;Could not load image \&quot;&quot; + imagePath + &quot;\&quot;&quot;);    }    else    {      bufferedImage1.setImage(ballimage);    }    String image = &quot;image&quot;;    String jpg   = &quot;.jpg&quot;;    images = new Image[24];    for ( int i = 0; i &lt; 24; i++ )    {      imagePath = &quot;images/&quot; + image + (i+1) + jpg;      images[i] = Util.loadImage( imagePath, this);      if (images[i] == null)      {        System.err.println(&quot;Could not load image \&quot;&quot; + imagePath + &quot;\&quot;&quot;);      }      }  }        /**     * Shows or hides the component depending on the boolean flag b.     * @param b  if true, show the component; otherwise, hide the component.     * @see java.awt.Component#isVisible     */    public void setVisible(boolean b)  {    if(b)    {      setLocation(50, 50);    }      super.setVisible(b);  }    java.awt.Panel panel1;  java.awt.Button button1;  java.awt.TextField textField1;  BufferedImage bufferedImage1;    protected Image ballimage;  protected Image images[];  protected boolean dragging = false;  protected Point startPoint;  protected Fortune oracle = new Fortune();  /**   * Handle window events   */   class SymWindow extends java.awt.event.WindowAdapter  {    public void windowClosing(java.awt.event.WindowEvent event)    {      Object object = event.getSource();      if (object == MainFrame.this)        MainFrame_WindowClosing(event);    }  }    void MainFrame_WindowClosing(java.awt.event.WindowEvent event)  {    setVisible(false);  // hide the Frame    dispose();      // free the system resources    System.exit(0);    // close the application  }    /**   * Inner class for handling mouse events   */  class SymMouse extends java.awt.event.MouseAdapter  {     /**     * Handle mousePressed events     */    public void mousePressed(java.awt.event.MouseEvent event)    {      Object object = event.getSource();      if (object == bufferedImage1)      {        bufferedImage1_MousePressed(event);        dragging = false;      }    }       /**     * Handle mouseReleased events     */    public void mouseReleased(java.awt.event.MouseEvent event)    {      Object object = event.getSource();      if (object == bufferedImage1)        bufferedImage1_MouseReleased(event);      if ( dragging == true )  // user must drag the ball. Clicking on it will not invoke it      {        askMystic( textField1.getText() );      }    }  }  /**   * Handle mouseDragged events   */  class SymMouseMotion extends java.awt.event.MouseMotionAdapter  {    public void mouseDragged(java.awt.event.MouseEvent event)    {      Object object = event.getSource();      if (object == bufferedImage1)      {        bufferedImage1_MouseDragged(event);        dragging = true;      }    }  }    /**   * Factored routine exposed to AppleScript that performs the oracle &quot;magic&quot;   * @param question Query to ask of the oracle   * @return reponse from oracle   */  public String askMystic( String question )  {    if ( !(textField1.getText().equals( question )))      textField1.setText( question );        String s = &quot;&quot;;    if ( question.equals( &quot;&quot; ))  // if no question is asked, return a canned response    {      animateTriangle( false );      s = &quot;Please ask a question&quot;;    }      else            // if there is a question, clear textfield and generate response    {      animateTriangle( );      s = oracle.getResponse();      try      {        Thread.sleep(150);  // delay in between frames of animation      }      catch (InterruptedException exc) { }      textField1.setText(&quot;&quot;);    }    return s;  }      /**   * Perform animation of floating dodecahedron    * @param input true if non-empty input from textfield   */  void animateTriangle( boolean input )  {    Graphics g = getGraphics();    Point origin = new Point(bufferedImage1.getImageLocation());     origin.x += 114;    // upper left corner for drawing repsonse images    origin.y += 112;    if ( g != null )    {      for ( int i = 0; i &lt; 3; i++ )      {        try        {          Thread.sleep(150);  // delay in between frames of animation        }        catch (InterruptedException exc) { }        g.drawImage( images[i], origin.x, origin.y, this );  // draw 3 common animation frames      }      try      {        Thread.sleep(150);      }      catch (InterruptedException exc) { }      if ( input )        g.drawImage( images[oracle.generateResponseNum() + 4], origin.x, origin.y, this ); // draw response frame      else        g.drawImage( images[3], origin.x, origin.y, this );  // draw &quot;Ask A ?&quot;    }  }    /**   * Perform animation of floating dodecahedron    * This routine simulates calling this routine with a default value of true   */  void animateTriangle( )  {    animateTriangle( true );  }    /**   * Handles mouse pressed events in the buffered image   */  void bufferedImage1_MousePressed(java.awt.event.MouseEvent event)  {    Point eLoc = event.getPoint();          // cache click location    Point iLoc = bufferedImage1.getImageLocation(); // cache image location    Dimension iSize = bufferedImage1.getImageSize();    Rectangle imageRect = new Rectangle(iLoc.x, iLoc.y, iSize.width, iSize.height);    if (imageRect.contains(eLoc))          // determine if click was within image    {      startPoint = new Point(eLoc.x - iLoc.x, eLoc.y - iLoc.y);    }    else      startPoint = null;  }  /**   * Handles mouse dragged events in the buffered image   */  void bufferedImage1_MouseDragged(java.awt.event.MouseEvent event)  {    if (startPoint != null)    // gets the location of the image, offsets it and draws    {      Point eLoc = event.getPoint();      eLoc.translate(-startPoint.x, -startPoint.y);      bufferedImage1.setImageLocation(eLoc);      bufferedImage1.paint(getGraphics());    }  }    /**   * resets the startPoint of the buffered image when the mouse button is released   */  void bufferedImage1_MouseReleased(java.awt.event.MouseEvent event)  {    startPoint = null;  }  /**   * Respond to button clicks and enter key pressed in text field   */  class SymAction implements java.awt.event.ActionListener  {    public void actionPerformed(java.awt.event.ActionEvent event)    {      Object object = event.getSource();      if (object == button1)        button1_ActionPerformed(event);      else if (object == textField1)        textField1_EnterHit(event);    }  }  /**   * Respond to &quot;Ask Mystic&quot; button pressed event   */  void button1_ActionPerformed(java.awt.event.ActionEvent event)  {    askMystic( textField1.getText( ));  }  /**   * Respond enter key pressed in textfield   */  void textField1_EnterHit(java.awt.event.ActionEvent event)  {    simulateClick(button1);  }  /**   * A function to simulate a click on the target button.   * This will make the button draw as if it had been pressed and   * released, and the button will fire an Action event as if   * the button were pressed.   * For use with the Apple MRJ 2.1 EA3 and later.   */  static protected void simulateClick(Button target)  {    if (target != null)    {      KeyEvent keyEvent = new KeyEvent(target, KeyEvent.KEY_PRESSED,                                      System.currentTimeMillis(), 0, KeyEvent.VK_ENTER,                                      (char)KeyEvent.VK_ENTER);      target.dispatchEvent(keyEvent);    }  }}</pre>
	<!--googleoff: index -->
			</td>
		</tr>
	</table>
	<!-- END WIDE COLUMN -->

	<!-- END MAIN CONTENT -->
		<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/samplecode/Magic_Oracle/listing4.html%3Fid%3DDTS10000220-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/samplecode/Magic_Oracle/listing4.html%3Fid%3DDTS10000220-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/samplecode/Magic_Oracle/listing4.html%3Fid%3DDTS10000220-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

	<!-- START BOTTOM APPLE NAVIGATION -->
	<!--#include virtual="/includes/footer"-->
	<!-- END BOTTOM APPLE NAVIGATION -->

<!-- START CENTER CLOSE -->
</center>
<!-- END CENTER CLOSE -->

</body>
</html>