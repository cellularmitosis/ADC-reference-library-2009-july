<html><head><title>Mac OS X
 Manual Page For formail(1)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/1/formail" title="Mac OS X
 Manual Page for formail(1)"><!-- headerDoc=man; indexgroup=Section 1; uid="//apple_ref/doc/man/1/formail"; name=formail(1) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
FORMAIL(1)                                                                                        FORMAIL(1)



<b>NAME</b>
       formail - mail (re)formatter

<b>SYNOPSIS</b>
       <b>formail</b> [<b>+</b><u>skip</u>] [<b>-</b><u>total</u>] [<b>-bczfrktedqBY</b>] [<b>-p</b> <u>prefix</u>]
            [<b>-D</b> <u>maxlen</u> <u>idcache</u>]
            [<b>-l</b> <u>folder</u>]
            [<b>-x</b> <u>headerfield</u>] [<b>-X</b> <u>headerfield</u>]
            [<b>-a</b> <u>headerfield</u>] [<b>-A</b> <u>headerfield</u>]
            [<b>-i</b> <u>headerfield</u>] [<b>-I</b> <u>headerfield</u>]
            [<b>-u</b> <u>headerfield</u>] [<b>-U</b> <u>headerfield</u>]
            [<b>-R</b> <u>oldfield</u> <u>newfield</u>]
            [<b>-n</b> [<u>maxprocs</u> ]] [<b>-m</b> <u>minfields</u>] [<b>-s</b> [<u>command</u> [<u>arg</u> ...]]]
       <b>formail</b> <b>-v</b>

<b>DESCRIPTION</b>
       <b>formail</b>  is  a  filter  that can be used to force mail into mailbox format, perform `From ' escaping,
       generate  auto-replying  headers,  do  simple  header  munging/extracting  or  split   up   a   mail-<font color="#ffffff" class="whiteout">box/digest/articles&nbsp;mailbox/digest/articles</font>
       box/digest/articles file.  The mail/mailbox/article contents will be expected on stdin.

       If  formail  is supposed to determine the sender of the mail, but is unable to find any, it will sub-<font color="#ffffff" class="whiteout">stitute&nbsp;substitute</font>
       stitute `foo@bar'.

       If formail is started without any command line options, it will force any mail coming from stdin into
       mailbox format and will escape <b>all</b> bogus `From ' lines with a `&gt;'.

<b>OPTIONS</b>
       <b>-v</b>   Formail will print its version number and exit.

       <b>-b</b>   Don't escape any bogus mailbox headers (i.e., lines starting with `From ').

       <b>-p</b> <u>prefix</u>
            Define a different quotation prefix.  If unspecified it defaults to `&gt;'.

       <b>-Y</b>   Assume traditional Berkeley mailbox format, ignoring any <b>Content-Length:</b> fields.

       <b>-c</b>   Concatenate  continued  fields in the header.  Might be convenient when postprocessing mail with
            standard (line oriented) text utilities.

       <b>-z</b>   Ensure a whitespace exists between field name and content.  Zap fields which contain only a sin-<font color="#ffffff" class="whiteout">gle&nbsp;single</font>
            gle whitespace character.  Zap leading and trailing whitespace on fields extracted with <b>-x</b>.

       <b>-f</b>   Force  formail  to simply pass along any non-mailbox format (i.e., don't generate a `From ' line
            as the first line).

       <b>-r</b>   Generate an auto-reply header.  This will normally throw away all the existing fields (except X-<font color="#ffffff" class="whiteout">Loop:)&nbsp;XLoop:)</font>
            Loop:)  in  the  original  message,  fields  you  wish to preserve need to be named using the <b>-i</b>
            option.  If you use this option in conjunction with <b>-k</b>, you can  prevent  the  body  from  being
            `escaped' by also specifying <b>-b</b>.

       <b>-k</b>   When generating the auto-reply header or when extracting fields, keep the body as well.

       <b>-t</b>   Trust  the  sender  to  have  used a valid return address in his header.  This causes formail to
            select the <u>header</u> <u>sender</u> instead of the <u>envelope</u> <u>sender</u> for the reply.  This  option  should  be
            used  when generating auto-reply headers from news articles or when the sender of the message is
            expecting a reply.

       <b>-s</b>   The input will be split up into separate mail messages, and piped into a program one by  one  (a
            new program is started for every part).  <b>-s</b> has to be the last option specified, the first argu-<font color="#ffffff" class="whiteout">ment&nbsp;argument</font>
            ment following it is expected to be the name of a program, any other arguments  will  be  passed
            along  to  it.  If you omit the program, then formail will simply concatenate the split mails on
            stdout again.  See <b>FILENO</b>.

       <b>-n</b> <u>[maxprocs]</u>
            Tell formail not to wait for every program to finish before starting the next (causes splits  to
            be  processed  in parallel).  <u>Maxprocs</u> optionally specifies an upper limit on the number of con-<font color="#ffffff" class="whiteout">currently&nbsp;concurrently</font>
            currently running processes.

       <b>-e</b>   Do not require empty lines to be preceding the header of a  new  message  (i.e.,   the  messages
            could start on every line).

       <b>-d</b>   Tell  formail  that  the  messages  it is supposed to split need not be in strict mailbox format
            (i.e., allows you to split digests/articles or non-standard  mailbox  formats).   This  disables
            recognition of the <b>Content-Length:</b> field.

       <b>-l</b> <b>folder</b>
            Generate  a  log  summary in the same style as procmail.  This includes the entire "From " line,
            the Subject: header field, the folder, and the size of the message in bytes.  The mailstat  com-<font color="#ffffff" class="whiteout">mand&nbsp;command</font>
            mand can be used to summarize logs in this format.

       <b>-B</b>   Makes formail assume that it is splitting up a BABYL rmail file.

       <b>-m</b> <u>minfields</u>
            Allows  you  to  specify  the number of consecutive headerfields formail needs to find before it
            decides it found the start of a new message, it defaults to 2.

       <b>-q</b>   Tells formail to (still detect but) be quiet about write errors,  duplicate  messages  and  mis-<font color="#ffffff" class="whiteout">matched&nbsp;mismatched</font>
            matched  <b>Content-Length:</b>  fields.  This option is on by default, to make it display the messages
            use <b>-q-</b>.

       <b>-D</b> <u>maxlen</u> <u>idcache</u>
            Formail will detect if the Message-ID of the current message has  already  been  seen  using  an
            <u>idcache</u> file of approximately <u>maxlen</u> size.  If not splitting, it will return success if a dupli-<font color="#ffffff" class="whiteout">cate&nbsp;duplicate</font>
            cate has been found.  If splitting, it will not output duplicate messages.  If used in  conjunc-<font color="#ffffff" class="whiteout">tion&nbsp;conjunction</font>
            tion  with  <b>-r</b>, formail will look at the <u>mail</u> <u>address</u> of the envelope sender <u>instead</u> at the Mes-<font color="#ffffff" class="whiteout">sage-ID.&nbsp;Message-ID.</font>
            sage-ID.

       <b>-x</b> <u>headerfield</u>
            Extract the contents of this <u>headerfield</u> from the  header.   Line  continuations  will  be  left
            intact; if you want the value on a single line then you'll also need the <b>-c</b> option.

       <b>-X</b> <u>headerfield</u>
            Same as <b>-x</b>, but also preserves/includes the field name.

       <b>-a</b> <u>headerfield</u>
            Append a custom <u>headerfield</u> onto the header; but only if a similar field does not exist yet.  If
            you specify either one of the field names <b>Message-ID:</b> or <b>Resent-Message-ID:</b> with no  field  con-<font color="#ffffff" class="whiteout">tents,&nbsp;contents,</font>
            tents, then formail will generate a unique message-ID for you.

       <b>-A</b> <u>headerfield</u>
            Append a custom <u>headerfield</u> onto the header in any case.

       <b>-i</b> <u>headerfield</u>
            Same  as  <b>-A</b>, except that any existing similar fields are renamed by prepending an ``Old-'' pre-<font color="#ffffff" class="whiteout">fix.&nbsp;prefix.</font>
            fix.  If <u>headerfield</u> consists only of a field-name, it will not be appended.

       <b>-I</b> <u>headerfield</u>
            Same as <b>-i</b>, except that any existing similar fields are simply removed.  If <u>headerfield</u> consists
            only of a field-name, it effectively deletes the field.

       <b>-u</b> <u>headerfield</u>
            Make  the  first  occurrence of this field unique, and thus delete all subsequent occurrences of
            it.

       <b>-U</b> <u>headerfield</u>
            Make the last occurrence of this field unique, and thus delete all preceding occurrences of  it.

       <b>-R</b> <u>oldfield</u> <u>newfield</u>
            Renames all occurrences of the fieldname <u>oldfield</u> into <u>newfield</u>.

       <b>+</b><u>skip</u>
            Skip the first <u>skip</u> messages while splitting.

       <b>-</b><u>total</u>
            Output at most <u>total</u> messages while splitting.

<b>NOTES</b>
       When  renaming,  removing, or extracting fields, partial fieldnames may be used to specify all fields
       that start with the specified value.

       By default, when generating an auto-reply header procmail selects the envelope sender from the  input
       message.   This is correct for vacation messages and other automatic replies regarding the routing or
       delivery of the original message.  If the sender is expecting a reply or the reply is being generated
       in response to the contents of the original message then the -t option should be used.

       <b>RFC822</b>, the original standard governing the format of Internet mail messages, did not specify whether
       Resent header fields (those that begin with `Resent-', such as `Resent-From:') should  be  considered
       when generating a reply.  Since then, the recommended usage of the Resent headers has evolved to con-<font color="#ffffff" class="whiteout">sider&nbsp;consider</font>
       sider them as purely informational and not for use when generating a reply.  This has  been  codified
       in <b>RFC2822</b>, the new Internet Message Format standard, which states in part:

              Resent  fields  are  used to identify a message as having been reintroduced into the transport
              system by a user.  The purpose of using resent fields is to have the  message  appear  to  the
              final  recipient  as if it were sent directly by the original sender, with all of the original
              fields remaining the same....They MUST NOT be used in the  normal  processing  of  replies  or
              other such automatic actions on messages.

       While formail now ignores Resent headers when generating header replies, versions of formail prior to
       3.14 gave such headers a high precedence.  If the old behavior is needed for established applications
       it  can  be  specified  by  calling formail with the option `-a Resent-' in addition to the -r and -t
       options.  This usage is deprecated and should not be used in new applications.

<b>ENVIRONMENT</b>
       <b>FILENO</b>
            While splitting, formail assigns the message number currently being output to this variable.  By
            presetting  FILENO,  you  can  change the initial message number being used and the width of the
            zero-padded output.  If FILENO is unset it will default to 000.  If FILENO is non-empty and does
            not contain a number, FILENO generation is disabled.

<b>EXAMPLES</b>
       To split up a digest one usually uses:
              formail +1 -ds &gt;&gt;the_mailbox_of_your_choice
       or
              formail +1 -ds procmail

       To remove all Received: fields from the header:
              formail -I Received:

       To remove all fields except From: and Subject: from the header:
              formail -k -X From: -X Subject:

       To supersede the Reply-To: field in a header you could use:
              formail -i "Reply-To: foo@bar"

       To convert a non-standard mailbox file into a standard mailbox file you can use:
              formail -ds &lt;old_mailbox &gt;&gt;new_mailbox

       Or, if you have a very tolerant mailer:
              formail -a Date: -ds &lt;old_mailbox &gt;&gt;new_mailbox

       To extract the header from a message:
              formail -X ""
       or
              sed -e '/^$/ q'

       To extract the body from a message:
              formail -I ""
       or
              sed -e '1,/^$/ d'

<b>SEE</b> <b>ALSO</b>
       <a href="mail.1.html#//apple_ref/doc/man/1/mail"><b>mail</b>(1)</a>, <!-- a --><b>binmail</b>(1)<!-- /a -->, <!-- a --><b>sendmail</b>(8)<!-- /a -->, <a href="procmail.1.html#//apple_ref/doc/man/1/procmail"><b>procmail</b>(1)</a>, <a href="sed.1.html#//apple_ref/doc/man/1/sed"><b>sed</b>(1)</a>, <a href="sh.1.html#//apple_ref/doc/man/1/sh"><b>sh</b>(1)</a>, <b>RFC822</b>, <b>RFC2822</b>, <b>RFC1123</b>

<b>DIAGNOSTICS</b>
       Can't fork             Too many processes on this machine.

       Content-Length: field exceeds actual length by nnn bytes
                              The  Content-Length:  field  in  the header specified a length that was longer
                              than the actual body.  This causes this message to absorb a number  of  subse-<font color="#ffffff" class="whiteout">quent&nbsp;subsequent</font>
                              quent messages following it in the same mailbox.

       Couldn't write to stdout
                              The  program  that  formail was trying to pipe into didn't accept all the data
                              formail sent to it; this diagnostic can be suppressed by the <b>-q</b> option.

       Duplicate key found: x The Message-ID or sender x in this message was found in the idcache; this  di-<font color="#ffffff" class="whiteout">agnostic&nbsp;diagnostic</font>
                              agnostic can be suppressed by the <b>-q</b> option.

       Failed to execute "x"  Program not in path, or not executable.

       File table full        Too many open files on this machine.

       Invalid field-name: "x"
                              The  specified field-name "x" contains control characters, or cannot be a par-<font color="#ffffff" class="whiteout">tial&nbsp;partial</font>
                              tial field-name for this option.

<b>WARNINGS</b>
       You can save yourself and others a lot of grief if you try to avoid using this autoreply  feature  on
       mails  coming  through mailinglists.  Depending on the format of the incoming mail (which in turn de-<font color="#ffffff" class="whiteout">pends&nbsp;depends</font>
       pends on both the original sender's mail agent and the mailinglist setup)  formail  could  decide  to
       generate an autoreply header that replies to the list.

       In the tradition of UN*X utilities, formail will do exactly what you ask it to, even if it results in
       a non-<b>RFC822</b> compliant message.  In particular, formail will let you  generate  header  fields  whose
       name  ends  in  a space instead of a colon.  While this is correct for the leading `From ' line, that
       line is not a header field so much as the message separator for the mbox  mailbox  format.   Multiple
       occurrences  of  such a line or any other colonless header field will be considered by many mail pro-<font color="#ffffff" class="whiteout">grams,&nbsp;programs,</font>
       grams, including formail itself, as the beginning of a new message.  Others will consider the message
       to  be  corrupt.   Because of this, you should not use the <b>-i</b> option with the `From ' line as the re-<font color="#ffffff" class="whiteout">sulting&nbsp;resulting</font>
       sulting renamed line, `Old-From ', will probably not do what you want it to.  If you want to save the
       original `From ' line, rename it with the <b>-R</b> option to a legal header field such as `X-From_:'.

<b>BUGS</b>
       When  formail  has  to generate a leading `From ' line it normally will contain the current date.  If
       formail is given the option `-a Date:', it will use the date from the `Date:' field in the header (if
       present).   However,  since  formail copies it verbatim, the format will differ from that expected by
       most mail readers.

       If formail is instructed to delete or rename the leading `From ' line, it will not automatically  re-<font color="#ffffff" class="whiteout">generate&nbsp;regenerate</font>
       generate it as usual.  To force formail to regenerate it in this case, include <b>-a</b> <b>'From</b> <b>'</b>.

       If  formail is not called as the first program in a pipe and it is told to split up the input in sev-<font color="#ffffff" class="whiteout">eral&nbsp;several</font>
       eral messages, then formail will not terminate until the program it receives the  input  from  closes
       its output or terminates itself.

       If  formail  is  instructed to generate an autoreply mail, it will <b>never</b> put more than one address in
       the `To:' field.

<b>MISCELLANEOUS</b>
       Formail is eight-bit clean.

       When formail has to determine the sender's address, every <b>RFC822</b> conforming mail address is  allowed.
       Formail  will  always  strip  down  the  address to its minimal form (deleting excessive comments and
       whitespace).

       The regular expression that is used to find `real' postmarks is:
              "\n\nFrom [\t ]*[^\t\n ]+[\t ]+[^\n\t ]"

       If a <b>Content-Length:</b> field is found in a header, formail will copy the number of specified  bytes  in
       the  body verbatim before resuming the regular scanning for message boundaries (except when splitting
       digests or Berkeley mailbox format is assumed).

       Any header lines immediately following the leading `From ' line that start with `&gt;From ' are  consid-<font color="#ffffff" class="whiteout">ered&nbsp;considered</font>
       ered  to  be  a  continuation of the `From ' line.  If instructed to rename the `From ' line, formail
       will change each leading `&gt;' into a space, thereby transforming those lines into normal  <b>RFC822</b>  con-<font color="#ffffff" class="whiteout">tinuations.&nbsp;continuations.</font>
       tinuations.

<b>NOTES</b>
       Calling up formail with the -h or -? options will cause it to display a command-line help page.

<b>SOURCE</b>
       This  program  is  part of the <u>procmail</u> <u>mail-processing-package</u> (v3.22) available at <a href="http://www.procmail.org/">http://www.proc-</a>
       <a href="http://www.procmail.org/">mail.org/</a> or ftp.procmail.org in <b>pub/procmail/</b>.

<b>MAILINGLIST</b>
       There exists a mailinglist for questions relating to any program in the procmail package:
              &lt;procmail-users@procmail.org&gt;
                     for submitting questions/answers.
              &lt;procmail-users-request@procmail.org&gt;
                     for subscription requests.

       If you would like to stay informed about new versions and official patches send  a  subscription  re-
       quest to
              procmail-announce-request@procmail.org
       (this is a readonly list).

<b>AUTHORS</b>
       Stephen R. van den Berg
              &lt;srb@cuci.nl&gt;
       Philip A. Guenther
              &lt;guenther@sendmail.com&gt;



BuGless                                          2003/10/14                                       FORMAIL(1)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man1/formail.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man1/formail.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man1/formail.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
