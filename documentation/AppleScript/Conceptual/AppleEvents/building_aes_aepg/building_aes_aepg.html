<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Apple Events Programming Guide: Building an Apple Event</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Building an Apple Event"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001449-CH203" title="Building an Apple Event"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../ScriptingAutomation/index.html#//apple_ref/doc/uid/TP30000440-TP40005948" target="_top">Scripting &amp; Automation</a> &gt; <a href="../../../../ScriptingAutomation/Carbon-date.html#//apple_ref/doc/uid/TP30000440-TP40005948-TP30000494" target="_top">Carbon</a> &gt; <a href="../intro_aepg/intro_aepg.html#//apple_ref/doc/uid/TP40001449-CH201-DontLinkElementID_65">Apple Events Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../about_aes_aepg/about_aes_aepg.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../dispatch_aes_aepg/dispatch_aes_aepg.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40001449-CH203-BABDAJGB" title="Building an Apple Event"></a><h1>Building an Apple Event</h1><p><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_113"></a>This chapter provides an overview of Apple event data structures and describes how to build an Apple event.</p><p>An Apple event is capable of describing complex commands and the data necessary to carry them out. For example, an Apple event might request that a database application return data from records that meet certain criteria. An event sent by the Mac OS might request that the receiving application print a specified list of documents. The Apple Event Manager provides a relatively small number of Apple event data structures that together can be used to represent commands of great complexity.</p><p>Your application typically works with Apple events and the data they contain when:</p><ul class="ul"><li class="li"><p>It receives an Apple event and must extract information to figure out what to do with the event.</p></li><li class="li"><p>In response to a received Apple event, it must add information to a reply event to return to the sender.</p></li><li class="li"><p>It creates an Apple event from scratch for internal communication or to request data or services from another application.</p></li></ul><p>Working effectively with Apple events in these cases requires some knowledge of the data structures and organization of an Apple event, as well as familiarity with the Apple Event Manager functions you use to create Apple events and manipulate their data.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="building_aes_aepg.html#//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_12">About Apple Event Data Structures</a>
				
			<br/>
			
        
			
			
				<a href="building_aes_aepg.html#//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_13">Apple Event Building Blocks</a>
				
			<br/>
			
        
			
			
				<a href="building_aes_aepg.html#//apple_ref/doc/uid/TP40001449-CH203-CEGDCFEJ">Two Approaches to Creating an Apple Event</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_12" title="About Apple Event Data Structures"></a><h2>About Apple Event Data Structures</h2><p><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_114"></a>Understanding a few key concepts can help things go smoothly in creating an Apple event or working with its data:</p><ul class="ul"><li class="li"><p>Each piece of information in an Apple event is associated with a four-character code (or in some cases, two such codes).</p></li><li class="li"><p>A descriptor is a data structure that stores data and an accompanying four-character code. All the information you work with in an Apple event is stored in descriptors and lists of descriptors.</p></li><li class="li"><p>The content of an Apple event is conceptually divided into two kinds of items, both constructed from descriptors:</p><ul class="nested"><li class="nested li"><p>Attributes identify characteristics of the task to be performed by the Apple event.</p></li><li class="nested li"><p>Parameters provide additional data to be used in performing the task.</p></li></ul></li><li class="li"><p>To create an Apple event, extract data from an event, or add data to an event, an application calls Apple Event Manager functions and passes the appropriate four-character codes and other information.</p></li><li class="li"><p>To operate effectively with Apple events, you just need to find the right function for the task at hand.</p></li></ul><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_13" title="Apple Event Building Blocks"></a><h2>Apple Event Building Blocks</h2><p>This section describes the constants and data structures used to construct an Apple event.</p><a name="//apple_ref/doc/uid/TP40001449-CH203-CEGGDFEA" title="Apple Event Constants"></a><h3>Apple Event Constants</h3><p><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_115"></a><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_116"></a><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_117"></a>The Apple Event Manager uses four-character codes (also referred to as Apple event codes) to identify the data within an Apple event. A four-character code is just four bytes of data that can be expressed as a string of four characters in the Mac OS Roman encoding. For example, <code>'capp'</code> is the four-character code that specifies an application.</p><p>The Apple Event Manager defines four-character-code constants for many common commands (or verbs) and data objects (or nouns) that can be used in Apple events. These constants are defined primarily in the header files <code>AppleEvents.h</code> and <code>AERegistry.h</code> in the AE framework. They are documented in <em><a href="../../../../Carbon/Reference/Apple_Event_Manager/index.html#//apple_ref/doc/uid/TP30000134" target="_top">Apple Event Manager Reference</a></em>. A subset of these constants is described in <span class="content_text"><a href="../appendix2_aepg/appendix2_aepg.html#//apple_ref/doc/uid/TP40001449-CH212-BABDAJGB">“Selected Apple Event Constants”</a></span> in this document.</p><p><span class="content_text"><a href="building_aes_aepg.html#//apple_ref/doc/uid/TP40001449-CH203-BABEHGEE">Listing 2-1</a></span> shows some constants from <code>AERegistry.h</code>. Each constant definition includes a comment showing the actual numeric value as a hex number.</p><a name="//apple_ref/doc/uid/TP40001449-CH203-BABEHGEE" title="Listing 2-1Some four-character codes from AERegistry.h"></a><p class="codesample"><strong>Listing 2-1&nbsp;&nbsp;</strong>Some four-character codes from AERegistry.h</p><div class="codesample"><table><tr><td scope="row"><pre>enum {<span></span></pre></td></tr><tr><td scope="row"><pre>  cApplication                  = 'capp', /*  0x63617070  */<span></span></pre></td></tr><tr><td scope="row"><pre>  cArc                          = 'carc', /*  0x63617263  */<span></span></pre></td></tr><tr><td scope="row"><pre>  cBoolean                      = 'bool', /*  0x626f6f6c  */<span></span></pre></td></tr><tr><td scope="row"><pre>  cCell                         = 'ccel', /*  0x6363656c  */<span></span></pre></td></tr><tr><td scope="row"><pre>  cChar                         = 'cha ', /*  0x63686120  */<span></span></pre></td></tr><tr><td scope="row"><pre>  cDocument                     = 'docu', /*  0x646f6375  */<span></span></pre></td></tr><tr><td scope="row"><pre>  cGraphicLine                  = 'glin', /*  0x676c696e  */<span></span></pre></td></tr><tr><td scope="row"><pre>...<span></span></pre></td></tr><tr><td scope="row"><pre>};<span></span></pre></td></tr></table></div><p>For the Apple event support in your application, you should use existing constants wherever they make sense, rather than defining new constants. For example, if your application supports an Apple event to get the name of a document, you can use the constant <code>cDocument</code> to denote a document.</p><p>Apple reserves all values that consist entirely of lowercase letters and spaces. You can generally avoid conflicts with Apple-defined constants by including at least one uppercase letter when defining a four-character code.<a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_118"></a></p><a name="//apple_ref/doc/uid/TP40001449-CH203-SW1" title="Event Class and Event ID"></a><h3>Event Class and Event ID</h3><p><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_119"></a><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_120"></a>An Apple event is uniquely identified by its <strong>event class</strong> and <strong>event ID</strong> attributes, each of which is an arbitrary four-character code (described in <span class="content_text"><a href="building_aes_aepg.html#//apple_ref/doc/uid/TP40001449-CH203-CEGGDFEA">“Apple Event Constants”</a></span>). The Apple Event Manager uses these values in dispatching Apple events to code in your application (described in <span class="content_text"><a href="../dispatch_aes_aepg/dispatch_aes_aepg.html#//apple_ref/doc/uid/TP40001449-CH204-BABDAJGB">“Apple Event Dispatching”</a></span>).</p><p>Apple defines event class and event ID values for standard Apple events, including those that it sends. For example, a <code>delete</code> Apple event has an event class value of <code>'core'</code> (represented by the constant <code>kAECoreSuite</code>) and an event ID value of <code>'delo'</code> (<code>kAEDelete</code>). For examples and descriptions of Apple-defined event class and event ID values, see <span class="content_text"><a href="../appendix2_aepg/appendix2_aepg.html#//apple_ref/doc/uid/TP40001449-CH212-SW2">“Event Class Constants,”</a></span> <span class="content_text"><a href="../appendix2_aepg/appendix2_aepg.html#//apple_ref/doc/uid/TP40001449-CH212-CHDDDDFD">“Event ID Constants for Apple Events Sent by the Mac OS,”</a></span> and <span class="content_text"><a href="../appendix2_aepg/appendix2_aepg.html#//apple_ref/doc/uid/TP40001449-CH212-SW3">“Event ID Constants for Standard AppleScript Commands.”</a></span></p><p>You define the event class and event ID values for application-specific Apple events your application supports. While these values are arbitrary, you should follow the simple guidelines described in <span class="content_text"><a href="building_aes_aepg.html#//apple_ref/doc/uid/TP40001449-CH203-CEGGDFEA">“Apple Event Constants”</a></span> in choosing values.</p><p>You can use a common event class for multiple Apple events as a way to group related events that your application supports. For example, many Apple-defined Apple events share a common event class. This can be useful in organizing the name space for your Apple events and may simplify your coding, but it doesn’t result in any special treatment by the Apple Event Manager.</p><p>If you want other applications to be able to send Apple events to your application, you must publish event class and event ID values for those events. You should also describe the contents your application expects to find in each type of Apple event.</p><p>Similarly, if you want to send Apple events to other applications, you are dependent on those applications to provide the event class, event ID, and any other information you need to construct an Apple event the application can understand. One exception is that most applications, including yours, should be able to handle the Apple events described in <span class="content_text"><a href="../responding_aepg/responding_aepg.html#//apple_ref/doc/uid/TP40001449-CH206-CEGFFJBB">“Common Apple Events Sent by the Mac OS.”</a></span> So, for example, you might construct a <code>quit</code> Apple event that targets almost any Mac OS X application, and expect the application to handle it.</p><a name="//apple_ref/doc/uid/TP40001449-CH203-BEJJGABC" title="Descriptors, Descriptor Lists, and Apple Events"></a><h3>Descriptors, Descriptor Lists, and Apple Events</h3><p>Descriptors and descriptor lists are the basic structural elements used in Apple events. A <strong>descriptor</strong><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_121"></a> stores data and an accompanying descriptor type to form the basic building block of all Apple Events. The <strong>descriptor type</strong><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_122"></a> is a four-character code that identifies the type of data associated with the descriptor. <span class="content_text"><a href="../appendix2_aepg/appendix2_aepg.html#//apple_ref/doc/uid/TP40001449-CH212-CEGDFICF">Table B-4</a></span> lists constants for some of the main descriptor types—for a complete list, see <em><a href="../../../../Carbon/Reference/Apple_Event_Manager/index.html#//apple_ref/doc/uid/TP30000134" target="_top">Apple Event Manager Reference</a></em>. <span class="content_text">Figure 2-1</span> shows the format of a descriptor.</p><br/><div><a name="//apple_ref/doc/uid/TP40001449-CH203-BEJICJHE" title="Figure 2-1A descriptor"></a><p><strong>Figure 2-1&nbsp;&nbsp;</strong>A descriptor</p><img src = "../art/descriptor.gif" alt = "A descriptor" width="181" height="58"></div><br/><p>The data field of a descriptor is opaque—you should not attempt to access it directly. <span class="content_text"><a href="../appendix1_aepg/appendix1_aepg.html#//apple_ref/doc/uid/TP40001449-CH211-CEGGJADB">Table A-1</a></span> lists functions provided by the Apple Event Manager for accessing the data in a descriptor (and related data types).</p><p><span class="content_text">Figure 2-2</span> shows a descriptor with a descriptor type of <code>typeUTF8Text</code>, which specifies that the descriptor’s data is text in UTF-8 encoding—in this case, the text is “Summary of Sales”.</p><br/><div><a name="//apple_ref/doc/uid/TP40001449-CH203-CEGEAIEE" title="Figure 2-2A descriptor whose data is a Unicode text string"></a><p><strong>Figure 2-2&nbsp;&nbsp;</strong>A descriptor whose data is a Unicode text string</p><img src = "../art/data_unterminated_string.gif" alt = "A descriptor whose data is a Unicode text string" width="223" height="55"></div><br/><p>A <strong>keyword</strong><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_123"></a> is a four-character code used by the Apple Event Manager to identify a specific descriptor within an Apple event. A <strong>keyword-specified descriptor</strong><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_124"></a><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_125"></a> combines a keyword with a descriptor. This is the basic type used to specify attributes and parameters, which are described in detail in <span class="content_text"><a href="building_aes_aepg.html#//apple_ref/doc/uid/TP40001449-CH203-CEGGBBBD">“Apple Event Attributes and Parameters.”</a></span> <span class="content_text">Figure 2-3</span> shows the format of a keyword-specified descriptor.</p><br/><div><a name="//apple_ref/doc/uid/TP40001449-CH203-BEJDGDBJ" title="Figure 2-3A keyword-specified descriptor"></a><p><strong>Figure 2-3&nbsp;&nbsp;</strong>A keyword-specified descriptor</p><img src = "../art/keyword_specified.gif" alt = "A keyword-specified descriptor" width="172" height="81"></div><br/><p>An <strong>address descriptor</strong><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_126"></a><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_127"></a> is a descriptor that specifies a target address for an Apple event—that is, it specifies the application or other process to send the event to. The descriptor type can be specified by one of the constants shown in <span class="content_text"><a href="../appendix2_aepg/appendix2_aepg.html#//apple_ref/doc/uid/TP40001449-CH212-CEGBIEDH">Table B-5</a></span>.</p><p>A <strong>descriptor list</strong><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_128"></a> is a descriptor whose data consists of a list of zero or more descriptors (it can be an empty list). A descriptor list can contain other lists, which allows for the construction of complex descriptors, and hence complex Apple events. <span class="content_text">Figure 2-4</span> shows the format of a descriptor list.</p><br/><div><a name="//apple_ref/doc/uid/TP40001449-CH203-BEJIJAHC" title="Figure 2-4A descriptor list"></a><p><strong>Figure 2-4&nbsp;&nbsp;</strong>A descriptor list</p><img src = "../art/descriptorlist_new.gif" alt = "A descriptor list" width="172" height="118"></div><br/><p>An <strong>Apple event record</strong><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_129"></a> is a descriptor list whose data is a set of keyword-specified descriptors that describe Apple event parameters.</p><p>An <strong>Apple event</strong><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_130"></a> is an Apple event record whose contents are conceptually divided into two parts, one for attributes and one for parameters, as shown in <span class="content_text"><a href="building_aes_aepg.html#//apple_ref/doc/uid/TP40001449-CH203-CEGHIDFJ">Figure 2-6</a></span>.</p><p><span class="content_text">Figure 2-5</span> shows the inheritance for descriptors and related data structures, with the corresponding data types shown in parentheses.</p><br/><div><a name="//apple_ref/doc/uid/TP40001449-CH203-CEGEHHDF" title="Figure 2-5Hierarchy of Apple event data structures"></a><p><strong>Figure 2-5&nbsp;&nbsp;</strong>Hierarchy of Apple event data structures</p><img src = "../art/ae_stack.gif" alt = "Hierarchy of Apple event data structures" width="246" height="206"></div><br/><p>An Apple Event Manager function that operates on one of these data structures can also operate on any type that inherits from it. For example, Apple events inherit from Apple event records, which inherit from descriptor lists. As a result, you can pass an Apple event to any Apple Event Manager function that expects an Apple event record or a descriptor list. Similarly, you can pass Apple events and Apple event records, as well as descriptor lists and descriptors, to any Apple Event Manager function that expects a descriptor. See <span class="content_text"><a href="../appendix1_aepg/appendix1_aepg.html#//apple_ref/doc/uid/TP40001449-CH211-CEGGJADB">Table A-1</a></span> for a list of functions for working with the various data types.</p><a name="//apple_ref/doc/uid/TP40001449-CH203-CEGGBBBD" title="Apple Event Attributes and Parameters"></a><h3>Apple Event Attributes and Parameters</h3><p><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_131"></a>Every Apple event consists of attributes and, often, parameters, as shown in <span class="content_text">Figure 2-6</span>. Taken together, the attributes of an Apple event denote the task to be performed, while the parameters provide additional information to be used in performing the task.</p><br/><div><a name="//apple_ref/doc/uid/TP40001449-CH203-CEGHIDFJ" title="Figure 2-6An Apple event, with attributes and parameters"></a><p><strong>Figure 2-6&nbsp;&nbsp;</strong>An Apple event, with attributes and parameters</p><img src = "../art/apple_event.gif" alt = "An Apple event, with attributes and parameters" width="165" height="262"></div><br/><p>You use Apple Event Manager functions to create an Apple event, to add attributes or parameters to an Apple event, and to extract and examine the attributes or parameters from an Apple event.</p><a name="//apple_ref/doc/uid/TP40001449-CH203-CEGECJBG" title="Apple Event Attributes"></a><h4>Apple Event Attributes</h4><p>An <strong>Apple event attribute</strong><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_132"></a> is a keyword-specified descriptor that identifies a characteristic of an Apple event. For example, every Apple event must include attributes for event class, event ID, and target address:</p><ul class="spaceabove"><li class="li"><p>The event class<a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_133"></a> and event ID <a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_134"></a>attributes provide a pair of arbitrary four-character codes that together uniquely identify an Apple event. For more information, see <span class="content_text"><a href="building_aes_aepg.html#//apple_ref/doc/uid/TP40001449-CH203-SW1">“Event Class and Event ID.”</a></span></p></li><li class="li"><p>The <strong>target address attribute</strong><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_135"></a> specifies the process to send the Apple event to.</p></li></ul><p>Apple events can include other kinds of attributes—see <span class="content_text"><a href="../appendix2_aepg/appendix2_aepg.html#//apple_ref/doc/uid/TP40001449-CH212-CEGHCEGG">Table B-6</a></span> for a list of keyword constants for Apple event attributes.</p><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_14" title="Apple Event Parameters"></a><h4>Apple Event Parameters</h4><p>An <strong>Apple event parameter</strong><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_136"></a> is a keyword-specified descriptor that contains additional data for the command. Keywords for common Apple event parameters are shown in <span class="content_text"><a href="../appendix2_aepg/appendix2_aepg.html#//apple_ref/doc/uid/TP40001449-CH212-CEGDDBJG">Table B-7</a></span>.</p><p>As with attributes, there are various kinds of Apple event parameters. A <strong>direct parameter</strong><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_137"></a> usually specifies the data to be acted upon by the target application. For example, <span class="content_text">Figure 2-7</span> shows the main Apple event attributes and the direct parameter for an <code>open documents</code> event that targets the AppleWorks application. The direct parameter specifies a descriptor list containing file aliases to the documents to open. An Apple event has at most one direct parameter.</p><br/><div><a name="//apple_ref/doc/uid/TP40001449-CH203-CEGIHAII" title="Figure 2-7Main attributes and direct parameter of an open documents event"></a><p><strong>Figure 2-7&nbsp;&nbsp;</strong>Main attributes and direct parameter of an open documents event</p><img src = "../art/major_attributes.gif" alt = "Main attributes and direct parameter of an open documents event" width="488" height="322"></div><br/><p>Apple event parameters can contain standard data types, such as text strings, integers of various lengths, Boolean values, and others, listed in <span class="content_text"><a href="../appendix2_aepg/appendix2_aepg.html#//apple_ref/doc/uid/TP40001449-CH212-CEGDFICF">Table B-4</a></span>.</p><p>An Apple event can include other parameters, in addition to the direct parameter. For example, an Apple event that represents an arithmetic operation might contain a direct parameter that specifies a pair of values to operate on, as well as an additional parameter that specifies the operator. A reply Apple event may contain an error number parameter and an error string parameter, added by your application when an error occurs, as described in <span class="content_text"><a href="../responding_aepg/responding_aepg.html#//apple_ref/doc/uid/TP40001449-CH206-CEGFGBBG">“Returning Error Information.”</a></span></p><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_15" title="Accessing Attributes and Parameters"></a><h4>Accessing Attributes and Parameters</h4><p><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_138"></a><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_139"></a>Your application cannot examine the attributes and parameters of an assembled Apple event directly. Instead, it calls Apple Event Manager functions such as <code>AEGetAttributeDesc</code> and <code>AEGetParamDesc</code> to request an attribute or parameter by keyword. Because attributes and parameters are descriptors, you can also operate on them by index, using the functions <code>AEGetNthDesc</code> or <code>AEGetNthPtr</code>. However, that only makes sense if, for example, you are iterating over every descriptor—you should not assume that the parameters or attributes in an Apple event are in any particular order.</p><p>Apple event parameters often contain descriptions of Apple event objects within the target application. For example, a <code>get data</code> Apple event contains a parameter that describes the Apple event object that contains the requested data. Thus, an event might request, for example, the first paragraph of text from a named document. Apple event objects are described in <span class="content_text"><a href="http://developer.apple.com/documentation/mac/IAC/IAC-231.html#HEADING231-0" target="_top">“Resolving and Creating Object Specifier Records”</a></span> in <span class="content_text"><a href="http://developer.apple.com/documentation/mac/IAC/IAC-2.html" target="_top">Inside Macintosh: Interapplication Communication</a></span>.</p><p>For more information on accessing attributes and parameters in an Apple event, see <span class="content_text"><a href="../data_in_ae_aepg/data_in_ae_aepg.html#//apple_ref/doc/uid/TP40001582-BABDAJGB">“Working With the Data in an Apple Event.”</a></span></p><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_16" title="Optional Parameters"></a><h4>Optional Parameters</h4><p>An Apple event may be defined so that it has optional parameters. An <strong>optional parameter</strong><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_140"></a> is one that the sending application may or may not include. A target application must be prepared to handle the event whether or not the optional parameter is present. However, it can choose to ignore an optional parameter, even if present. This allows optional parameters to be added to an Apple event retroactively, without breaking existing code.</p><p>If an optional parameter is not present, or if your application chooses to ignore it, you should provide the default behavior for the Apple event. To determine if an optional parameter is present, you call a function such as <code>AEGetParamDesc</code>, specifying the keyword for the parameter. If the function returns successfully, you can extract information from the parameter and respond accordingly. If the function returns an error, you can assume the parameter is not present and provide the default behavior.<a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_141"></a></p><a name="//apple_ref/doc/uid/TP40001449-CH203-CEGDCFEJ" title="Two Approaches to Creating an Apple Event"></a><h2>Two Approaches to Creating an Apple Event</h2><p><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_142"></a>How do you put together the data structures described in this chapter to create an Apple event? The Apple Event Manager provides functions that lend themselves to two main approaches, which you can combine as needed:</p><ul class="ul"><li class="li"><p>You can create an Apple event with one call, passing all the information needed for a complete Apple event.</p><p>Related functions allow you to create a complex descriptor, attribute, or parameter and add it to an existing Apple event in one step.</p></li><li class="li"><p>You can create an Apple event sequentially, by first creating a potentially incomplete event, then adding information to it with subsequent calls.</p><p>With this approach, you build descriptors into more complex data structures from the bottom up.</p></li></ul><p>In either case, your application relies on the Apple Event Manager to construct Apple event data structures based on the arguments you pass.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_50" title="Note"></a><p><strong>Note:</strong>&nbsp;There is a third way, not shown in this document, to create Apple event records and Apple event descriptors using stream-oriented calling conventions. The stream APIs are documented in <em><a href="../../../../Carbon/Reference/Apple_Event_Manager/index.html#//apple_ref/doc/uid/TP30000134" target="_top">Apple Event Manager Reference</a></em>, while Technical Note 2046 <span class="content_text"><a href="http://developer.apple.com/technotes/tn/tn2046.html" target="_top">AEStream and Friends</a></span> provides conceptual overview and examples. You can use the stream functions independently, or combine them with the other mechanisms.</p></div><a name="//apple_ref/doc/uid/TP40001449-CH203-CEGCCIBD" title="Creating an Apple Event in One Step"></a><h3>Creating an Apple Event in One Step</h3><p><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_143"></a>You can call the <code>AEBuildAppleEvent</code><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_144"></a>function to create an Apple event in one step. To do so, you pass event class, event ID, and other information that is used to create the Apple event’s attributes. The <code>AEBuildAppleEvent</code> function includes parameters for specifying the target address—you don’t have to separately create an address descriptor. You may need to prepare data you’ll pass to <code>AEBuildAppleEvent</code>—for example, you may need to create aliases to files you will insert into the Apple event as a descriptor list.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_51" title="Note"></a><p><strong>Note:</strong>&nbsp;In this discussion, the word “parameter” is overloaded. When you call <code>AEBuildAppleEvent</code>, you pass information in <em>function parameters</em> to specify how to create <em>Apple event parameters</em> (and attributes), which are just Apple event data structures.</p></div><p>In addition, you provide a specially formatted string, similar to the string you might pass to a <code>printf</code> function, along with parameters that specify the data that corresponds to items in the format string. As a result, <code>AEBuildAppleEvent</code> can also create the parameters for your Apple event, resulting in a full-fledged Apple event.</p><p>The Apple Event Manager also provides the <code>AEBuildDesc</code> function as a one-step mechanism for adding potentially complex descriptors to an existing Apple event, and the <code>AEBuildParameters</code> function for adding parameters or attributes.</p><p>The one-step functions are most useful in situations where your application knows in advance all the information needed to create an Apple event or other data structure. They also make it easier to do parameterized substitution of values. For an example of this approach, see <span class="content_text"><a href="../create_send_aepg/create_send_aepg.html#//apple_ref/doc/uid/TP40001449-CH209-BABHDIJA">“Creating an Apple Event With AEBuildAppleEvent.”</a></span><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_145"></a></p><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_17" title="Creating an Apple Event Sequentially"></a><h3>Creating an Apple Event Sequentially</h3><p><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_146"></a>You can create the basic structure for an Apple event by calling the <code>AECreateAppleEvent</code><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_147"></a> function. You pass information specifying event class, event ID, target address, return ID, and transaction ID; the function creates an Apple event containing the corresponding attributes. However, before you can call <code>AECreateAppleEvent</code>, you have to create a target address descriptor to pass to it, using a function such as <code>AECreateDesc</code><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_148"></a>.</p><p>After calling <code>AECreateAppleEvent</code>, the resulting Apple event contains attributes for the event but no parameters. To add parameters to the event, you can use the <code>AEBuildDesc</code> and <code>AEBuildParameters</code> functions described in the previous section, or you can continue to work sequentially. For example, if the direct object of the event you are creating is a list of file aliases, you could create it sequentially by performing the following steps:</p><ol class="ol"><li class="li"><p>Call <code>AECreateDesc</code> once for each file alias to create a descriptor for it.</p></li><li class="li"><p>Call <code>AECreateList</code> to create a descriptor list.</p></li><li class="li"><p>Call <code>AEPutDesc</code><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_149"></a> once for each descriptor to add it to the descriptor list.</p></li><li class="li"><p>Call <code>AEPutParamDesc</code><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_150"></a> to add the descriptor list to the Apple event as a parameter.</p></li></ol><p>This sequential approach is most useful for creating simple Apple events, or in situations where your application must factor the creation of an Apple event across several layers of code—for example, where you create an event, then pass it to various subsystems to add data to it.</p><p>For an example of how to create an Apple event step by step, see <span class="content_text"><a href="../create_send_aepg/create_send_aepg.html#//apple_ref/doc/uid/TP40001449-CH209-BABJCGDJ">“Creating an Apple Event With AECreateAppleEvent.”</a></span><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_151"></a></p><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_18" title="The Completed Apple Event"></a><h3>The Completed Apple Event</h3><p><span class="content_text">Figure 2-8</span> shows the main data structures of a complete Apple event, containing a list of keyword-specified descriptors that specify the attributes and parameters of an <code>open documents</code> Apple event. Although this is an event sent to your application by the Mac OS, events you create have a similar structure.</p><p>The figure includes attributes for the event class, event ID, and target address. It also shows the direct parameter—a keyword-specified descriptor with the keyword <code>keyDirectObject</code>. The entire figure corresponds to the <code>open documents</code> event shown in <span class="content_text"><a href="building_aes_aepg.html#//apple_ref/doc/uid/TP40001449-CH203-CEGIHAII">Figure 2-7</a></span><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_152"></a>.</p><br/><div><a name="//apple_ref/doc/uid/TP40001449-CH203-CEGHJIGH" title="Figure 2-8Structure of an open documents Apple event"></a><p><strong>Figure 2-8&nbsp;&nbsp;</strong>Structure of an open documents Apple event</p><a name="//apple_ref/doc/uid/TP40001449-CH203-DontLinkElementID_153"></a><img src = "../art/open_documents_event.gif" alt = "Structure of an open documents Apple event" width="294" height="674"></div><br/>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../about_aes_aepg/about_aes_aepg.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../dispatch_aes_aepg/dispatch_aes_aepg.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2005, 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-10-31<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleScript/Conceptual/AppleEvents/building_aes_aepg/building_aes_aepg.html%3Fid%3DTP40001449-1.5&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleScript/Conceptual/AppleEvents/building_aes_aepg/building_aes_aepg.html%3Fid%3DTP40001449-1.5&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleScript/Conceptual/AppleEvents/building_aes_aepg/building_aes_aepg.html%3Fid%3DTP40001449-1.5&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>