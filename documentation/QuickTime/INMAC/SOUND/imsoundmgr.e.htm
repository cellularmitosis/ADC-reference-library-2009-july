<!-- legacy work start --><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"        "http://www.w3.org/TR/html4/loose.dtd"><!-- legacy work end --><HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><TITLE> Releasing Sound Channels (deprecated)</title><!-- legacy work start -->        <META NAME="Generator" CONTENT="manual">        <META http-equiv="content-type" CONTENT="text/html;charset=utf-8">        <META NAME = "Copyright" CONTENT="Copyright 2007 Apple Inc. All Rights Reserved.">        <META NAME="IndexTitle" CONTENT="Sound Input Manager (Not Recommended)">        <meta name="xcode-display" content="render">        <LINK REL="stylesheet" TYPE="text/css" HREF="../../../Resources/CSS/frameset_styles.css"> <!-- before submitting, globally replace ".." with "developer.apple.com" -->        <script type="text/javascript" language="JavaScript" src="../../../Resources/JavaScript/page.js"></script><!-- legacy work end --></HEAD><BODY BGCOLOR="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- path goes here --><!-- QTnavbar start --><P><I>Inside Macintosh: Sound</I><P>| <A target="doc" HREF="imsoundmgr.d.htm">Previous</A> | <A target="doc" HREF="imsoundmgr.1.htm">Chapter contents</A> | <A target="doc" HREF="imsoundmgr.htm">Chapter top</A> | <A target="doc" HREF="imsoundmgr.b.htm">Section top</A> | <A target="doc" HREF="imsoundmgr.f.htm">Next</a> | <!-- QTnavbar end --><!-- legacy work start --><script type="text/javascript"> placeWatermark()</script><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox" style="position: relative;"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b><i>Sound Input Manager</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="http://developer.apple.com/referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div><!-- legacy work end --><H1 CLASS="H3.Heading3"><A NAME="pgfId=3366"> </A>Releasing Sound Channels<A NAME="marker=702"> </A></H1><P CLASS="T0.Text0"><A NAME="pgfId=3367"> </A>To dispose of a sound channel that you have allocated with <TT CLASS="cv">SndNewChannel</TT>, use the <TT CLASS="cv">SndDisposeChannel</TT> function. <TT CLASS="cv">SndDisposeChannel</TT> requires two parameters, a pointer to the channel that is to be disposed and a Boolean value that indicates whether the channel should be flushed before disposal. Here's an example:<A NAME="marker=1283"> </A></P><CODE CLASS="Cv.Code"><A NAME="pgfId=9707"> </A>myErr := SndDisposeChannel(mySndChan, TRUE);<BR></CODE><P CLASS="T1.Text1"><A NAME="pgfId=3369"> </A>Because the second parameter is <TT CLASS="cv">TRUE</TT>, the Sound Manager sends both a <TT CLASS="cv">flushCmd</TT> command and a <TT CLASS="cv">quietCmd</TT> command to the sound channel (using <TT CLASS="cv">SndDoImmediate</TT>). This removes all commands from the sound channel and stops any sound already in progress. Then the Sound Manager disposes of the channel.<A NAME="marker=1286"> </A><A NAME="marker=1287"> </A></P><P CLASS="T1.Text1"><A NAME="pgfId=2249"> </A>If the second parameter is <TT CLASS="cv">FALSE</TT>, the Sound Manager simply queues a <TT CLASS="cv">quietCmd</TT> command (using <TT CLASS="cv">SndDoCommand</TT>) and waits until <TT CLASS="cv">quietCmd</TT> is received by the channel before disposing of the channel. In this case, the <TT CLASS="cv">SndDisposeChannel</TT> function does not return until the channel has finished processing commands and the queue is empty.</P><P CLASS="W.Warning"><A NAME="pgfId=2320"> </A><A NAME="41791"> </A>If you dispose of a channel currently playing from disk, then your completion routine will still execute, but will receive a pointer to a sound channel that no longer exists. Thus, you should stop a play from disk before disposing of a channel. See <A target="doc" HREF="imsoundmgr.21.htm#20113" CLASS="XRef">&quot;Managing an Asynchronous Play From Disk&quot;</A> for more information on completion routines. </P><P CLASS="T1.Text1"><A NAME="pgfId=2250"> </A>Although the <TT CLASS="cv">SndDisposeChannel</TT> function always releases memory reserved for sound commands, <TT CLASS="cv">SndDisposeChannel</TT> cannot release memory associated with a sound channel record if you have allocated that memory yourself. For example, if you use the <TT CLASS="cv">MyCreateSndChannel</TT> function defined in <A target="doc" HREF="imsoundmgr.c.htm#18564" CLASS="XRef">Listing 1-11</A> to create a sound channel, you must dispose first of the sound channel and then of the memory occupied by the sound channel record, as illustrated in <A target="doc" HREF="imsoundmgr.e.htm#39506" CLASS="XRef">Listing 1-13</A>.</P><P CLASS="L.Listing"><A NAME="pgfId=2252"> </A>Listing&nbsp;13 <A NAME="39506"> </A>Disposing of memory associated with a sound channel</P><CODE CLASS="CvF.CodeFull"><A NAME="pgfId=9711"> </A>FUNCTION MyDisposeSndChannel (sndChan: SndChannelPtr; quietNow: Boolean): <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OSErr;<BR>VAR<BR>&nbsp;&nbsp;&nbsp;&nbsp;myErr:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OSErr;<BR>BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;myErr := SndDisposeChannel(sndChan, quietNow);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{dispose of channel}<BR>&nbsp;&nbsp;&nbsp;&nbsp;DisposePtr(Ptr(sndChan));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{dispose of channel ptr}<BR>&nbsp;&nbsp;&nbsp;&nbsp;MyDisposeSndChannel := myErr;<BR>END;<BR></CODE><P CLASS="T1.Text1"><A NAME="pgfId=2251"> </A><A NAME="marker=9713"> </A>If you have played a sound resource through a channel, the <TT CLASS="cv">SndDisposeChannel</TT> function does not free the memory taken by the resource. You must call the Resource Manager's <TT CLASS="cv">ReleaseResource</TT> function to do so, or, if you have detached a resource from a resource file, you could free the memory by making the handle unlocked and purgeable. Note that if you play a sound resource asynchronously, you should not release the memory occupied by the resource until the sound finishes playing or the sound might not play properly. For information on releasing a sound resource after playing a sound asynchronously, see <A target="doc" HREF="imsoundmgr.1e.htm#28093" CLASS="XRef">&quot;Playing Sounds Asynchronously&quot;</A>.<A NAME="marker=863"> </A><A NAME="marker=862"> </A><A NAME="marker=313"> </A></P><P CLASS="I.Important"><A NAME="pgfId=2253"> </A>In Sound Manager versions 3.0 and later, you can play sounds in any number of sound channels. In earlier Sound Manager versions, however, only one kind of sound can be played at one time. This results in several important restrictions on your application. In Sound Manager version 2 and earlier, you should create sound channels just before playing sounds. Once the sound is completed, you should dispose of the channel. If your application is switched out and does not release a sound channel, then other applications may be unable to open sound channels. In particular, the system alert sound might not be heard and the user might not be notified of important system occurrences. In general, while it is acceptable to issue a number of sound commands to the same sound channel, it's not a good idea to play more than one sampled sound on the same sound channel.  </P><hr>&#169; 1999 Apple Computer, Inc.<!-- QTnavbar start --><P><I>Inside Macintosh: Sound</I><P>| <A target="doc" HREF="imsoundmgr.d.htm">Previous</A> | <A target="doc" HREF="imsoundmgr.1.htm">Chapter contents</A> | <A target="doc" HREF="imsoundmgr.htm">Chapter top</A> | <A target="doc" HREF="imsoundmgr.b.htm">Section top</A> | <A target="doc" HREF="imsoundmgr.f.htm">Next</a> | <!-- QTnavbar end --><!-- legacy work start --><script type="text/javascript"> placeWatermark()</script><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox" style="position: relative;"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b><i>Sound Input Manager</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="http://developer.apple.com/referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div><!-- legacy work end --></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY></HTML>