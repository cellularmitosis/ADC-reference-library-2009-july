<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE> Cache Operations</TITLE></HEAD><BODY BGCOLOR="#ffffff"><DIV><a name="top"></a><!-- start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!-- start of path --><font face="Geneva,Helvetica,Arial" size="1"><b><br>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Documentation</a> &gt; <!-- a href="" target="_top" -->Hardware<!-- /a -->  <b>&gt; </b><a href="../../devicemgrs.html" target="_top">Device Managers and Drivers</a> <b>&gt; </b><a href="../pci_srvcs.html" target="_top">PCI Card Services</a> <b>&gt; </b>Designing PCI Cards and Drivers for Power Macintosh Computers</font><br><br><!-- end of path --><A HREF="PCI_BOOK.144.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.157.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.159.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><HR></DIV><H1 CLASS="H2.Heading2"><A NAME="pgfId=3754"> </A><A NAME="15358"> </A>Cache Operations</H1><P CLASS="T1.Text1"><A NAME="pgfId=3755"> </A>Unlike some previous Macintosh drivers, native drivers do not need to flush the PowerPC processor cache in the case of normal I/O operations. The Power Macintosh hardware supports processor cache snooping, which guarantees that the RAM and cache memory domain is coherent. The <TT CLASS="cv">PrepareMemoryForIO</TT> routine takes care of maintaining cache coherency inherent in PCI-based Macintosh computers. </P><P CLASS="T1.Text1"><A NAME="pgfId=3756"> </A>Nevertheless, driver writers may want to perform cache manipulation to improve driver performance. The Driver Services Library provides several routines and data types, described in this section, that allow drivers to get information about cache, alter the default cache modes, and flush the processor cache.The <A HREF="PCI_BOOK.15e.html#16060" CLASS="XRef"><TT CLASS="cv">SetProcessorCacheMode</TT> function</A> forces the cache mode for selected pages of memory. The <A HREF="PCI_BOOK.162.html#26692" CLASS="XRef"><TT CLASS="cv">FlushProcessorCache</TT> function</A> forces data from cache out to main memory. These functions lets special-purpose drivers optimize their I/O performance. </P><DIV><blockquote><p CLASS="WarningHead"><b><A NAME="pgfId=18825"> </A>WARNING</b></p><P CLASS="W.Warning"><A NAME="pgfId=3763"> </A>Take care when using the <TT CLASS="cv">SetProcessorCacheMode</TT> and <TT CLASS="cv">FlushProcessorCache</TT> functions, because they may conflict with the cache mode operations of Mac&nbsp;OS. Most drivers need use only <TT CLASS="cv">PrepareMemoryForIO</TT> and <TT CLASS="cv">CheckPointIO</TT>. </P></blockquote></DIV><H2 CLASS="H3.Heading3TOC"><A HREF="PCI_BOOK.159.html#pgfId=3767" CLASS="Hypertext">Getting Cache Information</A></H2><H2 CLASS="RoH.RoutineHeadingTOC"><A HREF="PCI_BOOK.15a.html#pgfId=3769" CLASS="Hypertext">GetLogicalPageSize</A></H2><H2 CLASS="RoH.RoutineHeadingTOC"><A HREF="PCI_BOOK.15b.html#pgfId=3777" CLASS="Hypertext">GetDataCacheLineSize</A></H2><H2 CLASS="RoH.RoutineHeadingTOC"><A HREF="PCI_BOOK.15c.html#pgfId=3785" CLASS="Hypertext">GetPageInformation</A></H2><H2 CLASS="H3.Heading3TOC"><A HREF="PCI_BOOK.15d.html#pgfId=3828" CLASS="Hypertext">Setting Cache Modes</A></H2><H2 CLASS="RoH.RoutineHeadingTOC"><A HREF="PCI_BOOK.15e.html#pgfId=3833" CLASS="Hypertext">SetProcessorCacheMode</A></H2><H2 CLASS="H3.Heading3TOC"><A HREF="PCI_BOOK.15f.html#pgfId=3861" CLASS="Hypertext">Synchronizing I/O</A></H2><H2 CLASS="RoH.RoutineHeadingTOC"><A HREF="PCI_BOOK.160.html#pgfId=3864" CLASS="Hypertext">SynchronizeIO</A></H2><H2 CLASS="H3.Heading3TOC"><A HREF="PCI_BOOK.161.html#pgfId=3876" CLASS="Hypertext">Flushing the Processor Cache</A></H2><H2 CLASS="RoH.RoutineHeadingTOC"><A HREF="PCI_BOOK.162.html#pgfId=3882" CLASS="Hypertext">FlushProcessorCache</A></H2><HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 26 March 99)<P><A HREF="PCI_BOOK.144.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.157.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.159.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></HTML>