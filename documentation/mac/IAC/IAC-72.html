<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>OpenNewEdition(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING72></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-71.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-73.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-23.html"><B>Chapter 2 - Edition Manager</B></A> / <A HREF="IAC-48.html"><B>Edition Manager Reference</B></A><BR><DL><DD><A HREF="IAC-52.html"><B>Edition Manager Routines</B></A> / <A HREF="IAC-71.html"><B>Writing out Edition Data</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING72-0></A>
<H3>OpenNewEdition</H3>
 To initiate the writing of data from a publisher to its edition container, use the <CODE>OpenNewEdition</CODE> function.<P>
<PRE>
FUNCTION OpenNewEdition (publisherSectionH: SectionHandle;
                         fdCreator: OSType;
                         publisherSectionDocument: FSSpecPtr; 
                         VAR refNum: EditionRefNum): OSErr;
</PRE>
<DL>
<DT><CODE>publisherSectionH</CODE>
<DD> The publisher section that is writing to the edition. 
<DT><CODE>fdCreator</CODE>
<DD> The Finder creator type of the new edition icon.
<DT><CODE>publisherSectionDocument</CODE>
<DD> The document that contains the publisher. This parameter is used to create an alias from the edition to the publisher's document. If you pass <CODE>NIL</CODE> for <CODE>publisherSectionDocument</CODE>, an alias is not made in the edition file.
<DT><CODE>refNum</CODE>
<DD> The <CODE>OpenNewEdition</CODE> function returns the reference number for the edition in this parameter. You specify this reference number as a parameter for subsequent calls to <CODE>WriteEdition</CODE>, <CODE>SetEditionFormatMark</CODE>, and <CODE>CloseEdition</CODE> to specify which publisher is writing its data to an edition. If the edition cannot be opened for writing because there is another publisher writing to it, or because the file system does not allow writing, an error is returned and <CODE>OpenNewEdition</CODE> sets <CODE>refNum</CODE> to <CODE>NIL</CODE>. 
</DL>
<A NAME=HEADING72-7></A>
<H5>DESCRIPTION</H5>
 The <CODE>OpenNewEdition</CODE> function opens an edition for writing. The function returns an <CODE>flLckdErr</CODE> result code if there is a subscriber on another machine reading data from the same edition. The <CODE>OpenNewEdition</CODE> function returns a <CODE>permErr</CODE> result code if there is a registered publisher to that edition on another machine.<P>
 The Edition Manager allows two registered publishers that are located on the <I>same</I> machine to write to the same edition. Note that multiple publishers cannot write to the same edition simultaneously--only one publisher can write to an edition at a given time.<A NAME=MARKER-2-380></A><P>
<A NAME=HEADING72-10></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>ioErr<TD>-36<TD>I/O error<TR>
<TD>flLckdErr<TD>-45<TD>Edition in use by another section<TR>
<TD>permErr<TD>-54<TD>Registered publisher on another machine<TR>
<TD>wrPermErr<TD>-61<TD>Not a publisher<TR>
<TD>editionMgrInitErr<TD>-450<TD>Manager not initialized</TABLE>
</H5>
<A NAME=HEADING72-11></A>
<H5>SEE ALSO</H5>
 For an example of the use of <CODE>OpenNewEdition</CODE>, see <A HREF=IAC-32.html#MARKER-9-186>Listing 2-5</A> beginning on <BR><A HREF=IAC-32.html#MARKER-9-186>page 2-36</A>. <P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-71.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-73.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
