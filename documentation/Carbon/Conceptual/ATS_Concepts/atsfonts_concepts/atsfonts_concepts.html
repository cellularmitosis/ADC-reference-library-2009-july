<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Apple Type Services for Fonts Programming Guide: Managing Fonts: ATS Concepts</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Managing Fonts: ATS Concepts"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30000109" title="Managing Fonts: ATS Concepts"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000420" target="_top">Carbon</a> &gt; <a href="../../../TextFonts-date.html#//apple_ref/doc/uid/TP30000440-TP30000420-TP30000461" target="_top">Text &amp; Fonts</a> &gt; <a href="../atsfonts_intro/atsfonts_intro.html#//apple_ref/doc/uid/TP30000108-DontLinkElementID_15">Apple Type Services for Fonts Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../atsfonts_intro/atsfonts_intro.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../atsfonts_tasks/atsfonts_tasks.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP30000109-SW1" title="Managing Fonts: ATS Concepts"></a><h1>Managing Fonts: ATS Concepts</h1><p>The chapter provides an overview of font services in Max OS X and information on the key concepts you need to use ATS for Fonts in your application. It assumes that you are already familiar with fonts and font data, but that you need information specific to managing fonts in Max OS X. In particular, you should be familiar with the following terminology:</p><ul class="ul"><li class="li"><p>Outline and bitmap fonts</p></li><li class="li"><p>Font naming conventions</p></li><li class="li"><p>Type face, font families, and font family instances</p></li><li class="li"><p>Font metrics such as point size, left-side bearing, advance width, baseline and leading</p></li></ul><p>The following topics, specific to Mac OS X, are discussed in this chapter:</p><ul class="ul"><li class="li"><p>Font formats and file types supported in Mac OS X</p></li><li class="li"><p>Locations in which fonts can be installed</p></li><li class="li"><p>The role of the ATS server in font management</p></li><li class="li"><p>Font user interface</p></li></ul>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="atsfonts_concepts.html#//apple_ref/doc/uid/TP30000109-DontLinkElementID_1">Font Services in Mac OS X</a>
				
			<br/>
			
        
			
			
				<a href="atsfonts_concepts.html#//apple_ref/doc/uid/TP30000109-SW9">Font Formats and File Types</a>
				
			<br/>
			
        
			
			
				<a href="atsfonts_concepts.html#//apple_ref/doc/uid/TP30000109-DontLinkElementID_2">Font Locations and Installation</a>
				
			<br/>
			
        
			
			
				<a href="atsfonts_concepts.html#//apple_ref/doc/uid/TP30000109-SW3">The ATS Server, Notifications, and Queries</a>
				
			<br/>
			
        
			
			
				<a href="atsfonts_concepts.html#//apple_ref/doc/uid/TP30000109-SW8">Font User Interface</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP30000109-DontLinkElementID_1" title="Font Services in Mac OS X"></a><h2>Font Services in Mac OS X</h2><p><span class="content_text">Figure 1-1</span> shows the interaction of applications with Mac OS X font services. Various applications (Cocoa, Carbon, HTML-based) communicate with the Application Services framework through the QuickDraw or Quartz frameworks. Each of these frameworks communicate with the ATS client framework. Apple Type Services for Unicode Imaging (ATSUI) communicates through the QuickDraw and Quartz subframeworks but can also call directly into the ATS client framework. The ATS client framework provides the programming interface used by developers (ATS for Fonts) and the private programming interface used by the system.</p><br/><div><a name="//apple_ref/doc/uid/TP30000109-SW2" title="Figure 1-1Applications and Mac OS X font services"></a><p><strong>Figure 1-1&nbsp;&nbsp;</strong>Applications and Mac OS X font services</p><img src = "../art/fontservices.gif" alt = "Applications and Mac OS X font services" width="289" height="297"></div><br/><p>The ATS client communicates directly to the ATS server, which is a separate process. The ATS server maintains the font database and performs such tasks as activating and deactivating fonts, supplying glyph outline data, and obtaining information from font tables. The ATS server is discussed in more detail in <span class="content_text"><a href="atsfonts_concepts.html#//apple_ref/doc/uid/TP30000109-SW3">“The ATS Server, Notifications, and Queries.”</a></span></p><a name="//apple_ref/doc/uid/TP30000109-SW9" title="Font Formats and File Types"></a><h2>Font Formats and File Types</h2><p>The font formats and file types supported for rendering, previewing, and printing documents in Mac OS X are:</p><ul class="ul"><li class="li"><p>Macintosh TrueType font suitcases and data-fork (<code>.dfont</code>) suitcases. A data fork font suitcase contains the resources associated with a Macintosh font, including 'FOND' and 'NFNT' resources. The only difference is that the information is stored in a data fork rather than a resource fork. However, the data fork suitcase format is not the same as the format used for a data fork TrueType font used in the Windows OS.</p></li><li class="li"><p>Windows TrueType (<code>.ttf</code>/<code>.ttc</code>) outline/bitmap fonts</p></li><li class="li"><p>PostScript OpenType Roman outline/bitmap fonts</p></li><li class="li"><p>PostScript OpenType CID Chinese, Japanese, Korean, and Vietnamese outline/bitmap fonts</p></li><li class="li"><p>PostScript Type 1 outline font with Macintosh bitmap font suitcases (LWFN)</p></li><li class="li"><p>Macintosh PostScript Type 1 enabled font suitcases (<code>'sfnt'</code>)</p></li><li class="li"><p>Macintosh PostScript Type 1 CID enabled font suitcases (<code>'sfnt'</code>/CID)</p></li><li class="li"><p>Multiple Master PostScript fonts (available starting with Mac OS X version 10.2). There are two types available—LWFN and <code>'sfnt'</code>.</p></li></ul><div class="notebox"><a name="//apple_ref/doc/uid/TP30000109-DontLinkElementID_12" title="Note"></a><p><strong>Note:</strong>&nbsp;Bitmap font resources are not supported in Mac OS X. Font families that consist entirely of bitmap font resources are ignored by Quartz-based applications that use Cocoa, Apple Type Services for Unicode Imaging (ATSUI), or Multilingual Text Engine (MLTE). These font families are not available for use in such user interface elements as menus, windows, and static and editable text controls. </p></div><p>See the following resources for more details:</p><ul class="ul"><li class="li"><p>TrueType reference manual</p><p><span class="content_text"><a href="http://developer.apple.com/fonts" target="_top">http://developer.apple.com/fonts</a></span></p></li><li class="li"><p>The Adobe Type Technology website, for information on the OpenType specification, Multiple Master fonts, and CID-keyed fonts:</p><p><span class="content_text"><a href="http://partners.adobe.com/public/developer/opentype/index.html" target="_blank">http://partners.adobe.com/public/developer/opentype/index.html</a></span></p></li></ul><a name="//apple_ref/doc/uid/TP30000109-DontLinkElementID_2" title="Font Locations and Installation"></a><h2>Font Locations and Installation</h2><p>Installing fonts is easy. You need only copy or move font files to any of the standard font directories of the Mac OS X file system listed in <span class="content_text">Table 1-1</span>. The directories are arranged so that resources local to the user's computer are segregated from those on the network. On a computer, system resources are segregated from those under the control of the user or system administrator. </p><p>Fonts, applications, documents, and other resources can be installed in one of several file system domains. A <strong>domain</strong> is an area of the file system segregated from other parts of the file system. A domain has structural elements identical to other domains. For example each of the domains listed in <span class="content_text">Table 1-1</span> has a /Library/Fonts/ directory.</p><p>Changes to the font directories are registered automatically with the operating system when an application launches or a user logs in to the account or computer on which the changes occurred. The ATS server, which maintains the font database, resolves duplicate fonts based on the order of precedence defined for the standard domains. The standard domains described in <span class="content_text">Table 1-1</span> are listed in the table from the highest to lowest priority.</p><a name="//apple_ref/doc/uid/TP30000109-SW4" title="Table 1-1Standard domains and font directories"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 1-1&nbsp;&nbsp;</strong>Standard domains and font directories</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Domain</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Directory</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Comment</p></th></tr><tr><td  scope="row"><p>User</p></td><td ><p><code>~/Library/Fonts/</code></p></td><td ><p>The User domain is specific to the user who is logged into the system and is associated with the user's home directory, which can either be on the startup volume or on the network. The user has complete control over the contents of this domain.</p></td></tr><tr><td  scope="row"><p>Local</p></td><td ><p><code>/Library/Fonts/</code></p></td><td ><p>The Local domain is for fonts shared among all users of a particular computer and not required by the operating system to run. Users with system administrator privileges can add, remove, and modify items in this domain, which is also the recommended location for fonts that are shared among applications.</p></td></tr><tr><td  scope="row"><p>Network</p></td><td ><p><code>/Network/Library/Fonts/</code></p></td><td ><p>The Network domain is for fonts shared among all users of a local area network. The contents of this domain are typically located on network file servers and are under the control of a network administrator.</p></td></tr><tr><td  scope="row"><p>System</p></td><td ><p><code>/System/Library/Fonts/</code></p></td><td ><p>The System domain contains the default fonts required by the operating system to run and should not be altered.</p></td></tr><tr><td  scope="row"><p>Classic</p></td><td ><p><code>System Folder: Fonts:</code></p></td><td ><p>The Classic domain contains the default fonts required by the Classic environment to run and should not be altered.</p></td></tr></table></div><div class="notebox"><a name="//apple_ref/doc/uid/TP30000109-DontLinkElementID_13" title="Note"></a><p><strong>Note:</strong>&nbsp;In Mac OS X version 10.2 and later, you can install directories of fonts within the Fonts directory. Using nested directories provides more flexibility for you to install and organize fonts.</p></div><p>The domain in which a font is placed defines the accessibility for that font. For example, if a user installs a custom font in the user domain, the font is accessible only to that user. If an administrator installs the same font in the network domain, the font is accessible to everyone on the network.</p><p>The ownership and permissions model of the file system is fundamentally different in Mac OS X than from previous releases of the operating system. This difference affects how you install and use fonts. For each file and directory in the file system there are three categories of users (owner, group, and other). For each type of user there are three specific permissions that affect access to the file or directory (read, write, and execute). When you install a font, check that the permissions of the files associated with the font are set to enable read access for the appropriate categories of users for the domain.</p><p>You can programmatically activate fonts from any directory, including the application library directory and bundle, and from an application resource fork.</p><a name="//apple_ref/doc/uid/TP30000109-SW3" title="The ATS Server, Notifications, and Queries"></a><h2>The ATS Server, Notifications, and Queries</h2><p>The ATS server is a process that is responsible for maintaining the font database for Mac OS X. It activates and deactivates fonts, maintains and scales glyph outline data, maintains font caches, and communicates information about font availability between font clients and font utility applications. The ATS server ‘s role in font support in Mac OS X is shown in <span class="content_text">Figure 1-2</span>.</p><p>The ATS server also handles font notifications. A <strong>font notification</strong> is a message from the ATS server that informs applications of changes in the font database. The ATS server passes the font activation and deactivation information to any application that has subscribed to receive notifications. Currently, the only types of notification an application can receive are the result of a global font activation or deactivation.</p><p>Applications that subscribe to notifications receive up-to-date information about the font database. Notifications eliminate the need for an application to check generation values and to periodically enumerate fonts and font families.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP30000109-DontLinkElementID_14" title="Note"></a><p><strong>Note:</strong>&nbsp;Only  applications that use a Core Foundation run loop can receive notifications. Carbon and Cocoa applications automatically have a Core Foundation run loop (<code>CFRunLoopRef</code> data type). Other applications, such as a faceless tool or utility, must explicitly create a Core Foundation run loop.</p></div><br/><div><a name="//apple_ref/doc/uid/TP30000109-SW5" title="Figure 1-2The ATS server in Mac OS X "></a><p><strong>Figure 1-2&nbsp;&nbsp;</strong>The ATS server in Mac OS X </p><img src = "../art/ats.gif" alt = "The ATS server in Mac OS X" width="269" height="233"></div><br/><p>ATS supports the ability for ATS clients to send font queries. A <strong>font query</strong> is simply a message that is generated by an application in need of font information. Currently there is only one type of query supported—a query for a missing font. A missing-font query is generated automatically whenever an application looks for a font that is not currently active. If the ATS server does not have the queried font in the font database, the server passes the font query to any application that has signed up to handle queries. Typically this is a font utility, often a faceless process, specifically designed to handle font queries. If the font utility has access to the font, the utility can activate the font using the appropriate ATS function.</p><p>The query process is opaque to the application that needs a font. Query management is handled by the ATS server. To the requesting application, activation of the needed font is automatic. </p><a name="//apple_ref/doc/uid/TP30000109-SW8" title="Font User Interface"></a><h2>Font User Interface</h2><p>Your application can display fonts to the user by providing a Font menu or a Fonts panel. The Font menu, shown in <span class="content_text"><a href="atsfonts_concepts.html#//apple_ref/doc/uid/TP30000109-SW6">Figure 1-4</a></span>, is the user interface available in Mac OS 9. Prior to Mac OS X version 10.1, the Font menu was the only Font interface available to Carbon applications. With the release of Mac OS X version 10.2, Carbon applications can provide a Fonts panel, shown in <span class="content_text"><a href="atsfonts_concepts.html#//apple_ref/doc/uid/TP30000109-SW7">Figure 1-3</a></span>. The Fonts panel was previously available only to Cocoa applications. If your application runs only in Mac OS X, you should provide a Fonts panel rather than a Font menu. The Fonts panel is the preferred user interface for Fonts. </p><p>Fonts Panel is the programming interface that provides the functions you need to support the Fonts panel. Using these functions along with Carbon events, your application can do the following:</p><ul class="ul"><li class="li"><p>Show and hide the Fonts panel</p></li><li class="li"><p>Set selections programmatically in the Fonts panel</p></li><li class="li"><p>Obtain user selections from the Fonts panel</p></li></ul><br/><div><a name="//apple_ref/doc/uid/TP30000109-SW7" title="Figure 1-3The Fonts panel"></a><p><strong>Figure 1-3&nbsp;&nbsp;</strong>The Fonts panel</p><img src = "../art/fontpanel.gif" alt = "The Fonts window" width="266" height="335"></div><br/><p>As shown in <span class="content_text">Figure 1-3</span>, the columns in the Fonts panel improve the viewing and selection of large collections of fonts compared to the hierarchical Font menu shown in <span class="content_text">Figure 1-4</span>. The columns provide easy access for users to select font, style, and size. The Fonts panel also supports font color, although color is not shown in <span class="content_text">Figure 1-3</span>. See <span class="content_text"><a href="../atsfonts_tasks/atsfonts_tasks.html#//apple_ref/doc/uid/TP30000110-SW3">“Providing a Fonts Panel in a Carbon Application”</a></span> for instructions and code examples on supporting a Fonts panel in your application.</p><br/><div><a name="//apple_ref/doc/uid/TP30000109-SW6" title="Figure 1-4A hierarchical Font menu"></a><p><strong>Figure 1-4&nbsp;&nbsp;</strong>A hierarchical Font menu</p><img src = "../art/fontmenu.gif" alt = "A hierarchical Font menu" width="303" height="347"></div><br/>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../atsfonts_intro/atsfonts_intro.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../atsfonts_tasks/atsfonts_tasks.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2003, 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-12-11<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Carbon/Conceptual/ATS_Concepts/atsfonts_concepts/atsfonts_concepts.html%3Fid%3DTP30000981-1.5&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Carbon/Conceptual/ATS_Concepts/atsfonts_concepts/atsfonts_concepts.html%3Fid%3DTP30000981-1.5&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Carbon/Conceptual/ATS_Concepts/atsfonts_concepts/atsfonts_concepts.html%3Fid%3DTP30000981-1.5&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>