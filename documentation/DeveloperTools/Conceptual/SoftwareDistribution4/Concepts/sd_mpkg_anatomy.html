<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Software Distribution Legacy Guide (Legacy): Anatomy of a Metapackage</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Anatomy of a Metapackage"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	<meta name="ROBOTS" content="NOINDEX"/>
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20001768" title="Anatomy of a Metapackage"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../LegacyTechnologies/index.html#//apple_ref/doc/uid/TP30000440-TP30000470" target="_top">Legacy Documents</a> &gt; <a href="../../../../LegacyTechnologies/Tools-date.html#//apple_ref/doc/uid/TP30000440-TP30000470-TP30000463" target="_top">Tools</a> &gt; <a href="../index.html" target="_top">Software Distribution Legacy Guide (Legacy)</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="sd_pkg_anatomy.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="sd_permissions_author.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        <script type="text/javascript" language="JavaScript">placeWatermark()</script>
<div id="legacyOuterWrapper"><div align="center" id="watermark">
<div class="legacybox">
<h1>Legacy Document<span class="closebutton"><a href="javascript:closeWatermark()"><img src="../../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>
        <a name="//apple_ref/doc/uid/20001768-TPXREF3" title="Anatomy of a Metapackage"></a><hr /><H1>Anatomy of a Metapackage</H1><p>This section provides a detailed description of the contents of an installation metapackage. It assumes you are familiar with the information in <span class="content_text"><a href="sd_about_pkgs.html#//apple_ref/doc/uid/20001761-1041172">“What Is a Metapackage?.”</a></span></p><p>You use package files for installing software and metapackage files for grouping multiple packages, which allows a user to perform a custom installation. You can also use PackageMaker to create package and metapackage definition files (with extensions <code>.mpsp</code> and <code>.pmsm</code>, respectively) to store the information you’ve entered, and to modify and recreate packages and metapackages.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="sd_mpkg_anatomy.html#//apple_ref/doc/uid/20001768-1017398-TPXREF4">High-level Metapackage Structure</a>
				
			<br/>
			
        
			
			
				<a href="sd_mpkg_anatomy.html#//apple_ref/doc/uid/20001768-1017313-TPXREF20">Choosing an Installation Location for the Software in a Metapackage</a>
				
			<br/>
			
        
			
			
				<a href="sd_mpkg_anatomy.html#//apple_ref/doc/uid/20001768-1017325-BGBEBCFB">When a Package or Metapackage Is Required</a>
				
			<br/>
			
        
			
			
				<a href="sd_mpkg_anatomy.html#//apple_ref/doc/uid/20001768-1009721-TPXREF2">Authorization and Restart Action</a>
				
			<br/>
			
        
			
			
				<a href="sd_mpkg_anatomy.html#//apple_ref/doc/uid/20001768-1009740-TPXREF13">Hiding the Packages Contained in a Metapackage</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/20001768-1017398" title="High-level Metapackage Structure"></a><a name="//apple_ref/doc/uid/20001768-1017398-TPXREF4" title="High-level Metapackage Structure"></a><h2>High-level Metapackage Structure</h2><p>A metapackage file is similar in construction to a package file, but instead of containing the software to be installed, it contains information about the packages (or other metapackages) to install. <span class="content_text">Listing 1</span> shows the contents of a simple metapackage.</p><a name="//apple_ref/doc/uid/20001768-1007541-BGBHEGHI" title="Listing 1Contents of a simple metapackage"></a><p class="codesample"><a name="//apple_ref/doc/uid/20001768-1007541" title="Listing 1Contents of a simple metapackage"></a><strong>Listing 1&nbsp;&nbsp;</strong>Contents of a simple metapackage</p><div class="codesample"><table><tr><td scope="row"><pre>Contents<span></span></pre></td></tr><tr><td scope="row"><pre>Info.plist<span></span></pre></td></tr><tr><td scope="row"><pre>PkgInfo<span></span></pre></td></tr><tr><td scope="row"><pre>Resources<span></span></pre></td></tr><tr><td scope="row"><pre>    Description.plist<span></span></pre></td></tr><tr><td scope="row"><pre>    License.rtf<span></span></pre></td></tr><tr><td scope="row"><pre>    ReadMe.rtf<span></span></pre></td></tr><tr><td scope="row"><pre>    Simple Meta.bom<span></span></pre></td></tr><tr><td scope="row"><pre>    Simple Meta.info<span></span></pre></td></tr><tr><td scope="row"><pre>    Welcome.rtf<span></span></pre></td></tr></table></div><p>You use the PackageMaker metapackage editor to create a metapackage. To open it, you choose File > New Meta Package. You then enter information, such as the name of the metapackage, the packages or metapackages it contains, and the location of its resource folder (needed only if you provide License, Read Me, or other customizing information, as described in <span class="content_text"><a href="sd_modify_install_ui.html#//apple_ref/doc/uid/20001766-TPXREF2">“Customizing What Installer Shows to the User”</a></span>).</p><p>Of course, you’ll create your packages first, before adding them to a metapackage. One of the main advantages of a metapackage is that it can allow a user to do a custom installation and choose from among various items to install. To give the user more control over the process, it is worthwhile to break your software into as many pieces as you reasonably can, rather than create a single, monolithic package. For example, you might place your application, documentation, fonts, and other items in separate packages.</p><p>A metapackage shows, in the Custom Install pane, which packages will be installed and which are upgrades. The button to start the installation is labeled Install only if all of the packages have not yet been installed; otherwise it is labeled Upgrade. Items in a metapackage are installed in the order listed.</p><a name="//apple_ref/doc/uid/20001768-1017313" title="Choosing an Installation Location for the Software in a Metapackage"></a><a name="//apple_ref/doc/uid/20001768-1017313-TPXREF20" title="Choosing an Installation Location for the Software in a Metapackage"></a><h2>Choosing an Installation Location for the Software in a Metapackage</h2><p>When you combine individual packages in a metapackage, the user will be able to choose a destination if any of the individual packages is relocatable. If this is the case, the user will be able to choose only one destination for all relocatable packages they install, not separate destinations for each relocatable package; installed packages that are not relocatable will not be relocated. Note, however, that prior to Mac OS X version 10.3.4, relocation did not work reliably for metapackages.</p><a name="//apple_ref/doc/uid/20001768-1017325" title="When a Package or Metapackage Is Required"></a><a name="//apple_ref/doc/uid/20001768-1017325-BGBEBCFB" title="When a Package or Metapackage Is Required"></a><h2>When a Package or Metapackage Is Required</h2><p>You can mark a package as required on the Info pane in PackageMaker. When you add a package to a metapackage in PackageMaker, you can also set the Attribute field for the package to Selected, Unselected, or Required (default is Selected). Together, these settings determine how the package is displayed on the Installer Custom Install pane.</p><p>On that pane, a selected checkbox means the package will be installed. If the checkbox is deselected, the package won’t be installed. If an entry is dimmed, you can’t change the setting. And if an entry is not dimmed, you can select or deselect the package for installation. <span class="content_text">Table 1</span> shows how each package is displayed and its resulting status (required or not required), based on the possible settings in the package and metapackage.</p><a name="//apple_ref/doc/uid/20001768-1009265-BGBCIHBE" title="Table 1Relationship between the Required checkbox in the package and the package attribute in the metapackage (Required, Selected, Unselected)"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/20001768-1009265" title="Table 1Relationship between the Required checkbox in the package and the package attribute in the metapackage (Required, Selected, Unselected)"></a><strong>Table 1&nbsp;&nbsp;</strong>Relationship between the Required checkbox in the package and the package attribute in the metapackage (Required, Selected, Unselected)</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Package</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Metapackage</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Custom Install checkbox in Installer</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Result</p></th></tr><tr><td  scope="row"><p>Required</p></td><td ><p>Selected</p></td><td ><p>checked + dimmed</p></td><td ><p>required</p></td></tr><tr><td  scope="row"><p>Required</p></td><td ><p>Unselected</p></td><td ><p>checked + dimmed</p></td><td ><p>required</p></td></tr><tr><td  scope="row"><p>Required</p></td><td ><p>Required</p></td><td ><p>checked + dimmed</p></td><td ><p>required</p></td></tr><tr><td  scope="row"><p>not Required</p></td><td ><p>Selected</p></td><td ><p>checked + enabled</p></td><td ><p>not required</p></td></tr><tr><td  scope="row"><p>not Required</p></td><td ><p>Unselected</p></td><td ><p>not checked + enabled</p></td><td ><p>not required</p></td></tr><tr><td  scope="row"><p>not Required</p></td><td ><p>Required</p></td><td ><p>checked + disabled</p></td><td ><p>required</p></td></tr></table></div><a name="//apple_ref/doc/uid/20001768-1009721" title="Authorization and Restart Action"></a><a name="//apple_ref/doc/uid/20001768-1009721-TPXREF2" title="Authorization and Restart Action"></a><h2>Authorization and Restart Action</h2><p>A metapackage requires authorization if any of its enclosed packages requires it; otherwise, a metapackage does not require authorization. A metapackage requires the highest authorization required by any enclosed package; it also requires the highest restart action of any enclosed package.</p><a name="//apple_ref/doc/uid/20001768-1009740" title="Hiding the Packages Contained in a Metapackage"></a><a name="//apple_ref/doc/uid/20001768-1009740-TPXREF13" title="Hiding the Packages Contained in a Metapackage"></a><h2>Hiding the Packages Contained in a Metapackage</h2><p></p><p>Something to consider when creating a metapackage is that the packages (or metapackages) it contains are visible to users. If you want to discourage users from installing individual packages, which is generally recommended, you can place the contained packages in a directory that isn’t visible in Finder windows. You can make a directory invisible (given standard Finder settings) by changing its name to start with a period.</p><p>One convenient way to create a metapackage that hides its packages in an invisible directory is to create a visible directory, add the packages to the directory, create and test the metapackage, then make the directory invisible by adding a period to its name using a shell command. After renaming the directory, you’ll have to edit the <code>Info.plist</code> file in the metapackage to point to the packages.</p><p>Suppose, for example, you have two packages, <code>Cool_App.pkg</code> and <code>Mouse_pad.pkg</code> (the same packages used in <span class="content_text"><a href="sd_install_process.html#//apple_ref/doc/uid/20001765-1011079">“Execution Order for a Complex Metapackage”</a></span>). You could create a metapackage that installs these packages from a hidden directory by performing the following steps:</p><ol class="ol"><li class="li"><p>In the Finder, in the directory where you want the metapackage file to reside, create a subdirectory named <code>contained_packages</code>. Copy <code>Cool_App.pkg</code> and <code>Mouse_pad.pkg</code> into that directory.</p></li><li class="li"><p>Open PackageMaker and choose File > New > Meta Package to create a new metapackage.</p></li><li class="li"><p>In the Finder, drag each of the packages to the Package List pane in PackageMaker.</p></li><li class="li"><p>Choose File > Create Package and create the metapackage definition file as <code>TestHiddenPackage.mpkg</code>. Save this file in the same directory as <code>contained_packages</code>.</p></li><li class="li"><p>Choose File > Save and save the metapackage definition file as <code>TestHiddenPackage</code> (it will automatically get the extension <code>.pmsm</code>). For convenience, save this file in the directory with the metapackage.</p></li><li class="li"><p>Test the metapackage. If there are any problems, open the metapackage definition file to modify and save the metapackage, and continue testing until it works as desired.</p></li><li class="li"><p>In a Terminal window, use the <code>cd</code> command to change directories to the directory containing the metapackage and other files.</p></li><li class="li"><p>Use the <code>mv</code> command to add a period to the beginning of the <code>contained_packages</code> directory:</p><p><code>mv contained_packages .contained_packages</code></p><p>The period causes the directory to disappear in the Finder unless you have your Finder settings adjusted to show hidden files.</p></li><li class="li"><p>In the Finder, Control-click <code>TestHiddenPackage.mpkg</code> and choose Show Package Contents.</p></li><li class="li"><p>In the Finder or in a Terminal window, set the permissions on the file <code>Info.plist</code> in the <code>Contents</code> directory so that you have permission to edit it. For example, in a Terminal widow, you could use</p><p><code>chmod +w Info.plist</code></p><p>After editing, you can use <code>chmod -w Info.plist</code> to prevent further modifications.</p></li><li class="li"><p>Open the file and look for the key <code>IFPkgFlagComponentDirectory</code>. Change the value for that key from “..” to “../.contained_packages”.</p></li><li class="li"><p>Save your changes to the <code>Info.plist</code> file and test the metapackage. It should work the same as before but with the package files no longer visible (again, assuming standard settings in the Finder).</p></li></ol><div class="notebox"><a name="//apple_ref/doc/uid/20001768-DontLinkElementID_43" title="Note"></a><p><strong>Note:</strong>&nbsp;If you know the name of an invisible directory, you can open the directory by doing a Finder search by name, and adding a search criteria for Visibility: all. Then double-click the icon for the found directory to open it.</p>You can also perform the following steps to show all invisible files in the Finder:</p>1. Type the following line in a Terminal window and press Return.</p><code>defaults write com.apple.Finder AppleShowAllFiles YES</code></p>You can turn off display of invisible files with the following line:</p>defaults write com.apple.Finder AppleShowAllFiles NO</p>2. Relaunch the Finder. You can do so by choosing Force Quit from the Apple menu, selecting the Finder, and clicking Relaunch.</p></div><p>For more information on editing property list files, see <span class="content_text"><a href="sd_pkg_flags.html#//apple_ref/doc/uid/20001940-TPXREF3">“Examining and Modifying Property Lists.”</a></span></p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="sd_pkg_anatomy.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="sd_permissions_author.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2003, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-07-24<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/DeveloperTools/Conceptual/SoftwareDistribution4/Concepts/sd_mpkg_anatomy.html%3Fid%3DTP40004615-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/DeveloperTools/Conceptual/SoftwareDistribution4/Concepts/sd_mpkg_anatomy.html%3Fid%3DTP40004615-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/DeveloperTools/Conceptual/SoftwareDistribution4/Concepts/sd_mpkg_anatomy.html%3Fid%3DTP40004615-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
