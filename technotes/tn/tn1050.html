<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!-- Template 03-24-01 --><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note TN1050: System 7.5.3 Revision 2</title><META NAME="Identifier-URL"Content="http://www.apple.com/metadata/sample.html"><META NAME="Identifier"     		CONTENT="[See Instructions]">    <meta name="keywords" content="Mac OS 8 System 7.5.3 revisions Enabler startup tuner INIT">    <meta name="Description" content="Technical Note TN1050: This Technical Note describes thevarious changes offered by System 7.5.3 Revision 2 and providesinformation for Apple developers regarding these changes.This Note also includes references to other sources of informationthat further discuss these changes. Three primary areas ofdiscussion are System Enabler Changes, Startup Tuner INITChanges, and Changes in the About Macintosh Dialog box."><meta name="categories" content="Overview, Operating System and System Releases"><meta name="week-posted" content="May 27, 1996 - Jun 7, 1996"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002891" title="System 7.5.3 Revision 2"></a><A NAME="top"></A><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxMacOS9Earlier-date.html">Mac OS 9 & Earlier</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/index.html" target="_blank">Reference Library</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TN1050</div>
<div id="pageheadsub">System 7.5.3 Revision 2</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"> <!-- begin_header_box --> <table width="600" cellpadding="0" cellspacing="0" border="0">	<tr>		<td width=300 valign="top" align=left scope="row">			<table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>				</tr>				<tr bgcolor="#e6e6e6">					<td background="images/tnmenubody.gif" width=300 align=left>						<span id="menutitle">							CONTENTS     <BR>    <BR>						</span>					</td>				</tr>				<tr bgcolor="#e6e6e6">					<td background="images/tnmenubody.gif" width=300 align=left>						<p id="menutext"><A HREF = "#RTFToC1">About System 7.5.3 Revision 2</a><br><br><A HREF = "#RTFToC2">System Enabler Changes</a><br><br><A HREF = "#RTFToC3">Startup Tuner INIT Changes</a><br><br><A HREF = "#RTFToC4">Detecting System 7.5.3 Revision 2</a><br><br><A HREF = "#RTFToC5">Changes in the "About This Macintosh" Dialog Box</a><br><br><A HREF = "#References">References</a><br><br><A HREF="#Downloads">Downloadables</A></p>											</td>				</tr>				<tr>					<td width=300 align=left scope="row">						<img src="images/tnmenubottom.gif" alt="" width=300 height=16>					</td>				</tr>			</table>		</td>		<td width=300 valign="top" align=left>			<!-- begin_intro_text --><P id = "introtext">This Technote describes the various changes offered by System 7.5.3 Revision 2and provides information for Apple developers regarding these changes. ThisNote also includes references to other sources of information that furtherdiscuss these changes.</p><!-- end_intro_text --><!-- begin_date --><h3>&nbsp;Updated: [June 1 1996]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR> <!-- begin_content --><a name = "RTFToC1"></a><h2>About System 7.5.3 Revision 2</h2><p>System 7.5.3 Revision 2 is a small set of bug fixes meant to be applied toSystem 7.5.3. These fixes apply to any machine currently running System 7.5.3.(The update also brings PowerBook Enabler 1.2.x up to version 1.2.4  wheninstalling these fixes. In that one case, System 7.5.3 Revision 2 applies tosome PowerBook computers running System 7.5.2.)</p><P><A HREF="#top">Back to top</A></P><a name = "RTFToC2"></a><h2>System Enabler Changes</h2><P>Both the System 7.5 &amp; 7.5.2 Update Enabler are modified by System 7.5.3Revision 2. System 7.5.3 Revision 2 changes the enabler for your machine to fixthe following problems: </p><ul><li>Type 8 errors on PowerBooks</li><li>Cache flushing on PowerBooks</li><li>Floppy driver on the PowerBook 5300</li><li>Dynamic Recompiling Emulator</li><li>Potential SCSI Problem</li></ul><h3>Type 8 Errors </h3><P>In certain cases, the state of the 68K status register (SR) was saved from acopy on the stack after the processor had switched stacks. As a result, therestoration of SR wasn't quite right. This has been fixed. Note that the fixonly applies to PowerBook computers. Among other behaviors, this bug causedType 8 errors for PowerBook users when coming out of Sleep if they hadRamDoubler installed.</p><h3>Cache Flushing </h3><P>A performance patch in the enabler was applied to the PowerBook 5300 serieswhen it should have been applied to all PowerPC-based PowerBooks. This patch to<code>SetTrapAddress</code> flushes only a cache range instead of the whole cache. This fixshould improve performance of the PowerBook Duo 2300c, any Duo with a PowerPCupgrade, and PowerPC upgrades for the PowerBook 540 and PowerBook 520 series.</p><h3>Floppy Driver on the 5300</h3><P>If the user first inserts a PC floppy disk into the PowerBook 5300, the diskbecomes unreadable on PCs. To fix this problem, the timings in the PowerBook5300 floppy disk driver (i.e., how it reads and writes data) were modified andadjusted.</p><h3>Dynamic Recompiling Emulator </h3><P>There was a problem in the Dynamic Recompiling Emulator which resulted incorruption of the emulated 68K SR register's C bit. The root cause of this bugwas corruption of the PowerPC XER register, resulting in destruction of theemulated 68K SR register's C bit. This fix affects PCI Mac OS machines, as wellas the 5300 and 2300 PowerBook series.</p><h3>A Potential SCSI Problem</h3><P>Because of an ambiguity in the SCSI specification, there can be cases where theSCSI Manager incorrectly returns data errors. This situation occurs whencertain IBM drives, with write caching disabled, finish their last data phasetransfer. The drive does not perform a SAVE_DATA_POINTERS before doing the SCSIdisconnect. When the drive reconnects to send status, the SCSI Manager does animplied RESTORE_POINTERS which moves the data pointer to where it was at thebeginning of the previous connection. The data pointer is not the same as thedata pointer in the original transfer. The SCSI Manager thus returns a residuallength error. Previous versions of the SCSI Manager worked around this problemby assuming that if the device went to status phase on the subsequent reselectthat the previous connection was OK and that therefore there was no reason toperform the implied RESTORE_POINTERS.</p><P>With the internal fast bus on the PCI Power Macintoshes, the SCSI Manager didnot "know" the device was in status phase after the reconnect because of adifference in the way the controller works. The SCSI Manager now correctlyissues the RESTORE_POINTERS command. The transaction will be correctlyreported as successful. This fix affects only PCI PowerMacs running Mac OSwhich use the 1 gigabyte IBM drive with write caching disabled. Apple shipsthese drives with write caching enabled. However, write caching may be disabledby some third-party SCSI utilities. This is a preventive measure rather acommon occurrence.</p><P>For more details on write caching, see <A HREF = "tn1040.html">Technote 1040 "Write Cache Flushing: Techniques for Properly Handling System Shutdown."</a></p><P><A HREF="#top">Back to top</A></P><a name = "RTFToC3"></a><h2>Startup Tuner INIT Changes</h2><h3>Drive Spin Up </h3><P>When a Power Macintosh is powered on, it may not boot properly from the harddrive selected in the Startup Disk control panel. This problem only occurs withvirtual memory turned off. Even if virtual memory is turned on again, theproblem may still occur. This fix affects only PCI Power Macintosh computers.</p><h3>Other Changes</h3><P>System 7.5.3 comes pre-installed on some machines. System 7.5 Update 2.0contains additional bug fixes beyond those found in System 7.5.3 as installedon some early machines. For details on the differences between System 7.5.3 andSystem 7.5 Update 2.0, refer to the <A HREF = "tn1017.html">"Two Implementations"</a> section of <A HREF = "tn1017.html">Technote 1017</a>. System 7.5.3 Revision 2 installs most of the bug fixes listed in the <A HREF = "tn1017.html">"IfSystem Software 7.5.3 is Present..."</a> section of <A HREF = "tn1017.html">Technote 1017</a>, if those bugfixes are not already installed. The updater will not install all of the bugfixes described in <A HREF = "tn1017.html">Technote 1017</a> because some of these resources are installeddirectly into the system file instead of into the enabler -- including somenetworking resources, the latest IR Talk driver resource, and someinternational resources.</p><P>System 7.5.3 Revision 2 may require the creation of a "System 7.5.3 Enabler" onsome machines which currently do not ship with such an enabler as part ofSystem 7.5.3. If the "System 7.5.3 Enabler" is created, it will contain all ofthe bug fixes listed above, as well as most of the bug fixes listed in the <A HREF = "tn1017.html">"IfSystem Software 7.5.3 is Present..."</a> section of <A HREF = "tn1017.html">Technote 1017</a>. If a machinealready has a "System 7.5 Enabler" or "System 7.5.2 Enabler" installed, thenthat enabler is updated instead.</p><P><A HREF="#top">Back to top</A></P><a name = "RTFToC4"></a><h2>Detecting System 7.5.3 Revision 2</h2><P>To distinguish between the multiple versions of system software, the <code>'sysu'</code>Gestalt selector has been provided. It returns the version number of thecurrently installed system update, formatted according to the same conventionsas the version numbering used in <code>'vers'</code> resources, as illustrated in Figure 1.</p><P align=center><img src="images/tn1050_003.gif" alt="" width=230 height=142></p><P align=center><b>Figure 1</b>. The format of the Gestalt response for the 'sysu' selector.</p><P>The presence of the <code>'sysu'</code> Gestalt selector allows application programs todetermine if the current installed system software version was establishedusing the system update. The 'sysu' Gestalt selector will only be defined if asystem update package was used to establish the current system version: the<code>'sysu'</code> selector is not defined on machines shipped with System 7.5.3 installed.</p><h3>Using the 'sysv' and 'sysu' Gestalt Selectors</h3><P>Here is how you can use the <code>'sysv'</code> and the <code>'sysu'</code> Gestalt selectors toestablish information about System 7.5.3: </p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    long response, updateversion;    OSErr err;    Boolean seven_five_three;    Boolean is_an_update;    seven_five_three = false;    is_an_update = false;    err = Gestalt(gestaltSystemVersion, &amp;response);    if (err == noErr) {        seven_five_three = (response == 0x00000753);        if (seven_five_three) {            err = Gestalt('sysu', &amp;updateversion);            is_an_update = (err == noErr);        }    }    /* at this point, seven_five_three will be true if system 7.5.3    is the current operating system, and is_an_update will be true    if the current system version was established by update. if    is_an_update is true, updateversion will contain the System    update's version number (0x02038000 for system 7.5.3 revision 2). */</pre>	</TD></TR></TABLE></CENTER><P><A HREF="#top">Back to top</A></P><a name = "RTFToC5"></a><h2>Changes in the "About This Macintosh" Dialog Box</h2><P>When System 7.5.3 Revision 2 is installed, the second line of the "About ThisMacintosh" dialog box becomes "Updated to Revision 2." Due to some unresolved Finder issues, the copyright string displayed in the "About This Macintosh" dialog box does not change; the first release of this Technote claimed that it did.</p><p align=center><img src="images/tn1050_004.gif" alt="" width=193 height=94></p><p align=center><b>Figure 2</b>. "About This Macintosh" dialog box with System 7.5 Update 2.0</p><p align="center"><img src="images/tn1050_005.gif" alt="" width=197 height=97></p><P align=center><b>Figure 3</b>. "About This Macintosh" dialog box with System 7.5.3 Revision 2</p><P><A HREF="#top">Back to top</A></P><A NAME="References"></a><H2>References</h2><p>Technote <A HREF = "tn1017.html">1017, "System 7.5 Update 2.0; Macintosh System 7.5.3."</a></p><p>Technote <A HREF = "tn1040.html">1040, "Write Cache Flushing: Techniques for Properly Handling SystemShutdown."</a></p><P><A HREF="#top">Back to top</A></P>         <P><A NAME=Downloads></A></P>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (108K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/tn1050.pdf">Download</A></P>               </TD>            </TR></TABLE><P><A HREF="#top">Back to top</A></P></TD></TR></table></center><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tn/tn1050.html%3Fid%3DDTS10002891-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tn/tn1050.html%3Fid%3DDTS10002891-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tn/tn1050.html%3Fid%3DDTS10002891-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>