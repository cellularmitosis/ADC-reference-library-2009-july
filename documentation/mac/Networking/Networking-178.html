<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Summary of ATP(IM:N)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING178></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Networking-177.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Networking-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Networking-304.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt= "Book Index"></A> <A HREF="Networking-179.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Networking-2.html"><B>Networking</B></A> / <BR><DD><A HREF="Networking-143.html"><B>Chapter 6 - AppleTalk Transaction Protocol (ATP)</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING178-0></A>
<H1>Summary of ATP</H1>
<A NAME=HEADING178-1></A>
<H2>Pascal Summary</H2>
<A NAME=HEADING178-2></A>
<H3>Constants</H3>
<PRE>
CONST
   {csCodes}
   nSendRequest         = 248;         {send request using a specific socket}
   relRspCB             = 249;         {release RspCB}
   closeATPSkt          = 250;         {close ATP socket}
   addResponse          = 251;         {add response}
   sendResponse         = 252;         {send response}
   getRequest           = 253;         {get request}
   openATPSkt           = 254;         {open ATP socket}
   sendRequest          = 255;         {send request}
   relTCB               = 256;         {release TCB}
   killGetReq           = 257;         {kill getRequest}
   killSendReq          = 258;         {kill sendRequest}
   killAllGetReq        = 259;         {kill all getRequests for a socket}
   {ATP flags}
   atpXOvalue              = 32;       {ATP exactly-once bit}
   atpEOMvalue             = 16;       {ATP end-of-message bit}
   atpSTSvalue             = 8;        {ATP send-transmission-status bit}
   atpTIDValidvalue        = 2;        {ATP trans. ID valid bit}
   atpSendChkvalue         = 1;        {ATP send checksum bit}
</PRE>
<A NAME=HEADING178-5></A>
<H3><A NAME=MARKER-21-272></A>Data Types</H3>
<A NAME=HEADING178-6></A>
<H4>The Buffer Data Structure </H4>
<PRE>
TYPE  BDSElement = 
   RECORD
      buffSize:   Integer;
      buffPtr:    Ptr;
      dataSize:   Integer;
      userBytes:  LongInt;
   END;
BDSType = ARRAY[0..7] OF BDSElement;
BDSPtr = ^BDSType;
BitMapType = PACKED ARRAY[0..7] OF Boolean;
</PRE>
<A NAME=HEADING178-8></A>
<H4>The Address Block Record</H4>
<PRE>
TYPE AddrBlock = 
   PACKED RECORD
      aNet:          Integer;          {network number}
      aNode:         Byte;             {node ID}
      aSocket:       Byte;             {socket number}
   END;
</PRE>
<A NAME=HEADING178-10></A>
<H4>The ATP Parameter Block</H4>
<PRE>
TYPE ATPParamBlock = 
   PACKED RECORD
      qLink:         QElemPtr;         {next queue entry}
      qType:         Integer;          {queue type}
      ioTrap:        Integer;          {routine trap}
      ioCmdAddr:     Ptr;              {routine address}
      ioCompletion:  ProcPtr;          {completion routine}
      ioResult:      OSErr;            {result code}
      userData:      Longint;          {ATP user bytes}
      reqTID:        Integer;          {request transaction ID}
      ioRefNum:      Integer;          {driver reference number}
      csCode:        Integer;          {call command code }
                                       { automatically set}
      atpSocket:     Byte;             {currBitMap or socket number}
      CASE MPPParmType OF 
         SendRequestParm,
         SendResponseParm,
         GetRequestParm,
         AddResponseParm,
         KillSendReqParm:
            (atpFlags:        Byte;    {control information}
            addrBlock:        AddrBlock;  
                                       {source/dest. socket address}
            reqLength:        Integer; {request/response length}
            reqPointer:       Ptr;     {ptr to request/response data}
            bdsPointer:       Ptr;     {ptr to response BDS}
         CASE MPPParmType OF
            SendRequestParm:
               (numOfBuffs:   Byte;    {number of responses expected}
               timeOutVal:    Byte;    {timeout interval}
               numOfResps:    Byte;    {number of responses }
                                       { actually received}
               retryCount:    Byte;    {number of retries}
               intBuff:       Integer; {used internally for PNSendRequest}
               TRelTime:      Byte);   {TRelease time for extended }
                                       { send request}
            SendResponseParm:
               (filler0:      Byte;    {numOfBuffs}
               bdsSize:       Byte;    {number of BDS elements}
               transID:       Integer);{transaction ID}
            GetRequestParm:
               (bitMap:       Byte;    {bitmap}
               filler1:       Byte);
            AddResponseParm:
               (rspNum:       Byte;    {sequence number}
               filler2:       Byte);
            KillSendReqParm:
               (aKillQEl:     Ptr));   {pointer to queue element to cancel}
   END;

ATPPBPtr = ^ATPParamBlock;
</PRE>
<A NAME=HEADING178-12></A>
<H3>Routines</H3>
<A NAME=HEADING178-13></A>
<H4>Sending an ATP Request</H4>
<PRE>
FUNCTION PSendRequest(thePBPtr: ATPPBPt; async: Boolean): OSErr;
FUNCTION PNSendRequest(thePBPtr: ATPPBPtr; async: Boolean): OSErr;
</PRE>
<A NAME=HEADING178-16></A>
<H4>Opening and Closing an ATP Socket</H4>
<PRE>
FUNCTION POpenATPSkt(thePBptr: ATPPBPtr; async: Boolean): OSErr;
FUNCTION PCloseATPSkt(thePBPtr: ATPPBPtr; async: Boolean): OSErr;
</PRE>
<A NAME=HEADING178-19></A>
<H4>Setting Up a Socket to Listen for Requests</H4>
<PRE>
FUNCTION PGetRequest(thePBPtr: ATPPBPtr; async: Boolean): OSErr;
</PRE>
<A NAME=HEADING178-21></A>
<H4>Responding to Requests</H4>
<PRE>
FUNCTION PSendResponse(thePBPtr: ATPPBPtr; async: Boolean): OSErr;
FUNCTION PAddResponse(thePBPtr: ATPPBPtr; async: Boolean): OSErr;
</PRE>
<A NAME=HEADING178-24></A>
<H4>Canceling Pending ATP Functions </H4>
<PRE>
FUNCTION PKillSendReq(thePBPtr: ATPPBPtr; async: Boolean): OSErr;
FUNCTION PRelTCB(thePBPtr: ATPPBPtr; async: Boolean): OSErr;
FUNCTION PKillGetReq(thePBPtr: ATPPBPtr; async: Boolean): OSErr;
FUNCTION ATPKillAllGetReq(thePBPtr: ATPPBPtr; async: Boolean): OSErr;
FUNCTION PRelRspCB(thePBPtr: ATPPBPtr; async: Boolean): OSErr;
</PRE>
<A NAME=HEADING178-30></A>
<H4>Building a Buffer Data Structure</H4>
<PRE>
FUNCTION BuildBDS(buffPtr: Ptr; bdsPtr: Ptr; buffSize: Integer): 
Integer;
</PRE>
<A NAME=HEADING178-32></A>
<H2>C Summary</H2>
<A NAME=HEADING178-33></A>
<H3>Constants</H3>
<PRE>
/*ATP parameter constants*/
#define ATPioCompletion ATP.ioCompletion
#define ATPioResult ATP.ioResult
#define ATPuserData ATP.userData
#define ATPreqTID ATP.reqTID
#define ATPioRefNum ATP.ioRefNum
#define ATPcsCode ATP.csCode
#define ATPatpSocket ATP.atpSocket
#define ATPatpFlags ATP.atpFlags
#define ATPaddrBlock ATP.addrBlock
#define ATPreqLength ATP.reqLength
#define ATPreqPointer ATP.reqPointer
#define ATPbdsPointer ATP.bdsPointer
#define ATPtimeOutVal SREQ.timeOutVal
#define ATPnumOfResps SREQ.numOfResps
#define ATPretryCount SREQ.retryCount
#define ATPnumOfBuffs OTH1.u0.numOfBuffs
#define ATPbitMap OTH1.u0.bitMap
#define ATPrspNum OTH1.u0.rspNum
#define ATPbdsSize OTH2.bdsSize
#define ATPtransID OTH2.transID
#define ATPaKillQEl KILL.aKillQEl



/*csCodes*/
enum {                                 /*csCodes*/
   nSendRequest         = 248,         /*send request using a specific */
                                       /* socket*/
   relRspCB             = 249,         /*release RspCB*/
   closeATPSkt          = 250,         /*close ATP socket*/
   addResponse          = 251,         /*add response*/
   sendResponse         = 252,         /*send response*/
   getRequest           = 253,         /*get request*/
   openATPSkt           = 254,         /*open ATP socket*/
   sendRequest          = 255,         /*send request*/
   relTCB               = 256,         /*release TCB*/
   killGetReq           = 257,         /*kill getRequest*/
   killSendReq          = 258,         /*kill sendRequest*/
   killAllGetReq        = 259};        /*kill all getRequests for */
                                       /* a socket*/
/*ATP flags*/
enum {
   atpXOvalue              = 32,          /*ATP exactly-once bit*/
   atpEOMvalue             = 16,          /*ATP end-of-message bit*/
   atpSTSvalue             = 8,           /*ATP send-transmission-status */
                                          /* bit*/
   atpTIDValidvalue        = 2,           /*ATP trans. ID valid bit*/
   atpSendChkvalue         = 1};          /*ATP send checksum bit*/
</PRE>
<A NAME=HEADING178-36></A>
<H3>Data Types</H3>
<A NAME=HEADING178-37></A>
<H4>The Buffer Data Structure </H4>
<PRE>
struct   BDSElement {
   short       buffSize;
   Ptr         buffPtr;
   short       dataSize;
   long        userBytes;
};

typedef struct BDSElement BDSElement;
typedef BDSElement BDSType[8];
typedef BDSElement *BDSPtr;
typedef char BitMapType;
</PRE>
<A NAME=HEADING178-40></A>
<H4>The Address Block Record</H4>
<PRE>
struct AddrBlock {
   short             aNet;
   unsigned char     aNode;
   unsigned char     aSocket;
};

typedef struct AddrBlock AddrBlock; 
</PRE>
<A NAME=HEADING178-42></A>
<H4>The ATP Parameter Block</H4>
<PRE>
#define MPPATPHeader \
   QElem       *qLink;                 /*next queue entry*/\
   short       qType;                  /*queue type*/\
   short       ioTrap;                 /*routine trap*/\
   Ptr         ioCmdAddr;              /*routine address*/\
   ProcPtr     ioCompletion;           /*completion routine*/\
   OSErr       ioResult;               /*result code*/\
   long        userData;               /*command result (ATP user bytes)*/\
   short       reqTID;                 /*request transaction ID*/\
   short       ioRefNum;               /*driver reference number*/\
   short       csCode;                 /*call command code*/

typedef struct {
   MPPATPHeader 
}MPPparms;
#define MOREATPHeader \
   char        atpSocket;              /*currbitmap for requests or ATP */\
                                       /* socket number*/\
   char        atpFlags;               /*control information*/\
   AddrBlock   addrBlock;              /*source/dest. socket address*/\
   short       reqLength;              /*request/response length*/\
   Ptr         reqPointer;             /*pointer to request/response data*/\
   Ptr         bdsPointer;             /*pointer to response BDS*/

typedef struct {
   MPPATPHeader
   MOREATPHeader 
}ATPparms;



typedef struct {
   MPPATPHeader
   MOREATPHeader
   char        filler;                 /*numOfBuffs*/
   char        timeOutVal;             /*timeout interval*/
   char        numOfResps;             /*number of responses actually */
                                       /* received*/
   char        retryCount;             /*number of retries*/
   short       intBuff;                /*used internally for NSendRequest*/
   char        TRelTime;               /*TRelease time for extended send */
                                       /* request*/
}SendReqparms;
typedef struct {
    MPPATPHeader
    MOREATPHeader
   union {
      char     bitMap;                 /*bitmap received*/
      char     numOfBuffs;             /*number of responses being sent*/
      char     rspNum;                 /*sequence number*/
 } u0;
}ATPmisc1;
typedef struct {
   MPPATPHeader
   MOREATPHeader
   char           filler;
   char           bdsSize;             /*number of BDS elements*/
   short          transID;             /*transaction ID*/
}ATPmisc2;
typedef struct {
   MPPATPHeader
   MOREATPHeader
   Ptr            aKillQEl;            /*pointer to i/o queue element to */
                                       /* cancel*/
}Killparms;
union ATPParamBlock {
   ATPparms       ATP;                 /*general ATP parms*/
   SendReqparms   SREQ;                /*send request parms*/
   ATPmisc1       OTH1;                /*miscellaneous parms*/
   ATPmisc2       OTH2;                /*miscellaneous parms*/
   Killparms      KILL;                /*kill request parms*/
};
typedef union ATPParamBlock ATPParamBlock;
typedef ATPParamBlock *ATPPBPtr;
</PRE>
<A NAME=HEADING178-50></A>
<H3>Routines</H3>
<A NAME=HEADING178-51></A>
<H4>Sending an ATP Request</H4>
<PRE>
pascal OSErr PSendRequest(ATPPBPtr thePBPtr,Boolean async);
pascal OSErr PNSendRequest(ATPPBPtr thePBPtr,Boolean async); 
</PRE>
<A NAME=HEADING178-54></A>
<H4>Opening and Closing an ATP Socket</H4>
<PRE>
pascal OSErr POpenATPSkt(ATPPBPtr thePBptr,Boolean async); 
pascal OSErr PCloseATPSkt(ATPPBPtr thePBPtr,Boolean async); 
</PRE>
<A NAME=HEADING178-57></A>
<H4>Setting Up a Socket to Listen for Requests</H4>
<PRE>
pascal OSErr PGetRequest(ATPPBPtr thePBPtr,Boolean async);
</PRE>
<A NAME=HEADING178-59></A>
<H4>Responding to Requests</H4>
<PRE>
pascal OSErr PSendResponse(ATPPBPtr thePBPtr,Boolean async);
pascal OSErr PAddResponse(ATPPBPtr thePBPtr,Boolean async);
</PRE>
<A NAME=HEADING178-62></A>
<H4>Canceling Pending ATP Functions </H4>
<PRE>
pascal OSErr PKillSendReq(ATPPBPtr thePBPtr,Boolean async); 
pascal OSErr PRelTCB(ATPPBPtr thePBPtr,Boolean async);
pascal OSErr PKillGetReq(ATPPBPtr thePBPtr,Boolean async); 
pascal OSErr ATPKillAllGetReq
(ATPPBPtr thePBPtr,Boolean async); 
pascal OSErr PRelRspCB(ATPPBPtr thePBPtr,Boolean async); 
</PRE>
<A NAME=HEADING178-69></A>
<H4>Building a Buffer Data Structure</H4>
<PRE>
pascal short BuildBDS(Ptr buffPtr,Ptr bdsPtr,short buffSize); 
</PRE>
<A NAME=HEADING178-71></A>
<H2>Assembly-Language Summary</H2>
<A NAME=HEADING178-72></A>
<H3>Constants</H3>
<A NAME=HEADING178-73></A>
<H4>ATP Header</H4>
<PRE>
atpControl     EQU   0           ;control field (byte)
atpBitmap      EQU   1           ;bitmap (requests only) (byte)
atpRespNo      EQU   1           ;response number (responses only) (byte)
atpTransID     EQU   2           ;transaction ID (word)
atpUserData    EQU   4           ;start of user data (long)
atpHdSz        EQU   8           ;size of ATP header
</PRE>
<A NAME=HEADING178-75></A>
<H4>ATP Control Field</H4>
<PRE>
atpReqCode     EQU   $40         ;request code after masking
atpRspCode     EQU   $80         ;response code after masking
atpRelCode     EQU   $C0         ;release code after masking
atpXOBit       EQU   5           ;bit number of exactly-once bit
atpEOMBit      EQU   4           ;bit number of end-of-message bit
atpSTSBit      EQU   3           ;send transmission status bit number
flagMask       EQU   $3F         ;mask for just flags
controlMask    EQU   $F8         ;mask for good control bits
</PRE>
<A NAME=HEADING178-77></A>
<H4>ATP Type Code</H4>
<PRE>
atp            EQU   $3          ;ATP type code (in DDP header)
</PRE>
<A NAME=HEADING178-79></A>
<H4>ATP Limits</H4>
<PRE>
atpMaxNum      EQU   8           ;maximum number of responses per request
atpMaxData     EQU   $242        ;maximum data size in ATP packet
</PRE>
<A NAME=HEADING178-81></A>
<H4>ATP Command Codes</H4>
<PRE>
nSendRequest   EQU   248         ;PNSendRequest code
relRspCB       EQU   249         ;release RspCB
closeATPSkt    EQU   250         ;close ATP socket
addResponse    EQU   251         ;add response code
sendResponse   EQU   252         ;send response code 
getRequest     EQU   253         ;get request code
openATPSkt     EQU   254         ;open ATP socket
sendRequest    EQU   255         ;send request code
relTCB         EQU   256         ;release TCB
killGetReq     EQU   257         ;kill GetRequest
killSendReq    EQU   258         ;kill SendRequest
killAllGetReq  EQU   259         ;kill all getRequests for a socket
</PRE>
<A NAME=HEADING178-83></A>
<H4>ATPQueue Element Standard Structure</H4>
<PRE>
;arguments passed in the CSParam area
atpSocket      EQU   $1C         ;socket number is first parameter [byte]
atpFlags       EQU   $1D         ;flag [byte]
addrBlock      EQU   $1E         ;start of address block
reqLength      EQU   $22         ;size of request buffer [word]
reqPointer     EQU   $24         ;pointer to request buffer or data
bdsPointer     EQU   $28         ;pointer to buffer data structure (BDS)
guArea         EQU   $2C         ;start of general-use area
userData       EQU   $12         ;user bytes
</PRE>
<A NAME=HEADING178-86></A>
<H4>ATP Bits</H4>
<PRE>
sendCHK        EQU   0           ;bit number of send-checksum bit in flags
tidValid       EQU   1           ;bit set when TID valid in SendRequest
</PRE>
<A NAME=HEADING178-88></A>
<H3>Data Structures</H3>
<A NAME=HEADING178-89></A>
<H4>Buffer Data Structure (BDS)</H4>
<PRE>
bdsBuffSz      EQU   0           ;send: data length
                                 ; receive: buffer length
bdsBuffAdr     EQU   2           ;send: data address 
                                 ; receive: buffer address
bdsDataSz      EQU   6           ;send: used internally 
                                 ; receive: data length
bdsUserData    EQU   8           ;send: 4 user bytes 
                                 ; receive: 4 user bytes
bdsEntrySz     EQU   12          ;size of a BDS entry
</PRE>
<A NAME=HEADING178-91></A>
<H4>ATP Parameter Block Common Fields 
<TABLE BORDER="0" CELLPADDING=3><TD>0<TD>qLink<TD>long<TD>reserved<TR>
<TD>4<TD>qType<TD>word<TD>reserved<TR>
<TD>6<TD>ioTrap<TD>word<TD>reserved<TR>
<TD>8<TD>ioCmdAddr<TD>long<TD>reserved<TR>
<TD>12<TD>ioCompletion<TD>long<TD>address of completion routine<TR>
<TD>16<TD>ioResult<TD>word<TD>result code<TR>
<TD>18<TD>userData<TD>long<TD>user bytes<TR>
<TD>22<TD>reqTID<TD>word<TD>request transaction ID<TR>
<TD>24<TD>ioRefNum<TD>word<TD>driver reference number<TR>
<TD>26<TD>csCode<TD>word<TD>command code<TR>
<TD>28<TD>atpSocket<TD>byte<TD>current bitmap or socket number</TABLE>
</H4>
<A NAME=HEADING178-92></A>
<H4>SendRequest
<TABLE BORDER="0" CELLPADDING=3><TD>26<TD>csCode<TD>word<TD>command code; always <CODE>sendRequest</CODE><TR>
<TD>28<TD>currBitMap<TD>byte<TD>current bitmap<TR>
<TD>29<TD>atpFlags<TD>byte<TD>control information<TR>
<TD>30<TD>addrBlock<TD>long<TD>destination socket address<TR>
<TD>34<TD>reqLength<TD>word<TD>request size in bytes<TR>
<TD>36<TD>reqPointer<TD>long<TD>pointer to request data<TR>
<TD>40<TD>bdsPointer<TD>long<TD>pointer to response BDS<TR>
<TD>44<TD>numOfBuffs<TD>byte<TD>number of responses expected<TR>
<TD>45<TD>timeOutVal<TD>byte<TD>timeout interval<TR>
<TD>46<TD>numOfResps<TD>byte<TD>number of responses received<TR>
<TD>47<TD>retryCount<TD>byte<TD>number of retries<TR>
<TD>50<TD>TrelTime<TD>byte<TD>release time for extended send request</TABLE>
 Parameter Variant</H4>
<A NAME=HEADING178-93></A>
<H4>NSendRequest
<TABLE BORDER="0" CELLPADDING=3><TD>22<TD>reqTID<TD>word<TD>request transaction ID<TR>
<TD>26<TD>csCode<TD>word<TD>command code; always <CODE>nSendRequest</CODE><TR>
<TD>29<TD>atpFlags<TD>byte<TD>control information<TR>
<TD>30<TD>addrBlock<TD>long<TD>destination socket address<TR>
<TD>34<TD>reqLength<TD>word<TD>request size in bytes<TR>
<TD>36<TD>reqPointer<TD>long<TD>pointer to request data<TR>
<TD>40<TD>bdsPointer<TD>long<TD>pointer to response BDS<TR>
<TD>44<TD>numOfBuffs<TD>byte<TD>number of responses expected<TR>
<TD>45<TD>timeOutVal<TD>byte<TD>timeout interval<TR>
<TD>46<TD>numOfResps<TD>byte<TD>number of responses received<TR>
<TD>47<TD>retryCount<TD>byte<TD>number of retries<TR>
<TD>50<TD>TrelTime<TD>byte<TD>release time for extended send request</TABLE>
 Parameter Variant</H4>
<A NAME=HEADING178-94></A>
<H4>OpenATPSkt
<TABLE BORDER="0" CELLPADDING=3><TD>26<TD>csCode<TD>word<TD>command code; always <CODE>openATPSkt</CODE><TR>
<TD>30<TD>addrBlock<TD>long<TD>socket request specification</TABLE>
 Parameter Variant</H4>
<A NAME=HEADING178-95></A>
<H4>CloseATPSkt
<TABLE BORDER="0" CELLPADDING=3><TD>26<TD>csCode<TD>word<TD>command code; always <CODE>closeATPSkt</CODE></TABLE>
 Parameter Variant</H4>
<A NAME=HEADING178-96></A>
<H4>GetRequest
<TABLE BORDER="0" CELLPADDING=3><TD>22<TD>reqTID<TD>word<TD>request transaction ID<TR>
<TD>26<TD>csCode<TD>word<TD>command code; always <CODE>getRequest</CODE><TR>
<TD>29<TD>atpFlags<TD>byte<TD>control information<TR>
<TD>30<TD>addrBlock<TD>long<TD>destination socket address<TR>
<TD>34<TD>reqLength<TD>word<TD>request size in bytes<TR>
<TD>36<TD>reqPointer<TD>long<TD>pointer to request data<TR>
<TD>44<TD>bitMap<TD>byte<TD>current bitmap</TABLE>
 Parameter Variant</H4>
<A NAME=HEADING178-97></A>
<H4>SendResponse
<TABLE BORDER="0" CELLPADDING=3><TD>26<TD>csCode<TD>word<TD>command code; always <CODE>sendResponse</CODE><TR>
<TD>29<TD>atpFlags<TD>byte<TD>control information<TR>
<TD>30<TD>addrBlock<TD>long<TD>destination socket address<TR>
<TD>40<TD>bdsPointer<TD>long<TD>pointer to response BDS<TR>
<TD>44<TD>numOfBuffs<TD>byte<TD>number of responses expected<TR>
<TD>45<TD>bdsSize<TD>byte<TD>BDS size in elements<TR>
<TD>46<TD>transID<TD>word<TD>transaction ID</TABLE>
 Parameter Variant</H4>
<A NAME=HEADING178-98></A>
<H4>AddResponse
<TABLE BORDER="0" CELLPADDING=3><TD>26<TD>csCode<TD>word<TD>command code; always <CODE>addResponse</CODE><TR>
<TD>29<TD>atpFlags<TD>byte<TD>control information<TR>
<TD>30<TD>addrBlock<TD>long<TD>destination socket address<TR>
<TD>34<TD>reqLength<TD>word<TD>response size in bytes<TR>
<TD>36<TD>reqPointer<TD>long<TD>pointer to response data<TR>
<TD>44<TD>rspNum<TD>byte<TD>sequence number<TR>
<TD>46<TD>transID<TD>word<TD>transaction ID</TABLE>
 Parameter Variant</H4>
<A NAME=HEADING178-99></A>
<H4>KillSendReq
<TABLE BORDER="0" CELLPADDING=3><TD>26<TD>csCode<TD>word<TD>command code; always <CODE>killSendReq</CODE><TR>
<TD>44<TD>aKillQEl<TD>long<TD>pointer to queue element of function to be removed</TABLE>
 Parameter Variant</H4>
<A NAME=HEADING178-100></A>
<H4>RelTCB
<TABLE BORDER="0" CELLPADDING=3><TD>26<TD>csCode<TD>word<TD>command code; always <CODE>relTCB</CODE><TR>
<TD>30<TD>addrBlock<TD>long<TD>destination socket address of request<TR>
<TD>46<TD>transID<TD>word<TD>transaction ID of request to be canceled</TABLE>
 Parameter Variant</H4>
<A NAME=HEADING178-101></A>
<H4>KillGetReq Parameter Variant
<TABLE BORDER="0" CELLPADDING=3><TD>26<TD>csCode<TD>word<TD>command code; always <CODE>killGetReq</CODE><TR>
<TD>44<TD>aKillQEl<TD>long<TD>pointer to queue element of function to be removed</TABLE>
</H4>
<A NAME=HEADING178-102></A>
<H4>KillAllGetReq Parameter Variant
<TABLE BORDER="0" CELLPADDING=3><TD>26<TD>csCode<TD>word<TD>command code; always <CODE>killAllGetReq</CODE></TABLE>
</H4>
<A NAME=HEADING178-103></A>
<H4>RelRspCB
<TABLE BORDER="0" CELLPADDING=3><TD>26<TD>csCode<TD>word<TD>command code; always <CODE>relRspCB</CODE><TR>
<TD>30<TD>addrBlock<TD>long<TD>internet socket address of the source of the request<TR>
<TD>46<TD>transID<TD>word<TD>transaction ID of request with which the <CODE>PSendResponse</CODE> <BR>function to be canceled is associated</TABLE>
 Parameter Variant</H4>
<A NAME=HEADING178-104></A>
<H2>Result Codes
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>paramErr<TD>-50<TD>Version number is too high<TR>
<TD>reqFailed<TD>-1096<TD>Retry count exceeded<TR>
<TD>tooManyReqs<TD>-1097<TD>Too many concurrent requests<TR>
<TD>tooManySkts<TD>-1098<TD>Too many responding sockets<TR>
<TD>badATPSkt<TD>-1099<TD>Bad responding socket<TR>
<TD>badBuffNum<TD>-1100<TD>Sequence number out of range<TR>
<TD>noRelErr<TD>-1101<TD>No release received<TR>
<TD>cbNotFound<TD>-1102<TD>The <CODE>aKillQEl</CODE> parameter does not point to a <CODE>PSendRequest</CODE> or <CODE>PNSendRequest</CODE> queue element<TR>
<TD>noSendResp<TD>-1103<TD><CODE>PAddResponse</CODE> issued before <CODE>PSendResponse</CODE><TR>
<TD>noDataArea<TD>-1104<TD>Too many outstanding ATP calls<TR>
<TD>reqAborted<TD>-1105<TD>Request canceled<A NAME=MARKER-2-186></A></TABLE>
</H2>
 <P>
</BLOCKQUOTE><P>

</BLOCKQUOTE>
<HR>
<center>
<A HREF="Networking-177.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Networking-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Networking-304.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt= "Book Index"></A> <A HREF="Networking-179.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Networking-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
