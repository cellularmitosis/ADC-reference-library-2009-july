<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>OTConnect</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING177></A>
<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->

<!-- Main Body -->

<CENTER>
<P>
<A HREF="NetworkingWOT-176.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="NetworkingWOT-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="NetworkingWOT-491.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A>  <A HREF="NetworkingWOT-178.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html"><B>Inside Macintosh:</B></A> <A HREF="NetworkingWOT-2.html"><B>Networking With Open Transport </B></A> / <A HREF="NetworkingWOT-81.html"><B>Part 2 - Open Transport Reference</B></A><BR><DD><A HREF="NetworkingWOT-127.html"><B>Chapter 22 - Endpoints Reference</B></A> / <A HREF="NetworkingWOT-146.html"><B>Functions</B></A><BR><DL><DD><A HREF="NetworkingWOT-176.html"><B>Establishing Connection</B></A> / </DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING177-0></A>
<H3><A NAME=MARKER-9-199></A>OTConnect</H3>
 Requests a connection to a remote peer.<P>
<A NAME=HEADING177-2></A>
<H5>C INTERFACE</H5>
<PRE>
<A NAME=MARKER-11-200></A>OSStatus OTConnect(EndpointRef ref, 
                     TCall* sndCall, 
                     TCall* rcvCall);
</PRE>
<A NAME=HEADING177-4></A>
<H5>C++ INTERFACE</H5>
<PRE>
<A NAME=MARKER-12-201></A>OSStatus TEndpoint::Connect(TCall* sndCall, 
                     TCall* rcvCall);
</PRE>
<A NAME=HEADING177-6></A>
<H5>PARAMETERS</H5>
<DL>
<DT><CODE>ref</CODE>
<DD> The endpoint reference of the endpoint initiating the connection.<P>
<DT><CODE>sndCall</CODE>
<DD> A pointer to a structure<A HREF=NetworkingWOT-142.html#MARKER-9-103><CODE>TCall</CODE> structure</A>. You must allocate buffers, store the appropriate address, option, and data in them, and specify their length.<P>
<DT>
<DD> The <CODE>sndCall-&gt;addr.buf</CODE> field points to a buffer that specifies the address of the passive peer. The <CODE>sndCall-&gt;addr.len</CODE> field specifies the size of the address in bytes.<P>
<DT>
<DD> The <CODE>sndCall-&gt;opt.buf</CODE> field points to a buffer that specifies the options you want to negotiate. The <CODE>sndCall-&gt;opt.len</CODE> field specifies the size of the buffer in bytes.<P>
<DT>
<DD> The <CODE>sndCall-&gt;udata.buf</CODE> field points to a buffer that contains data you want to send with the connection request. The <CODE>sndCall-&gt;udata.len</CODE> field specifies the size of the data in bytes.<P> 
<DT><CODE>rcvCall</CODE>
<DD> A pointer to a <A HREF=NetworkingWOT-142.html#MARKER-9-103><CODE>TCall</CODE></A> structure that stores information about the connection when the function returns. You can set this parameter to nil, inwhich case no information is returned to you.<P>
<DT>
<DD> This parameter is only meaningful for synchronous calls to the <CODE>OTConnect</CODE> function. In this case, you must allocate the buffers for address, options, and data returned, and you must specify their maximum length. You can set this to nil if you'e not interested in the result.<P>
<DT>
<DD> The <CODE>rcvCall-&gt;addr.buf</CODE> field points to a buffer that is used to store the address to which you are actually connected. Set the <CODE>rcvCall-&gt;addr.maxlen</CODE> field to the size of the buffer in bytes.<P>
<DT>
<DD> The <CODE>rcvCall-&gt;opt.buf</CODE> field points to a buffer in which the options that have actually been negotiated are stored. Set the <CODE>rcvCall-&gt;opt.maxlen</CODE> field to the size of the buffer in bytes.<P>
<DT>
<DD> The <CODE>rcvCall-&gt;udata.buf </CODE>field points to a buffer that contains data sent by the peer accepting the connection. Set the <CODE>rcvCall-&gt;udata.maxlen</CODE> field to the size of the buffer in bytes.<P>
<DT><I>function result</I>
<DD> An error code. See Discussion.
</DL>
<A NAME=HEADING177-18></A>
<H5>DISCUSSION</H5>
 If the endpoint is in synchronous mode, the <CODE>OTConnect</CODE> function returns after the connection is established and fills in the fields of the <CODE>rcvCall</CODE> parameter with the actual values associated with this connection. These might be different from the values you specified using the <CODE>sndCall</CODE> parameter. <P>
 If the <CODE>OTConnect</CODE> function returns with the <CODE>kOTLookErr</CODE> result, this might be either because of a pending <CODE>T_LISTEN</CODE> or <CODE>T_DISCONNECT</CODE> event. That is, either a connection request from another endpoint has interrupted execution of the function, or the remote endpoint has rejected the connection. If you don't have a notifier installed, you can call the <A HREF=NetworkingWOT-156.html#MARKER-9-143><CODE>OTLook</CODE></A> function to identify the event that caused the <CODE>kOTLookErr</CODE> result. If the event is <CODE>T_LISTEN</CODE>, you must accept or reject the incoming request and then continue processing the <CODE>OTConnect</CODE> function by calling the function <A HREF=NetworkingWOT-178.html#MARKER-9-202><CODE>OTRcvConnect</CODE></A>. If the event is <CODE>T_DISCONNECT</CODE>, you must call the <A HREF=NetworkingWOT-193.html#MARKER-9-239><CODE>OTRcvDisconnect</CODE></A>  functionto clear the error condition--that is, to deallocate memory and place the endpoint in the correct state.<P>
 If the endpoint is in asynchronous mode, the <CODE>OTConnect</CODE> function returns before the connection is established with a <CODE>kOTNoDataErr</CODE> result to indicate that the connection is in progress. When the connection is established, the endpoint provider calls your notifier, passing <CODE>T_CONNECT</CODE> for the <CODE>code</CODE> parameter. In response, you must call the <CODE>OTRcvConnect</CODE> function to read the connection parameters that would have been returned in the <CODE>rcvCall</CODE> parameter if the endpoint were in synchronous mode.<P>
 It is possible that the remote address returned in the <CODE>addr.buf</CODE> field of the <CODE>rcvCall</CODE> parameter is not the same as the address you requested using the <CODE>sndCall-&gt;addr</CODE> field. This happens when the remote peer accepts the connection on a different endpoint than the one receiving the connection request. <P>
 If the <CODE>OTConnect</CODE> function returns a result other than <CODE>kOTNoDataErr</CODE>, then the connection attempt has not been initiated and no events will be received.<P>
<A NAME=HEADING177-24></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 Not all endpoints support the sending of data with a connection request. Examine the <CODE>connect</CODE> field of the <A HREF=NetworkingWOT-136.html#MARKER-9-81><CODE>TEndpointInfo</CODE></A> structure  for the endpoint to determine if the endpoint supports the sending of data and to determine the maximum size of the data.<P>
<A NAME=HEADING177-26></A>
<H5>SEE ALSO</H5>
 <A HREF=NetworkingWOT-414.html#MARKER-9-27>"AppleTalk Reference"</A>.<P>
 <A HREF=NetworkingWOT-27.html#MARKER-9-12>Table 4-4 </A>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="NetworkingWOT-176.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="NetworkingWOT-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="NetworkingWOT-491.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A>  <A HREF="NetworkingWOT-178.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="NetworkingWOT-4.html">&copy; Apple Computer, Inc.</A><br>15 JAN 1998<P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML> 
