<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE> Handling Asynchronous I/O</TITLE></HEAD><BODY BGCOLOR="#ffffff"><DIV><a name="top"></a><!-- start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!-- start of path --><font face="Geneva,Helvetica,Arial" size="1"><b><br>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Documentation</a> &gt; <!-- a href="" target="_top" -->Hardware<!-- /a -->  <b>&gt; </b><a href="../../devicemgrs.html" target="_top">Device Managers and Drivers</a> <b>&gt; </b><a href="../pci_srvcs.html" target="_top">PCI Card Services</a> <b>&gt; </b>Designing PCI Cards and Drivers for Power Macintosh Computers</font><br><br><!-- end of path --><A HREF="PCI_BOOK.b6.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.c8.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.ca.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><HR></DIV><H1 CLASS="H2.Heading2"><A NAME="pgfId=3974"> </A><A NAME="32891"> </A>Handling Asynchronous I/O</H1><P CLASS="T1.Text1"><A NAME="pgfId=3977"> </A><A NAME="marker=3975"> </A><A NAME="marker=3976"> </A>If you design any of your driver routines to execute asynchronously, you must provide a mechanism for the driver to complete the requests. Some examples of routines that you might use are the following:</P><UL><LI CLASS="B1.Bullet1"><A NAME="pgfId=3979"> </A><B CLASS="bold">Completion routines:</B><A NAME="marker=3978"> </A> Completion routines are provided by Device Manager clients to let the Device Manager notify the client when an I/O process is finished.</LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=3981"> </A><B CLASS="bold">Interrupt handlers:</B><A NAME="marker=3980"> </A> If the driver serves a hardware device that generates interrupts, you can create an interrupt handler that responds to these interrupts. The interrupt handler must clear the source of the interrupt and return as quickly as possible. For more&nbsp;information about interrupts and how to install an interrupt handler, see <A HREF="PCI_BOOK.16b.html#32981" CLASS="XRef">Interrupt Management</A>.</LI></UL><P CLASS="T1.Text1"><A NAME="pgfId=3986"> </A><A NAME="marker=3985"> </A>Clients of the Device Manager that make asynchronous calls should observe these guidelines when using asynchronous routines:</P><UL><LI CLASS="B1.Bullet1"><A NAME="pgfId=3987"> </A>Once you pass a parameter block to an asynchronous routine, it is out of your control. You should not examine or change the parameter block until the completion routine is called because you have no way of knowing the state of the parameter block.</LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=3988"> </A>Do not dispose of or reuse a parameter block until the asynchronous request is completed. For example, if you declare the parameter block as a local variable, the function cannot return until the request is complete because local variables are allocated on the stack and released when a function returns.</LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=3989"> </A>Use a completion routine to determine when an asynchronous routine has completed, rather than polling the <TT CLASS="cv">ioResult</TT> field of the parameter block. Polling the <TT CLASS="cv">ioResult</TT> field is not efficient and defeats the purpose of asynchronous operation. </LI></UL><HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 26 March 99)<P><A HREF="PCI_BOOK.b6.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.c8.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.ca.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></HTML>