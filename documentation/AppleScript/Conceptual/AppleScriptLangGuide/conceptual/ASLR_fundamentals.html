<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>AppleScript Language Guide: AppleScript Fundamentals</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="AppleScript Fundamentals"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40000983-CH218" title="AppleScript Fundamentals"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../ScriptingAutomation/index.html#//apple_ref/doc/uid/TP30000440-TP40005948" target="_top">Scripting &amp; Automation</a> &gt; <a href="../../../../ScriptingAutomation/AppleScript-date.html#//apple_ref/doc/uid/TP30000440-TP40005948-TP30000481" target="_top">AppleScript</a> &gt; <a href="../index.html" target="_top">AppleScript Language Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="ASLR_lexical_conventions.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="ASLR_variables.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40000983-CH218-SW2" title="AppleScript Fundamentals"></a><h1>AppleScript Fundamentals</h1><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_268"></a>This chapter describes basic concepts that underlie the terminology and rules covered in the rest of this guide.</p><ul class="ul"><li class="li"><p><span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW36">“Script Editor Application”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW1">“AppleScript and Objects”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW7">“Object Specifiers”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW21">“Coercion (Object Conversion)”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW3">“Scripting Additions”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW8">“Commands Overview”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW10">“AppleScript Error Handling”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-BAJBDEJI">“Global Constants in AppleScript”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW4">“The it and me Keywords”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW28">“Aliases and Files”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW9">“Remote Applications”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW20">“Debugging AppleScript Scripts”</a></span></p></li></ul><a name="//apple_ref/doc/uid/TP40000983-CH218-SW36" title="Script Editor Application"></a><h2>Script Editor Application</h2><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_269"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_270"></a>The Script Editor application is located in <code>/Applications/AppleScript</code>. It provides the ability to edit, compile, and execute scripts, display application scripting terminologies, and save scripts in a variety of formats, such as compiled scripts, applications, and plain text.</p><p>Script Editor can display the result of executing an AppleScript script and can display a log of the Apple events that are sent during execution of a script. In the Script Editor Preferences, you can also choose to keep a history of recent results or event logs.</p><p>Script Editor has text formatting preferences for various types of script text, such as language keywords, comments, and so on. You can also turn on or off the Script Assistant, a code completion tool that can suggest and fill in scripting terms as you type. In addition, Script Editor provides a contextual menu to insert many types of boilerplate script statements, such as conditionals, comments, and error handlers.</p><p>A <strong>dictionary</strong> <a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_271"></a>is the part of a scriptable application that specifies the scripting terms it understands. You can choose File > Open Dictionary in Script Editor to display the dictionary<a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_272"></a> of a scriptable application or scripting addition on your computer. Or you can drag an application icon to the Script Editor icon to display its dictionary (if it has one).</p><p>To display a list that includes just the scriptable applications and scripting additions provided by Mac OS X, choose Window > Library. Double-click an item in the list to display its dictionary. <span class="content_text">Figure 2-1</span> shows the dictionary for the Finder application in Mac OS X v10.5. The dictionary is labeled as “Finder.sdef”. The sdef format, along with other terminology formats, is described in “Specifying Scripting Terminology” in <em><a href="../../AppleScriptX/index.html#//apple_ref/doc/uid/10000156i" target="_top">AppleScript Overview</a></em>.</p><br/><div><a name="//apple_ref/doc/uid/TP40000983-CH218-1153023-BBCCDDAF" title="Figure 2-1The Finder dictionary in Script Editor (in Mac OS X v10.5)"></a><p><a name="//apple_ref/doc/uid/TP40001568-1153023" title="Figure 2-1The Finder dictionary in Script Editor (in Mac OS X v10.5)"></a><strong>Figure 2-1&nbsp;&nbsp;</strong>The Finder dictionary in Script Editor (in Mac OS X v10.5)</p><img src = "../Art/finder_dictionary.jpg" alt = "The Finder dictionary in Script Editor (in Mac OS X v10.5)" ></div><br/><p>There are also third-party editors for AppleScript.</p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW1" title="AppleScript and Objects"></a><h2>AppleScript and Objects</h2><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_273"></a>AppleScript is an object-oriented language. When you write, compile, and execute scripts, everything you work with is an object. An <strong>object</strong> is an instantiation of a class definition, which can include properties and actions. AppleScript defines classes for the objects you most commonly work with, starting with the top-level <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW5">script</a></code> object, which is the overall script you are working in.</p><p>Within in a <code>script</code> object, you work with other objects, including:</p><ul class="ul"><li class="li"><p>AppleScript objects:</p><p>AppleScript defines classes for boolean values, scripts, text, numbers, and other kinds of objects for working in scripts; for a complete list, see <span class="content_text"><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-246384">“Class Reference.”</a></span></p></li><li class="li"><p>Mac OS X objects:</p><p>Scriptable parts of Mac OS X and applications distributed with it, such as Finder, System Events, and Database Events (located in <code>/System/Library/CoreServices</code>), define many useful classes.</p></li><li class="li"><p>Application objects:</p><p>Third-party scriptable applications define classes that support a wide variety of features.</p></li></ul><p>The following sections provide more detail about objects:</p><ul class="ul"><li class="li"><p><span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW15">“What Is in a Script Object”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW5">“Properties”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW14">“Elements”</a></span></p></li></ul><a name="//apple_ref/doc/uid/TP40000983-CH218-SW15" title="What Is in a Script Object"></a><h3>What Is in a Script Object</h3><p>When you enter AppleScript statements in script window in Script Editor, you are working in a top-level <code>script</code> object. All <code>script</code> object definitions follow the same syntax, except that a top-level <code>script</code> object does not have statements marking its beginning and end.</p><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_274"></a>A <code>script</code> object can contain the following:</p><ul class="spaceabove"><li class="li"><p>Property definitions (optional):</p><p>A property is a labeled container in which to store a value.</p></li><li class="li"><p>An explicit <code>run</code> handler (optional):</p><p>A <code>run</code> handler contains statements AppleScript executes when the script is run. (For more information, see <span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW15">“run Handlers.”</a></span>)</p></li><li class="li"><p>An implicit <code>run</code> handler (optional):</p><p>An implicit <code>run</code> handler consists of any statements outside of any contained handlers or <code>script</code> objects.</p></li><li class="li"><p>Additional handlers (optional):</p><p>A handler is the equivalent of a subroutine. (For details, see <span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-CJBIDBJH">“About Handlers.”</a></span>)</p></li><li class="li"><p>Additional <code>script</code> objects (optional):</p><p>A <code>script</code> object can contain nested <code>script</code> objects, each of which is defined just like a top-level <code>script</code> object, except that a nested <code>script</code> object is bracketed with statements that mark its beginning and end. (For details, see <span class="content_text"><a href="ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-BAJJCIAA">“Script Objects.”</a></span>)</p></li></ul><p>Here is an example of a simple script with one property, one handler, one nested <code>script</code> object, and an implicit <code>run</code> handler with two statements:</p><div class="codesample"><table><tr><td scope="row"><pre>property defaultClientName : "Mary Smith"<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>on greetClient(nameOfClient)<span></span></pre></td></tr><tr><td scope="row"><pre>    display dialog ("Hello " &amp; nameOfClient &amp; "!")<span></span></pre></td></tr><tr><td scope="row"><pre>end greetClient<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>script testGreet<span></span></pre></td></tr><tr><td scope="row"><pre>    greetClient(defaultClientName)<span></span></pre></td></tr><tr><td scope="row"><pre>end script<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>run testGreet --result: "Hello Mary Smith!"<span></span></pre></td></tr><tr><td scope="row"><pre>greetClient("Joe Jones") --result: "Hello Joe Jones!"<span></span></pre></td></tr></table></div><p>The first statement in the <code>run</code> handler is <code>run testGreet</code>, which runs the nested <code>script</code> object <code>testGreet</code>. That <code>script</code> object calls the handler <code>greetClient()</code>, passing the property <code>defaultClientName</code>. The handler displays a dialog, greeting the default client, Mary Smith.</p><p>The second statement in the <code>run</code> handler calls <code>greetClient()</code> directly, passing the string <code>"Joe Jones"</code>.</p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW5" title="Properties"></a><h3>Properties</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_275"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_276"></a>A <strong>property</strong> of an object is a characteristic that has a single value and a label, such as the <code>name</code> property of a window or the <code>month</code> property of a date. The definition for any AppleScript class includes the name and class for each of its properties. Property names must be unique within a class. Property values can be read/write or read only.</p><p>The AppleScript <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCGECID">date</a></code> class, for example, defines both read/write and read only properties. These include the <code>weekday</code> property, which is read only, and the <code>month</code>, <code>day</code>, and <code>year</code> properties, which are read/write. That’s because the value of the <code>weekday</code> property depends on the other properties—you can’t set an arbitrary weekday for an actual date.</p><p>The class of a property can be a simple class such as <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCIBBGG">boolean</a></code> or <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCHBDCJ">integer</a></code>, a composite class such as a <code>point</code> class (made up of two integers), or a more complex class.</p><p>Most classes only support predefined properties. However, for the <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW5">script</a></code> class, AppleScript lets you to define additional properties. For information on how to do this, see <span class="content_text"><a href="ASLR_variables.html#//apple_ref/doc/uid/TP40000983-CH223-SW2">“Defining Properties.”</a></span> You can also define properties for <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCDGEAH">record</a></code> objects.</p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW14" title="Elements"></a><h3>Elements</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_277"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_278"></a>An <strong>element</strong> is an object contained within another object. The definition for any AppleScript class includes the element types it can contain. An object can typically contain zero or more of each of its elements.</p><p>For a given element type, an object can contain many elements or none, and the number of elements that it contains may change over time. For example, it is possible for a <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCDBHIE">list</a></code> object to contain no items (it can be an empty list). At a later time, the same list might contain many items.</p><p>Whether you can add elements to or remove elements from an object depends on the class and the element. For example, a <code>text</code> object is immutable—you cannot add or remove text once the object is created. For a <code>list</code> object, you cannot remove items, but you can use the <code>set</code> command to add an item to the beginning or end:</p><div class="codesample"><table><tr><td scope="row"><pre>set myList to {1, "what", 3} --result: {1, "what", 3}<span></span></pre></td></tr><tr><td scope="row"><pre>set beginning of myList to 0<span></span></pre></td></tr><tr><td scope="row"><pre>set end of myList to "four"<span></span></pre></td></tr><tr><td scope="row"><pre>myList --result: {0, 1, "what", 3, "four"}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000983-CH218-SW7" title="Object Specifiers"></a><h2>Object Specifiers</h2><p>An <strong>object specifier</strong><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_279"></a> specifies the information needed to find another object in terms of the objects in which it is contained. An object specifier can refer to an application object, such as a window or file, or to an AppleScript object, such as an item in a list or a property in a record.</p><p>An object specifier is fully evaluated (or resolved) only when a script is run, not when it is compiled. A script can contain a valid object specifier (such as <code>third document of application "TextEdit"</code> that causes an error when the script is executed (because, for example, there may be less than three documents open).</p><p>Applications typically return object specifiers in response to commands. For example, if you ask the Finder for a window, it returns information that specifies the window object your script asked for (if it exists). The top-level container in an object specifier is typically the application itself.</p><p>You create an object specifier every time your script uses a phrase that describes the path to an object or property, such as <code>name of window 1 of application "Finder"</code>. When you use the <code><a href="../reference/ASLR_operators.html#//apple_ref/doc/uid/TP40000983-CH5g-SW1">a reference to</a></code> operator, it creates a <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCDJJDE">reference</a></code> object that wraps an object specifier.</p><p>The difference between an object specifier and the object it refers to is like the difference between a building address and the building itself. The address is a series of words and numbers, such as “2121 Oak Street, San Francisco, CA” that identifies a location (on a street, in a city, in a state). It is distinct from the building itself. If the building at that location is torn down and replaced with a new building, the address remains the same.</p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW23" title="What Is in an Object Specifier"></a><h3>What Is in an Object Specifier</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_280"></a>An object specifier describes an object type, a location, and how to distinguish the object from other objects of the same type in that location. These three types of information—the type, or class; the location, or container; and the distinguishing information, or reference form—allow you to specify any object.</p><p>In the following example, the class of the object is <code>paragraph</code>. The container is the phrase <code>of document 1</code>. Because this phrase is inside a <code>tell</code> statement, the <code>tell</code> statement provides the top-level container, <code>of application "TextEdit"</code>. The distinguishing information (the reference form) is the combination of the class, <code>paragraph</code>, and an index value, <code>1</code>, which together indicate the first paragraph.</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "TextEdit"<span></span></pre></td></tr><tr><td scope="row"><pre>    paragraph 1 of document 1<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><div class="notebox"><a name="//apple_ref/doc/uid/TP40000983-CH218-SW39" title="Note"></a><p><strong>Note:</strong>&nbsp;If you examine the dictionary for the TextEdit application, you might think this script should say <code>paragraph 1 of text of document 1</code>. However, where the meaning is unambiguous, some applications make life easier for scripters by allowing them to omit a container from an object specifier. TextEdit uses this feature in supplying an <a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_281"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_282"></a><em>implicitly specified subcontainer</em> for the text in a document. That is, if an object specifier identifies an object, such as a word or paragraph, that is contained in a document’s text, TextEdit automatically supplies the <code>of text</code> part of the object specifier.</p></div><p>In addition to the index reference form, you can specify objects in a container by name, by range, by ID, and by the other forms described in <span class="content_text"><a href="../reference/ASLR_reference_forms.html#//apple_ref/doc/uid/TP40000983-CH4g-120522">“Reference Forms.”</a></span></p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW24" title="Containers"></a><h3>Containers</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_283"></a>A container is an object that contains one or more objects or properties. In an object specifier, a container specifies where to find an object or a property. To specify a container, use the word <code>of</code> or <code>in</code>, as in the following statement (from a Finder <code>tell</code> block):<a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_284"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_285"></a></p><div class="codesample"><table><tr><td scope="row"><pre>folder "Applications" of startup disk<span></span></pre></td></tr></table></div><p>A container can be an object or a series of objects, listed from the innermost to the outermost containing object, as in the following:</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "Finder"<span></span></pre></td></tr><tr><td scope="row"><pre>    first item of first folder of first disk<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>You can also use the possessive form (<code>'s</code>) to specify containers. In the following example, the innermost container is <code>first window</code> and the object it contains is a <code>name</code> property:<a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_286"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_287"></a></p><div class="codesample"><table><tr><td scope="row"><pre>tell application "TextEdit"<span></span></pre></td></tr><tr><td scope="row"><pre>    first window's name<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>In this example, the target of the <code>tell</code> statement (<code>"TextEdit"</code>) is the outer container for the object specifier.</p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW25" title="Absolute and Relative Object Specifiers"></a><h3>Absolute and Relative Object Specifiers</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_288"></a>An <a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_289"></a><strong>absolute object specifier</strong> has enough information to identify an object or objects uniquely. It can be used unambiguously anywhere in a script. For a reference to an application object to be absolute, its outermost container must be the application itself, as in:</p><div class="codesample"><table><tr><td scope="row"><pre>version of application "Finder" --result: "10.5.1"<span></span></pre></td></tr></table></div><p>In contrast, <a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_290"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_291"></a>a <strong>relative object specifier</strong> does not specify enough information to identify an object or objects uniquely; for example:</p><div class="codesample"><table><tr><td scope="row"><pre>name of item 1 of disk 2<span></span></pre></td></tr></table></div><p>When AppleScript encounters a relative object specifier in a <code>tell</code> statement, it attempts to use the default target specified by the statement to complete the object specifier. Though it isn’t generally needed, this implicit target can be specified explicitly using the keyword <code>it</code>, which is described in <span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW4">“The it and me Keywords.”</a></span></p><p>The default target of a <code>tell</code> statement is the object that receives commands if no other object is specified. For example, the following <code>tell</code> statement tells the Finder to get a name using the previous relative object specifier.</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "Finder"<span></span></pre></td></tr><tr><td scope="row"><pre>    name of item 1 of disk 2<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>When AppleScript encounters a relative object specifier outside any <code>tell</code> statement, it tries to complete the object specifier by looking up the inheritance chain described in <span class="content_text"><a href="ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-SW5">“Inheritance in Script Objects.”</a></span></p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW27" title="Object Specifiers in Reference Objects"></a><h3>Object Specifiers in Reference Objects</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_292"></a>When you can create a <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCDJJDE">reference</a></code> object  with the <a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_293"></a><code><a href="../reference/ASLR_operators.html#//apple_ref/doc/uid/TP40000983-CH5g-SW1">a reference to</a></code> operator, it contains an object specifier. For example:</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "TextEdit"<span></span></pre></td></tr><tr><td scope="row"><pre>    set docRef to a reference to the first document<span></span></pre></td></tr><tr><td scope="row"><pre>    --result: document 1 of application "TextEdit"<span></span></pre></td></tr><tr><td scope="row"><pre>        -- an object specifier<span></span></pre></td></tr><tr><td scope="row"><pre>    name of docRef --result: "New Report.rtf"<span></span></pre></td></tr><tr><td scope="row"><pre>        -- name of the specified object<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>In this script, the variable <code>docRef</code> is a reference whose object specifier refers to the first document of the application TextEdit—which happens to be named “New Report.rtf” in this case. However, the object that <code>docRef</code> refers to can change. If you open a second TextEdit document called “Second Report.rtf” so that its window is in front of the previous document, then run this script again, it will return the name of the now-frontmost document, “Second Report.rtf”.</p><p>You could instead create a reference with a more specific object specifier:</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "TextEdit"<span></span></pre></td></tr><tr><td scope="row"><pre>    set docRef to a reference to document "New Report.rtf"<span></span></pre></td></tr><tr><td scope="row"><pre>    --result: document "New Report.rtf" of application "TextEdit"<span></span></pre></td></tr><tr><td scope="row"><pre>    name of docRef --result: "New Report.rtf"<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>If you run this script after opening a second document, it will still return the name of the original document, “New Report.rtf”, if the document exists.</p><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_294"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_295"></a>After you create a <code>reference</code> object with the <code>a reference to</code> operator, you can use the <code>contents</code> property to get the value of the object that it refers to. That is, using the <code>contents</code> property causes the reference’s object specifier to be evaluated. In the following script, for example, the content of the variable <code>myWindow</code> is the window reference itself.<a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_296"></a></p><div class="codesample"><table><tr><td scope="row"><pre>set myWindow to a ref to window "Q1.rtf" of application "TextEdit"<span></span></pre></td></tr><tr><td scope="row"><pre>myWindow<span></span></pre></td></tr><tr><td scope="row"><pre>    -- result: window "Q1.rtf" of application "TextEdit" (object specifier)<span></span></pre></td></tr><tr><td scope="row"><pre>contents of myWindow<span></span></pre></td></tr><tr><td scope="row"><pre>    --result: window id 283 of application "TextEdit" (an evaluated window)<span></span></pre></td></tr><tr><td scope="row"><pre>get myWindow<span></span></pre></td></tr><tr><td scope="row"><pre>    -- result: window "Q1.rtf" of application "TextEdit" (object specifier)<span></span></pre></td></tr></table></div><p>Note that the result of the <code>get</code> command is to return the reference’s object specifier, not to resolve the specifier to the object it specifies.</p><p>When it can, AppleScript will implicitly dereference a reference object (without use of the <code>contents</code> property), as in the following example:</p><div class="codesample"><table><tr><td scope="row"><pre>set myWindow to a ref to window 1 of application "TextEdit"<span></span></pre></td></tr><tr><td scope="row"><pre>name of myWindow --result: "Q1.rtf" (if that is the first window's name)<span></span></pre></td></tr></table></div><p>For related information, see the Discussion section for the <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCDJJDE">reference</a></code> class.</p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW21" title="Coercion (Object Conversion)"></a><h2>Coercion (Object Conversion)</h2><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_297"></a><strong>Coercion</strong> (also known as <a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_298"></a><strong>object conversion</strong>) is the process of converting objects from one class to another. AppleScript converts an object to a different class in either of these circumstances:</p><ul class="ul"><li class="li"><p>in response to the <code>as</code> operator<a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_299"></a></p></li><li class="li"><p>automatically, when an object is of a different class than was expected for a particular command or operation</p></li></ul><p>Not all classes can be coerced to all other class types. <span class="content_text">Table 2-1</span> summarizes the coercions that AppleScript supports for commonly used classes. For more information about each coercion, see the corresponding class definition in <span class="content_text"><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-246384">“Class Reference.”</a></span></p><p>AppleScript provides many coercions, either as a built-in part of the language or through the Standard Additions scripting addition. You can use these coercions outside of a <code>tell</code> block in your script. However, coercion of application class types may be dependent on the application and require a <code>tell</code> block that targets the application.</p><p>The <code>as</code> operator specifies a specific coercion. For example, the following statement coerces the integer <code>2</code> into the text <code>"2"</code> before storing it in the variable <code>myText</code>:</p><div class="codesample"><table><tr><td scope="row"><pre>set myText to 2 as text<span></span></pre></td></tr></table></div><p>If you provide a command parameter or operand of the wrong class, AppleScript automatically coerces the operand or parameter to the expected class, if possible. If the conversion can’t be performed, AppleScript reports an error.</p><p>When coercing <code>text</code> strings to values of class <code>integer</code>, <code>number</code>, or <code>real</code>, or vice versa, AppleScript uses the current Numbers settings in the Formats pane in International preferences to determine what separators to use in the string. When coercing strings to values of class <code>date</code> or vice versa, AppleScript uses the current Dates settings in the Formats pane.<a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_300"></a></p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW12" title="Table 2-1Default coercions supported by AppleScript"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 2-1&nbsp;&nbsp;</strong>Default coercions supported by AppleScript</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Convert from class</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>To class</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Notes</p></th></tr><tr><td  scope="row"><p><code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW3">alias</a></code></p></td><td ><p><code>list</code> (single-item)</p><p><code>text</code></p></td><td ><p></p></td></tr><tr><td  scope="row"><p><code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW2">application</a></code></p></td><td ><p><code>list</code> (single-item)</p></td><td ><p>This is both an AppleScript class and an application class.</p></td></tr><tr><td  scope="row"><p><code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCIBBGG">boolean</a></code></p></td><td ><p><code>integer</code></p><p><code>list</code> (single-item)</p><p><code>text</code></p></td><td ><p></p></td></tr><tr><td  scope="row"><p><code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCFEDGB">class</a></code></p></td><td ><p><code>list</code> (single-item)</p><p><code>text</code></p></td><td ><p></p></td></tr><tr><td  scope="row"><p><code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCECDHC">constant</a></code></p></td><td ><p><code>list</code> (single-item)</p><p><code>text</code></p></td><td ><p></p></td></tr><tr><td  scope="row"><p><code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCGECID">date</a></code></p></td><td ><p><code>list</code> (single-item)</p><p><code>text</code></p></td><td ><p></p></td></tr><tr><td  scope="row"><p><code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW17">file</a></code></p></td><td ><p><code>list</code> (single-item)</p><p><code>text</code></p></td><td ><p></p></td></tr><tr><td  scope="row"><p><code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCHBDCJ">integer</a></code></p></td><td ><p><code>list</code> (single-item)</p><p><code>real</code></p><p><code>text</code></p></td><td ><p>Coercing an <code>integer</code> to a <code>number</code> does not change its class.</p></td></tr><tr><td  scope="row"><p><code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCDBHIE">list</a></code> (single-item)</p></td><td ><p>any class to which the item can be coerced if it is not part of a list</p></td><td ><p></p></td></tr><tr><td  scope="row"><p><code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCDBHIE">list</a></code> (multiple-item)</p></td><td ><p><code>text</code>, if each of the items in the list can be coerced to a <code>text</code> object</p></td><td ><p></p></td></tr><tr><td  scope="row"><p><code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCBJDGC">number</a></code></p></td><td ><p><code>integer</code></p><p><code>list</code> (single-item)</p><p><code>real</code></p><p><code>text</code></p></td><td ><p>Values identified as values of class <code>number</code> are really values of either class <code>integer</code> or class <code>real</code>.</p></td></tr><tr><td  scope="row"><p><code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW15">POSIX file</a></code></p></td><td ><p>see <code>file</code></p></td><td ><p><code>POSIX file</code> is a pseudo-class equivalent to the <code>file</code> class.</p></td></tr><tr><td  scope="row"><p><code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCJECEC">real</a></code></p></td><td ><p><code>integer</code></p><p><code>list</code> (single-item)</p></td><td ><p>In coercing to <code>integer</code>, any fractional part is rounded.</p><p>Coercing a <code>real</code> to a <code>number</code> does not change its class.</p></td></tr><tr><td  scope="row"><p><code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCDGEAH">record</a></code></p></td><td ><p><code>list</code></p></td><td ><p>All labels are lost in the coercion and the resulting list cannot be coerced back to a record.</p></td></tr><tr><td  scope="row"><p><code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCDJJDE">reference</a></code></p></td><td ><p>any class to which the referenced object can be coerced</p></td><td ><p></p></td></tr><tr><td  scope="row"><p><code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW5">script</a></code></p></td><td ><p><code>list</code> (single-item)</p></td><td ><p></p></td></tr><tr><td  scope="row"><p><code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCIAHJF">text</a></code></p></td><td ><p><code>integer</code></p><p><code>list</code> (single-item)</p><p><code>real</code></p></td><td ><p>Can coerce to <code>integer</code> or <code>real</code> only if the <code>text</code> object represents an appropriate number.</p></td></tr><tr><td  scope="row"><p><code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW8">unit types</a></code></p></td><td ><p><code>integer</code></p><p><code>list</code> (single-item)</p><p><code>real</code></p><p><code>text</code></p></td><td ><p>Can coerce between unit types in the same category, such as <code>inches</code> to <code>kilometers</code> (length) or <code>gallons</code> to <code>liters</code> (liquid volume).</p></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000983-CH218-SW3" title="Scripting Additions"></a><h2>Scripting Additions</h2><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_301"></a>A <strong>scripting addition</strong> is a file or bundle that provides handlers you can use in scripts to perform commands and coercions.</p><p>Many of the commands described in this guide are defined in the Standard Additions scripting addition in Mac OS X. These commands are stored in the file <code>StandardAdditions.osax</code> in <code>/System/Library/ScriptingAdditions</code>, and are available to any script. You can examine the terminology for the Standard Additions by opening this file in Script Editor.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000983-CH218-SW19" title="Note"></a><p><strong>Note:</strong>&nbsp;A script can obtain the location of the Standard Additions with this script statement, which uses the <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW19">path to (folder)</a></code> command:</p><div class="codesample"><table><tr><td scope="row"><pre>path to scripting additions as text<span></span></pre></td></tr><tr><td scope="row"><pre>    --result: "Hard_Disk:System:Library:ScriptingAdditions:"<span></span></pre></td></tr></table></div></div><p>Scripting additions can be embedded within bundled script applets by placing them in a folder named <code>Scripting Additions</code> (note the space between “Scripting” and “Additions”) inside the bundle’s <code>Contents/Resources/</code> folder. Note that Script Editor does not look for embedded scripting additions when editing bundled applets. During script development, any required scripting additions must be properly installed in <code>/System/ScriptingAdditions</code>, <code>/Library/ScriptingAdditions</code>, or <code>~/Library/ScriptingAdditions</code> so that Script Editor can find them.</p><p>Developers can create their own scripting additions, as described in Technical Note TN1164, <em><a href="../../../../../technotes/tn/tn1164.html#//apple_ref/doc/uid/DTS10003003" target="_top">Scripting Additions for Mac OS X</a></em>. For related conceptual information, see <em><a href="../../AppleScriptX/index.html#//apple_ref/doc/uid/10000156i" target="_top">AppleScript Overview</a></em>, particularly the section “Extending AppleScript with Coercions, Scripting Additions, and Faceless Background Applications” in the chapter <span class="content_text"><a href="../../AppleScriptX/Concepts/osa.html#//apple_ref/doc/uid/TP40001571" target="_top">Open Scripting Architecture</a></span>.</p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW8" title="Commands Overview"></a><h2>Commands Overview</h2><p>A <strong>command</strong> is a word or a series of words used in AppleScript statements to request an action. Every command is directed at a <strong>target</strong>, which is the object that responds to the command. The target is often an <strong>application object</strong><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_302"></a> (one that is stored in an application or its documents and managed by the application, such as a window or document) or an object in Mac OS X. However, it can also be a <code>script</code> object or a value in the current script.</p><p>Commands often return results. For example, the <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW12">display dialog</a></code> command returns a record that may contain text, a button name, and other information. Your script can examine this record to determine what to do next. You can assign the result of a command to a variable you define, or access it through the predefined AppleScript <code>result</code> variable.</p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW26" title="Types of Commands"></a><h3>Types of Commands</h3><p>Scripts can make use of the following kinds of commands:</p><ul class="spaceabove"><li class="li"><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_303"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_304"></a>An <strong>AppleScript command</strong> is one that is built into the AppleScript language. There currently are five such commands: <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW56">get</a></code> , <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW52">set</a></code>, <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW55">count</a></code>, <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW53">copy</a></code>, and <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW57">run</a></code>. Except for <code>copy</code> , each of these commands can also be implemented by applications. That is, there is an AppleScript version of the command that works on AppleScript objects, but an application can define its own version that works on the object types it defines.</p></li><li class="li"><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_305"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_306"></a>A <strong>scripting addition command</strong> is one that is implemented through the mechanism described in <span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW3">“Scripting Additions”</a></span>). Although anyone can create a scripting addition (see Technical Note TN1164, <em><a href="../../../../../technotes/tn/tn1164.html#//apple_ref/doc/uid/DTS10003003" target="_top">Scripting Additions for Mac OS X</a></em>), this guide documents only the scripting addition commands from the Standard Additions, supplied by Apple as part of Mac OS X. These commands are available to all scripts.</p></li><li class="li"><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_307"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_308"></a>A <strong>user-defined command</strong> is one that is implemented by a handler defined in a <code>script</code> object. To invoke a user-defined command outside of a <code>tell</code> statement, simply use its name and supply values for any parameters it requires. The command will use the current script as its target.</p><p>To invoke a user-defined command inside a <code>tell</code> statement, see <span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW1">“Calling Handlers in a tell Statement.”</a></span></p></li><li class="li"><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_309"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_310"></a>An <strong>application command</strong> is one that is defined by scriptable application to provide access to a scriptable feature. They are typically enclosed in a <code>tell</code> statement that targets the application. You can determine which commands an application supports by examining its dictionary in Script Editor.</p><p>Scriptable applications that ship with Mac OS X, such as the Finder and System Events applications (located in <code>/System/Library/CoreServices</code>), provide many useful scripting commands.</p><p>Third-party scriptable applications also provide commands you can use in scripts. Many support all or a subset of the Standard commands, described in Technical Note TN2106, <em><a href="../../../../../technotes/tn2002/tn2106.html#//apple_ref/doc/uid/DTS10003199" target="_top">Scripting Interface Guidelines</a></em>. These include commands such as <code>delete</code>, <code>duplicate</code>, <code>exists</code>, and <code>move</code>, as well as application implementations of AppleScript commands, such as <code>get</code> and <code>set</code>.</p></li></ul><a name="//apple_ref/doc/uid/TP40000983-CH218-SW18" title="Target"></a><h3>Target</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_311"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_312"></a>There are two ways to specify an object as the target of a command: by supplying it as the direct parameter of the command (described in the next section) or by specifying it as the target of a <code>tell</code> statement that contains the command. If a script doesn’t explicitly specify the target with a <code>tell</code> statement, and it isn’t handled by a handler in the script or by AppleScript itself, it is sent to the next object in the inheritance chain (see <span class="content_text"><a href="ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-SW15">“The AppleScript Inheritance Chain”</a></span>).</p><p>In the following script, the target of the <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW56">get</a></code> command is the object specifier <code>name of first window</code>. Because the enclosing <code>tell</code> statement specifies the Finder application, the full specifier is <code>name of first window of application "Finder"</code>, and it is the Finder application which obtains and returns the requested information.</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "Finder"<span></span></pre></td></tr><tr><td scope="row"><pre>    get name of first window<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>When a command targets an application, the result may be an application object. If so, subsequent statements that target the result object are sent to the application.</p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW13" title="Direct Parameter"></a><h3>Direct Parameter</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_313"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_314"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_315"></a>The <strong>direct parameter</strong> is a value, usually an object specifier, that appears immediately after a command and specifies the target of the command. Not all commands have a direct parameter. If a command can have a direct parameter, it is noted in the command’s definition.</p><p>In the following statement, the object specifier <code>last file of window 1 of application "Finder"</code> is the direct parameter of the <code>duplicate</code> command:</p><div class="codesample"><table><tr><td scope="row"><pre>duplicate last file of window 1 of application "Finder"<span></span></pre></td></tr></table></div><p>A <code>tell</code> statement specifies a default target for all commands contained within it, so the direct parameter is optional. The following example has the same result as the previous example:<a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_316"></a></p><div class="codesample"><table><tr><td scope="row"><pre>tell last file of window 1 of application "Finder"<span></span></pre></td></tr><tr><td scope="row"><pre>    duplicate<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000983-CH218-BAJHBFBA" title="Parameters That Specify Locations"></a><h3>Parameters That Specify Locations</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_317"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_318"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_319"></a>Many commands have parameters that specify locations. A location can be either an insertion point or another object. An <strong>insertion point</strong> is a location where an object can be added.<a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_320"></a></p><p>In the following example, the <code>to</code> parameter specifies the location to which to move the first paragraph. The value of the <code>to</code> parameter of the <code>duplicate</code> command is the relative object specifier <code>before paragraph 4</code>, which is an insertion point. AppleScript completes the specifier with the target of the <code>tell</code> statement, <code>front document of application "TextEdit"</code>.</p><div class="codesample"><table><tr><td scope="row"><pre>tell front document of application "TextEdit"<span></span></pre></td></tr><tr><td scope="row"><pre>    duplicate paragraph 1 to before paragraph 4<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>The phrases <code>paragraph 1</code> and <code>before paragraph 4</code> are called index and relative references, respectively. For more information, see <span class="content_text"><a href="../reference/ASLR_reference_forms.html#//apple_ref/doc/uid/TP40000983-CH4g-120522">“Reference Forms.”</a></span></p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW10" title="AppleScript Error Handling"></a><h2>AppleScript Error Handling</h2><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_321"></a>During script execution, errors may occur due to interaction with Mac OS X, problems encountered in an application script command, or problems caused by statements in the script itself. When an error occurs, AppleScript stops execution at the current location, signals an error, and looks up the calling chain for script statements that can handle the error. That is, it looks for the nearest error-handling code block that surrounds the location where the error occurred.</p><p>Scripts can handle errors by enclosing statements that may encounter an error within a <code><a href="../reference/ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-129232">try</a></code> statement. The <code>try</code> statement includes an <code>on error</code> section that is invoked if an error occurs. AppleScript passes information about the error, including an error number and an error message, to the <code>on error</code> section. This allows scripts to examine the error number and to display information about it.</p><p>If the error occurs within a handler that does not provide a <code>try</code> statement, AppleScript looks for an enclosing <code>try</code> statement where the handler was invoked. If none of the calls in the call chain is contained in a <code>try</code> statement, AppleScript stops execution of the script and displays an error message (for any error number other than -128, described below).</p><p>A script can use an <code><a href="../reference/ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-129678">error</a></code> statement to signal an error directly. Doing so invokes the AppleScript error handling mechanism, which looks for an enclosing <code>try</code> statement to handle the error.</p><p>Some “errors” are the result of the normal operation of a command. For example, commands such as <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW12">display dialog</a></code> and <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW4">choose file</a></code> signal <a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_322"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_323"></a><code>error –128</code> (User canceled), if the user clicks the Cancel button. Scripts routinely handle the user canceled error to ensure normal operation. For an example of how to do this, see the Examples section for the <code>display dialog</code> command. If no <code>try</code> statement in a script handles the -128 error, AppleScript halts execution of the script without displaying any error message.<a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_324"></a></p><p>For related information, see <span class="content_text"><a href="ASLR_lexical_conventions.html#//apple_ref/doc/uid/TP40000983-CH214-SW19">“Results,”</a></span> <span class="content_text"><a href="../reference/ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-129657">“error Statements,”</a></span> <span class="content_text"><a href="../reference/ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-128973">“try Statements,”</a></span> <span class="content_text"><a href="../reference/ASLR_error_codes.html#//apple_ref/doc/uid/TP40000983-CH220-SW5">“Error Numbers and Error Messages,”</a></span> and <span class="content_text"><a href="../reference/ASLR_error_xmpls.html#//apple_ref/doc/uid/TP40000983-CH221-SW1">“Working with Errors.”</a></span></p><a name="//apple_ref/doc/uid/TP40000983-CH218-BAJBDEJI" title="Global Constants in AppleScript"></a><h2>Global Constants in AppleScript</h2><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_325"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_326"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_327"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_328"></a>AppleScript defines a number of global constants that you can use anywhere in a script.</p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW38" title="AppleScript Constant"></a><h3>AppleScript Constant</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_329"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_330"></a>The global constant <code>AppleScript</code> provides access to properties you can use throughout your scripts.</p><p>You can use the <code>AppleScript</code> identifier itself to distinguish an AppleScript property from a property of the current target with the same name, as shown in the section <span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW6">“version.”</a></span></p><p>The following sections describe additional properties of <code>AppleScript</code>.</p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW29" title="pi"></a><h4>pi</h4><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_331"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_332"></a>This <code>mathematical</code> value represents the ratio of a circle's circumference to its diameter. It is defined as a real number with the value 3.14159265359.</p><p> For example, the following statement computes the area of a circle with radius 7:</p><div class="codesample"><table><tr><td scope="row"><pre>set circleArea to pi * 7 * 7 --result: 153.9380400259<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000983-CH218-SW40" title="result"></a><h4>result</h4><p>When a statement is executed, AppleScript stores the resulting value, if any, in the predefined property <a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_333"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_334"></a><code>result</code>. The value remains there until another statement is executed that generates a value. Until a statement that yields a result is executed, the value of <code>result</code> is undefined. You can examine the result in Script Editor by looking in the Result pane of the script window.<a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_335"></a></p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000983-CH218-SW43" title="Note"></a><p><strong>Note:</strong>&nbsp;When an error occurs during script execution, AppleScript signals an error. It doesn’t return error information in the <code>result</code> property. For more information, see <span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW10">“AppleScript Error Handling.”</a></span></p></div><a name="//apple_ref/doc/uid/TP40000983-CH218-SW30" title="Text Constants"></a><h4>Text Constants</h4><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_336"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_337"></a>AppleScript defines the text properties <code>space</code>, <code>tab</code>, <code>return</code>, <code>linefeed</code>, and <code>quote</code>. You effectively use these properties as text constants to represent white space or a double quote (<code>"</code>) character. They are described in the Special String Characters section of the <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCIAHJF">text</a></code> class.</p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW22" title="text item delimiters"></a><h4>text item delimiters</h4><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_338"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_339"></a>AppleScript provides the <code>text item delimiters</code> property for use in processing text. This property consists of a list of strings used as delimiters by AppleScript when it coerces a list to text or gets text items from text strings. AppleScript currently uses only the first delimiter in the list.</p><p>Because <code>text item delimiters</code> respect <code>considering</code> and <code>ignoring</code> attributes in AppleScript 2.0, delimiters are case-insensitive by default. Formerly, they were always case-sensitive. To enforce the previous behavior, add an explicit <code>considering case</code> statement.</p><p>You can get and set the current value of the <code>text item delimiters</code> property. Normally, AppleScript doesn’t use any delimiters. For example, if the text delimiters have not been explicitly changed, the statement</p><div class="codesample"><table><tr><td scope="row"><pre>{"bread", "milk", "butter", 10.45}  as string<span></span></pre></td></tr></table></div><p>returns the following:</p><div class="codesample"><table><tr><td scope="row"><pre>"breadmilkbutter10.45"<span></span></pre></td></tr></table></div><p>For printing or display purposes, it is usually preferable to set <code>text item delimiters</code> to something that’s easier to read. For example, the script</p><div class="codesample"><table><tr><td scope="row"><pre>set AppleScript's text item delimiters to {", "}<span></span></pre></td></tr><tr><td scope="row"><pre>{"bread", "milk", "butter", 10.45}  as string<span></span></pre></td></tr></table></div><p>returns this result:</p><div class="codesample"><table><tr><td scope="row"><pre>"bread, milk, butter, 10.45"<span></span></pre></td></tr></table></div><p>The <code>text item delimiters</code> property can be used to extract individual names from a pathname. For example, the script</p><div class="codesample"><table><tr><td scope="row"><pre>set AppleScript's text item delimiters to {":"}<span></span></pre></td></tr><tr><td scope="row"><pre>get last text item of "Hard Disk:CD Contents:Release Notes"<span></span></pre></td></tr></table></div><p>returns the result <code>"Release Notes"</code>.</p><p>If you change the <code>text item delimiters</code> property in Script Editor, it remains changed until you restore its previous value or until you quit Script Editor and launch it again. If you change <code>text item delimiters</code> in a script application, it remains changed in that application until you restore its previous value or until the script application quits; however, the delimiters are not changed in Script Editor or in other script applications you run.</p><p>Scripts commonly use an error handler to reset the <code>text item delimiters</code> property to its former value if an error occurs (for more on dealing with errors, see <span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW10">“AppleScript Error Handling”</a></span>):</p><div class="codesample"><table><tr><td scope="row"><pre>set savedDelimiters to AppleScript's text item delimiters<span></span></pre></td></tr><tr><td scope="row"><pre>try<span></span></pre></td></tr><tr><td scope="row"><pre>    set AppleScript's text item delimiters to {"**"}<span></span></pre></td></tr><tr><td scope="row"><pre>    --other script statements...<span></span></pre></td></tr><tr><td scope="row"><pre>    --now reset the text item delimiters:<span></span></pre></td></tr><tr><td scope="row"><pre>    set AppleScript's text item delimiters to savedDelimiters<span></span></pre></td></tr><tr><td scope="row"><pre>on error m number n<span></span></pre></td></tr><tr><td scope="row"><pre>    --also reset text item delimiters in case of an error:<span></span></pre></td></tr><tr><td scope="row"><pre>    set AppleScript's text item delimiters to savedDelimiters<span></span></pre></td></tr><tr><td scope="row"><pre>    --and resignal the error:<span></span></pre></td></tr><tr><td scope="row"><pre>    error m number n<span></span></pre></td></tr><tr><td scope="row"><pre>end try<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000983-CH218-SW6" title="version"></a><h4>version</h4><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_340"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_341"></a>This property provides the current version of AppleScript. The following script shows how to check for a version greater than or equal to version 1.9. The <code>if</code> statement is wrapped in a <code>considering numeric strings</code> statement so that an AppleScript version such as <code>1.10.6</code> compares as larger than, say, version <code>1.9</code>.</p><div class="codesample"><table><tr><td scope="row"><pre>considering numeric strings<span></span></pre></td></tr><tr><td scope="row"><pre>    if version of AppleScript as string ≥ "1.9" then<span></span></pre></td></tr><tr><td scope="row"><pre>        -- Perform operations that depend on version 1.9 or greater<span></span></pre></td></tr><tr><td scope="row"><pre>    else<span></span></pre></td></tr><tr><td scope="row"><pre>        -- Handle case where version is not high enough<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end considering<span></span></pre></td></tr></table></div><p>Applications can have their own <code>version</code> property, so to access the AppleScript version explicitly, you use the phrase <code>version of AppleScript</code>. This will work inside a <code>tell</code> block that targets another application, such as the following:</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "Finder"<span></span></pre></td></tr><tr><td scope="row"><pre>    version --result: "10.5.1"<span></span></pre></td></tr><tr><td scope="row"><pre>    version of AppleScript --result: "2.0"<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000983-CH218-SW41" title="current application Constant"></a><h3>current application Constant</h3><p>The <a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_342"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_343"></a><code>current application</code> constant refers to the application that is executing the current AppleScript script (for example, Script Editor). Because the current application is the parent of AppleScript <a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_344"></a>(see <span class="content_text"><a href="ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-SW15">“The AppleScript Inheritance Chain”</a></span>), it gets a chance to handle commands that aren’t handled by the current script or by AppleScript.</p><p>The <code>current application</code> constant is an object specifier—if you ask AppleScript for its value, the result is the object specifier:</p><div class="codesample"><table><tr><td scope="row"><pre>get current application --result: current application<span></span></pre></td></tr></table></div><p>However, if you ask for <code>name of current application</code>, AppleScript resolves the object specifier and returns the current application’s name:</p><div class="codesample"><table><tr><td scope="row"><pre>name of current application --result: "Script Editor"<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000983-CH218-SW44" title="missing value Constant"></a><h3>missing value Constant</h3><p>The <a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_345"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_346"></a><code>missing value</code> constant is a placeholder for missing or uninitialized information.</p><p>For example, the following statements use the <code>missing value</code> constant to determine if a variable has changed:</p><div class="codesample"><table><tr><td scope="row"><pre>set myVariable to missing value<span></span></pre></td></tr><tr><td scope="row"><pre>    -- perform operations that might change the value of myVariable<span></span></pre></td></tr><tr><td scope="row"><pre>if myVariable is equal to missing value then<span></span></pre></td></tr><tr><td scope="row"><pre>    -- the value of the variable never changed<span></span></pre></td></tr><tr><td scope="row"><pre>else<span></span></pre></td></tr><tr><td scope="row"><pre>    -- the value of the variable did change<span></span></pre></td></tr><tr><td scope="row"><pre>end if<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000983-CH218-SW42" title="true, false Constants"></a><h3>true, false Constants</h3><p>AppleScript defines the <a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_347"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_348"></a>Boolean constants <a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_349"></a><code>true</code> and <a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_350"></a><code>false</code>. These constants are described with the <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCIBBGG">boolean</a></code> class.</p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW4" title="The it and me Keywords"></a><h2>The it and me Keywords</h2><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_351"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_352"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_353"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_354"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_355"></a>AppleScript defines the keyword <code>me</code> to refer to the current script and the keyword <code>it</code> to refer to the current target. (The <a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_356"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_357"></a><strong>current script</strong> is the one that is currently being executed; the <a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_358"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_359"></a><strong>current target</strong> is the object that is the current default target for commands.) It also defines <code>my</code> as a synonym for <code>of me</code> and <code>its</code><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_360"></a> as a synonym for <code>of it</code>.</p><p>If a script hasn’t targeted anything, <code>it</code> and <code>me</code> refer to the same thing—the script—as shown in the following example:</p><div class="codesample"><table><tr><td scope="row"><pre>-- At the top-level of the script:<span></span></pre></td></tr><tr><td scope="row"><pre>me --result: «script» (the top-level script object)<span></span></pre></td></tr><tr><td scope="row"><pre>it --result: «script» (same as it, since no target set yet)<span></span></pre></td></tr></table></div><p>A <code>tell</code> statement specifies a default target. In the following example, the default target is the Finder application:</p><div class="codesample"><table><tr><td scope="row"><pre>-- Within a tell block:<span></span></pre></td></tr><tr><td scope="row"><pre>tell application "Finder" -- sets target<span></span></pre></td></tr><tr><td scope="row"><pre>    me --result: «script» (still the top-level script object)<span></span></pre></td></tr><tr><td scope="row"><pre>    it --result: application "Finder" (target of the tell statement)<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>You can use the words <code>of me</code> or <code>my</code> to indicate that the target of a command is the current script and not the target of the <code>tell</code> statement. In the following example, the word <code>my</code> indicates that <code>minimumValue()</code> handler is defined by the script, not by Finder:</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "Finder"<span></span></pre></td></tr><tr><td scope="row"><pre>    set fileCount to count files in front window<span></span></pre></td></tr><tr><td scope="row"><pre>    set myCount to my minimumValue(fileCount, 100)<span></span></pre></td></tr><tr><td scope="row"><pre>    --do something with up to the first 100 files…<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>You can also use <code>of me</code> or <code>my</code> to distinguish script properties from object properties. Suppose there is a TextEdit document open named “Simple.rtf”:</p><div class="codesample"><table><tr><td scope="row"><pre>tell document 1 of application "TextEdit"<span></span></pre></td></tr><tr><td scope="row"><pre>    name --result: "Simple.rtf" (implicitly uses target of tell)<span></span></pre></td></tr><tr><td scope="row"><pre>    name of it --result: "Simple.rtf" (specifies target of tell)<span></span></pre></td></tr><tr><td scope="row"><pre>    me --result: «script» (top-level script object, not target of tell)<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>The following example shows how to specify different <code>version</code> properties in a Finder <code>tell</code> statement. The Finder is the default target, but using <code>version of me</code>, <code>my version</code>, or <code>version of AppleScript</code> allows you to specify the version of the top-level <code>script</code> object. (The top-level <code>script</code> object returns the AppleScript version, because it inherits from AppleScript, as described in <span class="content_text"><a href="ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-SW15">“The AppleScript Inheritance Chain.”</a></span>)</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "Finder"<span></span></pre></td></tr><tr><td scope="row"><pre>    version --result: "10.5.1" (Finder version is the default in tell block)<span></span></pre></td></tr><tr><td scope="row"><pre>    its version --result: "10.5.1" (specifically asks for Finder version)<span></span></pre></td></tr><tr><td scope="row"><pre>    version of me --result: "2.0" (AppleScript version)<span></span></pre></td></tr><tr><td scope="row"><pre>    my version --result: "2.0" (AppleScript version)<span></span></pre></td></tr><tr><td scope="row"><pre>    version of AppleScript --result: "2.0" (AppleScript version)<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>For information on using <code>it</code> in a filter reference, see the Discussion section for the <span class="content_text"><a href="../reference/ASLR_reference_forms.html#//apple_ref/doc/uid/TP40000983-CH4g-BAJJHEFE">“Filter”</a></span> reference form.</p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW28" title="Aliases and Files"></a><h2>Aliases and Files</h2><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_361"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_362"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_363"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_364"></a>To refer to items and locations in the Mac OS X file system, you use <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW3">alias</a></code> objects and <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW17">file</a></code> objects.</p><p>An <code>alias</code> object is a dynamic reference to an existing file system object. Because it is dynamic, it can maintain the link to its designated file system object even if that object is moved or renamed.</p><p>A <code>file</code> object represents a specific file at a specific location in the file system. It can refer to an item that does not currently exist, such as the name and location for a file that is to be created. A <code>file</code> object is not dynamic, and always refers to the same location, even if a different item is moved into that place. The <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW15">POSIX file</a></code> pseudo-class is roughly synonymous with file: <code>POSIX file</code> specifiers evaluate to a <code>file</code> object, but they use different semantics for the name, as described in <span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW11">“Specifying Paths.”</a></span></p><p>The following is the recommended usage for these types:</p><ul class="ul"><li class="li"><p>Use an <code>alias</code> object to refer to existing file system objects.</p></li><li class="li"><p>Use a <code>file</code> object to refer to a file that does not yet exist.</p></li><li class="li"><p>Use a <code>POSIX file</code> specifier if you want to specify the file using a POSIX path.</p></li></ul><p>The following sections describe how to specify file system objects by path and how to work with them in your scripts.</p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW11" title="Specifying Paths"></a><h3>Specifying Paths</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_365"></a>You can create <code>alias</code> objects and <code>file</code> objects by supplying a name specifier, where the name is the path to an item in the file system.</p><p>For alias and file specifiers, the path is an HFS path, which takes the form <code>"disk:item:subitem:subsubitem:...:item"</code>. For example, <code>"Hard_Disk:Applications:Mail.app"</code> is the HFS path to the Mail application, assuming your boot drive is named <code>"Hard_Disk"</code>.</p><p>HFS paths with a leading colon, such as <code>":folder:file"</code>, are resolved relative to the HFS working directory. However, their use is discouraged, because the location of the HFS working directory is unspecified, and there is no way to control it from AppleScript.</p><p>For POSIX file specifiers, the path is a POSIX path, which takes the form <code>"/item/subitem/subsubitem/.../item"</code>. The disk name is not required for the boot disk. For example, <code>"/Applications/Mail.app"</code> is the POSIX path to the Mail application. You can see the POSIX path of an item in Finder in the "Where" field of its Get Info window. Despite the name, POSIX file specifiers may refer to folders or disks. Use of <code>"~"</code> to specify a home directory is not supported.</p><p>POSIX paths without a leading slash, such as <code>"folder/file"</code>, are resolved relative to the POSIX working directory. This is supported, but only is useful for scripts run from the shell—the working directory is the current directory in the shell. The location of the POSIX working directory for applications is unspecified.</p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW33" title="Working With Aliases"></a><h3>Working With Aliases</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_366"></a>AppleScript defines the <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW3">alias</a></code> class to represent aliases. An alias can be stored in a variable and used throughout a script.</p><p>The following script first creates an alias to an existing file in the variable <code>notesAlias</code>, then uses the variable in a <code>tell</code> statement that opens the file. It uses a <code><a href="../reference/ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-129232">try</a></code> statement to check for existence of the alias before creating it, so that the alias is only created once, even if the script is run repeatedly.</p><div class="codesample"><table><tr><td scope="row"><pre>try<span></span></pre></td></tr><tr><td scope="row"><pre>    notesAlias -- see if we've created the alias yet<span></span></pre></td></tr><tr><td scope="row"><pre>on error<span></span></pre></td></tr><tr><td scope="row"><pre>    -- if not, create it in the error branch<span></span></pre></td></tr><tr><td scope="row"><pre>    set notesAlias to alias "Hard_Disk:Users:myUser:Feb_Notes.rtf"<span></span></pre></td></tr><tr><td scope="row"><pre>end try<span></span></pre></td></tr><tr><td scope="row"><pre>-- now open the file from the alias:<span></span></pre></td></tr><tr><td scope="row"><pre>tell application "TextEdit" to open notesAlias<span></span></pre></td></tr></table></div><p>Finding the object an alias refers to is called <em>resolving</em> an alias. AppleScript 2.0 attempts to resolve aliases only when you run a script. However, in earlier versions, AppleScript attempts to resolve aliases at compile time.</p><p>Once you run the previous example, creating the alias, the script will be able to find the original file when you run it again, even if the file’s name or location changes. (However, if you run the script again after recompiling it, it will create a new alias.)</p><p>You can get the HFS path from an alias by coercing it to text:</p><div class="codesample"><table><tr><td scope="row"><pre>notesAlias as text --result: "Hard_Disk:Users:myUser:Feb_Notes.rtf"<span></span></pre></td></tr></table></div><p>You can use the <code>POSIX path</code> property to obtain a POSIX-style path to the item referred to by an alias:</p><div class="codesample"><table><tr><td scope="row"><pre>POSIX path of notesAlias --result: "/Feb_Notes.rtf"<span></span></pre></td></tr></table></div><p>If an alias doesn’t refer to an existing file system object then it is broken. You can’t create an alias to an object that doesn’t exist, such as a file you plan to create. For that you use a <code>file</code> object, described in the next section.</p><p>For a sample script that shows how a script application can process a list of aliases it receives when a user drops one or more file icons on it, see <span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW16">“open Handlers.”</a></span></p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW31" title="Working With Files"></a><h3>Working With Files</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_367"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_368"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_369"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_370"></a>AppleScript uses <code>file</code> objects to represent files in scripts. A <code>file</code> object can be stored in a variable and used throughout a script. The following script first creates a <code>file</code> object for an existing file in the variable <code>notesFile</code>, then uses the variable in a <code>tell</code> statement that opens the file:</p><div class="codesample"><table><tr><td scope="row"><pre>set notesFile to POSIX file "/Users/myUser/Feb_Meeting_Notes.rtf"<span></span></pre></td></tr><tr><td scope="row"><pre>tell application "TextEdit" to open notesFile<span></span></pre></td></tr></table></div><p>You can use a <code>file</code> object to specify a name and location for a file that may not exist:</p><div class="codesample"><table><tr><td scope="row"><pre>set newFile to POSIX file "/Users/myUser/BrandNewFile.rtf"<span></span></pre></td></tr></table></div><p>Similarly, you can let a user specify a new file with the <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW5">choose file name</a></code> command, then use the returned <code>file</code> object to create the file. In the following example, if the user cancels the <code>choose file name</code> dialog, the rest of the script is not executed. If the user does supply a file name, the script opens the file, creating it if necessary, then uses a <code>try</code> statement to make sure it closes the file when it is finished writing to it.</p><div class="codesample"><table><tr><td scope="row"><pre>set theFile to choose file name<span></span></pre></td></tr><tr><td scope="row"><pre>set referenceNumber to open for access theFile with write permission<span></span></pre></td></tr><tr><td scope="row"><pre>try<span></span></pre></td></tr><tr><td scope="row"><pre>    -- statements to write to the file<span></span></pre></td></tr><tr><td scope="row"><pre>on error<span></span></pre></td></tr><tr><td scope="row"><pre>    close access referenceNumber<span></span></pre></td></tr><tr><td scope="row"><pre>end try<span></span></pre></td></tr><tr><td scope="row"><pre>close access referenceNumber<span></span></pre></td></tr></table></div><p>Typically, when you pass a <code>file</code> object to a command that uses it to operate on a new or existing item in the file system, the components of the path must exist for the command to succeed.<a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_371"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_372"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_373"></a></p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW9" title="Remote Applications"></a><h2>Remote Applications</h2><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_374"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_375"></a>A script can target an application on a remote computer if remote applications are enabled on that computer, and if the script specifies the computer with an eppc-style specifier.</p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW34" title="Enabling Remote Applications"></a><h3>Enabling Remote Applications</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_376"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_377"></a>For a script to send commands to a remote application, the following conditions must be satisfied:</p><ul class="spaceabove"><li class="li"><p>The computer that contains the application and the computer on which the script is run must be connected to each other through a network.</p></li><li class="li"><p>Remote Apple Events (set in the Sharing preferences pane) must be enabled on the remote computer and user access must be provided (you can allow access for all users or for specified users only).</p></li><li class="li"><p>If the specified remote application is not running, you must run it.</p></li><li class="li"><p>You must authenticate as admin when you compile or run the script.</p></li></ul><a name="//apple_ref/doc/uid/TP40000983-CH218-SW37" title="eppc-Style Specifiers"></a><h3>eppc-Style Specifiers</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_378"></a>An eppc-style specifier takes the following format:</p><div class="codesample"><table><tr><td scope="row"><pre>eppc://[user[:password]@]IP_address<span></span></pre></td></tr></table></div><dl class="termdef">	<dt><code>ip_address</code></dt><dd><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_379"></a>Either a numeric IP address in dotted decimal form (four numbers, from 0 to 255, separated by periods; for example, <code>123.23.23.123</code>) or a hostname. A hostname can be a Bonjour name.</p></dd></dl><p>The following are examples of valid eppc-style specifiers. If you supply the user name and password, no authentication is required. If you do not supply it, authentication may be required.</p><div class="codesample"><table><tr><td scope="row"><pre>"eppc://myCoolMac.local" -- hostname, no user or pwd<span></span></pre></td></tr><tr><td scope="row"><pre>"eppc://myUserName:pwd@myCoolMac.local" -- user, pwd, and hostname<span></span></pre></td></tr><tr><td scope="row"><pre>"eppc://123.23.23.123" -- IP address, no user or pwd<span></span></pre></td></tr><tr><td scope="row"><pre>"eppc://myUserName:pwd@123.23.23.123" -- user, pwd, and IP address<span></span></pre></td></tr><tr><td scope="row"><pre>"eppc://myUserName@server.company.com" -- server address, user<span></span></pre></td></tr></table></div><div class="importantbox"><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_9" title="Important:"></a><p><strong>Important:</strong>&nbsp;If a part of the eppc-style specifier contains non-UTF-8 characters or white space, it must be URL-encoded: for example, here is a user name that contains a space:</p><p>   <code>John%20Smith</code>.</p><p></p></div><a name="//apple_ref/doc/uid/TP40000983-CH218-SW35" title="Targeting Remote Applications"></a><h3>Targeting Remote Applications</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_380"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_381"></a>You can target an application that is running on a remote machine and you can launch applications on remote machines that are not currently running.</p><p>The following example uses an eppc-style specifier to target the Finder on a remote computer. It includes a user name and password, so no authentication is required.</p><div class="codesample"><table><tr><td scope="row"><pre>set remoteMachine to "eppc://userName:pwd@MacName.local"<span></span></pre></td></tr><tr><td scope="row"><pre>tell app "Finder" of machine remoteMachine to close front window<span></span></pre></td></tr></table></div><div class="importantbox"><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_10" title="Important:"></a><p><strong>Important:</strong>&nbsp;If you compile an erroneous eppc-style address, you will have to quit and relaunch Script Editor for changes to that address to take effect.</p><p></p></div><p>In some cases, you’ll need to use a <code><a href="../reference/ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-SW1">using terms from</a></code> statement to tell AppleScript to compile against the local version of an application. The following example uses that technique in telling the remote Finder application to open the TextEdit application:</p><div class="codesample"><table><tr><td scope="row"><pre>set remoteFinder to application "Finder" of machine ¬<span></span></pre></td></tr><tr><td scope="row"><pre>    "eppc://myUserName:pwd@123.23.23.123"<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>using terms from application "Finder"<span></span></pre></td></tr><tr><td scope="row"><pre>    tell remoteFinder<span></span></pre></td></tr><tr><td scope="row"><pre>        open application file id "com.apple.TextEdit"<span></span></pre></td></tr><tr><td scope="row"><pre>    end tell<span></span></pre></td></tr><tr><td scope="row"><pre>end using terms from<span></span></pre></td></tr></table></div><p>If you omit the password (<code>pwd</code>) in the previous script, you will have to authenticate when you run the script.</p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW20" title="Debugging AppleScript Scripts"></a><h2>Debugging AppleScript Scripts</h2><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_382"></a>AppleScript does not include a built-in debugger, but it does provide several simple mechanisms to help you debug your scripts or just observe how they are working.</p><a name="//apple_ref/doc/uid/TP40000983-CH218-SW16" title="Feedback From Your Script"></a><h3>Feedback From Your Script</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_383"></a>You can insert various statements into a script to indicate the current location and other information. In the simplest case, you can insert a beep command in a location of interest:</p><div class="codesample"><table><tr><td scope="row"><pre>beep 3 -- three beeps; a very important part of the script!<span></span></pre></td></tr></table></div><p>A <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW12">display dialog</a></code> command can display information about what’s happening in a script and, like a breakpoint, it halts execution until you dismiss it (or until it times out, depending on the parameters you pass). The following example displays the current script location and the value of a variable:</p><div class="codesample"><table><tr><td scope="row"><pre>display dialog "In factorial routine; x = " &amp; (x as string)<span></span></pre></td></tr></table></div><p>The <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW13">say</a></code> command can get your attention by speaking the specified text. In the following example, <code>currentClient</code> is a <code>text</code> object that stores a client name:</p><div class="codesample"><table><tr><td scope="row"><pre>say "I'm in the clientName handler. The client is " &amp; currentClient<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000983-CH218-SW17" title="Logging"></a><h3>Logging</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_384"></a><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_385"></a>Script Editor can display a log of the Apple events that are sent during execution of a script. In the Script Editor Preferences, you can also choose to keep a history of recent results or event logs.</p><p>In addition, you can insert <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW49">log</a></code> statements into a script. Log output is shown in the Event Log pane of a script window, and also in the <a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_386"></a>Event Log History window, if it is open.</p><p>The following simple example logs the current word in a <code><a href="../reference/ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-128481">repeat with loopVariable (in list)</a></code> statement:</p><div class="codesample"><table><tr><td scope="row"><pre>set wordList to words in "Where is the hammer?"<span></span></pre></td></tr><tr><td scope="row"><pre>repeat with currentWord in wordList<span></span></pre></td></tr><tr><td scope="row"><pre>    log currentWord<span></span></pre></td></tr><tr><td scope="row"><pre>    if contents of currentWord is equal to "hammer" then<span></span></pre></td></tr><tr><td scope="row"><pre>        display dialog "I found the hammer!"<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end repeat<span></span></pre></td></tr></table></div><p>The following shows how the words appear in the log when the script is run:</p><div class="codesample"><table><tr><td scope="row"><pre>    (*Where*)<span></span></pre></td></tr><tr><td scope="row"><pre>    (*is*)<span></span></pre></td></tr><tr><td scope="row"><pre>    (*the*)<span></span></pre></td></tr><tr><td scope="row"><pre>    (*hammer*)<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000983-CH218-SW32" title="Third Party Debuggers"></a><h3>Third Party Debuggers</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_387"></a>If you need full-featured debugging capabilities, there are powerful, third-party AppleScript debuggers available.<a name="//apple_ref/doc/uid/TP40000983-CH218-DontLinkElementID_388"></a></p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="ASLR_lexical_conventions.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="ASLR_variables.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-03-11<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_fundamentals.html%3Fid%3DTP40000983-3.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_fundamentals.html%3Fid%3DTP40000983-3.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_fundamentals.html%3Fid%3DTP40000983-3.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>