<html><head><title>Mac OS X
 Manual Page For tcpd(8)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/8/tcpd" title="Mac OS X
 Manual Page for tcpd(8)"><!-- headerDoc=man; indexgroup=Section 8; uid="//apple_ref/doc/man/8/tcpd"; name=tcpd(8) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
TCPD(8)                                                                                              TCPD(8)



<b>NAME</b>
       tcpd - access control facility for internet services

<b>DESCRIPTION</b>
       The  <u>tcpd</u>  program  can  be  set  up to monitor incoming requests for <u>telnet</u>, <u>finger</u>, <u>ftp</u>, <u>exec</u>, <u>rsh</u>,
       <u>rlogin</u>, <u>tftp</u>, <u>talk</u>, <u>comsat</u> and other services that have a one-to-one mapping onto executable files.

       The program supports both 4.3BSD-style sockets and System V.4-style TLI.  Functionality may  be  lim-<font color="#ffffff" class="whiteout">ited&nbsp;limited</font>
       ited when the protocol underneath TLI is not an internet protocol.

       Operation  is  as  follows:  whenever a request for service arrives, the <u>inetd</u> daemon is tricked into
       running the <u>tcpd</u> program instead of the desired server. <u>tcpd</u> logs the request  and  does  some  addi-<font color="#ffffff" class="whiteout">tional&nbsp;additional</font>
       tional checks. When all is well, <u>tcpd</u> runs the appropriate server program and goes away.

       Optional  features  are:  pattern-based access control, client username lookups with the RFC 931 etc.
       protocol, protection against hosts that pretend to have  someone  elses  host  name,  and  protection
       against hosts that pretend to have someone elses network address.

<b>LOGGING</b>
       Connections  that are monitored by <u>tcpd</u> are reported through the <a href="../man3/syslog.3.html#//apple_ref/doc/man/3/syslog"><u>syslog</u>(3)</a> facility. Each record con-<font color="#ffffff" class="whiteout">tains&nbsp;contains</font>
       tains a time stamp, the client host name and the name of the requested service.  The information  can
       be  useful  to  detect unwanted activities, especially when logfile information from several hosts is
       merged.

       In order to find out where your logs are  going,  examine  the  syslog  configuration  file,  usually
       /etc/syslog.conf.

<b>ACCESS</b> <b>CONTROL</b>
       Optionally,  <u>tcpd</u>  supports  a  simple form of access control that is based on pattern matching.  The
       access-control software provides hooks for the execution of shell commands when a pattern fires.  For
       details, see the <a href="../man5/hosts_access.5.html#//apple_ref/doc/man/5/hosts_access"><u>hosts</u><b>_</b><u>access</u>(5)</a> manual page.

<b>HOST</b> <b>NAME</b> <b>VERIFICATION</b>
       The  authentication scheme of some protocols (<u>rlogin,</u> <u>rsh</u>) relies on host names. Some implementations
       believe the host name that they get from any random name server; other implementations are more care-<font color="#ffffff" class="whiteout">ful&nbsp;careful</font>
       ful but use a flawed algorithm.

       <u>tcpd</u> verifies the client host name that is returned by the address-&gt;name DNS server by looking at the
       host name and address that are returned by the name-&gt;address  DNS  server.   If  any  discrepancy  is
       detected,  <u>tcpd</u>  concludes  that  it  is dealing with a host that pretends to have someone elses host
       name.

       If the sources are compiled with -DPARANOID, <u>tcpd</u>  will  drop  the  connection  in  case  of  a  host
       name/address  mismatch.   Otherwise,  the  hostname  can be matched with the <u>PARANOID</u> wildcard, after
       which suitable action can be taken.

<b>HOST</b> <b>ADDRESS</b> <b>SPOOFING</b>
       Optionally, <u>tcpd</u> disables source-routing socket options on every connection that it deals with.  This
       will  take  care  of  most attacks from hosts that pretend to have an address that belongs to someone
       elses network. UDP services do not benefit from this protection. This feature must be  turned  on  at
       compile time.

<b>RFC</b> <b>931</b>
       When  RFC  931 etc. lookups are enabled (compile-time option) <u>tcpd</u> will attempt to establish the name
       of the client user. This will succeed only if the client  host  runs  an  RFC  931-compliant  daemon.
       Client  user  name  lookups will not work for datagram-oriented connections, and may cause noticeable
       delays in the case of connections from PCs.

<b>EXAMPLES</b>
       The details of using <u>tcpd</u> depend on pathname information that was compiled into the program.

<b>EXAMPLE</b> <b>1</b>
       This example applies when <u>tcpd</u> expects that the original network daemons will be moved to an  "other"
       place.

       In  order  to  monitor  access  to the <u>finger</u> service, move the original finger daemon to the "other"
       place and install tcpd in the place of the original finger daemon. No changes are required to config-<font color="#ffffff" class="whiteout">uration&nbsp;configuration</font>
       uration files.

            # mkdir /other/place
            # mv /usr/etc/in.fingerd /other/place
            # cp tcpd /usr/etc/in.fingerd

       The  example assumes that the network daemons live in /usr/etc. On some systems, network daemons live
       in /usr/sbin or in /usr/libexec, or have no `in.' prefix to their name.

<b>EXAMPLE</b> <b>2</b>
       This example applies when <u>tcpd</u> expects that the network daemons are left in their original place.

       In order to monitor access to the <u>finger</u> service, perform the following edits on the <u>inetd</u> configura-<font color="#ffffff" class="whiteout">tion&nbsp;configuration</font>
       tion file (usually <u>/etc/inetd.conf</u> or <u>/etc/inet/inetd.conf</u>):

            finger  stream  tcp  nowait  nobody  /usr/etc/in.fingerd  in.fingerd

       becomes:

            finger  stream  tcp  nowait  nobody  /some/where/tcpd     in.fingerd


       The  example assumes that the network daemons live in /usr/etc. On some systems, network daemons live
       in /usr/sbin or in /usr/libexec, the daemons have no `in.' prefix to  their  name,  or  there  is  no
       userid field in the inetd configuration file.

       Similar  changes  will be needed for the other services that are to be covered by <u>tcpd</u>.  Send a `kill
       -HUP' to the <!-- a --><u>inetd</u>(8)<!-- /a --> process to make the changes effective. AIX users may also have to  execute  the
       `inetimp' command.

<b>EXAMPLE</b> <b>3</b>
       In the case of daemons that do not live in a common directory ("secret" or otherwise), edit the <u>inetd</u>
       configuration file so that it specifies an absolute path name for the process name field.  For  exam-<font color="#ffffff" class="whiteout">ple:&nbsp;example:</font>
       ple:

           ntalk  dgram  udp  wait  root  /some/where/tcpd  /usr/local/lib/ntalkd


       Only the last component (ntalkd) of the pathname will be used for access control and logging.

<b>BUGS</b>
       Some  UDP  (and  RPC)  daemons linger around for a while after they have finished their work, in case
       another request comes in.  In the inetd configuration file these services  are  registered  with  the
       <u>wait</u> option. Only the request that started such a daemon will be logged.

       The program does not work with RPC services over TCP. These services are registered as <u>rpc/tcp</u> in the
       inetd configuration file. The only non-trivial service that is affected by this limitation  is  <u>rexd</u>,
       which is used by the <!-- a --><u>on(1)</u><!-- /a --><u></u> command. This is no great loss.  On most systems, <u>rexd</u> is less secure than
       a wildcard in /etc/hosts.equiv.

       RPC broadcast requests (for example: <u>rwall,</u> <u>rup,</u> <u>rusers</u>) always appear to come  from  the  responding
       host.  What  happens is that the client broadcasts the request to all <u>portmap</u> daemons on its network;
       each <u>portmap</u> daemon forwards the request to a local daemon. As far as the <u>rwall</u> etc.   daemons  know,
       the request comes from the local host.

<b>FILES</b>
       The default locations of the host access control tables are:

       /etc/hosts.allow
       /etc/hosts.deny

<b>SEE</b> <b>ALSO</b>
       <a href="../man5/hosts_access.5.html#//apple_ref/doc/man/5/hosts_access">hosts_access(5)</a>, format of the tcpd access control tables.
       <a href="../man5/syslog.conf.5.html#//apple_ref/doc/man/5/syslog.conf">syslog.conf(5)</a>, format of the syslogd control file.
       <!-- a -->inetd.conf(5)<!-- /a -->, format of the inetd control file.

<b>AUTHORS</b>
       Wietse Venema (wietse@wzv.win.tue.nl),
       Department of Mathematics and Computing Science,
       Eindhoven University of Technology
       Den Dolech 2, P.O. Box 513,
       5600 MB Eindhoven, The Netherlands




                                                                                                     TCPD(8)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man8/tcpd.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man8/tcpd.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man8/tcpd.8.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
