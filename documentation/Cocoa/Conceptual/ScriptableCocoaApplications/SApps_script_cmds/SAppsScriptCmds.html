<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Cocoa Scripting Guide: Script Commands</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Script Commands"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20001242" title="Script Commands"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../Scripting-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000569" target="_top">Scripting &amp; Automation</a> &gt; <a href="../SApps_intro/SAppsIntro.html#//apple_ref/doc/uid/TP40001982-BCICHGIE">Cocoa Scripting Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../SApps_object_specifiers/SAppsObjectSpecifiers.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../SApps_debugging/SAppsDebugging.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/20001242-BBCBCIJE" title="Script Commands"></a><h1>Script Commands</h1><p>Cocoa scripting uses script command objects to handle scripting-related Apple events received by your application. This chapter describes how script commands work, and how your application uses them to support its scriptable features.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW4">Script Commands Overview</a>
				
			<br/>
			
        
			
			
				<a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW2">Implementing an Object-First Command—Rotate</a>
				
			<br/>
			
        
			
			
				<a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW7">Implementing a Verb-First Command—Align</a>
				
			<br/>
			
        
			
			
				<a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW11">Modifying a Standard Command</a>
				
			<br/>
			
        
			
			
				<a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW5">Summary of AppleScript Command Support</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/20001242-SW4" title="Script Commands Overview"></a><h2>Script Commands Overview</h2><p><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_438"></a>When a user runs an AppleScript script, script statements that target your application are converted into corresponding Apple events and sent to the application. For each Apple event that corresponds to a command defined in your sdef, Cocoa scripting instantiates a <strong>script command object</strong> that contains all the information needed to describe the specified operation. It then executes the script command, which works with objects in your application to perform the operation.  The flow of Apple events is bidirectional and script commands can return values to the originating script.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001242-SW18" title="Note"></a><p><strong>Note:</strong>&nbsp;Cocoa's <code>NSApplication</code> class automatically registers handlers for certain Apple events, such as <code>open application</code> and <code>open documents</code>. These handlers are described in <span class="content_text"><a href="../SApps_handle_AEs/SAppsHandleAEs.html#//apple_ref/doc/uid/20001239-BBCBCIJE">“How Cocoa Applications Handle Apple Events.”</a></span></p></div><p>Cocoa scripting provides default support for many basic AppleScript commands, such as  <code>delete</code>, <code>move</code>, <code>get</code>, and <code>set</code>. This support is implemented by the <code>NSScriptCommand</code> class and a number of subclasses. In some cases, it also relies on command information that you must insert into your sdef file. Beyond that, however, the default support generally requires only that your scriptable objects follow the key-value coding guidelines described in <span class="content_text"><a href="../SApps_get_set/SAppsGetSet.html#//apple_ref/doc/uid/TP40002164-CH18-SW4">“Maintain KVC Compliance”</a></span> and that you implement object specifier methods for your scriptable classes, as described in <span class="content_text"><a href="../SApps_object_specifiers/SAppsObjectSpecifiers.html#//apple_ref/doc/uid/TP40002164-CH3-SW1">“Object Specifiers.”</a></span></p><p>You can define new subclasses of Cocoa's script command classes to modify their default behavior or to implement new AppleScript commands specific to your application. Or, in some cases, you can simply add a command-handling method to a scriptable class and provide information in your sdef file to specify when it should be called. This chapter includes detailed information on how to perform these kinds of operations.</p><a name="//apple_ref/doc/uid/20001242-SW12" title="Script Command Classes Supplied by Cocoa"></a><h3>Script Command Classes Supplied by Cocoa</h3><p>Cocoa defines Objective-C script command classes to implement the AppleScript commands from the Standard suite. These classes are listed in <span class="content_text"><a href="../SApps_script_classes/SAppsScriptClasses.html#//apple_ref/doc/uid/20000034-BBCGCAAD">Table 9-4</a></span>.  As part of Cocoa scripting's standard implementation, <code>NSScriptCommand</code> and its subclasses can handle the <code>close</code>, <code>copy</code>, <code>count</code>, <code>create</code>, <code>delete</code>, <code>exists</code>, <code>move</code>, <code>open</code>, and <code>print</code>commands for most applications without any subclassing.  It also handles the <code>get</code> and <code>set</code> commands, which are technically not part of the Standard suite, but rather considered built-in, or <a name="//apple_ref/doc/uid/20001242-DontLinkElementID_439"></a>intrinsic, AppleScript commands. However, if your application needs to modify any of these commands, you can do so in one of two ways:</p><ul class="spaceabove"><li class="li"><p>Supply a method to handle the command and list it in your sdef file.</p></li><li class="li"><p>Create a subclass of <code>NSScriptCommand</code> or one of its subclasses and override <code>performDefaultImplementation</code>.</p></li></ul><p><span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW14">Table 7-1</a></span> lists the AppleScript commands supported by Cocoa scripting and summarizes their default behavior and how you can customize it.</p><div class="importantbox"><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_17" title="Important:"></a><p><strong>Important:</strong>&nbsp;When your application defines a new Objective-C script command class, it must be a subclass of <code>NSScriptCommand</code> or of one of its subclasses.</p><p></p></div><a name="//apple_ref/doc/uid/20001242-SW19" title="Script Command Scriptability Information"></a><h3>Script Command Scriptability Information</h3><p><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_440"></a>In working with script commands, Cocoa scripting relies on scriptability information in your sdef. That includes <code>command</code> elements, which provide information about specific AppleScript commands, and <code>responds-to</code> elements, which specify that objects of a particular class can respond to a specified command.</p><p>Your sdef includes a <code>command</code> element for every new AppleScript command you create. For these commands, you specify all the appropriate information described in <span class="content_text"><a href="../SApps_creating_sdef/SAppsCreateSdef.html#//apple_ref/doc/uid/TP40001977-1129132">“Command Elements.”</a></span> That includes command name, code, and description. It can also include a direct parameter, other parameters, and result type.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001242-SW20" title="Note"></a><p><strong>Note:</strong>&nbsp;When a command object is instantiated, parameters and result type are stored in an argument dictionary in the command. See <span class="content_text">“Script Command Components”</span> for information on how to access items in the argument dictionary.</p></div><p>If you implement a new Objective-C class for the command, you also supply the name in the <code>command</code> element. If you do not supply a class name, Cocoa scripting uses the default, <code>NSScriptCommand</code>.</p><p>Your sdef should also include <code>command</code> element definitions for most of the AppleScript commands Cocoa scripting supports, if they can be used in your application:</p><ul class="spaceabove"><li class="li"><p>Your sdef should not include <code>command</code> elements for the <code>get</code> and <code>set</code> commands—they are automatically available to every application.</p></li><li class="li"><p>Your sdef should include <code>command</code> elements for the commands in the Standard suite, such as <code>count</code>, <code>duplicate</code>, and <code>move</code>. You can obtain these definitions by copying them from the file <code>Sketch.sdef</code>, as described in <span class="content_text"><a href="../SApps_creating_sdef/SAppsCreateSdef.html#//apple_ref/doc/uid/TP40001979-SW2">“Create a Scripting Definition File.”</a></span></p></li></ul><p>Cocoa also provides automatic support for the AppleScript types described in <span class="content_text"><a href="../SApps_about_apps/SAppsAboutApps.html#//apple_ref/doc/uid/TP40001976-SW12">“Built-in Support for Basic AppleScript Types.”</a></span><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_441"></a></p><a name="//apple_ref/doc/uid/20001242-SW15" title="Script Command Components"></a><h3>Script Command Components</h3><p><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_442"></a>A script command object is an instance of <code>NSScriptCommand</code> or one of its subclasses, including classes defined by Cocoa and those defined by your application. A script command can have several components, which vary by command and are described in the <code>command</code> element definition for the command in the sdef file.</p><ul class="spaceabove"><li class="li"><p><strong>The receiver or receivers for the command (if any):</strong> The object or objects designated to receive the command in the application.</p><p>If the originating Apple event specifies receivers, it does so in its direct parameter. If the Apple event does not specify receivers, it may still have a direct parameter, which is then interpreted to be the object to which to send the command.</p><p>If a command specifies receivers, you can retrieve them from the command object with the <code>evaluatedReceivers</code> method, which converts object specifiers into references to actual objects. If the command doesn't specify receivers, you can retrieve the direct parameter with the <code>directParameter</code> method, or you can retrieve it from the arguments list, as described in the next item.</p></li><li class="li"><p><strong>The arguments of the command (if any):</strong> The arguments provide access to information from the parameters of the originating Apple event. The arguments can include direct parameter, other parameters, and result type.</p><p>You can retrieve a dictionary of arguments from the command object with the <code>evaluatedArguments</code> method. You obtain individual arguments from this dictionary by key, where the parameter names defined in the sdef serve as keys. You can use the empty key (an empty string: <code>@""</code>) to retrieve the direct parameter (or "unnamed argument") from the argument dictionary, if the direct parameter is not the receivers specifier.</p></li><li class="li"><p><strong>The class description for the command:</strong> From the class description, you can obtain information such as argument names, command result type, AppleScript command name, and name of the Objective-C class Cocoa instantiates to perform the command. This information is used by Cocoa scripting, but less commonly by your application. See <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW6">“Script Command Creation”</a></span> for a description of how Cocoa scripting obtains this information.</p></li><li class="li"><p><strong>An Apple event descriptor:</strong> This Cocoa object, of type <code>NSAppleEventDescriptor</code>, represents the Apple event itself. Your application won't necessarily need to work directly with the Apple event, but it's available if you do.</p></li></ul><p>Your application typically only needs to access the components of a command when you want to modify the default behavior or implement a new script command. In those situations, the <code><a href="../../../Reference/Foundation/Classes/NSScriptCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSScriptCommand" target="_top">NSScriptCommand</a></code> class provides a number of methods for obtaining the information you need, including those mentioned here (<code>evaluatedReceivers</code>, <code>evaluatedArguments</code>, and <code>directParameter</code>).<a name="//apple_ref/doc/uid/20001242-DontLinkElementID_443"></a></p><a name="//apple_ref/doc/uid/20001242-SW6" title="Script Command Creation"></a><h3>Script Command Creation</h3><p><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_444"></a>It is important to note that your application doesn't typically instantiate a script command directly. Instead, it lists the commands it can handle in its sdef file and Cocoa scripting instantiates a command object when the application receives the corresponding Apple event.</p><p>Cocoa extracts information from the Apple event and stores it in the command object. To do this, it uses application scriptability information (loaded from your sdef and stored in a global instance of <code>NSScriptSuiteRegistry</code>) to obtain the keys for the specified objects and to get data from class and command descriptions. Application scriptability information automatically includes information to support the <code>get</code> and <code>set</code> commands.</p><p>Because at this point the command’s receivers and arguments are probably known only as AppleScript reference forms (for example, <code>graphic 3 of document "SketchDocOne"</code>), they are represented in the command object as nested object specifiers. See <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW16">“Script Commands and Object Specifiers”</a></span> for more information.</p><a name="//apple_ref/doc/uid/20001242-SW21" title="Script Command Execution"></a><h3>Script Command Execution</h3><p><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_445"></a>Once Cocoa scripting has created and prepared a script command, it executes it in a series of steps:</p><ol class="ol"><li class="li"><p>It uses key-value coding (KVC) to evaluate the receivers specifier in the script command (see <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW16">“Script Commands and Object Specifiers”</a></span> for details).</p></li><li class="li"><p>It determines which method to use for executing the command. For some commands (such as <code>get</code> and <code>set</code>), it invokes KVC methods, based on keys supplied in the sdef file, to access values of the specified objects.</p><p>For other commands, it looks in the class descriptions of the receivers to see if any has specified a selector for the command. If not, or if there are no receivers, it selects the default implementation for the command. This mechanism is described in more detail in <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW1">“Object-first Versus Verb-first Script Commands.”</a></span></p></li><li class="li"><p>It invokes the method indicated by the selector (which has a single argument, the script command object) or the method that implements the default behavior for the command (<code>performDefaultImplementation</code>).</p></li><li class="li"><p>When a command needs to return a value, Cocoa scripting packages the information in a reply Apple event and returns it. If an error occurs while executing the command, Cocoa returns the error information (including any information added by the application) in the reply Apple event. For details, see <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW3">“Error Handling.”</a></span></p></li><li class="li"><p>If a command requires asynchronous processing, the application can suspend it, so that the application doesn't receive additional Apple events during processing. For details, see <span class="content_text"><a href="../SApps_handle_AEs/SAppsHandleAEs.html#//apple_ref/doc/uid/20001239-1134778">“Suspending and Resuming Apple Events and Script Commands.”</a></span></p></li></ol><p>Most standard commands perform their operations automatically. For an example where you might want to modify or replace the default behavior, see <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW11">“Modifying a Standard Command.”</a></span><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_446"></a></p><a name="//apple_ref/doc/uid/20001242-SW16" title="Script Commands and Object Specifiers"></a><h3>Script Commands and Object Specifiers</h3><p><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_447"></a>When a script command is ready for execution in your application, the receiver or receivers have been set as object specifiers and any arguments may also have been set as object specifiers (arguments can be actual values as well). To represent a series of reference forms (such as <code>first word of second paragraph of document "Stock Alert"</code>), each object specifier is nested inside its container object specifier; the innermost object specifier indicates the final object to be evaluated, while the outermost object is usually the application.</p><p>The keys to an attribute or relationship are often not the same words expressed by the corresponding reference forms. For example, the key for an array of document objects is <code>orderedDocuments</code>, but the actual scripting term used is <code>document</code>. The mapping between key name and script name is provided in the application's sdef. When Cocoa scripting converts an Apple event into an objective-C script command object, it obtains the mapping between a four-character code in the Apple event and the corresponding key for the specified class, attribute, or relationship in the application. It can then locate the language-independent information (specifically, class and command descriptions) needed to compose the script command, including the object specifiers for its arguments and receivers.</p><p>In the normal course of script-command execution, an application invokes <code>evaluatedReceivers</code> on a script command to get the receiver or receivers of the command and invokes <code>evaluatedArguments</code> to get any arguments of the command. These methods in turn invoke <code>objectsByEvaluatingSpecifier</code> on the object specifiers representing command arguments or receivers. The object specifier receiving the message is the innermost specifier as nested in its containers.</p><p>The <a name="//apple_ref/doc/uid/20001242-DontLinkElementID_448"></a><code>objectsByEvaluatingSpecifier</code> method goes up the chain of nested containers by asking each specifier for its container until it comes to the top-level object specifier, which has no container. The top-level object is usually the application object, but it can be an object specifier involved in a <code>whose</code> clause (<code><a href="../../../Reference/Foundation/Classes/NSWhoseSpecifier_Class/Reference/Reference.html#//apple_ref/occ/cl/NSWhoseSpecifier" target="_top">NSWhoseSpecifier</a></code>) or the container for a range evaluation. The method then invokes <a name="//apple_ref/doc/uid/20001242-DontLinkElementID_449"></a><code>objectsByEvaluatingWithContainers:</code> on this <a name="//apple_ref/doc/uid/20001242-DontLinkElementID_450"></a>top-level specifier, which then proceeds down the chain of nested specifiers, evaluating each through key-value coding and using the evaluated object as the basis for the next evaluation. Evaluating the innermost specifier yields the real command receiver or receivers or any object used as a command argument.</p><p>For related information, see <span class="content_text"><a href="../SApps_object_specifiers/SAppsObjectSpecifiers.html#//apple_ref/doc/uid/TP40002164-CH3-SW14">“A Closer Look at an Object Specifier.”</a></span><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_451"></a></p><a name="//apple_ref/doc/uid/20001242-SW3" title="Error Handling"></a><h3>Error Handling</h3><p><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_452"></a>Your application can signal error information during script command execution by providing the command object with an error number, an error string, or both. The error information is returned in the reply Apple event. If an error occurs and your application does nothing, Cocoa scripting will supply the most applicable error number it can, along with an error string for that number. The error codes that Cocoa scripting uses for general command execution problems are listed with the documentation for the <code><a href="../../../Reference/Foundation/Classes/NSScriptCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSScriptCommand" target="_top">NSScriptCommand</a></code> class.</p><p><code>NSScriptCommand</code> supplies the <code>setScriptErrorNumber:</code> and <code>setScriptErrorString:</code> methods for setting error information.</p><p>Your command handler should only provide error information if it is specific to the operation of your application. On occasion, you may be able to use one of the codes defined by Cocoa scripting. You can also choose an error number from constants supplied by the Apple Event Manager (described in “Apple Event Manager Result Codes” in <em><a href="../../../../Carbon/Reference/Apple_Event_Manager/index.html#//apple_ref/doc/uid/TP30000134" target="_top">Apple Event Manager Reference</a></em>). When you choose one of these constants, such as <code>errAENotASingleObject</code>, Cocoa scripting will supply the corresponding error string (<code>"Handler only handles single objects"</code>). You can also supply general Mac OS system error numbers (defined in <code>MacErrors.h</code>). For example, if you return <code>fnfErr</code>, the error number for <code>"file not found"</code>, AppleScript will attempt to supply an appropriate error string.<a name="//apple_ref/doc/uid/20001242-DontLinkElementID_453"></a></p><a name="//apple_ref/doc/uid/20001242-SW1" title="Object-first Versus Verb-first Script Commands"></a><h3>Object-first Versus Verb-first Script Commands</h3><p>Cocoa script commands can be described as object-first or verb-first, depending on the receivers for the command. When a script command is executed, it looks first for receivers that can perform the desired action directly. If it finds any, it invokes the specified method on each receiver. A command of this type is called an <a name="//apple_ref/doc/uid/20001242-DontLinkElementID_454"></a><strong>object-first command</strong>—the objects perform the specified action on themselves.</p><p>Sketch implements the <code>rotate</code> command as an object-first command—for details, see <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW2">“Implementing an Object-First Command—Rotate.”</a></span></p><p>If no receiver can perform the desired action, or if there are no receivers specified, the script command invokes its <code>performDefaultImplementation</code> method. When a command invokes this method, it is called a <a name="//apple_ref/doc/uid/20001242-DontLinkElementID_455"></a><strong>verb-first command</strong>—a single method performs the action (or verb) on any number of objects. To create a verb-first command, you define a subclass of one of Cocoa's script command classes and override the <code>performDefaultImplementation</code> method (which does nothing in <code>NSScriptCommand</code>) to perform your version of the command action.</p><p>Sketch implements the <code>align</code> command as a verb-first command—for details, see <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW7">“Implementing a Verb-First Command—Align.”</a></span> Several of the standard commands are also verb-first commands—see <span class="content_text"><a href="../SApps_script_classes/SAppsScriptClasses.html#//apple_ref/doc/uid/20000034-BBCGCAAD">Table 9-4</a></span> for details.</p><p><span class="content_text">Figure 7-1</span> shows Cocoa scripting's decision tree for executing a script command.</p><br/><div><a name="//apple_ref/doc/uid/20001242-SW10" title="Figure 7-1Executing a script command&acirc;&#128;&#148;verb-first versus object-first"></a><p><strong>Figure 7-1&nbsp;&nbsp;</strong>Executing a script command—verb-first versus object-first</p><img src = "../Art/executing_script_command.gif" alt = "Executing a script command—verb-first versus object-first" width="309" height="414"></div><br/><a name="//apple_ref/doc/uid/20001242-SW8" title="About Object-first Script Commands"></a><h4>About Object-first Script Commands</h4><p><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_456"></a>You can use an object-first command to modify the behavior of a standard AppleScript command (except for the <code>get</code> and <code>set</code> commands). You can also use an object-first command to quickly add a new AppleScript command to your application. For these tasks, you don't need to implement a new Objective-C command class. However, you can implement such a class if desired—for example, if you want to supply functionality in the command class that any of the receivers can invoke.</p><p>An object-first command is appropriate for an action that can benefit from polymorphism, because the same message can result in different behavior depending on the receiver. It is also appropriate for operations on relatively small numbers of objects or for simple actions that don't require peripheral information—for example, an action that calls for a simple reversal of state. Although each receiver can, if necessary, extract information from the command to aid in performing the action, such an approach could conceivably lead to performance problems, if operating on large numbers of objects.</p><p>Another advantage of using an object-first command is that you can often implement it by creating a category on an existing class.</p><p>To support an object-first command, you perform the following steps: </p><ul class="spaceabove"><li class="li"><p>In your sdef, provide a <code>responds-to</code> entry for each scriptable class that can handle the command. Specify the same method name for each class, matching the template <code>&lt;methodName>:</code>.</p></li><li class="li"><p>For a new AppleScript command you have defined, add a <code>command</code> element to your sdef file. Specify all the appropriate information described in <span class="content_text"><a href="../SApps_creating_sdef/SAppsCreateSdef.html#//apple_ref/doc/uid/TP40001977-1129132">“Command Elements.”</a></span></p><p>If you will define a new Objective-C class to implement the command, supply the class name in the <code>command</code> element.</p></li><li class="li"><p>To use the object-first approach to change the behavior of a standard AppleScript command (but not the <code>get</code> and <code>set</code> commands), make sure your sdef includes the <code>command</code> element definition for that command, as described in <span class="content_text"><a href="../SApps_creating_sdef/SAppsCreateSdef.html#//apple_ref/doc/uid/TP40001979-SW2">“Create a Scripting Definition File.”</a></span> You don't need to modify the <code>command</code> definition unless you implement a new Objective-C class for the command.</p><p>For example, if your sdef includes a <code>responds-to</code> element that specifies a <code>specialMove:</code> method that Cocoa scripting should invoke for the <code>move</code> command, there is no need to modify the <code>move</code> command in your sdef or to subclass <code>NSMoveCommand</code>. But if you do provide a subclass of <code>NSMoveCommand</code>, you must list it in the <code>command</code> element.</p></li><li class="li"><p>In the implementation for the corresponding scriptable classes, implement the named method. The method declaration must match one of the following two templates (depending on whether the command returns a value):</p><p><code>-(id)&lt;methodName>:(NSScriptCommand*)command</code></p><p><code>-(void)&lt;methodName>:(NSScriptCommand*)command</code></p></li><li class="li"><p>If you are using one, implement the Objective-C class for the command; it must inherit from one of the script command classes defined by Cocoa.</p></li></ul><p>For a detailed example, see <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW2">“Implementing an Object-First Command—Rotate.”</a></span><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_457"></a></p><a name="//apple_ref/doc/uid/20001242-SW9" title="About Verb-first Script Commands"></a><h4>About Verb-first Script Commands</h4><p><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_458"></a>A verb-first command is appropriate for an action that requires the interaction of objects, so that it cannot be handled by individual objects. It is also appropriate for operations that require significant overhead, such that it would be inefficient to invoke the same method on many objects, with each duplicating the overhead. A verb-first command can also be appropriate to customize the behavior of an existing verb-first command.</p><p>To implement a verb-first command, you perform the following steps: </p><ul class="spaceabove"><li class="li"><p>To handle a new AppleScript command for your application, add a <code>command</code> element for the class to your sdef file. Specify all the appropriate information described in <span class="content_text"><a href="../SApps_creating_sdef/SAppsCreateSdef.html#//apple_ref/doc/uid/TP40001977-1129132">“Command Elements.”</a></span> That includes specifying the name of your new Objective-C class that implements the command.</p><p>To handle a standard AppleScript command with a new command subclass, make sure your sdef includes the <code>command</code> element definition for that command (except for the <code>get</code> and <code>set</code> commands), as described in <span class="content_text"><a href="../SApps_creating_sdef/SAppsCreateSdef.html#//apple_ref/doc/uid/TP40001979-SW2">“Create a Scripting Definition File.”</a></span> Modify that element to specify the name of your new Objective-C class.</p></li><li class="li"><p>Define the command in your code as a subclass of <code>NSScriptCommand</code> or of one of the script command subclasses listed in <span class="content_text"><a href="../SApps_script_classes/SAppsScriptClasses.html#//apple_ref/doc/uid/20000034-BBCGCAAD">Table 9-4</a></span>:</p><p>Subclass <code>NSScriptCommand</code> to perform an operation which is not supported by any of the standard Cocoa script command classes.</p><p>Subclass one of Cocoa scripting's other script command classes to perform a variation of its standard action. For example, you may want to perform a custom <code>move</code> operation in some cases, but otherwise fall back on the default behavior.</p></li><li class="li"><p>Override the <code>performDefaultImplementation</code> method. In that method, you can use methods of <code>NSScriptCommand</code> to extract any information you need from the command object.</p><p>For example, you can examine the objects on which the command should be performed and decide whether to perform the customized version of the command. If not, you can invoke the method of the superclass:</p><div class="codesample"><table><tr><td scope="row"><pre>        return [super performDefaultImplementation];<span></span></pre></td></tr></table></div><p>This method either returns an <code>id</code> or, if there is nothing to return, returns <code>nil</code>. The version in <code>NSScriptCommand</code> does nothing and returns <code>nil</code>, but most subclasses of <code>NSScriptCommand</code> override this method to perform an action.</p></li></ul><p>For a detailed example, see <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW7">“Implementing a Verb-First Command—Align.”</a></span><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_459"></a></p><a name="//apple_ref/doc/uid/20001242-SW22" title="Mixing Object-first and Verb-first Behavior"></a><h4>Mixing Object-first and Verb-first Behavior</h4><p><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_460"></a><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_461"></a>When implementing a new command class or overriding a Cocoa command class, you might choose to mix the verb-first and object-first approaches. For example, you might support a command that most objects in your application can handle in a specified method (object-first), but that for a certain class of objects, it is necessary to handle the action in the <code>performDefaultImplementation</code> method (verb-first).</p><p>To implement a command that mixes these behaviors, you use a combination of the same implementation steps described in <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW8">“About Object-first Script Commands”</a></span> and <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW9">“About Verb-first Script Commands.”</a></span> That is, you provide both <code>responds-to</code> elements and a <code>command</code> element in your sdef file and you specify an Objective-C class for the command; in your code, you implement a script command subclass that overrides <code>performDefaultImplementation</code>, as well as versions of the method specified by the <code>responds-to</code> element in individual classes that can respond to the command. The result of handling an instance of the command will then depend on the class types of the objects on which it operates.</p><div class="importantbox"><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_18" title="Important:"></a><p><strong>Important:</strong>&nbsp;Cocoa scripting cannot mix verb-first and object-first approaches in response to a single Apple event. It does the right thing if all the objects specified by an Apple event provide a method with the same signature to handle the action (object first—invoke the method) or if none of them do (verb-first—invoke the command's <code>performDefaultImplementation</code> method). However, if a single Apple event includes some objects that specify a method and some that don't, or objects that specify methods with different names, the result is undefined.</p><p></p></div><a name="//apple_ref/doc/uid/20001242-SW13" title="Steps for Implementing a New or Modified Script Command"></a><h3>Steps for Implementing a New or Modified Script Command</h3><p><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_462"></a>To summarize from previous sections, you use these steps to implement a new command or to modify the behavior of the script commands provided by Cocoa scripting:</p><ul class="spaceabove"><li class="li"><p>For either an object-first (except the <code>get</code> and <code>set</code> commands) or a verb-first command:</p><p>In the sdef, define a <code>command</code> element for the AppleScript command, if it doesn't already have one.</p></li><li class="li"><p>For an object-first command:</p><ul class="nested"><li class="nested li"><p>In the sdef, add a <code>responds-to</code> element to the <code>class</code> definition of each scriptable class that can handle the command. Specify the same method name for each class.</p></li><li class="nested li"><p>Implement the specified method in the classes that can respond to the command. The declaration should match one of these templates:</p><p><code>-(id)&lt;methodName>:(NSScriptCommand*)command</code> </p><p><code>-(void)&lt;methodName>:(NSScriptCommand*)command</code></p></li></ul></li><li class="li"><p>For a verb-first command (and if needed, for an object-first command)</p><ul class="nested"><li class="nested li"><p>Implement an Objective-C script command class that inherits from <code>NSScriptCommand</code> or one of its subclasses.</p></li><li class="nested li"><p>Specify the name of the Objective-C command class in the <code>command</code> element in the sdef.</p></li></ul><p>For a verb-first command, override the <code>performDefaultImplementation</code> method.<a name="//apple_ref/doc/uid/20001242-DontLinkElementID_463"></a><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_464"></a></p></li></ul><a name="//apple_ref/doc/uid/20001242-SW2" title="Implementing an Object-First Command&acirc;&#128;&#148;Rotate"></a><h2>Implementing an Object-First Command—Rotate</h2><p><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_465"></a>The Sketch sample application implements the <code>rotate</code> command as an object-first command—it's a logical task for a <code>rectangle</code> object to rotate itself.</p><p>To implement the object-first AppleScript command <code>rotate</code>, the Sketch application does the following:</p><ol class="ol"><li class="li"><p>It defines the <code>rotate</code> command in the file <code>Sketch.sdef</code>:</p><div class="codesample"><table><tr><td scope="row"><pre>        &lt;command name="rotate" code="sktcrota"<span></span></pre></td></tr><tr><td scope="row"><pre>            description="Rotate objects."><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;direct-parameter type="graphic"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;parameter name="by" code="by  " type="real"<span></span></pre></td></tr><tr><td scope="row"><pre>                description="degrees to rotate; positive numbers rotate counter-clockwise."><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;cocoa key="byDegrees"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;/parameter><span></span></pre></td></tr></table></div><p>Here's what this command definition specifies:</p><ol class="ol"><li class="ol ol"><p>The command name is <code>"rotate"</code> and its two-part code is <code>"sktcrota"</code>. This code is used in installing a handler to respond to Apple events that specify this command.</p></li><li class="ol ol"><p>The command has a direct parameter which specifies one or more graphic objects to be rotated.</p></li><li class="ol ol"><p>The command has a parameter with the key <code>"byDegrees"</code> that specifies the degrees by which the specified objects should be rotated.</p></li><li class="ol ol"><p>This command definition does not specify a command class to implement the command, because the <code>rotate</code> command does not require a new command class. Because it doesn't specify a command class, the default class will be used (<code>NSScriptCommand</code>).</p></li><li class="ol ol"><p>This command definition does not include a <code>result type</code> element, so the Objective-C method that handles the command should return <code>nil</code>.</p></li></ol></li><li class="li"><p>In its sdef, Sketch also adds a <code>responds-to</code> element to the <code>rectangle</code> class (rectangles are the only graphics that can be rotated by this command).</p><div class="codesample"><table><tr><td scope="row"><pre>            &lt;responds-to name="rotate"><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;cocoa method="rotate:"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;/responds-to><span></span></pre></td></tr></table></div><p>This element definition specifies that for a <code>rotate</code> command, Cocoa scripting should call the <code>rotate:</code> method of the <code>rectangle</code> object to be rotated.</p></li><li class="li"><p>In the implementation for the <code>SKTRectangle</code> class, it implements the <code>rotate:</code> method. Here is a summary of how <code>rotate:</code> works:</p><ol class="ol"><li class="ol ol"><p>It invokes <code>[command evaluatedArguments]</code> on the passed command object to get a dictionary (<code>theArgs</code>) containing the evaluated arguments for the command. The arguments have been evaluated from object specifiers to objects if necessary. The keys in the dictionary are the argument names, specified in the sdef.</p></li><li class="ol ol"><p>It invokes <code>[theArgs objectForKey:@"byDegrees"]</code> to obtain the argument for the number of degrees to rotate, as an instance of <code>NSNumber</code>. The key <code>"byDegrees"</code> corresponds to the Cocoa key defined for the <code>"by"</code> parameter in the <code>rotate</code> definition in Sketch's sdef file.</p></li><li class="ol ol"><p>It obtains the number of degrees to rotate by from the number object and performs some math operations to determine whether to rotate the rectangle.</p></li><li class="ol ol"><p>In the case that it needs to rotate the rectangle, it does so by flipping the width and height and modifying the position.</p></li><li class="ol ol"><p>If there is an error, it invokes <code>[self setScriptErrorNumber:theError]</code> to supply an error number.</p><p>You can also invoke <code>setScriptErrorString:</code> to supply an error message.</p></li><li class="ol ol"><p>Because the <code>rotate</code> command does not declare a <code>result type</code> element in its sdef definition, this method should return <code>nil</code>.</p></li></ol></li></ol><div class="notebox"><a name="//apple_ref/doc/uid/20001242-SW23" title="Note"></a><p><strong>Note:</strong>&nbsp;To support various AppleScript commands, scriptable Sketch classes such as <code>SKTGraphics</code> and <code>SKTDrawDocument</code> maintain KVC compliance in naming the accessors for their scriptable properties. In addition, <code>SKTGraphics</code> implements an object specifier method (shown in <span class="content_text"><a href="../SApps_object_specifiers/SAppsObjectSpecifiers.html#//apple_ref/doc/uid/TP40002164-CH3-CJBDAGIE">Listing 6-1</a></span>, as does <code>NSDocument</code> (the superclass of <code>SKTDrawDocument</code>).</p></div><p>Here is an AppleScript script that exercises the <code>rotate</code> command:</p><a name="//apple_ref/doc/uid/20001242-SW24" title="Listing 7-1A script to test the rotate command"></a><p class="codesample"><strong>Listing 7-1&nbsp;&nbsp;</strong>A script to test the rotate command</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "Sketch"<span></span></pre></td></tr><tr><td scope="row"><pre>    with timeout of 60 * 60 seconds<span></span></pre></td></tr><tr><td scope="row"><pre>        tell document 1<span></span></pre></td></tr><tr><td scope="row"><pre>            get orientation of every rectangle<span></span></pre></td></tr><tr><td scope="row"><pre>            set x to every rectangle<span></span></pre></td></tr><tr><td scope="row"><pre>            repeat with y in x<span></span></pre></td></tr><tr><td scope="row"><pre>                rotate y by 90<span></span></pre></td></tr><tr><td scope="row"><pre>            end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>            try<span></span></pre></td></tr><tr><td scope="row"><pre>                rotate rectangle 1 by 80<span></span></pre></td></tr><tr><td scope="row"><pre>            on error eMsg number eNum<span></span></pre></td></tr><tr><td scope="row"><pre>                log {eNum, eMsg}<span></span></pre></td></tr><tr><td scope="row"><pre>            end try<span></span></pre></td></tr><tr><td scope="row"><pre>            get orientation of every rectangle<span></span></pre></td></tr><tr><td scope="row"><pre>        end tell<span></span></pre></td></tr><tr><td scope="row"><pre>    end timeout<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>Here's what this script does:</p><ol class="ol"><li class="li"><p>It sets a long timeout value so it won't time out (and be interrupted) during execution if you break in the application to debug its scriptability support.</p></li><li class="li"><p>It performs a series of tests on the first document:</p><ol class="ol"><li class="ol ol"><p>It gets the <code>orientation</code> property of every <code>rectangle</code> object.</p></li><li class="ol ol"><p>It rotates every <code>rectangle</code> object by 90 degrees.</p></li><li class="ol ol"><p>It uses a <code>try</code> block to test for an error condition (rotating by a value that is not a multiple of 90).</p></li><li class="ol ol"><p>It gets the <code>orientation</code> property of every <code>rectangle</code> object after rotating.</p></li></ol></li></ol><p>You might add additional tests to this script, such as the following:</p><ol class="ol"><li class="li"><p>Try to rotate by different degrees.</p></li><li class="li"><p>Try to rotate objects that aren't rectangles.</p></li><li class="li"><p>Delete all graphics, then try to rotate with no rectangles in the document.</p></li><li class="li"><p>Rotate each rectangle by flipping its orientation property.<a name="//apple_ref/doc/uid/20001242-DontLinkElementID_466"></a></p></li></ol><a name="//apple_ref/doc/uid/20001242-SW7" title="Implementing a Verb-First Command&acirc;&#128;&#148;Align"></a><h2>Implementing a Verb-First Command—Align</h2><p><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_467"></a>The Sketch sample application implements the <code>align</code> script command as a verb-first command. It makes sense to let the <code>performDefaultImplementation</code> method align all the specified objects in an array of objects, whereas asking each object to align itself would require the objects to know or find out about other objects to align with.</p><p>To implement the verb-first AppleScript command <code>align</code>, the Sketch application does the following:</p><ol class="ol"><li class="li"><p>It defines the <code>align</code> command in Sketch's sdef file</p><div class="codesample"><table><tr><td scope="row"><pre>        &lt;command name="align" code="sktcalig"<span></span></pre></td></tr><tr><td scope="row"><pre>            description="Align a set of objects."><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;cocoa class="SKTAlignCommand"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;direct-parameter><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;type type="graphic" list="yes"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;/direct-parameter><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;parameter name="to" code="to  " type="edge"><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;cocoa key="toEdge"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;/parameter><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;/command><span></span></pre></td></tr></table></div><p>Here's what this command definition specifies:</p><ol class="ol"><li class="ol ol"><p>The command name is <code>"align"</code> and its two-part code is <code>"sktcalig"</code>. This code is used in installing a handler to respond to Apple events that specify this command.</p></li><li class="ol ol"><p>To handle the command, Cocoa scripting should implement an instance of <code>SKTAlignCommand</code>.</p></li><li class="ol ol"><p>The command has a direct parameter which supplies a list of graphics to be aligned.</p></li><li class="ol ol"><p>The command has a parameter that specifies the edge to which the objects should be aligned.</p></li><li class="ol ol"><p>This command definition does not include a <code>result type</code> element, so the Objective-C code that handles the command should return <code>nil</code>.</p></li></ol><p>In its sdef, Sketch also defines an <code>edge</code> enumeration (not shown) to define edge constants for use with the <code>align</code> command.</p></li><li class="li"><p>Sketch adds two files to its Xcode project to define the <code>SKTAlignCommand</code> class: <code>SKTAlignCommand.h</code> and <code>SKTAlignCommand.m</code>.</p><p>This command is a subclass of <code>NSScriptCommand</code>, containing one method, <code>performDefaultImplementation</code>. That method overrides the version in <code>NSScriptCommand</code>.</p></li><li class="li"><p>Here is a summary of how <code>performDefaultImplementation</code> works for the <code>align</code> command:</p><ol class="ol"><li class="ol ol"><p>It determines the receivers for the command (an array of graphic objects to align).</p></li><li class="ol ol"><p>It invokes <code>[self evaluatedArguments]</code> to get a dictionary (<code>theArgs</code>) containing the evaluated arguments for the command. The arguments have been evaluated from object specifiers to objects if necessary. The keys in the dictionary are the argument names, specified in the sdef.</p></li><li class="ol ol"><p>It invokes <code>[theArgs objectForKey:@"toEdge"]</code> to obtain the argument for the edge to align to. The key <code>"toEdge"</code> corresponds to the Cocoa key defined for the <code>"to"</code> edge parameter in the <code>align</code> definition in Sketch's sdef file.</p><p>From that argument, it obtains the value of the edge to align to.</p></li><li class="ol ol"><p>It gets the bounds for the first object in the array of graphics objects. That is the object to which any other objects will be aligned.</p></li><li class="ol ol"><p>It iterates over the array of graphics objects to align, using a mechanism to align them that depends on the specified edge to align to.</p></li><li class="ol ol"><p>If there is an error, it invokes <code>[self setScriptErrorNumber:theError]</code> to supply an error number.</p><p>You can also invoke <code>setScriptErrorString:</code> to supply an error message.</p></li><li class="ol ol"><p>Because the <code>align</code> command does not declare a <code>result type</code> element in its sdef definition, this method should return <code>nil</code>.</p></li></ol></li></ol><p>The <code>performDefaultImplementation</code> method for <code>SKTAlignCommand</code> never invokes the implementation of its superclass (<code>NSScriptCommand</code>) for two reasons:</p><ul class="ul"><li class="li"><p>The version in <code>NSScriptCommand</code> doesn't do anything—it exists only to be overridden.</p></li><li class="li"><p>The implementation in <code>SKTAlignCommand</code> does all the work necessary to implement the <code>align</code> command.</p></li></ul><p>Here is an AppleScript script that exercises the <code>align</code> command:</p><a name="//apple_ref/doc/uid/20001242-SW17" title="Listing 7-2A script to test the align command"></a><p class="codesample"><strong>Listing 7-2&nbsp;&nbsp;</strong>A script to test the align command</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "Sketch"<span></span></pre></td></tr><tr><td scope="row"><pre>    with timeout of 60 * 60 seconds<span></span></pre></td></tr><tr><td scope="row"><pre>        tell document 1<span></span></pre></td></tr><tr><td scope="row"><pre>            align every graphic to vertical centers<span></span></pre></td></tr><tr><td scope="row"><pre>            delay 3<span></span></pre></td></tr><tr><td scope="row"><pre>            set x to every graphic<span></span></pre></td></tr><tr><td scope="row"><pre>            align x to horizontal centers<span></span></pre></td></tr><tr><td scope="row"><pre>        end tell<span></span></pre></td></tr><tr><td scope="row"><pre>    end timeout<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>Here's what this script does:</p><ol class="ol"><li class="li"><p>It sets a long timeout value so it won't time out (and be interrupted) during execution if you break in the application to debug its scriptability support.</p></li><li class="li"><p>It tells the first document to align every graphic vertically.</p></li><li class="li"><p>After a 3 second delay, it tells the document to align every graphic horizontally.</p></li></ol><p>You can make this test script more complete by, for example, adding statements to:</p><ol class="ol"><li class="li"><p>Test the other alignment options defined in Sketch's sdef: <code>left edges</code>, <code>right edges</code>, <code>horizontal centers</code>, <code>top edges</code>, and <code>bottom edges</code>.</p></li><li class="li"><p>Align a range of graphics.</p></li><li class="li"><p>Delete all graphics, then try to align with no graphics in the document.<a name="//apple_ref/doc/uid/20001242-DontLinkElementID_468"></a></p></li></ol><a name="//apple_ref/doc/uid/20001242-SW11" title="Modifying a Standard Command"></a><h2>Modifying a Standard Command</h2><p><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_469"></a>The <code>NSMoveCommand</code> is part of Cocoa’s built-in scripting support for standard AppleScript commands. It works automatically to support the <code>move</code> command through key-value coding. However, there are situations where you might want to override this command, using either a verb-first or an object-first approach. This section provides some tips for this task—a complete solution is beyond the scope of this document.</p><p>Here is the sdef entry for the <code>move</code> command, which shows the direct parameter and other parameters to the command:</p><div class="codesample"><table><tr><td scope="row"><pre>        &lt;command name="move" code="coremove"<span></span></pre></td></tr><tr><td scope="row"><pre>                description="Move object(s) to a new location."><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;cocoa class="NSMoveCommand"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;direct-parameter type="specifier" description="the object(s) to move"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;parameter name="to" code="insh" type="location specifier"<span></span></pre></td></tr><tr><td scope="row"><pre>                description="The new location for the object(s)."><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;cocoa key="ToLocation"/><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;/parameter><span></span></pre></td></tr></table></div><div class="importantbox"><a name="//apple_ref/doc/uid/20001242-DontLinkElementID_19" title="Important:"></a><p><strong>Important:</strong>&nbsp;The <code>NSMoveCommand</code> class overrides the <code>setReceiversSpecifier:</code> method of <code>NSScriptCommand</code>, so that the container, rather than the objects to be moved, becomes the receiver for the command. So the specifier returned by <code>receiversSpecifier</code> may be different than the specifier set by <code>setReceiversSpecifier:</code>. For more information, see the documentation for <code><a href="../../../Reference/Foundation/Classes/NSMoveCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSMoveCommand" target="_top">NSMoveCommand</a></code>.</p><p>Other command classes that override <code>setReceiversSpecifier:</code> are: <code><a href="../../../Reference/Foundation/Classes/NSCloneCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSCloneCommand" target="_top">NSCloneCommand</a></code>, <code><a href="../../../Reference/Foundation/Classes/NSDeleteCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSDeleteCommand" target="_top">NSDeleteCommand</a></code>, and <code><a href="../../../Reference/Foundation/Classes/NSSetCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSSetCommand" target="_top">NSSetCommand</a></code>.</p><p></p></div><a name="//apple_ref/doc/uid/20001242-SW25" title="A Verb-first Move Command"></a><h3>A Verb-first Move Command</h3><p>Suppose your application lets scripters work with terms such as <code>file</code> and <code>folder</code>, providing a familiar terminology to access data that is actually stored in a database. However, your underlying implementation does not support operations on this data using KVC accessors whose keys can be mapped to <code>"file"</code> and <code>"folder"</code>. Or perhaps you tried the standard <code>move</code> support and found that you need increased performance for moving large numbers of objects.</p><p>Using the verb-first approach, you can subclass <code>NSMoveCommand</code> and override <code>performDefaultImplementation</code>. The <code>NSMoveCommand</code> class is already a verb-first command, and it generally makes sense to have a higher-level object within your application supervise the movement of contained objects, rather than telling each object to move itself.</p><p>In your override of <code>performDefaultImplementation</code>, you can extract information from the command and translate it into appropriate operations on the underlying data. For example, you can examine the objects to move: </p><ul class="spaceabove"><li class="li"><p> If they are <code>file</code> or <code>folder</code> objects, you make the appropriate changes in the database to reflect the changes expected in the user's (AppleScript object model) view of the world.</p></li><li class="li"><p>For other objects, you can use the following statement to apply the standard behavior supplied by <code>NSMoveCommand</code>:</p><p><code>return [super performDefaultImplementation];</code></p></li></ul><a name="//apple_ref/doc/uid/20001242-SW26" title="An Object-first Move Command"></a><h3>An Object-first Move Command</h3><p>Suppose, on the other hand, that certain objects in your application do know how to move themselves, and they use a mechanism different from the KVC-based moves supported by <code>NSMoveCommand</code>, which work with standard containers. In this situation, you could use the object-first mechanism to allow objects of a certain class to handle the <code>move</code> command directly in a method defined for that class.</p><p>To implement this approach, you use the steps described previously in <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW8">“About Object-first Script Commands.”</a></span> In your handler methods, you extract the information you need from the command object (the location to move to), which is passed as a parameter to the method, then perform the move for the current object.<a name="//apple_ref/doc/uid/20001242-DontLinkElementID_470"></a></p><a name="//apple_ref/doc/uid/20001242-SW5" title="Summary of AppleScript Command Support"></a><h2>Summary of AppleScript Command Support</h2><p><span class="content_text">Table 7-1</span> lists AppleScript commands supported by Cocoa scripting. For each command, it shows the Objective-C class that executes the command. It also describes the default handling for the command and how to customize it.</p><p>Though not mentioned in the table, for classes that recommend verb-first modification, you can generally use the object-first approach as well. This is particularly useful if you want to modify behavior on a class-by-class basis.</p><p>Remember too that most Cocoa script commands rely on you to maintain KVC-compliance in the naming of scriptable properties in your scriptable classes, and in some cases to implement object specifier methods for those classes. Otherwise, the commands cannot identify objects in your application on which to operate, or get or set values in those objects.</p><p>For additional information on default handling, see <span class="content_text"><a href="../SApps_handle_AEs/SAppsHandleAEs.html#//apple_ref/doc/uid/20001239-1117769">“Apple Events Sent by the Mac OS.”</a></span></p><a name="//apple_ref/doc/uid/20001242-SW14" title="Table 7-1Default support for AppleScript commands and how to customize it"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 7-1&nbsp;&nbsp;</strong>Default support for AppleScript commands and how to customize it</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>AppleScript command</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Objective-C class</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Default support and how to customize it</p></th></tr><tr><td  scope="row"><p><code>close</code></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSCloseCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSCloseCommand" target="_top">NSCloseCommand</a></code></p></td><td ><p>Cocoa scripting automatically handles <code>close</code> for windows and documents, with the window version commonly passing control to the window's document. Customize by overriding the <code>handleCloseScriptCommand:</code> method in a subclass of <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/cl/NSDocument" target="_top">NSDocument</a></code> or <code><a href="../../../Reference/ApplicationKit/Classes/NSWindow_Class/Reference/Reference.html#//apple_ref/occ/cl/NSWindow" target="_top">NSWindow</a></code>, depending on the object. (See also the documentation for <code><a href="../../../Reference/ApplicationKit/Protocols/NSWindowScripting_Protocol/Reference/Reference.html#//apple_ref/occ/cat/NSWindowScripting" target="_top">NSWindowScripting</a></code>.)</p><p>To support <code>close</code> for a different class, you can use the mechanism described in <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW8">“About Object-first Script Commands.”</a></span></p></td></tr><tr><td  scope="row"><p><code>count</code></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSCountCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSCountCommand" target="_top">NSCountCommand</a></code></p></td><td ><p>Handled by verb-first command. Customize by implementing a verb-first subclass, as described in <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW9">“About Verb-first Script Commands.”</a></span></p></td></tr><tr><td  scope="row"><p><code>delete</code></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSDeleteCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSDeleteCommand" target="_top">NSDeleteCommand</a></code></p></td><td ><p>Handled by verb-first command. Customize by implementing a verb-first subclass, as described in <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW9">“About Verb-first Script Commands.”</a></span></p></td></tr><tr><td  scope="row"><p><code>duplicate</code></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSCloneCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSCloneCommand" target="_top">NSCloneCommand</a></code></p></td><td ><p>Handled by a verb-first command that invokes <code>copyWithZone:</code> on the objects to be duplicated. Customize in your implementation of that method or by implementing a verb-first subclass, as described in <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW9">“About Verb-first Script Commands.”</a></span></p></td></tr><tr><td  scope="row"><p><code>exists</code></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSExistsCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSExistsCommand" target="_top">NSExistsCommand</a></code></p></td><td ><p>Handled by verb-first command. Customize by implementing a verb-first subclass, as described in <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW9">“About Verb-first Script Commands.”</a></span></p></td></tr><tr><td  scope="row"><p><code>get</code></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSGetCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSGetCommand" target="_top">NSGetCommand</a></code></p></td><td ><p>Handled by verb-first command. Customize by implementing a verb-first subclass, as described in <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW9">“About Verb-first Script Commands.”</a></span></p><p>You do not need a <code>command</code> element in your sdef file for the <code>get</code> command.</p></td></tr><tr><td  scope="row"><p><code>make</code></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSCreateCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSCreateCommand" target="_top">NSCreateCommand</a></code></p></td><td ><p>Handled by verb-first command. Customize by implementing a verb-first subclass, as described in <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW9">“About Verb-first Script Commands.”</a></span></p></td></tr><tr><td  scope="row"><p><code>move</code></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSMoveCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSMoveCommand" target="_top">NSMoveCommand</a></code></p></td><td ><p>Handled by verb-first command. Customize by implementing either a verb-first or object-first approach, as described in <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW11">“Modifying a Standard Command.”</a></span></p></td></tr><tr><td  scope="row"><p><code>open documents</code></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSScriptCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSScriptCommand" target="_top">NSScriptCommand</a></code></p></td><td ><p>Cocoa automatically handles <code>open documents</code> by invoking the methods described in <span class="content_text"><a href="../SApps_handle_AEs/SAppsHandleAEs.html#//apple_ref/doc/uid/20001239-1119823">“Open.”</a></span> You can modify the default behavior by implementing or overriding those methods.</p></td></tr><tr><td  scope="row"><p><code>print documents</code></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSScriptCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSScriptCommand" target="_top">NSScriptCommand</a></code></p></td><td ><p>Cocoa automatically handles <code>print</code> for  documents by invoking the methods described in <span class="content_text"><a href="../SApps_handle_AEs/SAppsHandleAEs.html#//apple_ref/doc/uid/20001239-1122706">“Print.”</a></span> You can modify the default behavior by implementing or overriding those methods.</p></td></tr><tr><td  scope="row"><p><code>quit</code></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSQuitCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSQuitCommand" target="_top">NSQuitCommand</a></code></p></td><td ><p>The <code><a href="../../../Reference/ApplicationKit/Classes/NSApplication_Class/Reference/Reference.html#//apple_ref/occ/cl/NSApplication" target="_top">NSApplication</a></code> class automatically handles this command for applications by invoking the methods described in <span class="content_text"><a href="../SApps_handle_AEs/SAppsHandleAEs.html#//apple_ref/doc/uid/20001239-1121178">“Quit.”</a></span> You can modify the default behavior by implementing or overriding those methods.</p></td></tr><tr><td  scope="row"><p><code>save</code></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSScriptCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSScriptCommand" target="_top">NSScriptCommand</a></code></p></td><td ><p>Cocoa automatically handles <code>save</code> for windows and documents, with the window version commonly passing control to the window's document. Customize saving behavior by overriding the <code>handleSaveScriptCommand:</code> method in a subclass of <code><a href="../../../Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/cl/NSDocument" target="_top">NSDocument</a></code> or <code><a href="../../../Reference/ApplicationKit/Classes/NSWindow_Class/Reference/Reference.html#//apple_ref/occ/cl/NSWindow" target="_top">NSWindow</a></code>, depending on the object. (See also the documentation for <code><a href="../../../Reference/ApplicationKit/Protocols/NSWindowScripting_Protocol/Reference/Reference.html#//apple_ref/occ/cat/NSWindowScripting" target="_top">NSWindowScripting</a></code>.)</p><p>To support <code>save</code> for a different class, you can use the mechanism described in <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW8">“About Object-first Script Commands.”</a></span></p></td></tr><tr><td  scope="row"><p><code>set</code></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSSetCommand_Class/Reference/Reference.html#//apple_ref/occ/cl/NSSetCommand" target="_top">NSSetCommand</a></code></p></td><td ><p>Handled by verb-first command. Customize by implementing a verb-first subclass, as described in <span class="content_text"><a href="SAppsScriptCmds.html#//apple_ref/doc/uid/20001242-SW9">“About Verb-first Script Commands.”</a></span></p><p>You do not need a <code>command</code> element in your sdef file for the <code>set</code> command.</p></td></tr></table></div>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../SApps_object_specifiers/SAppsObjectSpecifiers.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../SApps_debugging/SAppsDebugging.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-03-11<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Conceptual/ScriptableCocoaApplications/SApps_script_cmds/SAppsScriptCmds.html%3Fid%3DTP40002164-2.4&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Conceptual/ScriptableCocoaApplications/SApps_script_cmds/SAppsScriptCmds.html%3Fid%3DTP40002164-2.4&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Conceptual/ScriptableCocoaApplications/SApps_script_cmds/SAppsScriptCmds.html%3Fid%3DTP40002164-2.4&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>