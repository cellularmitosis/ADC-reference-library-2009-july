<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Cyberdog Item Opening Process(Cyberdog)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING19></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->




<!-- Main Body -->

<CENTER>
<P>
<A HREF="Cyberdog-18.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Cyberdog-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Cyberdog-319.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Cyberdog-20.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Cyberdog-2.html"><B>Cyberdog Programmer's Kit</B></A> / <A HREF="Cyberdog-10.html"><B>Part 1 - Basics</B></A><BR><DD><A HREF="Cyberdog-15.html"><B>Chapter 2 - Development Overview</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING19-0></A>
<H1><A NAME=MARKER-9-121></A>Cyberdog Item Opening Process</H1>
 <A NAME=MARKER-2-122></A>This section discusses the opening process of a Cyberdog item and how various Cyberdog objects play a role in that process. It begins with a description of how Cyberdog items are manipulated and stored. Then it discusses the opening process, including a description of the roles played by the Cyberdog item, Cyberdog display part, opener part, navigator, and download part. Finally, it describes various scenarios for implementing a Cyberdog item's <CODE>Open</CODE> method and a Cyberdog display part's <CODE>OpenCyberItem</CODE> method.<P>
<A NAME=HEADING19-2></A>
<H2>Manipulating and Storing Cyberdog Items</H2>
 <A NAME=MARKER-2-123></A>In order to understand the opening process of a Cyberdog item, it is useful to first understand the different ways in which a Cyberdog item is represented and how those representations are manipulated and stored.<P>
 <A NAME=MARKER-2-124></A>When displayed as an icon in a window, such as the log, a notebook, or a web page, a Cyberdog item is an object in memory; it is not an OpenDoc part. A user can open a Cyberdog item that is in memory by clicking on its icon. This action results in a call to the Cyberdog item's <CODE>Open</CODE> method.<P>
 Cyberdog items implement their opening behavior; in other words, they know how to open themselves. In the simplest cases, <CODE>Open</CODE> creates a Cyberdog display part and calls its <CODE>OpenCyberItem</CODE> method. <CODE>OpenCyberItem</CODE> initiates a download of the data referenced by the Cyberdog item and displays the display part. For more information on the objects involved in the opening process, see <A HREF=#MARKER-9-129>"Object Roles in the Opening Process" (page 72)</A>.<P>
 <A NAME=MARKER-2-125></A>When the user drags a Cyberdog item object (from a notebook, for example), the Cyberdog item is stored in the storage unit of the OpenDoc drag-and-drop object as kind <CODE><A NAME=MARKER-2-126></A>kCyberItemKind</CODE>. The destination of the drop determines what happens.<P>
<UL>
<LI>If the destination of the drop is the desktop or a Finder window, the Cyberdog item is stored as an OpenDoc part whose part kind is <CODE>kCyberItemKind</CODE>. If the user clicks on that part, OpenDoc creates an opener part (which binds to parts of kind <CODE>kCyberItemKind</CODE>) to open the part.
<LI><A NAME=MARKER-2-128></A>If the destination of the drop is a container that does not manipulate data of kind <CODE>kCyberItemKind</CODE>, the container creates an embedded part, clones the contents of the drag-and-drop storage unit into its draft, and embeds the new part at an appropriate location in its content. Because the kind of the storage unit is <CODE>kCyberItemKind</CODE>, OpenDoc creates an opener part to display the part.
<LI>If the destination of the drop is a container that does manipulate data of kind <CODE>kCyberItemKind</CODE>, the container can incorporate the data. For example, the container might display the Cyberdog item as an icon instead of displaying the content the item references.<P>
</UL>
 Copying and pasting of Cyberdog items are handled in a similar fashion.<P>
<A NAME=HEADING19-11></A>
<H2><A NAME=MARKER-9-129></A>Object Roles in the Opening Process</H2>
 <A HREF=Cyberdog-18.html#MARKER-9-96>"A Cyberdog Example" (page 66)</A> shows how to open a Cyberdog item that references content stored on a Gopher server. Because that Cyberdog item references text, it creates a Cyberdog text display part. The text display part downloads the data and displays it. That example represents the simplest case of opening a Cyberdog item: the Cyberdog item knows the type of the data it references and the text display part opens itself immediately.<P>
 The primary responsibility for opening a Cyberdog item is shared between the Cyberdog item being opened (the Cyberdog item's <CODE>Open</CODE> method) and the display part that will display the data referenced by the Cyberdog item (the display part's <CODE>OpenCyberItem</CODE> method). However, opening a Cyberdog item is more complex in these situations:<P>
<UL>
<LI>The Cyberdog item cannot identify the type of the data it references and thus cannot create a display part immediately.
<LI>The Cyberdog item can identify the type of data it references, but cannot create a Cyberdog display part capable of downloading and displaying that type of data.
<LI>The Cyberdog display part cannot open until all the data it is to display has been downloaded. For example, the Cyberdog QuickTime display part does not open until all of its data has been downloaded.
<LI>The Cyberdog display part is embedded in a navigator.<P>
</UL>
 The Cyberdog item and the Cyberdog display part may rely on other objects, such as an opener part, a navigator, or a download part, in these more complex opening scenarios.<P>
<A NAME=HEADING19-19></A>
<H3>Role of the Cyberdog Item</H3>
 A Cyberdog item's <CODE>Open</CODE> method is responsible for the following:<P>
<UL>
<LI><B><A NAME=MARKER-2-130></A>resolving</B>, or determining the type of data it refers to
<LI>creating a Cyberdog display part appropriate for the data type in the appropriate document
<LI>calling the display part's <CODE>OpenCyberItem</CODE> method<P>
</UL>
 Some Cyberdog items (Gopher items, for example) are resolved inherently; they always refer to a single, known type of data. If you are developing a Cyberdog item that is resolved inherently, your Cyberdog item's <CODE>Open</CODE> method can be synchronous.<P>
 Some other Cyberdog items (HTTP items, for example) cannot be resolved without communicating with the server on which the data they reference resides. If you are developing a Cyberdog item that is not resolved inherently, your Cyberdog item's <CODE>Open</CODE> method must be asynchronous.<P>
<A NAME=HEADING19-26></A>
<H3>Role of the Display Part</H3>
 <A NAME=MARKER-2-131></A>When a Cyberdog item calls a Cyberdog display part's <CODE>OpenCyberItem</CODE> method, the display part is responsible for the following:<P>
<UL>
<LI>It must perform tasks to prepare for displaying the data referenced by its Cyberdog item, such as creating a stream and opening it to initiate the download operation.
<LI>It must call its inherited <CODE>OpenCyberItem</CODE> method, which displays the display part.<P>
</UL>
 Some display parts (the Cyberdog HTML display part, for example) display data as it is downloaded; they do not wait to display until all the data has been downloaded. If you want your display part to display before the data referenced by its Cyberdog item has been completely downloaded, the display part's <CODE>OpenCyberItem</CODE> method can be synchronous.<P>
 Some other display parts (the Cyberdog QuickTime display part, for example) do not display until all of the data they are to display has been downloaded. If you do not want your display part to display until the data referenced by its Cyberdog item has been completely downloaded, the display part's <CODE>OpenCyberItem</CODE> method must be asynchronous.<P>
 In addition, a Cyberdog display part decides whether it is to be embedded in a navigator. If your display part is to be embedded in a navigator, you need to modify your <CODE>OpenCyberItem</CODE> method to obtain a navigator and call its <CODE>GoToCyberItem</CODE> method.<A NAME=MARKER-2-132></A><P>
<A NAME=HEADING19-33></A>
<H3>Role of the Opener Part</H3>
 <A NAME=MARKER-2-133></A>The primary purpose of the opener part is to bridge the gap between a Cyberdog item stored in an OpenDoc document and the Cyberdog display part that displays the content referenced by the Cyberdog item. To bridge this gap, the opener part does the following:<P>
<UL>
<LI>It binds to parts of kind <CODE>kCyberItemKind</CODE>.
<LI>It serves as a placeholder in a document until the appropriate display part can be opened. The opener part replaces itself in a document, putting the resulting display part in its stead.<P>
</UL>
 A secondary purpose of the opener part is to display progress to the user during an asynchronous operation. A Cyberdog item or Cyberdog display part that initiates an asynchronous operation can attach a progress broadcaster to the opener part and use the opener part to display progress.<P>
 An <B><A NAME=MARKER-2-134></A>initial opener part</B> is an opener part created by OpenDoc to bind to a part of kind <CODE>kCyberItemKind</CODE>. In this situation, the initial opener part is passed as a parameter to the Cyberdog item's <CODE>Open</CODE> method. However, before the Cyberdog item can use the initial opener part, the item must first <B>obtain</B> it from the Cyberdog session by calling the session object's <CODE><A NAME=MARKER-2-135></A>ObtainOpener</CODE> method; this method returns an <B><A NAME=MARKER-2-136></A>obtained opener part</B>.<P>
 You should always use the opener part returned by <CODE>ObtainOpener</CODE> and should not assume that it is the same as the initial opener part that you passed in. Once you have obtained an opener part, you should use the opener part's methods to manipulate it. For example, you should not call an obtained opener part's <CODE>Open</CODE> method or place the opener part in an embedded frame.You can call <CODE>ObtainOpener</CODE> without worrying about whether it has already been called during the opening of a given Cyberdog item; the method can be called more than once.<P>
<A NAME=HEADING19-40></A>
<H4><A NAME=MARKER-9-137></A>Binding to Stored Cyberdog Items</H4>
 <A NAME=MARKER-2-138></A>When a Cyberdog item is stored in a storage unit (for example, when it is stored on the desktop as a reference) its part kind is <CODE>kCyberItemKind</CODE>. If the user later clicks on the Cyberdog item's reference icon on the desktop, OpenDoc attempts to create a part for the storage unit. Because the storage unit contains data of kind <CODE>kCyberItemKind</CODE>, OpenDoc creates an opener part.<P>
 The opener part reads the Cyberdog item from the storage unit by calling <CODE>CyberSession::CreateCyberItemFromSU</CODE>. The opener part waits until it is displayed in a frame and then calls the Cyberdog item's <CODE>Open</CODE> method, passing itself as the initial opener part.<P>
<A NAME=HEADING19-43></A>
<H4>Acting as a Placeholder for Display Parts</H4>
 If either the Cyberdog item's <CODE>Open</CODE> method or the Cyberdog display part's <CODE>OpenCyberItem</CODE> method is asynchronous, the method must obtain an opener part by calling <CODE>CyberSession::ObtainOpener</CODE> and attach to the opener part a progress broadcaster representing the asynchronous operation. If either <CODE>Open</CODE> or <CODE>OpenCyberItem</CODE> is passed an opener part as a parameter, the method can try to obtain that opener part by passing it as a parameter to <CODE>ObtainOpener</CODE>. However, <CODE>ObtainOpener</CODE> may return a different opener part than the one passed to it.<P>
 The opener part opens in its own window or in an embedded frame and displays progress during the opening process. The opener part is responsible for ensuring that a Cyberdog display part is created in the appropriate document and displayed in the right place on the screen.<P>
<UL>
<LI>Your Cyberdog item's <CODE>Open</CODE> method must call <CODE>CyberSession::CreateCyberPart</CODE> to create a display part. This method creates the display part in either an OpenDoc document or the session document, depending on which document contains the opener part.
<LI>Unless your display part is to be embedded in a navigator, your part's <CODE>OpenCyberItem</CODE> method must call its inherited method to display the part. The inherited <CODE>OpenCyberItem</CODE> method checks whether an opener part is being used. If so, the inherited method calls the opener part's <CODE>OpenPart</CODE> method; <CODE>OpenPart</CODE> ensures that the display part is displayed in the right place. If not, the inherited method calls the display part's <CODE>Open</CODE> method.<A NAME=MARKER-2-139></A><P>
</UL>
<A NAME=HEADING19-48></A>
<H3>Role of the Navigator</H3>
 <A NAME=MARKER-2-140></A>A navigator is a special type of opener part; <CODE>CyberNavigatorExtension</CODE> is a subclass of <CODE>CyberOpenerPartExtension</CODE>. As an opener part, a navigator can be a placeholder in a document during the opening process and can display progress. Unlike other opener parts, a navigator does not replace itself in a document, putting the resulting display part in its stead. Rather, the display part is embedded in the navigator. Also, a navigator does not bind to parts of kind <CODE>kCyberItemKind.</CODE><P>
 The calling Cyberdog item may pass a navigator as a parameter to a Cyberdog display part's <CODE>OpenCyberItem</CODE> method. However, it is up to the display part to decide whether it will be embedded in a navigator.<P>
 A display part that wants to be embedded in a navigator must obtain a navigator by calling <CODE>ObtainOpener</CODE>, passing <CODE>kNavigatorKind</CODE> as the part kind of the opener part. The display part should always use the navigator returned by <CODE>ObtainOpener</CODE>. If a navigator was passed into the <CODE>OpenCyberItem</CODE> method, the display part can try to obtain that navigator by passing it as a parameter to <CODE>ObtainOpener</CODE>. However, <CODE>ObtainOpener</CODE> may not return the same navigator that the display part passed to it. For example, if the user has disabled the <A NAME=MARKER-2-141></A>Browse in Place menu item in the Navigate menu, <CODE>ObtainOpener</CODE> returns a new navigator.<P>
 Once the display part has obtained a navigator, the display part should call the navigator's <CODE>GoToCyberItem</CODE> method, which displays the display part in the navigator.<A NAME=MARKER-2-143></A><P>
<A NAME=HEADING19-53></A>
<H3>Role of the Download Part</H3>
 <A NAME=MARKER-2-144></A>A Cyberdog item calls <CODE>CyberSession::CreateCyberPart</CODE> to create an appropriate Cyberdog display part for the data type referenced by the item. If no Cyberdog display part editor is available for that data type, <CODE>CreateCyberPart</CODE> cannot create a Cyberdog display part. If so, the Cyberdog item can use a download part to download the data referenced by the item, save it to a file, and attempt to open the file in some other way.<P>
 To create a download part, the Cyberdog item calls <CODE>CyberSession::CreatePartInCyberDocument</CODE>, passing <CODE>kDownloadPartKind</CODE> as the part kind to be created. The Cyberdog item calls the resulting download part's <CODE>OpenCyberItem</CODE> method, which takes these actions:<P>
<UL>
<LI>It obtains an opener part by calling <CODE>CyberSession::ObtainOpener</CODE>, passing <CODE>kOpenerPartKind</CODE> as the opener part kind.
<LI>It downloads the data referenced by the Cyberdog item and saves it to a file.
<LI>It calls the opener part's <CODE>OpenFile</CODE> method. <CODE>OpenFile</CODE> tries to find a part editor (a non-Cyberdog part editor) that can open files of this type; if it cannot, it asks the Finder to open the file.<A NAME=MARKER-2-146></A><P>
</UL>
<A NAME=HEADING19-59></A>
<H2>Implementing the Opening Methods</H2>
 Responsibility for opening a Cyberdog item is divided between the <CODE>Open</CODE> method of the Cyberdog item being opened and the <CODE>OpenCyberItem</CODE> method of the display part that will display the data referenced by the Cyberdog item.<P>
<A NAME=HEADING19-61></A>
<H3>Implementing a Cyberdog Item's Open Method</H3>
 <A NAME=MARKER-2-147></A>The Cyberdog item's <CODE>Open</CODE> method is responsible for determining the type of data the item references, creating an appropriate display part for that type of data, and calling the display part's <CODE>OpenCyberItem</CODE> method.<P>
 If you are developing your own Cyberdog item, you must subclass the <CODE>CyberItem</CODE> class and override your subclass's <CODE>Open</CODE> method to implement the item's opening behavior.<P>
<A NAME=HEADING19-64></A>
<H4><A NAME=MARKER-9-148></A>Open as a Synchronous Method</H4>
 If a Cyberdog item is inherently resolved, its <CODE>Open</CODE> method can be asynchronous. Before returning, <CODE>Open</CODE> calls the Cyberdog display part's <CODE>OpenCyberItem</CODE> method, which displays the display part. In this case, the <CODE>Open</CODE> method should perform the following steps:<P>
<OL>
<LI>If the parameter set contains either an initial or an obtained opener part, retrieve it. For example, the parameter set may contain an opener part if the Cyberdog item is being opened from a storage unit, as discussed in <A HREF=#MARKER-9-137>"Binding to Stored Cyberdog Items" (page 75)</A>.<P>
</OL>
<PRE>
   if (params)
      if (!params-&gt;GetParameter (ev, kCDInitialOpenerPartKey,
         &amp;openerPart))
      params-&gt;GetParameter (ev, kCDObtainedOpenerPartKey, &amp;openerPart);
</PRE>
<OL>
<LI>Call <CODE>CyberSession::<A NAME=MARKER-2-149></A>GetISOTypeFromMIMEType </CODE>to translate the MIME type of the data referenced by the Cyberdog item to a part kind.<P>
</OL>
<PRE>
   ODValueType kind = cyberSession (ev)-&gt;GetISOTypeFromMIMEType (ev,
      someMIMEType);
</PRE>
<OL>
<LI>Call <CODE>CyberSession::<A NAME=MARKER-2-150></A>CreateCyberPart</CODE> to create the part, passing the part kind and the opener part, if any. <CODE>CreateCyberPart</CODE> determines whether to create the new part in the session document or in another OpenDoc document by checking which document the opener part is contained in.<P>
</OL>
<PRE>
   ODPart* part = cyberSession-&gt;CreateCyberPart (ev, openerPart,
      kind, kODNULL);
</PRE>
<OL>
<LI>If <CODE>CreateCyberPart</CODE> cannot create a Cyberdog display part for the type of data referenced by the Cyberdog item and the referenced data can be downloaded, call <CODE>CyberSession::<A NAME=MARKER-2-151></A>CreatePartInCyberDocument</CODE> to create a download part.<P>
</OL>
<PRE>
   if (!part &amp;&amp; this-&gt;IsDownloadable (ev))
      part = cyberSession-&gt;CreatePartInCyberDocument (ev,
         kDownloadPartKind, kODNULL);
</PRE>
<OL>
<LI>Call the display part's (or the download part's) <CODE>OpenCyberItem</CODE> method.<P>
</OL>
<PRE>
   CyberPartExtension* CyberPartExt = part-&gt;GetExtension (ev,
      kCyberPartExtension);
   CyberPartExt-&gt;OpenCyberItem (ev, this, openerPart, params);
   CyberPartExt-&gt;Release (ev);
</PRE>
<A NAME=HEADING19-76></A>
<H4>Open as an Asynchronous Method</H4>
 If the Cyberdog item is not inherently resolved, its <CODE>Open</CODE> method must be asynchronous. In this case, the Cyberdog item must obtain an opener part to act as a placeholder and to display progress until an appropriate Cyberdog display part can be created. The Cyberdog item defers the call to <CODE>OpenCyberItem</CODE> until the display part is created. In this case, <CODE>Open</CODE> should perform the following steps:<P>
<OL>
<LI>Determine whether the Cyberdog item has been resolved by calling its <CODE>isResolved</CODE> method. If the Cyberdog item is resolved, perform steps 1 to 5 described in <A HREF=#MARKER-9-148>"Open as a Synchronous Method" (page 77)</A>.
<LI>If the Cyberdog item has not been resolved, retrieve an initial or obtained opener part, if any, from the parameter set. For example, the parameter set may contain an opener part if the Cyberdog item is being opened from a storage unit, as discussed in <A HREF=#MARKER-9-137>"Binding to Stored Cyberdog Items" (page 75)</A>.<P>
</OL>
<PRE>
   if (params)
      if (!params-&gt;GetParameter (ev, kCDInitialOpenerPartKey, 
         &amp;openerPart))
         params-&gt;GetParameter (ev, kCDObtainedOpenerPartKey, 
            &amp;openerPart);
</PRE>
<OL>
<LI>Call the <CODE>CyberSession::ObtainOpener</CODE> method to obtain an opener part, passing the opener part retrieved from the parameter set, if any. You should acquire the parameter set before passing it to <CODE>ObtainOpener</CODE>. If no parameter set was passed to the <CODE>Open</CODE> method, you should create one before calling <CODE>ObtainOpener</CODE>.<P>
</OL>
<PRE>
   openerPart = cyberSession-&gt;ObtainOpener (ev, openerPart, 
      kODNULL, this, params);
</PRE>
<OL>
<LI>Call the Cyberdog item's <CODE><A NAME=MARKER-2-153></A>Resolve</CODE> method, passing a pointer to a notification function that <CODE>Resolve</CODE> can call when the Cyberdog item is resolved.<P>
</OL>
<PRE>
   this-&gt;Resolve (ev, MyCyberItemResolved, params, openerPart);
</PRE>
 Your Cyberdog item's <CODE>Resolve</CODE> method should initiate whatever process is necessary for its resolution, such as creating and opening a Cyberdog stream. To display progress during the resolution process, the <CODE>Resolve</CODE> method should attach a progress broadcaster to the opener part and call the broadcaster's accessor methods to update its progress settings. When the <CODE>Resolve</CODE> method has finished trying to resolve the Cyberdog item, it should call the notification function.<P>
<DL>
<DT><B>Note</B>
<DD>Do not call the resolution notification function at interrupt time.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 Your resolution notification function should check the error code parameter to determine whether the Cyberdog item was resolved successfully. If the Cyberdog item is resolved, the resolution notification function should perform steps 1 to 5 described in <A HREF=#MARKER-9-148>"Open as a Synchronous Method" (page 77)</A>. The resolution notification function should release the parameter set.<A NAME=MARKER-2-154></A><P>
<A NAME=HEADING19-88></A>
<H3>Implementing a Display Part's OpenCyberItem Method</H3>
 <A NAME=MARKER-2-155></A>The Cyberdog display part's <CODE>OpenCyberItem</CODE> method is responsible for downloading and displaying the data referenced by the Cyberdog item. If you are developing your own Cyberdog display part, you must subclass <CODE>CyberPartExtension</CODE> and override your subclass's <CODE>OpenCyberItem</CODE> method.<P>
<A NAME=HEADING19-90></A>
<H4>OpenCyberItem as a Synchronous Method</H4>
 A Cyberdog display part's <CODE>OpenCyberItem</CODE> method can be synchronous if the display part can be displayed before all of the data it is to display has been downloaded. In this case, <CODE>OpenCyberItem</CODE> should perform the following steps:<P>
<OL>
<LI>Call the Cyberdog item's <CODE><A NAME=MARKER-2-156></A>CreateCyberStream</CODE> method to retrieve a stream for downloading the data and call the stream's <CODE>Open</CODE> method to initiate the download operation.<P>
</OL>
<PRE>
   fMyStream = fMyItem-&gt;CreateCyberStream (ev);
   fMyStream-&gt;Open (ev);
</PRE>
<OL>
<LI>Retrieve the Cyberdog item's parent item, if any, from the parameter set, and call <CODE>CyberSession::<A NAME=MARKER-2-157></A>AddCyberItemToLog</CODE> to add the Cyberdog item to the log.<P>
</OL>
<PRE>
   CyberItem* parent = kODNULL;
   if (params)
      params-&gt;GetParameter (ev, kCDParentItemKey, &amp;parent);
   GetCyberSession (ev)-&gt;AddCyberItemToLog (ev, parent, fMyItem);
</PRE>
<OL>
<LI>Call the inherited <CODE>OpenCyberItem</CODE> method, which displays the display part.<P>
</OL>
<PRE>
   inherited::OpenCyberItem (item, openerPart, params);
</PRE>
<A NAME=HEADING19-98></A>
<H4>OpenCyberItem as an Asynchronous Method</H4>
 If a Cyberdog display part cannot be displayed until all the content referenced by its Cyberdog item has been downloaded, the display part's <CODE>OpenCyberItem</CODE> method must asynchronous. <CODE>OpenCyberItem</CODE> does not call its inherited method; calling the inherited method is deferred until the data has been downloaded.<P>
 In this case, <CODE>OpenCyberItem</CODE> should perform the following steps:<P>
<OL>
<LI>Retrieve the Cyberdog item's parent item, if any, from the parameter set, and call <CODE>CyberSession::AddCyberItemToLog</CODE> to add the Cyberdog item to the log.<P>
</OL>
<PRE>
   CyberItem* parent = kODNULL;
   if (params)
      params-&gt;GetParameter (ev, kCDParentItemKey, &amp;parent);
   GetCyberSession (ev)-&gt;AddCyberItemToLog (ev, parent, fMyItem);
</PRE>
<OL>
<LI>Call the <CODE>CyberSession::ObtainOpener</CODE> method to obtain an opener part, which will be used to display progress until the display part can be displayed. You must acquire the parameter set before passing it to <CODE>ObtainOpener</CODE>. If no parameter set was passed to the <CODE>Open</CODE> method, you should create one before calling <CODE>ObtainOpener</CODE>.<P>
</OL>
<PRE>
   openerPart = cyberSession-&gt;ObtainOpener (ev, openerPart,
      kODNULL, this, params);
</PRE>
<OL>
<LI>Call a method that initiates whatever asynchronous process is necessary for the data to be displayed, such as creating and opening a Cyberdog stream. To display progress while the data is downloaded, the method should attach a progress broadcaster to the opener part and call the broadcaster's accessor methods to update its progress settings. When the method is finished downloading the data, it should call the inherited <CODE>OpenCyberItem</CODE> method.<P>
</OL>
<A NAME=HEADING19-106></A>
<H4>Embedding a Display Part in a Navigator</H4>
 <A NAME=MARKER-2-159></A>A Cyberdog display part determines whether to embed itself in a navigator. If so, the display part must call <CODE>ObtainOpener</CODE> to obtain a navigator. In this case, <CODE>OpenCyberItem</CODE> performs the following steps:<P>
<OL>
<LI>Call the Cyberdog item's <CODE>CreateCyberStream</CODE> method to retrieve a stream for downloading the data and call the stream's <CODE>Open</CODE> method to initiate the download operation.<P>
</OL>
<PRE>
   fMyStream = fMyItem-&gt;CreateCyberStream (ev);
   fMyStream-&gt;Open (ev);
</PRE>
<OL>
<LI>Retrieve the Cyberdog item's parent item, if any, from the parameter set, and call <CODE>CyberSession::AddCyberItemToLog</CODE> to add the Cyberdog item to the log.<P>
</OL>
<PRE>
   CyberItem* parent = kODNULL;
   if (params)
      params-&gt;GetParameter (ev, kCDParentItemKey, &amp;parent);
   GetCyberSession (ev)-&gt;AddCyberItemToLog (ev, parent, fMyItem);
</PRE>
<OL>
<LI>Call the display part's <CODE><A NAME=MARKER-2-160></A>SetCyberItem</CODE> method to store a reference to the Cyberdog item. This method is called by the inherited <CODE>OpenCyberItem</CODE> method; however, in this case, the inherited <CODE>OpenCyberItem</CODE> method is not called.<P>
</OL>
<PRE>
   SetCyberItem (item, params);
</PRE>
<OL>
<LI>Call the <CODE>CyberSession::<A NAME=MARKER-2-161></A>ObtainOpener</CODE> method, passing <CODE>kNavigatorKind</CODE> as the opener part kind, to obtain a navigator. You must acquire the parameter set before passing it to <CODE>ObtainOpener</CODE>. If no parameter set was passed to the <CODE>Open</CODE> method, you should create one before calling <CODE>ObtainOpener</CODE>.<P>
</OL>
<PRE>
   ODPart* navPart = GetCyberSession()-&gt;ObtainOpener (ev, openerPart,
      kNavigatorKind, item, params);
</PRE>
<OL>
<LI>Instead of calling the display part's <CODE>OpenCyberItem</CODE> method, call the navigator's <CODE><A NAME=MARKER-2-162></A>GoToCyberItem</CODE> method, which displays the display part in the navigator.<P>
</OL>
<PRE>
   TempNavigatorExtension navigatorExt (navPart, 
      kCyberNavigatorExtension);
   navigatorExt-&gt;GoToCyberItem (ev, item, this-&gt;GetODPart(), params);
</PRE>
<OL>
<LI>Release the parameter set.<P>
</OL>
<PRE>
   params-&gt;Release (ev);
</PRE>
<DL>
<DT><B>Note</B>
<DD>The previous scenario assumes that <CODE>OpenCyberItem</CODE> is synchronous. However, a display part whose <CODE>OpenCyberItem</CODE> method is asynchronous can also be embedded in a navigator<A NAME=MARKER-2-163></A>.<EM></EM><A NAME=MARKER-2-164></A>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 <P>

</BLOCKQUOTE>
<HR>
<center>
<A HREF="Cyberdog-18.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Cyberdog-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Cyberdog-319.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Cyberdog-20.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Cyberdog-3.html">&copy; Apple Computer, Inc.</A><br>13 JUL 1996</center></font><P>
<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->
</BODY>
</HTML>   
