<html><head><title>Mac OS X
 Manual Page For pgsql_table(5)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/5/pgsql_table" title="Mac OS X
 Manual Page for pgsql_table(5)"><!-- headerDoc=man; indexgroup=Section 5; uid="//apple_ref/doc/man/5/pgsql_table"; name=pgsql_table(5) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
PGSQL_TABLE(5)                                                                                PGSQL_TABLE(5)



<b>NAME</b>
       pgsql_table - Postfix PostgreSQL client configuration

<b>SYNOPSIS</b>
       <b>postmap</b> <b>-q</b> <b>"</b><u>string</u><b>"</b> <b>pgsql:/etc/postfix/filename</b>

       <b>postmap</b> <b>-q</b> <b>-</b> <b>pgsql:/etc/postfix/</b><u>filename</u> &lt;<u>inputfile</u>

<b>DESCRIPTION</b>
       The  Postfix mail system uses optional tables for address rewriting or mail routing. These tables are
       usually in <b>dbm</b> or <b>db</b> format.

       Alternatively, lookup tables can be specified as PostgreSQL databases.  In order  to  use  PostgreSQL
       lookups, define a PostgreSQL source as a lookup table in main.cf, for example:
           alias_maps = pgsql:/etc/pgsql-aliases.cf

       The file /etc/postfix/pgsql-aliases.cf has the same format as the Postfix main.cf file, and can spec-
       ify the parameters described below.

<b>BACKWARDS</b> <b>COMPATIBILITY</b>
       For compatibility with other Postfix lookup tables, PostgreSQL parameters  can  also  be  defined  in
       main.cf.  In order to do that, specify as PostgreSQL source a name that doesn't begin with a slash or
       a dot.  The PostgreSQL parameters will then be accessible as the name you've given the source in  its
       definition,  an  underscore,  and the name of the parameter.  For example, if the map is specified as
       "pgsql:<u>pgsqlname</u>", the parameter "hosts" below would be defined in main.cf as "<u>pgsqlname</u>_hosts".

       Note: with this form, the passwords for the PostgreSQL sources are written in main.cf, which is  nor-<font color="#ffffff" class="whiteout">mally&nbsp;normally</font>
       mally world-readable.  Support for this form will be removed in a future Postfix version.

       Postfix 2.2 has enhanced query interfaces for MySQL and PostgreSQL, these include features previously
       available only in the Postfix LDAP client. In the new interface the SQL query is specified via a sin-<font color="#ffffff" class="whiteout">gle&nbsp;single</font>
       gle  <b>query</b>  parameter (described in more detail below).  In Postfix 2.1 the parameter precedence was,
       from highest to lowest, <b>select_function</b>, <b>query</b> and finally <b>select_field</b>, ...

       With Postfix 2.2 the <b>query</b> parameter has highest precedence, and is used in preference to  the  still
       supported,  but  slated to be phased out, <b>select_function</b>, <b>select_field</b>, <b>table</b>, <b>where_field</b> and <b>addi</b>-<font color="#ffffff" class="whiteout">tional_conditions&nbsp;additional_conditions</font>
       <b>tional_conditions</b> parameters. To migrate to the new interface set:

           <b>query</b> = SELECT <u>select</u><b>_</b><u>function</u>('%s')

       or in the absence of <b>selection_function</b>, the lower precedence:

           <b>query</b> = SELECT <u>select</u><b>_</b><u>field</u>
               FROM <u>table</u>
               WHERE <u>where</u><b>_</b><u>field</u> = '%s'
                   <u>additional</u><b>_</b><u>conditions</u>

       Use the value, not the name, of each legacy parameter. Note that the <b>additional_conditions</b>  parameter
       is optional and if not empty, will always start with <b>AND</b>.

<b>LIST</b> <b>MEMBERSHIP</b>
       When  using  SQL  to  store lists such as $mynetworks, $mydestination, $relay_domains, $local_recipi-<font color="#ffffff" class="whiteout">ent_maps,&nbsp;$local_recipient_maps,</font>
       ent_maps, etc., it is important to understand that the table must store each list member as  a  sepa-<font color="#ffffff" class="whiteout">rate&nbsp;separate</font>
       rate  key. The table lookup verifies the *existence* of the key. See "Postfix lists versus tables" in
       the DATABASE_README document for a discussion.

       Do NOT create tables that return the full list of domains in $mydestination or  $relay_domains  etc.,
       or IP addresses in $mynetworks.

       DO  create tables with each matching item as a key and with an arbitrary value. With SQL databases it
       is not uncommon to return the key itself or a constant value.

<b>PGSQL</b> <b>PARAMETERS</b>
       <b>hosts</b>  The hosts that Postfix will try to connect to and query from.  Specify <u>unix:</u>  for  UNIX-domain
              sockets, <u>inet:</u> for TCP connections (default).  Example:
                  hosts = host1.some.domain host2.some.domain
                  hosts = unix:/file/name

              The hosts are tried in random order, with all connections over UNIX domain sockets being tried
              before those over TCP.  The connections are automatically closed after being idle for about  1
              minute, and are re-opened as necessary.

              NOTE:  the  <u>unix:</u> and <u>inet:</u> prefixes are accepted for backwards compatibility reasons, but are
              actually ignored.  The PostgreSQL client library will always try to connect to an UNIX  socket
              if the name starts with a slash, and will try a TCP connection otherwise.

       <b>user,</b> <b>password</b>
              The user name and password to log into the pgsql server.  Example:
                  user = someone
                  password = some_password

       <b>dbname</b> The database name on the servers. Example:
                  dbname = customer_database

       <b>query</b>  The  SQL  query template used to search the database, where <b>%s</b> is a substitute for the address
              Postfix is trying to resolve, e.g.
                  query = SELECT replacement FROM aliases WHERE mailbox = '%s'

              This parameter supports the following '%' expansions:

              <b>%%</b>     This is replaced by a literal '%' character. (Postfix 2.2 and later)

              <b>%s</b>     This is replaced by the input key.  SQL quoting is used to make sure that the input key
                     does not add unexpected metacharacters.

              <b>%u</b>     When  the  input  key  is an address of the form user@domain, <b>%u</b> is replaced by the SQL
                     quoted local part of the address.  Otherwise, <b>%u</b>  is  replaced  by  the  entire  search
                     string.  If the localpart is empty, the query is suppressed and returns no results.

              <b>%d</b>     When  the  input  key  is an address of the form user@domain, <b>%d</b> is replaced by the SQL
                     quoted domain part of the address.  Otherwise, the query is suppressed and  returns  no
                     results.

              <b>%[SUD]</b> The  upper-case equivalents of the above expansions behave in the <b>query</b> parameter iden-<font color="#ffffff" class="whiteout">tically&nbsp;identically</font>
                     tically to their lower-case  counter-parts.   With  the  <b>result_format</b>  parameter  (see
                     below), they expand the input key rather than the result value.

                     The above %S, %U and %D expansions are available with Postfix 2.2 and later

              <b>%[1-9]</b> The  patterns  %1, %2, ... %9 are replaced by the corresponding most significant compo-<font color="#ffffff" class="whiteout">nent&nbsp;component</font>
                     nent of the input key's domain. If the input key is <u>user@mail.example.com</u>, then  %1  is
                     <b>com</b>,  %2  is  <b>example</b>  and %3 is <b>mail</b>. If the input key is unqualified or does not have
                     enough domain components to satisfy all the specified patterns, the query is suppressed
                     and returns no results.

                     The above %1, ... %9 expansions are available with Postfix 2.2 and later

              The  <b>domain</b>  parameter described below limits the input keys to addresses in matching domains.
              When the <b>domain</b> parameter is non-empty, SQL queries for unqualified addresses or addresses  in
              non-matching domains are suppressed and return no results.

              The  precedence  of  this parameter has changed with Postfix 2.2, in prior releases the prece-<font color="#ffffff" class="whiteout">dence&nbsp;precedence</font>
              dence was, from highest to lowest, <b>select_function</b>, <b>query</b>, <b>select_field</b>, ...

              With Postfix 2.2 the <b>query</b> parameter has highest precedence, see COMPATIBILITY above.

              NOTE: DO NOT put quotes around the <b>query</b> parameter.

       <b>result_format</b> <b>(default:</b> <b>%s</b>)
              Format template applied to result attributes. Most commonly used to append (or  prepend)  text
              to the result. This parameter supports the following '%' expansions:

              <b>%%</b>     This is replaced by a literal '%' character.

              <b>%s</b>     This  is  replaced  by  the  value  of the result attribute. When result is empty it is
                     skipped.

              <b>%u</b>     When the result attribute value is an address of the form user@domain, <b>%u</b>  is  replaced
                     by the local part of the address. When the result has an empty localpart it is skipped.

              <b>%d</b>     When a result attribute value is an address of the form user@domain, <b>%d</b> is replaced  by
                     the domain part of the attribute value. When the result is unqualified it is skipped.

              <b>%[SUD1-9]</b>
                     The  upper-case  and  decimal  digit  expansions interpolate the parts of the input key
                     rather than the result. Their behavior is identical to that described with  <b>query</b>,  and
                     in  fact  because the input key is known in advance, queries whose key does not contain
                     all the information specified in the result  template  are  suppressed  and  return  no
                     results.

              For  example,  using "result_format = smtp:[%s]" allows one to use a mailHost attribute as the
              basis of a <a href="transport.5.html#//apple_ref/doc/man/5/transport">transport(5)</a> table. After applying the result format, multiple values are  concate-<font color="#ffffff" class="whiteout">nated&nbsp;concatenated</font>
              nated as comma separated strings. The expansion_limit and parameter explained below allows one
              to restrict the number of values in the result, which is especially useful for maps that  must
              return at most one value.

              The default value <b>%s</b> specifies that each result value should be used as is.

              This parameter is available with Postfix 2.2 and later.

              NOTE: DO NOT put quotes around the result format!

       <b>domain</b> <b>(default:</b> <b>no</b> <b>domain</b> <b>list)</b>
              This  is  a  list of domain names, paths to files, or dictionaries. When specified, only fully
              qualified search keys with a *non-empty* localpart and a  matching  domain  are  eligible  for
              lookup:  'user' lookups, bare domain lookups and "@domain" lookups are not performed. This can
              significantly reduce the query load on the PostgreSQL server.
                  domain = postfix.org, hash:/etc/postfix/searchdomains

              It is best not to use SQL to store the domains eligible for SQL lookups.

              This parameter is available with Postfix 2.2 and later.

              NOTE: DO NOT define this parameter for <a href="../man8/local.8.html#//apple_ref/doc/man/8/local">local(8)</a> aliases, because the  input  keys  are  always
              unqualified.

       <b>expansion_limit</b> <b>(default:</b> <b>0)</b>
              A  limit  on  the  total  number  of result elements returned (as a comma separated list) by a
              lookup against the map.  A setting of zero disables the limit. Lookups fail with  a  temporary
              error  if  the  limit  is exceeded.  Setting the limit to 1 ensures that lookups do not return
              multiple values.

       Pre-Postfix 2.2 legacy interfaces:

       <b>select_function</b>
              This parameter specifies a database function name. Example:
                  select_function = my_lookup_user_alias

              This is equivalent to:
                  query = SELECT my_lookup_user_alias('%s')

              This parameter overrides the legacy table-related fields (described below). With Postfix  ver-<font color="#ffffff" class="whiteout">sions&nbsp;versions</font>
              sions  prior  to  2.2,  it  also overrides the <b>query</b> parameter. Starting with Postfix 2.2, the
              <b>query</b> parameter has highest precedence, and this parameter is deprecated.  Please  migrate  to
              the new <b>query</b> interface as this interface is slated to be phased out.

       The  following  parameters (with lower precedence than the <b>select_function</b> interface described above)
       can be used to build the SQL select statement as follows:

           SELECT [<b>select_field</b>]
           FROM [<b>table</b>]
           WHERE [<b>where_field</b>] = '%s'
                 [<b>additional_conditions</b>]

       The specifier %s is replaced with each lookup by the lookup key and is escaped so if it contains sin-<font color="#ffffff" class="whiteout">gle&nbsp;single</font>
       gle quotes or other odd characters, it will not cause a parse error, or worse, a security problem.

       Starting  with Postfix 2.2, this interface is obsoleted by the more general <b>query</b> interface described
       above. If higher precedence the <b>query</b> or <b>select_function</b>  parameters  described  above  are  defined,
       these  parameters  are ignored. Please migrate to the new <b>query</b> interface as this interface is slated
       to be phased out.

       <b>select_field</b>
              The SQL "select" parameter. Example:
                  <b>select_field</b> = forw_addr

       <b>table</b>  The SQL "select .. from" table name. Example:
                  <b>table</b> = mxaliases

       <b>where_field</b>
              The SQL "select .. where" parameter. Example:
                  <b>where_field</b> = alias

       <b>additional_conditions</b>
              Additional conditions to the SQL query. Example:
                  <b>additional_conditions</b> = AND status = 'paid'

<b>SEE</b> <b>ALSO</b>
       <a href="../man1/postmap.1.html#//apple_ref/doc/man/1/postmap">postmap(1)</a>, Postfix lookup table manager
       <a href="postconf.5.html#//apple_ref/doc/man/5/postconf">postconf(5)</a>, configuration parameters
       <a href="ldap_table.5.html#//apple_ref/doc/man/5/ldap_table">ldap_table(5)</a>, LDAP lookup tables
       <a href="mysql_table.5.html#//apple_ref/doc/man/5/mysql_table">mysql_table(5)</a>, MySQL lookup tables

<b>README</b> <b>FILES</b>
       Use "<b>postconf</b> <b>readme_directory</b>" or "<b>postconf</b> <b>html_directory</b>" to locate this information.
       DATABASE_README, Postfix lookup table overview
       PGSQL_README, Postfix PostgreSQL client guide

<b>LICENSE</b>
       The Secure Mailer license must be distributed with this software.

<b>HISTORY</b>
       PgSQL support was introduced with Postfix version 2.1.

<b>AUTHOR(S)</b>
       Based on the MySQL client by:
       Scott Cotton, Joshua Marcus
       IC Group, Inc.

       Ported to PostgreSQL by:
       Aaron Sethman

       Further enhanced by:
       Liviu Daia
       Institute of Mathematics of the Romanian Academy
       P.O. BOX 1-764
       RO-014700 Bucharest, ROMANIA



                                                                                              PGSQL_TABLE(5)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man5/pgsql_table.5.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man5/pgsql_table.5.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man5/pgsql_table.5.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
