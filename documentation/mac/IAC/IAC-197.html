<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Adding Parameters to an Apple Event(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING197></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-196.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-198.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-195.html"><B>Chapter 5 - Creating and Sending Apple Events</B></A> / <A HREF="IAC-196.html"><B>Creating an Apple Event</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING197-0></A>
<H2><A NAME=MARKER-9-31></A><A NAME=MARKER-21-32></A>Adding Parameters to an Apple Event</H2>
 <A NAME=MARKER-2-115></A>You can use the <CODE>AEPutParamPtr</CODE> or <CODE>AEPutParamDesc</CODE> function to add parameters to an Apple event. When you use either of these functions, the Apple Event Manager adds the specified parameter to the Apple event. <P>
 Use the <CODE>AEPutParamPtr</CODE> function when you want to add data specified in a buffer as the parameter of an Apple event. You specify the Apple event, the keyword of the parameter to add, the descriptor type, a buffer that contains the data, and the size of this buffer as parameters to the <CODE>AEPutParamPtr</CODE> function. The <CODE>AEPutParamPtr</CODE> function adds the data to the Apple event as a parameter with the specified keyword.<P>
 For example, this code adds a parameter to the Multiply event using the <CODE>AEPutParamPtr</CODE> function:<P>
<PRE>
CONST keyOperand1 = 'OPN1';
VAR
   number1:          LongInt;
   theAppleEvent:    AppleEvent;
   myErr:            OSErr;

number1 := 10;
myErr := AEPutParamPtr(theAppleEvent, keyOperand1, 
                       typeLongInteger, @number1,
                       SizeOf(number1));
</PRE>
 In this example, the Apple Event Manager adds the parameter containing the first number to the specified Apple event. <P>
 Use the <CODE>AEPutParamDesc</CODE> function to add a descriptor record to an Apple event. The descriptor record you specify must already exist. To create or get a descriptor record, you can use the <CODE>AECreateDesc</CODE>, <CODE>AEDuplicateDesc</CODE>, and other Apple Event Manager functions that return a descriptor record.<P>
 When you create a descriptor record using the <CODE>AECreateDesc</CODE> function, you specify the descriptor type, a buffer that contains the data, and the size of this buffer as parameters. The <CODE>AECreateDesc</CODE> function returns the descriptor record that describes the data.<P>
 This example creates a descriptor record for the second parameter of the Multiply event:<P>
<PRE>
VAR
   number2:          LongInt;
   multParam2Desc:   AEDesc;
   myErr:            OSErr;

number2 := 8;
myErr := AECreateDesc(typeLongInteger, @number2, SizeOf(number2),
                      multParam2Desc); 
</PRE>
 In this example, the <CODE>AECreateDesc</CODE> function creates a descriptor record with the <CODE>typeLongInteger</CODE> descriptor type and the data identified in the <CODE>number2</CODE> variable.<P>
 Once you have created a descriptor record, you can use <CODE>AEPutParamDesc</CODE> to add the data to an Apple event parameter. You specify the Apple event to add the parameter to, the keyword of the parameter, and the descriptor record of the parameter as parameters to the <CODE>AEPutParamDesc</CODE> function.<P>
 This example adds a second parameter to the Multiply event using the <CODE>AEPutParamDesc</CODE> function:<P>
<PRE>
CONST keyOperand2 = 'OPN2';

myErr := AEPutParamDesc(theAppleEvent, keyOperand2, 
                        multParam2Desc);
</PRE>
 This example adds the <CODE>keyOperand2</CODE> keyword and the descriptor record created in the previous example as the second parameter to the specified Apple event. <P>
 You can also create a descriptor record without using Apple Event Manager routines. For example, this example generates an alias descriptor record from an existing alias handle:<P>
<PRE>
WITH myAliasDesc DO
   BEGIN
      descriptorType := typeAlias;
      dataHandle := myAliasHandle;
   END;
</PRE>
 Whatever method you use to create a descriptor record, you can add it to an Apple event parameter by using <CODE>AEPutParamDesc</CODE>.<P>
 After adding parameters to an Apple event, you can send the Apple event using the <CODE>AESend</CODE> function. See <A HREF=IAC-200.html#MARKER-9-87>"Sending an Apple Event,"</A> which begins on <A HREF=IAC-200.html#MARKER-9-87>page 5-13</A>, for information about using this function.<A NAME=MARKER-2-34></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-196.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-198.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
