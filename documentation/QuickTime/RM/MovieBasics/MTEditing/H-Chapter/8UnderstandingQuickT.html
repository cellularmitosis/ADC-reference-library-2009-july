<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>QuickTime Movie Basics: Understanding QuickTime Atoms</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Understanding QuickTime Atoms"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms" title="Understanding QuickTime Atoms"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000433" target="_top">QuickTime</a> &gt; <a href="../../../../MovieBasics-date.html#//apple_ref/doc/uid/TP30000440-TP30000433-TP30000545" target="_top">Movie Basics</a> &gt; <a href="../A-Intro/1Introduction.html#//apple_ref/doc/uid/TP40000908-IntroductiontoQuickTimeMovieBasics-DontLinkElementID_83">QuickTime Movie Basics</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../G-Chapter/7WorkingWithMediaSam.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../I-Chapter/9TimecodeMediaHandle.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-SW1" title="Understanding QuickTime Atoms"></a>
<h1>Understanding QuickTime Atoms</h1>

<p>This chapter discusses QuickTime atoms, a basic structure for storing information in QuickTime. It also describes the functions used to create, dispose of, read from, and store to QuickTime atom containers. The QT atom is an enhancement of the existing atom data structure. Most QuickTime data structures (movies, tracks, media) are built of atoms. Newer QuickTime data structures (timecode tracks, sprites) are implemented using QT atoms.</p>



<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="8UnderstandingQuickT.html#//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_41">Atom Structures and IDs</a>
				
			<br/>
			
        
			
			
				<a href="8UnderstandingQuickT.html#//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_42">Creating and Disposing of Atom Containers</a>
				
			<br/>
			
        
			
			
				<a href="8UnderstandingQuickT.html#//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_43">Creating New Atoms</a>
				
			<br/>
			
        
			
			
				<a href="8UnderstandingQuickT.html#//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_44">Copying Existing Atoms</a>
				
			<br/>
			
        
			
			
				<a href="8UnderstandingQuickT.html#//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_45">Retrieving Atoms From an Atom Container</a>
				
			<br/>
			
        
			
			
				<a href="8UnderstandingQuickT.html#//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_46">Modifying Atoms</a>
				
			<br/>
			
        
			
			
				<a href="8UnderstandingQuickT.html#//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_47">Removing Atoms From an Atom Container</a>
				
			<br/>
			
        
			
			
				<a href="8UnderstandingQuickT.html#//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_48">Creating and Modifying QT Atom Containers</a>
				
			<br/>
			
        
			
			
				<a href="8UnderstandingQuickT.html#//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_49">Retrieving Atoms and Atom Data</a>
				
			<br/>
			
        
			
			
				<a href="8UnderstandingQuickT.html#//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_50">Constants for QT Atom Functions</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_41" title="Atom Structures and IDs"></a>
<h2><a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-AtomStructuresandIDs" title="Atom Structures and IDs"></a>Atom Structures and IDs</h2>
<p>A QT <strong>atom</strong> <strong>container</strong> <strong></strong> is a basic memory structure for storing information in QuickTime. You can use a QT atom container to construct arbitrarily complex hierarchical data structures. You can think of a newly-created QT atom container as the root of a tree structure that contains no children. A QT atom container contains <strong>QT</strong> <strong>atoms</strong> (Figure&#160;7-1). Each QT atom contains either data or other atoms. If a QT atom contains other atoms, it is a <strong>parent</strong> <strong>atom</strong> and the atoms it contains are its <strong>child</strong> <strong>atoms.</strong> If a QT atom contains data, it is called a <strong>leaf</strong> <strong>atom.</strong></p>
<br/><div><a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_90" title="Figure 7-1QT atom container with parent and child atoms"></a><p><strong>Figure 7-1&nbsp;&nbsp;</strong>QT atom container with parent and child atoms</p><img src = "../Art/QTML-05.gif" alt = "" width="353" height="268"></div><br/>
<p>Each QT atom has an offset that describes the atom&#8217;s position within the QT atom container. In addition, each QT atom has a type and an ID. The atom type describes the kind of information the atom represents. The atom ID is used to differentiate child atoms of the same type with the same parent; an atom&#8217;s ID must be unique for a given parent and type. In addition to the atom ID, each atom has a 1-based index that describes its order relative to other child atoms of the same parent. You can uniquely identify a QT atom in three ways:</p>
<ul class="ul">
<li class="li"><p>by its offset within its QT atom container</p></li>
<li class="li"><p>by its parent atom, type, and index</p></li>
<li class="li"><p>by its parent atom, type, and ID</p></li>
</ul>
<p>You can store and retrieve atoms in a QT atom container by index, ID, or both. For example, to use a QT atom container as a dynamic array or tree structure, you can store and retrieve atoms by index. To use a QT atom container as a database, you can store and retrieve atoms by ID. You can also create, store, and retrieve atoms using both ID and index to create an arbitrarily complex, extensible data structure.</p>
<div class="warningbox"><img src="../../../../../Resources/Images/icon_warning.gif" alt="!" width="20" height="20" border="0" class="warningicon" /><a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_91" title="Warning:"></a><p><strong>Warning:</strong>&nbsp;
Since QT atoms are offsets into a data structure, they can be changed during editing operations on QT atom containers, such as inserting or deleting atoms. For a given atom, editing child atoms is safe, but editing sibling or parent atoms invalidates that atom&#8217;s offset.  </p><p>
</p><div class="clear"></div></div>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_92" title="Note"></a>
<p><strong>Note:</strong>&nbsp;
For cross-platform purposes, all data in a QT atom is expected to be in big-endian format.  </p>
</div>
<p>Figure&#160;7-2 shows a QT atom container that has two child atoms. The first child atom (offset = 10) is a leaf atom that has an atom type of <code>'abcd'</code>, an ID of 1000, and an index of 1. The second child atom (offset = 20) has an atom type of <code>'abcd'</code>, an ID of 900, and an index of 2. Because the two child atoms have the same type, they must have different IDs. The second child atom is also a parent atom of three atoms.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_93" title="Figure 7-2QT atom container example"></a><p><strong>Figure 7-2&nbsp;&nbsp;</strong>QT atom container example</p><img src = "../Art/QTML-06.gif" alt = "" width="430" height="240"></div><br/>
<p>The first child atom (offset = 30) has an atom type of <code>'abcd'</code>, an ID of 100, and an index of 1. It does not have any children, nor does it have data. The second child atom (offset = 40) has an atom type of <code>'word'</code>, an ID of 100, and an index of 1. The atom has data, so it is a leaf atom. The second atom (offset = 40) has the same ID as the first atom (offset = 30), but a different atom type. The third child atom (offset = 50) has an atom type of <code>'abcd'</code>, an ID of 1000, and an index of 2. Its atom type and ID are the same as that of another atom (offset = 20) with a different parent.</p>
<p>As a developer, you do not need to parse QT atoms yourself. Instead, you can use the QT atom functions to create atom containers, add atoms to and remove atoms from atom containers, search for atoms in atom containers, and retrieve data from atoms in atom containers.</p>
<p>Most QT atom functions take two parameters to specify a particular atom: the atom container that contains the atom and the offset of the atom in the atom container data structure. You obtain an atom&#8217;s offset by calling either <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTFindChildByID" target="_top">QTFindChildByID</a></code> or <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTFindChildByIndex" target="_top">QTFindChildByIndex</a></code>. An atom&#8217;s offset may be invalidated if the QT atom container that contains it is modified.</p>
<p>When calling any QT atom function for which you specify a parent atom as a parameter, you can pass the constant <code>kParentAtomIsContainer</code> as an atom offset to indicate that the specified parent atom is the atom container itself. For example, you would call the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTFindChildByIndex" target="_top">QTFindChildByIndex</a></code> function and pass <code>kParentAtomIsContainer</code> constant for the parent atom parameter to indicate that the requested child atom is a child of the atom container itself.</p>

<a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_42" title="Creating and Disposing of Atom Containers"></a>
<h2><a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-CreatingandDisposingofAtomContainers" title="Creating and Disposing of Atom Containers"></a>Creating and Disposing of Atom Containers</h2>
<p>Before you can add atoms to an atom container, you must first create the container by calling <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTNewAtomContainer" target="_top">QTNewAtomContainer</a></code>. The code sample shown in Listing 7-1 calls <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTNewAtomContainer" target="_top">QTNewAtomContainer</a></code> to create an atom container.</p>
<a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_94" title="Listing 7-1Creating a new atom container"></a>
<p class="codesample"><strong>Listing 7-1&nbsp;&nbsp;</strong>Creating a new atom container</p>
<div class="codesample"><table><tr><td scope="row"><pre>QTAtomContainer spriteData;<span></span></pre></td></tr><tr><td scope="row"><pre>OSErr err<span></span></pre></td></tr><tr><td scope="row"><pre>// create an atom container to hold a sprite's data<span></span></pre></td></tr><tr><td scope="row"><pre>err=QTNewAtomContainer (&#38;spriteData);<span></span></pre></td></tr></table></div>

<p>When you have finished using an atom container, you should dispose of it by calling the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTDisposeAtomContainer" target="_top">QTDisposeAtomContainer</a></code> function. The sample code shown in Listing 7-2 calls <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTDisposeAtomContainer" target="_top">QTDisposeAtomContainer</a></code> to dispose of the <code>spriteData</code> atom container.</p>
<a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_95" title="Listing 7-2Disposing of an atom container"></a>
<p class="codesample"><strong>Listing 7-2&nbsp;&nbsp;</strong>Disposing of an atom container</p>
<div class="codesample"><table><tr><td scope="row"><pre>if (spriteData)<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;QTDisposeAtomContainer (spriteData);<span></span></pre></td></tr></table></div>


<a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_43" title="Creating New Atoms"></a>
<h2><a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-CreatingNewAtoms" title="Creating New Atoms"></a>Creating New Atoms</h2>
<p>You can use the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTInsertChild" target="_top">QTInsertChild</a></code> function to create new atoms and insert them in a QT atom container. The <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTInsertChild" target="_top">QTInsertChild</a></code> function creates a new child atom for a parent atom. The caller specifies an atom type and atom ID for the new atom. If you specify a value of 0 for the atom ID, <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTInsertChild" target="_top">QTInsertChild</a></code> assigns a unique ID to the atom.</p>
<p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTInsertChild" target="_top">QTInsertChild</a></code> inserts the atom in the parent&#8217;s child list at the index specified by the <code>index</code> parameter; any existing atoms at the same index or greater are moved toward the end of the child list. If you specify a value of 0 for the <code>index</code> parameter, <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTInsertChild" target="_top">QTInsertChild</a></code> inserts the atom at the end of the child list.</p>
<p>The code sample in Listing 7-3 creates a new QT atom container and calls <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTInsertChild" target="_top">QTInsertChild</a></code> to add an atom. The resulting QT atom container is shown in Figure&#160;7-3. The offset value 10 is returned in the <code>firstAtom</code> parameter.</p>
<a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_96" title="Listing 7-3Creating a new QT atom container and calling QTInsertChild to add an atom"></a>
<p class="codesample"><strong>Listing 7-3&nbsp;&nbsp;</strong>Creating a new QT atom container and calling QTInsertChild to add an atom</p>
<div class="codesample"><table><tr><td scope="row"><pre>QTAtom firstAtom;<span></span></pre></td></tr><tr><td scope="row"><pre>QTAtomContainer container;<span></span></pre></td></tr><tr><td scope="row"><pre>OSErr err<span></span></pre></td></tr><tr><td scope="row"><pre>err = QTNewAtomContainer (&#38;container);<span></span></pre></td></tr><tr><td scope="row"><pre>if (!err)<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;err = QTInsertChild (container, kParentAtomIsContainer, 'abcd',<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;1000, 1, 0, nil, &#38;firstAtom);<span></span></pre></td></tr></table></div>

<br/><div><a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_97" title="Figure 7-3QT atom container after inserting an atom"></a><p><strong>Figure 7-3&nbsp;&nbsp;</strong>QT atom container after inserting an atom</p><img src = "../Art/QTML-07.gif" alt = "" width="98" height="161"></div><br/>
<p>The following code sample calls <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTInsertChild" target="_top">QTInsertChild</a></code> to create a second child atom. Because a value of 1 is specified for the <code>index</code> parameter, the second atom is inserted in front of the first atom in the child list; the index of the first atom is changed to 2. The resulting QT atom container is shown in  Figure&#160;7-4.</p>

<div class="codesample"><table><tr><td scope="row"><pre>QTAtom secondAtom;<span></span></pre></td></tr><tr><td scope="row"><pre>FailOSErr (QTInsertChild (container, kParentAtomIsContainer, 'abcd',<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;2000, 1, 0, nil, &#38;secondAtom));<span></span></pre></td></tr></table></div>

<br/><div><a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_98" title="Figure 7-4QT atom container after inserting a second atom"></a><p><strong>Figure 7-4&nbsp;&nbsp;</strong>QT atom container after inserting a second atom</p><img src = "../Art/QTML-08.gif" alt = "" width="240" height="140"></div><br/>
<p>You can call the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTFindChildByID" target="_top">QTFindChildByID</a></code> function to retrieve the changed offset of the first atom that was inserted, as shown in the following example. In this example, the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTFindChildByID" target="_top">QTFindChildByID</a></code> function returns an offset of 20.</p>

<div class="codesample"><table><tr><td scope="row"><pre>firstAtom = QTFindChildByID (container, kParentAtomIsContainer, 'abcd',<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;1000, nil);<span></span></pre></td></tr></table></div>

<p>Listing 7-4 shows how the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTInsertChild" target="_top">QTInsertChild</a></code> function inserts a leaf atom into the atom container <code>sprite</code>. The new leaf atom contains a sprite image index as its data.</p>
<a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_99" title="Listing 7-4Inserting a child atom"></a>
<p class="codesample"><strong>Listing 7-4&nbsp;&nbsp;</strong>Inserting a child atom</p>
<div class="codesample"><table><tr><td scope="row"><pre>if ((propertyAtom = QTFindChildByIndex (sprite, kParentAtomIsContainer,<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;kSpritePropertyImageIndex, 1, nil)) == 0)<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;FailOSErr (QTInsertChild (sprite, kParentAtomIsContainer,<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;kSpritePropertyImageIndex, 1, 1, sizeof(short),&#38;imageIndex,<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;nil));<span></span></pre></td></tr></table></div>


<a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_44" title="Copying Existing Atoms"></a>
<h2><a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-CopyingExistingAtoms" title="Copying Existing Atoms"></a>Copying Existing Atoms</h2>
<p>QuickTime provides several functions for copying existing atoms within an atom container. The <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTInsertChildren" target="_top">QTInsertChildren</a></code> function inserts a container of atoms as children of a parent atom in another atom container. Figure&#160;7-5 shows two example QT atom containers, A and B.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_100" title="Figure 7-5Two QT atom containers, A and B"></a><p><strong>Figure 7-5&nbsp;&nbsp;</strong>Two QT atom containers, A and B</p><img src = "../Art/QTML-09.gif" alt = "" width="334" height="184"></div><br/>
<p>The following code sample calls <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTFindChildByID" target="_top">QTFindChildByID</a></code> to retrieve the offset of the atom in container A. Then, the code sample calls the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTInsertChildren" target="_top">QTInsertChildren</a></code> function to insert the atoms in container B as children of the atom in container A. Figure&#160;7-6 shows what container A looks like after the atoms from container B have been inserted.</p>

<div class="codesample"><table><tr><td scope="row"><pre>QTAtom targetAtom;<span></span></pre></td></tr><tr><td scope="row"><pre>targetAtom = QTFindChildByID (containerA, kParentAtomIsContainer, 'abcd',<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;1000, nil);<span></span></pre></td></tr><tr><td scope="row"><pre>FailOSErr (QTInsertChildren (containerA, targetAtom, containerB));<span></span></pre></td></tr></table></div>

<br/><div><a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_101" title="Figure 7-6QT atom container after child atoms have been inserted"></a><p><strong>Figure 7-6&nbsp;&nbsp;</strong>QT atom container after child atoms have been inserted</p><img src = "../Art/QTML-10.gif" alt = "" width="198" height="254"></div><br/>
<p>In Listing 7-5, the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTInsertChild" target="_top">QTInsertChild</a></code> function inserts a parent atom into the atom container <code>theSample</code>. Then, the code calls <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTInsertChildren" target="_top">QTInsertChildren</a></code> to insert the container <code>theSprite</code> into the container <code>theSample</code>. The parent atom is <code>newSpriteAtomMovie</code> Data Types.</p>
<a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_102" title="Listing 7-5Inserting a container into another container"></a>
<p class="codesample"><strong>Listing 7-5&nbsp;&nbsp;</strong>Inserting a container into another container</p>
<div class="codesample"><table><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>FailOSErr (QTInsertChild (theSample, kParentAtomIsContainer,<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;kSpriteAtomType, spriteID, 0, 0, nil, &#38;newSpriteAtom));<span></span></pre></td></tr><tr><td scope="row"><pre>FailOSErr (QTInsertChildren (theSample, newSpriteAtom, theSprite));<span></span></pre></td></tr></table></div>

<p>QuickTime provides three other functions you can use to manipulate atoms in an atom container. The <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTReplaceAtom" target="_top">QTReplaceAtom</a></code> function replaces an atom and its children with a different atom and its children. You can call the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTSwapAtoms" target="_top">QTSwapAtoms</a></code> function to swap the contents of two atoms in an atom container; after swapping, the ID and index of each atom remains the same. The <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTCopyAtom" target="_top">QTCopyAtom</a></code> function copies an atom and its children to a new atom container.</p>

<a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_45" title="Retrieving Atoms From an Atom Container"></a>
<h2><a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-RetrievingAtomsFromanAtomContainer" title="Retrieving Atoms From an Atom Container"></a>Retrieving Atoms From an Atom Container</h2>
<p>QuickTime provides functions you can use to retrieve information about the types of a parent atom&#8217;s children, to search for a specific atom, and to retrieve a leaf atom&#8217;s data.</p>
<p>You can use the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTCountChildrenOfType" target="_top">QTCountChildrenOfType</a></code> and <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTGetNextChildType" target="_top">QTGetNextChildType</a></code> functions to retrieve information about the types of an atom&#8217;s children. The <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTCountChildrenOfType" target="_top">QTCountChildrenOfType</a></code> function returns the number of children of a given atom type for a parent atom. The <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTGetNextChildType" target="_top">QTGetNextChildType</a></code> function returns the next atom type in the child list of a parent atom.</p>
<p>You can use the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTFindChildByIndex" target="_top">QTFindChildByIndex</a></code>, <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTFindChildByID" target="_top">QTFindChildByID</a></code>, and <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTNextChildAnyType" target="_top">QTNextChildAnyType</a></code> functions to retrieve an atom. You call the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTFindChildByIndex" target="_top">QTFindChildByIndex</a></code> function to search for and retrieve a parent atom&#8217;s child by its type and index within that type.</p>
<p>Listing 7-6 shows the sample code function <code>SetSpriteData</code>, which updates an atom container that describes a sprite. For each property of the sprite that needs to be updated, <code>SetSpriteData</code> calls <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTFindChildByIndex" target="_top">QTFindChildByIndex</a></code> to retrieve the appropriate atom from the atom container. If the atom is found, <code>SetSpriteData</code> calls <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTSetAtomData" target="_top">QTSetAtomData</a></code> to replace the atom&#8217;s data with the new value of the property. If the atom is not found, <code>SetSpriteData</code> calls <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTInsertChild" target="_top">QTInsertChild</a></code> to add a new atom for the property.</p>
<a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_103" title="Listing 7-6Finding a child atom by index"></a>
<p class="codesample"><strong>Listing 7-6&nbsp;&nbsp;</strong>Finding a child atom by index</p>
<div class="codesample"><table><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>OSErr SetSpriteData (QTAtomContainer sprite, Point *location,<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;short *visible, short *layer, short *imageIndex)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;OSErr err = noErr;<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;QTAtom propertyAtom;<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;// if the sprite's visible property has a new value<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;if (visible)<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;{<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// retrieve the atom for the visible property --<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// if none exists, insert one<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if ((propertyAtom = QTFindChildByIndex (sprite,<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;kParentAtomIsContainer, kSpritePropertyVisible, 1,<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;nil)) == 0)<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;FailOSErr (QTInsertChild (sprite, kParentAtomIsContainer,<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;kSpritePropertyVisible, 1, 1, sizeof(short), visible,<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;nil))<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// if an atom does exist, update its data<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;FailOSErr (QTSetAtomData (sprite, propertyAtom,<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sizeof(short), visible));<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;}<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;// ...<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;// handle other sprite properties<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;// ...<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div>

<p>You can call the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTFindChildByID" target="_top">QTFindChildByID</a></code> function to search for and retrieve a parent atom&#8217;s child by its type and ID. The sample code function <code>AddSpriteToSample</code>, shown in  Listing 7-7, adds a sprite, represented by an atom container, to a key sample, represented by another atom container. <code>AddSpriteToSample</code> calls <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTFindChildByID" target="_top">QTFindChildByID</a></code> to determine whether the atom container <code>theSample</code> contains an atom of type <code>kSpriteAtomType</code> with the ID <code>spriteIDMovie</code> Data Types. If not, <code>AddSpriteToSample</code> calls <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTInsertChild" target="_top">QTInsertChild</a></code> to insert an atom with that type and ID. A value of 0 is passed for the <code>index</code> parameter to indicate that the atom should be inserted at the end of the child list. A value of 0 is passed for the <code>dataSize</code> parameter to indicate that the atom does not have any data. Then, <code>AddSpriteToSample</code> calls <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTInsertChildren" target="_top">QTInsertChildren</a></code> to insert the atoms in the container <code>theSprite</code> as children of the new atom. <code>FailIf</code> and <code>FailOSErr</code> are macros that exit the current function when an error occurs.</p>
<a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_104" title="Listing 7-7Finding a child atom by ID"></a>
<p class="codesample"><strong>Listing 7-7&nbsp;&nbsp;</strong>Finding a child atom by ID</p>
<div class="codesample"><table><tr><td scope="row"><pre>OSErr AddSpriteToSample (QTAtomContainer theSample,<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;QTAtomContainer theSprite, short spriteID)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;OSErr err = noErr;<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;QTAtom newSpriteAtom;<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;FailIf (QTFindChildByID (theSample, kParentAtomIsContainer,<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;kSpriteAtomType, spriteID, nil), paramErr);<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;FailOSErr (QTInsertChild (theSample, kParentAtomIsContainer,<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;kSpriteAtomType, spriteID, 0, 0, nil, &#38;newSpriteAtom));<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;FailOSErr (QTInsertChildren (theSample, newSpriteAtom, theSprite));<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div>

<p>Once you have retrieved a child atom, you can call <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTNextChildAnyType" target="_top">QTNextChildAnyType</a></code> function to retrieve subsequent children of a parent atom. <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTNextChildAnyType" target="_top">QTNextChildAnyType</a></code> returns an offset to the next atom of any type in a parent atom&#8217;s child list. This function is useful for iterating through a parent atom&#8217;s children quickly.</p>
<p>QuickTime also provides functions for retrieving an atom&#8217;s type, ID, and data. You can call <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTGetAtomTypeAndID" target="_top">QTGetAtomTypeAndID</a></code> function to retrieve an atom&#8217;s type and ID. You can access an atom&#8217;s data in one of three ways.</p>
<ul class="ul">
<li class="li"><p>To copy an atom&#8217;s data to a handle, you can use the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTCopyAtomDataToHandle" target="_top">QTCopyAtomDataToHandle</a></code> function.</p></li>
<li class="li"><p>To copy an atom&#8217;s data to a pointer, you can use the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTCopyAtomDataToPtr" target="_top">QTCopyAtomDataToPtr</a></code> function.</p></li>
<li class="li"><p>To access an atom&#8217;s data directly, you should lock the atom container in memory by calling <code>QTLockContainerMovie</code> Data Types. Once the container is locked, you can call <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTGetAtomDataPtr" target="_top">QTGetAtomDataPtr</a></code> to retrieve a pointer to an atom&#8217;s data. When you have finished accessing the atom&#8217;s data, you should call the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTUnlockContainer" target="_top">QTUnlockContainer</a></code> function to unlock the container in memory.</p></li>
</ul>

<a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_46" title="Modifying Atoms"></a>
<h2><a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-ModifyingAtoms" title="Modifying Atoms"></a>Modifying Atoms</h2>
<p>QuickTime provides functions that you can call to modify attributes or data associated with an atom in an atom container. To modify an atom&#8217;s ID, you call the function <code>QTSetAtomIDMovie</code> Data Types.</p>
<p>You use the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTSetAtomData" target="_top">QTSetAtomData</a></code> function to update the data associated with a leaf atom in an atom container. The <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTSetAtomData" target="_top">QTSetAtomData</a></code> function replaces a leaf atom&#8217;s data with new data. The code sample in Listing 7-8 calls <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTFindChildByIndex" target="_top">QTFindChildByIndex</a></code> to determine whether an atom container contains a sprite&#8217;s visible property. If so, the sample calls <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTSetAtomData" target="_top">QTSetAtomData</a></code> to replace the atom&#8217;s data with a new visible property.</p>
<a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_105" title="Listing 7-8Modifying an atom&#39;s data"></a>
<p class="codesample"><strong>Listing 7-8&nbsp;&nbsp;</strong>Modifying an atom's data</p>
<div class="codesample"><table><tr><td scope="row"><pre>QTAtom propertyAtom;<span></span></pre></td></tr><tr><td scope="row"><pre>// if the atom isn't in the container, add it<span></span></pre></td></tr><tr><td scope="row"><pre>if ((propertyAtom = QTFindChildByIndex (sprite, kParentAtomIsContainer,<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;kSpritePropertyVisible, 1, nil)) == 0)<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;FailOSErr (QTInsertChild (sprite, kParentAtomIsContainer,<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;kSpritePropertyVisible, 1, 0, sizeof(short), visible, nil))<span></span></pre></td></tr><tr><td scope="row"><pre>// if the atom is in the container, replace its data<span></span></pre></td></tr><tr><td scope="row"><pre>else<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;FailOSErr (QTSetAtomData (sprite, propertyAtom, sizeof(short),<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;visible));<span></span></pre></td></tr></table></div>


<a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_47" title="Removing Atoms From an Atom Container"></a>
<h2><a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-RemovingAtomsFromanAtomContainer" title="Removing Atoms From an Atom Container"></a>Removing Atoms From an Atom Container</h2>
<p>To remove atoms from an atom container, you can use the <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTRemoveAtom" target="_top">QTRemoveAtom</a></code> and <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTRemoveChildren" target="_top">QTRemoveChildren</a></code> functions. The <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTRemoveAtom" target="_top">QTRemoveAtom</a></code> function removes an atom and its children, if any, from a container. The <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTRemoveChildren" target="_top">QTRemoveChildren</a></code> function removes an atom&#8217;s children from a container, but does not remove the atom itself. You can also use <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTRemoveChildren" target="_top">QTRemoveChildren</a></code> to remove all the atoms in an atom container. To do so, you should pass the constant <code>kParentAtomIsContainer</code> for the <code>atom</code> parameter.</p>
<p>The code sample shown in Listing 7-9 adds override samples to a sprite track to animate the sprites in the sprite track. The <code>sample</code> and <code>spriteData</code> variables are atom containers. The <code>spriteData</code> atom container contains atoms that describe a single sprite. The <code>sample</code> atom container contains atoms that describes an override sample.</p>
<p>Each iteration of the <code>for</code> loop calls <code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTRemoveChildren" target="_top">QTRemoveChildren</a></code> to remove all atoms from both the <code>sample</code> and the <code>spriteData</code> containers. The sample code updates the index of the image to be used for the sprite and the sprite&#8217;s location and calls <code>SetSpriteData</code>, which adds the appropriate atoms to the <code>spriteData</code> atom container. Then, the sample code calls <code>AddSpriteToSample</code> to add the <code>spriteData</code> atom container to the <code>sample</code> atom container. Finally, when all the sprites have been updated, the sample code calls <code>AddSpriteSampleToMedia</code> to add the override sample to the sprite track.</p>
<a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_106" title="Listing 7-9Removing atoms from a container"></a>
<p class="codesample"><strong>Listing 7-9&nbsp;&nbsp;</strong>Removing atoms from a container</p>
<div class="codesample"><table><tr><td scope="row"><pre>QTAtomContainer sample, spriteData;<span></span></pre></td></tr><tr><td scope="row"><pre>// ...<span></span></pre></td></tr><tr><td scope="row"><pre>// add the sprite key sample<span></span></pre></td></tr><tr><td scope="row"><pre>// ...<span></span></pre></td></tr><tr><td scope="row"><pre>// add override samples to make the sprites spin and move<span></span></pre></td></tr><tr><td scope="row"><pre>for (i = 1; i &#60;= kNumOverrideSamples; i++)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;QTRemoveChildren (sample, kParentAtomIsContainer);<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;QTRemoveChildren (spriteData, kParentAtomIsContainer);<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;// ...<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;// update the sprite:<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;// - update the imageIndex<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;// - update the location<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;// ...<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;// add atoms to spriteData atom container<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;SetSpriteData (spriteData, &#38;location, nil, nil, &#38;imageIndex);<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;// add the spriteData atom container to sample<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;err = AddSpriteToSample (sample, spriteData, 2);<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;// ...<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;// update other sprites<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;// ...<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;// add the sample to the media<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;err = AddSpriteSampleToMedia (newMedia, sample,<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;kSpriteMediaFrameDuration, false);<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div>


<a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_48" title="Creating and Modifying QT Atom Containers"></a>
<h2><a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-CreatingandModifyingQTAtomContainers" title="Creating and Modifying QT Atom Containers"></a>Creating and Modifying QT Atom Containers</h2>
<p>The following functions can be used to create and modify QT atom containers:</p>
<ul class="ul">
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTNewAtomContainer" target="_top">QTNewAtomContainer</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTInsertChild" target="_top">QTInsertChild</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTInsertChildren" target="_top">QTInsertChildren</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTReplaceAtom" target="_top">QTReplaceAtom</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTSwapAtoms" target="_top">QTSwapAtoms</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTSetAtomID" target="_top">QTSetAtomID</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTSetAtomData" target="_top">QTSetAtomData</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTCopyAtom" target="_top">QTCopyAtom</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTLockContainer" target="_top">QTLockContainer</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTGetAtomDataPtr" target="_top">QTGetAtomDataPtr</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTUnlockContainer" target="_top">QTUnlockContainer</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTRemoveAtom" target="_top">QTRemoveAtom</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTRemoveChildren" target="_top">QTRemoveChildren</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTDisposeAtomContainer" target="_top">QTDisposeAtomContainer</a></code></p></li>
</ul>

<a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_49" title="Retrieving Atoms and Atom Data"></a>
<h2><a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-RetrievingAtomsandAtomData" title="Retrieving Atoms and Atom Data"></a>Retrieving Atoms and Atom Data</h2>
<p>This following functions can be used to retrieve QT Atoms and atom data. Each QT atom contains either data or other atoms.</p>
<ul class="ul">
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTGetNextChildType" target="_top">QTGetNextChildType</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTCountChildrenOfType" target="_top">QTCountChildrenOfType</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTFindChildByIndex" target="_top">QTFindChildByIndex</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTFindChildByID" target="_top">QTFindChildByID</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTNextChildAnyType" target="_top">QTNextChildAnyType</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTCopyAtomDataToHandle" target="_top">QTCopyAtomDataToHandle</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTCopyAtomDataToPtr" target="_top">QTCopyAtomDataToPtr</a></code></p></li>
<li class="li"><p><code><a href="../../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/c/func/QTGetAtomTypeAndID" target="_top">QTGetAtomTypeAndID</a></code></p></li>
</ul>

<a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_50" title="Constants for QT Atom Functions"></a>
<h2><a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-ConstantsforQTAtomFunctions" title="Constants for QT Atom Functions"></a>Constants for QT Atom Functions</h2>
<p>You can pass the <code>kParentAtomIsContainer</code> constant to QT atom functions that take an atom container and a parent atom as parameters. When passed in place of the parent atom, this constant indicates that the parent atom is the atom container itself.</p>

<div class="codesample"><table><tr><td scope="row"><pre>enum {<span></span></pre></td></tr><tr><td scope="row"><pre>&#160;&#160;&#160;&#160;kParentAtomIsContainer&#160;&#160;= 0<span></span></pre></td></tr><tr><td scope="row"><pre>};<span></span></pre></td></tr></table></div>

<a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_51" title="QT Atom"></a>
<h3><a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-QTAtom" title="QT Atom"></a>QT Atom</h3>
<p>The <code>QTAtom</code> data type represents the offset of an atom within an atom container.</p>

<div class="codesample"><table><tr><td scope="row"><pre>typedef long QTAtom;<span></span></pre></td></tr></table></div>


<a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_52" title="QT Atom Type and ID"></a>
<h3><a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-QTAtomTypeandID" title="QT Atom Type and ID"></a>QT Atom Type and ID</h3>
<p>The <code>QTAtomType</code> data type represents the type of a QT atom. To be valid, a QT atom&#8217;s type must have a nonzero value.</p>

<div class="codesample"><table><tr><td scope="row"><pre>typedef long QTAtomType;<span></span></pre></td></tr></table></div>

<p>The <code>QTAtomID</code> data type represents the ID of a QT atom. To be valid, a QT atom&#8217;s ID must have a nonzero value.</p>

<div class="codesample"><table><tr><td scope="row"><pre>typedef long QTAtomID;<span></span></pre></td></tr></table></div>


<a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-DontLinkElementID_53" title="QT Atom Container"></a>
<h3><a name="//apple_ref/doc/uid/TP40000908-UnderstandingQuickTimeAtoms-QTAtomContainer" title="QT Atom Container"></a>QT Atom Container</h3>
<p>The <code>QTAtomContainer</code> data type is a handle to a QT atom container. Your application never modifies the contents of a QT atom container directly. Instead, you use the functions provided by QuickTime for creating and manipulating QT atom containers.</p>

<div class="codesample"><table><tr><td scope="row"><pre>typedef Handle QTAtomContainer;<span></span></pre></td></tr></table></div>






        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../G-Chapter/7WorkingWithMediaSam.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../I-Chapter/9TimecodeMediaHandle.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2005, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-01-10<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/QuickTime/RM/MovieBasics/MTEditing/H-Chapter/8UnderstandingQuickT.html%3Fid%3DTP40000908-3.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/QuickTime/RM/MovieBasics/MTEditing/H-Chapter/8UnderstandingQuickT.html%3Fid%3DTP40000908-3.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/QuickTime/RM/MovieBasics/MTEditing/H-Chapter/8UnderstandingQuickT.html%3Fid%3DTP40000908-3.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>