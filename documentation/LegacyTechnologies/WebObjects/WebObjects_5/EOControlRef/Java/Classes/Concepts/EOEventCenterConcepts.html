<html>	<head>		<meta http-equiv="content-type" content="text/html;charset=iso-8859-1">		<meta name="generator" content="GoLive CyberStudio 3">		<title>EOEventCenter Concepts</title>	</head>	<body bgcolor="white">		<!-- start of header -->		<!--#include virtual="/includes/framesetheader" -->		<!-- end of header --><!-- start of path --><table cellspacing=0 border=0 width=600 valign="left"><tr><td scope="row"><font face="Geneva,Helvetica,Arial" size="1"><b>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="../../../../../index.html" target="_top">Documentation</a> <b>></b> <a href="../../../../webobjects.html" target="_top">WebObjects</a></font></td></tr></table><br><!-- end of path -->		<a href="../../EOControlTOC.html"><img src="../Art/up.gif" border="0" alt="Table of Contents"></a> <a name="EOClassDescription"></a>		<h1><font color="#000066"><a name="//apple_ref/UNKNOWN_LANGUAGE/cl/EOEventCenter.Concepts"></a>EOEventCenter.Concepts</font></h1>		<p><br>		<br>		<a name="CBGCFGEE"></a>		<h2>Event Logging Overview</h2>		<p>The event logging system defined by EOEventCenter and EOEvent allow the measurement of the length of certain <em>instrumented</em> operations. An EOEvent keeps information (such as duration and type) about a logged event, and an EOEventCenter manages those events. EOEvent is an abstract class whose subclasses are responsible for defining the events they track. For example, there are (private) subclasses for Sybase adaptor events, editing context events, WOApplication events, and so on. To enable event logging in an application, simply open the WOEventSetup page as described in <a href="#CBGCAACH">&quot;WOEventSetup page&quot; (page 89)</a> and enable logging for the event classes you want to see.</p>		<p>In addition to the framework support, the WOExtensions framework provides components for using the feature. WOEventSetup is a page you use to configure event logging, and WOEventDisplay is a page the displays event information. Both pages can be accessed in any WebObjects 4.5 application with a direct action.</p>		<p><br>		<a name="CBGCAACH"></a>		<h2>WOEventSetup page</h2>		<p>The page used to set up the logging properties is accessed through a direct action named &quot;WOEventSetup&quot;. So for example, you can access the WOEventSetup page for an application named &quot;MyApp&quot; with a URL such as the following:</p>		<pre><blockquote>http://myhost:aPort/cgi-bin/WebObjects/MyApp.woa/wa/WOEventSetup</blockquote></pre>		<p><br>		<p>On the WOEventSetup page, you can see all families of events that are registered for the application. Since the event classes are registered dynamically as the program executes, it is a good idea to &quot;warm up&quot; an application before accessing WOEventSetup.</p>		<p>The page lists the registered event classes, their subcategories, and a description of the kinds of events that can be logged. For instance, the EOEditingContext event class logs events for the <b>saveChanges</b> and <b>objectsWithFetchSpecification</b> methods. Logging for each class can be enabled and disabled with the corresponding check box; it isn't possible to disable individual subcategories of an event class.</p>		<p>The logging mechanism is extremely fast and memory efficient. A standard 300MHz G3 can log more than 300,000 events per second, so event logging overhead is negligible compared to the time required to generate dynamic web pages.</p>		<p><br>		<h2>User Defaults</h2>		<p>In addition to the configuration you can do on the WOEventSetup page, the event logging system uses user defaults to additionally configure event logging behavior. The user defaults are:</p>		<ul>			<li><b>EOEventLoggingEnabled</b>, a boolean value that specifies whether or not to log registered event classes by default. 			<li><b>EOEventLoggingLimit</b>, an integer value that specifies the number of events to log before suspending logging. 		</ul>		<p><br>		<a name="CAHGDEGG"></a>		<h2>WOEventDisplay page</h2>		<p>The page that displays collected events, WOEventDisplay, is also accessed through a direct action. For example, you can access the WOEventSetup page for an application named &quot;MyApp&quot; with a URL such as the following:</p>		<pre><blockquote>http://myhost:aPort/cgi-bin/WebObjects/MyApp.woa/wa/WOEventDisplay</blockquote></pre>		<p><br>		<p>On this page, you can view events in four different ways:</p>		<ul>			<li><em>Raw root events</em>. In this view, all events at the root level (events without an encompassing event) are displayed. WOEventDisplay shows each event individually, which means that it's possible for an event to appear multiple times if the thread of execution crossed its point more than once. 			<li><em>Aggregated root events</em>. This view is similar to the raw root event view, except that multiple identical events are aggregated, and their combined time is displayed. In addition, the &quot;Calls&quot; column shows how many times an event was executed (in other words, how many events contributed to the displayed aggregate event). 			<li><em>Events grouped by page and component</em>. In this view, the first level of display shows only page names. By expanding a page, you get a list of components in that page. Expanding a component shows all the events within that component. This means that even events which were collected &quot;deep&quot; within a component are shown immediately below the component name. All identical events are aggregated as in the aggregated root event view for easier reading. It's possible to traverse the component event hierarchy by expanding the hyperlinks within a component. Note that since a page is also a component, a page with no dynamic subcomponents seems as if it's nested one level too deep. This is the correct behavior. 			<li><em>Events grouped by page only</em>. This display is similar to the grouped by page and component view, except the events do not have a by-component subgrouping. 		</ul>		<p>In any of these displays, if an event or event group has subevents, it can be expanded by clicking the hyperlink or triangle image.</p>		<p>Each view orders events by duration (in milliseconds) from the longest to the shortest. Aggregation induces rounding errors, which are a maximum of 1ms per event. In other words, an aggregate event consisting of ten events has at most 1ms deviation from the actual run time; however, manually adding ten individual events as displayed in the table might have up to a 10ms deviation. Therefore, any displayed sum is always more accurate than adding up the durations of individual events. Also note that the sub-events of an event branch doesn't necessarily add up to the duration of the branch event-the branch event's duration might be larger. This because the parent event generally consists of more than just calling the methods causing the sub-events.</p>		<p><br>		<a name="CAHJJFFF"></a>		<h2>Custom Event Logging</h2>		<p>To define and log custom events, you create an event class, you define the event's categories and subcategories, you register the event class with the WOEvent center, and you instrument the portions of code you want to log. This section describes these steps.</p>		<p>To create a custom event:</p>		<ol>			<li>Create a subclass of EOEvent or an appropriate subclass. For example, to log events for a custom adaptor you've written, say MyAdaptor, create an EOEvent subclass named MyAdaptorEvent. Your subclass doesn't usually have to override any of the inherited methods, but you can customize the default behavior. For more information, see the EOEvent class specification. 			<li>Create a description file for your event and add it to your project's Resources folder. An event's description file defines the event categories and subcategories used in the WOEventDisplay page. The file's contents is a dictionary in plist format. For the MyAdaptorEvent class, the file's name is <tt>MyAdaptorEvent.description</tt>, and it might look like the following: 			<pre><blockquote>{    EOEventGroupName = &quot;MyAdaptor Event&quot;;    connect = &quot;Connect&quot;;    openChannel = &quot;Open Channel&quot;;    evaluateExpression = &quot;Evaluate Expression&quot;;    fetchRow = &quot;Fetch Row&quot;;    commitTransaction = &quot;Commit Transaction&quot;;}</blockquote></pre>			<p><br>			For more information, see the eventTypeDescriptions method description in the EOEvent class specification. 			<li>Register the event class with the EOEventCenter. Typically you register an event class in the <b>initialize</b> method of the class whose code you're instrumenting-MyAdaptor in this example. 			<pre><blockquote>static Class MyAdaptorEventLoggingClass = Nil;static NSString *connectEvent = @&quot;connect&quot;;static NSString *openChannelEvent = @&quot;openChannel&quot;;static NSString *evaluateExpressionEvent = @&quot;evaluateExpression&quot;;static NSString *fetchRowEvent = @&quot;fetchRow&quot;;static NSString *commitTransactionEvent = @&quot;commitTransaction&quot;;+ (void)initialize {    [EOEventCenter registerEventClass:[MyAdaptorEvent class]            classPointer:&MyAdaptorEventLoggingClass;];}</blockquote></pre>			<p><br>			As in this example, you might want to define string constants for the keys in your event's description dictionary. 			<li>Instrument the methods. In any method you want to instrument, add the following code, substituting the appropriate event key. This code instruments the &quot;connect&quot; event of MyAdaptorEvent. 			<pre><blockquote>MyAdaptorEvent *event = nil;// Setup and start loggingif (MyAdaptorEventLoggingClass) {    event = EONewEventOfClass(MyAdaptorEventLoggingClass, connectEvent);    EOMarkStartOfEvent(event, nil);}// Code to be timed goes here.// Finish logging.if(event) {    EOMarkEndOfEvent(event);</blockquote></pre>			<p><br>			The second argument to <b>EONewEventOfClass</b> is an event key corresponding with an entry in the <tt>.description</tt> file. The corresponding value is used in the Title column of the WOEventDisplay page. If the argument isn't a key in the description dictionary, <b>EONewEventOfClass</b> uses the argument instead. For more information on the methods used in this example, see the appropriate method descriptions in the EOEventCenter class specification. 		</ol>		<p>&copy; 2001 Apple Computer, Inc. (Last Published April 19, 2001)</p>		<p><br>		<a href="../../EOControlTOC.html"><img src="../Art/up.gif" border="0" alt="Table of Contents"></a> <!-- start of footer -->		<!--#include virtual="/includes/framesetfooter" -->		<!-- end of footer -->	</body></html>