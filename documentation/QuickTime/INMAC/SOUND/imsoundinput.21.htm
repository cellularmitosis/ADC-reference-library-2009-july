<!-- legacy work start --><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"        "http://www.w3.org/TR/html4/loose.dtd"><!-- legacy work end --><HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><TITLE>Sound Input Interrupt Routines (deprecated)</title><!-- legacy work start -->        <META NAME="Generator" CONTENT="manual">        <META http-equiv="content-type" CONTENT="text/html;charset=utf-8">        <META NAME = "Copyright" CONTENT="Copyright 2007 Apple Inc. All Rights Reserved.">        <META NAME="IndexTitle" CONTENT="Sound Input Manager (Not Recommended)">        <meta name="xcode-display" content="render">        <LINK REL="stylesheet" TYPE="text/css" HREF="../../../Resources/CSS/frameset_styles.css"> <!-- before submitting, globally replace ".." with "developer.apple.com" -->        <script type="text/javascript" language="JavaScript" src="../../../Resources/JavaScript/page.js"></script><!-- legacy work end --></HEAD><BODY BGCOLOR="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- path goes here --><!-- QTnavbar start --><P><I>Inside Macintosh: Sound Manager</I><P>| <A target="doc" HREF="imsoundinput.20.htm">Previous</A> | <A target="doc" HREF="imsoundinput.1.htm">Chapter contents</A> | <A target="doc" HREF="imsoundinput.htm">Chapter top</A> | <A target="doc" HREF="imsoundinput.1f.htm">Section top</A> | <!-- QTnavbar end --><!-- legacy work start --><script type="text/javascript"> placeWatermark()</script><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox" style="position: relative;"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b><i>Sound Input Manager</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="http://developer.apple.com/referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div><!-- legacy work end --><H1 CLASS="RH3.RoutineHd3"><A NAME="pgfId=1774"> </A><A NAME="41529"> </A>Sound Input Interrupt Routines<A NAME="marker=217"> </A><A NAME="marker=528"> </A></H1><P CLASS="T0.Text0"><A NAME="pgfId=1313"> </A><A NAME="marker=416"> </A>You can specify a sound input interrupt routine in the <TT CLASS="cv">interruptRoutine</TT> field of the&nbsp;sound input parameter block that your application uses to initiate asynchronous recording directly from a device. Because the <TT CLASS="cv">SPBRecordToFile</TT> function uses sound input interrupt routines to enable it to record sound data to disk during recording, you can use sound input interrupt routines only with the <TT CLASS="cv">SPBRecord</TT> function.</P><DIV><H2 CLASS="RoH.RoutineHeading"><A NAME="pgfId=1315"> </A>MySIInterruptRoutine</H2><P CLASS="T0.Text0"><A NAME="pgfId=1316"> </A>A sound input interrupt routine has the following syntax:</P><CODE CLASS="RD.RoutineDeclare"><A NAME="pgfId=13656"> </A>PROCEDURE MySIInterruptRoutine;<BR></CODE><DIV><H3 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=1325"> </A>DESCRIPTION</H3><P CLASS="T0.Text0"><A NAME="pgfId=1328"> </A>A sound input device driver executes the sound input interrupt routine associated with an asynchronous sound recording whenever the driver's internal buffers are full. The internal buffers contain raw samples taken directly from the input device. The interrupt routine can thus modify the samples in the buffer in any way it requires. After your sound input interrupt routine finishes processing the data, the sound input device driver&nbsp;compresses the data (if compression is enabled) and copies the data into your application's buffer.</P></DIV><DIV><H3 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=1318"> </A>SPECIAL CONSIDERATIONS</H3><P CLASS="T0.Text0"><A NAME="pgfId=1326"> </A>If your sound input interrupt routine accesses your application's global variables, it must ensure that the A5 register contains the address of the boundary between the application global variables and the application parameters. Your application can pass the value of the A5 register to the sound input interrupt routine in the <TT CLASS="cv">userLong</TT> field of the sound input parameter block. For more information on ensuring the validity of the A5 register, see the chapter &quot;Memory Management Utilities&quot; in <I CLASS="italics">Inside Macintosh: Memory</I>.</P></DIV><DIV><H3 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=1314"> </A>ASSEMBLY-LANGUAGE INFORMATION</H3><P CLASS="T0.Text0"><A NAME="pgfId=1319"> </A>Sound input interrupt routines are sometimes written in assembly language to maximize real-time performance in recording sound. On entry, registers are set up as follows: </P><TABLE><TR><TD ROWSPAN="1" COLSPAN="2"><H6 CLASS="MH.ColsHd"><A NAME="pgfId=1299"> </A>Registers on entry</H6></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="ML.ColsList"><A NAME="pgfId=1693"> </A>A0</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="ML.ColsList"><A NAME="pgfId=1300"> </A>Address of the sound parameter block passed to <TT CLASS="cv">SPBRecord</TT></P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="ML.ColsList"><A NAME="pgfId=1301"> </A>A1</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="ML.ColsList"><A NAME="pgfId=1302"> </A>Address of the start of the sample buffer</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="ML.ColsList"><A NAME="pgfId=1303"> </A>D0</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="ML.ColsList"><A NAME="pgfId=1312"> </A>Peak amplitude for sample buffer if metering is on</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="ML.ColsList"><A NAME="pgfId=1643"> </A>D1</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="ML.ColsList"><A NAME="pgfId=1644"> </A>Size of the sample buffer in bytes</P></TD></TR></TABLE><P CLASS="T1.Text1"><A NAME="pgfId=1320"> </A>If you write a sound input interrupt routine in a high-level language like Pascal or C, you might need to write inline code to copy variables from the registers into local variables that your application defines.</P><P CLASS="T1.Text1"><A NAME="pgfId=1324"> </A>Because a sound input interrupt routine is called at interrupt time, it must preserve all&nbsp;registers.<A NAME="marker=388"> </A><A NAME="marker=391"> </A><A NAME="marker=472"> </A><A NAME="marker=417"> </A></P><P CLASS="T1.Text1"><A NAME="pgfId=593"> </A>&nbsp;</P></DIV></DIV><hr>&#169; 1999 Apple Computer, Inc.<!-- QTnavbar start --><P><I>Inside Macintosh: Sound Manager</I><P>| <A target="doc" HREF="imsoundinput.20.htm">Previous</A> | <A target="doc" HREF="imsoundinput.1.htm">Chapter contents</A> | <A target="doc" HREF="imsoundinput.htm">Chapter top</A> | <A target="doc" HREF="imsoundinput.1f.htm">Section top</A> | <!-- QTnavbar end --><!-- legacy work start --><script type="text/javascript"> placeWatermark()</script><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox" style="position: relative;"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b><i>Sound Input Manager</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="http://developer.apple.com/referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div><!-- legacy work end --></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY></HTML>